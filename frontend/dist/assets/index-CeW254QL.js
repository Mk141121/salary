var G1=e=>{throw TypeError(e)};var Ff=(e,t,r)=>t.has(e)||G1("Cannot "+r);var te=(e,t,r)=>(Ff(e,t,"read from private field"),r?r.call(e):t.get(e)),Qe=(e,t,r)=>t.has(e)?G1("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Ue=(e,t,r,n)=>(Ff(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),ft=(e,t,r)=>(Ff(e,t,"access private method"),r);var E0=(e,t,r,n)=>({set _(s){Ue(e,t,s,r)},get _(){return te(e,t,n)}});function pj(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const l=Object.getOwnPropertyDescriptor(n,s);l&&Object.defineProperty(e,s,l.get?l:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(s){if(s.ep)return;s.ep=!0;const l=r(s);fetch(s.href,l)}})();function lx(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Af={exports:{}},mc={},Df={exports:{}},mt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q1;function xj(){if(q1)return mt;q1=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.iterator;function g(K){return K===null||typeof K!="object"?null:(K=m&&K[m]||K["@@iterator"],typeof K=="function"?K:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,y={};function N(K,k,B){this.props=K,this.context=k,this.refs=y,this.updater=B||b}N.prototype.isReactComponent={},N.prototype.setState=function(K,k){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,k,"setState")},N.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function _(){}_.prototype=N.prototype;function C(K,k,B){this.props=K,this.context=k,this.refs=y,this.updater=B||b}var S=C.prototype=new _;S.constructor=C,v(S,N.prototype),S.isPureReactComponent=!0;var E=Array.isArray,O=Object.prototype.hasOwnProperty,F={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function D(K,k,B){var A,M={},ae=null,de=null;if(k!=null)for(A in k.ref!==void 0&&(de=k.ref),k.key!==void 0&&(ae=""+k.key),k)O.call(k,A)&&!T.hasOwnProperty(A)&&(M[A]=k[A]);var be=arguments.length-2;if(be===1)M.children=B;else if(1<be){for(var we=Array(be),ye=0;ye<be;ye++)we[ye]=arguments[ye+2];M.children=we}if(K&&K.defaultProps)for(A in be=K.defaultProps,be)M[A]===void 0&&(M[A]=be[A]);return{$$typeof:e,type:K,key:ae,ref:de,props:M,_owner:F.current}}function I(K,k){return{$$typeof:e,type:K.type,key:k,ref:K.ref,props:K.props,_owner:K._owner}}function J(K){return typeof K=="object"&&K!==null&&K.$$typeof===e}function Z(K){var k={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(B){return k[B]})}var ee=/\/+/g;function ne(K,k){return typeof K=="object"&&K!==null&&K.key!=null?Z(""+K.key):k.toString(36)}function he(K,k,B,A,M){var ae=typeof K;(ae==="undefined"||ae==="boolean")&&(K=null);var de=!1;if(K===null)de=!0;else switch(ae){case"string":case"number":de=!0;break;case"object":switch(K.$$typeof){case e:case t:de=!0}}if(de)return de=K,M=M(de),K=A===""?"."+ne(de,0):A,E(M)?(B="",K!=null&&(B=K.replace(ee,"$&/")+"/"),he(M,k,B,"",function(ye){return ye})):M!=null&&(J(M)&&(M=I(M,B+(!M.key||de&&de.key===M.key?"":(""+M.key).replace(ee,"$&/")+"/")+K)),k.push(M)),1;if(de=0,A=A===""?".":A+":",E(K))for(var be=0;be<K.length;be++){ae=K[be];var we=A+ne(ae,be);de+=he(ae,k,B,we,M)}else if(we=g(K),typeof we=="function")for(K=we.call(K),be=0;!(ae=K.next()).done;)ae=ae.value,we=A+ne(ae,be++),de+=he(ae,k,B,we,M);else if(ae==="object")throw k=String(K),Error("Objects are not valid as a React child (found: "+(k==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":k)+"). If you meant to render a collection of children, use an array instead.");return de}function Q(K,k,B){if(K==null)return K;var A=[],M=0;return he(K,A,"","",function(ae){return k.call(B,ae,M++)}),A}function xe(K){if(K._status===-1){var k=K._result;k=k(),k.then(function(B){(K._status===0||K._status===-1)&&(K._status=1,K._result=B)},function(B){(K._status===0||K._status===-1)&&(K._status=2,K._result=B)}),K._status===-1&&(K._status=0,K._result=k)}if(K._status===1)return K._result.default;throw K._result}var Y={current:null},le={transition:null},X={ReactCurrentDispatcher:Y,ReactCurrentBatchConfig:le,ReactCurrentOwner:F};function ve(){throw Error("act(...) is not supported in production builds of React.")}return mt.Children={map:Q,forEach:function(K,k,B){Q(K,function(){k.apply(this,arguments)},B)},count:function(K){var k=0;return Q(K,function(){k++}),k},toArray:function(K){return Q(K,function(k){return k})||[]},only:function(K){if(!J(K))throw Error("React.Children.only expected to receive a single React element child.");return K}},mt.Component=N,mt.Fragment=r,mt.Profiler=s,mt.PureComponent=C,mt.StrictMode=n,mt.Suspense=d,mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,mt.act=ve,mt.cloneElement=function(K,k,B){if(K==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+K+".");var A=v({},K.props),M=K.key,ae=K.ref,de=K._owner;if(k!=null){if(k.ref!==void 0&&(ae=k.ref,de=F.current),k.key!==void 0&&(M=""+k.key),K.type&&K.type.defaultProps)var be=K.type.defaultProps;for(we in k)O.call(k,we)&&!T.hasOwnProperty(we)&&(A[we]=k[we]===void 0&&be!==void 0?be[we]:k[we])}var we=arguments.length-2;if(we===1)A.children=B;else if(1<we){be=Array(we);for(var ye=0;ye<we;ye++)be[ye]=arguments[ye+2];A.children=be}return{$$typeof:e,type:K.type,key:M,ref:ae,props:A,_owner:de}},mt.createContext=function(K){return K={$$typeof:c,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},K.Provider={$$typeof:l,_context:K},K.Consumer=K},mt.createElement=D,mt.createFactory=function(K){var k=D.bind(null,K);return k.type=K,k},mt.createRef=function(){return{current:null}},mt.forwardRef=function(K){return{$$typeof:u,render:K}},mt.isValidElement=J,mt.lazy=function(K){return{$$typeof:p,_payload:{_status:-1,_result:K},_init:xe}},mt.memo=function(K,k){return{$$typeof:f,type:K,compare:k===void 0?null:k}},mt.startTransition=function(K){var k=le.transition;le.transition={};try{K()}finally{le.transition=k}},mt.unstable_act=ve,mt.useCallback=function(K,k){return Y.current.useCallback(K,k)},mt.useContext=function(K){return Y.current.useContext(K)},mt.useDebugValue=function(){},mt.useDeferredValue=function(K){return Y.current.useDeferredValue(K)},mt.useEffect=function(K,k){return Y.current.useEffect(K,k)},mt.useId=function(){return Y.current.useId()},mt.useImperativeHandle=function(K,k,B){return Y.current.useImperativeHandle(K,k,B)},mt.useInsertionEffect=function(K,k){return Y.current.useInsertionEffect(K,k)},mt.useLayoutEffect=function(K,k){return Y.current.useLayoutEffect(K,k)},mt.useMemo=function(K,k){return Y.current.useMemo(K,k)},mt.useReducer=function(K,k,B){return Y.current.useReducer(K,k,B)},mt.useRef=function(K){return Y.current.useRef(K)},mt.useState=function(K){return Y.current.useState(K)},mt.useSyncExternalStore=function(K,k,B){return Y.current.useSyncExternalStore(K,k,B)},mt.useTransition=function(){return Y.current.useTransition()},mt.version="18.3.1",mt}var X1;function ox(){return X1||(X1=1,Df.exports=xj()),Df.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q1;function mj(){if(Q1)return mc;Q1=1;var e=ox(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(u,d,f){var p,m={},g=null,b=null;f!==void 0&&(g=""+f),d.key!==void 0&&(g=""+d.key),d.ref!==void 0&&(b=d.ref);for(p in d)n.call(d,p)&&!l.hasOwnProperty(p)&&(m[p]=d[p]);if(u&&u.defaultProps)for(p in d=u.defaultProps,d)m[p]===void 0&&(m[p]=d[p]);return{$$typeof:t,type:u,key:g,ref:b,props:m,_owner:s.current}}return mc.Fragment=r,mc.jsx=c,mc.jsxs=c,mc}var Y1;function gj(){return Y1||(Y1=1,Af.exports=mj()),Af.exports}var a=gj(),P=ox();const z2=lx(P),vj=pj({__proto__:null,default:z2},[P]);var F0={},Pf={exports:{}},mn={},Lf={exports:{}},Of={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J1;function yj(){return J1||(J1=1,(function(e){function t(le,X){var ve=le.length;le.push(X);e:for(;0<ve;){var K=ve-1>>>1,k=le[K];if(0<s(k,X))le[K]=X,le[ve]=k,ve=K;else break e}}function r(le){return le.length===0?null:le[0]}function n(le){if(le.length===0)return null;var X=le[0],ve=le.pop();if(ve!==X){le[0]=ve;e:for(var K=0,k=le.length,B=k>>>1;K<B;){var A=2*(K+1)-1,M=le[A],ae=A+1,de=le[ae];if(0>s(M,ve))ae<k&&0>s(de,M)?(le[K]=de,le[ae]=ve,K=ae):(le[K]=M,le[A]=ve,K=A);else if(ae<k&&0>s(de,ve))le[K]=de,le[ae]=ve,K=ae;else break e}}return X}function s(le,X){var ve=le.sortIndex-X.sortIndex;return ve!==0?ve:le.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var d=[],f=[],p=1,m=null,g=3,b=!1,v=!1,y=!1,N=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(le){for(var X=r(f);X!==null;){if(X.callback===null)n(f);else if(X.startTime<=le)n(f),X.sortIndex=X.expirationTime,t(d,X);else break;X=r(f)}}function E(le){if(y=!1,S(le),!v)if(r(d)!==null)v=!0,xe(O);else{var X=r(f);X!==null&&Y(E,X.startTime-le)}}function O(le,X){v=!1,y&&(y=!1,_(D),D=-1),b=!0;var ve=g;try{for(S(X),m=r(d);m!==null&&(!(m.expirationTime>X)||le&&!Z());){var K=m.callback;if(typeof K=="function"){m.callback=null,g=m.priorityLevel;var k=K(m.expirationTime<=X);X=e.unstable_now(),typeof k=="function"?m.callback=k:m===r(d)&&n(d),S(X)}else n(d);m=r(d)}if(m!==null)var B=!0;else{var A=r(f);A!==null&&Y(E,A.startTime-X),B=!1}return B}finally{m=null,g=ve,b=!1}}var F=!1,T=null,D=-1,I=5,J=-1;function Z(){return!(e.unstable_now()-J<I)}function ee(){if(T!==null){var le=e.unstable_now();J=le;var X=!0;try{X=T(!0,le)}finally{X?ne():(F=!1,T=null)}}else F=!1}var ne;if(typeof C=="function")ne=function(){C(ee)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,Q=he.port2;he.port1.onmessage=ee,ne=function(){Q.postMessage(null)}}else ne=function(){N(ee,0)};function xe(le){T=le,F||(F=!0,ne())}function Y(le,X){D=N(function(){le(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(le){le.callback=null},e.unstable_continueExecution=function(){v||b||(v=!0,xe(O))},e.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<le?Math.floor(1e3/le):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return r(d)},e.unstable_next=function(le){switch(g){case 1:case 2:case 3:var X=3;break;default:X=g}var ve=g;g=X;try{return le()}finally{g=ve}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(le,X){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var ve=g;g=le;try{return X()}finally{g=ve}},e.unstable_scheduleCallback=function(le,X,ve){var K=e.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?K+ve:K):ve=K,le){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=ve+k,le={id:p++,callback:X,priorityLevel:le,startTime:ve,expirationTime:k,sortIndex:-1},ve>K?(le.sortIndex=ve,t(f,le),r(d)===null&&le===r(f)&&(y?(_(D),D=-1):y=!0,Y(E,ve-K))):(le.sortIndex=k,t(d,le),v||b||(v=!0,xe(O))),le},e.unstable_shouldYield=Z,e.unstable_wrapCallback=function(le){var X=g;return function(){var ve=g;g=X;try{return le.apply(this,arguments)}finally{g=ve}}}})(Of)),Of}var Z1;function bj(){return Z1||(Z1=1,Lf.exports=yj()),Lf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ev;function wj(){if(ev)return mn;ev=1;var e=ox(),t=bj();function r(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,h=1;h<arguments.length;h++)o+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function l(i,o){c(i,o),c(i+"Capture",o)}function c(i,o){for(s[i]=o,i=0;i<o.length;i++)n.add(o[i])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function g(i){return d.call(m,i)?!0:d.call(p,i)?!1:f.test(i)?m[i]=!0:(p[i]=!0,!1)}function b(i,o,h,x){if(h!==null&&h.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return x?!1:h!==null?!h.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function v(i,o,h,x){if(o===null||typeof o>"u"||b(i,o,h,x))return!0;if(x)return!1;if(h!==null)switch(h.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function y(i,o,h,x,w,j,L){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=x,this.attributeNamespace=w,this.mustUseProperty=h,this.propertyName=i,this.type=o,this.sanitizeURL=j,this.removeEmptyString=L}var N={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){N[i]=new y(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];N[o]=new y(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){N[i]=new y(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){N[i]=new y(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){N[i]=new y(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){N[i]=new y(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){N[i]=new y(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){N[i]=new y(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){N[i]=new y(i,5,!1,i.toLowerCase(),null,!1,!1)});var _=/[\-:]([a-z])/g;function C(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(_,C);N[o]=new y(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(_,C);N[o]=new y(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(_,C);N[o]=new y(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){N[i]=new y(i,1,!1,i.toLowerCase(),null,!1,!1)}),N.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){N[i]=new y(i,1,!1,i.toLowerCase(),null,!0,!0)});function S(i,o,h,x){var w=N.hasOwnProperty(o)?N[o]:null;(w!==null?w.type!==0:x||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(v(o,h,w,x)&&(h=null),x||w===null?g(o)&&(h===null?i.removeAttribute(o):i.setAttribute(o,""+h)):w.mustUseProperty?i[w.propertyName]=h===null?w.type===3?!1:"":h:(o=w.attributeName,x=w.attributeNamespace,h===null?i.removeAttribute(o):(w=w.type,h=w===3||w===4&&h===!0?"":""+h,x?i.setAttributeNS(x,o,h):i.setAttribute(o,h))))}var E=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O=Symbol.for("react.element"),F=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),J=Symbol.for("react.provider"),Z=Symbol.for("react.context"),ee=Symbol.for("react.forward_ref"),ne=Symbol.for("react.suspense"),he=Symbol.for("react.suspense_list"),Q=Symbol.for("react.memo"),xe=Symbol.for("react.lazy"),Y=Symbol.for("react.offscreen"),le=Symbol.iterator;function X(i){return i===null||typeof i!="object"?null:(i=le&&i[le]||i["@@iterator"],typeof i=="function"?i:null)}var ve=Object.assign,K;function k(i){if(K===void 0)try{throw Error()}catch(h){var o=h.stack.trim().match(/\n( *(at )?)/);K=o&&o[1]||""}return`
`+K+i}var B=!1;function A(i,o){if(!i||B)return"";B=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(me){var x=me}Reflect.construct(i,[],o)}else{try{o.call()}catch(me){x=me}i.call(o.prototype)}else{try{throw Error()}catch(me){x=me}i()}}catch(me){if(me&&x&&typeof me.stack=="string"){for(var w=me.stack.split(`
`),j=x.stack.split(`
`),L=w.length-1,q=j.length-1;1<=L&&0<=q&&w[L]!==j[q];)q--;for(;1<=L&&0<=q;L--,q--)if(w[L]!==j[q]){if(L!==1||q!==1)do if(L--,q--,0>q||w[L]!==j[q]){var re=`
`+w[L].replace(" at new "," at ");return i.displayName&&re.includes("<anonymous>")&&(re=re.replace("<anonymous>",i.displayName)),re}while(1<=L&&0<=q);break}}}finally{B=!1,Error.prepareStackTrace=h}return(i=i?i.displayName||i.name:"")?k(i):""}function M(i){switch(i.tag){case 5:return k(i.type);case 16:return k("Lazy");case 13:return k("Suspense");case 19:return k("SuspenseList");case 0:case 2:case 15:return i=A(i.type,!1),i;case 11:return i=A(i.type.render,!1),i;case 1:return i=A(i.type,!0),i;default:return""}}function ae(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case T:return"Fragment";case F:return"Portal";case I:return"Profiler";case D:return"StrictMode";case ne:return"Suspense";case he:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case Z:return(i.displayName||"Context")+".Consumer";case J:return(i._context.displayName||"Context")+".Provider";case ee:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Q:return o=i.displayName||null,o!==null?o:ae(i.type)||"Memo";case xe:o=i._payload,i=i._init;try{return ae(i(o))}catch{}}return null}function de(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ae(o);case 8:return o===D?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function be(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function we(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function ye(i){var o=we(i)?"checked":"value",h=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),x=""+i[o];if(!i.hasOwnProperty(o)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var w=h.get,j=h.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return w.call(this)},set:function(L){x=""+L,j.call(this,L)}}),Object.defineProperty(i,o,{enumerable:h.enumerable}),{getValue:function(){return x},setValue:function(L){x=""+L},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Je(i){i._valueTracker||(i._valueTracker=ye(i))}function G(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var h=o.getValue(),x="";return i&&(x=we(i)?i.checked?"true":"false":i.value),i=x,i!==h?(o.setValue(i),!0):!1}function Ne(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function He(i,o){var h=o.checked;return ve({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??i._wrapperState.initialChecked})}function ht(i,o){var h=o.defaultValue==null?"":o.defaultValue,x=o.checked!=null?o.checked:o.defaultChecked;h=be(o.value!=null?o.value:h),i._wrapperState={initialChecked:x,initialValue:h,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function rt(i,o){o=o.checked,o!=null&&S(i,"checked",o,!1)}function Oe(i,o){rt(i,o);var h=be(o.value),x=o.type;if(h!=null)x==="number"?(h===0&&i.value===""||i.value!=h)&&(i.value=""+h):i.value!==""+h&&(i.value=""+h);else if(x==="submit"||x==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?lr(i,o.type,h):o.hasOwnProperty("defaultValue")&&lr(i,o.type,be(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function Pt(i,o,h){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var x=o.type;if(!(x!=="submit"&&x!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,h||o===i.value||(i.value=o),i.defaultValue=o}h=i.name,h!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,h!==""&&(i.name=h)}function lr(i,o,h){(o!=="number"||Ne(i.ownerDocument)!==i)&&(h==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+h&&(i.defaultValue=""+h))}var or=Array.isArray;function _r(i,o,h,x){if(i=i.options,o){o={};for(var w=0;w<h.length;w++)o["$"+h[w]]=!0;for(h=0;h<i.length;h++)w=o.hasOwnProperty("$"+i[h].value),i[h].selected!==w&&(i[h].selected=w),w&&x&&(i[h].defaultSelected=!0)}else{for(h=""+be(h),o=null,w=0;w<i.length;w++){if(i[w].value===h){i[w].selected=!0,x&&(i[w].defaultSelected=!0);return}o!==null||i[w].disabled||(o=i[w])}o!==null&&(o.selected=!0)}}function sa(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(r(91));return ve({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Cn(i,o){var h=o.value;if(h==null){if(h=o.children,o=o.defaultValue,h!=null){if(o!=null)throw Error(r(92));if(or(h)){if(1<h.length)throw Error(r(93));h=h[0]}o=h}o==null&&(o=""),h=o}i._wrapperState={initialValue:be(h)}}function Re(i,o){var h=be(o.value),x=be(o.defaultValue);h!=null&&(h=""+h,h!==i.value&&(i.value=h),o.defaultValue==null&&i.defaultValue!==h&&(i.defaultValue=h)),x!=null&&(i.defaultValue=""+x)}function Ge(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function Tt(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Lt(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?Tt(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var bt,br=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,h,x,w){MSApp.execUnsafeLocalFunction(function(){return i(o,h,x,w)})}:i})(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(bt=bt||document.createElement("div"),bt.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=bt.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function tt(i,o){if(o){var h=i.firstChild;if(h&&h===i.lastChild&&h.nodeType===3){h.nodeValue=o;return}}i.textContent=o}var St={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sr=["Webkit","ms","Moz","O"];Object.keys(St).forEach(function(i){Sr.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),St[o]=St[i]})});function Ht(i,o,h){return o==null||typeof o=="boolean"||o===""?"":h||typeof o!="number"||o===0||St.hasOwnProperty(i)&&St[i]?(""+o).trim():o+"px"}function tn(i,o){i=i.style;for(var h in o)if(o.hasOwnProperty(h)){var x=h.indexOf("--")===0,w=Ht(h,o[h],x);h==="float"&&(h="cssFloat"),x?i.setProperty(h,w):i[h]=w}}var ys=ve({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ka(i,o){if(o){if(ys[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(r(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(r(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(r(61))}if(o.style!=null&&typeof o.style!="object")throw Error(r(62))}}function $a(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ka=null;function bs(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var vl=null,ws=null,Ns=null;function vi(i){if(i=tc(i)){if(typeof vl!="function")throw Error(r(280));var o=i.stateNode;o&&(o=Ku(o),vl(i.stateNode,i.type,o))}}function wu(i){ws?Ns?Ns.push(i):Ns=[i]:ws=i}function Nu(){if(ws){var i=ws,o=Ns;if(Ns=ws=null,vi(i),o)for(i=0;i<o.length;i++)vi(o[i])}}function ku(i,o){return i(o)}function Tu(){}var Lo=!1;function ju(i,o,h){if(Lo)return i(o,h);Lo=!0;try{return ku(i,o,h)}finally{Lo=!1,(ws!==null||Ns!==null)&&(Tu(),Nu())}}function yi(i,o){var h=i.stateNode;if(h===null)return null;var x=Ku(h);if(x===null)return null;h=x[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(i=i.type,x=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!x;break e;default:i=!1}if(i)return null;if(h&&typeof h!="function")throw Error(r(231,o,typeof h));return h}var Oo=!1;if(u)try{var Wa={};Object.defineProperty(Wa,"passive",{get:function(){Oo=!0}}),window.addEventListener("test",Wa,Wa),window.removeEventListener("test",Wa,Wa)}catch{Oo=!1}function Xh(i,o,h,x,w,j,L,q,re){var me=Array.prototype.slice.call(arguments,3);try{o.apply(h,me)}catch(Ce){this.onError(Ce)}}var bi=!1,yl=null,R=!1,V=null,H={onError:function(i){bi=!0,yl=i}};function U(i,o,h,x,w,j,L,q,re){bi=!1,yl=null,Xh.apply(H,arguments)}function z(i,o,h,x,w,j,L,q,re){if(U.apply(this,arguments),bi){if(bi){var me=yl;bi=!1,yl=null}else throw Error(r(198));R||(R=!0,V=me)}}function W(i){var o=i,h=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(h=o.return),i=o.return;while(i)}return o.tag===3?h:null}function ue(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function Te(i){if(W(i)!==i)throw Error(r(188))}function ce(i){var o=i.alternate;if(!o){if(o=W(i),o===null)throw Error(r(188));return o!==i?null:i}for(var h=i,x=o;;){var w=h.return;if(w===null)break;var j=w.alternate;if(j===null){if(x=w.return,x!==null){h=x;continue}break}if(w.child===j.child){for(j=w.child;j;){if(j===h)return Te(w),i;if(j===x)return Te(w),o;j=j.sibling}throw Error(r(188))}if(h.return!==x.return)h=w,x=j;else{for(var L=!1,q=w.child;q;){if(q===h){L=!0,h=w,x=j;break}if(q===x){L=!0,x=w,h=j;break}q=q.sibling}if(!L){for(q=j.child;q;){if(q===h){L=!0,h=j,x=w;break}if(q===x){L=!0,x=j,h=w;break}q=q.sibling}if(!L)throw Error(r(189))}}if(h.alternate!==x)throw Error(r(190))}if(h.tag!==3)throw Error(r(188));return h.stateNode.current===h?i:o}function fe(i){return i=ce(i),i!==null?pe(i):null}function pe(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=pe(i);if(o!==null)return o;i=i.sibling}return null}var Ee=t.unstable_scheduleCallback,Be=t.unstable_cancelCallback,ze=t.unstable_shouldYield,De=t.unstable_requestPaint,Ae=t.unstable_now,lt=t.unstable_getCurrentPriorityLevel,Rt=t.unstable_ImmediatePriority,Ut=t.unstable_UserBlockingPriority,cr=t.unstable_NormalPriority,wi=t.unstable_LowPriority,ks=t.unstable_IdlePriority,Ta=null,Cr=null;function Ro(i){if(Cr&&typeof Cr.onCommitFiberRoot=="function")try{Cr.onCommitFiberRoot(Ta,i,void 0,(i.current.flags&128)===128)}catch{}}var ur=Math.clz32?Math.clz32:Dk,Fk=Math.log,Ak=Math.LN2;function Dk(i){return i>>>=0,i===0?32:31-(Fk(i)/Ak|0)|0}var _u=64,Su=4194304;function Io(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Cu(i,o){var h=i.pendingLanes;if(h===0)return 0;var x=0,w=i.suspendedLanes,j=i.pingedLanes,L=h&268435455;if(L!==0){var q=L&~w;q!==0?x=Io(q):(j&=L,j!==0&&(x=Io(j)))}else L=h&~w,L!==0?x=Io(L):j!==0&&(x=Io(j));if(x===0)return 0;if(o!==0&&o!==x&&(o&w)===0&&(w=x&-x,j=o&-o,w>=j||w===16&&(j&4194240)!==0))return o;if((x&4)!==0&&(x|=h&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=x;0<o;)h=31-ur(o),w=1<<h,x|=i[h],o&=~w;return x}function Pk(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Lk(i,o){for(var h=i.suspendedLanes,x=i.pingedLanes,w=i.expirationTimes,j=i.pendingLanes;0<j;){var L=31-ur(j),q=1<<L,re=w[L];re===-1?((q&h)===0||(q&x)!==0)&&(w[L]=Pk(q,o)):re<=o&&(i.expiredLanes|=q),j&=~q}}function Qh(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Tm(){var i=_u;return _u<<=1,(_u&4194240)===0&&(_u=64),i}function Yh(i){for(var o=[],h=0;31>h;h++)o.push(i);return o}function Mo(i,o,h){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-ur(o),i[o]=h}function Ok(i,o){var h=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var x=i.eventTimes;for(i=i.expirationTimes;0<h;){var w=31-ur(h),j=1<<w;o[w]=0,x[w]=-1,i[w]=-1,h&=~j}}function Jh(i,o){var h=i.entangledLanes|=o;for(i=i.entanglements;h;){var x=31-ur(h),w=1<<x;w&o|i[x]&o&&(i[x]|=o),h&=~w}}var Et=0;function jm(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var _m,Zh,Sm,Cm,Em,ed=!1,Eu=[],Ts=null,js=null,_s=null,Bo=new Map,Ho=new Map,Ss=[],Rk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fm(i,o){switch(i){case"focusin":case"focusout":Ts=null;break;case"dragenter":case"dragleave":js=null;break;case"mouseover":case"mouseout":_s=null;break;case"pointerover":case"pointerout":Bo.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ho.delete(o.pointerId)}}function Uo(i,o,h,x,w,j){return i===null||i.nativeEvent!==j?(i={blockedOn:o,domEventName:h,eventSystemFlags:x,nativeEvent:j,targetContainers:[w]},o!==null&&(o=tc(o),o!==null&&Zh(o)),i):(i.eventSystemFlags|=x,o=i.targetContainers,w!==null&&o.indexOf(w)===-1&&o.push(w),i)}function Ik(i,o,h,x,w){switch(o){case"focusin":return Ts=Uo(Ts,i,o,h,x,w),!0;case"dragenter":return js=Uo(js,i,o,h,x,w),!0;case"mouseover":return _s=Uo(_s,i,o,h,x,w),!0;case"pointerover":var j=w.pointerId;return Bo.set(j,Uo(Bo.get(j)||null,i,o,h,x,w)),!0;case"gotpointercapture":return j=w.pointerId,Ho.set(j,Uo(Ho.get(j)||null,i,o,h,x,w)),!0}return!1}function Am(i){var o=Ni(i.target);if(o!==null){var h=W(o);if(h!==null){if(o=h.tag,o===13){if(o=ue(h),o!==null){i.blockedOn=o,Em(i.priority,function(){Sm(h)});return}}else if(o===3&&h.stateNode.current.memoizedState.isDehydrated){i.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Fu(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var h=rd(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(h===null){h=i.nativeEvent;var x=new h.constructor(h.type,h);ka=x,h.target.dispatchEvent(x),ka=null}else return o=tc(h),o!==null&&Zh(o),i.blockedOn=h,!1;o.shift()}return!0}function Dm(i,o,h){Fu(i)&&h.delete(o)}function Mk(){ed=!1,Ts!==null&&Fu(Ts)&&(Ts=null),js!==null&&Fu(js)&&(js=null),_s!==null&&Fu(_s)&&(_s=null),Bo.forEach(Dm),Ho.forEach(Dm)}function Vo(i,o){i.blockedOn===o&&(i.blockedOn=null,ed||(ed=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Mk)))}function zo(i){function o(w){return Vo(w,i)}if(0<Eu.length){Vo(Eu[0],i);for(var h=1;h<Eu.length;h++){var x=Eu[h];x.blockedOn===i&&(x.blockedOn=null)}}for(Ts!==null&&Vo(Ts,i),js!==null&&Vo(js,i),_s!==null&&Vo(_s,i),Bo.forEach(o),Ho.forEach(o),h=0;h<Ss.length;h++)x=Ss[h],x.blockedOn===i&&(x.blockedOn=null);for(;0<Ss.length&&(h=Ss[0],h.blockedOn===null);)Am(h),h.blockedOn===null&&Ss.shift()}var bl=E.ReactCurrentBatchConfig,Au=!0;function Bk(i,o,h,x){var w=Et,j=bl.transition;bl.transition=null;try{Et=1,td(i,o,h,x)}finally{Et=w,bl.transition=j}}function Hk(i,o,h,x){var w=Et,j=bl.transition;bl.transition=null;try{Et=4,td(i,o,h,x)}finally{Et=w,bl.transition=j}}function td(i,o,h,x){if(Au){var w=rd(i,o,h,x);if(w===null)yd(i,o,x,Du,h),Fm(i,x);else if(Ik(w,i,o,h,x))x.stopPropagation();else if(Fm(i,x),o&4&&-1<Rk.indexOf(i)){for(;w!==null;){var j=tc(w);if(j!==null&&_m(j),j=rd(i,o,h,x),j===null&&yd(i,o,x,Du,h),j===w)break;w=j}w!==null&&x.stopPropagation()}else yd(i,o,x,null,h)}}var Du=null;function rd(i,o,h,x){if(Du=null,i=bs(x),i=Ni(i),i!==null)if(o=W(i),o===null)i=null;else if(h=o.tag,h===13){if(i=ue(o),i!==null)return i;i=null}else if(h===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return Du=i,null}function Pm(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(lt()){case Rt:return 1;case Ut:return 4;case cr:case wi:return 16;case ks:return 536870912;default:return 16}default:return 16}}var Cs=null,nd=null,Pu=null;function Lm(){if(Pu)return Pu;var i,o=nd,h=o.length,x,w="value"in Cs?Cs.value:Cs.textContent,j=w.length;for(i=0;i<h&&o[i]===w[i];i++);var L=h-i;for(x=1;x<=L&&o[h-x]===w[j-x];x++);return Pu=w.slice(i,1<x?1-x:void 0)}function Lu(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function Ou(){return!0}function Om(){return!1}function En(i){function o(h,x,w,j,L){this._reactName=h,this._targetInst=w,this.type=x,this.nativeEvent=j,this.target=L,this.currentTarget=null;for(var q in i)i.hasOwnProperty(q)&&(h=i[q],this[q]=h?h(j):j[q]);return this.isDefaultPrevented=(j.defaultPrevented!=null?j.defaultPrevented:j.returnValue===!1)?Ou:Om,this.isPropagationStopped=Om,this}return ve(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Ou)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Ou)},persist:function(){},isPersistent:Ou}),o}var wl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ad=En(wl),Ko=ve({},wl,{view:0,detail:0}),Uk=En(Ko),sd,id,$o,Ru=ve({},Ko,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:od,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==$o&&($o&&i.type==="mousemove"?(sd=i.screenX-$o.screenX,id=i.screenY-$o.screenY):id=sd=0,$o=i),sd)},movementY:function(i){return"movementY"in i?i.movementY:id}}),Rm=En(Ru),Vk=ve({},Ru,{dataTransfer:0}),zk=En(Vk),Kk=ve({},Ko,{relatedTarget:0}),ld=En(Kk),$k=ve({},wl,{animationName:0,elapsedTime:0,pseudoElement:0}),Wk=En($k),Gk=ve({},wl,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),qk=En(Gk),Xk=ve({},wl,{data:0}),Im=En(Xk),Qk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Yk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zk(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=Jk[i])?!!o[i]:!1}function od(){return Zk}var eT=ve({},Ko,{key:function(i){if(i.key){var o=Qk[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Lu(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Yk[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:od,charCode:function(i){return i.type==="keypress"?Lu(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Lu(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),tT=En(eT),rT=ve({},Ru,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Mm=En(rT),nT=ve({},Ko,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:od}),aT=En(nT),sT=ve({},wl,{propertyName:0,elapsedTime:0,pseudoElement:0}),iT=En(sT),lT=ve({},Ru,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),oT=En(lT),cT=[9,13,27,32],cd=u&&"CompositionEvent"in window,Wo=null;u&&"documentMode"in document&&(Wo=document.documentMode);var uT=u&&"TextEvent"in window&&!Wo,Bm=u&&(!cd||Wo&&8<Wo&&11>=Wo),Hm=" ",Um=!1;function Vm(i,o){switch(i){case"keyup":return cT.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zm(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Nl=!1;function hT(i,o){switch(i){case"compositionend":return zm(o);case"keypress":return o.which!==32?null:(Um=!0,Hm);case"textInput":return i=o.data,i===Hm&&Um?null:i;default:return null}}function dT(i,o){if(Nl)return i==="compositionend"||!cd&&Vm(i,o)?(i=Lm(),Pu=nd=Cs=null,Nl=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Bm&&o.locale!=="ko"?null:o.data;default:return null}}var fT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Km(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!fT[i.type]:o==="textarea"}function $m(i,o,h,x){wu(x),o=Uu(o,"onChange"),0<o.length&&(h=new ad("onChange","change",null,h,x),i.push({event:h,listeners:o}))}var Go=null,qo=null;function pT(i){cg(i,0)}function Iu(i){var o=Sl(i);if(G(o))return i}function xT(i,o){if(i==="change")return o}var Wm=!1;if(u){var ud;if(u){var hd="oninput"in document;if(!hd){var Gm=document.createElement("div");Gm.setAttribute("oninput","return;"),hd=typeof Gm.oninput=="function"}ud=hd}else ud=!1;Wm=ud&&(!document.documentMode||9<document.documentMode)}function qm(){Go&&(Go.detachEvent("onpropertychange",Xm),qo=Go=null)}function Xm(i){if(i.propertyName==="value"&&Iu(qo)){var o=[];$m(o,qo,i,bs(i)),ju(pT,o)}}function mT(i,o,h){i==="focusin"?(qm(),Go=o,qo=h,Go.attachEvent("onpropertychange",Xm)):i==="focusout"&&qm()}function gT(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Iu(qo)}function vT(i,o){if(i==="click")return Iu(o)}function yT(i,o){if(i==="input"||i==="change")return Iu(o)}function bT(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var ia=typeof Object.is=="function"?Object.is:bT;function Xo(i,o){if(ia(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var h=Object.keys(i),x=Object.keys(o);if(h.length!==x.length)return!1;for(x=0;x<h.length;x++){var w=h[x];if(!d.call(o,w)||!ia(i[w],o[w]))return!1}return!0}function Qm(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Ym(i,o){var h=Qm(i);i=0;for(var x;h;){if(h.nodeType===3){if(x=i+h.textContent.length,i<=o&&x>=o)return{node:h,offset:o-i};i=x}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Qm(h)}}function Jm(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?Jm(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Zm(){for(var i=window,o=Ne();o instanceof i.HTMLIFrameElement;){try{var h=typeof o.contentWindow.location.href=="string"}catch{h=!1}if(h)i=o.contentWindow;else break;o=Ne(i.document)}return o}function dd(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function wT(i){var o=Zm(),h=i.focusedElem,x=i.selectionRange;if(o!==h&&h&&h.ownerDocument&&Jm(h.ownerDocument.documentElement,h)){if(x!==null&&dd(h)){if(o=x.start,i=x.end,i===void 0&&(i=o),"selectionStart"in h)h.selectionStart=o,h.selectionEnd=Math.min(i,h.value.length);else if(i=(o=h.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var w=h.textContent.length,j=Math.min(x.start,w);x=x.end===void 0?j:Math.min(x.end,w),!i.extend&&j>x&&(w=x,x=j,j=w),w=Ym(h,j);var L=Ym(h,x);w&&L&&(i.rangeCount!==1||i.anchorNode!==w.node||i.anchorOffset!==w.offset||i.focusNode!==L.node||i.focusOffset!==L.offset)&&(o=o.createRange(),o.setStart(w.node,w.offset),i.removeAllRanges(),j>x?(i.addRange(o),i.extend(L.node,L.offset)):(o.setEnd(L.node,L.offset),i.addRange(o)))}}for(o=[],i=h;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<o.length;h++)i=o[h],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var NT=u&&"documentMode"in document&&11>=document.documentMode,kl=null,fd=null,Qo=null,pd=!1;function eg(i,o,h){var x=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;pd||kl==null||kl!==Ne(x)||(x=kl,"selectionStart"in x&&dd(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Qo&&Xo(Qo,x)||(Qo=x,x=Uu(fd,"onSelect"),0<x.length&&(o=new ad("onSelect","select",null,o,h),i.push({event:o,listeners:x}),o.target=kl)))}function Mu(i,o){var h={};return h[i.toLowerCase()]=o.toLowerCase(),h["Webkit"+i]="webkit"+o,h["Moz"+i]="moz"+o,h}var Tl={animationend:Mu("Animation","AnimationEnd"),animationiteration:Mu("Animation","AnimationIteration"),animationstart:Mu("Animation","AnimationStart"),transitionend:Mu("Transition","TransitionEnd")},xd={},tg={};u&&(tg=document.createElement("div").style,"AnimationEvent"in window||(delete Tl.animationend.animation,delete Tl.animationiteration.animation,delete Tl.animationstart.animation),"TransitionEvent"in window||delete Tl.transitionend.transition);function Bu(i){if(xd[i])return xd[i];if(!Tl[i])return i;var o=Tl[i],h;for(h in o)if(o.hasOwnProperty(h)&&h in tg)return xd[i]=o[h];return i}var rg=Bu("animationend"),ng=Bu("animationiteration"),ag=Bu("animationstart"),sg=Bu("transitionend"),ig=new Map,lg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Es(i,o){ig.set(i,o),l(o,[i])}for(var md=0;md<lg.length;md++){var gd=lg[md],kT=gd.toLowerCase(),TT=gd[0].toUpperCase()+gd.slice(1);Es(kT,"on"+TT)}Es(rg,"onAnimationEnd"),Es(ng,"onAnimationIteration"),Es(ag,"onAnimationStart"),Es("dblclick","onDoubleClick"),Es("focusin","onFocus"),Es("focusout","onBlur"),Es(sg,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jT=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yo));function og(i,o,h){var x=i.type||"unknown-event";i.currentTarget=h,z(x,o,void 0,i),i.currentTarget=null}function cg(i,o){o=(o&4)!==0;for(var h=0;h<i.length;h++){var x=i[h],w=x.event;x=x.listeners;e:{var j=void 0;if(o)for(var L=x.length-1;0<=L;L--){var q=x[L],re=q.instance,me=q.currentTarget;if(q=q.listener,re!==j&&w.isPropagationStopped())break e;og(w,q,me),j=re}else for(L=0;L<x.length;L++){if(q=x[L],re=q.instance,me=q.currentTarget,q=q.listener,re!==j&&w.isPropagationStopped())break e;og(w,q,me),j=re}}}if(R)throw i=V,R=!1,V=null,i}function zt(i,o){var h=o[jd];h===void 0&&(h=o[jd]=new Set);var x=i+"__bubble";h.has(x)||(ug(o,i,2,!1),h.add(x))}function vd(i,o,h){var x=0;o&&(x|=4),ug(h,i,x,o)}var Hu="_reactListening"+Math.random().toString(36).slice(2);function Jo(i){if(!i[Hu]){i[Hu]=!0,n.forEach(function(h){h!=="selectionchange"&&(jT.has(h)||vd(h,!1,i),vd(h,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Hu]||(o[Hu]=!0,vd("selectionchange",!1,o))}}function ug(i,o,h,x){switch(Pm(o)){case 1:var w=Bk;break;case 4:w=Hk;break;default:w=td}h=w.bind(null,o,h,i),w=void 0,!Oo||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(w=!0),x?w!==void 0?i.addEventListener(o,h,{capture:!0,passive:w}):i.addEventListener(o,h,!0):w!==void 0?i.addEventListener(o,h,{passive:w}):i.addEventListener(o,h,!1)}function yd(i,o,h,x,w){var j=x;if((o&1)===0&&(o&2)===0&&x!==null)e:for(;;){if(x===null)return;var L=x.tag;if(L===3||L===4){var q=x.stateNode.containerInfo;if(q===w||q.nodeType===8&&q.parentNode===w)break;if(L===4)for(L=x.return;L!==null;){var re=L.tag;if((re===3||re===4)&&(re=L.stateNode.containerInfo,re===w||re.nodeType===8&&re.parentNode===w))return;L=L.return}for(;q!==null;){if(L=Ni(q),L===null)return;if(re=L.tag,re===5||re===6){x=j=L;continue e}q=q.parentNode}}x=x.return}ju(function(){var me=j,Ce=bs(h),Fe=[];e:{var Se=ig.get(i);if(Se!==void 0){var Ve=ad,$e=i;switch(i){case"keypress":if(Lu(h)===0)break e;case"keydown":case"keyup":Ve=tT;break;case"focusin":$e="focus",Ve=ld;break;case"focusout":$e="blur",Ve=ld;break;case"beforeblur":case"afterblur":Ve=ld;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ve=Rm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ve=zk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ve=aT;break;case rg:case ng:case ag:Ve=Wk;break;case sg:Ve=iT;break;case"scroll":Ve=Uk;break;case"wheel":Ve=oT;break;case"copy":case"cut":case"paste":Ve=qk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ve=Mm}var We=(o&4)!==0,hr=!We&&i==="scroll",ie=We?Se!==null?Se+"Capture":null:Se;We=[];for(var se=me,oe;se!==null;){oe=se;var Pe=oe.stateNode;if(oe.tag===5&&Pe!==null&&(oe=Pe,ie!==null&&(Pe=yi(se,ie),Pe!=null&&We.push(Zo(se,Pe,oe)))),hr)break;se=se.return}0<We.length&&(Se=new Ve(Se,$e,null,h,Ce),Fe.push({event:Se,listeners:We}))}}if((o&7)===0){e:{if(Se=i==="mouseover"||i==="pointerover",Ve=i==="mouseout"||i==="pointerout",Se&&h!==ka&&($e=h.relatedTarget||h.fromElement)&&(Ni($e)||$e[Ga]))break e;if((Ve||Se)&&(Se=Ce.window===Ce?Ce:(Se=Ce.ownerDocument)?Se.defaultView||Se.parentWindow:window,Ve?($e=h.relatedTarget||h.toElement,Ve=me,$e=$e?Ni($e):null,$e!==null&&(hr=W($e),$e!==hr||$e.tag!==5&&$e.tag!==6)&&($e=null)):(Ve=null,$e=me),Ve!==$e)){if(We=Rm,Pe="onMouseLeave",ie="onMouseEnter",se="mouse",(i==="pointerout"||i==="pointerover")&&(We=Mm,Pe="onPointerLeave",ie="onPointerEnter",se="pointer"),hr=Ve==null?Se:Sl(Ve),oe=$e==null?Se:Sl($e),Se=new We(Pe,se+"leave",Ve,h,Ce),Se.target=hr,Se.relatedTarget=oe,Pe=null,Ni(Ce)===me&&(We=new We(ie,se+"enter",$e,h,Ce),We.target=oe,We.relatedTarget=hr,Pe=We),hr=Pe,Ve&&$e)t:{for(We=Ve,ie=$e,se=0,oe=We;oe;oe=jl(oe))se++;for(oe=0,Pe=ie;Pe;Pe=jl(Pe))oe++;for(;0<se-oe;)We=jl(We),se--;for(;0<oe-se;)ie=jl(ie),oe--;for(;se--;){if(We===ie||ie!==null&&We===ie.alternate)break t;We=jl(We),ie=jl(ie)}We=null}else We=null;Ve!==null&&hg(Fe,Se,Ve,We,!1),$e!==null&&hr!==null&&hg(Fe,hr,$e,We,!0)}}e:{if(Se=me?Sl(me):window,Ve=Se.nodeName&&Se.nodeName.toLowerCase(),Ve==="select"||Ve==="input"&&Se.type==="file")var qe=xT;else if(Km(Se))if(Wm)qe=yT;else{qe=gT;var Ze=mT}else(Ve=Se.nodeName)&&Ve.toLowerCase()==="input"&&(Se.type==="checkbox"||Se.type==="radio")&&(qe=vT);if(qe&&(qe=qe(i,me))){$m(Fe,qe,h,Ce);break e}Ze&&Ze(i,Se,me),i==="focusout"&&(Ze=Se._wrapperState)&&Ze.controlled&&Se.type==="number"&&lr(Se,"number",Se.value)}switch(Ze=me?Sl(me):window,i){case"focusin":(Km(Ze)||Ze.contentEditable==="true")&&(kl=Ze,fd=me,Qo=null);break;case"focusout":Qo=fd=kl=null;break;case"mousedown":pd=!0;break;case"contextmenu":case"mouseup":case"dragend":pd=!1,eg(Fe,h,Ce);break;case"selectionchange":if(NT)break;case"keydown":case"keyup":eg(Fe,h,Ce)}var et;if(cd)e:{switch(i){case"compositionstart":var it="onCompositionStart";break e;case"compositionend":it="onCompositionEnd";break e;case"compositionupdate":it="onCompositionUpdate";break e}it=void 0}else Nl?Vm(i,h)&&(it="onCompositionEnd"):i==="keydown"&&h.keyCode===229&&(it="onCompositionStart");it&&(Bm&&h.locale!=="ko"&&(Nl||it!=="onCompositionStart"?it==="onCompositionEnd"&&Nl&&(et=Lm()):(Cs=Ce,nd="value"in Cs?Cs.value:Cs.textContent,Nl=!0)),Ze=Uu(me,it),0<Ze.length&&(it=new Im(it,i,null,h,Ce),Fe.push({event:it,listeners:Ze}),et?it.data=et:(et=zm(h),et!==null&&(it.data=et)))),(et=uT?hT(i,h):dT(i,h))&&(me=Uu(me,"onBeforeInput"),0<me.length&&(Ce=new Im("onBeforeInput","beforeinput",null,h,Ce),Fe.push({event:Ce,listeners:me}),Ce.data=et))}cg(Fe,o)})}function Zo(i,o,h){return{instance:i,listener:o,currentTarget:h}}function Uu(i,o){for(var h=o+"Capture",x=[];i!==null;){var w=i,j=w.stateNode;w.tag===5&&j!==null&&(w=j,j=yi(i,h),j!=null&&x.unshift(Zo(i,j,w)),j=yi(i,o),j!=null&&x.push(Zo(i,j,w))),i=i.return}return x}function jl(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function hg(i,o,h,x,w){for(var j=o._reactName,L=[];h!==null&&h!==x;){var q=h,re=q.alternate,me=q.stateNode;if(re!==null&&re===x)break;q.tag===5&&me!==null&&(q=me,w?(re=yi(h,j),re!=null&&L.unshift(Zo(h,re,q))):w||(re=yi(h,j),re!=null&&L.push(Zo(h,re,q)))),h=h.return}L.length!==0&&i.push({event:o,listeners:L})}var _T=/\r\n?/g,ST=/\u0000|\uFFFD/g;function dg(i){return(typeof i=="string"?i:""+i).replace(_T,`
`).replace(ST,"")}function Vu(i,o,h){if(o=dg(o),dg(i)!==o&&h)throw Error(r(425))}function zu(){}var bd=null,wd=null;function Nd(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var kd=typeof setTimeout=="function"?setTimeout:void 0,CT=typeof clearTimeout=="function"?clearTimeout:void 0,fg=typeof Promise=="function"?Promise:void 0,ET=typeof queueMicrotask=="function"?queueMicrotask:typeof fg<"u"?function(i){return fg.resolve(null).then(i).catch(FT)}:kd;function FT(i){setTimeout(function(){throw i})}function Td(i,o){var h=o,x=0;do{var w=h.nextSibling;if(i.removeChild(h),w&&w.nodeType===8)if(h=w.data,h==="/$"){if(x===0){i.removeChild(w),zo(o);return}x--}else h!=="$"&&h!=="$?"&&h!=="$!"||x++;h=w}while(h);zo(o)}function Fs(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function pg(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var h=i.data;if(h==="$"||h==="$!"||h==="$?"){if(o===0)return i;o--}else h==="/$"&&o++}i=i.previousSibling}return null}var _l=Math.random().toString(36).slice(2),ja="__reactFiber$"+_l,ec="__reactProps$"+_l,Ga="__reactContainer$"+_l,jd="__reactEvents$"+_l,AT="__reactListeners$"+_l,DT="__reactHandles$"+_l;function Ni(i){var o=i[ja];if(o)return o;for(var h=i.parentNode;h;){if(o=h[Ga]||h[ja]){if(h=o.alternate,o.child!==null||h!==null&&h.child!==null)for(i=pg(i);i!==null;){if(h=i[ja])return h;i=pg(i)}return o}i=h,h=i.parentNode}return null}function tc(i){return i=i[ja]||i[Ga],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Sl(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(r(33))}function Ku(i){return i[ec]||null}var _d=[],Cl=-1;function As(i){return{current:i}}function Kt(i){0>Cl||(i.current=_d[Cl],_d[Cl]=null,Cl--)}function Vt(i,o){Cl++,_d[Cl]=i.current,i.current=o}var Ds={},Vr=As(Ds),hn=As(!1),ki=Ds;function El(i,o){var h=i.type.contextTypes;if(!h)return Ds;var x=i.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===o)return x.__reactInternalMemoizedMaskedChildContext;var w={},j;for(j in h)w[j]=o[j];return x&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=w),w}function dn(i){return i=i.childContextTypes,i!=null}function $u(){Kt(hn),Kt(Vr)}function xg(i,o,h){if(Vr.current!==Ds)throw Error(r(168));Vt(Vr,o),Vt(hn,h)}function mg(i,o,h){var x=i.stateNode;if(o=o.childContextTypes,typeof x.getChildContext!="function")return h;x=x.getChildContext();for(var w in x)if(!(w in o))throw Error(r(108,de(i)||"Unknown",w));return ve({},h,x)}function Wu(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Ds,ki=Vr.current,Vt(Vr,i),Vt(hn,hn.current),!0}function gg(i,o,h){var x=i.stateNode;if(!x)throw Error(r(169));h?(i=mg(i,o,ki),x.__reactInternalMemoizedMergedChildContext=i,Kt(hn),Kt(Vr),Vt(Vr,i)):Kt(hn),Vt(hn,h)}var qa=null,Gu=!1,Sd=!1;function vg(i){qa===null?qa=[i]:qa.push(i)}function PT(i){Gu=!0,vg(i)}function Ps(){if(!Sd&&qa!==null){Sd=!0;var i=0,o=Et;try{var h=qa;for(Et=1;i<h.length;i++){var x=h[i];do x=x(!0);while(x!==null)}qa=null,Gu=!1}catch(w){throw qa!==null&&(qa=qa.slice(i+1)),Ee(Rt,Ps),w}finally{Et=o,Sd=!1}}return null}var Fl=[],Al=0,qu=null,Xu=0,Hn=[],Un=0,Ti=null,Xa=1,Qa="";function ji(i,o){Fl[Al++]=Xu,Fl[Al++]=qu,qu=i,Xu=o}function yg(i,o,h){Hn[Un++]=Xa,Hn[Un++]=Qa,Hn[Un++]=Ti,Ti=i;var x=Xa;i=Qa;var w=32-ur(x)-1;x&=~(1<<w),h+=1;var j=32-ur(o)+w;if(30<j){var L=w-w%5;j=(x&(1<<L)-1).toString(32),x>>=L,w-=L,Xa=1<<32-ur(o)+w|h<<w|x,Qa=j+i}else Xa=1<<j|h<<w|x,Qa=i}function Cd(i){i.return!==null&&(ji(i,1),yg(i,1,0))}function Ed(i){for(;i===qu;)qu=Fl[--Al],Fl[Al]=null,Xu=Fl[--Al],Fl[Al]=null;for(;i===Ti;)Ti=Hn[--Un],Hn[Un]=null,Qa=Hn[--Un],Hn[Un]=null,Xa=Hn[--Un],Hn[Un]=null}var Fn=null,An=null,qt=!1,la=null;function bg(i,o){var h=$n(5,null,null,0);h.elementType="DELETED",h.stateNode=o,h.return=i,o=i.deletions,o===null?(i.deletions=[h],i.flags|=16):o.push(h)}function wg(i,o){switch(i.tag){case 5:var h=i.type;return o=o.nodeType!==1||h.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,Fn=i,An=Fs(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,Fn=i,An=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(h=Ti!==null?{id:Xa,overflow:Qa}:null,i.memoizedState={dehydrated:o,treeContext:h,retryLane:1073741824},h=$n(18,null,null,0),h.stateNode=o,h.return=i,i.child=h,Fn=i,An=null,!0):!1;default:return!1}}function Fd(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Ad(i){if(qt){var o=An;if(o){var h=o;if(!wg(i,o)){if(Fd(i))throw Error(r(418));o=Fs(h.nextSibling);var x=Fn;o&&wg(i,o)?bg(x,h):(i.flags=i.flags&-4097|2,qt=!1,Fn=i)}}else{if(Fd(i))throw Error(r(418));i.flags=i.flags&-4097|2,qt=!1,Fn=i}}}function Ng(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Fn=i}function Qu(i){if(i!==Fn)return!1;if(!qt)return Ng(i),qt=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!Nd(i.type,i.memoizedProps)),o&&(o=An)){if(Fd(i))throw kg(),Error(r(418));for(;o;)bg(i,o),o=Fs(o.nextSibling)}if(Ng(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var h=i.data;if(h==="/$"){if(o===0){An=Fs(i.nextSibling);break e}o--}else h!=="$"&&h!=="$!"&&h!=="$?"||o++}i=i.nextSibling}An=null}}else An=Fn?Fs(i.stateNode.nextSibling):null;return!0}function kg(){for(var i=An;i;)i=Fs(i.nextSibling)}function Dl(){An=Fn=null,qt=!1}function Dd(i){la===null?la=[i]:la.push(i)}var LT=E.ReactCurrentBatchConfig;function rc(i,o,h){if(i=h.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(r(309));var x=h.stateNode}if(!x)throw Error(r(147,i));var w=x,j=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===j?o.ref:(o=function(L){var q=w.refs;L===null?delete q[j]:q[j]=L},o._stringRef=j,o)}if(typeof i!="string")throw Error(r(284));if(!h._owner)throw Error(r(290,i))}return i}function Yu(i,o){throw i=Object.prototype.toString.call(o),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function Tg(i){var o=i._init;return o(i._payload)}function jg(i){function o(ie,se){if(i){var oe=ie.deletions;oe===null?(ie.deletions=[se],ie.flags|=16):oe.push(se)}}function h(ie,se){if(!i)return null;for(;se!==null;)o(ie,se),se=se.sibling;return null}function x(ie,se){for(ie=new Map;se!==null;)se.key!==null?ie.set(se.key,se):ie.set(se.index,se),se=se.sibling;return ie}function w(ie,se){return ie=Us(ie,se),ie.index=0,ie.sibling=null,ie}function j(ie,se,oe){return ie.index=oe,i?(oe=ie.alternate,oe!==null?(oe=oe.index,oe<se?(ie.flags|=2,se):oe):(ie.flags|=2,se)):(ie.flags|=1048576,se)}function L(ie){return i&&ie.alternate===null&&(ie.flags|=2),ie}function q(ie,se,oe,Pe){return se===null||se.tag!==6?(se=Tf(oe,ie.mode,Pe),se.return=ie,se):(se=w(se,oe),se.return=ie,se)}function re(ie,se,oe,Pe){var qe=oe.type;return qe===T?Ce(ie,se,oe.props.children,Pe,oe.key):se!==null&&(se.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===xe&&Tg(qe)===se.type)?(Pe=w(se,oe.props),Pe.ref=rc(ie,se,oe),Pe.return=ie,Pe):(Pe=w0(oe.type,oe.key,oe.props,null,ie.mode,Pe),Pe.ref=rc(ie,se,oe),Pe.return=ie,Pe)}function me(ie,se,oe,Pe){return se===null||se.tag!==4||se.stateNode.containerInfo!==oe.containerInfo||se.stateNode.implementation!==oe.implementation?(se=jf(oe,ie.mode,Pe),se.return=ie,se):(se=w(se,oe.children||[]),se.return=ie,se)}function Ce(ie,se,oe,Pe,qe){return se===null||se.tag!==7?(se=Pi(oe,ie.mode,Pe,qe),se.return=ie,se):(se=w(se,oe),se.return=ie,se)}function Fe(ie,se,oe){if(typeof se=="string"&&se!==""||typeof se=="number")return se=Tf(""+se,ie.mode,oe),se.return=ie,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case O:return oe=w0(se.type,se.key,se.props,null,ie.mode,oe),oe.ref=rc(ie,null,se),oe.return=ie,oe;case F:return se=jf(se,ie.mode,oe),se.return=ie,se;case xe:var Pe=se._init;return Fe(ie,Pe(se._payload),oe)}if(or(se)||X(se))return se=Pi(se,ie.mode,oe,null),se.return=ie,se;Yu(ie,se)}return null}function Se(ie,se,oe,Pe){var qe=se!==null?se.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number")return qe!==null?null:q(ie,se,""+oe,Pe);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case O:return oe.key===qe?re(ie,se,oe,Pe):null;case F:return oe.key===qe?me(ie,se,oe,Pe):null;case xe:return qe=oe._init,Se(ie,se,qe(oe._payload),Pe)}if(or(oe)||X(oe))return qe!==null?null:Ce(ie,se,oe,Pe,null);Yu(ie,oe)}return null}function Ve(ie,se,oe,Pe,qe){if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number")return ie=ie.get(oe)||null,q(se,ie,""+Pe,qe);if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case O:return ie=ie.get(Pe.key===null?oe:Pe.key)||null,re(se,ie,Pe,qe);case F:return ie=ie.get(Pe.key===null?oe:Pe.key)||null,me(se,ie,Pe,qe);case xe:var Ze=Pe._init;return Ve(ie,se,oe,Ze(Pe._payload),qe)}if(or(Pe)||X(Pe))return ie=ie.get(oe)||null,Ce(se,ie,Pe,qe,null);Yu(se,Pe)}return null}function $e(ie,se,oe,Pe){for(var qe=null,Ze=null,et=se,it=se=0,Ar=null;et!==null&&it<oe.length;it++){et.index>it?(Ar=et,et=null):Ar=et.sibling;var jt=Se(ie,et,oe[it],Pe);if(jt===null){et===null&&(et=Ar);break}i&&et&&jt.alternate===null&&o(ie,et),se=j(jt,se,it),Ze===null?qe=jt:Ze.sibling=jt,Ze=jt,et=Ar}if(it===oe.length)return h(ie,et),qt&&ji(ie,it),qe;if(et===null){for(;it<oe.length;it++)et=Fe(ie,oe[it],Pe),et!==null&&(se=j(et,se,it),Ze===null?qe=et:Ze.sibling=et,Ze=et);return qt&&ji(ie,it),qe}for(et=x(ie,et);it<oe.length;it++)Ar=Ve(et,ie,it,oe[it],Pe),Ar!==null&&(i&&Ar.alternate!==null&&et.delete(Ar.key===null?it:Ar.key),se=j(Ar,se,it),Ze===null?qe=Ar:Ze.sibling=Ar,Ze=Ar);return i&&et.forEach(function(Vs){return o(ie,Vs)}),qt&&ji(ie,it),qe}function We(ie,se,oe,Pe){var qe=X(oe);if(typeof qe!="function")throw Error(r(150));if(oe=qe.call(oe),oe==null)throw Error(r(151));for(var Ze=qe=null,et=se,it=se=0,Ar=null,jt=oe.next();et!==null&&!jt.done;it++,jt=oe.next()){et.index>it?(Ar=et,et=null):Ar=et.sibling;var Vs=Se(ie,et,jt.value,Pe);if(Vs===null){et===null&&(et=Ar);break}i&&et&&Vs.alternate===null&&o(ie,et),se=j(Vs,se,it),Ze===null?qe=Vs:Ze.sibling=Vs,Ze=Vs,et=Ar}if(jt.done)return h(ie,et),qt&&ji(ie,it),qe;if(et===null){for(;!jt.done;it++,jt=oe.next())jt=Fe(ie,jt.value,Pe),jt!==null&&(se=j(jt,se,it),Ze===null?qe=jt:Ze.sibling=jt,Ze=jt);return qt&&ji(ie,it),qe}for(et=x(ie,et);!jt.done;it++,jt=oe.next())jt=Ve(et,ie,it,jt.value,Pe),jt!==null&&(i&&jt.alternate!==null&&et.delete(jt.key===null?it:jt.key),se=j(jt,se,it),Ze===null?qe=jt:Ze.sibling=jt,Ze=jt);return i&&et.forEach(function(fj){return o(ie,fj)}),qt&&ji(ie,it),qe}function hr(ie,se,oe,Pe){if(typeof oe=="object"&&oe!==null&&oe.type===T&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case O:e:{for(var qe=oe.key,Ze=se;Ze!==null;){if(Ze.key===qe){if(qe=oe.type,qe===T){if(Ze.tag===7){h(ie,Ze.sibling),se=w(Ze,oe.props.children),se.return=ie,ie=se;break e}}else if(Ze.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===xe&&Tg(qe)===Ze.type){h(ie,Ze.sibling),se=w(Ze,oe.props),se.ref=rc(ie,Ze,oe),se.return=ie,ie=se;break e}h(ie,Ze);break}else o(ie,Ze);Ze=Ze.sibling}oe.type===T?(se=Pi(oe.props.children,ie.mode,Pe,oe.key),se.return=ie,ie=se):(Pe=w0(oe.type,oe.key,oe.props,null,ie.mode,Pe),Pe.ref=rc(ie,se,oe),Pe.return=ie,ie=Pe)}return L(ie);case F:e:{for(Ze=oe.key;se!==null;){if(se.key===Ze)if(se.tag===4&&se.stateNode.containerInfo===oe.containerInfo&&se.stateNode.implementation===oe.implementation){h(ie,se.sibling),se=w(se,oe.children||[]),se.return=ie,ie=se;break e}else{h(ie,se);break}else o(ie,se);se=se.sibling}se=jf(oe,ie.mode,Pe),se.return=ie,ie=se}return L(ie);case xe:return Ze=oe._init,hr(ie,se,Ze(oe._payload),Pe)}if(or(oe))return $e(ie,se,oe,Pe);if(X(oe))return We(ie,se,oe,Pe);Yu(ie,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"?(oe=""+oe,se!==null&&se.tag===6?(h(ie,se.sibling),se=w(se,oe),se.return=ie,ie=se):(h(ie,se),se=Tf(oe,ie.mode,Pe),se.return=ie,ie=se),L(ie)):h(ie,se)}return hr}var Pl=jg(!0),_g=jg(!1),Ju=As(null),Zu=null,Ll=null,Pd=null;function Ld(){Pd=Ll=Zu=null}function Od(i){var o=Ju.current;Kt(Ju),i._currentValue=o}function Rd(i,o,h){for(;i!==null;){var x=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,x!==null&&(x.childLanes|=o)):x!==null&&(x.childLanes&o)!==o&&(x.childLanes|=o),i===h)break;i=i.return}}function Ol(i,o){Zu=i,Pd=Ll=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(fn=!0),i.firstContext=null)}function Vn(i){var o=i._currentValue;if(Pd!==i)if(i={context:i,memoizedValue:o,next:null},Ll===null){if(Zu===null)throw Error(r(308));Ll=i,Zu.dependencies={lanes:0,firstContext:i}}else Ll=Ll.next=i;return o}var _i=null;function Id(i){_i===null?_i=[i]:_i.push(i)}function Sg(i,o,h,x){var w=o.interleaved;return w===null?(h.next=h,Id(o)):(h.next=w.next,w.next=h),o.interleaved=h,Ya(i,x)}function Ya(i,o){i.lanes|=o;var h=i.alternate;for(h!==null&&(h.lanes|=o),h=i,i=i.return;i!==null;)i.childLanes|=o,h=i.alternate,h!==null&&(h.childLanes|=o),h=i,i=i.return;return h.tag===3?h.stateNode:null}var Ls=!1;function Md(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Cg(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Ja(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function Os(i,o,h){var x=i.updateQueue;if(x===null)return null;if(x=x.shared,(wt&2)!==0){var w=x.pending;return w===null?o.next=o:(o.next=w.next,w.next=o),x.pending=o,Ya(i,h)}return w=x.interleaved,w===null?(o.next=o,Id(x)):(o.next=w.next,w.next=o),x.interleaved=o,Ya(i,h)}function e0(i,o,h){if(o=o.updateQueue,o!==null&&(o=o.shared,(h&4194240)!==0)){var x=o.lanes;x&=i.pendingLanes,h|=x,o.lanes=h,Jh(i,h)}}function Eg(i,o){var h=i.updateQueue,x=i.alternate;if(x!==null&&(x=x.updateQueue,h===x)){var w=null,j=null;if(h=h.firstBaseUpdate,h!==null){do{var L={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};j===null?w=j=L:j=j.next=L,h=h.next}while(h!==null);j===null?w=j=o:j=j.next=o}else w=j=o;h={baseState:x.baseState,firstBaseUpdate:w,lastBaseUpdate:j,shared:x.shared,effects:x.effects},i.updateQueue=h;return}i=h.lastBaseUpdate,i===null?h.firstBaseUpdate=o:i.next=o,h.lastBaseUpdate=o}function t0(i,o,h,x){var w=i.updateQueue;Ls=!1;var j=w.firstBaseUpdate,L=w.lastBaseUpdate,q=w.shared.pending;if(q!==null){w.shared.pending=null;var re=q,me=re.next;re.next=null,L===null?j=me:L.next=me,L=re;var Ce=i.alternate;Ce!==null&&(Ce=Ce.updateQueue,q=Ce.lastBaseUpdate,q!==L&&(q===null?Ce.firstBaseUpdate=me:q.next=me,Ce.lastBaseUpdate=re))}if(j!==null){var Fe=w.baseState;L=0,Ce=me=re=null,q=j;do{var Se=q.lane,Ve=q.eventTime;if((x&Se)===Se){Ce!==null&&(Ce=Ce.next={eventTime:Ve,lane:0,tag:q.tag,payload:q.payload,callback:q.callback,next:null});e:{var $e=i,We=q;switch(Se=o,Ve=h,We.tag){case 1:if($e=We.payload,typeof $e=="function"){Fe=$e.call(Ve,Fe,Se);break e}Fe=$e;break e;case 3:$e.flags=$e.flags&-65537|128;case 0:if($e=We.payload,Se=typeof $e=="function"?$e.call(Ve,Fe,Se):$e,Se==null)break e;Fe=ve({},Fe,Se);break e;case 2:Ls=!0}}q.callback!==null&&q.lane!==0&&(i.flags|=64,Se=w.effects,Se===null?w.effects=[q]:Se.push(q))}else Ve={eventTime:Ve,lane:Se,tag:q.tag,payload:q.payload,callback:q.callback,next:null},Ce===null?(me=Ce=Ve,re=Fe):Ce=Ce.next=Ve,L|=Se;if(q=q.next,q===null){if(q=w.shared.pending,q===null)break;Se=q,q=Se.next,Se.next=null,w.lastBaseUpdate=Se,w.shared.pending=null}}while(!0);if(Ce===null&&(re=Fe),w.baseState=re,w.firstBaseUpdate=me,w.lastBaseUpdate=Ce,o=w.shared.interleaved,o!==null){w=o;do L|=w.lane,w=w.next;while(w!==o)}else j===null&&(w.shared.lanes=0);Ei|=L,i.lanes=L,i.memoizedState=Fe}}function Fg(i,o,h){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var x=i[o],w=x.callback;if(w!==null){if(x.callback=null,x=h,typeof w!="function")throw Error(r(191,w));w.call(x)}}}var nc={},_a=As(nc),ac=As(nc),sc=As(nc);function Si(i){if(i===nc)throw Error(r(174));return i}function Bd(i,o){switch(Vt(sc,o),Vt(ac,i),Vt(_a,nc),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:Lt(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=Lt(o,i)}Kt(_a),Vt(_a,o)}function Rl(){Kt(_a),Kt(ac),Kt(sc)}function Ag(i){Si(sc.current);var o=Si(_a.current),h=Lt(o,i.type);o!==h&&(Vt(ac,i),Vt(_a,h))}function Hd(i){ac.current===i&&(Kt(_a),Kt(ac))}var Qt=As(0);function r0(i){for(var o=i;o!==null;){if(o.tag===13){var h=o.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Ud=[];function Vd(){for(var i=0;i<Ud.length;i++)Ud[i]._workInProgressVersionPrimary=null;Ud.length=0}var n0=E.ReactCurrentDispatcher,zd=E.ReactCurrentBatchConfig,Ci=0,Yt=null,wr=null,Er=null,a0=!1,ic=!1,lc=0,OT=0;function zr(){throw Error(r(321))}function Kd(i,o){if(o===null)return!1;for(var h=0;h<o.length&&h<i.length;h++)if(!ia(i[h],o[h]))return!1;return!0}function $d(i,o,h,x,w,j){if(Ci=j,Yt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,n0.current=i===null||i.memoizedState===null?BT:HT,i=h(x,w),ic){j=0;do{if(ic=!1,lc=0,25<=j)throw Error(r(301));j+=1,Er=wr=null,o.updateQueue=null,n0.current=UT,i=h(x,w)}while(ic)}if(n0.current=l0,o=wr!==null&&wr.next!==null,Ci=0,Er=wr=Yt=null,a0=!1,o)throw Error(r(300));return i}function Wd(){var i=lc!==0;return lc=0,i}function Sa(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Er===null?Yt.memoizedState=Er=i:Er=Er.next=i,Er}function zn(){if(wr===null){var i=Yt.alternate;i=i!==null?i.memoizedState:null}else i=wr.next;var o=Er===null?Yt.memoizedState:Er.next;if(o!==null)Er=o,wr=i;else{if(i===null)throw Error(r(310));wr=i,i={memoizedState:wr.memoizedState,baseState:wr.baseState,baseQueue:wr.baseQueue,queue:wr.queue,next:null},Er===null?Yt.memoizedState=Er=i:Er=Er.next=i}return Er}function oc(i,o){return typeof o=="function"?o(i):o}function Gd(i){var o=zn(),h=o.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=i;var x=wr,w=x.baseQueue,j=h.pending;if(j!==null){if(w!==null){var L=w.next;w.next=j.next,j.next=L}x.baseQueue=w=j,h.pending=null}if(w!==null){j=w.next,x=x.baseState;var q=L=null,re=null,me=j;do{var Ce=me.lane;if((Ci&Ce)===Ce)re!==null&&(re=re.next={lane:0,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null}),x=me.hasEagerState?me.eagerState:i(x,me.action);else{var Fe={lane:Ce,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null};re===null?(q=re=Fe,L=x):re=re.next=Fe,Yt.lanes|=Ce,Ei|=Ce}me=me.next}while(me!==null&&me!==j);re===null?L=x:re.next=q,ia(x,o.memoizedState)||(fn=!0),o.memoizedState=x,o.baseState=L,o.baseQueue=re,h.lastRenderedState=x}if(i=h.interleaved,i!==null){w=i;do j=w.lane,Yt.lanes|=j,Ei|=j,w=w.next;while(w!==i)}else w===null&&(h.lanes=0);return[o.memoizedState,h.dispatch]}function qd(i){var o=zn(),h=o.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=i;var x=h.dispatch,w=h.pending,j=o.memoizedState;if(w!==null){h.pending=null;var L=w=w.next;do j=i(j,L.action),L=L.next;while(L!==w);ia(j,o.memoizedState)||(fn=!0),o.memoizedState=j,o.baseQueue===null&&(o.baseState=j),h.lastRenderedState=j}return[j,x]}function Dg(){}function Pg(i,o){var h=Yt,x=zn(),w=o(),j=!ia(x.memoizedState,w);if(j&&(x.memoizedState=w,fn=!0),x=x.queue,Xd(Rg.bind(null,h,x,i),[i]),x.getSnapshot!==o||j||Er!==null&&Er.memoizedState.tag&1){if(h.flags|=2048,cc(9,Og.bind(null,h,x,w,o),void 0,null),Fr===null)throw Error(r(349));(Ci&30)!==0||Lg(h,o,w)}return w}function Lg(i,o,h){i.flags|=16384,i={getSnapshot:o,value:h},o=Yt.updateQueue,o===null?(o={lastEffect:null,stores:null},Yt.updateQueue=o,o.stores=[i]):(h=o.stores,h===null?o.stores=[i]:h.push(i))}function Og(i,o,h,x){o.value=h,o.getSnapshot=x,Ig(o)&&Mg(i)}function Rg(i,o,h){return h(function(){Ig(o)&&Mg(i)})}function Ig(i){var o=i.getSnapshot;i=i.value;try{var h=o();return!ia(i,h)}catch{return!0}}function Mg(i){var o=Ya(i,1);o!==null&&ha(o,i,1,-1)}function Bg(i){var o=Sa();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:oc,lastRenderedState:i},o.queue=i,i=i.dispatch=MT.bind(null,Yt,i),[o.memoizedState,i]}function cc(i,o,h,x){return i={tag:i,create:o,destroy:h,deps:x,next:null},o=Yt.updateQueue,o===null?(o={lastEffect:null,stores:null},Yt.updateQueue=o,o.lastEffect=i.next=i):(h=o.lastEffect,h===null?o.lastEffect=i.next=i:(x=h.next,h.next=i,i.next=x,o.lastEffect=i)),i}function Hg(){return zn().memoizedState}function s0(i,o,h,x){var w=Sa();Yt.flags|=i,w.memoizedState=cc(1|o,h,void 0,x===void 0?null:x)}function i0(i,o,h,x){var w=zn();x=x===void 0?null:x;var j=void 0;if(wr!==null){var L=wr.memoizedState;if(j=L.destroy,x!==null&&Kd(x,L.deps)){w.memoizedState=cc(o,h,j,x);return}}Yt.flags|=i,w.memoizedState=cc(1|o,h,j,x)}function Ug(i,o){return s0(8390656,8,i,o)}function Xd(i,o){return i0(2048,8,i,o)}function Vg(i,o){return i0(4,2,i,o)}function zg(i,o){return i0(4,4,i,o)}function Kg(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function $g(i,o,h){return h=h!=null?h.concat([i]):null,i0(4,4,Kg.bind(null,o,i),h)}function Qd(){}function Wg(i,o){var h=zn();o=o===void 0?null:o;var x=h.memoizedState;return x!==null&&o!==null&&Kd(o,x[1])?x[0]:(h.memoizedState=[i,o],i)}function Gg(i,o){var h=zn();o=o===void 0?null:o;var x=h.memoizedState;return x!==null&&o!==null&&Kd(o,x[1])?x[0]:(i=i(),h.memoizedState=[i,o],i)}function qg(i,o,h){return(Ci&21)===0?(i.baseState&&(i.baseState=!1,fn=!0),i.memoizedState=h):(ia(h,o)||(h=Tm(),Yt.lanes|=h,Ei|=h,i.baseState=!0),o)}function RT(i,o){var h=Et;Et=h!==0&&4>h?h:4,i(!0);var x=zd.transition;zd.transition={};try{i(!1),o()}finally{Et=h,zd.transition=x}}function Xg(){return zn().memoizedState}function IT(i,o,h){var x=Bs(i);if(h={lane:x,action:h,hasEagerState:!1,eagerState:null,next:null},Qg(i))Yg(o,h);else if(h=Sg(i,o,h,x),h!==null){var w=nn();ha(h,i,x,w),Jg(h,o,x)}}function MT(i,o,h){var x=Bs(i),w={lane:x,action:h,hasEagerState:!1,eagerState:null,next:null};if(Qg(i))Yg(o,w);else{var j=i.alternate;if(i.lanes===0&&(j===null||j.lanes===0)&&(j=o.lastRenderedReducer,j!==null))try{var L=o.lastRenderedState,q=j(L,h);if(w.hasEagerState=!0,w.eagerState=q,ia(q,L)){var re=o.interleaved;re===null?(w.next=w,Id(o)):(w.next=re.next,re.next=w),o.interleaved=w;return}}catch{}finally{}h=Sg(i,o,w,x),h!==null&&(w=nn(),ha(h,i,x,w),Jg(h,o,x))}}function Qg(i){var o=i.alternate;return i===Yt||o!==null&&o===Yt}function Yg(i,o){ic=a0=!0;var h=i.pending;h===null?o.next=o:(o.next=h.next,h.next=o),i.pending=o}function Jg(i,o,h){if((h&4194240)!==0){var x=o.lanes;x&=i.pendingLanes,h|=x,o.lanes=h,Jh(i,h)}}var l0={readContext:Vn,useCallback:zr,useContext:zr,useEffect:zr,useImperativeHandle:zr,useInsertionEffect:zr,useLayoutEffect:zr,useMemo:zr,useReducer:zr,useRef:zr,useState:zr,useDebugValue:zr,useDeferredValue:zr,useTransition:zr,useMutableSource:zr,useSyncExternalStore:zr,useId:zr,unstable_isNewReconciler:!1},BT={readContext:Vn,useCallback:function(i,o){return Sa().memoizedState=[i,o===void 0?null:o],i},useContext:Vn,useEffect:Ug,useImperativeHandle:function(i,o,h){return h=h!=null?h.concat([i]):null,s0(4194308,4,Kg.bind(null,o,i),h)},useLayoutEffect:function(i,o){return s0(4194308,4,i,o)},useInsertionEffect:function(i,o){return s0(4,2,i,o)},useMemo:function(i,o){var h=Sa();return o=o===void 0?null:o,i=i(),h.memoizedState=[i,o],i},useReducer:function(i,o,h){var x=Sa();return o=h!==void 0?h(o):o,x.memoizedState=x.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},x.queue=i,i=i.dispatch=IT.bind(null,Yt,i),[x.memoizedState,i]},useRef:function(i){var o=Sa();return i={current:i},o.memoizedState=i},useState:Bg,useDebugValue:Qd,useDeferredValue:function(i){return Sa().memoizedState=i},useTransition:function(){var i=Bg(!1),o=i[0];return i=RT.bind(null,i[1]),Sa().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,h){var x=Yt,w=Sa();if(qt){if(h===void 0)throw Error(r(407));h=h()}else{if(h=o(),Fr===null)throw Error(r(349));(Ci&30)!==0||Lg(x,o,h)}w.memoizedState=h;var j={value:h,getSnapshot:o};return w.queue=j,Ug(Rg.bind(null,x,j,i),[i]),x.flags|=2048,cc(9,Og.bind(null,x,j,h,o),void 0,null),h},useId:function(){var i=Sa(),o=Fr.identifierPrefix;if(qt){var h=Qa,x=Xa;h=(x&~(1<<32-ur(x)-1)).toString(32)+h,o=":"+o+"R"+h,h=lc++,0<h&&(o+="H"+h.toString(32)),o+=":"}else h=OT++,o=":"+o+"r"+h.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},HT={readContext:Vn,useCallback:Wg,useContext:Vn,useEffect:Xd,useImperativeHandle:$g,useInsertionEffect:Vg,useLayoutEffect:zg,useMemo:Gg,useReducer:Gd,useRef:Hg,useState:function(){return Gd(oc)},useDebugValue:Qd,useDeferredValue:function(i){var o=zn();return qg(o,wr.memoizedState,i)},useTransition:function(){var i=Gd(oc)[0],o=zn().memoizedState;return[i,o]},useMutableSource:Dg,useSyncExternalStore:Pg,useId:Xg,unstable_isNewReconciler:!1},UT={readContext:Vn,useCallback:Wg,useContext:Vn,useEffect:Xd,useImperativeHandle:$g,useInsertionEffect:Vg,useLayoutEffect:zg,useMemo:Gg,useReducer:qd,useRef:Hg,useState:function(){return qd(oc)},useDebugValue:Qd,useDeferredValue:function(i){var o=zn();return wr===null?o.memoizedState=i:qg(o,wr.memoizedState,i)},useTransition:function(){var i=qd(oc)[0],o=zn().memoizedState;return[i,o]},useMutableSource:Dg,useSyncExternalStore:Pg,useId:Xg,unstable_isNewReconciler:!1};function oa(i,o){if(i&&i.defaultProps){o=ve({},o),i=i.defaultProps;for(var h in i)o[h]===void 0&&(o[h]=i[h]);return o}return o}function Yd(i,o,h,x){o=i.memoizedState,h=h(x,o),h=h==null?o:ve({},o,h),i.memoizedState=h,i.lanes===0&&(i.updateQueue.baseState=h)}var o0={isMounted:function(i){return(i=i._reactInternals)?W(i)===i:!1},enqueueSetState:function(i,o,h){i=i._reactInternals;var x=nn(),w=Bs(i),j=Ja(x,w);j.payload=o,h!=null&&(j.callback=h),o=Os(i,j,w),o!==null&&(ha(o,i,w,x),e0(o,i,w))},enqueueReplaceState:function(i,o,h){i=i._reactInternals;var x=nn(),w=Bs(i),j=Ja(x,w);j.tag=1,j.payload=o,h!=null&&(j.callback=h),o=Os(i,j,w),o!==null&&(ha(o,i,w,x),e0(o,i,w))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var h=nn(),x=Bs(i),w=Ja(h,x);w.tag=2,o!=null&&(w.callback=o),o=Os(i,w,x),o!==null&&(ha(o,i,x,h),e0(o,i,x))}};function Zg(i,o,h,x,w,j,L){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(x,j,L):o.prototype&&o.prototype.isPureReactComponent?!Xo(h,x)||!Xo(w,j):!0}function e1(i,o,h){var x=!1,w=Ds,j=o.contextType;return typeof j=="object"&&j!==null?j=Vn(j):(w=dn(o)?ki:Vr.current,x=o.contextTypes,j=(x=x!=null)?El(i,w):Ds),o=new o(h,j),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=o0,i.stateNode=o,o._reactInternals=i,x&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=w,i.__reactInternalMemoizedMaskedChildContext=j),o}function t1(i,o,h,x){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(h,x),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(h,x),o.state!==i&&o0.enqueueReplaceState(o,o.state,null)}function Jd(i,o,h,x){var w=i.stateNode;w.props=h,w.state=i.memoizedState,w.refs={},Md(i);var j=o.contextType;typeof j=="object"&&j!==null?w.context=Vn(j):(j=dn(o)?ki:Vr.current,w.context=El(i,j)),w.state=i.memoizedState,j=o.getDerivedStateFromProps,typeof j=="function"&&(Yd(i,o,j,h),w.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(o=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),o!==w.state&&o0.enqueueReplaceState(w,w.state,null),t0(i,h,w,x),w.state=i.memoizedState),typeof w.componentDidMount=="function"&&(i.flags|=4194308)}function Il(i,o){try{var h="",x=o;do h+=M(x),x=x.return;while(x);var w=h}catch(j){w=`
Error generating stack: `+j.message+`
`+j.stack}return{value:i,source:o,stack:w,digest:null}}function Zd(i,o,h){return{value:i,source:null,stack:h??null,digest:o??null}}function ef(i,o){try{console.error(o.value)}catch(h){setTimeout(function(){throw h})}}var VT=typeof WeakMap=="function"?WeakMap:Map;function r1(i,o,h){h=Ja(-1,h),h.tag=3,h.payload={element:null};var x=o.value;return h.callback=function(){x0||(x0=!0,mf=x),ef(i,o)},h}function n1(i,o,h){h=Ja(-1,h),h.tag=3;var x=i.type.getDerivedStateFromError;if(typeof x=="function"){var w=o.value;h.payload=function(){return x(w)},h.callback=function(){ef(i,o)}}var j=i.stateNode;return j!==null&&typeof j.componentDidCatch=="function"&&(h.callback=function(){ef(i,o),typeof x!="function"&&(Is===null?Is=new Set([this]):Is.add(this));var L=o.stack;this.componentDidCatch(o.value,{componentStack:L!==null?L:""})}),h}function a1(i,o,h){var x=i.pingCache;if(x===null){x=i.pingCache=new VT;var w=new Set;x.set(o,w)}else w=x.get(o),w===void 0&&(w=new Set,x.set(o,w));w.has(h)||(w.add(h),i=rj.bind(null,i,o,h),o.then(i,i))}function s1(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function i1(i,o,h,x,w){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(o=Ja(-1,1),o.tag=2,Os(h,o,1))),h.lanes|=1),i):(i.flags|=65536,i.lanes=w,i)}var zT=E.ReactCurrentOwner,fn=!1;function rn(i,o,h,x){o.child=i===null?_g(o,null,h,x):Pl(o,i.child,h,x)}function l1(i,o,h,x,w){h=h.render;var j=o.ref;return Ol(o,w),x=$d(i,o,h,x,j,w),h=Wd(),i!==null&&!fn?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~w,Za(i,o,w)):(qt&&h&&Cd(o),o.flags|=1,rn(i,o,x,w),o.child)}function o1(i,o,h,x,w){if(i===null){var j=h.type;return typeof j=="function"&&!kf(j)&&j.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(o.tag=15,o.type=j,c1(i,o,j,x,w)):(i=w0(h.type,null,x,o,o.mode,w),i.ref=o.ref,i.return=o,o.child=i)}if(j=i.child,(i.lanes&w)===0){var L=j.memoizedProps;if(h=h.compare,h=h!==null?h:Xo,h(L,x)&&i.ref===o.ref)return Za(i,o,w)}return o.flags|=1,i=Us(j,x),i.ref=o.ref,i.return=o,o.child=i}function c1(i,o,h,x,w){if(i!==null){var j=i.memoizedProps;if(Xo(j,x)&&i.ref===o.ref)if(fn=!1,o.pendingProps=x=j,(i.lanes&w)!==0)(i.flags&131072)!==0&&(fn=!0);else return o.lanes=i.lanes,Za(i,o,w)}return tf(i,o,h,x,w)}function u1(i,o,h){var x=o.pendingProps,w=x.children,j=i!==null?i.memoizedState:null;if(x.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vt(Bl,Dn),Dn|=h;else{if((h&1073741824)===0)return i=j!==null?j.baseLanes|h:h,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,Vt(Bl,Dn),Dn|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=j!==null?j.baseLanes:h,Vt(Bl,Dn),Dn|=x}else j!==null?(x=j.baseLanes|h,o.memoizedState=null):x=h,Vt(Bl,Dn),Dn|=x;return rn(i,o,w,h),o.child}function h1(i,o){var h=o.ref;(i===null&&h!==null||i!==null&&i.ref!==h)&&(o.flags|=512,o.flags|=2097152)}function tf(i,o,h,x,w){var j=dn(h)?ki:Vr.current;return j=El(o,j),Ol(o,w),h=$d(i,o,h,x,j,w),x=Wd(),i!==null&&!fn?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~w,Za(i,o,w)):(qt&&x&&Cd(o),o.flags|=1,rn(i,o,h,w),o.child)}function d1(i,o,h,x,w){if(dn(h)){var j=!0;Wu(o)}else j=!1;if(Ol(o,w),o.stateNode===null)u0(i,o),e1(o,h,x),Jd(o,h,x,w),x=!0;else if(i===null){var L=o.stateNode,q=o.memoizedProps;L.props=q;var re=L.context,me=h.contextType;typeof me=="object"&&me!==null?me=Vn(me):(me=dn(h)?ki:Vr.current,me=El(o,me));var Ce=h.getDerivedStateFromProps,Fe=typeof Ce=="function"||typeof L.getSnapshotBeforeUpdate=="function";Fe||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(q!==x||re!==me)&&t1(o,L,x,me),Ls=!1;var Se=o.memoizedState;L.state=Se,t0(o,x,L,w),re=o.memoizedState,q!==x||Se!==re||hn.current||Ls?(typeof Ce=="function"&&(Yd(o,h,Ce,x),re=o.memoizedState),(q=Ls||Zg(o,h,q,x,Se,re,me))?(Fe||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(o.flags|=4194308)):(typeof L.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=x,o.memoizedState=re),L.props=x,L.state=re,L.context=me,x=q):(typeof L.componentDidMount=="function"&&(o.flags|=4194308),x=!1)}else{L=o.stateNode,Cg(i,o),q=o.memoizedProps,me=o.type===o.elementType?q:oa(o.type,q),L.props=me,Fe=o.pendingProps,Se=L.context,re=h.contextType,typeof re=="object"&&re!==null?re=Vn(re):(re=dn(h)?ki:Vr.current,re=El(o,re));var Ve=h.getDerivedStateFromProps;(Ce=typeof Ve=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(q!==Fe||Se!==re)&&t1(o,L,x,re),Ls=!1,Se=o.memoizedState,L.state=Se,t0(o,x,L,w);var $e=o.memoizedState;q!==Fe||Se!==$e||hn.current||Ls?(typeof Ve=="function"&&(Yd(o,h,Ve,x),$e=o.memoizedState),(me=Ls||Zg(o,h,me,x,Se,$e,re)||!1)?(Ce||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(x,$e,re),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(x,$e,re)),typeof L.componentDidUpdate=="function"&&(o.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof L.componentDidUpdate!="function"||q===i.memoizedProps&&Se===i.memoizedState||(o.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||q===i.memoizedProps&&Se===i.memoizedState||(o.flags|=1024),o.memoizedProps=x,o.memoizedState=$e),L.props=x,L.state=$e,L.context=re,x=me):(typeof L.componentDidUpdate!="function"||q===i.memoizedProps&&Se===i.memoizedState||(o.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||q===i.memoizedProps&&Se===i.memoizedState||(o.flags|=1024),x=!1)}return rf(i,o,h,x,j,w)}function rf(i,o,h,x,w,j){h1(i,o);var L=(o.flags&128)!==0;if(!x&&!L)return w&&gg(o,h,!1),Za(i,o,j);x=o.stateNode,zT.current=o;var q=L&&typeof h.getDerivedStateFromError!="function"?null:x.render();return o.flags|=1,i!==null&&L?(o.child=Pl(o,i.child,null,j),o.child=Pl(o,null,q,j)):rn(i,o,q,j),o.memoizedState=x.state,w&&gg(o,h,!0),o.child}function f1(i){var o=i.stateNode;o.pendingContext?xg(i,o.pendingContext,o.pendingContext!==o.context):o.context&&xg(i,o.context,!1),Bd(i,o.containerInfo)}function p1(i,o,h,x,w){return Dl(),Dd(w),o.flags|=256,rn(i,o,h,x),o.child}var nf={dehydrated:null,treeContext:null,retryLane:0};function af(i){return{baseLanes:i,cachePool:null,transitions:null}}function x1(i,o,h){var x=o.pendingProps,w=Qt.current,j=!1,L=(o.flags&128)!==0,q;if((q=L)||(q=i!==null&&i.memoizedState===null?!1:(w&2)!==0),q?(j=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(w|=1),Vt(Qt,w&1),i===null)return Ad(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(L=x.children,i=x.fallback,j?(x=o.mode,j=o.child,L={mode:"hidden",children:L},(x&1)===0&&j!==null?(j.childLanes=0,j.pendingProps=L):j=N0(L,x,0,null),i=Pi(i,x,h,null),j.return=o,i.return=o,j.sibling=i,o.child=j,o.child.memoizedState=af(h),o.memoizedState=nf,i):sf(o,L));if(w=i.memoizedState,w!==null&&(q=w.dehydrated,q!==null))return KT(i,o,L,x,q,w,h);if(j){j=x.fallback,L=o.mode,w=i.child,q=w.sibling;var re={mode:"hidden",children:x.children};return(L&1)===0&&o.child!==w?(x=o.child,x.childLanes=0,x.pendingProps=re,o.deletions=null):(x=Us(w,re),x.subtreeFlags=w.subtreeFlags&14680064),q!==null?j=Us(q,j):(j=Pi(j,L,h,null),j.flags|=2),j.return=o,x.return=o,x.sibling=j,o.child=x,x=j,j=o.child,L=i.child.memoizedState,L=L===null?af(h):{baseLanes:L.baseLanes|h,cachePool:null,transitions:L.transitions},j.memoizedState=L,j.childLanes=i.childLanes&~h,o.memoizedState=nf,x}return j=i.child,i=j.sibling,x=Us(j,{mode:"visible",children:x.children}),(o.mode&1)===0&&(x.lanes=h),x.return=o,x.sibling=null,i!==null&&(h=o.deletions,h===null?(o.deletions=[i],o.flags|=16):h.push(i)),o.child=x,o.memoizedState=null,x}function sf(i,o){return o=N0({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function c0(i,o,h,x){return x!==null&&Dd(x),Pl(o,i.child,null,h),i=sf(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function KT(i,o,h,x,w,j,L){if(h)return o.flags&256?(o.flags&=-257,x=Zd(Error(r(422))),c0(i,o,L,x)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(j=x.fallback,w=o.mode,x=N0({mode:"visible",children:x.children},w,0,null),j=Pi(j,w,L,null),j.flags|=2,x.return=o,j.return=o,x.sibling=j,o.child=x,(o.mode&1)!==0&&Pl(o,i.child,null,L),o.child.memoizedState=af(L),o.memoizedState=nf,j);if((o.mode&1)===0)return c0(i,o,L,null);if(w.data==="$!"){if(x=w.nextSibling&&w.nextSibling.dataset,x)var q=x.dgst;return x=q,j=Error(r(419)),x=Zd(j,x,void 0),c0(i,o,L,x)}if(q=(L&i.childLanes)!==0,fn||q){if(x=Fr,x!==null){switch(L&-L){case 4:w=2;break;case 16:w=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:w=32;break;case 536870912:w=268435456;break;default:w=0}w=(w&(x.suspendedLanes|L))!==0?0:w,w!==0&&w!==j.retryLane&&(j.retryLane=w,Ya(i,w),ha(x,i,w,-1))}return Nf(),x=Zd(Error(r(421))),c0(i,o,L,x)}return w.data==="$?"?(o.flags|=128,o.child=i.child,o=nj.bind(null,i),w._reactRetry=o,null):(i=j.treeContext,An=Fs(w.nextSibling),Fn=o,qt=!0,la=null,i!==null&&(Hn[Un++]=Xa,Hn[Un++]=Qa,Hn[Un++]=Ti,Xa=i.id,Qa=i.overflow,Ti=o),o=sf(o,x.children),o.flags|=4096,o)}function m1(i,o,h){i.lanes|=o;var x=i.alternate;x!==null&&(x.lanes|=o),Rd(i.return,o,h)}function lf(i,o,h,x,w){var j=i.memoizedState;j===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:x,tail:h,tailMode:w}:(j.isBackwards=o,j.rendering=null,j.renderingStartTime=0,j.last=x,j.tail=h,j.tailMode=w)}function g1(i,o,h){var x=o.pendingProps,w=x.revealOrder,j=x.tail;if(rn(i,o,x.children,h),x=Qt.current,(x&2)!==0)x=x&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&m1(i,h,o);else if(i.tag===19)m1(i,h,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}x&=1}if(Vt(Qt,x),(o.mode&1)===0)o.memoizedState=null;else switch(w){case"forwards":for(h=o.child,w=null;h!==null;)i=h.alternate,i!==null&&r0(i)===null&&(w=h),h=h.sibling;h=w,h===null?(w=o.child,o.child=null):(w=h.sibling,h.sibling=null),lf(o,!1,w,h,j);break;case"backwards":for(h=null,w=o.child,o.child=null;w!==null;){if(i=w.alternate,i!==null&&r0(i)===null){o.child=w;break}i=w.sibling,w.sibling=h,h=w,w=i}lf(o,!0,h,null,j);break;case"together":lf(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function u0(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function Za(i,o,h){if(i!==null&&(o.dependencies=i.dependencies),Ei|=o.lanes,(h&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(r(153));if(o.child!==null){for(i=o.child,h=Us(i,i.pendingProps),o.child=h,h.return=o;i.sibling!==null;)i=i.sibling,h=h.sibling=Us(i,i.pendingProps),h.return=o;h.sibling=null}return o.child}function $T(i,o,h){switch(o.tag){case 3:f1(o),Dl();break;case 5:Ag(o);break;case 1:dn(o.type)&&Wu(o);break;case 4:Bd(o,o.stateNode.containerInfo);break;case 10:var x=o.type._context,w=o.memoizedProps.value;Vt(Ju,x._currentValue),x._currentValue=w;break;case 13:if(x=o.memoizedState,x!==null)return x.dehydrated!==null?(Vt(Qt,Qt.current&1),o.flags|=128,null):(h&o.child.childLanes)!==0?x1(i,o,h):(Vt(Qt,Qt.current&1),i=Za(i,o,h),i!==null?i.sibling:null);Vt(Qt,Qt.current&1);break;case 19:if(x=(h&o.childLanes)!==0,(i.flags&128)!==0){if(x)return g1(i,o,h);o.flags|=128}if(w=o.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),Vt(Qt,Qt.current),x)break;return null;case 22:case 23:return o.lanes=0,u1(i,o,h)}return Za(i,o,h)}var v1,of,y1,b1;v1=function(i,o){for(var h=o.child;h!==null;){if(h.tag===5||h.tag===6)i.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===o)break;for(;h.sibling===null;){if(h.return===null||h.return===o)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},of=function(){},y1=function(i,o,h,x){var w=i.memoizedProps;if(w!==x){i=o.stateNode,Si(_a.current);var j=null;switch(h){case"input":w=He(i,w),x=He(i,x),j=[];break;case"select":w=ve({},w,{value:void 0}),x=ve({},x,{value:void 0}),j=[];break;case"textarea":w=sa(i,w),x=sa(i,x),j=[];break;default:typeof w.onClick!="function"&&typeof x.onClick=="function"&&(i.onclick=zu)}Ka(h,x);var L;h=null;for(me in w)if(!x.hasOwnProperty(me)&&w.hasOwnProperty(me)&&w[me]!=null)if(me==="style"){var q=w[me];for(L in q)q.hasOwnProperty(L)&&(h||(h={}),h[L]="")}else me!=="dangerouslySetInnerHTML"&&me!=="children"&&me!=="suppressContentEditableWarning"&&me!=="suppressHydrationWarning"&&me!=="autoFocus"&&(s.hasOwnProperty(me)?j||(j=[]):(j=j||[]).push(me,null));for(me in x){var re=x[me];if(q=w!=null?w[me]:void 0,x.hasOwnProperty(me)&&re!==q&&(re!=null||q!=null))if(me==="style")if(q){for(L in q)!q.hasOwnProperty(L)||re&&re.hasOwnProperty(L)||(h||(h={}),h[L]="");for(L in re)re.hasOwnProperty(L)&&q[L]!==re[L]&&(h||(h={}),h[L]=re[L])}else h||(j||(j=[]),j.push(me,h)),h=re;else me==="dangerouslySetInnerHTML"?(re=re?re.__html:void 0,q=q?q.__html:void 0,re!=null&&q!==re&&(j=j||[]).push(me,re)):me==="children"?typeof re!="string"&&typeof re!="number"||(j=j||[]).push(me,""+re):me!=="suppressContentEditableWarning"&&me!=="suppressHydrationWarning"&&(s.hasOwnProperty(me)?(re!=null&&me==="onScroll"&&zt("scroll",i),j||q===re||(j=[])):(j=j||[]).push(me,re))}h&&(j=j||[]).push("style",h);var me=j;(o.updateQueue=me)&&(o.flags|=4)}},b1=function(i,o,h,x){h!==x&&(o.flags|=4)};function uc(i,o){if(!qt)switch(i.tailMode){case"hidden":o=i.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?i.tail=null:h.sibling=null;break;case"collapsed":h=i.tail;for(var x=null;h!==null;)h.alternate!==null&&(x=h),h=h.sibling;x===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:x.sibling=null}}function Kr(i){var o=i.alternate!==null&&i.alternate.child===i.child,h=0,x=0;if(o)for(var w=i.child;w!==null;)h|=w.lanes|w.childLanes,x|=w.subtreeFlags&14680064,x|=w.flags&14680064,w.return=i,w=w.sibling;else for(w=i.child;w!==null;)h|=w.lanes|w.childLanes,x|=w.subtreeFlags,x|=w.flags,w.return=i,w=w.sibling;return i.subtreeFlags|=x,i.childLanes=h,o}function WT(i,o,h){var x=o.pendingProps;switch(Ed(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kr(o),null;case 1:return dn(o.type)&&$u(),Kr(o),null;case 3:return x=o.stateNode,Rl(),Kt(hn),Kt(Vr),Vd(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(i===null||i.child===null)&&(Qu(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,la!==null&&(yf(la),la=null))),of(i,o),Kr(o),null;case 5:Hd(o);var w=Si(sc.current);if(h=o.type,i!==null&&o.stateNode!=null)y1(i,o,h,x,w),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!x){if(o.stateNode===null)throw Error(r(166));return Kr(o),null}if(i=Si(_a.current),Qu(o)){x=o.stateNode,h=o.type;var j=o.memoizedProps;switch(x[ja]=o,x[ec]=j,i=(o.mode&1)!==0,h){case"dialog":zt("cancel",x),zt("close",x);break;case"iframe":case"object":case"embed":zt("load",x);break;case"video":case"audio":for(w=0;w<Yo.length;w++)zt(Yo[w],x);break;case"source":zt("error",x);break;case"img":case"image":case"link":zt("error",x),zt("load",x);break;case"details":zt("toggle",x);break;case"input":ht(x,j),zt("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!j.multiple},zt("invalid",x);break;case"textarea":Cn(x,j),zt("invalid",x)}Ka(h,j),w=null;for(var L in j)if(j.hasOwnProperty(L)){var q=j[L];L==="children"?typeof q=="string"?x.textContent!==q&&(j.suppressHydrationWarning!==!0&&Vu(x.textContent,q,i),w=["children",q]):typeof q=="number"&&x.textContent!==""+q&&(j.suppressHydrationWarning!==!0&&Vu(x.textContent,q,i),w=["children",""+q]):s.hasOwnProperty(L)&&q!=null&&L==="onScroll"&&zt("scroll",x)}switch(h){case"input":Je(x),Pt(x,j,!0);break;case"textarea":Je(x),Ge(x);break;case"select":case"option":break;default:typeof j.onClick=="function"&&(x.onclick=zu)}x=w,o.updateQueue=x,x!==null&&(o.flags|=4)}else{L=w.nodeType===9?w:w.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=Tt(h)),i==="http://www.w3.org/1999/xhtml"?h==="script"?(i=L.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof x.is=="string"?i=L.createElement(h,{is:x.is}):(i=L.createElement(h),h==="select"&&(L=i,x.multiple?L.multiple=!0:x.size&&(L.size=x.size))):i=L.createElementNS(i,h),i[ja]=o,i[ec]=x,v1(i,o,!1,!1),o.stateNode=i;e:{switch(L=$a(h,x),h){case"dialog":zt("cancel",i),zt("close",i),w=x;break;case"iframe":case"object":case"embed":zt("load",i),w=x;break;case"video":case"audio":for(w=0;w<Yo.length;w++)zt(Yo[w],i);w=x;break;case"source":zt("error",i),w=x;break;case"img":case"image":case"link":zt("error",i),zt("load",i),w=x;break;case"details":zt("toggle",i),w=x;break;case"input":ht(i,x),w=He(i,x),zt("invalid",i);break;case"option":w=x;break;case"select":i._wrapperState={wasMultiple:!!x.multiple},w=ve({},x,{value:void 0}),zt("invalid",i);break;case"textarea":Cn(i,x),w=sa(i,x),zt("invalid",i);break;default:w=x}Ka(h,w),q=w;for(j in q)if(q.hasOwnProperty(j)){var re=q[j];j==="style"?tn(i,re):j==="dangerouslySetInnerHTML"?(re=re?re.__html:void 0,re!=null&&br(i,re)):j==="children"?typeof re=="string"?(h!=="textarea"||re!=="")&&tt(i,re):typeof re=="number"&&tt(i,""+re):j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&j!=="autoFocus"&&(s.hasOwnProperty(j)?re!=null&&j==="onScroll"&&zt("scroll",i):re!=null&&S(i,j,re,L))}switch(h){case"input":Je(i),Pt(i,x,!1);break;case"textarea":Je(i),Ge(i);break;case"option":x.value!=null&&i.setAttribute("value",""+be(x.value));break;case"select":i.multiple=!!x.multiple,j=x.value,j!=null?_r(i,!!x.multiple,j,!1):x.defaultValue!=null&&_r(i,!!x.multiple,x.defaultValue,!0);break;default:typeof w.onClick=="function"&&(i.onclick=zu)}switch(h){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return Kr(o),null;case 6:if(i&&o.stateNode!=null)b1(i,o,i.memoizedProps,x);else{if(typeof x!="string"&&o.stateNode===null)throw Error(r(166));if(h=Si(sc.current),Si(_a.current),Qu(o)){if(x=o.stateNode,h=o.memoizedProps,x[ja]=o,(j=x.nodeValue!==h)&&(i=Fn,i!==null))switch(i.tag){case 3:Vu(x.nodeValue,h,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Vu(x.nodeValue,h,(i.mode&1)!==0)}j&&(o.flags|=4)}else x=(h.nodeType===9?h:h.ownerDocument).createTextNode(x),x[ja]=o,o.stateNode=x}return Kr(o),null;case 13:if(Kt(Qt),x=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(qt&&An!==null&&(o.mode&1)!==0&&(o.flags&128)===0)kg(),Dl(),o.flags|=98560,j=!1;else if(j=Qu(o),x!==null&&x.dehydrated!==null){if(i===null){if(!j)throw Error(r(318));if(j=o.memoizedState,j=j!==null?j.dehydrated:null,!j)throw Error(r(317));j[ja]=o}else Dl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Kr(o),j=!1}else la!==null&&(yf(la),la=null),j=!0;if(!j)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=h,o):(x=x!==null,x!==(i!==null&&i.memoizedState!==null)&&x&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(Qt.current&1)!==0?Nr===0&&(Nr=3):Nf())),o.updateQueue!==null&&(o.flags|=4),Kr(o),null);case 4:return Rl(),of(i,o),i===null&&Jo(o.stateNode.containerInfo),Kr(o),null;case 10:return Od(o.type._context),Kr(o),null;case 17:return dn(o.type)&&$u(),Kr(o),null;case 19:if(Kt(Qt),j=o.memoizedState,j===null)return Kr(o),null;if(x=(o.flags&128)!==0,L=j.rendering,L===null)if(x)uc(j,!1);else{if(Nr!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(L=r0(i),L!==null){for(o.flags|=128,uc(j,!1),x=L.updateQueue,x!==null&&(o.updateQueue=x,o.flags|=4),o.subtreeFlags=0,x=h,h=o.child;h!==null;)j=h,i=x,j.flags&=14680066,L=j.alternate,L===null?(j.childLanes=0,j.lanes=i,j.child=null,j.subtreeFlags=0,j.memoizedProps=null,j.memoizedState=null,j.updateQueue=null,j.dependencies=null,j.stateNode=null):(j.childLanes=L.childLanes,j.lanes=L.lanes,j.child=L.child,j.subtreeFlags=0,j.deletions=null,j.memoizedProps=L.memoizedProps,j.memoizedState=L.memoizedState,j.updateQueue=L.updateQueue,j.type=L.type,i=L.dependencies,j.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),h=h.sibling;return Vt(Qt,Qt.current&1|2),o.child}i=i.sibling}j.tail!==null&&Ae()>Hl&&(o.flags|=128,x=!0,uc(j,!1),o.lanes=4194304)}else{if(!x)if(i=r0(L),i!==null){if(o.flags|=128,x=!0,h=i.updateQueue,h!==null&&(o.updateQueue=h,o.flags|=4),uc(j,!0),j.tail===null&&j.tailMode==="hidden"&&!L.alternate&&!qt)return Kr(o),null}else 2*Ae()-j.renderingStartTime>Hl&&h!==1073741824&&(o.flags|=128,x=!0,uc(j,!1),o.lanes=4194304);j.isBackwards?(L.sibling=o.child,o.child=L):(h=j.last,h!==null?h.sibling=L:o.child=L,j.last=L)}return j.tail!==null?(o=j.tail,j.rendering=o,j.tail=o.sibling,j.renderingStartTime=Ae(),o.sibling=null,h=Qt.current,Vt(Qt,x?h&1|2:h&1),o):(Kr(o),null);case 22:case 23:return wf(),x=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==x&&(o.flags|=8192),x&&(o.mode&1)!==0?(Dn&1073741824)!==0&&(Kr(o),o.subtreeFlags&6&&(o.flags|=8192)):Kr(o),null;case 24:return null;case 25:return null}throw Error(r(156,o.tag))}function GT(i,o){switch(Ed(o),o.tag){case 1:return dn(o.type)&&$u(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return Rl(),Kt(hn),Kt(Vr),Vd(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return Hd(o),null;case 13:if(Kt(Qt),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(r(340));Dl()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return Kt(Qt),null;case 4:return Rl(),null;case 10:return Od(o.type._context),null;case 22:case 23:return wf(),null;case 24:return null;default:return null}}var h0=!1,$r=!1,qT=typeof WeakSet=="function"?WeakSet:Set,Ke=null;function Ml(i,o){var h=i.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(x){rr(i,o,x)}else h.current=null}function cf(i,o,h){try{h()}catch(x){rr(i,o,x)}}var w1=!1;function XT(i,o){if(bd=Au,i=Zm(),dd(i)){if("selectionStart"in i)var h={start:i.selectionStart,end:i.selectionEnd};else e:{h=(h=i.ownerDocument)&&h.defaultView||window;var x=h.getSelection&&h.getSelection();if(x&&x.rangeCount!==0){h=x.anchorNode;var w=x.anchorOffset,j=x.focusNode;x=x.focusOffset;try{h.nodeType,j.nodeType}catch{h=null;break e}var L=0,q=-1,re=-1,me=0,Ce=0,Fe=i,Se=null;t:for(;;){for(var Ve;Fe!==h||w!==0&&Fe.nodeType!==3||(q=L+w),Fe!==j||x!==0&&Fe.nodeType!==3||(re=L+x),Fe.nodeType===3&&(L+=Fe.nodeValue.length),(Ve=Fe.firstChild)!==null;)Se=Fe,Fe=Ve;for(;;){if(Fe===i)break t;if(Se===h&&++me===w&&(q=L),Se===j&&++Ce===x&&(re=L),(Ve=Fe.nextSibling)!==null)break;Fe=Se,Se=Fe.parentNode}Fe=Ve}h=q===-1||re===-1?null:{start:q,end:re}}else h=null}h=h||{start:0,end:0}}else h=null;for(wd={focusedElem:i,selectionRange:h},Au=!1,Ke=o;Ke!==null;)if(o=Ke,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,Ke=i;else for(;Ke!==null;){o=Ke;try{var $e=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if($e!==null){var We=$e.memoizedProps,hr=$e.memoizedState,ie=o.stateNode,se=ie.getSnapshotBeforeUpdate(o.elementType===o.type?We:oa(o.type,We),hr);ie.__reactInternalSnapshotBeforeUpdate=se}break;case 3:var oe=o.stateNode.containerInfo;oe.nodeType===1?oe.textContent="":oe.nodeType===9&&oe.documentElement&&oe.removeChild(oe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Pe){rr(o,o.return,Pe)}if(i=o.sibling,i!==null){i.return=o.return,Ke=i;break}Ke=o.return}return $e=w1,w1=!1,$e}function hc(i,o,h){var x=o.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var w=x=x.next;do{if((w.tag&i)===i){var j=w.destroy;w.destroy=void 0,j!==void 0&&cf(o,h,j)}w=w.next}while(w!==x)}}function d0(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var h=o=o.next;do{if((h.tag&i)===i){var x=h.create;h.destroy=x()}h=h.next}while(h!==o)}}function uf(i){var o=i.ref;if(o!==null){var h=i.stateNode;switch(i.tag){case 5:i=h;break;default:i=h}typeof o=="function"?o(i):o.current=i}}function N1(i){var o=i.alternate;o!==null&&(i.alternate=null,N1(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[ja],delete o[ec],delete o[jd],delete o[AT],delete o[DT])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function k1(i){return i.tag===5||i.tag===3||i.tag===4}function T1(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||k1(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function hf(i,o,h){var x=i.tag;if(x===5||x===6)i=i.stateNode,o?h.nodeType===8?h.parentNode.insertBefore(i,o):h.insertBefore(i,o):(h.nodeType===8?(o=h.parentNode,o.insertBefore(i,h)):(o=h,o.appendChild(i)),h=h._reactRootContainer,h!=null||o.onclick!==null||(o.onclick=zu));else if(x!==4&&(i=i.child,i!==null))for(hf(i,o,h),i=i.sibling;i!==null;)hf(i,o,h),i=i.sibling}function df(i,o,h){var x=i.tag;if(x===5||x===6)i=i.stateNode,o?h.insertBefore(i,o):h.appendChild(i);else if(x!==4&&(i=i.child,i!==null))for(df(i,o,h),i=i.sibling;i!==null;)df(i,o,h),i=i.sibling}var Ir=null,ca=!1;function Rs(i,o,h){for(h=h.child;h!==null;)j1(i,o,h),h=h.sibling}function j1(i,o,h){if(Cr&&typeof Cr.onCommitFiberUnmount=="function")try{Cr.onCommitFiberUnmount(Ta,h)}catch{}switch(h.tag){case 5:$r||Ml(h,o);case 6:var x=Ir,w=ca;Ir=null,Rs(i,o,h),Ir=x,ca=w,Ir!==null&&(ca?(i=Ir,h=h.stateNode,i.nodeType===8?i.parentNode.removeChild(h):i.removeChild(h)):Ir.removeChild(h.stateNode));break;case 18:Ir!==null&&(ca?(i=Ir,h=h.stateNode,i.nodeType===8?Td(i.parentNode,h):i.nodeType===1&&Td(i,h),zo(i)):Td(Ir,h.stateNode));break;case 4:x=Ir,w=ca,Ir=h.stateNode.containerInfo,ca=!0,Rs(i,o,h),Ir=x,ca=w;break;case 0:case 11:case 14:case 15:if(!$r&&(x=h.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){w=x=x.next;do{var j=w,L=j.destroy;j=j.tag,L!==void 0&&((j&2)!==0||(j&4)!==0)&&cf(h,o,L),w=w.next}while(w!==x)}Rs(i,o,h);break;case 1:if(!$r&&(Ml(h,o),x=h.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=h.memoizedProps,x.state=h.memoizedState,x.componentWillUnmount()}catch(q){rr(h,o,q)}Rs(i,o,h);break;case 21:Rs(i,o,h);break;case 22:h.mode&1?($r=(x=$r)||h.memoizedState!==null,Rs(i,o,h),$r=x):Rs(i,o,h);break;default:Rs(i,o,h)}}function _1(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var h=i.stateNode;h===null&&(h=i.stateNode=new qT),o.forEach(function(x){var w=aj.bind(null,i,x);h.has(x)||(h.add(x),x.then(w,w))})}}function ua(i,o){var h=o.deletions;if(h!==null)for(var x=0;x<h.length;x++){var w=h[x];try{var j=i,L=o,q=L;e:for(;q!==null;){switch(q.tag){case 5:Ir=q.stateNode,ca=!1;break e;case 3:Ir=q.stateNode.containerInfo,ca=!0;break e;case 4:Ir=q.stateNode.containerInfo,ca=!0;break e}q=q.return}if(Ir===null)throw Error(r(160));j1(j,L,w),Ir=null,ca=!1;var re=w.alternate;re!==null&&(re.return=null),w.return=null}catch(me){rr(w,o,me)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)S1(o,i),o=o.sibling}function S1(i,o){var h=i.alternate,x=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(ua(o,i),Ca(i),x&4){try{hc(3,i,i.return),d0(3,i)}catch(We){rr(i,i.return,We)}try{hc(5,i,i.return)}catch(We){rr(i,i.return,We)}}break;case 1:ua(o,i),Ca(i),x&512&&h!==null&&Ml(h,h.return);break;case 5:if(ua(o,i),Ca(i),x&512&&h!==null&&Ml(h,h.return),i.flags&32){var w=i.stateNode;try{tt(w,"")}catch(We){rr(i,i.return,We)}}if(x&4&&(w=i.stateNode,w!=null)){var j=i.memoizedProps,L=h!==null?h.memoizedProps:j,q=i.type,re=i.updateQueue;if(i.updateQueue=null,re!==null)try{q==="input"&&j.type==="radio"&&j.name!=null&&rt(w,j),$a(q,L);var me=$a(q,j);for(L=0;L<re.length;L+=2){var Ce=re[L],Fe=re[L+1];Ce==="style"?tn(w,Fe):Ce==="dangerouslySetInnerHTML"?br(w,Fe):Ce==="children"?tt(w,Fe):S(w,Ce,Fe,me)}switch(q){case"input":Oe(w,j);break;case"textarea":Re(w,j);break;case"select":var Se=w._wrapperState.wasMultiple;w._wrapperState.wasMultiple=!!j.multiple;var Ve=j.value;Ve!=null?_r(w,!!j.multiple,Ve,!1):Se!==!!j.multiple&&(j.defaultValue!=null?_r(w,!!j.multiple,j.defaultValue,!0):_r(w,!!j.multiple,j.multiple?[]:"",!1))}w[ec]=j}catch(We){rr(i,i.return,We)}}break;case 6:if(ua(o,i),Ca(i),x&4){if(i.stateNode===null)throw Error(r(162));w=i.stateNode,j=i.memoizedProps;try{w.nodeValue=j}catch(We){rr(i,i.return,We)}}break;case 3:if(ua(o,i),Ca(i),x&4&&h!==null&&h.memoizedState.isDehydrated)try{zo(o.containerInfo)}catch(We){rr(i,i.return,We)}break;case 4:ua(o,i),Ca(i);break;case 13:ua(o,i),Ca(i),w=i.child,w.flags&8192&&(j=w.memoizedState!==null,w.stateNode.isHidden=j,!j||w.alternate!==null&&w.alternate.memoizedState!==null||(xf=Ae())),x&4&&_1(i);break;case 22:if(Ce=h!==null&&h.memoizedState!==null,i.mode&1?($r=(me=$r)||Ce,ua(o,i),$r=me):ua(o,i),Ca(i),x&8192){if(me=i.memoizedState!==null,(i.stateNode.isHidden=me)&&!Ce&&(i.mode&1)!==0)for(Ke=i,Ce=i.child;Ce!==null;){for(Fe=Ke=Ce;Ke!==null;){switch(Se=Ke,Ve=Se.child,Se.tag){case 0:case 11:case 14:case 15:hc(4,Se,Se.return);break;case 1:Ml(Se,Se.return);var $e=Se.stateNode;if(typeof $e.componentWillUnmount=="function"){x=Se,h=Se.return;try{o=x,$e.props=o.memoizedProps,$e.state=o.memoizedState,$e.componentWillUnmount()}catch(We){rr(x,h,We)}}break;case 5:Ml(Se,Se.return);break;case 22:if(Se.memoizedState!==null){F1(Fe);continue}}Ve!==null?(Ve.return=Se,Ke=Ve):F1(Fe)}Ce=Ce.sibling}e:for(Ce=null,Fe=i;;){if(Fe.tag===5){if(Ce===null){Ce=Fe;try{w=Fe.stateNode,me?(j=w.style,typeof j.setProperty=="function"?j.setProperty("display","none","important"):j.display="none"):(q=Fe.stateNode,re=Fe.memoizedProps.style,L=re!=null&&re.hasOwnProperty("display")?re.display:null,q.style.display=Ht("display",L))}catch(We){rr(i,i.return,We)}}}else if(Fe.tag===6){if(Ce===null)try{Fe.stateNode.nodeValue=me?"":Fe.memoizedProps}catch(We){rr(i,i.return,We)}}else if((Fe.tag!==22&&Fe.tag!==23||Fe.memoizedState===null||Fe===i)&&Fe.child!==null){Fe.child.return=Fe,Fe=Fe.child;continue}if(Fe===i)break e;for(;Fe.sibling===null;){if(Fe.return===null||Fe.return===i)break e;Ce===Fe&&(Ce=null),Fe=Fe.return}Ce===Fe&&(Ce=null),Fe.sibling.return=Fe.return,Fe=Fe.sibling}}break;case 19:ua(o,i),Ca(i),x&4&&_1(i);break;case 21:break;default:ua(o,i),Ca(i)}}function Ca(i){var o=i.flags;if(o&2){try{e:{for(var h=i.return;h!==null;){if(k1(h)){var x=h;break e}h=h.return}throw Error(r(160))}switch(x.tag){case 5:var w=x.stateNode;x.flags&32&&(tt(w,""),x.flags&=-33);var j=T1(i);df(i,j,w);break;case 3:case 4:var L=x.stateNode.containerInfo,q=T1(i);hf(i,q,L);break;default:throw Error(r(161))}}catch(re){rr(i,i.return,re)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function QT(i,o,h){Ke=i,C1(i)}function C1(i,o,h){for(var x=(i.mode&1)!==0;Ke!==null;){var w=Ke,j=w.child;if(w.tag===22&&x){var L=w.memoizedState!==null||h0;if(!L){var q=w.alternate,re=q!==null&&q.memoizedState!==null||$r;q=h0;var me=$r;if(h0=L,($r=re)&&!me)for(Ke=w;Ke!==null;)L=Ke,re=L.child,L.tag===22&&L.memoizedState!==null?A1(w):re!==null?(re.return=L,Ke=re):A1(w);for(;j!==null;)Ke=j,C1(j),j=j.sibling;Ke=w,h0=q,$r=me}E1(i)}else(w.subtreeFlags&8772)!==0&&j!==null?(j.return=w,Ke=j):E1(i)}}function E1(i){for(;Ke!==null;){var o=Ke;if((o.flags&8772)!==0){var h=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:$r||d0(5,o);break;case 1:var x=o.stateNode;if(o.flags&4&&!$r)if(h===null)x.componentDidMount();else{var w=o.elementType===o.type?h.memoizedProps:oa(o.type,h.memoizedProps);x.componentDidUpdate(w,h.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var j=o.updateQueue;j!==null&&Fg(o,j,x);break;case 3:var L=o.updateQueue;if(L!==null){if(h=null,o.child!==null)switch(o.child.tag){case 5:h=o.child.stateNode;break;case 1:h=o.child.stateNode}Fg(o,L,h)}break;case 5:var q=o.stateNode;if(h===null&&o.flags&4){h=q;var re=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":re.autoFocus&&h.focus();break;case"img":re.src&&(h.src=re.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var me=o.alternate;if(me!==null){var Ce=me.memoizedState;if(Ce!==null){var Fe=Ce.dehydrated;Fe!==null&&zo(Fe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}$r||o.flags&512&&uf(o)}catch(Se){rr(o,o.return,Se)}}if(o===i){Ke=null;break}if(h=o.sibling,h!==null){h.return=o.return,Ke=h;break}Ke=o.return}}function F1(i){for(;Ke!==null;){var o=Ke;if(o===i){Ke=null;break}var h=o.sibling;if(h!==null){h.return=o.return,Ke=h;break}Ke=o.return}}function A1(i){for(;Ke!==null;){var o=Ke;try{switch(o.tag){case 0:case 11:case 15:var h=o.return;try{d0(4,o)}catch(re){rr(o,h,re)}break;case 1:var x=o.stateNode;if(typeof x.componentDidMount=="function"){var w=o.return;try{x.componentDidMount()}catch(re){rr(o,w,re)}}var j=o.return;try{uf(o)}catch(re){rr(o,j,re)}break;case 5:var L=o.return;try{uf(o)}catch(re){rr(o,L,re)}}}catch(re){rr(o,o.return,re)}if(o===i){Ke=null;break}var q=o.sibling;if(q!==null){q.return=o.return,Ke=q;break}Ke=o.return}}var YT=Math.ceil,f0=E.ReactCurrentDispatcher,ff=E.ReactCurrentOwner,Kn=E.ReactCurrentBatchConfig,wt=0,Fr=null,mr=null,Mr=0,Dn=0,Bl=As(0),Nr=0,dc=null,Ei=0,p0=0,pf=0,fc=null,pn=null,xf=0,Hl=1/0,es=null,x0=!1,mf=null,Is=null,m0=!1,Ms=null,g0=0,pc=0,gf=null,v0=-1,y0=0;function nn(){return(wt&6)!==0?Ae():v0!==-1?v0:v0=Ae()}function Bs(i){return(i.mode&1)===0?1:(wt&2)!==0&&Mr!==0?Mr&-Mr:LT.transition!==null?(y0===0&&(y0=Tm()),y0):(i=Et,i!==0||(i=window.event,i=i===void 0?16:Pm(i.type)),i)}function ha(i,o,h,x){if(50<pc)throw pc=0,gf=null,Error(r(185));Mo(i,h,x),((wt&2)===0||i!==Fr)&&(i===Fr&&((wt&2)===0&&(p0|=h),Nr===4&&Hs(i,Mr)),xn(i,x),h===1&&wt===0&&(o.mode&1)===0&&(Hl=Ae()+500,Gu&&Ps()))}function xn(i,o){var h=i.callbackNode;Lk(i,o);var x=Cu(i,i===Fr?Mr:0);if(x===0)h!==null&&Be(h),i.callbackNode=null,i.callbackPriority=0;else if(o=x&-x,i.callbackPriority!==o){if(h!=null&&Be(h),o===1)i.tag===0?PT(P1.bind(null,i)):vg(P1.bind(null,i)),ET(function(){(wt&6)===0&&Ps()}),h=null;else{switch(jm(x)){case 1:h=Rt;break;case 4:h=Ut;break;case 16:h=cr;break;case 536870912:h=ks;break;default:h=cr}h=U1(h,D1.bind(null,i))}i.callbackPriority=o,i.callbackNode=h}}function D1(i,o){if(v0=-1,y0=0,(wt&6)!==0)throw Error(r(327));var h=i.callbackNode;if(Ul()&&i.callbackNode!==h)return null;var x=Cu(i,i===Fr?Mr:0);if(x===0)return null;if((x&30)!==0||(x&i.expiredLanes)!==0||o)o=b0(i,x);else{o=x;var w=wt;wt|=2;var j=O1();(Fr!==i||Mr!==o)&&(es=null,Hl=Ae()+500,Ai(i,o));do try{ej();break}catch(q){L1(i,q)}while(!0);Ld(),f0.current=j,wt=w,mr!==null?o=0:(Fr=null,Mr=0,o=Nr)}if(o!==0){if(o===2&&(w=Qh(i),w!==0&&(x=w,o=vf(i,w))),o===1)throw h=dc,Ai(i,0),Hs(i,x),xn(i,Ae()),h;if(o===6)Hs(i,x);else{if(w=i.current.alternate,(x&30)===0&&!JT(w)&&(o=b0(i,x),o===2&&(j=Qh(i),j!==0&&(x=j,o=vf(i,j))),o===1))throw h=dc,Ai(i,0),Hs(i,x),xn(i,Ae()),h;switch(i.finishedWork=w,i.finishedLanes=x,o){case 0:case 1:throw Error(r(345));case 2:Di(i,pn,es);break;case 3:if(Hs(i,x),(x&130023424)===x&&(o=xf+500-Ae(),10<o)){if(Cu(i,0)!==0)break;if(w=i.suspendedLanes,(w&x)!==x){nn(),i.pingedLanes|=i.suspendedLanes&w;break}i.timeoutHandle=kd(Di.bind(null,i,pn,es),o);break}Di(i,pn,es);break;case 4:if(Hs(i,x),(x&4194240)===x)break;for(o=i.eventTimes,w=-1;0<x;){var L=31-ur(x);j=1<<L,L=o[L],L>w&&(w=L),x&=~j}if(x=w,x=Ae()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*YT(x/1960))-x,10<x){i.timeoutHandle=kd(Di.bind(null,i,pn,es),x);break}Di(i,pn,es);break;case 5:Di(i,pn,es);break;default:throw Error(r(329))}}}return xn(i,Ae()),i.callbackNode===h?D1.bind(null,i):null}function vf(i,o){var h=fc;return i.current.memoizedState.isDehydrated&&(Ai(i,o).flags|=256),i=b0(i,o),i!==2&&(o=pn,pn=h,o!==null&&yf(o)),i}function yf(i){pn===null?pn=i:pn.push.apply(pn,i)}function JT(i){for(var o=i;;){if(o.flags&16384){var h=o.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var x=0;x<h.length;x++){var w=h[x],j=w.getSnapshot;w=w.value;try{if(!ia(j(),w))return!1}catch{return!1}}}if(h=o.child,o.subtreeFlags&16384&&h!==null)h.return=o,o=h;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Hs(i,o){for(o&=~pf,o&=~p0,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var h=31-ur(o),x=1<<h;i[h]=-1,o&=~x}}function P1(i){if((wt&6)!==0)throw Error(r(327));Ul();var o=Cu(i,0);if((o&1)===0)return xn(i,Ae()),null;var h=b0(i,o);if(i.tag!==0&&h===2){var x=Qh(i);x!==0&&(o=x,h=vf(i,x))}if(h===1)throw h=dc,Ai(i,0),Hs(i,o),xn(i,Ae()),h;if(h===6)throw Error(r(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,Di(i,pn,es),xn(i,Ae()),null}function bf(i,o){var h=wt;wt|=1;try{return i(o)}finally{wt=h,wt===0&&(Hl=Ae()+500,Gu&&Ps())}}function Fi(i){Ms!==null&&Ms.tag===0&&(wt&6)===0&&Ul();var o=wt;wt|=1;var h=Kn.transition,x=Et;try{if(Kn.transition=null,Et=1,i)return i()}finally{Et=x,Kn.transition=h,wt=o,(wt&6)===0&&Ps()}}function wf(){Dn=Bl.current,Kt(Bl)}function Ai(i,o){i.finishedWork=null,i.finishedLanes=0;var h=i.timeoutHandle;if(h!==-1&&(i.timeoutHandle=-1,CT(h)),mr!==null)for(h=mr.return;h!==null;){var x=h;switch(Ed(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&$u();break;case 3:Rl(),Kt(hn),Kt(Vr),Vd();break;case 5:Hd(x);break;case 4:Rl();break;case 13:Kt(Qt);break;case 19:Kt(Qt);break;case 10:Od(x.type._context);break;case 22:case 23:wf()}h=h.return}if(Fr=i,mr=i=Us(i.current,null),Mr=Dn=o,Nr=0,dc=null,pf=p0=Ei=0,pn=fc=null,_i!==null){for(o=0;o<_i.length;o++)if(h=_i[o],x=h.interleaved,x!==null){h.interleaved=null;var w=x.next,j=h.pending;if(j!==null){var L=j.next;j.next=w,x.next=L}h.pending=x}_i=null}return i}function L1(i,o){do{var h=mr;try{if(Ld(),n0.current=l0,a0){for(var x=Yt.memoizedState;x!==null;){var w=x.queue;w!==null&&(w.pending=null),x=x.next}a0=!1}if(Ci=0,Er=wr=Yt=null,ic=!1,lc=0,ff.current=null,h===null||h.return===null){Nr=1,dc=o,mr=null;break}e:{var j=i,L=h.return,q=h,re=o;if(o=Mr,q.flags|=32768,re!==null&&typeof re=="object"&&typeof re.then=="function"){var me=re,Ce=q,Fe=Ce.tag;if((Ce.mode&1)===0&&(Fe===0||Fe===11||Fe===15)){var Se=Ce.alternate;Se?(Ce.updateQueue=Se.updateQueue,Ce.memoizedState=Se.memoizedState,Ce.lanes=Se.lanes):(Ce.updateQueue=null,Ce.memoizedState=null)}var Ve=s1(L);if(Ve!==null){Ve.flags&=-257,i1(Ve,L,q,j,o),Ve.mode&1&&a1(j,me,o),o=Ve,re=me;var $e=o.updateQueue;if($e===null){var We=new Set;We.add(re),o.updateQueue=We}else $e.add(re);break e}else{if((o&1)===0){a1(j,me,o),Nf();break e}re=Error(r(426))}}else if(qt&&q.mode&1){var hr=s1(L);if(hr!==null){(hr.flags&65536)===0&&(hr.flags|=256),i1(hr,L,q,j,o),Dd(Il(re,q));break e}}j=re=Il(re,q),Nr!==4&&(Nr=2),fc===null?fc=[j]:fc.push(j),j=L;do{switch(j.tag){case 3:j.flags|=65536,o&=-o,j.lanes|=o;var ie=r1(j,re,o);Eg(j,ie);break e;case 1:q=re;var se=j.type,oe=j.stateNode;if((j.flags&128)===0&&(typeof se.getDerivedStateFromError=="function"||oe!==null&&typeof oe.componentDidCatch=="function"&&(Is===null||!Is.has(oe)))){j.flags|=65536,o&=-o,j.lanes|=o;var Pe=n1(j,q,o);Eg(j,Pe);break e}}j=j.return}while(j!==null)}I1(h)}catch(qe){o=qe,mr===h&&h!==null&&(mr=h=h.return);continue}break}while(!0)}function O1(){var i=f0.current;return f0.current=l0,i===null?l0:i}function Nf(){(Nr===0||Nr===3||Nr===2)&&(Nr=4),Fr===null||(Ei&268435455)===0&&(p0&268435455)===0||Hs(Fr,Mr)}function b0(i,o){var h=wt;wt|=2;var x=O1();(Fr!==i||Mr!==o)&&(es=null,Ai(i,o));do try{ZT();break}catch(w){L1(i,w)}while(!0);if(Ld(),wt=h,f0.current=x,mr!==null)throw Error(r(261));return Fr=null,Mr=0,Nr}function ZT(){for(;mr!==null;)R1(mr)}function ej(){for(;mr!==null&&!ze();)R1(mr)}function R1(i){var o=H1(i.alternate,i,Dn);i.memoizedProps=i.pendingProps,o===null?I1(i):mr=o,ff.current=null}function I1(i){var o=i;do{var h=o.alternate;if(i=o.return,(o.flags&32768)===0){if(h=WT(h,o,Dn),h!==null){mr=h;return}}else{if(h=GT(h,o),h!==null){h.flags&=32767,mr=h;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Nr=6,mr=null;return}}if(o=o.sibling,o!==null){mr=o;return}mr=o=i}while(o!==null);Nr===0&&(Nr=5)}function Di(i,o,h){var x=Et,w=Kn.transition;try{Kn.transition=null,Et=1,tj(i,o,h,x)}finally{Kn.transition=w,Et=x}return null}function tj(i,o,h,x){do Ul();while(Ms!==null);if((wt&6)!==0)throw Error(r(327));h=i.finishedWork;var w=i.finishedLanes;if(h===null)return null;if(i.finishedWork=null,i.finishedLanes=0,h===i.current)throw Error(r(177));i.callbackNode=null,i.callbackPriority=0;var j=h.lanes|h.childLanes;if(Ok(i,j),i===Fr&&(mr=Fr=null,Mr=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||m0||(m0=!0,U1(cr,function(){return Ul(),null})),j=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||j){j=Kn.transition,Kn.transition=null;var L=Et;Et=1;var q=wt;wt|=4,ff.current=null,XT(i,h),S1(h,i),wT(wd),Au=!!bd,wd=bd=null,i.current=h,QT(h),De(),wt=q,Et=L,Kn.transition=j}else i.current=h;if(m0&&(m0=!1,Ms=i,g0=w),j=i.pendingLanes,j===0&&(Is=null),Ro(h.stateNode),xn(i,Ae()),o!==null)for(x=i.onRecoverableError,h=0;h<o.length;h++)w=o[h],x(w.value,{componentStack:w.stack,digest:w.digest});if(x0)throw x0=!1,i=mf,mf=null,i;return(g0&1)!==0&&i.tag!==0&&Ul(),j=i.pendingLanes,(j&1)!==0?i===gf?pc++:(pc=0,gf=i):pc=0,Ps(),null}function Ul(){if(Ms!==null){var i=jm(g0),o=Kn.transition,h=Et;try{if(Kn.transition=null,Et=16>i?16:i,Ms===null)var x=!1;else{if(i=Ms,Ms=null,g0=0,(wt&6)!==0)throw Error(r(331));var w=wt;for(wt|=4,Ke=i.current;Ke!==null;){var j=Ke,L=j.child;if((Ke.flags&16)!==0){var q=j.deletions;if(q!==null){for(var re=0;re<q.length;re++){var me=q[re];for(Ke=me;Ke!==null;){var Ce=Ke;switch(Ce.tag){case 0:case 11:case 15:hc(8,Ce,j)}var Fe=Ce.child;if(Fe!==null)Fe.return=Ce,Ke=Fe;else for(;Ke!==null;){Ce=Ke;var Se=Ce.sibling,Ve=Ce.return;if(N1(Ce),Ce===me){Ke=null;break}if(Se!==null){Se.return=Ve,Ke=Se;break}Ke=Ve}}}var $e=j.alternate;if($e!==null){var We=$e.child;if(We!==null){$e.child=null;do{var hr=We.sibling;We.sibling=null,We=hr}while(We!==null)}}Ke=j}}if((j.subtreeFlags&2064)!==0&&L!==null)L.return=j,Ke=L;else e:for(;Ke!==null;){if(j=Ke,(j.flags&2048)!==0)switch(j.tag){case 0:case 11:case 15:hc(9,j,j.return)}var ie=j.sibling;if(ie!==null){ie.return=j.return,Ke=ie;break e}Ke=j.return}}var se=i.current;for(Ke=se;Ke!==null;){L=Ke;var oe=L.child;if((L.subtreeFlags&2064)!==0&&oe!==null)oe.return=L,Ke=oe;else e:for(L=se;Ke!==null;){if(q=Ke,(q.flags&2048)!==0)try{switch(q.tag){case 0:case 11:case 15:d0(9,q)}}catch(qe){rr(q,q.return,qe)}if(q===L){Ke=null;break e}var Pe=q.sibling;if(Pe!==null){Pe.return=q.return,Ke=Pe;break e}Ke=q.return}}if(wt=w,Ps(),Cr&&typeof Cr.onPostCommitFiberRoot=="function")try{Cr.onPostCommitFiberRoot(Ta,i)}catch{}x=!0}return x}finally{Et=h,Kn.transition=o}}return!1}function M1(i,o,h){o=Il(h,o),o=r1(i,o,1),i=Os(i,o,1),o=nn(),i!==null&&(Mo(i,1,o),xn(i,o))}function rr(i,o,h){if(i.tag===3)M1(i,i,h);else for(;o!==null;){if(o.tag===3){M1(o,i,h);break}else if(o.tag===1){var x=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Is===null||!Is.has(x))){i=Il(h,i),i=n1(o,i,1),o=Os(o,i,1),i=nn(),o!==null&&(Mo(o,1,i),xn(o,i));break}}o=o.return}}function rj(i,o,h){var x=i.pingCache;x!==null&&x.delete(o),o=nn(),i.pingedLanes|=i.suspendedLanes&h,Fr===i&&(Mr&h)===h&&(Nr===4||Nr===3&&(Mr&130023424)===Mr&&500>Ae()-xf?Ai(i,0):pf|=h),xn(i,o)}function B1(i,o){o===0&&((i.mode&1)===0?o=1:(o=Su,Su<<=1,(Su&130023424)===0&&(Su=4194304)));var h=nn();i=Ya(i,o),i!==null&&(Mo(i,o,h),xn(i,h))}function nj(i){var o=i.memoizedState,h=0;o!==null&&(h=o.retryLane),B1(i,h)}function aj(i,o){var h=0;switch(i.tag){case 13:var x=i.stateNode,w=i.memoizedState;w!==null&&(h=w.retryLane);break;case 19:x=i.stateNode;break;default:throw Error(r(314))}x!==null&&x.delete(o),B1(i,h)}var H1;H1=function(i,o,h){if(i!==null)if(i.memoizedProps!==o.pendingProps||hn.current)fn=!0;else{if((i.lanes&h)===0&&(o.flags&128)===0)return fn=!1,$T(i,o,h);fn=(i.flags&131072)!==0}else fn=!1,qt&&(o.flags&1048576)!==0&&yg(o,Xu,o.index);switch(o.lanes=0,o.tag){case 2:var x=o.type;u0(i,o),i=o.pendingProps;var w=El(o,Vr.current);Ol(o,h),w=$d(null,o,x,i,w,h);var j=Wd();return o.flags|=1,typeof w=="object"&&w!==null&&typeof w.render=="function"&&w.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,dn(x)?(j=!0,Wu(o)):j=!1,o.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,Md(o),w.updater=o0,o.stateNode=w,w._reactInternals=o,Jd(o,x,i,h),o=rf(null,o,x,!0,j,h)):(o.tag=0,qt&&j&&Cd(o),rn(null,o,w,h),o=o.child),o;case 16:x=o.elementType;e:{switch(u0(i,o),i=o.pendingProps,w=x._init,x=w(x._payload),o.type=x,w=o.tag=ij(x),i=oa(x,i),w){case 0:o=tf(null,o,x,i,h);break e;case 1:o=d1(null,o,x,i,h);break e;case 11:o=l1(null,o,x,i,h);break e;case 14:o=o1(null,o,x,oa(x.type,i),h);break e}throw Error(r(306,x,""))}return o;case 0:return x=o.type,w=o.pendingProps,w=o.elementType===x?w:oa(x,w),tf(i,o,x,w,h);case 1:return x=o.type,w=o.pendingProps,w=o.elementType===x?w:oa(x,w),d1(i,o,x,w,h);case 3:e:{if(f1(o),i===null)throw Error(r(387));x=o.pendingProps,j=o.memoizedState,w=j.element,Cg(i,o),t0(o,x,null,h);var L=o.memoizedState;if(x=L.element,j.isDehydrated)if(j={element:x,isDehydrated:!1,cache:L.cache,pendingSuspenseBoundaries:L.pendingSuspenseBoundaries,transitions:L.transitions},o.updateQueue.baseState=j,o.memoizedState=j,o.flags&256){w=Il(Error(r(423)),o),o=p1(i,o,x,h,w);break e}else if(x!==w){w=Il(Error(r(424)),o),o=p1(i,o,x,h,w);break e}else for(An=Fs(o.stateNode.containerInfo.firstChild),Fn=o,qt=!0,la=null,h=_g(o,null,x,h),o.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Dl(),x===w){o=Za(i,o,h);break e}rn(i,o,x,h)}o=o.child}return o;case 5:return Ag(o),i===null&&Ad(o),x=o.type,w=o.pendingProps,j=i!==null?i.memoizedProps:null,L=w.children,Nd(x,w)?L=null:j!==null&&Nd(x,j)&&(o.flags|=32),h1(i,o),rn(i,o,L,h),o.child;case 6:return i===null&&Ad(o),null;case 13:return x1(i,o,h);case 4:return Bd(o,o.stateNode.containerInfo),x=o.pendingProps,i===null?o.child=Pl(o,null,x,h):rn(i,o,x,h),o.child;case 11:return x=o.type,w=o.pendingProps,w=o.elementType===x?w:oa(x,w),l1(i,o,x,w,h);case 7:return rn(i,o,o.pendingProps,h),o.child;case 8:return rn(i,o,o.pendingProps.children,h),o.child;case 12:return rn(i,o,o.pendingProps.children,h),o.child;case 10:e:{if(x=o.type._context,w=o.pendingProps,j=o.memoizedProps,L=w.value,Vt(Ju,x._currentValue),x._currentValue=L,j!==null)if(ia(j.value,L)){if(j.children===w.children&&!hn.current){o=Za(i,o,h);break e}}else for(j=o.child,j!==null&&(j.return=o);j!==null;){var q=j.dependencies;if(q!==null){L=j.child;for(var re=q.firstContext;re!==null;){if(re.context===x){if(j.tag===1){re=Ja(-1,h&-h),re.tag=2;var me=j.updateQueue;if(me!==null){me=me.shared;var Ce=me.pending;Ce===null?re.next=re:(re.next=Ce.next,Ce.next=re),me.pending=re}}j.lanes|=h,re=j.alternate,re!==null&&(re.lanes|=h),Rd(j.return,h,o),q.lanes|=h;break}re=re.next}}else if(j.tag===10)L=j.type===o.type?null:j.child;else if(j.tag===18){if(L=j.return,L===null)throw Error(r(341));L.lanes|=h,q=L.alternate,q!==null&&(q.lanes|=h),Rd(L,h,o),L=j.sibling}else L=j.child;if(L!==null)L.return=j;else for(L=j;L!==null;){if(L===o){L=null;break}if(j=L.sibling,j!==null){j.return=L.return,L=j;break}L=L.return}j=L}rn(i,o,w.children,h),o=o.child}return o;case 9:return w=o.type,x=o.pendingProps.children,Ol(o,h),w=Vn(w),x=x(w),o.flags|=1,rn(i,o,x,h),o.child;case 14:return x=o.type,w=oa(x,o.pendingProps),w=oa(x.type,w),o1(i,o,x,w,h);case 15:return c1(i,o,o.type,o.pendingProps,h);case 17:return x=o.type,w=o.pendingProps,w=o.elementType===x?w:oa(x,w),u0(i,o),o.tag=1,dn(x)?(i=!0,Wu(o)):i=!1,Ol(o,h),e1(o,x,w),Jd(o,x,w,h),rf(null,o,x,!0,i,h);case 19:return g1(i,o,h);case 22:return u1(i,o,h)}throw Error(r(156,o.tag))};function U1(i,o){return Ee(i,o)}function sj(i,o,h,x){this.tag=i,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $n(i,o,h,x){return new sj(i,o,h,x)}function kf(i){return i=i.prototype,!(!i||!i.isReactComponent)}function ij(i){if(typeof i=="function")return kf(i)?1:0;if(i!=null){if(i=i.$$typeof,i===ee)return 11;if(i===Q)return 14}return 2}function Us(i,o){var h=i.alternate;return h===null?(h=$n(i.tag,o,i.key,i.mode),h.elementType=i.elementType,h.type=i.type,h.stateNode=i.stateNode,h.alternate=i,i.alternate=h):(h.pendingProps=o,h.type=i.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=i.flags&14680064,h.childLanes=i.childLanes,h.lanes=i.lanes,h.child=i.child,h.memoizedProps=i.memoizedProps,h.memoizedState=i.memoizedState,h.updateQueue=i.updateQueue,o=i.dependencies,h.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},h.sibling=i.sibling,h.index=i.index,h.ref=i.ref,h}function w0(i,o,h,x,w,j){var L=2;if(x=i,typeof i=="function")kf(i)&&(L=1);else if(typeof i=="string")L=5;else e:switch(i){case T:return Pi(h.children,w,j,o);case D:L=8,w|=8;break;case I:return i=$n(12,h,o,w|2),i.elementType=I,i.lanes=j,i;case ne:return i=$n(13,h,o,w),i.elementType=ne,i.lanes=j,i;case he:return i=$n(19,h,o,w),i.elementType=he,i.lanes=j,i;case Y:return N0(h,w,j,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case J:L=10;break e;case Z:L=9;break e;case ee:L=11;break e;case Q:L=14;break e;case xe:L=16,x=null;break e}throw Error(r(130,i==null?i:typeof i,""))}return o=$n(L,h,o,w),o.elementType=i,o.type=x,o.lanes=j,o}function Pi(i,o,h,x){return i=$n(7,i,x,o),i.lanes=h,i}function N0(i,o,h,x){return i=$n(22,i,x,o),i.elementType=Y,i.lanes=h,i.stateNode={isHidden:!1},i}function Tf(i,o,h){return i=$n(6,i,null,o),i.lanes=h,i}function jf(i,o,h){return o=$n(4,i.children!==null?i.children:[],i.key,o),o.lanes=h,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function lj(i,o,h,x,w){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yh(0),this.expirationTimes=Yh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yh(0),this.identifierPrefix=x,this.onRecoverableError=w,this.mutableSourceEagerHydrationData=null}function _f(i,o,h,x,w,j,L,q,re){return i=new lj(i,o,h,q,re),o===1?(o=1,j===!0&&(o|=8)):o=0,j=$n(3,null,null,o),i.current=j,j.stateNode=i,j.memoizedState={element:x,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},Md(j),i}function oj(i,o,h){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:F,key:x==null?null:""+x,children:i,containerInfo:o,implementation:h}}function V1(i){if(!i)return Ds;i=i._reactInternals;e:{if(W(i)!==i||i.tag!==1)throw Error(r(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(dn(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(r(171))}if(i.tag===1){var h=i.type;if(dn(h))return mg(i,h,o)}return o}function z1(i,o,h,x,w,j,L,q,re){return i=_f(h,x,!0,i,w,j,L,q,re),i.context=V1(null),h=i.current,x=nn(),w=Bs(h),j=Ja(x,w),j.callback=o??null,Os(h,j,w),i.current.lanes=w,Mo(i,w,x),xn(i,x),i}function k0(i,o,h,x){var w=o.current,j=nn(),L=Bs(w);return h=V1(h),o.context===null?o.context=h:o.pendingContext=h,o=Ja(j,L),o.payload={element:i},x=x===void 0?null:x,x!==null&&(o.callback=x),i=Os(w,o,L),i!==null&&(ha(i,w,L,j),e0(i,w,L)),L}function T0(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function K1(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var h=i.retryLane;i.retryLane=h!==0&&h<o?h:o}}function Sf(i,o){K1(i,o),(i=i.alternate)&&K1(i,o)}function cj(){return null}var $1=typeof reportError=="function"?reportError:function(i){console.error(i)};function Cf(i){this._internalRoot=i}j0.prototype.render=Cf.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(r(409));k0(i,o,null,null)},j0.prototype.unmount=Cf.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;Fi(function(){k0(null,i,null,null)}),o[Ga]=null}};function j0(i){this._internalRoot=i}j0.prototype.unstable_scheduleHydration=function(i){if(i){var o=Cm();i={blockedOn:null,target:i,priority:o};for(var h=0;h<Ss.length&&o!==0&&o<Ss[h].priority;h++);Ss.splice(h,0,i),h===0&&Am(i)}};function Ef(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function _0(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function W1(){}function uj(i,o,h,x,w){if(w){if(typeof x=="function"){var j=x;x=function(){var me=T0(L);j.call(me)}}var L=z1(o,x,i,0,null,!1,!1,"",W1);return i._reactRootContainer=L,i[Ga]=L.current,Jo(i.nodeType===8?i.parentNode:i),Fi(),L}for(;w=i.lastChild;)i.removeChild(w);if(typeof x=="function"){var q=x;x=function(){var me=T0(re);q.call(me)}}var re=_f(i,0,!1,null,null,!1,!1,"",W1);return i._reactRootContainer=re,i[Ga]=re.current,Jo(i.nodeType===8?i.parentNode:i),Fi(function(){k0(o,re,h,x)}),re}function S0(i,o,h,x,w){var j=h._reactRootContainer;if(j){var L=j;if(typeof w=="function"){var q=w;w=function(){var re=T0(L);q.call(re)}}k0(o,L,i,w)}else L=uj(h,o,i,w,x);return T0(L)}_m=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var h=Io(o.pendingLanes);h!==0&&(Jh(o,h|1),xn(o,Ae()),(wt&6)===0&&(Hl=Ae()+500,Ps()))}break;case 13:Fi(function(){var x=Ya(i,1);if(x!==null){var w=nn();ha(x,i,1,w)}}),Sf(i,1)}},Zh=function(i){if(i.tag===13){var o=Ya(i,134217728);if(o!==null){var h=nn();ha(o,i,134217728,h)}Sf(i,134217728)}},Sm=function(i){if(i.tag===13){var o=Bs(i),h=Ya(i,o);if(h!==null){var x=nn();ha(h,i,o,x)}Sf(i,o)}},Cm=function(){return Et},Em=function(i,o){var h=Et;try{return Et=i,o()}finally{Et=h}},vl=function(i,o,h){switch(o){case"input":if(Oe(i,h),o=h.name,h.type==="radio"&&o!=null){for(h=i;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<h.length;o++){var x=h[o];if(x!==i&&x.form===i.form){var w=Ku(x);if(!w)throw Error(r(90));G(x),Oe(x,w)}}}break;case"textarea":Re(i,h);break;case"select":o=h.value,o!=null&&_r(i,!!h.multiple,o,!1)}},ku=bf,Tu=Fi;var hj={usingClientEntryPoint:!1,Events:[tc,Sl,Ku,wu,Nu,bf]},xc={findFiberByHostInstance:Ni,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},dj={bundleType:xc.bundleType,version:xc.version,rendererPackageName:xc.rendererPackageName,rendererConfig:xc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:E.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=fe(i),i===null?null:i.stateNode},findFiberByHostInstance:xc.findFiberByHostInstance||cj,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var C0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!C0.isDisabled&&C0.supportsFiber)try{Ta=C0.inject(dj),Cr=C0}catch{}}return mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hj,mn.createPortal=function(i,o){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ef(o))throw Error(r(200));return oj(i,o,null,h)},mn.createRoot=function(i,o){if(!Ef(i))throw Error(r(299));var h=!1,x="",w=$1;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(x=o.identifierPrefix),o.onRecoverableError!==void 0&&(w=o.onRecoverableError)),o=_f(i,1,!1,null,null,h,!1,x,w),i[Ga]=o.current,Jo(i.nodeType===8?i.parentNode:i),new Cf(o)},mn.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=fe(o),i=i===null?null:i.stateNode,i},mn.flushSync=function(i){return Fi(i)},mn.hydrate=function(i,o,h){if(!_0(o))throw Error(r(200));return S0(null,i,o,!0,h)},mn.hydrateRoot=function(i,o,h){if(!Ef(i))throw Error(r(405));var x=h!=null&&h.hydratedSources||null,w=!1,j="",L=$1;if(h!=null&&(h.unstable_strictMode===!0&&(w=!0),h.identifierPrefix!==void 0&&(j=h.identifierPrefix),h.onRecoverableError!==void 0&&(L=h.onRecoverableError)),o=z1(o,null,i,1,h??null,w,!1,j,L),i[Ga]=o.current,Jo(i),x)for(i=0;i<x.length;i++)h=x[i],w=h._getVersion,w=w(h._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[h,w]:o.mutableSourceEagerHydrationData.push(h,w);return new j0(o)},mn.render=function(i,o,h){if(!_0(o))throw Error(r(200));return S0(null,i,o,!1,h)},mn.unmountComponentAtNode=function(i){if(!_0(i))throw Error(r(40));return i._reactRootContainer?(Fi(function(){S0(null,null,i,!1,function(){i._reactRootContainer=null,i[Ga]=null})}),!0):!1},mn.unstable_batchedUpdates=bf,mn.unstable_renderSubtreeIntoContainer=function(i,o,h,x){if(!_0(h))throw Error(r(200));if(i==null||i._reactInternals===void 0)throw Error(r(38));return S0(i,o,h,!1,x)},mn.version="18.3.1-next-f1338f8080-20240426",mn}var tv;function K2(){if(tv)return Pf.exports;tv=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Pf.exports=wj(),Pf.exports}var rv;function Nj(){if(rv)return F0;rv=1;var e=K2();return F0.createRoot=e.createRoot,F0.hydrateRoot=e.hydrateRoot,F0}var kj=Nj(),jo=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Tj={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Ws,ix,D2,jj=(D2=class{constructor(){Qe(this,Ws,Tj);Qe(this,ix,!1)}setTimeoutProvider(e){Ue(this,Ws,e)}setTimeout(e,t){return te(this,Ws).setTimeout(e,t)}clearTimeout(e){te(this,Ws).clearTimeout(e)}setInterval(e,t){return te(this,Ws).setInterval(e,t)}clearInterval(e){te(this,Ws).clearInterval(e)}},Ws=new WeakMap,ix=new WeakMap,D2),Ii=new jj;function _j(e){setTimeout(e,0)}var el=typeof window>"u"||"Deno"in globalThis;function ln(){}function Sj(e,t){return typeof e=="function"?e(t):e}function mp(e){return typeof e=="number"&&e>=0&&e!==1/0}function $2(e,t){return Math.max(e+(t||0)-Date.now(),0)}function ai(e,t){return typeof e=="function"?e(t):e}function ea(e,t){return typeof e=="function"?e(t):e}function nv(e,t){const{type:r="all",exact:n,fetchStatus:s,predicate:l,queryKey:c,stale:u}=e;if(c){if(n){if(t.queryHash!==cx(c,t.options))return!1}else if(!Ic(t.queryKey,c))return!1}if(r!=="all"){const d=t.isActive();if(r==="active"&&!d||r==="inactive"&&d)return!1}return!(typeof u=="boolean"&&t.isStale()!==u||s&&s!==t.state.fetchStatus||l&&!l(t))}function av(e,t){const{exact:r,status:n,predicate:s,mutationKey:l}=e;if(l){if(!t.options.mutationKey)return!1;if(r){if(tl(t.options.mutationKey)!==tl(l))return!1}else if(!Ic(t.options.mutationKey,l))return!1}return!(n&&t.state.status!==n||s&&!s(t))}function cx(e,t){return((t==null?void 0:t.queryKeyHashFn)||tl)(e)}function tl(e){return JSON.stringify(e,(t,r)=>gp(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function Ic(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>Ic(e[r],t[r])):!1}var Cj=Object.prototype.hasOwnProperty;function W2(e,t){if(e===t)return e;const r=sv(e)&&sv(t);if(!r&&!(gp(e)&&gp(t)))return t;const s=(r?e:Object.keys(e)).length,l=r?t:Object.keys(t),c=l.length,u=r?new Array(c):{};let d=0;for(let f=0;f<c;f++){const p=r?f:l[f],m=e[p],g=t[p];if(m===g){u[p]=m,(r?f<s:Cj.call(e,p))&&d++;continue}if(m===null||g===null||typeof m!="object"||typeof g!="object"){u[p]=g;continue}const b=W2(m,g);u[p]=b,b===m&&d++}return s===c&&d===s?e:u}function eh(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function sv(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function gp(e){if(!iv(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!iv(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function iv(e){return Object.prototype.toString.call(e)==="[object Object]"}function Ej(e){return new Promise(t=>{Ii.setTimeout(t,e)})}function vp(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?W2(e,t):t}function Fj(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function Aj(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var ux=Symbol();function G2(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===ux?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function hx(e,t){return typeof e=="function"?e(...t):!!e}function Dj(e,t,r){let n=!1,s;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(s??(s=t()),n||(n=!0,s.aborted?r():s.addEventListener("abort",r,{once:!0})),s)}),e}var Hi,Gs,ao,P2,Pj=(P2=class extends jo{constructor(){super();Qe(this,Hi);Qe(this,Gs);Qe(this,ao);Ue(this,ao,t=>{if(!el&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){te(this,Gs)||this.setEventListener(te(this,ao))}onUnsubscribe(){var t;this.hasListeners()||((t=te(this,Gs))==null||t.call(this),Ue(this,Gs,void 0))}setEventListener(t){var r;Ue(this,ao,t),(r=te(this,Gs))==null||r.call(this),Ue(this,Gs,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){te(this,Hi)!==t&&(Ue(this,Hi,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof te(this,Hi)=="boolean"?te(this,Hi):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Hi=new WeakMap,Gs=new WeakMap,ao=new WeakMap,P2),dx=new Pj;function yp(){let e,t;const r=new Promise((s,l)=>{e=s,t=l});r.status="pending",r.catch(()=>{});function n(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{n({status:"fulfilled",value:s}),e(s)},r.reject=s=>{n({status:"rejected",reason:s}),t(s)},r}var Lj=_j;function Oj(){let e=[],t=0,r=u=>{u()},n=u=>{u()},s=Lj;const l=u=>{t?e.push(u):s(()=>{r(u)})},c=()=>{const u=e;e=[],u.length&&s(()=>{n(()=>{u.forEach(d=>{r(d)})})})};return{batch:u=>{let d;t++;try{d=u()}finally{t--,t||c()}return d},batchCalls:u=>(...d)=>{l(()=>{u(...d)})},schedule:l,setNotifyFunction:u=>{r=u},setBatchNotifyFunction:u=>{n=u},setScheduler:u=>{s=u}}}var kr=Oj(),so,qs,io,L2,Rj=(L2=class extends jo{constructor(){super();Qe(this,so,!0);Qe(this,qs);Qe(this,io);Ue(this,io,t=>{if(!el&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){te(this,qs)||this.setEventListener(te(this,io))}onUnsubscribe(){var t;this.hasListeners()||((t=te(this,qs))==null||t.call(this),Ue(this,qs,void 0))}setEventListener(t){var r;Ue(this,io,t),(r=te(this,qs))==null||r.call(this),Ue(this,qs,t(this.setOnline.bind(this)))}setOnline(t){te(this,so)!==t&&(Ue(this,so,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return te(this,so)}},so=new WeakMap,qs=new WeakMap,io=new WeakMap,L2),th=new Rj;function Ij(e){return Math.min(1e3*2**e,3e4)}function q2(e){return(e??"online")==="online"?th.isOnline():!0}var bp=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function X2(e){let t=!1,r=0,n;const s=yp(),l=()=>s.status!=="pending",c=y=>{var N;if(!l()){const _=new bp(y);g(_),(N=e.onCancel)==null||N.call(e,_)}},u=()=>{t=!0},d=()=>{t=!1},f=()=>dx.isFocused()&&(e.networkMode==="always"||th.isOnline())&&e.canRun(),p=()=>q2(e.networkMode)&&e.canRun(),m=y=>{l()||(n==null||n(),s.resolve(y))},g=y=>{l()||(n==null||n(),s.reject(y))},b=()=>new Promise(y=>{var N;n=_=>{(l()||f())&&y(_)},(N=e.onPause)==null||N.call(e)}).then(()=>{var y;n=void 0,l()||(y=e.onContinue)==null||y.call(e)}),v=()=>{if(l())return;let y;const N=r===0?e.initialPromise:void 0;try{y=N??e.fn()}catch(_){y=Promise.reject(_)}Promise.resolve(y).then(m).catch(_=>{var F;if(l())return;const C=e.retry??(el?0:3),S=e.retryDelay??Ij,E=typeof S=="function"?S(r,_):S,O=C===!0||typeof C=="number"&&r<C||typeof C=="function"&&C(r,_);if(t||!O){g(_);return}r++,(F=e.onFail)==null||F.call(e,r,_),Ej(E).then(()=>f()?void 0:b()).then(()=>{t?g(_):v()})})};return{promise:s,status:()=>s.status,cancel:c,continue:()=>(n==null||n(),s),cancelRetry:u,continueRetry:d,canStart:p,start:()=>(p()?v():b().then(v),s)}}var Ui,O2,Q2=(O2=class{constructor(){Qe(this,Ui)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),mp(this.gcTime)&&Ue(this,Ui,Ii.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(el?1/0:300*1e3))}clearGcTimeout(){te(this,Ui)&&(Ii.clearTimeout(te(this,Ui)),Ue(this,Ui,void 0))}},Ui=new WeakMap,O2),Vi,lo,Jn,zi,Dr,ru,Ki,fa,rs,R2,Mj=(R2=class extends Q2{constructor(t){super();Qe(this,fa);Qe(this,Vi);Qe(this,lo);Qe(this,Jn);Qe(this,zi);Qe(this,Dr);Qe(this,ru);Qe(this,Ki);Ue(this,Ki,!1),Ue(this,ru,t.defaultOptions),this.setOptions(t.options),this.observers=[],Ue(this,zi,t.client),Ue(this,Jn,te(this,zi).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Ue(this,Vi,ov(this.options)),this.state=t.state??te(this,Vi),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=te(this,Dr))==null?void 0:t.promise}setOptions(t){if(this.options={...te(this,ru),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=ov(this.options);r.data!==void 0&&(this.setState(lv(r.data,r.dataUpdatedAt)),Ue(this,Vi,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&te(this,Jn).remove(this)}setData(t,r){const n=vp(this.state.data,t,this.options);return ft(this,fa,rs).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){ft(this,fa,rs).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,s;const r=(n=te(this,Dr))==null?void 0:n.promise;return(s=te(this,Dr))==null||s.cancel(t),r?r.then(ln).catch(ln):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(te(this,Vi))}isActive(){return this.observers.some(t=>ea(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===ux||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>ai(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!$2(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=te(this,Dr))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=te(this,Dr))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),te(this,Jn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(te(this,Dr)&&(te(this,Ki)?te(this,Dr).cancel({revert:!0}):te(this,Dr).cancelRetry()),this.scheduleGc()),te(this,Jn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ft(this,fa,rs).call(this,{type:"invalidate"})}async fetch(t,r){var d,f,p,m,g,b,v,y,N,_,C,S;if(this.state.fetchStatus!=="idle"&&((d=te(this,Dr))==null?void 0:d.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(te(this,Dr))return te(this,Dr).continueRetry(),te(this,Dr).promise}if(t&&this.setOptions(t),!this.options.queryFn){const E=this.observers.find(O=>O.options.queryFn);E&&this.setOptions(E.options)}const n=new AbortController,s=E=>{Object.defineProperty(E,"signal",{enumerable:!0,get:()=>(Ue(this,Ki,!0),n.signal)})},l=()=>{const E=G2(this.options,r),F=(()=>{const T={client:te(this,zi),queryKey:this.queryKey,meta:this.meta};return s(T),T})();return Ue(this,Ki,!1),this.options.persister?this.options.persister(E,F,this):E(F)},u=(()=>{const E={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:te(this,zi),state:this.state,fetchFn:l};return s(E),E})();(f=this.options.behavior)==null||f.onFetch(u,this),Ue(this,lo,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((p=u.fetchOptions)==null?void 0:p.meta))&&ft(this,fa,rs).call(this,{type:"fetch",meta:(m=u.fetchOptions)==null?void 0:m.meta}),Ue(this,Dr,X2({initialPromise:r==null?void 0:r.initialPromise,fn:u.fetchFn,onCancel:E=>{E instanceof bp&&E.revert&&this.setState({...te(this,lo),fetchStatus:"idle"}),n.abort()},onFail:(E,O)=>{ft(this,fa,rs).call(this,{type:"failed",failureCount:E,error:O})},onPause:()=>{ft(this,fa,rs).call(this,{type:"pause"})},onContinue:()=>{ft(this,fa,rs).call(this,{type:"continue"})},retry:u.options.retry,retryDelay:u.options.retryDelay,networkMode:u.options.networkMode,canRun:()=>!0}));try{const E=await te(this,Dr).start();if(E===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(E),(b=(g=te(this,Jn).config).onSuccess)==null||b.call(g,E,this),(y=(v=te(this,Jn).config).onSettled)==null||y.call(v,E,this.state.error,this),E}catch(E){if(E instanceof bp){if(E.silent)return te(this,Dr).promise;if(E.revert){if(this.state.data===void 0)throw E;return this.state.data}}throw ft(this,fa,rs).call(this,{type:"error",error:E}),(_=(N=te(this,Jn).config).onError)==null||_.call(N,E,this),(S=(C=te(this,Jn).config).onSettled)==null||S.call(C,this.state.data,E,this),E}finally{this.scheduleGc()}}},Vi=new WeakMap,lo=new WeakMap,Jn=new WeakMap,zi=new WeakMap,Dr=new WeakMap,ru=new WeakMap,Ki=new WeakMap,fa=new WeakSet,rs=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...Y2(n.data,this.options),fetchMeta:t.meta??null};case"success":const s={...n,...lv(t.data,t.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Ue(this,lo,t.manual?s:void 0),s;case"error":const l=t.error;return{...n,error:l,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),kr.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),te(this,Jn).notify({query:this,type:"updated",action:t})})},R2);function Y2(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:q2(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function lv(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function ov(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var gn,vt,nu,an,$i,oo,as,Xs,au,co,uo,Wi,Gi,Qs,ho,Ct,wc,wp,Np,kp,Tp,jp,_p,Sp,J2,I2,Bj=(I2=class extends jo{constructor(t,r){super();Qe(this,Ct);Qe(this,gn);Qe(this,vt);Qe(this,nu);Qe(this,an);Qe(this,$i);Qe(this,oo);Qe(this,as);Qe(this,Xs);Qe(this,au);Qe(this,co);Qe(this,uo);Qe(this,Wi);Qe(this,Gi);Qe(this,Qs);Qe(this,ho,new Set);this.options=r,Ue(this,gn,t),Ue(this,Xs,null),Ue(this,as,yp()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(te(this,vt).addObserver(this),cv(te(this,vt),this.options)?ft(this,Ct,wc).call(this):this.updateResult(),ft(this,Ct,Tp).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Cp(te(this,vt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Cp(te(this,vt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,ft(this,Ct,jp).call(this),ft(this,Ct,_p).call(this),te(this,vt).removeObserver(this)}setOptions(t){const r=this.options,n=te(this,vt);if(this.options=te(this,gn).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ea(this.options.enabled,te(this,vt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");ft(this,Ct,Sp).call(this),te(this,vt).setOptions(this.options),r._defaulted&&!eh(this.options,r)&&te(this,gn).getQueryCache().notify({type:"observerOptionsUpdated",query:te(this,vt),observer:this});const s=this.hasListeners();s&&uv(te(this,vt),n,this.options,r)&&ft(this,Ct,wc).call(this),this.updateResult(),s&&(te(this,vt)!==n||ea(this.options.enabled,te(this,vt))!==ea(r.enabled,te(this,vt))||ai(this.options.staleTime,te(this,vt))!==ai(r.staleTime,te(this,vt)))&&ft(this,Ct,wp).call(this);const l=ft(this,Ct,Np).call(this);s&&(te(this,vt)!==n||ea(this.options.enabled,te(this,vt))!==ea(r.enabled,te(this,vt))||l!==te(this,Qs))&&ft(this,Ct,kp).call(this,l)}getOptimisticResult(t){const r=te(this,gn).getQueryCache().build(te(this,gn),t),n=this.createResult(r,t);return Uj(this,n)&&(Ue(this,an,n),Ue(this,oo,this.options),Ue(this,$i,te(this,vt).state)),n}getCurrentResult(){return te(this,an)}trackResult(t,r){return new Proxy(t,{get:(n,s)=>(this.trackProp(s),r==null||r(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&te(this,as).status==="pending"&&te(this,as).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,s))})}trackProp(t){te(this,ho).add(t)}getCurrentQuery(){return te(this,vt)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=te(this,gn).defaultQueryOptions(t),n=te(this,gn).getQueryCache().build(te(this,gn),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return ft(this,Ct,wc).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),te(this,an)))}createResult(t,r){var I;const n=te(this,vt),s=this.options,l=te(this,an),c=te(this,$i),u=te(this,oo),f=t!==n?t.state:te(this,nu),{state:p}=t;let m={...p},g=!1,b;if(r._optimisticResults){const J=this.hasListeners(),Z=!J&&cv(t,r),ee=J&&uv(t,n,r,s);(Z||ee)&&(m={...m,...Y2(p.data,t.options)}),r._optimisticResults==="isRestoring"&&(m.fetchStatus="idle")}let{error:v,errorUpdatedAt:y,status:N}=m;b=m.data;let _=!1;if(r.placeholderData!==void 0&&b===void 0&&N==="pending"){let J;l!=null&&l.isPlaceholderData&&r.placeholderData===(u==null?void 0:u.placeholderData)?(J=l.data,_=!0):J=typeof r.placeholderData=="function"?r.placeholderData((I=te(this,uo))==null?void 0:I.state.data,te(this,uo)):r.placeholderData,J!==void 0&&(N="success",b=vp(l==null?void 0:l.data,J,r),g=!0)}if(r.select&&b!==void 0&&!_)if(l&&b===(c==null?void 0:c.data)&&r.select===te(this,au))b=te(this,co);else try{Ue(this,au,r.select),b=r.select(b),b=vp(l==null?void 0:l.data,b,r),Ue(this,co,b),Ue(this,Xs,null)}catch(J){Ue(this,Xs,J)}te(this,Xs)&&(v=te(this,Xs),b=te(this,co),y=Date.now(),N="error");const C=m.fetchStatus==="fetching",S=N==="pending",E=N==="error",O=S&&C,F=b!==void 0,D={status:N,fetchStatus:m.fetchStatus,isPending:S,isSuccess:N==="success",isError:E,isInitialLoading:O,isLoading:O,data:b,dataUpdatedAt:m.dataUpdatedAt,error:v,errorUpdatedAt:y,failureCount:m.fetchFailureCount,failureReason:m.fetchFailureReason,errorUpdateCount:m.errorUpdateCount,isFetched:m.dataUpdateCount>0||m.errorUpdateCount>0,isFetchedAfterMount:m.dataUpdateCount>f.dataUpdateCount||m.errorUpdateCount>f.errorUpdateCount,isFetching:C,isRefetching:C&&!S,isLoadingError:E&&!F,isPaused:m.fetchStatus==="paused",isPlaceholderData:g,isRefetchError:E&&F,isStale:fx(t,r),refetch:this.refetch,promise:te(this,as),isEnabled:ea(r.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const J=ne=>{D.status==="error"?ne.reject(D.error):D.data!==void 0&&ne.resolve(D.data)},Z=()=>{const ne=Ue(this,as,D.promise=yp());J(ne)},ee=te(this,as);switch(ee.status){case"pending":t.queryHash===n.queryHash&&J(ee);break;case"fulfilled":(D.status==="error"||D.data!==ee.value)&&Z();break;case"rejected":(D.status!=="error"||D.error!==ee.reason)&&Z();break}}return D}updateResult(){const t=te(this,an),r=this.createResult(te(this,vt),this.options);if(Ue(this,$i,te(this,vt).state),Ue(this,oo,this.options),te(this,$i).data!==void 0&&Ue(this,uo,te(this,vt)),eh(r,t))return;Ue(this,an,r);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,l=typeof s=="function"?s():s;if(l==="all"||!l&&!te(this,ho).size)return!0;const c=new Set(l??te(this,ho));return this.options.throwOnError&&c.add("error"),Object.keys(te(this,an)).some(u=>{const d=u;return te(this,an)[d]!==t[d]&&c.has(d)})};ft(this,Ct,J2).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&ft(this,Ct,Tp).call(this)}},gn=new WeakMap,vt=new WeakMap,nu=new WeakMap,an=new WeakMap,$i=new WeakMap,oo=new WeakMap,as=new WeakMap,Xs=new WeakMap,au=new WeakMap,co=new WeakMap,uo=new WeakMap,Wi=new WeakMap,Gi=new WeakMap,Qs=new WeakMap,ho=new WeakMap,Ct=new WeakSet,wc=function(t){ft(this,Ct,Sp).call(this);let r=te(this,vt).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(ln)),r},wp=function(){ft(this,Ct,jp).call(this);const t=ai(this.options.staleTime,te(this,vt));if(el||te(this,an).isStale||!mp(t))return;const n=$2(te(this,an).dataUpdatedAt,t)+1;Ue(this,Wi,Ii.setTimeout(()=>{te(this,an).isStale||this.updateResult()},n))},Np=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(te(this,vt)):this.options.refetchInterval)??!1},kp=function(t){ft(this,Ct,_p).call(this),Ue(this,Qs,t),!(el||ea(this.options.enabled,te(this,vt))===!1||!mp(te(this,Qs))||te(this,Qs)===0)&&Ue(this,Gi,Ii.setInterval(()=>{(this.options.refetchIntervalInBackground||dx.isFocused())&&ft(this,Ct,wc).call(this)},te(this,Qs)))},Tp=function(){ft(this,Ct,wp).call(this),ft(this,Ct,kp).call(this,ft(this,Ct,Np).call(this))},jp=function(){te(this,Wi)&&(Ii.clearTimeout(te(this,Wi)),Ue(this,Wi,void 0))},_p=function(){te(this,Gi)&&(Ii.clearInterval(te(this,Gi)),Ue(this,Gi,void 0))},Sp=function(){const t=te(this,gn).getQueryCache().build(te(this,gn),this.options);if(t===te(this,vt))return;const r=te(this,vt);Ue(this,vt,t),Ue(this,nu,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},J2=function(t){kr.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(te(this,an))}),te(this,gn).getQueryCache().notify({query:te(this,vt),type:"observerResultsUpdated"})})},I2);function Hj(e,t){return ea(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function cv(e,t){return Hj(e,t)||e.state.data!==void 0&&Cp(e,t,t.refetchOnMount)}function Cp(e,t,r){if(ea(t.enabled,e)!==!1&&ai(t.staleTime,e)!=="static"){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&fx(e,t)}return!1}function uv(e,t,r,n){return(e!==t||ea(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&fx(e,r)}function fx(e,t){return ea(t.enabled,e)!==!1&&e.isStaleByTime(ai(t.staleTime,e))}function Uj(e,t){return!eh(e.getCurrentResult(),t)}function hv(e){return{onFetch:(t,r)=>{var p,m,g,b,v;const n=t.options,s=(g=(m=(p=t.fetchOptions)==null?void 0:p.meta)==null?void 0:m.fetchMore)==null?void 0:g.direction,l=((b=t.state.data)==null?void 0:b.pages)||[],c=((v=t.state.data)==null?void 0:v.pageParams)||[];let u={pages:[],pageParams:[]},d=0;const f=async()=>{let y=!1;const N=S=>{Dj(S,()=>t.signal,()=>y=!0)},_=G2(t.options,t.fetchOptions),C=async(S,E,O)=>{if(y)return Promise.reject();if(E==null&&S.pages.length)return Promise.resolve(S);const T=(()=>{const Z={client:t.client,queryKey:t.queryKey,pageParam:E,direction:O?"backward":"forward",meta:t.options.meta};return N(Z),Z})(),D=await _(T),{maxPages:I}=t.options,J=O?Aj:Fj;return{pages:J(S.pages,D,I),pageParams:J(S.pageParams,E,I)}};if(s&&l.length){const S=s==="backward",E=S?Vj:dv,O={pages:l,pageParams:c},F=E(n,O);u=await C(O,F,S)}else{const S=e??l.length;do{const E=d===0?c[0]??n.initialPageParam:dv(n,u);if(d>0&&E==null)break;u=await C(u,E),d++}while(d<S)}return u};t.options.persister?t.fetchFn=()=>{var y,N;return(N=(y=t.options).persister)==null?void 0:N.call(y,f,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=f}}}function dv(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function Vj(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var su,La,sn,qi,Oa,Ks,M2,zj=(M2=class extends Q2{constructor(t){super();Qe(this,Oa);Qe(this,su);Qe(this,La);Qe(this,sn);Qe(this,qi);Ue(this,su,t.client),this.mutationId=t.mutationId,Ue(this,sn,t.mutationCache),Ue(this,La,[]),this.state=t.state||Z2(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){te(this,La).includes(t)||(te(this,La).push(t),this.clearGcTimeout(),te(this,sn).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Ue(this,La,te(this,La).filter(r=>r!==t)),this.scheduleGc(),te(this,sn).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){te(this,La).length||(this.state.status==="pending"?this.scheduleGc():te(this,sn).remove(this))}continue(){var t;return((t=te(this,qi))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var c,u,d,f,p,m,g,b,v,y,N,_,C,S,E,O,F,T,D,I;const r=()=>{ft(this,Oa,Ks).call(this,{type:"continue"})},n={client:te(this,su),meta:this.options.meta,mutationKey:this.options.mutationKey};Ue(this,qi,X2({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(J,Z)=>{ft(this,Oa,Ks).call(this,{type:"failed",failureCount:J,error:Z})},onPause:()=>{ft(this,Oa,Ks).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>te(this,sn).canRun(this)}));const s=this.state.status==="pending",l=!te(this,qi).canStart();try{if(s)r();else{ft(this,Oa,Ks).call(this,{type:"pending",variables:t,isPaused:l}),await((u=(c=te(this,sn).config).onMutate)==null?void 0:u.call(c,t,this,n));const Z=await((f=(d=this.options).onMutate)==null?void 0:f.call(d,t,n));Z!==this.state.context&&ft(this,Oa,Ks).call(this,{type:"pending",context:Z,variables:t,isPaused:l})}const J=await te(this,qi).start();return await((m=(p=te(this,sn).config).onSuccess)==null?void 0:m.call(p,J,t,this.state.context,this,n)),await((b=(g=this.options).onSuccess)==null?void 0:b.call(g,J,t,this.state.context,n)),await((y=(v=te(this,sn).config).onSettled)==null?void 0:y.call(v,J,null,this.state.variables,this.state.context,this,n)),await((_=(N=this.options).onSettled)==null?void 0:_.call(N,J,null,t,this.state.context,n)),ft(this,Oa,Ks).call(this,{type:"success",data:J}),J}catch(J){try{await((S=(C=te(this,sn).config).onError)==null?void 0:S.call(C,J,t,this.state.context,this,n))}catch(Z){Promise.reject(Z)}try{await((O=(E=this.options).onError)==null?void 0:O.call(E,J,t,this.state.context,n))}catch(Z){Promise.reject(Z)}try{await((T=(F=te(this,sn).config).onSettled)==null?void 0:T.call(F,void 0,J,this.state.variables,this.state.context,this,n))}catch(Z){Promise.reject(Z)}try{await((I=(D=this.options).onSettled)==null?void 0:I.call(D,void 0,J,t,this.state.context,n))}catch(Z){Promise.reject(Z)}throw ft(this,Oa,Ks).call(this,{type:"error",error:J}),J}finally{te(this,sn).runNext(this)}}},su=new WeakMap,La=new WeakMap,sn=new WeakMap,qi=new WeakMap,Oa=new WeakSet,Ks=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),kr.batch(()=>{te(this,La).forEach(n=>{n.onMutationUpdate(t)}),te(this,sn).notify({mutation:this,type:"updated",action:t})})},M2);function Z2(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ss,pa,iu,B2,Kj=(B2=class extends jo{constructor(t={}){super();Qe(this,ss);Qe(this,pa);Qe(this,iu);this.config=t,Ue(this,ss,new Set),Ue(this,pa,new Map),Ue(this,iu,0)}build(t,r,n){const s=new zj({client:t,mutationCache:this,mutationId:++E0(this,iu)._,options:t.defaultMutationOptions(r),state:n});return this.add(s),s}add(t){te(this,ss).add(t);const r=A0(t);if(typeof r=="string"){const n=te(this,pa).get(r);n?n.push(t):te(this,pa).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(te(this,ss).delete(t)){const r=A0(t);if(typeof r=="string"){const n=te(this,pa).get(r);if(n)if(n.length>1){const s=n.indexOf(t);s!==-1&&n.splice(s,1)}else n[0]===t&&te(this,pa).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=A0(t);if(typeof r=="string"){const n=te(this,pa).get(r),s=n==null?void 0:n.find(l=>l.state.status==="pending");return!s||s===t}else return!0}runNext(t){var n;const r=A0(t);if(typeof r=="string"){const s=(n=te(this,pa).get(r))==null?void 0:n.find(l=>l!==t&&l.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){kr.batch(()=>{te(this,ss).forEach(t=>{this.notify({type:"removed",mutation:t})}),te(this,ss).clear(),te(this,pa).clear()})}getAll(){return Array.from(te(this,ss))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>av(r,n))}findAll(t={}){return this.getAll().filter(r=>av(t,r))}notify(t){kr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return kr.batch(()=>Promise.all(t.map(r=>r.continue().catch(ln))))}},ss=new WeakMap,pa=new WeakMap,iu=new WeakMap,B2);function A0(e){var t;return(t=e.options.scope)==null?void 0:t.id}var is,Ys,vn,ls,fs,q0,Ep,H2,$j=(H2=class extends jo{constructor(r,n){super();Qe(this,fs);Qe(this,is);Qe(this,Ys);Qe(this,vn);Qe(this,ls);Ue(this,is,r),this.setOptions(n),this.bindMethods(),ft(this,fs,q0).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var s;const n=this.options;this.options=te(this,is).defaultMutationOptions(r),eh(this.options,n)||te(this,is).getMutationCache().notify({type:"observerOptionsUpdated",mutation:te(this,vn),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&tl(n.mutationKey)!==tl(this.options.mutationKey)?this.reset():((s=te(this,vn))==null?void 0:s.state.status)==="pending"&&te(this,vn).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=te(this,vn))==null||r.removeObserver(this)}onMutationUpdate(r){ft(this,fs,q0).call(this),ft(this,fs,Ep).call(this,r)}getCurrentResult(){return te(this,Ys)}reset(){var r;(r=te(this,vn))==null||r.removeObserver(this),Ue(this,vn,void 0),ft(this,fs,q0).call(this),ft(this,fs,Ep).call(this)}mutate(r,n){var s;return Ue(this,ls,n),(s=te(this,vn))==null||s.removeObserver(this),Ue(this,vn,te(this,is).getMutationCache().build(te(this,is),this.options)),te(this,vn).addObserver(this),te(this,vn).execute(r)}},is=new WeakMap,Ys=new WeakMap,vn=new WeakMap,ls=new WeakMap,fs=new WeakSet,q0=function(){var n;const r=((n=te(this,vn))==null?void 0:n.state)??Z2();Ue(this,Ys,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},Ep=function(r){kr.batch(()=>{var n,s,l,c,u,d,f,p;if(te(this,ls)&&this.hasListeners()){const m=te(this,Ys).variables,g=te(this,Ys).context,b={client:te(this,is),meta:this.options.meta,mutationKey:this.options.mutationKey};if((r==null?void 0:r.type)==="success"){try{(s=(n=te(this,ls)).onSuccess)==null||s.call(n,r.data,m,g,b)}catch(v){Promise.reject(v)}try{(c=(l=te(this,ls)).onSettled)==null||c.call(l,r.data,null,m,g,b)}catch(v){Promise.reject(v)}}else if((r==null?void 0:r.type)==="error"){try{(d=(u=te(this,ls)).onError)==null||d.call(u,r.error,m,g,b)}catch(v){Promise.reject(v)}try{(p=(f=te(this,ls)).onSettled)==null||p.call(f,void 0,r.error,m,g,b)}catch(v){Promise.reject(v)}}}this.listeners.forEach(m=>{m(te(this,Ys))})})},H2),Ra,U2,Wj=(U2=class extends jo{constructor(t={}){super();Qe(this,Ra);this.config=t,Ue(this,Ra,new Map)}build(t,r,n){const s=r.queryKey,l=r.queryHash??cx(s,r);let c=this.get(l);return c||(c=new Mj({client:t,queryKey:s,queryHash:l,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(s)}),this.add(c)),c}add(t){te(this,Ra).has(t.queryHash)||(te(this,Ra).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=te(this,Ra).get(t.queryHash);r&&(t.destroy(),r===t&&te(this,Ra).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){kr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return te(this,Ra).get(t)}getAll(){return[...te(this,Ra).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>nv(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>nv(t,n)):r}notify(t){kr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){kr.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){kr.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Ra=new WeakMap,U2),nr,Js,Zs,fo,po,ei,xo,mo,V2,Gj=(V2=class{constructor(e={}){Qe(this,nr);Qe(this,Js);Qe(this,Zs);Qe(this,fo);Qe(this,po);Qe(this,ei);Qe(this,xo);Qe(this,mo);Ue(this,nr,e.queryCache||new Wj),Ue(this,Js,e.mutationCache||new Kj),Ue(this,Zs,e.defaultOptions||{}),Ue(this,fo,new Map),Ue(this,po,new Map),Ue(this,ei,0)}mount(){E0(this,ei)._++,te(this,ei)===1&&(Ue(this,xo,dx.subscribe(async e=>{e&&(await this.resumePausedMutations(),te(this,nr).onFocus())})),Ue(this,mo,th.subscribe(async e=>{e&&(await this.resumePausedMutations(),te(this,nr).onOnline())})))}unmount(){var e,t;E0(this,ei)._--,te(this,ei)===0&&((e=te(this,xo))==null||e.call(this),Ue(this,xo,void 0),(t=te(this,mo))==null||t.call(this),Ue(this,mo,void 0))}isFetching(e){return te(this,nr).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return te(this,Js).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=te(this,nr).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=te(this,nr).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(ai(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return te(this,nr).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),s=te(this,nr).get(n.queryHash),l=s==null?void 0:s.state.data,c=Sj(t,l);if(c!==void 0)return te(this,nr).build(this,n).setData(c,{...r,manual:!0})}setQueriesData(e,t,r){return kr.batch(()=>te(this,nr).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=te(this,nr).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=te(this,nr);kr.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=te(this,nr);return kr.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=kr.batch(()=>te(this,nr).findAll(e).map(s=>s.cancel(r)));return Promise.all(n).then(ln).catch(ln)}invalidateQueries(e,t={}){return kr.batch(()=>(te(this,nr).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=kr.batch(()=>te(this,nr).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let l=s.fetch(void 0,r);return r.throwOnError||(l=l.catch(ln)),s.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(n).then(ln)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=te(this,nr).build(this,t);return r.isStaleByTime(ai(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(ln).catch(ln)}fetchInfiniteQuery(e){return e.behavior=hv(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(ln).catch(ln)}ensureInfiniteQueryData(e){return e.behavior=hv(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return th.isOnline()?te(this,Js).resumePausedMutations():Promise.resolve()}getQueryCache(){return te(this,nr)}getMutationCache(){return te(this,Js)}getDefaultOptions(){return te(this,Zs)}setDefaultOptions(e){Ue(this,Zs,e)}setQueryDefaults(e,t){te(this,fo).set(tl(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...te(this,fo).values()],r={};return t.forEach(n=>{Ic(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){te(this,po).set(tl(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...te(this,po).values()],r={};return t.forEach(n=>{Ic(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...te(this,Zs).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=cx(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===ux&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...te(this,Zs).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){te(this,nr).clear(),te(this,Js).clear()}},nr=new WeakMap,Js=new WeakMap,Zs=new WeakMap,fo=new WeakMap,po=new WeakMap,ei=new WeakMap,xo=new WeakMap,mo=new WeakMap,V2),eb=P.createContext(void 0),Sn=e=>{const t=P.useContext(eb);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},qj=({client:e,children:t})=>(P.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(eb.Provider,{value:e,children:t})),tb=P.createContext(!1),Xj=()=>P.useContext(tb);tb.Provider;function Qj(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Yj=P.createContext(Qj()),Jj=()=>P.useContext(Yj),Zj=(e,t,r)=>{const n=r!=null&&r.state.error&&typeof e.throwOnError=="function"?hx(e.throwOnError,[r.state.error,r]):e.throwOnError;(e.suspense||e.experimental_prefetchInRender||n)&&(t.isReset()||(e.retryOnMount=!1))},e4=e=>{P.useEffect(()=>{e.clearReset()},[e])},t4=({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:s})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(s&&e.data===void 0||hx(r,[e.error,n])),r4=e=>{if(e.suspense){const r=s=>s==="static"?s:Math.max(s??1e3,1e3),n=e.staleTime;e.staleTime=typeof n=="function"?(...s)=>r(n(...s)):r(n),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},n4=(e,t)=>e.isLoading&&e.isFetching&&!t,a4=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,fv=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function s4(e,t,r){var g,b,v,y;const n=Xj(),s=Jj(),l=Sn(),c=l.defaultQueryOptions(e);(b=(g=l.getDefaultOptions().queries)==null?void 0:g._experimental_beforeQuery)==null||b.call(g,c);const u=l.getQueryCache().get(c.queryHash);c._optimisticResults=n?"isRestoring":"optimistic",r4(c),Zj(c,s,u),e4(s);const d=!l.getQueryCache().get(c.queryHash),[f]=P.useState(()=>new t(l,c)),p=f.getOptimisticResult(c),m=!n&&e.subscribed!==!1;if(P.useSyncExternalStore(P.useCallback(N=>{const _=m?f.subscribe(kr.batchCalls(N)):ln;return f.updateResult(),_},[f,m]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),P.useEffect(()=>{f.setOptions(c)},[c,f]),a4(c,p))throw fv(c,f,s);if(t4({result:p,errorResetBoundary:s,throwOnError:c.throwOnError,query:u,suspense:c.suspense}))throw p.error;if((y=(v=l.getDefaultOptions().queries)==null?void 0:v._experimental_afterQuery)==null||y.call(v,c,p),c.experimental_prefetchInRender&&!el&&n4(p,n)){const N=d?fv(c,f,s):u==null?void 0:u.promise;N==null||N.catch(ln).finally(()=>{f.updateResult()})}return c.notifyOnChangeProps?p:f.trackResult(p)}function Bt(e,t){return s4(e,Bj)}function ot(e,t){const r=Sn(),[n]=P.useState(()=>new $j(r,e));P.useEffect(()=>{n.setOptions(e)},[n,e]);const s=P.useSyncExternalStore(P.useCallback(c=>n.subscribe(kr.batchCalls(c)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),l=P.useCallback((c,u)=>{n.mutate(c,u).catch(ln)},[n]);if(s.error&&hx(n.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:l,mutateAsync:s.mutate}}K2();/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mc(){return Mc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mc.apply(this,arguments)}var ti;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(ti||(ti={}));const pv="popstate";function i4(e){e===void 0&&(e={});function t(n,s){let{pathname:l,search:c,hash:u}=n.location;return Fp("",{pathname:l,search:c,hash:u},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:rh(s)}return o4(t,r,null,e)}function fr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function px(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function l4(){return Math.random().toString(36).substr(2,8)}function xv(e,t){return{usr:e.state,key:e.key,idx:t}}function Fp(e,t,r,n){return r===void 0&&(r=null),Mc({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?_o(t):t,{state:r,key:t&&t.key||n||l4()})}function rh(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function _o(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function o4(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:l=!1}=n,c=s.history,u=ti.Pop,d=null,f=p();f==null&&(f=0,c.replaceState(Mc({},c.state,{idx:f}),""));function p(){return(c.state||{idx:null}).idx}function m(){u=ti.Pop;let N=p(),_=N==null?null:N-f;f=N,d&&d({action:u,location:y.location,delta:_})}function g(N,_){u=ti.Push;let C=Fp(y.location,N,_);f=p()+1;let S=xv(C,f),E=y.createHref(C);try{c.pushState(S,"",E)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(E)}l&&d&&d({action:u,location:y.location,delta:1})}function b(N,_){u=ti.Replace;let C=Fp(y.location,N,_);f=p();let S=xv(C,f),E=y.createHref(C);c.replaceState(S,"",E),l&&d&&d({action:u,location:y.location,delta:0})}function v(N){let _=s.location.origin!=="null"?s.location.origin:s.location.href,C=typeof N=="string"?N:rh(N);return C=C.replace(/ $/,"%20"),fr(_,"No window.location.(origin|href) available to create URL for href: "+C),new URL(C,_)}let y={get action(){return u},get location(){return e(s,c)},listen(N){if(d)throw new Error("A history only accepts one active listener");return s.addEventListener(pv,m),d=N,()=>{s.removeEventListener(pv,m),d=null}},createHref(N){return t(s,N)},createURL:v,encodeLocation(N){let _=v(N);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:g,replace:b,go(N){return c.go(N)}};return y}var mv;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(mv||(mv={}));function c4(e,t,r){return r===void 0&&(r="/"),u4(e,t,r)}function u4(e,t,r,n){let s=typeof t=="string"?_o(t):t,l=xx(s.pathname||"/",r);if(l==null)return null;let c=rb(e);h4(c);let u=null;for(let d=0;u==null&&d<c.length;++d){let f=k4(l);u=b4(c[d],f)}return u}function rb(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(l,c,u)=>{let d={relativePath:u===void 0?l.path||"":u,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};d.relativePath.startsWith("/")&&(fr(d.relativePath.startsWith(n),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(n.length));let f=si([n,d.relativePath]),p=r.concat(d);l.children&&l.children.length>0&&(fr(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+f+'".')),rb(l.children,t,p,f)),!(l.path==null&&!l.index)&&t.push({path:f,score:v4(f,l.index),routesMeta:p})};return e.forEach((l,c)=>{var u;if(l.path===""||!((u=l.path)!=null&&u.includes("?")))s(l,c);else for(let d of nb(l.path))s(l,c,d)}),t}function nb(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),l=r.replace(/\?$/,"");if(n.length===0)return s?[l,""]:[l];let c=nb(n.join("/")),u=[];return u.push(...c.map(d=>d===""?l:[l,d].join("/"))),s&&u.push(...c),u.map(d=>e.startsWith("/")&&d===""?"/":d)}function h4(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:y4(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const d4=/^:[\w-]+$/,f4=3,p4=2,x4=1,m4=10,g4=-2,gv=e=>e==="*";function v4(e,t){let r=e.split("/"),n=r.length;return r.some(gv)&&(n+=g4),t&&(n+=p4),r.filter(s=>!gv(s)).reduce((s,l)=>s+(d4.test(l)?f4:l===""?x4:m4),n)}function y4(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function b4(e,t,r){let{routesMeta:n}=e,s={},l="/",c=[];for(let u=0;u<n.length;++u){let d=n[u],f=u===n.length-1,p=l==="/"?t:t.slice(l.length)||"/",m=w4({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},p),g=d.route;if(!m)return null;Object.assign(s,m.params),c.push({params:s,pathname:si([l,m.pathname]),pathnameBase:C4(si([l,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(l=si([l,m.pathnameBase]))}return c}function w4(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=N4(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let l=s[0],c=l.replace(/(.)\/+$/,"$1"),u=s.slice(1);return{params:n.reduce((f,p,m)=>{let{paramName:g,isOptional:b}=p;if(g==="*"){let y=u[m]||"";c=l.slice(0,l.length-y.length).replace(/(.)\/+$/,"$1")}const v=u[m];return b&&!v?f[g]=void 0:f[g]=(v||"").replace(/%2F/g,"/"),f},{}),pathname:l,pathnameBase:c,pattern:e}}function N4(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),px(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,d)=>(n.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function k4(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return px(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function xx(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const T4=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,j4=e=>T4.test(e);function _4(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?_o(e):e,l;if(r)if(j4(r))l=r;else{if(r.includes("//")){let c=r;r=r.replace(/\/\/+/g,"/"),px(!1,"Pathnames cannot have embedded double slashes - normalizing "+(c+" -> "+r))}r.startsWith("/")?l=vv(r.substring(1),"/"):l=vv(r,t)}else l=t;return{pathname:l,search:E4(n),hash:F4(s)}}function vv(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Rf(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function S4(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function mx(e,t){let r=S4(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function gx(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=_o(e):(s=Mc({},e),fr(!s.pathname||!s.pathname.includes("?"),Rf("?","pathname","search",s)),fr(!s.pathname||!s.pathname.includes("#"),Rf("#","pathname","hash",s)),fr(!s.search||!s.search.includes("#"),Rf("#","search","hash",s)));let l=e===""||s.pathname==="",c=l?"/":s.pathname,u;if(c==null)u=r;else{let m=t.length-1;if(!n&&c.startsWith("..")){let g=c.split("/");for(;g[0]==="..";)g.shift(),m-=1;s.pathname=g.join("/")}u=m>=0?t[m]:"/"}let d=_4(s,u),f=c&&c!=="/"&&c.endsWith("/"),p=(l||c===".")&&r.endsWith("/");return!d.pathname.endsWith("/")&&(f||p)&&(d.pathname+="/"),d}const si=e=>e.join("/").replace(/\/\/+/g,"/"),C4=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),E4=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,F4=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function A4(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const ab=["post","put","patch","delete"];new Set(ab);const D4=["get",...ab];new Set(D4);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bc(){return Bc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bc.apply(this,arguments)}const vx=P.createContext(null),P4=P.createContext(null),di=P.createContext(null),Sh=P.createContext(null),Ua=P.createContext({outlet:null,matches:[],isDataRoute:!1}),sb=P.createContext(null);function L4(e,t){let{relative:r}=t===void 0?{}:t;So()||fr(!1);let{basename:n,navigator:s}=P.useContext(di),{hash:l,pathname:c,search:u}=lb(e,{relative:r}),d=c;return n!=="/"&&(d=c==="/"?n:si([n,c])),s.createHref({pathname:d,search:u,hash:l})}function So(){return P.useContext(Sh)!=null}function ul(){return So()||fr(!1),P.useContext(Sh).location}function ib(e){P.useContext(di).static||P.useLayoutEffect(e)}function fi(){let{isDataRoute:e}=P.useContext(Ua);return e?X4():O4()}function O4(){So()||fr(!1);let e=P.useContext(vx),{basename:t,future:r,navigator:n}=P.useContext(di),{matches:s}=P.useContext(Ua),{pathname:l}=ul(),c=JSON.stringify(mx(s,r.v7_relativeSplatPath)),u=P.useRef(!1);return ib(()=>{u.current=!0}),P.useCallback(function(f,p){if(p===void 0&&(p={}),!u.current)return;if(typeof f=="number"){n.go(f);return}let m=gx(f,JSON.parse(c),l,p.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:si([t,m.pathname])),(p.replace?n.replace:n.push)(m,p.state,p)},[t,n,c,l,e])}const R4=P.createContext(null);function I4(e){let t=P.useContext(Ua).outlet;return t&&P.createElement(R4.Provider,{value:e},t)}function yx(){let{matches:e}=P.useContext(Ua),t=e[e.length-1];return t?t.params:{}}function lb(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=P.useContext(di),{matches:s}=P.useContext(Ua),{pathname:l}=ul(),c=JSON.stringify(mx(s,n.v7_relativeSplatPath));return P.useMemo(()=>gx(e,JSON.parse(c),l,r==="path"),[e,c,l,r])}function M4(e,t){return B4(e,t)}function B4(e,t,r,n){So()||fr(!1);let{navigator:s}=P.useContext(di),{matches:l}=P.useContext(Ua),c=l[l.length-1],u=c?c.params:{};c&&c.pathname;let d=c?c.pathnameBase:"/";c&&c.route;let f=ul(),p;if(t){var m;let N=typeof t=="string"?_o(t):t;d==="/"||(m=N.pathname)!=null&&m.startsWith(d)||fr(!1),p=N}else p=f;let g=p.pathname||"/",b=g;if(d!=="/"){let N=d.replace(/^\//,"").split("/");b="/"+g.replace(/^\//,"").split("/").slice(N.length).join("/")}let v=c4(e,{pathname:b}),y=K4(v&&v.map(N=>Object.assign({},N,{params:Object.assign({},u,N.params),pathname:si([d,s.encodeLocation?s.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?d:si([d,s.encodeLocation?s.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),l,r,n);return t&&y?P.createElement(Sh.Provider,{value:{location:Bc({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:ti.Pop}},y):y}function H4(){let e=q4(),t=A4(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},t),r?P.createElement("pre",{style:s},r):null,null)}const U4=P.createElement(H4,null);class V4 extends P.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?P.createElement(Ua.Provider,{value:this.props.routeContext},P.createElement(sb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function z4(e){let{routeContext:t,match:r,children:n}=e,s=P.useContext(vx);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),P.createElement(Ua.Provider,{value:t},n)}function K4(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var l;if(!r)return null;if(r.errors)e=r.matches;else if((l=n)!=null&&l.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let c=e,u=(s=r)==null?void 0:s.errors;if(u!=null){let p=c.findIndex(m=>m.route.id&&(u==null?void 0:u[m.route.id])!==void 0);p>=0||fr(!1),c=c.slice(0,Math.min(c.length,p+1))}let d=!1,f=-1;if(r&&n&&n.v7_partialHydration)for(let p=0;p<c.length;p++){let m=c[p];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(f=p),m.route.id){let{loaderData:g,errors:b}=r,v=m.route.loader&&g[m.route.id]===void 0&&(!b||b[m.route.id]===void 0);if(m.route.lazy||v){d=!0,f>=0?c=c.slice(0,f+1):c=[c[0]];break}}}return c.reduceRight((p,m,g)=>{let b,v=!1,y=null,N=null;r&&(b=u&&m.route.id?u[m.route.id]:void 0,y=m.route.errorElement||U4,d&&(f<0&&g===0?(Q4("route-fallback"),v=!0,N=null):f===g&&(v=!0,N=m.route.hydrateFallbackElement||null)));let _=t.concat(c.slice(0,g+1)),C=()=>{let S;return b?S=y:v?S=N:m.route.Component?S=P.createElement(m.route.Component,null):m.route.element?S=m.route.element:S=p,P.createElement(z4,{match:m,routeContext:{outlet:p,matches:_,isDataRoute:r!=null},children:S})};return r&&(m.route.ErrorBoundary||m.route.errorElement||g===0)?P.createElement(V4,{location:r.location,revalidation:r.revalidation,component:y,error:b,children:C(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):C()},null)}var ob=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(ob||{}),cb=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(cb||{});function $4(e){let t=P.useContext(vx);return t||fr(!1),t}function W4(e){let t=P.useContext(P4);return t||fr(!1),t}function G4(e){let t=P.useContext(Ua);return t||fr(!1),t}function ub(e){let t=G4(),r=t.matches[t.matches.length-1];return r.route.id||fr(!1),r.route.id}function q4(){var e;let t=P.useContext(sb),r=W4(),n=ub();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function X4(){let{router:e}=$4(ob.UseNavigateStable),t=ub(cb.UseNavigateStable),r=P.useRef(!1);return ib(()=>{r.current=!0}),P.useCallback(function(s,l){l===void 0&&(l={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Bc({fromRouteId:t},l)))},[e,t])}const yv={};function Q4(e,t,r){yv[e]||(yv[e]=!0)}function Y4(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function J4(e){let{to:t,replace:r,state:n,relative:s}=e;So()||fr(!1);let{future:l,static:c}=P.useContext(di),{matches:u}=P.useContext(Ua),{pathname:d}=ul(),f=fi(),p=gx(t,mx(u,l.v7_relativeSplatPath),d,s==="path"),m=JSON.stringify(p);return P.useEffect(()=>f(JSON.parse(m),{replace:r,state:n,relative:s}),[f,m,s,r,n]),null}function Z4(e){return I4(e.context)}function Mt(e){fr(!1)}function e_(e){let{basename:t="/",children:r=null,location:n,navigationType:s=ti.Pop,navigator:l,static:c=!1,future:u}=e;So()&&fr(!1);let d=t.replace(/^\/*/,"/"),f=P.useMemo(()=>({basename:d,navigator:l,static:c,future:Bc({v7_relativeSplatPath:!1},u)}),[d,u,l,c]);typeof n=="string"&&(n=_o(n));let{pathname:p="/",search:m="",hash:g="",state:b=null,key:v="default"}=n,y=P.useMemo(()=>{let N=xx(p,d);return N==null?null:{location:{pathname:N,search:m,hash:g,state:b,key:v},navigationType:s}},[d,p,m,g,b,v,s]);return y==null?null:P.createElement(di.Provider,{value:f},P.createElement(Sh.Provider,{children:r,value:y}))}function t_(e){let{children:t,location:r}=e;return M4(Ap(t),r)}new Promise(()=>{});function Ap(e,t){t===void 0&&(t=[]);let r=[];return P.Children.forEach(e,(n,s)=>{if(!P.isValidElement(n))return;let l=[...t,s];if(n.type===P.Fragment){r.push.apply(r,Ap(n.props.children,l));return}n.type!==Mt&&fr(!1),!n.props.index||!n.props.children||fr(!1);let c={id:n.props.id||l.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(c.children=Ap(n.props.children,l)),r.push(c)}),r}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dp(){return Dp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dp.apply(this,arguments)}function r_(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,l;for(l=0;l<n.length;l++)s=n[l],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function n_(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function a_(e,t){return e.button===0&&(!t||t==="_self")&&!n_(e)}function Pp(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(s=>[r,s]):[[r,n]])},[]))}function s_(e,t){let r=Pp(e);return t&&t.forEach((n,s)=>{r.has(s)||t.getAll(s).forEach(l=>{r.append(s,l)})}),r}const i_=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],l_="6";try{window.__reactRouterVersion=l_}catch{}const o_="startTransition",bv=vj[o_];function c_(e){let{basename:t,children:r,future:n,window:s}=e,l=P.useRef();l.current==null&&(l.current=i4({window:s,v5Compat:!0}));let c=l.current,[u,d]=P.useState({action:c.action,location:c.location}),{v7_startTransition:f}=n||{},p=P.useCallback(m=>{f&&bv?bv(()=>d(m)):d(m)},[d,f]);return P.useLayoutEffect(()=>c.listen(p),[c,p]),P.useEffect(()=>Y4(n),[n]),P.createElement(e_,{basename:t,children:r,location:u.location,navigationType:u.action,navigator:c,future:n})}const u_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",h_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wn=P.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:l,replace:c,state:u,target:d,to:f,preventScrollReset:p,viewTransition:m}=t,g=r_(t,i_),{basename:b}=P.useContext(di),v,y=!1;if(typeof f=="string"&&h_.test(f)&&(v=f,u_))try{let S=new URL(window.location.href),E=f.startsWith("//")?new URL(S.protocol+f):new URL(f),O=xx(E.pathname,b);E.origin===S.origin&&O!=null?f=O+E.search+E.hash:y=!0}catch{}let N=L4(f,{relative:s}),_=d_(f,{replace:c,state:u,target:d,preventScrollReset:p,relative:s,viewTransition:m});function C(S){n&&n(S),S.defaultPrevented||_(S)}return P.createElement("a",Dp({},g,{href:v||N,onClick:y||l?n:C,ref:r,target:d}))});var wv;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(wv||(wv={}));var Nv;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Nv||(Nv={}));function d_(e,t){let{target:r,replace:n,state:s,preventScrollReset:l,relative:c,viewTransition:u}=t===void 0?{}:t,d=fi(),f=ul(),p=lb(e,{relative:c});return P.useCallback(m=>{if(a_(m,r)){m.preventDefault();let g=n!==void 0?n:rh(f)===rh(p);d(e,{replace:g,state:s,preventScrollReset:l,relative:c,viewTransition:u})}},[f,d,p,n,s,r,e,l,c,u])}function f_(e){let t=P.useRef(Pp(e)),r=P.useRef(!1),n=ul(),s=P.useMemo(()=>s_(n.search,r.current?null:t.current),[n.search]),l=fi(),c=P.useCallback((u,d)=>{const f=Pp(typeof u=="function"?u(s):u);r.current=!0,l("?"+f,d)},[l,s]);return[s,c]}let p_={data:""},x_=e=>{if(typeof window=="object"){let t=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return t.nonce=window.__nonce__,t.parentNode||(e||document.head).appendChild(t),t.firstChild}return e||p_},m_=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,g_=/\/\*[^]*?\*\/|  +/g,kv=/\n+/g,$s=(e,t)=>{let r="",n="",s="";for(let l in e){let c=e[l];l[0]=="@"?l[1]=="i"?r=l+" "+c+";":n+=l[1]=="f"?$s(c,l):l+"{"+$s(c,l[1]=="k"?"":t)+"}":typeof c=="object"?n+=$s(c,t?t.replace(/([^,])+/g,u=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,d=>/&/.test(d)?d.replace(/&/g,u):u?u+" "+d:d)):l):c!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=$s.p?$s.p(l,c):l+":"+c+";")}return r+(t&&s?t+"{"+s+"}":s)+n},ts={},hb=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+hb(e[r]);return t}return e},v_=(e,t,r,n,s)=>{let l=hb(e),c=ts[l]||(ts[l]=(d=>{let f=0,p=11;for(;f<d.length;)p=101*p+d.charCodeAt(f++)>>>0;return"go"+p})(l));if(!ts[c]){let d=l!==e?e:(f=>{let p,m,g=[{}];for(;p=m_.exec(f.replace(g_,""));)p[4]?g.shift():p[3]?(m=p[3].replace(kv," ").trim(),g.unshift(g[0][m]=g[0][m]||{})):g[0][p[1]]=p[2].replace(kv," ").trim();return g[0]})(e);ts[c]=$s(s?{["@keyframes "+c]:d}:d,r?"":"."+c)}let u=r&&ts.g?ts.g:null;return r&&(ts.g=ts[c]),((d,f,p,m)=>{m?f.data=f.data.replace(m,d):f.data.indexOf(d)===-1&&(f.data=p?d+f.data:f.data+d)})(ts[c],t,n,u),c},y_=(e,t,r)=>e.reduce((n,s,l)=>{let c=t[l];if(c&&c.call){let u=c(r),d=u&&u.props&&u.props.className||/^go/.test(u)&&u;c=d?"."+d:u&&typeof u=="object"?u.props?"":$s(u,""):u===!1?"":u}return n+s+(c??"")},"");function Ch(e){let t=this||{},r=e.call?e(t.p):e;return v_(r.unshift?r.raw?y_(r,[].slice.call(arguments,1),t.p):r.reduce((n,s)=>Object.assign(n,s&&s.call?s(t.p):s),{}):r,x_(t.target),t.g,t.o,t.k)}let db,Lp,Op;Ch.bind({g:1});let ps=Ch.bind({k:1});function b_(e,t,r,n){$s.p=t,db=e,Lp=r,Op=n}function pi(e,t){let r=this||{};return function(){let n=arguments;function s(l,c){let u=Object.assign({},l),d=u.className||s.className;r.p=Object.assign({theme:Lp&&Lp()},u),r.o=/ *go\d+/.test(d),u.className=Ch.apply(r,n)+(d?" "+d:"");let f=e;return e[0]&&(f=u.as||e,delete u.as),Op&&f[0]&&Op(u),db(f,u)}return s}}var w_=e=>typeof e=="function",nh=(e,t)=>w_(e)?e(t):e,N_=(()=>{let e=0;return()=>(++e).toString()})(),fb=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),k_=20,bx="default",pb=(e,t)=>{let{toastLimit:r}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,r)};case 1:return{...e,toasts:e.toasts.map(c=>c.id===t.toast.id?{...c,...t.toast}:c)};case 2:let{toast:n}=t;return pb(e,{type:e.toasts.find(c=>c.id===n.id)?1:0,toast:n});case 3:let{toastId:s}=t;return{...e,toasts:e.toasts.map(c=>c.id===s||s===void 0?{...c,dismissed:!0,visible:!1}:c)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(c=>c.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let l=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(c=>({...c,pauseDuration:c.pauseDuration+l}))}}},X0=[],xb={toasts:[],pausedAt:void 0,settings:{toastLimit:k_}},Ia={},mb=(e,t=bx)=>{Ia[t]=pb(Ia[t]||xb,e),X0.forEach(([r,n])=>{r===t&&n(Ia[t])})},gb=e=>Object.keys(Ia).forEach(t=>mb(e,t)),T_=e=>Object.keys(Ia).find(t=>Ia[t].toasts.some(r=>r.id===e)),Eh=(e=bx)=>t=>{mb(t,e)},j_={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},__=(e={},t=bx)=>{let[r,n]=P.useState(Ia[t]||xb),s=P.useRef(Ia[t]);P.useEffect(()=>(s.current!==Ia[t]&&n(Ia[t]),X0.push([t,n]),()=>{let c=X0.findIndex(([u])=>u===t);c>-1&&X0.splice(c,1)}),[t]);let l=r.toasts.map(c=>{var u,d,f;return{...e,...e[c.type],...c,removeDelay:c.removeDelay||((u=e[c.type])==null?void 0:u.removeDelay)||(e==null?void 0:e.removeDelay),duration:c.duration||((d=e[c.type])==null?void 0:d.duration)||(e==null?void 0:e.duration)||j_[c.type],style:{...e.style,...(f=e[c.type])==null?void 0:f.style,...c.style}}});return{...r,toasts:l}},S_=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||N_()}),lu=e=>(t,r)=>{let n=S_(t,e,r);return Eh(n.toasterId||T_(n.id))({type:2,toast:n}),n.id},pt=(e,t)=>lu("blank")(e,t);pt.error=lu("error");pt.success=lu("success");pt.loading=lu("loading");pt.custom=lu("custom");pt.dismiss=(e,t)=>{let r={type:3,toastId:e};t?Eh(t)(r):gb(r)};pt.dismissAll=e=>pt.dismiss(void 0,e);pt.remove=(e,t)=>{let r={type:4,toastId:e};t?Eh(t)(r):gb(r)};pt.removeAll=e=>pt.remove(void 0,e);pt.promise=(e,t,r)=>{let n=pt.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(s=>{let l=t.success?nh(t.success,s):void 0;return l?pt.success(l,{id:n,...r,...r==null?void 0:r.success}):pt.dismiss(n),s}).catch(s=>{let l=t.error?nh(t.error,s):void 0;l?pt.error(l,{id:n,...r,...r==null?void 0:r.error}):pt.dismiss(n)}),e};var C_=1e3,E_=(e,t="default")=>{let{toasts:r,pausedAt:n}=__(e,t),s=P.useRef(new Map).current,l=P.useCallback((m,g=C_)=>{if(s.has(m))return;let b=setTimeout(()=>{s.delete(m),c({type:4,toastId:m})},g);s.set(m,b)},[]);P.useEffect(()=>{if(n)return;let m=Date.now(),g=r.map(b=>{if(b.duration===1/0)return;let v=(b.duration||0)+b.pauseDuration-(m-b.createdAt);if(v<0){b.visible&&pt.dismiss(b.id);return}return setTimeout(()=>pt.dismiss(b.id,t),v)});return()=>{g.forEach(b=>b&&clearTimeout(b))}},[r,n,t]);let c=P.useCallback(Eh(t),[t]),u=P.useCallback(()=>{c({type:5,time:Date.now()})},[c]),d=P.useCallback((m,g)=>{c({type:1,toast:{id:m,height:g}})},[c]),f=P.useCallback(()=>{n&&c({type:6,time:Date.now()})},[n,c]),p=P.useCallback((m,g)=>{let{reverseOrder:b=!1,gutter:v=8,defaultPosition:y}=g||{},N=r.filter(S=>(S.position||y)===(m.position||y)&&S.height),_=N.findIndex(S=>S.id===m.id),C=N.filter((S,E)=>E<_&&S.visible).length;return N.filter(S=>S.visible).slice(...b?[C+1]:[0,C]).reduce((S,E)=>S+(E.height||0)+v,0)},[r]);return P.useEffect(()=>{r.forEach(m=>{if(m.dismissed)l(m.id,m.removeDelay);else{let g=s.get(m.id);g&&(clearTimeout(g),s.delete(m.id))}})},[r,l]),{toasts:r,handlers:{updateHeight:d,startPause:u,endPause:f,calculateOffset:p}}},F_=ps`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,A_=ps`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,D_=ps`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,P_=pi("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${F_} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${A_} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${D_} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,L_=ps`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,O_=pi("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${L_} 1s linear infinite;
`,R_=ps`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,I_=ps`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,M_=pi("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${R_} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${I_} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,B_=pi("div")`
  position: absolute;
`,H_=pi("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,U_=ps`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,V_=pi("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${U_} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,z_=({toast:e})=>{let{icon:t,type:r,iconTheme:n}=e;return t!==void 0?typeof t=="string"?P.createElement(V_,null,t):t:r==="blank"?null:P.createElement(H_,null,P.createElement(O_,{...n}),r!=="loading"&&P.createElement(B_,null,r==="error"?P.createElement(P_,{...n}):P.createElement(M_,{...n})))},K_=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,$_=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,W_="0%{opacity:0;} 100%{opacity:1;}",G_="0%{opacity:1;} 100%{opacity:0;}",q_=pi("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,X_=pi("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Q_=(e,t)=>{let r=e.includes("top")?1:-1,[n,s]=fb()?[W_,G_]:[K_(r),$_(r)];return{animation:t?`${ps(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${ps(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Y_=P.memo(({toast:e,position:t,style:r,children:n})=>{let s=e.height?Q_(e.position||t||"top-center",e.visible):{opacity:0},l=P.createElement(z_,{toast:e}),c=P.createElement(X_,{...e.ariaProps},nh(e.message,e));return P.createElement(q_,{className:e.className,style:{...s,...r,...e.style}},typeof n=="function"?n({icon:l,message:c}):P.createElement(P.Fragment,null,l,c))});b_(P.createElement);var J_=({id:e,className:t,style:r,onHeightUpdate:n,children:s})=>{let l=P.useCallback(c=>{if(c){let u=()=>{let d=c.getBoundingClientRect().height;n(e,d)};u(),new MutationObserver(u).observe(c,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return P.createElement("div",{ref:l,className:t,style:r},s)},Z_=(e,t)=>{let r=e.includes("top"),n=r?{top:0}:{bottom:0},s=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:fb()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...n,...s}},eS=Ch`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,D0=16,tS=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:n,children:s,toasterId:l,containerStyle:c,containerClassName:u})=>{let{toasts:d,handlers:f}=E_(r,l);return P.createElement("div",{"data-rht-toaster":l||"",style:{position:"fixed",zIndex:9999,top:D0,left:D0,right:D0,bottom:D0,pointerEvents:"none",...c},className:u,onMouseEnter:f.startPause,onMouseLeave:f.endPause},d.map(p=>{let m=p.position||t,g=f.calculateOffset(p,{reverseOrder:e,gutter:n,defaultPosition:t}),b=Z_(m,g);return P.createElement(J_,{id:p.id,key:p.id,onHeightUpdate:f.updateHeight,className:p.visible?eS:"",style:b},p.type==="custom"?nh(p.message,p):s?s(p):P.createElement(Y_,{toast:p,position:m}))}))},je=pt;/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var rS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nS=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Xe=(e,t)=>{const r=P.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:c,className:u="",children:d,...f},p)=>P.createElement("svg",{ref:p,...rS,width:s,height:s,stroke:n,strokeWidth:c?Number(l)*24/Number(s):l,className:["lucide",`lucide-${nS(e)}`,u].join(" "),...f},[...t.map(([m,g])=>P.createElement(m,g)),...Array.isArray(d)?d:[d]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wx=Xe("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jc=Xe("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nx=Xe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aS=Xe("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tv=Xe("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sS=Xe("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ou=Xe("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fh=Xe("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ah=Xe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ah=Xe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vb=Xe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iS=Xe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jv=Xe("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _c=Xe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lS=Xe("Cog",[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oS=Xe("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sh=Xe("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cS=Xe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rp=Xe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dh=Xe("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hc=Xe("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uS=Xe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hS=Xe("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _v=Xe("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dS=Xe("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ph=Xe("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fS=Xe("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pS=Xe("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xS=Xe("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=Xe("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yb=Xe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mS=Xe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bb=Xe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gS=Xe("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sv=Xe("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=Xe("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wb=Xe("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const go=Xe("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yS=Xe("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ha=Xe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ih=Xe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kx=Xe("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vo=Xe("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tx=Xe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bS=Xe("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yo=Xe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wS=Xe("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NS=Xe("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const li=Xe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nb=Xe("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kS=Xe("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kb=Xe("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zl=Xe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cv=Xe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=Xe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TS=Xe("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tb=Xe("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rl=Xe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function jb(e,t){return function(){return e.apply(t,arguments)}}const{toString:jS}=Object.prototype,{getPrototypeOf:jx}=Object,{iterator:Lh,toStringTag:_b}=Symbol,Oh=(e=>t=>{const r=jS.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Na=e=>(e=e.toLowerCase(),t=>Oh(t)===e),Rh=e=>t=>typeof t===e,{isArray:Co}=Array,bo=Rh("undefined");function cu(e){return e!==null&&!bo(e)&&e.constructor!==null&&!bo(e.constructor)&&Nn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Sb=Na("ArrayBuffer");function _S(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Sb(e.buffer),t}const SS=Rh("string"),Nn=Rh("function"),Cb=Rh("number"),uu=e=>e!==null&&typeof e=="object",CS=e=>e===!0||e===!1,Q0=e=>{if(Oh(e)!=="object")return!1;const t=jx(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(_b in e)&&!(Lh in e)},ES=e=>{if(!uu(e)||cu(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},FS=Na("Date"),AS=Na("File"),DS=Na("Blob"),PS=Na("FileList"),LS=e=>uu(e)&&Nn(e.pipe),OS=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Nn(e.append)&&((t=Oh(e))==="formdata"||t==="object"&&Nn(e.toString)&&e.toString()==="[object FormData]"))},RS=Na("URLSearchParams"),[IS,MS,BS,HS]=["ReadableStream","Request","Response","Headers"].map(Na),US=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function hu(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,s;if(typeof e!="object"&&(e=[e]),Co(e))for(n=0,s=e.length;n<s;n++)t.call(null,e[n],n,e);else{if(cu(e))return;const l=r?Object.getOwnPropertyNames(e):Object.keys(e),c=l.length;let u;for(n=0;n<c;n++)u=l[n],t.call(null,e[u],u,e)}}function Eb(e,t){if(cu(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,s;for(;n-- >0;)if(s=r[n],t===s.toLowerCase())return s;return null}const Mi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Fb=e=>!bo(e)&&e!==Mi;function Ip(){const{caseless:e,skipUndefined:t}=Fb(this)&&this||{},r={},n=(s,l)=>{const c=e&&Eb(r,l)||l;Q0(r[c])&&Q0(s)?r[c]=Ip(r[c],s):Q0(s)?r[c]=Ip({},s):Co(s)?r[c]=s.slice():(!t||!bo(s))&&(r[c]=s)};for(let s=0,l=arguments.length;s<l;s++)arguments[s]&&hu(arguments[s],n);return r}const VS=(e,t,r,{allOwnKeys:n}={})=>(hu(t,(s,l)=>{r&&Nn(s)?e[l]=jb(s,r):e[l]=s},{allOwnKeys:n}),e),zS=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),KS=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},$S=(e,t,r,n)=>{let s,l,c;const u={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),l=s.length;l-- >0;)c=s[l],(!n||n(c,e,t))&&!u[c]&&(t[c]=e[c],u[c]=!0);e=r!==!1&&jx(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},WS=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},GS=e=>{if(!e)return null;if(Co(e))return e;let t=e.length;if(!Cb(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},qS=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&jx(Uint8Array)),XS=(e,t)=>{const n=(e&&e[Lh]).call(e);let s;for(;(s=n.next())&&!s.done;){const l=s.value;t.call(e,l[0],l[1])}},QS=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},YS=Na("HTMLFormElement"),JS=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),Ev=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),ZS=Na("RegExp"),Ab=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};hu(r,(s,l)=>{let c;(c=t(s,l,e))!==!1&&(n[l]=c||s)}),Object.defineProperties(e,n)},eC=e=>{Ab(e,(t,r)=>{if(Nn(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(Nn(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},tC=(e,t)=>{const r={},n=s=>{s.forEach(l=>{r[l]=!0})};return Co(e)?n(e):n(String(e).split(t)),r},rC=()=>{},nC=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function aC(e){return!!(e&&Nn(e.append)&&e[_b]==="FormData"&&e[Lh])}const sC=e=>{const t=new Array(10),r=(n,s)=>{if(uu(n)){if(t.indexOf(n)>=0)return;if(cu(n))return n;if(!("toJSON"in n)){t[s]=n;const l=Co(n)?[]:{};return hu(n,(c,u)=>{const d=r(c,s+1);!bo(d)&&(l[u]=d)}),t[s]=void 0,l}}return n};return r(e,0)},iC=Na("AsyncFunction"),lC=e=>e&&(uu(e)||Nn(e))&&Nn(e.then)&&Nn(e.catch),Db=((e,t)=>e?setImmediate:t?((r,n)=>(Mi.addEventListener("message",({source:s,data:l})=>{s===Mi&&l===r&&n.length&&n.shift()()},!1),s=>{n.push(s),Mi.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Nn(Mi.postMessage)),oC=typeof queueMicrotask<"u"?queueMicrotask.bind(Mi):typeof process<"u"&&process.nextTick||Db,cC=e=>e!=null&&Nn(e[Lh]),ge={isArray:Co,isArrayBuffer:Sb,isBuffer:cu,isFormData:OS,isArrayBufferView:_S,isString:SS,isNumber:Cb,isBoolean:CS,isObject:uu,isPlainObject:Q0,isEmptyObject:ES,isReadableStream:IS,isRequest:MS,isResponse:BS,isHeaders:HS,isUndefined:bo,isDate:FS,isFile:AS,isBlob:DS,isRegExp:ZS,isFunction:Nn,isStream:LS,isURLSearchParams:RS,isTypedArray:qS,isFileList:PS,forEach:hu,merge:Ip,extend:VS,trim:US,stripBOM:zS,inherits:KS,toFlatObject:$S,kindOf:Oh,kindOfTest:Na,endsWith:WS,toArray:GS,forEachEntry:XS,matchAll:QS,isHTMLForm:YS,hasOwnProperty:Ev,hasOwnProp:Ev,reduceDescriptors:Ab,freezeMethods:eC,toObjectSet:tC,toCamelCase:JS,noop:rC,toFiniteNumber:nC,findKey:Eb,global:Mi,isContextDefined:Fb,isSpecCompliantForm:aC,toJSONObject:sC,isAsyncFn:iC,isThenable:lC,setImmediate:Db,asap:oC,isIterable:cC};function ct(e,t,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}ge.inherits(ct,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ge.toJSONObject(this.config),code:this.code,status:this.status}}});const Pb=ct.prototype,Lb={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Lb[e]={value:e}});Object.defineProperties(ct,Lb);Object.defineProperty(Pb,"isAxiosError",{value:!0});ct.from=(e,t,r,n,s,l)=>{const c=Object.create(Pb);ge.toFlatObject(e,c,function(p){return p!==Error.prototype},f=>f!=="isAxiosError");const u=e&&e.message?e.message:"Error",d=t==null&&e?e.code:t;return ct.call(c,u,d,r,n,s),e&&c.cause==null&&Object.defineProperty(c,"cause",{value:e,configurable:!0}),c.name=e&&e.name||"Error",l&&Object.assign(c,l),c};const uC=null;function Mp(e){return ge.isPlainObject(e)||ge.isArray(e)}function Ob(e){return ge.endsWith(e,"[]")?e.slice(0,-2):e}function Fv(e,t,r){return e?e.concat(t).map(function(s,l){return s=Ob(s),!r&&l?"["+s+"]":s}).join(r?".":""):t}function hC(e){return ge.isArray(e)&&!e.some(Mp)}const dC=ge.toFlatObject(ge,{},null,function(t){return/^is[A-Z]/.test(t)});function Ih(e,t,r){if(!ge.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=ge.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,N){return!ge.isUndefined(N[y])});const n=r.metaTokens,s=r.visitor||p,l=r.dots,c=r.indexes,d=(r.Blob||typeof Blob<"u"&&Blob)&&ge.isSpecCompliantForm(t);if(!ge.isFunction(s))throw new TypeError("visitor must be a function");function f(v){if(v===null)return"";if(ge.isDate(v))return v.toISOString();if(ge.isBoolean(v))return v.toString();if(!d&&ge.isBlob(v))throw new ct("Blob is not supported. Use a Buffer instead.");return ge.isArrayBuffer(v)||ge.isTypedArray(v)?d&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function p(v,y,N){let _=v;if(v&&!N&&typeof v=="object"){if(ge.endsWith(y,"{}"))y=n?y:y.slice(0,-2),v=JSON.stringify(v);else if(ge.isArray(v)&&hC(v)||(ge.isFileList(v)||ge.endsWith(y,"[]"))&&(_=ge.toArray(v)))return y=Ob(y),_.forEach(function(S,E){!(ge.isUndefined(S)||S===null)&&t.append(c===!0?Fv([y],E,l):c===null?y:y+"[]",f(S))}),!1}return Mp(v)?!0:(t.append(Fv(N,y,l),f(v)),!1)}const m=[],g=Object.assign(dC,{defaultVisitor:p,convertValue:f,isVisitable:Mp});function b(v,y){if(!ge.isUndefined(v)){if(m.indexOf(v)!==-1)throw Error("Circular reference detected in "+y.join("."));m.push(v),ge.forEach(v,function(_,C){(!(ge.isUndefined(_)||_===null)&&s.call(t,_,ge.isString(C)?C.trim():C,y,g))===!0&&b(_,y?y.concat(C):[C])}),m.pop()}}if(!ge.isObject(e))throw new TypeError("data must be an object");return b(e),t}function Av(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function _x(e,t){this._pairs=[],e&&Ih(e,this,t)}const Rb=_x.prototype;Rb.append=function(t,r){this._pairs.push([t,r])};Rb.toString=function(t){const r=t?function(n){return t.call(this,n,Av)}:Av;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function fC(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Ib(e,t,r){if(!t)return e;const n=r&&r.encode||fC;ge.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let l;if(s?l=s(t,r):l=ge.isURLSearchParams(t)?t.toString():new _x(t,r).toString(n),l){const c=e.indexOf("#");c!==-1&&(e=e.slice(0,c)),e+=(e.indexOf("?")===-1?"?":"&")+l}return e}class Dv{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ge.forEach(this.handlers,function(n){n!==null&&t(n)})}}const Mb={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},pC=typeof URLSearchParams<"u"?URLSearchParams:_x,xC=typeof FormData<"u"?FormData:null,mC=typeof Blob<"u"?Blob:null,gC={isBrowser:!0,classes:{URLSearchParams:pC,FormData:xC,Blob:mC},protocols:["http","https","file","blob","url","data"]},Sx=typeof window<"u"&&typeof document<"u",Bp=typeof navigator=="object"&&navigator||void 0,vC=Sx&&(!Bp||["ReactNative","NativeScript","NS"].indexOf(Bp.product)<0),yC=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",bC=Sx&&window.location.href||"http://localhost",wC=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Sx,hasStandardBrowserEnv:vC,hasStandardBrowserWebWorkerEnv:yC,navigator:Bp,origin:bC},Symbol.toStringTag,{value:"Module"})),Qr={...wC,...gC};function NC(e,t){return Ih(e,new Qr.classes.URLSearchParams,{visitor:function(r,n,s,l){return Qr.isNode&&ge.isBuffer(r)?(this.append(n,r.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...t})}function kC(e){return ge.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function TC(e){const t={},r=Object.keys(e);let n;const s=r.length;let l;for(n=0;n<s;n++)l=r[n],t[l]=e[l];return t}function Bb(e){function t(r,n,s,l){let c=r[l++];if(c==="__proto__")return!0;const u=Number.isFinite(+c),d=l>=r.length;return c=!c&&ge.isArray(s)?s.length:c,d?(ge.hasOwnProp(s,c)?s[c]=[s[c],n]:s[c]=n,!u):((!s[c]||!ge.isObject(s[c]))&&(s[c]=[]),t(r,n,s[c],l)&&ge.isArray(s[c])&&(s[c]=TC(s[c])),!u)}if(ge.isFormData(e)&&ge.isFunction(e.entries)){const r={};return ge.forEachEntry(e,(n,s)=>{t(kC(n),s,r,0)}),r}return null}function jC(e,t,r){if(ge.isString(e))try{return(t||JSON.parse)(e),ge.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const du={transitional:Mb,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,l=ge.isObject(t);if(l&&ge.isHTMLForm(t)&&(t=new FormData(t)),ge.isFormData(t))return s?JSON.stringify(Bb(t)):t;if(ge.isArrayBuffer(t)||ge.isBuffer(t)||ge.isStream(t)||ge.isFile(t)||ge.isBlob(t)||ge.isReadableStream(t))return t;if(ge.isArrayBufferView(t))return t.buffer;if(ge.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(l){if(n.indexOf("application/x-www-form-urlencoded")>-1)return NC(t,this.formSerializer).toString();if((u=ge.isFileList(t))||n.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return Ih(u?{"files[]":t}:t,d&&new d,this.formSerializer)}}return l||s?(r.setContentType("application/json",!1),jC(t)):t}],transformResponse:[function(t){const r=this.transitional||du.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(ge.isResponse(t)||ge.isReadableStream(t))return t;if(t&&ge.isString(t)&&(n&&!this.responseType||s)){const c=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(u){if(c)throw u.name==="SyntaxError"?ct.from(u,ct.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Qr.classes.FormData,Blob:Qr.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ge.forEach(["delete","get","head","post","put","patch"],e=>{du.headers[e]={}});const _C=ge.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),SC=e=>{const t={};let r,n,s;return e&&e.split(`
`).forEach(function(c){s=c.indexOf(":"),r=c.substring(0,s).trim().toLowerCase(),n=c.substring(s+1).trim(),!(!r||t[r]&&_C[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},Pv=Symbol("internals");function gc(e){return e&&String(e).trim().toLowerCase()}function Y0(e){return e===!1||e==null?e:ge.isArray(e)?e.map(Y0):String(e)}function CC(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const EC=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function If(e,t,r,n,s){if(ge.isFunction(n))return n.call(this,t,r);if(s&&(t=r),!!ge.isString(t)){if(ge.isString(n))return t.indexOf(n)!==-1;if(ge.isRegExp(n))return n.test(t)}}function FC(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function AC(e,t){const r=ge.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(s,l,c){return this[n].call(this,t,s,l,c)},configurable:!0})})}let kn=class{constructor(t){t&&this.set(t)}set(t,r,n){const s=this;function l(u,d,f){const p=gc(d);if(!p)throw new Error("header name must be a non-empty string");const m=ge.findKey(s,p);(!m||s[m]===void 0||f===!0||f===void 0&&s[m]!==!1)&&(s[m||d]=Y0(u))}const c=(u,d)=>ge.forEach(u,(f,p)=>l(f,p,d));if(ge.isPlainObject(t)||t instanceof this.constructor)c(t,r);else if(ge.isString(t)&&(t=t.trim())&&!EC(t))c(SC(t),r);else if(ge.isObject(t)&&ge.isIterable(t)){let u={},d,f;for(const p of t){if(!ge.isArray(p))throw TypeError("Object iterator must return a key-value pair");u[f=p[0]]=(d=u[f])?ge.isArray(d)?[...d,p[1]]:[d,p[1]]:p[1]}c(u,r)}else t!=null&&l(r,t,n);return this}get(t,r){if(t=gc(t),t){const n=ge.findKey(this,t);if(n){const s=this[n];if(!r)return s;if(r===!0)return CC(s);if(ge.isFunction(r))return r.call(this,s,n);if(ge.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=gc(t),t){const n=ge.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||If(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let s=!1;function l(c){if(c=gc(c),c){const u=ge.findKey(n,c);u&&(!r||If(n,n[u],u,r))&&(delete n[u],s=!0)}}return ge.isArray(t)?t.forEach(l):l(t),s}clear(t){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const l=r[n];(!t||If(this,this[l],l,t,!0))&&(delete this[l],s=!0)}return s}normalize(t){const r=this,n={};return ge.forEach(this,(s,l)=>{const c=ge.findKey(n,l);if(c){r[c]=Y0(s),delete r[l];return}const u=t?FC(l):String(l).trim();u!==l&&delete r[l],r[u]=Y0(s),n[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return ge.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=t&&ge.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(s=>n.set(s)),n}static accessor(t){const n=(this[Pv]=this[Pv]={accessors:{}}).accessors,s=this.prototype;function l(c){const u=gc(c);n[u]||(AC(s,c),n[u]=!0)}return ge.isArray(t)?t.forEach(l):l(t),this}};kn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ge.reduceDescriptors(kn.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});ge.freezeMethods(kn);function Mf(e,t){const r=this||du,n=t||r,s=kn.from(n.headers);let l=n.data;return ge.forEach(e,function(u){l=u.call(r,l,s.normalize(),t?t.status:void 0)}),s.normalize(),l}function Hb(e){return!!(e&&e.__CANCEL__)}function Eo(e,t,r){ct.call(this,e??"canceled",ct.ERR_CANCELED,t,r),this.name="CanceledError"}ge.inherits(Eo,ct,{__CANCEL__:!0});function Ub(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new ct("Request failed with status code "+r.status,[ct.ERR_BAD_REQUEST,ct.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function DC(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function PC(e,t){e=e||10;const r=new Array(e),n=new Array(e);let s=0,l=0,c;return t=t!==void 0?t:1e3,function(d){const f=Date.now(),p=n[l];c||(c=f),r[s]=d,n[s]=f;let m=l,g=0;for(;m!==s;)g+=r[m++],m=m%e;if(s=(s+1)%e,s===l&&(l=(l+1)%e),f-c<t)return;const b=p&&f-p;return b?Math.round(g*1e3/b):void 0}}function LC(e,t){let r=0,n=1e3/t,s,l;const c=(f,p=Date.now())=>{r=p,s=null,l&&(clearTimeout(l),l=null),e(...f)};return[(...f)=>{const p=Date.now(),m=p-r;m>=n?c(f,p):(s=f,l||(l=setTimeout(()=>{l=null,c(s)},n-m)))},()=>s&&c(s)]}const lh=(e,t,r=3)=>{let n=0;const s=PC(50,250);return LC(l=>{const c=l.loaded,u=l.lengthComputable?l.total:void 0,d=c-n,f=s(d),p=c<=u;n=c;const m={loaded:c,total:u,progress:u?c/u:void 0,bytes:d,rate:f||void 0,estimated:f&&u&&p?(u-c)/f:void 0,event:l,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(m)},r)},Lv=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},Ov=e=>(...t)=>ge.asap(()=>e(...t)),OC=Qr.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Qr.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Qr.origin),Qr.navigator&&/(msie|trident)/i.test(Qr.navigator.userAgent)):()=>!0,RC=Qr.hasStandardBrowserEnv?{write(e,t,r,n,s,l,c){if(typeof document>"u")return;const u=[`${e}=${encodeURIComponent(t)}`];ge.isNumber(r)&&u.push(`expires=${new Date(r).toUTCString()}`),ge.isString(n)&&u.push(`path=${n}`),ge.isString(s)&&u.push(`domain=${s}`),l===!0&&u.push("secure"),ge.isString(c)&&u.push(`SameSite=${c}`),document.cookie=u.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function IC(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function MC(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Vb(e,t,r){let n=!IC(t);return e&&(n||r==!1)?MC(e,t):t}const Rv=e=>e instanceof kn?{...e}:e;function nl(e,t){t=t||{};const r={};function n(f,p,m,g){return ge.isPlainObject(f)&&ge.isPlainObject(p)?ge.merge.call({caseless:g},f,p):ge.isPlainObject(p)?ge.merge({},p):ge.isArray(p)?p.slice():p}function s(f,p,m,g){if(ge.isUndefined(p)){if(!ge.isUndefined(f))return n(void 0,f,m,g)}else return n(f,p,m,g)}function l(f,p){if(!ge.isUndefined(p))return n(void 0,p)}function c(f,p){if(ge.isUndefined(p)){if(!ge.isUndefined(f))return n(void 0,f)}else return n(void 0,p)}function u(f,p,m){if(m in t)return n(f,p);if(m in e)return n(void 0,f)}const d={url:l,method:l,data:l,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:u,headers:(f,p,m)=>s(Rv(f),Rv(p),m,!0)};return ge.forEach(Object.keys({...e,...t}),function(p){const m=d[p]||s,g=m(e[p],t[p],p);ge.isUndefined(g)&&m!==u||(r[p]=g)}),r}const zb=e=>{const t=nl({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:l,headers:c,auth:u}=t;if(t.headers=c=kn.from(c),t.url=Ib(Vb(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&c.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),ge.isFormData(r)){if(Qr.hasStandardBrowserEnv||Qr.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if(ge.isFunction(r.getHeaders)){const d=r.getHeaders(),f=["content-type","content-length"];Object.entries(d).forEach(([p,m])=>{f.includes(p.toLowerCase())&&c.set(p,m)})}}if(Qr.hasStandardBrowserEnv&&(n&&ge.isFunction(n)&&(n=n(t)),n||n!==!1&&OC(t.url))){const d=s&&l&&RC.read(l);d&&c.set(s,d)}return t},BC=typeof XMLHttpRequest<"u",HC=BC&&function(e){return new Promise(function(r,n){const s=zb(e);let l=s.data;const c=kn.from(s.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:f}=s,p,m,g,b,v;function y(){b&&b(),v&&v(),s.cancelToken&&s.cancelToken.unsubscribe(p),s.signal&&s.signal.removeEventListener("abort",p)}let N=new XMLHttpRequest;N.open(s.method.toUpperCase(),s.url,!0),N.timeout=s.timeout;function _(){if(!N)return;const S=kn.from("getAllResponseHeaders"in N&&N.getAllResponseHeaders()),O={data:!u||u==="text"||u==="json"?N.responseText:N.response,status:N.status,statusText:N.statusText,headers:S,config:e,request:N};Ub(function(T){r(T),y()},function(T){n(T),y()},O),N=null}"onloadend"in N?N.onloadend=_:N.onreadystatechange=function(){!N||N.readyState!==4||N.status===0&&!(N.responseURL&&N.responseURL.indexOf("file:")===0)||setTimeout(_)},N.onabort=function(){N&&(n(new ct("Request aborted",ct.ECONNABORTED,e,N)),N=null)},N.onerror=function(E){const O=E&&E.message?E.message:"Network Error",F=new ct(O,ct.ERR_NETWORK,e,N);F.event=E||null,n(F),N=null},N.ontimeout=function(){let E=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const O=s.transitional||Mb;s.timeoutErrorMessage&&(E=s.timeoutErrorMessage),n(new ct(E,O.clarifyTimeoutError?ct.ETIMEDOUT:ct.ECONNABORTED,e,N)),N=null},l===void 0&&c.setContentType(null),"setRequestHeader"in N&&ge.forEach(c.toJSON(),function(E,O){N.setRequestHeader(O,E)}),ge.isUndefined(s.withCredentials)||(N.withCredentials=!!s.withCredentials),u&&u!=="json"&&(N.responseType=s.responseType),f&&([g,v]=lh(f,!0),N.addEventListener("progress",g)),d&&N.upload&&([m,b]=lh(d),N.upload.addEventListener("progress",m),N.upload.addEventListener("loadend",b)),(s.cancelToken||s.signal)&&(p=S=>{N&&(n(!S||S.type?new Eo(null,e,N):S),N.abort(),N=null)},s.cancelToken&&s.cancelToken.subscribe(p),s.signal&&(s.signal.aborted?p():s.signal.addEventListener("abort",p)));const C=DC(s.url);if(C&&Qr.protocols.indexOf(C)===-1){n(new ct("Unsupported protocol "+C+":",ct.ERR_BAD_REQUEST,e));return}N.send(l||null)})},UC=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,s;const l=function(f){if(!s){s=!0,u();const p=f instanceof Error?f:this.reason;n.abort(p instanceof ct?p:new Eo(p instanceof Error?p.message:p))}};let c=t&&setTimeout(()=>{c=null,l(new ct(`timeout ${t} of ms exceeded`,ct.ETIMEDOUT))},t);const u=()=>{e&&(c&&clearTimeout(c),c=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(l):f.removeEventListener("abort",l)}),e=null)};e.forEach(f=>f.addEventListener("abort",l));const{signal:d}=n;return d.unsubscribe=()=>ge.asap(u),d}},VC=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,s;for(;n<r;)s=n+t,yield e.slice(n,s),n=s},zC=async function*(e,t){for await(const r of KC(e))yield*VC(r,t)},KC=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},Iv=(e,t,r,n)=>{const s=zC(e,t);let l=0,c,u=d=>{c||(c=!0,n&&n(d))};return new ReadableStream({async pull(d){try{const{done:f,value:p}=await s.next();if(f){u(),d.close();return}let m=p.byteLength;if(r){let g=l+=m;r(g)}d.enqueue(new Uint8Array(p))}catch(f){throw u(f),f}},cancel(d){return u(d),s.return()}},{highWaterMark:2})},Mv=64*1024,{isFunction:P0}=ge,$C=(({Request:e,Response:t})=>({Request:e,Response:t}))(ge.global),{ReadableStream:Bv,TextEncoder:Hv}=ge.global,Uv=(e,...t)=>{try{return!!e(...t)}catch{return!1}},WC=e=>{e=ge.merge.call({skipUndefined:!0},$C,e);const{fetch:t,Request:r,Response:n}=e,s=t?P0(t):typeof fetch=="function",l=P0(r),c=P0(n);if(!s)return!1;const u=s&&P0(Bv),d=s&&(typeof Hv=="function"?(v=>y=>v.encode(y))(new Hv):async v=>new Uint8Array(await new r(v).arrayBuffer())),f=l&&u&&Uv(()=>{let v=!1;const y=new r(Qr.origin,{body:new Bv,method:"POST",get duplex(){return v=!0,"half"}}).headers.has("Content-Type");return v&&!y}),p=c&&u&&Uv(()=>ge.isReadableStream(new n("").body)),m={stream:p&&(v=>v.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(v=>{!m[v]&&(m[v]=(y,N)=>{let _=y&&y[v];if(_)return _.call(y);throw new ct(`Response type '${v}' is not supported`,ct.ERR_NOT_SUPPORT,N)})});const g=async v=>{if(v==null)return 0;if(ge.isBlob(v))return v.size;if(ge.isSpecCompliantForm(v))return(await new r(Qr.origin,{method:"POST",body:v}).arrayBuffer()).byteLength;if(ge.isArrayBufferView(v)||ge.isArrayBuffer(v))return v.byteLength;if(ge.isURLSearchParams(v)&&(v=v+""),ge.isString(v))return(await d(v)).byteLength},b=async(v,y)=>{const N=ge.toFiniteNumber(v.getContentLength());return N??g(y)};return async v=>{let{url:y,method:N,data:_,signal:C,cancelToken:S,timeout:E,onDownloadProgress:O,onUploadProgress:F,responseType:T,headers:D,withCredentials:I="same-origin",fetchOptions:J}=zb(v),Z=t||fetch;T=T?(T+"").toLowerCase():"text";let ee=UC([C,S&&S.toAbortSignal()],E),ne=null;const he=ee&&ee.unsubscribe&&(()=>{ee.unsubscribe()});let Q;try{if(F&&f&&N!=="get"&&N!=="head"&&(Q=await b(D,_))!==0){let K=new r(y,{method:"POST",body:_,duplex:"half"}),k;if(ge.isFormData(_)&&(k=K.headers.get("content-type"))&&D.setContentType(k),K.body){const[B,A]=Lv(Q,lh(Ov(F)));_=Iv(K.body,Mv,B,A)}}ge.isString(I)||(I=I?"include":"omit");const xe=l&&"credentials"in r.prototype,Y={...J,signal:ee,method:N.toUpperCase(),headers:D.normalize().toJSON(),body:_,duplex:"half",credentials:xe?I:void 0};ne=l&&new r(y,Y);let le=await(l?Z(ne,J):Z(y,Y));const X=p&&(T==="stream"||T==="response");if(p&&(O||X&&he)){const K={};["status","statusText","headers"].forEach(M=>{K[M]=le[M]});const k=ge.toFiniteNumber(le.headers.get("content-length")),[B,A]=O&&Lv(k,lh(Ov(O),!0))||[];le=new n(Iv(le.body,Mv,B,()=>{A&&A(),he&&he()}),K)}T=T||"text";let ve=await m[ge.findKey(m,T)||"text"](le,v);return!X&&he&&he(),await new Promise((K,k)=>{Ub(K,k,{data:ve,headers:kn.from(le.headers),status:le.status,statusText:le.statusText,config:v,request:ne})})}catch(xe){throw he&&he(),xe&&xe.name==="TypeError"&&/Load failed|fetch/i.test(xe.message)?Object.assign(new ct("Network Error",ct.ERR_NETWORK,v,ne),{cause:xe.cause||xe}):ct.from(xe,xe&&xe.code,v,ne)}}},GC=new Map,Kb=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:s}=t,l=[n,s,r];let c=l.length,u=c,d,f,p=GC;for(;u--;)d=l[u],f=p.get(d),f===void 0&&p.set(d,f=u?new Map:WC(t)),p=f;return f};Kb();const Cx={http:uC,xhr:HC,fetch:{get:Kb}};ge.forEach(Cx,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Vv=e=>`- ${e}`,qC=e=>ge.isFunction(e)||e===null||e===!1;function XC(e,t){e=ge.isArray(e)?e:[e];const{length:r}=e;let n,s;const l={};for(let c=0;c<r;c++){n=e[c];let u;if(s=n,!qC(n)&&(s=Cx[(u=String(n)).toLowerCase()],s===void 0))throw new ct(`Unknown adapter '${u}'`);if(s&&(ge.isFunction(s)||(s=s.get(t))))break;l[u||"#"+c]=s}if(!s){const c=Object.entries(l).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let u=r?c.length>1?`since :
`+c.map(Vv).join(`
`):" "+Vv(c[0]):"as no adapter specified";throw new ct("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return s}const $b={getAdapter:XC,adapters:Cx};function Bf(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Eo(null,e)}function zv(e){return Bf(e),e.headers=kn.from(e.headers),e.data=Mf.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),$b.getAdapter(e.adapter||du.adapter,e)(e).then(function(n){return Bf(e),n.data=Mf.call(e,e.transformResponse,n),n.headers=kn.from(n.headers),n},function(n){return Hb(n)||(Bf(e),n&&n.response&&(n.response.data=Mf.call(e,e.transformResponse,n.response),n.response.headers=kn.from(n.response.headers))),Promise.reject(n)})}const Wb="1.13.2",Mh={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Mh[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Kv={};Mh.transitional=function(t,r,n){function s(l,c){return"[Axios v"+Wb+"] Transitional option '"+l+"'"+c+(n?". "+n:"")}return(l,c,u)=>{if(t===!1)throw new ct(s(c," has been removed"+(r?" in "+r:"")),ct.ERR_DEPRECATED);return r&&!Kv[c]&&(Kv[c]=!0,console.warn(s(c," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(l,c,u):!0}};Mh.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function QC(e,t,r){if(typeof e!="object")throw new ct("options must be an object",ct.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let s=n.length;for(;s-- >0;){const l=n[s],c=t[l];if(c){const u=e[l],d=u===void 0||c(u,l,e);if(d!==!0)throw new ct("option "+l+" must be "+d,ct.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new ct("Unknown option "+l,ct.ERR_BAD_OPTION)}}const J0={assertOptions:QC,validators:Mh},Ea=J0.validators;let Xi=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Dv,response:new Dv}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const l=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?l&&!String(n.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+l):n.stack=l}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=nl(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:l}=r;n!==void 0&&J0.assertOptions(n,{silentJSONParsing:Ea.transitional(Ea.boolean),forcedJSONParsing:Ea.transitional(Ea.boolean),clarifyTimeoutError:Ea.transitional(Ea.boolean)},!1),s!=null&&(ge.isFunction(s)?r.paramsSerializer={serialize:s}:J0.assertOptions(s,{encode:Ea.function,serialize:Ea.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),J0.assertOptions(r,{baseUrl:Ea.spelling("baseURL"),withXsrfToken:Ea.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let c=l&&ge.merge(l.common,l[r.method]);l&&ge.forEach(["delete","get","head","post","put","patch","common"],v=>{delete l[v]}),r.headers=kn.concat(c,l);const u=[];let d=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(r)===!1||(d=d&&y.synchronous,u.unshift(y.fulfilled,y.rejected))});const f=[];this.interceptors.response.forEach(function(y){f.push(y.fulfilled,y.rejected)});let p,m=0,g;if(!d){const v=[zv.bind(this),void 0];for(v.unshift(...u),v.push(...f),g=v.length,p=Promise.resolve(r);m<g;)p=p.then(v[m++],v[m++]);return p}g=u.length;let b=r;for(;m<g;){const v=u[m++],y=u[m++];try{b=v(b)}catch(N){y.call(this,N);break}}try{p=zv.call(this,b)}catch(v){return Promise.reject(v)}for(m=0,g=f.length;m<g;)p=p.then(f[m++],f[m++]);return p}getUri(t){t=nl(this.defaults,t);const r=Vb(t.baseURL,t.url,t.allowAbsoluteUrls);return Ib(r,t.params,t.paramsSerializer)}};ge.forEach(["delete","get","head","options"],function(t){Xi.prototype[t]=function(r,n){return this.request(nl(n||{},{method:t,url:r,data:(n||{}).data}))}});ge.forEach(["post","put","patch"],function(t){function r(n){return function(l,c,u){return this.request(nl(u||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:l,data:c}))}}Xi.prototype[t]=r(),Xi.prototype[t+"Form"]=r(!0)});let YC=class Gb{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(l){r=l});const n=this;this.promise.then(s=>{if(!n._listeners)return;let l=n._listeners.length;for(;l-- >0;)n._listeners[l](s);n._listeners=null}),this.promise.then=s=>{let l;const c=new Promise(u=>{n.subscribe(u),l=u}).then(s);return c.cancel=function(){n.unsubscribe(l)},c},t(function(l,c,u){n.reason||(n.reason=new Eo(l,c,u),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Gb(function(s){t=s}),cancel:t}}};function JC(e){return function(r){return e.apply(null,r)}}function ZC(e){return ge.isObject(e)&&e.isAxiosError===!0}const Hp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Hp).forEach(([e,t])=>{Hp[t]=e});function qb(e){const t=new Xi(e),r=jb(Xi.prototype.request,t);return ge.extend(r,Xi.prototype,t,{allOwnKeys:!0}),ge.extend(r,t,null,{allOwnKeys:!0}),r.create=function(s){return qb(nl(e,s))},r}const Xt=qb(du);Xt.Axios=Xi;Xt.CanceledError=Eo;Xt.CancelToken=YC;Xt.isCancel=Hb;Xt.VERSION=Wb;Xt.toFormData=Ih;Xt.AxiosError=ct;Xt.Cancel=Xt.CanceledError;Xt.all=function(t){return Promise.all(t)};Xt.spread=JC;Xt.isAxiosError=ZC;Xt.mergeConfig=nl;Xt.AxiosHeaders=kn;Xt.formToJSON=e=>Bb(ge.isHTMLForm(e)?new FormData(e):e);Xt.getAdapter=$b.getAdapter;Xt.HttpStatusCode=Hp;Xt.default=Xt;const{Axios:TB,AxiosError:jB,CanceledError:_B,isCancel:SB,CancelToken:CB,VERSION:EB,all:FB,Cancel:AB,isAxiosError:DB,spread:PB,toFormData:LB,AxiosHeaders:OB,HttpStatusCode:RB,formToJSON:IB,getAdapter:MB,mergeConfig:BB}=Xt,eE="tinh_luong_auth",Lr=Xt.create({baseURL:"/api/rbac",headers:{"Content-Type":"application/json"}});Lr.interceptors.request.use(e=>{const t=localStorage.getItem(eE);if(t)try{const r=JSON.parse(t);r.token&&(e.headers.Authorization=`Bearer ${r.token}`)}catch{}return e},e=>Promise.reject(e));const Hf={dangNhap:(e,t)=>Lr.post("/dang-nhap",{tenDangNhap:e,matKhau:t}).then(r=>r.data),dangXuat:e=>Lr.post("/dang-xuat",null,{headers:{Authorization:`Bearer ${e}`}}).then(t=>t.data),kiemTraToken:e=>Lr.get("/kiem-tra-token",{headers:{Authorization:`Bearer ${e}`}}).then(t=>t.data)},Uf={layTatCa:()=>Lr.get("/nguoi-dung").then(e=>e.data),layTheoId:e=>Lr.get(`/nguoi-dung/${e}`).then(t=>t.data),taoMoi:e=>Lr.post("/nguoi-dung",e).then(t=>t.data),capNhat:(e,t)=>Lr.put(`/nguoi-dung/${e}`,t).then(r=>r.data),doiMatKhau:(e,t,r)=>Lr.put(`/nguoi-dung/${e}/doi-mat-khau`,{matKhauCu:t,matKhauMoi:r}).then(n=>n.data)},$v={layTatCa:()=>Lr.get("/vai-tro").then(e=>e.data),layTheoId:e=>Lr.get(`/vai-tro/${e}`).then(t=>t.data),taoMoi:e=>Lr.post("/vai-tro",e).then(t=>t.data),capNhat:(e,t)=>Lr.put(`/vai-tro/${e}`,t).then(r=>r.data),ganVaiTro:(e,t)=>Lr.post("/vai-tro/gan",{nguoiDungId:e,vaiTroId:t}).then(r=>r.data),goVaiTro:(e,t)=>Lr.delete("/vai-tro/go",{data:{nguoiDungId:e,vaiTroId:t}}).then(r=>r.data)},tE={layDanhSach:e=>Lr.get("/audit-log",{params:e}).then(t=>t.data),layTheoNguoiDung:e=>Lr.get(`/audit-log/nguoi-dung/${e}`).then(t=>t.data),layTheoBanGhi:(e,t)=>Lr.get(`/audit-log/ban-ghi/${e}/${t}`).then(r=>r.data)},Xb=P.createContext(void 0),Vl="tinh_luong_auth",rE=6e4;function nE({children:e}){const[t,r]=P.useState(null),[n,s]=P.useState(null),[l,c]=P.useState([]),[u,d]=P.useState([]),[f,p]=P.useState(!0),m=P.useCallback(()=>{localStorage.removeItem(Vl),s(null),r(null),c([]),d([])},[]),g=P.useCallback(()=>{const C=localStorage.getItem(Vl);if(C)try{const S=JSON.parse(C),E=new Date(S.hetHan),O=new Date;if(E<=O)return m(),window.location.href="/dang-nhap?expired=1",!1;const F=E.getTime()-O.getTime();return F<600*1e3&&F>0&&console.warn("Token sp ht hn trong",Math.floor(F/6e4),"pht"),!0}catch{return m(),!1}return!1},[m]);P.useEffect(()=>{const C=localStorage.getItem(Vl);if(C)try{const S=JSON.parse(C);new Date(S.hetHan)>new Date?(s(S.token),r(S.user),c(S.vaiTros),d(S.quyens)):localStorage.removeItem(Vl)}catch{localStorage.removeItem(Vl)}p(!1)},[]),P.useEffect(()=>{if(n){const C=setInterval(g,rE);return()=>clearInterval(C)}},[n,g]);const b=async(C,S)=>{const E=await Hf.dangNhap(C,S),O={token:E.token,user:E.nguoiDung,vaiTros:E.vaiTros,quyens:E.quyens,hetHan:E.hetHan};localStorage.setItem(Vl,JSON.stringify(O)),s(E.token),r(E.nguoiDung),c(E.vaiTros),d(E.quyens)},v=async()=>{if(n)try{await Hf.dangXuat(n)}catch{}m()},y=async()=>{if(n)try{(await Hf.kiemTraToken(n)).hieu_luc||(m(),window.location.href="/dang-nhap?expired=1")}catch{m()}},N=C=>u.includes(C)||l.includes("ADMIN"),_=C=>l.includes(C);return a.jsx(Xb.Provider,{value:{user:t,token:n,vaiTros:l,quyens:u,isAuthenticated:!!t,isLoading:f,dangNhap:b,dangXuat:v,coQuyen:N,coVaiTro:_,refreshToken:y},children:e})}function Ex(){const e=P.useContext(Xb);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}function Wn({children:e,quyen:t}){const{isAuthenticated:r,isLoading:n,coQuyen:s}=Ex();return n?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):r?t&&!s(t)?a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[a.jsx("h3",{className:"text-lg font-medium text-red-800",children:"Khng c quyn truy cp"}),a.jsx("p",{className:"text-red-600 mt-2",children:"Bn khng c quyn truy cp trang ny."})]}):a.jsx(a.Fragment,{children:e}):(window.location.href="/dang-nhap",null)}const aE=[{path:"/",label:"Trang ch",icon:fS},{path:"/bang-luong",label:"Bng lng",icon:Dh},{path:"/phong-ban",label:"Phng ban",icon:ou},{path:"/nhan-vien",label:"Nhn vin",icon:Ba},{path:"/nhom-nhan-vien",label:"Nhm nhn vin",icon:Ba},{path:"/khoan-luong",label:"Khon lng",icon:sh},{path:"/cham-cong",label:"Chm cng",icon:jv},{path:"/quy-che",label:"Quy ch lng",icon:lS},{path:"/su-kien",label:"S kin thng/pht",icon:Tv},{path:"/import-excel",label:"Import Excel",icon:Zl},{path:"/san-luong",label:"Sn lng",icon:Sv,children:[{path:"/import-chia-hang",label:"Import Chia hng",icon:Sv},{path:"/import-giao-hang",label:"Import Giao hng",icon:kS},{path:"/lich-su-import",label:"Lch s Import",icon:Ph}]},{path:"/cai-dat",label:"Ci t",icon:yo},{path:"/kpi",label:"Qun l KPI",icon:NS,children:[{path:"/kpi/template",label:"Template KPI",icon:jv},{path:"/kpi/ky-danh-gia",label:"K nh gi",icon:Tv},{path:"/kpi/cau-hinh-thuong",label:"Cu hnh thng",icon:sh}]},{path:"/quan-tri",label:"Qun tr",icon:wS,children:[{path:"/quan-tri/nguoi-dung",label:"Ngi dng",icon:Ba},{path:"/quan-tri/audit-log",label:"Audit Log",icon:yo}]}];function sE(){const e=ul(),t=fi(),{user:r,isAuthenticated:n,dangXuat:s,vaiTros:l}=Ex(),[c,u]=P.useState(!0),[d,f]=P.useState([]),p=g=>{f(b=>b.includes(g)?b.filter(v=>v!==g):[...b,g])},m=async()=>{await s(),t("/dang-nhap")};return a.jsxs("div",{className:"min-h-screen bg-gray-100",children:[a.jsx("header",{className:"bg-white shadow-sm fixed top-0 left-0 right-0 z-50",children:a.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>u(!c),className:"p-2 rounded-lg hover:bg-gray-100",children:c?a.jsx(rl,{size:20}):a.jsx(gS,{size:20})}),a.jsx("h1",{className:"text-xl font-bold text-primary-600",children:" H Thng Tnh Lng"})]}),a.jsx("div",{className:"flex items-center gap-4",children:n&&r?a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:r.hoTen}),a.jsx("div",{className:"text-xs text-gray-500",children:l.join(", ")||"Cha gn vai tr"})]}),a.jsx("button",{onClick:m,className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"ng xut",children:a.jsx(mS,{size:20})})]}):a.jsx(wn,{to:"/dang-nhap",className:"text-sm text-blue-600 hover:text-blue-700",children:"ng nhp"})})]})}),a.jsxs("div",{className:"flex pt-14",children:[a.jsx("aside",{className:`
            fixed left-0 top-14 bottom-0 bg-white shadow-lg transition-all duration-300 z-40
            ${c?"w-56":"w-0 overflow-hidden"}
          `,children:a.jsx("nav",{className:"py-4 overflow-y-auto h-full",children:aE.map(g=>{var _;const b=g.icon,v=g.children&&g.children.length>0,y=d.includes(g.path),N=e.pathname===g.path||g.path!=="/"&&e.pathname.startsWith(g.path);return a.jsx("div",{children:v?a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>p(g.path),className:`
                          w-full flex items-center justify-between gap-3 px-4 py-3 mx-2 rounded-lg transition-colors
                          ${N?"bg-primary-100 text-primary-700":"text-gray-600 hover:bg-gray-100"}
                        `,style:{width:"calc(100% - 16px)"},children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(b,{size:20}),a.jsx("span",{className:"font-medium",children:g.label})]}),a.jsx(vb,{size:16,className:`transition-transform ${y?"rotate-180":""}`})]}),y&&a.jsx("div",{className:"ml-6 mt-1 space-y-1",children:(_=g.children)==null?void 0:_.map(C=>{const S=C.icon,E=e.pathname===C.path;return a.jsxs(wn,{to:C.path,className:`
                                  flex items-center gap-3 px-4 py-2 mx-2 rounded-lg transition-colors text-sm
                                  ${E?"bg-primary-100 text-primary-700":"text-gray-500 hover:bg-gray-100"}
                                `,children:[a.jsx(S,{size:16}),a.jsx("span",{children:C.label})]},C.path)})})]}):a.jsxs(wn,{to:g.path,className:`
                        flex items-center gap-3 px-4 py-3 mx-2 rounded-lg transition-colors
                        ${N?"bg-primary-100 text-primary-700":"text-gray-600 hover:bg-gray-100"}
                      `,children:[a.jsx(b,{size:20}),a.jsx("span",{className:"font-medium",children:g.label})]})},g.path)})})}),a.jsx("main",{className:`
            flex-1 p-6 transition-all duration-300
            ${c?"ml-56":"ml-0"}
          `,children:a.jsx(Z4,{})})]})]})}const Qb="tinh_luong_auth",Le=Xt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});Le.interceptors.request.use(e=>{const t=localStorage.getItem(Qb);if(t)try{const r=JSON.parse(t);r.token&&(e.headers.Authorization=`Bearer ${r.token}`)}catch{}return e},e=>Promise.reject(e));Le.interceptors.response.use(e=>e,e=>{var t;return((t=e.response)==null?void 0:t.status)===401&&(localStorage.removeItem(Qb),window.location.pathname!=="/dang-nhap"&&(window.location.href="/dang-nhap?expired=1")),Promise.reject(e)});const ga={layTatCa:()=>Le.get("/phong-ban").then(e=>e.data),layTheoId:e=>Le.get(`/phong-ban/${e}`).then(t=>t.data),taoMoi:e=>Le.post("/phong-ban",e).then(t=>t.data),capNhat:(e,t)=>Le.put(`/phong-ban/${e}`,t).then(r=>r.data),xoa:e=>Le.delete(`/phong-ban/${e}`).then(t=>t.data)},os={layTatCa:e=>Le.get("/nhan-vien",{params:e}).then(t=>t.data),layTheoId:e=>Le.get(`/nhan-vien/${e}`).then(t=>t.data),layMaTuDong:()=>Le.get("/nhan-vien/ma-tu-dong").then(e=>e.data),taoMoi:e=>Le.post("/nhan-vien",e).then(t=>t.data),capNhat:(e,t)=>Le.put(`/nhan-vien/${e}`,t).then(r=>r.data),xoa:e=>Le.delete(`/nhan-vien/${e}`).then(t=>t.data)},ta={layTatCa:e=>Le.get("/khoan-luong",{params:{loai:e}}).then(t=>t.data),layTheoId:e=>Le.get(`/khoan-luong/${e}`).then(t=>t.data),taoMoi:e=>Le.post("/khoan-luong",e).then(t=>t.data),capNhat:(e,t)=>Le.put(`/khoan-luong/${e}`,t).then(r=>r.data),xoa:e=>Le.delete(`/khoan-luong/${e}`).then(t=>t.data)},xa={layDanhSach:e=>Le.get("/bang-luong",{params:e}).then(t=>t.data),layTheoId:e=>Le.get(`/bang-luong/${e}`).then(t=>t.data),taoMoi:e=>Le.post("/bang-luong",e).then(t=>t.data),capNhatChiTiet:e=>Le.put("/bang-luong/chi-tiet/cap-nhat",e).then(t=>t.data),capNhatNhieuChiTiet:e=>Le.put("/bang-luong/chi-tiet/cap-nhat-nhieu",{danhSach:e}).then(t=>t.data),chotBangLuong:(e,t)=>Le.post(`/bang-luong/${e}/chot`,t).then(r=>r.data),moKhoa:e=>Le.post(`/bang-luong/${e}/mo-khoa`).then(t=>t.data),khoa:e=>Le.post(`/bang-luong/${e}/khoa`).then(t=>t.data),xoa:e=>Le.delete(`/bang-luong/${e}`).then(t=>t.data),layLichSu:e=>Le.get(`/bang-luong/${e}/lich-su`).then(t=>t.data),soSanhExcel:(e,t)=>Le.post(`/bang-luong/${e}/so-sanh-excel`,{tongExcel:t}).then(r=>r.data),tinhLaiLuong:e=>Le.post(`/bang-luong/${e}/tinh-lai-luong`).then(t=>t.data)},Up={layPhieuLuong:(e,t)=>Le.get(`/bang-luong/${e}/phieu-luong/${t}`).then(r=>r.data),layPhieuLuongHtml:(e,t)=>Le.get(`/bang-luong/${e}/phieu-luong/${t}/html`).then(r=>r.data),guiPhieuLuong:(e,t)=>Le.post(`/bang-luong/${e}/gui-phieu-luong/${t}`).then(r=>r.data),guiTatCa:e=>Le.post(`/bang-luong/${e}/gui-tat-ca`).then(t=>t.data)},Z0={docHeader:e=>{const t=new FormData;return t.append("file",e),Le.post("/import-excel/doc-header",t,{headers:{"Content-Type":"multipart/form-data"}}).then(r=>r.data)},goiYMapping:e=>{const t=new FormData;return t.append("file",e),Le.post("/import-excel/goi-y-mapping",t,{headers:{"Content-Type":"multipart/form-data"}}).then(r=>r.data)},import:(e,t,r,n,s)=>{const l=new FormData;return l.append("file",e),l.append("thang",String(t)),l.append("nam",String(r)),l.append("phongBanId",String(n)),l.append("mappings",JSON.stringify(s)),Le.post("/import-excel/import",l,{headers:{"Content-Type":"multipart/form-data"}}).then(c=>c.data)},export:e=>Le.get(`/import-excel/export/${e}`,{responseType:"blob"})},zl={layTheoNhanVien:e=>Le.get(`/phu-cap-nhan-vien/nhan-vien/${e}`).then(t=>t.data),layHieuLuc:e=>Le.get(`/phu-cap-nhan-vien/nhan-vien/${e}/hieu-luc`).then(t=>t.data),layTheoThang:(e,t,r)=>Le.get(`/phu-cap-nhan-vien/nhan-vien/${e}/theo-thang`,{params:{thang:t,nam:r}}).then(n=>n.data),layLichSu:(e,t)=>Le.get(`/phu-cap-nhan-vien/nhan-vien/${e}/lich-su`,{params:{khoanLuongId:t}}).then(r=>r.data),taoPhuCap:e=>Le.post("/phu-cap-nhan-vien",e).then(t=>t.data),ketThuc:(e,t,r)=>Le.put(`/phu-cap-nhan-vien/${e}/ket-thuc`,{denNgay:t,nguoiCapNhat:r}).then(n=>n.data),tang:(e,t)=>Le.post(`/phu-cap-nhan-vien/${e}/tang`,t).then(r=>r.data),tamDung:e=>Le.put(`/phu-cap-nhan-vien/${e}/tam-dung`).then(t=>t.data),kichHoat:e=>Le.put(`/phu-cap-nhan-vien/${e}/kich-hoat`).then(t=>t.data),thongKePhongBan:e=>Le.get(`/phu-cap-nhan-vien/thong-ke/phong-ban/${e}`).then(t=>t.data)},Wv={layTatCa:e=>Le.get(`/bang-luong/${e}/ngay-cong`).then(t=>t.data),layTheoNhanVien:(e,t)=>Le.get(`/bang-luong/${e}/ngay-cong/${t}`).then(r=>r.data),khoiTao:e=>Le.post(`/bang-luong/${e}/ngay-cong/khoi-tao`).then(t=>t.data),dieuChinh:(e,t,r)=>Le.put(`/bang-luong/${e}/ngay-cong/${t}/dieu-chinh`,r).then(n=>n.data),xoaDieuChinh:(e,t)=>Le.delete(`/bang-luong/${e}/ngay-cong/${t}/dieu-chinh`).then(r=>r.data)},Gv={lay:()=>Le.get("/thong-tin-cong-ty").then(e=>e.data),capNhat:e=>Le.put("/thong-tin-cong-ty",e).then(t=>t.data)};function Zt(e){if(e==null)return"0";const t=typeof e=="string"?parseFloat(e):e;return isNaN(t)?"0":new Intl.NumberFormat("vi-VN").format(t)}function iE(e){if(!e)return 0;const t=e.replace(/[^\d]/g,"");return parseInt(t,10)||0}function Kl(e){return e?new Date(e).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):""}function lE(e){switch(e){case"NHAP":return"badge badge-nhap";case"DA_CHOT":return"badge badge-da-chot";case"KHOA":return"badge badge-khoa";default:return"badge"}}function oE(e){switch(e){case"NHAP":return"ang nhp";case"DA_CHOT":return" cht";case"KHOA":return" kha";default:return e}}function cE(e,t){const r=window.URL.createObjectURL(e),n=document.createElement("a");n.href=r,n.setAttribute("download",t),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(r)}function uE(){const{data:e}=Bt({queryKey:["phong-ban"],queryFn:ga.layTatCa}),{data:t}=Bt({queryKey:["nhan-vien"],queryFn:()=>os.layTatCa()}),{data:r}=Bt({queryKey:["khoan-luong"],queryFn:()=>ta.layTatCa()}),{data:n}=Bt({queryKey:["bang-luong"],queryFn:()=>xa.layDanhSach()}),s=Array.isArray(t)?t:(t==null?void 0:t.data)||[],l=Array.isArray(n)?n:(n==null?void 0:n.data)||[],c=(l==null?void 0:l.reduce((d,f)=>d+(f.thucLinh||0),0))||0,u=[{label:"Phng ban",value:(e==null?void 0:e.length)||0,icon:ou,color:"bg-blue-500",link:"/nhan-vien"},{label:"Nhn vin",value:(s==null?void 0:s.length)||0,icon:Ba,color:"bg-green-500",link:"/nhan-vien"},{label:"Khon lng",value:(r==null?void 0:r.length)||0,icon:sh,color:"bg-purple-500",link:"/khoan-luong"},{label:"Bng lng",value:(l==null?void 0:l.length)||0,icon:Dh,color:"bg-orange-500",link:"/bang-luong"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Tng quan H thng"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:u.map(d=>{const f=d.icon;return a.jsx(wn,{to:d.link,className:"card hover:shadow-md transition-shadow",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:d.label}),a.jsx("p",{className:"text-2xl font-bold text-gray-800",children:d.value})]}),a.jsx("div",{className:`p-3 rounded-full ${d.color}`,children:a.jsx(f,{size:24,className:"text-white"})})]})},d.label)})}),a.jsx("div",{className:"card mb-8",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-4 bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl",children:a.jsx(Nb,{size:32,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Tng qu lng"}),a.jsxs("p",{className:"text-3xl font-bold text-gray-800",children:[Zt(c)," ",a.jsx("span",{className:"text-lg text-gray-500",children:"VN"})]})]})]})}),a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[a.jsx(Fh,{size:20}),"Bng lng gn y"]}),a.jsx(wn,{to:"/bang-luong",className:"text-primary-600 hover:underline text-sm",children:"Xem tt c "})]}),l&&l.length>0?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium text-gray-500",children:"Thng/Nm"}),a.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium text-gray-500",children:"Phng ban"}),a.jsx("th",{className:"text-right py-2 px-3 text-sm font-medium text-gray-500",children:"S NV"}),a.jsx("th",{className:"text-right py-2 px-3 text-sm font-medium text-gray-500",children:"Thc lnh"}),a.jsx("th",{className:"text-center py-2 px-3 text-sm font-medium text-gray-500",children:"Trng thi"})]})}),a.jsx("tbody",{children:l.slice(0,5).map(d=>a.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"py-3 px-3",children:a.jsxs(wn,{to:`/bang-luong/${d.id}`,className:"text-primary-600 hover:underline font-medium",children:["Thng ",d.thang,"/",d.nam]})}),a.jsx("td",{className:"py-3 px-3",children:d.phongBan.tenPhongBan}),a.jsx("td",{className:"py-3 px-3 text-right",children:d.soNhanVien||0}),a.jsx("td",{className:"py-3 px-3 text-right font-medium currency",children:Zt(d.thucLinh)}),a.jsx("td",{className:"py-3 px-3 text-center",children:a.jsxs("span",{className:`
                          badge
                          ${d.trangThai==="NHAP"?"badge-nhap":""}
                          ${d.trangThai==="DA_CHOT"?"badge-da-chot":""}
                          ${d.trangThai==="KHOA"?"badge-khoa":""}
                        `,children:[d.trangThai==="NHAP"&&"ang nhp",d.trangThai==="DA_CHOT"&&" cht",d.trangThai==="KHOA"&&" kha"]})})]},d.id))})]})}):a.jsxs("p",{className:"text-gray-500 text-center py-8",children:["Cha c bng lng no.",a.jsx(wn,{to:"/bang-luong",className:"text-primary-600 hover:underline ml-1",children:"To bng lng mi"})]})]})]})}function hE(){const e=Sn(),[t,r]=P.useState(!1),[n,s]=P.useState(new Date().getFullYear()),[l,c]=P.useState(),[u,d]=P.useState({thang:new Date().getMonth()+1,nam:new Date().getFullYear(),phongBanIds:[],tenBangLuong:""}),{data:f,isLoading:p}=Bt({queryKey:["bang-luong",n,l],queryFn:()=>xa.layDanhSach({nam:n,phongBanId:l})}),m=Array.isArray(f)?f:(f==null?void 0:f.data)||[],{data:g}=Bt({queryKey:["phong-ban"],queryFn:ga.layTatCa}),b=ot({mutationFn:async _=>await Promise.all(_.phongBanIds.map(S=>xa.taoMoi({thang:_.thang,nam:_.nam,phongBanId:S,tenBangLuong:_.phongBanIds.length>1?"":_.tenBangLuong}))),onSuccess:_=>{e.invalidateQueries({queryKey:["bang-luong"]}),je.success(`To ${_.length} bng lng thnh cng!`),r(!1),d({thang:new Date().getMonth()+1,nam:new Date().getFullYear(),phongBanIds:[],tenBangLuong:""})},onError:_=>{var C,S;je.error(((S=(C=_.response)==null?void 0:C.data)==null?void 0:S.message)||"C li xy ra")}}),v=ot({mutationFn:xa.xoa,onSuccess:()=>{e.invalidateQueries({queryKey:["bang-luong"]}),je.success("Xa bng lng thnh cng!")},onError:_=>{var C,S;je.error(((S=(C=_.response)==null?void 0:C.data)==null?void 0:S.message)||"C li xy ra")}}),y=()=>{if(u.phongBanIds.length===0){je.error("Vui lng chn t nht mt phng ban");return}b.mutate(u)},N=(_,C)=>{if(C!=="NHAP"){je.error("Ch c th xa bng lng ang  trng thi Nhp");return}confirm("Bn c chc mun xa bng lng ny?")&&v.mutate(_)};return a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx(Dh,{size:28}),"Qun l Bng lng"]}),a.jsxs("button",{onClick:()=>r(!0),className:"btn btn-primary",children:[a.jsx(Ha,{size:20}),"To bng lng mi"]})]}),a.jsx("div",{className:"card mb-6",children:a.jsxs("div",{className:"flex gap-4 items-center",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Nm"}),a.jsx("select",{value:n,onChange:_=>s(Number(_.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(_=>a.jsx("option",{value:_,children:_},_))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban"}),a.jsxs("select",{value:l||"",onChange:_=>c(_.target.value?Number(_.target.value):void 0),className:"border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"",children:"Tt c"}),g==null?void 0:g.map(_=>a.jsx("option",{value:_.id,children:_.tenPhongBan},_.id))]})]})]})}),a.jsx("div",{className:"card",children:p?a.jsx("p",{className:"text-center py-8 text-gray-500",children:"ang ti..."}):m&&m.length>0?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b bg-gray-50",children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Tn bng lng"}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Thng/Nm"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Phng ban"}),a.jsx("th",{className:"text-right py-3 px-4 text-sm font-semibold text-gray-600",children:"S NV"}),a.jsx("th",{className:"text-right py-3 px-4 text-sm font-semibold text-gray-600",children:"Tng thu nhp"}),a.jsx("th",{className:"text-right py-3 px-4 text-sm font-semibold text-gray-600",children:"Thc lnh"}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Trng thi"}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Thao tc"})]})}),a.jsx("tbody",{children:m.map(_=>a.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"py-3 px-4",children:a.jsx(wn,{to:`/bang-luong/${_.id}`,className:"text-primary-600 hover:underline font-medium",children:_.tenBangLuong||`Bng lng T${_.thang}/${_.nam}`})}),a.jsxs("td",{className:"py-3 px-4 text-center",children:[_.thang,"/",_.nam]}),a.jsx("td",{className:"py-3 px-4",children:_.phongBan.tenPhongBan}),a.jsx("td",{className:"py-3 px-4 text-right",children:_.soNhanVien||0}),a.jsx("td",{className:"py-3 px-4 text-right currency",children:Zt(_.tongThuNhap)}),a.jsx("td",{className:"py-3 px-4 text-right font-semibold currency text-green-600",children:Zt(_.thucLinh)}),a.jsx("td",{className:"py-3 px-4 text-center",children:a.jsx("span",{className:lE(_.trangThai),children:oE(_.trangThai)})}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx(wn,{to:`/bang-luong/${_.id}`,className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Xem chi tit",children:a.jsx(Rp,{size:18})}),_.trangThai==="NHAP"&&a.jsx("button",{onClick:()=>N(_.id,_.trangThai),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Xa",children:a.jsx(li,{size:18})}),_.trangThai==="DA_CHOT"&&a.jsx("span",{title:" cht",children:a.jsx(yb,{size:18,className:"text-gray-400"})}),_.trangThai==="KHOA"&&a.jsx("span",{title:" kha",children:a.jsx(kb,{size:18,className:"text-gray-400"})})]})})]},_.id))})]})}):a.jsx("p",{className:"text-center py-8 text-gray-500",children:"Cha c bng lng no"})}),t&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:"To bng lng mi"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Thng"}),a.jsx("select",{value:u.thang,onChange:_=>d({...u,thang:Number(_.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:Array.from({length:12},(_,C)=>C+1).map(_=>a.jsxs("option",{value:_,children:["Thng ",_]},_))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Nm"}),a.jsx("select",{value:u.nam,onChange:_=>d({...u,nam:Number(_.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(_=>a.jsx("option",{value:_,children:_},_))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Phng ban * (chn nhiu)"}),a.jsxs("div",{className:"border rounded-lg p-3 max-h-48 overflow-y-auto space-y-2",children:[a.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded cursor-pointer border-b pb-2 mb-2",children:[a.jsx("input",{type:"checkbox",checked:g&&u.phongBanIds.length===g.length,onChange:_=>{_.target.checked?d({...u,phongBanIds:(g==null?void 0:g.map(C=>C.id))||[]}):d({...u,phongBanIds:[]})},className:"w-4 h-4 text-blue-600 rounded"}),a.jsxs("span",{className:"font-medium text-blue-600",children:["Chn tt c (",(g==null?void 0:g.length)||0," phng ban)"]})]}),g==null?void 0:g.map(_=>a.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:u.phongBanIds.includes(_.id),onChange:C=>{C.target.checked?d({...u,phongBanIds:[...u.phongBanIds,_.id]}):d({...u,phongBanIds:u.phongBanIds.filter(S=>S!==_.id)})},className:"w-4 h-4 text-blue-600 rounded"}),a.jsx("span",{children:_.tenPhongBan}),u.phongBanIds.includes(_.id)&&a.jsx(Ah,{className:"w-4 h-4 text-green-500 ml-auto"})]},_.id))]}),u.phongBanIds.length>0&&a.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[" chn: ",u.phongBanIds.length," phng ban"]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tn bng lng (tu chn)"}),a.jsx("input",{type:"text",value:u.tenBangLuong,onChange:_=>d({...u,tenBangLuong:_.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"T ng to nu  trng"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[a.jsx("button",{onClick:()=>r(!1),className:"btn btn-secondary",children:"Hy"}),a.jsx("button",{onClick:y,disabled:b.isPending,className:"btn btn-primary",children:b.isPending?"ang to...":"To mi"})]})]})})]})}function dE(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const r=document.implementation.createHTMLDocument(),n=r.createElement("base"),s=r.createElement("a");return r.head.appendChild(n),r.body.appendChild(s),t&&(n.href=t),s.href=e,s.href}const fE=(()=>{let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function ii(e){const t=[];for(let r=0,n=e.length;r<n;r++)t.push(e[r]);return t}let $l=null;function Yb(e={}){return $l||(e.includeStyleProperties?($l=e.includeStyleProperties,$l):($l=ii(window.getComputedStyle(document.documentElement)),$l))}function oh(e,t){const n=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return n?parseFloat(n.replace("px","")):0}function pE(e){const t=oh(e,"border-left-width"),r=oh(e,"border-right-width");return e.clientWidth+t+r}function xE(e){const t=oh(e,"border-top-width"),r=oh(e,"border-bottom-width");return e.clientHeight+t+r}function Jb(e,t={}){const r=t.width||pE(e),n=t.height||xE(e);return{width:r,height:n}}function mE(){let e,t;try{t=process}catch{}const r=t&&t.env?t.env.devicePixelRatio:null;return r&&(e=parseInt(r,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const Pn=16384;function gE(e){(e.width>Pn||e.height>Pn)&&(e.width>Pn&&e.height>Pn?e.width>e.height?(e.height*=Pn/e.width,e.width=Pn):(e.width*=Pn/e.height,e.height=Pn):e.width>Pn?(e.height*=Pn/e.width,e.width=Pn):(e.width*=Pn/e.height,e.height=Pn))}function ch(e){return new Promise((t,r)=>{const n=new Image;n.onload=()=>{n.decode().then(()=>{requestAnimationFrame(()=>t(n))})},n.onerror=r,n.crossOrigin="anonymous",n.decoding="async",n.src=e})}async function vE(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function yE(e,t,r){const n="http://www.w3.org/2000/svg",s=document.createElementNS(n,"svg"),l=document.createElementNS(n,"foreignObject");return s.setAttribute("width",`${t}`),s.setAttribute("height",`${r}`),s.setAttribute("viewBox",`0 0 ${t} ${r}`),l.setAttribute("width","100%"),l.setAttribute("height","100%"),l.setAttribute("x","0"),l.setAttribute("y","0"),l.setAttribute("externalResourcesRequired","true"),s.appendChild(l),l.appendChild(e),vE(s)}const Tn=(e,t)=>{if(e instanceof t)return!0;const r=Object.getPrototypeOf(e);return r===null?!1:r.constructor.name===t.name||Tn(r,t)};function bE(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function wE(e,t){return Yb(t).map(r=>{const n=e.getPropertyValue(r),s=e.getPropertyPriority(r);return`${r}: ${n}${s?" !important":""};`}).join(" ")}function NE(e,t,r,n){const s=`.${e}:${t}`,l=r.cssText?bE(r):wE(r,n);return document.createTextNode(`${s}{${l}}`)}function qv(e,t,r,n){const s=window.getComputedStyle(e,r),l=s.getPropertyValue("content");if(l===""||l==="none")return;const c=fE();try{t.className=`${t.className} ${c}`}catch{return}const u=document.createElement("style");u.appendChild(NE(c,r,s,n)),t.appendChild(u)}function kE(e,t,r){qv(e,t,":before",r),qv(e,t,":after",r)}const Xv="application/font-woff",Qv="image/jpeg",TE={woff:Xv,woff2:Xv,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Qv,jpeg:Qv,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function jE(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function Fx(e){const t=jE(e).toLowerCase();return TE[t]||""}function _E(e){return e.split(/,/)[1]}function Vp(e){return e.search(/^(data:)/)!==-1}function SE(e,t){return`data:${t};base64,${e}`}async function Zb(e,t,r){const n=await fetch(e,t);if(n.status===404)throw new Error(`Resource "${n.url}" not found`);const s=await n.blob();return new Promise((l,c)=>{const u=new FileReader;u.onerror=c,u.onloadend=()=>{try{l(r({res:n,result:u.result}))}catch(d){c(d)}},u.readAsDataURL(s)})}const Vf={};function CE(e,t,r){let n=e.replace(/\?.*/,"");return r&&(n=e),/ttf|otf|eot|woff2?/i.test(n)&&(n=n.replace(/.*\//,"")),t?`[${t}]${n}`:n}async function Ax(e,t,r){const n=CE(e,t,r.includeQueryParams);if(Vf[n]!=null)return Vf[n];r.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let s;try{const l=await Zb(e,r.fetchRequestInit,({res:c,result:u})=>(t||(t=c.headers.get("Content-Type")||""),_E(u)));s=SE(l,t)}catch(l){s=r.imagePlaceholder||"";let c=`Failed to fetch resource: ${e}`;l&&(c=typeof l=="string"?l:l.message),c&&console.warn(c)}return Vf[n]=s,s}async function EE(e){const t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):ch(t)}async function FE(e,t){if(e.currentSrc){const l=document.createElement("canvas"),c=l.getContext("2d");l.width=e.clientWidth,l.height=e.clientHeight,c==null||c.drawImage(e,0,0,l.width,l.height);const u=l.toDataURL();return ch(u)}const r=e.poster,n=Fx(r),s=await Ax(r,n,t);return ch(s)}async function AE(e,t){var r;try{if(!((r=e==null?void 0:e.contentDocument)===null||r===void 0)&&r.body)return await Bh(e.contentDocument.body,t,!0)}catch{}return e.cloneNode(!1)}async function DE(e,t){return Tn(e,HTMLCanvasElement)?EE(e):Tn(e,HTMLVideoElement)?FE(e,t):Tn(e,HTMLIFrameElement)?AE(e,t):e.cloneNode(ew(e))}const PE=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",ew=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function LE(e,t,r){var n,s;if(ew(t))return t;let l=[];return PE(e)&&e.assignedNodes?l=ii(e.assignedNodes()):Tn(e,HTMLIFrameElement)&&(!((n=e.contentDocument)===null||n===void 0)&&n.body)?l=ii(e.contentDocument.body.childNodes):l=ii(((s=e.shadowRoot)!==null&&s!==void 0?s:e).childNodes),l.length===0||Tn(e,HTMLVideoElement)||await l.reduce((c,u)=>c.then(()=>Bh(u,r)).then(d=>{d&&t.appendChild(d)}),Promise.resolve()),t}function OE(e,t,r){const n=t.style;if(!n)return;const s=window.getComputedStyle(e);s.cssText?(n.cssText=s.cssText,n.transformOrigin=s.transformOrigin):Yb(r).forEach(l=>{let c=s.getPropertyValue(l);l==="font-size"&&c.endsWith("px")&&(c=`${Math.floor(parseFloat(c.substring(0,c.length-2)))-.1}px`),Tn(e,HTMLIFrameElement)&&l==="display"&&c==="inline"&&(c="block"),l==="d"&&t.getAttribute("d")&&(c=`path(${t.getAttribute("d")})`),n.setProperty(l,c,s.getPropertyPriority(l))})}function RE(e,t){Tn(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),Tn(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function IE(e,t){if(Tn(e,HTMLSelectElement)){const n=Array.from(t.children).find(s=>e.value===s.getAttribute("value"));n&&n.setAttribute("selected","")}}function ME(e,t,r){return Tn(t,Element)&&(OE(e,t,r),kE(e,t,r),RE(e,t),IE(e,t)),t}async function BE(e,t){const r=e.querySelectorAll?e.querySelectorAll("use"):[];if(r.length===0)return e;const n={};for(let l=0;l<r.length;l++){const u=r[l].getAttribute("xlink:href");if(u){const d=e.querySelector(u),f=document.querySelector(u);!d&&f&&!n[u]&&(n[u]=await Bh(f,t,!0))}}const s=Object.values(n);if(s.length){const l="http://www.w3.org/1999/xhtml",c=document.createElementNS(l,"svg");c.setAttribute("xmlns",l),c.style.position="absolute",c.style.width="0",c.style.height="0",c.style.overflow="hidden",c.style.display="none";const u=document.createElementNS(l,"defs");c.appendChild(u);for(let d=0;d<s.length;d++)u.appendChild(s[d]);e.appendChild(c)}return e}async function Bh(e,t,r){return!r&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(n=>DE(n,t)).then(n=>LE(e,n,t)).then(n=>ME(e,n,t)).then(n=>BE(n,t))}const tw=/url\((['"]?)([^'"]+?)\1\)/g,HE=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,UE=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function VE(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function zE(e){const t=[];return e.replace(tw,(r,n,s)=>(t.push(s),r)),t.filter(r=>!Vp(r))}async function KE(e,t,r,n,s){try{const l=r?dE(t,r):t,c=Fx(t);let u;return s||(u=await Ax(l,c,n)),e.replace(VE(t),`$1${u}$3`)}catch{}return e}function $E(e,{preferredFontFormat:t}){return t?e.replace(UE,r=>{for(;;){const[n,,s]=HE.exec(r)||[];if(!s)return"";if(s===t)return`src: ${n};`}}):e}function rw(e){return e.search(tw)!==-1}async function nw(e,t,r){if(!rw(e))return e;const n=$E(e,r);return zE(n).reduce((l,c)=>l.then(u=>KE(u,c,t,r)),Promise.resolve(n))}async function Wl(e,t,r){var n;const s=(n=t.style)===null||n===void 0?void 0:n.getPropertyValue(e);if(s){const l=await nw(s,null,r);return t.style.setProperty(e,l,t.style.getPropertyPriority(e)),!0}return!1}async function WE(e,t){await Wl("background",e,t)||await Wl("background-image",e,t),await Wl("mask",e,t)||await Wl("-webkit-mask",e,t)||await Wl("mask-image",e,t)||await Wl("-webkit-mask-image",e,t)}async function GE(e,t){const r=Tn(e,HTMLImageElement);if(!(r&&!Vp(e.src))&&!(Tn(e,SVGImageElement)&&!Vp(e.href.baseVal)))return;const n=r?e.src:e.href.baseVal,s=await Ax(n,Fx(n),t);await new Promise((l,c)=>{e.onload=l,e.onerror=t.onImageErrorHandler?(...d)=>{try{l(t.onImageErrorHandler(...d))}catch(f){c(f)}}:c;const u=e;u.decode&&(u.decode=l),u.loading==="lazy"&&(u.loading="eager"),r?(e.srcset="",e.src=s):e.href.baseVal=s})}async function qE(e,t){const n=ii(e.childNodes).map(s=>aw(s,t));await Promise.all(n).then(()=>e)}async function aw(e,t){Tn(e,Element)&&(await WE(e,t),await GE(e,t),await qE(e,t))}function XE(e,t){const{style:r}=e;t.backgroundColor&&(r.backgroundColor=t.backgroundColor),t.width&&(r.width=`${t.width}px`),t.height&&(r.height=`${t.height}px`);const n=t.style;return n!=null&&Object.keys(n).forEach(s=>{r[s]=n[s]}),e}const Yv={};async function Jv(e){let t=Yv[e];if(t!=null)return t;const n=await(await fetch(e)).text();return t={url:e,cssText:n},Yv[e]=t,t}async function Zv(e,t){let r=e.cssText;const n=/url\(["']?([^"')]+)["']?\)/g,l=(r.match(/url\([^)]+\)/g)||[]).map(async c=>{let u=c.replace(n,"$1");return u.startsWith("https://")||(u=new URL(u,e.url).href),Zb(u,t.fetchRequestInit,({result:d})=>(r=r.replace(c,`url(${d})`),[c,d]))});return Promise.all(l).then(()=>r)}function ey(e){if(e==null)return[];const t=[],r=/(\/\*[\s\S]*?\*\/)/gi;let n=e.replace(r,"");const s=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const d=s.exec(n);if(d===null)break;t.push(d[0])}n=n.replace(s,"");const l=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,c="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",u=new RegExp(c,"gi");for(;;){let d=l.exec(n);if(d===null){if(d=u.exec(n),d===null)break;l.lastIndex=u.lastIndex}else u.lastIndex=l.lastIndex;t.push(d[0])}return t}async function QE(e,t){const r=[],n=[];return e.forEach(s=>{if("cssRules"in s)try{ii(s.cssRules||[]).forEach((l,c)=>{if(l.type===CSSRule.IMPORT_RULE){let u=c+1;const d=l.href,f=Jv(d).then(p=>Zv(p,t)).then(p=>ey(p).forEach(m=>{try{s.insertRule(m,m.startsWith("@import")?u+=1:s.cssRules.length)}catch(g){console.error("Error inserting rule from remote css",{rule:m,error:g})}})).catch(p=>{console.error("Error loading remote css",p.toString())});n.push(f)}})}catch(l){const c=e.find(u=>u.href==null)||document.styleSheets[0];s.href!=null&&n.push(Jv(s.href).then(u=>Zv(u,t)).then(u=>ey(u).forEach(d=>{c.insertRule(d,c.cssRules.length)})).catch(u=>{console.error("Error loading remote stylesheet",u)})),console.error("Error inlining remote css file",l)}}),Promise.all(n).then(()=>(e.forEach(s=>{if("cssRules"in s)try{ii(s.cssRules||[]).forEach(l=>{r.push(l)})}catch(l){console.error(`Error while reading CSS rules from ${s.href}`,l)}}),r))}function YE(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>rw(t.style.getPropertyValue("src")))}async function JE(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const r=ii(e.ownerDocument.styleSheets),n=await QE(r,t);return YE(n)}function sw(e){return e.trim().replace(/["']/g,"")}function ZE(e){const t=new Set;function r(n){(n.style.fontFamily||getComputedStyle(n).fontFamily).split(",").forEach(l=>{t.add(sw(l))}),Array.from(n.children).forEach(l=>{l instanceof HTMLElement&&r(l)})}return r(e),t}async function e3(e,t){const r=await JE(e,t),n=ZE(e);return(await Promise.all(r.filter(l=>n.has(sw(l.style.fontFamily))).map(l=>{const c=l.parentStyleSheet?l.parentStyleSheet.href:null;return nw(l.cssText,c,t)}))).join(`
`)}async function t3(e,t){const r=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await e3(e,t);if(r){const n=document.createElement("style"),s=document.createTextNode(r);n.appendChild(s),e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n)}}async function r3(e,t={}){const{width:r,height:n}=Jb(e,t),s=await Bh(e,t,!0);return await t3(s,t),await aw(s,t),XE(s,t),await yE(s,r,n)}async function n3(e,t={}){const{width:r,height:n}=Jb(e,t),s=await r3(e,t),l=await ch(s),c=document.createElement("canvas"),u=c.getContext("2d"),d=t.pixelRatio||mE(),f=t.canvasWidth||r,p=t.canvasHeight||n;return c.width=f*d,c.height=p*d,t.skipAutoScale||gE(c),c.style.width=`${f}`,c.style.height=`${p}`,t.backgroundColor&&(u.fillStyle=t.backgroundColor,u.fillRect(0,0,c.width,c.height)),u.drawImage(l,0,0,c.width,c.height),c}async function a3(e,t={}){return(await n3(e,t)).toDataURL()}const vc=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),iw=P.forwardRef(({data:e},t)=>{const r=e.cacKhoanLuong.filter(s=>s.loai==="THU_NHAP"),n=e.cacKhoanLuong.filter(s=>s.loai==="KHAU_TRU");return a.jsxs("div",{ref:t,className:"bg-white rounded-xl shadow-lg overflow-hidden max-w-2xl mx-auto",style:{width:"700px",fontFamily:"system-ui, -apple-system, sans-serif"},children:[a.jsxs("div",{className:"text-white text-center py-8 px-6",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[a.jsx("h1",{className:"text-3xl font-bold mb-1",children:"PHIU LNG"}),a.jsxs("p",{className:"text-lg opacity-90",children:["Thng ",e.thang," / ",e.nam]})]}),a.jsxs("div",{className:"text-center py-4 px-6 border-b-2 border-dashed border-gray-200 bg-gray-50",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"CNG TY TNHH ABC"}),a.jsx("p",{className:"text-sm text-gray-600",children:"123 ng ABC, Qun 1, TP.HCM"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 p-6 bg-gray-50 border-b border-gray-200",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-gray-500",children:"H v tn"}),a.jsx("p",{className:"font-semibold text-gray-800",children:e.hoTen})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-gray-500",children:"M nhn vin"}),a.jsx("p",{className:"font-semibold text-gray-800",children:e.maNhanVien})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-gray-500",children:"Phng ban"}),a.jsx("p",{className:"font-semibold text-gray-800",children:e.phongBan})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-gray-500",children:"Chc v"}),a.jsx("p",{className:"font-semibold text-gray-800",children:e.chucVu||"Nhn vin"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("span",{className:"text-xs text-gray-500",children:"Ngy cng thc t"}),a.jsxs("p",{className:"font-semibold text-gray-800",children:[a.jsx("span",{className:"text-blue-600",children:e.ngayCongThucTe})," / ",e.ngayCongLyThuyet," ngy"]})]})]}),a.jsxs("div",{className:"p-6 border-b border-gray-100",children:[a.jsx("h3",{className:"text-base font-bold text-gray-800 mb-4 pb-2 border-b-2 border-green-500 inline-block",children:"THU NHP"}),a.jsx("div",{className:"space-y-3",children:r.map((s,l)=>a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-gray-600",children:s.tenKhoan}),a.jsx("span",{className:"font-medium text-green-600",children:vc(s.soTien)})]},l))})]}),a.jsxs("div",{className:"p-6 border-b border-gray-100",children:[a.jsx("h3",{className:"text-base font-bold text-gray-800 mb-4 pb-2 border-b-2 border-red-500 inline-block",children:"KHU TR"}),a.jsx("div",{className:"space-y-3",children:n.length>0?n.map((s,l)=>a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-gray-600",children:s.tenKhoan}),a.jsxs("span",{className:"font-medium text-red-600",children:["-",vc(s.soTien)]})]},l)):a.jsx("p",{className:"text-gray-400 italic",children:"Khng c khon khu tr"})})]}),a.jsxs("div",{className:"p-6 text-white",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[a.jsxs("div",{className:"flex justify-between items-center py-2",children:[a.jsx("span",{className:"opacity-90",children:"Tng thu nhp:"}),a.jsx("span",{className:"font-semibold",children:vc(e.tongThuNhap)})]}),a.jsxs("div",{className:"flex justify-between items-center py-2",children:[a.jsx("span",{className:"opacity-90",children:"Tng khu tr:"}),a.jsxs("span",{className:"font-semibold",children:["-",vc(e.tongKhauTru)]})]}),a.jsxs("div",{className:"flex justify-between items-center pt-4 mt-4 border-t border-white/30",children:[a.jsx("span",{className:"text-xl font-bold",children:"THC LNH:"}),a.jsx("span",{className:"text-2xl font-bold",children:vc(e.thucLinh)})]})]}),a.jsxs("div",{className:"text-center py-4 px-6 text-sm text-gray-500 border-t border-gray-100",children:[a.jsx("p",{children:"Phiu lng c to t ng bi h thng tnh lng."}),a.jsx("p",{children:"Nu c thc mc, vui lng lin h phng Nhn s."})]})]})});iw.displayName="PhieuLuong";function s3({isOpen:e,onClose:t,bangLuongId:r,nhanVienId:n,hoTen:s}){const l=P.useRef(null),[c,u]=P.useState(!1),{data:d,isLoading:f,error:p}=Bt({queryKey:["phieu-luong",r,n],queryFn:()=>Up.layPhieuLuong(r,n),enabled:e}),m=ot({mutationFn:()=>Up.guiPhieuLuong(r,n),onSuccess:v=>{v.success?je.success(v.message):je.error(v.message)},onError:()=>{je.error("C li khi gi email")}}),g=P.useCallback(async()=>{if(!(!l.current||!d)){u(!0);try{const v=await a3(l.current,{cacheBust:!0,pixelRatio:2,backgroundColor:"#ffffff"}),y=document.createElement("a");y.download=`phieu-luong-${d.maNhanVien}-thang-${d.thang}-${d.nam}.png`,y.href=v,y.click(),je.success(" xut phiu lng thnh cng!")}catch(v){console.error("Export error:",v),je.error("C li khi xut nh")}finally{u(!1)}}},[d]),b=P.useCallback(()=>{if(!(d!=null&&d.email)){je.error("Nhn vin khng c email");return}m.mutate()},[d==null?void 0:d.email,m]);return e?a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:t}),a.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col mx-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gray-50",children:[a.jsxs("h2",{className:"text-lg font-bold text-gray-800",children:["Phiu lng - ",s]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:g,disabled:c||f,className:"btn btn-secondary flex items-center gap-2",children:[c?a.jsx(Mn,{size:18,className:"animate-spin"}):a.jsx(pS,{size:18}),"Xut nh"]}),a.jsxs("button",{onClick:b,disabled:m.isPending||f||!(d!=null&&d.email),className:"btn btn-primary flex items-center gap-2",title:d!=null&&d.email?"Gi phiu lng qua email":"Nhn vin khng c email",children:[m.isPending?a.jsx(Mn,{size:18,className:"animate-spin"}):a.jsx(bb,{size:18}),"Gi email"]}),a.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-200 rounded-lg",children:a.jsx(rl,{size:20})})]})]}),a.jsx("div",{className:"flex-1 overflow-auto p-6 bg-gray-100",children:f?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(Mn,{size:40,className:"animate-spin text-blue-500"})}):p?a.jsx("div",{className:"text-center py-8",children:a.jsx("p",{className:"text-red-500",children:"C li khi ti phiu lng"})}):d?a.jsx(iw,{ref:l,data:d}):null}),d&&a.jsxs("div",{className:"p-3 bg-gray-50 border-t text-sm text-gray-600 flex items-center justify-between",children:[a.jsxs("span",{children:["Email: ",d.email||a.jsx("span",{className:"italic text-gray-400",children:"Cha c"})]}),a.jsxs("span",{children:["Thc lnh: ",a.jsx("strong",{className:"text-green-600",children:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(d.thucLinh)})]})]})]})]}):null}function i3({ngayCong:e,onClose:t,onSave:r,isLoading:n}){var p,m,g;const[s,l]=P.useState(((p=e==null?void 0:e.ngayCongDieuChinh)==null?void 0:p.toString())||""),[c,u]=P.useState((e==null?void 0:e.ghiChu)||"");if(!e)return null;const d=e.ngayCongDieuChinh?Number(e.ngayCongDieuChinh):Number(e.soCongThucTe)+Number(e.soNgayNghiPhep),f=async b=>{if(b.preventDefault(),!s)return;const v=parseFloat(s);if(isNaN(v)||v<0){alert("S ngy cng khng hp l");return}await r(v,c||void 0)};return a.jsx("div",{className:"modal-overlay",onClick:t,children:a.jsxs("div",{className:"modal-content max-w-lg",onClick:b=>b.stopPropagation(),children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Fh,{className:"w-5 h-5"}),a.jsx("h3",{className:"text-lg font-semibold",children:"iu chnh ngy cng"})]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:a.jsx(rl,{className:"w-5 h-5"})})]}),a.jsxs("form",{onSubmit:f,children:[a.jsxs("div",{className:"modal-body space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Nhn vin"}),a.jsx("div",{className:"font-semibold text-gray-900",children:((m=e.nhanVien)==null?void 0:m.hoTen)||"N/A"}),a.jsx("div",{className:"text-sm text-gray-500",children:((g=e.nhanVien)==null?void 0:g.maNhanVien)||"N/A"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[a.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Ngy cng l thuyt"}),a.jsx("div",{className:"text-xl font-bold text-blue-700",children:Number(e.ngayCongLyThuyet).toFixed(1)})]}),a.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[a.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"S cng thc t"}),a.jsx("div",{className:"text-xl font-bold text-green-700",children:Number(e.soCongThucTe).toFixed(1)})]}),a.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[a.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Ngh c php"}),a.jsx("div",{className:"text-xl font-bold text-yellow-700",children:Number(e.soNgayNghiPhep).toFixed(1)})]}),a.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[a.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Ngh khng php"}),a.jsx("div",{className:"text-xl font-bold text-red-700",children:Number(e.soNgayNghiKhongPhep).toFixed(1)})]})]}),a.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border-2 border-purple-200",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Ngy cng hin ti (dng  tnh lng)"}),a.jsxs("div",{className:"text-2xl font-bold text-purple-700",children:[d.toFixed(1)," ngy"]}),e.ngayCongDieuChinh&&a.jsx("div",{className:"text-xs text-purple-600 mt-1",children:"  iu chnh th cng"})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("label",{className:"label",children:a.jsx("span",{className:"label-text font-semibold",children:"iu chnh ngy cng mi"})}),a.jsx("input",{type:"number",step:"0.5",min:"0",max:Number(e.ngayCongLyThuyet),className:"input input-bordered w-full",value:s,onChange:b=>l(b.target.value),placeholder:"Nhp s ngy cng",required:!0}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Nhp s ngy cng mi  iu chnh th cng"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"label",children:a.jsx("span",{className:"label-text font-semibold",children:"Ghi ch"})}),a.jsx("textarea",{className:"textarea textarea-bordered w-full",rows:3,value:c,onChange:b=>u(b.target.value),placeholder:"L do iu chnh..."})]}),a.jsxs("div",{className:"flex items-start gap-2 bg-yellow-50 p-3 rounded-lg border border-yellow-200",children:[a.jsx(wx,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"text-sm text-yellow-800",children:[a.jsx("div",{className:"font-semibold mb-1",children:"Lu :"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[a.jsx("li",{children:"iu chnh ngy cng s nh hng n lng c bn"}),a.jsx("li",{children:"Nn c l do r rng trong phn ghi ch"}),a.jsx("li",{children:"C th xa iu chnh  tr v tnh t ng"})]})]})]})]}),a.jsxs("div",{className:"modal-footer",children:[a.jsx("button",{type:"button",onClick:t,className:"btn btn-ghost",children:"Hy"}),a.jsx("button",{type:"submit",className:"btn btn-primary",disabled:n||!s,children:n?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"loading loading-spinner loading-sm"}),"ang lu..."]}):a.jsxs(a.Fragment,{children:[a.jsx(vo,{className:"w-4 h-4"}),"Lu iu chnh"]})})]})]})]})})}function l3(){const{id:e}=yx(),t=fi(),r=Sn(),[n,s]=P.useState(null),[l,c]=P.useState(new Map),[u,d]=P.useState(!1),[f,p]=P.useState(!1),[m,g]=P.useState(""),[b,v]=P.useState(null),[y,N]=P.useState(null),{data:_,isLoading:C}=Bt({queryKey:["bang-luong",e],queryFn:()=>xa.layTheoId(Number(e)),enabled:!!e}),{data:S}=Bt({queryKey:["ngay-cong",e],queryFn:()=>Wv.layTatCa(Number(e)),enabled:!!e}),{data:E}=Bt({queryKey:["bang-luong-lich-su",e],queryFn:()=>xa.layLichSu(Number(e)),enabled:!!e&&u}),O=ot({mutationFn:xa.capNhatNhieuChiTiet,onSuccess:()=>{r.invalidateQueries({queryKey:["bang-luong",e]}),c(new Map),je.success("Lu thay i thnh cng!")},onError:()=>{je.error("C li khi lu")}}),F=ot({mutationFn:({nguoiChot:k})=>xa.chotBangLuong(Number(e),{nguoiChot:k}),onSuccess:()=>{r.invalidateQueries({queryKey:["bang-luong",e]}),je.success("Cht bng lng thnh cng!"),p(!1)},onError:()=>{je.error("C li khi cht")}}),T=ot({mutationFn:()=>xa.moKhoa(Number(e)),onSuccess:()=>{r.invalidateQueries({queryKey:["bang-luong",e]}),je.success("M kha thnh cng!")}}),D=ot({mutationFn:()=>Up.guiTatCa(Number(e)),onSuccess:k=>{k.success>0&&je.success(` gi ${k.success} phiu lng thnh cng!`),k.failed>0&&je.error(`${k.failed} phiu lng gi tht bi`)},onError:()=>{je.error("C li khi gi phiu lng")}}),I=ot({mutationFn:({nhanVienId:k,ngayCongMoi:B,ghiChu:A})=>Wv.dieuChinh(Number(e),k,{ngayCongMoi:B,ghiChu:A}),onSuccess:()=>{r.invalidateQueries({queryKey:["ngay-cong",e]}),r.invalidateQueries({queryKey:["bang-luong",e]}),je.success("Cp nht ngy cng thnh cng!"),N(null)},onError:()=>{je.error("C li khi cp nht ngy cng")}}),J=ot({mutationFn:()=>xa.tinhLaiLuong(Number(e)),onSuccess:k=>{r.invalidateQueries({queryKey:["bang-luong",e]}),je.success(k.message)},onError:()=>{je.error("C li khi tnh li lng")}}),Z=k=>{const B=S==null?void 0:S.find(A=>A.nhanVienId===k);if(B)N(B);else{const A=_==null?void 0:_.danhSachNhanVien.find(M=>M.nhanVienId===k);if(A&&_){const M={id:0,bangLuongId:_.id,nhanVienId:k,ngayCongLyThuyet:_.ngayCongLyThuyet,soCongThucTe:A.ngayCongThucTe,soNgayNghiPhep:0,soNgayNghiKhongPhep:0,ngayCongDieuChinh:null,ghiChu:null,nhanVien:{id:k,maNhanVien:A.maNhanVien,hoTen:A.hoTen}};N(M)}else je.error("Khng tm thy thng tin nhn vin")}},ee=async(k,B)=>{y&&await I.mutateAsync({nhanVienId:y.nhanVienId,ngayCongMoi:k,ghiChu:B})},ne=(k,B,A)=>{(_==null?void 0:_.trangThai)==="NHAP"&&s({nhanVienId:k,khoanLuongId:B,value:A.toString()})},he=k=>{n&&s({...n,value:k})},Q=()=>{var ae;if(!n||!_)return;const k=iE(n.value),B=`${n.nhanVienId}-${n.khoanLuongId}`,A=_.danhSachNhanVien.find(de=>de.nhanVienId===n.nhanVienId),M=((ae=A==null?void 0:A.cacKhoanLuong.find(de=>de.khoanLuongId===n.khoanLuongId))==null?void 0:ae.soTien)||0;if(k!==M){const de=new Map(l);de.set(B,{nhanVienId:n.nhanVienId,khoanLuongId:n.khoanLuongId,soTien:k}),c(de)}s(null)},xe=k=>{k.key==="Enter"?Q():k.key==="Escape"&&s(null)},Y=()=>{if(l.size===0){je("Khng c thay i  lu");return}const k=Array.from(l.values()).map(B=>({bangLuongId:Number(e),...B}));O.mutate(k)},le=async()=>{try{const k=await Z0.export(Number(e));cE(k.data,`bang-luong-${e}.xlsx`),je.success("Xut file thnh cng!")}catch{je.error("C li khi xut file")}},X=P.useCallback((k,B,A)=>{const M=`${k}-${B}`,ae=l.get(M);return ae?ae.soTien:A},[l]),ve=P.useCallback(k=>{let B=0,A=0;for(const M of k.cacKhoanLuong){const ae=X(k.nhanVienId,M.khoanLuongId,M.soTien);M.loai==="THU_NHAP"?B+=ae:A+=ae}return l.forEach(M=>{if(M.nhanVienId===k.nhanVienId&&!k.cacKhoanLuong.find(de=>de.khoanLuongId===M.khoanLuongId)){const de=_==null?void 0:_.danhSachKhoanLuong.find(be=>be.id===M.khoanLuongId);(de==null?void 0:de.loai)==="THU_NHAP"?B+=M.soTien:A+=M.soTien}}),{tongThuNhap:B,tongKhauTru:A,thucLinh:B-A}},[X,l,_==null?void 0:_.danhSachKhoanLuong]);if(C)return a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"text-gray-500",children:"ang ti..."})});if(!_)return a.jsxs("div",{className:"text-center py-8",children:[a.jsx("p",{className:"text-gray-500",children:"Khng tm thy bng lng"}),a.jsx("button",{onClick:()=>t("/bang-luong"),className:"btn btn-primary mt-4",children:"Quay li"})]});const K=_.trangThai==="NHAP";return a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>t("/bang-luong"),className:"p-2 hover:bg-gray-200 rounded-lg",children:a.jsx(Nx,{size:20})}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-xl font-bold text-gray-800",children:["Bng lng ",_.phongBan.tenPhongBan]}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Thng ",_.thang,"/",_.nam]})]}),a.jsxs("span",{className:`badge ${_.trangThai==="NHAP"?"badge-nhap":_.trangThai==="DA_CHOT"?"badge-da-chot":"badge-khoa"}`,children:[_.trangThai==="NHAP"&&"ang nhp",_.trangThai==="DA_CHOT"&&" cht",_.trangThai==="KHOA"&&" kha"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[l.size>0&&a.jsxs("span",{className:"text-sm text-orange-600 mr-2",children:[l.size," thay i cha lu"]}),K&&l.size>0&&a.jsxs("button",{onClick:Y,disabled:O.isPending,className:"btn btn-success",children:[a.jsx(vo,{size:18}),"Lu (",l.size,")"]}),a.jsxs("button",{onClick:le,className:"btn btn-secondary",children:[a.jsx(cS,{size:18}),"Xut Excel"]}),a.jsxs("button",{onClick:()=>d(!u),className:"btn btn-secondary",children:[a.jsx(Ph,{size:18}),"Lch s"]}),a.jsxs("button",{onClick:()=>D.mutate(),disabled:D.isPending,className:"btn btn-secondary",title:"Gi phiu lng cho tt c nhn vin qua email",children:[D.isPending?a.jsx(Mn,{size:18,className:"animate-spin"}):a.jsx(bb,{size:18}),"Gi tt c"]}),K&&a.jsxs("button",{onClick:()=>J.mutate(),disabled:J.isPending,className:"btn btn-secondary",title:"Tnh li lng theo ngy cng",children:[J.isPending?a.jsx(Mn,{size:18,className:"animate-spin"}):a.jsx(ih,{size:18}),"Tnh li lng"]}),K&&a.jsxs("button",{onClick:()=>p(!0),className:"btn btn-primary",children:[a.jsx(yb,{size:18}),"Cht"]}),_.trangThai==="DA_CHOT"&&a.jsxs("button",{onClick:()=>T.mutate(),className:"btn btn-secondary",children:[a.jsx(kb,{size:18}),"M kha"]})]})]}),a.jsx("div",{className:"card overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"excel-table w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"sticky left-0 z-20 bg-gray-200",children:"STT"}),a.jsx("th",{className:"sticky left-10 z-20 bg-gray-200 min-w-[80px]",children:"M NV"}),a.jsx("th",{className:"sticky left-[120px] z-20 bg-gray-200 min-w-[180px]",children:"H tn"}),a.jsx("th",{className:"min-w-[120px]",children:"Chc v"}),a.jsx("th",{className:"min-w-[80px] text-center bg-orange-100",children:"Ngy cng"}),a.jsx("th",{className:"min-w-[100px] text-center bg-orange-100",children:"NC iu chnh"}),_.danhSachKhoanLuong.map(k=>a.jsx("th",{className:"min-w-[120px] text-right",children:k.tenKhoan},k.id)),a.jsx("th",{className:"min-w-[130px] text-right bg-blue-100",children:"Tng thu nhp"}),a.jsx("th",{className:"min-w-[100px] text-right bg-red-100",children:"Khu tr"}),a.jsx("th",{className:"min-w-[130px] text-right bg-green-100",children:"Thc lnh"}),a.jsx("th",{className:"min-w-[80px] text-center bg-purple-100",children:"Phiu lng"})]})}),a.jsx("tbody",{children:_.danhSachNhanVien.map((k,B)=>{const A=ve(k),M=S==null?void 0:S.find(de=>de.nhanVienId===k.nhanVienId),ae=M!=null&&M.ngayCongDieuChinh?Number(M.ngayCongDieuChinh):M?Number(M.soCongThucTe)+Number(M.soNgayNghiPhep):k.ngayCongThucTe;return a.jsxs("tr",{children:[a.jsx("td",{className:"sticky left-0 bg-white",children:B+1}),a.jsx("td",{className:"sticky left-10 bg-white font-medium",children:k.maNhanVien}),a.jsx("td",{className:"sticky left-[120px] bg-white",children:k.hoTen}),a.jsx("td",{children:k.chucVu||"-"}),a.jsxs("td",{className:"text-center bg-orange-50 relative group",children:[a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsxs("span",{className:`font-medium ${M!=null&&M.ngayCongDieuChinh?"text-orange-600":""}`,children:[ae.toFixed(1),"/",_.ngayCongLyThuyet]}),K&&a.jsx("button",{onClick:()=>Z(k.nhanVienId),className:"opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-orange-200 rounded",title:"Chi tit v iu chnh",children:a.jsx(wb,{className:"w-3 h-3 text-orange-600"})}),(M==null?void 0:M.ngayCongDieuChinh)&&a.jsx("span",{className:"text-xs text-orange-600",title:" iu chnh th cng",children:""})]}),M&&a.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[a.jsxs("span",{className:"text-green-600",children:[Number(M.soNgayNghiPhep).toFixed(1),"P"]}),Number(M.soNgayNghiKhongPhep)>0&&a.jsxs("span",{className:"text-red-600 ml-1",children:[Number(M.soNgayNghiKhongPhep).toFixed(1),"KP"]})]})]}),a.jsx("td",{className:`text-center bg-orange-50 ${K?"cursor-pointer hover:bg-orange-100":""}`,onClick:()=>K&&Z(k.nhanVienId),title:K?"Click  iu chnh ngy cng":"",children:M!=null&&M.ngayCongDieuChinh?a.jsx("span",{className:"font-medium text-orange-600",children:Number(M.ngayCongDieuChinh).toFixed(1)}):a.jsx("span",{className:K?"text-blue-500 hover:underline":"text-gray-400",children:K?"Nhp":"-"})}),_.danhSachKhoanLuong.map(de=>{const be=k.cacKhoanLuong.find(Ne=>Ne.khoanLuongId===de.id),we=(be==null?void 0:be.soTien)||0,ye=X(k.nhanVienId,de.id,we),Je=(n==null?void 0:n.nhanVienId)===k.nhanVienId&&(n==null?void 0:n.khoanLuongId)===de.id,G=l.has(`${k.nhanVienId}-${de.id}`);return a.jsx("td",{className:`number ${K?"editable":""} ${G?"bg-yellow-100":""}`,onClick:()=>ne(k.nhanVienId,de.id,ye),children:Je?a.jsx("input",{type:"text",value:n.value,onChange:Ne=>he(Ne.target.value),onBlur:Q,onKeyDown:xe,className:"cell-input",autoFocus:!0}):Zt(ye)},de.id)}),a.jsx("td",{className:"number font-semibold bg-blue-50",children:Zt(A.tongThuNhap)}),a.jsx("td",{className:"number text-red-600 bg-red-50",children:Zt(A.tongKhauTru)}),a.jsx("td",{className:"number font-bold text-green-600 bg-green-50",children:Zt(A.thucLinh)}),a.jsx("td",{className:"text-center bg-purple-50",children:a.jsx("button",{onClick:()=>v({id:k.nhanVienId,hoTen:k.hoTen}),className:"p-1.5 hover:bg-purple-200 rounded-lg text-purple-600 transition-colors",title:"Xem phiu lng",children:a.jsx(Hc,{size:18})})})]},k.nhanVienId)})}),a.jsx("tfoot",{children:a.jsxs("tr",{className:"total-row",children:[a.jsx("td",{colSpan:4,className:"text-right font-bold",children:"TNG CNG"}),a.jsx("td",{className:"bg-orange-100"}),a.jsx("td",{className:"bg-orange-100"}),_.danhSachKhoanLuong.map(k=>{const B=_.danhSachNhanVien.reduce((A,M)=>{const ae=M.cacKhoanLuong.find(de=>de.khoanLuongId===k.id);return A+X(M.nhanVienId,k.id,(ae==null?void 0:ae.soTien)||0)},0);return a.jsx("td",{className:"number font-bold",children:Zt(B)},k.id)}),a.jsx("td",{className:"number font-bold bg-blue-100",children:Zt(_.danhSachNhanVien.reduce((k,B)=>k+ve(B).tongThuNhap,0))}),a.jsx("td",{className:"number font-bold text-red-600 bg-red-100",children:Zt(_.danhSachNhanVien.reduce((k,B)=>k+ve(B).tongKhauTru,0))}),a.jsx("td",{className:"number font-bold text-green-600 bg-green-100",children:Zt(_.danhSachNhanVien.reduce((k,B)=>k+ve(B).thucLinh,0))}),a.jsx("td",{className:"bg-purple-100"})]})})]})})}),u&&a.jsxs("div",{className:"card mt-4",children:[a.jsx("h3",{className:"font-semibold mb-3",children:"Lch s chnh sa"}),E&&E.length>0?a.jsx("div",{className:"max-h-64 overflow-y-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-2",children:"Thi gian"}),a.jsx("th",{className:"text-left py-2",children:"Nhn vin"}),a.jsx("th",{className:"text-left py-2",children:"Khon"}),a.jsx("th",{className:"text-right py-2",children:"C"}),a.jsx("th",{className:"text-right py-2",children:"Mi"}),a.jsx("th",{className:"text-left py-2",children:"Ngi sa"})]})}),a.jsx("tbody",{children:E.map(k=>{var B,A;return a.jsxs("tr",{className:"border-b",children:[a.jsx("td",{className:"py-2",children:new Date(k.ngayThayDoi).toLocaleString("vi-VN")}),a.jsx("td",{className:"py-2",children:(B=k.nhanVien)==null?void 0:B.hoTen}),a.jsx("td",{className:"py-2",children:(A=k.khoanLuong)==null?void 0:A.tenKhoan}),a.jsx("td",{className:"py-2 text-right",children:Zt(k.giaTriCu)}),a.jsx("td",{className:"py-2 text-right font-medium",children:Zt(k.giaTriMoi)}),a.jsx("td",{className:"py-2",children:k.nguoiThayDoi})]},k.id)})})]})}):a.jsx("p",{className:"text-gray-500",children:"Cha c lch s chnh sa"})]}),f&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:"Cht bng lng"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Sau khi cht, bng lng s khng th chnh sa. Bn c chc chn?"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngi cht *"}),a.jsx("input",{type:"text",value:m,onChange:k=>g(k.target.value),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp tn ngi cht"})]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsxs("button",{onClick:()=>p(!1),className:"btn btn-secondary",children:[a.jsx(rl,{size:18}),"Hy"]}),a.jsxs("button",{onClick:()=>F.mutate({nguoiChot:m}),disabled:!m||F.isPending,className:"btn btn-primary",children:[a.jsx(Ah,{size:18}),"Xc nhn cht"]})]})]})}),b&&a.jsx(s3,{isOpen:!!b,onClose:()=>v(null),bangLuongId:Number(e),nhanVienId:b.id,hoTen:b.hoTen}),y&&a.jsx(i3,{ngayCong:y,onClose:()=>N(null),onSave:ee,isLoading:I.isPending})]})}const ty={DANG_LAM:{label:"ang lm",color:"bg-green-100 text-green-700"},NGHI_VIEC:{label:" ngh",color:"bg-red-100 text-red-700"},TAM_NGHI:{label:"Tm ngh",color:"bg-yellow-100 text-yellow-700"}};function o3(){const e=Sn(),[t,r]=P.useState(!1),[n,s]=P.useState(),[l,c]=P.useState(""),[u,d]=P.useState(""),[f,p]=P.useState({maNhanVien:"",hoTen:"",email:"",soDienThoai:"",phongBanId:0,chucVu:"",ngayVaoLam:"",gioiTinh:"",ngaySinh:"",diaChi:"",trangThai:"DANG_LAM"}),{data:m,isLoading:g}=Bt({queryKey:["nhan-vien",n,l,u],queryFn:()=>os.layTatCa({phongBanId:n,tuKhoa:u,trangThai:l||void 0})}),b=Array.isArray(m)?m:(m==null?void 0:m.data)||[],{data:v}=Bt({queryKey:["phong-ban"],queryFn:ga.layTatCa}),y=ot({mutationFn:os.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["nhan-vien"]}),je.success("To nhn vin thnh cng!"),C()},onError:T=>{var D,I;je.error(((I=(D=T.response)==null?void 0:D.data)==null?void 0:I.message)||"C li xy ra")}}),N=ot({mutationFn:({id:T,data:D})=>os.capNhat(T,D),onSuccess:()=>{e.invalidateQueries({queryKey:["nhan-vien"]}),je.success("Cp nht thnh cng!"),C()},onError:T=>{var D,I;je.error(((I=(D=T.response)==null?void 0:D.data)==null?void 0:I.message)||"C li xy ra")}}),_=ot({mutationFn:os.xoa,onSuccess:()=>{e.invalidateQueries({queryKey:["nhan-vien"]}),je.success("Xa nhn vin thnh cng!")},onError:T=>{var D,I;je.error(((I=(D=T.response)==null?void 0:D.data)==null?void 0:I.message)||"C li xy ra")}}),C=()=>{r(!1),p({maNhanVien:"",hoTen:"",email:"",soDienThoai:"",phongBanId:0,chucVu:"",ngayVaoLam:"",gioiTinh:"",ngaySinh:"",diaChi:"",trangThai:"DANG_LAM"})},S=async()=>{try{const{maNhanVien:T}=await os.layMaTuDong();p(D=>({...D,maNhanVien:T})),r(!0)}catch{r(!0)}},E=T=>{confirm(`Khi phc nhn vin "${T.hoTen}" v trng thi ang lm?`)&&N.mutate({id:T.id,data:{trangThai:"DANG_LAM"}})},O=()=>{if(!f.maNhanVien||!f.hoTen||!f.phongBanId){je.error("Vui lng in y  thng tin bt buc");return}y.mutate(f)},F=T=>{confirm(`Bn c chc mun xa nhn vin "${T.hoTen}"?`)&&_.mutate(T.id)};return a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx(Ba,{size:28}),"Qun l Nhn vin"]}),a.jsxs("button",{onClick:S,className:"btn btn-primary",children:[a.jsx(Ha,{size:20}),"Thm nhn vin"]})]}),a.jsx("div",{className:"card mb-6",children:a.jsxs("div",{className:"flex gap-4 items-center",children:[a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"relative",children:[a.jsx(Tx,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",value:u,onChange:T=>d(T.target.value),placeholder:"Tm kim theo tn, m NV, email...",className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]})}),a.jsx("div",{children:a.jsxs("select",{value:n||"",onChange:T=>s(T.target.value?Number(T.target.value):void 0),className:"border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"",children:"Tt c phng ban"}),v==null?void 0:v.map(T=>a.jsx("option",{value:T.id,children:T.tenPhongBan},T.id))]})}),a.jsx("div",{children:a.jsxs("select",{value:l,onChange:T=>c(T.target.value),className:"border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"",children:"Tt c trng thi"}),a.jsx("option",{value:"DANG_LAM",children:"ang lm"}),a.jsx("option",{value:"NGHI_VIEC",children:" ngh"}),a.jsx("option",{value:"TAM_NGHI",children:"Tm ngh"})]})})]})}),a.jsx("div",{className:"card",children:g?a.jsx("p",{className:"text-center py-8 text-gray-500",children:"ang ti..."}):b&&b.length>0?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b bg-gray-50",children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"M NV"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"H tn"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Phng ban"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Chc v"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Email"}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Ngy vo lm"}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Trng thi"}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Thao tc"})]})}),a.jsx("tbody",{children:b.map(T=>{var D,I,J;return a.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"py-3 px-4 font-medium",children:T.maNhanVien}),a.jsx("td",{className:"py-3 px-4",children:T.hoTen}),a.jsx("td",{className:"py-3 px-4",children:(D=T.phongBan)==null?void 0:D.tenPhongBan}),a.jsx("td",{className:"py-3 px-4",children:T.chucVu||"-"}),a.jsx("td",{className:"py-3 px-4",children:T.email||"-"}),a.jsx("td",{className:"py-3 px-4 text-center",children:T.ngayVaoLam?new Date(T.ngayVaoLam).toLocaleDateString("vi-VN"):"-"}),a.jsx("td",{className:"py-3 px-4 text-center",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${((I=ty[T.trangThai])==null?void 0:I.color)||"bg-gray-100"}`,children:((J=ty[T.trangThai])==null?void 0:J.label)||T.trangThai})}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsxs(wn,{to:`/nhan-vien/${T.id}`,className:"px-3 py-1.5 text-xs bg-blue-100 text-blue-700 hover:bg-blue-200 rounded flex items-center gap-1 font-medium",title:"Xem & chnh sa thng tin nhn vin",children:[a.jsx(go,{size:14}),"Chi tit"]}),T.trangThai==="NGHI_VIEC"?a.jsx("button",{onClick:()=>E(T),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg",title:"Khi phc",children:a.jsx(kx,{size:18})}):a.jsx("button",{onClick:()=>F(T),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Cho ngh vic",children:a.jsx(li,{size:18})})]})})]},T.id)})})]})}):a.jsx("p",{className:"text-center py-8 text-gray-500",children:"Cha c nhn vin no"})}),t&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-lg",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:"Thm nhn vin mi"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"M nhn vin *"}),a.jsx("input",{type:"text",value:f.maNhanVien,onChange:T=>p({...f,maNhanVien:T.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"H tn *"}),a.jsx("input",{type:"text",value:f.hoTen,onChange:T=>p({...f,hoTen:T.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phng ban *"}),a.jsxs("select",{value:f.phongBanId,onChange:T=>p({...f,phongBanId:Number(T.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:0,children:"-- Chn phng ban --"}),v==null?void 0:v.map(T=>a.jsx("option",{value:T.id,children:T.tenPhongBan},T.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chc v"}),a.jsx("input",{type:"text",value:f.chucVu,onChange:T=>p({...f,chucVu:T.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gii tnh"}),a.jsxs("select",{value:f.gioiTinh,onChange:T=>p({...f,gioiTinh:T.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"",children:"-- Chn --"}),a.jsx("option",{value:"NAM",children:"Nam"}),a.jsx("option",{value:"NU",children:"N"}),a.jsx("option",{value:"KHAC",children:"Khc"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy sinh"}),a.jsx("input",{type:"date",value:f.ngaySinh,onChange:T=>p({...f,ngaySinh:T.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),a.jsx("input",{type:"email",value:f.email,onChange:T=>p({...f,email:T.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"S in thoi"}),a.jsx("input",{type:"text",value:f.soDienThoai,onChange:T=>p({...f,soDienThoai:T.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"a ch"}),a.jsx("input",{type:"text",value:f.diaChi,onChange:T=>p({...f,diaChi:T.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp a ch..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy vo lm"}),a.jsx("input",{type:"date",value:f.ngayVaoLam,onChange:T=>p({...f,ngayVaoLam:T.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[a.jsx("button",{onClick:C,className:"btn btn-secondary",children:"Hy"}),a.jsx("button",{onClick:O,disabled:y.isPending||N.isPending,className:"btn btn-primary",children:y.isPending||N.isPending?"ang lu...":"Lu"})]})]})})]})}const c3=async e=>(await Le.get(`/nhan-vien/${e}/hop-dong`)).data,u3=async(e,t)=>(await Le.post(`/nhan-vien/${e}/hop-dong`,t)).data,h3=async(e,t)=>(await Le.put(`/nhan-vien/hop-dong/${e}`,t)).data,d3=async(e,t)=>(await Le.post(`/nhan-vien/hop-dong/${e}/ngung`,t)).data,f3=async e=>{await Le.delete(`/nhan-vien/hop-dong/${e}`)},p3=async e=>(await Le.get(`/nhan-vien/${e}/ngan-hang`)).data,x3=async(e,t)=>(await Le.post(`/nhan-vien/${e}/ngan-hang`,t)).data,m3=async(e,t)=>(await Le.put(`/nhan-vien/ngan-hang/${e}`,t)).data,g3=async e=>(await Le.post(`/nhan-vien/ngan-hang/${e}/dat-mac-dinh`)).data,v3=async e=>{await Le.delete(`/nhan-vien/ngan-hang/${e}`)},lw=async()=>(await Le.get("/nhom-nhan-vien")).data,y3=async e=>(await Le.post("/nhom-nhan-vien",e)).data,b3=async(e,t)=>(await Le.put(`/nhom-nhan-vien/${e}`,t)).data,w3=async e=>{await Le.delete(`/nhom-nhan-vien/${e}`)},ry={THU_VIEC:"Th vic",MOT_NAM:"1 nm",BA_NAM:"3 nm",VO_THOI_HAN:"V thi hn"},N3={HIEU_LUC:"Hiu lc",HET_HAN:"Ht hn",HUY_BO:"Hy b"},k3=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e);function T3({nhanVienId:e}){const t=Sn(),[r,n]=P.useState(!1),[s,l]=P.useState(null),[c,u]=P.useState(null),[d,f]=P.useState({loaiHopDong:"VO_THOI_HAN",tuNgay:new Date().toISOString().split("T")[0],denNgay:"",luongCoBan:0,luongDongBH:0,heSoLuong:1,ghiChu:""}),[p,m]=P.useState({ngayKetThuc:new Date().toISOString().split("T")[0],lyDo:""}),{data:g,isLoading:b}=Bt({queryKey:["hop-dong",e],queryFn:()=>c3(e)}),v=ot({mutationFn:F=>u3(e,{...F,denNgay:F.denNgay||void 0}),onSuccess:()=>{je.success("To hp ng thnh cng"),t.invalidateQueries({queryKey:["hop-dong",e]}),n(!1),C()},onError:F=>{var T,D;je.error(((D=(T=F.response)==null?void 0:T.data)==null?void 0:D.message)||"Li to hp ng")}}),y=ot({mutationFn:({id:F,data:T})=>h3(F,T),onSuccess:()=>{je.success("Cp nht hp ng thnh cng"),t.invalidateQueries({queryKey:["hop-dong",e]}),l(null),C()},onError:F=>{var T,D;je.error(((D=(T=F.response)==null?void 0:T.data)==null?void 0:D.message)||"Li cp nht")}}),N=ot({mutationFn:({id:F,data:T})=>d3(F,T),onSuccess:()=>{je.success(" ngng hp ng"),t.invalidateQueries({queryKey:["hop-dong",e]}),u(null)},onError:F=>{var T,D;je.error(((D=(T=F.response)==null?void 0:T.data)==null?void 0:D.message)||"Li ngng hp ng")}}),_=ot({mutationFn:f3,onSuccess:()=>{je.success(" xa hp ng"),t.invalidateQueries({queryKey:["hop-dong",e]})},onError:F=>{var T,D;je.error(((D=(T=F.response)==null?void 0:T.data)==null?void 0:D.message)||"Li xa")}}),C=()=>{f({loaiHopDong:"VO_THOI_HAN",tuNgay:new Date().toISOString().split("T")[0],denNgay:"",luongCoBan:0,luongDongBH:0,heSoLuong:1,ghiChu:""})},S=F=>{var T;f({loaiHopDong:F.loaiHopDong,tuNgay:F.tuNgay.split("T")[0],denNgay:((T=F.denNgay)==null?void 0:T.split("T")[0])||"",luongCoBan:Number(F.luongCoBan),luongDongBH:Number(F.luongDongBH||0),heSoLuong:Number(F.heSoLuong||1),ghiChu:F.ghiChu||""}),l(F.id),n(!0)},E=F=>{F.preventDefault(),s?y.mutate({id:s,data:d}):v.mutate(d)},O=F=>{F.preventDefault(),c&&N.mutate({id:c,data:p})};return b?a.jsx("div",{className:"p-4 text-center",children:"ang ti..."}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Lch s Hp ng / Lng"}),a.jsxs("button",{onClick:()=>{n(!0),l(null),C()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[a.jsx("span",{children:"+"})," Thm hp ng"]})]}),r&&a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[a.jsx("h4",{className:"font-medium mb-3",children:s?"Sa hp ng":"To hp ng mi"}),a.jsxs("form",{onSubmit:E,className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi hp ng"}),a.jsx("select",{value:d.loaiHopDong,onChange:F=>f({...d,loaiHopDong:F.target.value}),className:"w-full border rounded-lg px-3 py-2",children:Object.entries(ry).map(([F,T])=>a.jsx("option",{value:F,children:T},F))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lng c bn"}),a.jsx("input",{type:"number",value:d.luongCoBan,onChange:F=>f({...d,luongCoBan:Number(F.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0,required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"T ngy"}),a.jsx("input",{type:"date",value:d.tuNgay,onChange:F=>f({...d,tuNgay:F.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"n ngy ( trng nu v thi hn)"}),a.jsx("input",{type:"date",value:d.denNgay,onChange:F=>f({...d,denNgay:F.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lng ng BH"}),a.jsx("input",{type:"number",value:d.luongDongBH,onChange:F=>f({...d,luongDongBH:Number(F.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"H s lng"}),a.jsx("input",{type:"number",step:"0.01",value:d.heSoLuong,onChange:F=>f({...d,heSoLuong:Number(F.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ghi ch"}),a.jsx("textarea",{value:d.ghiChu,onChange:F=>f({...d,ghiChu:F.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),a.jsxs("div",{className:"col-span-2 flex gap-2",children:[a.jsx("button",{type:"submit",disabled:v.isPending||y.isPending,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:s?"Cp nht":"To mi"}),a.jsx("button",{type:"button",onClick:()=>{n(!1),l(null)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Hy"})]})]})]}),c&&a.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[a.jsx("h4",{className:"font-medium mb-3 text-yellow-800",children:"Ngng hp ng sm"}),a.jsxs("form",{onSubmit:O,className:"flex gap-4 items-end",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy kt thc"}),a.jsx("input",{type:"date",value:p.ngayKetThuc,onChange:F=>m({...p,ngayKetThuc:F.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"L do"}),a.jsx("input",{type:"text",value:p.lyDo,onChange:F=>m({...p,lyDo:F.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp l do..."})]}),a.jsx("button",{type:"submit",disabled:N.isPending,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:opacity-50",children:"Xc nhn"}),a.jsx("button",{type:"button",onClick:()=>u(null),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Hy"})]})]}),a.jsx("div",{className:"relative",children:(g==null?void 0:g.length)===0?a.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:"Cha c hp ng no"}):a.jsx("div",{className:"space-y-4",children:g==null?void 0:g.map((F,T)=>a.jsxs("div",{className:`relative pl-8 pb-4 ${T<((g==null?void 0:g.length)||0)-1?"border-l-2 border-gray-200":""}`,children:[a.jsx("div",{className:`absolute left-[-5px] w-3 h-3 rounded-full ${F.trangThai==="HIEU_LUC"?"bg-green-500":"bg-gray-400"}`}),a.jsxs("div",{className:`bg-white rounded-lg shadow p-4 ${F.trangThai==="HIEU_LUC"?"border-l-4 border-green-500":""}`,children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-semibold",children:ry[F.loaiHopDong]}),a.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${F.trangThai==="HIEU_LUC"?"bg-green-100 text-green-800":F.trangThai==="HET_HAN"?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"}`,children:N3[F.trangThai]})]}),a.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[new Date(F.tuNgay).toLocaleDateString("vi-VN"),"  ",F.denNgay?new Date(F.denNgay).toLocaleDateString("vi-VN"):"V thi hn"]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-lg font-bold text-blue-600",children:k3(Number(F.luongCoBan))}),F.heSoLuong&&a.jsxs("div",{className:"text-xs text-gray-500",children:["H s: ",F.heSoLuong]})]})]}),F.ghiChu&&a.jsx("div",{className:"text-sm text-gray-500 mt-2 italic",children:F.ghiChu}),a.jsxs("div",{className:"flex gap-2 mt-3",children:[a.jsx("button",{onClick:()=>S(F),className:"text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100",children:"Sa"}),F.trangThai==="HIEU_LUC"&&a.jsx("button",{onClick:()=>u(F.id),className:"text-xs px-2 py-1 bg-yellow-50 text-yellow-600 rounded hover:bg-yellow-100",children:"Ngng sm"}),a.jsx("button",{onClick:()=>{confirm("Xc nhn xa hp ng ny?")&&_.mutate(F.id)},className:"text-xs px-2 py-1 bg-red-50 text-red-600 rounded hover:bg-red-100",children:"Xa"})]})]})]},F.id))})})]})}const ny=[{code:"VCB",name:"Vietcombank"},{code:"TCB",name:"Techcombank"},{code:"BIDV",name:"BIDV"},{code:"VTB",name:"Vietinbank"},{code:"ACB",name:"ACB"},{code:"MBB",name:"MB Bank"},{code:"VPB",name:"VPBank"},{code:"TPB",name:"TPBank"},{code:"STB",name:"Sacombank"},{code:"SHB",name:"SHB"},{code:"MSB",name:"MSB"},{code:"OCB",name:"OCB"},{code:"HDB",name:"HDBank"},{code:"SCB",name:"SCB"},{code:"EIB",name:"Eximbank"},{code:"AGRI",name:"Agribank"},{code:"KHAC",name:"Khc"}];function j3({nhanVienId:e}){const t=Sn(),[r,n]=P.useState(!1),[s,l]=P.useState(null),[c,u]=P.useState({tenNganHang:"VCB",chiNhanh:"",soTaiKhoan:"",chuTaiKhoan:"",laMacDinh:!1,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""}),{data:d,isLoading:f}=Bt({queryKey:["ngan-hang",e],queryFn:()=>p3(e)}),p=ot({mutationFn:C=>x3(e,{...C,denNgay:C.denNgay||void 0}),onSuccess:()=>{je.success("Thm ti khon ngn hng thnh cng"),t.invalidateQueries({queryKey:["ngan-hang",e]}),n(!1),v()},onError:C=>{var S,E;je.error(((E=(S=C.response)==null?void 0:S.data)==null?void 0:E.message)||"Li thm ti khon")}}),m=ot({mutationFn:({id:C,data:S})=>m3(C,S),onSuccess:()=>{je.success("Cp nht ti khon thnh cng"),t.invalidateQueries({queryKey:["ngan-hang",e]}),l(null),n(!1),v()},onError:C=>{var S,E;je.error(((E=(S=C.response)==null?void 0:S.data)==null?void 0:E.message)||"Li cp nht")}}),g=ot({mutationFn:v3,onSuccess:()=>{je.success(" xa ti khon"),t.invalidateQueries({queryKey:["ngan-hang",e]})},onError:C=>{var S,E;je.error(((E=(S=C.response)==null?void 0:S.data)==null?void 0:E.message)||"Li xa")}}),b=ot({mutationFn:g3,onSuccess:()=>{je.success(" t lm mc nh"),t.invalidateQueries({queryKey:["ngan-hang",e]})},onError:C=>{var S,E;je.error(((E=(S=C.response)==null?void 0:S.data)==null?void 0:E.message)||"Li")}}),v=()=>{u({tenNganHang:"VCB",chiNhanh:"",soTaiKhoan:"",chuTaiKhoan:"",laMacDinh:!1,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""})},y=C=>{var S,E;u({tenNganHang:C.tenNganHang,chiNhanh:C.chiNhanh||"",soTaiKhoan:C.soTaiKhoan,chuTaiKhoan:C.chuTaiKhoan,laMacDinh:C.laMacDinh,tuNgay:((S=C.tuNgay)==null?void 0:S.split("T")[0])||"",denNgay:((E=C.denNgay)==null?void 0:E.split("T")[0])||"",ghiChu:C.ghiChu||""}),l(C.id),n(!0)},N=C=>{C.preventDefault(),s?m.mutate({id:s,data:c}):p.mutate(c)},_=C=>{const S=ny.find(E=>E.code===C);return S?S.name:C};return f?a.jsx("div",{className:"p-4 text-center",children:"ang ti..."}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Ti khon Ngn hng"}),a.jsxs("button",{onClick:()=>{n(!0),l(null),v()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[a.jsx("span",{children:"+"})," Thm ti khon"]})]}),r&&a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[a.jsx("h4",{className:"font-medium mb-3",children:s?"Sa ti khon":"Thm ti khon mi"}),a.jsxs("form",{onSubmit:N,className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngn hng"}),a.jsx("select",{value:c.tenNganHang,onChange:C=>u({...c,tenNganHang:C.target.value}),className:"w-full border rounded-lg px-3 py-2",children:ny.map(C=>a.jsx("option",{value:C.code,children:C.name},C.code))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chi nhnh"}),a.jsx("input",{type:"text",value:c.chiNhanh,onChange:C=>u({...c,chiNhanh:C.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: H Ni, TP.HCM..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"S ti khon *"}),a.jsx("input",{type:"text",value:c.soTaiKhoan,onChange:C=>u({...c,soTaiKhoan:C.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp s ti khon",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ch ti khon *"}),a.jsx("input",{type:"text",value:c.chuTaiKhoan,onChange:C=>u({...c,chuTaiKhoan:C.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"NGUYEN VAN A",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hiu lc t"}),a.jsx("input",{type:"date",value:c.tuNgay,onChange:C=>u({...c,tuNgay:C.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hiu lc n"}),a.jsx("input",{type:"date",value:c.denNgay,onChange:C=>u({...c,denNgay:C.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ghi ch"}),a.jsx("input",{type:"text",value:c.ghiChu,onChange:C=>u({...c,ghiChu:C.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ti khon nhn lng, ti khon ph..."})]}),a.jsx("div",{className:"col-span-2",children:a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:c.laMacDinh,onChange:C=>u({...c,laMacDinh:C.target.checked}),className:"w-4 h-4 rounded"}),a.jsx("span",{className:"text-sm",children:"t lm ti khon mc nh"})]})}),a.jsxs("div",{className:"col-span-2 flex gap-2",children:[a.jsx("button",{type:"submit",disabled:p.isPending||m.isPending,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:s?"Cp nht":"Thm"}),a.jsx("button",{type:"button",onClick:()=>{n(!1),l(null)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Hy"})]})]})]}),a.jsx("div",{className:"grid gap-4",children:(d==null?void 0:d.length)===0?a.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:"Cha c ti khon ngn hng no"}):d==null?void 0:d.map(C=>a.jsxs("div",{className:`bg-white rounded-lg shadow p-4 ${C.laMacDinh?"border-l-4 border-green-500":""}`,children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 font-bold text-sm",children:C.tenNganHang.slice(0,3)}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-semibold",children:_(C.tenNganHang)}),C.chiNhanh&&a.jsxs("span",{className:"text-sm text-gray-500",children:["- ",C.chiNhanh]}),C.laMacDinh&&a.jsx("span",{className:"text-xs px-2 py-0.5 bg-green-100 text-green-800 rounded-full",children:"Mc nh"})]}),a.jsx("div",{className:"text-lg font-mono text-gray-800",children:C.soTaiKhoan}),a.jsx("div",{className:"text-sm text-gray-500",children:C.chuTaiKhoan})]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-2",children:[C.tuNgay&&a.jsxs("div",{className:"text-xs text-gray-400",children:[new Date(C.tuNgay).toLocaleDateString("vi-VN"),C.denNgay&&`  ${new Date(C.denNgay).toLocaleDateString("vi-VN")}`]}),a.jsxs("div",{className:"flex gap-2",children:[!C.laMacDinh&&a.jsx("button",{onClick:()=>b.mutate(C.id),className:"text-xs px-2 py-1 bg-green-50 text-green-600 rounded hover:bg-green-100",children:"t mc nh"}),a.jsx("button",{onClick:()=>y(C),className:"text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100",children:"Sa"}),a.jsx("button",{onClick:()=>{confirm("Xc nhn xa ti khon ny?")&&g.mutate(C.id)},className:"text-xs px-2 py-1 bg-red-50 text-red-600 rounded hover:bg-red-100",children:"Xa"})]})]})]}),C.ghiChu&&a.jsx("div",{className:"text-sm text-gray-500 mt-2 italic",children:C.ghiChu})]},C.id))})]})}function _3({nhanVienId:e}){const t=Sn(),[r,n]=P.useState(null),{data:s,isLoading:l}=Bt({queryKey:["nhan-vien-nhom",e],queryFn:async()=>(await Le.get(`/nhan-vien/${e}/nhom`)).data}),{data:c}=Bt({queryKey:["nhom-nhan-vien"],queryFn:()=>lw()}),u=c==null?void 0:c.filter(g=>!(s!=null&&s.some(b=>b.nhom.id===g.id))),d=ot({mutationFn:async g=>Le.post(`/nhan-vien/${e}/them-vao-nhom`,{nhomId:g,tuNgay:new Date().toISOString().split("T")[0]}),onSuccess:()=>{je.success(" thm vo nhm"),t.invalidateQueries({queryKey:["nhan-vien-nhom",e]}),n(null)},onError:g=>{var b,v;je.error(((v=(b=g.response)==null?void 0:b.data)==null?void 0:v.message)||"Li thm vo nhm")}}),f=ot({mutationFn:async g=>Le.post(`/nhan-vien/${e}/go-khoi-nhom`,{nhomId:g,denNgay:new Date().toISOString().split("T")[0]}),onSuccess:()=>{je.success(" g khi nhm"),t.invalidateQueries({queryKey:["nhan-vien-nhom",e]})},onError:g=>{var b,v;je.error(((v=(b=g.response)==null?void 0:b.data)==null?void 0:v.message)||"Li g khi nhm")}}),p=()=>{r&&d.mutate(r)},m=g=>{confirm("Xc nhn g khi nhm?")&&f.mutate(g)};return l?a.jsx("div",{className:"p-4 text-center",children:"ang ti..."}):a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"flex justify-between items-center",children:a.jsx("h3",{className:"text-lg font-semibold",children:"Nhm Nhn vin"})}),u&&u.length>0&&a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[a.jsx("h4",{className:"font-medium mb-3",children:"Thm vo nhm"}),a.jsxs("div",{className:"flex gap-2 items-center",children:[a.jsxs("select",{value:r||"",onChange:g=>n(Number(g.target.value)),className:"flex-1 border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"",children:"-- Chn nhm --"}),u.map(g=>a.jsxs("option",{value:g.id,children:[g.tenNhom," ",g.moTa&&`(${g.moTa})`]},g.id))]}),a.jsx("button",{onClick:p,disabled:!r,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:"Thm"})]})]}),a.jsx("div",{className:"grid gap-3",children:(s==null?void 0:s.length)===0?a.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:"Nhn vin cha thuc nhm no"}):s==null?void 0:s.map(g=>a.jsxs("div",{className:"bg-white rounded-lg shadow p-4 flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-white font-bold",style:{backgroundColor:g.nhom.mauSac||"#6B7280"},children:g.nhom.tenNhom.charAt(0).toUpperCase()}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold",children:g.nhom.tenNhom}),g.nhom.moTa&&a.jsx("div",{className:"text-sm text-gray-500",children:g.nhom.moTa}),a.jsxs("div",{className:"text-xs text-gray-400",children:["T ",new Date(g.tuNgay).toLocaleDateString("vi-VN"),g.denNgay&&` n ${new Date(g.denNgay).toLocaleDateString("vi-VN")}`]})]})]}),a.jsx("button",{onClick:()=>m(g.nhom.id),className:"text-xs px-3 py-1 bg-red-50 text-red-600 rounded hover:bg-red-100",children:"G khi nhm"})]},g.id))}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-sm text-gray-600",children:[a.jsx("strong",{children:"Lu :"})," Nhm nhn vin c s dng trong Rule Engine  p dng cc quy tc tnh lng cho tng nhm ring bit (VD: nhm Qun l, nhm K thut, nhm Sales...)."]})]})}const S3=({nhanVienId:e})=>{const[t,r]=P.useState(null),[n,s]=P.useState(!0),[l,c]=P.useState(!1),[u,d]=P.useState(!1),[f,p]=P.useState({mstCaNhan:"",soCmndCccd:"",ngayCap:"",noiCap:"",soNguoiPhuThuoc:0,ghiChu:""}),m=async()=>{try{s(!0);const N=(await Le.get(`/nhan-vien/${e}/thue-bh`)).data;r(N),N&&p({mstCaNhan:N.mstCaNhan||"",soCmndCccd:N.soCmndCccd||"",ngayCap:N.ngayCap?N.ngayCap.split("T")[0]:"",noiCap:N.noiCap||"",soNguoiPhuThuoc:N.soNguoiPhuThuoc||0,ghiChu:N.ghiChu||""})}catch(y){console.error("Li khi ti thng tin thu/BHXH:",y)}finally{s(!1)}};P.useEffect(()=>{m()},[e]);const g=y=>{const{name:N,value:_}=y.target;p(C=>({...C,[N]:N==="soNguoiPhuThuoc"?parseInt(_)||0:_}))},b=async()=>{try{c(!0),await Le.post(`/nhan-vien/${e}/thue-bh`,f),await m(),d(!1)}catch(y){console.error("Li khi lu thng tin thu/BHXH:",y),alert("C li xy ra khi lu thng tin")}finally{c(!1)}},v=()=>{p(t?{mstCaNhan:t.mstCaNhan||"",soCmndCccd:t.soCmndCccd||"",ngayCap:t.ngayCap?t.ngayCap.split("T")[0]:"",noiCap:t.noiCap||"",soNguoiPhuThuoc:t.soNguoiPhuThuoc||0,ghiChu:t.ghiChu||""}:{mstCaNhan:"",soCmndCccd:"",ngayCap:"",noiCap:"",soNguoiPhuThuoc:0,ghiChu:""}),d(!1)};return n?a.jsx("div",{className:"flex justify-center items-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Thng tin Thu & BHXH"}),u?a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:v,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Hy"}),a.jsx("button",{onClick:b,disabled:l,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:l?"ang lu...":"Lu"})]}):a.jsx("button",{onClick:()=>d(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:t?"Chnh sa":"Thm thng tin"})]}),a.jsxs("div",{className:"bg-white border rounded-lg p-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S CMND/CCCD"}),u?a.jsx("input",{type:"text",name:"soCmndCccd",value:f.soCmndCccd,onChange:g,placeholder:"Nhp s CMND/CCCD",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):a.jsx("p",{className:"text-gray-900",children:(t==null?void 0:t.soCmndCccd)||""})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy cp"}),u?a.jsx("input",{type:"date",name:"ngayCap",value:f.ngayCap,onChange:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):a.jsx("p",{className:"text-gray-900",children:t!=null&&t.ngayCap?new Date(t.ngayCap).toLocaleDateString("vi-VN"):""})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ni cp"}),u?a.jsx("input",{type:"text",name:"noiCap",value:f.noiCap,onChange:g,placeholder:"Nhp ni cp",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):a.jsx("p",{className:"text-gray-900",children:(t==null?void 0:t.noiCap)||""})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M s thu c nhn"}),u?a.jsx("input",{type:"text",name:"mstCaNhan",value:f.mstCaNhan,onChange:g,placeholder:"Nhp m s thu",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):a.jsx("p",{className:"text-gray-900",children:(t==null?void 0:t.mstCaNhan)||""})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S ngi ph thuc"}),u?a.jsx("input",{type:"number",name:"soNguoiPhuThuoc",min:"0",value:f.soNguoiPhuThuoc,onChange:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):a.jsxs("p",{className:"text-gray-900",children:[(t==null?void 0:t.soNguoiPhuThuoc)??0," ngi"]})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),u?a.jsx("textarea",{name:"ghiChu",value:f.ghiChu,onChange:g,rows:3,placeholder:"Nhp ghi ch (nu c)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):a.jsx("p",{className:"text-gray-900",children:(t==null?void 0:t.ghiChu)||""})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:" Thng tin gim tr thu TNCN"}),a.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[a.jsx("p",{children:" Gim tr bn thn: 11.000.000 /thng"}),a.jsx("p",{children:" Gim tr ngi ph thuc: 4.400.000 /ngi/thng"}),a.jsx("p",{children:a.jsxs("strong",{children:["Tng gim tr: ",(11e6+(f.soNguoiPhuThuoc||0)*44e5).toLocaleString("vi-VN")," /thng"]})})]})]})]}),t&&a.jsxs("div",{className:"text-sm text-gray-500",children:["Cp nht ln cui: ",new Date().toLocaleDateString("vi-VN")]})]})};function C3(){var K;const{id:e}=yx(),t=parseInt(e),r=Sn(),[n,s]=P.useState("thong-tin"),[l,c]=P.useState(!1),[u,d]=P.useState(null),[f,p]=P.useState(null),[m,g]=P.useState({khoanLuongId:0,soTien:0,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""}),[b,v]=P.useState({soTienMoi:0,tuNgay:new Date().toISOString().split("T")[0],ghiChu:""}),[y,N]=P.useState({denNgay:new Date().toISOString().split("T")[0]}),{data:_,isLoading:C}=Bt({queryKey:["nhan-vien",t],queryFn:()=>os.layTheoId(t)}),{data:S,isLoading:E}=Bt({queryKey:["phu-cap",t],queryFn:()=>zl.layTheoNhanVien(t)}),{data:O}=Bt({queryKey:["khoan-luong","THU_NHAP"],queryFn:()=>ta.layTatCa("THU_NHAP")}),F=ot({mutationFn:k=>zl.taoPhuCap(k),onSuccess:()=>{je.success("Thm ph cp thnh cng"),r.invalidateQueries({queryKey:["phu-cap",t]}),c(!1),Z()},onError:k=>{var B,A;je.error(((A=(B=k.response)==null?void 0:B.data)==null?void 0:A.message)||"C li xy ra")}}),T=ot({mutationFn:({id:k,data:B})=>zl.tang(k,B),onSuccess:()=>{je.success("iu chnh ph cp thnh cng"),r.invalidateQueries({queryKey:["phu-cap",t]}),d(null)},onError:k=>{var B,A;je.error(((A=(B=k.response)==null?void 0:B.data)==null?void 0:A.message)||"C li xy ra")}}),D=ot({mutationFn:({id:k,denNgay:B})=>zl.ketThuc(k,B,"Admin"),onSuccess:()=>{je.success("Kt thc ph cp thnh cng"),r.invalidateQueries({queryKey:["phu-cap",t]}),p(null)},onError:k=>{var B,A;je.error(((A=(B=k.response)==null?void 0:B.data)==null?void 0:A.message)||"C li xy ra")}}),I=ot({mutationFn:k=>zl.tamDung(k),onSuccess:()=>{je.success("Tm dng ph cp thnh cng"),r.invalidateQueries({queryKey:["phu-cap",t]})}}),J=ot({mutationFn:k=>zl.kichHoat(k),onSuccess:()=>{je.success("Kch hot ph cp thnh cng"),r.invalidateQueries({queryKey:["phu-cap",t]})}}),Z=()=>{g({khoanLuongId:0,soTien:0,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""})},ee=()=>{if(!m.khoanLuongId){je.error("Vui lng chn khon ph cp");return}if(m.soTien<=0){je.error("S tin phi > 0");return}F.mutate({nhanVienId:t,khoanLuongId:m.khoanLuongId,soTien:m.soTien,tuNgay:m.tuNgay,denNgay:m.denNgay||void 0,ghiChu:m.ghiChu||void 0,nguoiTao:"Admin"})},ne=()=>{if(u){if(b.soTienMoi<=0){je.error("S tin mi phi > 0");return}T.mutate({id:u.id,data:{soTienMoi:b.soTienMoi,tuNgay:b.tuNgay,ghiChu:b.ghiChu||void 0,nguoiTao:"Admin"}})}},he=()=>{f&&D.mutate({id:f.id,denNgay:y.denNgay})},Q=(S==null?void 0:S.filter(k=>k.trangThai==="HIEU_LUC"))||[],xe=(S==null?void 0:S.filter(k=>k.trangThai==="TAM_DUNG"))||[],Y=(S==null?void 0:S.filter(k=>k.trangThai==="KET_THUC"))||[],le=Q.reduce((k,B)=>k+B.soTien,0);if(C)return a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});if(!_)return a.jsx("div",{className:"text-center py-12 text-gray-500",children:"Khng tm thy nhn vin"});const X=k=>{switch(k){case"HIEU_LUC":return"bg-green-100 text-green-800";case"TAM_DUNG":return"bg-yellow-100 text-yellow-800";case"KET_THUC":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},ve=k=>{switch(k){case"HIEU_LUC":return"Hiu lc";case"TAM_DUNG":return"Tm dng";case"KET_THUC":return"Kt thc";default:return k}};return a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[a.jsx(wn,{to:"/nhan-vien",className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(Nx,{size:24})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:_.hoTen}),a.jsxs("p",{className:"text-gray-500",children:[_.maNhanVien," - ",_.chucVu||"Nhn vin"]})]})]}),a.jsxs("div",{className:"flex gap-2 mb-6 border-b overflow-x-auto",children:[a.jsxs("button",{onClick:()=>s("thong-tin"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${n==="thong-tin"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(Cv,{size:18,className:"inline-block mr-2"}),"Thng tin"]}),a.jsxs("button",{onClick:()=>s("hop-dong"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${n==="hop-dong"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(Hc,{size:18,className:"inline-block mr-2"}),"Hp ng / Lng"]}),a.jsxs("button",{onClick:()=>s("phu-cap"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${n==="phu-cap"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(TS,{size:18,className:"inline-block mr-2"}),"Ph cp",Q.length>0&&a.jsx("span",{className:"ml-2 bg-primary-100 text-primary-700 px-2 py-0.5 rounded-full text-xs",children:Q.length})]}),a.jsxs("button",{onClick:()=>s("lich-su"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${n==="lich-su"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(Ph,{size:18,className:"inline-block mr-2"}),"Lch s"]})]}),n==="thong-tin"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"card",children:[a.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[a.jsx(Cv,{size:20}),"Thng tin c bn"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-500",children:"M nhn vin"}),a.jsx("p",{className:"font-medium",children:_.maNhanVien})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-500",children:"H tn"}),a.jsx("p",{className:"font-medium",children:_.hoTen})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-500",children:"Phng ban"}),a.jsx("p",{className:"font-medium",children:(K=_.phongBan)==null?void 0:K.tenPhongBan})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-500",children:"Chc v"}),a.jsx("p",{className:"font-medium",children:_.chucVu||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-500",children:"Gii tnh"}),a.jsx("p",{className:"font-medium",children:_.gioiTinh==="NAM"?"Nam":_.gioiTinh==="NU"?"N":_.gioiTinh==="KHAC"?"Khc":"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-500",children:"Ngy sinh"}),a.jsx("p",{className:"font-medium",children:_.ngaySinh?Kl(_.ngaySinh):"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-500",children:"Email"}),a.jsx("p",{className:"font-medium",children:_.email||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-500",children:"S in thoi"}),a.jsx("p",{className:"font-medium",children:_.soDienThoai||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-500",children:"a ch"}),a.jsx("p",{className:"font-medium",children:_.diaChi||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-500",children:"Ngy vo lm"}),a.jsx("p",{className:"font-medium",children:_.ngayVaoLam?Kl(_.ngayVaoLam):"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-500",children:"Lng c bn"}),a.jsx("p",{className:"font-medium text-primary-600",children:Zt(_.luongCoBan)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-500",children:"Tng ph cp hin ti"}),a.jsx("p",{className:"font-medium text-green-600",children:Zt(le)})]})]})]}),a.jsxs("div",{className:"card",children:[a.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[a.jsx(ou,{size:20}),"Ti khon ngn hng"]}),a.jsx(j3,{nhanVienId:t})]}),a.jsxs("div",{className:"card",children:[a.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[a.jsx(Hc,{size:20}),"Thng tin Thu & BHXH"]}),a.jsx(S3,{nhanVienId:t})]}),a.jsxs("div",{className:"card",children:[a.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[a.jsx(Ba,{size:20}),"Nhm nhn vin"]}),a.jsx(_3,{nhanVienId:t})]})]}),n==="hop-dong"&&a.jsx("div",{className:"card",children:a.jsx(T3,{nhanVienId:t})}),n==="phu-cap"&&a.jsxs("div",{children:[a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{className:"card bg-green-50",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Ph cp hiu lc"}),a.jsx("p",{className:"text-2xl font-bold text-green-600",children:Q.length}),a.jsxs("p",{className:"text-sm text-green-600",children:[Zt(le),"/thng"]})]}),a.jsxs("div",{className:"card bg-yellow-50",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Tm dng"}),a.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:xe.length})]}),a.jsxs("div",{className:"card bg-gray-50",children:[a.jsx("p",{className:"text-sm text-gray-600",children:" kt thc"}),a.jsx("p",{className:"text-2xl font-bold text-gray-600",children:Y.length})]})]}),a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"font-semibold text-lg",children:"Danh sch ph cp"}),a.jsxs("button",{onClick:()=>c(!0),className:"btn btn-primary",children:[a.jsx(Ha,{size:20}),"Thm ph cp"]})]}),Q.length>0&&a.jsxs("div",{className:"card mb-4",children:[a.jsxs("h4",{className:"font-medium text-green-700 mb-3 flex items-center gap-2",children:[a.jsx("span",{className:"w-3 h-3 bg-green-500 rounded-full"}),"ang hiu lc (",Q.length,")"]}),a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b bg-gray-50",children:[a.jsx("th",{className:"text-left py-2 px-3",children:"Khon ph cp"}),a.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),a.jsx("th",{className:"text-left py-2 px-3",children:"T ngy"}),a.jsx("th",{className:"text-left py-2 px-3",children:"n ngy"}),a.jsx("th",{className:"text-left py-2 px-3",children:"Ghi ch"}),a.jsx("th",{className:"text-center py-2 px-3",children:"Thao tc"})]})}),a.jsx("tbody",{children:Q.map(k=>a.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"py-2 px-3 font-medium",children:k.khoanLuong.tenKhoan}),a.jsx("td",{className:"py-2 px-3 text-right font-semibold text-primary-600",children:Zt(k.soTien)}),a.jsx("td",{className:"py-2 px-3",children:Kl(k.tuNgay)}),a.jsx("td",{className:"py-2 px-3",children:k.denNgay?Kl(k.denNgay):"Khng xc nh"}),a.jsx("td",{className:"py-2 px-3 text-gray-500 text-sm",children:k.ghiChu||"-"}),a.jsx("td",{className:"py-2 px-3",children:a.jsxs("div",{className:"flex justify-center gap-1",children:[a.jsx("button",{onClick:()=>{d(k),v({soTienMoi:k.soTien,tuNgay:new Date().toISOString().split("T")[0],ghiChu:""})},className:"p-1 hover:bg-blue-100 rounded text-blue-600",title:"iu chnh",children:a.jsx(Nb,{size:18})}),a.jsx("button",{onClick:()=>I.mutate(k.id),className:"p-1 hover:bg-yellow-100 rounded text-yellow-600",title:"Tm dng",children:a.jsx(vS,{size:18})}),a.jsx("button",{onClick:()=>{p(k),N({denNgay:new Date().toISOString().split("T")[0]})},className:"p-1 hover:bg-red-100 rounded text-red-600",title:"Kt thc",children:a.jsx(Fh,{size:18})})]})})]},k.id))})]})]}),xe.length>0&&a.jsxs("div",{className:"card mb-4",children:[a.jsxs("h4",{className:"font-medium text-yellow-700 mb-3 flex items-center gap-2",children:[a.jsx("span",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),"Tm dng (",xe.length,")"]}),a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b bg-gray-50",children:[a.jsx("th",{className:"text-left py-2 px-3",children:"Khon ph cp"}),a.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),a.jsx("th",{className:"text-left py-2 px-3",children:"Trng thi"}),a.jsx("th",{className:"text-center py-2 px-3",children:"Thao tc"})]})}),a.jsx("tbody",{children:xe.map(k=>a.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"py-2 px-3",children:k.khoanLuong.tenKhoan}),a.jsx("td",{className:"py-2 px-3 text-right",children:Zt(k.soTien)}),a.jsx("td",{className:"py-2 px-3",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${X(k.trangThai)}`,children:ve(k.trangThai)})}),a.jsx("td",{className:"py-2 px-3 text-center",children:a.jsx("button",{onClick:()=>J.mutate(k.id),className:"p-1 hover:bg-green-100 rounded text-green-600",title:"Kch hot li",children:a.jsx(yS,{size:18})})})]},k.id))})]})]}),E?a.jsx("div",{className:"text-center py-8",children:"ang ti..."}):(S==null?void 0:S.length)===0?a.jsxs("div",{className:"card text-center py-8 text-gray-500",children:[a.jsx(wx,{size:48,className:"mx-auto mb-4 text-gray-300"}),a.jsx("p",{children:"Nhn vin cha c ph cp no"}),a.jsxs("button",{onClick:()=>c(!0),className:"btn btn-primary mt-4",children:[a.jsx(Ha,{size:20}),"Thm ph cp u tin"]})]}):null]}),n==="lich-su"&&a.jsxs("div",{className:"card",children:[a.jsx("h3",{className:"font-semibold mb-4",children:"Lch s thay i ph cp"}),S&&S.length>0?a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b bg-gray-50",children:[a.jsx("th",{className:"text-left py-2 px-3",children:"Khon ph cp"}),a.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),a.jsx("th",{className:"text-left py-2 px-3",children:"T ngy"}),a.jsx("th",{className:"text-left py-2 px-3",children:"n ngy"}),a.jsx("th",{className:"text-left py-2 px-3",children:"Trng thi"}),a.jsx("th",{className:"text-left py-2 px-3",children:"Ghi ch"})]})}),a.jsx("tbody",{children:S.map(k=>a.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"py-2 px-3",children:k.khoanLuong.tenKhoan}),a.jsx("td",{className:"py-2 px-3 text-right font-medium",children:Zt(k.soTien)}),a.jsx("td",{className:"py-2 px-3",children:Kl(k.tuNgay)}),a.jsx("td",{className:"py-2 px-3",children:k.denNgay?Kl(k.denNgay):"-"}),a.jsx("td",{className:"py-2 px-3",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${X(k.trangThai)}`,children:ve(k.trangThai)})}),a.jsx("td",{className:"py-2 px-3 text-gray-500 text-sm",children:k.ghiChu||"-"})]},k.id))})]}):a.jsx("p",{className:"text-gray-500 text-center py-8",children:"Cha c d liu lch s"})]}),l&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm ph cp mi"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Khon ph cp *"}),a.jsxs("select",{value:m.khoanLuongId,onChange:k=>g({...m,khoanLuongId:Number(k.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:0,children:"-- Chn khon ph cp --"}),O==null?void 0:O.map(k=>a.jsx("option",{value:k.id,children:k.tenKhoan},k.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"S tin *"}),a.jsx("input",{type:"number",value:m.soTien,onChange:k=>g({...m,soTien:Number(k.target.value)}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: 500000"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy bt u *"}),a.jsx("input",{type:"date",value:m.tuNgay,onChange:k=>g({...m,tuNgay:k.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy kt thc (ty chn)"}),a.jsx("input",{type:"date",value:m.denNgay,onChange:k=>g({...m,denNgay:k.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ghi ch"}),a.jsx("textarea",{value:m.ghiChu,onChange:k=>g({...m,ghiChu:k.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[a.jsx("button",{onClick:()=>c(!1),className:"btn btn-secondary",children:"Hy"}),a.jsx("button",{onClick:ee,disabled:F.isPending,className:"btn btn-primary",children:F.isPending?"ang lu...":"Thm ph cp"})]})]})}),u&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"iu chnh ph cp"}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg mb-4",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Khon ph cp"}),a.jsx("p",{className:"font-medium",children:u.khoanLuong.tenKhoan}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Hin ti: ",Zt(u.soTien)]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"S tin mi *"}),a.jsx("input",{type:"number",value:b.soTienMoi,onChange:k=>v({...b,soTienMoi:Number(k.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy hiu lc mi *"}),a.jsx("input",{type:"date",value:b.tuNgay,onChange:k=>v({...b,tuNgay:k.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"L do iu chnh"}),a.jsx("textarea",{value:b.ghiChu,onChange:k=>v({...b,ghiChu:k.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[a.jsx("button",{onClick:()=>d(null),className:"btn btn-secondary",children:"Hy"}),a.jsx("button",{onClick:ne,disabled:T.isPending,className:"btn btn-primary",children:T.isPending?"ang lu...":"iu chnh"})]})]})}),f&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Kt thc ph cp"}),a.jsxs("div",{className:"bg-red-50 p-3 rounded-lg mb-4",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Khon ph cp"}),a.jsx("p",{className:"font-medium",children:f.khoanLuong.tenKhoan}),a.jsxs("p",{className:"text-sm text-red-600",children:["S tin: ",Zt(f.soTien)]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy kt thc *"}),a.jsx("input",{type:"date",value:y.denNgay,onChange:k=>N({denNgay:k.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[a.jsx("button",{onClick:()=>p(null),className:"btn btn-secondary",children:"Hy"}),a.jsx("button",{onClick:he,disabled:D.isPending,className:"btn btn-danger",children:D.isPending?"ang lu...":"Kt thc"})]})]})})]})}function E3(){const e=Sn(),[t,r]=P.useState(!1),[n,s]=P.useState(null),[l,c]=P.useState({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",chiuThue:!1,moTa:""}),{data:u,isLoading:d}=Bt({queryKey:["khoan-luong"],queryFn:()=>ta.layTatCa()}),f=ot({mutationFn:ta.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["khoan-luong"]}),je.success("To khon lng thnh cng!"),g()},onError:C=>{var S,E;je.error(((E=(S=C.response)==null?void 0:S.data)==null?void 0:E.message)||"C li xy ra")}}),p=ot({mutationFn:({id:C,data:S})=>ta.capNhat(C,S),onSuccess:()=>{e.invalidateQueries({queryKey:["khoan-luong"]}),je.success("Cp nht thnh cng!"),g()},onError:C=>{var S,E;je.error(((E=(S=C.response)==null?void 0:S.data)==null?void 0:E.message)||"C li xy ra")}}),m=ot({mutationFn:ta.xoa,onSuccess:()=>{e.invalidateQueries({queryKey:["khoan-luong"]}),je.success("Xa khon lng thnh cng!")},onError:C=>{var S,E;je.error(((E=(S=C.response)==null?void 0:S.data)==null?void 0:E.message)||"C li xy ra")}}),g=()=>{r(!1),s(null),c({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",chiuThue:!1,moTa:""})},b=C=>{s(C),c({maKhoan:C.maKhoan,tenKhoan:C.tenKhoan,loai:C.loai,chiuThue:C.chiuThue,moTa:C.moTa||""}),r(!0)},v=()=>{if(!l.maKhoan||!l.tenKhoan){je.error("Vui lng in y  thng tin bt buc");return}n?p.mutate({id:n.id,data:l}):f.mutate(l)},y=C=>{confirm(`Bn c chc mun xa khon lng "${C.tenKhoan}"?`)&&m.mutate(C.id)},N=(u==null?void 0:u.filter(C=>C.loai==="THU_NHAP"))||[],_=(u==null?void 0:u.filter(C=>C.loai==="KHAU_TRU"))||[];return a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx(sh,{size:28}),"Qun l Khon lng"]}),a.jsxs("button",{onClick:()=>r(!0),className:"btn btn-primary",children:[a.jsx(Ha,{size:20}),"Thm khon lng"]})]}),d?a.jsx("p",{className:"text-center py-8 text-gray-500",children:"ang ti..."}):a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"card",children:[a.jsxs("h2",{className:"text-lg font-semibold text-green-700 mb-4 flex items-center gap-2",children:[a.jsx("span",{className:"w-3 h-3 bg-green-500 rounded-full"}),"Cc khon Thu nhp (",N.length,")"]}),a.jsxs("div",{className:"space-y-2",children:[N.map(C=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(_v,{size:16,className:"text-gray-400 cursor-grab"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:C.tenKhoan}),a.jsxs("p",{className:"text-xs text-gray-500",children:[C.maKhoan,C.chiuThue&&a.jsx("span",{className:"ml-2 px-1.5 py-0.5 bg-orange-100 text-orange-700 rounded",children:"Chu thu"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:()=>b(C),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-lg",children:a.jsx(go,{size:16})}),a.jsx("button",{onClick:()=>y(C),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg",children:a.jsx(li,{size:16})})]})]},C.id)),N.length===0&&a.jsx("p",{className:"text-gray-500 text-center py-4",children:"Cha c khon thu nhp"})]})]}),a.jsxs("div",{className:"card",children:[a.jsxs("h2",{className:"text-lg font-semibold text-red-700 mb-4 flex items-center gap-2",children:[a.jsx("span",{className:"w-3 h-3 bg-red-500 rounded-full"}),"Cc khon Khu tr (",_.length,")"]}),a.jsxs("div",{className:"space-y-2",children:[_.map(C=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(_v,{size:16,className:"text-gray-400 cursor-grab"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:C.tenKhoan}),a.jsx("p",{className:"text-xs text-gray-500",children:C.maKhoan})]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:()=>b(C),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-lg",children:a.jsx(go,{size:16})}),a.jsx("button",{onClick:()=>y(C),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg",children:a.jsx(li,{size:16})})]})]},C.id)),_.length===0&&a.jsx("p",{className:"text-gray-500 text-center py-4",children:"Cha c khon khu tr (BHXH, thu s thm  y)"})]})]})]}),t&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:n?"Sa khon lng":"Thm khon lng mi"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"M khon *"}),a.jsx("input",{type:"text",value:l.maKhoan,onChange:C=>c({...l,maKhoan:C.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: PHU_CAP_XE",disabled:!!n})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tn khon *"}),a.jsx("input",{type:"text",value:l.tenKhoan,onChange:C=>c({...l,tenKhoan:C.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ph cp xe"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi"}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"radio",name:"loai",checked:l.loai==="THU_NHAP",onChange:()=>c({...l,loai:"THU_NHAP"})}),a.jsx("span",{className:"text-green-700",children:"Thu nhp (+)"})]}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"radio",name:"loai",checked:l.loai==="KHAU_TRU",onChange:()=>c({...l,loai:"KHAU_TRU"})}),a.jsx("span",{className:"text-red-700",children:"Khu tr (-)"})]})]})]}),a.jsx("div",{children:a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:l.chiuThue,onChange:C=>c({...l,chiuThue:C.target.checked})}),a.jsx("span",{className:"text-sm",children:"Khon ny chu thu TNCN"})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"M t"}),a.jsx("textarea",{value:l.moTa,onChange:C=>c({...l,moTa:C.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[a.jsx("button",{onClick:g,className:"btn btn-secondary",children:"Hy"}),a.jsx("button",{onClick:v,disabled:f.isPending||p.isPending,className:"btn btn-primary",children:f.isPending||p.isPending?"ang lu...":"Lu"})]})]})})]})}function F3(){const e=Sn(),t=P.useRef(null),[r,n]=P.useState("upload"),[s,l]=P.useState(null),[c,u]=P.useState([]),[d,f]=P.useState([]),[p,m]=P.useState([]),[g,b]=P.useState(new Date().getMonth()+1),[v,y]=P.useState(new Date().getFullYear()),[N,_]=P.useState(0),[C,S]=P.useState(null),{data:E}=Bt({queryKey:["phong-ban"],queryFn:ga.layTatCa}),{data:O}=Bt({queryKey:["khoan-luong"],queryFn:()=>ta.layTatCa()}),F=ot({mutationFn:ne=>Z0.docHeader(ne),onSuccess:ne=>{u(ne.headers),f(ne.duLieuMau),T.mutate(s)},onError:()=>{je.error("Khng th c file Excel")}}),T=ot({mutationFn:ne=>Z0.goiYMapping(ne),onSuccess:ne=>{m(ne),n("mapping")}}),D=ot({mutationFn:()=>Z0.import(s,g,v,N,p),onSuccess:ne=>{S(ne),n("result"),e.invalidateQueries({queryKey:["bang-luong"]}),ne.thanhCong?je.success("Import thnh cng!"):je.error(`Import c ${ne.dongLoi} dng li`)},onError:ne=>{var he,Q;je.error(((Q=(he=ne.response)==null?void 0:he.data)==null?void 0:Q.message)||"C li khi import")}}),I=ne=>{var Q;const he=(Q=ne.target.files)==null?void 0:Q[0];if(he){if(!he.name.endsWith(".xlsx")&&!he.name.endsWith(".xls")){je.error("Vui lng chn file Excel (.xlsx hoc .xls)");return}l(he),F.mutate(he)}},J=(ne,he,Q)=>{const xe=[...p];xe[ne]={...xe[ne],[he]:Q},m(xe)},Z=()=>{if(!N){je.error("Vui lng chn phng ban");return}if(!p.some(he=>he.loaiMapping==="thong_tin"&&he.truongHeThong==="ma_nhan_vien")){je.error("Cn mapping ct M nhn vin");return}D.mutate()},ee=()=>{n("upload"),l(null),u([]),f([]),m([]),S(null),t.current&&(t.current.value="")};return a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2 mb-6",children:[a.jsx(Zl,{size:28}),"Import t Excel"]}),a.jsx("div",{className:"flex items-center gap-4 mb-8",children:["Upload file","Mapping ct","Kt qu"].map((ne,he)=>{const Q=["upload","mapping","result"],xe=r===Q[he],Y=Q.indexOf(r)>he;return a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`
                  w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold
                  ${xe?"bg-primary-600 text-white":""}
                  ${Y?"bg-green-500 text-white":""}
                  ${!xe&&!Y?"bg-gray-200 text-gray-500":""}
                `,children:Y?"":he+1}),a.jsx("span",{className:xe?"font-semibold":"text-gray-500",children:ne}),he<2&&a.jsx(aS,{size:16,className:"text-gray-400 ml-2"})]},ne)})}),r==="upload"&&a.jsx("div",{className:"card",children:a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Dh,{size:64,className:"mx-auto text-gray-400 mb-4"}),a.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Chn file Excel  import"}),a.jsx("p",{className:"text-gray-500 mb-6",children:"H tr nh dng .xlsx v .xls"}),a.jsx("input",{ref:t,type:"file",accept:".xlsx,.xls",onChange:I,className:"hidden"}),a.jsxs("button",{onClick:()=>{var ne;return(ne=t.current)==null?void 0:ne.click()},disabled:F.isPending,className:"btn btn-primary",children:[a.jsx(Zl,{size:20}),F.isPending?"ang c file...":"Chn file Excel"]})]})}),r==="mapping"&&a.jsxs("div",{children:[a.jsxs("div",{className:"card mb-6",children:[a.jsx("h3",{className:"font-semibold mb-4",children:"Thng tin import"}),a.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"File"}),a.jsx("p",{className:"font-medium",children:s==null?void 0:s.name})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Thng"}),a.jsx("select",{value:g,onChange:ne=>b(Number(ne.target.value)),className:"w-full border rounded-lg px-3 py-2",children:Array.from({length:12},(ne,he)=>he+1).map(ne=>a.jsxs("option",{value:ne,children:["Thng ",ne]},ne))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Nm"}),a.jsx("select",{value:v,onChange:ne=>y(Number(ne.target.value)),className:"w-full border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(ne=>a.jsx("option",{value:ne,children:ne},ne))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban *"}),a.jsxs("select",{value:N,onChange:ne=>_(Number(ne.target.value)),className:"w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:0,children:"-- Chn --"}),E==null?void 0:E.map(ne=>a.jsx("option",{value:ne.id,children:ne.tenPhongBan},ne.id))]})]})]})]}),a.jsxs("div",{className:"card mb-6",children:[a.jsx("h3",{className:"font-semibold mb-4",children:"Mapping ct Excel  Khon lng"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b bg-gray-50",children:[a.jsx("th",{className:"text-left py-2 px-3",children:"Ct"}),a.jsx("th",{className:"text-left py-2 px-3",children:"Tn ct Excel"}),a.jsx("th",{className:"text-left py-2 px-3",children:"D liu mu"}),a.jsx("th",{className:"text-left py-2 px-3",children:"Loi"}),a.jsx("th",{className:"text-left py-2 px-3",children:"Mapping"})]})}),a.jsx("tbody",{children:p.map((ne,he)=>{var Q;return a.jsxs("tr",{className:"border-b",children:[a.jsx("td",{className:"py-2 px-3",children:ne.soCot}),a.jsx("td",{className:"py-2 px-3 font-medium",children:ne.tenCot}),a.jsx("td",{className:"py-2 px-3 text-gray-500",children:((Q=d[0])==null?void 0:Q[he])||"-"}),a.jsx("td",{className:"py-2 px-3",children:a.jsxs("select",{value:ne.loaiMapping,onChange:xe=>J(he,"loaiMapping",xe.target.value),className:"border rounded px-2 py-1 text-sm",children:[a.jsx("option",{value:"thong_tin",children:"Thng tin"}),a.jsx("option",{value:"khoan_luong",children:"Khon lng"})]})}),a.jsx("td",{className:"py-2 px-3",children:ne.loaiMapping==="thong_tin"?a.jsxs("select",{value:ne.truongHeThong||"",onChange:xe=>J(he,"truongHeThong",xe.target.value),className:"border rounded px-2 py-1 text-sm w-full",children:[a.jsx("option",{value:"",children:"-- B qua --"}),a.jsx("option",{value:"ma_nhan_vien",children:"M nhn vin"}),a.jsx("option",{value:"ho_ten",children:"H tn"}),a.jsx("option",{value:"phong_ban",children:"Phng ban"}),a.jsx("option",{value:"tong_luong_bo_qua",children:"Tng (b qua)"})]}):a.jsxs("select",{value:ne.khoanLuongId||"",onChange:xe=>J(he,"khoanLuongId",Number(xe.target.value)||void 0),className:"border rounded px-2 py-1 text-sm w-full",children:[a.jsx("option",{value:"",children:"-- B qua --"}),O==null?void 0:O.map(xe=>a.jsx("option",{value:xe.id,children:xe.tenKhoan},xe.id))]})})]},he)})})]})})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("button",{onClick:ee,className:"btn btn-secondary",children:"Quay li"}),a.jsx("button",{onClick:Z,disabled:D.isPending,className:"btn btn-primary",children:D.isPending?"ang import...":"Bt u Import"})]})]}),r==="result"&&C&&a.jsxs("div",{children:[a.jsx("div",{className:`card mb-6 ${C.thanhCong?"bg-green-50":"bg-yellow-50"}`,children:a.jsxs("div",{className:"flex items-center gap-4",children:[C.thanhCong?a.jsx(ah,{size:48,className:"text-green-500"}):a.jsx(wx,{size:48,className:"text-yellow-500"}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold",children:C.thanhCong?"Import thnh cng!":"Import hon tt (c li)"}),a.jsxs("p",{className:"text-gray-600",children:[" import ",C.dongThanhCong,"/",C.tongDong," dng"]})]})]})}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{className:"card text-center",children:[a.jsx("p",{className:"text-3xl font-bold text-green-600",children:C.dongThanhCong}),a.jsx("p",{className:"text-gray-500",children:"Dng thnh cng"})]}),a.jsxs("div",{className:"card text-center",children:[a.jsx("p",{className:"text-3xl font-bold text-red-600",children:C.dongLoi}),a.jsx("p",{className:"text-gray-500",children:"Dng li"})]}),a.jsxs("div",{className:"card text-center",children:[a.jsx("p",{className:"text-3xl font-bold text-primary-600",children:Zt(C.tongTienImport)}),a.jsx("p",{className:"text-gray-500",children:"Tng tin import"})]})]}),C.chiTietLoi.length>0&&a.jsxs("div",{className:"card mb-6",children:[a.jsx("h3",{className:"font-semibold text-red-600 mb-3",children:"Chi tit li"}),a.jsx("div",{className:"max-h-48 overflow-y-auto",children:C.chiTietLoi.map((ne,he)=>a.jsxs("div",{className:"flex items-center gap-2 py-2 border-b",children:[a.jsx(Tb,{size:16,className:"text-red-500"}),a.jsxs("span",{className:"font-medium",children:["Dng ",ne.dong,":"]}),a.jsx("span",{className:"text-gray-600",children:ne.lyDo})]},he))})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx("button",{onClick:ee,className:"btn btn-secondary",children:"Import file khc"}),a.jsx("a",{href:`/bang-luong/${C.bangLuongId}`,className:"btn btn-primary",children:"Xem bng lng"})]})]})]})}const zf={layDanhSach:(e,t,r)=>{const n=new URLSearchParams({thang:String(e),nam:String(t)});return r&&n.append("phongBanId",String(r)),Le.get(`/cham-cong?${n}`)},layChamCongNhanVien:(e,t,r)=>Le.get(`/cham-cong/nhan-vien/${e}?thang=${t}&nam=${r}`),luu:e=>Le.post("/cham-cong",e),khoiTao:(e,t,r=26)=>Le.post("/cham-cong/khoi-tao",{thang:e,nam:t,soCongChuan:r}),import:(e,t,r)=>Le.post("/cham-cong/import",{thang:e,nam:t,duLieu:r})},Kf={lay:e=>Le.get(`/cham-cong/cau-hinh-phat/${e}`),capNhat:(e,t)=>Le.put(`/cham-cong/cau-hinh-phat/${e}`,t),tinhPhat:(e,t,r)=>Le.get(`/cham-cong/tinh-phat/${e}?thang=${t}&nam=${r}`)},A3={dongBoCSV:e=>Le.post("/cham-cong/dong-bo-csv",{csvContent:e})};function D3(){const[e,t]=P.useState("cham-cong"),[r,n]=P.useState(new Date().getMonth()+1),[s,l]=P.useState(new Date().getFullYear()),[c,u]=P.useState(),[d,f]=P.useState([]),[p,m]=P.useState([]),[g,b]=P.useState(null),[v,y]=P.useState({}),[N,_]=P.useState(!1),[C,S]=P.useState(null),[E,O]=P.useState({}),[F,T]=P.useState(null),[D,I]=P.useState(null),[J,Z]=P.useState(!1),ee=P.useRef(null);P.useEffect(()=>{Le.get("/phong-ban").then(k=>f(k.data))},[]),P.useEffect(()=>{ne()},[r,s,c]),P.useEffect(()=>{e==="cau-hinh"&&he()},[e,s]);const ne=async()=>{_(!0);try{const k=await zf.layDanhSach(r,s,c);m(k.data);const B={};for(const A of k.data)if(A.soLanDiMuon>0||A.soLanVeSom>0||Number(A.soNgayNghiKhongLuong)>0)try{const M=await Kf.tinhPhat(A.nhanVienId,r,s);B[A.nhanVienId]=M.data}catch{}y(B)}catch{je.error("Li ti d liu chm cng")}_(!1)},he=async()=>{try{const k=await Kf.lay(s);b(k.data)}catch{je.error("Li ti cu hnh pht")}},Q=async()=>{if(confirm(`Khi to chm cng thng ${r}/${s} cho tt c nhn vin?`))try{const k=await zf.khoiTao(r,s,26);je.success(`${k.data.message} -  to: ${k.data.created}, B qua: ${k.data.skipped}`),ne()}catch{je.error("Li khi to chm cng")}},xe=k=>{S(k.id),O({nhanVienId:k.nhanVienId,thang:k.thang,nam:k.nam,soCongChuan:Number(k.soCongChuan),soCongThucTe:Number(k.soCongThucTe),soNgayNghiPhep:Number(k.soNgayNghiPhep),soNgayNghiKhongLuong:Number(k.soNgayNghiKhongLuong),soGioOT:Number(k.soGioOT),soLanDiMuon:k.soLanDiMuon,soLanVeSom:k.soLanVeSom})},Y=async()=>{if(E.nhanVienId)try{await zf.luu(E),je.success(" lu chm cng"),S(null),O({}),ne()}catch{je.error("Li lu chm cng")}},le=async()=>{if(g)try{await Kf.capNhat(s,g),je.success(" lu cu hnh pht")}catch{je.error("Li lu cu hnh")}},X=k=>new Intl.NumberFormat("vi-VN").format(k)+" ",ve=k=>{var A;const B=(A=k.target.files)==null?void 0:A[0];B&&(T(B),I(null))},K=async()=>{var k,B;if(!F){je.error("Vui lng chn file CSV");return}Z(!0);try{const A=await F.text(),M=await A3.dongBoCSV(A);I(M.data),je.success(` ng b ${M.data.luuThanhCong} nhn vin thnh cng`),ne()}catch(A){je.error(((B=(k=A==null?void 0:A.response)==null?void 0:k.data)==null?void 0:B.message)||"Li ng b file")}Z(!1)};return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex justify-between items-center",children:a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx(_c,{className:"text-primary-600"}),"Qun l Chm cng"]}),a.jsx("p",{className:"text-gray-500 mt-1",children:"Theo di chm cng, i mun, ngh khng php"})]})}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"flex gap-4",children:[a.jsxs("button",{onClick:()=>t("cham-cong"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${e==="cham-cong"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(Ba,{size:18,className:"inline mr-2"}),"Chm cng thng"]}),a.jsxs("button",{onClick:()=>t("dong-bo"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${e==="dong-bo"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(Zl,{size:18,className:"inline mr-2"}),"ng b my chm cng"]}),a.jsxs("button",{onClick:()=>t("cau-hinh"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${e==="cau-hinh"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[a.jsx(yo,{size:18,className:"inline mr-2"}),"Cu hnh pht"]})]})}),e==="cham-cong"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm flex flex-wrap gap-4 items-end",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Thng"}),a.jsx("select",{value:r,onChange:k=>n(Number(k.target.value)),className:"border rounded-lg px-3 py-2",children:[...Array(12)].map((k,B)=>a.jsxs("option",{value:B+1,children:["Thng ",B+1]},B+1))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Nm"}),a.jsx("select",{value:s,onChange:k=>l(Number(k.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(k=>a.jsx("option",{value:k,children:k},k))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban"}),a.jsxs("select",{value:c||"",onChange:k=>u(k.target.value?Number(k.target.value):void 0),className:"border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"",children:"Tt c"}),d.map(k=>a.jsx("option",{value:k.id,children:k.tenPhongBan},k.id))]})]}),a.jsxs("button",{onClick:ne,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg",children:[a.jsx(ih,{size:18}),"Lm mi"]}),a.jsxs("button",{onClick:Q,className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white hover:bg-primary-700 rounded-lg",children:[a.jsx(Fh,{size:18}),"Khi to thng"]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nhn vin"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phng ban"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Cng chun"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Cng thc"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Ngh php"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Ngh KL"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"i mun"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"V sm"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"OT (gi)"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Tin pht"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:N?a.jsx("tr",{children:a.jsx("td",{colSpan:11,className:"px-4 py-8 text-center text-gray-500",children:"ang ti..."})}):p.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:11,className:"px-4 py-8 text-center text-gray-500",children:'Cha c d liu chm cng. Nhn "Khi to thng"  bt u.'})}):p.map(k=>{var ae,de,be,we;const B=C===k.id,A=v[k.nhanVienId],M=k.soLanDiMuon>0||k.soLanVeSom>0||Number(k.soNgayNghiKhongLuong)>0;return a.jsxs("tr",{className:M?"bg-red-50":"",children:[a.jsxs("td",{className:"px-4 py-3",children:[a.jsx("div",{className:"font-medium text-gray-900",children:(ae=k.nhanVien)==null?void 0:ae.hoTen}),a.jsx("div",{className:"text-sm text-gray-500",children:(de=k.nhanVien)==null?void 0:de.maNhanVien})]}),a.jsx("td",{className:"px-4 py-3 text-gray-600",children:(we=(be=k.nhanVien)==null?void 0:be.phongBan)==null?void 0:we.tenPhongBan}),a.jsx("td",{className:"px-4 py-3 text-center",children:B?a.jsx("input",{type:"number",value:E.soCongChuan||0,onChange:ye=>O({...E,soCongChuan:Number(ye.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(k.soCongChuan)}),a.jsx("td",{className:"px-4 py-3 text-center",children:B?a.jsx("input",{type:"number",value:E.soCongThucTe||0,onChange:ye=>O({...E,soCongThucTe:Number(ye.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(k.soCongThucTe)}),a.jsx("td",{className:"px-4 py-3 text-center",children:B?a.jsx("input",{type:"number",value:E.soNgayNghiPhep||0,onChange:ye=>O({...E,soNgayNghiPhep:Number(ye.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(k.soNgayNghiPhep)}),a.jsx("td",{className:"px-4 py-3 text-center",children:B?a.jsx("input",{type:"number",value:E.soNgayNghiKhongLuong||0,onChange:ye=>O({...E,soNgayNghiKhongLuong:Number(ye.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):a.jsx("span",{className:Number(k.soNgayNghiKhongLuong)>0?"text-red-600 font-semibold":"",children:Number(k.soNgayNghiKhongLuong)})}),a.jsx("td",{className:"px-4 py-3 text-center",children:B?a.jsx("input",{type:"number",value:E.soLanDiMuon||0,onChange:ye=>O({...E,soLanDiMuon:Number(ye.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):a.jsx("span",{className:k.soLanDiMuon>0?"text-orange-600 font-semibold":"",children:k.soLanDiMuon})}),a.jsx("td",{className:"px-4 py-3 text-center",children:B?a.jsx("input",{type:"number",value:E.soLanVeSom||0,onChange:ye=>O({...E,soLanVeSom:Number(ye.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):a.jsx("span",{className:k.soLanVeSom>0?"text-orange-600 font-semibold":"",children:k.soLanVeSom})}),a.jsx("td",{className:"px-4 py-3 text-center text-blue-600",children:B?a.jsx("input",{type:"number",value:E.soGioOT||0,onChange:ye=>O({...E,soGioOT:Number(ye.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(k.soGioOT)}),a.jsx("td",{className:"px-4 py-3 text-right",children:A&&A.tongPhat>0&&a.jsx("div",{className:"text-red-600 font-semibold",title:`Pht i mun: ${X(A.tienPhatDiMuon)}
Pht v sm: ${X(A.tienPhatVeSom)}
Pht ngh KP: ${X(A.tienPhatNghiKhongPhep)}
Tr lng: ${X(A.truLuongNgayCong)}`,children:X(A.tongPhat)})}),a.jsx("td",{className:"px-4 py-3 text-center",children:B?a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsx("button",{onClick:Y,className:"p-1 text-green-600 hover:bg-green-50 rounded",children:a.jsx(vo,{size:18})}),a.jsx("button",{onClick:()=>{S(null),O({})},className:"p-1 text-gray-600 hover:bg-gray-100 rounded",children:""})]}):a.jsx("button",{onClick:()=>xe(k),className:"p-1 text-primary-600 hover:bg-primary-50 rounded",children:"Sa"})})]},k.id)})})]})})}),p.length>0&&a.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Tng nhn vin"}),a.jsx("div",{className:"text-2xl font-bold text-gray-800",children:p.length})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"i mun"}),a.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[p.filter(k=>k.soLanDiMuon>0).length," NV"]})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Ngh khng php"}),a.jsxs("div",{className:"text-2xl font-bold text-red-600",children:[p.filter(k=>Number(k.soNgayNghiKhongLuong)>0).length," NV"]})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Tng tin pht"}),a.jsx("div",{className:"text-2xl font-bold text-red-600",children:X(Object.values(v).reduce((k,B)=>k+B.tongPhat,0))})]})]})]}),e==="dong-bo"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx(Zl,{className:"text-primary-600",size:20}),"Upload file CSV t my chm cng"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{onClick:()=>{var k;return(k=ee.current)==null?void 0:k.click()},className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-primary-400 transition-colors",children:[a.jsx(Hc,{className:"mx-auto text-gray-400 mb-3",size:48}),F?a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-800",children:F.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[(F.size/1024).toFixed(1)," KB"]})]}):a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-600",children:"Nhp  chn file CSV"}),a.jsx("p",{className:"text-sm text-gray-400",children:"H tr file t my chm cng (Access Controller)"})]}),a.jsx("input",{ref:ee,type:"file",accept:".csv",onChange:ve,className:"hidden"})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:K,disabled:!F||J,className:"flex items-center gap-2 px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[J?a.jsx(ih,{size:18,className:"animate-spin"}):a.jsx(Zl,{size:18}),J?"ang x l...":"ng b d liu"]}),F&&a.jsx("button",{onClick:()=>{T(null),I(null),ee.current&&(ee.current.value="")},className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"Xa file"})]})]})]}),D&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Tng bn ghi"}),a.jsx("div",{className:"text-2xl font-bold text-gray-800",children:D.tongBanGhi})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"S ngy cng"}),a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:D.tongNgay})]}),a.jsxs("div",{className:"bg-green-50 p-4 rounded-lg shadow-sm",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Lu thnh cng"}),a.jsxs("div",{className:"text-2xl font-bold text-green-600 flex items-center gap-2",children:[a.jsx(ah,{size:24})," ",D.luuThanhCong]})]}),a.jsxs("div",{className:"bg-red-50 p-4 rounded-lg shadow-sm",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Li"}),a.jsxs("div",{className:"text-2xl font-bold text-red-600 flex items-center gap-2",children:[a.jsx(Tb,{size:24})," ",D.luuThatBai]})]})]}),D.thongKe.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[a.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b",children:a.jsx("h4",{className:"font-semibold",children:"Thng k theo nhn vin"})}),a.jsx("div",{className:"overflow-x-auto max-h-64",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),a.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Thng/Nm"}),a.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"S cng"}),a.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"i mun"}),a.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"V sm"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:D.thongKe.map((k,B)=>a.jsxs("tr",{className:k.soLanDiMuon>0||k.soLanVeSom>0?"bg-orange-50":"",children:[a.jsx("td",{className:"px-4 py-2 font-medium",children:k.maNhanVien}),a.jsxs("td",{className:"px-4 py-2 text-center",children:[k.thang,"/",k.nam]}),a.jsx("td",{className:"px-4 py-2 text-center text-blue-600 font-semibold",children:k.soCongThucTe}),a.jsx("td",{className:"px-4 py-2 text-center",children:a.jsx("span",{className:k.soLanDiMuon>0?"text-orange-600 font-semibold":"",children:k.soLanDiMuon})}),a.jsx("td",{className:"px-4 py-2 text-center",children:a.jsx("span",{className:k.soLanVeSom>0?"text-orange-600 font-semibold":"",children:k.soLanVeSom})})]},B))})]})})]}),D.chiTiet.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[a.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b",children:a.jsxs("h4",{className:"font-semibold",children:["Chi tit chm cng (",D.chiTiet.length," ngy)"]})}),a.jsxs("div",{className:"overflow-x-auto max-h-96",children:[a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),a.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Gi vo"}),a.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Gi ra"}),a.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:D.chiTiet.slice(0,100).map((k,B)=>a.jsxs("tr",{className:k.diMuon||k.veSom?"bg-orange-50":"",children:[a.jsx("td",{className:"px-4 py-2 font-medium",children:k.maNhanVien}),a.jsx("td",{className:"px-4 py-2",children:k.ngay}),a.jsxs("td",{className:"px-4 py-2 text-center",children:[a.jsx("span",{className:k.diMuon?"text-orange-600 font-semibold":"",children:k.gioVao||"-"}),k.diMuon&&a.jsxs("span",{className:"text-xs text-orange-500 ml-1",children:["(+",k.phutMuon,"p)"]})]}),a.jsxs("td",{className:"px-4 py-2 text-center",children:[a.jsx("span",{className:k.veSom?"text-orange-600 font-semibold":"",children:k.gioRa||"-"}),k.veSom&&a.jsxs("span",{className:"text-xs text-orange-500 ml-1",children:["(-",k.phutSom,"p)"]})]}),a.jsxs("td",{className:"px-4 py-2 text-center",children:[k.diMuon&&a.jsx("span",{className:"px-2 py-0.5 bg-orange-100 text-orange-700 text-xs rounded mr-1",children:"Mun"}),k.veSom&&a.jsx("span",{className:"px-2 py-0.5 bg-orange-100 text-orange-700 text-xs rounded",children:"Sm"}),!k.diMuon&&!k.veSom&&a.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded",children:"OK"})]})]},B))})]}),D.chiTiet.length>100&&a.jsxs("div",{className:"px-4 py-2 bg-gray-50 text-center text-sm text-gray-500",children:["Hin th 100/",D.chiTiet.length," bn ghi"]})]})]}),D.loi.length>0&&a.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[a.jsxs("h4",{className:"font-semibold text-red-800 mb-2",children:[" Li (",D.loi.length,")"]}),a.jsx("ul",{className:"text-sm text-red-700 space-y-1 list-disc ml-5",children:D.loi.map((k,B)=>a.jsx("li",{children:k},B))})]})]}),a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[a.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:" Hng dn:"}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc ml-5",children:[a.jsx("li",{children:"Upload file CSV xut t my chm cng (Access Controller)"}),a.jsxs("li",{children:["Format: Tn ring, H, ",a.jsx("strong",{children:"ID (m NV)"}),", B phn, ",a.jsx("strong",{children:"Ngy"}),", ",a.jsx("strong",{children:"Thi gian"}),", ..."]}),a.jsx("li",{children:"H thng t ng nhn din gi vo (qut u bui sng) v gi ra (qut cui bui chiu)"}),a.jsx("li",{children:"So snh vi gi chun (cu hnh trong tab Cu hnh pht)  xc nh i mun/v sm"}),a.jsx("li",{children:"D liu s c tng hp theo thng v lu vo h thng"})]})]})]}),e==="cau-hinh"&&g&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex gap-4 items-center",children:[a.jsx("label",{className:"font-medium",children:"Nm p dng:"}),a.jsx("select",{value:s,onChange:k=>l(Number(k.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(k=>a.jsx("option",{value:k,children:k},k))})]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx(jc,{className:"text-orange-500",size:20}),"Pht i mun (theo thng)"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"i mun 1-3 ln"}),a.jsx("input",{type:"number",value:Number(g.phatDiMuon1_3Lan),onChange:k=>b({...g,phatDiMuon1_3Lan:Number(k.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"i mun 4-6 ln"}),a.jsx("input",{type:"number",value:Number(g.phatDiMuon4_6Lan),onChange:k=>b({...g,phatDiMuon4_6Lan:Number(k.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"i mun trn 6 ln"}),a.jsx("input",{type:"number",value:Number(g.phatDiMuonTren6Lan),onChange:k=>b({...g,phatDiMuonTren6Lan:Number(k.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]})]}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx(jc,{className:"text-orange-500",size:20}),"Pht v sm (theo thng)"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"V sm 1-3 ln"}),a.jsx("input",{type:"number",value:Number(g.phatVeSom1_3Lan),onChange:k=>b({...g,phatVeSom1_3Lan:Number(k.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"V sm 4-6 ln"}),a.jsx("input",{type:"number",value:Number(g.phatVeSom4_6Lan),onChange:k=>b({...g,phatVeSom4_6Lan:Number(k.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"V sm trn 6 ln"}),a.jsx("input",{type:"number",value:Number(g.phatVeSomTren6Lan),onChange:k=>b({...g,phatVeSomTren6Lan:Number(k.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]})]}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx(jc,{className:"text-red-500",size:20}),"Ngh khng php"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Tin pht mi ngy (VN)"}),a.jsx("input",{type:"number",value:Number(g.phatNghiKhongPhep),onChange:k=>b({...g,phatNghiKhongPhep:Number(k.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"truLuong",checked:g.truLuongNghiKhongPhep,onChange:k=>b({...g,truLuongNghiKhongPhep:k.target.checked}),className:"rounded"}),a.jsx("label",{htmlFor:"truLuong",className:"text-sm text-gray-700",children:"Tr thm lng theo ngy cng (Lng / Cng chun  S ngy ngh)"})]})]})]}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx(_c,{className:"text-blue-500",size:20}),"Gi lm vic chun"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Gi vo"}),a.jsx("input",{type:"time",value:g.gioVaoChuan,onChange:k=>b({...g,gioVaoChuan:k.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Gi ra"}),a.jsx("input",{type:"time",value:g.gioRaChuan,onChange:k=>b({...g,gioRaChuan:k.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"S pht c php tr"}),a.jsx("input",{type:"number",value:g.phutChoPhepTre,onChange:k=>b({...g,phutChoPhepTre:Number(k.target.value)}),className:"w-full border rounded-lg px-3 py-2"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Nhn vin n tr trong khong thi gian ny khng b tnh i mun"})]})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{onClick:le,className:"flex items-center gap-2 px-6 py-2 bg-primary-600 text-white hover:bg-primary-700 rounded-lg",children:[a.jsx(vo,{size:18}),"Lu cu hnh"]})}),a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[a.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:" Cch tnh tin pht:"}),a.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc ml-5",children:[a.jsx("li",{children:"Pht i mun: Tnh theo s ln i mun trong thng (1-3, 4-6, hoc >6 ln)"}),a.jsx("li",{children:"Pht v sm: Tnh theo s ln v sm trong thng"}),a.jsx("li",{children:"Pht ngh khng php: Tin pht  S ngy ngh"}),a.jsx("li",{children:"Tr lng: (Lng c bn  Cng chun)  S ngy ngh khng php"}),a.jsx("li",{children:"Tng pht = Pht i mun + Pht v sm + Pht ngh KP + Tr lng"})]})]})]})]})}function P3(){const e=Sn(),[t,r]=P.useState(""),[n,s]=P.useState(!1),[l,c]=P.useState(null),[u,d]=P.useState({maPhongBan:"",tenPhongBan:"",moTa:"",gioVaoChuan:"08:00",gioRaChuan:"17:00",phutChoPhepTre:5}),{data:f,isLoading:p}=Bt({queryKey:["phong-ban"],queryFn:ga.layTatCa}),{data:m}=Bt({queryKey:["nhan-vien"],queryFn:()=>os.layTatCa({})}),g=Array.isArray(m)?m:(m==null?void 0:m.data)||[],b=T=>(g==null?void 0:g.filter(D=>D.phongBanId===T).length)||0,v=ot({mutationFn:ga.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["phong-ban"]}),E()}}),y=ot({mutationFn:({id:T,data:D})=>ga.capNhat(T,D),onSuccess:()=>{e.invalidateQueries({queryKey:["phong-ban"]}),E()}}),N=ot({mutationFn:ga.xoa,onSuccess:()=>{e.invalidateQueries({queryKey:["phong-ban"]})}}),_=f==null?void 0:f.filter(T=>T.tenPhongBan.toLowerCase().includes(t.toLowerCase())||T.maPhongBan.toLowerCase().includes(t.toLowerCase())),C=()=>{c(null),d({maPhongBan:"",tenPhongBan:"",moTa:"",gioVaoChuan:"08:00",gioRaChuan:"17:00",phutChoPhepTre:5}),s(!0)},S=T=>{c(T),d({maPhongBan:T.maPhongBan,tenPhongBan:T.tenPhongBan,moTa:T.moTa||"",gioVaoChuan:T.gioVaoChuan||"08:00",gioRaChuan:T.gioRaChuan||"17:00",phutChoPhepTre:T.phutChoPhepTre??5}),s(!0)},E=()=>{s(!1),c(null),d({maPhongBan:"",tenPhongBan:"",moTa:"",gioVaoChuan:"08:00",gioRaChuan:"17:00",phutChoPhepTre:5})},O=T=>{if(T.preventDefault(),!u.maPhongBan.trim()||!u.tenPhongBan.trim()){alert("Vui lng nhp m v tn phng ban");return}l?y.mutate({id:l.id,data:u}):v.mutate(u)},F=T=>{const D=b(T.id);if(D>0){alert(`Khng th xa phng ban ny v ang c ${D} nhn vin. Vui lng chuyn nhn vin sang phng ban khc trc.`);return}confirm(`Bn c chc mun xa phng ban "${T.tenPhongBan}"?`)&&N.mutate(T.id)};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(ou,{className:"w-8 h-8 text-primary-600"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Phng ban"}),a.jsx("p",{className:"text-gray-500",children:"Qun l c cu t chc cng ty"})]})]}),a.jsxs("button",{onClick:C,className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[a.jsx(Ha,{size:20}),"Thm phng ban"]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4",children:a.jsxs("div",{className:"relative max-w-md",children:[a.jsx(Tx,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),a.jsx("input",{type:"text",placeholder:"Tm kim phng ban...",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",value:t,onChange:T=>r(T.target.value)})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:p?a.jsx("div",{className:"p-8 text-center text-gray-500",children:"ang ti..."}):(_==null?void 0:_.length)===0?a.jsx("div",{className:"p-8 text-center text-gray-500",children:"Khng c phng ban no"}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"M"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tn phng ban"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx(_c,{size:14}),"Gi lm vic"]})}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cho php tr"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nhn vin"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thao tc"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:_==null?void 0:_.map(T=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:T.maPhongBan})}),a.jsxs("td",{className:"px-4 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"font-medium text-gray-900",children:T.tenPhongBan}),T.moTa&&a.jsx("div",{className:"text-xs text-gray-500",children:T.moTa})]}),a.jsx("td",{className:"px-4 py-4 text-center",children:a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-lg text-sm font-medium bg-indigo-50 text-indigo-700",children:[a.jsx(_c,{size:14}),T.gioVaoChuan||"08:00"," - ",T.gioRaChuan||"17:00"]})}),a.jsx("td",{className:"px-4 py-4 text-center",children:a.jsxs("span",{className:"text-sm text-gray-600",children:[T.phutChoPhepTre??5," pht"]})}),a.jsx("td",{className:"px-4 py-4 text-center",children:a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[a.jsx(Ba,{size:14}),b(T.id)]})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right",children:a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{onClick:()=>S(T),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Sa",children:a.jsx(go,{size:18})}),a.jsx("button",{onClick:()=>F(T),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Xa",disabled:N.isPending,children:a.jsx(li,{size:18})})]})})]},T.id))})]})})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Tng s phng ban"}),a.jsx("div",{className:"text-3xl font-bold text-primary-600 mt-1",children:(f==null?void 0:f.length)||0})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Tng s nhn vin"}),a.jsx("div",{className:"text-3xl font-bold text-green-600 mt-1",children:(g==null?void 0:g.length)||0})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Trung bnh NV/Phng"}),a.jsx("div",{className:"text-3xl font-bold text-blue-600 mt-1",children:(f==null?void 0:f.length)>0?Math.round(((g==null?void 0:g.length)||0)/f.length):0})]})]}),n&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:l?"Cp nht phng ban":"Thm phng ban mi"}),a.jsxs("form",{onSubmit:O,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["M phng ban ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:u.maPhongBan,onChange:T=>d({...u,maPhongBan:T.target.value.toUpperCase()}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"VD: HR, IT..."})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn phng ban ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:u.tenPhongBan,onChange:T=>d({...u,tenPhongBan:T.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"VD: Phng Nhn s..."})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),a.jsx("textarea",{value:u.moTa,onChange:T=>d({...u,moTa:T.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",rows:2,placeholder:"M t v phng ban..."})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(_c,{className:"w-5 h-5 text-indigo-600"}),a.jsx("h3",{className:"font-medium text-gray-900",children:"Gi lm vic"})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi vo"}),a.jsx("input",{type:"time",value:u.gioVaoChuan,onChange:T=>d({...u,gioVaoChuan:T.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi ra"}),a.jsx("input",{type:"time",value:u.gioRaChuan,onChange:T=>d({...u,gioRaChuan:T.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cho php tr"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"number",min:"0",max:"60",value:u.phutChoPhepTre,onChange:T=>d({...u,phutChoPhepTre:Number(T.target.value)}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 pr-12"}),a.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm",children:"pht"})]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Nhn vin c php n mun trong khong thi gian cho php m khng b tnh l i tr."})]}),a.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[a.jsx("button",{type:"button",onClick:E,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Hy"}),a.jsx("button",{type:"submit",disabled:v.isPending||y.isPending,className:"flex-1 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:v.isPending||y.isPending?"ang lu...":l?"Cp nht":"Thm mi"})]})]})]})})]})}const L0={LUONG_THANG_CO_DINH:{label:"C nh theo thng",desc:"Nhn  s tin mi thng, khng ph thuc ngy cng"},THEO_NGAY_CONG:{label:"Theo ngy cng",desc:"Tnh theo cng thc: S tin  (Ngy cng thc t / Ngy cng l thuyt)"},CHUYEN_CAN_DIEU_KIEN:{label:"Chuyn cn c iu kin",desc:"Nhn  nu ngh khng php  2 ngy, mt ht nu > 2 ngy"}};function L3(){var he;const[e,t]=P.useState("phucap"),r=Sn(),[n,s]=P.useState(!1),[l,c]=P.useState(null),[u,d]=P.useState(""),[f,p]=P.useState({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",cachTinh:"LUONG_THANG_CO_DINH",chiuThue:!1,moTa:"",thuTu:0}),{data:m,isLoading:g}=Bt({queryKey:["khoan-luong"],queryFn:()=>ta.layTatCa()}),b=(m==null?void 0:m.filter(Q=>u===""||Q.loai===u))||[],v=ot({mutationFn:ta.taoMoi,onSuccess:()=>{r.invalidateQueries({queryKey:["khoan-luong"]}),je.success("To ph cp thnh cng!"),_()},onError:Q=>{var xe,Y;je.error(((Y=(xe=Q.response)==null?void 0:xe.data)==null?void 0:Y.message)||"C li xy ra")}}),y=ot({mutationFn:({id:Q,data:xe})=>ta.capNhat(Q,xe),onSuccess:()=>{r.invalidateQueries({queryKey:["khoan-luong"]}),je.success("Cp nht ph cp thnh cng!"),_()},onError:Q=>{var xe,Y;je.error(((Y=(xe=Q.response)==null?void 0:xe.data)==null?void 0:Y.message)||"C li xy ra")}}),N=ot({mutationFn:ta.xoa,onSuccess:()=>{r.invalidateQueries({queryKey:["khoan-luong"]}),je.success("Xa ph cp thnh cng!")},onError:Q=>{var xe,Y;je.error(((Y=(xe=Q.response)==null?void 0:xe.data)==null?void 0:Y.message)||"C li xy ra")}}),_=()=>{s(!1),c(null),p({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",cachTinh:"LUONG_THANG_CO_DINH",chiuThue:!1,moTa:"",thuTu:0})},C=Q=>{c(Q),p({maKhoan:Q.maKhoan,tenKhoan:Q.tenKhoan,loai:Q.loai,cachTinh:Q.cachTinh||"LUONG_THANG_CO_DINH",chiuThue:Q.chiuThue,moTa:Q.moTa||"",thuTu:Q.thuTu}),s(!0)},S=()=>{if(!f.maKhoan||!f.tenKhoan){je.error("Vui lng in m v tn ph cp");return}l?y.mutate({id:l.id,data:f}):v.mutate(f)},E=Q=>{confirm(`Bn c chc mun xa ph cp "${Q.tenKhoan}"?`)&&N.mutate(Q.id)},[O,F]=P.useState({nam:new Date().getFullYear(),tyLeBHXH_NV:8,tyLeBHYT_NV:1.5,tyLeBHTN_NV:1,tyLeBHXH_DN:17.5,tyLeBHYT_DN:3,tyLeBHTN_DN:1,tyLeBHXH_KPCCD_NV:.5,tyLeBHXH_KPCCD_DN:1,mucLuongCoSo:18e5,mucLuongToiThieu:496e4}),{data:T,isLoading:D}=Bt({queryKey:["thong-tin-cong-ty"],queryFn:Gv.lay}),[I,J]=P.useState({tenCongTy:"",maSoThue:"",diaChi:"",dienThoai:"",email:"",website:"",nguoiDaiDien:"",chucVuDaiDien:""});P.useEffect(()=>{T&&J(T)},[T]);const Z=ot({mutationFn:Gv.capNhat,onSuccess:()=>{r.invalidateQueries({queryKey:["thong-tin-cong-ty"]}),je.success("Cp nht thng tin cng ty thnh cng!")},onError:()=>{je.error("C li khi cp nht thng tin cng ty")}}),ee=async Q=>{Q.preventDefault(),je.success("Lu cu hnh BHXH/Thu thnh cng!")},ne=async Q=>{Q.preventDefault(),await Z.mutateAsync(I)};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(yo,{className:"w-8 h-8 text-blue-600"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Ci t h thng"}),a.jsx("p",{className:"text-gray-600",children:"Qun l cu hnh BHXH, thu v thng tin cng ty"})]})]}),a.jsxs("div",{className:"card",children:[a.jsx("div",{className:"border-b",children:a.jsxs("div",{className:"flex gap-4",children:[a.jsx("button",{onClick:()=>t("phucap"),className:`px-4 py-3 font-medium border-b-2 transition-colors ${e==="phucap"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(hS,{className:"w-4 h-4"}),"Ph cp & Khon lng"]})}),a.jsx("button",{onClick:()=>t("bhxh"),className:`px-4 py-3 font-medium border-b-2 transition-colors ${e==="bhxh"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Hc,{className:"w-4 h-4"}),"BHXH / Thu"]})}),a.jsx("button",{onClick:()=>t("congty"),className:`px-4 py-3 font-medium border-b-2 transition-colors ${e==="congty"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ou,{className:"w-4 h-4"}),"Thng tin cng ty"]})})]})}),a.jsxs("div",{className:"p-6",children:[e==="phucap"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Danh sch Ph cp & Khon lng"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Cu hnh cc khon ph cp, thu nhp, khu tr p dng cho nhn vin"})]}),a.jsxs("button",{onClick:()=>s(!0),className:"btn btn-primary",children:[a.jsx(Ha,{size:18}),"Thm mi"]})]}),a.jsxs("div",{className:"flex gap-4 items-center",children:[a.jsxs("select",{value:u,onChange:Q=>d(Q.target.value),className:"border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"",children:"Tt c loi"}),a.jsx("option",{value:"THU_NHAP",children:"Thu nhp"}),a.jsx("option",{value:"KHAU_TRU",children:"Khu tr"})]}),a.jsxs("span",{className:"text-sm text-gray-500",children:["Tng: ",b.length," khon"]})]}),g?a.jsx("div",{className:"text-center py-8",children:a.jsx(Mn,{className:"w-8 h-8 animate-spin mx-auto text-blue-600"})}):a.jsx("div",{className:"overflow-x-auto border rounded-lg",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"M"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Tn khon"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Loi"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Cch tnh"}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Chu thu"}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Th t"}),a.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Thao tc"})]})}),a.jsx("tbody",{children:b.map(Q=>{var xe;return a.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[a.jsx("td",{className:"py-3 px-4 font-mono text-sm",children:Q.maKhoan}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:Q.tenKhoan}),Q.moTa&&a.jsx("div",{className:"text-xs text-gray-500",children:Q.moTa})]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Q.loai==="THU_NHAP"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Q.loai==="THU_NHAP"?"Thu nhp":"Khu tr"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"text-sm",children:((xe=L0[Q.cachTinh])==null?void 0:xe.label)||Q.cachTinh})}),a.jsx("td",{className:"py-3 px-4 text-center",children:Q.chiuThue?a.jsx("span",{className:"text-green-600",children:""}):a.jsx("span",{className:"text-gray-400",children:"-"})}),a.jsx("td",{className:"py-3 px-4 text-center text-gray-500",children:Q.thuTu}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx("button",{onClick:()=>C(Q),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Sa",children:a.jsx(go,{size:16})}),a.jsx("button",{onClick:()=>E(Q),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Xa",children:a.jsx(li,{size:16})})]})})]},Q.id)})})]})}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:[a.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Hng dn cch tnh lng"}),a.jsx("div",{className:"space-y-2 text-sm text-blue-800",children:Object.entries(L0).map(([Q,xe])=>a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("span",{className:"font-medium min-w-[180px]",children:[xe.label,":"]}),a.jsx("span",{children:xe.desc})]},Q))})]})]}),e==="bhxh"&&a.jsxs("form",{onSubmit:ee,className:"space-y-6 max-w-3xl",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Cu hnh BHXH/BHYT/BHTN"}),a.jsx("div",{className:"grid grid-cols-2 gap-4 mb-6",children:a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:a.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Nm p dng"})}),a.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:O.nam,onChange:Q=>F({...O,nam:Number(Q.target.value)})})]})}),a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:[a.jsx("h4",{className:"font-semibold text-blue-900 mb-3",children:"T l ng Nhn vin (%)"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:a.jsx("span",{className:"text-sm text-gray-700",children:"BHXH"})}),a.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:O.tyLeBHXH_NV,onChange:Q=>F({...O,tyLeBHXH_NV:Number(Q.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:a.jsx("span",{className:"text-sm text-gray-700",children:"BHYT"})}),a.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:O.tyLeBHYT_NV,onChange:Q=>F({...O,tyLeBHYT_NV:Number(Q.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:a.jsx("span",{className:"text-sm text-gray-700",children:"BHTN"})}),a.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:O.tyLeBHTN_NV,onChange:Q=>F({...O,tyLeBHTN_NV:Number(Q.target.value)})})]})]})]}),a.jsxs("div",{className:"bg-green-50 p-4 rounded-lg mb-4",children:[a.jsx("h4",{className:"font-semibold text-green-900 mb-3",children:"T l ng Doanh nghip (%)"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:a.jsx("span",{className:"text-sm text-gray-700",children:"BHXH"})}),a.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:O.tyLeBHXH_DN,onChange:Q=>F({...O,tyLeBHXH_DN:Number(Q.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:a.jsx("span",{className:"text-sm text-gray-700",children:"BHYT"})}),a.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:O.tyLeBHYT_DN,onChange:Q=>F({...O,tyLeBHYT_DN:Number(Q.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:a.jsx("span",{className:"text-sm text-gray-700",children:"BHTN"})}),a.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:O.tyLeBHTN_DN,onChange:Q=>F({...O,tyLeBHTN_DN:Number(Q.target.value)})})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:a.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Mc lng c s (VN)"})}),a.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:O.mucLuongCoSo,onChange:Q=>F({...O,mucLuongCoSo:Number(Q.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:a.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Mc lng ti thiu vng (VN)"})}),a.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:O.mucLuongToiThieu,onChange:Q=>F({...O,mucLuongToiThieu:Number(Q.target.value)})})]})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 p-4 rounded-lg text-sm text-yellow-800",children:[a.jsx("strong",{children:"Lu :"})," Cc t l ny s c p dng cho tt c nhn vin khi tnh lng. Vui lng kim tra k trc khi lu."]})]}),a.jsx("div",{className:"flex justify-end gap-2",children:a.jsxs("button",{type:"submit",className:"btn btn-primary",children:[a.jsx(vo,{className:"w-4 h-4"}),"Lu cu hnh"]})})]}),e==="congty"&&a.jsx("form",{onSubmit:ne,className:"space-y-6 max-w-3xl",children:D?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx(Mn,{className:"w-8 h-8 animate-spin text-blue-600"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thng tin cng ty"}),a.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:a.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Tn cng ty *"})}),a.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:I.tenCongTy||"",onChange:Q=>J({...I,tenCongTy:Q.target.value}),required:!0})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:a.jsx("span",{className:"text-sm text-gray-700",children:"M s thu"})}),a.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:I.maSoThue||"",onChange:Q=>J({...I,maSoThue:Q.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:a.jsx("span",{className:"text-sm text-gray-700",children:"in thoi"})}),a.jsx("input",{type:"tel",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:I.dienThoai||"",onChange:Q=>J({...I,dienThoai:Q.target.value})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:a.jsx("span",{className:"text-sm text-gray-700",children:"a ch"})}),a.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",rows:2,value:I.diaChi||"",onChange:Q=>J({...I,diaChi:Q.target.value})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:a.jsx("span",{className:"text-sm text-gray-700",children:"Email"})}),a.jsx("input",{type:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:I.email||"",onChange:Q=>J({...I,email:Q.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:a.jsx("span",{className:"text-sm text-gray-700",children:"Website"})}),a.jsx("input",{type:"url",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:I.website||"",onChange:Q=>J({...I,website:Q.target.value})})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:a.jsx("span",{className:"text-sm text-gray-700",children:"Ngi i din"})}),a.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:I.nguoiDaiDien||"",onChange:Q=>J({...I,nguoiDaiDien:Q.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:a.jsx("span",{className:"text-sm text-gray-700",children:"Chc v ngi i din"})}),a.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:I.chucVuDaiDien||"",onChange:Q=>J({...I,chucVuDaiDien:Q.target.value})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:a.jsx("span",{className:"text-sm text-gray-700",children:"Logo (URL)"})}),a.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:I.logo||"",onChange:Q=>J({...I,logo:Q.target.value}),placeholder:"https://example.com/logo.png"}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Nhp URL ca logo cng ty (hin th trn phiu lng)"})]})]}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg text-sm text-blue-800 mt-4",children:[a.jsx("strong",{children:"Lu :"})," Thng tin ny s c hin th trn cc phiu lng khi xut."]})]}),a.jsx("div",{className:"flex justify-end gap-2",children:a.jsx("button",{type:"submit",className:"btn btn-primary",disabled:Z.isPending,children:Z.isPending?a.jsxs(a.Fragment,{children:[a.jsx(Mn,{className:"w-4 h-4 animate-spin"}),"ang lu..."]}):a.jsxs(a.Fragment,{children:[a.jsx(vo,{className:"w-4 h-4"}),"Lu thng tin"]})})})]})})]})]}),n&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:l?"Sa khon ph cp":"Thm khon ph cp mi"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"M khon *"}),a.jsx("input",{type:"text",value:f.maKhoan,onChange:Q=>p({...f,maKhoan:Q.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: PHU_CAP_AN_TRUA",disabled:!!l})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Th t hin th"}),a.jsx("input",{type:"number",value:f.thuTu,onChange:Q=>p({...f,thuTu:Number(Q.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tn khon *"}),a.jsx("input",{type:"text",value:f.tenKhoan,onChange:Q=>p({...f,tenKhoan:Q.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ph cp n tra"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi khon"}),a.jsxs("select",{value:f.loai,onChange:Q=>p({...f,loai:Q.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"THU_NHAP",children:"Thu nhp (cng vo lng)"}),a.jsx("option",{value:"KHAU_TRU",children:"Khu tr (tr khi lng)"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chu thu TNCN"}),a.jsxs("select",{value:f.chiuThue?"true":"false",onChange:Q=>p({...f,chiuThue:Q.target.value==="true"}),className:"w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"false",children:"Khng chu thu"}),a.jsx("option",{value:"true",children:"C chu thu"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Cch tnh lng"}),a.jsx("select",{value:f.cachTinh,onChange:Q=>p({...f,cachTinh:Q.target.value}),className:"w-full border rounded-lg px-3 py-2",children:Object.entries(L0).map(([Q,xe])=>a.jsx("option",{value:Q,children:xe.label},Q))}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:(he=L0[f.cachTinh])==null?void 0:he.desc})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"M t"}),a.jsx("textarea",{value:f.moTa,onChange:Q=>p({...f,moTa:Q.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2,placeholder:"Ghi ch v khon ph cp ny..."})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[a.jsx("button",{onClick:_,className:"btn btn-secondary",children:"Hy"}),a.jsx("button",{onClick:S,disabled:v.isPending||y.isPending,className:"btn btn-primary",children:v.isPending||y.isPending?"ang lu...":"Lu"})]})]})})]})}function O3(){const e=Sn(),[t,r]=P.useState(!1),[n,s]=P.useState(null),[l,c]=P.useState({maNhom:"",tenNhom:"",moTa:"",mauSac:"#3B82F6",trangThai:!0}),{data:u,isLoading:d}=Bt({queryKey:["nhom-nhan-vien"],queryFn:lw}),f=ot({mutationFn:y3,onSuccess:()=>{je.success("To nhm thnh cng"),e.invalidateQueries({queryKey:["nhom-nhan-vien"]}),r(!1),g()},onError:y=>{var N,_;je.error(((_=(N=y.response)==null?void 0:N.data)==null?void 0:_.message)||"Li to nhm")}}),p=ot({mutationFn:({id:y,data:N})=>b3(y,N),onSuccess:()=>{je.success("Cp nht nhm thnh cng"),e.invalidateQueries({queryKey:["nhom-nhan-vien"]}),s(null),r(!1),g()},onError:y=>{var N,_;je.error(((_=(N=y.response)==null?void 0:N.data)==null?void 0:_.message)||"Li cp nht")}}),m=ot({mutationFn:w3,onSuccess:()=>{je.success(" xa nhm"),e.invalidateQueries({queryKey:["nhom-nhan-vien"]})},onError:y=>{var N,_;je.error(((_=(N=y.response)==null?void 0:N.data)==null?void 0:_.message)||"Li xa nhm")}}),g=()=>{c({maNhom:"",tenNhom:"",moTa:"",mauSac:"#3B82F6",trangThai:!0})},b=y=>{c({maNhom:y.maNhom,tenNhom:y.tenNhom,moTa:y.moTa||"",mauSac:y.mauSac||"#3B82F6",trangThai:y.trangThai}),s(y.id),r(!0)},v=y=>{y.preventDefault(),n?p.mutate({id:n,data:l}):f.mutate(l)};return d?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Qun l Nhm Nhn vin"}),a.jsxs("button",{onClick:()=>{r(!0),s(null),g()},className:"btn btn-primary flex items-center gap-2",children:[a.jsx(Ha,{size:20}),"Thm nhm"]})]}),t&&a.jsxs("div",{className:"card mb-6 bg-blue-50 border border-blue-200",children:[a.jsx("h3",{className:"font-semibold mb-4",children:n?"Sa nhm":"To nhm mi"}),a.jsxs("form",{onSubmit:v,className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"M nhm *"}),a.jsx("input",{type:"text",value:l.maNhom,onChange:y=>c({...l,maNhom:y.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: NHOM_KT, NHOM_HR...",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tn nhm *"}),a.jsx("input",{type:"text",value:l.tenNhom,onChange:y=>c({...l,tenNhom:y.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Nhm K ton, Nhm HR...",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"M t"}),a.jsx("input",{type:"text",value:l.moTa,onChange:y=>c({...l,moTa:y.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"M t ngn v nhm..."})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Mu sc"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"color",value:l.mauSac,onChange:y=>c({...l,mauSac:y.target.value}),className:"w-10 h-10 rounded cursor-pointer"}),a.jsx("span",{className:"text-sm text-gray-500",children:l.mauSac})]})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Trng thi"}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:l.trangThai,onChange:y=>c({...l,trangThai:y.target.checked}),className:"w-4 h-4 rounded"}),a.jsx("span",{className:"text-sm",children:"ang hot ng"})]})]})]}),a.jsxs("div",{className:"col-span-2 flex gap-2",children:[a.jsx("button",{type:"submit",disabled:f.isPending||p.isPending,className:"btn btn-primary",children:n?"Cp nht":"To mi"}),a.jsx("button",{type:"button",onClick:()=>{r(!1),s(null)},className:"btn btn-secondary",children:"Hy"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[u==null?void 0:u.map(y=>{var N;return a.jsxs("div",{className:`card ${y.trangThai?"":"opacity-60"}`,style:{borderLeftWidth:"4px",borderLeftColor:y.mauSac||"#6B7280"},children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center text-white font-bold text-lg",style:{backgroundColor:y.mauSac||"#6B7280"},children:y.tenNhom.charAt(0).toUpperCase()}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold",children:y.tenNhom}),a.jsx("div",{className:"text-xs text-gray-500",children:y.maNhom})]})]}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>b(y),className:"p-1.5 hover:bg-blue-100 rounded text-blue-600",title:"Sa",children:a.jsx(go,{size:16})}),a.jsx("button",{onClick:()=>{confirm(`Xc nhn xa nhm "${y.tenNhom}"?`)&&m.mutate(y.id)},className:"p-1.5 hover:bg-red-100 rounded text-red-600",title:"Xa",children:a.jsx(li,{size:16})})]})]}),y.moTa&&a.jsx("div",{className:"text-sm text-gray-600 mt-2",children:y.moTa}),a.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t",children:[a.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[a.jsx(Ba,{size:16}),a.jsxs("span",{children:[((N=y._count)==null?void 0:N.thanhViens)||0," thnh vin"]})]}),a.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${y.trangThai?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:y.trangThai?"Hot ng":"Tm dng"})]})]},y.id)}),(u==null?void 0:u.length)===0&&a.jsxs("div",{className:"col-span-3 text-center py-12 text-gray-500 bg-gray-50 rounded-lg",children:[a.jsx(Ba,{size:48,className:"mx-auto mb-4 text-gray-300"}),a.jsx("p",{children:"Cha c nhm no"}),a.jsxs("button",{onClick:()=>{r(!0),s(null),g()},className:"btn btn-primary mt-4",children:[a.jsx(Ha,{size:20}),"To nhm u tin"]})]})]}),a.jsxs("div",{className:"mt-6 bg-blue-50 p-4 rounded-lg text-sm text-blue-800",children:[a.jsx("strong",{children:" Hng dn:"})," Nhm nhn vin c s dng trong Rule Engine  p dng cc quy tc tnh lng khc nhau cho tng nhm. V d: nhm Qun l c ph cp chc v, nhm K thut c ph cp c hi..."]})]})}function R3(){const e=fi(),{dangNhap:t,isAuthenticated:r}=Ex(),[n,s]=P.useState(""),[l,c]=P.useState(""),[u,d]=P.useState(!1),[f,p]=P.useState("");if(r)return e("/",{replace:!0}),null;const m=async g=>{var b,v;if(g.preventDefault(),p(""),!n||!l){p("Vui lng nhp tn ng nhp v mt khu");return}d(!0);try{await t(n,l),e("/",{replace:!0})}catch(y){p(((v=(b=y.response)==null?void 0:b.data)==null?void 0:v.message)||"ng nhp tht bi")}finally{d(!1)}};return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:a.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg p-8",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-blue-100 mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"H thng Tnh Lng"}),a.jsx("p",{className:"text-gray-500 mt-1",children:"ng nhp  tip tc"})]}),f&&a.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:f}),a.jsxs("form",{onSubmit:m,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"tenDangNhap",className:"block text-sm font-medium text-gray-700 mb-2",children:"Tn ng nhp"}),a.jsx("input",{type:"text",id:"tenDangNhap",value:n,onChange:g=>s(g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition",placeholder:"Nhp tn ng nhp",autoComplete:"username"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"matKhau",className:"block text-sm font-medium text-gray-700 mb-2",children:"Mt khu"}),a.jsx("input",{type:"password",id:"matKhau",value:l,onChange:g=>c(g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition",placeholder:"Nhp mt khu",autoComplete:"current-password"})]}),a.jsx("button",{type:"submit",disabled:u,className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium rounded-lg transition flex items-center justify-center",children:u?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"ang ng nhp..."]}):"ng nhp"})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs("p",{className:"text-sm text-gray-500",children:["Ti khon mc nh: ",a.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:"admin"})," / ",a.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:"admin123"})]})})]})})}const I3="tinh_luong_auth",bn=Xt.create({baseURL:"/api/kpi",headers:{"Content-Type":"application/json"}});bn.interceptors.request.use(e=>{const t=localStorage.getItem(I3);if(t)try{const r=JSON.parse(t);r.token&&(e.headers.Authorization=`Bearer ${r.token}`)}catch{}return e},e=>Promise.reject(e));const Gl={layTatCa:e=>bn.get("/template",{params:e}).then(t=>t.data),layTheoId:e=>bn.get(`/template/${e}`).then(t=>t.data),taoMoi:e=>bn.post("/template",e).then(t=>t.data),capNhat:(e,t)=>bn.put(`/template/${e}`,t).then(r=>r.data),themChiTieu:(e,t)=>bn.post(`/template/${e}/chi-tieu`,t).then(r=>r.data),xoaChiTieu:e=>bn.delete(`/chi-tieu/${e}`).then(t=>t.data)},$f={layTatCa:e=>bn.get("/ky-danh-gia",{params:e}).then(t=>t.data),layTheoId:e=>bn.get(`/ky-danh-gia/${e}`).then(t=>t.data),taoMoi:e=>bn.post("/ky-danh-gia",e).then(t=>t.data),capNhatTrangThai:(e,t)=>bn.put(`/ky-danh-gia/${e}/trang-thai`,{trangThai:t}).then(r=>r.data)},Wf={layTheoNam:e=>bn.get(`/cau-hinh-thuong/${e}`).then(t=>t.data),taoMoi:e=>bn.post("/cau-hinh-thuong",e).then(t=>t.data),khoiTaoMacDinh:e=>bn.post(`/cau-hinh-thuong/khoi-tao/${e}`).then(t=>t.data)};function M3(){var O,F;const[e,t]=P.useState([]),[r,n]=P.useState([]),[s,l]=P.useState(null),[c,u]=P.useState(!0),[d,f]=P.useState(!1),[p,m]=P.useState(!1),[g,b]=P.useState({maTemplate:"",tenTemplate:"",phongBanId:"",moTa:""}),[v,y]=P.useState({maChiTieu:"",tenChiTieu:"",donViTinh:"",trongSo:0,loaiChiTieu:"SO",chiTieuToiThieu:0,chiTieuMucTieu:0,chiTieuVuotMuc:0});P.useEffect(()=>{N()},[]);const N=async()=>{try{const[T,D]=await Promise.all([Gl.layTatCa(),ga.layTatCa()]);t(T),n(D)}catch(T){console.error("Li ti d liu:",T)}finally{u(!1)}},_=async T=>{T.preventDefault();try{await Gl.taoMoi({maTemplate:g.maTemplate,tenTemplate:g.tenTemplate,phongBanId:g.phongBanId?parseInt(g.phongBanId):void 0,moTa:g.moTa||void 0}),f(!1),b({maTemplate:"",tenTemplate:"",phongBanId:"",moTa:""}),N()}catch(D){console.error("Li to template:",D)}},C=async T=>{var D;if(T.preventDefault(),!!s)try{await Gl.themChiTieu(s.id,{...v,thuTu:(((D=s.chiTieuKPIs)==null?void 0:D.length)||0)+1}),m(!1),y({maChiTieu:"",tenChiTieu:"",donViTinh:"",trongSo:0,loaiChiTieu:"SO",chiTieuToiThieu:0,chiTieuMucTieu:0,chiTieuVuotMuc:0}),N();const I=await Gl.layTheoId(s.id);l(I)}catch(I){console.error("Li thm ch tiu:",I)}},S=async T=>{if(confirm("Xc nhn xa ch tiu ny?"))try{if(await Gl.xoaChiTieu(T),N(),s){const D=await Gl.layTheoId(s.id);l(D)}}catch(D){console.error("Li xa ch tiu:",D)}},E=T=>(T==null?void 0:T.reduce((D,I)=>D+Number(I.trongSo),0))||0;return c?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Template KPI"}),a.jsx("p",{className:"text-gray-500 mt-1",children:"Thit lp cc ch tiu nh gi KPI"})]}),a.jsxs("button",{onClick:()=>f(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm Template"]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow",children:[a.jsx("div",{className:"p-4 border-b",children:a.jsx("h2",{className:"font-semibold text-gray-800",children:"Danh sch Template"})}),a.jsx("div",{className:"divide-y max-h-[600px] overflow-y-auto",children:e.length===0?a.jsx("div",{className:"p-8 text-center text-gray-500",children:"Cha c template no"}):e.map(T=>{var D;return a.jsx("div",{onClick:()=>l(T),className:`p-4 cursor-pointer hover:bg-gray-50 ${(s==null?void 0:s.id)===T.id?"bg-blue-50 border-l-4 border-blue-500":""}`,children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-900",children:T.tenTemplate}),a.jsx("p",{className:"text-sm text-gray-500",children:T.maTemplate}),T.phongBan&&a.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded",children:T.phongBan.tenPhongBan})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("span",{className:"text-sm text-gray-600",children:[((D=T.chiTieuKPIs)==null?void 0:D.length)||0," ch tiu"]}),a.jsxs("div",{className:`text-xs mt-1 ${E(T.chiTieuKPIs)===100?"text-green-600":"text-amber-600"}`,children:["Tng: ",E(T.chiTieuKPIs),"%"]})]})]})},T.id)})})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow",children:[a.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[a.jsx("h2",{className:"font-semibold text-gray-800",children:s?s.tenTemplate:"Chi tit Template"}),s&&a.jsxs("button",{onClick:()=>m(!0),className:"text-blue-600 hover:text-blue-700 text-sm flex items-center gap-1",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm ch tiu"]})]}),s?a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[a.jsxs("p",{className:"text-sm",children:[a.jsx("span",{className:"font-medium",children:"M:"})," ",s.maTemplate]}),s.moTa&&a.jsxs("p",{className:"text-sm mt-1",children:[a.jsx("span",{className:"font-medium",children:"M t:"})," ",s.moTa]}),a.jsxs("p",{className:`text-sm mt-1 ${E(s.chiTieuKPIs)===100?"text-green-600":"text-amber-600"}`,children:[a.jsx("span",{className:"font-medium",children:"Tng trng s:"})," ",E(s.chiTieuKPIs),"%",E(s.chiTieuKPIs)!==100&&" (cn = 100%)"]})]}),a.jsx("div",{className:"space-y-3",children:((O=s.chiTieuKPIs)==null?void 0:O.length)===0?a.jsx("p",{className:"text-gray-500 text-center py-4",children:"Cha c ch tiu"}):(F=s.chiTieuKPIs)==null?void 0:F.map(T=>a.jsxs("div",{className:"border rounded-lg p-3",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900",children:T.tenChiTieu}),a.jsx("p",{className:"text-sm text-gray-500",children:T.maChiTieu})]}),a.jsx("button",{onClick:()=>S(T.id),className:"text-red-500 hover:text-red-700",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),a.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Trng s:"})," ",T.trongSo,"%"]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"n v:"})," ",T.donViTinh]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Loi:"})," ",T.loaiChiTieu]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Mc tiu:"})," ",Number(T.chiTieuMucTieu).toLocaleString()]})]})]},T.id))})]}):a.jsx("div",{className:"p-8 text-center text-gray-500",children:"Chn mt template  xem chi tit"})]})]}),d&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm Template KPI"}),a.jsxs("form",{onSubmit:_,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M template *"}),a.jsx("input",{type:"text",value:g.maTemplate,onChange:T=>b({...g,maTemplate:T.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn template *"}),a.jsx("input",{type:"text",value:g.tenTemplate,onChange:T=>b({...g,tenTemplate:T.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),a.jsxs("select",{value:g.phongBanId,onChange:T=>b({...g,phongBanId:T.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"",children:"-- p dng chung --"}),r.map(T=>a.jsx("option",{value:T.id,children:T.tenPhongBan},T.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),a.jsx("textarea",{value:g.moTa,onChange:T=>b({...g,moTa:T.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To"})]})]})]})}),p&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm Ch tiu KPI"}),a.jsxs("form",{onSubmit:C,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M ch tiu *"}),a.jsx("input",{type:"text",value:v.maChiTieu,onChange:T=>y({...v,maChiTieu:T.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn ch tiu *"}),a.jsx("input",{type:"text",value:v.tenChiTieu,onChange:T=>y({...v,tenChiTieu:T.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n v *"}),a.jsx("input",{type:"text",value:v.donViTinh,onChange:T=>y({...v,donViTinh:T.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VN, %, S...",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng s (%) *"}),a.jsx("input",{type:"number",value:v.trongSo,onChange:T=>y({...v,trongSo:Number(T.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0,max:100,required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi *"}),a.jsxs("select",{value:v.loaiChiTieu,onChange:T=>y({...v,loaiChiTieu:T.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[a.jsx("option",{value:"SO",children:"S lng"}),a.jsx("option",{value:"PHAN_TRAM",children:"Phn trm"}),a.jsx("option",{value:"TIEN",children:"Tin"}),a.jsx("option",{value:"DANH_GIA",children:"nh gi (1-5)"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ti thiu"}),a.jsx("input",{type:"number",value:v.chiTieuToiThieu,onChange:T=>y({...v,chiTieuToiThieu:Number(T.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mc tiu"}),a.jsx("input",{type:"number",value:v.chiTieuMucTieu,onChange:T=>y({...v,chiTieuMucTieu:Number(T.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vt mc"}),a.jsx("input",{type:"number",value:v.chiTieuVuotMuc,onChange:T=>y({...v,chiTieuVuotMuc:Number(T.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>m(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Thm"})]})]})]})})]})}const B3={THANG:"Thng",QUY:"Qu",NAM:"Nm"},ay={CHUA_BAT_DAU:{label:"Cha bt u",color:"bg-gray-100 text-gray-600"},DANG_DIEN_RA:{label:"ang din ra",color:"bg-green-100 text-green-700"},DA_KET_THUC:{label:" kt thc",color:"bg-blue-100 text-blue-700"},DA_DONG:{label:" ng",color:"bg-red-100 text-red-700"}};function H3(){const[e,t]=P.useState([]),[r,n]=P.useState(!0),[s,l]=P.useState(!1),[c,u]=P.useState(new Date().getFullYear()),[d,f]=P.useState({maKy:"",tenKy:"",loaiKy:"THANG",tuNgay:"",denNgay:"",moTa:""});P.useEffect(()=>{p()},[c]);const p=async()=>{n(!0);try{const v=await $f.layTatCa({nam:c});t(v)}catch(v){console.error("Li ti d liu:",v)}finally{n(!1)}},m=async v=>{v.preventDefault();try{await $f.taoMoi({...d,moTa:d.moTa||void 0}),l(!1),f({maKy:"",tenKy:"",loaiKy:"THANG",tuNgay:"",denNgay:"",moTa:""}),p()}catch(y){console.error("Li to k nh gi:",y)}},g=async(v,y)=>{try{await $f.capNhatTrangThai(v,y),p()}catch(N){console.error("Li cp nht trng thi:",N)}},b=v=>new Date(v).toLocaleDateString("vi-VN");return r?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"K nh Gi KPI"}),a.jsx("p",{className:"text-gray-500 mt-1",children:"Qun l cc k nh gi hiu sut"})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx("select",{value:c,onChange:v=>u(Number(v.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(v=>a.jsxs("option",{value:v,children:["Nm ",v]},v))}),a.jsxs("button",{onClick:()=>l(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm K nh Gi"]})]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M k"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tn k"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Loi"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thi gian"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"S nh gi"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.length===0?a.jsx("tr",{children:a.jsxs("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:["Cha c k nh gi no trong nm ",c]})}):e.map(v=>{var y;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:"font-mono text-sm text-gray-900",children:v.maKy})}),a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:v.tenKy}),v.moTa&&a.jsx("div",{className:"text-xs text-gray-500",children:v.moTa})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:"px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded",children:B3[v.loaiKy]})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:[b(v.tuNgay)," - ",b(v.denNgay)]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`px-2 py-1 text-xs rounded ${ay[v.trangThai].color}`,children:ay[v.trangThai].label})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:((y=v._count)==null?void 0:y.danhGias)||0}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:a.jsxs("div",{className:"flex gap-2",children:[v.trangThai==="CHUA_BAT_DAU"&&a.jsx("button",{onClick:()=>g(v.id,"DANG_DIEN_RA"),className:"text-green-600 hover:text-green-800",children:"Bt u"}),v.trangThai==="DANG_DIEN_RA"&&a.jsx("button",{onClick:()=>g(v.id,"DA_KET_THUC"),className:"text-blue-600 hover:text-blue-800",children:"Kt thc"}),v.trangThai==="DA_KET_THUC"&&a.jsx("button",{onClick:()=>g(v.id,"DA_DONG"),className:"text-red-600 hover:text-red-800",children:"ng"}),a.jsx("a",{href:`/kpi/ky-danh-gia/${v.id}`,className:"text-indigo-600 hover:text-indigo-800",children:"Chi tit"})]})})]},v.id)})})]})}),s&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm K nh Gi"}),a.jsxs("form",{onSubmit:m,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M k *"}),a.jsx("input",{type:"text",value:d.maKy,onChange:v=>f({...d,maKy:v.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: KPI-2026-Q1",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi k *"}),a.jsxs("select",{value:d.loaiKy,onChange:v=>f({...d,loaiKy:v.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[a.jsx("option",{value:"THANG",children:"Thng"}),a.jsx("option",{value:"QUY",children:"Qu"}),a.jsx("option",{value:"NAM",children:"Nm"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn k *"}),a.jsx("input",{type:"text",value:d.tenKy,onChange:v=>f({...d,tenKy:v.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: nh gi KPI Qu 1/2026",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T ngy *"}),a.jsx("input",{type:"date",value:d.tuNgay,onChange:v=>f({...d,tuNgay:v.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n ngy *"}),a.jsx("input",{type:"date",value:d.denNgay,onChange:v=>f({...d,denNgay:v.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),a.jsx("textarea",{value:d.moTa,onChange:v=>f({...d,moTa:v.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To"})]})]})]})})]})}const Gf={XUAT_SAC:{label:"Xut sc",color:"bg-purple-100 text-purple-700"},TOT:{label:"Tt",color:"bg-green-100 text-green-700"},KHA:{label:"Kh",color:"bg-blue-100 text-blue-700"},TRUNG_BINH:{label:"Trung bnh",color:"bg-yellow-100 text-yellow-700"},YEU:{label:"Yu",color:"bg-red-100 text-red-700"}};function U3(){const[e,t]=P.useState([]),[r,n]=P.useState(!0),[s,l]=P.useState(new Date().getFullYear()),[c,u]=P.useState(!1),[d,f]=P.useState({xepLoai:"TOT",diemToiThieu:0,diemToiDa:100,heSoThuong:1,moTa:""});P.useEffect(()=>{p()},[s]);const p=async()=>{n(!0);try{const b=await Wf.layTheoNam(s);t(b)}catch(b){console.error("Li ti d liu:",b)}finally{n(!1)}},m=async()=>{if(confirm(`Khi to cu hnh thng mc nh cho nm ${s}?`))try{await Wf.khoiTaoMacDinh(s),p()}catch(b){console.error("Li khi to:",b)}},g=async b=>{b.preventDefault();try{await Wf.taoMoi({nam:s,...d,moTa:d.moTa||void 0}),u(!1),p()}catch(v){console.error("Li to cu hnh:",v)}};return r?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Cu hnh Thng KPI"}),a.jsx("p",{className:"text-gray-500 mt-1",children:"Thit lp h s thng theo mc xp loi"})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx("select",{value:s,onChange:b=>l(Number(b.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(b=>a.jsxs("option",{value:b,children:["Nm ",b]},b))}),a.jsx("button",{onClick:m,className:"border border-blue-600 text-blue-600 hover:bg-blue-50 px-4 py-2 rounded-lg",children:"Khi to mc nh"}),a.jsxs("button",{onClick:()=>u(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm Cu hnh"]})]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Xp loi"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"im ti thiu"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"im ti a"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"H s thng"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M t"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Trng thi"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.length===0?a.jsx("tr",{children:a.jsxs("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:[a.jsxs("p",{children:["Cha c cu hnh thng cho nm ",s]}),a.jsx("button",{onClick:m,className:"mt-4 text-blue-600 hover:text-blue-700 underline",children:"Khi to cu hnh mc nh"})]})}):e.map(b=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`px-3 py-1 text-sm rounded-full font-medium ${Gf[b.xepLoai].color}`,children:Gf[b.xepLoai].label})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("span",{className:"text-gray-900 font-mono",children:[Number(b.diemToiThieu).toFixed(1),"%"]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("span",{className:"text-gray-900 font-mono",children:[Number(b.diemToiDa).toFixed(2),"%"]})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsxs("span",{className:"text-lg font-semibold text-indigo-600",children:[Number(b.heSoThuong),"x"]}),a.jsx("span",{className:"text-gray-500 text-sm ml-1",children:"lng c bn"})]}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:"text-gray-600 text-sm",children:b.moTa||"-"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`px-2 py-1 text-xs rounded ${b.trangThai?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:b.trangThai?"Hot ng":"Ngng"})})]},b.id))})]})}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[a.jsx("h3",{className:"font-semibold text-blue-800 mb-3",children:" Cng thc tnh thng KPI"}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-blue-700",children:[a.jsxs("div",{children:[a.jsx("p",{children:a.jsx("strong",{children:"Tin thng = Lng c bn  H s thng"})}),a.jsx("p",{className:"mt-2",children:'V d: Nhn vin lng 15,000,000, xp loi "Tt" (h s 1.5x)'}),a.jsxs("p",{children:[" Thng = 15,000,000  1.5 = ",a.jsx("strong",{children:"22,500,000"})]})]}),a.jsxs("div",{children:[a.jsx("p",{children:a.jsx("strong",{children:"im KPI c tnh t:"})}),a.jsxs("ul",{className:"list-disc ml-4 mt-2",children:[a.jsx("li",{children:"Tng im =  (im ch tiu  Trng s)"}),a.jsx("li",{children:"im ch tiu = (Kt qu / Mc tiu)  100"}),a.jsx("li",{children:"Ti a 150% nu vt mc"})]})]})]})]}),c&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm Cu hnh Thng"}),a.jsxs("form",{onSubmit:g,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Xp loi *"}),a.jsx("select",{value:d.xepLoai,onChange:b=>f({...d,xepLoai:b.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:Object.entries(Gf).map(([b,{label:v}])=>a.jsx("option",{value:b,children:v},b))})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"im ti thiu *"}),a.jsx("input",{type:"number",step:"0.01",value:d.diemToiThieu,onChange:b=>f({...d,diemToiThieu:Number(b.target.value)}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"im ti a *"}),a.jsx("input",{type:"number",step:"0.01",value:d.diemToiDa,onChange:b=>f({...d,diemToiDa:Number(b.target.value)}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"H s thng *"}),a.jsx("input",{type:"number",step:"0.1",value:d.heSoThuong,onChange:b=>f({...d,heSoThuong:Number(b.target.value)}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),a.jsx("input",{type:"text",value:d.moTa,onChange:b=>f({...d,moTa:b.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>u(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To"})]})]})]})})]})}const sy={HOAT_DONG:{label:"Hot ng",color:"bg-green-100 text-green-700"},TAM_KHOA:{label:"Tm kha",color:"bg-yellow-100 text-yellow-700"},NGUNG_HOAT_DONG:{label:"Ngng",color:"bg-red-100 text-red-700"}};function V3(){const[e,t]=P.useState([]),[r,n]=P.useState([]),[s,l]=P.useState(!0),[c,u]=P.useState(!1),[d,f]=P.useState("nguoi-dung"),[p,m]=P.useState({tenDangNhap:"",matKhau:"",hoTen:"",email:"",soDienThoai:"",vaiTroIds:[]}),[g,b]=P.useState({maVaiTro:"",tenVaiTro:"",moTa:"",capDo:50});P.useEffect(()=>{v()},[]);const v=async()=>{try{const[E,O]=await Promise.all([Uf.layTatCa(),$v.layTatCa()]);t(E),n(O)}catch(E){console.error("Li ti d liu:",E)}finally{l(!1)}},y=async E=>{E.preventDefault();try{await Uf.taoMoi({tenDangNhap:p.tenDangNhap,matKhau:p.matKhau,hoTen:p.hoTen,email:p.email,soDienThoai:p.soDienThoai||void 0,vaiTroIds:p.vaiTroIds}),u(!1),m({tenDangNhap:"",matKhau:"",hoTen:"",email:"",soDienThoai:"",vaiTroIds:[]}),v()}catch(O){console.error("Li to ngi dng:",O)}},N=async E=>{E.preventDefault();try{await $v.taoMoi({maVaiTro:g.maVaiTro,tenVaiTro:g.tenVaiTro,moTa:g.moTa||void 0,capDo:g.capDo}),u(!1),b({maVaiTro:"",tenVaiTro:"",moTa:"",capDo:50}),v()}catch(O){console.error("Li to vai tr:",O)}},_=async(E,O)=>{try{await Uf.capNhat(E,{trangThai:O}),v()}catch(F){console.error("Li cp nht:",F)}},C=E=>{m(O=>({...O,vaiTroIds:O.vaiTroIds.includes(E)?O.vaiTroIds.filter(F=>F!==E):[...O.vaiTroIds,E]}))},S=E=>E?new Date(E).toLocaleString("vi-VN"):"-";return s?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Ngi dng & Vai tr"}),a.jsx("p",{className:"text-gray-500 mt-1",children:"Phn quyn truy cp h thng"})]}),a.jsxs("button",{onClick:()=>u(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),d==="nguoi-dung"?"Thm Ngi dng":"Thm Vai tr"]})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsxs("nav",{className:"-mb-px flex gap-6",children:[a.jsxs("button",{onClick:()=>f("nguoi-dung"),className:`py-3 px-1 border-b-2 font-medium text-sm ${d==="nguoi-dung"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Ngi dng (",e.length,")"]}),a.jsxs("button",{onClick:()=>f("vai-tro"),className:`py-3 px-1 border-b-2 font-medium text-sm ${d==="vai-tro"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Vai tr (",r.length,")"]})]})}),d==="nguoi-dung"?a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngi dng"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Vai tr"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ng nhp cui"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(E=>{var O,F,T;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:a.jsx("span",{className:"text-blue-600 font-medium",children:E.hoTen.charAt(0).toUpperCase()})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("div",{className:"font-medium text-gray-900",children:E.hoTen}),a.jsxs("div",{className:"text-sm text-gray-500",children:["@",E.tenDangNhap]})]})]})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:E.email}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"flex flex-wrap gap-1",children:((O=E.vaiTros)==null?void 0:O.map(D=>a.jsx("span",{className:"px-2 py-0.5 bg-indigo-100 text-indigo-700 text-xs rounded",children:D.vaiTro.tenVaiTro},D.id)))||a.jsx("span",{className:"text-gray-400 text-sm",children:"Cha gn"})})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:S(E.lanDangNhapCuoi)}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`px-2 py-1 text-xs rounded ${((F=sy[E.trangThai])==null?void 0:F.color)||"bg-gray-100"}`,children:((T=sy[E.trangThai])==null?void 0:T.label)||E.trangThai})}),a.jsx("td",{className:"px-6 py-4 text-sm",children:a.jsxs("div",{className:"flex gap-2",children:[E.trangThai==="HOAT_DONG"&&a.jsx("button",{onClick:()=>_(E.id,"TAM_KHOA"),className:"text-yellow-600 hover:text-yellow-800",children:"Kha"}),E.trangThai==="TAM_KHOA"&&a.jsx("button",{onClick:()=>_(E.id,"HOAT_DONG"),className:"text-green-600 hover:text-green-800",children:"M kha"})]})})]},E.id)})})]})}):a.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:r.map(E=>{var O,F,T,D,I;return a.jsxs("div",{className:"bg-white rounded-lg shadow p-5",children:[a.jsxs("div",{className:"flex justify-between items-start mb-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:E.tenVaiTro}),a.jsx("p",{className:"text-sm text-gray-500 font-mono",children:E.maVaiTro})]}),a.jsx("span",{className:`px-2 py-1 text-xs rounded ${E.trangThai?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:E.trangThai?"Hot ng":"Ngng"})]}),E.moTa&&a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:E.moTa}),a.jsxs("div",{className:"flex justify-between items-center text-sm",children:[a.jsxs("span",{className:"text-gray-500",children:["Cp : ",E.capDo]}),a.jsxs("span",{className:"text-indigo-600",children:[((O=E._count)==null?void 0:O.nguoiDungs)||0," ngi dng"]})]}),a.jsxs("div",{className:"mt-3 pt-3 border-t",children:[a.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:["Quyn (",((F=E.quyens)==null?void 0:F.length)||0,"):"]}),a.jsxs("div",{className:"flex flex-wrap gap-1 max-h-20 overflow-y-auto",children:[(T=E.quyens)==null?void 0:T.slice(0,8).map(J=>a.jsx("span",{className:"px-1.5 py-0.5 bg-gray-100 text-gray-600 text-xs rounded",children:J.quyen.tenQuyen},J.id)),(((D=E.quyens)==null?void 0:D.length)||0)>8&&a.jsxs("span",{className:"px-1.5 py-0.5 bg-gray-200 text-gray-700 text-xs rounded",children:["+",(((I=E.quyens)==null?void 0:I.length)||0)-8," quyn"]})]})]})]},E.id)})}),c&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:d==="nguoi-dung"?"Thm Ngi dng":"Thm Vai tr"}),d==="nguoi-dung"?a.jsxs("form",{onSubmit:y,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn ng nhp *"}),a.jsx("input",{type:"text",value:p.tenDangNhap,onChange:E=>m({...p,tenDangNhap:E.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mt khu *"}),a.jsx("input",{type:"password",value:p.matKhau,onChange:E=>m({...p,matKhau:E.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"H tn *"}),a.jsx("input",{type:"text",value:p.hoTen,onChange:E=>m({...p,hoTen:E.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),a.jsx("input",{type:"email",value:p.email,onChange:E=>m({...p,email:E.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vai tr"}),a.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:r.map(E=>a.jsxs("label",{className:"flex items-center gap-1",children:[a.jsx("input",{type:"checkbox",checked:p.vaiTroIds.includes(E.id),onChange:()=>C(E.id),className:"rounded"}),a.jsx("span",{className:"text-sm",children:E.tenVaiTro})]},E.id))})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>u(!1),className:"px-4 py-2 border rounded-lg",children:"Hy"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:"To"})]})]}):a.jsxs("form",{onSubmit:N,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M vai tr *"}),a.jsx("input",{type:"text",value:g.maVaiTro,onChange:E=>b({...g,maVaiTro:E.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: SUPERVISOR",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn vai tr *"}),a.jsx("input",{type:"text",value:g.tenVaiTro,onChange:E=>b({...g,tenVaiTro:E.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cp "}),a.jsx("input",{type:"number",value:g.capDo,onChange:E=>b({...g,capDo:Number(E.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:1,max:100})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),a.jsx("textarea",{value:g.moTa,onChange:E=>b({...g,moTa:E.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>u(!1),className:"px-4 py-2 border rounded-lg",children:"Hy"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:"To"})]})]})]})})]})}const qf={TAO:{label:"To mi",color:"bg-green-100 text-green-700",icon:""},SUA:{label:"Cp nht",color:"bg-blue-100 text-blue-700",icon:""},XOA:{label:"Xa",color:"bg-red-100 text-red-700",icon:""},XEM:{label:"Xem",color:"bg-gray-100 text-gray-700",icon:""},DANG_NHAP:{label:"ng nhp",color:"bg-indigo-100 text-indigo-700",icon:""},DANG_XUAT:{label:"ng xut",color:"bg-purple-100 text-purple-700",icon:""},CHOT:{label:"Cht",color:"bg-yellow-100 text-yellow-700",icon:""},MO_KHOA:{label:"M kha",color:"bg-cyan-100 text-cyan-700",icon:""},DUYET:{label:"Duyt",color:"bg-emerald-100 text-emerald-700",icon:""},TU_CHOI:{label:"T chi",color:"bg-orange-100 text-orange-700",icon:""}};function z3(){var _,C;const[e,t]=P.useState([]),[r,n]=P.useState(!0),[s,l]=P.useState(null),[c,u]=P.useState(""),[d,f]=P.useState(""),[p,m]=P.useState(""),[g,b]=P.useState("");P.useEffect(()=>{v()},[c,d,p,g]);const v=async()=>{n(!0);try{const S=await tE.layDanhSach({hanhDong:c||void 0,bangDuLieu:d||void 0,tuNgay:p||void 0,denNgay:g||void 0}),E=Array.isArray(S)?S:(S==null?void 0:S.items)||[];t(E)}catch(S){console.error("Li ti d liu:",S)}finally{n(!1)}},y=S=>new Date(S).toLocaleString("vi-VN"),N=S=>S?JSON.stringify(S,null,2):null;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Audit Log"}),a.jsx("p",{className:"text-gray-500 mt-1",children:"Lch s thao tc trn h thng"})]}),a.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hnh ng"}),a.jsxs("select",{value:c,onChange:S=>u(S.target.value),className:"w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"",children:"Tt c"}),Object.entries(qf).map(([S,{label:E}])=>a.jsx("option",{value:S,children:E},S))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bng d liu"}),a.jsxs("select",{value:d,onChange:S=>f(S.target.value),className:"w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"",children:"Tt c"}),a.jsx("option",{value:"NhanVien",children:"Nhn vin"}),a.jsx("option",{value:"BangLuong",children:"Bng lng"}),a.jsx("option",{value:"KhoanLuong",children:"Khon lng"}),a.jsx("option",{value:"PhongBan",children:"Phng ban"}),a.jsx("option",{value:"NguoiDung",children:"Ngi dng"}),a.jsx("option",{value:"DanhGiaKPI",children:"nh gi KPI"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T ngy"}),a.jsx("input",{type:"date",value:p,onChange:S=>m(S.target.value),className:"w-full border rounded-lg px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n ngy"}),a.jsx("input",{type:"date",value:g,onChange:S=>b(S.target.value),className:"w-full border rounded-lg px-3 py-2"})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:r?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):e.length===0?a.jsx("div",{className:"p-12 text-center text-gray-500",children:"Khng c d liu audit log"}):a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thi gian"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngi dng"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Hnh ng"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Bng d liu"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ID bn ghi"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Chi tit"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(S=>{const E=qf[S.hanhDong]||{label:S.hanhDong,color:"bg-gray-100",icon:""};return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:y(S.ngayTao)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:S.nguoiDung?a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:a.jsx("span",{className:"text-blue-600 text-xs font-medium",children:S.nguoiDung.hoTen.charAt(0)})}),a.jsx("span",{className:"ml-2 text-sm text-gray-900",children:S.nguoiDung.hoTen})]}):a.jsx("span",{className:"text-gray-400 text-sm",children:"H thng"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("span",{className:`px-2 py-1 text-xs rounded ${E.color}`,children:[E.icon," ",E.label]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:S.bangDuLieu||"-"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 font-mono",children:S.banGhiId||"-"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(S.duLieuCu||S.duLieuMoi)&&a.jsx("button",{onClick:()=>l(S),className:"text-blue-600 hover:text-blue-800 text-sm",children:"Xem chi tit"})})]},S.id)})})]})}),s&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-3xl max-h-[80vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Chi tit thay i"}),a.jsx("button",{onClick:()=>l(null),className:"text-gray-400 hover:text-gray-600",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Thi gian:"})," ",y(s.ngayTao)]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Ngi dng:"})," ",((_=s.nguoiDung)==null?void 0:_.hoTen)||"H thng"]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Hnh ng:"})," ",(C=qf[s.hanhDong])==null?void 0:C.label]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Bng:"})," ",s.bangDuLieu," #",s.banGhiId]}),s.ipAddress&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"IP:"})," ",s.ipAddress]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.duLieuCu&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-red-600 mb-2",children:"D liu c"}),a.jsx("pre",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-xs overflow-x-auto",children:N(s.duLieuCu)})]}),s.duLieuMoi&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-green-600 mb-2",children:"D liu mi"}),a.jsx("pre",{className:"bg-green-50 border border-green-200 rounded-lg p-3 text-xs overflow-x-auto",children:N(s.duLieuMoi)})]})]})]})})]})}const K3="tinh_luong_auth",yt=Xt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});yt.interceptors.request.use(e=>{const t=localStorage.getItem(K3);if(t)try{const r=JSON.parse(t);r.token&&(e.headers.Authorization=`Bearer ${r.token}`)}catch{}return e},e=>Promise.reject(e));const ns={layDanhSach:e=>yt.get("/quy-che-luong",{params:e}).then(t=>t.data),layChiTiet:e=>yt.get(`/quy-che-luong/${e}`).then(t=>t.data),tao:e=>yt.post("/quy-che-luong",e).then(t=>t.data),capNhat:(e,t)=>yt.put(`/quy-che-luong/${e}`,t).then(r=>r.data),nhanBan:(e,t)=>yt.post(`/quy-che-luong/${e}/nhan-ban`,t).then(r=>r.data),kichHoat:e=>yt.post(`/quy-che-luong/${e}/kich-hoat`).then(t=>t.data),ngung:e=>yt.post(`/quy-che-luong/${e}/ngung`).then(t=>t.data),xoa:e=>yt.delete(`/quy-che-luong/${e}`).then(t=>t.data),layRules:e=>yt.get(`/quy-che-luong/${e}/rules`).then(t=>t.data),taoRule:(e,t)=>yt.post(`/quy-che-luong/${e}/rule`,t).then(r=>r.data),sapXepRules:(e,t)=>yt.put(`/quy-che-luong/${e}/sap-xep-rule`,{danhSachRuleId:t}).then(r=>r.data)},Sc={layChiTiet:e=>yt.get(`/quy-che-rule/${e}`).then(t=>t.data),capNhat:(e,t)=>yt.put(`/quy-che-rule/${e}`,t).then(r=>r.data),xoa:e=>yt.delete(`/quy-che-rule/${e}`).then(t=>t.data),validate:e=>yt.post("/quy-che-rule/validate",e).then(t=>t.data),preview:e=>yt.post("/quy-che-rule/preview",e).then(t=>t.data)},Li={layDanhSach:e=>yt.get("/su-kien-thuong-phat",{params:e}).then(t=>t.data),layChiTiet:e=>yt.get(`/su-kien-thuong-phat/${e}`).then(t=>t.data),tao:e=>yt.post("/su-kien-thuong-phat",e).then(t=>t.data),capNhat:(e,t)=>yt.put(`/su-kien-thuong-phat/${e}`,t).then(r=>r.data),duyet:(e,t)=>yt.post(`/su-kien-thuong-phat/${e}/duyet`,{duyetBoi:t.duyetBoi||"admin",ghiChu:t.lyDo}).then(r=>r.data),duyetNhieu:e=>yt.post("/su-kien-thuong-phat/duyet-nhieu",{ids:e.danhSachId,duyetBoi:e.duyetBoi||"admin"}).then(t=>t.data),huy:e=>yt.post(`/su-kien-thuong-phat/${e}/huy`).then(t=>t.data),thongKe:(e,t,r)=>yt.get(`/su-kien-thuong-phat/thong-ke/${e}`,{params:{thang:t,nam:r}}).then(n=>n.data),layDanhMucSuKien:e=>yt.get("/su-kien-thuong-phat/danh-muc",{params:{loai:e}}).then(t=>t.data),taoDanhMucSuKien:e=>yt.post("/su-kien-thuong-phat/danh-muc",e).then(t=>t.data),khoiTaoDanhMucMau:()=>yt.post("/su-kien-thuong-phat/khoi-tao-danh-muc-mau").then(e=>e.data)},$3={chay:(e,t)=>yt.post(`/bang-luong/${e}/chay-rule-engine`,{nguoiThucHien:t}).then(r=>r.data),xemTrace:(e,t)=>yt.get(`/bang-luong/${e}/rule-trace`,{params:t?{nhanVienId:t}:void 0}).then(r=>r.data)},Cc={goiYRule:(e,t,r)=>yt.post("/tro-ly-ai/goi-y-rule",{phongBanId:e,quyCheId:t,noiDungTiengViet:r}).then(n=>n.data),layContext:(e,t)=>yt.get(`/tro-ly-ai/context/${e}/${t}`).then(r=>r.data),apDungRule:(e,t,r)=>yt.post(`/tro-ly-ai/ap-dung/${e}`,{auditId:t,ruleDeXuat:r}).then(n=>n.data),huyDeXuat:e=>yt.post(`/tro-ly-ai/huy/${e}`).then(t=>t.data),lichSuDeXuat:e=>yt.get(`/tro-ly-ai/lich-su/${e}`).then(t=>t.data)},W3=({trangThai:e})=>{const r={NHAP:{bg:"bg-gray-100",text:"text-gray-800",label:"Nhp"},HIEU_LUC:{bg:"bg-green-100",text:"text-green-800",label:"Hiu lc"},TAM_DUNG:{bg:"bg-yellow-100",text:"text-yellow-800",label:"Tm dng"},NGUNG:{bg:"bg-red-100",text:"text-red-800",label:"Ngng"}}[e];return a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${r.bg} ${r.text}`,children:r.label})};function G3(){const e=fi(),[t,r]=P.useState([]),[n,s]=P.useState([]),[l,c]=P.useState(!1),[u,d]=P.useState(""),[f,p]=P.useState(!1),[m,g]=P.useState({phongBanId:0,tenQuyChe:"",moTa:"",tuNgay:new Date().toISOString().split("T")[0]});P.useEffect(()=>{b(),v()},[u]);const b=async()=>{try{const O=await ga.layTatCa();s(O)}catch(O){console.error("Li load phng ban:",O)}},v=async()=>{c(!0);try{const O=u?{phongBanId:u}:{},F=await ns.layDanhSach(O);r(F)}catch(O){console.error("Li load quy ch:",O)}finally{c(!1)}},y=async()=>{if(!m.phongBanId||!m.tenQuyChe||!m.tuNgay){alert("Vui lng nhp y  thng tin");return}try{await ns.tao({phongBanId:m.phongBanId,tenQuyChe:m.tenQuyChe,moTa:m.moTa,tuNgay:new Date(m.tuNgay)}),p(!1),g({phongBanId:0,tenQuyChe:"",moTa:"",tuNgay:new Date().toISOString().split("T")[0]}),v()}catch(O){console.error("Li to quy ch:",O),alert("Li to quy ch")}},N=async O=>{if(confirm("Kch hot quy ch ny? Cc quy ch khc cng phng ban s b ngng."))try{await ns.kichHoat(O),v()}catch(F){console.error("Li kch hot:",F),alert("Li kch hot quy ch")}},_=async O=>{if(confirm("Ngng quy ch ny?"))try{await ns.ngung(O),v()}catch(F){console.error("Li ngng:",F),alert("Li ngng quy ch")}},C=async(O,F)=>{const T=prompt("Tn quy ch mi:",`${F} (v2)`);if(T)try{const D=await ns.nhanBan(O,{tenQuyChe:T,tuNgay:new Date});e(`/quy-che/${D.id}`)}catch(D){console.error("Li nhn bn:",D),alert("Li nhn bn quy ch")}},S=async O=>{if(confirm("Xa quy ch ny? Ch c th xa quy ch ang  trng thi Nhp."))try{await ns.xoa(O),v()}catch(F){console.error("Li xa:",F),alert("Khng th xa quy ch ny")}},E=t.reduce((O,F)=>{var D;const T=((D=F.phongBan)==null?void 0:D.tenPhongBan)||"Khc";return O[T]||(O[T]=[]),O[T].push(F),O},{});return a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Quy ch lng"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Cu hnh quy ch lng theo phng ban vi cc rule t ng"})]}),a.jsxs("button",{onClick:()=>p(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"To quy ch mi"]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:a.jsx("div",{className:"flex items-center gap-4",children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),a.jsxs("select",{value:u,onChange:O=>d(O.target.value?Number(O.target.value):""),className:"border rounded-lg px-3 py-2 min-w-[200px]",children:[a.jsx("option",{value:"",children:"Tt c phng ban"}),n.map(O=>a.jsx("option",{value:O.id,children:O.tenPhongBan},O.id))]})]})})}),l&&a.jsx("div",{className:"text-center py-10",children:a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}),!l&&a.jsxs("div",{className:"space-y-6",children:[Object.entries(E).map(([O,F])=>a.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b",children:a.jsx("h2",{className:"font-semibold text-gray-900",children:O})}),a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tn quy ch"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Phin bn"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"S rule"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"T ngy"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:F.map(T=>{var D;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsxs("td",{className:"px-4 py-3",children:[a.jsx("button",{onClick:()=>e(`/quy-che/${T.id}`),className:"text-blue-600 hover:text-blue-800 font-medium",children:T.tenQuyChe}),T.moTa&&a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:T.moTa})]}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-sm",children:["v",T.phienBan]})}),a.jsx("td",{className:"px-4 py-3 text-center",children:((D=T._count)==null?void 0:D.rules)||0}),a.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-600",children:new Date(T.tuNgay).toLocaleDateString("vi-VN")}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx(W3,{trangThai:T.trangThai})}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx("button",{onClick:()=>e(`/quy-che/${T.id}`),className:"p-1 text-gray-400 hover:text-blue-600",title:"Cu hnh",children:a.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),T.trangThai==="NHAP"&&a.jsx("button",{onClick:()=>N(T.id),className:"p-1 text-gray-400 hover:text-green-600",title:"Kch hot",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),T.trangThai==="HIEU_LUC"&&a.jsx("button",{onClick:()=>_(T.id),className:"p-1 text-gray-400 hover:text-yellow-600",title:"Ngng",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),a.jsx("button",{onClick:()=>C(T.id,T.tenQuyChe),className:"p-1 text-gray-400 hover:text-purple-600",title:"Nhn bn",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),T.trangThai==="NHAP"&&a.jsx("button",{onClick:()=>S(T.id),className:"p-1 text-gray-400 hover:text-red-600",title:"Xa",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},T.id)})})]})]},O)),Object.keys(E).length===0&&a.jsx("div",{className:"bg-white rounded-lg shadow p-10 text-center text-gray-500",children:'Cha c quy ch no. Bm "To quy ch mi"  bt u.'})]}),f&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[a.jsx("div",{className:"px-6 py-4 border-b",children:a.jsx("h3",{className:"text-lg font-semibold",children:"To quy ch mi"})}),a.jsxs("div",{className:"px-6 py-4 space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Phng ban ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{value:m.phongBanId,onChange:O=>g({...m,phongBanId:Number(O.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:0,children:"-- Chn phng ban --"}),n.map(O=>a.jsx("option",{value:O.id,children:O.tenPhongBan},O.id))]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn quy ch ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:m.tenQuyChe,onChange:O=>g({...m,tenQuyChe:O.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Quy ch lng phng Kho 2026"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),a.jsx("textarea",{value:m.moTa,onChange:O=>g({...m,moTa:O.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:3,placeholder:"M t quy ch..."})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["p dng t ngy ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"date",value:m.tuNgay,onChange:O=>g({...m,tuNgay:O.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),a.jsxs("div",{className:"px-6 py-4 border-t flex justify-end gap-3",children:[a.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),a.jsx("button",{onClick:y,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To quy ch"})]})]})})]})}const q3=["Pht i tr: 1-2 ln 50k/ln, t ln 3 tr ln 100k/ln","Trch nhim kho: cp 1 500k, cp 2 1tr, cp 3 1.5tr","Tin trch nhim = lng c bn * 0.15","Thng chuyn cn: 200k/thng nu khng ngh","Ph cp trch nhim c nh 500k/thng"],Xf={CO_DINH:"C nh",THEO_HE_SO:"Theo h s",BAC_THANG:"Bc thang",THEO_SU_KIEN:"Theo s kin",CONG_THUC:"Cng thc"},iy={CONG_DON:"Cng dn",GHI_DE:"Ghi "};function X3({isOpen:e,onClose:t,phongBanId:r,quyCheId:n,onRuleApplied:s}){const l=P.useRef(null),c=P.useRef(null),[u,d]=P.useState(""),[f,p]=P.useState(!1),[m,g]=P.useState(null),[b,v]=P.useState(null),[y,N]=P.useState(!1),[_,C]=P.useState(!1),[S,E]=P.useState(null),[O,F]=P.useState(!1),[T,D]=P.useState(null),[I,J]=P.useState(!1),[Z,ee]=P.useState(null),[ne,he]=P.useState("goi-y"),[Q,xe]=P.useState(!1),[Y,le]=P.useState(!1),[X,ve]=P.useState(!1),[K,k]=P.useState({luongCoBan:1e7,capTrachNhiem:2,heSoTrachNhiem:1.2,soLanDiTre:3,soLanNghiKhongPhep:0});P.useEffect(()=>{e&&r&&n&&(Cc.layContext(r,n).then(v).catch(console.error),setTimeout(()=>{var Ne;return(Ne=l.current)==null?void 0:Ne.focus()},100))},[e,r,n]),P.useEffect(()=>{e||(d(""),g(null),E(null),D(null),ee(null),J(!1),xe(!1),le(!1),ve(!1))},[e]);const B=P.useCallback(Ne=>{e&&(Ne.key==="Escape"&&t(),(Ne.ctrlKey||Ne.metaKey)&&Ne.key==="Enter"&&u.trim()&&!f&&Ne.preventDefault())},[e,u,f,t]);P.useEffect(()=>(document.addEventListener("keydown",B),()=>document.removeEventListener("keydown",B)),[B]);const A=async()=>{if(u.trim()){p(!0),g(null),E(null),D(null);try{const Ne=await Cc.goiYRule(r,n,u);g(Ne),Ne.ruleDeXuat&&ee({...Ne.ruleDeXuat})}catch(Ne){console.error("Li gi  rule:",Ne),g({hopLeSoBo:!1,canLamRo:["C li xy ra khi x l yu cu. Vui lng th li."]})}finally{p(!1)}}},M=async()=>{if(!Z)return;const Ne=we();if(Ne.length>0){E({hopLe:!1,loi:["[Client] "+Ne.join(", [Client] ")]});return}C(!0);try{const He=await Sc.validate({loaiRule:Z.loaiRule,dieuKienJson:Z.dieuKienJson,congThucJson:Z.congThucJson});E({hopLe:He.hopLe,loi:He.danhSachLoi||[]})}catch(He){console.error("Li validate:",He),E({hopLe:!1,loi:["C li xy ra khi validate server"]})}finally{C(!1)}},ae=async()=>{if(Z){F(!0);try{const Ne=await Sc.preview({quyCheId:n,duLieuGiaLap:K});D({soTien:Ne.tongTien,trace:Ne.trace.map(He=>`${He.ruleName}: ${He.message}  ${He.output.toLocaleString("vi-VN")}`).join(`
`)})}catch(Ne){console.error("Li preview:",Ne)}finally{F(!1)}}},de=async()=>{if(Z)try{await navigator.clipboard.writeText(JSON.stringify(Z,null,2)),ve(!0),setTimeout(()=>ve(!1),2e3)}catch(Ne){console.error("Li copy:",Ne)}},be=()=>{m!=null&&m.ruleDeXuat&&ee({...m.ruleDeXuat})},we=()=>{const Ne=[];if(!Z)return["Khng c rule  validate"];(!Z.tenRule||Z.tenRule.trim().length<3)&&Ne.push("Tn rule phi c t nht 3 k t"),Z.khoanLuongMa||Ne.push("Cha chn khon lng");const He=Z.congThucJson;switch(Z.loaiRule){case"CO_DINH":(!He.soTien||He.soTien<=0)&&Ne.push("S tin c nh phi ln hn 0");break;case"THEO_HE_SO":He.base||Ne.push("Cha chn ngun tnh (base)"),(!He.heSo||He.heSo<=0)&&Ne.push("H s phi ln hn 0");break;case"BAC_THANG":{const ht=He.bac;!ht||ht.length===0?Ne.push("Phi c t nht 1 bc thang"):ht.forEach((rt,Oe)=>{(rt.from===void 0||rt.to===void 0)&&Ne.push(`Bc ${Oe+1}: Cha nh ngha khong from-to`),!rt.soTien&&!rt.soTienMoiLan&&Ne.push(`Bc ${Oe+1}: Cha nh ngha s tin`)})}break;case"CONG_THUC":(!He.bieuThuc||He.bieuThuc.trim().length===0)&&Ne.push("Cha nhp biu thc cng thc");break;case"THEO_SU_KIEN":He.maSuKien||Ne.push("Cha chn m s kin");break}return Ne},ye=async()=>{if(!(m!=null&&m.auditId)||!Z)return;const Ne=we();if(Ne.length>0){E({hopLe:!1,loi:Ne}),alert(`Vui lng sa cc li trc khi p dng:

`+Ne.join(`
`));return}if(confirm(`Xc nhn p dng rule "${Z.tenRule}"?

Loi: ${Xf[Z.loaiRule]}
Khon lng: ${Z.khoanLuongMa}`)){N(!0);try{await Cc.apDungRule(n,m.auditId,Z),alert("  p dng rule thnh cng!"),s(),t()}catch(ht){console.error("Li p dng rule:",ht);const rt=ht instanceof Error?ht.message:"Li khng xc nh";alert(` C li khi p dng rule: ${rt}`)}finally{N(!1)}}},Je=Ne=>{d(Ne)},G=Ne=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(Ne);return e?a.jsxs("div",{className:"fixed inset-0 z-50 flex overflow-hidden",children:[a.jsx("div",{className:"flex-1 bg-black/50 backdrop-blur-sm animate-fadeIn",onClick:t}),a.jsxs("div",{ref:c,className:"w-[600px] max-w-full bg-white shadow-2xl flex flex-col h-full animate-slideInRight",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 text-white shadow-lg",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:a.jsx(sS,{className:"h-6 w-6"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"font-semibold text-lg",children:"Tr l AI gi  Rule"}),a.jsx("p",{className:"text-sm text-white/80",children:"Nhp ting Vit  To rule t ng"})]})]}),a.jsx("button",{onClick:t,className:"p-2 hover:bg-white/20 rounded-lg transition-all hover:rotate-90",title:"ng (Escape)",children:a.jsx(rl,{className:"h-5 w-5"})})]}),a.jsxs("div",{className:"flex border-b bg-gray-50",children:[a.jsxs("button",{onClick:()=>he("goi-y"),className:`flex-1 py-3 text-sm font-medium transition-all ${ne==="goi-y"?"border-b-2 border-blue-600 text-blue-600 bg-white":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[a.jsx(xS,{className:"h-4 w-4 inline mr-2"}),"Gi  Rule"]}),a.jsxs("button",{onClick:()=>he("lich-su"),className:`flex-1 py-3 text-sm font-medium transition-all ${ne==="lich-su"?"border-b-2 border-blue-600 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[a.jsx(Ph,{className:"h-4 w-4 inline mr-2"}),"Lch s"]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[ne==="goi-y"&&a.jsxs(a.Fragment,{children:[b&&a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-sm",children:[a.jsx("div",{className:"font-medium text-gray-700 mb-2",children:"Ng cnh hin ti:"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-gray-600",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Phng ban:"})," ",a.jsx("span",{className:"font-medium",children:b.phongBan.tenPhongBan})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Quy ch:"})," ",a.jsxs("span",{className:"font-medium",children:["v",b.quyChe.phienBan]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Khon lng:"})," ",a.jsxs("span",{className:"font-medium",children:[b.khoanLuongs.length," khon"]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"S kin:"})," ",a.jsxs("span",{className:"font-medium",children:[b.danhMucSuKien.length," mc"]})]})]})]}),a.jsxs("div",{className:"animate-slideInUp",children:[a.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:" Mu gi :"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:q3.map((Ne,He)=>a.jsx("button",{onClick:()=>Je(Ne),className:"text-xs px-3 py-1.5 bg-blue-50 text-blue-700 rounded-full hover:bg-blue-100 hover:scale-105 transition-all",children:Ne.length>40?Ne.substring(0,37)+"...":Ne},He))})]}),a.jsxs("div",{className:"animate-slideInUp",style:{animationDelay:"0.1s"},children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" M t bng ting Vit:"}),a.jsx("textarea",{ref:l,value:u,onChange:Ne=>d(Ne.target.value),onKeyDown:Ne=>{(Ne.ctrlKey||Ne.metaKey)&&Ne.key==="Enter"&&(Ne.preventDefault(),u.trim()&&!f&&A())},placeholder:"V d: Pht i tr 1-2 ln 50k/ln, t ln 3 tr ln 100k/ln",className:"w-full h-28 px-3 py-2 border rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",disabled:f}),a.jsxs("div",{className:"flex items-center justify-between mt-1",children:[a.jsx("span",{className:"text-xs text-gray-400",children:"/Ctrl + Enter  gi"}),a.jsxs("span",{className:"text-xs text-gray-400",children:[u.length," k t"]})]}),a.jsx("button",{onClick:A,disabled:!u.trim()||f,className:"mt-2 w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-md hover:shadow-lg",children:f?a.jsxs(a.Fragment,{children:[a.jsx(Mn,{className:"h-4 w-4 animate-spin"}),"ang x l..."]}):a.jsxs(a.Fragment,{children:[a.jsx(bS,{className:"h-4 w-4"}),"To  xut"]})})]}),m&&a.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[a.jsxs("div",{className:`p-3 flex items-center gap-2 ${m.hopLeSoBo?"bg-green-50":"bg-yellow-50"}`,children:[m.hopLeSoBo?a.jsx(ah,{className:"h-5 w-5 text-green-600"}):a.jsx(dS,{className:"h-5 w-5 text-yellow-600"}),a.jsx("span",{className:`font-medium ${m.hopLeSoBo?"text-green-700":"text-yellow-700"}`,children:m.hopLeSoBo?" to  xut thnh cng":"Cn lm r thm"})]}),m.canLamRo.length>0&&a.jsxs("div",{className:"p-3 bg-yellow-50 border-t",children:[a.jsx("div",{className:"text-sm font-medium text-yellow-800 mb-2",children:"Cu hi:"}),a.jsx("ul",{className:"space-y-1",children:m.canLamRo.map((Ne,He)=>a.jsxs("li",{className:"text-sm text-yellow-700 flex items-start gap-2",children:[a.jsx("span",{children:""}),a.jsx("span",{children:Ne})]},He))})]}),m.ruleDeXuat&&Z&&a.jsxs("div",{className:"p-3 space-y-3",children:[m.tomTatRule&&a.jsxs("div",{className:"text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Tm tt:"})," ",a.jsx("span",{className:"font-medium",children:m.tomTatRule})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2 text-sm",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Loi rule:"})," ",a.jsx("span",{className:"font-medium text-blue-600",children:Xf[Z.loaiRule]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Ch  gp:"})," ",a.jsx("span",{className:"font-medium",children:iy[Z.cheDoGop]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Khon lng:"})," ",a.jsx("span",{className:"font-medium",children:Z.khoanLuongMa})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"u tin:"})," ",a.jsx("span",{className:"font-medium",children:Z.thuTuUuTien})]})]}),a.jsxs("div",{className:"pt-2 border-t flex items-center gap-2 flex-wrap",children:[a.jsxs("button",{onClick:()=>J(!I),className:"text-blue-600 hover:text-blue-800 text-sm flex items-center gap-1",children:[I?a.jsx(Rp,{className:"h-4 w-4"}):a.jsx(wb,{className:"h-4 w-4"}),I?"n JSON":"Xem JSON"]}),a.jsxs("button",{onClick:de,className:"text-gray-600 hover:text-gray-800 text-sm flex items-center gap-1",children:[a.jsx(oS,{className:"h-4 w-4"}),X?" copy!":"Copy JSON"]}),a.jsxs("button",{onClick:()=>xe(!Q),className:"text-purple-600 hover:text-purple-800 text-sm flex items-center gap-1",children:[a.jsx(yo,{className:"h-4 w-4"}),Q?"n form":"Chnh sa"]}),a.jsxs("button",{onClick:be,className:"text-orange-600 hover:text-orange-800 text-sm flex items-center gap-1",children:[a.jsx(kx,{className:"h-4 w-4"}),"Reset"]})]}),I&&a.jsx("pre",{className:"mt-2 p-2 bg-gray-800 text-green-400 rounded text-xs overflow-x-auto max-h-48",children:JSON.stringify(Z,null,2)}),Q&&a.jsxs("div",{className:"mt-2 p-3 bg-white border rounded-lg space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Tn rule"}),a.jsx("input",{type:"text",value:Z.tenRule,onChange:Ne=>ee({...Z,tenRule:Ne.target.value}),className:"w-full px-2 py-1.5 border rounded text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Loi rule"}),a.jsx("select",{value:Z.loaiRule,onChange:Ne=>ee({...Z,loaiRule:Ne.target.value}),className:"w-full px-2 py-1.5 border rounded text-sm",children:Object.entries(Xf).map(([Ne,He])=>a.jsx("option",{value:Ne,children:He},Ne))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Ch  gp"}),a.jsx("select",{value:Z.cheDoGop,onChange:Ne=>ee({...Z,cheDoGop:Ne.target.value}),className:"w-full px-2 py-1.5 border rounded text-sm",children:Object.entries(iy).map(([Ne,He])=>a.jsx("option",{value:Ne,children:He},Ne))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Th t u tin"}),a.jsx("input",{type:"number",value:Z.thuTuUuTien,onChange:Ne=>ee({...Z,thuTuUuTien:Number(Ne.target.value)}),className:"w-24 px-2 py-1.5 border rounded text-sm"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"choPhepChinhTay",checked:Z.choPhepChinhTay,onChange:Ne=>ee({...Z,choPhepChinhTay:Ne.target.checked})}),a.jsx("label",{htmlFor:"choPhepChinhTay",className:"text-sm text-gray-700",children:"Cho php chnh tay"})]})]})]}),m.giaiThich&&m.giaiThich.length>0&&a.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[a.jsx("div",{className:"text-sm font-medium text-blue-800 mb-1",children:"Gii thch:"}),a.jsx("ul",{className:"space-y-1",children:m.giaiThich.map((Ne,He)=>a.jsxs("li",{className:"text-sm text-blue-700 flex items-start gap-2",children:[a.jsx("span",{children:""}),a.jsx("span",{children:Ne})]},He))})]}),m.canhBao&&m.canhBao.length>0&&a.jsxs("div",{className:"bg-orange-50 rounded-lg p-3",children:[a.jsxs("div",{className:"text-sm font-medium text-orange-800 mb-1 flex items-center gap-1",children:[a.jsx(jc,{className:"h-4 w-4"}),"Cnh bo:"]}),a.jsx("ul",{className:"space-y-1",children:m.canhBao.map((Ne,He)=>a.jsxs("li",{className:"text-sm text-orange-700 flex items-start gap-2",children:[a.jsx("span",{children:""}),a.jsx("span",{children:Ne})]},He))})]}),S&&a.jsxs("div",{className:`rounded-lg p-3 ${S.hopLe?"bg-green-50":"bg-red-50"}`,children:[a.jsxs("div",{className:`text-sm font-medium mb-1 flex items-center gap-1 ${S.hopLe?"text-green-800":"text-red-800"}`,children:[S.hopLe?a.jsx(ah,{className:"h-4 w-4"}):a.jsx(jc,{className:"h-4 w-4"}),S.hopLe?"Validate thnh cng":"Validate tht bi"]}),S.loi.length>0&&a.jsx("ul",{className:"space-y-1",children:S.loi.map((Ne,He)=>a.jsxs("li",{className:"text-sm text-red-700 flex items-start gap-2",children:[a.jsx("span",{children:""}),a.jsx("span",{children:Ne})]},He))})]}),T&&a.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[a.jsx("div",{className:"text-sm font-medium text-purple-800 mb-1",children:"Preview (d liu gi lp):"}),a.jsx("div",{className:"text-lg font-bold text-purple-600",children:G(T.soTien)}),a.jsx("div",{className:"text-xs text-purple-600 mt-1",children:T.trace})]}),a.jsxs("div",{className:"border rounded-lg",children:[a.jsxs("button",{onClick:()=>le(!Y),className:"w-full px-3 py-2 flex items-center justify-between text-sm text-gray-600 hover:bg-gray-50",children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(yo,{className:"h-4 w-4"}),"Ci t d liu gi lp"]}),a.jsx("span",{children:Y?"":""})]}),Y&&a.jsx("div",{className:"p-3 border-t space-y-2",children:a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Lng c bn"}),a.jsx("input",{type:"number",value:K.luongCoBan,onChange:Ne=>k({...K,luongCoBan:Number(Ne.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"H s trch nhim"}),a.jsx("input",{type:"number",step:"0.1",value:K.heSoTrachNhiem,onChange:Ne=>k({...K,heSoTrachNhiem:Number(Ne.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Cp trch nhim"}),a.jsx("input",{type:"number",value:K.capTrachNhiem,onChange:Ne=>k({...K,capTrachNhiem:Number(Ne.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"S ln i tr"}),a.jsx("input",{type:"number",value:K.soLanDiTre,onChange:Ne=>k({...K,soLanDiTre:Number(Ne.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]})]})})]}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsxs("button",{onClick:M,disabled:_,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 disabled:opacity-50 transition",children:[_?a.jsx(Mn,{className:"h-4 w-4 animate-spin"}):a.jsx(ih,{className:"h-4 w-4"}),"Validate"]}),a.jsxs("button",{onClick:ae,disabled:O,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 border border-purple-600 text-purple-600 rounded-lg hover:bg-purple-50 disabled:opacity-50 transition",children:[O?a.jsx(Mn,{className:"h-4 w-4 animate-spin"}):a.jsx(Rp,{className:"h-4 w-4"}),"Preview"]}),a.jsxs("button",{onClick:ye,disabled:y,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition",children:[y?a.jsx(Mn,{className:"h-4 w-4 animate-spin"}):a.jsx(Ah,{className:"h-4 w-4"}),"p dng"]})]})]})]})]}),ne==="lich-su"&&a.jsx(Q3,{quyCheId:n,onTaiSuDung:Ne=>{d(Ne),he("goi-y")}})]})]})]}):null}function Q3({quyCheId:e,onTaiSuDung:t}){const[r,n]=P.useState([]),[s,l]=P.useState(!0);P.useEffect(()=>{Cc.lichSuDeXuat(e).then(n).catch(console.error).finally(()=>l(!1))},[e]);const c=async d=>{if(confirm("Hy  xut ny?"))try{await Cc.huyDeXuat(d),n(f=>f.map(p=>p.id===d?{...p,trangThai:"HUY"}:p))}catch(f){console.error("Li hy:",f)}};if(s)return a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx(Mn,{className:"h-6 w-6 animate-spin text-gray-400"})});if(r.length===0)return a.jsx("div",{className:"text-center py-8 text-gray-500",children:"Cha c lch s  xut no"});const u={DE_XUAT:{text:" xut",color:"bg-yellow-100 text-yellow-800"},DA_AP_DUNG:{text:" p dng",color:"bg-green-100 text-green-800"},HUY:{text:" hy",color:"bg-gray-100 text-gray-800"}};return a.jsx("div",{className:"space-y-3",children:r.map(d=>{var f,p;return a.jsxs("div",{className:"border rounded-lg p-3 hover:border-gray-300 transition",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"text-sm text-gray-500",children:[new Date(d.taoLuc).toLocaleString("vi-VN"),d.nguoiTao&&`  ${d.nguoiTao.hoTen}`]}),a.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${((f=u[d.trangThai])==null?void 0:f.color)||"bg-gray-100"}`,children:((p=u[d.trangThai])==null?void 0:p.text)||d.trangThai})]}),a.jsx("div",{className:"text-sm text-gray-700 line-clamp-2",children:d.promptGoc}),d.rule&&a.jsxs("div",{className:"mt-2 text-xs text-blue-600",children:[" Rule: ",d.rule.tenRule]}),a.jsxs("div",{className:"mt-2 flex gap-2",children:[a.jsxs("button",{onClick:()=>t==null?void 0:t(d.promptGoc),className:"text-xs text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[a.jsx(kx,{className:"h-3 w-3"}),"Ti s dng"]}),d.trangThai==="DE_XUAT"&&a.jsxs("button",{onClick:()=>c(d.id),className:"text-xs text-red-600 hover:text-red-800 flex items-center gap-1",children:[a.jsx(li,{className:"h-3 w-3"}),"Hy"]})]})]},d.id)})})}const Dx={CO_DINH:"C nh",THEO_HE_SO:"Theo h s",BAC_THANG:"Bc thang",THEO_SU_KIEN:"Theo s kin",CONG_THUC:"Cng thc"},Y3={CO_DINH:"bg-blue-100 text-blue-800",THEO_HE_SO:"bg-green-100 text-green-800",BAC_THANG:"bg-purple-100 text-purple-800",THEO_SU_KIEN:"bg-orange-100 text-orange-800",CONG_THUC:"bg-pink-100 text-pink-800"},J3=({rule:e,index:t,isSelected:r,onSelect:n,onDragStart:s,onDragOver:l,onDrop:c,isDragging:u})=>{var d;return a.jsx("div",{draggable:!0,onDragStart:s,onDragOver:l,onDrop:c,onClick:n,className:`
        p-3 rounded-lg border-2 cursor-pointer transition-all
        ${r?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}
        ${u?"opacity-50":""}
      `,children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"cursor-grab text-gray-400 hover:text-gray-600 mt-1",children:a.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{d:"M7 2a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 2zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 8zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 14zm6-8a2 2 0 1 0-.001-4.001A2 2 0 0 0 13 6zm0 2a2 2 0 1 0 .001 4.001A2 2 0 0 0 13 8zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 13 14z"})})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsxs("span",{className:"text-xs font-medium text-gray-500",children:["#",t+1]}),a.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${Y3[e.loaiRule]}`,children:Dx[e.loaiRule]})]}),a.jsx("h4",{className:"font-medium text-gray-900 truncate",children:e.tenRule}),a.jsx("p",{className:"text-sm text-gray-500 truncate mt-1",children:(d=e.khoanLuong)==null?void 0:d.tenKhoan})]}),a.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${e.trangThai?"bg-green-500":"bg-gray-300"}`})]})})},Z3=({value:e,onChange:t})=>a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S tin c nh"}),a.jsx("input",{type:"number",value:e.soTien||"",onChange:r=>t({soTien:Number(r.target.value)}),className:"w-full border rounded-lg px-3 py-2",placeholder:"1000000"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.soTien?new Intl.NumberFormat("vi-VN").format(e.soTien)+"":""})]}),e6=({value:e,onChange:t})=>a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Base (ngun tnh)"}),a.jsxs("select",{value:e.base||"",onChange:r=>t({...e,base:r.target.value,heSo:e.heSo||1}),className:"w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"",children:"-- Chn --"}),a.jsx("option",{value:"LUONG_CO_BAN",children:"Lng c bn"}),a.jsx("option",{value:"HE_SO_TRACH_NHIEM",children:"H s trch nhim"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"H s"}),a.jsx("input",{type:"number",step:"0.01",value:e.heSo||"",onChange:r=>t({...e,base:e.base||"LUONG_CO_BAN",heSo:Number(r.target.value)}),className:"w-full border rounded-lg px-3 py-2",placeholder:"0.2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cng thm (ty chn)"}),a.jsx("input",{type:"number",value:e.congThem||"",onChange:r=>t({...e,base:e.base||"LUONG_CO_BAN",heSo:e.heSo||1,congThem:Number(r.target.value)||void 0}),className:"w-full border rounded-lg px-3 py-2",placeholder:"200000"})]})]}),t6=({value:e,onChange:t})=>{const r=e.bac||[{from:1,to:1,soTien:0}],n=()=>{const c=r[r.length-1];t({field:e.field||"cap_trach_nhiem",bac:[...r,{from:((c==null?void 0:c.to)||0)+1,to:((c==null?void 0:c.to)||0)+1,soTien:0}]})},s=c=>{r.length<=1||t({field:e.field||"cap_trach_nhiem",bac:r.filter((u,d)=>d!==c)})},l=(c,u)=>{t({field:e.field||"cap_trach_nhiem",bac:r.map((d,f)=>f===c?{...d,...u}:d)})};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng d liu"}),a.jsxs("select",{value:e.field||"",onChange:c=>t({...e,field:c.target.value,bac:r}),className:"w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"",children:"-- Chn --"}),a.jsx("option",{value:"cap_trach_nhiem",children:"Cp trch nhim"}),a.jsx("option",{value:"he_so_trach_nhiem",children:"H s trch nhim"})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Bc thang"}),a.jsx("button",{type:"button",onClick:n,className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Thm bc"})]}),a.jsx("div",{className:"space-y-2",children:r.map((c,u)=>a.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded",children:[a.jsxs("span",{className:"text-sm text-gray-500 w-16",children:["Bc ",u+1]}),a.jsx("input",{type:"number",value:c.from,onChange:d=>l(u,{from:Number(d.target.value)}),className:"w-20 border rounded px-2 py-1 text-sm",placeholder:"T"}),a.jsx("span",{className:"text-gray-400",children:""}),a.jsx("input",{type:"number",value:c.to,onChange:d=>l(u,{to:Number(d.target.value)}),className:"w-20 border rounded px-2 py-1 text-sm",placeholder:"n"}),a.jsx("input",{type:"number",value:c.soTien||"",onChange:d=>l(u,{soTien:Number(d.target.value)}),className:"flex-1 border rounded px-2 py-1 text-sm",placeholder:"S tin"}),r.length>1&&a.jsx("button",{type:"button",onClick:()=>s(u),className:"text-red-500 hover:text-red-700",children:""})]},u))})]})]})},r6=({value:e,onChange:t})=>a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Biu thc cng thc"}),a.jsx("textarea",{value:e.bieuThuc||"",onChange:r=>t({bieuThuc:r.target.value}),className:"w-full border rounded-lg px-3 py-2 font-mono text-sm",rows:3,placeholder:"LUONG_CO_BAN * HE_SO_TRACH_NHIEM + 200000"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Bin cho php: LUONG_CO_BAN, HE_SO_TRACH_NHIEM, CAP_TRACH_NHIEM, CONG_CHUAN, CONG_THUC_TE, ..."})]});function n6(){var X,ve,K,k,B;const{id:e}=yx(),t=fi(),[r,n]=P.useState(null),[s,l]=P.useState([]),[c,u]=P.useState([]),[d,f]=P.useState(null),[p,m]=P.useState(!0),[g,b]=P.useState(!1),[v,y]=P.useState(null),[N,_]=P.useState(!1),[C,S]=P.useState(!1),[E,O]=P.useState(null),[F,T]=P.useState("thongtin"),[D,I]=P.useState({tenRule:"",moTa:"",khoanLuongId:0,loaiRule:"CO_DINH",congThucJson:{soTien:0},dieuKienJson:{},cheDoGop:"GHI_DE",choPhepChinhTay:!0});P.useEffect(()=>{e&&J()},[e]);const J=async()=>{m(!0);try{const[A,M]=await Promise.all([ns.layChiTiet(Number(e)),ta.layTatCa()]);n(A),l(A.rules||[]),u(M),A.rules&&A.rules.length>0&&Z(A.rules[0])}catch(A){console.error("Li load d liu:",A)}finally{m(!1)}},Z=A=>{f(A),I({tenRule:A.tenRule,moTa:A.moTa||"",khoanLuongId:A.khoanLuongId,loaiRule:A.loaiRule,congThucJson:JSON.parse(A.congThucJson),dieuKienJson:A.dieuKienJson?JSON.parse(A.dieuKienJson):{},cheDoGop:A.cheDoGop,choPhepChinhTay:A.choPhepChinhTay}),T("thongtin"),O(null)},ee=A=>{y(A)},ne=A=>{A.preventDefault()},he=async A=>{if(v===null||v===A){y(null);return}const M=[...s],[ae]=M.splice(v,1);M.splice(A,0,ae),l(M),y(null);try{await ns.sapXepRules(Number(e),M.map(de=>de.id))}catch(de){console.error("Li sp xp:",de),J()}},Q=async()=>{var A,M,ae;if(d){b(!0);try{await Sc.capNhat(d.id,{tenRule:D.tenRule,moTa:D.moTa,loaiRule:D.loaiRule,congThucJson:D.congThucJson,dieuKienJson:D.dieuKienJson,cheDoGop:D.cheDoGop,choPhepChinhTay:D.choPhepChinhTay}),J()}catch(de){console.error("Li lu rule:",de),alert(((ae=(M=(A=de.response)==null?void 0:A.data)==null?void 0:M.loi)==null?void 0:ae.join(`
`))||"Li lu rule")}finally{b(!1)}}},xe=async()=>{if(d&&confirm("Xa rule ny?"))try{await Sc.xoa(d.id),f(null),J()}catch(A){console.error("Li xa:",A),alert("Khng th xa rule ny")}},Y=async()=>{if(e)try{const A=await Sc.preview({quyCheId:Number(e),duLieuGiaLap:{LUONG_CO_BAN:1e7,CAP_TRACH_NHIEM:2,HE_SO_TRACH_NHIEM:1.2}});O(A),T("preview")}catch(A){console.error("Li preview:",A),alert("Li chy th")}},le=async A=>{try{let M={soTien:0};A.loaiRule==="THEO_HE_SO"?M={base:"LUONG_CO_BAN",heSo:.1}:A.loaiRule==="BAC_THANG"?M={field:"cap_trach_nhiem",bac:[{from:1,to:1,soTien:5e5}]}:A.loaiRule==="CONG_THUC"&&(M={bieuThuc:"LUONG_CO_BAN * 0.1"}),await ns.taoRule(Number(e),{khoanLuongId:A.khoanLuongId,tenRule:A.tenRule,loaiRule:A.loaiRule,congThucJson:M}),_(!1),J()}catch(M){console.error("Li thm rule:",M),alert("Li thm rule")}};return p?a.jsx("div",{className:"flex items-center justify-center h-96",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}):r?a.jsxs("div",{className:"h-screen flex flex-col",children:[a.jsx("div",{className:"bg-white border-b px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>t("/quy-che"),className:"p-2 hover:bg-gray-100 rounded",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-bold",children:r.tenQuyChe}),a.jsxs("p",{className:"text-sm text-gray-500",children:[(X=r.phongBan)==null?void 0:X.tenPhongBan,"  Phin bn ",r.phienBan]})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[!r.coDuocSua&&a.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded text-sm",children:" Quy ch  kho"}),a.jsx("button",{onClick:Y,className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Chy th"}),a.jsxs("button",{onClick:()=>S(!0),disabled:!r.coDuocSua,className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 disabled:opacity-50 flex items-center gap-2",children:[a.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73A2 2 0 0 1 12 2z"}),a.jsx("path",{d:"M9 14a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"}),a.jsx("path",{d:"M15 14a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"})]}),"Tr l AI"]}),a.jsx("button",{onClick:()=>_(!0),disabled:!r.coDuocSua,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"+ Thm rule"})]})]})}),a.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[a.jsxs("div",{className:"w-80 border-r bg-gray-50 flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b bg-white",children:[a.jsxs("h3",{className:"font-semibold text-gray-900",children:["Danh sch Rule (",s.length,")"]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ko th  sp xp th t u tin"})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[s.map((A,M)=>a.jsx(J3,{rule:A,index:M,isSelected:(d==null?void 0:d.id)===A.id,onSelect:()=>Z(A),onDragStart:()=>ee(M),onDragOver:ne,onDrop:()=>he(M),isDragging:v===M},A.id)),s.length===0&&a.jsxs("div",{className:"text-center text-gray-500 py-10",children:["Cha c rule no.",a.jsx("br",{}),a.jsx("button",{onClick:()=>_(!0),className:"text-blue-600 hover:underline mt-2",children:"Thm rule u tin"})]})]})]}),a.jsx("div",{className:"flex-1 flex flex-col bg-white overflow-hidden",children:d?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"border-b",children:a.jsx("nav",{className:"flex px-6",children:["thongtin","dieukien","congthuc","preview"].map(A=>a.jsx("button",{onClick:()=>T(A),className:`px-4 py-3 text-sm font-medium border-b-2 -mb-px ${F===A?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:{thongtin:"Thng tin",dieukien:"iu kin",congthuc:"Cch tnh",preview:"Xem th"}[A]},A))})}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[F==="thongtin"&&a.jsxs("div",{className:"space-y-4 max-w-lg",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn rule"}),a.jsx("input",{type:"text",value:D.tenRule,onChange:A=>I({...D,tenRule:A.target.value}),className:"w-full border rounded-lg px-3 py-2",disabled:!r.coDuocSua})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Khon lng"}),a.jsx("select",{value:D.khoanLuongId,onChange:A=>I({...D,khoanLuongId:Number(A.target.value)}),className:"w-full border rounded-lg px-3 py-2",disabled:!r.coDuocSua,children:c.map(A=>a.jsxs("option",{value:A.id,children:[A.tenKhoan," (",A.loai==="THU_NHAP"?"+":"-",")"]},A.id))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi rule"}),a.jsx("select",{value:D.loaiRule,onChange:A=>I({...D,loaiRule:A.target.value}),className:"w-full border rounded-lg px-3 py-2",disabled:!r.coDuocSua,children:Object.entries(Dx).map(([A,M])=>a.jsx("option",{value:A,children:M},A))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),a.jsx("textarea",{value:D.moTa,onChange:A=>I({...D,moTa:A.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:3,disabled:!r.coDuocSua})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:D.choPhepChinhTay,onChange:A=>I({...D,choPhepChinhTay:A.target.checked}),disabled:!r.coDuocSua}),a.jsx("span",{className:"text-sm",children:"Cho php chnh tay"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm",children:"Ch  gp:"}),a.jsxs("select",{value:D.cheDoGop,onChange:A=>I({...D,cheDoGop:A.target.value}),className:"border rounded px-2 py-1 text-sm",disabled:!r.coDuocSua,children:[a.jsx("option",{value:"GHI_DE",children:"Ghi "}),a.jsx("option",{value:"CONG_DON",children:"Cng dn"})]})]})]})]}),F==="dieukien"&&a.jsxs("div",{className:"max-w-lg space-y-4",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"iu kin p dng rule.  trng = p dng cho tt c nhn vin."}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vai tr"}),a.jsx("input",{type:"text",value:(((K=(ve=D.dieuKienJson)==null?void 0:ve.apDungCho)==null?void 0:K.vaiTro)||[]).join(", "),onChange:A=>{var M;return I({...D,dieuKienJson:{apDungCho:{...(M=D.dieuKienJson)==null?void 0:M.apDungCho,vaiTro:A.target.value?A.target.value.split(",").map(ae=>ae.trim()):void 0}}})},className:"w-full border rounded-lg px-3 py-2",placeholder:"TO_TRUONG, QUAN_LY",disabled:!r.coDuocSua}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Phn cch bng du phy"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cp trch nhim"}),a.jsx("input",{type:"text",value:(((B=(k=D.dieuKienJson)==null?void 0:k.apDungCho)==null?void 0:B.capTrachNhiem)||[]).join(", "),onChange:A=>{var M;return I({...D,dieuKienJson:{apDungCho:{...(M=D.dieuKienJson)==null?void 0:M.apDungCho,capTrachNhiem:A.target.value?A.target.value.split(",").map(ae=>Number(ae.trim())).filter(ae=>!isNaN(ae)):void 0}}})},className:"w-full border rounded-lg px-3 py-2",placeholder:"1, 2, 3",disabled:!r.coDuocSua})]})]}),F==="congthuc"&&a.jsxs("div",{className:"max-w-lg",children:[D.loaiRule==="CO_DINH"&&a.jsx(Z3,{value:D.congThucJson,onChange:A=>I({...D,congThucJson:A})}),D.loaiRule==="THEO_HE_SO"&&a.jsx(e6,{value:D.congThucJson,onChange:A=>I({...D,congThucJson:A})}),D.loaiRule==="BAC_THANG"&&a.jsx(t6,{value:D.congThucJson,onChange:A=>I({...D,congThucJson:A})}),D.loaiRule==="CONG_THUC"&&a.jsx(r6,{value:D.congThucJson,onChange:A=>I({...D,congThucJson:A})}),D.loaiRule==="THEO_SU_KIEN"&&a.jsx("div",{className:"text-gray-500",children:"Form s kin s c thm sau..."})]}),F==="preview"&&E&&a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"p-4 bg-blue-50 rounded-lg",children:a.jsxs("h4",{className:"font-semibold text-blue-900",children:["Tng tin: ",new Intl.NumberFormat("vi-VN").format(E.tongTien),""]})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium mb-2",children:"Chi tit"}),a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Khon lng"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm",children:"S tin"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Gii thch"})]})}),a.jsx("tbody",{children:E.chiTiet.map((A,M)=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-4 py-2",children:A.khoanLuong}),a.jsx("td",{className:"px-4 py-2 text-right font-mono",children:new Intl.NumberFormat("vi-VN").format(A.soTien)}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:A.giaiThich})]},M))})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium mb-2",children:"Trace"}),a.jsx("div",{className:"space-y-2",children:E.trace.map((A,M)=>a.jsxs("div",{className:"p-3 bg-gray-50 rounded text-sm",children:[a.jsx("div",{className:"font-medium",children:A.ruleName}),a.jsx("div",{className:"text-gray-600",children:A.message}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Output: ",new Intl.NumberFormat("vi-VN").format(A.output),""]})]},M))})]})]})]}),r.coDuocSua&&a.jsxs("div",{className:"border-t px-6 py-4 flex justify-between",children:[a.jsx("button",{onClick:xe,className:"px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg",children:"Xa rule"}),a.jsx("button",{onClick:Q,disabled:g,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:g?"ang lu...":"Lu thay i"})]})]}):a.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:"Chn mt rule  xem chi tit"})})]}),N&&a.jsx(a6,{khoanLuongs:c,onClose:()=>_(!1),onAdd:le}),a.jsx(X3,{isOpen:C,onClose:()=>S(!1),phongBanId:r.phongBanId,quyCheId:r.id,onRuleApplied:J})]}):a.jsx("div",{className:"p-6 text-center text-gray-500",children:"Khng tm thy quy ch"})}function a6({khoanLuongs:e,onClose:t,onAdd:r}){var l;const[n,s]=P.useState({khoanLuongId:((l=e[0])==null?void 0:l.id)||0,tenRule:"",loaiRule:"CO_DINH"});return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[a.jsx("div",{className:"px-6 py-4 border-b",children:a.jsx("h3",{className:"text-lg font-semibold",children:"Thm Rule mi"})}),a.jsxs("div",{className:"px-6 py-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn rule"}),a.jsx("input",{type:"text",value:n.tenRule,onChange:c=>s({...n,tenRule:c.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ph cp trch nhim t trng"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Khon lng"}),a.jsx("select",{value:n.khoanLuongId,onChange:c=>s({...n,khoanLuongId:Number(c.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:e.map(c=>a.jsxs("option",{value:c.id,children:[c.tenKhoan," (",c.loai==="THU_NHAP"?"+":"-",")"]},c.id))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi rule"}),a.jsx("select",{value:n.loaiRule,onChange:c=>s({...n,loaiRule:c.target.value}),className:"w-full border rounded-lg px-3 py-2",children:Object.entries(Dx).map(([c,u])=>a.jsx("option",{value:c,children:u},c))})]})]}),a.jsxs("div",{className:"px-6 py-4 border-t flex justify-end gap-3",children:[a.jsx("button",{onClick:t,className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),a.jsx("button",{onClick:()=>r(n),disabled:!n.tenRule||!n.khoanLuongId,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Thm rule"})]})]})})}const Qf={NHAP:{label:"Nhp",color:"bg-gray-100 text-gray-800"},DA_DUYET:{label:" duyt",color:"bg-green-100 text-green-800"},TU_CHOI:{label:"T chi",color:"bg-red-100 text-red-800"},HUY:{label:"Hu",color:"bg-gray-400 text-white"}},yc={THUONG:{label:"Thng",color:"bg-green-100 text-green-800",icon:""},PHAT:{label:"Pht",color:"bg-red-100 text-red-800",icon:""}};function s6(){const[e,t]=P.useState([]),[r,n]=P.useState([]),[s,l]=P.useState([]),[c,u]=P.useState([]),[d,f]=P.useState(!0),[p,m]=P.useState(!1),[g,b]=P.useState(!1),[v,y]=P.useState([]),[N,_]=P.useState({}),[C,S]=P.useState({nhanVienId:0,phongBanId:0,ngay:new Date().toISOString().split("T")[0],loaiSuKien:"THUONG",maSuKien:"",giaTri:1,soTien:0,ghiChu:""}),[E,O]=P.useState({maSuKien:"",tenSuKien:"",loai:"THUONG",moTa:"",soTienMacDinh:0});P.useEffect(()=>{F()},[]);const F=async()=>{f(!0);try{const Y={...N,tuNgay:N.tuNgay?new Date(N.tuNgay):void 0,denNgay:N.denNgay?new Date(N.denNgay):void 0},[le,X,ve,K]=await Promise.all([Li.layDanhSach(Y),Li.layDanhMucSuKien(),ga.layTatCa(),os.layTatCa()]);t(Array.isArray(le)?le:[]),n(X),l(ve);const k="data"in K?K.data:K;u(Array.isArray(k)?k:[])}catch(Y){console.error("Li load d liu:",Y)}finally{f(!1)}},T=()=>{F()},D=async()=>{try{await Li.tao({...C,ngay:new Date(C.ngay)}),m(!1),F(),ne()}catch(Y){console.error("Li to s kin:",Y),alert("Li to s kin")}},I=async Y=>{try{await Li.duyet(Y,{trangThai:"DA_DUYET"}),F()}catch(le){console.error("Li duyt:",le),alert("Li duyt s kin")}},J=async Y=>{const le=prompt("L do t chi:");if(le)try{await Li.duyet(Y,{trangThai:"TU_CHOI",lyDo:le}),F()}catch(X){console.error("Li t chi:",X)}},Z=async()=>{if(v.length!==0&&confirm(`Duyt ${v.length} s kin?`))try{await Li.duyetNhieu({danhSachId:v,trangThai:"DA_DUYET"}),y([]),F()}catch(Y){console.error("Li duyt nhiu:",Y)}},ee=async()=>{try{await Li.taoDanhMucSuKien(E),b(!1),F(),O({maSuKien:"",tenSuKien:"",loai:"THUONG",moTa:"",soTienMacDinh:0})}catch(Y){console.error("Li to danh mc:",Y),alert("Li to danh mc")}},ne=()=>{S({nhanVienId:0,phongBanId:0,ngay:new Date().toISOString().split("T")[0],loaiSuKien:"THUONG",maSuKien:"",giaTri:1,soTien:0,ghiChu:""})},he=Y=>{y(le=>le.includes(Y)?le.filter(X=>X!==Y):[...le,Y])},Q=()=>{const Y=e.filter(le=>le.trangThai==="NHAP").map(le=>le.id);v.length===Y.length?y([]):y(Y)},xe=Y=>{const le=r.find(X=>X.maSuKien===Y);S({...C,maSuKien:Y,loaiSuKien:(le==null?void 0:le.loai)||"THUONG",soTien:(le==null?void 0:le.soTienMacDinh)||0})};return d?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}):a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"S kin Thng/Pht"}),a.jsx("p",{className:"text-gray-500 mt-1",children:"Qun l cc s kin thng, pht cho nhn vin"})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>b(!0),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Danh mc s kin"}),a.jsxs("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[a.jsx(Ha,{size:18}),"Thm s kin"]})]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:a.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban"}),a.jsxs("select",{value:N.phongBanId||"",onChange:Y=>_({...N,phongBanId:Number(Y.target.value)||void 0}),className:"border rounded-lg px-3 py-2 w-48",children:[a.jsx("option",{value:"",children:"Tt c"}),s.map(Y=>a.jsx("option",{value:Y.id,children:Y.tenPhongBan},Y.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Loi"}),a.jsxs("select",{value:N.loaiSuKien||"",onChange:Y=>_({...N,loaiSuKien:Y.target.value||void 0}),className:"border rounded-lg px-3 py-2 w-32",children:[a.jsx("option",{value:"",children:"Tt c"}),a.jsx("option",{value:"THUONG",children:"Thng"}),a.jsx("option",{value:"PHAT",children:"Pht"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Trng thi"}),a.jsxs("select",{value:N.trangThai||"",onChange:Y=>_({...N,trangThai:Y.target.value||void 0}),className:"border rounded-lg px-3 py-2 w-32",children:[a.jsx("option",{value:"",children:"Tt c"}),Object.entries(Qf).map(([Y,{label:le}])=>a.jsx("option",{value:Y,children:le},Y))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"T ngy"}),a.jsx("input",{type:"date",value:N.tuNgay||"",onChange:Y=>_({...N,tuNgay:Y.target.value}),className:"border rounded-lg px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"n ngy"}),a.jsx("input",{type:"date",value:N.denNgay||"",onChange:Y=>_({...N,denNgay:Y.target.value}),className:"border rounded-lg px-3 py-2"})]}),a.jsxs("button",{onClick:T,className:"px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 flex items-center gap-2",children:[a.jsx(uS,{size:16}),"Lc"]})]})}),v.length>0&&a.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 mb-4 flex items-center justify-between",children:[a.jsxs("span",{className:"text-blue-800",children:[" chn ",v.length," s kin"]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:Z,className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 text-sm",children:"Duyt tt c"}),a.jsx("button",{onClick:()=>y([]),className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 text-sm",children:"B chn"})]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left w-10",children:a.jsx("input",{type:"checkbox",checked:e.filter(Y=>Y.trangThai==="NHAP").length>0&&v.length===e.filter(Y=>Y.trangThai==="NHAP").length,onChange:Q})}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Ngy"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Nhn vin"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Phng ban"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Loi"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M s kin"}),a.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"Gi tr"}),a.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"S tin"}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Trng thi"}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Thao tc"})]})}),a.jsxs("tbody",{children:[e.map(Y=>{var le,X,ve;return a.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3",children:Y.trangThai==="NHAP"&&a.jsx("input",{type:"checkbox",checked:v.includes(Y.id),onChange:()=>he(Y.id)})}),a.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(Y.ngay).toLocaleDateString("vi-VN")}),a.jsxs("td",{className:"px-4 py-3",children:[a.jsx("div",{className:"text-sm font-medium",children:(le=Y.nhanVien)==null?void 0:le.hoTen}),a.jsx("div",{className:"text-xs text-gray-500",children:(X=Y.nhanVien)==null?void 0:X.maNhanVien})]}),a.jsx("td",{className:"px-4 py-3 text-sm",children:(ve=Y.phongBan)==null?void 0:ve.tenPhongBan}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("span",{className:`px-2 py-1 rounded text-xs ${yc[Y.loaiSuKien].color}`,children:[yc[Y.loaiSuKien].icon," ",yc[Y.loaiSuKien].label]})}),a.jsx("td",{className:"px-4 py-3 text-sm font-mono",children:Y.maSuKien}),a.jsx("td",{className:"px-4 py-3 text-sm text-right",children:Y.giaTri}),a.jsxs("td",{className:"px-4 py-3 text-sm text-right font-mono",children:[new Intl.NumberFormat("vi-VN").format(Y.soTien),""]}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("span",{className:`px-2 py-1 rounded text-xs ${Qf[Y.trangThai].color}`,children:Qf[Y.trangThai].label})}),a.jsx("td",{className:"px-4 py-3 text-center",children:Y.trangThai==="NHAP"&&a.jsxs("div",{className:"flex justify-center gap-1",children:[a.jsx("button",{onClick:()=>I(Y.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Duyt",children:a.jsx(Ah,{size:16})}),a.jsx("button",{onClick:()=>J(Y.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"T chi",children:a.jsx(rl,{size:16})})]})})]},Y.id)}),e.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:10,className:"px-4 py-10 text-center text-gray-500",children:"Khng c s kin no"})})]})]})}),p&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg",children:[a.jsx("div",{className:"px-6 py-4 border-b",children:a.jsx("h3",{className:"text-lg font-semibold",children:"Thm s kin Thng/Pht"})}),a.jsxs("div",{className:"px-6 py-4 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nhn vin"}),a.jsxs("select",{value:C.nhanVienId,onChange:Y=>{const le=c.find(X=>X.id===Number(Y.target.value));S({...C,nhanVienId:Number(Y.target.value),phongBanId:(le==null?void 0:le.phongBanId)||C.phongBanId})},className:"w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"",children:"-- Chn --"}),c.map(Y=>a.jsxs("option",{value:Y.id,children:[Y.hoTen," (",Y.maNhanVien,")"]},Y.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy"}),a.jsx("input",{type:"date",value:C.ngay,onChange:Y=>S({...C,ngay:Y.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi s kin"}),a.jsxs("select",{value:C.maSuKien,onChange:Y=>xe(Y.target.value),className:"w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"",children:"-- Chn s kin --"}),a.jsx("optgroup",{label:"Thng",children:r.filter(Y=>Y.loai==="THUONG").map(Y=>a.jsxs("option",{value:Y.maSuKien,children:[Y.tenSuKien," (",Y.maSuKien,")"]},Y.maSuKien))}),a.jsx("optgroup",{label:"Pht",children:r.filter(Y=>Y.loai==="PHAT").map(Y=>a.jsxs("option",{value:Y.maSuKien,children:[Y.tenSuKien," (",Y.maSuKien,")"]},Y.maSuKien))})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi tr (ln/ngy/...)"}),a.jsx("input",{type:"number",value:C.giaTri,onChange:Y=>S({...C,giaTri:Number(Y.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:1})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S tin"}),a.jsx("input",{type:"number",value:C.soTien,onChange:Y=>S({...C,soTien:Number(Y.target.value)}),className:"w-full border rounded-lg px-3 py-2"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[new Intl.NumberFormat("vi-VN").format(C.soTien),""]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),a.jsx("textarea",{value:C.ghiChu,onChange:Y=>S({...C,ghiChu:Y.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),a.jsxs("div",{className:"px-6 py-4 border-t flex justify-end gap-3",children:[a.jsx("button",{onClick:()=>{m(!1),ne()},className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),a.jsx("button",{onClick:D,disabled:!C.nhanVienId||!C.maSuKien,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Thm s kin"})]})]})}),g&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[80vh] flex flex-col",children:[a.jsxs("div",{className:"px-6 py-4 border-b flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Danh mc S kin"}),a.jsx("button",{onClick:()=>b(!1),className:"p-2 hover:bg-gray-100 rounded",children:a.jsx(rl,{size:20})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[a.jsx("h4",{className:"font-medium mb-3",children:"Thm danh mc mi"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsx("input",{type:"text",placeholder:"M s kin",value:E.maSuKien,onChange:Y=>O({...E,maSuKien:Y.target.value}),className:"border rounded px-3 py-2"}),a.jsx("input",{type:"text",placeholder:"Tn s kin",value:E.tenSuKien,onChange:Y=>O({...E,tenSuKien:Y.target.value}),className:"border rounded px-3 py-2"}),a.jsxs("select",{value:E.loai,onChange:Y=>O({...E,loai:Y.target.value}),className:"border rounded px-3 py-2",children:[a.jsx("option",{value:"THUONG",children:"Thng"}),a.jsx("option",{value:"PHAT",children:"Pht"})]}),a.jsx("input",{type:"number",placeholder:"S tin mc nh",value:E.soTienMacDinh||"",onChange:Y=>O({...E,soTienMacDinh:Number(Y.target.value)}),className:"border rounded px-3 py-2"})]}),a.jsx("div",{className:"mt-3 flex justify-end",children:a.jsx("button",{onClick:ee,disabled:!E.maSuKien||!E.tenSuKien,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:"Thm"})})]}),a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left text-sm",children:"M"}),a.jsx("th",{className:"px-3 py-2 text-left text-sm",children:"Tn"}),a.jsx("th",{className:"px-3 py-2 text-left text-sm",children:"Loi"}),a.jsx("th",{className:"px-3 py-2 text-right text-sm",children:"S tin mc nh"})]})}),a.jsx("tbody",{children:r.map(Y=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2 font-mono text-sm",children:Y.maSuKien}),a.jsx("td",{className:"px-3 py-2",children:Y.tenSuKien}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${yc[Y.loai].color}`,children:yc[Y.loai].label})}),a.jsx("td",{className:"px-3 py-2 text-right font-mono",children:Y.soTienMacDinh?new Intl.NumberFormat("vi-VN").format(Y.soTienMacDinh)+"":"-"})]},Y.id))})]})]})]})})]})}const i6={CO_DINH:"C nh",THEO_HE_SO:"Theo h s",BAC_THANG:"Bc thang",THEO_SU_KIEN:"Theo s kin",CONG_THUC:"Cng thc"};function l6(){const[e]=f_(),t=Number(e.get("bangLuongId"))||0,[r,n]=P.useState(null),[s,l]=P.useState([]),[c,u]=P.useState(!0),[d,f]=P.useState(""),[p,m]=P.useState([]);P.useEffect(()=>{t&&g()},[t]);const g=async()=>{u(!0);try{const[_,C]=await Promise.all([xa.layTheoId(t),$3.xemTrace(t)]);n(_),l(C)}catch(_){console.error("Li load d liu:",_)}finally{u(!1)}},b=s.reduce((_,C)=>{const S=C.nhanVienId;return _[S]||(_[S]={nhanVien:C.nhanVien,traces:[]}),_[S].traces.push(C),_},{}),v=Object.entries(b).filter(([_,C])=>{var E,O;if(!d)return!0;const S=d.toLowerCase();return((E=C.nhanVien)==null?void 0:E.hoTen.toLowerCase().includes(S))||((O=C.nhanVien)==null?void 0:O.maNhanVien.toLowerCase().includes(S))}),y=_=>{m(C=>C.includes(_)?C.filter(S=>S!==_):[...C,_])},N=_=>new Intl.NumberFormat("vi-VN").format(_);return c?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}):a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[a.jsx(wn,{to:`/bang-luong/${t}`,className:"p-2 hover:bg-gray-100 rounded",children:a.jsx(Nx,{size:20})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Rule Trace - Gii trnh tnh lng"}),r&&a.jsxs("p",{className:"text-gray-500 mt-1",children:[r.phongBan.tenPhongBan," - Thng ",r.thang,"/",r.nam]})]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:a.jsxs("div",{className:"relative",children:[a.jsx(Tx,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),a.jsx("input",{type:"text",placeholder:"Tm theo tn hoc m nhn vin...",value:d,onChange:_=>f(_.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]})}),a.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 mb-6 flex items-center justify-between",children:[a.jsx("div",{children:a.jsxs("span",{className:"text-blue-800",children:["Tng: ",Object.keys(b).length," nhn vin, ",s.length," dng trace"]})}),a.jsx("button",{onClick:()=>{p.length===Object.keys(b).length?m([]):m(Object.keys(b).map(Number))},className:"text-sm text-blue-600 hover:underline",children:p.length===Object.keys(b).length?"Thu gn tt c":"M rng tt c"})]}),a.jsxs("div",{className:"space-y-4",children:[v.map(([_,C])=>{var F,T;const S=Number(_),E=p.includes(S),O=C.traces.reduce((D,I)=>D+I.outputSoTien,0);return a.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsxs("button",{onClick:()=>y(S),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-gray-50",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[E?a.jsx(vb,{size:18,className:"text-gray-400"}):a.jsx(iS,{size:18,className:"text-gray-400"}),a.jsxs("div",{className:"text-left",children:[a.jsx("div",{className:"font-medium",children:(F=C.nhanVien)==null?void 0:F.hoTen}),a.jsx("div",{className:"text-sm text-gray-500",children:(T=C.nhanVien)==null?void 0:T.maNhanVien})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"font-medium text-blue-600",children:[N(O),""]}),a.jsxs("div",{className:"text-sm text-gray-500",children:[C.traces.length," rules"]})]})]}),E&&a.jsx("div",{className:"border-t",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Quy ch"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Rule"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Khon lng"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500",children:"S tin"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Gii thch"})]})}),a.jsx("tbody",{children:C.traces.map(D=>{var I,J,Z,ee,ne,he;return a.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[a.jsxs("td",{className:"px-4 py-2",children:[a.jsx("div",{className:"text-sm",children:(I=D.quyChe)==null?void 0:I.tenQuyChe}),a.jsxs("div",{className:"text-xs text-gray-500",children:["v",(J=D.quyChe)==null?void 0:J.phienBan]})]}),a.jsx("td",{className:"px-4 py-2",children:D.quyCheRule?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm",children:D.quyCheRule.tenRule}),a.jsx("div",{className:"text-xs text-gray-500",children:i6[D.quyCheRule.loaiRule]})]}):a.jsx("span",{className:"text-gray-400 text-sm",children:"-"})}),a.jsxs("td",{className:"px-4 py-2",children:[a.jsx("div",{className:"text-sm",children:(Z=D.khoanLuong)==null?void 0:Z.tenKhoan}),a.jsx("div",{className:"text-xs text-gray-500",children:(ee=D.khoanLuong)==null?void 0:ee.maKhoan})]}),a.jsx("td",{className:"px-4 py-2 text-right",children:a.jsxs("span",{className:`font-mono text-sm ${((ne=D.khoanLuong)==null?void 0:ne.loai)==="KHAU_TRU"?"text-red-600":"text-green-600"}`,children:[((he=D.khoanLuong)==null?void 0:he.loai)==="KHAU_TRU"?"-":"+",N(D.outputSoTien),""]})}),a.jsxs("td",{className:"px-4 py-2",children:[a.jsx("div",{className:"text-sm text-gray-600",children:D.messageGiaiThich}),D.inputJson&&a.jsxs("details",{className:"mt-1",children:[a.jsx("summary",{className:"text-xs text-blue-600 cursor-pointer",children:"Xem input"}),a.jsx("pre",{className:"mt-1 text-xs bg-gray-100 p-2 rounded overflow-x-auto",children:JSON.stringify(JSON.parse(D.inputJson),null,2)})]})]})]},D.id)})})]})})]},S)}),v.length===0&&a.jsx("div",{className:"text-center text-gray-500 py-10",children:"Khng c d liu trace"})]})]})}var Yf={exports:{}},Jf,ly;function o6(){if(ly)return Jf;ly=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Jf=e,Jf}var Zf,oy;function c6(){if(oy)return Zf;oy=1;var e=o6();function t(){}function r(){}return r.resetWarningCache=t,Zf=function(){function n(c,u,d,f,p,m){if(m!==e){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}n.isRequired=n;function s(){return n}var l={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:s,element:n,elementType:n,instanceOf:s,node:n,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:r,resetWarningCache:t};return l.PropTypes=l,l},Zf}var cy;function u6(){return cy||(cy=1,Yf.exports=c6()()),Yf.exports}var h6=u6();const It=lx(h6);function hl(e,t,r,n){function s(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function u(p){try{f(n.next(p))}catch(m){c(m)}}function d(p){try{f(n.throw(p))}catch(m){c(m)}}function f(p){p.done?l(p.value):s(p.value).then(u,d)}f((n=n.apply(e,t||[])).next())})}const d6=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function wo(e,t,r){const n=f6(e),{webkitRelativePath:s}=e,l=typeof t=="string"?t:typeof s=="string"&&s.length>0?s:`./${e.name}`;return typeof n.path!="string"&&uy(n,"path",l),uy(n,"relativePath",l),n}function f6(e){const{name:t}=e;if(t&&t.lastIndexOf(".")!==-1&&!e.type){const n=t.split(".").pop().toLowerCase(),s=d6.get(n);s&&Object.defineProperty(e,"type",{value:s,writable:!1,configurable:!1,enumerable:!0})}return e}function uy(e,t,r){Object.defineProperty(e,t,{value:r,writable:!1,configurable:!1,enumerable:!0})}const p6=[".DS_Store","Thumbs.db"];function x6(e){return hl(this,void 0,void 0,function*(){return uh(e)&&m6(e.dataTransfer)?b6(e.dataTransfer,e.type):g6(e)?v6(e):Array.isArray(e)&&e.every(t=>"getFile"in t&&typeof t.getFile=="function")?y6(e):[]})}function m6(e){return uh(e)}function g6(e){return uh(e)&&uh(e.target)}function uh(e){return typeof e=="object"&&e!==null}function v6(e){return zp(e.target.files).map(t=>wo(t))}function y6(e){return hl(this,void 0,void 0,function*(){return(yield Promise.all(e.map(r=>r.getFile()))).map(r=>wo(r))})}function b6(e,t){return hl(this,void 0,void 0,function*(){if(e.items){const r=zp(e.items).filter(s=>s.kind==="file");if(t!=="drop")return r;const n=yield Promise.all(r.map(w6));return hy(ow(n))}return hy(zp(e.files).map(r=>wo(r)))})}function hy(e){return e.filter(t=>p6.indexOf(t.name)===-1)}function zp(e){if(e===null)return[];const t=[];for(let r=0;r<e.length;r++){const n=e[r];t.push(n)}return t}function w6(e){if(typeof e.webkitGetAsEntry!="function")return dy(e);const t=e.webkitGetAsEntry();return t&&t.isDirectory?cw(t):dy(e,t)}function ow(e){return e.reduce((t,r)=>[...t,...Array.isArray(r)?ow(r):[r]],[])}function dy(e,t){return hl(this,void 0,void 0,function*(){var r;if(globalThis.isSecureContext&&typeof e.getAsFileSystemHandle=="function"){const l=yield e.getAsFileSystemHandle();if(l===null)throw new Error(`${e} is not a File`);if(l!==void 0){const c=yield l.getFile();return c.handle=l,wo(c)}}const n=e.getAsFile();if(!n)throw new Error(`${e} is not a File`);return wo(n,(r=t==null?void 0:t.fullPath)!==null&&r!==void 0?r:void 0)})}function N6(e){return hl(this,void 0,void 0,function*(){return e.isDirectory?cw(e):k6(e)})}function cw(e){const t=e.createReader();return new Promise((r,n)=>{const s=[];function l(){t.readEntries(c=>hl(this,void 0,void 0,function*(){if(c.length){const u=Promise.all(c.map(N6));s.push(u),l()}else try{const u=yield Promise.all(s);r(u)}catch(u){n(u)}}),c=>{n(c)})}l()})}function k6(e){return hl(this,void 0,void 0,function*(){return new Promise((t,r)=>{e.file(n=>{const s=wo(n,e.fullPath);t(s)},n=>{r(n)})})})}var O0={},fy;function T6(){return fy||(fy=1,O0.__esModule=!0,O0.default=function(e,t){if(e&&t){var r=Array.isArray(t)?t:t.split(",");if(r.length===0)return!0;var n=e.name||"",s=(e.type||"").toLowerCase(),l=s.replace(/\/.*$/,"");return r.some(function(c){var u=c.trim().toLowerCase();return u.charAt(0)==="."?n.toLowerCase().endsWith(u):u.endsWith("/*")?l===u.replace(/\/.*$/,""):s===u})}return!0}),O0}var j6=T6();const ep=lx(j6);function py(e){return C6(e)||S6(e)||hw(e)||_6()}function _6(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function S6(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function C6(e){if(Array.isArray(e))return Kp(e)}function xy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function my(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xy(Object(r),!0).forEach(function(n){uw(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uw(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uc(e,t){return A6(e)||F6(e,t)||hw(e,t)||E6()}function E6(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hw(e,t){if(e){if(typeof e=="string")return Kp(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Kp(e,t)}}function Kp(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function F6(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],s=!0,l=!1,c,u;try{for(r=r.call(e);!(s=(c=r.next()).done)&&(n.push(c.value),!(t&&n.length===t));s=!0);}catch(d){l=!0,u=d}finally{try{!s&&r.return!=null&&r.return()}finally{if(l)throw u}}return n}}function A6(e){if(Array.isArray(e))return e}var D6=typeof ep=="function"?ep:ep.default,P6="file-invalid-type",L6="file-too-large",O6="file-too-small",R6="too-many-files",I6=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=t.split(","),n=r.length>1?"one of ".concat(r.join(", ")):r[0];return{code:P6,message:"File type must be ".concat(n)}},gy=function(t){return{code:L6,message:"File is larger than ".concat(t," ").concat(t===1?"byte":"bytes")}},vy=function(t){return{code:O6,message:"File is smaller than ".concat(t," ").concat(t===1?"byte":"bytes")}},M6={code:R6,message:"Too many files"};function dw(e,t){var r=e.type==="application/x-moz-file"||D6(e,t);return[r,r?null:I6(t)]}function fw(e,t,r){if(Oi(e.size))if(Oi(t)&&Oi(r)){if(e.size>r)return[!1,gy(r)];if(e.size<t)return[!1,vy(t)]}else{if(Oi(t)&&e.size<t)return[!1,vy(t)];if(Oi(r)&&e.size>r)return[!1,gy(r)]}return[!0,null]}function Oi(e){return e!=null}function B6(e){var t=e.files,r=e.accept,n=e.minSize,s=e.maxSize,l=e.multiple,c=e.maxFiles,u=e.validator;return!l&&t.length>1||l&&c>=1&&t.length>c?!1:t.every(function(d){var f=dw(d,r),p=Uc(f,1),m=p[0],g=fw(d,n,s),b=Uc(g,1),v=b[0],y=u?u(d):null;return m&&v&&!y})}function hh(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function R0(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(t){return t==="Files"||t==="application/x-moz-file"}):!!e.target&&!!e.target.files}function yy(e){e.preventDefault()}function H6(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function U6(e){return e.indexOf("Edge/")!==-1}function V6(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return H6(e)||U6(e)}function Fa(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){for(var s=arguments.length,l=new Array(s>1?s-1:0),c=1;c<s;c++)l[c-1]=arguments[c];return t.some(function(u){return!hh(n)&&u&&u.apply(void 0,[n].concat(l)),hh(n)})}}function z6(){return"showOpenFilePicker"in window}function K6(e){if(Oi(e)){var t=Object.entries(e).filter(function(r){var n=Uc(r,2),s=n[0],l=n[1],c=!0;return pw(s)||(console.warn('Skipped "'.concat(s,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),c=!1),(!Array.isArray(l)||!l.every(xw))&&(console.warn('Skipped "'.concat(s,'" because an invalid file extension was provided.')),c=!1),c}).reduce(function(r,n){var s=Uc(n,2),l=s[0],c=s[1];return my(my({},r),{},uw({},l,c))},{});return[{description:"Files",accept:t}]}return e}function $6(e){if(Oi(e))return Object.entries(e).reduce(function(t,r){var n=Uc(r,2),s=n[0],l=n[1];return[].concat(py(t),[s],py(l))},[]).filter(function(t){return pw(t)||xw(t)}).join(",")}function W6(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function G6(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function pw(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||e==="application/*"||/\w+\/[-+.\w]+/g.test(e)}function xw(e){return/^.*\.[\w]+$/.test(e)}var q6=["children"],X6=["open"],Q6=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],Y6=["refKey","onChange","onClick"];function J6(e){return t5(e)||e5(e)||mw(e)||Z6()}function Z6(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function e5(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function t5(e){if(Array.isArray(e))return $p(e)}function tp(e,t){return a5(e)||n5(e,t)||mw(e,t)||r5()}function r5(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mw(e,t){if(e){if(typeof e=="string")return $p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $p(e,t)}}function $p(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function n5(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],s=!0,l=!1,c,u;try{for(r=r.call(e);!(s=(c=r.next()).done)&&(n.push(c.value),!(t&&n.length===t));s=!0);}catch(d){l=!0,u=d}finally{try{!s&&r.return!=null&&r.return()}finally{if(l)throw u}}return n}}function a5(e){if(Array.isArray(e))return e}function by(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Jt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?by(Object(r),!0).forEach(function(n){Wp(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):by(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Wp(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dh(e,t){if(e==null)return{};var r=s5(e,t),n,s;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(s=0;s<l.length;s++)n=l[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function s5(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,l;for(l=0;l<n.length;l++)s=n[l],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}var Px=P.forwardRef(function(e,t){var r=e.children,n=dh(e,q6),s=Lx(n),l=s.open,c=dh(s,X6);return P.useImperativeHandle(t,function(){return{open:l}},[l]),z2.createElement(P.Fragment,null,r(Jt(Jt({},c),{},{open:l})))});Px.displayName="Dropzone";var gw={disabled:!1,getFilesFromEvent:x6,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};Px.defaultProps=gw;Px.propTypes={children:It.func,accept:It.objectOf(It.arrayOf(It.string)),multiple:It.bool,preventDropOnDocument:It.bool,noClick:It.bool,noKeyboard:It.bool,noDrag:It.bool,noDragEventsBubbling:It.bool,minSize:It.number,maxSize:It.number,maxFiles:It.number,disabled:It.bool,getFilesFromEvent:It.func,onFileDialogCancel:It.func,onFileDialogOpen:It.func,useFsAccessApi:It.bool,autoFocus:It.bool,onDragEnter:It.func,onDragLeave:It.func,onDragOver:It.func,onDrop:It.func,onDropAccepted:It.func,onDropRejected:It.func,onError:It.func,validator:It.func};var Gp={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function Lx(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=Jt(Jt({},gw),e),r=t.accept,n=t.disabled,s=t.getFilesFromEvent,l=t.maxSize,c=t.minSize,u=t.multiple,d=t.maxFiles,f=t.onDragEnter,p=t.onDragLeave,m=t.onDragOver,g=t.onDrop,b=t.onDropAccepted,v=t.onDropRejected,y=t.onFileDialogCancel,N=t.onFileDialogOpen,_=t.useFsAccessApi,C=t.autoFocus,S=t.preventDropOnDocument,E=t.noClick,O=t.noKeyboard,F=t.noDrag,T=t.noDragEventsBubbling,D=t.onError,I=t.validator,J=P.useMemo(function(){return $6(r)},[r]),Z=P.useMemo(function(){return K6(r)},[r]),ee=P.useMemo(function(){return typeof N=="function"?N:wy},[N]),ne=P.useMemo(function(){return typeof y=="function"?y:wy},[y]),he=P.useRef(null),Q=P.useRef(null),xe=P.useReducer(i5,Gp),Y=tp(xe,2),le=Y[0],X=Y[1],ve=le.isFocused,K=le.isFileDialogActive,k=P.useRef(typeof window<"u"&&window.isSecureContext&&_&&z6()),B=function(){!k.current&&K&&setTimeout(function(){if(Q.current){var Ge=Q.current.files;Ge.length||(X({type:"closeDialog"}),ne())}},300)};P.useEffect(function(){return window.addEventListener("focus",B,!1),function(){window.removeEventListener("focus",B,!1)}},[Q,K,ne,k]);var A=P.useRef([]),M=function(Ge){he.current&&he.current.contains(Ge.target)||(Ge.preventDefault(),A.current=[])};P.useEffect(function(){return S&&(document.addEventListener("dragover",yy,!1),document.addEventListener("drop",M,!1)),function(){S&&(document.removeEventListener("dragover",yy),document.removeEventListener("drop",M))}},[he,S]),P.useEffect(function(){return!n&&C&&he.current&&he.current.focus(),function(){}},[he,C,n]);var ae=P.useCallback(function(Re){D?D(Re):console.error(Re)},[D]),de=P.useCallback(function(Re){Re.preventDefault(),Re.persist(),or(Re),A.current=[].concat(J6(A.current),[Re.target]),R0(Re)&&Promise.resolve(s(Re)).then(function(Ge){if(!(hh(Re)&&!T)){var Tt=Ge.length,Lt=Tt>0&&B6({files:Ge,accept:J,minSize:c,maxSize:l,multiple:u,maxFiles:d,validator:I}),bt=Tt>0&&!Lt;X({isDragAccept:Lt,isDragReject:bt,isDragActive:!0,type:"setDraggedFiles"}),f&&f(Re)}}).catch(function(Ge){return ae(Ge)})},[s,f,ae,T,J,c,l,u,d,I]),be=P.useCallback(function(Re){Re.preventDefault(),Re.persist(),or(Re);var Ge=R0(Re);if(Ge&&Re.dataTransfer)try{Re.dataTransfer.dropEffect="copy"}catch{}return Ge&&m&&m(Re),!1},[m,T]),we=P.useCallback(function(Re){Re.preventDefault(),Re.persist(),or(Re);var Ge=A.current.filter(function(Lt){return he.current&&he.current.contains(Lt)}),Tt=Ge.indexOf(Re.target);Tt!==-1&&Ge.splice(Tt,1),A.current=Ge,!(Ge.length>0)&&(X({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),R0(Re)&&p&&p(Re))},[he,p,T]),ye=P.useCallback(function(Re,Ge){var Tt=[],Lt=[];Re.forEach(function(bt){var br=dw(bt,J),tt=tp(br,2),St=tt[0],Sr=tt[1],Ht=fw(bt,c,l),tn=tp(Ht,2),ys=tn[0],Ka=tn[1],$a=I?I(bt):null;if(St&&ys&&!$a)Tt.push(bt);else{var ka=[Sr,Ka];$a&&(ka=ka.concat($a)),Lt.push({file:bt,errors:ka.filter(function(bs){return bs})})}}),(!u&&Tt.length>1||u&&d>=1&&Tt.length>d)&&(Tt.forEach(function(bt){Lt.push({file:bt,errors:[M6]})}),Tt.splice(0)),X({acceptedFiles:Tt,fileRejections:Lt,isDragReject:Lt.length>0,type:"setFiles"}),g&&g(Tt,Lt,Ge),Lt.length>0&&v&&v(Lt,Ge),Tt.length>0&&b&&b(Tt,Ge)},[X,u,J,c,l,d,g,b,v,I]),Je=P.useCallback(function(Re){Re.preventDefault(),Re.persist(),or(Re),A.current=[],R0(Re)&&Promise.resolve(s(Re)).then(function(Ge){hh(Re)&&!T||ye(Ge,Re)}).catch(function(Ge){return ae(Ge)}),X({type:"reset"})},[s,ye,ae,T]),G=P.useCallback(function(){if(k.current){X({type:"openDialog"}),ee();var Re={multiple:u,types:Z};window.showOpenFilePicker(Re).then(function(Ge){return s(Ge)}).then(function(Ge){ye(Ge,null),X({type:"closeDialog"})}).catch(function(Ge){W6(Ge)?(ne(Ge),X({type:"closeDialog"})):G6(Ge)?(k.current=!1,Q.current?(Q.current.value=null,Q.current.click()):ae(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):ae(Ge)});return}Q.current&&(X({type:"openDialog"}),ee(),Q.current.value=null,Q.current.click())},[X,ee,ne,_,ye,ae,Z,u]),Ne=P.useCallback(function(Re){!he.current||!he.current.isEqualNode(Re.target)||(Re.key===" "||Re.key==="Enter"||Re.keyCode===32||Re.keyCode===13)&&(Re.preventDefault(),G())},[he,G]),He=P.useCallback(function(){X({type:"focus"})},[]),ht=P.useCallback(function(){X({type:"blur"})},[]),rt=P.useCallback(function(){E||(V6()?setTimeout(G,0):G())},[E,G]),Oe=function(Ge){return n?null:Ge},Pt=function(Ge){return O?null:Oe(Ge)},lr=function(Ge){return F?null:Oe(Ge)},or=function(Ge){T&&Ge.stopPropagation()},_r=P.useMemo(function(){return function(){var Re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ge=Re.refKey,Tt=Ge===void 0?"ref":Ge,Lt=Re.role,bt=Re.onKeyDown,br=Re.onFocus,tt=Re.onBlur,St=Re.onClick,Sr=Re.onDragEnter,Ht=Re.onDragOver,tn=Re.onDragLeave,ys=Re.onDrop,Ka=dh(Re,Q6);return Jt(Jt(Wp({onKeyDown:Pt(Fa(bt,Ne)),onFocus:Pt(Fa(br,He)),onBlur:Pt(Fa(tt,ht)),onClick:Oe(Fa(St,rt)),onDragEnter:lr(Fa(Sr,de)),onDragOver:lr(Fa(Ht,be)),onDragLeave:lr(Fa(tn,we)),onDrop:lr(Fa(ys,Je)),role:typeof Lt=="string"&&Lt!==""?Lt:"presentation"},Tt,he),!n&&!O?{tabIndex:0}:{}),Ka)}},[he,Ne,He,ht,rt,de,be,we,Je,O,F,n]),sa=P.useCallback(function(Re){Re.stopPropagation()},[]),Cn=P.useMemo(function(){return function(){var Re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ge=Re.refKey,Tt=Ge===void 0?"ref":Ge,Lt=Re.onChange,bt=Re.onClick,br=dh(Re,Y6),tt=Wp({accept:J,multiple:u,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:Oe(Fa(Lt,Je)),onClick:Oe(Fa(bt,sa)),tabIndex:-1},Tt,Q);return Jt(Jt({},tt),br)}},[Q,r,u,Je,n]);return Jt(Jt({},le),{},{isFocused:ve&&!n,getRootProps:_r,getInputProps:Cn,rootRef:he,inputRef:Q,open:Oe(G)})}function i5(e,t){switch(t.type){case"focus":return Jt(Jt({},e),{},{isFocused:!0});case"blur":return Jt(Jt({},e),{},{isFocused:!1});case"openDialog":return Jt(Jt({},Gp),{},{isFileDialogActive:!0});case"closeDialog":return Jt(Jt({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return Jt(Jt({},e),{},{isDragActive:t.isDragActive,isDragAccept:t.isDragAccept,isDragReject:t.isDragReject});case"setFiles":return Jt(Jt({},e),{},{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections,isDragReject:t.isDragReject});case"reset":return Jt({},Gp);default:return e}}function wy(){}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var fh={};fh.version="0.18.5";var vw=1252,l5=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ox={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Rx=function(e){l5.indexOf(e)!=-1&&(vw=Ox[0]=e)};function o5(){Rx(1252)}var va=function(e){Rx(e)};function Ix(){va(1200),o5()}function Ny(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function c5(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function yw(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Nc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?c5(e.slice(2)):t==254&&r==255?yw(e.slice(2)):t==65279?e.slice(1):e},I0=function(t){return String.fromCharCode(t)},ky=function(t){return String.fromCharCode(t)},Vc,ri="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function zc(e){for(var t="",r=0,n=0,s=0,l=0,c=0,u=0,d=0,f=0;f<e.length;)r=e.charCodeAt(f++),l=r>>2,n=e.charCodeAt(f++),c=(r&3)<<4|n>>4,s=e.charCodeAt(f++),u=(n&15)<<2|s>>6,d=s&63,isNaN(n)?u=d=64:isNaN(s)&&(d=64),t+=ri.charAt(l)+ri.charAt(c)+ri.charAt(u)+ri.charAt(d);return t}function Bn(e){var t="",r=0,n=0,s=0,l=0,c=0,u=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)l=ri.indexOf(e.charAt(f++)),c=ri.indexOf(e.charAt(f++)),r=l<<2|c>>4,t+=String.fromCharCode(r),u=ri.indexOf(e.charAt(f++)),n=(c&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(n)),d=ri.indexOf(e.charAt(f++)),s=(u&3)<<6|d,d!==64&&(t+=String.fromCharCode(s));return t}var xt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ms=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function oi(e){return xt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Ty(e){return xt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Rn=function(t){return xt?ms(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Hh(e){if(typeof ArrayBuffer>"u")return Rn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function xi(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function u5(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Mx(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Mx(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Or=xt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ms(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function h5(e){for(var t=[],r=0,n=e.length+250,s=oi(e.length+255),l=0;l<e.length;++l){var c=e.charCodeAt(l);if(c<128)s[r++]=c;else if(c<2048)s[r++]=192|c>>6&31,s[r++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=e.charCodeAt(++l)&1023;s[r++]=240|c>>8&7,s[r++]=128|c>>2&63,s[r++]=128|u>>6&15|(c&3)<<4,s[r++]=128|u&63}else s[r++]=224|c>>12&15,s[r++]=128|c>>6&63,s[r++]=128|c&63;r>n&&(t.push(s.slice(0,r)),r=0,s=oi(65535),n=65530)}return t.push(s.slice(0,r)),Or(t)}var un=/\u0000/g,kc=/[\u0001-\u0006]/g;function eo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ya(e,t){var r=""+e;return r.length>=t?r:ar("0",t-r.length)+r}function Bx(e,t){var r=""+e;return r.length>=t?r:ar(" ",t-r.length)+r}function ph(e,t){var r=""+e;return r.length>=t?r:r+ar(" ",t-r.length)}function d5(e,t){var r=""+Math.round(e);return r.length>=t?r:ar("0",t-r.length)+r}function f5(e,t){var r=""+e;return r.length>=t?r:ar("0",t-r.length)+r}var jy=Math.pow(2,32);function ql(e,t){if(e>jy||e<-jy)return d5(e,t);var r=Math.round(e);return f5(r,t)}function xh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var _y=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],rp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function p5(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Sy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},x5={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function mh(e,t,r){for(var n=e<0?-1:1,s=e*n,l=0,c=1,u=0,d=1,f=0,p=0,m=Math.floor(s);f<t&&(m=Math.floor(s),u=m*c+l,p=m*f+d,!(s-m<5e-8));)s=1/(s-m),l=c,c=u,d=f,f=p;if(p>t&&(f>t?(p=d,u=l):(p=f,u=c)),!r)return[0,n*u,p];var g=Math.floor(n*u/p);return[g,n*u-g*p,p]}function Bi(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),l=0,c=[],u={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++s==86400&&(u.T=s=0,++n,++u.D)),n===60)c=r?[1317,10,29]:[1900,2,29],l=3;else if(n===0)c=r?[1317,8,29]:[1900,1,0],l=6;else{n>60&&--n;var d=new Date(1900,0,1);d.setDate(d.getDate()+n-1),c=[d.getFullYear(),d.getMonth()+1,d.getDate()],l=d.getDay(),n<60&&(l=(l+6)%7),r&&(l=w5(d,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=s%60,s=Math.floor(s/60),u.M=s%60,s=Math.floor(s/60),u.H=s,u.q=l,u}var bw=new Date(1899,11,31,0,0,0),m5=bw.getTime(),g5=new Date(1900,2,1,0,0,0);function ww(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=g5&&(r+=1440*60*1e3),(r-(m5+(e.getTimezoneOffset()-bw.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Hx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function v5(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function y5(e){var t=e<0?12:11,r=Hx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function b5(e){var t=Hx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Kc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=y5(e):t===10?r=e.toFixed(10).substr(0,12):r=b5(e),Hx(v5(r.toUpperCase()))}function al(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Kc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return na(14,ww(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function w5(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function N5(e,t,r,n){var s="",l=0,c=0,u=r.y,d,f=0;switch(e){case 98:u=r.y+543;case 121:switch(t.length){case 1:case 2:d=u%100,f=2;break;default:d=u%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:d=r.m,f=t.length;break;case 3:return rp[r.m-1][1];case 5:return rp[r.m-1][0];default:return rp[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=r.d,f=t.length;break;case 3:return _y[r.q][0];default:return _y[r.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ya(r.S,t.length):(n>=2?c=n===3?1e3:100:c=n===1?10:1,l=Math.round(c*(r.S+r.u)),l>=60*c&&(l=0),t==="s"?l===0?"0":""+l/c:(s=ya(l,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=r.D*24+r.H;break;case"[m]":case"[mm]":d=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":d=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:d=u,f=1;break}var p=f>0?ya(d,f):"";return p}function ni(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Nw=/%/g;function k5(e,t,r){var n=t.replace(Nw,""),s=t.length-n.length;return us(e,n,r*Math.pow(10,2*s))+ar("%",s)}function T5(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return us(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function kw(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+kw(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),r=(t/Math.pow(10,l)).toPrecision(n+1+(s+l)%s),r.indexOf("e")===-1){var c=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+l):r+="E+"+(c-l);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,f,p){return d+f+p.substr(0,(s+l)%s)+"."+p.substr(l)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Tw=/# (\?+)( ?)\/( ?)(\d+)/;function j5(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),l=Math.floor(s/n),c=s-l*n,u=n;return r+(l===0?"":""+l)+" "+(c===0?ar(" ",e[1].length+1+e[4].length):Bx(c,e[1].length)+e[2]+"/"+e[3]+ya(u,e[4].length))}function _5(e,t,r){return r+(t===0?"":""+t)+ar(" ",e[1].length+2+e[4].length)}var jw=/^#*0*\.([0#]+)/,_w=/\).*[0#]/,Sw=/\(###\) ###\\?-####/;function on(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Cy(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Ey(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function S5(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function C5(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function qn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(_w)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?qn("n",n,r):"("+qn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return T5(e,t,r);if(t.indexOf("%")!==-1)return k5(e,t,r);if(t.indexOf("E")!==-1)return kw(t,r);if(t.charCodeAt(0)===36)return"$"+qn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,l,c,u,d=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+ql(d,t.length);if(t.match(/^[#?]+$/))return s=ql(r,0),s==="0"&&(s=""),s.length>t.length?s:on(t.substr(0,t.length-s.length))+s;if(l=t.match(Tw))return j5(l,d,f);if(t.match(/^#+0+$/))return f+ql(d,t.length-t.indexOf("0"));if(l=t.match(jw))return s=Cy(r,l[1].length).replace(/^([^\.]+)$/,"$1."+on(l[1])).replace(/\.$/,"."+on(l[1])).replace(/\.(\d*)$/,function(v,y){return"."+y+ar("0",on(l[1]).length-y.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return f+Cy(d,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return f+ni(ql(d,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+qn(e,t,-r):ni(""+(Math.floor(r)+S5(r,l[1].length)))+"."+ya(Ey(r,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return qn(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=eo(qn(e,t.replace(/[\\-]/g,""),r)),c=0,eo(eo(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return c<s.length?s.charAt(c++):v==="0"?"0":""}));if(t.match(Sw))return s=qn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=mh(d,Math.pow(10,c)-1,!1),s=""+f,p=us("n",l[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+l[2]+"/"+l[3],p=ph(u[2],c),p.length<l[4].length&&(p=on(l[4].substr(l[4].length-p.length))+p),s+=p,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=mh(d,Math.pow(10,c)-1,!0),f+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Bx(u[1],c)+l[2]+"/"+l[3]+ph(u[2],c):ar(" ",2*c+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=ql(r,0),t.length<=s.length?s:on(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var m=t.indexOf(".")-c,g=t.length-s.length-m;return on(t.substr(0,m)+s+t.substr(t.length-g))}if(l=t.match(/^00,000\.([#0]*0)$/))return c=Ey(r,l[1].length),r<0?"-"+qn(e,t,-r):ni(C5(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ya(0,3-v.length):"")+v})+"."+ya(c,l[1].length);switch(t){case"###,##0.00":return qn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var b=ni(ql(d,0));return b!=="0"?f+b:"";case"###,###.00":return qn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return qn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function E5(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return us(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function F5(e,t,r){var n=t.replace(Nw,""),s=t.length-n.length;return us(e,n,r*Math.pow(10,2*s))+ar("%",s)}function Cw(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Cw(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),r=(t/Math.pow(10,l)).toPrecision(n+1+(s+l)%s),!r.match(/[Ee]/)){var c=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+l):r+="E+"+(c-l),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,f,p){return d+f+p.substr(0,(s+l)%s)+"."+p.substr(l)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Da(e,t,r){if(e.charCodeAt(0)===40&&!t.match(_w)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Da("n",n,r):"("+Da("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return E5(e,t,r);if(t.indexOf("%")!==-1)return F5(e,t,r);if(t.indexOf("E")!==-1)return Cw(t,r);if(t.charCodeAt(0)===36)return"$"+Da(e,t.substr(t.charAt(1)==" "?2:1),r);var s,l,c,u,d=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+ya(d,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:on(t.substr(0,t.length-s.length))+s;if(l=t.match(Tw))return _5(l,d,f);if(t.match(/^#+0+$/))return f+ya(d,t.length-t.indexOf("0"));if(l=t.match(jw))return s=(""+r).replace(/^([^\.]+)$/,"$1."+on(l[1])).replace(/\.$/,"."+on(l[1])),s=s.replace(/\.(\d*)$/,function(v,y){return"."+y+ar("0",on(l[1]).length-y.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return f+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return f+ni(""+d);if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Da(e,t,-r):ni(""+r)+"."+ar("0",l[1].length);if(l=t.match(/^#,#*,#0/))return Da(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=eo(Da(e,t.replace(/[\\-]/g,""),r)),c=0,eo(eo(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return c<s.length?s.charAt(c++):v==="0"?"0":""}));if(t.match(Sw))return s=Da(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=mh(d,Math.pow(10,c)-1,!1),s=""+f,p=us("n",l[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+l[2]+"/"+l[3],p=ph(u[2],c),p.length<l[4].length&&(p=on(l[4].substr(l[4].length-p.length))+p),s+=p,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=mh(d,Math.pow(10,c)-1,!0),f+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Bx(u[1],c)+l[2]+"/"+l[3]+ph(u[2],c):ar(" ",2*c+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:on(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var m=t.indexOf(".")-c,g=t.length-s.length-m;return on(t.substr(0,m)+s+t.substr(t.length-g))}if(l=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Da(e,t,-r):ni(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ya(0,3-v.length):"")+v})+"."+ya(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var b=ni(""+d);return b!=="0"?f+b:"";default:if(t.match(/\.[0#?]*$/))return Da(e,t.slice(0,t.lastIndexOf(".")),r)+on(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function us(e,t,r){return(r|0)===r?Da(e,t,r):qn(e,t,r)}function A5(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Ew=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Fo(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":xh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Ew))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function D5(e,t,r,n){for(var s=[],l="",c=0,u="",d="t",f,p,m,g="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!xh(e,c))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";(m=e.charCodeAt(++c))!==34&&c<e.length;)l+=String.fromCharCode(m);s[s.length]={t:"t",v:l},++c;break;case"\\":var b=e.charAt(++c),v=b==="("||b===")"?b:"t";s[s.length]={t:v,v:b},++c;break;case"_":s[s.length]={t:"t",v:" "},c+=2;break;case"@":s[s.length]={t:"T",v:t},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(f==null&&(f=Bi(t,r,e.charAt(c+1)==="2"),f==null))return"";s[s.length]={t:"X",v:e.substr(c,2)},d=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Bi(t,r),f==null))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;u==="m"&&d.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=g),s[s.length]={t:u,v:l},d=u;break;case"A":case"a":case"":var y={t:u,v:u};if(f==null&&(f=Bi(t,r)),e.substr(c,3).toUpperCase()==="A/P"?(f!=null&&(y.v=f.H>=12?"P":"A"),y.t="T",g="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(f!=null&&(y.v=f.H>=12?"PM":"AM"),y.t="T",c+=5,g="h"):e.substr(c,5).toUpperCase()==="/"?(f!=null&&(y.v=f.H>=12?"":""),y.t="T",c+=5,g="h"):(y.t="t",++c),f==null&&y.t==="T")return"";s[s.length]=y,d=u;break;case"[":for(l=u;e.charAt(c++)!=="]"&&c<e.length;)l+=e.charAt(c);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(Ew)){if(f==null&&(f=Bi(t,r),f==null))return"";s[s.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Fo(e)||(s[s.length]={t:"t",v:l}));break;case".":if(f!=null){for(l=u;++c<e.length&&(u=e.charAt(c))==="0";)l+=u;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;s[s.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;s[s.length]={t:u,v:l},d=u;break;case"*":++c,(e.charAt(c)==" "||e.charAt(c)=="*")&&++c;break;case"(":case")":s[s.length]={t:n===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:u,v:u},++c;break;case"$":s[s.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"t",v:u},++c;break}var N=0,_=0,C;for(c=s.length-1,d="t";c>=0;--c)switch(s[c].t){case"h":case"H":s[c].t=g,d="h",N<1&&(N=1);break;case"s":(C=s[c].v.match(/\.0+$/))&&(_=Math.max(_,C[0].length-1)),N<3&&(N=3);case"d":case"y":case"M":case"e":d=s[c].t;break;case"m":d==="s"&&(s[c].t="M",N<2&&(N=2));break;case"X":break;case"Z":N<1&&s[c].v.match(/[Hh]/)&&(N=1),N<2&&s[c].v.match(/[Mm]/)&&(N=2),N<3&&s[c].v.match(/[Ss]/)&&(N=3)}switch(N){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var S="",E;for(c=0;c<s.length;++c)switch(s[c].t){case"t":case"T":case" ":case"D":break;case"X":s[c].v="",s[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[c].v=N5(s[c].t.charCodeAt(0),s[c].v,f,_),s[c].t="t";break;case"n":case"?":for(E=c+1;s[E]!=null&&((u=s[E].t)==="?"||u==="D"||(u===" "||u==="t")&&s[E+1]!=null&&(s[E+1].t==="?"||s[E+1].t==="t"&&s[E+1].v==="/")||s[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(s[E].v==="/"||s[E].v===" "&&s[E+1]!=null&&s[E+1].t=="?"));)s[c].v+=s[E].v,s[E]={v:"",t:";"},++E;S+=s[c].v,c=E-1;break;case"G":s[c].t="t",s[c].v=al(t,r);break}var O="",F,T;if(S.length>0){S.charCodeAt(0)==40?(F=t<0&&S.charCodeAt(0)===45?-t:t,T=us("n",S,F)):(F=t<0&&n>1?-t:t,T=us("n",S,F),F<0&&s[0]&&s[0].t=="t"&&(T=T.substr(1),s[0].v="-"+s[0].v)),E=T.length-1;var D=s.length;for(c=0;c<s.length;++c)if(s[c]!=null&&s[c].t!="t"&&s[c].v.indexOf(".")>-1){D=c;break}var I=s.length;if(D===s.length&&T.indexOf("E")===-1){for(c=s.length-1;c>=0;--c)s[c]==null||"n?".indexOf(s[c].t)===-1||(E>=s[c].v.length-1?(E-=s[c].v.length,s[c].v=T.substr(E+1,s[c].v.length)):E<0?s[c].v="":(s[c].v=T.substr(0,E+1),E=-1),s[c].t="t",I=c);E>=0&&I<s.length&&(s[I].v=T.substr(0,E+1)+s[I].v)}else if(D!==s.length&&T.indexOf("E")===-1){for(E=T.indexOf(".")-1,c=D;c>=0;--c)if(!(s[c]==null||"n?".indexOf(s[c].t)===-1)){for(p=s[c].v.indexOf(".")>-1&&c===D?s[c].v.indexOf(".")-1:s[c].v.length-1,O=s[c].v.substr(p+1);p>=0;--p)E>=0&&(s[c].v.charAt(p)==="0"||s[c].v.charAt(p)==="#")&&(O=T.charAt(E--)+O);s[c].v=O,s[c].t="t",I=c}for(E>=0&&I<s.length&&(s[I].v=T.substr(0,E+1)+s[I].v),E=T.indexOf(".")+1,c=D;c<s.length;++c)if(!(s[c]==null||"n?(".indexOf(s[c].t)===-1&&c!==D)){for(p=s[c].v.indexOf(".")>-1&&c===D?s[c].v.indexOf(".")+1:0,O=s[c].v.substr(0,p);p<s[c].v.length;++p)E<T.length&&(O+=T.charAt(E++));s[c].v=O,s[c].t="t",I=c}}}for(c=0;c<s.length;++c)s[c]!=null&&"n?".indexOf(s[c].t)>-1&&(F=n>1&&t<0&&c>0&&s[c-1].v==="-"?-t:t,s[c].v=us(s[c].t,s[c].v,F),s[c].t="t");var J="";for(c=0;c!==s.length;++c)s[c]!=null&&(J+=s[c].v);return J}var Fy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ay(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function P5(e,t){var r=A5(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var l=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,l];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var c=r[0].match(Fy),u=r[1].match(Fy);return Ay(t,c)?[n,r[0]]:Ay(t,u)?[n,r[1]]:[n,r[c!=null&&u!=null?2:1]]}return[n,l]}function na(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:nt)[e],n==null&&(n=r.table&&r.table[Sy[e]]||nt[Sy[e]]),n==null&&(n=x5[e]||"General");break}if(xh(n,0))return al(t,r);t instanceof Date&&(t=ww(t,r.date1904));var s=P5(n,t);if(xh(s[1]))return al(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return D5(s[1],t,r,s[0])}function hs(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(nt[r]==null){t<0&&(t=r);continue}if(nt[r]==e){t=r;break}}t<0&&(t=391)}return nt[t]=e,t}function Uh(e){for(var t=0;t!=392;++t)e[t]!==void 0&&hs(e[t],t)}function Ao(){nt=p5()}var L5={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Fw=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function O5(e){var t=typeof e=="number"?nt[e]:e;return t=t.replace(Fw,"(\\d+)"),new RegExp("^"+t+"$")}function R5(e,t,r){var n=-1,s=-1,l=-1,c=-1,u=-1,d=-1;(t.match(Fw)||[]).forEach(function(m,g){var b=parseInt(r[g+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=b;break;case"d":l=b;break;case"h":c=b;break;case"s":d=b;break;case"m":c>=0?u=b:s=b;break}}),d>=0&&u==-1&&s>=0&&(u=s,s=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var p=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return c==-1&&u==-1&&d==-1?f:n==-1&&s==-1&&l==-1?p:f+"T"+p}var I5=(function(){var e={};e.version="1.2.0";function t(){for(var T=0,D=new Array(256),I=0;I!=256;++I)T=I,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,D[I]=T;return typeof Int32Array<"u"?new Int32Array(D):D}var r=t();function n(T){var D=0,I=0,J=0,Z=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(J=0;J!=256;++J)Z[J]=T[J];for(J=0;J!=256;++J)for(I=T[J],D=256+J;D<4096;D+=256)I=Z[D]=I>>>8^T[I&255];var ee=[];for(J=1;J!=16;++J)ee[J-1]=typeof Int32Array<"u"?Z.subarray(J*256,J*256+256):Z.slice(J*256,J*256+256);return ee}var s=n(r),l=s[0],c=s[1],u=s[2],d=s[3],f=s[4],p=s[5],m=s[6],g=s[7],b=s[8],v=s[9],y=s[10],N=s[11],_=s[12],C=s[13],S=s[14];function E(T,D){for(var I=D^-1,J=0,Z=T.length;J<Z;)I=I>>>8^r[(I^T.charCodeAt(J++))&255];return~I}function O(T,D){for(var I=D^-1,J=T.length-15,Z=0;Z<J;)I=S[T[Z++]^I&255]^C[T[Z++]^I>>8&255]^_[T[Z++]^I>>16&255]^N[T[Z++]^I>>>24]^y[T[Z++]]^v[T[Z++]]^b[T[Z++]]^g[T[Z++]]^m[T[Z++]]^p[T[Z++]]^f[T[Z++]]^d[T[Z++]]^u[T[Z++]]^c[T[Z++]]^l[T[Z++]]^r[T[Z++]];for(J+=15;Z<J;)I=I>>>8^r[(I^T[Z++])&255];return~I}function F(T,D){for(var I=D^-1,J=0,Z=T.length,ee=0,ne=0;J<Z;)ee=T.charCodeAt(J++),ee<128?I=I>>>8^r[(I^ee)&255]:ee<2048?(I=I>>>8^r[(I^(192|ee>>6&31))&255],I=I>>>8^r[(I^(128|ee&63))&255]):ee>=55296&&ee<57344?(ee=(ee&1023)+64,ne=T.charCodeAt(J++)&1023,I=I>>>8^r[(I^(240|ee>>8&7))&255],I=I>>>8^r[(I^(128|ee>>2&63))&255],I=I>>>8^r[(I^(128|ne>>6&15|(ee&3)<<4))&255],I=I>>>8^r[(I^(128|ne&63))&255]):(I=I>>>8^r[(I^(224|ee>>12&15))&255],I=I>>>8^r[(I^(128|ee>>6&63))&255],I=I>>>8^r[(I^(128|ee&63))&255]);return~I}return e.table=r,e.bstr=E,e.buf=O,e.str=F,e})(),Ye=(function(){var t={};t.version="1.2.1";function r(R,V){for(var H=R.split("/"),U=V.split("/"),z=0,W=0,ue=Math.min(H.length,U.length);z<ue;++z){if(W=H[z].length-U[z].length)return W;if(H[z]!=U[z])return H[z]<U[z]?-1:1}return H.length-U.length}function n(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:n(R.slice(0,-1));var V=R.lastIndexOf("/");return V===-1?R:R.slice(0,V+1)}function s(R){if(R.charAt(R.length-1)=="/")return s(R.slice(0,-1));var V=R.lastIndexOf("/");return V===-1?R:R.slice(V+1)}function l(R,V){typeof V=="string"&&(V=new Date(V));var H=V.getHours();H=H<<6|V.getMinutes(),H=H<<5|V.getSeconds()>>>1,R.write_shift(2,H);var U=V.getFullYear()-1980;U=U<<4|V.getMonth()+1,U=U<<5|V.getDate(),R.write_shift(2,U)}function c(R){var V=R.read_shift(2)&65535,H=R.read_shift(2)&65535,U=new Date,z=H&31;H>>>=5;var W=H&15;H>>>=4,U.setMilliseconds(0),U.setFullYear(H+1980),U.setMonth(W-1),U.setDate(z);var ue=V&31;V>>>=5;var Te=V&63;return V>>>=6,U.setHours(V),U.setMinutes(Te),U.setSeconds(ue<<1),U}function u(R){Hr(R,0);for(var V={},H=0;R.l<=R.length-4;){var U=R.read_shift(2),z=R.read_shift(2),W=R.l+z,ue={};switch(U){case 21589:H=R.read_shift(1),H&1&&(ue.mtime=R.read_shift(4)),z>5&&(H&2&&(ue.atime=R.read_shift(4)),H&4&&(ue.ctime=R.read_shift(4))),ue.mtime&&(ue.mt=new Date(ue.mtime*1e3));break}R.l=W,V[U]=ue}return V}var d;function f(){return d||(d={})}function p(R,V){if(R[0]==80&&R[1]==75)return vl(R,V);if((R[0]|32)==109&&(R[1]|32)==105)return ju(R,V);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var H=3,U=512,z=0,W=0,ue=0,Te=0,ce=0,fe=[],pe=R.slice(0,512);Hr(pe,0);var Ee=m(pe);switch(H=Ee[0],H){case 3:U=512;break;case 4:U=4096;break;case 0:if(Ee[1]==0)return vl(R,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+H)}U!==512&&(pe=R.slice(0,U),Hr(pe,28));var Be=R.slice(0,U);g(pe,H);var ze=pe.read_shift(4,"i");if(H===3&&ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ze);pe.l+=4,ue=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),Te=pe.read_shift(4,"i"),z=pe.read_shift(4,"i"),ce=pe.read_shift(4,"i"),W=pe.read_shift(4,"i");for(var De=-1,Ae=0;Ae<109&&(De=pe.read_shift(4,"i"),!(De<0));++Ae)fe[Ae]=De;var lt=b(R,U);N(ce,W,lt,U,fe);var Rt=C(lt,ue,fe,U);Rt[ue].name="!Directory",z>0&&Te!==ne&&(Rt[Te].name="!MiniFAT"),Rt[fe[0]].name="!FAT",Rt.fat_addrs=fe,Rt.ssz=U;var Ut={},cr=[],wi=[],ks=[];S(ue,Rt,lt,cr,z,Ut,wi,Te),v(wi,ks,cr),cr.shift();var Ta={FileIndex:wi,FullPaths:ks};return V&&V.raw&&(Ta.raw={header:Be,sectors:lt}),Ta}function m(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(he,"Header Signature: "),R.l+=16;var V=R.read_shift(2,"u");return[R.read_shift(2,"u"),V]}function g(R,V){var H=9;switch(R.l+=2,H=R.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+H);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+H);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+H)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function b(R,V){for(var H=Math.ceil(R.length/V)-1,U=[],z=1;z<H;++z)U[z-1]=R.slice(z*V,(z+1)*V);return U[H-1]=R.slice(H*V),U}function v(R,V,H){for(var U=0,z=0,W=0,ue=0,Te=0,ce=H.length,fe=[],pe=[];U<ce;++U)fe[U]=pe[U]=U,V[U]=H[U];for(;Te<pe.length;++Te)U=pe[Te],z=R[U].L,W=R[U].R,ue=R[U].C,fe[U]===U&&(z!==-1&&fe[z]!==z&&(fe[U]=fe[z]),W!==-1&&fe[W]!==W&&(fe[U]=fe[W])),ue!==-1&&(fe[ue]=U),z!==-1&&U!=fe[U]&&(fe[z]=fe[U],pe.lastIndexOf(z)<Te&&pe.push(z)),W!==-1&&U!=fe[U]&&(fe[W]=fe[U],pe.lastIndexOf(W)<Te&&pe.push(W));for(U=1;U<ce;++U)fe[U]===U&&(W!==-1&&fe[W]!==W?fe[U]=fe[W]:z!==-1&&fe[z]!==z&&(fe[U]=fe[z]));for(U=1;U<ce;++U)if(R[U].type!==0){if(Te=U,Te!=fe[Te])do Te=fe[Te],V[U]=V[Te]+"/"+V[U];while(Te!==0&&fe[Te]!==-1&&Te!=fe[Te]);fe[U]=-1}for(V[0]+="/",U=1;U<ce;++U)R[U].type!==2&&(V[U]+="/")}function y(R,V,H){for(var U=R.start,z=R.size,W=[],ue=U;H&&z>0&&ue>=0;)W.push(V.slice(ue*ee,ue*ee+ee)),z-=ee,ue=Ri(H,ue*4);return W.length===0?ke(0):Or(W).slice(0,R.size)}function N(R,V,H,U,z){var W=ne;if(R===ne){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var ue=H[R],Te=(U>>>2)-1;if(!ue)return;for(var ce=0;ce<Te&&(W=Ri(ue,ce*4))!==ne;++ce)z.push(W);N(Ri(ue,U-4),V-1,H,U,z)}}function _(R,V,H,U,z){var W=[],ue=[];z||(z=[]);var Te=U-1,ce=0,fe=0;for(ce=V;ce>=0;){z[ce]=!0,W[W.length]=ce,ue.push(R[ce]);var pe=H[Math.floor(ce*4/U)];if(fe=ce*4&Te,U<4+fe)throw new Error("FAT boundary crossed: "+ce+" 4 "+U);if(!R[pe])break;ce=Ri(R[pe],fe)}return{nodes:W,data:zy([ue])}}function C(R,V,H,U){var z=R.length,W=[],ue=[],Te=[],ce=[],fe=U-1,pe=0,Ee=0,Be=0,ze=0;for(pe=0;pe<z;++pe)if(Te=[],Be=pe+V,Be>=z&&(Be-=z),!ue[Be]){ce=[];var De=[];for(Ee=Be;Ee>=0;){De[Ee]=!0,ue[Ee]=!0,Te[Te.length]=Ee,ce.push(R[Ee]);var Ae=H[Math.floor(Ee*4/U)];if(ze=Ee*4&fe,U<4+ze)throw new Error("FAT boundary crossed: "+Ee+" 4 "+U);if(!R[Ae]||(Ee=Ri(R[Ae],ze),De[Ee]))break}W[Be]={nodes:Te,data:zy([ce])}}return W}function S(R,V,H,U,z,W,ue,Te){for(var ce=0,fe=U.length?2:0,pe=V[R].data,Ee=0,Be=0,ze;Ee<pe.length;Ee+=128){var De=pe.slice(Ee,Ee+128);Hr(De,64),Be=De.read_shift(2),ze=Gx(De,0,Be-fe),U.push(ze);var Ae={name:ze,type:De.read_shift(1),color:De.read_shift(1),L:De.read_shift(4,"i"),R:De.read_shift(4,"i"),C:De.read_shift(4,"i"),clsid:De.read_shift(16),state:De.read_shift(4,"i"),start:0,size:0},lt=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);lt!==0&&(Ae.ct=E(De,De.l-8));var Rt=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);Rt!==0&&(Ae.mt=E(De,De.l-8)),Ae.start=De.read_shift(4,"i"),Ae.size=De.read_shift(4,"i"),Ae.size<0&&Ae.start<0&&(Ae.size=Ae.type=0,Ae.start=ne,Ae.name=""),Ae.type===5?(ce=Ae.start,z>0&&ce!==ne&&(V[ce].name="!StreamData")):Ae.size>=4096?(Ae.storage="fat",V[Ae.start]===void 0&&(V[Ae.start]=_(H,Ae.start,V.fat_addrs,V.ssz)),V[Ae.start].name=Ae.name,Ae.content=V[Ae.start].data.slice(0,Ae.size)):(Ae.storage="minifat",Ae.size<0?Ae.size=0:ce!==ne&&Ae.start!==ne&&V[ce]&&(Ae.content=y(Ae,V[ce].data,(V[Te]||{}).data))),Ae.content&&Hr(Ae.content,0),W[ze]=Ae,ue.push(Ae)}}function E(R,V){return new Date((On(R,V+4)/1e7*Math.pow(2,32)+On(R,V)/1e7-11644473600)*1e3)}function O(R,V){return f(),p(d.readFileSync(R),V)}function F(R,V){var H=V&&V.type;switch(H||xt&&Buffer.isBuffer(R)&&(H="buffer"),H||"base64"){case"file":return O(R,V);case"base64":return p(Rn(Bn(R)),V);case"binary":return p(Rn(R),V)}return p(R,V)}function T(R,V){var H=V||{},U=H.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=U+"/",R.FileIndex[0]={name:U,type:5}),H.CLSID&&(R.FileIndex[0].clsid=H.CLSID),D(R)}function D(R){var V="Sh33tJ5";if(!Ye.find(R,"/"+V)){var H=ke(4);H[0]=55,H[1]=H[3]=50,H[2]=54,R.FileIndex.push({name:V,type:2,content:H,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+V),I(R)}}function I(R,V){T(R);for(var H=!1,U=!1,z=R.FullPaths.length-1;z>=0;--z){var W=R.FileIndex[z];switch(W.type){case 0:U?H=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:U=!0,isNaN(W.R*W.L*W.C)&&(H=!0),W.R>-1&&W.L>-1&&W.R==W.L&&(H=!0);break;default:H=!0;break}}if(!(!H&&!V)){var ue=new Date(1987,1,19),Te=0,ce=Object.create?Object.create(null):{},fe=[];for(z=0;z<R.FullPaths.length;++z)ce[R.FullPaths[z]]=!0,R.FileIndex[z].type!==0&&fe.push([R.FullPaths[z],R.FileIndex[z]]);for(z=0;z<fe.length;++z){var pe=n(fe[z][0]);U=ce[pe],U||(fe.push([pe,{name:s(pe).replace("/",""),type:1,clsid:xe,ct:ue,mt:ue,content:null}]),ce[pe]=!0)}for(fe.sort(function(ze,De){return r(ze[0],De[0])}),R.FullPaths=[],R.FileIndex=[],z=0;z<fe.length;++z)R.FullPaths[z]=fe[z][0],R.FileIndex[z]=fe[z][1];for(z=0;z<fe.length;++z){var Ee=R.FileIndex[z],Be=R.FullPaths[z];if(Ee.name=s(Be).replace("/",""),Ee.L=Ee.R=Ee.C=-(Ee.color=1),Ee.size=Ee.content?Ee.content.length:0,Ee.start=0,Ee.clsid=Ee.clsid||xe,z===0)Ee.C=fe.length>1?1:-1,Ee.size=0,Ee.type=5;else if(Be.slice(-1)=="/"){for(Te=z+1;Te<fe.length&&n(R.FullPaths[Te])!=Be;++Te);for(Ee.C=Te>=fe.length?-1:Te,Te=z+1;Te<fe.length&&n(R.FullPaths[Te])!=n(Be);++Te);Ee.R=Te>=fe.length?-1:Te,Ee.type=1}else n(R.FullPaths[z+1]||"")==n(Be)&&(Ee.R=z+1),Ee.type=2}}}function J(R,V){var H=V||{};if(H.fileType=="mad")return yi(R,H);switch(I(R),H.fileType){case"zip":return Ns(R,H)}var U=(function(ze){for(var De=0,Ae=0,lt=0;lt<ze.FileIndex.length;++lt){var Rt=ze.FileIndex[lt];if(Rt.content){var Ut=Rt.content.length;Ut>0&&(Ut<4096?De+=Ut+63>>6:Ae+=Ut+511>>9)}}for(var cr=ze.FullPaths.length+3>>2,wi=De+7>>3,ks=De+127>>7,Ta=wi+Ae+cr+ks,Cr=Ta+127>>7,Ro=Cr<=109?0:Math.ceil((Cr-109)/127);Ta+Cr+Ro+127>>7>Cr;)Ro=++Cr<=109?0:Math.ceil((Cr-109)/127);var ur=[1,Ro,Cr,ks,cr,Ae,De,0];return ze.FileIndex[0].size=De<<6,ur[7]=(ze.FileIndex[0].start=ur[0]+ur[1]+ur[2]+ur[3]+ur[4]+ur[5])+(ur[6]+7>>3),ur})(R),z=ke(U[7]<<9),W=0,ue=0;{for(W=0;W<8;++W)z.write_shift(1,Q[W]);for(W=0;W<8;++W)z.write_shift(2,0);for(z.write_shift(2,62),z.write_shift(2,3),z.write_shift(2,65534),z.write_shift(2,9),z.write_shift(2,6),W=0;W<3;++W)z.write_shift(2,0);for(z.write_shift(4,0),z.write_shift(4,U[2]),z.write_shift(4,U[0]+U[1]+U[2]+U[3]-1),z.write_shift(4,0),z.write_shift(4,4096),z.write_shift(4,U[3]?U[0]+U[1]+U[2]-1:ne),z.write_shift(4,U[3]),z.write_shift(-4,U[1]?U[0]-1:ne),z.write_shift(4,U[1]),W=0;W<109;++W)z.write_shift(-4,W<U[2]?U[1]+W:-1)}if(U[1])for(ue=0;ue<U[1];++ue){for(;W<236+ue*127;++W)z.write_shift(-4,W<U[2]?U[1]+W:-1);z.write_shift(-4,ue===U[1]-1?ne:ue+1)}var Te=function(ze){for(ue+=ze;W<ue-1;++W)z.write_shift(-4,W+1);ze&&(++W,z.write_shift(-4,ne))};for(ue=W=0,ue+=U[1];W<ue;++W)z.write_shift(-4,Y.DIFSECT);for(ue+=U[2];W<ue;++W)z.write_shift(-4,Y.FATSECT);Te(U[3]),Te(U[4]);for(var ce=0,fe=0,pe=R.FileIndex[0];ce<R.FileIndex.length;++ce)pe=R.FileIndex[ce],pe.content&&(fe=pe.content.length,!(fe<4096)&&(pe.start=ue,Te(fe+511>>9)));for(Te(U[6]+7>>3);z.l&511;)z.write_shift(-4,Y.ENDOFCHAIN);for(ue=W=0,ce=0;ce<R.FileIndex.length;++ce)pe=R.FileIndex[ce],pe.content&&(fe=pe.content.length,!(!fe||fe>=4096)&&(pe.start=ue,Te(fe+63>>6)));for(;z.l&511;)z.write_shift(-4,Y.ENDOFCHAIN);for(W=0;W<U[4]<<2;++W){var Ee=R.FullPaths[W];if(!Ee||Ee.length===0){for(ce=0;ce<17;++ce)z.write_shift(4,0);for(ce=0;ce<3;++ce)z.write_shift(4,-1);for(ce=0;ce<12;++ce)z.write_shift(4,0);continue}pe=R.FileIndex[W],W===0&&(pe.start=pe.size?pe.start-1:ne);var Be=W===0&&H.root||pe.name;if(fe=2*(Be.length+1),z.write_shift(64,Be,"utf16le"),z.write_shift(2,fe),z.write_shift(1,pe.type),z.write_shift(1,pe.color),z.write_shift(-4,pe.L),z.write_shift(-4,pe.R),z.write_shift(-4,pe.C),pe.clsid)z.write_shift(16,pe.clsid,"hex");else for(ce=0;ce<4;++ce)z.write_shift(4,0);z.write_shift(4,pe.state||0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,pe.start),z.write_shift(4,pe.size),z.write_shift(4,0)}for(W=1;W<R.FileIndex.length;++W)if(pe=R.FileIndex[W],pe.size>=4096)if(z.l=pe.start+1<<9,xt&&Buffer.isBuffer(pe.content))pe.content.copy(z,z.l,0,pe.size),z.l+=pe.size+511&-512;else{for(ce=0;ce<pe.size;++ce)z.write_shift(1,pe.content[ce]);for(;ce&511;++ce)z.write_shift(1,0)}for(W=1;W<R.FileIndex.length;++W)if(pe=R.FileIndex[W],pe.size>0&&pe.size<4096)if(xt&&Buffer.isBuffer(pe.content))pe.content.copy(z,z.l,0,pe.size),z.l+=pe.size+63&-64;else{for(ce=0;ce<pe.size;++ce)z.write_shift(1,pe.content[ce]);for(;ce&63;++ce)z.write_shift(1,0)}if(xt)z.l=z.length;else for(;z.l<z.length;)z.write_shift(1,0);return z}function Z(R,V){var H=R.FullPaths.map(function(ce){return ce.toUpperCase()}),U=H.map(function(ce){var fe=ce.split("/");return fe[fe.length-(ce.slice(-1)=="/"?2:1)]}),z=!1;V.charCodeAt(0)===47?(z=!0,V=H[0].slice(0,-1)+V):z=V.indexOf("/")!==-1;var W=V.toUpperCase(),ue=z===!0?H.indexOf(W):U.indexOf(W);if(ue!==-1)return R.FileIndex[ue];var Te=!W.match(kc);for(W=W.replace(un,""),Te&&(W=W.replace(kc,"!")),ue=0;ue<H.length;++ue)if((Te?H[ue].replace(kc,"!"):H[ue]).replace(un,"")==W||(Te?U[ue].replace(kc,"!"):U[ue]).replace(un,"")==W)return R.FileIndex[ue];return null}var ee=64,ne=-2,he="d0cf11e0a1b11ae1",Q=[208,207,17,224,161,177,26,225],xe="00000000000000000000000000000000",Y={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ne,FREESECT:-1,HEADER_SIGNATURE:he,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:xe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function le(R,V,H){f();var U=J(R,H);d.writeFileSync(V,U)}function X(R){for(var V=new Array(R.length),H=0;H<R.length;++H)V[H]=String.fromCharCode(R[H]);return V.join("")}function ve(R,V){var H=J(R,V);switch(V&&V.type||"buffer"){case"file":return f(),d.writeFileSync(V.filename,H),H;case"binary":return typeof H=="string"?H:X(H);case"base64":return zc(typeof H=="string"?H:X(H));case"buffer":if(xt)return Buffer.isBuffer(H)?H:ms(H);case"array":return typeof H=="string"?Rn(H):H}return H}var K;function k(R){try{var V=R.InflateRaw,H=new V;if(H._processChunk(new Uint8Array([3,0]),H._finishFlushFlag),H.bytesRead)K=R;else throw new Error("zlib does not expose bytesRead")}catch(U){console.error("cannot use native zlib: "+(U.message||U))}}function B(R,V){if(!K)return ka(R,V);var H=K.InflateRaw,U=new H,z=U._processChunk(R.slice(R.l),U._finishFlushFlag);return R.l+=U.bytesRead,z}function A(R){return K?K.deflateRawSync(R):tt(R)}var M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],de=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function be(R){var V=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(V>>16|V>>8|V)&255}for(var we=typeof Uint8Array<"u",ye=we?new Uint8Array(256):[],Je=0;Je<256;++Je)ye[Je]=be(Je);function G(R,V){var H=ye[R&255];return V<=8?H>>>8-V:(H=H<<8|ye[R>>8&255],V<=16?H>>>16-V:(H=H<<8|ye[R>>16&255],H>>>24-V))}function Ne(R,V){var H=V&7,U=V>>>3;return(R[U]|(H<=6?0:R[U+1]<<8))>>>H&3}function He(R,V){var H=V&7,U=V>>>3;return(R[U]|(H<=5?0:R[U+1]<<8))>>>H&7}function ht(R,V){var H=V&7,U=V>>>3;return(R[U]|(H<=4?0:R[U+1]<<8))>>>H&15}function rt(R,V){var H=V&7,U=V>>>3;return(R[U]|(H<=3?0:R[U+1]<<8))>>>H&31}function Oe(R,V){var H=V&7,U=V>>>3;return(R[U]|(H<=1?0:R[U+1]<<8))>>>H&127}function Pt(R,V,H){var U=V&7,z=V>>>3,W=(1<<H)-1,ue=R[z]>>>U;return H<8-U||(ue|=R[z+1]<<8-U,H<16-U)||(ue|=R[z+2]<<16-U,H<24-U)||(ue|=R[z+3]<<24-U),ue&W}function lr(R,V,H){var U=V&7,z=V>>>3;return U<=5?R[z]|=(H&7)<<U:(R[z]|=H<<U&255,R[z+1]=(H&7)>>8-U),V+3}function or(R,V,H){var U=V&7,z=V>>>3;return H=(H&1)<<U,R[z]|=H,V+1}function _r(R,V,H){var U=V&7,z=V>>>3;return H<<=U,R[z]|=H&255,H>>>=8,R[z+1]=H,V+8}function sa(R,V,H){var U=V&7,z=V>>>3;return H<<=U,R[z]|=H&255,H>>>=8,R[z+1]=H&255,R[z+2]=H>>>8,V+16}function Cn(R,V){var H=R.length,U=2*H>V?2*H:V+5,z=0;if(H>=V)return R;if(xt){var W=Ty(U);if(R.copy)R.copy(W);else for(;z<R.length;++z)W[z]=R[z];return W}else if(we){var ue=new Uint8Array(U);if(ue.set)ue.set(R);else for(;z<H;++z)ue[z]=R[z];return ue}return R.length=U,R}function Re(R){for(var V=new Array(R),H=0;H<R;++H)V[H]=0;return V}function Ge(R,V,H){var U=1,z=0,W=0,ue=0,Te=0,ce=R.length,fe=we?new Uint16Array(32):Re(32);for(W=0;W<32;++W)fe[W]=0;for(W=ce;W<H;++W)R[W]=0;ce=R.length;var pe=we?new Uint16Array(ce):Re(ce);for(W=0;W<ce;++W)fe[z=R[W]]++,U<z&&(U=z),pe[W]=0;for(fe[0]=0,W=1;W<=U;++W)fe[W+16]=Te=Te+fe[W-1]<<1;for(W=0;W<ce;++W)Te=R[W],Te!=0&&(pe[W]=fe[Te+16]++);var Ee=0;for(W=0;W<ce;++W)if(Ee=R[W],Ee!=0)for(Te=G(pe[W],U)>>U-Ee,ue=(1<<U+4-Ee)-1;ue>=0;--ue)V[Te|ue<<Ee]=Ee&15|W<<4;return U}var Tt=we?new Uint16Array(512):Re(512),Lt=we?new Uint16Array(32):Re(32);if(!we){for(var bt=0;bt<512;++bt)Tt[bt]=0;for(bt=0;bt<32;++bt)Lt[bt]=0}(function(){for(var R=[],V=0;V<32;V++)R.push(5);Ge(R,Lt,32);var H=[];for(V=0;V<=143;V++)H.push(8);for(;V<=255;V++)H.push(9);for(;V<=279;V++)H.push(7);for(;V<=287;V++)H.push(8);Ge(H,Tt,288)})();var br=(function(){for(var V=we?new Uint8Array(32768):[],H=0,U=0;H<de.length-1;++H)for(;U<de[H+1];++U)V[U]=H;for(;U<32768;++U)V[U]=29;var z=we?new Uint8Array(259):[];for(H=0,U=0;H<ae.length-1;++H)for(;U<ae[H+1];++U)z[U]=H;function W(Te,ce){for(var fe=0;fe<Te.length;){var pe=Math.min(65535,Te.length-fe),Ee=fe+pe==Te.length;for(ce.write_shift(1,+Ee),ce.write_shift(2,pe),ce.write_shift(2,~pe&65535);pe-- >0;)ce[ce.l++]=Te[fe++]}return ce.l}function ue(Te,ce){for(var fe=0,pe=0,Ee=we?new Uint16Array(32768):[];pe<Te.length;){var Be=Math.min(65535,Te.length-pe);if(Be<10){for(fe=lr(ce,fe,+(pe+Be==Te.length)),fe&7&&(fe+=8-(fe&7)),ce.l=fe/8|0,ce.write_shift(2,Be),ce.write_shift(2,~Be&65535);Be-- >0;)ce[ce.l++]=Te[pe++];fe=ce.l*8;continue}fe=lr(ce,fe,+(pe+Be==Te.length)+2);for(var ze=0;Be-- >0;){var De=Te[pe];ze=(ze<<5^De)&32767;var Ae=-1,lt=0;if((Ae=Ee[ze])&&(Ae|=pe&-32768,Ae>pe&&(Ae-=32768),Ae<pe))for(;Te[Ae+lt]==Te[pe+lt]&&lt<250;)++lt;if(lt>2){De=z[lt],De<=22?fe=_r(ce,fe,ye[De+1]>>1)-1:(_r(ce,fe,3),fe+=5,_r(ce,fe,ye[De-23]>>5),fe+=3);var Rt=De<8?0:De-4>>2;Rt>0&&(sa(ce,fe,lt-ae[De]),fe+=Rt),De=V[pe-Ae],fe=_r(ce,fe,ye[De]>>3),fe-=3;var Ut=De<4?0:De-2>>1;Ut>0&&(sa(ce,fe,pe-Ae-de[De]),fe+=Ut);for(var cr=0;cr<lt;++cr)Ee[ze]=pe&32767,ze=(ze<<5^Te[pe])&32767,++pe;Be-=lt-1}else De<=143?De=De+48:fe=or(ce,fe,1),fe=_r(ce,fe,ye[De]),Ee[ze]=pe&32767,++pe}fe=_r(ce,fe,0)-1}return ce.l=(fe+7)/8|0,ce.l}return function(ce,fe){return ce.length<8?W(ce,fe):ue(ce,fe)}})();function tt(R){var V=ke(50+Math.floor(R.length*1.1)),H=br(R,V);return V.slice(0,H)}var St=we?new Uint16Array(32768):Re(32768),Sr=we?new Uint16Array(32768):Re(32768),Ht=we?new Uint16Array(128):Re(128),tn=1,ys=1;function Ka(R,V){var H=rt(R,V)+257;V+=5;var U=rt(R,V)+1;V+=5;var z=ht(R,V)+4;V+=4;for(var W=0,ue=we?new Uint8Array(19):Re(19),Te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ce=1,fe=we?new Uint8Array(8):Re(8),pe=we?new Uint8Array(8):Re(8),Ee=ue.length,Be=0;Be<z;++Be)ue[M[Be]]=W=He(R,V),ce<W&&(ce=W),fe[W]++,V+=3;var ze=0;for(fe[0]=0,Be=1;Be<=ce;++Be)pe[Be]=ze=ze+fe[Be-1]<<1;for(Be=0;Be<Ee;++Be)(ze=ue[Be])!=0&&(Te[Be]=pe[ze]++);var De=0;for(Be=0;Be<Ee;++Be)if(De=ue[Be],De!=0){ze=ye[Te[Be]]>>8-De;for(var Ae=(1<<7-De)-1;Ae>=0;--Ae)Ht[ze|Ae<<De]=De&7|Be<<3}var lt=[];for(ce=1;lt.length<H+U;)switch(ze=Ht[Oe(R,V)],V+=ze&7,ze>>>=3){case 16:for(W=3+Ne(R,V),V+=2,ze=lt[lt.length-1];W-- >0;)lt.push(ze);break;case 17:for(W=3+He(R,V),V+=3;W-- >0;)lt.push(0);break;case 18:for(W=11+Oe(R,V),V+=7;W-- >0;)lt.push(0);break;default:lt.push(ze),ce<ze&&(ce=ze);break}var Rt=lt.slice(0,H),Ut=lt.slice(H);for(Be=H;Be<286;++Be)Rt[Be]=0;for(Be=U;Be<30;++Be)Ut[Be]=0;return tn=Ge(Rt,St,286),ys=Ge(Ut,Sr,30),V}function $a(R,V){if(R[0]==3&&!(R[1]&3))return[oi(V),2];for(var H=0,U=0,z=Ty(V||1<<18),W=0,ue=z.length>>>0,Te=0,ce=0;(U&1)==0;){if(U=He(R,H),H+=3,U>>>1)U>>1==1?(Te=9,ce=5):(H=Ka(R,H),Te=tn,ce=ys);else{H&7&&(H+=8-(H&7));var fe=R[H>>>3]|R[(H>>>3)+1]<<8;if(H+=32,fe>0)for(!V&&ue<W+fe&&(z=Cn(z,W+fe),ue=z.length);fe-- >0;)z[W++]=R[H>>>3],H+=8;continue}for(;;){!V&&ue<W+32767&&(z=Cn(z,W+32767),ue=z.length);var pe=Pt(R,H,Te),Ee=U>>>1==1?Tt[pe]:St[pe];if(H+=Ee&15,Ee>>>=4,(Ee>>>8&255)===0)z[W++]=Ee;else{if(Ee==256)break;Ee-=257;var Be=Ee<8?0:Ee-4>>2;Be>5&&(Be=0);var ze=W+ae[Ee];Be>0&&(ze+=Pt(R,H,Be),H+=Be),pe=Pt(R,H,ce),Ee=U>>>1==1?Lt[pe]:Sr[pe],H+=Ee&15,Ee>>>=4;var De=Ee<4?0:Ee-2>>1,Ae=de[Ee];for(De>0&&(Ae+=Pt(R,H,De),H+=De),!V&&ue<ze&&(z=Cn(z,ze+100),ue=z.length);W<ze;)z[W]=z[W-Ae],++W}}}return V?[z,H+7>>>3]:[z.slice(0,W),H+7>>>3]}function ka(R,V){var H=R.slice(R.l||0),U=$a(H,V);return R.l+=U[1],U[0]}function bs(R,V){if(R)typeof console<"u"&&console.error(V);else throw new Error(V)}function vl(R,V){var H=R;Hr(H,0);var U=[],z=[],W={FileIndex:U,FullPaths:z};T(W,{root:V.root});for(var ue=H.length-4;(H[ue]!=80||H[ue+1]!=75||H[ue+2]!=5||H[ue+3]!=6)&&ue>=0;)--ue;H.l=ue+4,H.l+=4;var Te=H.read_shift(2);H.l+=6;var ce=H.read_shift(4);for(H.l=ce,ue=0;ue<Te;++ue){H.l+=20;var fe=H.read_shift(4),pe=H.read_shift(4),Ee=H.read_shift(2),Be=H.read_shift(2),ze=H.read_shift(2);H.l+=8;var De=H.read_shift(4),Ae=u(H.slice(H.l+Ee,H.l+Ee+Be));H.l+=Ee+Be+ze;var lt=H.l;H.l=De+4,ws(H,fe,pe,W,Ae),H.l=lt}return W}function ws(R,V,H,U,z){R.l+=2;var W=R.read_shift(2),ue=R.read_shift(2),Te=c(R);if(W&8257)throw new Error("Unsupported ZIP encryption");for(var ce=R.read_shift(4),fe=R.read_shift(4),pe=R.read_shift(4),Ee=R.read_shift(2),Be=R.read_shift(2),ze="",De=0;De<Ee;++De)ze+=String.fromCharCode(R[R.l++]);if(Be){var Ae=u(R.slice(R.l,R.l+Be));(Ae[21589]||{}).mt&&(Te=Ae[21589].mt),((z||{})[21589]||{}).mt&&(Te=z[21589].mt)}R.l+=Be;var lt=R.slice(R.l,R.l+fe);switch(ue){case 8:lt=B(R,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ue)}var Rt=!1;W&8&&(ce=R.read_shift(4),ce==134695760&&(ce=R.read_shift(4),Rt=!0),fe=R.read_shift(4),pe=R.read_shift(4)),fe!=V&&bs(Rt,"Bad compressed size: "+V+" != "+fe),pe!=H&&bs(Rt,"Bad uncompressed size: "+H+" != "+pe),Wa(U,ze,lt,{unsafe:!0,mt:Te})}function Ns(R,V){var H=V||{},U=[],z=[],W=ke(1),ue=H.compression?8:0,Te=0,ce=0,fe=0,pe=0,Ee=0,Be=R.FullPaths[0],ze=Be,De=R.FileIndex[0],Ae=[],lt=0;for(ce=1;ce<R.FullPaths.length;++ce)if(ze=R.FullPaths[ce].slice(Be.length),De=R.FileIndex[ce],!(!De.size||!De.content||ze=="Sh33tJ5")){var Rt=pe,Ut=ke(ze.length);for(fe=0;fe<ze.length;++fe)Ut.write_shift(1,ze.charCodeAt(fe)&127);Ut=Ut.slice(0,Ut.l),Ae[Ee]=I5.buf(De.content,0);var cr=De.content;ue==8&&(cr=A(cr)),W=ke(30),W.write_shift(4,67324752),W.write_shift(2,20),W.write_shift(2,Te),W.write_shift(2,ue),De.mt?l(W,De.mt):W.write_shift(4,0),W.write_shift(-4,Ae[Ee]),W.write_shift(4,cr.length),W.write_shift(4,De.content.length),W.write_shift(2,Ut.length),W.write_shift(2,0),pe+=W.length,U.push(W),pe+=Ut.length,U.push(Ut),pe+=cr.length,U.push(cr),W=ke(46),W.write_shift(4,33639248),W.write_shift(2,0),W.write_shift(2,20),W.write_shift(2,Te),W.write_shift(2,ue),W.write_shift(4,0),W.write_shift(-4,Ae[Ee]),W.write_shift(4,cr.length),W.write_shift(4,De.content.length),W.write_shift(2,Ut.length),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(4,0),W.write_shift(4,Rt),lt+=W.l,z.push(W),lt+=Ut.length,z.push(Ut),++Ee}return W=ke(22),W.write_shift(4,101010256),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,Ee),W.write_shift(2,Ee),W.write_shift(4,lt),W.write_shift(4,pe),W.write_shift(2,0),Or([Or(U),Or(z),W])}var vi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function wu(R,V){if(R.ctype)return R.ctype;var H=R.name||"",U=H.match(/\.([^\.]+)$/);return U&&vi[U[1]]||V&&(U=(H=V).match(/[\.\\]([^\.\\])+$/),U&&vi[U[1]])?vi[U[1]]:"application/octet-stream"}function Nu(R){for(var V=zc(R),H=[],U=0;U<V.length;U+=76)H.push(V.slice(U,U+76));return H.join(`\r
`)+`\r
`}function ku(R){var V=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(fe){var pe=fe.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var H=[],U=V.split(`\r
`),z=0;z<U.length;++z){var W=U[z];if(W.length==0){H.push("");continue}for(var ue=0;ue<W.length;){var Te=76,ce=W.slice(ue,ue+Te);ce.charAt(Te-1)=="="?Te--:ce.charAt(Te-2)=="="?Te-=2:ce.charAt(Te-3)=="="&&(Te-=3),ce=W.slice(ue,ue+Te),ue+=Te,ue<W.length&&(ce+="="),H.push(ce)}}return H.join(`\r
`)}function Tu(R){for(var V=[],H=0;H<R.length;++H){for(var U=R[H];H<=R.length&&U.charAt(U.length-1)=="=";)U=U.slice(0,U.length-1)+R[++H];V.push(U)}for(var z=0;z<V.length;++z)V[z]=V[z].replace(/[=][0-9A-Fa-f]{2}/g,function(W){return String.fromCharCode(parseInt(W.slice(1),16))});return Rn(V.join(`\r
`))}function Lo(R,V,H){for(var U="",z="",W="",ue,Te=0;Te<10;++Te){var ce=V[Te];if(!ce||ce.match(/^\s*$/))break;var fe=ce.match(/^(.*?):\s*([^\s].*)$/);if(fe)switch(fe[1].toLowerCase()){case"content-location":U=fe[2].trim();break;case"content-type":W=fe[2].trim();break;case"content-transfer-encoding":z=fe[2].trim();break}}switch(++Te,z.toLowerCase()){case"base64":ue=Rn(Bn(V.slice(Te).join("")));break;case"quoted-printable":ue=Tu(V.slice(Te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+z)}var pe=Wa(R,U.slice(H.length),ue,{unsafe:!0});W&&(pe.ctype=W)}function ju(R,V){if(X(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var H=V&&V.root||"",U=(xt&&Buffer.isBuffer(R)?R.toString("binary"):X(R)).split(`\r
`),z=0,W="";for(z=0;z<U.length;++z)if(W=U[z],!!/^Content-Location:/i.test(W)&&(W=W.slice(W.indexOf("file")),H||(H=W.slice(0,W.lastIndexOf("/")+1)),W.slice(0,H.length)!=H))for(;H.length>0&&(H=H.slice(0,H.length-1),H=H.slice(0,H.lastIndexOf("/")+1),W.slice(0,H.length)!=H););var ue=(U[1]||"").match(/boundary="(.*?)"/);if(!ue)throw new Error("MAD cannot find boundary");var Te="--"+(ue[1]||""),ce=[],fe=[],pe={FileIndex:ce,FullPaths:fe};T(pe);var Ee,Be=0;for(z=0;z<U.length;++z){var ze=U[z];ze!==Te&&ze!==Te+"--"||(Be++&&Lo(pe,U.slice(Ee,z),H),Ee=z)}return pe}function yi(R,V){var H=V||{},U=H.boundary||"SheetJS";U="------="+U;for(var z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+U.slice(2)+'"',"","",""],W=R.FullPaths[0],ue=W,Te=R.FileIndex[0],ce=1;ce<R.FullPaths.length;++ce)if(ue=R.FullPaths[ce].slice(W.length),Te=R.FileIndex[ce],!(!Te.size||!Te.content||ue=="Sh33tJ5")){ue=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(lt){return"_x"+lt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(lt){return"_u"+lt.charCodeAt(0).toString(16)+"_"});for(var fe=Te.content,pe=xt&&Buffer.isBuffer(fe)?fe.toString("binary"):X(fe),Ee=0,Be=Math.min(1024,pe.length),ze=0,De=0;De<=Be;++De)(ze=pe.charCodeAt(De))>=32&&ze<128&&++Ee;var Ae=Ee>=Be*4/5;z.push(U),z.push("Content-Location: "+(H.root||"file:///C:/SheetJS/")+ue),z.push("Content-Transfer-Encoding: "+(Ae?"quoted-printable":"base64")),z.push("Content-Type: "+wu(Te,ue)),z.push(""),z.push(Ae?ku(pe):Nu(pe))}return z.push(U+`--\r
`),z.join(`\r
`)}function Oo(R){var V={};return T(V,R),V}function Wa(R,V,H,U){var z=U&&U.unsafe;z||T(R);var W=!z&&Ye.find(R,V);if(!W){var ue=R.FullPaths[0];V.slice(0,ue.length)==ue?ue=V:(ue.slice(-1)!="/"&&(ue+="/"),ue=(ue+V).replace("//","/")),W={name:s(V),type:2},R.FileIndex.push(W),R.FullPaths.push(ue),z||Ye.utils.cfb_gc(R)}return W.content=H,W.size=H?H.length:0,U&&(U.CLSID&&(W.clsid=U.CLSID),U.mt&&(W.mt=U.mt),U.ct&&(W.ct=U.ct)),W}function Xh(R,V){T(R);var H=Ye.find(R,V);if(H){for(var U=0;U<R.FileIndex.length;++U)if(R.FileIndex[U]==H)return R.FileIndex.splice(U,1),R.FullPaths.splice(U,1),!0}return!1}function bi(R,V,H){T(R);var U=Ye.find(R,V);if(U){for(var z=0;z<R.FileIndex.length;++z)if(R.FileIndex[z]==U)return R.FileIndex[z].name=s(H),R.FullPaths[z]=H,!0}return!1}function yl(R){I(R,!0)}return t.find=Z,t.read=F,t.parse=p,t.write=ve,t.writeFile=le,t.utils={cfb_new:Oo,cfb_add:Wa,cfb_del:Xh,cfb_mov:bi,cfb_gc:yl,ReadShift:Ec,CheckField:Jw,prep_blob:Hr,bconcat:Or,use_zlib:k,_deflateRaw:tt,_inflateRaw:ka,consts:Y},t})();function M5(e){return typeof e=="string"?Hh(e):Array.isArray(e)?u5(e):e}function fu(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Hh(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Ma(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([M5(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:e,saveAs:!0});var c=document.createElement("a");if(c.download!=null)return c.download=e,c.href=l,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=xi(t)),u.write(t),u.close(),t}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function B5(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ir(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Dy(e,t){for(var r=[],n=ir(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function Vh(e){for(var t=[],r=ir(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function zh(e){for(var t=[],r=ir(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function H5(e){for(var t=[],r=ir(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var gh=new Date(1899,11,30,0,0,0);function jr(e,t){var r=e.getTime(),n=gh.getTime()+(e.getTimezoneOffset()-gh.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var Aw=new Date,U5=gh.getTime()+(Aw.getTimezoneOffset()-gh.getTimezoneOffset())*6e4,Py=Aw.getTimezoneOffset();function Kh(e){var t=new Date;return t.setTime(e*24*60*60*1e3+U5),t.getTimezoneOffset()!==Py&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Py)*6e4),t}function V5(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=s.length;++l)if(s[l]){switch(r=1,l>3&&(n=!0),s[l].slice(s[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[l].slice(s[l].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[l],10)}return t}var Ly=new Date("2017-02-19T19:06:09.000Z"),Dw=isNaN(Ly.getFullYear())?new Date("2/19/17"):Ly,z5=Dw.getFullYear()==2017;function Wt(e,t){var r=new Date(e);if(z5)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Dw.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function sl(e,t){if(xt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ma(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ma(yw(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ma(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ma(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return r[l]||l})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Gt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Gt(e[r]));return t}function ar(e,t){for(var r="";r.length<t;)r+=e;return r}function ba(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,l){return r=-r,l}),!isNaN(t=Number(n)))?t/r:t}var K5=["january","february","march","april","may","june","july","august","september","october","november","december"];function No(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),l=t.getDate();if(isNaN(l))return r;var c=e.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&K5.indexOf(c)==-1)return r}else if(c.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||l>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var $5=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var l=r.split(n),c=[l[0]],u=1;u<l.length;++u)c.push(s),c.push(l[u]);return c}})();function Pw(e){return e?e.content&&e.type?sl(e.content,!0):e.data?Nc(e.data):e.asNodeBuffer&&xt?Nc(e.asNodeBuffer().toString("binary")):e.asBinary?Nc(e.asBinary()):e._data&&e._data.getContent?Nc(sl(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Lw(e){if(!e)return null;if(e.data)return Ny(e.data);if(e.asNodeBuffer&&xt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Ny(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function W5(e){return e&&e.name.slice(-4)===".bin"?Lw(e):Pw(e)}function Yn(e,t){for(var r=e.FullPaths||ir(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),l=0;l<r.length;++l){var c=r[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==c||s==c)return e.files?e.files[r[l]]:e.FileIndex[l]}return null}function Ux(e,t){var r=Yn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function vr(e,t,r){if(!r)return W5(Ux(e,t));if(!t)return null;try{return vr(e,t)}catch{return null}}function In(e,t,r){if(!r)return Pw(Ux(e,t));if(!t)return null;try{return In(e,t)}catch{return null}}function G5(e,t,r){return Lw(Ux(e,t))}function Oy(e){for(var t=e.FullPaths||ir(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function dt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return xt?n=ms(r):n=h5(r),Ye.utils.cfb_add(e,t,n)}Ye.utils.cfb_add(e,t,r)}else e.file(t,r)}function Vx(){return Ye.utils.cfb_new()}function Ow(e,t){switch(t.type){case"base64":return Ye.read(e,{type:"base64"});case"binary":return Ye.read(e,{type:"binary"});case"buffer":case"array":return Ye.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Tc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var xr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,q5=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Ry=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,X5=/<[^>]*>/g,en=xr.match(Ry)?Ry:X5,Q5=/<\w*:/,Y5=/<(\/?)\w+:/;function st(e,t,r){for(var n={},s=0,l=0;s!==e.length&&!((l=e.charCodeAt(s))===32||l===10||l===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var c=e.match(q5),u=0,d="",f=0,p="",m="",g=1;if(c)for(f=0;f!=c.length;++f){for(m=c[f],l=0;l!=m.length&&m.charCodeAt(l)!==61;++l);for(p=m.slice(0,l).trim();m.charCodeAt(l+1)==32;)++l;for(g=(s=m.charCodeAt(l+1))==34||s==39?1:0,d=m.slice(l+1+g,m.length-g),u=0;u!=p.length&&p.charCodeAt(u)!==58;++u);if(u===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=d,n[p.toLowerCase()]=d;else{var b=(u===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(u+1);if(n[b]&&p.slice(u-3,u)=="ext")continue;n[b]=d,n[b.toLowerCase()]=d}}return n}function Va(e){return e.replace(Y5,"<$1")}var Rw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},zx=Vh(Rw),Nt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",l=s.indexOf("<![CDATA[");if(l==-1)return s.replace(e,function(u,d){return Rw[u]||String.fromCharCode(parseInt(d,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,d){return String.fromCharCode(parseInt(d,16))});var c=s.indexOf("]]>");return r(s.slice(0,l))+s.slice(l+9,c)+r(s.slice(c+3))}})(),Kx=/[&<>'"]/g,J5=/[\u0000-\u0008\u000b-\u001f]/g;function Dt(e){var t=e+"";return t.replace(Kx,function(r){return zx[r]}).replace(J5,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Iy(e){return Dt(e).replace(/ /g,"_x0020_")}var Iw=/[\u0000-\u001f]/g;function $x(e){var t=e+"";return t.replace(Kx,function(r){return zx[r]}).replace(/\n/g,"<br/>").replace(Iw,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Z5(e){var t=e+"";return t.replace(Kx,function(r){return zx[r]}).replace(Iw,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var My=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function eF(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function $t(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function np(e){for(var t="",r=0,n=0,s=0,l=0,c=0,u=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){c=(n&31)<<6,c|=s&63,t+=String.fromCharCode(c);continue}if(l=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|l&63);continue}c=e.charCodeAt(r++),u=((n&7)<<18|(s&63)<<12|(l&63)<<6|c&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function By(e){var t=oi(2*e.length),r,n,s=1,l=0,c=0,u;for(n=0;n<e.length;n+=s)s=1,(u=e.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(e.charCodeAt(n+1)&63),s=2):u<240?(r=(u&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(u&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,c=55296+(r>>>10&1023),r=56320+(r&1023)),c!==0&&(t[l++]=c&255,t[l++]=c>>>8,c=0),t[l++]=r%256,t[l++]=r>>>8;return t.slice(0,l).toString("ucs2")}function Hy(e){return ms(e,"binary").toString("utf8")}var M0="foo bar baz",Ot=xt&&(Hy(M0)==np(M0)&&Hy||By(M0)==np(M0)&&By)||np,Ma=xt?function(e){return ms(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},$c=(function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),Mw=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}})(),tF=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),rF=/<\/?(?:vt:)?variant>/g,nF=/<(?:vt:)([^>]*)>([\s\S]*)</;function Uy(e,t){var r=st(e),n=e.match(tF(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(l){var c=l.replace(rF,"").match(nF);c&&s.push({v:Ot(c[2]),t:c[1]})}),s}var Bw=/(^\s|\s$|\n)/;function Ur(e,t){return"<"+e+(t.match(Bw)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Wc(e){return ir(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ie(e,t,r){return"<"+e+(r!=null?Wc(r):"")+(t!=null?(t.match(Bw)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function qp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function aF(e,t){switch(typeof e){case"string":var r=Ie("vt:lpwstr",Dt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ie((e|0)==e?"vt:i4":"vt:r8",Dt(String(e)));case"boolean":return Ie("vt:bool",e?"true":"false")}if(e instanceof Date)return Ie("vt:filetime",qp(e));throw new Error("Unable to serialize "+e)}function Wx(e){if(xt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ot(xi(Mx(e)));throw new Error("Bad input format: expected Buffer or string")}var Gc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Tr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},dl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ln={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function sF(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,l=5;l>=0;--l)s=s*256+e[t+l];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function iF(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,l=0,c=n?-t:t;isFinite(c)?c==0?s=l=0:(s=Math.floor(Math.log(c)/Math.LN2),l=c*Math.pow(2,52-s),s<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?s=-1022:(l-=Math.pow(2,52),s+=1023)):(s=2047,l=isNaN(t)?26985:0);for(var u=0;u<=5;++u,l/=256)e[r+u]=l&255;e[r+6]=(s&15)<<4|l&15,e[r+7]=s>>4|n}var Vy=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,l=e[0][n].length;s<l;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},zy=xt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ms(t)})):Vy(e)}:Vy,Ky=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(cs(e,s)));return n.join("").replace(un,"")},Gx=xt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(un,""):Ky(e,t,r)}:Ky,$y=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},Hw=xt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):$y(e,t,r)}:$y,Wy=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Yl(e,s)));return n.join("")},pu=xt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Wy(t,r,n)}:Wy,Uw=function(e,t){var r=On(e,t);return r>0?pu(e,t+4,t+4+r-1):""},Vw=Uw,zw=function(e,t){var r=On(e,t);return r>0?pu(e,t+4,t+4+r-1):""},Kw=zw,$w=function(e,t){var r=2*On(e,t);return r>0?pu(e,t+4,t+4+r-1):""},Ww=$w,Gw=function(t,r){var n=On(t,r);return n>0?Gx(t,r+4,r+4+n):""},qw=Gw,Xw=function(e,t){var r=On(e,t);return r>0?pu(e,t+4,t+4+r):""},Qw=Xw,Yw=function(e,t){return sF(e,t)},vh=Yw,qx=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};xt&&(Vw=function(t,r){if(!Buffer.isBuffer(t))return Uw(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Kw=function(t,r){if(!Buffer.isBuffer(t))return zw(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Ww=function(t,r){if(!Buffer.isBuffer(t))return $w(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},qw=function(t,r){if(!Buffer.isBuffer(t))return Gw(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Qw=function(t,r){if(!Buffer.isBuffer(t))return Xw(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},vh=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Yw(t,r)},qx=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Yl=function(e,t){return e[t]},cs=function(e,t){return e[t+1]*256+e[t]},lF=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},On=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ri=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},oF=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ec(e,t){var r="",n,s,l=[],c,u,d,f;switch(t){case"dbcs":if(f=this.l,xt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)r+=String.fromCharCode(cs(this,f)),f+=2;e*=2;break;case"utf8":r=pu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Gx(this,this.l,this.l+e);break;case"wstr":return Ec.call(this,e,"dbcs");case"lpstr-ansi":r=Vw(this,this.l),e=4+On(this,this.l);break;case"lpstr-cp":r=Kw(this,this.l),e=4+On(this,this.l);break;case"lpwstr":r=Ww(this,this.l),e=4+2*On(this,this.l);break;case"lpp4":e=4+On(this,this.l),r=qw(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+On(this,this.l),r=Qw(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(c=Yl(this,this.l+e++))!==0;)l.push(I0(c));r=l.join("");break;case"_wstr":for(e=0,r="";(c=cs(this,this.l+e))!==0;)l.push(I0(c)),e+=2;e+=2,r=l.join("");break;case"dbcs-cont":for(r="",f=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return c=Yl(this,f),this.l=f+1,u=Ec.call(this,e-d,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(I0(cs(this,f))),f+=2}r=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return c=Yl(this,f),this.l=f+1,u=Ec.call(this,e-d,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(I0(Yl(this,f))),f+=1}r=l.join("");break;default:switch(e){case 1:return n=Yl(this,this.l),this.l++,n;case 2:return n=(t==="i"?lF:cs)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Ri:oF)(this,this.l),this.l+=4,n):(s=On(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=vh(this,this.l):s=vh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=Hw(this,this.l,e);break}}return this.l+=e,r}var cF=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},uF=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},hF=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function dF(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)hF(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var l=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var c=t.charCodeAt(s);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,cF(this,t,this.l);break;case 8:if(n=8,r==="f"){iF(this,t,this.l);break}case 16:break;case-4:n=4,uF(this,t,this.l);break}return this.l+=n,this}function Jw(e,t){var r=Hw(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Hr(e,t){e.l=t,e.read_shift=Ec,e.chk=Jw,e.write_shift=dF}function Zr(e,t){e.l+=t}function ke(e){var t=oi(e);return Hr(t,0),t}function gs(e,t,r){if(e){var n,s,l;Hr(e,e.l||0);for(var c=e.length,u=0,d=0;e.l<c;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var f=Zc[u]||Zc[65535];for(n=e.read_shift(1),l=n&127,s=1;s<4&&n&128;++s)l+=((n=e.read_shift(1))&127)<<7*s;d=e.l+l;var p=f.f&&f.f(e,l,r);if(e.l=d,t(p,f,u))return}}}function jn(){var e=[],t=xt?256:2048,r=function(f){var p=ke(f);return Hr(p,0),p},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},l=function(f){return n&&f<n.length-n.l?n:(s(),n=r(Math.max(f+1,t)))},c=function(){return s(),Or(e)},u=function(f){s(),n=f,n.l==null&&(n.l=n.length),l(t)};return{next:l,push:u,end:c,_bufs:e}}function _e(e,t,r,n){var s=+t,l;if(!isNaN(s)){n||(n=Zc[s].p||(r||[]).length||0),l=1+(s>=128?1:0)+1,n>=128&&++l,n>=16384&&++l,n>=2097152&&++l;var c=e.next(l);s<=127?c.write_shift(1,s):(c.write_shift(1,(s&127)+128),c.write_shift(1,s>>7));for(var u=0;u!=4;++u)if(n>=128)c.write_shift(1,(n&127)+128),n>>=7;else{c.write_shift(1,n);break}n>0&&qx(r)&&e.push(r)}}function Fc(e,t,r){var n=Gt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Gy(e,t,r){var n=Gt(e);return n.s=Fc(n.s,t.s,r),n.e=Fc(n.e,t.s,r),n}function Ac(e,t){if(e.cRel&&e.c<0)for(e=Gt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Gt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=at(e);return!e.cRel&&e.cRel!=null&&(r=xF(r)),!e.rRel&&e.rRel!=null&&(r=fF(r)),r}function ap(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+er(e.s.c)+":"+(e.e.cRel?"":"$")+er(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+pr(e.s.r)+":"+(e.e.rRel?"":"$")+pr(e.e.r):Ac(e.s,t.biff)+":"+Ac(e.e,t.biff)}function Xx(e){return parseInt(pF(e),10)-1}function pr(e){return""+(e+1)}function fF(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function pF(e){return e.replace(/\$(\d+)$/,"$1")}function Qx(e){for(var t=mF(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function er(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function xF(e){return e.replace(/^([A-Z])/,"$$$1")}function mF(e){return e.replace(/^\$([A-Z])/,"$1")}function gF(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function tr(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function at(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function _n(e){var t=e.indexOf(":");return t==-1?{s:tr(e),e:tr(e)}:{s:tr(e.slice(0,t)),e:tr(e.slice(t+1))}}function ut(e,t){return typeof t>"u"||typeof t=="number"?ut(e.s,e.e):(typeof e!="string"&&(e=at(e)),typeof t!="string"&&(t=at(t)),e==t?e:e+":"+t)}function kt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,l=e.length;for(r=0;n<l&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<l&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===l||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=l&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=l&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function qy(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=na(e.z,r?jr(t):t)}catch{}try{return e.w=na((e.XF||{}).numFmtId||(r?14:0),r?jr(t):t)}catch{return""+t}}function xs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?vs[e.v]||e.v:t==null?qy(e,e.v):qy(e,t))}function mi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Zw(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,l=e||(s?[]:{}),c=0,u=0;if(l&&n.origin!=null){if(typeof n.origin=="number")c=n.origin;else{var d=typeof n.origin=="string"?tr(n.origin):n.origin;c=d.r,u=d.c}l["!ref"]||(l["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var p=kt(l["!ref"]);f.s.c=p.s.c,f.s.r=p.s.r,f.e.c=Math.max(f.e.c,p.e.c),f.e.r=Math.max(f.e.r,p.e.r),c==-1&&(f.e.r=c=p.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[m].length;++g)if(!(typeof t[m][g]>"u")){var b={v:t[m][g]},v=c+m,y=u+g;if(f.s.r>v&&(f.s.r=v),f.s.c>y&&(f.s.c=y),f.e.r<v&&(f.e.r=v),f.e.c<y&&(f.e.c=y),t[m][g]&&typeof t[m][g]=="object"&&!Array.isArray(t[m][g])&&!(t[m][g]instanceof Date))b=t[m][g];else if(Array.isArray(b.v)&&(b.f=t[m][g][1],b.v=b.v[0]),b.v===null)if(b.f)b.t="n";else if(n.nullError)b.t="e",b.v=0;else if(n.sheetStubs)b.t="z";else continue;else typeof b.v=="number"?b.t="n":typeof b.v=="boolean"?b.t="b":b.v instanceof Date?(b.z=n.dateNF||nt[14],n.cellDates?(b.t="d",b.w=na(b.z,jr(b.v))):(b.t="n",b.v=jr(b.v),b.w=na(b.z,b.v))):b.t="s";if(s)l[v]||(l[v]=[]),l[v][y]&&l[v][y].z&&(b.z=l[v][y].z),l[v][y]=b;else{var N=at({c:y,r:v});l[N]&&l[N].z&&(b.z=l[N].z),l[N]=b}}}return f.s.c<1e7&&(l["!ref"]=ut(f)),l}function Do(e,t){return Zw(null,e,t)}function vF(e){return e.read_shift(4,"i")}function wa(e,t){return t||(t=ke(4)),t.write_shift(4,e),t}function Jr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Rr(e,t){var r=!1;return t==null&&(r=!0,t=ke(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function yF(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function bF(e,t){return t||(t=ke(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Yx(e,t){var r=e.l,n=e.read_shift(1),s=Jr(e),l=[],c={t:s,h:s};if((n&1)!==0){for(var u=e.read_shift(4),d=0;d!=u;++d)l.push(yF(e));c.r=l}else c.r=[{ich:0,ifnt:0}];return e.l=r+t,c}function wF(e,t){var r=!1;return t==null&&(r=!0,t=ke(15+4*e.t.length)),t.write_shift(1,0),Rr(e.t,t),r?t.slice(0,t.l):t}var NF=Yx;function kF(e,t){var r=!1;return t==null&&(r=!0,t=ke(23+4*e.t.length)),t.write_shift(1,1),Rr(e.t,t),t.write_shift(4,1),bF({},t),r?t.slice(0,t.l):t}function aa(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function fl(e,t){return t==null&&(t=ke(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function pl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function xl(e,t){return t==null&&(t=ke(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var TF=Jr,eN=Rr;function Jx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function yh(e,t){var r=!1;return t==null&&(r=!0,t=ke(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var jF=Jr,Xp=Jx,Zx=yh;function em(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?vh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ri(t,0)>>2;return r?s/100:s}function tN(e,t){t==null&&(t=ke(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function rN(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function _F(e,t){return t||(t=ke(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ml=rN,Po=_F;function Yr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function il(e,t){return(t||ke(8)).write_shift(8,e,"f")}function SF(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),l=e.read_shift(2,"i"),c=e.read_shift(1),u=e.read_shift(1),d=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var f=Qi[s];f&&(t.rgb=Xc(f));break;case 2:t.rgb=Xc([c,u,d]);break;case 3:t.theme=s;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function bh(e,t){if(t||(t=ke(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function CF(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function EF(e,t){t||(t=ke(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function nN(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function FF(e){return nN(e,1)}function AF(e){return nN(e,2)}var tm=2,yn=3,B0=11,Xy=12,wh=19,H0=64,DF=65,PF=71,LF=4108,OF=4126,Pr=80,aN=81,RF=[Pr,aN],Qp={1:{n:"CodePage",t:tm},2:{n:"Category",t:Pr},3:{n:"PresentationFormat",t:Pr},4:{n:"ByteCount",t:yn},5:{n:"LineCount",t:yn},6:{n:"ParagraphCount",t:yn},7:{n:"SlideCount",t:yn},8:{n:"NoteCount",t:yn},9:{n:"HiddenCount",t:yn},10:{n:"MultimediaClipCount",t:yn},11:{n:"ScaleCrop",t:B0},12:{n:"HeadingPairs",t:LF},13:{n:"TitlesOfParts",t:OF},14:{n:"Manager",t:Pr},15:{n:"Company",t:Pr},16:{n:"LinksUpToDate",t:B0},17:{n:"CharacterCount",t:yn},19:{n:"SharedDoc",t:B0},22:{n:"HyperlinksChanged",t:B0},23:{n:"AppVersion",t:yn,p:"version"},24:{n:"DigSig",t:DF},26:{n:"ContentType",t:Pr},27:{n:"ContentStatus",t:Pr},28:{n:"Language",t:Pr},29:{n:"Version",t:Pr},255:{},2147483648:{n:"Locale",t:wh},2147483651:{n:"Behavior",t:wh},1919054434:{}},Yp={1:{n:"CodePage",t:tm},2:{n:"Title",t:Pr},3:{n:"Subject",t:Pr},4:{n:"Author",t:Pr},5:{n:"Keywords",t:Pr},6:{n:"Comments",t:Pr},7:{n:"Template",t:Pr},8:{n:"LastAuthor",t:Pr},9:{n:"RevNumber",t:Pr},10:{n:"EditTime",t:H0},11:{n:"LastPrinted",t:H0},12:{n:"CreatedDate",t:H0},13:{n:"ModifiedDate",t:H0},14:{n:"PageCount",t:yn},15:{n:"WordCount",t:yn},16:{n:"CharCount",t:yn},17:{n:"Thumbnail",t:PF},18:{n:"Application",t:Pr},19:{n:"DocSecurity",t:yn},255:{},2147483648:{n:"Locale",t:wh},2147483651:{n:"Behavior",t:wh},1919054434:{}},Qy={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},IF=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function MF(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var BF=MF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Qi=Gt(BF),vs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},sN={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Jp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},U0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function rm(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function HF(e){var t=rm();if(!e||!e.match)return t;var r={};if((e.match(en)||[]).forEach(function(n){var s=st(n);switch(s[0].replace(Q5,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Jp[s.ContentType]]!==void 0&&t[Jp[s.ContentType]].push(s.PartName);break}}),t.xmlns!==Tr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function iN(e,t){var r=H5(Jp),n=[],s;n[n.length]=xr,n[n.length]=Ie("Types",null,{xmlns:Tr.CT,"xmlns:xsd":Tr.xsd,"xmlns:xsi":Tr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Ie("Default",null,{Extension:d[0],ContentType:d[1]})}));var l=function(d){e[d]&&e[d].length>0&&(s=e[d][0],n[n.length]=Ie("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:U0[d][t.bookType]||U0[d].xlsx}))},c=function(d){(e[d]||[]).forEach(function(f){n[n.length]=Ie("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:U0[d][t.bookType]||U0[d].xlsx})})},u=function(d){(e[d]||[]).forEach(function(f){n[n.length]=Ie("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:r[d][0]})})};return l("workbooks"),c("sheets"),c("charts"),u("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),c("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var gt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function qc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Dc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(en)||[]).forEach(function(s){var l=st(s);if(l[0]==="<Relationship"){var c={};c.Type=l.Type,c.Target=l.Target,c.Id=l.Id,l.TargetMode&&(c.TargetMode=l.TargetMode);var u=l.TargetMode==="External"?l.Target:Tc(l.Target,t);r[u]=c,n[l.Id]=c}}),r["!id"]=n,r}function to(e){var t=[xr,Ie("Relationships",null,{xmlns:Tr.RELS})];return ir(e["!id"]).forEach(function(r){t[t.length]=Ie("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function At(e,t,r,n,s,l){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[gt.HLINK,gt.XPATH,gt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var UF="application/vnd.oasis.opendocument.spreadsheet";function VF(e,t){for(var r=Wx(e),n,s;n=Gc.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=st(n[0],!1),s.path=="/"&&s.type!==UF)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function zF(e){var t=[xr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Yy(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function KF(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function $F(e){var t=[xr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Yy(e[r][0],e[r][1])),t.push(KF("",e[r][0]));return t.push(Yy("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function lN(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+fh.version+"</meta:generator></office:meta></office:document-meta>"}var ra=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],WF=(function(){for(var e=new Array(ra.length),t=0;t<ra.length;++t){var r=ra[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function oN(e){var t={};e=Ot(e);for(var r=0;r<ra.length;++r){var n=ra[r],s=e.match(WF[r]);s!=null&&s.length>0&&(t[n[1]]=Nt(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Wt(t[n[1]]))}return t}function sp(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Dt(t),n[n.length]=r?Ie(e,t,r):Ur(e,t))}function cN(e,t){var r=t||{},n=[xr,Ie("cp:coreProperties",null,{"xmlns:cp":Tr.CORE_PROPS,"xmlns:dc":Tr.dc,"xmlns:dcterms":Tr.dcterms,"xmlns:dcmitype":Tr.dcmitype,"xmlns:xsi":Tr.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&sp("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:qp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&sp("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:qp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var l=0;l!=ra.length;++l){var c=ra[l],u=r.Props&&r.Props[c[1]]!=null?r.Props[c[1]]:e?e[c[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&sp(c[0],u,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Yi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],uN=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function hN(e,t,r,n){var s=[];if(typeof e=="string")s=Uy(e,n);else for(var l=0;l<e.length;++l)s=s.concat(e[l].map(function(p){return{v:p}}));var c=typeof t=="string"?Uy(t,n).map(function(p){return p.v}):t,u=0,d=0;if(c.length>0)for(var f=0;f!==s.length;f+=2){switch(d=+s[f+1].v,s[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=d,r.SheetNames=c.slice(u,u+d);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=d,r.DefinedNames=c.slice(u,u+d);break;case"Charts":case"Diagramme":r.Chartsheets=d,r.ChartNames=c.slice(u,u+d);break}u+=d}}function GF(e,t,r){var n={};return t||(t={}),e=Ot(e),Yi.forEach(function(s){var l=(e.match($c(s[0]))||[])[1];switch(s[2]){case"string":l&&(t[s[1]]=Nt(l));break;case"bool":t[s[1]]=l==="true";break;case"raw":var c=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));c&&c.length>0&&(n[s[1]]=c[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&hN(n.HeadingPairs,n.TitlesOfParts,t,r),t}function dN(e){var t=[],r=Ie;return e||(e={}),e.Application="SheetJS",t[t.length]=xr,t[t.length]=Ie("Properties",null,{xmlns:Tr.EXT_PROPS,"xmlns:vt":Tr.vt}),Yi.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Dt(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Dt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var qF=/<[^>]+>[^<]*/g;function XF(e,t){var r={},n="",s=e.match(qF);if(s)for(var l=0;l!=s.length;++l){var c=s[l],u=st(c);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Nt(u.name);break;case"</property>":n=null;break;default:if(c.indexOf("<vt:")===0){var d=c.split(">"),f=d[0].slice(4),p=d[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=Nt(p);break;case"bool":r[n]=$t(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(p);break;case"filetime":case"date":r[n]=Wt(p);break;case"cy":case"error":r[n]=Nt(p);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",c,f,d)}}else if(c.slice(0,2)!=="</"){if(t.WTF)throw new Error(c)}}}return r}function fN(e){var t=[xr,Ie("Properties",null,{xmlns:Tr.CUST_PROPS,"xmlns:vt":Tr.vt})];if(!e)return t.join("");var r=1;return ir(e).forEach(function(s){++r,t[t.length]=Ie("property",aF(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Dt(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Zp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ip;function QF(e,t,r){ip||(ip=Vh(Zp)),t=ip[t]||t,e[t]=r}function YF(e,t){var r=[];return ir(Zp).map(function(n){for(var s=0;s<ra.length;++s)if(ra[s][1]==n)return ra[s];for(s=0;s<Yi.length;++s)if(Yi[s][1]==n)return Yi[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Ur(Zp[n[1]]||n[1],s))}}),Ie("DocumentProperties",r.join(""),{xmlns:Ln.o})}function JF(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&ir(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)){for(var c=0;c<ra.length;++c)if(l==ra[c][1])return;for(c=0;c<Yi.length;++c)if(l==Yi[c][1])return;for(c=0;c<r.length;++c)if(l==r[c])return;var u=e[l],d="string";typeof u=="number"?(d="float",u=String(u)):u===!0||u===!1?(d="boolean",u=u?"1":"0"):u=String(u),s.push(Ie(Iy(l),u,{"dt:dt":d}))}}),t&&ir(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)&&!(e&&Object.prototype.hasOwnProperty.call(e,l))){var c=t[l],u="string";typeof c=="number"?(u="float",c=String(c)):c===!0||c===!1?(u="boolean",c=c?"1":"0"):c instanceof Date?(u="dateTime.tz",c=c.toISOString()):c=String(c),s.push(Ie(Iy(l),c,{"dt:dt":u}))}}),"<"+n+' xmlns="'+Ln.o+'">'+s.join("")+"</"+n+">"}function nm(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function ZF(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var l=n/Math.pow(2,32)|0;l>0&&(n=n%Math.pow(2,32),s+=l);var c=ke(8);return c.write_shift(4,n),c.write_shift(4,s),c}function pN(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function xN(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function mN(e,t,r){return t===31?xN(e):pN(e,t,r)}function ex(e,t,r){return mN(e,t,r===!1?0:4)}function eA(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return mN(e,t,0)}function tA(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(un,""),e.l-s&2&&(e.l+=2)}return r}function rA(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(un,"");return r}function nA(e){var t=e.l,r=Nh(e,aN);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Nh(e,yn);return[r,n]}function aA(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(nA(e));return r}function Jy(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var l=e.read_shift(4),c=e.read_shift(4);n[l]=e.read_shift(c,t===1200?"utf16le":"utf8").replace(un,"").replace(kc,"!"),t===1200&&c%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function gN(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function sA(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Nh(e,t,r){var n=e.read_shift(2),s,l=r||{};if(e.l+=2,t!==Xy&&n!==t&&RF.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Xy?n:t){case 2:return s=e.read_shift(2,"i"),l.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return pN(e,n,4).replace(un,"");case 31:return xN(e);case 64:return nm(e);case 65:return gN(e);case 71:return sA(e);case 80:return ex(e,n,!l.raw).replace(un,"");case 81:return eA(e,n).replace(un,"");case 4108:return aA(e);case 4126:case 4127:return n==4127?tA(e):rA(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Zy(e,t){var r=ke(4),n=ke(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=ke(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=ZF(t);break;case 31:case 80:for(n=ke(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Or([r,n])}function e2(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),l=[],c=0,u=0,d=-1,f={};for(c=0;c!=s;++c){var p=e.read_shift(4),m=e.read_shift(4);l[c]=[p,m+r]}l.sort(function(C,S){return C[1]-S[1]});var g={};for(c=0;c!=s;++c){if(e.l!==l[c][1]){var b=!0;if(c>0&&t)switch(t[l[c-1][0]].t){case 2:e.l+2===l[c][1]&&(e.l+=2,b=!1);break;case 80:e.l<=l[c][1]&&(e.l=l[c][1],b=!1);break;case 4108:e.l<=l[c][1]&&(e.l=l[c][1],b=!1);break}if((!t||c==0)&&e.l<=l[c][1]&&(b=!1,e.l=l[c][1]),b)throw new Error("Read Error: Expected address "+l[c][1]+" at "+e.l+" :"+c)}if(t){var v=t[l[c][0]];if(g[v.n]=Nh(e,v.t,{raw:!0}),v.p==="version"&&(g[v.n]=String(g[v.n]>>16)+"."+("0000"+String(g[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(g[v.n]){case 0:g[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:va(u=g[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[v.n])}}else if(l[c][0]===1){if(u=g.CodePage=Nh(e,tm),va(u),d!==-1){var y=e.l;e.l=l[d][1],f=Jy(e,u),e.l=y}}else if(l[c][0]===0){if(u===0){d=c,e.l=l[c+1][1];continue}f=Jy(e,u)}else{var N=f[l[c][0]],_;switch(e[e.l]){case 65:e.l+=4,_=gN(e);break;case 30:e.l+=4,_=ex(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,_=ex(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,_=e.read_shift(4,"i");break;case 19:e.l+=4,_=e.read_shift(4);break;case 5:e.l+=4,_=e.read_shift(8,"f");break;case 11:e.l+=4,_=dr(e,4);break;case 64:e.l+=4,_=Wt(nm(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[N]=_}}return e.l=r+n,g}var vN=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function iA(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function t2(e,t,r){var n=ke(8),s=[],l=[],c=8,u=0,d=ke(8),f=ke(8);if(d.write_shift(4,2),d.write_shift(4,1200),f.write_shift(4,1),l.push(d),s.push(f),c+=8+d.length,!t){f=ke(8),f.write_shift(4,0),s.unshift(f);var p=[ke(4)];for(p[0].write_shift(4,e.length),u=0;u<e.length;++u){var m=e[u][0];for(d=ke(8+2*(m.length+1)+(m.length%2?0:2)),d.write_shift(4,u+2),d.write_shift(4,m.length+1),d.write_shift(0,m,"dbcs");d.l!=d.length;)d.write_shift(1,0);p.push(d)}d=Or(p),l.unshift(d),c+=8+d.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(vN.indexOf(e[u][0])>-1||uN.indexOf(e[u][0])>-1)&&e[u][1]!=null){var g=e[u][1],b=0;if(t){b=+t[e[u][0]];var v=r[b];if(v.p=="version"&&typeof g=="string"){var y=g.split(".");g=(+y[0]<<16)+(+y[1]||0)}d=Zy(v.t,g)}else{var N=iA(g);N==-1&&(N=31,g=String(g)),d=Zy(N,g)}l.push(d),f=ke(8),f.write_shift(4,t?b:2+u),s.push(f),c+=8+d.length}var _=8*(l.length+1);for(u=0;u<l.length;++u)s[u].write_shift(4,_),_+=l[u].length;return n.write_shift(4,c),n.write_shift(4,l.length),Or([n].concat(s).concat(l))}function r2(e,t,r){var n=e.content;if(!n)return{};Hr(n,0);var s,l,c,u,d=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),p=n.read_shift(16);if(p!==Ye.utils.consts.HEADER_CLSID&&p!==r)throw new Error("Bad PropertySet CLSID "+p);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(l=n.read_shift(16),u=n.read_shift(4),s===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);s===2&&(c=n.read_shift(16),d=n.read_shift(4));var m=e2(n,t),g={SystemIdentifier:f};for(var b in m)g[b]=m[b];if(g.FMTID=l,s===1)return g;if(d-n.l==2&&(n.l+=2),n.l!==d)throw new Error("Length mismatch 2: "+n.l+" !== "+d);var v;try{v=e2(n,null)}catch{}for(b in v)g[b]=v[b];return g.FMTID=[l,c],g}function n2(e,t,r,n,s,l){var c=ke(s?68:48),u=[c];c.write_shift(2,65534),c.write_shift(2,0),c.write_shift(4,842412599),c.write_shift(16,Ye.utils.consts.HEADER_CLSID,"hex"),c.write_shift(4,s?2:1),c.write_shift(16,t,"hex"),c.write_shift(4,s?68:48);var d=t2(e,r,n);if(u.push(d),s){var f=t2(s,null,null);c.write_shift(16,l,"hex"),c.write_shift(4,68+d.length),u.push(f)}return Or(u)}function zs(e,t){return e.read_shift(t),null}function lA(e,t){t||(t=ke(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function oA(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function dr(e,t){return e.read_shift(t)===1}function cn(e,t){return t||(t=ke(2)),t.write_shift(2,+!!e),t}function yr(e){return e.read_shift(2,"u")}function Zn(e,t){return t||(t=ke(2)),t.write_shift(2,e),t}function yN(e,t){return oA(e,t,yr)}function cA(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function bN(e,t,r){return r||(r=ke(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function xu(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var l=e.read_shift(1);l&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var c=n?e.read_shift(n,s):"";return c}function uA(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,l=1+(r&1),c=0,u,d={};s&&(c=e.read_shift(2)),n&&(u=e.read_shift(4));var f=l==2?"dbcs-cont":"sbcs-cont",p=t===0?"":e.read_shift(t,f);return s&&(e.l+=4*c),n&&(e.l+=u),d.t=p,s||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function hA(e){var t=e.t||"",r=ke(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=ke(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return Or(s)}function ll(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function mu(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):ll(e,n,r)}function gl(e,t,r){if(r.biff>5)return mu(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function wN(e,t,r){return r||(r=ke(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function dA(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function fA(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(un,"");return n&&(e.l+=24),s}function pA(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=e.read_shift(l>>1,"utf16le").replace(un,"");return r+c}function xA(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return fA(e);case"0303000000000000c000000000000046":return pA(e);default:throw new Error("Unsupported Moniker "+r)}}function V0(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(un,""):"";return r}function a2(e,t){t||(t=ke(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function mA(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var l,c,u,d,f="",p,m;s&16&&(l=V0(e,r-e.l)),s&128&&(c=V0(e,r-e.l)),(s&257)===257&&(u=V0(e,r-e.l)),(s&257)===1&&(d=xA(e,r-e.l)),s&8&&(f=V0(e,r-e.l)),s&32&&(p=e.read_shift(16)),s&64&&(m=nm(e)),e.l=r;var g=c||u||d||"";g&&f&&(g+="#"+f),g||(g="#"+f),s&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var b={Target:g};return p&&(b.guid=p),m&&(b.time=m),l&&(b.Tooltip=l),b}function gA(e){var t=ke(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),l=s>-1?31:23;switch(n.charAt(0)){case"#":l=28;break;case".":l&=-3;break}t.write_shift(4,2),t.write_shift(4,l);var c=[8,6815827,6619237,4849780,83];for(r=0;r<c.length;++r)t.write_shift(4,c[r]);if(l==28)n=n.slice(1),a2(n,t);else if(l&2){for(c="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<c.length;++r)t.write_shift(1,parseInt(c[r],16));var u=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)t.write_shift(2,u.charCodeAt(r));t.write_shift(2,0),l&8&&a2(s>-1?n.slice(s+1):"",t)}else{for(c="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<c.length;++r)t.write_shift(1,parseInt(c[r],16));for(var d=0;n.slice(d*3,d*3+3)=="../"||n.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,n.length-3*d+1),r=0;r<n.length-3*d;++r)t.write_shift(1,n.charCodeAt(r+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function NN(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function kN(e,t){var r=NN(e);return r[3]=0,r}function za(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function ol(e,t,r,n){return n||(n=ke(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function vA(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function yA(e,t,r){return t===0?"":gl(e,t,r)}function bA(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),l=e.read_shift(n,"i"),c=e.read_shift(n,"i");return[s,l,c]}function TN(e){var t=e.read_shift(2),r=em(e);return[t,r]}function wA(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=xu(e,t,r),l=e.read_shift(2);if(n-=e.l,l!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+l);return e.l+=l,s}function $h(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function jN(e,t){return t||(t=ke(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function _N(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var NA=_N;function SN(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function kA(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function TA(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Wr(e){e.l+=2,e.l+=e.read_shift(2)}var jA={0:Wr,4:Wr,5:Wr,6:Wr,7:TA,8:Wr,9:Wr,10:Wr,11:Wr,12:Wr,13:kA,14:Wr,15:Wr,16:Wr,17:Wr,18:Wr,19:Wr,20:Wr,21:SN};function _A(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(jA[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function z0(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function am(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=ke(s);return l.write_shift(2,n),l.write_shift(2,t),s>4&&l.write_shift(2,29282),s>6&&l.write_shift(2,1997),s>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function SA(e,t){return t===0||e.read_shift(2),1200}function CA(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=gl(e,0,r);return e.read_shift(t+n-e.l),s}function EA(e,t){var r=!t||t.biff==8,n=ke(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function FA(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function AA(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var c=xu(e,0,r);return c.length===0&&(c="Sheet1"),{pos:n,hs:s,dt:l,name:c}}function DA(e,t){var r=!t||t.biff>=8?2:1,n=ke(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function PA(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),l=[],c=0;c!=s&&e.l<r;++c)l.push(uA(e));return l.Count=n,l.Unique=s,l}function LA(e,t){var r=ke(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=hA(e[s]);var l=Or([r].concat(n));return l.parts=[r.length].concat(n.map(function(c){return c.length})),l}function OA(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function RA(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function IA(e){var t=vA(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function MA(e){return e.read_shift(2),e.read_shift(4)}function s2(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var l={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[l,s]}function BA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2),d=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:l,CurTab:c,FirstTab:u,Selected:d,TabRatio:f}}function HA(){var e=ke(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function UA(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function VA(e){var t=ke(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function zA(){}function KA(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=xu(e,0,r),n}function $A(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,l=ke(s);return l.write_shift(2,e.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,r.length),n||l.write_shift(1,1),l.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),l}function WA(e){var t=za(e);return t.isst=e.read_shift(4),t}function GA(e,t,r,n){var s=ke(10);return ol(e,t,n,s),s.write_shift(4,r),s}function qA(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=za(e);r.biff==2&&e.l++;var l=mu(e,n-e.l,r);return s.val=l,s}function XA(e,t,r,n,s){var l=!s||s.biff==8,c=ke(8+ +l+(1+l)*r.length);return ol(e,t,n,c),c.write_shift(2,r.length),l&&c.write_shift(1,1),c.write_shift((1+l)*r.length,r,l?"utf16le":"sbcs"),c}function QA(e,t,r){var n=e.read_shift(2),s=gl(e,0,r);return[n,s]}function YA(e,t,r,n){var s=r&&r.biff==5;n||(n=ke(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var l=n.length>n.l?n.slice(0,n.l):n;return l.l==null&&(l.l=l.length),l}var JA=gl;function i2(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,l=e.read_shift(s),c=e.read_shift(s),u=e.read_shift(2),d=e.read_shift(2);return e.l=n,{s:{r:l,c:u},e:{r:c,c:d}}}function ZA(e,t){var r=t.biff==8||!t.biff?4:2,n=ke(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function e8(e){var t=e.read_shift(2),r=e.read_shift(2),n=TN(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function t8(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),l=[];e.l<r;)l.push(TN(e));if(e.l!==r)throw new Error("MulRK read error");var c=e.read_shift(2);if(l.length!=c-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:c,rkrec:l}}function r8(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),l=[];e.l<r;)l.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var c=e.read_shift(2);if(l.length!=c-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:c,ixfe:l}}function n8(e,t,r,n){var s={},l=e.read_shift(4),c=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2);return s.patternType=IF[u>>26],n.cellStyles&&(s.alc=l&7,s.fWrap=l>>3&1,s.alcV=l>>4&7,s.fJustLast=l>>7&1,s.trot=l>>8&255,s.cIndent=l>>16&15,s.fShrinkToFit=l>>20&1,s.iReadOrder=l>>22&2,s.fAtrNum=l>>26&1,s.fAtrFnt=l>>27&1,s.fAtrAlc=l>>28&1,s.fAtrBdr=l>>29&1,s.fAtrPat=l>>30&1,s.fAtrProt=l>>31&1,s.dgLeft=c&15,s.dgRight=c>>4&15,s.dgTop=c>>8&15,s.dgBottom=c>>12&15,s.icvLeft=c>>16&127,s.icvRight=c>>23&127,s.grbitDiag=c>>30&3,s.icvTop=u&127,s.icvBottom=u>>7&127,s.icvDiag=u>>14&127,s.dgDiag=u>>21&15,s.icvFore=d&127,s.icvBack=d>>7&127,s.fsxButton=d>>14&1),s}function a8(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=n8(e,t,n.fStyle,r),n}function l2(e,t,r,n){var s=r&&r.biff==5;n||(n=ke(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var l=0;return e.numFmtId>0&&s&&(l|=1024),n.write_shift(4,l),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function s8(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function i8(e){var t=ke(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function o2(e,t,r){var n=za(e);(r.biff==2||t==9)&&++e.l;var s=cA(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function l8(e,t,r,n,s,l){var c=ke(8);return ol(e,t,n,c),bN(r,l,c),c}function o8(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=za(e),s=Yr(e);return n.val=s,n}function c8(e,t,r,n){var s=ke(14);return ol(e,t,n,s),il(r,s),s}var c2=yA;function u8(e,t,r){var n=e.l+t,s=e.read_shift(2),l=e.read_shift(2);if(r.sbcch=l,l==1025||l==14849)return[l,s];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var c=ll(e,l),u=[];n>e.l;)u.push(mu(e));return[l,s,c,u]}function u2(e,t,r){var n=e.read_shift(2),s,l={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=wA(e,t-2,r)),l.body=s||e.read_shift(t-2),typeof s=="string"&&(l.Name=s),l}var h8=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function h2(e,t,r){var n=e.l+t,s=e.read_shift(2),l=e.read_shift(1),c=e.read_shift(1),u=e.read_shift(r&&r.biff==2?1:2),d=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),d=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=ll(e,c,r);s&32&&(f=h8[f.charCodeAt(0)]);var p=n-e.l;r&&r.biff==2&&--p;var m=n==e.l||u===0||!(p>0)?[]:_O(e,p,r,u);return{chKey:l,Name:f,itab:d,rgce:m}}function CN(e,t,r){if(r.biff<8)return d8(e,t,r);for(var n=[],s=e.l+t,l=e.read_shift(r.biff>8?4:2);l--!==0;)n.push(bA(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function d8(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=xu(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function f8(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),l=ll(e,n,r),c=ll(e,s,r);return[l,c]}function p8(e,t,r){var n=_N(e);e.l++;var s=e.read_shift(1);return t-=8,[SO(e,t,r),s,n]}function d2(e,t,r){var n=NA(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,TO(e,t,r)]}function x8(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function m8(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=gl(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},u,c,l]}}function g8(e,t,r){return m8(e,t,r)}function v8(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push($h(e));return r}function y8(e){var t=ke(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)jN(e[r],t);return t}function b8(e,t,r){if(r&&r.biff<8)return N8(e,t,r);var n=SN(e),s=_A(e,t-22,n[1]);return{cmo:n,ft:s}}var w8={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function N8(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var c=[];return c.push((w8[n]||Zr)(e,t,r)),{cmo:[s,n,l],ft:c}}function k8(e,t,r){var n=e.l,s="";try{e.l+=4;var l=(r.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:c=dA(e,6,r);var u=e.read_shift(2);e.read_shift(2),yr(e,2);var d=e.read_shift(2);e.l+=d;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var p=e[e.l],m=ll(e,e.lens[f+1]-e.lens[f]-1);if(s+=m,s.length>=(p?u:2*u))break}if(s.length!==u&&s.length!==u*2)throw new Error("cchText: "+u+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function T8(e,t){var r=$h(e);e.l+=16;var n=mA(e,t-24);return[r,n]}function j8(e){var t=ke(24),r=tr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return Or([t,gA(e[1])])}function _8(e,t){e.read_shift(2);var r=$h(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(un,""),[r,n]}function S8(e){var t=e[1].Tooltip,r=ke(10+2*(t.length+1));r.write_shift(2,2048);var n=tr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function C8(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Qy[r]||r,r=e.read_shift(2),t[1]=Qy[r]||r,t}function E8(e){return e||(e=ke(4)),e.write_shift(2,1),e.write_shift(2,1),e}function F8(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(kN(e));return r}function A8(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(kN(e));return r}function D8(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function EN(e,t,r){if(!r.cellStyles)return Zr(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(n),u=e.read_shift(n),d=e.read_shift(2);n==2&&(e.l+=2);var f={s,e:l,w:c,ixfe:u,flags:d};return(r.biff>=5||!r.biff)&&(f.level=d>>8&7),f}function P8(e,t){var r=ke(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function L8(e,t){var r={};return t<32||(e.l+=16,r.header=Yr(e),r.footer=Yr(e),e.l+=2),r}function O8(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function R8(e){for(var t=ke(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var I8=za,M8=yN,B8=mu;function H8(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function U8(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=za(e);++e.l;var s=gl(e,t-7,r);return n.t="str",n.val=s,n}function V8(e){var t=za(e);++e.l;var r=Yr(e);return t.t="n",t.val=r,t}function z8(e,t,r){var n=ke(15);return bu(n,e,t),n.write_shift(8,r,"f"),n}function K8(e){var t=za(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function $8(e,t,r){var n=ke(9);return bu(n,e,t),n.write_shift(2,r),n}function W8(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function G8(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function q8(e,t,r){var n=e.l+t,s=za(e),l=e.read_shift(2),c=ll(e,l,r);return e.l=n,s.t="str",s.val=c,s}var X8=[2,3,48,49,131,139,140,245],tx=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Vh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,d){var f=[],p=oi(1);switch(d.type){case"base64":p=Rn(Bn(u));break;case"binary":p=Rn(u);break;case"buffer":case"array":p=u;break}Hr(p,0);var m=p.read_shift(1),g=!!(m&136),b=!1,v=!1;switch(m){case 2:break;case 3:break;case 48:b=!0,g=!0;break;case 49:b=!0,g=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var y=0,N=521;m==2&&(y=p.read_shift(2)),p.l+=3,m!=2&&(y=p.read_shift(4)),y>1048576&&(y=1e6),m!=2&&(N=p.read_shift(2));var _=p.read_shift(2),C=d.codepage||1252;m!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(C=e[p[p.l]]),p.l+=1,p.l+=2),v&&(p.l+=36);for(var S=[],E={},O=Math.min(p.length,m==2?521:N-10-(b?264:0)),F=v?32:11;p.l<O&&p[p.l]!=13;)switch(E={},E.name=Vc.utils.decode(C,p.slice(p.l,p.l+F)).replace(/[\u0000\r\n].*$/g,""),p.l+=F,E.type=String.fromCharCode(p.read_shift(1)),m!=2&&!v&&(E.offset=p.read_shift(4)),E.len=p.read_shift(1),m==2&&(E.offset=p.read_shift(2)),E.dec=p.read_shift(1),E.name.length&&S.push(E),m!=2&&(p.l+=v?13:14),E.type){case"B":(!b||E.len!=8)&&d.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(p[p.l]!==13&&(p.l=N-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=N;var T=0,D=0;for(f[0]=[],D=0;D!=S.length;++D)f[0][D]=S[D].name;for(;y-- >0;){if(p[p.l]===42){p.l+=_;continue}for(++p.l,f[++T]=[],D=0,D=0;D!=S.length;++D){var I=p.slice(p.l,p.l+S[D].len);p.l+=S[D].len,Hr(I,0);var J=Vc.utils.decode(C,I);switch(S[D].type){case"C":J.trim().length&&(f[T][D]=J.replace(/\s+$/,""));break;case"D":J.length===8?f[T][D]=new Date(+J.slice(0,4),+J.slice(4,6)-1,+J.slice(6,8)):f[T][D]=J;break;case"F":f[T][D]=parseFloat(J.trim());break;case"+":case"I":f[T][D]=v?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(J.trim().toUpperCase()){case"Y":case"T":f[T][D]=!0;break;case"N":case"F":f[T][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+J+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));f[T][D]="##MEMO##"+(v?parseInt(J.trim(),10):I.read_shift(4));break;case"N":J=J.replace(/\u0000/g,"").trim(),J&&J!="."&&(f[T][D]=+J||0);break;case"@":f[T][D]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":f[T][D]=new Date((I.read_shift(4)-2440588)*864e5+I.read_shift(4));break;case"Y":f[T][D]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[T][D]=-I.read_shift(-8,"f");break;case"B":if(b&&S[D].len==8){f[T][D]=I.read_shift(8,"f");break}case"G":case"P":I.l+=S[D].len;break;case"0":if(S[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[D].type)}}}if(m!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return d&&d.sheetRows&&(f=f.slice(0,d.sheetRows)),d.DBF=S,f}function n(u,d){var f=d||{};f.dateNF||(f.dateNF="yyyymmdd");var p=Do(r(u,f),f);return p["!cols"]=f.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete f.DBF,p}function s(u,d){try{return mi(n(u,d),d)}catch(f){if(d&&d.WTF)throw f}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,d){var f=d||{};if(+f.codepage>=0&&va(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var p=jn(),m=_h(u,{header:1,raw:!0,cellDates:!0}),g=m[0],b=m.slice(1),v=u["!cols"]||[],y=0,N=0,_=0,C=1;for(y=0;y<g.length;++y){if(((v[y]||{}).DBF||{}).name){g[y]=v[y].DBF.name,++_;continue}if(g[y]!=null){if(++_,typeof g[y]=="number"&&(g[y]=g[y].toString(10)),typeof g[y]!="string")throw new Error("DBF Invalid column name "+g[y]+" |"+typeof g[y]+"|");if(g.indexOf(g[y])!==y){for(N=0;N<1024;++N)if(g.indexOf(g[y]+"_"+N)==-1){g[y]+="_"+N;break}}}}var S=kt(u["!ref"]),E=[],O=[],F=[];for(y=0;y<=S.e.c-S.s.c;++y){var T="",D="",I=0,J=[];for(N=0;N<b.length;++N)b[N][y]!=null&&J.push(b[N][y]);if(J.length==0||g[y]==null){E[y]="?";continue}for(N=0;N<J.length;++N){switch(typeof J[N]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=J[N]instanceof Date?"D":"C";break;default:D="C"}I=Math.max(I,String(J[N]).length),T=T&&T!=D?"C":D}I>250&&(I=250),D=((v[y]||{}).DBF||{}).type,D=="C"&&v[y].DBF.len>I&&(I=v[y].DBF.len),T=="B"&&D=="N"&&(T="N",F[y]=v[y].DBF.dec,I=v[y].DBF.len),O[y]=T=="C"||D=="N"?I:l[T]||0,C+=O[y],E[y]=T}var Z=p.next(32);for(Z.write_shift(4,318902576),Z.write_shift(4,b.length),Z.write_shift(2,296+32*_),Z.write_shift(2,C),y=0;y<4;++y)Z.write_shift(4,0);for(Z.write_shift(4,0|(+t[vw]||3)<<8),y=0,N=0;y<g.length;++y)if(g[y]!=null){var ee=p.next(32),ne=(g[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ee.write_shift(1,ne,"sbcs"),ee.write_shift(1,E[y]=="?"?"C":E[y],"sbcs"),ee.write_shift(4,N),ee.write_shift(1,O[y]||l[E[y]]||0),ee.write_shift(1,F[y]||0),ee.write_shift(1,2),ee.write_shift(4,0),ee.write_shift(1,0),ee.write_shift(4,0),ee.write_shift(4,0),N+=O[y]||l[E[y]]||0}var he=p.next(264);for(he.write_shift(4,13),y=0;y<65;++y)he.write_shift(4,0);for(y=0;y<b.length;++y){var Q=p.next(C);for(Q.write_shift(1,0),N=0;N<g.length;++N)if(g[N]!=null)switch(E[N]){case"L":Q.write_shift(1,b[y][N]==null?63:b[y][N]?84:70);break;case"B":Q.write_shift(8,b[y][N]||0,"f");break;case"N":var xe="0";for(typeof b[y][N]=="number"&&(xe=b[y][N].toFixed(F[N]||0)),_=0;_<O[N]-xe.length;++_)Q.write_shift(1,32);Q.write_shift(1,xe,"sbcs");break;case"D":b[y][N]?(Q.write_shift(4,("0000"+b[y][N].getFullYear()).slice(-4),"sbcs"),Q.write_shift(2,("00"+(b[y][N].getMonth()+1)).slice(-2),"sbcs"),Q.write_shift(2,("00"+b[y][N].getDate()).slice(-2),"sbcs")):Q.write_shift(8,"00000000","sbcs");break;case"C":var Y=String(b[y][N]!=null?b[y][N]:"").slice(0,O[N]);for(Q.write_shift(1,Y,"sbcs"),_=0;_<O[N]-Y.length;++_)Q.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:s,to_sheet:n,from_sheet:c}})(),FN=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ir(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,b){var v=e[b];return typeof v=="number"?ky(v):v},n=function(g,b,v){var y=b.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return y==59?g:ky(y)};e["|"]=254;function s(g,b){switch(b.type){case"base64":return l(Bn(g),b);case"binary":return l(g,b);case"buffer":return l(xt&&Buffer.isBuffer(g)?g.toString("binary"):xi(g),b);case"array":return l(sl(g),b)}throw new Error("Unrecognized type "+b.type)}function l(g,b){var v=g.split(/[\n\r]+/),y=-1,N=-1,_=0,C=0,S=[],E=[],O=null,F={},T=[],D=[],I=[],J=0,Z;for(+b.codepage>=0&&va(+b.codepage);_!==v.length;++_){J=0;var ee=v[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ne=ee.replace(/;;/g,"\0").split(";").map(function(M){return M.replace(/\u0000/g,";")}),he=ne[0],Q;if(ee.length>0)switch(he){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ne[1].charAt(0)=="P"&&E.push(ee.slice(3).replace(/;;/g,";"));break;case"C":var xe=!1,Y=!1,le=!1,X=!1,ve=-1,K=-1;for(C=1;C<ne.length;++C)switch(ne[C].charAt(0)){case"A":break;case"X":N=parseInt(ne[C].slice(1))-1,Y=!0;break;case"Y":for(y=parseInt(ne[C].slice(1))-1,Y||(N=0),Z=S.length;Z<=y;++Z)S[Z]=[];break;case"K":Q=ne[C].slice(1),Q.charAt(0)==='"'?Q=Q.slice(1,Q.length-1):Q==="TRUE"?Q=!0:Q==="FALSE"?Q=!1:isNaN(ba(Q))?isNaN(No(Q).getDate())||(Q=Wt(Q)):(Q=ba(Q),O!==null&&Fo(O)&&(Q=Kh(Q))),xe=!0;break;case"E":X=!0;var k=ro(ne[C].slice(1),{r:y,c:N});S[y][N]=[S[y][N],k];break;case"S":le=!0,S[y][N]=[S[y][N],"S5S"];break;case"G":break;case"R":ve=parseInt(ne[C].slice(1))-1;break;case"C":K=parseInt(ne[C].slice(1))-1;break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+ee)}if(xe&&(S[y][N]&&S[y][N].length==2?S[y][N][0]=Q:S[y][N]=Q,O=null),le){if(X)throw new Error("SYLK shared formula cannot have own formula");var B=ve>-1&&S[ve][K];if(!B||!B[1])throw new Error("SYLK shared formula cannot find base");S[y][N][1]=qN(B[1],{r:y-ve,c:N-K})}break;case"F":var A=0;for(C=1;C<ne.length;++C)switch(ne[C].charAt(0)){case"X":N=parseInt(ne[C].slice(1))-1,++A;break;case"Y":for(y=parseInt(ne[C].slice(1))-1,Z=S.length;Z<=y;++Z)S[Z]=[];break;case"M":J=parseInt(ne[C].slice(1))/20;break;case"F":break;case"G":break;case"P":O=E[parseInt(ne[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(I=ne[C].slice(1).split(" "),Z=parseInt(I[0],10);Z<=parseInt(I[1],10);++Z)J=parseInt(I[2],10),D[Z-1]=J===0?{hidden:!0}:{wch:J},ci(D[Z-1]);break;case"C":N=parseInt(ne[C].slice(1))-1,D[N]||(D[N]={});break;case"R":y=parseInt(ne[C].slice(1))-1,T[y]||(T[y]={}),J>0?(T[y].hpt=J,T[y].hpx=To(J)):J===0&&(T[y].hidden=!0);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+ee)}A<1&&(O=null);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+ee)}}return T.length>0&&(F["!rows"]=T),D.length>0&&(F["!cols"]=D),b&&b.sheetRows&&(S=S.slice(0,b.sheetRows)),[S,F]}function c(g,b){var v=s(g,b),y=v[0],N=v[1],_=Do(y,b);return ir(N).forEach(function(C){_[C]=N[C]}),_}function u(g,b){return mi(c(g,b),b)}function d(g,b,v,y){var N="C;Y"+(v+1)+";X"+(y+1)+";K";switch(g.t){case"n":N+=g.v||0,g.f&&!g.F&&(N+=";E"+um(g.f,{r:v,c:y}));break;case"b":N+=g.v?"TRUE":"FALSE";break;case"e":N+=g.w||g.v;break;case"d":N+='"'+(g.w||g.v)+'"';break;case"s":N+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return N}function f(g,b){b.forEach(function(v,y){var N="F;W"+(y+1)+" "+(y+1)+" ";v.hidden?N+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Qc(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Yc(v.wpx)),typeof v.wch=="number"&&(N+=Math.round(v.wch))),N.charAt(N.length-1)!=" "&&g.push(N)})}function p(g,b){b.forEach(function(v,y){var N="F;";v.hidden?N+="M0;":v.hpt?N+="M"+20*v.hpt+";":v.hpx&&(N+="M"+20*Jc(v.hpx)+";"),N.length>2&&g.push(N+"R"+(y+1))})}function m(g,b){var v=["ID;PWXL;N;E"],y=[],N=kt(g["!ref"]),_,C=Array.isArray(g),S=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),g["!cols"]&&f(v,g["!cols"]),g["!rows"]&&p(v,g["!rows"]),v.push("B;Y"+(N.e.r-N.s.r+1)+";X"+(N.e.c-N.s.c+1)+";D"+[N.s.c,N.s.r,N.e.c,N.e.r].join(" "));for(var E=N.s.r;E<=N.e.r;++E)for(var O=N.s.c;O<=N.e.c;++O){var F=at({r:E,c:O});_=C?(g[E]||[])[O]:g[F],!(!_||_.v==null&&(!_.f||_.F))&&y.push(d(_,g,E,O))}return v.join(S)+S+y.join(S)+S+"E"+S}return{to_workbook:u,to_sheet:c,from_sheet:m}})(),AN=(function(){function e(l,c){switch(c.type){case"base64":return t(Bn(l),c);case"binary":return t(l,c);case"buffer":return t(xt&&Buffer.isBuffer(l)?l.toString("binary"):xi(l),c);case"array":return t(sl(l),c)}throw new Error("Unrecognized type "+c.type)}function t(l,c){for(var u=l.split(`
`),d=-1,f=-1,p=0,m=[];p!==u.length;++p){if(u[p].trim()==="BOT"){m[++d]=[],f=0;continue}if(!(d<0)){var g=u[p].trim().split(","),b=g[0],v=g[1];++p;for(var y=u[p]||"";(y.match(/["]/g)||[]).length&1&&p<u.length-1;)y+=`
`+u[++p];switch(y=y.trim(),+b){case-1:if(y==="BOT"){m[++d]=[],f=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?m[d][f]=!0:y==="FALSE"?m[d][f]=!1:isNaN(ba(v))?isNaN(No(v).getDate())?m[d][f]=v:m[d][f]=Wt(v):m[d][f]=ba(v),++f;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),m[d][f++]=y!==""?y:null;break}if(y==="EOD")break}}return c&&c.sheetRows&&(m=m.slice(0,c.sheetRows)),m}function r(l,c){return Do(e(l,c),c)}function n(l,c){return mi(r(l,c),c)}var s=(function(){var l=function(d,f,p,m,g){d.push(f),d.push(p+","+m),d.push('"'+g.replace(/"/g,'""')+'"')},c=function(d,f,p,m){d.push(f+","+p),d.push(f==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(d){var f=[],p=kt(d["!ref"]),m,g=Array.isArray(d);l(f,"TABLE",0,1,"sheetjs"),l(f,"VECTORS",0,p.e.r-p.s.r+1,""),l(f,"TUPLES",0,p.e.c-p.s.c+1,""),l(f,"DATA",0,0,"");for(var b=p.s.r;b<=p.e.r;++b){c(f,-1,0,"BOT");for(var v=p.s.c;v<=p.e.c;++v){var y=at({r:b,c:v});if(m=g?(d[b]||[])[v]:d[y],!m){c(f,1,0,"");continue}switch(m.t){case"n":var N=m.w;!N&&m.v!=null&&(N=m.v),N==null?m.f&&!m.F?c(f,1,0,"="+m.f):c(f,1,0,""):c(f,0,N,"V");break;case"b":c(f,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":c(f,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=na(m.z||nt[14],jr(Wt(m.v)))),c(f,0,m.w,"V");break;default:c(f,1,0,"")}}}c(f,-1,0,"EOD");var _=`\r
`,C=f.join(_);return C}})();return{to_workbook:n,to_sheet:r,from_sheet:s}})(),DN=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,g){for(var b=m.split(`
`),v=-1,y=-1,N=0,_=[];N!==b.length;++N){var C=b[N].trim().split(":");if(C[0]==="cell"){var S=tr(C[1]);if(_.length<=S.r)for(v=_.length;v<=S.r;++v)_[v]||(_[v]=[]);switch(v=S.r,y=S.c,C[2]){case"t":_[v][y]=e(C[3]);break;case"v":_[v][y]=+C[3];break;case"vtf":var E=C[C.length-1];case"vtc":switch(C[3]){case"nl":_[v][y]=!!+C[4];break;default:_[v][y]=+C[4];break}C[2]=="vtf"&&(_[v][y]=[_[v][y],E])}}}return g&&g.sheetRows&&(_=_.slice(0,g.sheetRows)),_}function n(m,g){return Do(r(m,g),g)}function s(m,g){return mi(n(m,g),g)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function f(m){if(!m||!m["!ref"])return"";for(var g=[],b=[],v,y="",N=_n(m["!ref"]),_=Array.isArray(m),C=N.s.r;C<=N.e.r;++C)for(var S=N.s.c;S<=N.e.c;++S)if(y=at({r:C,c:S}),v=_?(m[C]||[])[S]:m[y],!(!v||v.v==null||v.t==="z")){switch(b=["cell",y,"t"],v.t){case"s":case"str":b.push(t(v.v));break;case"n":v.f?(b[2]="vtf",b[3]="n",b[4]=v.v,b[5]=t(v.f)):(b[2]="v",b[3]=v.v);break;case"b":b[2]="vt"+(v.f?"f":"c"),b[3]="nl",b[4]=v.v?"1":"0",b[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var E=jr(Wt(v.v));b[2]="vtc",b[3]="nd",b[4]=""+E,b[5]=v.w||na(v.z||nt[14],E);break;case"e":continue}g.push(b.join(":"))}return g.push("sheet:c:"+(N.e.c-N.s.c+1)+":r:"+(N.e.r-N.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function p(m){return[l,c,u,c,f(m),d].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:p}})(),ko=(function(){function e(p,m,g,b,v){v.raw?m[g][b]=p:p===""||(p==="TRUE"?m[g][b]=!0:p==="FALSE"?m[g][b]=!1:isNaN(ba(p))?isNaN(No(p).getDate())?m[g][b]=p:m[g][b]=Wt(p):m[g][b]=ba(p))}function t(p,m){var g=m||{},b=[];if(!p||p.length===0)return b;for(var v=p.split(/[\r\n]/),y=v.length-1;y>=0&&v[y].length===0;)--y;for(var N=10,_=0,C=0;C<=y;++C)_=v[C].indexOf(" "),_==-1?_=v[C].length:_++,N=Math.max(N,_);for(C=0;C<=y;++C){b[C]=[];var S=0;for(e(v[C].slice(0,N).trim(),b,C,S,g),S=1;S<=(v[C].length-N)/10+1;++S)e(v[C].slice(N+(S-1)*10,N+S*10).trim(),b,C,S,g)}return g.sheetRows&&(b=b.slice(0,g.sheetRows)),b}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(p){for(var m={},g=!1,b=0,v=0;b<p.length;++b)(v=p.charCodeAt(b))==34?g=!g:!g&&v in r&&(m[v]=(m[v]||0)+1);v=[];for(b in m)Object.prototype.hasOwnProperty.call(m,b)&&v.push([m[b],b]);if(!v.length){m=n;for(b in m)Object.prototype.hasOwnProperty.call(m,b)&&v.push([m[b],b])}return v.sort(function(y,N){return y[0]-N[0]||n[y[1]]-n[N[1]]}),r[v.pop()[1]]||44}function l(p,m){var g=m||{},b="",v=g.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(b=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(b=p.charAt(4),p=p.slice(6)):b=s(p.slice(0,1024)):g&&g.FS?b=g.FS:b=s(p.slice(0,1024));var N=0,_=0,C=0,S=0,E=0,O=b.charCodeAt(0),F=!1,T=0,D=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var I=g.dateNF!=null?O5(g.dateNF):null;function J(){var Z=p.slice(S,E),ee={};if(Z.charAt(0)=='"'&&Z.charAt(Z.length-1)=='"'&&(Z=Z.slice(1,-1).replace(/""/g,'"')),Z.length===0)ee.t="z";else if(g.raw)ee.t="s",ee.v=Z;else if(Z.trim().length===0)ee.t="s",ee.v=Z;else if(Z.charCodeAt(0)==61)Z.charCodeAt(1)==34&&Z.charCodeAt(Z.length-1)==34?(ee.t="s",ee.v=Z.slice(2,-1).replace(/""/g,'"')):uL(Z)?(ee.t="n",ee.f=Z.slice(1)):(ee.t="s",ee.v=Z);else if(Z=="TRUE")ee.t="b",ee.v=!0;else if(Z=="FALSE")ee.t="b",ee.v=!1;else if(!isNaN(C=ba(Z)))ee.t="n",g.cellText!==!1&&(ee.w=Z),ee.v=C;else if(!isNaN(No(Z).getDate())||I&&Z.match(I)){ee.z=g.dateNF||nt[14];var ne=0;I&&Z.match(I)&&(Z=R5(Z,g.dateNF,Z.match(I)||[]),ne=1),g.cellDates?(ee.t="d",ee.v=Wt(Z,ne)):(ee.t="n",ee.v=jr(Wt(Z,ne))),g.cellText!==!1&&(ee.w=na(ee.z,ee.v instanceof Date?jr(ee.v):ee.v)),g.cellNF||delete ee.z}else ee.t="s",ee.v=Z;if(ee.t=="z"||(g.dense?(v[N]||(v[N]=[]),v[N][_]=ee):v[at({c:_,r:N})]=ee),S=E+1,D=p.charCodeAt(S),y.e.c<_&&(y.e.c=_),y.e.r<N&&(y.e.r=N),T==O)++_;else if(_=0,++N,g.sheetRows&&g.sheetRows<=N)return!0}e:for(;E<p.length;++E)switch(T=p.charCodeAt(E)){case 34:D===34&&(F=!F);break;case O:case 10:case 13:if(!F&&J())break e;break}return E-S>0&&J(),v["!ref"]=ut(y),v}function c(p,m){return!(m&&m.PRN)||m.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?l(p,m):Do(t(p,m),m)}function u(p,m){var g="",b=m.type=="string"?[0,0,0,0]:ym(p,m);switch(m.type){case"base64":g=Bn(p);break;case"binary":g=p;break;case"buffer":m.codepage==65001?g=p.toString("utf8"):m.codepage&&typeof Vc<"u"||(g=xt&&Buffer.isBuffer(p)?p.toString("binary"):xi(p));break;case"array":g=sl(p);break;case"string":g=p;break;default:throw new Error("Unrecognized type "+m.type)}return b[0]==239&&b[1]==187&&b[2]==191?g=Ot(g.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?g=Ot(g):m.type=="binary"&&typeof Vc<"u",g.slice(0,19)=="socialcalc:version:"?DN.to_sheet(m.type=="string"?g:Ot(g),m):c(g,m)}function d(p,m){return mi(u(p,m),m)}function f(p){for(var m=[],g=kt(p["!ref"]),b,v=Array.isArray(p),y=g.s.r;y<=g.e.r;++y){for(var N=[],_=g.s.c;_<=g.e.c;++_){var C=at({r:y,c:_});if(b=v?(p[y]||[])[_]:p[C],!b||b.v==null){N.push("          ");continue}for(var S=(b.w||(xs(b),b.w)||"").slice(0,10);S.length<10;)S+=" ";N.push(S+(_===0?" ":""))}m.push(N.join(""))}return m.join(`
`)}return{to_workbook:d,to_sheet:u,from_sheet:f}})();function Q8(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=FN.to_workbook(e,r);return r.WTF=n,s}catch(l){if(r.WTF=n,!l.message.match(/SYLK bad record ID/)&&n)throw l;return ko.to_workbook(e,t)}}var Ji=(function(){function e(k,B,A){if(k){Hr(k,k.l||0);for(var M=A.Enum||ve;k.l<k.length;){var ae=k.read_shift(2),de=M[ae]||M[65535],be=k.read_shift(2),we=k.l+be,ye=de.f&&de.f(k,be,A);if(k.l=we,B(ye,de,ae))return}}}function t(k,B){switch(B.type){case"base64":return r(Rn(Bn(k)),B);case"binary":return r(Rn(k),B);case"buffer":case"array":return r(k,B)}throw"Unsupported type "+B.type}function r(k,B){if(!k)return k;var A=B||{},M=A.dense?[]:{},ae="Sheet1",de="",be=0,we={},ye=[],Je=[],G={s:{r:0,c:0},e:{r:0,c:0}},Ne=A.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)A.Enum=ve,e(k,function(Oe,Pt,lr){switch(lr){case 0:A.vers=Oe,Oe>=4096&&(A.qpro=!0);break;case 6:G=Oe;break;case 204:Oe&&(de=Oe);break;case 222:de=Oe;break;case 15:case 51:A.qpro||(Oe[1].v=Oe[1].v.slice(1));case 13:case 14:case 16:lr==14&&(Oe[2]&112)==112&&(Oe[2]&15)>1&&(Oe[2]&15)<15&&(Oe[1].z=A.dateNF||nt[14],A.cellDates&&(Oe[1].t="d",Oe[1].v=Kh(Oe[1].v))),A.qpro&&Oe[3]>be&&(M["!ref"]=ut(G),we[ae]=M,ye.push(ae),M=A.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},be=Oe[3],ae=de||"Sheet"+(be+1),de="");var or=A.dense?(M[Oe[0].r]||[])[Oe[0].c]:M[at(Oe[0])];if(or){or.t=Oe[1].t,or.v=Oe[1].v,Oe[1].z!=null&&(or.z=Oe[1].z),Oe[1].f!=null&&(or.f=Oe[1].f);break}A.dense?(M[Oe[0].r]||(M[Oe[0].r]=[]),M[Oe[0].r][Oe[0].c]=Oe[1]):M[at(Oe[0])]=Oe[1];break}},A);else if(k[2]==26||k[2]==14)A.Enum=K,k[2]==14&&(A.qpro=!0,k.l=0),e(k,function(Oe,Pt,lr){switch(lr){case 204:ae=Oe;break;case 22:Oe[1].v=Oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Oe[3]>be&&(M["!ref"]=ut(G),we[ae]=M,ye.push(ae),M=A.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},be=Oe[3],ae="Sheet"+(be+1)),Ne>0&&Oe[0].r>=Ne)break;A.dense?(M[Oe[0].r]||(M[Oe[0].r]=[]),M[Oe[0].r][Oe[0].c]=Oe[1]):M[at(Oe[0])]=Oe[1],G.e.c<Oe[0].c&&(G.e.c=Oe[0].c),G.e.r<Oe[0].r&&(G.e.r=Oe[0].r);break;case 27:Oe[14e3]&&(Je[Oe[14e3][0]]=Oe[14e3][1]);break;case 1537:Je[Oe[0]]=Oe[1],Oe[0]==be&&(ae=Oe[1]);break}},A);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(M["!ref"]=ut(G),we[de||ae]=M,ye.push(de||ae),!Je.length)return{SheetNames:ye,Sheets:we};for(var He={},ht=[],rt=0;rt<Je.length;++rt)we[ye[rt]]?(ht.push(Je[rt]||ye[rt]),He[Je[rt]]=we[Je[rt]]||we[ye[rt]]):(ht.push(Je[rt]),He[Je[rt]]={"!ref":"A1"});return{SheetNames:ht,Sheets:He}}function n(k,B){var A=B||{};if(+A.codepage>=0&&va(+A.codepage),A.type=="string")throw new Error("Cannot write WK1 to JS string");var M=jn(),ae=kt(k["!ref"]),de=Array.isArray(k),be=[];Me(M,0,l(1030)),Me(M,6,d(ae));for(var we=Math.min(ae.e.r,8191),ye=ae.s.r;ye<=we;++ye)for(var Je=pr(ye),G=ae.s.c;G<=ae.e.c;++G){ye===ae.s.r&&(be[G]=er(G));var Ne=be[G]+Je,He=de?(k[ye]||[])[G]:k[Ne];if(!(!He||He.t=="z"))if(He.t=="n")(He.v|0)==He.v&&He.v>=-32768&&He.v<=32767?Me(M,13,b(ye,G,He.v)):Me(M,14,y(ye,G,He.v));else{var ht=xs(He);Me(M,15,m(ye,G,ht.slice(0,239)))}}return Me(M,1),M.end()}function s(k,B){var A=B||{};if(+A.codepage>=0&&va(+A.codepage),A.type=="string")throw new Error("Cannot write WK3 to JS string");var M=jn();Me(M,0,c(k));for(var ae=0,de=0;ae<k.SheetNames.length;++ae)(k.Sheets[k.SheetNames[ae]]||{})["!ref"]&&Me(M,27,X(k.SheetNames[ae],de++));var be=0;for(ae=0;ae<k.SheetNames.length;++ae){var we=k.Sheets[k.SheetNames[ae]];if(!(!we||!we["!ref"])){for(var ye=kt(we["!ref"]),Je=Array.isArray(we),G=[],Ne=Math.min(ye.e.r,8191),He=ye.s.r;He<=Ne;++He)for(var ht=pr(He),rt=ye.s.c;rt<=ye.e.c;++rt){He===ye.s.r&&(G[rt]=er(rt));var Oe=G[rt]+ht,Pt=Je?(we[He]||[])[rt]:we[Oe];if(!(!Pt||Pt.t=="z"))if(Pt.t=="n")Me(M,23,J(He,rt,be,Pt.v));else{var lr=xs(Pt);Me(M,22,T(He,rt,be,lr.slice(0,239)))}}++be}}return Me(M,1),M.end()}function l(k){var B=ke(2);return B.write_shift(2,k),B}function c(k){var B=ke(26);B.write_shift(2,4096),B.write_shift(2,4),B.write_shift(4,0);for(var A=0,M=0,ae=0,de=0;de<k.SheetNames.length;++de){var be=k.SheetNames[de],we=k.Sheets[be];if(!(!we||!we["!ref"])){++ae;var ye=_n(we["!ref"]);A<ye.e.r&&(A=ye.e.r),M<ye.e.c&&(M=ye.e.c)}}return A>8191&&(A=8191),B.write_shift(2,A),B.write_shift(1,ae),B.write_shift(1,M),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(1,1),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(4,0),B}function u(k,B,A){var M={s:{c:0,r:0},e:{c:0,r:0}};return B==8&&A.qpro?(M.s.c=k.read_shift(1),k.l++,M.s.r=k.read_shift(2),M.e.c=k.read_shift(1),k.l++,M.e.r=k.read_shift(2),M):(M.s.c=k.read_shift(2),M.s.r=k.read_shift(2),B==12&&A.qpro&&(k.l+=2),M.e.c=k.read_shift(2),M.e.r=k.read_shift(2),B==12&&A.qpro&&(k.l+=2),M.s.c==65535&&(M.s.c=M.e.c=M.s.r=M.e.r=0),M)}function d(k){var B=ke(8);return B.write_shift(2,k.s.c),B.write_shift(2,k.s.r),B.write_shift(2,k.e.c),B.write_shift(2,k.e.r),B}function f(k,B,A){var M=[{c:0,r:0},{t:"n",v:0},0,0];return A.qpro&&A.vers!=20768?(M[0].c=k.read_shift(1),M[3]=k.read_shift(1),M[0].r=k.read_shift(2),k.l+=2):(M[2]=k.read_shift(1),M[0].c=k.read_shift(2),M[0].r=k.read_shift(2)),M}function p(k,B,A){var M=k.l+B,ae=f(k,B,A);if(ae[1].t="s",A.vers==20768){k.l++;var de=k.read_shift(1);return ae[1].v=k.read_shift(de,"utf8"),ae}return A.qpro&&k.l++,ae[1].v=k.read_shift(M-k.l,"cstr"),ae}function m(k,B,A){var M=ke(7+A.length);M.write_shift(1,255),M.write_shift(2,B),M.write_shift(2,k),M.write_shift(1,39);for(var ae=0;ae<M.length;++ae){var de=A.charCodeAt(ae);M.write_shift(1,de>=128?95:de)}return M.write_shift(1,0),M}function g(k,B,A){var M=f(k,B,A);return M[1].v=k.read_shift(2,"i"),M}function b(k,B,A){var M=ke(7);return M.write_shift(1,255),M.write_shift(2,B),M.write_shift(2,k),M.write_shift(2,A,"i"),M}function v(k,B,A){var M=f(k,B,A);return M[1].v=k.read_shift(8,"f"),M}function y(k,B,A){var M=ke(13);return M.write_shift(1,255),M.write_shift(2,B),M.write_shift(2,k),M.write_shift(8,A,"f"),M}function N(k,B,A){var M=k.l+B,ae=f(k,B,A);if(ae[1].v=k.read_shift(8,"f"),A.qpro)k.l=M;else{var de=k.read_shift(2);E(k.slice(k.l,k.l+de),ae),k.l+=de}return ae}function _(k,B,A){var M=B&32768;return B&=-32769,B=(M?k:0)+(B>=8192?B-16384:B),(M?"":"$")+(A?er(B):pr(B))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(k,B){Hr(k,0);for(var A=[],M=0,ae="",de="",be="",we="";k.l<k.length;){var ye=k[k.l++];switch(ye){case 0:A.push(k.read_shift(8,"f"));break;case 1:de=_(B[0].c,k.read_shift(2),!0),ae=_(B[0].r,k.read_shift(2),!1),A.push(de+ae);break;case 2:{var Je=_(B[0].c,k.read_shift(2),!0),G=_(B[0].r,k.read_shift(2),!1);de=_(B[0].c,k.read_shift(2),!0),ae=_(B[0].r,k.read_shift(2),!1),A.push(Je+G+":"+de+ae)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:A.push("("+A.pop()+")");break;case 5:A.push(k.read_shift(2));break;case 6:{for(var Ne="";ye=k[k.l++];)Ne+=String.fromCharCode(ye);A.push('"'+Ne.replace(/"/g,'""')+'"')}break;case 8:A.push("-"+A.pop());break;case 23:A.push("+"+A.pop());break;case 22:A.push("NOT("+A.pop()+")");break;case 20:case 21:we=A.pop(),be=A.pop(),A.push(["AND","OR"][ye-20]+"("+be+","+we+")");break;default:if(ye<32&&S[ye])we=A.pop(),be=A.pop(),A.push(be+S[ye]+we);else if(C[ye]){if(M=C[ye][1],M==69&&(M=k[k.l++]),M>A.length){console.error("WK1 bad formula parse 0x"+ye.toString(16)+":|"+A.join("|")+"|");return}var He=A.slice(-M);A.length-=M,A.push(C[ye][0]+"("+He.join(",")+")")}else return ye<=7?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=24?console.error("WK1 unsupported op "+ye.toString(16)):ye<=30?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=115?console.error("WK1 unsupported function opcode "+ye.toString(16)):console.error("WK1 unrecognized opcode "+ye.toString(16))}}A.length==1?B[1].f=""+A[0]:console.error("WK1 bad formula parse |"+A.join("|")+"|")}function O(k){var B=[{c:0,r:0},{t:"n",v:0},0];return B[0].r=k.read_shift(2),B[3]=k[k.l++],B[0].c=k[k.l++],B}function F(k,B){var A=O(k);return A[1].t="s",A[1].v=k.read_shift(B-4,"cstr"),A}function T(k,B,A,M){var ae=ke(6+M.length);ae.write_shift(2,k),ae.write_shift(1,A),ae.write_shift(1,B),ae.write_shift(1,39);for(var de=0;de<M.length;++de){var be=M.charCodeAt(de);ae.write_shift(1,be>=128?95:be)}return ae.write_shift(1,0),ae}function D(k,B){var A=O(k);A[1].v=k.read_shift(2);var M=A[1].v>>1;if(A[1].v&1)switch(M&7){case 0:M=(M>>3)*5e3;break;case 1:M=(M>>3)*500;break;case 2:M=(M>>3)/20;break;case 3:M=(M>>3)/200;break;case 4:M=(M>>3)/2e3;break;case 5:M=(M>>3)/2e4;break;case 6:M=(M>>3)/16;break;case 7:M=(M>>3)/64;break}return A[1].v=M,A}function I(k,B){var A=O(k),M=k.read_shift(4),ae=k.read_shift(4),de=k.read_shift(2);if(de==65535)return M===0&&ae===3221225472?(A[1].t="e",A[1].v=15):M===0&&ae===3489660928?(A[1].t="e",A[1].v=42):A[1].v=0,A;var be=de&32768;return de=(de&32767)-16446,A[1].v=(1-be*2)*(ae*Math.pow(2,de+32)+M*Math.pow(2,de)),A}function J(k,B,A,M){var ae=ke(14);if(ae.write_shift(2,k),ae.write_shift(1,A),ae.write_shift(1,B),M==0)return ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(2,65535),ae;var de=0,be=0,we=0,ye=0;return M<0&&(de=1,M=-M),be=Math.log2(M)|0,M/=Math.pow(2,be-31),ye=M>>>0,(ye&2147483648)==0&&(M/=2,++be,ye=M>>>0),M-=ye,ye|=2147483648,ye>>>=0,M*=Math.pow(2,32),we=M>>>0,ae.write_shift(4,we),ae.write_shift(4,ye),be+=16383+(de?32768:0),ae.write_shift(2,be),ae}function Z(k,B){var A=I(k);return k.l+=B-14,A}function ee(k,B){var A=O(k),M=k.read_shift(4);return A[1].v=M>>6,A}function ne(k,B){var A=O(k),M=k.read_shift(8,"f");return A[1].v=M,A}function he(k,B){var A=ne(k);return k.l+=B-10,A}function Q(k,B){return k[k.l+B-1]==0?k.read_shift(B,"cstr"):""}function xe(k,B){var A=k[k.l++];A>B-1&&(A=B-1);for(var M="";M.length<A;)M+=String.fromCharCode(k[k.l++]);return M}function Y(k,B,A){if(!(!A.qpro||B<21)){var M=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var ae=k.read_shift(B-21,"cstr");return[M,ae]}}function le(k,B){for(var A={},M=k.l+B;k.l<M;){var ae=k.read_shift(2);if(ae==14e3){for(A[ae]=[0,""],A[ae][0]=k.read_shift(2);k[k.l];)A[ae][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return A}function X(k,B){var A=ke(5+k.length);A.write_shift(2,14e3),A.write_shift(2,B);for(var M=0;M<k.length;++M){var ae=k.charCodeAt(M);A[A.l++]=ae>127?95:ae}return A[A.l++]=0,A}var ve={0:{n:"BOF",f:yr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:N},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Q},222:{n:"SHEETNAMELP",f:xe},65535:{n:""}},K={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:F},23:{n:"NUMBER17",f:I},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:Z},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:le},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ee},38:{n:"??"},39:{n:"NUMBER27",f:ne},40:{n:"FORMULA28",f:he},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Y},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}})();function Y8(e){var t={},r=e.match(en),n=0,s=!1;if(r)for(;n!=r.length;++n){var l=st(r[n]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;t.cp=Ox[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=l.val;break;case"<sz":t.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":l.rgb&&(t.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(l[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+l[0])}}return t}var J8=(function(){var e=$c("t"),t=$c("rPr");function r(l){var c=l.match(e);if(!c)return{t:"s",v:""};var u={t:"s",v:Nt(c[1])},d=l.match(t);return d&&(u.s=Y8(d[1])),u}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(c){return c.replace(n,"").split(s).map(r).filter(function(u){return u.v})}})(),Z8=(function(){var t=/(\r\n|\n)/g;function r(s,l,c){var u=[];s.u&&u.push("text-decoration: underline;"),s.uval&&u.push("text-underline-style:"+s.uval+";"),s.sz&&u.push("font-size:"+s.sz+"pt;"),s.outline&&u.push("text-effect: outline;"),s.shadow&&u.push("text-shadow: auto;"),l.push('<span style="'+u.join("")+'">'),s.b&&(l.push("<b>"),c.push("</b>")),s.i&&(l.push("<i>"),c.push("</i>")),s.strike&&(l.push("<s>"),c.push("</s>"));var d=s.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(l.push("<"+d+">"),c.push("</"+d+">")),c.push("</span>"),s}function n(s){var l=[[],s.v,[]];return s.v?(s.s&&r(s.s,l[0],l[2]),l[0].join("")+l[1].replace(t,"<br/>")+l[2].join("")):""}return function(l){return l.map(n).join("")}})(),eD=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,tD=/<(?:\w+:)?r>/,rD=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function sm(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Nt(Ot(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ot(e),r&&(n.h=$x(n.t))):e.match(tD)&&(n.r=Ot(e),n.t=Nt(Ot((e.replace(rD,"").match(eD)||[]).join("").replace(en,""))),r&&(n.h=Z8(J8(n.r)))),n):{t:""}}var nD=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,aD=/<(?:\w+:)?(?:si|sstItem)>/g,sD=/<\/(?:\w+:)?(?:si|sstItem)>/;function iD(e,t){var r=[],n="";if(!e)return r;var s=e.match(nD);if(s){n=s[2].replace(aD,"").split(sD);for(var l=0;l!=n.length;++l){var c=sm(n[l].trim(),t);c!=null&&(r[r.length]=c)}s=st(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var lD=/^\s|\s$|[\t\n\r]/;function PN(e,t){if(!t.bookSST)return"";var r=[xr];r[r.length]=Ie("sst",null,{xmlns:dl[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],l="<si>";s.r?l+=s.r:(l+="<t",s.t||(s.t=""),s.t.match(lD)&&(l+=' xml:space="preserve"'),l+=">"+Dt(s.t)+"</t>"),l+="</si>",r[r.length]=l}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function oD(e){return[e.read_shift(4),e.read_shift(4)]}function cD(e,t){var r=[],n=!1;return gs(e,function(l,c,u){switch(u){case 159:r.Count=l[0],r.Unique=l[1];break;case 19:r.push(l);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(c.T,!n||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function uD(e,t){return t||(t=ke(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var hD=wF;function dD(e){var t=jn();_e(t,159,uD(e));for(var r=0;r<e.length;++r)_e(t,19,hD(e[r]));return _e(t,160),t.end()}function LN(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ds(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function fD(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ds(e,4),t.U=ds(e,4),t.W=ds(e,4),t}function pD(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),l=[];s-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=l,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function xD(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(pD(e));return t}function mD(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function gD(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ds(e,4),t.U=ds(e,4),t.W=ds(e,4),t}function vD(e){var t=gD(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function ON(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function RN(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function yD(e){var t=ds(e);switch(t.Minor){case 2:return[t.Minor,bD(e)];case 3:return[t.Minor,wD()];case 4:return[t.Minor,ND(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function bD(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=ON(e,r),s=RN(e,e.length-e.l);return{t:"Std",h:n,v:s}}function wD(){throw new Error("File is password-protected: ECMA-376 Extensible")}function ND(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(en,function(l){var c=st(l);switch(Va(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){n[u]=c[u]});break;case"<dataIntegrity":n.encryptedHmacKey=c.encryptedHmacKey,n.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(c);break;default:throw c[0]}}),n}function kD(e,t){var r={},n=r.EncryptionVersionInfo=ds(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=ON(e,s),t-=s,r.EncryptionVerifier=RN(e,t),r}function TD(e){var t={},r=t.EncryptionVersionInfo=ds(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function im(e){var t=0,r,n=LN(e),s=n.length+1,l,c,u,d,f;for(r=oi(s),r[0]=n.length,l=1;l!=s;++l)r[l]=n[l-1];for(l=s-1;l>=0;--l)c=r[l],u=(t&16384)===0?0:1,d=t<<1&32767,f=u|d,t=f^c;return t^52811}var IN=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(c){return(c/2|c*128)&255},s=function(c,u){return n(c^u)},l=function(c){for(var u=t[c.length-1],d=104,f=c.length-1;f>=0;--f)for(var p=c[f],m=0;m!=7;++m)p&64&&(u^=r[d]),p*=2,--d;return u};return function(c){for(var u=LN(c),d=l(u),f=u.length,p=oi(16),m=0;m!=16;++m)p[m]=0;var g,b,v;for((f&1)===1&&(g=d>>8,p[f]=s(e[0],g),--f,g=d&255,b=u[u.length-1],p[f]=s(b,g));f>0;)--f,g=d>>8,p[f]=s(u[f],g),--f,g=d&255,p[f]=s(u[f],g);for(f=15,v=15-u.length;v>0;)g=d>>8,p[f]=s(e[v],g),--f,--v,g=d&255,p[f]=s(u[f],g),--f,--v;return p}})(),jD=function(e,t,r,n,s){s||(s=t),n||(n=IN(e));var l,c;for(l=0;l!=t.length;++l)c=t[l],c^=n[r],c=(c>>5|c<<3)&255,s[l]=c,++r;return[s,r,n]},_D=function(e){var t=0,r=IN(e);return function(n){var s=jD("",n,t,r);return t=s[1],s[0]}};function SD(e,t,r,n){var s={key:yr(e),verificationBytes:yr(e)};return r.password&&(s.verifier=im(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=_D(r.password)),s}function CD(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=TD(e):n.Data=kD(e,t),n}function ED(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?CD(e,t-2,n):SD(e,r.biff>=8?t:t-2,r,n),n}var MN=(function(){function e(s,l){switch(l.type){case"base64":return t(Bn(s),l);case"binary":return t(s,l);case"buffer":return t(xt&&Buffer.isBuffer(s)?s.toString("binary"):xi(s),l);case"array":return t(sl(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){var c=l||{},u=c.dense?[]:{},d=s.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(p,m){Array.isArray(u)&&(u[m]=[]);for(var g=/\\\w+\b/g,b=0,v,y=-1;v=g.exec(p);){switch(v[0]){case"\\cell":var N=p.slice(b,g.lastIndex-v[0].length);if(N[0]==" "&&(N=N.slice(1)),++y,N.length){var _={v:N,t:"s"};Array.isArray(u)?u[m][y]=_:u[at({r:m,c:y})]=_}break}b=g.lastIndex}y>f.e.c&&(f.e.c=y)}),u["!ref"]=ut(f),u}function r(s,l){return mi(e(s,l),l)}function n(s){for(var l=["{\\rtf1\\ansi"],c=kt(s["!ref"]),u,d=Array.isArray(s),f=c.s.r;f<=c.e.r;++f){l.push("\\trowd\\trautofit1");for(var p=c.s.c;p<=c.e.c;++p)l.push("\\cellx"+(p+1));for(l.push("\\pard\\intbl"),p=c.s.c;p<=c.e.c;++p){var m=at({r:f,c:p});u=d?(s[f]||[])[p]:s[m],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||(xs(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function FD(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Xc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function AD(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),l=Math.min(t,r,n),c=s-l;if(c===0)return[0,0,t];var u=0,d=0,f=s+l;switch(d=c/(f>1?2-f:f),s){case t:u=((r-n)/c+6)%6;break;case r:u=(n-t)/c+2;break;case n:u=(t-r)/c+4;break}return[u/6,d,f/2]}function DD(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),l=n-s/2,c=[l,l,l],u=6*t,d;if(r!==0)switch(u|0){case 0:case 6:d=s*u,c[0]+=s,c[1]+=d;break;case 1:d=s*(2-u),c[0]+=d,c[1]+=s;break;case 2:d=s*(u-2),c[1]+=s,c[2]+=d;break;case 3:d=s*(4-u),c[1]+=d,c[2]+=s;break;case 4:d=s*(u-4),c[2]+=s,c[0]+=d;break;case 5:d=s*(6-u),c[2]+=d,c[0]+=s;break}for(var f=0;f!=3;++f)c[f]=Math.round(c[f]*255);return c}function kh(e,t){if(t===0)return e;var r=AD(FD(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Xc(DD(r))}var BN=6,PD=15,LD=1,Xr=BN;function Qc(e){return Math.floor((e+Math.round(128/Xr)/256)*Xr)}function Yc(e){return Math.floor((e-5)/Xr*100+.5)/100}function Th(e){return Math.round((e*Xr+5)/Xr*256)/256}function lp(e){return Th(Yc(Qc(e)))}function lm(e){var t=Math.abs(e-lp(e)),r=Xr;if(t>.005)for(Xr=LD;Xr<PD;++Xr)Math.abs(e-lp(e))<=t&&(t=Math.abs(e-lp(e)),r=Xr);Xr=r}function ci(e){e.width?(e.wpx=Qc(e.width),e.wch=Yc(e.wpx),e.MDW=Xr):e.wpx?(e.wch=Yc(e.wpx),e.width=Th(e.wch),e.MDW=Xr):typeof e.wch=="number"&&(e.width=Th(e.wch),e.wpx=Qc(e.width),e.MDW=Xr),e.customWidth&&delete e.customWidth}var OD=96,HN=OD;function Jc(e){return e*96/HN}function To(e){return e*HN/96}var RD={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function ID(e,t,r,n){t.Borders=[];var s={},l=!1;(e[0].match(en)||[]).forEach(function(c){var u=st(c);switch(Va(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},u.diagonalUp&&(s.diagonalUp=$t(u.diagonalUp)),u.diagonalDown&&(s.diagonalDown=$t(u.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in borders")}})}function MD(e,t,r,n){t.Fills=[];var s={},l=!1;(e[0].match(en)||[]).forEach(function(c){var u=st(c);switch(Va(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":u.patternType&&(s.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),u.indexed&&(s.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(s.bgColor.theme=parseInt(u.theme,10)),u.tint&&(s.bgColor.tint=parseFloat(u.tint)),u.rgb&&(s.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),u.theme&&(s.fgColor.theme=parseInt(u.theme,10)),u.tint&&(s.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(s.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fills")}})}function BD(e,t,r,n){t.Fonts=[];var s={},l=!1;(e[0].match(en)||[]).forEach(function(c){var u=st(c);switch(Va(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":u.val&&(s.name=Ot(u.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=u.val?$t(u.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=u.val?$t(u.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(u.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=u.val?$t(u.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=u.val?$t(u.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=u.val?$t(u.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=u.val?$t(u.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=u.val?$t(u.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":u.val&&(s.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(s.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(s.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(s.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=Ox[parseInt(u.val,10)];break;case"<color":if(s.color||(s.color={}),u.auto&&(s.color.auto=$t(u.auto)),u.rgb)s.color.rgb=u.rgb.slice(-6);else if(u.indexed){s.color.index=parseInt(u.indexed,10);var d=Qi[s.color.index];s.color.index==81&&(d=Qi[1]),d||(d=Qi[1]),s.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else u.theme&&(s.color.theme=parseInt(u.theme,10),u.tint&&(s.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=kh(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fonts")}})}function HD(e,t,r){t.NumberFmt=[];for(var n=ir(nt),s=0;s<n.length;++s)t.NumberFmt[n[s]]=nt[n[s]];var l=e[0].match(en);if(l)for(s=0;s<l.length;++s){var c=st(l[s]);switch(Va(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Nt(Ot(c.formatCode)),d=parseInt(c.numFmtId,10);if(t.NumberFmt[d]=u,d>0){if(d>392){for(d=392;d>60&&t.NumberFmt[d]!=null;--d);t.NumberFmt[d]=u}hs(u,d)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}function UD(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ie("numFmt",null,{numFmtId:n,formatCode:Dt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ie("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var K0=["numFmtId","fillId","fontId","borderId","xfId"],$0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function VD(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(en)||[]).forEach(function(l){var c=st(l),u=0;switch(Va(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=c,delete n[0],u=0;u<K0.length;++u)n[K0[u]]&&(n[K0[u]]=parseInt(n[K0[u]],10));for(u=0;u<$0.length;++u)n[$0[u]]&&(n[$0[u]]=$t(n[$0[u]]));if(t.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[u]){n.numFmtId=u;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};c.vertical&&(d.vertical=c.vertical),c.horizontal&&(d.horizontal=c.horizontal),c.textRotation!=null&&(d.textRotation=c.textRotation),c.indent&&(d.indent=c.indent),c.wrapText&&(d.wrapText=$t(c.wrapText)),n.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}function zD(e){var t=[];return t[t.length]=Ie("cellXfs",null),e.forEach(function(r){t[t.length]=Ie("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ie("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var KD=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,d,f){var p={};if(!u)return p;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=u.match(t))&&HD(m,p,f),(m=u.match(s))&&BD(m,p,d,f),(m=u.match(n))&&MD(m,p,d,f),(m=u.match(l))&&ID(m,p,d,f),(m=u.match(r))&&VD(m,p,f),p}})();function UN(e,t){var r=[xr,Ie("styleSheet",null,{xmlns:dl[0],"xmlns:vt":Tr.vt})],n;return e.SSF&&(n=UD(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=zD(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function $D(e,t){var r=e.read_shift(2),n=Jr(e);return[r,n]}function WD(e,t,r){r||(r=ke(6+4*t.length)),r.write_shift(2,e),Rr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function GD(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=CF(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var l=e.read_shift(2);switch(l===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var c=e.read_shift(1);c!=0&&(n.underline=c);var u=e.read_shift(1);u>0&&(n.family=u);var d=e.read_shift(1);switch(d>0&&(n.charset=d),e.l++,n.color=SF(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Jr(e),n}function qD(e,t){t||(t=ke(153)),t.write_shift(2,e.sz*20),EF(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),bh(e.color,t);var n=0;return n=2,t.write_shift(1,n),Rr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var XD=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],op,QD=Zr;function f2(e,t){t||(t=ke(84)),op||(op=Vh(XD));var r=op[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(bh({auto:1},t),bh({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function YD(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function VN(e,t,r){r||(r=ke(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function bc(e,t){return t||(t=ke(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var JD=Zr;function ZD(e,t){return t||(t=ke(51)),t.write_shift(1,0),bc(null,t),bc(null,t),bc(null,t),bc(null,t),bc(null,t),t.length>t.l?t.slice(0,t.l):t}function eP(e,t){return t||(t=ke(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),yh(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function tP(e,t,r){var n=ke(2052);return n.write_shift(4,e),yh(t,n),yh(r,n),n.length>n.l?n.slice(0,n.l):n}function rP(e,t,r){var n={};n.NumberFmt=[];for(var s in nt)n.NumberFmt[s]=nt[s];n.CellXf=[],n.Fonts=[];var l=[],c=!1;return gs(e,function(d,f,p){switch(p){case 44:n.NumberFmt[d[0]]=d[1],hs(d[1],d[0]);break;case 43:n.Fonts.push(d),d.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(d.color.rgb=kh(t.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&n.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:l.push(p),c=!0;break;case 38:l.pop(),c=!1;break;default:if(f.T>0)l.push(p);else if(f.T<0)l.pop();else if(!c||r.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}function nP(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(_e(e,615,wa(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&_e(e,44,WD(s,t[s]))}),_e(e,616))}}function aP(e){var t=1;_e(e,611,wa(t)),_e(e,43,qD({sz:12,color:{theme:1},name:"Calibri",family:2})),_e(e,612)}function sP(e){var t=2;_e(e,603,wa(t)),_e(e,45,f2({patternType:"none"})),_e(e,45,f2({patternType:"gray125"})),_e(e,604)}function iP(e){var t=1;_e(e,613,wa(t)),_e(e,46,ZD()),_e(e,614)}function lP(e){var t=1;_e(e,626,wa(t)),_e(e,47,VN({numFmtId:0},65535)),_e(e,627)}function oP(e,t){_e(e,617,wa(t.length)),t.forEach(function(r){_e(e,47,VN(r,0))}),_e(e,618)}function cP(e){var t=1;_e(e,619,wa(t)),_e(e,48,eP({xfId:0,name:"Normal"})),_e(e,620)}function uP(e){var t=0;_e(e,505,wa(t)),_e(e,506)}function hP(e){var t=0;_e(e,508,tP(t,"TableStyleMedium9","PivotStyleMedium4")),_e(e,509)}function dP(e,t){var r=jn();return _e(r,278),nP(r,e.SSF),aP(r),sP(r),iP(r),lP(r),oP(r,t.cellXfs),cP(r),uP(r),hP(r),_e(r,279),r.end()}var fP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function pP(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(en)||[]).forEach(function(s){var l=st(s);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=l.val;break;case"<a:sysClr":n.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(t.themeElements.clrScheme[fP.indexOf(l[0])]=n,n={}):n.name=l[0].slice(3,l[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function xP(){}function mP(){}var gP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,vP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,yP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function bP(e,t,r){t.themeElements={};var n;[["clrScheme",gP,pP],["fontScheme",vP,xP],["fmtScheme",yP,mP]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var wP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function zN(e,t){(!e||e.length===0)&&(e=om());var r,n={};if(!(r=e.match(wP)))throw new Error("themeElements not found in theme");return bP(r[0],n,t),n.raw=e,n}function om(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[xr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function NP(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var l=e.slice(e.l);e.l=n;var c;try{c=Ow(l,{type:"array"})}catch{return}var u=In(c,"theme/theme/theme1.xml",!0);if(u)return zN(u,r)}}function kP(e){return e.read_shift(4)}function TP(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=jP(e,4);break;case 2:t.xclrValue=NN(e);break;case 3:t.xclrValue=kP(e);break;case 4:e.l+=4;break}return e.l+=8,t}function jP(e,t){return Zr(e,t)}function _P(e,t){return Zr(e,t)}function SP(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=TP(e);break;case 6:n[1]=_P(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function CP(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),l=[];s-- >0;)l.push(SP(e,r-e.l));return{ixfe:n,ext:l}}function EP(e,t){t.forEach(function(r){r[0]})}function FP(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Jr(e)}}function AP(e){var t=ke(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Rr(e.name,t),t.slice(0,t.l)}function DP(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function PP(e){var t=ke(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function LP(e,t){var r=ke(8+2*t.length);return r.write_shift(4,e),Rr(t,r),r.slice(0,r.l)}function OP(e){return e.l+=4,e.read_shift(4)!=0}function RP(e,t){var r=ke(8);return r.write_shift(4,e),r.write_shift(4,1),r}function IP(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},l=[],c=!1,u=2;return gs(e,function(d,f,p){switch(p){case 335:n.Types.push({name:d.name});break;case 51:d.forEach(function(m){u==1?n.Cell.push({type:n.Types[m[0]-1].name,index:m[1]}):u==0&&n.Value.push({type:n.Types[m[0]-1].name,index:m[1]})});break;case 337:u=d?1:0;break;case 338:u=2;break;case 35:l.push(p),c=!0;break;case 36:l.pop(),c=!1;break;default:if(!f.T){if(!c||s.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function MP(){var e=jn();return _e(e,332),_e(e,334,wa(1)),_e(e,335,AP({name:"XLDAPR",version:12e4,flags:3496657072})),_e(e,336),_e(e,339,LP(1,"XLDAPR")),_e(e,52),_e(e,35,wa(514)),_e(e,4096,wa(0)),_e(e,4097,Zn(1)),_e(e,36),_e(e,53),_e(e,340),_e(e,337,RP(1)),_e(e,51,PP([[1,0]])),_e(e,338),_e(e,333),e.end()}function BP(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,l=2,c;return e.replace(en,function(u){var d=st(u);switch(Va(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==d.name&&(c=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?n.Cell.push({type:n.Types[d.t-1].name,index:+d.v}):l==0&&n.Value.push({type:n.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+d.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return u}),n}function KN(){var e=[xr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function HP(e){var t=[];if(!e)return t;var r=1;return(e.match(en)||[]).forEach(function(n){var s=st(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function UP(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=at(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function VP(e,t,r){var n=[];return gs(e,function(l,c,u){switch(u){case 63:n.push(l);break;default:if(!c.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function zP(e,t,r,n){if(!e)return e;var s=n||{},l=!1;gs(e,function(u,d,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!d.T){if(!l||s.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},s)}function KP(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Jl=1024;function $N(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Ie("xml",null,{"xmlns:v":Ln.v,"xmlns:o":Ln.o,"xmlns:x":Ln.x,"xmlns:mv":Ln.mv}).replace(/\/>/,">"),Ie("o:shapelayout",Ie("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ie("v:shapetype",[Ie("v:stroke",null,{joinstyle:"miter"}),Ie("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Jl<e*1e3;)Jl+=1e3;return t.forEach(function(l){var c=tr(l[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var d=u.type=="gradient"?Ie("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Ie("v:fill",d,u),p={on:"t",obscured:"t"};++Jl,s=s.concat(["<v:shape"+Wc({id:"_x0000_s"+Jl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Ie("v:shadow",null,p),Ie("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ur("x:Anchor",[c.c+1,0,c.r+1,0,c.c+3,20,c.r+5,20].join(",")),Ur("x:AutoFill","False"),Ur("x:Row",String(c.r)),Ur("x:Column",String(c.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function p2(e,t,r,n){var s=Array.isArray(e),l;t.forEach(function(c){var u=tr(c.ref);if(s?(e[u.r]||(e[u.r]=[]),l=e[u.r][u.c]):l=e[c.ref],!l){l={t:"z"},s?e[u.r][u.c]=l:e[c.ref]=l;var d=kt(e["!ref"]||"BDWGO1000001:A1");d.s.r>u.r&&(d.s.r=u.r),d.e.r<u.r&&(d.e.r=u.r),d.s.c>u.c&&(d.s.c=u.c),d.e.c<u.c&&(d.e.c=u.c);var f=ut(d);f!==e["!ref"]&&(e["!ref"]=f)}l.c||(l.c=[]);var p={a:c.author,t:c.t,r:c.r,T:r};c.h&&(p.h=c.h);for(var m=l.c.length-1;m>=0;--m){if(!r&&l.c[m].T)return;r&&!l.c[m].T&&l.c.splice(m,1)}if(r&&n){for(m=0;m<n.length;++m)if(p.a==n[m].id){p.a=n[m].name||p.a;break}}l.c.push(p)})}function $P(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?comment[^>]*>/);if(u){var d=st(u[0]),f={author:d.authorId&&r[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},p=tr(d.ref);if(!(t.sheetRows&&t.sheetRows<=p.r)){var m=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!m&&!!m[1]&&sm(m[1])||{r:"",t:"",h:""};f.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),f.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=g.h),n.push(f)}}}}),n}function WN(e){var t=[xr,Ie("comments",null,{xmlns:dl[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var l=Dt(s.a);r.indexOf(l)==-1&&(r.push(l),t.push("<author>"+l+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,l=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(d){d.a&&(s=r.indexOf(Dt(d.a))),l.push(d.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),l.length<=1)t.push(Ur("t",Dt(l[0]||"")));else{for(var c=`Comment:
    `+l[0]+`
`,u=1;u<l.length;++u)c+=`Reply:
    `+l[u]+`
`;t.push(Ur("t",Dt(c)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function WP(e,t){var r=[],n=!1,s={},l=0;return e.replace(en,function(u,d){var f=st(u);switch(Va(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":l=d+u.length;break;case"</text>":s.t=e.slice(l,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return u}),r}function GP(e,t,r){var n=[xr,Ie("ThreadedComments",null,{xmlns:Tr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var l="";(s[1]||[]).forEach(function(c,u){if(!c.T){delete c.ID;return}c.a&&t.indexOf(c.a)==-1&&t.push(c.a);var d={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?l=d.id:d.parentId=l,c.ID=d.id,c.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(c.a)).slice(-12)+"}"),n.push(Ie("threadedComment",Ur("text",c.t||""),d))})}),n.push("</ThreadedComments>"),n.join("")}function qP(e,t){var r=[],n=!1;return e.replace(en,function(l){var c=st(l);switch(Va(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return l}),r}function XP(e){var t=[xr,Ie("personList",null,{xmlns:Tr.TCMNT,"xmlns:x":dl[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ie("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function QP(e){var t={};t.iauthor=e.read_shift(4);var r=ml(e);return t.rfx=r.s,t.ref=at(r.s),e.l+=16,t}function YP(e,t){return t==null&&(t=ke(36)),t.write_shift(4,e[1].iauthor),Po(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var JP=Jr;function ZP(e){return Rr(e.slice(0,54))}function eL(e,t){var r=[],n=[],s={},l=!1;return gs(e,function(u,d,f){switch(f){case 632:n.push(u);break;case 635:s=u;break;case 637:s.t=u.t,s.h=u.h,s.r=u.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!l||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}function tL(e){var t=jn(),r=[];return _e(t,628),_e(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),_e(t,632,ZP(s.a)))})}),_e(t,631),_e(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var l={s:tr(n[0]),e:tr(n[0])};_e(t,635,YP([l,s])),s.t&&s.t.length>0&&_e(t,637,kF(s)),_e(t,636),delete s.iauthor})}),_e(t,634),_e(t,629),t.end()}var rL="application/vnd.ms-office.vbaProject";function nL(e){var t=Ye.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ye.utils.cfb_add(t,s,e.FileIndex[n].content)}}),Ye.write(t)}function aL(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Ye.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var GN=["xlsb","xlsm","xlam","biff8","xla"];function sL(){return{"!type":"dialog"}}function iL(){return{"!type":"dialog"}}function lL(){return{"!type":"macro"}}function oL(){return{"!type":"macro"}}var ro=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,l,c){var u=!1,d=!1;l.length==0?d=!0:l.charAt(0)=="["&&(d=!0,l=l.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var f=l.length>0?parseInt(l,10)|0:0,p=c.length>0?parseInt(c,10)|0:0;return u?p+=t.c:--p,d?f+=t.r:--f,s+(u?"":"$")+er(p)+(d?"":"$")+pr(f)}return function(s,l){return t=l,s.replace(e,r)}})(),cm=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,um=(function(){return function(t,r){return t.replace(cm,function(n,s,l,c,u,d){var f=Qx(c)-(l?0:r.c),p=Xx(d)-(u?0:r.r),m=p==0?"":u?p+1:"["+p+"]",g=f==0?"":l?f+1:"["+f+"]";return s+"R"+m+"C"+g})}})();function qN(e,t){return e.replace(cm,function(r,n,s,l,c,u){return n+(s=="$"?s+l:er(Qx(l)+t.c))+(c=="$"?c+u:pr(Xx(u)+t.r))})}function cL(e,t,r){var n=_n(t),s=n.s,l=tr(r),c={r:l.r-s.r,c:l.c-s.c};return qN(e,c)}function uL(e){return e.length!=1}function x2(e){return e.replace(/_xlfn\./g,"")}function gr(e){e.l+=1}function ui(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function XN(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return QN(e);r.biff==12&&(n=4)}var s=e.read_shift(n),l=e.read_shift(n),c=ui(e),u=ui(e);return{s:{r:s,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function QN(e){var t=ui(e),r=ui(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function hL(e,t,r){if(r.biff<8)return QN(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),l=ui(e),c=ui(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function YN(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return dL(e);var n=e.read_shift(r&&r.biff==12?4:2),s=ui(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function dL(e){var t=ui(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function fL(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function pL(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return xL(e);var s=e.read_shift(n>=12?4:2),l=e.read_shift(2),c=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;s>524287;)s-=1048576;if(c==1)for(;l>8191;)l=l-16384;return{r:s,c:l,cRel:c,rRel:u}}function xL(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function mL(e,t,r){var n=(e[e.l++]&96)>>5,s=XN(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function gL(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var c=XN(e,l,r);return[n,s,c]}function vL(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function yL(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[n,s]}function bL(e,t,r){var n=(e[e.l++]&96)>>5,s=hL(e,t-1,r);return[n,s]}function wL(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function m2(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function NL(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],l=0;l<=n;++l)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function kL(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function TL(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function jL(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function _L(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function JN(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function SL(e){return e.read_shift(2),JN(e)}function CL(e){return e.read_shift(2),JN(e)}function EL(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=YN(e,0,r);return[n,s]}function FL(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=pL(e,0,r);return[n,s]}function AL(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var l=YN(e,0,r);return[n,s,l]}function DL(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[OO[s],tk[s],n]}function PL(e,t,r){var n=e[e.l++],s=e.read_shift(1),l=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:LL(e);return[s,(l[0]===0?tk:LO)[l[1]]]}function LL(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function OL(e,t,r){e.l+=r&&r.biff==2?3:4}function RL(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function IL(e){return e.l++,vs[e.read_shift(1)]}function ML(e){return e.l++,e.read_shift(2)}function BL(e){return e.l++,e.read_shift(1)!==0}function HL(e){return e.l++,Yr(e)}function UL(e,t,r){return e.l++,xu(e,t-1,r)}function VL(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=dr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=vs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Yr(e);break;case 2:r[1]=gl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function zL(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],l=0;l!=n;++l)s.push((r.biff==12?ml:$h)(e));return s}function KL(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var l=0,c=[];l!=n&&(c[l]=[]);++l)for(var u=0;u!=s;++u)c[l][u]=VL(e,r.biff);return c}function $L(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,l=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,l]}function WL(e,t,r){if(r.biff==5)return GL(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),l=e.read_shift(4);return[n,s,l]}function GL(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function qL(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function XL(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function QL(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function YL(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),l=4;if(r)switch(r.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[n,s]}var JL=Zr,ZL=Zr,eO=Zr;function gu(e,t,r){return e.l+=2,[fL(e)]}function hm(e){return e.l+=6,[]}var tO=gu,rO=hm,nO=hm,aO=gu;function ZN(e){return e.l+=2,[yr(e),e.read_shift(2)&1]}var sO=gu,iO=ZN,lO=hm,oO=gu,cO=gu,uO=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function hO(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),l=e.read_shift(2),c=uO[r>>2&31];return{ixti:t,coltype:r&3,rt:c,idx:n,c:s,C:l}}function dO(e){return e.l+=2,[e.read_shift(4)]}function fO(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function pO(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function xO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function mO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function gO(e){return e.l+=4,[0,0]}var g2={1:{n:"PtgExp",f:RL},2:{n:"PtgTbl",f:eO},3:{n:"PtgAdd",f:gr},4:{n:"PtgSub",f:gr},5:{n:"PtgMul",f:gr},6:{n:"PtgDiv",f:gr},7:{n:"PtgPower",f:gr},8:{n:"PtgConcat",f:gr},9:{n:"PtgLt",f:gr},10:{n:"PtgLe",f:gr},11:{n:"PtgEq",f:gr},12:{n:"PtgGe",f:gr},13:{n:"PtgGt",f:gr},14:{n:"PtgNe",f:gr},15:{n:"PtgIsect",f:gr},16:{n:"PtgUnion",f:gr},17:{n:"PtgRange",f:gr},18:{n:"PtgUplus",f:gr},19:{n:"PtgUminus",f:gr},20:{n:"PtgPercent",f:gr},21:{n:"PtgParen",f:gr},22:{n:"PtgMissArg",f:gr},23:{n:"PtgStr",f:UL},26:{n:"PtgSheet",f:fO},27:{n:"PtgEndSheet",f:pO},28:{n:"PtgErr",f:IL},29:{n:"PtgBool",f:BL},30:{n:"PtgInt",f:ML},31:{n:"PtgNum",f:HL},32:{n:"PtgArray",f:wL},33:{n:"PtgFunc",f:DL},34:{n:"PtgFuncVar",f:PL},35:{n:"PtgName",f:$L},36:{n:"PtgRef",f:EL},37:{n:"PtgArea",f:mL},38:{n:"PtgMemArea",f:qL},39:{n:"PtgMemErr",f:JL},40:{n:"PtgMemNoMem",f:ZL},41:{n:"PtgMemFunc",f:XL},42:{n:"PtgRefErr",f:QL},43:{n:"PtgAreaErr",f:vL},44:{n:"PtgRefN",f:FL},45:{n:"PtgAreaN",f:bL},46:{n:"PtgMemAreaN",f:xO},47:{n:"PtgMemNoMemN",f:mO},57:{n:"PtgNameX",f:WL},58:{n:"PtgRef3d",f:AL},59:{n:"PtgArea3d",f:gL},60:{n:"PtgRefErr3d",f:YL},61:{n:"PtgAreaErr3d",f:yL},255:{}},vO={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},yO={1:{n:"PtgElfLel",f:ZN},2:{n:"PtgElfRw",f:oO},3:{n:"PtgElfCol",f:tO},6:{n:"PtgElfRwV",f:cO},7:{n:"PtgElfColV",f:aO},10:{n:"PtgElfRadical",f:sO},11:{n:"PtgElfRadicalS",f:lO},13:{n:"PtgElfColS",f:rO},15:{n:"PtgElfColSV",f:nO},16:{n:"PtgElfRadicalLel",f:iO},25:{n:"PtgList",f:hO},29:{n:"PtgSxName",f:dO},255:{}},bO={0:{n:"PtgAttrNoop",f:gO},1:{n:"PtgAttrSemi",f:_L},2:{n:"PtgAttrIf",f:TL},4:{n:"PtgAttrChoose",f:NL},8:{n:"PtgAttrGoto",f:kL},16:{n:"PtgAttrSum",f:OL},32:{n:"PtgAttrBaxcel",f:m2},33:{n:"PtgAttrBaxcel",f:m2},64:{n:"PtgAttrSpace",f:SL},65:{n:"PtgAttrSpaceSemi",f:CL},128:{n:"PtgAttrIfError",f:jL},255:{}};function vu(e,t,r,n){if(n.biff<8)return Zr(e,t);for(var s=e.l+t,l=[],c=0;c!==r.length;++c)switch(r[c][0]){case"PtgArray":r[c][1]=KL(e,0,n),l.push(r[c][1]);break;case"PtgMemArea":r[c][2]=zL(e,r[c][1],n),l.push(r[c][2]);break;case"PtgExp":n&&n.biff==12&&(r[c][1][1]=e.read_shift(4),l.push(r[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[c][0]}return t=s-e.l,t!==0&&l.push(Zr(e,t)),l}function yu(e,t,r){for(var n=e.l+t,s,l,c=[];n!=e.l;)t=n-e.l,l=e[e.l],s=g2[l]||g2[vO[l]],(l===24||l===25)&&(s=(l===24?yO:bO)[e[e.l+1]]),!s||!s.f?Zr(e,t):c.push([s.n,s.f(e,t,r)]);return c}function wO(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],l=0;l<n.length;++l){var c=n[l];if(c)switch(c[0]){case 2:s.push('"'+c[1].replace(/"/g,'""')+'"');break;default:s.push(c[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var NO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function kO(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function ek(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function v2(e,t,r){var n=ek(e,t,r);return n=="#REF"?n:kO(n,r)}function qr(e,t,r,n,s){var l=s&&s.biff||8,c={s:{c:0,r:0}},u=[],d,f,p,m=0,g=0,b,v="";if(!e[0]||!e[0][0])return"";for(var y=-1,N="",_=0,C=e[0].length;_<C;++_){var S=e[0][_];switch(S[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=u.pop(),f=u.pop(),y>=0){switch(e[0][y][1][0]){case 0:N=ar(" ",e[0][y][1][1]);break;case 1:N=ar("\r",e[0][y][1][1]);break;default:if(N="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}f=f+N,y=-1}u.push(f+NO[S[0]]+d);break;case"PtgIsect":d=u.pop(),f=u.pop(),u.push(f+" "+d);break;case"PtgUnion":d=u.pop(),f=u.pop(),u.push(f+","+d);break;case"PtgRange":d=u.pop(),f=u.pop(),u.push(f+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Fc(S[1][1],c,s),u.push(Ac(p,l));break;case"PtgRefN":p=r?Fc(S[1][1],r,s):S[1][1],u.push(Ac(p,l));break;case"PtgRef3d":m=S[1][1],p=Fc(S[1][2],c,s),v=v2(n,m,s),u.push(v+"!"+Ac(p,l));break;case"PtgFunc":case"PtgFuncVar":var E=S[1][0],O=S[1][1];E||(E=0),E&=127;var F=E==0?[]:u.slice(-E);u.length-=E,O==="User"&&(O=F.shift()),u.push(O+"("+F.join(",")+")");break;case"PtgBool":u.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(S[1]);break;case"PtgNum":u.push(String(S[1]));break;case"PtgStr":u.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(S[1]);break;case"PtgAreaN":b=Gy(S[1][1],r?{s:r}:c,s),u.push(ap(b,s));break;case"PtgArea":b=Gy(S[1][1],c,s),u.push(ap(b,s));break;case"PtgArea3d":m=S[1][1],b=S[1][2],v=v2(n,m,s),u.push(v+"!"+ap(b,s));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=S[1][2];var T=(n.names||[])[g-1]||(n[0]||[])[g],D=T?T.Name:"SH33TJSNAME"+String(g);D&&D.slice(0,6)=="_xlfn."&&!s.xlfn&&(D=D.slice(6)),u.push(D);break;case"PtgNameX":var I=S[1][1];g=S[1][2];var J;if(s.biff<=5)I<0&&(I=-I),n[I]&&(J=n[I][g]);else{var Z="";if(((n[I]||[])[0]||[])[0]==14849||(((n[I]||[])[0]||[])[0]==1025?n[I][g]&&n[I][g].itab>0&&(Z=n.SheetNames[n[I][g].itab-1]+"!"):Z=n.SheetNames[g-1]+"!"),n[I]&&n[I][g])Z+=n[I][g].Name;else if(n[0]&&n[0][g])Z+=n[0][g].Name;else{var ee=(ek(n,I,s)||"").split(";;");ee[g-1]?Z=ee[g-1]:Z+="SH33TJSERRX"}u.push(Z);break}J||(J={Name:"SH33TJSERRY"}),u.push(J.Name);break;case"PtgParen":var ne="(",he=")";if(y>=0){switch(N="",e[0][y][1][0]){case 2:ne=ar(" ",e[0][y][1][1])+ne;break;case 3:ne=ar("\r",e[0][y][1][1])+ne;break;case 4:he=ar(" ",e[0][y][1][1])+he;break;case 5:he=ar("\r",e[0][y][1][1])+he;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}u.push(ne+u.pop()+he);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:S[1][1],r:S[1][0]};var Q={c:r.c,r:r.r};if(n.sharedf[at(p)]){var xe=n.sharedf[at(p)];u.push(qr(xe,c,Q,n,s))}else{var Y=!1;for(d=0;d!=n.arrayf.length;++d)if(f=n.arrayf[d],!(p.c<f[0].s.c||p.c>f[0].e.c)&&!(p.r<f[0].s.r||p.r>f[0].e.r)){u.push(qr(f[1],c,Q,n,s)),Y=!0;break}Y||u.push(S[1])}break;case"PtgArray":u.push("{"+wO(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var le=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&y>=0&&le.indexOf(e[0][_][0])==-1){S=e[0][y];var X=!0;switch(S[1][0]){case 4:X=!1;case 0:N=ar(" ",S[1][1]);break;case 5:X=!1;case 1:N=ar("\r",S[1][1]);break;default:if(N="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}u.push((X?N:"")+u.pop()+(X?"":N)),y=-1}}if(u.length>1&&s.WTF)throw new Error("bad formula stack");return u[0]}function TO(e,t,r){var n=e.l+t,s=r.biff==2?1:2,l,c=e.read_shift(s);if(c==65535)return[[],Zr(e,t-2)];var u=yu(e,c,r);return t!==c+s&&(l=vu(e,t-c-s,u,r)),e.l=n,[u,l]}function jO(e,t,r){var n=e.l+t,s=r.biff==2?1:2,l,c=e.read_shift(s);if(c==65535)return[[],Zr(e,t-2)];var u=yu(e,c,r);return t!==c+s&&(l=vu(e,t-c-s,u,r)),e.l=n,[u,l]}function _O(e,t,r,n){var s=e.l+t,l=yu(e,n,r),c;return s!==e.l&&(c=vu(e,s-e.l,l,r)),[l,c]}function SO(e,t,r){var n=e.l+t,s,l=e.read_shift(2),c=yu(e,l,r);return l==65535?[[],Zr(e,t-2)]:(t!==l+2&&(s=vu(e,n-l-2,c,r)),[c,s])}function CO(e){var t;if(cs(e,e.l+6)!==65535)return[Yr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function EO(e){if(e==null){var t=ke(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return il(e);return il(0)}function cp(e,t,r){var n=e.l+t,s=za(e);r.biff==2&&++e.l;var l=CO(e),c=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var u=jO(e,n-e.l,r);return{cell:s,val:l[0],formula:u,shared:c>>3&1,tt:l[1]}}function FO(e,t,r,n,s){var l=ol(t,r,s),c=EO(e.v),u=ke(6),d=33;u.write_shift(2,d),u.write_shift(4,0);for(var f=ke(e.bf.length),p=0;p<e.bf.length;++p)f[p]=e.bf[p];var m=Or([l,c,u,f]);return m}function Wh(e,t,r){var n=e.read_shift(4),s=yu(e,n,r),l=e.read_shift(4),c=l>0?vu(e,l,s,r):null;return[s,c]}var AO=Wh,Gh=Wh,DO=Wh,PO=Wh,LO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},tk={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},OO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function y2(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function RO(e){var t="of:="+e.replace(cm,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function up(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function IO(e){return e.replace(/\./,"!")}var Pc={},no={},Lc=typeof Map<"u";function dm(e,t,r){var n=0,s=e.length;if(r){if(Lc?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var l=Lc?r.get(t):r[t];n<l.length;++n)if(e[l[n]].t===t)return e.Count++,l[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(Lc?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function qh(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Xr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Yc(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Th(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Zi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function gi(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,l=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){hs(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=l;++s)if(e[s].numFmtId===n)return s;return e[l]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function rk(e,t,r,n,s,l){try{n.cellNF&&(e.z=nt[t])}catch(u){if(n.WTF)throw u}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Wt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(nt[t]==null&&hs(L5[t]||"General",t),e.t==="e")e.w=e.w||vs[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Kc(e.v);else if(e.t==="d"){var c=jr(e.v);(c|0)===c?e.w=c.toString(10):e.w=Kc(c)}else{if(e.v===void 0)return"";e.w=al(e.v,no)}else e.t==="d"?e.w=na(t,jr(e.v),no):e.w=na(t,e.v,no)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{e.s=l.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=kh(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=kh(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&l.Fills)throw u}}}function MO(e,t,r){if(e&&e["!ref"]){var n=kt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function BO(e,t){var r=kt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=ut(r))}var HO=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,UO=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,VO=/<(?:\w:)?hyperlink [^>]*>/mg,zO=/"(\w*:\w*)"/,KO=/<(?:\w:)?col\b[^>]*[\/]?>/g,$O=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,WO=/<(?:\w:)?pageMargins[^>]*\/>/g,nk=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,GO=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,qO=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function XO(e,t,r,n,s,l,c){if(!e)return e;n||(n={"!id":{}});var u=t.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",p="",m=e.match(UO);m?(f=e.slice(0,m.index),p=e.slice(m.index+m[0].length)):f=p=e;var g=f.match(nk);g?fm(g[0],u,s,r):(g=f.match(GO))&&YO(g[0],g[1]||"",u,s,r);var b=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(b>0){var v=f.slice(b,b+50).match(zO);v&&BO(u,v[1])}var y=f.match(qO);y&&y[1]&&uR(y[1],s);var N=[];if(t.cellStyles){var _=f.match(KO);_&&sR(N,_)}m&&fR(m[1],u,t,d,l,c);var C=p.match($O);C&&(u["!autofilter"]=lR(C[0]));var S=[],E=p.match(HO);if(E)for(b=0;b!=E.length;++b)S[b]=kt(E[b].slice(E[b].indexOf('"')+1));var O=p.match(VO);O&&rR(u,O,n);var F=p.match(WO);if(F&&(u["!margins"]=nR(st(F[0]))),!u["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(u["!ref"]=ut(d)),t.sheetRows>0&&u["!ref"]){var T=kt(u["!ref"]);t.sheetRows<=+T.e.r&&(T.e.r=t.sheetRows-1,T.e.r>d.e.r&&(T.e.r=d.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>d.e.c&&(T.e.c=d.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),u["!fullref"]=u["!ref"],u["!ref"]=ut(T))}return N.length>0&&(u["!cols"]=N),S.length>0&&(u["!merges"]=S),u}function QO(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+ut(e[r])+'"/>';return t+"</mergeCells>"}function fm(e,t,r,n){var s=st(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Nt(Ot(s.codeName)))}function YO(e,t,r,n,s){fm(e.slice(0,e.indexOf(">")),r,n,s)}function JO(e,t,r,n,s){var l=!1,c={},u=null;if(n.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[r];try{t.Workbook&&(d=t.Workbook.Sheets[r].CodeName||d)}catch{}l=!0,c.codeName=Ma(Dt(d))}if(e&&e["!outline"]){var f={summaryBelow:1,summaryRight:1};e["!outline"].above&&(f.summaryBelow=0),e["!outline"].left&&(f.summaryRight=0),u=(u||"")+Ie("outlinePr",null,f)}!l&&!u||(s[s.length]=Ie("sheetPr",u,c))}var ZO=["objects","scenarios","selectLockedCells","selectUnlockedCells"],eR=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function tR(e){var t={sheet:1};return ZO.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),eR.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=im(e.password).toString(16).toUpperCase()),Ie("sheetProtection",null,t)}function rR(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var l=st(Ot(t[s]),!0);if(!l.ref)return;var c=((r||{})["!id"]||[])[l.id];c?(l.Target=c.Target,l.location&&(l.Target+="#"+Nt(l.location))):(l.Target="#"+Nt(l.location),c={Target:l.Target,TargetMode:"Internal"}),l.Rel=c,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var u=kt(l.ref),d=u.s.r;d<=u.e.r;++d)for(var f=u.s.c;f<=u.e.c;++f){var p=at({c:f,r:d});n?(e[d]||(e[d]=[]),e[d][f]||(e[d][f]={t:"z",v:void 0}),e[d][f].l=l):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=l)}}}function nR(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function aR(e){return Zi(e),Ie("pageMargins",null,e)}function sR(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=st(t[n],!0);s.hidden&&(s.hidden=$t(s.hidden));var l=parseInt(s.min,10)-1,c=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,lm(s.width)),ci(s);l<=c;)e[l++]=Gt(s)}}function iR(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=Ie("col",null,qh(s,n)));return r[r.length]="</cols>",r.join("")}function lR(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function oR(e,t,r,n){var s=typeof e.ref=="string"?e.ref:ut(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,c=_n(s);c.s.r==c.e.r&&(c.e.r=_n(t["!ref"]).e.r,s=ut(c));for(var u=0;u<l.length;++u){var d=l[u];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return u==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Ie("autoFilter",null,{ref:s})}var cR=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function uR(e,t){t.Views||(t.Views=[{}]),(e.match(cR)||[]).forEach(function(r,n){var s=st(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),$t(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function hR(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ie("sheetViews",Ie("sheetView",null,s),{})}function dR(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",l=e.t,c=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=vs[e.v];break;case"d":n&&n.cellDates?s=Wt(e.v,-1).toISOString():(e=Gt(e),e.t="n",s=""+(e.v=jr(Wt(e.v)))),typeof e.z>"u"&&(e.z=nt[14]);break;default:s=e.v;break}var u=Ur("v",Dt(s)),d={r:t},f=gi(n.cellXfs,e,n);switch(f!==0&&(d.s=f),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=Ur("v",""+dm(n.Strings,e.v,n.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=l&&(e.t=l,e.v=c),typeof e.f=="string"&&e.f){var p=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=Ie("f",Dt(e.f),p)+(e.v!=null?u:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(d.cm=1),Ie("c",u,d)}var fR=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,l=$c("v"),c=$c("f");return function(d,f,p,m,g,b){for(var v=0,y="",N=[],_=[],C=0,S=0,E=0,O="",F,T,D=0,I=0,J,Z,ee=0,ne=0,he=Array.isArray(b.CellXf),Q,xe=[],Y=[],le=Array.isArray(f),X=[],ve={},K=!1,k=!!p.sheetStubs,B=d.split(t),A=0,M=B.length;A!=M;++A){y=B[A].trim();var ae=y.length;if(ae!==0){var de=0;e:for(v=0;v<ae;++v)switch(y[v]){case">":if(y[v-1]!="/"){++v;break e}if(p&&p.cellStyles){if(T=st(y.slice(de,v),!0),D=T.r!=null?parseInt(T.r,10):D+1,I=-1,p.sheetRows&&p.sheetRows<D)continue;ve={},K=!1,T.ht&&(K=!0,ve.hpt=parseFloat(T.ht),ve.hpx=To(ve.hpt)),T.hidden=="1"&&(K=!0,ve.hidden=!0),T.outlineLevel!=null&&(K=!0,ve.level=+T.outlineLevel),K&&(X[D-1]=ve)}break;case"<":de=v;break}if(de>=v)break;if(T=st(y.slice(de,v),!0),D=T.r!=null?parseInt(T.r,10):D+1,I=-1,!(p.sheetRows&&p.sheetRows<D)){m.s.r>D-1&&(m.s.r=D-1),m.e.r<D-1&&(m.e.r=D-1),p&&p.cellStyles&&(ve={},K=!1,T.ht&&(K=!0,ve.hpt=parseFloat(T.ht),ve.hpx=To(ve.hpt)),T.hidden=="1"&&(K=!0,ve.hidden=!0),T.outlineLevel!=null&&(K=!0,ve.level=+T.outlineLevel),K&&(X[D-1]=ve)),N=y.slice(v).split(e);for(var be=0;be!=N.length&&N[be].trim().charAt(0)=="<";++be);for(N=N.slice(be),v=0;v!=N.length;++v)if(y=N[v].trim(),y.length!==0){if(_=y.match(r),C=v,S=0,E=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,_!=null&&_.length===2){for(C=0,O=_[1],S=0;S!=O.length&&!((E=O.charCodeAt(S)-64)<1||E>26);++S)C=26*C+E;--C,I=C}else++I;for(S=0;S!=y.length&&y.charCodeAt(S)!==62;++S);if(++S,T=st(y.slice(0,S),!0),T.r||(T.r=at({r:D-1,c:I})),O=y.slice(S),F={t:""},(_=O.match(l))!=null&&_[1]!==""&&(F.v=Nt(_[1])),p.cellFormula){if((_=O.match(c))!=null&&_[1]!==""){if(F.f=Nt(Ot(_[1])).replace(/\r\n/g,`
`),p.xlfn||(F.f=x2(F.f)),_[0].indexOf('t="array"')>-1)F.F=(O.match(s)||[])[1],F.F.indexOf(":")>-1&&xe.push([kt(F.F),F.F]);else if(_[0].indexOf('t="shared"')>-1){Z=st(_[0]);var we=Nt(Ot(_[1]));p.xlfn||(we=x2(we)),Y[parseInt(Z.si,10)]=[Z,we,T.r]}}else(_=O.match(/<f[^>]*\/>/))&&(Z=st(_[0]),Y[Z.si]&&(F.f=cL(Y[Z.si][1],Y[Z.si][2],T.r)));var ye=tr(T.r);for(S=0;S<xe.length;++S)ye.r>=xe[S][0].s.r&&ye.r<=xe[S][0].e.r&&ye.c>=xe[S][0].s.c&&ye.c<=xe[S][0].e.c&&(F.F=xe[S][1])}if(T.t==null&&F.v===void 0)if(F.f||F.F)F.v=0,F.t="n";else if(k)F.t="z";else continue;else F.t=T.t||"n";switch(m.s.c>I&&(m.s.c=I),m.e.c<I&&(m.e.c=I),F.t){case"n":if(F.v==""||F.v==null){if(!k)continue;F.t="z"}else F.v=parseFloat(F.v);break;case"s":if(typeof F.v>"u"){if(!k)continue;F.t="z"}else J=Pc[parseInt(F.v,10)],F.v=J.t,F.r=J.r,p.cellHTML&&(F.h=J.h);break;case"str":F.t="s",F.v=F.v!=null?Ot(F.v):"",p.cellHTML&&(F.h=$x(F.v));break;case"inlineStr":_=O.match(n),F.t="s",_!=null&&(J=sm(_[1]))?(F.v=J.t,p.cellHTML&&(F.h=J.h)):F.v="";break;case"b":F.v=$t(F.v);break;case"d":p.cellDates?F.v=Wt(F.v,1):(F.v=jr(Wt(F.v,1)),F.t="n");break;case"e":(!p||p.cellText!==!1)&&(F.w=F.v),F.v=sN[F.v];break}if(ee=ne=0,Q=null,he&&T.s!==void 0&&(Q=b.CellXf[T.s],Q!=null&&(Q.numFmtId!=null&&(ee=Q.numFmtId),p.cellStyles&&Q.fillId!=null&&(ne=Q.fillId))),rk(F,ee,ne,p,g,b),p.cellDates&&he&&F.t=="n"&&Fo(nt[ee])&&(F.t="d",F.v=Kh(F.v)),T.cm&&p.xlmeta){var Je=(p.xlmeta.Cell||[])[+T.cm-1];Je&&Je.type=="XLDAPR"&&(F.D=!0)}if(le){var G=tr(T.r);f[G.r]||(f[G.r]=[]),f[G.r][G.c]=F}else f[T.r]=F}}}}X.length>0&&(f["!rows"]=X)}})();function pR(e,t,r,n){var s=[],l=[],c=kt(e["!ref"]),u="",d,f="",p=[],m=0,g=0,b=e["!rows"],v=Array.isArray(e),y={r:f},N,_=-1;for(g=c.s.c;g<=c.e.c;++g)p[g]=er(g);for(m=c.s.r;m<=c.e.r;++m){for(l=[],f=pr(m),g=c.s.c;g<=c.e.c;++g){d=p[g]+f;var C=v?(e[m]||[])[g]:e[d];C!==void 0&&(u=dR(C,d,e,t))!=null&&l.push(u)}(l.length>0||b&&b[m])&&(y={r:f},b&&b[m]&&(N=b[m],N.hidden&&(y.hidden=1),_=-1,N.hpx?_=Jc(N.hpx):N.hpt&&(_=N.hpt),_>-1&&(y.ht=_,y.customHeight=1),N.level&&(y.outlineLevel=N.level)),s[s.length]=Ie("row",l.join(""),y))}if(b)for(;m<b.length;++m)b&&b[m]&&(y={r:m+1},N=b[m],N.hidden&&(y.hidden=1),_=-1,N.hpx?_=Jc(N.hpx):N.hpt&&(_=N.hpt),_>-1&&(y.ht=_,y.customHeight=1),N.level&&(y.outlineLevel=N.level),s[s.length]=Ie("row","",y));return s.join("")}function ak(e,t,r,n){var s=[xr,Ie("worksheet",null,{xmlns:dl[0],"xmlns:r":Tr.r})],l=r.SheetNames[e],c=0,u="",d=r.Sheets[l];d==null&&(d={});var f=d["!ref"]||"A1",p=kt(f);if(p.e.c>16383||p.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),f=ut(p)}n||(n={}),d["!comments"]=[];var m=[];JO(d,r,e,t,s),s[s.length]=Ie("dimension",null,{ref:f}),s[s.length]=hR(d,t,e,r),t.sheetFormat&&(s[s.length]=Ie("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(s[s.length]=iR(d,d["!cols"])),s[c=s.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(u=pR(d,t),u.length>0&&(s[s.length]=u)),s.length>c+1&&(s[s.length]="</sheetData>",s[c]=s[c].replace("/>",">")),d["!protect"]&&(s[s.length]=tR(d["!protect"])),d["!autofilter"]!=null&&(s[s.length]=oR(d["!autofilter"],d,r,e)),d["!merges"]!=null&&d["!merges"].length>0&&(s[s.length]=QO(d["!merges"]));var g=-1,b,v=-1;return d["!links"].length>0&&(s[s.length]="<hyperlinks>",d["!links"].forEach(function(y){y[1].Target&&(b={ref:y[0]},y[1].Target.charAt(0)!="#"&&(v=At(n,-1,Dt(y[1].Target).replace(/#.*$/,""),gt.HLINK),b["r:id"]="rId"+v),(g=y[1].Target.indexOf("#"))>-1&&(b.location=Dt(y[1].Target.slice(g+1))),y[1].Tooltip&&(b.tooltip=Dt(y[1].Tooltip)),s[s.length]=Ie("hyperlink",null,b))}),s[s.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(s[s.length]=aR(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Ur("ignoredErrors",Ie("ignoredError",null,{numberStoredAsText:1,sqref:f}))),m.length>0&&(v=At(n,-1,"../drawings/drawing"+(e+1)+".xml",gt.DRAW),s[s.length]=Ie("drawing",null,{"r:id":"rId"+v}),d["!drawing"]=m),d["!comments"].length>0&&(v=At(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",gt.VML),s[s.length]=Ie("legacyDrawing",null,{"r:id":"rId"+v}),d["!legacy"]=v),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function xR(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=n,l&7&&(r.level=l&7),l&16&&(r.hidden=!0),l&32&&(r.hpt=s/20),r}function mR(e,t,r){var n=ke(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var l=320;s.hpx?l=Jc(s.hpx)*20:s.hpt&&(l=s.hpt*20),n.write_shift(2,l),n.write_shift(1,0);var c=0;s.level&&(c|=s.level),s.hidden&&(c|=16),(s.hpx||s.hpt)&&(c|=32),n.write_shift(1,c),n.write_shift(1,0);var u=0,d=n.l;n.l+=4;for(var f={r:e,c:0},p=0;p<16;++p)if(!(t.s.c>p+1<<10||t.e.c<p<<10)){for(var m=-1,g=-1,b=p<<10;b<p+1<<10;++b){f.c=b;var v=Array.isArray(r)?(r[f.r]||[])[f.c]:r[at(f)];v&&(m<0&&(m=b),g=b)}m<0||(++u,n.write_shift(4,m),n.write_shift(4,g))}var y=n.l;return n.l=d,n.write_shift(4,u),n.l=y,n.length>n.l?n.slice(0,n.l):n}function gR(e,t,r,n){var s=mR(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&_e(e,0,s)}var vR=ml,yR=Po;function bR(){}function wR(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=TF(e),r}function NR(e,t,r){r==null&&(r=ke(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return bh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),eN(e,r),r.slice(0,r.l)}function kR(e){var t=aa(e);return[t]}function TR(e,t,r){return r==null&&(r=ke(8)),fl(t,r)}function jR(e){var t=pl(e);return[t]}function _R(e,t,r){return r==null&&(r=ke(4)),xl(t,r)}function SR(e){var t=aa(e),r=e.read_shift(1);return[t,r,"b"]}function CR(e,t,r){return r==null&&(r=ke(9)),fl(t,r),r.write_shift(1,e.v?1:0),r}function ER(e){var t=pl(e),r=e.read_shift(1);return[t,r,"b"]}function FR(e,t,r){return r==null&&(r=ke(5)),xl(t,r),r.write_shift(1,e.v?1:0),r}function AR(e){var t=aa(e),r=e.read_shift(1);return[t,r,"e"]}function DR(e,t,r){return r==null&&(r=ke(9)),fl(t,r),r.write_shift(1,e.v),r}function PR(e){var t=pl(e),r=e.read_shift(1);return[t,r,"e"]}function LR(e,t,r){return r==null&&(r=ke(8)),xl(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function OR(e){var t=aa(e),r=e.read_shift(4);return[t,r,"s"]}function RR(e,t,r){return r==null&&(r=ke(12)),fl(t,r),r.write_shift(4,t.v),r}function IR(e){var t=pl(e),r=e.read_shift(4);return[t,r,"s"]}function MR(e,t,r){return r==null&&(r=ke(8)),xl(t,r),r.write_shift(4,t.v),r}function BR(e){var t=aa(e),r=Yr(e);return[t,r,"n"]}function HR(e,t,r){return r==null&&(r=ke(16)),fl(t,r),il(e.v,r),r}function sk(e){var t=pl(e),r=Yr(e);return[t,r,"n"]}function UR(e,t,r){return r==null&&(r=ke(12)),xl(t,r),il(e.v,r),r}function VR(e){var t=aa(e),r=em(e);return[t,r,"n"]}function zR(e,t,r){return r==null&&(r=ke(12)),fl(t,r),tN(e.v,r),r}function KR(e){var t=pl(e),r=em(e);return[t,r,"n"]}function $R(e,t,r){return r==null&&(r=ke(8)),xl(t,r),tN(e.v,r),r}function WR(e){var t=aa(e),r=Yx(e);return[t,r,"is"]}function GR(e){var t=aa(e),r=Jr(e);return[t,r,"str"]}function qR(e,t,r){return r==null&&(r=ke(12+4*e.v.length)),fl(t,r),Rr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function XR(e){var t=pl(e),r=Jr(e);return[t,r,"str"]}function QR(e,t,r){return r==null&&(r=ke(8+4*e.v.length)),xl(t,r),Rr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function YR(e,t,r){var n=e.l+t,s=aa(e);s.r=r["!row"];var l=e.read_shift(1),c=[s,l,"b"];if(r.cellFormula){e.l+=2;var u=Gh(e,n-e.l,r);c[3]=qr(u,null,s,r.supbooks,r)}else e.l=n;return c}function JR(e,t,r){var n=e.l+t,s=aa(e);s.r=r["!row"];var l=e.read_shift(1),c=[s,l,"e"];if(r.cellFormula){e.l+=2;var u=Gh(e,n-e.l,r);c[3]=qr(u,null,s,r.supbooks,r)}else e.l=n;return c}function ZR(e,t,r){var n=e.l+t,s=aa(e);s.r=r["!row"];var l=Yr(e),c=[s,l,"n"];if(r.cellFormula){e.l+=2;var u=Gh(e,n-e.l,r);c[3]=qr(u,null,s,r.supbooks,r)}else e.l=n;return c}function eI(e,t,r){var n=e.l+t,s=aa(e);s.r=r["!row"];var l=Jr(e),c=[s,l,"str"];if(r.cellFormula){e.l+=2;var u=Gh(e,n-e.l,r);c[3]=qr(u,null,s,r.supbooks,r)}else e.l=n;return c}var tI=ml,rI=Po;function nI(e,t){return t==null&&(t=ke(4)),t.write_shift(4,e),t}function aI(e,t){var r=e.l+t,n=ml(e),s=Jx(e),l=Jr(e),c=Jr(e),u=Jr(e);e.l=r;var d={rfx:n,relId:s,loc:l,display:u};return c&&(d.Tooltip=c),d}function sI(e,t){var r=ke(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Po({s:tr(e[0]),e:tr(e[0])},r),Zx("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Rr(s||"",r),Rr(e[1].Tooltip||"",r),Rr("",r),r.slice(0,r.l)}function iI(){}function lI(e,t,r){var n=e.l+t,s=rN(e),l=e.read_shift(1),c=[s];if(c[2]=l,r.cellFormula){var u=AO(e,n-e.l,r);c[1]=u}else e.l=n;return c}function oI(e,t,r){var n=e.l+t,s=ml(e),l=[s];if(r.cellFormula){var c=PO(e,n-e.l,r);l[1]=c,e.l=n}else e.l=n;return l}function cI(e,t,r){r==null&&(r=ke(18));var n=qh(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var ik=["left","right","top","bottom","header","footer"];function uI(e){var t={};return ik.forEach(function(r){t[r]=Yr(e)}),t}function hI(e,t){return t==null&&(t=ke(48)),Zi(e),ik.forEach(function(r){il(e[r],t)}),t}function dI(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function fI(e,t,r){r==null&&(r=ke(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function pI(e){var t=ke(24);return t.write_shift(4,4),t.write_shift(4,1),Po(e,t),t}function xI(e,t){return t==null&&(t=ke(66)),t.write_shift(2,e.password?im(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function mI(){}function gI(){}function vI(e,t,r,n,s,l,c){if(!e)return e;var u=t||{};n||(n={"!id":{}});var d=u.dense?[]:{},f,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,g=!1,b,v,y,N,_,C,S,E,O,F=[];u.biff=12,u["!row"]=0;var T=0,D=!1,I=[],J={},Z=u.supbooks||s.supbooks||[[]];if(Z.sharedf=J,Z.arrayf=I,Z.SheetNames=s.SheetNames||s.Sheets.map(function(le){return le.name}),!u.supbooks&&(u.supbooks=Z,s.Names))for(var ee=0;ee<s.Names.length;++ee)Z[0][ee+1]=s.Names[ee];var ne=[],he=[],Q=!1;Zc[16]={n:"BrtShortReal",f:sk};var xe;if(gs(e,function(X,ve,K){if(!g)switch(K){case 148:f=X;break;case 0:b=X,u.sheetRows&&u.sheetRows<=b.r&&(g=!0),E=pr(N=b.r),u["!row"]=b.r,(X.hidden||X.hpt||X.level!=null)&&(X.hpt&&(X.hpx=To(X.hpt)),he[X.r]=X);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:X[2]},X[2]){case"n":v.v=X[1];break;case"s":S=Pc[X[1]],v.v=S.t,v.r=S.r;break;case"b":v.v=!!X[1];break;case"e":v.v=X[1],u.cellText!==!1&&(v.w=vs[v.v]);break;case"str":v.t="s",v.v=X[1];break;case"is":v.t="s",v.v=X[1].t;break}if((y=c.CellXf[X[0].iStyleRef])&&rk(v,y.numFmtId,null,u,l,c),_=X[0].c==-1?_+1:X[0].c,u.dense?(d[N]||(d[N]=[]),d[N][_]=v):d[er(_)+E]=v,u.cellFormula){for(D=!1,T=0;T<I.length;++T){var k=I[T];b.r>=k[0].s.r&&b.r<=k[0].e.r&&_>=k[0].s.c&&_<=k[0].e.c&&(v.F=ut(k[0]),D=!0)}!D&&X.length>3&&(v.f=X[3])}if(p.s.r>b.r&&(p.s.r=b.r),p.s.c>_&&(p.s.c=_),p.e.r<b.r&&(p.e.r=b.r),p.e.c<_&&(p.e.c=_),u.cellDates&&y&&v.t=="n"&&Fo(nt[y.numFmtId])){var B=Bi(v.v);B&&(v.t="d",v.v=new Date(B.y,B.m-1,B.d,B.H,B.M,B.S,B.u))}xe&&(xe.type=="XLDAPR"&&(v.D=!0),xe=void 0);break;case 1:case 12:if(!u.sheetStubs||m)break;v={t:"z",v:void 0},_=X[0].c==-1?_+1:X[0].c,u.dense?(d[N]||(d[N]=[]),d[N][_]=v):d[er(_)+E]=v,p.s.r>b.r&&(p.s.r=b.r),p.s.c>_&&(p.s.c=_),p.e.r<b.r&&(p.e.r=b.r),p.e.c<_&&(p.e.c=_),xe&&(xe.type=="XLDAPR"&&(v.D=!0),xe=void 0);break;case 176:F.push(X);break;case 49:xe=((u.xlmeta||{}).Cell||[])[X-1];break;case 494:var A=n["!id"][X.relId];for(A?(X.Target=A.Target,X.loc&&(X.Target+="#"+X.loc),X.Rel=A):X.relId==""&&(X.Target="#"+X.loc),N=X.rfx.s.r;N<=X.rfx.e.r;++N)for(_=X.rfx.s.c;_<=X.rfx.e.c;++_)u.dense?(d[N]||(d[N]=[]),d[N][_]||(d[N][_]={t:"z",v:void 0}),d[N][_].l=X):(C=at({c:_,r:N}),d[C]||(d[C]={t:"z",v:void 0}),d[C].l=X);break;case 426:if(!u.cellFormula)break;I.push(X),O=u.dense?d[N][_]:d[er(_)+E],O.f=qr(X[1],p,{r:b.r,c:_},Z,u),O.F=ut(X[0]);break;case 427:if(!u.cellFormula)break;J[at(X[0].s)]=X[1],O=u.dense?d[N][_]:d[er(_)+E],O.f=qr(X[1],p,{r:b.r,c:_},Z,u);break;case 60:if(!u.cellStyles)break;for(;X.e>=X.s;)ne[X.e--]={width:X.w/256,hidden:!!(X.flags&1),level:X.level},Q||(Q=!0,lm(X.w/256)),ci(ne[X.e+1]);break;case 161:d["!autofilter"]={ref:ut(X)};break;case 476:d["!margins"]=X;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),X.name&&(s.Sheets[r].CodeName=X.name),(X.above||X.left)&&(d["!outline"]={above:X.above,left:X.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),X.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!ve.T){if(!m||u.WTF)throw new Error("Unexpected record 0x"+K.toString(16))}}},u),delete u.supbooks,delete u["!row"],!d["!ref"]&&(p.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(d["!ref"]=ut(f||p)),u.sheetRows&&d["!ref"]){var Y=kt(d["!ref"]);u.sheetRows<=+Y.e.r&&(Y.e.r=u.sheetRows-1,Y.e.r>p.e.r&&(Y.e.r=p.e.r),Y.e.r<Y.s.r&&(Y.s.r=Y.e.r),Y.e.c>p.e.c&&(Y.e.c=p.e.c),Y.e.c<Y.s.c&&(Y.s.c=Y.e.c),d["!fullref"]=d["!ref"],d["!ref"]=ut(Y))}return F.length>0&&(d["!merges"]=F),ne.length>0&&(d["!cols"]=ne),he.length>0&&(d["!rows"]=he),d}function yI(e,t,r,n,s,l,c){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=Gt(t),t.z=t.z||nt[14],t.v=jr(Wt(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var d={r,c:n};switch(d.s=gi(s.cellXfs,t,s),t.l&&l["!links"].push([at(d),t.l]),t.c&&l["!comments"].push([at(d),t.c]),t.t){case"s":case"str":return s.bookSST?(u=dm(s.Strings,t.v,s.revStrings),d.t="s",d.v=u,c?_e(e,18,MR(t,d)):_e(e,7,RR(t,d))):(d.t="str",c?_e(e,17,QR(t,d)):_e(e,6,qR(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?c?_e(e,13,$R(t,d)):_e(e,2,zR(t,d)):c?_e(e,16,UR(t,d)):_e(e,5,HR(t,d)),!0;case"b":return d.t="b",c?_e(e,15,FR(t,d)):_e(e,4,CR(t,d)),!0;case"e":return d.t="e",c?_e(e,14,LR(t,d)):_e(e,3,DR(t,d)),!0}return c?_e(e,12,_R(t,d)):_e(e,1,TR(t,d)),!0}function bI(e,t,r,n){var s=kt(t["!ref"]||"A1"),l,c="",u=[];_e(e,145);var d=Array.isArray(t),f=s.e.r;t["!rows"]&&(f=Math.max(s.e.r,t["!rows"].length-1));for(var p=s.s.r;p<=f;++p){c=pr(p),gR(e,t,s,p);var m=!1;if(p<=s.e.r)for(var g=s.s.c;g<=s.e.c;++g){p===s.s.r&&(u[g]=er(g)),l=u[g]+c;var b=d?(t[p]||[])[g]:t[l];if(!b){m=!1;continue}m=yI(e,b,p,g,n,t,m)}}_e(e,146)}function wI(e,t){!t||!t["!merges"]||(_e(e,177,nI(t["!merges"].length)),t["!merges"].forEach(function(r){_e(e,176,rI(r))}),_e(e,178))}function NI(e,t){!t||!t["!cols"]||(_e(e,390),t["!cols"].forEach(function(r,n){r&&_e(e,60,cI(n,r))}),_e(e,391))}function kI(e,t){!t||!t["!ref"]||(_e(e,648),_e(e,649,pI(kt(t["!ref"]))),_e(e,650))}function TI(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=At(r,-1,n[1].Target.replace(/#.*$/,""),gt.HLINK);_e(e,494,sI(n,s))}}),delete t["!links"]}function jI(e,t,r,n){if(t["!comments"].length>0){var s=At(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",gt.VML);_e(e,551,Zx("rId"+s)),t["!legacy"]=s}}function _I(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],l=typeof s.ref=="string"?s.ref:ut(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var c=r.Workbook.Names,u=_n(l);u.s.r==u.e.r&&(u.e.r=_n(t["!ref"]).e.r,l=ut(u));for(var d=0;d<c.length;++d){var f=c[d];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+l;break}}d==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+l}),_e(e,161,Po(kt(l))),_e(e,162)}}function SI(e,t,r){_e(e,133),_e(e,137,fI(t,r)),_e(e,138),_e(e,134)}function CI(e,t){t["!protect"]&&_e(e,535,xI(t["!protect"]))}function EI(e,t,r,n){var s=jn(),l=r.SheetNames[e],c=r.Sheets[l]||{},u=l;try{r&&r.Workbook&&(u=r.Workbook.Sheets[e].CodeName||u)}catch{}var d=kt(c["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return c["!links"]=[],c["!comments"]=[],_e(s,129),(r.vbaraw||c["!outline"])&&_e(s,147,NR(u,c["!outline"])),_e(s,148,yR(d)),SI(s,c,r.Workbook),NI(s,c),bI(s,c,e,t),CI(s,c),_I(s,c,r,e),wI(s,c),TI(s,c,n),c["!margins"]&&_e(s,476,hI(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&kI(s,c),jI(s,c,e,n),_e(s,130),s.end()}function FI(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var c=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(t[+c[1]]=r?+c[2]:c[2])});var s=Nt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){n=l.replace(/<.*?>/g,"")}),[t,s,n]}function AI(e,t,r,n,s,l){var c=l||{"!type":"chart"};if(!e)return l;var u=0,d=0,f="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var g=FI(m);p.s.r=p.s.c=0,p.e.c=u,f=er(u),g[0].forEach(function(b,v){c[f+pr(v)]={t:"n",v:b,z:g[1]},d=v}),p.e.r<d&&(p.e.r=d),++u}),u>0&&(c["!ref"]=ut(p)),c}function DI(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c,u=e.match(nk);return u&&fm(u[0],l,s,r),(c=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=c[1]),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}function PI(e,t){e.l+=10;var r=Jr(e);return{name:r}}function LI(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c=!1;return gs(e,function(d,f,p){switch(p){case 550:l["!rel"]=d;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),d.name&&(s.Sheets[r].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!c||t.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},t),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}var pm=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],OI=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],RI=[],II=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function b2(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var l=t[s];if(n[l[0]]==null)n[l[0]]=l[1];else switch(l[2]){case"bool":typeof n[l[0]]=="string"&&(n[l[0]]=$t(n[l[0]]));break;case"int":typeof n[l[0]]=="string"&&(n[l[0]]=parseInt(n[l[0]],10));break}}}function w2(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=$t(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function lk(e){w2(e.WBProps,pm),w2(e.CalcPr,II),b2(e.WBView,OI),b2(e.Sheets,RI),no.date1904=$t(e.WBProps.date1904)}function MI(e){return!e.Workbook||!e.Workbook.WBProps?"false":$t(e.Workbook.WBProps.date1904)?"true":"false"}var BI="][*?/\\".split("");function ok(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return BI.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function HI(e,t,r){e.forEach(function(n,s){ok(n);for(var l=0;l<s;++l)if(n==e[l])throw new Error("Duplicate Sheet Name: "+n);if(r){var c=t&&t[s]&&t[s].CodeName||n;if(c.charCodeAt(0)==95&&c.length>22)throw new Error("Bad Code Name: Worksheet"+c)}})}function UI(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];HI(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)MO(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var VI=/<\w+:workbook/;function zI(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",l={},c=0;if(e.replace(en,function(d,f){var p=st(d);switch(Va(p[0])){case"<?xml":break;case"<workbook":d.match(VI)&&(s="xmlns"+d.match(/<(\w+):/)[1]),r.xmlns=p[s];break;case"</workbook>":break;case"<fileVersion":delete p[0],r.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":pm.forEach(function(m){if(p[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=$t(p[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(p[m[0]],10);break;default:r.WBProps[m[0]]=p[m[0]]}}),p.codeName&&(r.WBProps.CodeName=Ot(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],r.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=Nt(Ot(p.name)),delete p[0],r.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":l={},l.Name=Ot(p.name),p.comment&&(l.Comment=p.comment),p.localSheetId&&(l.Sheet=+p.localSheetId),$t(p.hidden||"0")&&(l.Hidden=!0),c=f+d.length;break;case"</definedName>":l.Ref=Nt(Ot(e.slice(c,f))),r.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete p[0],r.CalcPr=p;break;case"<calcPr/>":delete p[0],r.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return d}),dl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return lk(r),r}function ck(e){var t=[xr];t[t.length]=Ie("workbook",null,{xmlns:dl[0],"xmlns:r":Tr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(pm.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ie("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],l=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",l=0;l!=e.SheetNames.length&&!(!s[l]||!s[l].Hidden);++l);l==e.SheetNames.length&&(l=0),t[t.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",l=0;l!=e.SheetNames.length;++l){var c={name:Dt(e.SheetNames[l].slice(0,31))};if(c.sheetId=""+(l+1),c["r:id"]="rId"+(l+1),s[l])switch(s[l].Hidden){case 1:c.state="hidden";break;case 2:c.state="veryHidden";break}t[t.length]=Ie("sheet",null,c)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var d={name:u.Name};u.Comment&&(d.comment=u.Comment),u.Sheet!=null&&(d.localSheetId=""+u.Sheet),u.Hidden&&(d.hidden="1"),u.Ref&&(t[t.length]=Ie("definedName",Dt(u.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function KI(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Xp(e),r.name=Jr(e),r}function $I(e,t){return t||(t=ke(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Zx(e.strRelID,t),Rr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function WI(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Jr(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function GI(e,t){t||(t=ke(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),eN(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function qI(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function XI(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),l=jF(e),c=DO(e,0,r),u=Jx(e);e.l=n;var d={Name:l,Ptg:c};return s<268435455&&(d.Sheet=s),u&&(d.Comment=u),d}function QI(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var l=[],c=[[]];return c.SheetNames=[],c.XTI=[],Zc[16]={n:"BrtFRTArchID$",f:qI},gs(e,function(d,f,p){switch(p){case 156:c.SheetNames.push(d.name),r.Sheets.push(d);break;case 153:r.WBProps=d;break;case 39:d.Sheet!=null&&(t.SID=d.Sheet),d.Ref=qr(d.Ptg,null,null,c,t),delete t.SID,delete d.Ptg,l.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([p,d]):c[0]=[p,d],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(d),c.XTI=c.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(p),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!f.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},t),lk(r),r.Names=l,r.supbooks=c,r}function YI(e,t){_e(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};_e(e,156,$I(s))}_e(e,144)}function JI(e,t){t||(t=ke(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Rr("SheetJS",t),Rr(fh.version,t),Rr(fh.version,t),Rr("7262",t),t.length>t.l?t.slice(0,t.l):t}function ZI(e,t){t||(t=ke(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function e7(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,l=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&l==-1&&(l=n);l>s||(_e(e,135),_e(e,158,ZI(s)),_e(e,136))}}function t7(e,t){var r=jn();return _e(r,131),_e(r,128,JI()),_e(r,153,GI(e.Workbook&&e.Workbook.WBProps||null)),e7(r,e),YI(r,e),_e(r,132),r.end()}function r7(e,t,r){return t.slice(-4)===".bin"?QI(e,r):zI(e,r)}function n7(e,t,r,n,s,l,c,u){return t.slice(-4)===".bin"?vI(e,n,r,s,l,c,u):XO(e,n,r,s,l,c,u)}function a7(e,t,r,n,s,l,c,u){return t.slice(-4)===".bin"?LI(e,n,r,s,l):DI(e,n,r,s,l)}function s7(e,t,r,n,s,l,c,u){return t.slice(-4)===".bin"?lL():oL()}function i7(e,t,r,n,s,l,c,u){return t.slice(-4)===".bin"?sL():iL()}function l7(e,t,r,n){return t.slice(-4)===".bin"?rP(e,r,n):KD(e,r,n)}function o7(e,t,r){return zN(e,r)}function c7(e,t,r){return t.slice(-4)===".bin"?cD(e,r):iD(e,r)}function u7(e,t,r){return t.slice(-4)===".bin"?eL(e,r):$P(e,r)}function h7(e,t,r){return t.slice(-4)===".bin"?VP(e):HP(e)}function d7(e,t,r,n){return r.slice(-4)===".bin"?zP(e,t,r,n):void 0}function f7(e,t,r){return t.slice(-4)===".bin"?IP(e,t,r):BP(e,t,r)}function p7(e,t,r){return(t.slice(-4)===".bin"?t7:ck)(e)}function x7(e,t,r,n,s){return(t.slice(-4)===".bin"?EI:ak)(e,r,n,s)}function m7(e,t,r){return(t.slice(-4)===".bin"?dP:UN)(e,r)}function g7(e,t,r){return(t.slice(-4)===".bin"?dD:PN)(e,r)}function v7(e,t,r){return(t.slice(-4)===".bin"?tL:WN)(e)}function y7(e){return(e.slice(-4)===".bin"?MP:KN)()}var uk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,hk=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function da(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(uk),l,c,u,d;if(s)for(d=0;d!=s.length;++d)l=s[d].match(hk),(c=l[1].indexOf(":"))===-1?n[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?u="xmlns"+l[1].slice(6):u=l[1].slice(c+1),n[u]=l[2].slice(1,l[2].length-1));return n}function b7(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(uk),s,l,c,u;if(n)for(u=0;u!=n.length;++u)s=n[u].match(hk),(l=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(l+1),r[c]=s[2].slice(1,s[2].length-1));return r}var Oc;function w7(e,t){var r=Oc[e]||Nt(e);return r==="General"?al(t):na(r,t)}function N7(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=$t(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Wt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Nt(t)]=s}function k7(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||vs[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Kc(e.v):e.w=al(e.v):e.w=w7(t||"General",e.v)}catch(l){if(r.WTF)throw l}try{var n=Oc[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Fo(n)){var s=Bi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(l){if(r.WTF)throw l}}}function T7(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=RD[n.Pattern]||n.Pattern)}e[t.ID]=t}function j7(e,t,r,n,s,l,c,u,d,f){var p="General",m=n.StyleID,g={};f=f||{};var b=[],v=0;for(m===void 0&&u&&(m=u.StyleID),m===void 0&&c&&(m=c.StyleID);l[m]!==void 0&&(l[m].nf&&(p=l[m].nf),l[m].Interior&&b.push(l[m].Interior),!!l[m].Parent);)m=l[m].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=$t(e);break;case"String":n.t="s",n.r=My(Nt(e)),n.v=e.indexOf("<")>-1?Nt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Wt(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Nt(e):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=sN[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=My(t||e));break}if(k7(n,p,f),f.cellFormula!==!1)if(n.Formula){var y=Nt(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=ro(y,s),delete n.Formula,n.ArrayRange=="RC"?n.F=ro("RC:RC",s):n.ArrayRange&&(n.F=ro(n.ArrayRange,s),d.push([kt(n.F),n.F]))}else for(v=0;v<d.length;++v)s.r>=d[v][0].s.r&&s.r<=d[v][0].e.r&&s.c>=d[v][0].s.c&&s.c<=d[v][0].e.c&&(n.F=d[v][1]);f.cellStyles&&(b.forEach(function(N){!g.patternType&&N.patternType&&(g.patternType=N.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function _7(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function hp(e,t){var r=t||{};Ao();var n=Nc(Wx(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ot(n));var s=n.slice(0,1024).toLowerCase(),l=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var c=Gt(r);return c.type="string",ko.to_workbook(n,c)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Pt){s.indexOf("<"+Pt)>=0&&(l=!0)}),l)return hM(n,r);Oc={"General Number":"General","General Date":nt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":nt[15],"Short Date":nt[14],"Long Time":nt[19],"Medium Time":nt[18],"Short Time":nt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:nt[2],Standard:nt[4],Percent:nt[10],Scientific:nt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,d=[],f,p={},m=[],g=r.dense?[]:{},b="",v={},y={},N=da('<Data ss:Type="String">'),_=0,C=0,S=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},O={},F={},T="",D=0,I=[],J={},Z={},ee=0,ne=[],he=[],Q={},xe=[],Y,le=!1,X=[],ve=[],K={},k=0,B=0,A={Sheets:[],WBProps:{date1904:!1}},M={};Gc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ae="";u=Gc.exec(n);)switch(u[3]=(ae=u[3]).toLowerCase()){case"data":if(ae=="data"){if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break}if(d[d.length-1][1])break;u[1]==="/"?j7(n.slice(_,u.index),T,N,d[d.length-1][0]=="comment"?Q:v,{c:C,r:S},O,xe[C],y,X,r):(T="",N=da(u[0]),_=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(he.length>0&&(v.c=he),(!r.sheetRows||r.sheetRows>S)&&v.v!==void 0&&(r.dense?(g[S]||(g[S]=[]),g[S][C]=v):g[er(C)+pr(S)]=v),v.HRef&&(v.l={Target:Nt(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(k=C+(parseInt(v.MergeAcross,10)|0),B=S+(parseInt(v.MergeDown,10)|0),I.push({s:{c:C,r:S},e:{c:k,r:B}})),!r.sheetStubs)v.MergeAcross?C=k+1:++C;else if(v.MergeAcross||v.MergeDown){for(var de=C;de<=k;++de)for(var be=S;be<=B;++be)(de>C||be>S)&&(r.dense?(g[be]||(g[be]=[]),g[be][de]={t:"z"}):g[er(de)+pr(be)]={t:"z"});C=k+1}else++C;else v=b7(u[0]),v.Index&&(C=+v.Index-1),C<E.s.c&&(E.s.c=C),C>E.e.c&&(E.e.c=C),u[0].slice(-2)==="/>"&&++C,he=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(S<E.s.r&&(E.s.r=S),S>E.e.r&&(E.e.r=S),u[0].slice(-2)==="/>"&&(y=da(u[0]),y.Index&&(S=+y.Index-1)),C=0,++S):(y=da(u[0]),y.Index&&(S=+y.Index-1),K={},(y.AutoFitHeight=="0"||y.Height)&&(K.hpx=parseInt(y.Height,10),K.hpt=Jc(K.hpx),ve[S]=K),y.Hidden=="1"&&(K.hidden=!0,ve[S]=K));break;case"worksheet":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"));m.push(b),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(g["!ref"]=ut(E),r.sheetRows&&r.sheetRows<=E.e.r&&(g["!fullref"]=g["!ref"],E.e.r=r.sheetRows-1,g["!ref"]=ut(E))),I.length&&(g["!merges"]=I),xe.length>0&&(g["!cols"]=xe),ve.length>0&&(g["!rows"]=ve),p[b]=g}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=C=0,d.push([u[3],!1]),f=da(u[0]),b=Nt(f.Name),g=r.dense?[]:{},I=[],X=[],ve=[],M={name:b,Hidden:0},A.Sheets.push(M);break;case"table":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else{if(u[0].slice(-2)=="/>")break;d.push([u[3],!1]),xe=[],le=!1}break;case"style":u[1]==="/"?T7(O,F,r):F=da(u[0]);break;case"numberformat":F.nf=Nt(da(u[0]).Format||"General"),Oc[F.nf]&&(F.nf=Oc[F.nf]);for(var we=0;we!=392&&nt[we]!=F.nf;++we);if(we==392){for(we=57;we!=392;++we)if(nt[we]==null){hs(F.nf,we);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(Y=da(u[0]),Y.Hidden&&(Y.hidden=!0,delete Y.Hidden),Y.Width&&(Y.wpx=parseInt(Y.Width,10)),!le&&Y.wpx>10){le=!0,Xr=BN;for(var ye=0;ye<xe.length;++ye)xe[ye]&&ci(xe[ye])}le&&ci(Y),xe[Y.Index-1||xe.length]=Y;for(var Je=0;Je<+Y.Span;++Je)xe[xe.length]=Gt(Y);break;case"namedrange":if(u[1]==="/")break;A.Names||(A.Names=[]);var G=st(u[0]),Ne={Name:G.Name,Ref:ro(G.RefersTo.slice(1),{r:0,c:0})};A.Sheets.length>0&&(Ne.Sheet=A.Sheets.length-1),A.Names.push(Ne);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?T+=n.slice(D,u.index):D=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;F.Interior=da(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?QF(J,ae,n.slice(ee,u.index)):ee=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else d.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"));_7(Q),he.push(Q)}else d.push([u[3],!1]),f=da(u[0]),Q={a:f.Author};break;case"autofilter":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var He=da(u[0]);g["!autofilter"]={ref:ro(He.Range).replace(/\$/g,"")},d.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((f=d.pop())[0]!==u[3])throw new Error("Bad state: "+f.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"null":break;default:if(d.length==0&&u[3]=="document"||d.length==0&&u[3]=="uof")return _2(n,r);var ht=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ht=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ht=!1}break;case"excelworkbook":switch(u[3]){case"date1904":A.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ht=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:ht=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(ee,u.index)){case"SheetHidden":M.Hidden=1;break;case"SheetVeryHidden":M.Hidden=2;break}else ee=u.index+u[0].length;break;case"header":g["!margins"]||Zi(g["!margins"]={},"xlml"),isNaN(+st(u[0]).Margin)||(g["!margins"].header=+st(u[0]).Margin);break;case"footer":g["!margins"]||Zi(g["!margins"]={},"xlml"),isNaN(+st(u[0]).Margin)||(g["!margins"].footer=+st(u[0]).Margin);break;case"pagemargins":var rt=st(u[0]);g["!margins"]||Zi(g["!margins"]={},"xlml"),isNaN(+rt.Top)||(g["!margins"].top=+rt.Top),isNaN(+rt.Left)||(g["!margins"].left=+rt.Left),isNaN(+rt.Right)||(g["!margins"].right=+rt.Right),isNaN(+rt.Bottom)||(g["!margins"].bottom=+rt.Bottom);break;case"displayrighttoleft":A.Views||(A.Views=[]),A.Views[0]||(A.Views[0]={}),A.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ht=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ht=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ht=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ht=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ht=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ht=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ht=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ht=!1}break;case"smarttags":break;default:ht=!1;break}if(ht||u[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?N7(Z,ae,ne,n.slice(ee,u.index)):(ne=u,ee=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+d.join("|")}var Oe={};return!r.bookSheets&&!r.bookProps&&(Oe.Sheets=p),Oe.SheetNames=m,Oe.Workbook=A,Oe.SSF=Gt(nt),Oe.Props=J,Oe.Custprops=Z,Oe}function rx(e,t){switch(gm(t=t||{}),t.type||"base64"){case"base64":return hp(Bn(e),t);case"binary":case"buffer":case"file":return hp(e,t);case"array":return hp(xi(e),t)}}function S7(e,t){var r=[];return e.Props&&r.push(YF(e.Props,t)),e.Custprops&&r.push(JF(e.Props,e.Custprops)),r.join("")}function C7(){return""}function E7(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var l=[];l.push(Ie("NumberFormat",null,{"ss:Format":Dt(nt[n.numFmtId])}));var c={"ss:ID":"s"+(21+s)};r.push(Ie("Style",l.join(""),c))}),Ie("Styles",r.join(""))}function dk(e){return Ie("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+um(e.Ref,{r:0,c:0})})}function F7(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(dk(s)))}return Ie("Names",r.join(""))}function A7(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,l=[],c=0;c<s.length;++c){var u=s[c];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||l.push(dk(u)))}return l.join("")}function D7(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Ie("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Ie("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Ie("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Ie("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<r&&!(n.Workbook.Sheets[l]&&!n.Workbook.Sheets[l].Hidden);++l);l==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Ur("ProtectContents","True")),e["!protect"].objects&&s.push(Ur("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Ur("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Ur("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Ur("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(c){e["!protect"][c[0]]&&s.push("<"+c[1]+"/>")})),s.length==0?"":Ie("WorksheetOptions",s.join(""),{xmlns:Ln.x})}function P7(e){return e.map(function(t){var r=eF(t.t||""),n=Ie("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ie("Comment",n,{"ss:Author":t.a})}).join("")}function L7(e,t,r,n,s,l,c){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+Dt(um(e.f,c))),e.F&&e.F.slice(0,t.length)==t){var d=tr(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(d.r==c.r?"":"["+(d.r-c.r)+"]")+"C"+(d.c==c.c?"":"["+(d.c-c.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=Dt(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=Dt(e.l.Tooltip))),r["!merges"])for(var f=r["!merges"],p=0;p!=f.length;++p)f[p].s.c!=c.c||f[p].s.r!=c.r||(f[p].e.c>f[p].s.c&&(u["ss:MergeAcross"]=f[p].e.c-f[p].s.c),f[p].e.r>f[p].s.r&&(u["ss:MergeDown"]=f[p].e.r-f[p].s.r));var m="",g="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":m="Number",g=String(e.v);break;case"b":m="Boolean",g=e.v?"1":"0";break;case"e":m="Error",g=vs[e.v];break;case"d":m="DateTime",g=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||nt[14]);break;case"s":m="String",g=Z5(e.v||"");break}var b=gi(n.cellXfs,e,n);u["ss:StyleID"]="s"+(21+b),u["ss:Index"]=c.c+1;var v=e.v!=null?g:"",y=e.t=="z"?"":'<Data ss:Type="'+m+'">'+v+"</Data>";return(e.c||[]).length>0&&(y+=P7(e.c)),Ie("Cell",y,u)}function O7(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=To(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function R7(e,t,r,n){if(!e["!ref"])return"";var s=kt(e["!ref"]),l=e["!merges"]||[],c=0,u=[];e["!cols"]&&e["!cols"].forEach(function(N,_){ci(N);var C=!!N.width,S=qh(_,N),E={"ss:Index":_+1};C&&(E["ss:Width"]=Qc(S.width)),N.hidden&&(E["ss:Hidden"]="1"),u.push(Ie("Column",null,E))});for(var d=Array.isArray(e),f=s.s.r;f<=s.e.r;++f){for(var p=[O7(f,(e["!rows"]||[])[f])],m=s.s.c;m<=s.e.c;++m){var g=!1;for(c=0;c!=l.length;++c)if(!(l[c].s.c>m)&&!(l[c].s.r>f)&&!(l[c].e.c<m)&&!(l[c].e.r<f)){(l[c].s.c!=m||l[c].s.r!=f)&&(g=!0);break}if(!g){var b={r:f,c:m},v=at(b),y=d?(e[f]||[])[m]:e[v];p.push(L7(y,v,e,t,r,n,b))}}p.push("</Row>"),p.length>2&&u.push(p.join(""))}return u.join("")}function I7(e,t,r){var n=[],s=r.SheetNames[e],l=r.Sheets[s],c=l?A7(l,t,e,r):"";return c.length>0&&n.push("<Names>"+c+"</Names>"),c=l?R7(l,t,e,r):"",c.length>0&&n.push("<Table>"+c+"</Table>"),n.push(D7(l,t,e,r)),n.join("")}function M7(e,t){t||(t={}),e.SSF||(e.SSF=Gt(nt)),e.SSF&&(Ao(),Uh(e.SSF),t.revssf=zh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],gi(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(S7(e,t)),r.push(C7()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Ie("Worksheet",I7(n,t,e),{"ss:Name":Dt(e.SheetNames[n])}));return r[2]=E7(e,t),r[3]=F7(e),xr+Ie("Workbook",r.join(""),{xmlns:Ln.ss,"xmlns:o":Ln.o,"xmlns:x":Ln.x,"xmlns:ss":Ln.ss,"xmlns:dt":Ln.dt,"xmlns:html":Ln.html})}function B7(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=FF(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=AF(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var H7=[60,1084,2066,2165,2175];function U7(e,t,r,n,s){var l=n,c=[],u=r.slice(r.l,r.l+l);if(s&&s.enc&&s.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(u)}c.push(u),r.l+=l;for(var d=cs(r,r.l),f=nx[d],p=0;f!=null&&H7.indexOf(d)>-1;)l=cs(r,r.l+2),p=r.l+4,d==2066?p+=4:(d==2165||d==2175)&&(p+=12),u=r.slice(p,r.l+4+l),c.push(u),r.l+=4+l,f=nx[d=cs(r,r.l)];var m=Or(c);Hr(m,0);var g=0;m.lens=[];for(var b=0;b<c.length;++b)m.lens.push(g),g+=c[b].length;if(m.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+n;return t.f(m,m.length,s)}function Aa(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=nt[n])}catch(l){if(t.WTF)throw l}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||vs[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Kc(e.v):e.w=al(e.v):e.w=na(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(l){if(t.WTF)throw l}if(t.cellDates&&n&&e.t=="n"&&Fo(nt[n]||String(n))){var s=Bi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function W0(e,t,r){return{v:e,ixfe:t,t:r}}function V7(e,t){var r={opts:{}},n={},s=t.dense?[]:{},l={},c={},u=null,d=[],f="",p={},m,g="",b,v,y,N,_={},C=[],S,E,O=[],F=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},D={},I=function(tt){return tt<8?Qi[tt]:tt<64&&F[tt-8]||Qi[tt]},J=function(tt,St,Sr){var Ht=St.XF.data;if(!(!Ht||!Ht.patternType||!Sr||!Sr.cellStyles)){St.s={},St.s.patternType=Ht.patternType;var tn;(tn=Xc(I(Ht.icvFore)))&&(St.s.fgColor={rgb:tn}),(tn=Xc(I(Ht.icvBack)))&&(St.s.bgColor={rgb:tn})}},Z=function(tt,St,Sr){if(!(K>1)&&!(Sr.sheetRows&&tt.r>=Sr.sheetRows)){if(Sr.cellStyles&&St.XF&&St.XF.data&&J(tt,St,Sr),delete St.ixfe,delete St.XF,m=tt,g=at(tt),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),tt.r<c.s.r&&(c.s.r=tt.r),tt.c<c.s.c&&(c.s.c=tt.c),tt.r+1>c.e.r&&(c.e.r=tt.r+1),tt.c+1>c.e.c&&(c.e.c=tt.c+1),Sr.cellFormula&&St.f){for(var Ht=0;Ht<C.length;++Ht)if(!(C[Ht][0].s.c>tt.c||C[Ht][0].s.r>tt.r)&&!(C[Ht][0].e.c<tt.c||C[Ht][0].e.r<tt.r)){St.F=ut(C[Ht][0]),(C[Ht][0].s.c!=tt.c||C[Ht][0].s.r!=tt.r)&&delete St.f,St.f&&(St.f=""+qr(C[Ht][1],c,tt,X,ee));break}}Sr.dense?(s[tt.r]||(s[tt.r]=[]),s[tt.r][tt.c]=St):s[g]=St}},ee={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:C,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(ee.password=t.password);var ne,he=[],Q=[],xe=[],Y=[],le=!1,X=[];X.SheetNames=ee.snames,X.sharedf=ee.sharedf,X.arrayf=ee.arrayf,X.names=[],X.XTI=[];var ve=0,K=0,k=0,B=[],A=[],M;ee.codepage=1200,va(1200);for(var ae=!1;e.l<e.length-1;){var de=e.l,be=e.read_shift(2);if(be===0&&ve===10)break;var we=e.l===e.length?0:e.read_shift(2),ye=nx[be];if(ye&&ye.f){if(t.bookSheets&&ve===133&&be!==133)break;if(ve=be,ye.r===2||ye.r==12){var Je=e.read_shift(2);if(we-=2,!ee.enc&&Je!==be&&((Je&255)<<8|Je>>8)!==be)throw new Error("rt mismatch: "+Je+"!="+be);ye.r==12&&(e.l+=10,we-=10)}var G={};if(be===10?G=ye.f(e,we,ee):G=U7(be,ye,e,we,ee),K==0&&[9,521,1033,2057].indexOf(ve)===-1)continue;switch(be){case 34:r.opts.Date1904=T.WBProps.date1904=G;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(ee.enc||(e.l=0),ee.enc=G,!t.password)throw new Error("File is password-protected");if(G.valid==null)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:ee.lastuser=G;break;case 66:var Ne=Number(G);switch(Ne){case 21010:Ne=1200;break;case 32768:Ne=1e4;break;case 32769:Ne=1252;break}va(ee.codepage=Ne),ae=!0;break;case 317:ee.rrtabid=G;break;case 25:ee.winlocked=G;break;case 439:r.opts.RefreshAll=G;break;case 12:r.opts.CalcCount=G;break;case 16:r.opts.CalcDelta=G;break;case 17:r.opts.CalcIter=G;break;case 13:r.opts.CalcMode=G;break;case 14:r.opts.CalcPrecision=G;break;case 95:r.opts.CalcSaveRecalc=G;break;case 15:ee.CalcRefMode=G;break;case 2211:r.opts.FullCalc=G;break;case 129:G.fDialog&&(s["!type"]="dialog"),G.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),G.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:O.push(G);break;case 430:X.push([G]),X[X.length-1].XTI=[];break;case 35:case 547:X[X.length-1].push(G);break;case 24:case 536:M={Name:G.Name,Ref:qr(G.rgce,c,null,X,ee)},G.itab>0&&(M.Sheet=G.itab-1),X.names.push(M),X[0]||(X[0]=[],X[0].XTI=[]),X[X.length-1].push(G),G.Name=="_xlnm._FilterDatabase"&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&G.rgce[0][0][0]=="PtgArea3d"&&(A[G.itab-1]={ref:ut(G.rgce[0][0][1][2])});break;case 22:ee.ExternCount=G;break;case 23:X.length==0&&(X[0]=[],X[0].XTI=[]),X[X.length-1].XTI=X[X.length-1].XTI.concat(G),X.XTI=X.XTI.concat(G);break;case 2196:if(ee.biff<8)break;M!=null&&(M.Comment=G[1]);break;case 18:s["!protect"]=G;break;case 19:G!==0&&ee.WTF&&console.error("Password verifier: "+G);break;case 133:l[G.pos]=G,ee.snames.push(G.name);break;case 10:{if(--K)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,s["!ref"]=ut(c),t.sheetRows&&t.sheetRows<=c.e.r){var He=c.e.r;c.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=ut(c),c.e.r=He}c.e.r++,c.e.c++}he.length>0&&(s["!merges"]=he),Q.length>0&&(s["!objects"]=Q),xe.length>0&&(s["!cols"]=xe),Y.length>0&&(s["!rows"]=Y),T.Sheets.push(D)}f===""?p=s:n[f]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ee.biff===8&&(ee.biff={9:2,521:3,1033:4}[be]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),ee.biffguess=G.BIFFVer==0,G.BIFFVer==0&&G.dt==4096&&(ee.biff=5,ae=!0,va(ee.codepage=28591)),ee.biff==8&&G.BIFFVer==0&&G.dt==16&&(ee.biff=2),K++)break;if(s=t.dense?[]:{},ee.biff<8&&!ae&&(ae=!0,va(ee.codepage=t.codepage||1252)),ee.biff<5||G.BIFFVer==0&&G.dt==4096){f===""&&(f="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var ht={pos:e.l-we,name:f};l[ht.pos]=ht,ee.snames.push(f)}else f=(l[de]||{name:""}).name;G.dt==32&&(s["!type"]="chart"),G.dt==64&&(s["!type"]="macro"),he=[],Q=[],ee.arrayf=C=[],xe=[],Y=[],le=!1,D={Hidden:(l[de]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[G.r]||[])[G.c]:s[at({c:G.c,r:G.r})])&&++G.c,S={ixfe:G.ixfe,XF:O[G.ixfe]||{},v:G.val,t:"n"},k>0&&(S.z=B[S.ixfe>>8&63]),Aa(S,t,r.opts.Date1904),Z({c:G.c,r:G.r},S,t);break;case 5:case 517:S={ixfe:G.ixfe,XF:O[G.ixfe],v:G.val,t:G.t},k>0&&(S.z=B[S.ixfe>>8&63]),Aa(S,t,r.opts.Date1904),Z({c:G.c,r:G.r},S,t);break;case 638:S={ixfe:G.ixfe,XF:O[G.ixfe],v:G.rknum,t:"n"},k>0&&(S.z=B[S.ixfe>>8&63]),Aa(S,t,r.opts.Date1904),Z({c:G.c,r:G.r},S,t);break;case 189:for(var rt=G.c;rt<=G.C;++rt){var Oe=G.rkrec[rt-G.c][0];S={ixfe:Oe,XF:O[Oe],v:G.rkrec[rt-G.c][1],t:"n"},k>0&&(S.z=B[S.ixfe>>8&63]),Aa(S,t,r.opts.Date1904),Z({c:rt,r:G.r},S,t)}break;case 6:case 518:case 1030:{if(G.val=="String"){u=G;break}if(S=W0(G.val,G.cell.ixfe,G.tt),S.XF=O[S.ixfe],t.cellFormula){var Pt=G.formula;if(Pt&&Pt[0]&&Pt[0][0]&&Pt[0][0][0]=="PtgExp"){var lr=Pt[0][0][1][0],or=Pt[0][0][1][1],_r=at({r:lr,c:or});_[_r]?S.f=""+qr(G.formula,c,G.cell,X,ee):S.F=((t.dense?(s[lr]||[])[or]:s[_r])||{}).F}else S.f=""+qr(G.formula,c,G.cell,X,ee)}k>0&&(S.z=B[S.ixfe>>8&63]),Aa(S,t,r.opts.Date1904),Z(G.cell,S,t),u=G}break;case 7:case 519:if(u)u.val=G,S=W0(G,u.cell.ixfe,"s"),S.XF=O[S.ixfe],t.cellFormula&&(S.f=""+qr(u.formula,c,u.cell,X,ee)),k>0&&(S.z=B[S.ixfe>>8&63]),Aa(S,t,r.opts.Date1904),Z(u.cell,S,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{C.push(G);var sa=at(G[0].s);if(b=t.dense?(s[G[0].s.r]||[])[G[0].s.c]:s[sa],t.cellFormula&&b){if(!u||!sa||!b)break;b.f=""+qr(G[1],c,G[0],X,ee),b.F=ut(G[0])}}break;case 1212:{if(!t.cellFormula)break;if(g){if(!u)break;_[at(u.cell)]=G[0],b=t.dense?(s[u.cell.r]||[])[u.cell.c]:s[at(u.cell)],(b||{}).f=""+qr(G[0],c,m,X,ee)}}break;case 253:S=W0(d[G.isst].t,G.ixfe,"s"),d[G.isst].h&&(S.h=d[G.isst].h),S.XF=O[S.ixfe],k>0&&(S.z=B[S.ixfe>>8&63]),Aa(S,t,r.opts.Date1904),Z({c:G.c,r:G.r},S,t);break;case 513:t.sheetStubs&&(S={ixfe:G.ixfe,XF:O[G.ixfe],t:"z"},k>0&&(S.z=B[S.ixfe>>8&63]),Aa(S,t,r.opts.Date1904),Z({c:G.c,r:G.r},S,t));break;case 190:if(t.sheetStubs)for(var Cn=G.c;Cn<=G.C;++Cn){var Re=G.ixfe[Cn-G.c];S={ixfe:Re,XF:O[Re],t:"z"},k>0&&(S.z=B[S.ixfe>>8&63]),Aa(S,t,r.opts.Date1904),Z({c:Cn,r:G.r},S,t)}break;case 214:case 516:case 4:S=W0(G.val,G.ixfe,"s"),S.XF=O[S.ixfe],k>0&&(S.z=B[S.ixfe>>8&63]),Aa(S,t,r.opts.Date1904),Z({c:G.c,r:G.r},S,t);break;case 0:case 512:K===1&&(c=G);break;case 252:d=G;break;case 1054:if(ee.biff==4){B[k++]=G[1];for(var Ge=0;Ge<k+163&&nt[Ge]!=G[1];++Ge);Ge>=163&&hs(G[1],k+163)}else hs(G[1],G[0]);break;case 30:{B[k++]=G;for(var Tt=0;Tt<k+163&&nt[Tt]!=G;++Tt);Tt>=163&&hs(G,k+163)}break;case 229:he=he.concat(G);break;case 93:Q[G.cmo[0]]=ee.lastobj=G;break;case 438:ee.lastobj.TxO=G;break;case 127:ee.lastobj.ImData=G;break;case 440:for(N=G[0].s.r;N<=G[0].e.r;++N)for(y=G[0].s.c;y<=G[0].e.c;++y)b=t.dense?(s[N]||[])[y]:s[at({c:y,r:N})],b&&(b.l=G[1]);break;case 2048:for(N=G[0].s.r;N<=G[0].e.r;++N)for(y=G[0].s.c;y<=G[0].e.c;++y)b=t.dense?(s[N]||[])[y]:s[at({c:y,r:N})],b&&b.l&&(b.l.Tooltip=G[1]);break;case 28:{if(ee.biff<=5&&ee.biff>=2)break;b=t.dense?(s[G[0].r]||[])[G[0].c]:s[at(G[0])];var Lt=Q[G[2]];b||(t.dense?(s[G[0].r]||(s[G[0].r]=[]),b=s[G[0].r][G[0].c]={t:"z"}):b=s[at(G[0])]={t:"z"},c.e.r=Math.max(c.e.r,G[0].r),c.s.r=Math.min(c.s.r,G[0].r),c.e.c=Math.max(c.e.c,G[0].c),c.s.c=Math.min(c.s.c,G[0].c)),b.c||(b.c=[]),v={a:G[1],t:Lt.TxO.t},b.c.push(v)}break;case 2173:EP(O[G.ixfe],G.ext);break;case 125:{if(!ee.cellStyles)break;for(;G.e>=G.s;)xe[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(G.flags&1)},le||(le=!0,lm(G.w/256)),ci(xe[G.e+1])}break;case 520:{var bt={};G.level!=null&&(Y[G.r]=bt,bt.level=G.level),G.hidden&&(Y[G.r]=bt,bt.hidden=!0),G.hpt&&(Y[G.r]=bt,bt.hpt=G.hpt,bt.hpx=To(G.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Zi(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[be]]=G;break;case 161:s["!margins"]||Zi(s["!margins"]={}),s["!margins"].header=G.header,s["!margins"].footer=G.footer;break;case 574:G.RTL&&(T.Views[0].RTL=!0);break;case 146:F=G;break;case 2198:ne=G;break;case 140:E=G;break;case 442:f?D.CodeName=G||D.name:T.WBProps.CodeName=G||"ThisWorkbook";break}}else ye||console.error("Missing Info for XLS Record 0x"+be.toString(16)),e.l+=we}return r.SheetNames=ir(l).sort(function(br,tt){return Number(br)-Number(tt)}).map(function(br){return l[br].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&p["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=p)):r.Preamble=p,r.Sheets&&A.forEach(function(br,tt){r.Sheets[r.SheetNames[tt]]["!autofilter"]=br}),r.Strings=d,r.SSF=Gt(nt),ee.enc&&(r.Encryption=ee.enc),ne&&(r.Themes=ne),r.Metadata={},E!==void 0&&(r.Metadata.Country=E),X.names.length>0&&(T.Names=X.names),r.Workbook=T,r}var Rc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function z7(e,t,r){var n=Ye.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=r2(n,Qp,Rc.DSI);for(var l in s)t[l]=s[l]}catch(f){if(r.WTF)throw f}var c=Ye.find(e,"/!SummaryInformation");if(c&&c.size>0)try{var u=r2(c,Yp,Rc.SI);for(var d in u)t[d]==null&&(t[d]=u[d])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(hN(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function K7(e,t){var r=[],n=[],s=[],l=0,c,u=Dy(Qp,"n"),d=Dy(Yp,"n");if(e.Props)for(c=ir(e.Props),l=0;l<c.length;++l)(Object.prototype.hasOwnProperty.call(u,c[l])?r:Object.prototype.hasOwnProperty.call(d,c[l])?n:s).push([c[l],e.Props[c[l]]]);if(e.Custprops)for(c=ir(e.Custprops),l=0;l<c.length;++l)Object.prototype.hasOwnProperty.call(e.Props||{},c[l])||(Object.prototype.hasOwnProperty.call(u,c[l])?r:Object.prototype.hasOwnProperty.call(d,c[l])?n:s).push([c[l],e.Custprops[c[l]]]);var f=[];for(l=0;l<s.length;++l)vN.indexOf(s[l][0])>-1||uN.indexOf(s[l][0])>-1||s[l][1]!=null&&f.push(s[l]);n.length&&Ye.utils.cfb_add(t,"/SummaryInformation",n2(n,Rc.SI,d,Yp)),(r.length||f.length)&&Ye.utils.cfb_add(t,"/DocumentSummaryInformation",n2(r,Rc.DSI,u,Qp,f.length?f:null,Rc.UDI))}function xm(e,t){t||(t={}),gm(t),Ix(),t.codepage&&Rx(t.codepage);var r,n;if(e.FullPaths){if(Ye.find(e,"/encryption"))throw new Error("File is password-protected");r=Ye.find(e,"!CompObj"),n=Ye.find(e,"/Workbook")||Ye.find(e,"/Book")}else{switch(t.type){case"base64":e=Rn(Bn(e));break;case"binary":e=Rn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Hr(e,0),n={content:e}}var s,l;if(r&&B7(r),t.bookProps&&!t.bookSheets)s={};else{var c=xt?"buffer":"array";if(n&&n.content)s=V7(n.content,t);else if((l=Ye.find(e,"PerfectOffice_MAIN"))&&l.content)s=Ji.to_workbook(l.content,(t.type=c,t));else if((l=Ye.find(e,"NativeContent_MAIN"))&&l.content)s=Ji.to_workbook(l.content,(t.type=c,t));else throw(l=Ye.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ye.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=nL(e))}var u={};return e.FullPaths&&z7(e,u,t),s.Props=s.Custprops=u,t.bookFiles&&(s.cfb=e),s}function $7(e,t){var r=t||{},n=Ye.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ye.utils.cfb_add(n,s,fk(e,r)),r.biff==8&&(e.Props||e.Custprops)&&K7(e,n),r.biff==8&&e.vbaraw&&aL(n,Ye.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Zc={0:{f:xR},1:{f:kR},2:{f:VR},3:{f:AR},4:{f:SR},5:{f:BR},6:{f:GR},7:{f:OR},8:{f:eI},9:{f:ZR},10:{f:YR},11:{f:JR},12:{f:jR},13:{f:KR},14:{f:PR},15:{f:ER},16:{f:sk},17:{f:XR},18:{f:IR},19:{f:Yx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:XI},40:{},42:{},43:{f:GD},44:{f:$D},45:{f:QD},46:{f:JD},47:{f:YD},48:{},49:{f:vF},50:{},51:{f:DP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:EN},62:{f:WR},63:{f:UP},64:{f:mI},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Zr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:dI},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:wR},148:{f:vR,p:16},151:{f:iI},152:{},153:{f:WI},154:{},155:{},156:{f:KI},157:{},158:{},159:{T:1,f:oD},160:{T:-1},161:{T:1,f:ml},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:tI},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:FP},336:{T:-1},337:{f:OP,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Xp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:CN},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:lI},427:{f:oI},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:uI},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:bR},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:aI},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Xp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:JP},633:{T:1},634:{T:-1},635:{T:1,f:QP},636:{T:-1},637:{f:NF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:PI},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:gI},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},nx={6:{f:cp},10:{f:zs},12:{f:yr},13:{f:yr},14:{f:dr},15:{f:dr},16:{f:Yr},17:{f:dr},18:{f:dr},19:{f:yr},20:{f:c2},21:{f:c2},23:{f:CN},24:{f:h2},25:{f:dr},26:{},27:{},28:{f:g8},29:{},34:{f:dr},35:{f:u2},38:{f:Yr},39:{f:Yr},40:{f:Yr},41:{f:Yr},42:{f:dr},43:{f:dr},47:{f:ED},49:{f:KA},51:{f:yr},60:{},61:{f:BA},64:{f:dr},65:{f:zA},66:{f:yr},77:{},80:{},81:{},82:{},85:{f:yr},89:{},90:{},91:{},92:{f:CA},93:{f:b8},94:{},95:{f:dr},96:{},97:{},99:{f:dr},125:{f:EN},128:{f:s8},129:{f:FA},130:{f:yr},131:{f:dr},132:{f:dr},133:{f:AA},134:{},140:{f:C8},141:{f:yr},144:{},146:{f:A8},151:{},152:{},153:{},154:{},155:{},156:{f:yr},157:{},158:{},160:{f:M8},161:{f:L8},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:t8},190:{f:r8},193:{f:zs},197:{},198:{},199:{},200:{},201:{},202:{f:dr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:yr},220:{},221:{f:dr},222:{},224:{f:a8},225:{f:SA},226:{f:zs},227:{},229:{f:v8},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:PA},253:{f:WA},255:{f:OA},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:yN},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:dr},353:{f:zs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:u8},431:{f:dr},432:{},433:{},434:{},437:{},438:{f:k8},439:{f:dr},440:{f:T8},441:{},442:{f:mu},443:{},444:{f:yr},445:{},446:{},448:{f:zs},449:{f:MA,r:2},450:{f:zs},512:{f:i2},513:{f:I8},515:{f:o8},516:{f:qA},517:{f:o2},519:{f:B8},520:{f:RA},523:{},545:{f:d2},549:{f:s2},566:{},574:{f:UA},638:{f:e8},659:{},1048:{},1054:{f:QA},1084:{},1212:{f:p8},2048:{f:_8},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:z0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:zs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:D8,r:12},2173:{f:CP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:dr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:f8,r:12},2197:{},2198:{f:NP,r:12},2199:{},2200:{},2201:{},2202:{f:x8,r:12},2203:{f:zs},2204:{},2205:{},2206:{},2207:{},2211:{f:IA},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:yr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:O8},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:F8},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:i2},1:{},2:{f:K8},3:{f:V8},4:{f:U8},5:{f:o2},7:{f:W8},8:{},9:{f:z0},11:{},22:{f:yr},30:{f:JA},31:{},32:{},33:{f:d2},36:{},37:{f:s2},50:{f:G8},62:{},52:{},67:{},68:{f:yr},69:{},86:{},126:{},127:{f:H8},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:q8},223:{},234:{},354:{},421:{},518:{f:cp},521:{f:z0},536:{f:h2},547:{f:u2},561:{},579:{},1030:{f:cp},1033:{f:z0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Me(e,t,r,n){var s=t;if(!isNaN(s)){var l=n||(r||[]).length||0,c=e.next(4);c.write_shift(2,s),c.write_shift(2,l),l>0&&qx(r)&&e.push(r)}}function W7(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return Me(e,t,r,s);var l=t;if(!isNaN(l)){for(var c=r.parts||[],u=0,d=0,f=0;f+(c[u]||8224)<=8224;)f+=c[u]||8224,u++;var p=e.next(4);for(p.write_shift(2,l),p.write_shift(2,f),e.push(r.slice(d,d+f)),d+=f;d<s;){for(p=e.next(4),p.write_shift(2,60),f=0;f+(c[u]||8224)<=8224;)f+=c[u]||8224,u++;p.write_shift(2,f),e.push(r.slice(d,d+f)),d+=f}}}function bu(e,t,r){return e||(e=ke(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function G7(e,t,r,n){var s=ke(9);return bu(s,e,t),bN(r,n||"b",s),s}function q7(e,t,r){var n=ke(8+2*r.length);return bu(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function X7(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?jr(Wt(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Me(e,2,$8(r,n,s)):Me(e,3,z8(r,n,s));return;case"b":case"e":Me(e,5,G7(r,n,t.v,t.t));return;case"s":case"str":Me(e,4,q7(r,n,(t.v||"").slice(0,255)));return}Me(e,1,bu(null,r,n))}function Q7(e,t,r,n){var s=Array.isArray(t),l=kt(t["!ref"]||"A1"),c,u="",d=[];if(l.e.c>255||l.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),c=ut(l)}for(var f=l.s.r;f<=l.e.r;++f){u=pr(f);for(var p=l.s.c;p<=l.e.c;++p){f===l.s.r&&(d[p]=er(p)),c=d[p]+u;var m=s?(t[f]||[])[p]:t[c];m&&X7(e,m,f,p)}}}function Y7(e,t){for(var r=t||{},n=jn(),s=0,l=0;l<e.SheetNames.length;++l)e.SheetNames[l]==r.sheet&&(s=l);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Me(n,r.biff==4?1033:r.biff==3?521:9,am(e,16,r)),Q7(n,e.Sheets[e.SheetNames[s]],s,r),Me(n,10),n.end()}function J7(e,t,r){Me(e,49,$A({sz:12,name:"Arial"},r))}function Z7(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Me(e,1054,YA(s,t[s],r))})}function eM(e,t){var r=ke(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Me(e,2151,r),r=ke(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),jN(kt(t["!ref"]||"A1"),r),r.write_shift(4,4),Me(e,2152,r)}function tM(e,t){for(var r=0;r<16;++r)Me(e,224,l2({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Me(e,224,l2(n,0,t))})}function rM(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Me(e,440,j8(n)),n[1].Tooltip&&Me(e,2048,S8(n))}delete t["!links"]}function nM(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&Me(e,125,P8(qh(s,n),s))})}}function aM(e,t,r,n,s){var l=16+gi(s.cellXfs,t,s);if(t.v==null&&!t.bf){Me(e,513,ol(r,n,l));return}if(t.bf)Me(e,6,FO(t,r,n,s,l));else switch(t.t){case"d":case"n":var c=t.t=="d"?jr(Wt(t.v)):t.v;Me(e,515,c8(r,n,c,l));break;case"b":case"e":Me(e,517,l8(r,n,t.v,l,s,t.t));break;case"s":case"str":if(s.bookSST){var u=dm(s.Strings,t.v,s.revStrings);Me(e,253,GA(r,n,u,l))}else Me(e,516,XA(r,n,(t.v||"").slice(0,255),l,s));break;default:Me(e,513,ol(r,n,l))}}function sM(e,t,r){var n=jn(),s=r.SheetNames[e],l=r.Sheets[s]||{},c=(r||{}).Workbook||{},u=(c.Sheets||[])[e]||{},d=Array.isArray(l),f=t.biff==8,p,m="",g=[],b=kt(l["!ref"]||"A1"),v=f?65536:16384;if(b.e.c>255||b.e.r>=v){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");b.e.c=Math.min(b.e.c,255),b.e.r=Math.min(b.e.c,v-1)}Me(n,2057,am(r,16,t)),Me(n,13,Zn(1)),Me(n,12,Zn(100)),Me(n,15,cn(!0)),Me(n,17,cn(!1)),Me(n,16,il(.001)),Me(n,95,cn(!0)),Me(n,42,cn(!1)),Me(n,43,cn(!1)),Me(n,130,Zn(1)),Me(n,128,i8()),Me(n,131,cn(!1)),Me(n,132,cn(!1)),f&&nM(n,l["!cols"]),Me(n,512,ZA(b,t)),f&&(l["!links"]=[]);for(var y=b.s.r;y<=b.e.r;++y){m=pr(y);for(var N=b.s.c;N<=b.e.c;++N){y===b.s.r&&(g[N]=er(N)),p=g[N]+m;var _=d?(l[y]||[])[N]:l[p];_&&(aM(n,_,y,N,t),f&&_.l&&l["!links"].push([p,_.l]))}}var C=u.CodeName||u.name||s;return f&&Me(n,574,VA((c.Views||[])[0])),f&&(l["!merges"]||[]).length&&Me(n,229,y8(l["!merges"])),f&&rM(n,l),Me(n,442,wN(C)),f&&eM(n,l),Me(n,10),n.end()}function iM(e,t,r){var n=jn(),s=(e||{}).Workbook||{},l=s.Sheets||[],c=s.WBProps||{},u=r.biff==8,d=r.biff==5;if(Me(n,2057,am(e,5,r)),r.bookType=="xla"&&Me(n,135),Me(n,225,u?Zn(1200):null),Me(n,193,lA(2)),d&&Me(n,191),d&&Me(n,192),Me(n,226),Me(n,92,EA("SheetJS",r)),Me(n,66,Zn(u?1200:1252)),u&&Me(n,353,Zn(0)),u&&Me(n,448),Me(n,317,R8(e.SheetNames.length)),u&&e.vbaraw&&Me(n,211),u&&e.vbaraw){var f=c.CodeName||"ThisWorkbook";Me(n,442,wN(f))}Me(n,156,Zn(17)),Me(n,25,cn(!1)),Me(n,18,cn(!1)),Me(n,19,Zn(0)),u&&Me(n,431,cn(!1)),u&&Me(n,444,Zn(0)),Me(n,61,HA()),Me(n,64,cn(!1)),Me(n,141,Zn(0)),Me(n,34,cn(MI(e)=="true")),Me(n,14,cn(!0)),u&&Me(n,439,cn(!1)),Me(n,218,Zn(0)),J7(n,e,r),Z7(n,e.SSF,r),tM(n,r),u&&Me(n,352,cn(!1));var p=n.end(),m=jn();u&&Me(m,140,E8()),u&&r.Strings&&W7(m,252,LA(r.Strings)),Me(m,10);var g=m.end(),b=jn(),v=0,y=0;for(y=0;y<e.SheetNames.length;++y)v+=(u?12:11)+(u?2:1)*e.SheetNames[y].length;var N=p.length+v+g.length;for(y=0;y<e.SheetNames.length;++y){var _=l[y]||{};Me(b,133,DA({pos:N,hs:_.Hidden||0,dt:0,name:e.SheetNames[y]},r)),N+=t[y].length}var C=b.end();if(v!=C.length)throw new Error("BS8 "+v+" != "+C.length);var S=[];return p.length&&S.push(p),C.length&&S.push(C),g.length&&S.push(g),Or(S)}function lM(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Gt(nt)),e&&e.SSF&&(Ao(),Uh(e.SSF),r.revssf=zh(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,vm(r),r.cellXfs=[],gi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=sM(s,r,e);return n.unshift(iM(e,n,r)),Or(n)}function fk(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=_n(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var l=t||{};switch(l.biff||2){case 8:case 5:return lM(e,t);case 4:case 3:case 2:return Y7(e,t)}throw new Error("invalid type "+l.bookType+" for BIFF")}function N2(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),c=s.index,u=l&&l.index||e.length,d=$5(e.slice(c,u),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,p=0,m=0,g=0,b={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(c=0;c<d.length;++c){var y=d[c].trim(),N=y.slice(0,3).toLowerCase();if(N=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}p=0;continue}if(!(N!="<td"&&N!="<th")){var _=y.split(/<\/t[dh]>/i);for(u=0;u<_.length;++u){var C=_[u].trim();if(C.match(/<t[dh]/i)){for(var S=C,E=0;S.charAt(0)=="<"&&(E=S.indexOf(">"))>-1;)S=S.slice(E+1);for(var O=0;O<v.length;++O){var F=v[O];F.s.c==p&&F.s.r<f&&f<=F.e.r&&(p=F.e.c+1,O=-1)}var T=st(C.slice(0,C.indexOf(">")));g=T.colspan?+T.colspan:1,((m=+T.rowspan)>1||g>1)&&v.push({s:{r:f,c:p},e:{r:f+(m||1)-1,c:p+g-1}});var D=T.t||T["data-t"]||"";if(!S.length){p+=g;continue}if(S=Mw(S),b.s.r>f&&(b.s.r=f),b.e.r<f&&(b.e.r=f),b.s.c>p&&(b.s.c=p),b.e.c<p&&(b.e.c=p),!S.length){p+=g;continue}var I={t:"s",v:S};r.raw||!S.trim().length||D=="s"||(S==="TRUE"?I={t:"b",v:!0}:S==="FALSE"?I={t:"b",v:!1}:isNaN(ba(S))?isNaN(No(S).getDate())||(I={t:"d",v:Wt(S)},r.cellDates||(I={t:"n",v:jr(I.v)}),I.z=r.dateNF||nt[14]):I={t:"n",v:ba(S)}),r.dense?(n[f]||(n[f]=[]),n[f][p]=I):n[at({r:f,c:p})]=I,p+=g}}}}return n["!ref"]=ut(b),v.length&&(n["!merges"]=v),n}function oM(e,t,r,n){for(var s=e["!merges"]||[],l=[],c=t.s.c;c<=t.e.c;++c){for(var u=0,d=0,f=0;f<s.length;++f)if(!(s[f].s.r>r||s[f].s.c>c)&&!(s[f].e.r<r||s[f].e.c<c)){if(s[f].s.r<r||s[f].s.c<c){u=-1;break}u=s[f].e.r-s[f].s.r+1,d=s[f].e.c-s[f].s.c+1;break}if(!(u<0)){var p=at({r,c}),m=n.dense?(e[r]||[])[c]:e[p],g=m&&m.v!=null&&(m.h||$x(m.w||(xs(m),m.w)||""))||"",b={};u>1&&(b.rowspan=u),d>1&&(b.colspan=d),n.editable?g='<span contenteditable="true">'+g+"</span>":m&&(b["data-t"]=m&&m.t||"z",m.v!=null&&(b["data-v"]=m.v),m.z!=null&&(b["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+m.l.Target+'">'+g+"</a>")),b.id=(n.id||"sjs")+"-"+p,l.push(Ie("td",g,b))}}var v="<tr>";return v+l.join("")+"</tr>"}var cM='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',uM="</body></html>";function hM(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return mi(N2(r[0],t),t);var n=Nm();return r.forEach(function(s,l){km(n,N2(s,t),"Sheet"+(l+1))}),n}function dM(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function pk(e,t){var r=t||{},n=r.header!=null?r.header:cM,s=r.footer!=null?r.footer:uM,l=[n],c=_n(e["!ref"]);r.dense=Array.isArray(e),l.push(dM(e,c,r));for(var u=c.s.r;u<=c.e.r;++u)l.push(oM(e,c,u,r));return l.push("</table>"+s),l.join("")}function xk(e,t,r){var n=r||{},s=0,l=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?tr(n.origin):n.origin;s=c.r,l=c.c}var u=t.getElementsByTagName("tr"),d=Math.min(n.sheetRows||1e7,u.length),f={s:{r:0,c:0},e:{r:s,c:l}};if(e["!ref"]){var p=_n(e["!ref"]);f.s.r=Math.min(f.s.r,p.s.r),f.s.c=Math.min(f.s.c,p.s.c),f.e.r=Math.max(f.e.r,p.e.r),f.e.c=Math.max(f.e.c,p.e.c),s==-1&&(f.e.r=s=p.e.r+1)}var m=[],g=0,b=e["!rows"]||(e["!rows"]=[]),v=0,y=0,N=0,_=0,C=0,S=0;for(e["!cols"]||(e["!cols"]=[]);v<u.length&&y<d;++v){var E=u[v];if(k2(E)){if(n.display)continue;b[y]={hidden:!0}}var O=E.children;for(N=_=0;N<O.length;++N){var F=O[N];if(!(n.display&&k2(F))){var T=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):Mw(F.innerHTML),D=F.getAttribute("data-z")||F.getAttribute("z");for(g=0;g<m.length;++g){var I=m[g];I.s.c==_+l&&I.s.r<y+s&&y+s<=I.e.r&&(_=I.e.c+1-l,g=-1)}S=+F.getAttribute("colspan")||1,((C=+F.getAttribute("rowspan")||1)>1||S>1)&&m.push({s:{r:y+s,c:_+l},e:{r:y+s+(C||1)-1,c:_+l+(S||1)-1}});var J={t:"s",v:T},Z=F.getAttribute("data-t")||F.getAttribute("t")||"";T!=null&&(T.length==0?J.t=Z||"z":n.raw||T.trim().length==0||Z=="s"||(T==="TRUE"?J={t:"b",v:!0}:T==="FALSE"?J={t:"b",v:!1}:isNaN(ba(T))?isNaN(No(T).getDate())||(J={t:"d",v:Wt(T)},n.cellDates||(J={t:"n",v:jr(J.v)}),J.z=n.dateNF||nt[14]):J={t:"n",v:ba(T)})),J.z===void 0&&D!=null&&(J.z=D);var ee="",ne=F.getElementsByTagName("A");if(ne&&ne.length)for(var he=0;he<ne.length&&!(ne[he].hasAttribute("href")&&(ee=ne[he].getAttribute("href"),ee.charAt(0)!="#"));++he);ee&&ee.charAt(0)!="#"&&(J.l={Target:ee}),n.dense?(e[y+s]||(e[y+s]=[]),e[y+s][_+l]=J):e[at({c:_+l,r:y+s})]=J,f.e.c<_+l&&(f.e.c=_+l),_+=S}}++y}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),f.e.r=Math.max(f.e.r,y-1+s),e["!ref"]=ut(f),y>=d&&(e["!fullref"]=ut((f.e.r=u.length-v+y-1+s,f))),e}function mk(e,t){var r=t||{},n=r.dense?[]:{};return xk(n,e,t)}function fM(e,t){return mi(mk(e,t),t)}function k2(e){var t="",r=pM(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function pM(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function xM(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Nt(t.replace(/<[^>]*>/g,""));return[r]}var T2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function gk(e,t){var r=t||{},n=Wx(e),s=[],l,c,u={name:""},d="",f=0,p,m,g={},b=[],v=r.dense?[]:{},y,N,_={value:""},C="",S=0,E=[],O=-1,F=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},D=0,I={},J=[],Z={},ee=0,ne=0,he=[],Q=1,xe=1,Y=[],le={Names:[]},X={},ve=["",""],K=[],k={},B="",A=0,M=!1,ae=!1,de=0;for(Gc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=Gc.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?v["!ref"]=ut(T):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(v["!fullref"]=v["!ref"],T.e.r=r.sheetRows-1,v["!ref"]=ut(T)),J.length&&(v["!merges"]=J),he.length&&(v["!rows"]=he),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),b.push(p.name),g[p.name]=v,ae=!1):y[0].charAt(y[0].length-2)!=="/"&&(p=st(y[0],!1),O=F=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,v=r.dense?[]:{},J=[],he=[],ae=!0);break;case"table-row-group":y[1]==="/"?--D:++D;break;case"table-row":case"":if(y[1]==="/"){O+=Q,Q=1;break}if(m=st(y[0],!1),m.?O=m.-1:O==-1&&(O=0),Q=+m["number-rows-repeated"]||1,Q<10)for(de=0;de<Q;++de)D>0&&(he[O+de]={level:D});F=-1;break;case"covered-table-cell":y[1]!=="/"&&++F,r.sheetStubs&&(r.dense?(v[O]||(v[O]=[]),v[O][F]={t:"z"}):v[at({r:O,c:F})]={t:"z"}),C="",E=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++F,_=st(y[0],!1),xe=parseInt(_["number-columns-repeated"]||"1",10),N={t:"z",v:null},_.formula&&r.cellFormula!=!1&&(N.f=y2(Nt(_.formula))),(_.||_["value-type"])=="string"&&(N.t="s",N.v=Nt(_["string-value"]||""),r.dense?(v[O]||(v[O]=[]),v[O][F]=N):v[at({r:O,c:F})]=N),F+=xe-1;else if(y[1]!=="/"){++F,C="",S=0,E=[],xe=1;var be=Q?O+Q-1:O;if(F>T.e.c&&(T.e.c=F),F<T.s.c&&(T.s.c=F),O<T.s.r&&(T.s.r=O),be>T.e.r&&(T.e.r=be),_=st(y[0],!1),K=[],k={},N={t:_.||_["value-type"],v:null},r.cellFormula)if(_.formula&&(_.formula=Nt(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(ee=parseInt(_["number-matrix-rows-spanned"],10)||0,ne=parseInt(_["number-matrix-columns-spanned"],10)||0,Z={s:{r:O,c:F},e:{r:O+ee-1,c:F+ne-1}},N.F=ut(Z),Y.push([Z,N.F])),_.formula)N.f=y2(_.formula);else for(de=0;de<Y.length;++de)O>=Y[de][0].s.r&&O<=Y[de][0].e.r&&F>=Y[de][0].s.c&&F<=Y[de][0].e.c&&(N.F=Y[de][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(ee=parseInt(_["number-rows-spanned"],10)||0,ne=parseInt(_["number-columns-spanned"],10)||0,Z={s:{r:O,c:F},e:{r:O+ee-1,c:F+ne-1}},J.push(Z)),_["number-columns-repeated"]&&(xe=parseInt(_["number-columns-repeated"],10)),N.t){case"boolean":N.t="b",N.v=$t(_["boolean-value"]);break;case"float":N.t="n",N.v=parseFloat(_.value);break;case"percentage":N.t="n",N.v=parseFloat(_.value);break;case"currency":N.t="n",N.v=parseFloat(_.value);break;case"date":N.t="d",N.v=Wt(_["date-value"]),r.cellDates||(N.t="n",N.v=jr(N.v)),N.z="m/d/yy";break;case"time":N.t="n",N.v=V5(_["time-value"])/86400,r.cellDates&&(N.t="d",N.v=Kh(N.v)),N.z="HH:MM:SS";break;case"number":N.t="n",N.v=parseFloat(_.);break;default:if(N.t==="string"||N.t==="text"||!N.t)N.t="s",_["string-value"]!=null&&(C=Nt(_["string-value"]),E=[]);else throw new Error("Unsupported value type "+N.t)}}else{if(M=!1,N.t==="s"&&(N.v=C||"",E.length&&(N.R=E),M=S==0),X.Target&&(N.l=X),K.length>0&&(N.c=K,K=[]),C&&r.cellText!==!1&&(N.w=C),M&&(N.t="z",delete N.v),(!M||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=O))for(var we=0;we<Q;++we){if(xe=parseInt(_["number-columns-repeated"]||"1",10),r.dense)for(v[O+we]||(v[O+we]=[]),v[O+we][F]=we==0?N:Gt(N);--xe>0;)v[O+we][F+xe]=Gt(N);else for(v[at({r:O+we,c:F})]=N;--xe>0;)v[at({r:O+we,c:F+xe})]=Gt(N);T.e.c<=F&&(T.e.c=F)}xe=parseInt(_["number-columns-repeated"]||"1",10),F+=xe-1,xe=0,N={},C="",E=[]}X={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((l=s.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((l=s.pop())[0]!==y[3])throw"Bad state: "+l;k.t=C,E.length&&(k.R=E),k.a=B,K.push(k)}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);B="",A=0,C="",S=0,E=[];break;case"creator":y[1]==="/"?B=n.slice(A,y.index):A=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((l=s.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);C="",S=0,E=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(I[u.name]=d,(l=s.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&(d="",u=st(y[0],!1),s.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":c=st(y[0],!1),d+=T2[y[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":c=st(y[0],!1),d+=T2[y[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":d+=n.slice(f,y.index);break}else f=y.index+y[0].length;break;case"named-range":c=st(y[0],!1),ve=up(c["cell-range-address"]);var ye={Name:c.name,Ref:ve[0]+"!"+ve[1]};ae&&(ye.Sheet=b.length),le.Names.push(ye);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(y[1]==="/"&&(!_||!_["string-value"])){var Je=xM(n.slice(S,y.index));C=(C.length>0?C+`
`:"")+Je[0]}else st(y[0],!1),S=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{ve=up(st(y[0])["target-range-address"]),g[ve[0]]["!autofilter"]={ref:ve[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(X=st(y[0],!1),!X.href)break;X.Target=Nt(X.href),delete X.href,X.Target.charAt(0)=="#"&&X.Target.indexOf(".")>-1?(ve=up(X.Target.slice(1)),X.Target="#"+ve[0]+"!"+ve[1]):X.Target.match(/^\.\.[\\\/]/)&&(X.Target=X.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var G={Sheets:g,SheetNames:b,Workbook:le};return r.bookSheets&&delete G.Sheets,G}function j2(e,t){t=t||{},Yn(e,"META-INF/manifest.xml")&&VF(vr(e,"META-INF/manifest.xml"),t);var r=In(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=gk(Ot(r),t);return Yn(e,"meta.xml")&&(n.Props=oN(vr(e,"meta.xml"))),n}function _2(e,t){return gk(e,t)}var mM=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Wc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return xr+t}})(),S2=(function(){var e=function(l){return Dt(l).replace(/  +/g,function(c){return'<text:s text:c="'+c.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(l,c,u){var d=[];d.push('      <table:table table:name="'+Dt(c.SheetNames[u])+`" table:style-name="ta1">
`);var f=0,p=0,m=_n(l["!ref"]||"A1"),g=l["!merges"]||[],b=0,v=Array.isArray(l);if(l["!cols"])for(p=0;p<=m.e.c;++p)d.push("        <table:table-column"+(l["!cols"][p]?' table:style-name="co'+l["!cols"][p].ods+'"':"")+`></table:table-column>
`);var y="",N=l["!rows"]||[];for(f=0;f<m.s.r;++f)y=N[f]?' table:style-name="ro'+N[f].ods+'"':"",d.push("        <table:table-row"+y+`></table:table-row>
`);for(;f<=m.e.r;++f){for(y=N[f]?' table:style-name="ro'+N[f].ods+'"':"",d.push("        <table:table-row"+y+`>
`),p=0;p<m.s.c;++p)d.push(t);for(;p<=m.e.c;++p){var _=!1,C={},S="";for(b=0;b!=g.length;++b)if(!(g[b].s.c>p)&&!(g[b].s.r>f)&&!(g[b].e.c<p)&&!(g[b].e.r<f)){(g[b].s.c!=p||g[b].s.r!=f)&&(_=!0),C["table:number-columns-spanned"]=g[b].e.c-g[b].s.c+1,C["table:number-rows-spanned"]=g[b].e.r-g[b].s.r+1;break}if(_){d.push(r);continue}var E=at({r:f,c:p}),O=v?(l[f]||[])[p]:l[E];if(O&&O.f&&(C["table:formula"]=Dt(RO(O.f)),O.F&&O.F.slice(0,E.length)==E)){var F=_n(O.F);C["table:number-matrix-columns-spanned"]=F.e.c-F.s.c+1,C["table:number-matrix-rows-spanned"]=F.e.r-F.s.r+1}if(!O){d.push(t);continue}switch(O.t){case"b":S=O.v?"TRUE":"FALSE",C["office:value-type"]="boolean",C["office:boolean-value"]=O.v?"true":"false";break;case"n":S=O.w||String(O.v||0),C["office:value-type"]="float",C["office:value"]=O.v||0;break;case"s":case"str":S=O.v==null?"":O.v,C["office:value-type"]="string";break;case"d":S=O.w||Wt(O.v).toISOString(),C["office:value-type"]="date",C["office:date-value"]=Wt(O.v).toISOString(),C["table:style-name"]="ce1";break;default:d.push(t);continue}var T=e(S);if(O.l&&O.l.Target){var D=O.l.Target;D=D.charAt(0)=="#"?"#"+IO(D.slice(1)):D,D.charAt(0)!="#"&&!D.match(/^\w+:/)&&(D="../"+D),T=Ie("text:a",T,{"xlink:href":D.replace(/&/g,"&amp;")})}d.push("          "+Ie("table:table-cell",Ie("text:p",T,{}),C)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},s=function(l,c){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var u=0;c.SheetNames.map(function(f){return c.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var p=0;p<f["!cols"].length;++p)if(f["!cols"][p]){var m=f["!cols"][p];if(m.width==null&&m.wpx==null&&m.wch==null)continue;ci(m),m.ods=u;var g=f["!cols"][p].wpx+"px";l.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),l.push(`  </style:style>
`),++u}}});var d=0;c.SheetNames.map(function(f){return c.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var p=0;p<f["!rows"].length;++p)if(f["!rows"][p]){f["!rows"][p].ods=d;var m=f["!rows"][p].hpx+"px";l.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),l.push(`  </style:style>
`),++d}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(c,u){var d=[xr],f=Wc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=Wc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(d.push("<office:document"+f+p+`>
`),d.push(lN().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+f+`>
`),s(d,c),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var m=0;m!=c.SheetNames.length;++m)d.push(n(c.Sheets[c.SheetNames[m]],c,m));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),u.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}})();function vk(e,t){if(t.bookType=="fods")return S2(e,t);var r=Vx(),n="",s=[],l=[];return n="mimetype",dt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",dt(r,n,S2(e,t)),s.push([n,"text/xml"]),l.push([n,"ContentFile"]),n="styles.xml",dt(r,n,mM(e,t)),s.push([n,"text/xml"]),l.push([n,"StylesFile"]),n="meta.xml",dt(r,n,xr+lN()),s.push([n,"text/xml"]),l.push([n,"MetadataFile"]),n="manifest.rdf",dt(r,n,$F(l)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",dt(r,n,zF(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function cl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ax(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ot(xi(e))}function gM(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Rn(Ma(e))}function vM(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function hi(e){var t=e.reduce(function(s,l){return s+l.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function C2(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function yM(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function bM(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var l=0;s>=1;++l,s/=256)e[t+l]=s&255;e[t+15]|=r>=0?0:128}function eu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ft(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function sr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function _t(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=eu(e,r),l=s&7;s=Math.floor(s/8);var c=0,u;if(s==0)break;switch(l){case 0:{for(var d=r[0];e[r[0]++]>=128;);u=e.slice(d,r[0])}break;case 5:c=4,u=e.slice(r[0],r[0]+c),r[0]+=c;break;case 1:c=8,u=e.slice(r[0],r[0]+c),r[0]+=c;break;case 2:c=eu(e,r),u=e.slice(r[0],r[0]+c),r[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(s," at offset ").concat(n))}var f={data:u,type:l};t[s]==null?t[s]=[f]:t[s].push(f)}return t}function Br(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(Ft(n*8+s.type)),s.type==2&&t.push(Ft(s.data.length)),t.push(s.data))})}),hi(t)}function mm(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Xn(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=eu(e,n),l=_t(e.slice(n[0],n[0]+s));n[0]+=s;var c={id:sr(l[1][0].data),messages:[]};l[2].forEach(function(u){var d=_t(u.data),f=sr(d[3][0].data);c.messages.push({meta:d,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=l[3])!=null&&t[0]&&(c.merge=sr(l[3][0].data)>>>0>0),r.push(c)}return r}function Xl(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Ft(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ft(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(c){s.push(c.data),c.meta[3]=[{type:0,data:Ft(c.data.length)}],n[2].push({data:Br(c.meta),type:2})});var l=Br(n);t.push(Ft(l.length)),t.push(l),s.forEach(function(c){return t.push(c)})}),hi(t)}function wM(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=eu(t,r),s=[];r[0]<t.length;){var l=t[r[0]]&3;if(l==0){var c=t[r[0]++]>>2;if(c<60)++c;else{var u=c-59;c=t[r[0]],u>1&&(c|=t[r[0]+1]<<8),u>2&&(c|=t[r[0]+2]<<16),u>3&&(c|=t[r[0]+3]<<24),c>>>=0,c++,r[0]+=u}s.push(t.slice(r[0],r[0]+c)),r[0]+=c;continue}else{var d=0,f=0;if(l==1?(f=(t[r[0]]>>2&7)+4,d=(t[r[0]++]&224)<<3,d|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,l==2?(d=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(d=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[hi(s)],d==0)throw new Error("Invalid offset 0");if(d>s[0].length)throw new Error("Invalid offset beyond length");if(f>=d)for(s.push(s[0].slice(-d)),f-=d;f>=s[s.length-1].length;)s.push(s[s.length-1]),f-=s[s.length-1].length;s.push(s[0].slice(-d,-d+f))}}var p=hi(s);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function Qn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(wM(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return hi(t)}function Ql(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var l=Ft(n),c=l.length;t.push(l),n<=60?(c++,t.push(new Uint8Array([n-1<<2]))):n<=256?(c+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(c+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(c+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(c+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),c+=n,s[0]=0,s[1]=c&255,s[2]=c>>8&255,s[3]=c>>16&255,r+=n}return hi(t)}function NM(e,t,r,n){var s=cl(e),l=s.getUint32(4,!0),c=(n>1?12:8)+C2(l&(n>1?3470:398))*4,u=-1,d=-1,f=NaN,p=new Date(2001,0,1);l&512&&(u=s.getUint32(c,!0),c+=4),c+=C2(l&(n>1?12288:4096))*4,l&16&&(d=s.getUint32(c,!0),c+=4),l&32&&(f=s.getFloat64(c,!0),c+=8),l&64&&(p.setTime(p.getTime()+s.getFloat64(c,!0)*1e3),c+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:t[d]};break;case 5:m={t:"d",v:p};break;case 6:m={t:"b",v:f>0};break;case 7:m={t:"n",v:f/86400};break;case 8:m={t:"e",v:0};break;case 9:if(u>-1)m={t:"s",v:r[u]};else if(d>-1)m={t:"s",v:t[d]};else if(!isNaN(f))m={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function kM(e,t,r){var n=cl(e),s=n.getUint32(8,!0),l=12,c=-1,u=-1,d=NaN,f=NaN,p=new Date(2001,0,1);s&1&&(d=yM(e,l),l+=16),s&2&&(f=n.getFloat64(l,!0),l+=8),s&4&&(p.setTime(p.getTime()+n.getFloat64(l,!0)*1e3),l+=8),s&8&&(u=n.getUint32(l,!0),l+=4),s&16&&(c=n.getUint32(l,!0),l+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:d};break;case 3:m={t:"s",v:t[u]};break;case 5:m={t:"d",v:p};break;case 6:m={t:"b",v:f>0};break;case 7:m={t:"n",v:f/86400};break;case 8:m={t:"e",v:0};break;case 9:if(c>-1)m={t:"s",v:r[c]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return m}function dp(e,t){var r=new Uint8Array(32),n=cl(r),s=12,l=0;switch(r[0]=5,e.t){case"n":r[1]=2,bM(r,s,e.v),l|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),l|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),l|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,l,!0),r.slice(0,s)}function fp(e,t){var r=new Uint8Array(32),n=cl(r),s=12,l=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),l|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),l|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),l|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,l,!0),r.slice(0,s)}function TM(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return NM(e,t,r,e[0]);case 5:return kM(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Gr(e){var t=_t(e);return eu(t[1][0].data)}function E2(e,t){var r=_t(t.data),n=sr(r[1][0].data),s=r[3],l=[];return(s||[]).forEach(function(c){var u=_t(c.data),d=sr(u[1][0].data)>>>0;switch(n){case 1:l[d]=ax(u[3][0].data);break;case 8:{var f=e[Gr(u[9][0].data)][0],p=_t(f.data),m=e[Gr(p[1][0].data)][0],g=sr(m.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var b=_t(m.data);l[d]=b[3].map(function(v){return ax(v.data)}).join("")}break}}),l}function jM(e,t){var r,n,s,l,c,u,d,f,p,m,g,b,v,y,N=_t(e),_=sr(N[1][0].data)>>>0,C=sr(N[2][0].data)>>>0,S=((n=(r=N[8])==null?void 0:r[0])==null?void 0:n.data)&&sr(N[8][0].data)>0||!1,E,O;if((l=(s=N[7])==null?void 0:s[0])!=null&&l.data&&t!=0)E=(u=(c=N[7])==null?void 0:c[0])==null?void 0:u.data,O=(f=(d=N[6])==null?void 0:d[0])==null?void 0:f.data;else if((m=(p=N[4])==null?void 0:p[0])!=null&&m.data&&t!=1)E=(b=(g=N[4])==null?void 0:g[0])==null?void 0:b.data,O=(y=(v=N[3])==null?void 0:v[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var F=S?4:1,T=cl(E),D=[],I=0;I<E.length/2;++I){var J=T.getUint16(I*2,!0);J<65535&&D.push([I,J])}if(D.length!=C)throw"Expected ".concat(C," cells, found ").concat(D.length);var Z=[];for(I=0;I<D.length-1;++I)Z[D[I][0]]=O.subarray(D[I][1]*F,D[I+1][1]*F);return D.length>=1&&(Z[D[D.length-1][0]]=O.subarray(D[D.length-1][1]*F)),{R:_,cells:Z}}function _M(e,t){var r,n=_t(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?sr(n[7][0].data)>>>0>0?1:0:-1,l=mm(n[5],function(c){return jM(c,s)});return{nrows:sr(n[4][0].data)>>>0,data:l.reduce(function(c,u){return c[u.R]||(c[u.R]=[]),u.cells.forEach(function(d,f){if(c[u.R][f])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(f));c[u.R][f]=d}),c},[])}}function SM(e,t,r){var n,s=_t(t.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(sr(s[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(l.e.c=(sr(s[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=ut(l);var c=_t(s[4][0].data),u=E2(e,e[Gr(c[4][0].data)][0]),d=(n=c[17])!=null&&n[0]?E2(e,e[Gr(c[17][0].data)][0]):[],f=_t(c[3][0].data),p=0;f[1].forEach(function(m){var g=_t(m.data),b=e[Gr(g[2][0].data)][0],v=sr(b.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var y=_M(e,b);y.data.forEach(function(N,_){N.forEach(function(C,S){var E=at({r:p+_,c:S}),O=TM(C,u,d);O&&(r[E]=O)})}),p+=y.nrows})}function CM(e,t){var r=_t(t.data),n={"!ref":"A1"},s=e[Gr(r[2][0].data)],l=sr(s[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return SM(e,s[0],n),n}function EM(e,t){var r,n=_t(t.data),s={name:(r=n[1])!=null&&r[0]?ax(n[1][0].data):"",sheets:[]},l=mm(n[2],Gr);return l.forEach(function(c){e[c].forEach(function(u){var d=sr(u.meta[1][0].data);d==6e3&&s.sheets.push(CM(e,u))})}),s}function FM(e,t){var r=Nm(),n=_t(t.data),s=mm(n[1],Gr);if(s.forEach(function(l){e[l].forEach(function(c){var u=sr(c.meta[1][0].data);if(u==2){var d=EM(e,c);d.sheets.forEach(function(f,p){km(r,f,p==0?d.name:d.name+"_"+p,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function pp(e){var t,r,n,s,l={},c=[];if(e.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var f;try{f=Qn(d.content)}catch(m){return console.log("?? "+d.content.length+" "+(m.message||m))}var p;try{p=Xn(f)}catch(m){return console.log("## "+(m.message||m))}p.forEach(function(m){l[m.id]=m.messages,c.push(m.id)})}}),!c.length)throw new Error("File has no messages");var u=((s=(n=(r=(t=l==null?void 0:l[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&sr(l[1][0].meta[1][0].data)==1&&l[1][0];if(u||c.forEach(function(d){l[d].forEach(function(f){var p=sr(f.meta[1][0].data)>>>0;if(p==1)if(!u)u=f;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return FM(l,u)}function AM(e,t,r){var n,s,l,c;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var u=((c=(l=e[8])==null?void 0:l[0])==null?void 0:c.data)&&sr(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var d=0,f=cl(e[7][0].data),p=0,m=[],g=cl(e[4][0].data),b=0,v=[],y=0;y<t.length;++y){if(t[y]==null){f.setUint16(y*2,65535,!0),g.setUint16(y*2,65535);continue}f.setUint16(y*2,p,!0),g.setUint16(y*2,b,!0);var N,_;switch(typeof t[y]){case"string":N=dp({t:"s",v:t[y]},r),_=fp({t:"s",v:t[y]},r);break;case"number":N=dp({t:"n",v:t[y]},r),_=fp({t:"n",v:t[y]},r);break;case"boolean":N=dp({t:"b",v:t[y]},r),_=fp({t:"b",v:t[y]},r);break;default:throw new Error("Unsupported value "+t[y])}m.push(N),p+=N.length,v.push(_),b+=_.length,++d}for(e[2][0].data=Ft(d);y<e[7][0].data.length/2;++y)f.setUint16(y*2,65535,!0),g.setUint16(y*2,65535,!0);return e[6][0].data=hi(m),e[3][0].data=hi(v),d}function DM(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=_n(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(ut(n)));var l=_h(r,{range:n,header:1}),c=["~Sh33tJ5~"];l.forEach(function(B){return B.forEach(function(A){typeof A=="string"&&c.push(A)})});var u={},d=[],f=Ye.read(t.numbers,{type:"base64"});f.FileIndex.map(function(B,A){return[B,f.FullPaths[A]]}).forEach(function(B){var A=B[0],M=B[1];if(A.type==2&&A.name.match(/\.iwa/)){var ae=A.content,de=Qn(ae),be=Xn(de);be.forEach(function(we){d.push(we.id),u[we.id]={deps:[],location:M,type:sr(we.messages[0].meta[1][0].data)}})}}),d.sort(function(B,A){return B-A});var p=d.filter(function(B){return B>1}).map(function(B){return[B,Ft(B)]});f.FileIndex.map(function(B,A){return[B,f.FullPaths[A]]}).forEach(function(B){var A=B[0];if(B[1],!!A.name.match(/\.iwa/)){var M=Xn(Qn(A.content));M.forEach(function(ae){ae.messages.forEach(function(de){p.forEach(function(be){ae.messages.some(function(we){return sr(we.meta[1][0].data)!=11006&&vM(we.data,be[1])})&&u[be[0]].deps.push(ae.id)})})})}});for(var m=Ye.find(f,u[1].location),g=Xn(Qn(m.content)),b,v=0;v<g.length;++v){var y=g[v];y.id==1&&(b=y)}var N=Gr(_t(b.messages[0].data)[1][0].data);for(m=Ye.find(f,u[N].location),g=Xn(Qn(m.content)),v=0;v<g.length;++v)y=g[v],y.id==N&&(b=y);for(N=Gr(_t(b.messages[0].data)[2][0].data),m=Ye.find(f,u[N].location),g=Xn(Qn(m.content)),v=0;v<g.length;++v)y=g[v],y.id==N&&(b=y);for(N=Gr(_t(b.messages[0].data)[2][0].data),m=Ye.find(f,u[N].location),g=Xn(Qn(m.content)),v=0;v<g.length;++v)y=g[v],y.id==N&&(b=y);var _=_t(b.messages[0].data);{_[6][0].data=Ft(n.e.r+1),_[7][0].data=Ft(n.e.c+1);var C=Gr(_[46][0].data),S=Ye.find(f,u[C].location),E=Xn(Qn(S.content));{for(var O=0;O<E.length&&E[O].id!=C;++O);if(E[O].id!=C)throw"Bad ColumnRowUIDMapArchive";var F=_t(E[O].messages[0].data);F[1]=[],F[2]=[],F[3]=[];for(var T=0;T<=n.e.c;++T){var D=[];D[1]=D[2]=[{type:0,data:Ft(T+420690)}],F[1].push({type:2,data:Br(D)}),F[2].push({type:0,data:Ft(T)}),F[3].push({type:0,data:Ft(T)})}F[4]=[],F[5]=[],F[6]=[];for(var I=0;I<=n.e.r;++I)D=[],D[1]=D[2]=[{type:0,data:Ft(I+726270)}],F[4].push({type:2,data:Br(D)}),F[5].push({type:0,data:Ft(I)}),F[6].push({type:0,data:Ft(I)});E[O].messages[0].data=Br(F)}S.content=Ql(Xl(E)),S.size=S.content.length,delete _[46];var J=_t(_[4][0].data);{J[7][0].data=Ft(n.e.r+1);var Z=_t(J[1][0].data),ee=Gr(Z[2][0].data);S=Ye.find(f,u[ee].location),E=Xn(Qn(S.content));{if(E[0].id!=ee)throw"Bad HeaderStorageBucket";var ne=_t(E[0].messages[0].data);for(I=0;I<l.length;++I){var he=_t(ne[2][0].data);he[1][0].data=Ft(I),he[4][0].data=Ft(l[I].length),ne[2][I]={type:ne[2][0].type,data:Br(he)}}E[0].messages[0].data=Br(ne)}S.content=Ql(Xl(E)),S.size=S.content.length;var Q=Gr(J[2][0].data);S=Ye.find(f,u[Q].location),E=Xn(Qn(S.content));{if(E[0].id!=Q)throw"Bad HeaderStorageBucket";for(ne=_t(E[0].messages[0].data),T=0;T<=n.e.c;++T)he=_t(ne[2][0].data),he[1][0].data=Ft(T),he[4][0].data=Ft(n.e.r+1),ne[2][T]={type:ne[2][0].type,data:Br(he)};E[0].messages[0].data=Br(ne)}S.content=Ql(Xl(E)),S.size=S.content.length;var xe=Gr(J[4][0].data);(function(){for(var B=Ye.find(f,u[xe].location),A=Xn(Qn(B.content)),M,ae=0;ae<A.length;++ae){var de=A[ae];de.id==xe&&(M=de)}var be=_t(M.messages[0].data);{be[3]=[];var we=[];c.forEach(function(G,Ne){we[1]=[{type:0,data:Ft(Ne)}],we[2]=[{type:0,data:Ft(1)}],we[3]=[{type:2,data:gM(G)}],be[3].push({type:2,data:Br(we)})})}M.messages[0].data=Br(be);var ye=Xl(A),Je=Ql(ye);B.content=Je,B.size=B.content.length})();var Y=_t(J[3][0].data);{var le=Y[1][0];delete Y[2];var X=_t(le.data);{var ve=Gr(X[2][0].data);(function(){for(var B=Ye.find(f,u[ve].location),A=Xn(Qn(B.content)),M,ae=0;ae<A.length;++ae){var de=A[ae];de.id==ve&&(M=de)}var be=_t(M.messages[0].data);{delete be[6],delete Y[7];var we=new Uint8Array(be[5][0].data);be[5]=[];for(var ye=0,Je=0;Je<=n.e.r;++Je){var G=_t(we);ye+=AM(G,l[Je],c),G[1][0].data=Ft(Je),be[5].push({data:Br(G),type:2})}be[1]=[{type:0,data:Ft(n.e.c+1)}],be[2]=[{type:0,data:Ft(n.e.r+1)}],be[3]=[{type:0,data:Ft(ye)}],be[4]=[{type:0,data:Ft(n.e.r+1)}]}M.messages[0].data=Br(be);var Ne=Xl(A),He=Ql(Ne);B.content=He,B.size=B.content.length})()}le.data=Br(X)}J[3][0].data=Br(Y)}_[4][0].data=Br(J)}b.messages[0].data=Br(_);var K=Xl(g),k=Ql(K);return m.content=k,m.size=m.content.length,f}function yk(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function gm(e){yk([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function vm(e){yk([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function PM(e){return gt.WS.indexOf(e)>-1?"sheet":e==gt.CS?"chart":e==gt.DS?"dialog":e==gt.MS?"macro":e&&e.length?e:"sheet"}function LM(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,PM(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function OM(e,t,r,n,s,l,c,u,d,f,p,m){try{l[n]=Dc(In(e,r,!0),t);var g=vr(e,t),b;switch(u){case"sheet":b=n7(g,t,s,d,l[n],f,p,m);break;case"chart":if(b=a7(g,t,s,d,l[n],f,p,m),!b||!b["!drawel"])break;var v=Tc(b["!drawel"].Target,t),y=qc(v),N=KP(In(e,v,!0),Dc(In(e,y,!0),v)),_=Tc(N,v),C=qc(_);b=AI(In(e,_,!0),_,d,Dc(In(e,C,!0),_),f,b);break;case"macro":b=s7(g,t,s,d,l[n],f,p,m);break;case"dialog":b=i7(g,t,s,d,l[n],f,p,m);break;default:throw new Error("Unrecognized sheet type "+u)}c[n]=b;var S=[];l&&l[n]&&ir(l[n]).forEach(function(E){var O="";if(l[n][E].Type==gt.CMNT){O=Tc(l[n][E].Target,t);var F=u7(vr(e,O,!0),O,d);if(!F||!F.length)return;p2(b,F,!1)}l[n][E].Type==gt.TCMNT&&(O=Tc(l[n][E].Target,t),S=S.concat(WP(vr(e,O,!0),d)))}),S&&S.length&&p2(b,S,!0,d.people||[])}catch(E){if(d.WTF)throw E}}function Gn(e){return e.charAt(0)=="/"?e.slice(1):e}function bk(e,t){if(Ao(),t=t||{},gm(t),Yn(e,"META-INF/manifest.xml")||Yn(e,"objectdata.xml"))return j2(e,t);if(Yn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof pp<"u"){if(e.FileIndex)return pp(e);var r=Ye.utils.cfb_new();return Oy(e).forEach(function(he){dt(r,he,G5(e,he))}),pp(r)}throw new Error("Unsupported NUMBERS file")}if(!Yn(e,"[Content_Types].xml"))throw Yn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Yn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Oy(e),s=HF(In(e,"[Content_Types].xml")),l=!1,c,u;if(s.workbooks.length===0&&(u="xl/workbook.xml",vr(e,u,!0)&&s.workbooks.push(u)),s.workbooks.length===0){if(u="xl/workbook.bin",!vr(e,u,!0))throw new Error("Could not find workbook");s.workbooks.push(u),l=!0}s.workbooks[0].slice(-3)=="bin"&&(l=!0);var d={},f={};if(!t.bookSheets&&!t.bookProps){if(Pc=[],s.sst)try{Pc=c7(vr(e,Gn(s.sst)),s.sst,t)}catch(he){if(t.WTF)throw he}t.cellStyles&&s.themes.length&&(d=o7(In(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(f=l7(vr(e,Gn(s.style)),s.style,d,t))}s.links.map(function(he){try{var Q=Dc(In(e,qc(Gn(he))),he);return d7(vr(e,Gn(he)),Q,he,t)}catch{}});var p=r7(vr(e,Gn(s.workbooks[0])),s.workbooks[0],t),m={},g="";s.coreprops.length&&(g=vr(e,Gn(s.coreprops[0]),!0),g&&(m=oN(g)),s.extprops.length!==0&&(g=vr(e,Gn(s.extprops[0]),!0),g&&GF(g,m,t)));var b={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(g=In(e,Gn(s.custprops[0]),!0),g&&(b=XF(g,t)));var v={};if((t.bookSheets||t.bookProps)&&(p.Sheets?c=p.Sheets.map(function(Q){return Q.name}):m.Worksheets&&m.SheetNames.length>0&&(c=m.SheetNames),t.bookProps&&(v.Props=m,v.Custprops=b),t.bookSheets&&typeof c<"u"&&(v.SheetNames=c),t.bookSheets?v.SheetNames:t.bookProps))return v;c={};var y={};t.bookDeps&&s.calcchain&&(y=h7(vr(e,Gn(s.calcchain)),s.calcchain));var N=0,_={},C,S;{var E=p.Sheets;m.Worksheets=E.length,m.SheetNames=[];for(var O=0;O!=E.length;++O)m.SheetNames[O]=E[O].name}var F=l?"bin":"xml",T=s.workbooks[0].lastIndexOf("/"),D=(s.workbooks[0].slice(0,T+1)+"_rels/"+s.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");Yn(e,D)||(D="xl/_rels/workbook."+F+".rels");var I=Dc(In(e,D,!0),D.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=f7(vr(e,Gn(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=qP(vr(e,Gn(s.people[0])),t)),I&&(I=LM(I,p.Sheets));var J=vr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(N=0;N!=m.Worksheets;++N){var Z="sheet";if(I&&I[N]?(C="xl/"+I[N][1].replace(/[\/]?xl\//,""),Yn(e,C)||(C=I[N][1]),Yn(e,C)||(C=D.replace(/_rels\/.*$/,"")+I[N][1]),Z=I[N][2]):(C="xl/worksheets/sheet"+(N+1-J)+"."+F,C=C.replace(/sheet0\./,"sheet.")),S=C.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(N!=t.sheets)continue e;break;case"string":if(m.SheetNames[N].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var ee=!1,ne=0;ne!=t.sheets.length;++ne)typeof t.sheets[ne]=="number"&&t.sheets[ne]==N&&(ee=1),typeof t.sheets[ne]=="string"&&t.sheets[ne].toLowerCase()==m.SheetNames[N].toLowerCase()&&(ee=1);if(!ee)continue e}}OM(e,C,S,m.SheetNames[N],N,_,c,Z,t,p,d,f)}return v={Directory:s,Workbook:p,Props:m,Custprops:b,Deps:y,Sheets:c,SheetNames:m.SheetNames,Strings:Pc,Styles:f,Themes:d,SSF:Gt(nt)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(he,Q){he=he.replace(/^Root Entry[\/]/,""),v.keys.push(he),v.files[he]=e.FileIndex[Q]}))),t&&t.bookVBA&&(s.vba.length>0?v.vbaraw=vr(e,Gn(s.vba[0]),!0):s.defaults&&s.defaults.bin===rL&&(v.vbaraw=vr(e,"xl/vbaProject.bin",!0))),v}function RM(e,t){var r=t||{},n="Workbook",s=Ye.find(e,n);try{if(n="/!DataSpaces/Version",s=Ye.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(fD(s.content),n="/!DataSpaces/DataSpaceMap",s=Ye.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=xD(s.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Ye.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=mD(s.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Ye.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);vD(s.content)}catch{}if(n="/EncryptionInfo",s=Ye.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=yD(s.content);if(n="/EncryptedPackage",s=Ye.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],s.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function IM(e,t){return t.bookType=="ods"?vk(e,t):t.bookType=="numbers"?DM(e,t):t.bookType=="xlsb"?MM(e,t):BM(e,t)}function MM(e,t){Jl=1024,e&&!e.SSF&&(e.SSF=Gt(nt)),e&&e.SSF&&(Ao(),Uh(e.SSF),t.revssf=zh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Lc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=GN.indexOf(t.bookType)>-1,s=rm();vm(t=t||{});var l=Vx(),c="",u=0;if(t.cellXfs=[],gi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),c="docProps/core.xml",dt(l,c,cN(e.Props,t)),s.coreprops.push(c),At(t.rels,2,c,gt.CORE_PROPS),c="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&d.push(e.SheetNames[f]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,dt(l,c,dN(e.Props)),s.extprops.push(c),At(t.rels,3,c,gt.EXT_PROPS),e.Custprops!==e.Props&&ir(e.Custprops||{}).length>0&&(c="docProps/custom.xml",dt(l,c,fN(e.Custprops)),s.custprops.push(c),At(t.rels,4,c,gt.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var p={"!id":{}},m=e.Sheets[e.SheetNames[u-1]],g=(m||{})["!type"]||"sheet";switch(g){case"chart":default:c="xl/worksheets/sheet"+u+"."+r,dt(l,c,x7(u-1,c,t,e,p)),s.sheets.push(c),At(t.wbrels,-1,"worksheets/sheet"+u+"."+r,gt.WS[0])}if(m){var b=m["!comments"],v=!1,y="";b&&b.length>0&&(y="xl/comments"+u+"."+r,dt(l,y,v7(b,y)),s.comments.push(y),At(p,-1,"../comments"+u+"."+r,gt.CMNT),v=!0),m["!legacy"]&&v&&dt(l,"xl/drawings/vmlDrawing"+u+".vml",$N(u,m["!comments"])),delete m["!comments"],delete m["!legacy"]}p["!id"].rId1&&dt(l,qc(c),to(p))}return t.Strings!=null&&t.Strings.length>0&&(c="xl/sharedStrings."+r,dt(l,c,g7(t.Strings,c,t)),s.strs.push(c),At(t.wbrels,-1,"sharedStrings."+r,gt.SST)),c="xl/workbook."+r,dt(l,c,p7(e,c)),s.workbooks.push(c),At(t.rels,1,c,gt.WB),c="xl/theme/theme1.xml",dt(l,c,om(e.Themes,t)),s.themes.push(c),At(t.wbrels,-1,"theme/theme1.xml",gt.THEME),c="xl/styles."+r,dt(l,c,m7(e,c,t)),s.styles.push(c),At(t.wbrels,-1,"styles."+r,gt.STY),e.vbaraw&&n&&(c="xl/vbaProject.bin",dt(l,c,e.vbaraw),s.vba.push(c),At(t.wbrels,-1,"vbaProject.bin",gt.VBA)),c="xl/metadata."+r,dt(l,c,y7(c)),s.metadata.push(c),At(t.wbrels,-1,"metadata."+r,gt.XLMETA),dt(l,"[Content_Types].xml",iN(s,t)),dt(l,"_rels/.rels",to(t.rels)),dt(l,"xl/_rels/workbook."+r+".rels",to(t.wbrels)),delete t.revssf,delete t.ssf,l}function BM(e,t){Jl=1024,e&&!e.SSF&&(e.SSF=Gt(nt)),e&&e.SSF&&(Ao(),Uh(e.SSF),t.revssf=zh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Lc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=GN.indexOf(t.bookType)>-1,s=rm();vm(t=t||{});var l=Vx(),c="",u=0;if(t.cellXfs=[],gi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),c="docProps/core.xml",dt(l,c,cN(e.Props,t)),s.coreprops.push(c),At(t.rels,2,c,gt.CORE_PROPS),c="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&d.push(e.SheetNames[f]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,dt(l,c,dN(e.Props)),s.extprops.push(c),At(t.rels,3,c,gt.EXT_PROPS),e.Custprops!==e.Props&&ir(e.Custprops||{}).length>0&&(c="docProps/custom.xml",dt(l,c,fN(e.Custprops)),s.custprops.push(c),At(t.rels,4,c,gt.CUST_PROPS));var p=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var m={"!id":{}},g=e.Sheets[e.SheetNames[u-1]],b=(g||{})["!type"]||"sheet";switch(b){case"chart":default:c="xl/worksheets/sheet"+u+"."+r,dt(l,c,ak(u-1,t,e,m)),s.sheets.push(c),At(t.wbrels,-1,"worksheets/sheet"+u+"."+r,gt.WS[0])}if(g){var v=g["!comments"],y=!1,N="";if(v&&v.length>0){var _=!1;v.forEach(function(C){C[1].forEach(function(S){S.T==!0&&(_=!0)})}),_&&(N="xl/threadedComments/threadedComment"+u+"."+r,dt(l,N,GP(v,p,t)),s.threadedcomments.push(N),At(m,-1,"../threadedComments/threadedComment"+u+"."+r,gt.TCMNT)),N="xl/comments"+u+"."+r,dt(l,N,WN(v)),s.comments.push(N),At(m,-1,"../comments"+u+"."+r,gt.CMNT),y=!0}g["!legacy"]&&y&&dt(l,"xl/drawings/vmlDrawing"+u+".vml",$N(u,g["!comments"])),delete g["!comments"],delete g["!legacy"]}m["!id"].rId1&&dt(l,qc(c),to(m))}return t.Strings!=null&&t.Strings.length>0&&(c="xl/sharedStrings."+r,dt(l,c,PN(t.Strings,t)),s.strs.push(c),At(t.wbrels,-1,"sharedStrings."+r,gt.SST)),c="xl/workbook."+r,dt(l,c,ck(e)),s.workbooks.push(c),At(t.rels,1,c,gt.WB),c="xl/theme/theme1.xml",dt(l,c,om(e.Themes,t)),s.themes.push(c),At(t.wbrels,-1,"theme/theme1.xml",gt.THEME),c="xl/styles."+r,dt(l,c,UN(e,t)),s.styles.push(c),At(t.wbrels,-1,"styles."+r,gt.STY),e.vbaraw&&n&&(c="xl/vbaProject.bin",dt(l,c,e.vbaraw),s.vba.push(c),At(t.wbrels,-1,"vbaProject.bin",gt.VBA)),c="xl/metadata."+r,dt(l,c,KN()),s.metadata.push(c),At(t.wbrels,-1,"metadata."+r,gt.XLMETA),p.length>1&&(c="xl/persons/person.xml",dt(l,c,XP(p)),s.people.push(c),At(t.wbrels,-1,"persons/person.xml",gt.PEOPLE)),dt(l,"[Content_Types].xml",iN(s,t)),dt(l,"_rels/.rels",to(t.rels)),dt(l,"xl/_rels/workbook."+r+".rels",to(t.wbrels)),delete t.revssf,delete t.ssf,l}function ym(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Bn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function HM(e,t){return Ye.find(e,"EncryptedPackage")?RM(e,t):xm(e,t)}function UM(e,t){var r,n=e,s=t||{};return s.type||(s.type=xt&&Buffer.isBuffer(e)?"buffer":"base64"),r=Ow(n,s),bk(r,s)}function wk(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return rx(e.slice(r),t);default:break e}return ko.to_workbook(e,t)}function VM(e,t){var r="",n=ym(e,t);switch(t.type){case"base64":r=Bn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=sl(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ot(r)),t.type="binary",wk(r,t)}function zM(e,t){var r=e;return t.type=="base64"&&(r=Bn(r)),r=Vc.utils.decode(1200,r.slice(2),"str"),t.type="binary",wk(r,t)}function KM(e){return e.match(/[^\x00-\x7F]/)?Ma(e):e}function xp(e,t,r,n){return n?(r.type="string",ko.to_workbook(e,r)):ko.to_workbook(t,r)}function sx(e,t){Ix();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return sx(new Uint8Array(e),(r=Gt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],l=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),no={},r.dateNF&&(no.dateNF=r.dateNF),r.type||(r.type=xt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=xt?"buffer":"binary",n=B5(e),typeof Uint8Array<"u"&&!xt&&(r.type="array")),r.type=="string"&&(l=!0,r.type="binary",r.codepage=65001,n=KM(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),u=new Uint8Array(c);if(u.foo="bar",!u.foo)return r=Gt(r),r.type="array",sx(Mx(n),r)}switch((s=ym(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return HM(Ye.read(n,r),r);break;case 9:if(s[1]<=8)return xm(n,r);break;case 60:return rx(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return Q8(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return AN.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?UM(n,r):xp(e,n,r,l);case 239:return s[3]===60?rx(n,r):xp(e,n,r,l);case 255:if(s[1]===254)return zM(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Ji.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Ji.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return tx.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return MN.to_workbook(n,r);break;case 10:case 13:case 32:return VM(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return X8.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?tx.to_workbook(n,r):xp(e,n,r,l)}function Nk(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return fu(t.file,Ye.write(e,{type:xt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ye.write(e,t)}function $M(e,t){var r=Gt(t||{}),n=IM(e,r);return WM(n,r)}function WM(e,t){var r={},n=xt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Ye.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Hh(s))}return t.password&&typeof encrypt_agile<"u"?Nk(encrypt_agile(s,t.password),t):t.type==="file"?fu(t.file,s):t.type=="string"?Ot(s):s}function GM(e,t){var r=t||{},n=$7(e,r);return Nk(n,r)}function Pa(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return zc(Ma(n));case"binary":return Ma(n);case"string":return e;case"file":return fu(t.file,n,"utf8");case"buffer":return xt?ms(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Pa(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function qM(e,t){switch(t.type){case"base64":return zc(e);case"binary":return e;case"string":return e;case"file":return fu(t.file,e,"binary");case"buffer":return xt?ms(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function G0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?zc(r):t.type=="string"?Ot(r):r;case"file":return fu(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function bm(e,t){Ix(),UI(e);var r=Gt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=bm(e,r);return r.type="array",Hh(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Pa(M7(e,r),r);case"slk":case"sylk":return Pa(FN.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Pa(pk(e.Sheets[e.SheetNames[s]],r),r);case"txt":return qM(kk(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Pa(wm(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Pa(AN.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return G0(tx.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Pa(ko.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Pa(MN.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Pa(DN.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Pa(vk(e,r),r);case"wk1":return G0(Ji.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return G0(Ji.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),G0(fk(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),GM(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return $M(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function XM(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function jh(e,t,r){var n={};return n.type="file",n.file=t,XM(n),bm(e,n)}function QM(e,t,r,n,s,l,c,u){var d=pr(r),f=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),m=!0,g=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!c||e[r])for(var b=t.s.c;b<=t.e.c;++b){var v=c?e[r][b]:e[n[b]+d];if(v===void 0||v.t===void 0){if(f===void 0)continue;l[b]!=null&&(g[l[b]]=f);continue}var y=v.v;switch(v.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(l[b]!=null){if(y==null)if(v.t=="e"&&y===null)g[l[b]]=null;else if(f!==void 0)g[l[b]]=f;else if(p&&y===null)g[l[b]]=null;else continue;else g[l[b]]=p&&(v.t!=="n"||v.t==="n"&&u.rawNumbers!==!1)?y:xs(v,y,u);y!=null&&(m=!1)}}return{row:g,isempty:m}}function _h(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,l=[],c=0,u="",d={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},p=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof p){case"string":d=kt(p);break;case"number":d=kt(e["!ref"]),d.s.r=p;break;default:d=p}n>0&&(s=0);var m=pr(d.s.r),g=[],b=[],v=0,y=0,N=Array.isArray(e),_=d.s.r,C=0,S={};N&&!e[_]&&(e[_]=[]);var E=f.skipHidden&&e["!cols"]||[],O=f.skipHidden&&e["!rows"]||[];for(C=d.s.c;C<=d.e.c;++C)if(!(E[C]||{}).hidden)switch(g[C]=er(C),r=N?e[_][C]:e[g[C]+m],n){case 1:l[C]=C-d.s.c;break;case 2:l[C]=g[C];break;case 3:l[C]=f.header[C-d.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=c=xs(r,null,f),y=S[c]||0,!y)S[c]=1;else{do u=c+"_"+y++;while(S[u]);S[c]=y,S[u]=1}l[C]=u}for(_=d.s.r+s;_<=d.e.r;++_)if(!(O[_]||{}).hidden){var F=QM(e,d,_,g,n,l,N,f);(F.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(b[v++]=F.row)}return b.length=v,b}var F2=/"/g;function YM(e,t,r,n,s,l,c,u){for(var d=!0,f=[],p="",m=pr(r),g=t.s.c;g<=t.e.c;++g)if(n[g]){var b=u.dense?(e[r]||[])[g]:e[n[g]+m];if(b==null)p="";else if(b.v!=null){d=!1,p=""+(u.rawNumbers&&b.t=="n"?b.v:xs(b,null,u));for(var v=0,y=0;v!==p.length;++v)if((y=p.charCodeAt(v))===s||y===l||y===34||u.forceQuotes){p='"'+p.replace(F2,'""')+'"';break}p=="ID"&&(p='"ID"')}else b.f!=null&&!b.F?(d=!1,p="="+b.f,p.indexOf(",")>=0&&(p='"'+p.replace(F2,'""')+'"')):p="";f.push(p)}return u.blankrows===!1&&d?null:f.join(c)}function wm(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=kt(e["!ref"]),l=n.FS!==void 0?n.FS:",",c=l.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,d=u.charCodeAt(0),f=new RegExp((l=="|"?"\\|":l)+"+$"),p="",m=[];n.dense=Array.isArray(e);for(var g=n.skipHidden&&e["!cols"]||[],b=n.skipHidden&&e["!rows"]||[],v=s.s.c;v<=s.e.c;++v)(g[v]||{}).hidden||(m[v]=er(v));for(var y=0,N=s.s.r;N<=s.e.r;++N)(b[N]||{}).hidden||(p=YM(e,s,N,m,c,d,l,n),p!=null&&(n.strip&&(p=p.replace(f,"")),(p||n.blankrows!==!1)&&r.push((y++?u:"")+p)));return delete n.dense,r.join("")}function kk(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=wm(e,t);return r}function JM(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=kt(e["!ref"]),l="",c=[],u,d=[],f=Array.isArray(e);for(u=s.s.c;u<=s.e.c;++u)c[u]=er(u);for(var p=s.s.r;p<=s.e.r;++p)for(l=pr(p),u=s.s.c;u<=s.e.c;++u)if(t=c[u]+l,r=f?(e[p]||[])[u]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}d[d.length]=t+"="+n}return d}function Tk(e,t,r){var n=r||{},s=+!n.skipHeader,l=e||{},c=0,u=0;if(l&&n.origin!=null)if(typeof n.origin=="number")c=n.origin;else{var d=typeof n.origin=="string"?tr(n.origin):n.origin;c=d.r,u=d.c}var f,p={s:{c:0,r:0},e:{c:u,r:c+t.length-1+s}};if(l["!ref"]){var m=kt(l["!ref"]);p.e.c=Math.max(p.e.c,m.e.c),p.e.r=Math.max(p.e.r,m.e.r),c==-1&&(c=m.e.r+1,p.e.r=c+t.length-1+s)}else c==-1&&(c=0,p.e.r=t.length-1+s);var g=n.header||[],b=0;t.forEach(function(y,N){ir(y).forEach(function(_){(b=g.indexOf(_))==-1&&(g[b=g.length]=_);var C=y[_],S="z",E="",O=at({c:u+b,r:c+N+s});f=tu(l,O),C&&typeof C=="object"&&!(C instanceof Date)?l[O]=C:(typeof C=="number"?S="n":typeof C=="boolean"?S="b":typeof C=="string"?S="s":C instanceof Date?(S="d",n.cellDates||(S="n",C=jr(C)),E=n.dateNF||nt[14]):C===null&&n.nullError&&(S="e",C=0),f?(f.t=S,f.v=C,delete f.w,delete f.R,E&&(f.z=E)):l[O]=f={t:S,v:C},E&&(f.z=E))})}),p.e.c=Math.max(p.e.c,u+g.length-1);var v=pr(c);if(s)for(b=0;b<g.length;++b)l[er(b+u)+v]={t:"s",v:g[b]};return l["!ref"]=ut(p),l}function ZM(e,t){return Tk(null,e,t)}function tu(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=tr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?tu(e,at(t)):tu(e,at({r:t,c:r||0}))}function eB(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Nm(){return{SheetNames:[],Sheets:{}}}function km(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var l=r.match(/(^.*?)(\d+)$/);s=l&&+l[2]||0;var c=l&&l[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=c+s)!=-1;++s);}if(ok(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function tB(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=eB(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function rB(e,t){return e.z=t,e}function jk(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function nB(e,t,r){return jk(e,"#"+t,r)}function aB(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function sB(e,t,r,n){for(var s=typeof t!="string"?t:kt(t),l=typeof t=="string"?t:ut(t),c=s.s.r;c<=s.e.r;++c)for(var u=s.s.c;u<=s.e.c;++u){var d=tu(e,c,u);d.t="n",d.F=l,delete d.v,c==s.s.r&&u==s.s.c&&(d.f=r,n&&(d.D=!0))}return e}var ma={encode_col:er,encode_row:pr,encode_cell:at,encode_range:ut,decode_col:Qx,decode_row:Xx,split_cell:gF,decode_cell:tr,decode_range:_n,format_cell:xs,sheet_add_aoa:Zw,sheet_add_json:Tk,sheet_add_dom:xk,aoa_to_sheet:Do,json_to_sheet:ZM,table_to_sheet:mk,table_to_book:fM,sheet_to_csv:wm,sheet_to_txt:kk,sheet_to_json:_h,sheet_to_html:pk,sheet_to_formulae:JM,sheet_to_row_object_array:_h,sheet_get_cell:tu,book_new:Nm,book_append_sheet:km,book_set_sheet_visibility:tB,cell_set_number_format:rB,cell_set_hyperlink:jk,cell_set_internal_link:nB,cell_add_comment:aB,sheet_set_array_formula:sB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const _k=Object.freeze(Object.defineProperty({__proto__:null,CFB:Ye,parse_xlscfb:xm,parse_zip:bk,read:sx,utils:ma,write:bm,writeFile:jh,writeFileSync:jh},Symbol.toStringTag,{value:"Module"})),iB="modulepreload",lB=function(e){return"/"+e},A2={},Sk=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){let c=function(f){return Promise.all(f.map(p=>Promise.resolve(p).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),d=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));s=c(r.map(f=>{if(f=lB(f),f in A2)return;A2[f]=!0;const p=f.endsWith(".css"),m=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${m}`))return;const g=document.createElement("link");if(g.rel=p?"stylesheet":iB,p||(g.as="script"),g.crossOrigin="",g.href=f,d&&g.setAttribute("nonce",d),document.head.appendChild(g),p)return new Promise((b,v)=>{g.addEventListener("load",b),g.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${f}`)))})}))}function l(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return s.then(c=>{for(const u of c||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},oB=async(e,t,r)=>(await Le.post("/san-luong/chia-hang/preview",{rows:e,thang:t,nam:r})).data,cB=async(e,t,r)=>(await Le.post("/san-luong/chia-hang/confirm",{rows:e,tenFile:t,fileHash:r})).data,uB=async(e,t,r)=>(await Le.post("/san-luong/giao-hang/preview",{rows:e,thang:t,nam:r})).data,hB=async(e,t,r)=>(await Le.post("/san-luong/giao-hang/confirm",{rows:e,tenFile:t,fileHash:r})).data,dB=async e=>(await Le.get("/san-luong/lich-su-import",{params:e})).data,fB=async e=>{const{read:t,utils:r}=await Sk(async()=>{const{read:u,utils:d}=await Promise.resolve().then(()=>_k);return{read:u,utils:d}},void 0),n=await e.arrayBuffer(),s=t(n,{type:"array"}),l=s.Sheets[s.SheetNames[0]];return r.sheet_to_json(l).map(u=>({maNhanVien:String(u["M NV"]||u.MaNhanVien||u.maNhanVien||""),ngay:Ck(u.Ngy||u.ngay),sanPhamDat:Number(u["SP t"]||u.sanPhamDat||0),sanPhamLoi:Number(u["SP Li"]||u.sanPhamLoi||0),tongSanPham:Number(u["Tng SP"]||u.tongSanPham||0)}))},pB=async e=>{const{read:t,utils:r}=await Sk(async()=>{const{read:u,utils:d}=await Promise.resolve().then(()=>_k);return{read:u,utils:d}},void 0),n=await e.arrayBuffer(),s=t(n,{type:"array"}),l=s.Sheets[s.SheetNames[0]];return r.sheet_to_json(l).map(u=>({maNhanVien:String(u["M NV"]||u.MaNhanVien||u.maNhanVien||""),ngay:Ck(u.Ngy||u.ngay),khoiLuong:Number(u["Khi lng"]||u.khoiLuong||0),donGia:Number(u["n gi"]||u.donGia||0),phatTre:Number(u["Pht tr"]||u.phatTre||0),phatKhongLayPhieu:Number(u["Pht KL phiu"]||u.phatKhongLayPhieu||0)}))};function Ck(e){if(!e)return"";if(typeof e=="number")return new Date((e-25569)*86400*1e3).toISOString().split("T")[0];if(typeof e=="string"){const t=e.split("/");if(t.length===3){const[r,n,s]=t;return`${s}-${n.padStart(2,"0")}-${r.padStart(2,"0")}`}if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e}return String(e)}const Ek=async e=>{const t=await e.arrayBuffer(),r=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(r)).map(s=>s.toString(16).padStart(2,"0")).join("")},xB=()=>{const[e,t]=P.useState(null),[r,n]=P.useState([]),[s,l]=P.useState(null),[c,u]=P.useState(!1),[d,f]=P.useState(!1),[p,m]=P.useState(new Date().getMonth()+1),[g,b]=P.useState(new Date().getFullYear()),v=()=>{const F=[{"M NV":"NV001",Ngy:"01/01/2026","SP t":100,"SP Li":2,"Tng SP":102},{"M NV":"NV001",Ngy:"02/01/2026","SP t":95,"SP Li":1,"Tng SP":96},{"M NV":"NV002",Ngy:"01/01/2026","SP t":120,"SP Li":3,"Tng SP":123},{"M NV":"NV002",Ngy:"02/01/2026","SP t":110,"SP Li":0,"Tng SP":110}],T=ma.json_to_sheet(F);T["!cols"]=[{wch:10},{wch:12},{wch:10},{wch:10},{wch:10}];const D=ma.book_new();ma.book_append_sheet(D,T,"Chia Hng");const I=[{Ct:"M NV","M t":"M nhn vin (bt buc)","V d":"NV001"},{Ct:"Ngy","M t":"Ngy lm vic (dd/MM/yyyy)","V d":"01/01/2026"},{Ct:"SP t","M t":"S sn phm t chun","V d":"100"},{Ct:"SP Li","M t":"S sn phm li","V d":"2"},{Ct:"Tng SP","M t":"Tng sn phm","V d":"102"},{Ct:"","M t":"","V d":""},{Ct:"Cng thc","M t":"Quy i SP = SP t - (SP Li  5)","V d":""},{Ct:"","M t":"Tin sn lng = Quy i SP  320","V d":""}],J=ma.json_to_sheet(I);J["!cols"]=[{wch:12},{wch:40},{wch:15}],ma.book_append_sheet(D,J,"Hng dn"),jh(D,`Template_ChiaHang_${p}_${g}.xlsx`),pt.success(" ti template mu")},y=P.useCallback(async F=>{const T=F[0];if(T){t(T),u(!0),l(null);try{const D=await fB(T);n(D),pt.success(` c ${D.length} dng t file`)}catch(D){pt.error("Li c file Excel"),console.error(D)}finally{u(!1)}}},[]),{getRootProps:N,getInputProps:_,isDragActive:C}=Lx({onDrop:y,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"]},multiple:!1}),S=async()=>{var F,T;if(r.length===0){pt.error("Cha c d liu  preview");return}u(!0);try{const D=await oB(r,p,g);l(D),D.tongKhongHopLe>0?pt.error(`C ${D.tongKhongHopLe} dng khng hp l`):pt.success(`${D.tongHopLe} dng hp l, sn sng import`)}catch(D){const I=D;pt.error(((T=(F=I.response)==null?void 0:F.data)==null?void 0:T.message)||"Li preview")}finally{u(!1)}},E=async()=>{var F,T;if(!(!s||!e)){if(s.hopLe.length===0){pt.error("Khng c d liu hp l  import");return}f(!0);try{const D=await Ek(e),I=await cB(s.hopLe,e.name,D);pt.success(`Import thnh cng! Thm mi: ${I.inserted}, Cp nht: ${I.updated}`),t(null),n([]),l(null)}catch(D){const I=D;pt.error(((T=(F=I.response)==null?void 0:F.data)==null?void 0:T.message)||"Li import")}finally{f(!1)}}},O=()=>{t(null),n([]),l(null)};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Import Sn Lng Chia Hng"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:v,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Ti Template Mu"]}),(e||r.length>0)&&a.jsx("button",{onClick:O,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Reset"})]})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow flex gap-4 items-center",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thng"}),a.jsx("select",{value:p,onChange:F=>m(Number(F.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:12},(F,T)=>a.jsxs("option",{value:T+1,children:["Thng ",T+1]},T+1))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nm"}),a.jsx("select",{value:g,onChange:F=>b(Number(F.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:5},(F,T)=>new Date().getFullYear()-2+T).map(F=>a.jsx("option",{value:F,children:F},F))})]})]}),a.jsxs("div",{...N(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${C?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,children:[a.jsx("input",{..._()}),a.jsxs("div",{className:"text-gray-600",children:[a.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),C?a.jsx("p",{className:"text-blue-600",children:"Th file vo y..."}):a.jsxs(a.Fragment,{children:[a.jsx("p",{children:"Ko th file Excel vo y, hoc click  chn file"}),a.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"H tr: .xlsx, .xls"})]})]})]}),e&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsxs("p",{className:"text-blue-800",children:[a.jsx("strong",{children:"File:"})," ",e.name," (",(e.size/1024).toFixed(1)," KB)"]}),a.jsxs("p",{className:"text-blue-600 text-sm mt-1",children:[" c ",r.length," dng d liu"]})]}),r.length>0&&!s&&a.jsx("button",{onClick:S,disabled:c,className:"w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2",children:c?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang x l..."]}):"Preview d liu"}),s&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[a.jsx("p",{className:"text-green-800 font-semibold text-lg",children:s.tongHopLe}),a.jsx("p",{className:"text-green-600 text-sm",children:"Dng hp l"})]}),a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[a.jsx("p",{className:"text-red-800 font-semibold text-lg",children:s.tongKhongHopLe}),a.jsx("p",{className:"text-red-600 text-sm",children:"Dng khng hp l"})]})]}),s.hopLe.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsx("div",{className:"px-4 py-3 bg-green-50 border-b border-green-200",children:a.jsxs("h3",{className:"font-semibold text-green-800",children:["D liu hp l (",s.hopLe.length,")"]})}),a.jsxs("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:[a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"SP t"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"SP Li"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Tng SP"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:s.hopLe.slice(0,100).map((F,T)=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2 text-sm",children:F.maNhanVien}),a.jsx("td",{className:"px-4 py-2 text-sm",children:F.ngay}),a.jsx("td",{className:"px-4 py-2 text-sm text-right",children:F.sanPhamDat}),a.jsx("td",{className:"px-4 py-2 text-sm text-right",children:F.sanPhamLoi}),a.jsx("td",{className:"px-4 py-2 text-sm text-right",children:F.tongSanPham})]},T))})]}),s.hopLe.length>100&&a.jsxs("p",{className:"text-center text-gray-500 py-2",children:["... v ",s.hopLe.length-100," dng na"]})]})]}),s.khongHopLe.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsx("div",{className:"px-4 py-3 bg-red-50 border-b border-red-200",children:a.jsxs("h3",{className:"font-semibold text-red-800",children:["D liu khng hp l (",s.khongHopLe.length,")"]})}),a.jsx("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"L do"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:s.khongHopLe.map((F,T)=>a.jsxs("tr",{className:"bg-red-50",children:[a.jsx("td",{className:"px-4 py-2 text-sm",children:F.row.maNhanVien}),a.jsx("td",{className:"px-4 py-2 text-sm",children:F.row.ngay}),a.jsx("td",{className:"px-4 py-2 text-sm text-red-600",children:F.lyDo})]},T))})]})})]}),s.hopLe.length>0&&a.jsxs("div",{className:"flex gap-4",children:[a.jsx("button",{onClick:S,disabled:c,className:"flex-1 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 disabled:opacity-50",children:"Preview li"}),a.jsx("button",{onClick:E,disabled:d,className:"flex-1 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center justify-center gap-2",children:d?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang import..."]}):`Import ${s.hopLe.length} dng`})]})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[a.jsx("h3",{className:"font-semibold text-yellow-800 mb-2",children:"Hng dn"}),a.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1 list-disc list-inside",children:[a.jsx("li",{children:"File Excel cn c cc ct: M NV, Ngy, SP t, SP Li, Tng SP"}),a.jsx("li",{children:"Ngy c th  nh dng dd/MM/yyyy hoc yyyy-MM-dd"}),a.jsx("li",{children:"Nu d liu  tn ti (cng m NV + ngy) s c cp nht"}),a.jsxs("li",{children:["Cng thc: ",a.jsx("strong",{children:"Quy i SP = SP t - (SP Li  5)"}),", ",a.jsx("strong",{children:"Tin = Quy i  320"})]})]})]})]})},mB=()=>{const[e,t]=P.useState(null),[r,n]=P.useState([]),[s,l]=P.useState(null),[c,u]=P.useState(!1),[d,f]=P.useState(!1),[p,m]=P.useState(new Date().getMonth()+1),[g,b]=P.useState(new Date().getFullYear()),v=()=>{const T=[{"M NV":"NV001",Ngy:"01/01/2026","Khi lng":50,"n gi":5e3,"Pht tr":0,"Pht KL phiu":0},{"M NV":"NV001",Ngy:"02/01/2026","Khi lng":45,"n gi":5e3,"Pht tr":1e4,"Pht KL phiu":0},{"M NV":"NV002",Ngy:"01/01/2026","Khi lng":60,"n gi":5500,"Pht tr":0,"Pht KL phiu":5e3},{"M NV":"NV002",Ngy:"02/01/2026","Khi lng":55,"n gi":5500,"Pht tr":0,"Pht KL phiu":0}],D=ma.json_to_sheet(T);D["!cols"]=[{wch:10},{wch:12},{wch:12},{wch:12},{wch:12},{wch:15}];const I=ma.book_new();ma.book_append_sheet(I,D,"Giao Hng");const J=[{Ct:"M NV","M t":"M nhn vin (bt buc)","V d":"NV001"},{Ct:"Ngy","M t":"Ngy lm vic (dd/MM/yyyy)","V d":"01/01/2026"},{Ct:"Khi lng","M t":"Khi lng giao hng (kg)","V d":"50"},{Ct:"n gi","M t":"n gi theo kg (VN)","V d":"5000"},{Ct:"Pht tr","M t":"Tin pht giao tr (VN)","V d":"10000"},{Ct:"Pht KL phiu","M t":"Pht khng ly phiu (VN)","V d":"5000"},{Ct:"","M t":"","V d":""},{Ct:"Cng thc","M t":"Tin = Khi lng  n gi - Pht tr - Pht KL phiu","V d":""}],Z=ma.json_to_sheet(J);Z["!cols"]=[{wch:15},{wch:50},{wch:15}],ma.book_append_sheet(I,Z,"Hng dn"),jh(I,`Template_GiaoHang_${p}_${g}.xlsx`),pt.success(" ti template mu")},y=P.useCallback(async T=>{const D=T[0];if(D){t(D),u(!0),l(null);try{const I=await pB(D);n(I),pt.success(` c ${I.length} dng t file`)}catch(I){pt.error("Li c file Excel"),console.error(I)}finally{u(!1)}}},[]),{getRootProps:N,getInputProps:_,isDragActive:C}=Lx({onDrop:y,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"]},multiple:!1}),S=async()=>{var T,D;if(r.length===0){pt.error("Cha c d liu  preview");return}u(!0);try{const I=await uB(r,p,g);l(I),I.tongKhongHopLe>0?pt.error(`C ${I.tongKhongHopLe} dng khng hp l`):pt.success(`${I.tongHopLe} dng hp l, sn sng import`)}catch(I){const J=I;pt.error(((D=(T=J.response)==null?void 0:T.data)==null?void 0:D.message)||"Li preview")}finally{u(!1)}},E=async()=>{var T,D;if(!(!s||!e)){if(s.hopLe.length===0){pt.error("Khng c d liu hp l  import");return}f(!0);try{const I=await Ek(e),J=await hB(s.hopLe,e.name,I);pt.success(`Import thnh cng! Thm mi: ${J.inserted}, Cp nht: ${J.updated}`),t(null),n([]),l(null)}catch(I){const J=I;pt.error(((D=(T=J.response)==null?void 0:T.data)==null?void 0:D.message)||"Li import")}finally{f(!1)}}},O=()=>{t(null),n([]),l(null)},F=T=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(T);return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Import Sn Lng Giao Hng"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:v,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Ti Template Mu"]}),(e||r.length>0)&&a.jsx("button",{onClick:O,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Reset"})]})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow flex gap-4 items-center",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thng"}),a.jsx("select",{value:p,onChange:T=>m(Number(T.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:12},(T,D)=>a.jsxs("option",{value:D+1,children:["Thng ",D+1]},D+1))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nm"}),a.jsx("select",{value:g,onChange:T=>b(Number(T.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:5},(T,D)=>new Date().getFullYear()-2+D).map(T=>a.jsx("option",{value:T,children:T},T))})]})]}),a.jsxs("div",{...N(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${C?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,children:[a.jsx("input",{..._()}),a.jsxs("div",{className:"text-gray-600",children:[a.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),C?a.jsx("p",{className:"text-blue-600",children:"Th file vo y..."}):a.jsxs(a.Fragment,{children:[a.jsx("p",{children:"Ko th file Excel vo y, hoc click  chn file"}),a.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"H tr: .xlsx, .xls"})]})]})]}),e&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsxs("p",{className:"text-blue-800",children:[a.jsx("strong",{children:"File:"})," ",e.name," (",(e.size/1024).toFixed(1)," KB)"]}),a.jsxs("p",{className:"text-blue-600 text-sm mt-1",children:[" c ",r.length," dng d liu"]})]}),r.length>0&&!s&&a.jsx("button",{onClick:S,disabled:c,className:"w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2",children:c?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang x l..."]}):"Preview d liu"}),s&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[a.jsx("p",{className:"text-green-800 font-semibold text-lg",children:s.tongHopLe}),a.jsx("p",{className:"text-green-600 text-sm",children:"Dng hp l"})]}),a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[a.jsx("p",{className:"text-red-800 font-semibold text-lg",children:s.tongKhongHopLe}),a.jsx("p",{className:"text-red-600 text-sm",children:"Dng khng hp l"})]})]}),s.hopLe.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsx("div",{className:"px-4 py-3 bg-green-50 border-b border-green-200",children:a.jsxs("h3",{className:"font-semibold text-green-800",children:["D liu hp l (",s.hopLe.length,")"]})}),a.jsxs("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:[a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Khi lng"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"n gi"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Pht tr"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Pht KLP"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:s.hopLe.slice(0,100).map((T,D)=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2 text-sm",children:T.maNhanVien}),a.jsx("td",{className:"px-4 py-2 text-sm",children:T.ngay}),a.jsx("td",{className:"px-4 py-2 text-sm text-right",children:T.khoiLuong}),a.jsx("td",{className:"px-4 py-2 text-sm text-right",children:F(T.donGia)}),a.jsx("td",{className:"px-4 py-2 text-sm text-right text-red-600",children:F(T.phatTre)}),a.jsx("td",{className:"px-4 py-2 text-sm text-right text-red-600",children:F(T.phatKhongLayPhieu)})]},D))})]}),s.hopLe.length>100&&a.jsxs("p",{className:"text-center text-gray-500 py-2",children:["... v ",s.hopLe.length-100," dng na"]})]})]}),s.khongHopLe.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsx("div",{className:"px-4 py-3 bg-red-50 border-b border-red-200",children:a.jsxs("h3",{className:"font-semibold text-red-800",children:["D liu khng hp l (",s.khongHopLe.length,")"]})}),a.jsx("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"L do"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:s.khongHopLe.map((T,D)=>a.jsxs("tr",{className:"bg-red-50",children:[a.jsx("td",{className:"px-4 py-2 text-sm",children:T.row.maNhanVien}),a.jsx("td",{className:"px-4 py-2 text-sm",children:T.row.ngay}),a.jsx("td",{className:"px-4 py-2 text-sm text-red-600",children:T.lyDo})]},D))})]})})]}),s.hopLe.length>0&&a.jsxs("div",{className:"flex gap-4",children:[a.jsx("button",{onClick:S,disabled:c,className:"flex-1 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 disabled:opacity-50",children:"Preview li"}),a.jsx("button",{onClick:E,disabled:d,className:"flex-1 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center justify-center gap-2",children:d?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang import..."]}):`Import ${s.hopLe.length} dng`})]})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[a.jsx("h3",{className:"font-semibold text-yellow-800 mb-2",children:"Hng dn"}),a.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1 list-disc list-inside",children:[a.jsx("li",{children:"File Excel cn c cc ct: M NV, Ngy, Khi lng, n gi, Pht tr, Pht KL phiu"}),a.jsx("li",{children:"Ngy c th  nh dng dd/MM/yyyy hoc yyyy-MM-dd"}),a.jsx("li",{children:"Nu d liu  tn ti (cng m NV + ngy) s c cp nht"}),a.jsxs("li",{children:["Cng thc: ",a.jsx("strong",{children:"Tin = Khi lng  n gi - Pht tr - Pht khng ly phiu"})]})]})]})]})},gB=()=>{const[e,t]=P.useState([]),[r,n]=P.useState(0),[s,l]=P.useState(!0),[c,u]=P.useState({loai:void 0,trangThai:void 0,page:1,limit:20});P.useEffect(()=>{d()},[c]);const d=async()=>{var v,y;l(!0);try{const N=await dB(c);t(N.items),n(N.total)}catch(N){const _=N;pt.error(((y=(v=_.response)==null?void 0:v.data)==null?void 0:y.message)||"Li ti d liu")}finally{l(!1)}},f=v=>new Date(v).toLocaleString("vi-VN"),p=v=>{u(y=>({...y,loai:v===""?void 0:v,page:1}))},m=v=>{u(y=>({...y,trangThai:v===""?void 0:v,page:1}))},g=v=>{u(y=>({...y,page:v}))},b=Math.ceil(r/(c.limit||20));return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Lch S Import Sn Lng"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(wn,{to:"/import-chia-hang",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Import Chia Hng"}),a.jsx(wn,{to:"/import-giao-hang",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Import Giao Hng"})]})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow flex gap-4 items-center flex-wrap",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi"}),a.jsxs("select",{value:c.loai||"",onChange:v=>p(v.target.value),className:"border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"",children:"Tt c"}),a.jsx("option",{value:"CHIA_HANG",children:"Chia hng"}),a.jsx("option",{value:"GIAO_HANG",children:"Giao hng"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng thi"}),a.jsxs("select",{value:c.trangThai||"",onChange:v=>m(v.target.value),className:"border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"",children:"Tt c"}),a.jsx("option",{value:"THANH_CONG",children:"Thnh cng"}),a.jsx("option",{value:"THAT_BAI",children:"Tht bi"})]})]}),a.jsx("div",{className:"ml-auto",children:a.jsx("button",{onClick:d,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Lm mi"})})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[s?a.jsxs("div",{className:"p-8 text-center",children:[a.jsxs("svg",{className:"animate-spin h-8 w-8 mx-auto text-blue-600",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),a.jsx("p",{className:"text-gray-500 mt-2",children:"ang ti..."})]}):e.length===0?a.jsx("div",{className:"p-8 text-center text-gray-500",children:"Khng c d liu"}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Loi"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tn file"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thi gian"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ngi import"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"S dng"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thnh cng"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tht bi"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trng thi"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(v=>{var y;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:v.id}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v.loai==="CHIA_HANG"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:v.loai==="CHIA_HANG"?"Chia hng":"Giao hng"})}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",title:v.tenFile,children:v.tenFile}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:f(v.thoiGianImport)}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:((y=v.nguoiImport)==null?void 0:y.hoTen)||"N/A"}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-center",children:v.soLuongDong}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-green-600 text-center font-medium",children:v.soDongThanhCong}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-red-600 text-center font-medium",children:v.soDongThatBai}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v.trangThai==="THANH_CONG"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.trangThai==="THANH_CONG"?"Thnh cng":"Tht bi"})})]},v.id)})})]})}),b>1&&a.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 flex items-center justify-between",children:[a.jsxs("div",{className:"text-sm text-gray-700",children:["Hin th ",a.jsx("span",{className:"font-medium",children:(c.page-1)*c.limit+1})," n"," ",a.jsx("span",{className:"font-medium",children:Math.min(c.page*c.limit,r)})," trong"," ",a.jsx("span",{className:"font-medium",children:r})," kt qu"]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>g(c.page-1),disabled:c.page===1,className:"px-3 py-1 border rounded-md text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Trc"}),Array.from({length:Math.min(5,b)},(v,y)=>{let N;return b<=5||c.page<=3?N=y+1:c.page>=b-2?N=b-4+y:N=c.page-2+y,a.jsx("button",{onClick:()=>g(N),className:`px-3 py-1 border rounded-md text-sm ${N===c.page?"bg-blue-600 text-white border-blue-600":"hover:bg-gray-50"}`,children:N},N)}),a.jsx("button",{onClick:()=>g(c.page+1),disabled:c.page===b,className:"px-3 py-1 border rounded-md text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Sau"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Tng s ln import"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:r})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Import chia hng"}),a.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:e.filter(v=>v.loai==="CHIA_HANG").length})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Import giao hng"}),a.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:e.filter(v=>v.loai==="GIAO_HANG").length})]})]})]})};function vB(){return a.jsxs(t_,{children:[a.jsx(Mt,{path:"/dang-nhap",element:a.jsx(R3,{})}),a.jsxs(Mt,{path:"/",element:a.jsx(sE,{}),children:[a.jsx(Mt,{index:!0,element:a.jsx(uE,{})}),a.jsx(Mt,{path:"bang-luong",element:a.jsx(hE,{})}),a.jsx(Mt,{path:"bang-luong/:id",element:a.jsx(l3,{})}),a.jsx(Mt,{path:"nhan-vien",element:a.jsx(o3,{})}),a.jsx(Mt,{path:"nhan-vien/:id",element:a.jsx(C3,{})}),a.jsx(Mt,{path:"nhom-nhan-vien",element:a.jsx(O3,{})}),a.jsx(Mt,{path:"phong-ban",element:a.jsx(P3,{})}),a.jsx(Mt,{path:"khoan-luong",element:a.jsx(E3,{})}),a.jsx(Mt,{path:"cham-cong",element:a.jsx(D3,{})}),a.jsx(Mt,{path:"import-excel",element:a.jsx(F3,{})}),a.jsx(Mt,{path:"cai-dat",element:a.jsx(L3,{})}),a.jsx(Mt,{path:"quy-che",element:a.jsx(Wn,{children:a.jsx(G3,{})})}),a.jsx(Mt,{path:"quy-che/:id",element:a.jsx(Wn,{children:a.jsx(n6,{})})}),a.jsx(Mt,{path:"su-kien",element:a.jsx(Wn,{children:a.jsx(s6,{})})}),a.jsx(Mt,{path:"rule-trace",element:a.jsx(Wn,{children:a.jsx(l6,{})})}),a.jsx(Mt,{path:"kpi/template",element:a.jsx(Wn,{children:a.jsx(M3,{})})}),a.jsx(Mt,{path:"kpi/ky-danh-gia",element:a.jsx(Wn,{children:a.jsx(H3,{})})}),a.jsx(Mt,{path:"kpi/cau-hinh-thuong",element:a.jsx(Wn,{children:a.jsx(U3,{})})}),a.jsx(Mt,{path:"import-chia-hang",element:a.jsx(Wn,{children:a.jsx(xB,{})})}),a.jsx(Mt,{path:"import-giao-hang",element:a.jsx(Wn,{children:a.jsx(mB,{})})}),a.jsx(Mt,{path:"lich-su-import",element:a.jsx(Wn,{children:a.jsx(gB,{})})}),a.jsx(Mt,{path:"quan-tri/nguoi-dung",element:a.jsx(Wn,{children:a.jsx(V3,{})})}),a.jsx(Mt,{path:"quan-tri/audit-log",element:a.jsx(Wn,{children:a.jsx(z3,{})})}),a.jsx(Mt,{path:"*",element:a.jsx(J4,{to:"/",replace:!0})})]})]})}const yB=new Gj({defaultOptions:{queries:{staleTime:300*1e3,retry:1}}});kj.createRoot(document.getElementById("root")).render(a.jsx(P.StrictMode,{children:a.jsx(qj,{client:yB,children:a.jsx(c_,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:a.jsxs(nE,{children:[a.jsx(vB,{}),a.jsx(tS,{position:"top-right",toastOptions:{duration:3e3,style:{background:"#333",color:"#fff"}}})]})})})}));
