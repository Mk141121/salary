var kC=Object.defineProperty;var A1=e=>{throw TypeError(e)};var TC=(e,n,a)=>n in e?kC(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a;var Qm=(e,n,a)=>TC(e,typeof n!="symbol"?n+"":n,a),Ym=(e,n,a)=>n.has(e)||A1("Cannot "+a);var ce=(e,n,a)=>(Ym(e,n,"read from private field"),a?a.call(e):n.get(e)),at=(e,n,a)=>n.has(e)?A1("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(e):n.set(e,a),$e=(e,n,a,r)=>(Ym(e,n,"write to private field"),r?r.call(e,a):n.set(e,a),a),vt=(e,n,a)=>(Ym(e,n,"access private method"),a);var Vh=(e,n,a,r)=>({set _(s){$e(e,n,s,a)},get _(){return ce(e,n,r)}});function CC(e,n){for(var a=0;a<n.length;a++){const r=n[a];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const l=Object.getOwnPropertyDescriptor(r,s);l&&Object.defineProperty(e,s,l.get?l:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function a(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(s){if(s.ep)return;s.ep=!0;const l=a(s);fetch(s.href,l)}})();function Vp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Jm={exports:{}},jd={},Zm={exports:{}},Nt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F1;function SC(){if(F1)return Nt;F1=1;var e=Symbol.for("react.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),o=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),f=Symbol.iterator;function p(K){return K===null||typeof K!="object"?null:(K=f&&K[f]||K["@@iterator"],typeof K=="function"?K:null)}var N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,g={};function b(K,L,X){this.props=K,this.context=L,this.refs=g,this.updater=X||N}b.prototype.isReactComponent={},b.prototype.setState=function(K,L){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,L,"setState")},b.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function j(){}j.prototype=b.prototype;function T(K,L,X){this.props=K,this.context=L,this.refs=g,this.updater=X||N}var S=T.prototype=new j;S.constructor=T,y(S,b.prototype),S.isPureReactComponent=!0;var w=Array.isArray,_=Object.prototype.hasOwnProperty,E={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function P(K,L,X){var I,W={},z=null,xe=null;if(L!=null)for(I in L.ref!==void 0&&(xe=L.ref),L.key!==void 0&&(z=""+L.key),L)_.call(L,I)&&!C.hasOwnProperty(I)&&(W[I]=L[I]);var H=arguments.length-2;if(H===1)W.children=X;else if(1<H){for(var ne=Array(H),oe=0;oe<H;oe++)ne[oe]=arguments[oe+2];W.children=ne}if(K&&K.defaultProps)for(I in H=K.defaultProps,H)W[I]===void 0&&(W[I]=H[I]);return{$$typeof:e,type:K,key:z,ref:xe,props:W,_owner:E.current}}function F(K,L){return{$$typeof:e,type:K.type,key:L,ref:K.ref,props:K.props,_owner:K._owner}}function R(K){return typeof K=="object"&&K!==null&&K.$$typeof===e}function O(K){var L={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(X){return L[X]})}var M=/\/+/g;function q(K,L){return typeof K=="object"&&K!==null&&K.key!=null?O(""+K.key):L.toString(36)}function J(K,L,X,I,W){var z=typeof K;(z==="undefined"||z==="boolean")&&(K=null);var xe=!1;if(K===null)xe=!0;else switch(z){case"string":case"number":xe=!0;break;case"object":switch(K.$$typeof){case e:case n:xe=!0}}if(xe)return xe=K,W=W(xe),K=I===""?"."+q(xe,0):I,w(W)?(X="",K!=null&&(X=K.replace(M,"$&/")+"/"),J(W,L,X,"",function(oe){return oe})):W!=null&&(R(W)&&(W=F(W,X+(!W.key||xe&&xe.key===W.key?"":(""+W.key).replace(M,"$&/")+"/")+K)),L.push(W)),1;if(xe=0,I=I===""?".":I+":",w(K))for(var H=0;H<K.length;H++){z=K[H];var ne=I+q(z,H);xe+=J(z,L,X,ne,W)}else if(ne=p(K),typeof ne=="function")for(K=ne.call(K),H=0;!(z=K.next()).done;)z=z.value,ne=I+q(z,H++),xe+=J(z,L,X,ne,W);else if(z==="object")throw L=String(K),Error("Objects are not valid as a React child (found: "+(L==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":L)+"). If you meant to render a collection of children, use an array instead.");return xe}function B(K,L,X){if(K==null)return K;var I=[],W=0;return J(K,I,"","",function(z){return L.call(X,z,W++)}),I}function ue(K){if(K._status===-1){var L=K._result;L=L(),L.then(function(X){(K._status===0||K._status===-1)&&(K._status=1,K._result=X)},function(X){(K._status===0||K._status===-1)&&(K._status=2,K._result=X)}),K._status===-1&&(K._status=0,K._result=L)}if(K._status===1)return K._result.default;throw K._result}var te={current:null},Z={transition:null},Q={ReactCurrentDispatcher:te,ReactCurrentBatchConfig:Z,ReactCurrentOwner:E};function fe(){throw Error("act(...) is not supported in production builds of React.")}return Nt.Children={map:B,forEach:function(K,L,X){B(K,function(){L.apply(this,arguments)},X)},count:function(K){var L=0;return B(K,function(){L++}),L},toArray:function(K){return B(K,function(L){return L})||[]},only:function(K){if(!R(K))throw Error("React.Children.only expected to receive a single React element child.");return K}},Nt.Component=b,Nt.Fragment=a,Nt.Profiler=s,Nt.PureComponent=T,Nt.StrictMode=r,Nt.Suspense=u,Nt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Q,Nt.act=fe,Nt.cloneElement=function(K,L,X){if(K==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+K+".");var I=y({},K.props),W=K.key,z=K.ref,xe=K._owner;if(L!=null){if(L.ref!==void 0&&(z=L.ref,xe=E.current),L.key!==void 0&&(W=""+L.key),K.type&&K.type.defaultProps)var H=K.type.defaultProps;for(ne in L)_.call(L,ne)&&!C.hasOwnProperty(ne)&&(I[ne]=L[ne]===void 0&&H!==void 0?H[ne]:L[ne])}var ne=arguments.length-2;if(ne===1)I.children=X;else if(1<ne){H=Array(ne);for(var oe=0;oe<ne;oe++)H[oe]=arguments[oe+2];I.children=H}return{$$typeof:e,type:K.type,key:W,ref:z,props:I,_owner:xe}},Nt.createContext=function(K){return K={$$typeof:o,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},K.Provider={$$typeof:l,_context:K},K.Consumer=K},Nt.createElement=P,Nt.createFactory=function(K){var L=P.bind(null,K);return L.type=K,L},Nt.createRef=function(){return{current:null}},Nt.forwardRef=function(K){return{$$typeof:d,render:K}},Nt.isValidElement=R,Nt.lazy=function(K){return{$$typeof:m,_payload:{_status:-1,_result:K},_init:ue}},Nt.memo=function(K,L){return{$$typeof:x,type:K,compare:L===void 0?null:L}},Nt.startTransition=function(K){var L=Z.transition;Z.transition={};try{K()}finally{Z.transition=L}},Nt.unstable_act=fe,Nt.useCallback=function(K,L){return te.current.useCallback(K,L)},Nt.useContext=function(K){return te.current.useContext(K)},Nt.useDebugValue=function(){},Nt.useDeferredValue=function(K){return te.current.useDeferredValue(K)},Nt.useEffect=function(K,L){return te.current.useEffect(K,L)},Nt.useId=function(){return te.current.useId()},Nt.useImperativeHandle=function(K,L,X){return te.current.useImperativeHandle(K,L,X)},Nt.useInsertionEffect=function(K,L){return te.current.useInsertionEffect(K,L)},Nt.useLayoutEffect=function(K,L){return te.current.useLayoutEffect(K,L)},Nt.useMemo=function(K,L){return te.current.useMemo(K,L)},Nt.useReducer=function(K,L,X){return te.current.useReducer(K,L,X)},Nt.useRef=function(K){return te.current.useRef(K)},Nt.useState=function(K){return te.current.useState(K)},Nt.useSyncExternalStore=function(K,L,X){return te.current.useSyncExternalStore(K,L,X)},Nt.useTransition=function(){return te.current.useTransition()},Nt.version="18.3.1",Nt}var L1;function Up(){return L1||(L1=1,Zm.exports=SC()),Zm.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P1;function _C(){if(P1)return jd;P1=1;var e=Up(),n=Symbol.for("react.element"),a=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function o(d,u,x){var m,f={},p=null,N=null;x!==void 0&&(p=""+x),u.key!==void 0&&(p=""+u.key),u.ref!==void 0&&(N=u.ref);for(m in u)r.call(u,m)&&!l.hasOwnProperty(m)&&(f[m]=u[m]);if(d&&d.defaultProps)for(m in u=d.defaultProps,u)f[m]===void 0&&(f[m]=u[m]);return{$$typeof:n,type:d,key:p,ref:N,props:f,_owner:s.current}}return jd.Fragment=a,jd.jsx=o,jd.jsxs=o,jd}var I1;function EC(){return I1||(I1=1,Jm.exports=_C()),Jm.exports}var t=EC(),D=Up();const D2=Vp(D),DC=CC({__proto__:null,default:D2},[D]);var Uh={},ef={exports:{}},Ga={},tf={exports:{}},nf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O1;function AC(){return O1||(O1=1,(function(e){function n(Z,Q){var fe=Z.length;Z.push(Q);e:for(;0<fe;){var K=fe-1>>>1,L=Z[K];if(0<s(L,Q))Z[K]=Q,Z[fe]=L,fe=K;else break e}}function a(Z){return Z.length===0?null:Z[0]}function r(Z){if(Z.length===0)return null;var Q=Z[0],fe=Z.pop();if(fe!==Q){Z[0]=fe;e:for(var K=0,L=Z.length,X=L>>>1;K<X;){var I=2*(K+1)-1,W=Z[I],z=I+1,xe=Z[z];if(0>s(W,fe))z<L&&0>s(xe,W)?(Z[K]=xe,Z[z]=fe,K=z):(Z[K]=W,Z[I]=fe,K=I);else if(z<L&&0>s(xe,fe))Z[K]=xe,Z[z]=fe,K=z;else break e}}return Q}function s(Z,Q){var fe=Z.sortIndex-Q.sortIndex;return fe!==0?fe:Z.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,d=o.now();e.unstable_now=function(){return o.now()-d}}var u=[],x=[],m=1,f=null,p=3,N=!1,y=!1,g=!1,b=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(Z){for(var Q=a(x);Q!==null;){if(Q.callback===null)r(x);else if(Q.startTime<=Z)r(x),Q.sortIndex=Q.expirationTime,n(u,Q);else break;Q=a(x)}}function w(Z){if(g=!1,S(Z),!y)if(a(u)!==null)y=!0,ue(_);else{var Q=a(x);Q!==null&&te(w,Q.startTime-Z)}}function _(Z,Q){y=!1,g&&(g=!1,j(P),P=-1),N=!0;var fe=p;try{for(S(Q),f=a(u);f!==null&&(!(f.expirationTime>Q)||Z&&!O());){var K=f.callback;if(typeof K=="function"){f.callback=null,p=f.priorityLevel;var L=K(f.expirationTime<=Q);Q=e.unstable_now(),typeof L=="function"?f.callback=L:f===a(u)&&r(u),S(Q)}else r(u);f=a(u)}if(f!==null)var X=!0;else{var I=a(x);I!==null&&te(w,I.startTime-Q),X=!1}return X}finally{f=null,p=fe,N=!1}}var E=!1,C=null,P=-1,F=5,R=-1;function O(){return!(e.unstable_now()-R<F)}function M(){if(C!==null){var Z=e.unstable_now();R=Z;var Q=!0;try{Q=C(!0,Z)}finally{Q?q():(E=!1,C=null)}}else E=!1}var q;if(typeof T=="function")q=function(){T(M)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,B=J.port2;J.port1.onmessage=M,q=function(){B.postMessage(null)}}else q=function(){b(M,0)};function ue(Z){C=Z,E||(E=!0,q())}function te(Z,Q){P=b(function(){Z(e.unstable_now())},Q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Z){Z.callback=null},e.unstable_continueExecution=function(){y||N||(y=!0,ue(_))},e.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<Z?Math.floor(1e3/Z):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return a(u)},e.unstable_next=function(Z){switch(p){case 1:case 2:case 3:var Q=3;break;default:Q=p}var fe=p;p=Q;try{return Z()}finally{p=fe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Z,Q){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var fe=p;p=Z;try{return Q()}finally{p=fe}},e.unstable_scheduleCallback=function(Z,Q,fe){var K=e.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?K+fe:K):fe=K,Z){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=fe+L,Z={id:m++,callback:Q,priorityLevel:Z,startTime:fe,expirationTime:L,sortIndex:-1},fe>K?(Z.sortIndex=fe,n(x,Z),a(u)===null&&Z===a(x)&&(g?(j(P),P=-1):g=!0,te(w,fe-K))):(Z.sortIndex=L,n(u,Z),y||N||(y=!0,ue(_))),Z},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(Z){var Q=p;return function(){var fe=p;p=Q;try{return Z.apply(this,arguments)}finally{p=fe}}}})(nf)),nf}var M1;function FC(){return M1||(M1=1,tf.exports=AC()),tf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R1;function LC(){if(R1)return Ga;R1=1;var e=Up(),n=FC();function a(i){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+i,h=1;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+i+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function l(i,c){o(i,c),o(i+"Capture",c)}function o(i,c){for(s[i]=c,i=0;i<c.length;i++)r.add(c[i])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,x=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},f={};function p(i){return u.call(f,i)?!0:u.call(m,i)?!1:x.test(i)?f[i]=!0:(m[i]=!0,!1)}function N(i,c,h,v){if(h!==null&&h.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return v?!1:h!==null?!h.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function y(i,c,h,v){if(c===null||typeof c>"u"||N(i,c,h,v))return!0;if(v)return!1;if(h!==null)switch(h.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function g(i,c,h,v,k,A,U){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=v,this.attributeNamespace=k,this.mustUseProperty=h,this.propertyName=i,this.type=c,this.sanitizeURL=A,this.removeEmptyString=U}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){b[i]=new g(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var c=i[0];b[c]=new g(c,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){b[i]=new g(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){b[i]=new g(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){b[i]=new g(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){b[i]=new g(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){b[i]=new g(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){b[i]=new g(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){b[i]=new g(i,5,!1,i.toLowerCase(),null,!1,!1)});var j=/[\-:]([a-z])/g;function T(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var c=i.replace(j,T);b[c]=new g(c,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var c=i.replace(j,T);b[c]=new g(c,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var c=i.replace(j,T);b[c]=new g(c,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){b[i]=new g(i,1,!1,i.toLowerCase(),null,!1,!1)}),b.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){b[i]=new g(i,1,!1,i.toLowerCase(),null,!0,!0)});function S(i,c,h,v){var k=b.hasOwnProperty(c)?b[c]:null;(k!==null?k.type!==0:v||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(y(c,h,k,v)&&(h=null),v||k===null?p(c)&&(h===null?i.removeAttribute(c):i.setAttribute(c,""+h)):k.mustUseProperty?i[k.propertyName]=h===null?k.type===3?!1:"":h:(c=k.attributeName,v=k.attributeNamespace,h===null?i.removeAttribute(c):(k=k.type,h=k===3||k===4&&h===!0?"":""+h,v?i.setAttributeNS(v,c,h):i.setAttribute(c,h))))}var w=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),E=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),R=Symbol.for("react.provider"),O=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),ue=Symbol.for("react.lazy"),te=Symbol.for("react.offscreen"),Z=Symbol.iterator;function Q(i){return i===null||typeof i!="object"?null:(i=Z&&i[Z]||i["@@iterator"],typeof i=="function"?i:null)}var fe=Object.assign,K;function L(i){if(K===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);K=c&&c[1]||""}return`
`+K+i}var X=!1;function I(i,c){if(!i||X)return"";X=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(we){var v=we}Reflect.construct(i,[],c)}else{try{c.call()}catch(we){v=we}i.call(c.prototype)}else{try{throw Error()}catch(we){v=we}i()}}catch(we){if(we&&v&&typeof we.stack=="string"){for(var k=we.stack.split(`
`),A=v.stack.split(`
`),U=k.length-1,le=A.length-1;1<=U&&0<=le&&k[U]!==A[le];)le--;for(;1<=U&&0<=le;U--,le--)if(k[U]!==A[le]){if(U!==1||le!==1)do if(U--,le--,0>le||k[U]!==A[le]){var de=`
`+k[U].replace(" at new "," at ");return i.displayName&&de.includes("<anonymous>")&&(de=de.replace("<anonymous>",i.displayName)),de}while(1<=U&&0<=le);break}}}finally{X=!1,Error.prepareStackTrace=h}return(i=i?i.displayName||i.name:"")?L(i):""}function W(i){switch(i.tag){case 5:return L(i.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return i=I(i.type,!1),i;case 11:return i=I(i.type.render,!1),i;case 1:return i=I(i.type,!0),i;default:return""}}function z(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case C:return"Fragment";case E:return"Portal";case F:return"Profiler";case P:return"StrictMode";case q:return"Suspense";case J:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case O:return(i.displayName||"Context")+".Consumer";case R:return(i._context.displayName||"Context")+".Provider";case M:var c=i.render;return i=i.displayName,i||(i=c.displayName||c.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case B:return c=i.displayName||null,c!==null?c:z(i.type)||"Memo";case ue:c=i._payload,i=i._init;try{return z(i(c))}catch{}}return null}function xe(i){var c=i.type;switch(i.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=c.render,i=i.displayName||i.name||"",c.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(c);case 8:return c===P?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function H(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function ne(i){var c=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function oe(i){var c=ne(i)?"checked":"value",h=Object.getOwnPropertyDescriptor(i.constructor.prototype,c),v=""+i[c];if(!i.hasOwnProperty(c)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var k=h.get,A=h.set;return Object.defineProperty(i,c,{configurable:!0,get:function(){return k.call(this)},set:function(U){v=""+U,A.call(this,U)}}),Object.defineProperty(i,c,{enumerable:h.enumerable}),{getValue:function(){return v},setValue:function(U){v=""+U},stopTracking:function(){i._valueTracker=null,delete i[c]}}}}function Se(i){i._valueTracker||(i._valueTracker=oe(i))}function V(i){if(!i)return!1;var c=i._valueTracker;if(!c)return!0;var h=c.getValue(),v="";return i&&(v=ne(i)?i.checked?"true":"false":i.value),i=v,i!==h?(c.setValue(i),!0):!1}function be(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Oe(i,c){var h=c.checked;return fe({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??i._wrapperState.initialChecked})}function tt(i,c){var h=c.defaultValue==null?"":c.defaultValue,v=c.checked!=null?c.checked:c.defaultChecked;h=H(c.value!=null?c.value:h),i._wrapperState={initialChecked:v,initialValue:h,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function Je(i,c){c=c.checked,c!=null&&S(i,"checked",c,!1)}function Re(i,c){Je(i,c);var h=H(c.value),v=c.type;if(h!=null)v==="number"?(h===0&&i.value===""||i.value!=h)&&(i.value=""+h):i.value!==""+h&&(i.value=""+h);else if(v==="submit"||v==="reset"){i.removeAttribute("value");return}c.hasOwnProperty("value")?un(i,c.type,h):c.hasOwnProperty("defaultValue")&&un(i,c.type,H(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(i.defaultChecked=!!c.defaultChecked)}function Rt(i,c,h){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var v=c.type;if(!(v!=="submit"&&v!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+i._wrapperState.initialValue,h||c===i.value||(i.value=c),i.defaultValue=c}h=i.name,h!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,h!==""&&(i.name=h)}function un(i,c,h){(c!=="number"||be(i.ownerDocument)!==i)&&(h==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+h&&(i.defaultValue=""+h))}var hn=Array.isArray;function Cn(i,c,h,v){if(i=i.options,c){c={};for(var k=0;k<h.length;k++)c["$"+h[k]]=!0;for(h=0;h<i.length;h++)k=c.hasOwnProperty("$"+i[h].value),i[h].selected!==k&&(i[h].selected=k),k&&v&&(i[h].defaultSelected=!0)}else{for(h=""+H(h),c=null,k=0;k<i.length;k++){if(i[k].value===h){i[k].selected=!0,v&&(i[k].defaultSelected=!0);return}c!==null||i[k].disabled||(c=i[k])}c!==null&&(c.selected=!0)}}function Ha(i,c){if(c.dangerouslySetInnerHTML!=null)throw Error(a(91));return fe({},c,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Bn(i,c){var h=c.value;if(h==null){if(h=c.children,c=c.defaultValue,h!=null){if(c!=null)throw Error(a(92));if(hn(h)){if(1<h.length)throw Error(a(93));h=h[0]}c=h}c==null&&(c=""),h=c}i._wrapperState={initialValue:H(h)}}function Be(i,c){var h=H(c.value),v=H(c.defaultValue);h!=null&&(h=""+h,h!==i.value&&(i.value=h),c.defaultValue==null&&i.defaultValue!==h&&(i.defaultValue=h)),v!=null&&(i.defaultValue=""+v)}function Qe(i){var c=i.textContent;c===i._wrapperState.initialValue&&c!==""&&c!==null&&(i.value=c)}function Ct(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ht(i,c){return i==null||i==="http://www.w3.org/1999/xhtml"?Ct(c):i==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var kt,fn=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,h,v,k){MSApp.execUnsafeLocalFunction(function(){return i(c,h,v,k)})}:i})(function(i,c){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=c;else{for(kt=kt||document.createElement("div"),kt.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=kt.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;c.firstChild;)i.appendChild(c.firstChild)}});function ot(i,c){if(c){var h=i.firstChild;if(h&&h===i.lastChild&&h.nodeType===3){h.nodeValue=c;return}}i.textContent=c}var Bt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Xn=["Webkit","ms","Moz","O"];Object.keys(Bt).forEach(function(i){Xn.forEach(function(c){c=c+i.charAt(0).toUpperCase()+i.substring(1),Bt[c]=Bt[i]})});function en(i,c,h){return c==null||typeof c=="boolean"||c===""?"":h||typeof c!="number"||c===0||Bt.hasOwnProperty(i)&&Bt[i]?(""+c).trim():c+"px"}function Ea(i,c){i=i.style;for(var h in c)if(c.hasOwnProperty(h)){var v=h.indexOf("--")===0,k=en(h,c[h],v);h==="float"&&(h="cssFloat"),v?i.setProperty(h,k):i[h]=k}}var mi=fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ps(i,c){if(c){if(mi[i]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(a(137,i));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(a(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(a(61))}if(c.style!=null&&typeof c.style!="object")throw Error(a(62))}}function Is(i,c){if(i.indexOf("-")===-1)return typeof c.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ls=null;function fi(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ko=null,pi=null,gi=null;function fl(i){if(i=ld(i)){if(typeof ko!="function")throw Error(a(280));var c=i.stateNode;c&&(c=nh(c),ko(i.stateNode,i.type,c))}}function Lu(i){pi?gi?gi.push(i):gi=[i]:pi=i}function Pu(){if(pi){var i=pi,c=gi;if(gi=pi=null,fl(i),c)for(i=0;i<c.length;i++)fl(c[i])}}function Iu(i,c){return i(c)}function Ou(){}var Hc=!1;function Mu(i,c,h){if(Hc)return i(c,h);Hc=!0;try{return Iu(i,c,h)}finally{Hc=!1,(pi!==null||gi!==null)&&(Ou(),Pu())}}function pl(i,c){var h=i.stateNode;if(h===null)return null;var v=nh(h);if(v===null)return null;h=v[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(i=i.type,v=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!v;break e;default:i=!1}if(i)return null;if(h&&typeof h!="function")throw Error(a(231,c,typeof h));return h}var Vc=!1;if(d)try{var Os={};Object.defineProperty(Os,"passive",{get:function(){Vc=!0}}),window.addEventListener("test",Os,Os),window.removeEventListener("test",Os,Os)}catch{Vc=!1}function px(i,c,h,v,k,A,U,le,de){var we=Array.prototype.slice.call(arguments,3);try{c.apply(h,we)}catch(Fe){this.onError(Fe)}}var gl=!1,To=null,G=!1,ae=null,Y={onError:function(i){gl=!0,To=i}};function ee(i,c,h,v,k,A,U,le,de){gl=!1,To=null,px.apply(Y,arguments)}function re(i,c,h,v,k,A,U,le,de){if(ee.apply(this,arguments),gl){if(gl){var we=To;gl=!1,To=null}else throw Error(a(198));G||(G=!0,ae=we)}}function se(i){var c=i,h=i;if(i.alternate)for(;c.return;)c=c.return;else{i=c;do c=i,(c.flags&4098)!==0&&(h=c.return),i=c.return;while(i)}return c.tag===3?h:null}function ve(i){if(i.tag===13){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function Ce(i){if(se(i)!==i)throw Error(a(188))}function ye(i){var c=i.alternate;if(!c){if(c=se(i),c===null)throw Error(a(188));return c!==i?null:i}for(var h=i,v=c;;){var k=h.return;if(k===null)break;var A=k.alternate;if(A===null){if(v=k.return,v!==null){h=v;continue}break}if(k.child===A.child){for(A=k.child;A;){if(A===h)return Ce(k),i;if(A===v)return Ce(k),c;A=A.sibling}throw Error(a(188))}if(h.return!==v.return)h=k,v=A;else{for(var U=!1,le=k.child;le;){if(le===h){U=!0,h=k,v=A;break}if(le===v){U=!0,v=k,h=A;break}le=le.sibling}if(!U){for(le=A.child;le;){if(le===h){U=!0,h=A,v=k;break}if(le===v){U=!0,v=A,h=k;break}le=le.sibling}if(!U)throw Error(a(189))}}if(h.alternate!==v)throw Error(a(190))}if(h.tag!==3)throw Error(a(188));return h.stateNode.current===h?i:c}function Ne(i){return i=ye(i),i!==null?je(i):null}function je(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var c=je(i);if(c!==null)return c;i=i.sibling}return null}var Pe=n.unstable_scheduleCallback,ze=n.unstable_cancelCallback,qe=n.unstable_shouldYield,He=n.unstable_requestPaint,Me=n.unstable_now,mt=n.unstable_getCurrentPriorityLevel,Qt=n.unstable_ImmediatePriority,tn=n.unstable_UserBlockingPriority,Sn=n.unstable_NormalPriority,yl=n.unstable_LowPriority,yi=n.unstable_IdlePriority,os=null,Qn=null;function Uc(i){if(Qn&&typeof Qn.onCommitFiberRoot=="function")try{Qn.onCommitFiberRoot(os,i,void 0,(i.current.flags&128)===128)}catch{}}var _n=Math.clz32?Math.clz32:UT,HT=Math.log,VT=Math.LN2;function UT(i){return i>>>=0,i===0?32:31-(HT(i)/VT|0)|0}var Ru=64,Bu=4194304;function Kc(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Hu(i,c){var h=i.pendingLanes;if(h===0)return 0;var v=0,k=i.suspendedLanes,A=i.pingedLanes,U=h&268435455;if(U!==0){var le=U&~k;le!==0?v=Kc(le):(A&=U,A!==0&&(v=Kc(A)))}else U=h&~k,U!==0?v=Kc(U):A!==0&&(v=Kc(A));if(v===0)return 0;if(c!==0&&c!==v&&(c&k)===0&&(k=v&-v,A=c&-c,k>=A||k===16&&(A&4194240)!==0))return c;if((v&4)!==0&&(v|=h&16),c=i.entangledLanes,c!==0)for(i=i.entanglements,c&=v;0<c;)h=31-_n(c),k=1<<h,v|=i[h],c&=~k;return v}function KT(i,c){switch(i){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zT(i,c){for(var h=i.suspendedLanes,v=i.pingedLanes,k=i.expirationTimes,A=i.pendingLanes;0<A;){var U=31-_n(A),le=1<<U,de=k[U];de===-1?((le&h)===0||(le&v)!==0)&&(k[U]=KT(le,c)):de<=c&&(i.expiredLanes|=le),A&=~le}}function gx(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function oy(){var i=Ru;return Ru<<=1,(Ru&4194240)===0&&(Ru=64),i}function yx(i){for(var c=[],h=0;31>h;h++)c.push(i);return c}function zc(i,c,h){i.pendingLanes|=c,c!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,c=31-_n(c),i[c]=h}function $T(i,c){var h=i.pendingLanes&~c;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=c,i.mutableReadLanes&=c,i.entangledLanes&=c,c=i.entanglements;var v=i.eventTimes;for(i=i.expirationTimes;0<h;){var k=31-_n(h),A=1<<k;c[k]=0,v[k]=-1,i[k]=-1,h&=~A}}function vx(i,c){var h=i.entangledLanes|=c;for(i=i.entanglements;h;){var v=31-_n(h),k=1<<v;k&c|i[v]&c&&(i[v]|=c),h&=~k}}var zt=0;function cy(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var dy,bx,uy,hy,xy,Nx=!1,Vu=[],vi=null,bi=null,Ni=null,$c=new Map,Gc=new Map,ji=[],GT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function my(i,c){switch(i){case"focusin":case"focusout":vi=null;break;case"dragenter":case"dragleave":bi=null;break;case"mouseover":case"mouseout":Ni=null;break;case"pointerover":case"pointerout":$c.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gc.delete(c.pointerId)}}function qc(i,c,h,v,k,A){return i===null||i.nativeEvent!==A?(i={blockedOn:c,domEventName:h,eventSystemFlags:v,nativeEvent:A,targetContainers:[k]},c!==null&&(c=ld(c),c!==null&&bx(c)),i):(i.eventSystemFlags|=v,c=i.targetContainers,k!==null&&c.indexOf(k)===-1&&c.push(k),i)}function qT(i,c,h,v,k){switch(c){case"focusin":return vi=qc(vi,i,c,h,v,k),!0;case"dragenter":return bi=qc(bi,i,c,h,v,k),!0;case"mouseover":return Ni=qc(Ni,i,c,h,v,k),!0;case"pointerover":var A=k.pointerId;return $c.set(A,qc($c.get(A)||null,i,c,h,v,k)),!0;case"gotpointercapture":return A=k.pointerId,Gc.set(A,qc(Gc.get(A)||null,i,c,h,v,k)),!0}return!1}function fy(i){var c=vl(i.target);if(c!==null){var h=se(c);if(h!==null){if(c=h.tag,c===13){if(c=ve(h),c!==null){i.blockedOn=c,xy(i.priority,function(){uy(h)});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){i.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Uu(i){if(i.blockedOn!==null)return!1;for(var c=i.targetContainers;0<c.length;){var h=wx(i.domEventName,i.eventSystemFlags,c[0],i.nativeEvent);if(h===null){h=i.nativeEvent;var v=new h.constructor(h.type,h);ls=v,h.target.dispatchEvent(v),ls=null}else return c=ld(h),c!==null&&bx(c),i.blockedOn=h,!1;c.shift()}return!0}function py(i,c,h){Uu(i)&&h.delete(c)}function WT(){Nx=!1,vi!==null&&Uu(vi)&&(vi=null),bi!==null&&Uu(bi)&&(bi=null),Ni!==null&&Uu(Ni)&&(Ni=null),$c.forEach(py),Gc.forEach(py)}function Wc(i,c){i.blockedOn===c&&(i.blockedOn=null,Nx||(Nx=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,WT)))}function Xc(i){function c(k){return Wc(k,i)}if(0<Vu.length){Wc(Vu[0],i);for(var h=1;h<Vu.length;h++){var v=Vu[h];v.blockedOn===i&&(v.blockedOn=null)}}for(vi!==null&&Wc(vi,i),bi!==null&&Wc(bi,i),Ni!==null&&Wc(Ni,i),$c.forEach(c),Gc.forEach(c),h=0;h<ji.length;h++)v=ji[h],v.blockedOn===i&&(v.blockedOn=null);for(;0<ji.length&&(h=ji[0],h.blockedOn===null);)fy(h),h.blockedOn===null&&ji.shift()}var Co=w.ReactCurrentBatchConfig,Ku=!0;function XT(i,c,h,v){var k=zt,A=Co.transition;Co.transition=null;try{zt=1,jx(i,c,h,v)}finally{zt=k,Co.transition=A}}function QT(i,c,h,v){var k=zt,A=Co.transition;Co.transition=null;try{zt=4,jx(i,c,h,v)}finally{zt=k,Co.transition=A}}function jx(i,c,h,v){if(Ku){var k=wx(i,c,h,v);if(k===null)Hx(i,c,v,zu,h),my(i,v);else if(qT(k,i,c,h,v))v.stopPropagation();else if(my(i,v),c&4&&-1<GT.indexOf(i)){for(;k!==null;){var A=ld(k);if(A!==null&&dy(A),A=wx(i,c,h,v),A===null&&Hx(i,c,v,zu,h),A===k)break;k=A}k!==null&&v.stopPropagation()}else Hx(i,c,v,null,h)}}var zu=null;function wx(i,c,h,v){if(zu=null,i=fi(v),i=vl(i),i!==null)if(c=se(i),c===null)i=null;else if(h=c.tag,h===13){if(i=ve(c),i!==null)return i;i=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;i=null}else c!==i&&(i=null);return zu=i,null}function gy(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mt()){case Qt:return 1;case tn:return 4;case Sn:case yl:return 16;case yi:return 536870912;default:return 16}default:return 16}}var wi=null,kx=null,$u=null;function yy(){if($u)return $u;var i,c=kx,h=c.length,v,k="value"in wi?wi.value:wi.textContent,A=k.length;for(i=0;i<h&&c[i]===k[i];i++);var U=h-i;for(v=1;v<=U&&c[h-v]===k[A-v];v++);return $u=k.slice(i,1<v?1-v:void 0)}function Gu(i){var c=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&c===13&&(i=13)):i=c,i===10&&(i=13),32<=i||i===13?i:0}function qu(){return!0}function vy(){return!1}function ir(i){function c(h,v,k,A,U){this._reactName=h,this._targetInst=k,this.type=v,this.nativeEvent=A,this.target=U,this.currentTarget=null;for(var le in i)i.hasOwnProperty(le)&&(h=i[le],this[le]=h?h(A):A[le]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?qu:vy,this.isPropagationStopped=vy,this}return fe(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=qu)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=qu)},persist:function(){},isPersistent:qu}),c}var So={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Tx=ir(So),Qc=fe({},So,{view:0,detail:0}),YT=ir(Qc),Cx,Sx,Yc,Wu=fe({},Qc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ex,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Yc&&(Yc&&i.type==="mousemove"?(Cx=i.screenX-Yc.screenX,Sx=i.screenY-Yc.screenY):Sx=Cx=0,Yc=i),Cx)},movementY:function(i){return"movementY"in i?i.movementY:Sx}}),by=ir(Wu),JT=fe({},Wu,{dataTransfer:0}),ZT=ir(JT),e4=fe({},Qc,{relatedTarget:0}),_x=ir(e4),t4=fe({},So,{animationName:0,elapsedTime:0,pseudoElement:0}),n4=ir(t4),a4=fe({},So,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),r4=ir(a4),s4=fe({},So,{data:0}),Ny=ir(s4),i4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},l4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},o4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function c4(i){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(i):(i=o4[i])?!!c[i]:!1}function Ex(){return c4}var d4=fe({},Qc,{key:function(i){if(i.key){var c=i4[i.key]||i.key;if(c!=="Unidentified")return c}return i.type==="keypress"?(i=Gu(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?l4[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ex,charCode:function(i){return i.type==="keypress"?Gu(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Gu(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),u4=ir(d4),h4=fe({},Wu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jy=ir(h4),x4=fe({},Qc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ex}),m4=ir(x4),f4=fe({},So,{propertyName:0,elapsedTime:0,pseudoElement:0}),p4=ir(f4),g4=fe({},Wu,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),y4=ir(g4),v4=[9,13,27,32],Dx=d&&"CompositionEvent"in window,Jc=null;d&&"documentMode"in document&&(Jc=document.documentMode);var b4=d&&"TextEvent"in window&&!Jc,wy=d&&(!Dx||Jc&&8<Jc&&11>=Jc),ky=" ",Ty=!1;function Cy(i,c){switch(i){case"keyup":return v4.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sy(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var _o=!1;function N4(i,c){switch(i){case"compositionend":return Sy(c);case"keypress":return c.which!==32?null:(Ty=!0,ky);case"textInput":return i=c.data,i===ky&&Ty?null:i;default:return null}}function j4(i,c){if(_o)return i==="compositionend"||!Dx&&Cy(i,c)?(i=yy(),$u=kx=wi=null,_o=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return wy&&c.locale!=="ko"?null:c.data;default:return null}}var w4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _y(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c==="input"?!!w4[i.type]:c==="textarea"}function Ey(i,c,h,v){Lu(v),c=Zu(c,"onChange"),0<c.length&&(h=new Tx("onChange","change",null,h,v),i.push({event:h,listeners:c}))}var Zc=null,ed=null;function k4(i){qy(i,0)}function Xu(i){var c=Lo(i);if(V(c))return i}function T4(i,c){if(i==="change")return c}var Dy=!1;if(d){var Ax;if(d){var Fx="oninput"in document;if(!Fx){var Ay=document.createElement("div");Ay.setAttribute("oninput","return;"),Fx=typeof Ay.oninput=="function"}Ax=Fx}else Ax=!1;Dy=Ax&&(!document.documentMode||9<document.documentMode)}function Fy(){Zc&&(Zc.detachEvent("onpropertychange",Ly),ed=Zc=null)}function Ly(i){if(i.propertyName==="value"&&Xu(ed)){var c=[];Ey(c,ed,i,fi(i)),Mu(k4,c)}}function C4(i,c,h){i==="focusin"?(Fy(),Zc=c,ed=h,Zc.attachEvent("onpropertychange",Ly)):i==="focusout"&&Fy()}function S4(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Xu(ed)}function _4(i,c){if(i==="click")return Xu(c)}function E4(i,c){if(i==="input"||i==="change")return Xu(c)}function D4(i,c){return i===c&&(i!==0||1/i===1/c)||i!==i&&c!==c}var Kr=typeof Object.is=="function"?Object.is:D4;function td(i,c){if(Kr(i,c))return!0;if(typeof i!="object"||i===null||typeof c!="object"||c===null)return!1;var h=Object.keys(i),v=Object.keys(c);if(h.length!==v.length)return!1;for(v=0;v<h.length;v++){var k=h[v];if(!u.call(c,k)||!Kr(i[k],c[k]))return!1}return!0}function Py(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Iy(i,c){var h=Py(i);i=0;for(var v;h;){if(h.nodeType===3){if(v=i+h.textContent.length,i<=c&&v>=c)return{node:h,offset:c-i};i=v}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Py(h)}}function Oy(i,c){return i&&c?i===c?!0:i&&i.nodeType===3?!1:c&&c.nodeType===3?Oy(i,c.parentNode):"contains"in i?i.contains(c):i.compareDocumentPosition?!!(i.compareDocumentPosition(c)&16):!1:!1}function My(){for(var i=window,c=be();c instanceof i.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)i=c.contentWindow;else break;c=be(i.document)}return c}function Lx(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c&&(c==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||c==="textarea"||i.contentEditable==="true")}function A4(i){var c=My(),h=i.focusedElem,v=i.selectionRange;if(c!==h&&h&&h.ownerDocument&&Oy(h.ownerDocument.documentElement,h)){if(v!==null&&Lx(h)){if(c=v.start,i=v.end,i===void 0&&(i=c),"selectionStart"in h)h.selectionStart=c,h.selectionEnd=Math.min(i,h.value.length);else if(i=(c=h.ownerDocument||document)&&c.defaultView||window,i.getSelection){i=i.getSelection();var k=h.textContent.length,A=Math.min(v.start,k);v=v.end===void 0?A:Math.min(v.end,k),!i.extend&&A>v&&(k=v,v=A,A=k),k=Iy(h,A);var U=Iy(h,v);k&&U&&(i.rangeCount!==1||i.anchorNode!==k.node||i.anchorOffset!==k.offset||i.focusNode!==U.node||i.focusOffset!==U.offset)&&(c=c.createRange(),c.setStart(k.node,k.offset),i.removeAllRanges(),A>v?(i.addRange(c),i.extend(U.node,U.offset)):(c.setEnd(U.node,U.offset),i.addRange(c)))}}for(c=[],i=h;i=i.parentNode;)i.nodeType===1&&c.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<c.length;h++)i=c[h],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var F4=d&&"documentMode"in document&&11>=document.documentMode,Eo=null,Px=null,nd=null,Ix=!1;function Ry(i,c,h){var v=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Ix||Eo==null||Eo!==be(v)||(v=Eo,"selectionStart"in v&&Lx(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),nd&&td(nd,v)||(nd=v,v=Zu(Px,"onSelect"),0<v.length&&(c=new Tx("onSelect","select",null,c,h),i.push({event:c,listeners:v}),c.target=Eo)))}function Qu(i,c){var h={};return h[i.toLowerCase()]=c.toLowerCase(),h["Webkit"+i]="webkit"+c,h["Moz"+i]="moz"+c,h}var Do={animationend:Qu("Animation","AnimationEnd"),animationiteration:Qu("Animation","AnimationIteration"),animationstart:Qu("Animation","AnimationStart"),transitionend:Qu("Transition","TransitionEnd")},Ox={},By={};d&&(By=document.createElement("div").style,"AnimationEvent"in window||(delete Do.animationend.animation,delete Do.animationiteration.animation,delete Do.animationstart.animation),"TransitionEvent"in window||delete Do.transitionend.transition);function Yu(i){if(Ox[i])return Ox[i];if(!Do[i])return i;var c=Do[i],h;for(h in c)if(c.hasOwnProperty(h)&&h in By)return Ox[i]=c[h];return i}var Hy=Yu("animationend"),Vy=Yu("animationiteration"),Uy=Yu("animationstart"),Ky=Yu("transitionend"),zy=new Map,$y="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ki(i,c){zy.set(i,c),l(c,[i])}for(var Mx=0;Mx<$y.length;Mx++){var Rx=$y[Mx],L4=Rx.toLowerCase(),P4=Rx[0].toUpperCase()+Rx.slice(1);ki(L4,"on"+P4)}ki(Hy,"onAnimationEnd"),ki(Vy,"onAnimationIteration"),ki(Uy,"onAnimationStart"),ki("dblclick","onDoubleClick"),ki("focusin","onFocus"),ki("focusout","onBlur"),ki(Ky,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ad="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),I4=new Set("cancel close invalid load scroll toggle".split(" ").concat(ad));function Gy(i,c,h){var v=i.type||"unknown-event";i.currentTarget=h,re(v,c,void 0,i),i.currentTarget=null}function qy(i,c){c=(c&4)!==0;for(var h=0;h<i.length;h++){var v=i[h],k=v.event;v=v.listeners;e:{var A=void 0;if(c)for(var U=v.length-1;0<=U;U--){var le=v[U],de=le.instance,we=le.currentTarget;if(le=le.listener,de!==A&&k.isPropagationStopped())break e;Gy(k,le,we),A=de}else for(U=0;U<v.length;U++){if(le=v[U],de=le.instance,we=le.currentTarget,le=le.listener,de!==A&&k.isPropagationStopped())break e;Gy(k,le,we),A=de}}}if(G)throw i=ae,G=!1,ae=null,i}function rn(i,c){var h=c[Gx];h===void 0&&(h=c[Gx]=new Set);var v=i+"__bubble";h.has(v)||(Wy(c,i,2,!1),h.add(v))}function Bx(i,c,h){var v=0;c&&(v|=4),Wy(h,i,v,c)}var Ju="_reactListening"+Math.random().toString(36).slice(2);function rd(i){if(!i[Ju]){i[Ju]=!0,r.forEach(function(h){h!=="selectionchange"&&(I4.has(h)||Bx(h,!1,i),Bx(h,!0,i))});var c=i.nodeType===9?i:i.ownerDocument;c===null||c[Ju]||(c[Ju]=!0,Bx("selectionchange",!1,c))}}function Wy(i,c,h,v){switch(gy(c)){case 1:var k=XT;break;case 4:k=QT;break;default:k=jx}h=k.bind(null,c,h,i),k=void 0,!Vc||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(k=!0),v?k!==void 0?i.addEventListener(c,h,{capture:!0,passive:k}):i.addEventListener(c,h,!0):k!==void 0?i.addEventListener(c,h,{passive:k}):i.addEventListener(c,h,!1)}function Hx(i,c,h,v,k){var A=v;if((c&1)===0&&(c&2)===0&&v!==null)e:for(;;){if(v===null)return;var U=v.tag;if(U===3||U===4){var le=v.stateNode.containerInfo;if(le===k||le.nodeType===8&&le.parentNode===k)break;if(U===4)for(U=v.return;U!==null;){var de=U.tag;if((de===3||de===4)&&(de=U.stateNode.containerInfo,de===k||de.nodeType===8&&de.parentNode===k))return;U=U.return}for(;le!==null;){if(U=vl(le),U===null)return;if(de=U.tag,de===5||de===6){v=A=U;continue e}le=le.parentNode}}v=v.return}Mu(function(){var we=A,Fe=fi(h),Ie=[];e:{var Ae=zy.get(i);if(Ae!==void 0){var Ge=Tx,Xe=i;switch(i){case"keypress":if(Gu(h)===0)break e;case"keydown":case"keyup":Ge=u4;break;case"focusin":Xe="focus",Ge=_x;break;case"focusout":Xe="blur",Ge=_x;break;case"beforeblur":case"afterblur":Ge=_x;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ge=by;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ge=ZT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ge=m4;break;case Hy:case Vy:case Uy:Ge=n4;break;case Ky:Ge=p4;break;case"scroll":Ge=YT;break;case"wheel":Ge=y4;break;case"copy":case"cut":case"paste":Ge=r4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ge=jy}var Ze=(c&4)!==0,En=!Ze&&i==="scroll",pe=Ze?Ae!==null?Ae+"Capture":null:Ae;Ze=[];for(var me=we,ge;me!==null;){ge=me;var Ve=ge.stateNode;if(ge.tag===5&&Ve!==null&&(ge=Ve,pe!==null&&(Ve=pl(me,pe),Ve!=null&&Ze.push(sd(me,Ve,ge)))),En)break;me=me.return}0<Ze.length&&(Ae=new Ge(Ae,Xe,null,h,Fe),Ie.push({event:Ae,listeners:Ze}))}}if((c&7)===0){e:{if(Ae=i==="mouseover"||i==="pointerover",Ge=i==="mouseout"||i==="pointerout",Ae&&h!==ls&&(Xe=h.relatedTarget||h.fromElement)&&(vl(Xe)||Xe[Ms]))break e;if((Ge||Ae)&&(Ae=Fe.window===Fe?Fe:(Ae=Fe.ownerDocument)?Ae.defaultView||Ae.parentWindow:window,Ge?(Xe=h.relatedTarget||h.toElement,Ge=we,Xe=Xe?vl(Xe):null,Xe!==null&&(En=se(Xe),Xe!==En||Xe.tag!==5&&Xe.tag!==6)&&(Xe=null)):(Ge=null,Xe=we),Ge!==Xe)){if(Ze=by,Ve="onMouseLeave",pe="onMouseEnter",me="mouse",(i==="pointerout"||i==="pointerover")&&(Ze=jy,Ve="onPointerLeave",pe="onPointerEnter",me="pointer"),En=Ge==null?Ae:Lo(Ge),ge=Xe==null?Ae:Lo(Xe),Ae=new Ze(Ve,me+"leave",Ge,h,Fe),Ae.target=En,Ae.relatedTarget=ge,Ve=null,vl(Fe)===we&&(Ze=new Ze(pe,me+"enter",Xe,h,Fe),Ze.target=ge,Ze.relatedTarget=En,Ve=Ze),En=Ve,Ge&&Xe)t:{for(Ze=Ge,pe=Xe,me=0,ge=Ze;ge;ge=Ao(ge))me++;for(ge=0,Ve=pe;Ve;Ve=Ao(Ve))ge++;for(;0<me-ge;)Ze=Ao(Ze),me--;for(;0<ge-me;)pe=Ao(pe),ge--;for(;me--;){if(Ze===pe||pe!==null&&Ze===pe.alternate)break t;Ze=Ao(Ze),pe=Ao(pe)}Ze=null}else Ze=null;Ge!==null&&Xy(Ie,Ae,Ge,Ze,!1),Xe!==null&&En!==null&&Xy(Ie,En,Xe,Ze,!0)}}e:{if(Ae=we?Lo(we):window,Ge=Ae.nodeName&&Ae.nodeName.toLowerCase(),Ge==="select"||Ge==="input"&&Ae.type==="file")var et=T4;else if(_y(Ae))if(Dy)et=E4;else{et=S4;var it=C4}else(Ge=Ae.nodeName)&&Ge.toLowerCase()==="input"&&(Ae.type==="checkbox"||Ae.type==="radio")&&(et=_4);if(et&&(et=et(i,we))){Ey(Ie,et,h,Fe);break e}it&&it(i,Ae,we),i==="focusout"&&(it=Ae._wrapperState)&&it.controlled&&Ae.type==="number"&&un(Ae,"number",Ae.value)}switch(it=we?Lo(we):window,i){case"focusin":(_y(it)||it.contentEditable==="true")&&(Eo=it,Px=we,nd=null);break;case"focusout":nd=Px=Eo=null;break;case"mousedown":Ix=!0;break;case"contextmenu":case"mouseup":case"dragend":Ix=!1,Ry(Ie,h,Fe);break;case"selectionchange":if(F4)break;case"keydown":case"keyup":Ry(Ie,h,Fe)}var lt;if(Dx)e:{switch(i){case"compositionstart":var ht="onCompositionStart";break e;case"compositionend":ht="onCompositionEnd";break e;case"compositionupdate":ht="onCompositionUpdate";break e}ht=void 0}else _o?Cy(i,h)&&(ht="onCompositionEnd"):i==="keydown"&&h.keyCode===229&&(ht="onCompositionStart");ht&&(wy&&h.locale!=="ko"&&(_o||ht!=="onCompositionStart"?ht==="onCompositionEnd"&&_o&&(lt=yy()):(wi=Fe,kx="value"in wi?wi.value:wi.textContent,_o=!0)),it=Zu(we,ht),0<it.length&&(ht=new Ny(ht,i,null,h,Fe),Ie.push({event:ht,listeners:it}),lt?ht.data=lt:(lt=Sy(h),lt!==null&&(ht.data=lt)))),(lt=b4?N4(i,h):j4(i,h))&&(we=Zu(we,"onBeforeInput"),0<we.length&&(Fe=new Ny("onBeforeInput","beforeinput",null,h,Fe),Ie.push({event:Fe,listeners:we}),Fe.data=lt))}qy(Ie,c)})}function sd(i,c,h){return{instance:i,listener:c,currentTarget:h}}function Zu(i,c){for(var h=c+"Capture",v=[];i!==null;){var k=i,A=k.stateNode;k.tag===5&&A!==null&&(k=A,A=pl(i,h),A!=null&&v.unshift(sd(i,A,k)),A=pl(i,c),A!=null&&v.push(sd(i,A,k))),i=i.return}return v}function Ao(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function Xy(i,c,h,v,k){for(var A=c._reactName,U=[];h!==null&&h!==v;){var le=h,de=le.alternate,we=le.stateNode;if(de!==null&&de===v)break;le.tag===5&&we!==null&&(le=we,k?(de=pl(h,A),de!=null&&U.unshift(sd(h,de,le))):k||(de=pl(h,A),de!=null&&U.push(sd(h,de,le)))),h=h.return}U.length!==0&&i.push({event:c,listeners:U})}var O4=/\r\n?/g,M4=/\u0000|\uFFFD/g;function Qy(i){return(typeof i=="string"?i:""+i).replace(O4,`
`).replace(M4,"")}function eh(i,c,h){if(c=Qy(c),Qy(i)!==c&&h)throw Error(a(425))}function th(){}var Vx=null,Ux=null;function Kx(i,c){return i==="textarea"||i==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var zx=typeof setTimeout=="function"?setTimeout:void 0,R4=typeof clearTimeout=="function"?clearTimeout:void 0,Yy=typeof Promise=="function"?Promise:void 0,B4=typeof queueMicrotask=="function"?queueMicrotask:typeof Yy<"u"?function(i){return Yy.resolve(null).then(i).catch(H4)}:zx;function H4(i){setTimeout(function(){throw i})}function $x(i,c){var h=c,v=0;do{var k=h.nextSibling;if(i.removeChild(h),k&&k.nodeType===8)if(h=k.data,h==="/$"){if(v===0){i.removeChild(k),Xc(c);return}v--}else h!=="$"&&h!=="$?"&&h!=="$!"||v++;h=k}while(h);Xc(c)}function Ti(i){for(;i!=null;i=i.nextSibling){var c=i.nodeType;if(c===1||c===3)break;if(c===8){if(c=i.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return i}function Jy(i){i=i.previousSibling;for(var c=0;i;){if(i.nodeType===8){var h=i.data;if(h==="$"||h==="$!"||h==="$?"){if(c===0)return i;c--}else h==="/$"&&c++}i=i.previousSibling}return null}var Fo=Math.random().toString(36).slice(2),cs="__reactFiber$"+Fo,id="__reactProps$"+Fo,Ms="__reactContainer$"+Fo,Gx="__reactEvents$"+Fo,V4="__reactListeners$"+Fo,U4="__reactHandles$"+Fo;function vl(i){var c=i[cs];if(c)return c;for(var h=i.parentNode;h;){if(c=h[Ms]||h[cs]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(i=Jy(i);i!==null;){if(h=i[cs])return h;i=Jy(i)}return c}i=h,h=i.parentNode}return null}function ld(i){return i=i[cs]||i[Ms],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Lo(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(a(33))}function nh(i){return i[id]||null}var qx=[],Po=-1;function Ci(i){return{current:i}}function sn(i){0>Po||(i.current=qx[Po],qx[Po]=null,Po--)}function nn(i,c){Po++,qx[Po]=i.current,i.current=c}var Si={},fa=Ci(Si),Va=Ci(!1),bl=Si;function Io(i,c){var h=i.type.contextTypes;if(!h)return Si;var v=i.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===c)return v.__reactInternalMemoizedMaskedChildContext;var k={},A;for(A in h)k[A]=c[A];return v&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=c,i.__reactInternalMemoizedMaskedChildContext=k),k}function Ua(i){return i=i.childContextTypes,i!=null}function ah(){sn(Va),sn(fa)}function Zy(i,c,h){if(fa.current!==Si)throw Error(a(168));nn(fa,c),nn(Va,h)}function ev(i,c,h){var v=i.stateNode;if(c=c.childContextTypes,typeof v.getChildContext!="function")return h;v=v.getChildContext();for(var k in v)if(!(k in c))throw Error(a(108,xe(i)||"Unknown",k));return fe({},h,v)}function rh(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Si,bl=fa.current,nn(fa,i),nn(Va,Va.current),!0}function tv(i,c,h){var v=i.stateNode;if(!v)throw Error(a(169));h?(i=ev(i,c,bl),v.__reactInternalMemoizedMergedChildContext=i,sn(Va),sn(fa),nn(fa,i)):sn(Va),nn(Va,h)}var Rs=null,sh=!1,Wx=!1;function nv(i){Rs===null?Rs=[i]:Rs.push(i)}function K4(i){sh=!0,nv(i)}function _i(){if(!Wx&&Rs!==null){Wx=!0;var i=0,c=zt;try{var h=Rs;for(zt=1;i<h.length;i++){var v=h[i];do v=v(!0);while(v!==null)}Rs=null,sh=!1}catch(k){throw Rs!==null&&(Rs=Rs.slice(i+1)),Pe(Qt,_i),k}finally{zt=c,Wx=!1}}return null}var Oo=[],Mo=0,ih=null,lh=0,jr=[],wr=0,Nl=null,Bs=1,Hs="";function jl(i,c){Oo[Mo++]=lh,Oo[Mo++]=ih,ih=i,lh=c}function av(i,c,h){jr[wr++]=Bs,jr[wr++]=Hs,jr[wr++]=Nl,Nl=i;var v=Bs;i=Hs;var k=32-_n(v)-1;v&=~(1<<k),h+=1;var A=32-_n(c)+k;if(30<A){var U=k-k%5;A=(v&(1<<U)-1).toString(32),v>>=U,k-=U,Bs=1<<32-_n(c)+k|h<<k|v,Hs=A+i}else Bs=1<<A|h<<k|v,Hs=i}function Xx(i){i.return!==null&&(jl(i,1),av(i,1,0))}function Qx(i){for(;i===ih;)ih=Oo[--Mo],Oo[Mo]=null,lh=Oo[--Mo],Oo[Mo]=null;for(;i===Nl;)Nl=jr[--wr],jr[wr]=null,Hs=jr[--wr],jr[wr]=null,Bs=jr[--wr],jr[wr]=null}var lr=null,or=null,xn=!1,zr=null;function rv(i,c){var h=Sr(5,null,null,0);h.elementType="DELETED",h.stateNode=c,h.return=i,c=i.deletions,c===null?(i.deletions=[h],i.flags|=16):c.push(h)}function sv(i,c){switch(i.tag){case 5:var h=i.type;return c=c.nodeType!==1||h.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(i.stateNode=c,lr=i,or=Ti(c.firstChild),!0):!1;case 6:return c=i.pendingProps===""||c.nodeType!==3?null:c,c!==null?(i.stateNode=c,lr=i,or=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(h=Nl!==null?{id:Bs,overflow:Hs}:null,i.memoizedState={dehydrated:c,treeContext:h,retryLane:1073741824},h=Sr(18,null,null,0),h.stateNode=c,h.return=i,i.child=h,lr=i,or=null,!0):!1;default:return!1}}function Yx(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Jx(i){if(xn){var c=or;if(c){var h=c;if(!sv(i,c)){if(Yx(i))throw Error(a(418));c=Ti(h.nextSibling);var v=lr;c&&sv(i,c)?rv(v,h):(i.flags=i.flags&-4097|2,xn=!1,lr=i)}}else{if(Yx(i))throw Error(a(418));i.flags=i.flags&-4097|2,xn=!1,lr=i}}}function iv(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;lr=i}function oh(i){if(i!==lr)return!1;if(!xn)return iv(i),xn=!0,!1;var c;if((c=i.tag!==3)&&!(c=i.tag!==5)&&(c=i.type,c=c!=="head"&&c!=="body"&&!Kx(i.type,i.memoizedProps)),c&&(c=or)){if(Yx(i))throw lv(),Error(a(418));for(;c;)rv(i,c),c=Ti(c.nextSibling)}if(iv(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));e:{for(i=i.nextSibling,c=0;i;){if(i.nodeType===8){var h=i.data;if(h==="/$"){if(c===0){or=Ti(i.nextSibling);break e}c--}else h!=="$"&&h!=="$!"&&h!=="$?"||c++}i=i.nextSibling}or=null}}else or=lr?Ti(i.stateNode.nextSibling):null;return!0}function lv(){for(var i=or;i;)i=Ti(i.nextSibling)}function Ro(){or=lr=null,xn=!1}function Zx(i){zr===null?zr=[i]:zr.push(i)}var z4=w.ReactCurrentBatchConfig;function od(i,c,h){if(i=h.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(a(309));var v=h.stateNode}if(!v)throw Error(a(147,i));var k=v,A=""+i;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===A?c.ref:(c=function(U){var le=k.refs;U===null?delete le[A]:le[A]=U},c._stringRef=A,c)}if(typeof i!="string")throw Error(a(284));if(!h._owner)throw Error(a(290,i))}return i}function ch(i,c){throw i=Object.prototype.toString.call(c),Error(a(31,i==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":i))}function ov(i){var c=i._init;return c(i._payload)}function cv(i){function c(pe,me){if(i){var ge=pe.deletions;ge===null?(pe.deletions=[me],pe.flags|=16):ge.push(me)}}function h(pe,me){if(!i)return null;for(;me!==null;)c(pe,me),me=me.sibling;return null}function v(pe,me){for(pe=new Map;me!==null;)me.key!==null?pe.set(me.key,me):pe.set(me.index,me),me=me.sibling;return pe}function k(pe,me){return pe=Oi(pe,me),pe.index=0,pe.sibling=null,pe}function A(pe,me,ge){return pe.index=ge,i?(ge=pe.alternate,ge!==null?(ge=ge.index,ge<me?(pe.flags|=2,me):ge):(pe.flags|=2,me)):(pe.flags|=1048576,me)}function U(pe){return i&&pe.alternate===null&&(pe.flags|=2),pe}function le(pe,me,ge,Ve){return me===null||me.tag!==6?(me=zm(ge,pe.mode,Ve),me.return=pe,me):(me=k(me,ge),me.return=pe,me)}function de(pe,me,ge,Ve){var et=ge.type;return et===C?Fe(pe,me,ge.props.children,Ve,ge.key):me!==null&&(me.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===ue&&ov(et)===me.type)?(Ve=k(me,ge.props),Ve.ref=od(pe,me,ge),Ve.return=pe,Ve):(Ve=Lh(ge.type,ge.key,ge.props,null,pe.mode,Ve),Ve.ref=od(pe,me,ge),Ve.return=pe,Ve)}function we(pe,me,ge,Ve){return me===null||me.tag!==4||me.stateNode.containerInfo!==ge.containerInfo||me.stateNode.implementation!==ge.implementation?(me=$m(ge,pe.mode,Ve),me.return=pe,me):(me=k(me,ge.children||[]),me.return=pe,me)}function Fe(pe,me,ge,Ve,et){return me===null||me.tag!==7?(me=Dl(ge,pe.mode,Ve,et),me.return=pe,me):(me=k(me,ge),me.return=pe,me)}function Ie(pe,me,ge){if(typeof me=="string"&&me!==""||typeof me=="number")return me=zm(""+me,pe.mode,ge),me.return=pe,me;if(typeof me=="object"&&me!==null){switch(me.$$typeof){case _:return ge=Lh(me.type,me.key,me.props,null,pe.mode,ge),ge.ref=od(pe,null,me),ge.return=pe,ge;case E:return me=$m(me,pe.mode,ge),me.return=pe,me;case ue:var Ve=me._init;return Ie(pe,Ve(me._payload),ge)}if(hn(me)||Q(me))return me=Dl(me,pe.mode,ge,null),me.return=pe,me;ch(pe,me)}return null}function Ae(pe,me,ge,Ve){var et=me!==null?me.key:null;if(typeof ge=="string"&&ge!==""||typeof ge=="number")return et!==null?null:le(pe,me,""+ge,Ve);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case _:return ge.key===et?de(pe,me,ge,Ve):null;case E:return ge.key===et?we(pe,me,ge,Ve):null;case ue:return et=ge._init,Ae(pe,me,et(ge._payload),Ve)}if(hn(ge)||Q(ge))return et!==null?null:Fe(pe,me,ge,Ve,null);ch(pe,ge)}return null}function Ge(pe,me,ge,Ve,et){if(typeof Ve=="string"&&Ve!==""||typeof Ve=="number")return pe=pe.get(ge)||null,le(me,pe,""+Ve,et);if(typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case _:return pe=pe.get(Ve.key===null?ge:Ve.key)||null,de(me,pe,Ve,et);case E:return pe=pe.get(Ve.key===null?ge:Ve.key)||null,we(me,pe,Ve,et);case ue:var it=Ve._init;return Ge(pe,me,ge,it(Ve._payload),et)}if(hn(Ve)||Q(Ve))return pe=pe.get(ge)||null,Fe(me,pe,Ve,et,null);ch(me,Ve)}return null}function Xe(pe,me,ge,Ve){for(var et=null,it=null,lt=me,ht=me=0,Zn=null;lt!==null&&ht<ge.length;ht++){lt.index>ht?(Zn=lt,lt=null):Zn=lt.sibling;var It=Ae(pe,lt,ge[ht],Ve);if(It===null){lt===null&&(lt=Zn);break}i&&lt&&It.alternate===null&&c(pe,lt),me=A(It,me,ht),it===null?et=It:it.sibling=It,it=It,lt=Zn}if(ht===ge.length)return h(pe,lt),xn&&jl(pe,ht),et;if(lt===null){for(;ht<ge.length;ht++)lt=Ie(pe,ge[ht],Ve),lt!==null&&(me=A(lt,me,ht),it===null?et=lt:it.sibling=lt,it=lt);return xn&&jl(pe,ht),et}for(lt=v(pe,lt);ht<ge.length;ht++)Zn=Ge(lt,pe,ht,ge[ht],Ve),Zn!==null&&(i&&Zn.alternate!==null&&lt.delete(Zn.key===null?ht:Zn.key),me=A(Zn,me,ht),it===null?et=Zn:it.sibling=Zn,it=Zn);return i&&lt.forEach(function(Mi){return c(pe,Mi)}),xn&&jl(pe,ht),et}function Ze(pe,me,ge,Ve){var et=Q(ge);if(typeof et!="function")throw Error(a(150));if(ge=et.call(ge),ge==null)throw Error(a(151));for(var it=et=null,lt=me,ht=me=0,Zn=null,It=ge.next();lt!==null&&!It.done;ht++,It=ge.next()){lt.index>ht?(Zn=lt,lt=null):Zn=lt.sibling;var Mi=Ae(pe,lt,It.value,Ve);if(Mi===null){lt===null&&(lt=Zn);break}i&&lt&&Mi.alternate===null&&c(pe,lt),me=A(Mi,me,ht),it===null?et=Mi:it.sibling=Mi,it=Mi,lt=Zn}if(It.done)return h(pe,lt),xn&&jl(pe,ht),et;if(lt===null){for(;!It.done;ht++,It=ge.next())It=Ie(pe,It.value,Ve),It!==null&&(me=A(It,me,ht),it===null?et=It:it.sibling=It,it=It);return xn&&jl(pe,ht),et}for(lt=v(pe,lt);!It.done;ht++,It=ge.next())It=Ge(lt,pe,ht,It.value,Ve),It!==null&&(i&&It.alternate!==null&&lt.delete(It.key===null?ht:It.key),me=A(It,me,ht),it===null?et=It:it.sibling=It,it=It);return i&&lt.forEach(function(wC){return c(pe,wC)}),xn&&jl(pe,ht),et}function En(pe,me,ge,Ve){if(typeof ge=="object"&&ge!==null&&ge.type===C&&ge.key===null&&(ge=ge.props.children),typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case _:e:{for(var et=ge.key,it=me;it!==null;){if(it.key===et){if(et=ge.type,et===C){if(it.tag===7){h(pe,it.sibling),me=k(it,ge.props.children),me.return=pe,pe=me;break e}}else if(it.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===ue&&ov(et)===it.type){h(pe,it.sibling),me=k(it,ge.props),me.ref=od(pe,it,ge),me.return=pe,pe=me;break e}h(pe,it);break}else c(pe,it);it=it.sibling}ge.type===C?(me=Dl(ge.props.children,pe.mode,Ve,ge.key),me.return=pe,pe=me):(Ve=Lh(ge.type,ge.key,ge.props,null,pe.mode,Ve),Ve.ref=od(pe,me,ge),Ve.return=pe,pe=Ve)}return U(pe);case E:e:{for(it=ge.key;me!==null;){if(me.key===it)if(me.tag===4&&me.stateNode.containerInfo===ge.containerInfo&&me.stateNode.implementation===ge.implementation){h(pe,me.sibling),me=k(me,ge.children||[]),me.return=pe,pe=me;break e}else{h(pe,me);break}else c(pe,me);me=me.sibling}me=$m(ge,pe.mode,Ve),me.return=pe,pe=me}return U(pe);case ue:return it=ge._init,En(pe,me,it(ge._payload),Ve)}if(hn(ge))return Xe(pe,me,ge,Ve);if(Q(ge))return Ze(pe,me,ge,Ve);ch(pe,ge)}return typeof ge=="string"&&ge!==""||typeof ge=="number"?(ge=""+ge,me!==null&&me.tag===6?(h(pe,me.sibling),me=k(me,ge),me.return=pe,pe=me):(h(pe,me),me=zm(ge,pe.mode,Ve),me.return=pe,pe=me),U(pe)):h(pe,me)}return En}var Bo=cv(!0),dv=cv(!1),dh=Ci(null),uh=null,Ho=null,em=null;function tm(){em=Ho=uh=null}function nm(i){var c=dh.current;sn(dh),i._currentValue=c}function am(i,c,h){for(;i!==null;){var v=i.alternate;if((i.childLanes&c)!==c?(i.childLanes|=c,v!==null&&(v.childLanes|=c)):v!==null&&(v.childLanes&c)!==c&&(v.childLanes|=c),i===h)break;i=i.return}}function Vo(i,c){uh=i,em=Ho=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&c)!==0&&(Ka=!0),i.firstContext=null)}function kr(i){var c=i._currentValue;if(em!==i)if(i={context:i,memoizedValue:c,next:null},Ho===null){if(uh===null)throw Error(a(308));Ho=i,uh.dependencies={lanes:0,firstContext:i}}else Ho=Ho.next=i;return c}var wl=null;function rm(i){wl===null?wl=[i]:wl.push(i)}function uv(i,c,h,v){var k=c.interleaved;return k===null?(h.next=h,rm(c)):(h.next=k.next,k.next=h),c.interleaved=h,Vs(i,v)}function Vs(i,c){i.lanes|=c;var h=i.alternate;for(h!==null&&(h.lanes|=c),h=i,i=i.return;i!==null;)i.childLanes|=c,h=i.alternate,h!==null&&(h.childLanes|=c),h=i,i=i.return;return h.tag===3?h.stateNode:null}var Ei=!1;function sm(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function hv(i,c){i=i.updateQueue,c.updateQueue===i&&(c.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Us(i,c){return{eventTime:i,lane:c,tag:0,payload:null,callback:null,next:null}}function Di(i,c,h){var v=i.updateQueue;if(v===null)return null;if(v=v.shared,(At&2)!==0){var k=v.pending;return k===null?c.next=c:(c.next=k.next,k.next=c),v.pending=c,Vs(i,h)}return k=v.interleaved,k===null?(c.next=c,rm(v)):(c.next=k.next,k.next=c),v.interleaved=c,Vs(i,h)}function hh(i,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194240)!==0)){var v=c.lanes;v&=i.pendingLanes,h|=v,c.lanes=h,vx(i,h)}}function xv(i,c){var h=i.updateQueue,v=i.alternate;if(v!==null&&(v=v.updateQueue,h===v)){var k=null,A=null;if(h=h.firstBaseUpdate,h!==null){do{var U={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};A===null?k=A=U:A=A.next=U,h=h.next}while(h!==null);A===null?k=A=c:A=A.next=c}else k=A=c;h={baseState:v.baseState,firstBaseUpdate:k,lastBaseUpdate:A,shared:v.shared,effects:v.effects},i.updateQueue=h;return}i=h.lastBaseUpdate,i===null?h.firstBaseUpdate=c:i.next=c,h.lastBaseUpdate=c}function xh(i,c,h,v){var k=i.updateQueue;Ei=!1;var A=k.firstBaseUpdate,U=k.lastBaseUpdate,le=k.shared.pending;if(le!==null){k.shared.pending=null;var de=le,we=de.next;de.next=null,U===null?A=we:U.next=we,U=de;var Fe=i.alternate;Fe!==null&&(Fe=Fe.updateQueue,le=Fe.lastBaseUpdate,le!==U&&(le===null?Fe.firstBaseUpdate=we:le.next=we,Fe.lastBaseUpdate=de))}if(A!==null){var Ie=k.baseState;U=0,Fe=we=de=null,le=A;do{var Ae=le.lane,Ge=le.eventTime;if((v&Ae)===Ae){Fe!==null&&(Fe=Fe.next={eventTime:Ge,lane:0,tag:le.tag,payload:le.payload,callback:le.callback,next:null});e:{var Xe=i,Ze=le;switch(Ae=c,Ge=h,Ze.tag){case 1:if(Xe=Ze.payload,typeof Xe=="function"){Ie=Xe.call(Ge,Ie,Ae);break e}Ie=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=Ze.payload,Ae=typeof Xe=="function"?Xe.call(Ge,Ie,Ae):Xe,Ae==null)break e;Ie=fe({},Ie,Ae);break e;case 2:Ei=!0}}le.callback!==null&&le.lane!==0&&(i.flags|=64,Ae=k.effects,Ae===null?k.effects=[le]:Ae.push(le))}else Ge={eventTime:Ge,lane:Ae,tag:le.tag,payload:le.payload,callback:le.callback,next:null},Fe===null?(we=Fe=Ge,de=Ie):Fe=Fe.next=Ge,U|=Ae;if(le=le.next,le===null){if(le=k.shared.pending,le===null)break;Ae=le,le=Ae.next,Ae.next=null,k.lastBaseUpdate=Ae,k.shared.pending=null}}while(!0);if(Fe===null&&(de=Ie),k.baseState=de,k.firstBaseUpdate=we,k.lastBaseUpdate=Fe,c=k.shared.interleaved,c!==null){k=c;do U|=k.lane,k=k.next;while(k!==c)}else A===null&&(k.shared.lanes=0);Cl|=U,i.lanes=U,i.memoizedState=Ie}}function mv(i,c,h){if(i=c.effects,c.effects=null,i!==null)for(c=0;c<i.length;c++){var v=i[c],k=v.callback;if(k!==null){if(v.callback=null,v=h,typeof k!="function")throw Error(a(191,k));k.call(v)}}}var cd={},ds=Ci(cd),dd=Ci(cd),ud=Ci(cd);function kl(i){if(i===cd)throw Error(a(174));return i}function im(i,c){switch(nn(ud,c),nn(dd,i),nn(ds,cd),i=c.nodeType,i){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Ht(null,"");break;default:i=i===8?c.parentNode:c,c=i.namespaceURI||null,i=i.tagName,c=Ht(c,i)}sn(ds),nn(ds,c)}function Uo(){sn(ds),sn(dd),sn(ud)}function fv(i){kl(ud.current);var c=kl(ds.current),h=Ht(c,i.type);c!==h&&(nn(dd,i),nn(ds,h))}function lm(i){dd.current===i&&(sn(ds),sn(dd))}var pn=Ci(0);function mh(i){for(var c=i;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var om=[];function cm(){for(var i=0;i<om.length;i++)om[i]._workInProgressVersionPrimary=null;om.length=0}var fh=w.ReactCurrentDispatcher,dm=w.ReactCurrentBatchConfig,Tl=0,gn=null,Hn=null,Yn=null,ph=!1,hd=!1,xd=0,$4=0;function pa(){throw Error(a(321))}function um(i,c){if(c===null)return!1;for(var h=0;h<c.length&&h<i.length;h++)if(!Kr(i[h],c[h]))return!1;return!0}function hm(i,c,h,v,k,A){if(Tl=A,gn=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,fh.current=i===null||i.memoizedState===null?X4:Q4,i=h(v,k),hd){A=0;do{if(hd=!1,xd=0,25<=A)throw Error(a(301));A+=1,Yn=Hn=null,c.updateQueue=null,fh.current=Y4,i=h(v,k)}while(hd)}if(fh.current=vh,c=Hn!==null&&Hn.next!==null,Tl=0,Yn=Hn=gn=null,ph=!1,c)throw Error(a(300));return i}function xm(){var i=xd!==0;return xd=0,i}function us(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yn===null?gn.memoizedState=Yn=i:Yn=Yn.next=i,Yn}function Tr(){if(Hn===null){var i=gn.alternate;i=i!==null?i.memoizedState:null}else i=Hn.next;var c=Yn===null?gn.memoizedState:Yn.next;if(c!==null)Yn=c,Hn=i;else{if(i===null)throw Error(a(310));Hn=i,i={memoizedState:Hn.memoizedState,baseState:Hn.baseState,baseQueue:Hn.baseQueue,queue:Hn.queue,next:null},Yn===null?gn.memoizedState=Yn=i:Yn=Yn.next=i}return Yn}function md(i,c){return typeof c=="function"?c(i):c}function mm(i){var c=Tr(),h=c.queue;if(h===null)throw Error(a(311));h.lastRenderedReducer=i;var v=Hn,k=v.baseQueue,A=h.pending;if(A!==null){if(k!==null){var U=k.next;k.next=A.next,A.next=U}v.baseQueue=k=A,h.pending=null}if(k!==null){A=k.next,v=v.baseState;var le=U=null,de=null,we=A;do{var Fe=we.lane;if((Tl&Fe)===Fe)de!==null&&(de=de.next={lane:0,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null}),v=we.hasEagerState?we.eagerState:i(v,we.action);else{var Ie={lane:Fe,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null};de===null?(le=de=Ie,U=v):de=de.next=Ie,gn.lanes|=Fe,Cl|=Fe}we=we.next}while(we!==null&&we!==A);de===null?U=v:de.next=le,Kr(v,c.memoizedState)||(Ka=!0),c.memoizedState=v,c.baseState=U,c.baseQueue=de,h.lastRenderedState=v}if(i=h.interleaved,i!==null){k=i;do A=k.lane,gn.lanes|=A,Cl|=A,k=k.next;while(k!==i)}else k===null&&(h.lanes=0);return[c.memoizedState,h.dispatch]}function fm(i){var c=Tr(),h=c.queue;if(h===null)throw Error(a(311));h.lastRenderedReducer=i;var v=h.dispatch,k=h.pending,A=c.memoizedState;if(k!==null){h.pending=null;var U=k=k.next;do A=i(A,U.action),U=U.next;while(U!==k);Kr(A,c.memoizedState)||(Ka=!0),c.memoizedState=A,c.baseQueue===null&&(c.baseState=A),h.lastRenderedState=A}return[A,v]}function pv(){}function gv(i,c){var h=gn,v=Tr(),k=c(),A=!Kr(v.memoizedState,k);if(A&&(v.memoizedState=k,Ka=!0),v=v.queue,pm(bv.bind(null,h,v,i),[i]),v.getSnapshot!==c||A||Yn!==null&&Yn.memoizedState.tag&1){if(h.flags|=2048,fd(9,vv.bind(null,h,v,k,c),void 0,null),Jn===null)throw Error(a(349));(Tl&30)!==0||yv(h,c,k)}return k}function yv(i,c,h){i.flags|=16384,i={getSnapshot:c,value:h},c=gn.updateQueue,c===null?(c={lastEffect:null,stores:null},gn.updateQueue=c,c.stores=[i]):(h=c.stores,h===null?c.stores=[i]:h.push(i))}function vv(i,c,h,v){c.value=h,c.getSnapshot=v,Nv(c)&&jv(i)}function bv(i,c,h){return h(function(){Nv(c)&&jv(i)})}function Nv(i){var c=i.getSnapshot;i=i.value;try{var h=c();return!Kr(i,h)}catch{return!0}}function jv(i){var c=Vs(i,1);c!==null&&Wr(c,i,1,-1)}function wv(i){var c=us();return typeof i=="function"&&(i=i()),c.memoizedState=c.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:md,lastRenderedState:i},c.queue=i,i=i.dispatch=W4.bind(null,gn,i),[c.memoizedState,i]}function fd(i,c,h,v){return i={tag:i,create:c,destroy:h,deps:v,next:null},c=gn.updateQueue,c===null?(c={lastEffect:null,stores:null},gn.updateQueue=c,c.lastEffect=i.next=i):(h=c.lastEffect,h===null?c.lastEffect=i.next=i:(v=h.next,h.next=i,i.next=v,c.lastEffect=i)),i}function kv(){return Tr().memoizedState}function gh(i,c,h,v){var k=us();gn.flags|=i,k.memoizedState=fd(1|c,h,void 0,v===void 0?null:v)}function yh(i,c,h,v){var k=Tr();v=v===void 0?null:v;var A=void 0;if(Hn!==null){var U=Hn.memoizedState;if(A=U.destroy,v!==null&&um(v,U.deps)){k.memoizedState=fd(c,h,A,v);return}}gn.flags|=i,k.memoizedState=fd(1|c,h,A,v)}function Tv(i,c){return gh(8390656,8,i,c)}function pm(i,c){return yh(2048,8,i,c)}function Cv(i,c){return yh(4,2,i,c)}function Sv(i,c){return yh(4,4,i,c)}function _v(i,c){if(typeof c=="function")return i=i(),c(i),function(){c(null)};if(c!=null)return i=i(),c.current=i,function(){c.current=null}}function Ev(i,c,h){return h=h!=null?h.concat([i]):null,yh(4,4,_v.bind(null,c,i),h)}function gm(){}function Dv(i,c){var h=Tr();c=c===void 0?null:c;var v=h.memoizedState;return v!==null&&c!==null&&um(c,v[1])?v[0]:(h.memoizedState=[i,c],i)}function Av(i,c){var h=Tr();c=c===void 0?null:c;var v=h.memoizedState;return v!==null&&c!==null&&um(c,v[1])?v[0]:(i=i(),h.memoizedState=[i,c],i)}function Fv(i,c,h){return(Tl&21)===0?(i.baseState&&(i.baseState=!1,Ka=!0),i.memoizedState=h):(Kr(h,c)||(h=oy(),gn.lanes|=h,Cl|=h,i.baseState=!0),c)}function G4(i,c){var h=zt;zt=h!==0&&4>h?h:4,i(!0);var v=dm.transition;dm.transition={};try{i(!1),c()}finally{zt=h,dm.transition=v}}function Lv(){return Tr().memoizedState}function q4(i,c,h){var v=Pi(i);if(h={lane:v,action:h,hasEagerState:!1,eagerState:null,next:null},Pv(i))Iv(c,h);else if(h=uv(i,c,h,v),h!==null){var k=Aa();Wr(h,i,v,k),Ov(h,c,v)}}function W4(i,c,h){var v=Pi(i),k={lane:v,action:h,hasEagerState:!1,eagerState:null,next:null};if(Pv(i))Iv(c,k);else{var A=i.alternate;if(i.lanes===0&&(A===null||A.lanes===0)&&(A=c.lastRenderedReducer,A!==null))try{var U=c.lastRenderedState,le=A(U,h);if(k.hasEagerState=!0,k.eagerState=le,Kr(le,U)){var de=c.interleaved;de===null?(k.next=k,rm(c)):(k.next=de.next,de.next=k),c.interleaved=k;return}}catch{}finally{}h=uv(i,c,k,v),h!==null&&(k=Aa(),Wr(h,i,v,k),Ov(h,c,v))}}function Pv(i){var c=i.alternate;return i===gn||c!==null&&c===gn}function Iv(i,c){hd=ph=!0;var h=i.pending;h===null?c.next=c:(c.next=h.next,h.next=c),i.pending=c}function Ov(i,c,h){if((h&4194240)!==0){var v=c.lanes;v&=i.pendingLanes,h|=v,c.lanes=h,vx(i,h)}}var vh={readContext:kr,useCallback:pa,useContext:pa,useEffect:pa,useImperativeHandle:pa,useInsertionEffect:pa,useLayoutEffect:pa,useMemo:pa,useReducer:pa,useRef:pa,useState:pa,useDebugValue:pa,useDeferredValue:pa,useTransition:pa,useMutableSource:pa,useSyncExternalStore:pa,useId:pa,unstable_isNewReconciler:!1},X4={readContext:kr,useCallback:function(i,c){return us().memoizedState=[i,c===void 0?null:c],i},useContext:kr,useEffect:Tv,useImperativeHandle:function(i,c,h){return h=h!=null?h.concat([i]):null,gh(4194308,4,_v.bind(null,c,i),h)},useLayoutEffect:function(i,c){return gh(4194308,4,i,c)},useInsertionEffect:function(i,c){return gh(4,2,i,c)},useMemo:function(i,c){var h=us();return c=c===void 0?null:c,i=i(),h.memoizedState=[i,c],i},useReducer:function(i,c,h){var v=us();return c=h!==void 0?h(c):c,v.memoizedState=v.baseState=c,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:c},v.queue=i,i=i.dispatch=q4.bind(null,gn,i),[v.memoizedState,i]},useRef:function(i){var c=us();return i={current:i},c.memoizedState=i},useState:wv,useDebugValue:gm,useDeferredValue:function(i){return us().memoizedState=i},useTransition:function(){var i=wv(!1),c=i[0];return i=G4.bind(null,i[1]),us().memoizedState=i,[c,i]},useMutableSource:function(){},useSyncExternalStore:function(i,c,h){var v=gn,k=us();if(xn){if(h===void 0)throw Error(a(407));h=h()}else{if(h=c(),Jn===null)throw Error(a(349));(Tl&30)!==0||yv(v,c,h)}k.memoizedState=h;var A={value:h,getSnapshot:c};return k.queue=A,Tv(bv.bind(null,v,A,i),[i]),v.flags|=2048,fd(9,vv.bind(null,v,A,h,c),void 0,null),h},useId:function(){var i=us(),c=Jn.identifierPrefix;if(xn){var h=Hs,v=Bs;h=(v&~(1<<32-_n(v)-1)).toString(32)+h,c=":"+c+"R"+h,h=xd++,0<h&&(c+="H"+h.toString(32)),c+=":"}else h=$4++,c=":"+c+"r"+h.toString(32)+":";return i.memoizedState=c},unstable_isNewReconciler:!1},Q4={readContext:kr,useCallback:Dv,useContext:kr,useEffect:pm,useImperativeHandle:Ev,useInsertionEffect:Cv,useLayoutEffect:Sv,useMemo:Av,useReducer:mm,useRef:kv,useState:function(){return mm(md)},useDebugValue:gm,useDeferredValue:function(i){var c=Tr();return Fv(c,Hn.memoizedState,i)},useTransition:function(){var i=mm(md)[0],c=Tr().memoizedState;return[i,c]},useMutableSource:pv,useSyncExternalStore:gv,useId:Lv,unstable_isNewReconciler:!1},Y4={readContext:kr,useCallback:Dv,useContext:kr,useEffect:pm,useImperativeHandle:Ev,useInsertionEffect:Cv,useLayoutEffect:Sv,useMemo:Av,useReducer:fm,useRef:kv,useState:function(){return fm(md)},useDebugValue:gm,useDeferredValue:function(i){var c=Tr();return Hn===null?c.memoizedState=i:Fv(c,Hn.memoizedState,i)},useTransition:function(){var i=fm(md)[0],c=Tr().memoizedState;return[i,c]},useMutableSource:pv,useSyncExternalStore:gv,useId:Lv,unstable_isNewReconciler:!1};function $r(i,c){if(i&&i.defaultProps){c=fe({},c),i=i.defaultProps;for(var h in i)c[h]===void 0&&(c[h]=i[h]);return c}return c}function ym(i,c,h,v){c=i.memoizedState,h=h(v,c),h=h==null?c:fe({},c,h),i.memoizedState=h,i.lanes===0&&(i.updateQueue.baseState=h)}var bh={isMounted:function(i){return(i=i._reactInternals)?se(i)===i:!1},enqueueSetState:function(i,c,h){i=i._reactInternals;var v=Aa(),k=Pi(i),A=Us(v,k);A.payload=c,h!=null&&(A.callback=h),c=Di(i,A,k),c!==null&&(Wr(c,i,k,v),hh(c,i,k))},enqueueReplaceState:function(i,c,h){i=i._reactInternals;var v=Aa(),k=Pi(i),A=Us(v,k);A.tag=1,A.payload=c,h!=null&&(A.callback=h),c=Di(i,A,k),c!==null&&(Wr(c,i,k,v),hh(c,i,k))},enqueueForceUpdate:function(i,c){i=i._reactInternals;var h=Aa(),v=Pi(i),k=Us(h,v);k.tag=2,c!=null&&(k.callback=c),c=Di(i,k,v),c!==null&&(Wr(c,i,v,h),hh(c,i,v))}};function Mv(i,c,h,v,k,A,U){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(v,A,U):c.prototype&&c.prototype.isPureReactComponent?!td(h,v)||!td(k,A):!0}function Rv(i,c,h){var v=!1,k=Si,A=c.contextType;return typeof A=="object"&&A!==null?A=kr(A):(k=Ua(c)?bl:fa.current,v=c.contextTypes,A=(v=v!=null)?Io(i,k):Si),c=new c(h,A),i.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=bh,i.stateNode=c,c._reactInternals=i,v&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=k,i.__reactInternalMemoizedMaskedChildContext=A),c}function Bv(i,c,h,v){i=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,v),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,v),c.state!==i&&bh.enqueueReplaceState(c,c.state,null)}function vm(i,c,h,v){var k=i.stateNode;k.props=h,k.state=i.memoizedState,k.refs={},sm(i);var A=c.contextType;typeof A=="object"&&A!==null?k.context=kr(A):(A=Ua(c)?bl:fa.current,k.context=Io(i,A)),k.state=i.memoizedState,A=c.getDerivedStateFromProps,typeof A=="function"&&(ym(i,c,A,h),k.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(c=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),c!==k.state&&bh.enqueueReplaceState(k,k.state,null),xh(i,h,k,v),k.state=i.memoizedState),typeof k.componentDidMount=="function"&&(i.flags|=4194308)}function Ko(i,c){try{var h="",v=c;do h+=W(v),v=v.return;while(v);var k=h}catch(A){k=`
Error generating stack: `+A.message+`
`+A.stack}return{value:i,source:c,stack:k,digest:null}}function bm(i,c,h){return{value:i,source:null,stack:h??null,digest:c??null}}function Nm(i,c){try{console.error(c.value)}catch(h){setTimeout(function(){throw h})}}var J4=typeof WeakMap=="function"?WeakMap:Map;function Hv(i,c,h){h=Us(-1,h),h.tag=3,h.payload={element:null};var v=c.value;return h.callback=function(){Sh||(Sh=!0,Om=v),Nm(i,c)},h}function Vv(i,c,h){h=Us(-1,h),h.tag=3;var v=i.type.getDerivedStateFromError;if(typeof v=="function"){var k=c.value;h.payload=function(){return v(k)},h.callback=function(){Nm(i,c)}}var A=i.stateNode;return A!==null&&typeof A.componentDidCatch=="function"&&(h.callback=function(){Nm(i,c),typeof v!="function"&&(Fi===null?Fi=new Set([this]):Fi.add(this));var U=c.stack;this.componentDidCatch(c.value,{componentStack:U!==null?U:""})}),h}function Uv(i,c,h){var v=i.pingCache;if(v===null){v=i.pingCache=new J4;var k=new Set;v.set(c,k)}else k=v.get(c),k===void 0&&(k=new Set,v.set(c,k));k.has(h)||(k.add(h),i=hC.bind(null,i,c,h),c.then(i,i))}function Kv(i){do{var c;if((c=i.tag===13)&&(c=i.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return i;i=i.return}while(i!==null);return null}function zv(i,c,h,v,k){return(i.mode&1)===0?(i===c?i.flags|=65536:(i.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(c=Us(-1,1),c.tag=2,Di(h,c,1))),h.lanes|=1),i):(i.flags|=65536,i.lanes=k,i)}var Z4=w.ReactCurrentOwner,Ka=!1;function Da(i,c,h,v){c.child=i===null?dv(c,null,h,v):Bo(c,i.child,h,v)}function $v(i,c,h,v,k){h=h.render;var A=c.ref;return Vo(c,k),v=hm(i,c,h,v,A,k),h=xm(),i!==null&&!Ka?(c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~k,Ks(i,c,k)):(xn&&h&&Xx(c),c.flags|=1,Da(i,c,v,k),c.child)}function Gv(i,c,h,v,k){if(i===null){var A=h.type;return typeof A=="function"&&!Km(A)&&A.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(c.tag=15,c.type=A,qv(i,c,A,v,k)):(i=Lh(h.type,null,v,c,c.mode,k),i.ref=c.ref,i.return=c,c.child=i)}if(A=i.child,(i.lanes&k)===0){var U=A.memoizedProps;if(h=h.compare,h=h!==null?h:td,h(U,v)&&i.ref===c.ref)return Ks(i,c,k)}return c.flags|=1,i=Oi(A,v),i.ref=c.ref,i.return=c,c.child=i}function qv(i,c,h,v,k){if(i!==null){var A=i.memoizedProps;if(td(A,v)&&i.ref===c.ref)if(Ka=!1,c.pendingProps=v=A,(i.lanes&k)!==0)(i.flags&131072)!==0&&(Ka=!0);else return c.lanes=i.lanes,Ks(i,c,k)}return jm(i,c,h,v,k)}function Wv(i,c,h){var v=c.pendingProps,k=v.children,A=i!==null?i.memoizedState:null;if(v.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},nn($o,cr),cr|=h;else{if((h&1073741824)===0)return i=A!==null?A.baseLanes|h:h,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:i,cachePool:null,transitions:null},c.updateQueue=null,nn($o,cr),cr|=i,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=A!==null?A.baseLanes:h,nn($o,cr),cr|=v}else A!==null?(v=A.baseLanes|h,c.memoizedState=null):v=h,nn($o,cr),cr|=v;return Da(i,c,k,h),c.child}function Xv(i,c){var h=c.ref;(i===null&&h!==null||i!==null&&i.ref!==h)&&(c.flags|=512,c.flags|=2097152)}function jm(i,c,h,v,k){var A=Ua(h)?bl:fa.current;return A=Io(c,A),Vo(c,k),h=hm(i,c,h,v,A,k),v=xm(),i!==null&&!Ka?(c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~k,Ks(i,c,k)):(xn&&v&&Xx(c),c.flags|=1,Da(i,c,h,k),c.child)}function Qv(i,c,h,v,k){if(Ua(h)){var A=!0;rh(c)}else A=!1;if(Vo(c,k),c.stateNode===null)jh(i,c),Rv(c,h,v),vm(c,h,v,k),v=!0;else if(i===null){var U=c.stateNode,le=c.memoizedProps;U.props=le;var de=U.context,we=h.contextType;typeof we=="object"&&we!==null?we=kr(we):(we=Ua(h)?bl:fa.current,we=Io(c,we));var Fe=h.getDerivedStateFromProps,Ie=typeof Fe=="function"||typeof U.getSnapshotBeforeUpdate=="function";Ie||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(le!==v||de!==we)&&Bv(c,U,v,we),Ei=!1;var Ae=c.memoizedState;U.state=Ae,xh(c,v,U,k),de=c.memoizedState,le!==v||Ae!==de||Va.current||Ei?(typeof Fe=="function"&&(ym(c,h,Fe,v),de=c.memoizedState),(le=Ei||Mv(c,h,le,v,Ae,de,we))?(Ie||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount()),typeof U.componentDidMount=="function"&&(c.flags|=4194308)):(typeof U.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=v,c.memoizedState=de),U.props=v,U.state=de,U.context=we,v=le):(typeof U.componentDidMount=="function"&&(c.flags|=4194308),v=!1)}else{U=c.stateNode,hv(i,c),le=c.memoizedProps,we=c.type===c.elementType?le:$r(c.type,le),U.props=we,Ie=c.pendingProps,Ae=U.context,de=h.contextType,typeof de=="object"&&de!==null?de=kr(de):(de=Ua(h)?bl:fa.current,de=Io(c,de));var Ge=h.getDerivedStateFromProps;(Fe=typeof Ge=="function"||typeof U.getSnapshotBeforeUpdate=="function")||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(le!==Ie||Ae!==de)&&Bv(c,U,v,de),Ei=!1,Ae=c.memoizedState,U.state=Ae,xh(c,v,U,k);var Xe=c.memoizedState;le!==Ie||Ae!==Xe||Va.current||Ei?(typeof Ge=="function"&&(ym(c,h,Ge,v),Xe=c.memoizedState),(we=Ei||Mv(c,h,we,v,Ae,Xe,de)||!1)?(Fe||typeof U.UNSAFE_componentWillUpdate!="function"&&typeof U.componentWillUpdate!="function"||(typeof U.componentWillUpdate=="function"&&U.componentWillUpdate(v,Xe,de),typeof U.UNSAFE_componentWillUpdate=="function"&&U.UNSAFE_componentWillUpdate(v,Xe,de)),typeof U.componentDidUpdate=="function"&&(c.flags|=4),typeof U.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof U.componentDidUpdate!="function"||le===i.memoizedProps&&Ae===i.memoizedState||(c.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||le===i.memoizedProps&&Ae===i.memoizedState||(c.flags|=1024),c.memoizedProps=v,c.memoizedState=Xe),U.props=v,U.state=Xe,U.context=de,v=we):(typeof U.componentDidUpdate!="function"||le===i.memoizedProps&&Ae===i.memoizedState||(c.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||le===i.memoizedProps&&Ae===i.memoizedState||(c.flags|=1024),v=!1)}return wm(i,c,h,v,A,k)}function wm(i,c,h,v,k,A){Xv(i,c);var U=(c.flags&128)!==0;if(!v&&!U)return k&&tv(c,h,!1),Ks(i,c,A);v=c.stateNode,Z4.current=c;var le=U&&typeof h.getDerivedStateFromError!="function"?null:v.render();return c.flags|=1,i!==null&&U?(c.child=Bo(c,i.child,null,A),c.child=Bo(c,null,le,A)):Da(i,c,le,A),c.memoizedState=v.state,k&&tv(c,h,!0),c.child}function Yv(i){var c=i.stateNode;c.pendingContext?Zy(i,c.pendingContext,c.pendingContext!==c.context):c.context&&Zy(i,c.context,!1),im(i,c.containerInfo)}function Jv(i,c,h,v,k){return Ro(),Zx(k),c.flags|=256,Da(i,c,h,v),c.child}var km={dehydrated:null,treeContext:null,retryLane:0};function Tm(i){return{baseLanes:i,cachePool:null,transitions:null}}function Zv(i,c,h){var v=c.pendingProps,k=pn.current,A=!1,U=(c.flags&128)!==0,le;if((le=U)||(le=i!==null&&i.memoizedState===null?!1:(k&2)!==0),le?(A=!0,c.flags&=-129):(i===null||i.memoizedState!==null)&&(k|=1),nn(pn,k&1),i===null)return Jx(c),i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((c.mode&1)===0?c.lanes=1:i.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(U=v.children,i=v.fallback,A?(v=c.mode,A=c.child,U={mode:"hidden",children:U},(v&1)===0&&A!==null?(A.childLanes=0,A.pendingProps=U):A=Ph(U,v,0,null),i=Dl(i,v,h,null),A.return=c,i.return=c,A.sibling=i,c.child=A,c.child.memoizedState=Tm(h),c.memoizedState=km,i):Cm(c,U));if(k=i.memoizedState,k!==null&&(le=k.dehydrated,le!==null))return eC(i,c,U,v,le,k,h);if(A){A=v.fallback,U=c.mode,k=i.child,le=k.sibling;var de={mode:"hidden",children:v.children};return(U&1)===0&&c.child!==k?(v=c.child,v.childLanes=0,v.pendingProps=de,c.deletions=null):(v=Oi(k,de),v.subtreeFlags=k.subtreeFlags&14680064),le!==null?A=Oi(le,A):(A=Dl(A,U,h,null),A.flags|=2),A.return=c,v.return=c,v.sibling=A,c.child=v,v=A,A=c.child,U=i.child.memoizedState,U=U===null?Tm(h):{baseLanes:U.baseLanes|h,cachePool:null,transitions:U.transitions},A.memoizedState=U,A.childLanes=i.childLanes&~h,c.memoizedState=km,v}return A=i.child,i=A.sibling,v=Oi(A,{mode:"visible",children:v.children}),(c.mode&1)===0&&(v.lanes=h),v.return=c,v.sibling=null,i!==null&&(h=c.deletions,h===null?(c.deletions=[i],c.flags|=16):h.push(i)),c.child=v,c.memoizedState=null,v}function Cm(i,c){return c=Ph({mode:"visible",children:c},i.mode,0,null),c.return=i,i.child=c}function Nh(i,c,h,v){return v!==null&&Zx(v),Bo(c,i.child,null,h),i=Cm(c,c.pendingProps.children),i.flags|=2,c.memoizedState=null,i}function eC(i,c,h,v,k,A,U){if(h)return c.flags&256?(c.flags&=-257,v=bm(Error(a(422))),Nh(i,c,U,v)):c.memoizedState!==null?(c.child=i.child,c.flags|=128,null):(A=v.fallback,k=c.mode,v=Ph({mode:"visible",children:v.children},k,0,null),A=Dl(A,k,U,null),A.flags|=2,v.return=c,A.return=c,v.sibling=A,c.child=v,(c.mode&1)!==0&&Bo(c,i.child,null,U),c.child.memoizedState=Tm(U),c.memoizedState=km,A);if((c.mode&1)===0)return Nh(i,c,U,null);if(k.data==="$!"){if(v=k.nextSibling&&k.nextSibling.dataset,v)var le=v.dgst;return v=le,A=Error(a(419)),v=bm(A,v,void 0),Nh(i,c,U,v)}if(le=(U&i.childLanes)!==0,Ka||le){if(v=Jn,v!==null){switch(U&-U){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}k=(k&(v.suspendedLanes|U))!==0?0:k,k!==0&&k!==A.retryLane&&(A.retryLane=k,Vs(i,k),Wr(v,i,k,-1))}return Um(),v=bm(Error(a(421))),Nh(i,c,U,v)}return k.data==="$?"?(c.flags|=128,c.child=i.child,c=xC.bind(null,i),k._reactRetry=c,null):(i=A.treeContext,or=Ti(k.nextSibling),lr=c,xn=!0,zr=null,i!==null&&(jr[wr++]=Bs,jr[wr++]=Hs,jr[wr++]=Nl,Bs=i.id,Hs=i.overflow,Nl=c),c=Cm(c,v.children),c.flags|=4096,c)}function e1(i,c,h){i.lanes|=c;var v=i.alternate;v!==null&&(v.lanes|=c),am(i.return,c,h)}function Sm(i,c,h,v,k){var A=i.memoizedState;A===null?i.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:v,tail:h,tailMode:k}:(A.isBackwards=c,A.rendering=null,A.renderingStartTime=0,A.last=v,A.tail=h,A.tailMode=k)}function t1(i,c,h){var v=c.pendingProps,k=v.revealOrder,A=v.tail;if(Da(i,c,v.children,h),v=pn.current,(v&2)!==0)v=v&1|2,c.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=c.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&e1(i,h,c);else if(i.tag===19)e1(i,h,c);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===c)break e;for(;i.sibling===null;){if(i.return===null||i.return===c)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}v&=1}if(nn(pn,v),(c.mode&1)===0)c.memoizedState=null;else switch(k){case"forwards":for(h=c.child,k=null;h!==null;)i=h.alternate,i!==null&&mh(i)===null&&(k=h),h=h.sibling;h=k,h===null?(k=c.child,c.child=null):(k=h.sibling,h.sibling=null),Sm(c,!1,k,h,A);break;case"backwards":for(h=null,k=c.child,c.child=null;k!==null;){if(i=k.alternate,i!==null&&mh(i)===null){c.child=k;break}i=k.sibling,k.sibling=h,h=k,k=i}Sm(c,!0,h,null,A);break;case"together":Sm(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function jh(i,c){(c.mode&1)===0&&i!==null&&(i.alternate=null,c.alternate=null,c.flags|=2)}function Ks(i,c,h){if(i!==null&&(c.dependencies=i.dependencies),Cl|=c.lanes,(h&c.childLanes)===0)return null;if(i!==null&&c.child!==i.child)throw Error(a(153));if(c.child!==null){for(i=c.child,h=Oi(i,i.pendingProps),c.child=h,h.return=c;i.sibling!==null;)i=i.sibling,h=h.sibling=Oi(i,i.pendingProps),h.return=c;h.sibling=null}return c.child}function tC(i,c,h){switch(c.tag){case 3:Yv(c),Ro();break;case 5:fv(c);break;case 1:Ua(c.type)&&rh(c);break;case 4:im(c,c.stateNode.containerInfo);break;case 10:var v=c.type._context,k=c.memoizedProps.value;nn(dh,v._currentValue),v._currentValue=k;break;case 13:if(v=c.memoizedState,v!==null)return v.dehydrated!==null?(nn(pn,pn.current&1),c.flags|=128,null):(h&c.child.childLanes)!==0?Zv(i,c,h):(nn(pn,pn.current&1),i=Ks(i,c,h),i!==null?i.sibling:null);nn(pn,pn.current&1);break;case 19:if(v=(h&c.childLanes)!==0,(i.flags&128)!==0){if(v)return t1(i,c,h);c.flags|=128}if(k=c.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),nn(pn,pn.current),v)break;return null;case 22:case 23:return c.lanes=0,Wv(i,c,h)}return Ks(i,c,h)}var n1,_m,a1,r1;n1=function(i,c){for(var h=c.child;h!==null;){if(h.tag===5||h.tag===6)i.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},_m=function(){},a1=function(i,c,h,v){var k=i.memoizedProps;if(k!==v){i=c.stateNode,kl(ds.current);var A=null;switch(h){case"input":k=Oe(i,k),v=Oe(i,v),A=[];break;case"select":k=fe({},k,{value:void 0}),v=fe({},v,{value:void 0}),A=[];break;case"textarea":k=Ha(i,k),v=Ha(i,v),A=[];break;default:typeof k.onClick!="function"&&typeof v.onClick=="function"&&(i.onclick=th)}Ps(h,v);var U;h=null;for(we in k)if(!v.hasOwnProperty(we)&&k.hasOwnProperty(we)&&k[we]!=null)if(we==="style"){var le=k[we];for(U in le)le.hasOwnProperty(U)&&(h||(h={}),h[U]="")}else we!=="dangerouslySetInnerHTML"&&we!=="children"&&we!=="suppressContentEditableWarning"&&we!=="suppressHydrationWarning"&&we!=="autoFocus"&&(s.hasOwnProperty(we)?A||(A=[]):(A=A||[]).push(we,null));for(we in v){var de=v[we];if(le=k!=null?k[we]:void 0,v.hasOwnProperty(we)&&de!==le&&(de!=null||le!=null))if(we==="style")if(le){for(U in le)!le.hasOwnProperty(U)||de&&de.hasOwnProperty(U)||(h||(h={}),h[U]="");for(U in de)de.hasOwnProperty(U)&&le[U]!==de[U]&&(h||(h={}),h[U]=de[U])}else h||(A||(A=[]),A.push(we,h)),h=de;else we==="dangerouslySetInnerHTML"?(de=de?de.__html:void 0,le=le?le.__html:void 0,de!=null&&le!==de&&(A=A||[]).push(we,de)):we==="children"?typeof de!="string"&&typeof de!="number"||(A=A||[]).push(we,""+de):we!=="suppressContentEditableWarning"&&we!=="suppressHydrationWarning"&&(s.hasOwnProperty(we)?(de!=null&&we==="onScroll"&&rn("scroll",i),A||le===de||(A=[])):(A=A||[]).push(we,de))}h&&(A=A||[]).push("style",h);var we=A;(c.updateQueue=we)&&(c.flags|=4)}},r1=function(i,c,h,v){h!==v&&(c.flags|=4)};function pd(i,c){if(!xn)switch(i.tailMode){case"hidden":c=i.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?i.tail=null:h.sibling=null;break;case"collapsed":h=i.tail;for(var v=null;h!==null;)h.alternate!==null&&(v=h),h=h.sibling;v===null?c||i.tail===null?i.tail=null:i.tail.sibling=null:v.sibling=null}}function ga(i){var c=i.alternate!==null&&i.alternate.child===i.child,h=0,v=0;if(c)for(var k=i.child;k!==null;)h|=k.lanes|k.childLanes,v|=k.subtreeFlags&14680064,v|=k.flags&14680064,k.return=i,k=k.sibling;else for(k=i.child;k!==null;)h|=k.lanes|k.childLanes,v|=k.subtreeFlags,v|=k.flags,k.return=i,k=k.sibling;return i.subtreeFlags|=v,i.childLanes=h,c}function nC(i,c,h){var v=c.pendingProps;switch(Qx(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ga(c),null;case 1:return Ua(c.type)&&ah(),ga(c),null;case 3:return v=c.stateNode,Uo(),sn(Va),sn(fa),cm(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(i===null||i.child===null)&&(oh(c)?c.flags|=4:i===null||i.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,zr!==null&&(Bm(zr),zr=null))),_m(i,c),ga(c),null;case 5:lm(c);var k=kl(ud.current);if(h=c.type,i!==null&&c.stateNode!=null)a1(i,c,h,v,k),i.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!v){if(c.stateNode===null)throw Error(a(166));return ga(c),null}if(i=kl(ds.current),oh(c)){v=c.stateNode,h=c.type;var A=c.memoizedProps;switch(v[cs]=c,v[id]=A,i=(c.mode&1)!==0,h){case"dialog":rn("cancel",v),rn("close",v);break;case"iframe":case"object":case"embed":rn("load",v);break;case"video":case"audio":for(k=0;k<ad.length;k++)rn(ad[k],v);break;case"source":rn("error",v);break;case"img":case"image":case"link":rn("error",v),rn("load",v);break;case"details":rn("toggle",v);break;case"input":tt(v,A),rn("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!A.multiple},rn("invalid",v);break;case"textarea":Bn(v,A),rn("invalid",v)}Ps(h,A),k=null;for(var U in A)if(A.hasOwnProperty(U)){var le=A[U];U==="children"?typeof le=="string"?v.textContent!==le&&(A.suppressHydrationWarning!==!0&&eh(v.textContent,le,i),k=["children",le]):typeof le=="number"&&v.textContent!==""+le&&(A.suppressHydrationWarning!==!0&&eh(v.textContent,le,i),k=["children",""+le]):s.hasOwnProperty(U)&&le!=null&&U==="onScroll"&&rn("scroll",v)}switch(h){case"input":Se(v),Rt(v,A,!0);break;case"textarea":Se(v),Qe(v);break;case"select":case"option":break;default:typeof A.onClick=="function"&&(v.onclick=th)}v=k,c.updateQueue=v,v!==null&&(c.flags|=4)}else{U=k.nodeType===9?k:k.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=Ct(h)),i==="http://www.w3.org/1999/xhtml"?h==="script"?(i=U.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof v.is=="string"?i=U.createElement(h,{is:v.is}):(i=U.createElement(h),h==="select"&&(U=i,v.multiple?U.multiple=!0:v.size&&(U.size=v.size))):i=U.createElementNS(i,h),i[cs]=c,i[id]=v,n1(i,c,!1,!1),c.stateNode=i;e:{switch(U=Is(h,v),h){case"dialog":rn("cancel",i),rn("close",i),k=v;break;case"iframe":case"object":case"embed":rn("load",i),k=v;break;case"video":case"audio":for(k=0;k<ad.length;k++)rn(ad[k],i);k=v;break;case"source":rn("error",i),k=v;break;case"img":case"image":case"link":rn("error",i),rn("load",i),k=v;break;case"details":rn("toggle",i),k=v;break;case"input":tt(i,v),k=Oe(i,v),rn("invalid",i);break;case"option":k=v;break;case"select":i._wrapperState={wasMultiple:!!v.multiple},k=fe({},v,{value:void 0}),rn("invalid",i);break;case"textarea":Bn(i,v),k=Ha(i,v),rn("invalid",i);break;default:k=v}Ps(h,k),le=k;for(A in le)if(le.hasOwnProperty(A)){var de=le[A];A==="style"?Ea(i,de):A==="dangerouslySetInnerHTML"?(de=de?de.__html:void 0,de!=null&&fn(i,de)):A==="children"?typeof de=="string"?(h!=="textarea"||de!=="")&&ot(i,de):typeof de=="number"&&ot(i,""+de):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(s.hasOwnProperty(A)?de!=null&&A==="onScroll"&&rn("scroll",i):de!=null&&S(i,A,de,U))}switch(h){case"input":Se(i),Rt(i,v,!1);break;case"textarea":Se(i),Qe(i);break;case"option":v.value!=null&&i.setAttribute("value",""+H(v.value));break;case"select":i.multiple=!!v.multiple,A=v.value,A!=null?Cn(i,!!v.multiple,A,!1):v.defaultValue!=null&&Cn(i,!!v.multiple,v.defaultValue,!0);break;default:typeof k.onClick=="function"&&(i.onclick=th)}switch(h){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return ga(c),null;case 6:if(i&&c.stateNode!=null)r1(i,c,i.memoizedProps,v);else{if(typeof v!="string"&&c.stateNode===null)throw Error(a(166));if(h=kl(ud.current),kl(ds.current),oh(c)){if(v=c.stateNode,h=c.memoizedProps,v[cs]=c,(A=v.nodeValue!==h)&&(i=lr,i!==null))switch(i.tag){case 3:eh(v.nodeValue,h,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&eh(v.nodeValue,h,(i.mode&1)!==0)}A&&(c.flags|=4)}else v=(h.nodeType===9?h:h.ownerDocument).createTextNode(v),v[cs]=c,c.stateNode=v}return ga(c),null;case 13:if(sn(pn),v=c.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(xn&&or!==null&&(c.mode&1)!==0&&(c.flags&128)===0)lv(),Ro(),c.flags|=98560,A=!1;else if(A=oh(c),v!==null&&v.dehydrated!==null){if(i===null){if(!A)throw Error(a(318));if(A=c.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(a(317));A[cs]=c}else Ro(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;ga(c),A=!1}else zr!==null&&(Bm(zr),zr=null),A=!0;if(!A)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=h,c):(v=v!==null,v!==(i!==null&&i.memoizedState!==null)&&v&&(c.child.flags|=8192,(c.mode&1)!==0&&(i===null||(pn.current&1)!==0?Vn===0&&(Vn=3):Um())),c.updateQueue!==null&&(c.flags|=4),ga(c),null);case 4:return Uo(),_m(i,c),i===null&&rd(c.stateNode.containerInfo),ga(c),null;case 10:return nm(c.type._context),ga(c),null;case 17:return Ua(c.type)&&ah(),ga(c),null;case 19:if(sn(pn),A=c.memoizedState,A===null)return ga(c),null;if(v=(c.flags&128)!==0,U=A.rendering,U===null)if(v)pd(A,!1);else{if(Vn!==0||i!==null&&(i.flags&128)!==0)for(i=c.child;i!==null;){if(U=mh(i),U!==null){for(c.flags|=128,pd(A,!1),v=U.updateQueue,v!==null&&(c.updateQueue=v,c.flags|=4),c.subtreeFlags=0,v=h,h=c.child;h!==null;)A=h,i=v,A.flags&=14680066,U=A.alternate,U===null?(A.childLanes=0,A.lanes=i,A.child=null,A.subtreeFlags=0,A.memoizedProps=null,A.memoizedState=null,A.updateQueue=null,A.dependencies=null,A.stateNode=null):(A.childLanes=U.childLanes,A.lanes=U.lanes,A.child=U.child,A.subtreeFlags=0,A.deletions=null,A.memoizedProps=U.memoizedProps,A.memoizedState=U.memoizedState,A.updateQueue=U.updateQueue,A.type=U.type,i=U.dependencies,A.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),h=h.sibling;return nn(pn,pn.current&1|2),c.child}i=i.sibling}A.tail!==null&&Me()>Go&&(c.flags|=128,v=!0,pd(A,!1),c.lanes=4194304)}else{if(!v)if(i=mh(U),i!==null){if(c.flags|=128,v=!0,h=i.updateQueue,h!==null&&(c.updateQueue=h,c.flags|=4),pd(A,!0),A.tail===null&&A.tailMode==="hidden"&&!U.alternate&&!xn)return ga(c),null}else 2*Me()-A.renderingStartTime>Go&&h!==1073741824&&(c.flags|=128,v=!0,pd(A,!1),c.lanes=4194304);A.isBackwards?(U.sibling=c.child,c.child=U):(h=A.last,h!==null?h.sibling=U:c.child=U,A.last=U)}return A.tail!==null?(c=A.tail,A.rendering=c,A.tail=c.sibling,A.renderingStartTime=Me(),c.sibling=null,h=pn.current,nn(pn,v?h&1|2:h&1),c):(ga(c),null);case 22:case 23:return Vm(),v=c.memoizedState!==null,i!==null&&i.memoizedState!==null!==v&&(c.flags|=8192),v&&(c.mode&1)!==0?(cr&1073741824)!==0&&(ga(c),c.subtreeFlags&6&&(c.flags|=8192)):ga(c),null;case 24:return null;case 25:return null}throw Error(a(156,c.tag))}function aC(i,c){switch(Qx(c),c.tag){case 1:return Ua(c.type)&&ah(),i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 3:return Uo(),sn(Va),sn(fa),cm(),i=c.flags,(i&65536)!==0&&(i&128)===0?(c.flags=i&-65537|128,c):null;case 5:return lm(c),null;case 13:if(sn(pn),i=c.memoizedState,i!==null&&i.dehydrated!==null){if(c.alternate===null)throw Error(a(340));Ro()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 19:return sn(pn),null;case 4:return Uo(),null;case 10:return nm(c.type._context),null;case 22:case 23:return Vm(),null;case 24:return null;default:return null}}var wh=!1,ya=!1,rC=typeof WeakSet=="function"?WeakSet:Set,We=null;function zo(i,c){var h=i.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(v){Nn(i,c,v)}else h.current=null}function Em(i,c,h){try{h()}catch(v){Nn(i,c,v)}}var s1=!1;function sC(i,c){if(Vx=Ku,i=My(),Lx(i)){if("selectionStart"in i)var h={start:i.selectionStart,end:i.selectionEnd};else e:{h=(h=i.ownerDocument)&&h.defaultView||window;var v=h.getSelection&&h.getSelection();if(v&&v.rangeCount!==0){h=v.anchorNode;var k=v.anchorOffset,A=v.focusNode;v=v.focusOffset;try{h.nodeType,A.nodeType}catch{h=null;break e}var U=0,le=-1,de=-1,we=0,Fe=0,Ie=i,Ae=null;t:for(;;){for(var Ge;Ie!==h||k!==0&&Ie.nodeType!==3||(le=U+k),Ie!==A||v!==0&&Ie.nodeType!==3||(de=U+v),Ie.nodeType===3&&(U+=Ie.nodeValue.length),(Ge=Ie.firstChild)!==null;)Ae=Ie,Ie=Ge;for(;;){if(Ie===i)break t;if(Ae===h&&++we===k&&(le=U),Ae===A&&++Fe===v&&(de=U),(Ge=Ie.nextSibling)!==null)break;Ie=Ae,Ae=Ie.parentNode}Ie=Ge}h=le===-1||de===-1?null:{start:le,end:de}}else h=null}h=h||{start:0,end:0}}else h=null;for(Ux={focusedElem:i,selectionRange:h},Ku=!1,We=c;We!==null;)if(c=We,i=c.child,(c.subtreeFlags&1028)!==0&&i!==null)i.return=c,We=i;else for(;We!==null;){c=We;try{var Xe=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Xe!==null){var Ze=Xe.memoizedProps,En=Xe.memoizedState,pe=c.stateNode,me=pe.getSnapshotBeforeUpdate(c.elementType===c.type?Ze:$r(c.type,Ze),En);pe.__reactInternalSnapshotBeforeUpdate=me}break;case 3:var ge=c.stateNode.containerInfo;ge.nodeType===1?ge.textContent="":ge.nodeType===9&&ge.documentElement&&ge.removeChild(ge.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(a(163))}}catch(Ve){Nn(c,c.return,Ve)}if(i=c.sibling,i!==null){i.return=c.return,We=i;break}We=c.return}return Xe=s1,s1=!1,Xe}function gd(i,c,h){var v=c.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var k=v=v.next;do{if((k.tag&i)===i){var A=k.destroy;k.destroy=void 0,A!==void 0&&Em(c,h,A)}k=k.next}while(k!==v)}}function kh(i,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&i)===i){var v=h.create;h.destroy=v()}h=h.next}while(h!==c)}}function Dm(i){var c=i.ref;if(c!==null){var h=i.stateNode;switch(i.tag){case 5:i=h;break;default:i=h}typeof c=="function"?c(i):c.current=i}}function i1(i){var c=i.alternate;c!==null&&(i.alternate=null,i1(c)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(c=i.stateNode,c!==null&&(delete c[cs],delete c[id],delete c[Gx],delete c[V4],delete c[U4])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function l1(i){return i.tag===5||i.tag===3||i.tag===4}function o1(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||l1(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Am(i,c,h){var v=i.tag;if(v===5||v===6)i=i.stateNode,c?h.nodeType===8?h.parentNode.insertBefore(i,c):h.insertBefore(i,c):(h.nodeType===8?(c=h.parentNode,c.insertBefore(i,h)):(c=h,c.appendChild(i)),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=th));else if(v!==4&&(i=i.child,i!==null))for(Am(i,c,h),i=i.sibling;i!==null;)Am(i,c,h),i=i.sibling}function Fm(i,c,h){var v=i.tag;if(v===5||v===6)i=i.stateNode,c?h.insertBefore(i,c):h.appendChild(i);else if(v!==4&&(i=i.child,i!==null))for(Fm(i,c,h),i=i.sibling;i!==null;)Fm(i,c,h),i=i.sibling}var ia=null,Gr=!1;function Ai(i,c,h){for(h=h.child;h!==null;)c1(i,c,h),h=h.sibling}function c1(i,c,h){if(Qn&&typeof Qn.onCommitFiberUnmount=="function")try{Qn.onCommitFiberUnmount(os,h)}catch{}switch(h.tag){case 5:ya||zo(h,c);case 6:var v=ia,k=Gr;ia=null,Ai(i,c,h),ia=v,Gr=k,ia!==null&&(Gr?(i=ia,h=h.stateNode,i.nodeType===8?i.parentNode.removeChild(h):i.removeChild(h)):ia.removeChild(h.stateNode));break;case 18:ia!==null&&(Gr?(i=ia,h=h.stateNode,i.nodeType===8?$x(i.parentNode,h):i.nodeType===1&&$x(i,h),Xc(i)):$x(ia,h.stateNode));break;case 4:v=ia,k=Gr,ia=h.stateNode.containerInfo,Gr=!0,Ai(i,c,h),ia=v,Gr=k;break;case 0:case 11:case 14:case 15:if(!ya&&(v=h.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){k=v=v.next;do{var A=k,U=A.destroy;A=A.tag,U!==void 0&&((A&2)!==0||(A&4)!==0)&&Em(h,c,U),k=k.next}while(k!==v)}Ai(i,c,h);break;case 1:if(!ya&&(zo(h,c),v=h.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=h.memoizedProps,v.state=h.memoizedState,v.componentWillUnmount()}catch(le){Nn(h,c,le)}Ai(i,c,h);break;case 21:Ai(i,c,h);break;case 22:h.mode&1?(ya=(v=ya)||h.memoizedState!==null,Ai(i,c,h),ya=v):Ai(i,c,h);break;default:Ai(i,c,h)}}function d1(i){var c=i.updateQueue;if(c!==null){i.updateQueue=null;var h=i.stateNode;h===null&&(h=i.stateNode=new rC),c.forEach(function(v){var k=mC.bind(null,i,v);h.has(v)||(h.add(v),v.then(k,k))})}}function qr(i,c){var h=c.deletions;if(h!==null)for(var v=0;v<h.length;v++){var k=h[v];try{var A=i,U=c,le=U;e:for(;le!==null;){switch(le.tag){case 5:ia=le.stateNode,Gr=!1;break e;case 3:ia=le.stateNode.containerInfo,Gr=!0;break e;case 4:ia=le.stateNode.containerInfo,Gr=!0;break e}le=le.return}if(ia===null)throw Error(a(160));c1(A,U,k),ia=null,Gr=!1;var de=k.alternate;de!==null&&(de.return=null),k.return=null}catch(we){Nn(k,c,we)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)u1(c,i),c=c.sibling}function u1(i,c){var h=i.alternate,v=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(qr(c,i),hs(i),v&4){try{gd(3,i,i.return),kh(3,i)}catch(Ze){Nn(i,i.return,Ze)}try{gd(5,i,i.return)}catch(Ze){Nn(i,i.return,Ze)}}break;case 1:qr(c,i),hs(i),v&512&&h!==null&&zo(h,h.return);break;case 5:if(qr(c,i),hs(i),v&512&&h!==null&&zo(h,h.return),i.flags&32){var k=i.stateNode;try{ot(k,"")}catch(Ze){Nn(i,i.return,Ze)}}if(v&4&&(k=i.stateNode,k!=null)){var A=i.memoizedProps,U=h!==null?h.memoizedProps:A,le=i.type,de=i.updateQueue;if(i.updateQueue=null,de!==null)try{le==="input"&&A.type==="radio"&&A.name!=null&&Je(k,A),Is(le,U);var we=Is(le,A);for(U=0;U<de.length;U+=2){var Fe=de[U],Ie=de[U+1];Fe==="style"?Ea(k,Ie):Fe==="dangerouslySetInnerHTML"?fn(k,Ie):Fe==="children"?ot(k,Ie):S(k,Fe,Ie,we)}switch(le){case"input":Re(k,A);break;case"textarea":Be(k,A);break;case"select":var Ae=k._wrapperState.wasMultiple;k._wrapperState.wasMultiple=!!A.multiple;var Ge=A.value;Ge!=null?Cn(k,!!A.multiple,Ge,!1):Ae!==!!A.multiple&&(A.defaultValue!=null?Cn(k,!!A.multiple,A.defaultValue,!0):Cn(k,!!A.multiple,A.multiple?[]:"",!1))}k[id]=A}catch(Ze){Nn(i,i.return,Ze)}}break;case 6:if(qr(c,i),hs(i),v&4){if(i.stateNode===null)throw Error(a(162));k=i.stateNode,A=i.memoizedProps;try{k.nodeValue=A}catch(Ze){Nn(i,i.return,Ze)}}break;case 3:if(qr(c,i),hs(i),v&4&&h!==null&&h.memoizedState.isDehydrated)try{Xc(c.containerInfo)}catch(Ze){Nn(i,i.return,Ze)}break;case 4:qr(c,i),hs(i);break;case 13:qr(c,i),hs(i),k=i.child,k.flags&8192&&(A=k.memoizedState!==null,k.stateNode.isHidden=A,!A||k.alternate!==null&&k.alternate.memoizedState!==null||(Im=Me())),v&4&&d1(i);break;case 22:if(Fe=h!==null&&h.memoizedState!==null,i.mode&1?(ya=(we=ya)||Fe,qr(c,i),ya=we):qr(c,i),hs(i),v&8192){if(we=i.memoizedState!==null,(i.stateNode.isHidden=we)&&!Fe&&(i.mode&1)!==0)for(We=i,Fe=i.child;Fe!==null;){for(Ie=We=Fe;We!==null;){switch(Ae=We,Ge=Ae.child,Ae.tag){case 0:case 11:case 14:case 15:gd(4,Ae,Ae.return);break;case 1:zo(Ae,Ae.return);var Xe=Ae.stateNode;if(typeof Xe.componentWillUnmount=="function"){v=Ae,h=Ae.return;try{c=v,Xe.props=c.memoizedProps,Xe.state=c.memoizedState,Xe.componentWillUnmount()}catch(Ze){Nn(v,h,Ze)}}break;case 5:zo(Ae,Ae.return);break;case 22:if(Ae.memoizedState!==null){m1(Ie);continue}}Ge!==null?(Ge.return=Ae,We=Ge):m1(Ie)}Fe=Fe.sibling}e:for(Fe=null,Ie=i;;){if(Ie.tag===5){if(Fe===null){Fe=Ie;try{k=Ie.stateNode,we?(A=k.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none"):(le=Ie.stateNode,de=Ie.memoizedProps.style,U=de!=null&&de.hasOwnProperty("display")?de.display:null,le.style.display=en("display",U))}catch(Ze){Nn(i,i.return,Ze)}}}else if(Ie.tag===6){if(Fe===null)try{Ie.stateNode.nodeValue=we?"":Ie.memoizedProps}catch(Ze){Nn(i,i.return,Ze)}}else if((Ie.tag!==22&&Ie.tag!==23||Ie.memoizedState===null||Ie===i)&&Ie.child!==null){Ie.child.return=Ie,Ie=Ie.child;continue}if(Ie===i)break e;for(;Ie.sibling===null;){if(Ie.return===null||Ie.return===i)break e;Fe===Ie&&(Fe=null),Ie=Ie.return}Fe===Ie&&(Fe=null),Ie.sibling.return=Ie.return,Ie=Ie.sibling}}break;case 19:qr(c,i),hs(i),v&4&&d1(i);break;case 21:break;default:qr(c,i),hs(i)}}function hs(i){var c=i.flags;if(c&2){try{e:{for(var h=i.return;h!==null;){if(l1(h)){var v=h;break e}h=h.return}throw Error(a(160))}switch(v.tag){case 5:var k=v.stateNode;v.flags&32&&(ot(k,""),v.flags&=-33);var A=o1(i);Fm(i,A,k);break;case 3:case 4:var U=v.stateNode.containerInfo,le=o1(i);Am(i,le,U);break;default:throw Error(a(161))}}catch(de){Nn(i,i.return,de)}i.flags&=-3}c&4096&&(i.flags&=-4097)}function iC(i,c,h){We=i,h1(i)}function h1(i,c,h){for(var v=(i.mode&1)!==0;We!==null;){var k=We,A=k.child;if(k.tag===22&&v){var U=k.memoizedState!==null||wh;if(!U){var le=k.alternate,de=le!==null&&le.memoizedState!==null||ya;le=wh;var we=ya;if(wh=U,(ya=de)&&!we)for(We=k;We!==null;)U=We,de=U.child,U.tag===22&&U.memoizedState!==null?f1(k):de!==null?(de.return=U,We=de):f1(k);for(;A!==null;)We=A,h1(A),A=A.sibling;We=k,wh=le,ya=we}x1(i)}else(k.subtreeFlags&8772)!==0&&A!==null?(A.return=k,We=A):x1(i)}}function x1(i){for(;We!==null;){var c=We;if((c.flags&8772)!==0){var h=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:ya||kh(5,c);break;case 1:var v=c.stateNode;if(c.flags&4&&!ya)if(h===null)v.componentDidMount();else{var k=c.elementType===c.type?h.memoizedProps:$r(c.type,h.memoizedProps);v.componentDidUpdate(k,h.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var A=c.updateQueue;A!==null&&mv(c,A,v);break;case 3:var U=c.updateQueue;if(U!==null){if(h=null,c.child!==null)switch(c.child.tag){case 5:h=c.child.stateNode;break;case 1:h=c.child.stateNode}mv(c,U,h)}break;case 5:var le=c.stateNode;if(h===null&&c.flags&4){h=le;var de=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":de.autoFocus&&h.focus();break;case"img":de.src&&(h.src=de.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var we=c.alternate;if(we!==null){var Fe=we.memoizedState;if(Fe!==null){var Ie=Fe.dehydrated;Ie!==null&&Xc(Ie)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(a(163))}ya||c.flags&512&&Dm(c)}catch(Ae){Nn(c,c.return,Ae)}}if(c===i){We=null;break}if(h=c.sibling,h!==null){h.return=c.return,We=h;break}We=c.return}}function m1(i){for(;We!==null;){var c=We;if(c===i){We=null;break}var h=c.sibling;if(h!==null){h.return=c.return,We=h;break}We=c.return}}function f1(i){for(;We!==null;){var c=We;try{switch(c.tag){case 0:case 11:case 15:var h=c.return;try{kh(4,c)}catch(de){Nn(c,h,de)}break;case 1:var v=c.stateNode;if(typeof v.componentDidMount=="function"){var k=c.return;try{v.componentDidMount()}catch(de){Nn(c,k,de)}}var A=c.return;try{Dm(c)}catch(de){Nn(c,A,de)}break;case 5:var U=c.return;try{Dm(c)}catch(de){Nn(c,U,de)}}}catch(de){Nn(c,c.return,de)}if(c===i){We=null;break}var le=c.sibling;if(le!==null){le.return=c.return,We=le;break}We=c.return}}var lC=Math.ceil,Th=w.ReactCurrentDispatcher,Lm=w.ReactCurrentOwner,Cr=w.ReactCurrentBatchConfig,At=0,Jn=null,Pn=null,la=0,cr=0,$o=Ci(0),Vn=0,yd=null,Cl=0,Ch=0,Pm=0,vd=null,za=null,Im=0,Go=1/0,zs=null,Sh=!1,Om=null,Fi=null,_h=!1,Li=null,Eh=0,bd=0,Mm=null,Dh=-1,Ah=0;function Aa(){return(At&6)!==0?Me():Dh!==-1?Dh:Dh=Me()}function Pi(i){return(i.mode&1)===0?1:(At&2)!==0&&la!==0?la&-la:z4.transition!==null?(Ah===0&&(Ah=oy()),Ah):(i=zt,i!==0||(i=window.event,i=i===void 0?16:gy(i.type)),i)}function Wr(i,c,h,v){if(50<bd)throw bd=0,Mm=null,Error(a(185));zc(i,h,v),((At&2)===0||i!==Jn)&&(i===Jn&&((At&2)===0&&(Ch|=h),Vn===4&&Ii(i,la)),$a(i,v),h===1&&At===0&&(c.mode&1)===0&&(Go=Me()+500,sh&&_i()))}function $a(i,c){var h=i.callbackNode;zT(i,c);var v=Hu(i,i===Jn?la:0);if(v===0)h!==null&&ze(h),i.callbackNode=null,i.callbackPriority=0;else if(c=v&-v,i.callbackPriority!==c){if(h!=null&&ze(h),c===1)i.tag===0?K4(g1.bind(null,i)):nv(g1.bind(null,i)),B4(function(){(At&6)===0&&_i()}),h=null;else{switch(cy(v)){case 1:h=Qt;break;case 4:h=tn;break;case 16:h=Sn;break;case 536870912:h=yi;break;default:h=Sn}h=T1(h,p1.bind(null,i))}i.callbackPriority=c,i.callbackNode=h}}function p1(i,c){if(Dh=-1,Ah=0,(At&6)!==0)throw Error(a(327));var h=i.callbackNode;if(qo()&&i.callbackNode!==h)return null;var v=Hu(i,i===Jn?la:0);if(v===0)return null;if((v&30)!==0||(v&i.expiredLanes)!==0||c)c=Fh(i,v);else{c=v;var k=At;At|=2;var A=v1();(Jn!==i||la!==c)&&(zs=null,Go=Me()+500,_l(i,c));do try{dC();break}catch(le){y1(i,le)}while(!0);tm(),Th.current=A,At=k,Pn!==null?c=0:(Jn=null,la=0,c=Vn)}if(c!==0){if(c===2&&(k=gx(i),k!==0&&(v=k,c=Rm(i,k))),c===1)throw h=yd,_l(i,0),Ii(i,v),$a(i,Me()),h;if(c===6)Ii(i,v);else{if(k=i.current.alternate,(v&30)===0&&!oC(k)&&(c=Fh(i,v),c===2&&(A=gx(i),A!==0&&(v=A,c=Rm(i,A))),c===1))throw h=yd,_l(i,0),Ii(i,v),$a(i,Me()),h;switch(i.finishedWork=k,i.finishedLanes=v,c){case 0:case 1:throw Error(a(345));case 2:El(i,za,zs);break;case 3:if(Ii(i,v),(v&130023424)===v&&(c=Im+500-Me(),10<c)){if(Hu(i,0)!==0)break;if(k=i.suspendedLanes,(k&v)!==v){Aa(),i.pingedLanes|=i.suspendedLanes&k;break}i.timeoutHandle=zx(El.bind(null,i,za,zs),c);break}El(i,za,zs);break;case 4:if(Ii(i,v),(v&4194240)===v)break;for(c=i.eventTimes,k=-1;0<v;){var U=31-_n(v);A=1<<U,U=c[U],U>k&&(k=U),v&=~A}if(v=k,v=Me()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*lC(v/1960))-v,10<v){i.timeoutHandle=zx(El.bind(null,i,za,zs),v);break}El(i,za,zs);break;case 5:El(i,za,zs);break;default:throw Error(a(329))}}}return $a(i,Me()),i.callbackNode===h?p1.bind(null,i):null}function Rm(i,c){var h=vd;return i.current.memoizedState.isDehydrated&&(_l(i,c).flags|=256),i=Fh(i,c),i!==2&&(c=za,za=h,c!==null&&Bm(c)),i}function Bm(i){za===null?za=i:za.push.apply(za,i)}function oC(i){for(var c=i;;){if(c.flags&16384){var h=c.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var v=0;v<h.length;v++){var k=h[v],A=k.getSnapshot;k=k.value;try{if(!Kr(A(),k))return!1}catch{return!1}}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Ii(i,c){for(c&=~Pm,c&=~Ch,i.suspendedLanes|=c,i.pingedLanes&=~c,i=i.expirationTimes;0<c;){var h=31-_n(c),v=1<<h;i[h]=-1,c&=~v}}function g1(i){if((At&6)!==0)throw Error(a(327));qo();var c=Hu(i,0);if((c&1)===0)return $a(i,Me()),null;var h=Fh(i,c);if(i.tag!==0&&h===2){var v=gx(i);v!==0&&(c=v,h=Rm(i,v))}if(h===1)throw h=yd,_l(i,0),Ii(i,c),$a(i,Me()),h;if(h===6)throw Error(a(345));return i.finishedWork=i.current.alternate,i.finishedLanes=c,El(i,za,zs),$a(i,Me()),null}function Hm(i,c){var h=At;At|=1;try{return i(c)}finally{At=h,At===0&&(Go=Me()+500,sh&&_i())}}function Sl(i){Li!==null&&Li.tag===0&&(At&6)===0&&qo();var c=At;At|=1;var h=Cr.transition,v=zt;try{if(Cr.transition=null,zt=1,i)return i()}finally{zt=v,Cr.transition=h,At=c,(At&6)===0&&_i()}}function Vm(){cr=$o.current,sn($o)}function _l(i,c){i.finishedWork=null,i.finishedLanes=0;var h=i.timeoutHandle;if(h!==-1&&(i.timeoutHandle=-1,R4(h)),Pn!==null)for(h=Pn.return;h!==null;){var v=h;switch(Qx(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&ah();break;case 3:Uo(),sn(Va),sn(fa),cm();break;case 5:lm(v);break;case 4:Uo();break;case 13:sn(pn);break;case 19:sn(pn);break;case 10:nm(v.type._context);break;case 22:case 23:Vm()}h=h.return}if(Jn=i,Pn=i=Oi(i.current,null),la=cr=c,Vn=0,yd=null,Pm=Ch=Cl=0,za=vd=null,wl!==null){for(c=0;c<wl.length;c++)if(h=wl[c],v=h.interleaved,v!==null){h.interleaved=null;var k=v.next,A=h.pending;if(A!==null){var U=A.next;A.next=k,v.next=U}h.pending=v}wl=null}return i}function y1(i,c){do{var h=Pn;try{if(tm(),fh.current=vh,ph){for(var v=gn.memoizedState;v!==null;){var k=v.queue;k!==null&&(k.pending=null),v=v.next}ph=!1}if(Tl=0,Yn=Hn=gn=null,hd=!1,xd=0,Lm.current=null,h===null||h.return===null){Vn=1,yd=c,Pn=null;break}e:{var A=i,U=h.return,le=h,de=c;if(c=la,le.flags|=32768,de!==null&&typeof de=="object"&&typeof de.then=="function"){var we=de,Fe=le,Ie=Fe.tag;if((Fe.mode&1)===0&&(Ie===0||Ie===11||Ie===15)){var Ae=Fe.alternate;Ae?(Fe.updateQueue=Ae.updateQueue,Fe.memoizedState=Ae.memoizedState,Fe.lanes=Ae.lanes):(Fe.updateQueue=null,Fe.memoizedState=null)}var Ge=Kv(U);if(Ge!==null){Ge.flags&=-257,zv(Ge,U,le,A,c),Ge.mode&1&&Uv(A,we,c),c=Ge,de=we;var Xe=c.updateQueue;if(Xe===null){var Ze=new Set;Ze.add(de),c.updateQueue=Ze}else Xe.add(de);break e}else{if((c&1)===0){Uv(A,we,c),Um();break e}de=Error(a(426))}}else if(xn&&le.mode&1){var En=Kv(U);if(En!==null){(En.flags&65536)===0&&(En.flags|=256),zv(En,U,le,A,c),Zx(Ko(de,le));break e}}A=de=Ko(de,le),Vn!==4&&(Vn=2),vd===null?vd=[A]:vd.push(A),A=U;do{switch(A.tag){case 3:A.flags|=65536,c&=-c,A.lanes|=c;var pe=Hv(A,de,c);xv(A,pe);break e;case 1:le=de;var me=A.type,ge=A.stateNode;if((A.flags&128)===0&&(typeof me.getDerivedStateFromError=="function"||ge!==null&&typeof ge.componentDidCatch=="function"&&(Fi===null||!Fi.has(ge)))){A.flags|=65536,c&=-c,A.lanes|=c;var Ve=Vv(A,le,c);xv(A,Ve);break e}}A=A.return}while(A!==null)}N1(h)}catch(et){c=et,Pn===h&&h!==null&&(Pn=h=h.return);continue}break}while(!0)}function v1(){var i=Th.current;return Th.current=vh,i===null?vh:i}function Um(){(Vn===0||Vn===3||Vn===2)&&(Vn=4),Jn===null||(Cl&268435455)===0&&(Ch&268435455)===0||Ii(Jn,la)}function Fh(i,c){var h=At;At|=2;var v=v1();(Jn!==i||la!==c)&&(zs=null,_l(i,c));do try{cC();break}catch(k){y1(i,k)}while(!0);if(tm(),At=h,Th.current=v,Pn!==null)throw Error(a(261));return Jn=null,la=0,Vn}function cC(){for(;Pn!==null;)b1(Pn)}function dC(){for(;Pn!==null&&!qe();)b1(Pn)}function b1(i){var c=k1(i.alternate,i,cr);i.memoizedProps=i.pendingProps,c===null?N1(i):Pn=c,Lm.current=null}function N1(i){var c=i;do{var h=c.alternate;if(i=c.return,(c.flags&32768)===0){if(h=nC(h,c,cr),h!==null){Pn=h;return}}else{if(h=aC(h,c),h!==null){h.flags&=32767,Pn=h;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Vn=6,Pn=null;return}}if(c=c.sibling,c!==null){Pn=c;return}Pn=c=i}while(c!==null);Vn===0&&(Vn=5)}function El(i,c,h){var v=zt,k=Cr.transition;try{Cr.transition=null,zt=1,uC(i,c,h,v)}finally{Cr.transition=k,zt=v}return null}function uC(i,c,h,v){do qo();while(Li!==null);if((At&6)!==0)throw Error(a(327));h=i.finishedWork;var k=i.finishedLanes;if(h===null)return null;if(i.finishedWork=null,i.finishedLanes=0,h===i.current)throw Error(a(177));i.callbackNode=null,i.callbackPriority=0;var A=h.lanes|h.childLanes;if($T(i,A),i===Jn&&(Pn=Jn=null,la=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||_h||(_h=!0,T1(Sn,function(){return qo(),null})),A=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||A){A=Cr.transition,Cr.transition=null;var U=zt;zt=1;var le=At;At|=4,Lm.current=null,sC(i,h),u1(h,i),A4(Ux),Ku=!!Vx,Ux=Vx=null,i.current=h,iC(h),He(),At=le,zt=U,Cr.transition=A}else i.current=h;if(_h&&(_h=!1,Li=i,Eh=k),A=i.pendingLanes,A===0&&(Fi=null),Uc(h.stateNode),$a(i,Me()),c!==null)for(v=i.onRecoverableError,h=0;h<c.length;h++)k=c[h],v(k.value,{componentStack:k.stack,digest:k.digest});if(Sh)throw Sh=!1,i=Om,Om=null,i;return(Eh&1)!==0&&i.tag!==0&&qo(),A=i.pendingLanes,(A&1)!==0?i===Mm?bd++:(bd=0,Mm=i):bd=0,_i(),null}function qo(){if(Li!==null){var i=cy(Eh),c=Cr.transition,h=zt;try{if(Cr.transition=null,zt=16>i?16:i,Li===null)var v=!1;else{if(i=Li,Li=null,Eh=0,(At&6)!==0)throw Error(a(331));var k=At;for(At|=4,We=i.current;We!==null;){var A=We,U=A.child;if((We.flags&16)!==0){var le=A.deletions;if(le!==null){for(var de=0;de<le.length;de++){var we=le[de];for(We=we;We!==null;){var Fe=We;switch(Fe.tag){case 0:case 11:case 15:gd(8,Fe,A)}var Ie=Fe.child;if(Ie!==null)Ie.return=Fe,We=Ie;else for(;We!==null;){Fe=We;var Ae=Fe.sibling,Ge=Fe.return;if(i1(Fe),Fe===we){We=null;break}if(Ae!==null){Ae.return=Ge,We=Ae;break}We=Ge}}}var Xe=A.alternate;if(Xe!==null){var Ze=Xe.child;if(Ze!==null){Xe.child=null;do{var En=Ze.sibling;Ze.sibling=null,Ze=En}while(Ze!==null)}}We=A}}if((A.subtreeFlags&2064)!==0&&U!==null)U.return=A,We=U;else e:for(;We!==null;){if(A=We,(A.flags&2048)!==0)switch(A.tag){case 0:case 11:case 15:gd(9,A,A.return)}var pe=A.sibling;if(pe!==null){pe.return=A.return,We=pe;break e}We=A.return}}var me=i.current;for(We=me;We!==null;){U=We;var ge=U.child;if((U.subtreeFlags&2064)!==0&&ge!==null)ge.return=U,We=ge;else e:for(U=me;We!==null;){if(le=We,(le.flags&2048)!==0)try{switch(le.tag){case 0:case 11:case 15:kh(9,le)}}catch(et){Nn(le,le.return,et)}if(le===U){We=null;break e}var Ve=le.sibling;if(Ve!==null){Ve.return=le.return,We=Ve;break e}We=le.return}}if(At=k,_i(),Qn&&typeof Qn.onPostCommitFiberRoot=="function")try{Qn.onPostCommitFiberRoot(os,i)}catch{}v=!0}return v}finally{zt=h,Cr.transition=c}}return!1}function j1(i,c,h){c=Ko(h,c),c=Hv(i,c,1),i=Di(i,c,1),c=Aa(),i!==null&&(zc(i,1,c),$a(i,c))}function Nn(i,c,h){if(i.tag===3)j1(i,i,h);else for(;c!==null;){if(c.tag===3){j1(c,i,h);break}else if(c.tag===1){var v=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(Fi===null||!Fi.has(v))){i=Ko(h,i),i=Vv(c,i,1),c=Di(c,i,1),i=Aa(),c!==null&&(zc(c,1,i),$a(c,i));break}}c=c.return}}function hC(i,c,h){var v=i.pingCache;v!==null&&v.delete(c),c=Aa(),i.pingedLanes|=i.suspendedLanes&h,Jn===i&&(la&h)===h&&(Vn===4||Vn===3&&(la&130023424)===la&&500>Me()-Im?_l(i,0):Pm|=h),$a(i,c)}function w1(i,c){c===0&&((i.mode&1)===0?c=1:(c=Bu,Bu<<=1,(Bu&130023424)===0&&(Bu=4194304)));var h=Aa();i=Vs(i,c),i!==null&&(zc(i,c,h),$a(i,h))}function xC(i){var c=i.memoizedState,h=0;c!==null&&(h=c.retryLane),w1(i,h)}function mC(i,c){var h=0;switch(i.tag){case 13:var v=i.stateNode,k=i.memoizedState;k!==null&&(h=k.retryLane);break;case 19:v=i.stateNode;break;default:throw Error(a(314))}v!==null&&v.delete(c),w1(i,h)}var k1;k1=function(i,c,h){if(i!==null)if(i.memoizedProps!==c.pendingProps||Va.current)Ka=!0;else{if((i.lanes&h)===0&&(c.flags&128)===0)return Ka=!1,tC(i,c,h);Ka=(i.flags&131072)!==0}else Ka=!1,xn&&(c.flags&1048576)!==0&&av(c,lh,c.index);switch(c.lanes=0,c.tag){case 2:var v=c.type;jh(i,c),i=c.pendingProps;var k=Io(c,fa.current);Vo(c,h),k=hm(null,c,v,i,k,h);var A=xm();return c.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Ua(v)?(A=!0,rh(c)):A=!1,c.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,sm(c),k.updater=bh,c.stateNode=k,k._reactInternals=c,vm(c,v,i,h),c=wm(null,c,v,!0,A,h)):(c.tag=0,xn&&A&&Xx(c),Da(null,c,k,h),c=c.child),c;case 16:v=c.elementType;e:{switch(jh(i,c),i=c.pendingProps,k=v._init,v=k(v._payload),c.type=v,k=c.tag=pC(v),i=$r(v,i),k){case 0:c=jm(null,c,v,i,h);break e;case 1:c=Qv(null,c,v,i,h);break e;case 11:c=$v(null,c,v,i,h);break e;case 14:c=Gv(null,c,v,$r(v.type,i),h);break e}throw Error(a(306,v,""))}return c;case 0:return v=c.type,k=c.pendingProps,k=c.elementType===v?k:$r(v,k),jm(i,c,v,k,h);case 1:return v=c.type,k=c.pendingProps,k=c.elementType===v?k:$r(v,k),Qv(i,c,v,k,h);case 3:e:{if(Yv(c),i===null)throw Error(a(387));v=c.pendingProps,A=c.memoizedState,k=A.element,hv(i,c),xh(c,v,null,h);var U=c.memoizedState;if(v=U.element,A.isDehydrated)if(A={element:v,isDehydrated:!1,cache:U.cache,pendingSuspenseBoundaries:U.pendingSuspenseBoundaries,transitions:U.transitions},c.updateQueue.baseState=A,c.memoizedState=A,c.flags&256){k=Ko(Error(a(423)),c),c=Jv(i,c,v,h,k);break e}else if(v!==k){k=Ko(Error(a(424)),c),c=Jv(i,c,v,h,k);break e}else for(or=Ti(c.stateNode.containerInfo.firstChild),lr=c,xn=!0,zr=null,h=dv(c,null,v,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Ro(),v===k){c=Ks(i,c,h);break e}Da(i,c,v,h)}c=c.child}return c;case 5:return fv(c),i===null&&Jx(c),v=c.type,k=c.pendingProps,A=i!==null?i.memoizedProps:null,U=k.children,Kx(v,k)?U=null:A!==null&&Kx(v,A)&&(c.flags|=32),Xv(i,c),Da(i,c,U,h),c.child;case 6:return i===null&&Jx(c),null;case 13:return Zv(i,c,h);case 4:return im(c,c.stateNode.containerInfo),v=c.pendingProps,i===null?c.child=Bo(c,null,v,h):Da(i,c,v,h),c.child;case 11:return v=c.type,k=c.pendingProps,k=c.elementType===v?k:$r(v,k),$v(i,c,v,k,h);case 7:return Da(i,c,c.pendingProps,h),c.child;case 8:return Da(i,c,c.pendingProps.children,h),c.child;case 12:return Da(i,c,c.pendingProps.children,h),c.child;case 10:e:{if(v=c.type._context,k=c.pendingProps,A=c.memoizedProps,U=k.value,nn(dh,v._currentValue),v._currentValue=U,A!==null)if(Kr(A.value,U)){if(A.children===k.children&&!Va.current){c=Ks(i,c,h);break e}}else for(A=c.child,A!==null&&(A.return=c);A!==null;){var le=A.dependencies;if(le!==null){U=A.child;for(var de=le.firstContext;de!==null;){if(de.context===v){if(A.tag===1){de=Us(-1,h&-h),de.tag=2;var we=A.updateQueue;if(we!==null){we=we.shared;var Fe=we.pending;Fe===null?de.next=de:(de.next=Fe.next,Fe.next=de),we.pending=de}}A.lanes|=h,de=A.alternate,de!==null&&(de.lanes|=h),am(A.return,h,c),le.lanes|=h;break}de=de.next}}else if(A.tag===10)U=A.type===c.type?null:A.child;else if(A.tag===18){if(U=A.return,U===null)throw Error(a(341));U.lanes|=h,le=U.alternate,le!==null&&(le.lanes|=h),am(U,h,c),U=A.sibling}else U=A.child;if(U!==null)U.return=A;else for(U=A;U!==null;){if(U===c){U=null;break}if(A=U.sibling,A!==null){A.return=U.return,U=A;break}U=U.return}A=U}Da(i,c,k.children,h),c=c.child}return c;case 9:return k=c.type,v=c.pendingProps.children,Vo(c,h),k=kr(k),v=v(k),c.flags|=1,Da(i,c,v,h),c.child;case 14:return v=c.type,k=$r(v,c.pendingProps),k=$r(v.type,k),Gv(i,c,v,k,h);case 15:return qv(i,c,c.type,c.pendingProps,h);case 17:return v=c.type,k=c.pendingProps,k=c.elementType===v?k:$r(v,k),jh(i,c),c.tag=1,Ua(v)?(i=!0,rh(c)):i=!1,Vo(c,h),Rv(c,v,k),vm(c,v,k,h),wm(null,c,v,!0,i,h);case 19:return t1(i,c,h);case 22:return Wv(i,c,h)}throw Error(a(156,c.tag))};function T1(i,c){return Pe(i,c)}function fC(i,c,h,v){this.tag=i,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sr(i,c,h,v){return new fC(i,c,h,v)}function Km(i){return i=i.prototype,!(!i||!i.isReactComponent)}function pC(i){if(typeof i=="function")return Km(i)?1:0;if(i!=null){if(i=i.$$typeof,i===M)return 11;if(i===B)return 14}return 2}function Oi(i,c){var h=i.alternate;return h===null?(h=Sr(i.tag,c,i.key,i.mode),h.elementType=i.elementType,h.type=i.type,h.stateNode=i.stateNode,h.alternate=i,i.alternate=h):(h.pendingProps=c,h.type=i.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=i.flags&14680064,h.childLanes=i.childLanes,h.lanes=i.lanes,h.child=i.child,h.memoizedProps=i.memoizedProps,h.memoizedState=i.memoizedState,h.updateQueue=i.updateQueue,c=i.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=i.sibling,h.index=i.index,h.ref=i.ref,h}function Lh(i,c,h,v,k,A){var U=2;if(v=i,typeof i=="function")Km(i)&&(U=1);else if(typeof i=="string")U=5;else e:switch(i){case C:return Dl(h.children,k,A,c);case P:U=8,k|=8;break;case F:return i=Sr(12,h,c,k|2),i.elementType=F,i.lanes=A,i;case q:return i=Sr(13,h,c,k),i.elementType=q,i.lanes=A,i;case J:return i=Sr(19,h,c,k),i.elementType=J,i.lanes=A,i;case te:return Ph(h,k,A,c);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case R:U=10;break e;case O:U=9;break e;case M:U=11;break e;case B:U=14;break e;case ue:U=16,v=null;break e}throw Error(a(130,i==null?i:typeof i,""))}return c=Sr(U,h,c,k),c.elementType=i,c.type=v,c.lanes=A,c}function Dl(i,c,h,v){return i=Sr(7,i,v,c),i.lanes=h,i}function Ph(i,c,h,v){return i=Sr(22,i,v,c),i.elementType=te,i.lanes=h,i.stateNode={isHidden:!1},i}function zm(i,c,h){return i=Sr(6,i,null,c),i.lanes=h,i}function $m(i,c,h){return c=Sr(4,i.children!==null?i.children:[],i.key,c),c.lanes=h,c.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},c}function gC(i,c,h,v,k){this.tag=c,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yx(0),this.expirationTimes=yx(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yx(0),this.identifierPrefix=v,this.onRecoverableError=k,this.mutableSourceEagerHydrationData=null}function Gm(i,c,h,v,k,A,U,le,de){return i=new gC(i,c,h,le,de),c===1?(c=1,A===!0&&(c|=8)):c=0,A=Sr(3,null,null,c),i.current=A,A.stateNode=i,A.memoizedState={element:v,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},sm(A),i}function yC(i,c,h){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:E,key:v==null?null:""+v,children:i,containerInfo:c,implementation:h}}function C1(i){if(!i)return Si;i=i._reactInternals;e:{if(se(i)!==i||i.tag!==1)throw Error(a(170));var c=i;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Ua(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(a(171))}if(i.tag===1){var h=i.type;if(Ua(h))return ev(i,h,c)}return c}function S1(i,c,h,v,k,A,U,le,de){return i=Gm(h,v,!0,i,k,A,U,le,de),i.context=C1(null),h=i.current,v=Aa(),k=Pi(h),A=Us(v,k),A.callback=c??null,Di(h,A,k),i.current.lanes=k,zc(i,k,v),$a(i,v),i}function Ih(i,c,h,v){var k=c.current,A=Aa(),U=Pi(k);return h=C1(h),c.context===null?c.context=h:c.pendingContext=h,c=Us(A,U),c.payload={element:i},v=v===void 0?null:v,v!==null&&(c.callback=v),i=Di(k,c,U),i!==null&&(Wr(i,k,U,A),hh(i,k,U)),U}function Oh(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function _1(i,c){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var h=i.retryLane;i.retryLane=h!==0&&h<c?h:c}}function qm(i,c){_1(i,c),(i=i.alternate)&&_1(i,c)}function vC(){return null}var E1=typeof reportError=="function"?reportError:function(i){console.error(i)};function Wm(i){this._internalRoot=i}Mh.prototype.render=Wm.prototype.render=function(i){var c=this._internalRoot;if(c===null)throw Error(a(409));Ih(i,c,null,null)},Mh.prototype.unmount=Wm.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var c=i.containerInfo;Sl(function(){Ih(null,i,null,null)}),c[Ms]=null}};function Mh(i){this._internalRoot=i}Mh.prototype.unstable_scheduleHydration=function(i){if(i){var c=hy();i={blockedOn:null,target:i,priority:c};for(var h=0;h<ji.length&&c!==0&&c<ji[h].priority;h++);ji.splice(h,0,i),h===0&&fy(i)}};function Xm(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Rh(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function D1(){}function bC(i,c,h,v,k){if(k){if(typeof v=="function"){var A=v;v=function(){var we=Oh(U);A.call(we)}}var U=S1(c,v,i,0,null,!1,!1,"",D1);return i._reactRootContainer=U,i[Ms]=U.current,rd(i.nodeType===8?i.parentNode:i),Sl(),U}for(;k=i.lastChild;)i.removeChild(k);if(typeof v=="function"){var le=v;v=function(){var we=Oh(de);le.call(we)}}var de=Gm(i,0,!1,null,null,!1,!1,"",D1);return i._reactRootContainer=de,i[Ms]=de.current,rd(i.nodeType===8?i.parentNode:i),Sl(function(){Ih(c,de,h,v)}),de}function Bh(i,c,h,v,k){var A=h._reactRootContainer;if(A){var U=A;if(typeof k=="function"){var le=k;k=function(){var de=Oh(U);le.call(de)}}Ih(c,U,i,k)}else U=bC(h,c,i,k,v);return Oh(U)}dy=function(i){switch(i.tag){case 3:var c=i.stateNode;if(c.current.memoizedState.isDehydrated){var h=Kc(c.pendingLanes);h!==0&&(vx(c,h|1),$a(c,Me()),(At&6)===0&&(Go=Me()+500,_i()))}break;case 13:Sl(function(){var v=Vs(i,1);if(v!==null){var k=Aa();Wr(v,i,1,k)}}),qm(i,1)}},bx=function(i){if(i.tag===13){var c=Vs(i,134217728);if(c!==null){var h=Aa();Wr(c,i,134217728,h)}qm(i,134217728)}},uy=function(i){if(i.tag===13){var c=Pi(i),h=Vs(i,c);if(h!==null){var v=Aa();Wr(h,i,c,v)}qm(i,c)}},hy=function(){return zt},xy=function(i,c){var h=zt;try{return zt=i,c()}finally{zt=h}},ko=function(i,c,h){switch(c){case"input":if(Re(i,h),c=h.name,h.type==="radio"&&c!=null){for(h=i;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<h.length;c++){var v=h[c];if(v!==i&&v.form===i.form){var k=nh(v);if(!k)throw Error(a(90));V(v),Re(v,k)}}}break;case"textarea":Be(i,h);break;case"select":c=h.value,c!=null&&Cn(i,!!h.multiple,c,!1)}},Iu=Hm,Ou=Sl;var NC={usingClientEntryPoint:!1,Events:[ld,Lo,nh,Lu,Pu,Hm]},Nd={findFiberByHostInstance:vl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},jC={bundleType:Nd.bundleType,version:Nd.version,rendererPackageName:Nd.rendererPackageName,rendererConfig:Nd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Ne(i),i===null?null:i.stateNode},findFiberByHostInstance:Nd.findFiberByHostInstance||vC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hh.isDisabled&&Hh.supportsFiber)try{os=Hh.inject(jC),Qn=Hh}catch{}}return Ga.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NC,Ga.createPortal=function(i,c){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xm(c))throw Error(a(200));return yC(i,c,null,h)},Ga.createRoot=function(i,c){if(!Xm(i))throw Error(a(299));var h=!1,v="",k=E1;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onRecoverableError!==void 0&&(k=c.onRecoverableError)),c=Gm(i,1,!1,null,null,h,!1,v,k),i[Ms]=c.current,rd(i.nodeType===8?i.parentNode:i),new Wm(c)},Ga.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var c=i._reactInternals;if(c===void 0)throw typeof i.render=="function"?Error(a(188)):(i=Object.keys(i).join(","),Error(a(268,i)));return i=Ne(c),i=i===null?null:i.stateNode,i},Ga.flushSync=function(i){return Sl(i)},Ga.hydrate=function(i,c,h){if(!Rh(c))throw Error(a(200));return Bh(null,i,c,!0,h)},Ga.hydrateRoot=function(i,c,h){if(!Xm(i))throw Error(a(405));var v=h!=null&&h.hydratedSources||null,k=!1,A="",U=E1;if(h!=null&&(h.unstable_strictMode===!0&&(k=!0),h.identifierPrefix!==void 0&&(A=h.identifierPrefix),h.onRecoverableError!==void 0&&(U=h.onRecoverableError)),c=S1(c,null,i,1,h??null,k,!1,A,U),i[Ms]=c.current,rd(i),v)for(i=0;i<v.length;i++)h=v[i],k=h._getVersion,k=k(h._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[h,k]:c.mutableSourceEagerHydrationData.push(h,k);return new Mh(c)},Ga.render=function(i,c,h){if(!Rh(c))throw Error(a(200));return Bh(null,i,c,!1,h)},Ga.unmountComponentAtNode=function(i){if(!Rh(i))throw Error(a(40));return i._reactRootContainer?(Sl(function(){Bh(null,null,i,!1,function(){i._reactRootContainer=null,i[Ms]=null})}),!0):!1},Ga.unstable_batchedUpdates=Hm,Ga.unstable_renderSubtreeIntoContainer=function(i,c,h,v){if(!Rh(h))throw Error(a(200));if(i==null||i._reactInternals===void 0)throw Error(a(38));return Bh(i,c,h,!1,v)},Ga.version="18.3.1-next-f1338f8080-20240426",Ga}var B1;function A2(){if(B1)return ef.exports;B1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),ef.exports=LC(),ef.exports}var H1;function PC(){if(H1)return Uh;H1=1;var e=A2();return Uh.createRoot=e.createRoot,Uh.hydrateRoot=e.hydrateRoot,Uh}var IC=PC(),Dc=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},OC={setTimeout:(e,n)=>setTimeout(e,n),clearTimeout:e=>clearTimeout(e),setInterval:(e,n)=>setInterval(e,n),clearInterval:e=>clearInterval(e)},Vi,Hp,v2,MC=(v2=class{constructor(){at(this,Vi,OC);at(this,Hp,!1)}setTimeoutProvider(e){$e(this,Vi,e)}setTimeout(e,n){return ce(this,Vi).setTimeout(e,n)}clearTimeout(e){ce(this,Vi).clearTimeout(e)}setInterval(e,n){return ce(this,Vi).setInterval(e,n)}clearInterval(e){ce(this,Vi).clearInterval(e)}},Vi=new WeakMap,Hp=new WeakMap,v2),Bl=new MC;function RC(e){setTimeout(e,0)}var ao=typeof window>"u"||"Deno"in globalThis;function Pa(){}function BC(e,n){return typeof e=="function"?e(n):e}function Gf(e){return typeof e=="number"&&e>=0&&e!==1/0}function F2(e,n){return Math.max(e+(n||0)-Date.now(),0)}function nl(e,n){return typeof e=="function"?e(n):e}function Ir(e,n){return typeof e=="function"?e(n):e}function V1(e,n){const{type:a="all",exact:r,fetchStatus:s,predicate:l,queryKey:o,stale:d}=e;if(o){if(r){if(n.queryHash!==Kp(o,n.options))return!1}else if(!Gd(n.queryKey,o))return!1}if(a!=="all"){const u=n.isActive();if(a==="active"&&!u||a==="inactive"&&u)return!1}return!(typeof d=="boolean"&&n.isStale()!==d||s&&s!==n.state.fetchStatus||l&&!l(n))}function U1(e,n){const{exact:a,status:r,predicate:s,mutationKey:l}=e;if(l){if(!n.options.mutationKey)return!1;if(a){if(ro(n.options.mutationKey)!==ro(l))return!1}else if(!Gd(n.options.mutationKey,l))return!1}return!(r&&n.state.status!==r||s&&!s(n))}function Kp(e,n){return((n==null?void 0:n.queryKeyHashFn)||ro)(e)}function ro(e){return JSON.stringify(e,(n,a)=>qf(a)?Object.keys(a).sort().reduce((r,s)=>(r[s]=a[s],r),{}):a)}function Gd(e,n){return e===n?!0:typeof e!=typeof n?!1:e&&n&&typeof e=="object"&&typeof n=="object"?Object.keys(n).every(a=>Gd(e[a],n[a])):!1}var HC=Object.prototype.hasOwnProperty;function L2(e,n){if(e===n)return e;const a=K1(e)&&K1(n);if(!a&&!(qf(e)&&qf(n)))return n;const s=(a?e:Object.keys(e)).length,l=a?n:Object.keys(n),o=l.length,d=a?new Array(o):{};let u=0;for(let x=0;x<o;x++){const m=a?x:l[x],f=e[m],p=n[m];if(f===p){d[m]=f,(a?x<s:HC.call(e,m))&&u++;continue}if(f===null||p===null||typeof f!="object"||typeof p!="object"){d[m]=p;continue}const N=L2(f,p);d[m]=N,N===f&&u++}return s===o&&u===s?e:d}function m0(e,n){if(!n||Object.keys(e).length!==Object.keys(n).length)return!1;for(const a in e)if(e[a]!==n[a])return!1;return!0}function K1(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function qf(e){if(!z1(e))return!1;const n=e.constructor;if(n===void 0)return!0;const a=n.prototype;return!(!z1(a)||!a.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function z1(e){return Object.prototype.toString.call(e)==="[object Object]"}function VC(e){return new Promise(n=>{Bl.setTimeout(n,e)})}function Wf(e,n,a){return typeof a.structuralSharing=="function"?a.structuralSharing(e,n):a.structuralSharing!==!1?L2(e,n):n}function UC(e,n,a=0){const r=[...e,n];return a&&r.length>a?r.slice(1):r}function KC(e,n,a=0){const r=[n,...e];return a&&r.length>a?r.slice(0,-1):r}var zp=Symbol();function P2(e,n){return!e.queryFn&&(n!=null&&n.initialPromise)?()=>n.initialPromise:!e.queryFn||e.queryFn===zp?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function $p(e,n){return typeof e=="function"?e(...n):!!e}function zC(e,n,a){let r=!1,s;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(s??(s=n()),r||(r=!0,s.aborted?a():s.addEventListener("abort",a,{once:!0})),s)}),e}var Kl,Ui,dc,b2,$C=(b2=class extends Dc{constructor(){super();at(this,Kl);at(this,Ui);at(this,dc);$e(this,dc,n=>{if(!ao&&window.addEventListener){const a=()=>n();return window.addEventListener("visibilitychange",a,!1),()=>{window.removeEventListener("visibilitychange",a)}}})}onSubscribe(){ce(this,Ui)||this.setEventListener(ce(this,dc))}onUnsubscribe(){var n;this.hasListeners()||((n=ce(this,Ui))==null||n.call(this),$e(this,Ui,void 0))}setEventListener(n){var a;$e(this,dc,n),(a=ce(this,Ui))==null||a.call(this),$e(this,Ui,n(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(n){ce(this,Kl)!==n&&($e(this,Kl,n),this.onFocus())}onFocus(){const n=this.isFocused();this.listeners.forEach(a=>{a(n)})}isFocused(){var n;return typeof ce(this,Kl)=="boolean"?ce(this,Kl):((n=globalThis.document)==null?void 0:n.visibilityState)!=="hidden"}},Kl=new WeakMap,Ui=new WeakMap,dc=new WeakMap,b2),Gp=new $C;function Xf(){let e,n;const a=new Promise((s,l)=>{e=s,n=l});a.status="pending",a.catch(()=>{});function r(s){Object.assign(a,s),delete a.resolve,delete a.reject}return a.resolve=s=>{r({status:"fulfilled",value:s}),e(s)},a.reject=s=>{r({status:"rejected",reason:s}),n(s)},a}var GC=RC;function qC(){let e=[],n=0,a=d=>{d()},r=d=>{d()},s=GC;const l=d=>{n?e.push(d):s(()=>{a(d)})},o=()=>{const d=e;e=[],d.length&&s(()=>{r(()=>{d.forEach(u=>{a(u)})})})};return{batch:d=>{let u;n++;try{u=d()}finally{n--,n||o()}return u},batchCalls:d=>(...u)=>{l(()=>{d(...u)})},schedule:l,setNotifyFunction:d=>{a=d},setBatchNotifyFunction:d=>{r=d},setScheduler:d=>{s=d}}}var Kn=qC(),uc,Ki,hc,N2,WC=(N2=class extends Dc{constructor(){super();at(this,uc,!0);at(this,Ki);at(this,hc);$e(this,hc,n=>{if(!ao&&window.addEventListener){const a=()=>n(!0),r=()=>n(!1);return window.addEventListener("online",a,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",a),window.removeEventListener("offline",r)}}})}onSubscribe(){ce(this,Ki)||this.setEventListener(ce(this,hc))}onUnsubscribe(){var n;this.hasListeners()||((n=ce(this,Ki))==null||n.call(this),$e(this,Ki,void 0))}setEventListener(n){var a;$e(this,hc,n),(a=ce(this,Ki))==null||a.call(this),$e(this,Ki,n(this.setOnline.bind(this)))}setOnline(n){ce(this,uc)!==n&&($e(this,uc,n),this.listeners.forEach(r=>{r(n)}))}isOnline(){return ce(this,uc)}},uc=new WeakMap,Ki=new WeakMap,hc=new WeakMap,N2),f0=new WC;function XC(e){return Math.min(1e3*2**e,3e4)}function I2(e){return(e??"online")==="online"?f0.isOnline():!0}var Qf=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function O2(e){let n=!1,a=0,r;const s=Xf(),l=()=>s.status!=="pending",o=g=>{var b;if(!l()){const j=new Qf(g);p(j),(b=e.onCancel)==null||b.call(e,j)}},d=()=>{n=!0},u=()=>{n=!1},x=()=>Gp.isFocused()&&(e.networkMode==="always"||f0.isOnline())&&e.canRun(),m=()=>I2(e.networkMode)&&e.canRun(),f=g=>{l()||(r==null||r(),s.resolve(g))},p=g=>{l()||(r==null||r(),s.reject(g))},N=()=>new Promise(g=>{var b;r=j=>{(l()||x())&&g(j)},(b=e.onPause)==null||b.call(e)}).then(()=>{var g;r=void 0,l()||(g=e.onContinue)==null||g.call(e)}),y=()=>{if(l())return;let g;const b=a===0?e.initialPromise:void 0;try{g=b??e.fn()}catch(j){g=Promise.reject(j)}Promise.resolve(g).then(f).catch(j=>{var E;if(l())return;const T=e.retry??(ao?0:3),S=e.retryDelay??XC,w=typeof S=="function"?S(a,j):S,_=T===!0||typeof T=="number"&&a<T||typeof T=="function"&&T(a,j);if(n||!_){p(j);return}a++,(E=e.onFail)==null||E.call(e,a,j),VC(w).then(()=>x()?void 0:N()).then(()=>{n?p(j):y()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r==null||r(),s),cancelRetry:d,continueRetry:u,canStart:m,start:()=>(m()?y():N().then(y),s)}}var zl,j2,M2=(j2=class{constructor(){at(this,zl)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Gf(this.gcTime)&&$e(this,zl,Bl.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(ao?1/0:300*1e3))}clearGcTimeout(){ce(this,zl)&&(Bl.clearTimeout(ce(this,zl)),$e(this,zl,void 0))}},zl=new WeakMap,j2),$l,xc,Lr,Gl,ea,uu,ql,Qr,Gs,w2,QC=(w2=class extends M2{constructor(n){super();at(this,Qr);at(this,$l);at(this,xc);at(this,Lr);at(this,Gl);at(this,ea);at(this,uu);at(this,ql);$e(this,ql,!1),$e(this,uu,n.defaultOptions),this.setOptions(n.options),this.observers=[],$e(this,Gl,n.client),$e(this,Lr,ce(this,Gl).getQueryCache()),this.queryKey=n.queryKey,this.queryHash=n.queryHash,$e(this,$l,G1(this.options)),this.state=n.state??ce(this,$l),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var n;return(n=ce(this,ea))==null?void 0:n.promise}setOptions(n){if(this.options={...ce(this,uu),...n},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const a=G1(this.options);a.data!==void 0&&(this.setState($1(a.data,a.dataUpdatedAt)),$e(this,$l,a))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ce(this,Lr).remove(this)}setData(n,a){const r=Wf(this.state.data,n,this.options);return vt(this,Qr,Gs).call(this,{data:r,type:"success",dataUpdatedAt:a==null?void 0:a.updatedAt,manual:a==null?void 0:a.manual}),r}setState(n,a){vt(this,Qr,Gs).call(this,{type:"setState",state:n,setStateOptions:a})}cancel(n){var r,s;const a=(r=ce(this,ea))==null?void 0:r.promise;return(s=ce(this,ea))==null||s.cancel(n),a?a.then(Pa).catch(Pa):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ce(this,$l))}isActive(){return this.observers.some(n=>Ir(n.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===zp||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(n=>nl(n.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(n=>n.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(n=0){return this.state.data===void 0?!0:n==="static"?!1:this.state.isInvalidated?!0:!F2(this.state.dataUpdatedAt,n)}onFocus(){var a;const n=this.observers.find(r=>r.shouldFetchOnWindowFocus());n==null||n.refetch({cancelRefetch:!1}),(a=ce(this,ea))==null||a.continue()}onOnline(){var a;const n=this.observers.find(r=>r.shouldFetchOnReconnect());n==null||n.refetch({cancelRefetch:!1}),(a=ce(this,ea))==null||a.continue()}addObserver(n){this.observers.includes(n)||(this.observers.push(n),this.clearGcTimeout(),ce(this,Lr).notify({type:"observerAdded",query:this,observer:n}))}removeObserver(n){this.observers.includes(n)&&(this.observers=this.observers.filter(a=>a!==n),this.observers.length||(ce(this,ea)&&(ce(this,ql)?ce(this,ea).cancel({revert:!0}):ce(this,ea).cancelRetry()),this.scheduleGc()),ce(this,Lr).notify({type:"observerRemoved",query:this,observer:n}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||vt(this,Qr,Gs).call(this,{type:"invalidate"})}async fetch(n,a){var u,x,m,f,p,N,y,g,b,j,T,S;if(this.state.fetchStatus!=="idle"&&((u=ce(this,ea))==null?void 0:u.status())!=="rejected"){if(this.state.data!==void 0&&(a!=null&&a.cancelRefetch))this.cancel({silent:!0});else if(ce(this,ea))return ce(this,ea).continueRetry(),ce(this,ea).promise}if(n&&this.setOptions(n),!this.options.queryFn){const w=this.observers.find(_=>_.options.queryFn);w&&this.setOptions(w.options)}const r=new AbortController,s=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>($e(this,ql,!0),r.signal)})},l=()=>{const w=P2(this.options,a),E=(()=>{const C={client:ce(this,Gl),queryKey:this.queryKey,meta:this.meta};return s(C),C})();return $e(this,ql,!1),this.options.persister?this.options.persister(w,E,this):w(E)},d=(()=>{const w={fetchOptions:a,options:this.options,queryKey:this.queryKey,client:ce(this,Gl),state:this.state,fetchFn:l};return s(w),w})();(x=this.options.behavior)==null||x.onFetch(d,this),$e(this,xc,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((m=d.fetchOptions)==null?void 0:m.meta))&&vt(this,Qr,Gs).call(this,{type:"fetch",meta:(f=d.fetchOptions)==null?void 0:f.meta}),$e(this,ea,O2({initialPromise:a==null?void 0:a.initialPromise,fn:d.fetchFn,onCancel:w=>{w instanceof Qf&&w.revert&&this.setState({...ce(this,xc),fetchStatus:"idle"}),r.abort()},onFail:(w,_)=>{vt(this,Qr,Gs).call(this,{type:"failed",failureCount:w,error:_})},onPause:()=>{vt(this,Qr,Gs).call(this,{type:"pause"})},onContinue:()=>{vt(this,Qr,Gs).call(this,{type:"continue"})},retry:d.options.retry,retryDelay:d.options.retryDelay,networkMode:d.options.networkMode,canRun:()=>!0}));try{const w=await ce(this,ea).start();if(w===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(w),(N=(p=ce(this,Lr).config).onSuccess)==null||N.call(p,w,this),(g=(y=ce(this,Lr).config).onSettled)==null||g.call(y,w,this.state.error,this),w}catch(w){if(w instanceof Qf){if(w.silent)return ce(this,ea).promise;if(w.revert){if(this.state.data===void 0)throw w;return this.state.data}}throw vt(this,Qr,Gs).call(this,{type:"error",error:w}),(j=(b=ce(this,Lr).config).onError)==null||j.call(b,w,this),(S=(T=ce(this,Lr).config).onSettled)==null||S.call(T,this.state.data,w,this),w}finally{this.scheduleGc()}}},$l=new WeakMap,xc=new WeakMap,Lr=new WeakMap,Gl=new WeakMap,ea=new WeakMap,uu=new WeakMap,ql=new WeakMap,Qr=new WeakSet,Gs=function(n){const a=r=>{switch(n.type){case"failed":return{...r,fetchFailureCount:n.failureCount,fetchFailureReason:n.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...R2(r.data,this.options),fetchMeta:n.meta??null};case"success":const s={...r,...$1(n.data,n.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!n.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return $e(this,xc,n.manual?s:void 0),s;case"error":const l=n.error;return{...r,error:l,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...n.state}}};this.state=a(this.state),Kn.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),ce(this,Lr).notify({query:this,type:"updated",action:n})})},w2);function R2(e,n){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:I2(n.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function $1(e,n){return{data:e,dataUpdatedAt:n??Date.now(),error:null,isInvalidated:!1,status:"success"}}function G1(e){const n=typeof e.initialData=="function"?e.initialData():e.initialData,a=n!==void 0,r=a?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:n,dataUpdateCount:0,dataUpdatedAt:a?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:a?"success":"pending",fetchStatus:"idle"}}var qa,St,hu,Fa,Wl,mc,Xs,zi,xu,fc,pc,Xl,Ql,$i,gc,Kt,Dd,Yf,Jf,Zf,ep,tp,np,ap,B2,k2,YC=(k2=class extends Dc{constructor(n,a){super();at(this,Kt);at(this,qa);at(this,St);at(this,hu);at(this,Fa);at(this,Wl);at(this,mc);at(this,Xs);at(this,zi);at(this,xu);at(this,fc);at(this,pc);at(this,Xl);at(this,Ql);at(this,$i);at(this,gc,new Set);this.options=a,$e(this,qa,n),$e(this,zi,null),$e(this,Xs,Xf()),this.bindMethods(),this.setOptions(a)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(ce(this,St).addObserver(this),q1(ce(this,St),this.options)?vt(this,Kt,Dd).call(this):this.updateResult(),vt(this,Kt,ep).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return rp(ce(this,St),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return rp(ce(this,St),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,vt(this,Kt,tp).call(this),vt(this,Kt,np).call(this),ce(this,St).removeObserver(this)}setOptions(n){const a=this.options,r=ce(this,St);if(this.options=ce(this,qa).defaultQueryOptions(n),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Ir(this.options.enabled,ce(this,St))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");vt(this,Kt,ap).call(this),ce(this,St).setOptions(this.options),a._defaulted&&!m0(this.options,a)&&ce(this,qa).getQueryCache().notify({type:"observerOptionsUpdated",query:ce(this,St),observer:this});const s=this.hasListeners();s&&W1(ce(this,St),r,this.options,a)&&vt(this,Kt,Dd).call(this),this.updateResult(),s&&(ce(this,St)!==r||Ir(this.options.enabled,ce(this,St))!==Ir(a.enabled,ce(this,St))||nl(this.options.staleTime,ce(this,St))!==nl(a.staleTime,ce(this,St)))&&vt(this,Kt,Yf).call(this);const l=vt(this,Kt,Jf).call(this);s&&(ce(this,St)!==r||Ir(this.options.enabled,ce(this,St))!==Ir(a.enabled,ce(this,St))||l!==ce(this,$i))&&vt(this,Kt,Zf).call(this,l)}getOptimisticResult(n){const a=ce(this,qa).getQueryCache().build(ce(this,qa),n),r=this.createResult(a,n);return ZC(this,r)&&($e(this,Fa,r),$e(this,mc,this.options),$e(this,Wl,ce(this,St).state)),r}getCurrentResult(){return ce(this,Fa)}trackResult(n,a){return new Proxy(n,{get:(r,s)=>(this.trackProp(s),a==null||a(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&ce(this,Xs).status==="pending"&&ce(this,Xs).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,s))})}trackProp(n){ce(this,gc).add(n)}getCurrentQuery(){return ce(this,St)}refetch({...n}={}){return this.fetch({...n})}fetchOptimistic(n){const a=ce(this,qa).defaultQueryOptions(n),r=ce(this,qa).getQueryCache().build(ce(this,qa),a);return r.fetch().then(()=>this.createResult(r,a))}fetch(n){return vt(this,Kt,Dd).call(this,{...n,cancelRefetch:n.cancelRefetch??!0}).then(()=>(this.updateResult(),ce(this,Fa)))}createResult(n,a){var F;const r=ce(this,St),s=this.options,l=ce(this,Fa),o=ce(this,Wl),d=ce(this,mc),x=n!==r?n.state:ce(this,hu),{state:m}=n;let f={...m},p=!1,N;if(a._optimisticResults){const R=this.hasListeners(),O=!R&&q1(n,a),M=R&&W1(n,r,a,s);(O||M)&&(f={...f,...R2(m.data,n.options)}),a._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:y,errorUpdatedAt:g,status:b}=f;N=f.data;let j=!1;if(a.placeholderData!==void 0&&N===void 0&&b==="pending"){let R;l!=null&&l.isPlaceholderData&&a.placeholderData===(d==null?void 0:d.placeholderData)?(R=l.data,j=!0):R=typeof a.placeholderData=="function"?a.placeholderData((F=ce(this,pc))==null?void 0:F.state.data,ce(this,pc)):a.placeholderData,R!==void 0&&(b="success",N=Wf(l==null?void 0:l.data,R,a),p=!0)}if(a.select&&N!==void 0&&!j)if(l&&N===(o==null?void 0:o.data)&&a.select===ce(this,xu))N=ce(this,fc);else try{$e(this,xu,a.select),N=a.select(N),N=Wf(l==null?void 0:l.data,N,a),$e(this,fc,N),$e(this,zi,null)}catch(R){$e(this,zi,R)}ce(this,zi)&&(y=ce(this,zi),N=ce(this,fc),g=Date.now(),b="error");const T=f.fetchStatus==="fetching",S=b==="pending",w=b==="error",_=S&&T,E=N!==void 0,P={status:b,fetchStatus:f.fetchStatus,isPending:S,isSuccess:b==="success",isError:w,isInitialLoading:_,isLoading:_,data:N,dataUpdatedAt:f.dataUpdatedAt,error:y,errorUpdatedAt:g,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>x.dataUpdateCount||f.errorUpdateCount>x.errorUpdateCount,isFetching:T,isRefetching:T&&!S,isLoadingError:w&&!E,isPaused:f.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:w&&E,isStale:qp(n,a),refetch:this.refetch,promise:ce(this,Xs),isEnabled:Ir(a.enabled,n)!==!1};if(this.options.experimental_prefetchInRender){const R=q=>{P.status==="error"?q.reject(P.error):P.data!==void 0&&q.resolve(P.data)},O=()=>{const q=$e(this,Xs,P.promise=Xf());R(q)},M=ce(this,Xs);switch(M.status){case"pending":n.queryHash===r.queryHash&&R(M);break;case"fulfilled":(P.status==="error"||P.data!==M.value)&&O();break;case"rejected":(P.status!=="error"||P.error!==M.reason)&&O();break}}return P}updateResult(){const n=ce(this,Fa),a=this.createResult(ce(this,St),this.options);if($e(this,Wl,ce(this,St).state),$e(this,mc,this.options),ce(this,Wl).data!==void 0&&$e(this,pc,ce(this,St)),m0(a,n))return;$e(this,Fa,a);const r=()=>{if(!n)return!0;const{notifyOnChangeProps:s}=this.options,l=typeof s=="function"?s():s;if(l==="all"||!l&&!ce(this,gc).size)return!0;const o=new Set(l??ce(this,gc));return this.options.throwOnError&&o.add("error"),Object.keys(ce(this,Fa)).some(d=>{const u=d;return ce(this,Fa)[u]!==n[u]&&o.has(u)})};vt(this,Kt,B2).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&vt(this,Kt,ep).call(this)}},qa=new WeakMap,St=new WeakMap,hu=new WeakMap,Fa=new WeakMap,Wl=new WeakMap,mc=new WeakMap,Xs=new WeakMap,zi=new WeakMap,xu=new WeakMap,fc=new WeakMap,pc=new WeakMap,Xl=new WeakMap,Ql=new WeakMap,$i=new WeakMap,gc=new WeakMap,Kt=new WeakSet,Dd=function(n){vt(this,Kt,ap).call(this);let a=ce(this,St).fetch(this.options,n);return n!=null&&n.throwOnError||(a=a.catch(Pa)),a},Yf=function(){vt(this,Kt,tp).call(this);const n=nl(this.options.staleTime,ce(this,St));if(ao||ce(this,Fa).isStale||!Gf(n))return;const r=F2(ce(this,Fa).dataUpdatedAt,n)+1;$e(this,Xl,Bl.setTimeout(()=>{ce(this,Fa).isStale||this.updateResult()},r))},Jf=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(ce(this,St)):this.options.refetchInterval)??!1},Zf=function(n){vt(this,Kt,np).call(this),$e(this,$i,n),!(ao||Ir(this.options.enabled,ce(this,St))===!1||!Gf(ce(this,$i))||ce(this,$i)===0)&&$e(this,Ql,Bl.setInterval(()=>{(this.options.refetchIntervalInBackground||Gp.isFocused())&&vt(this,Kt,Dd).call(this)},ce(this,$i)))},ep=function(){vt(this,Kt,Yf).call(this),vt(this,Kt,Zf).call(this,vt(this,Kt,Jf).call(this))},tp=function(){ce(this,Xl)&&(Bl.clearTimeout(ce(this,Xl)),$e(this,Xl,void 0))},np=function(){ce(this,Ql)&&(Bl.clearInterval(ce(this,Ql)),$e(this,Ql,void 0))},ap=function(){const n=ce(this,qa).getQueryCache().build(ce(this,qa),this.options);if(n===ce(this,St))return;const a=ce(this,St);$e(this,St,n),$e(this,hu,n.state),this.hasListeners()&&(a==null||a.removeObserver(this),n.addObserver(this))},B2=function(n){Kn.batch(()=>{n.listeners&&this.listeners.forEach(a=>{a(ce(this,Fa))}),ce(this,qa).getQueryCache().notify({query:ce(this,St),type:"observerResultsUpdated"})})},k2);function JC(e,n){return Ir(n.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&n.retryOnMount===!1)}function q1(e,n){return JC(e,n)||e.state.data!==void 0&&rp(e,n,n.refetchOnMount)}function rp(e,n,a){if(Ir(n.enabled,e)!==!1&&nl(n.staleTime,e)!=="static"){const r=typeof a=="function"?a(e):a;return r==="always"||r!==!1&&qp(e,n)}return!1}function W1(e,n,a,r){return(e!==n||Ir(r.enabled,e)===!1)&&(!a.suspense||e.state.status!=="error")&&qp(e,a)}function qp(e,n){return Ir(n.enabled,e)!==!1&&e.isStaleByTime(nl(n.staleTime,e))}function ZC(e,n){return!m0(e.getCurrentResult(),n)}function X1(e){return{onFetch:(n,a)=>{var m,f,p,N,y;const r=n.options,s=(p=(f=(m=n.fetchOptions)==null?void 0:m.meta)==null?void 0:f.fetchMore)==null?void 0:p.direction,l=((N=n.state.data)==null?void 0:N.pages)||[],o=((y=n.state.data)==null?void 0:y.pageParams)||[];let d={pages:[],pageParams:[]},u=0;const x=async()=>{let g=!1;const b=S=>{zC(S,()=>n.signal,()=>g=!0)},j=P2(n.options,n.fetchOptions),T=async(S,w,_)=>{if(g)return Promise.reject();if(w==null&&S.pages.length)return Promise.resolve(S);const C=(()=>{const O={client:n.client,queryKey:n.queryKey,pageParam:w,direction:_?"backward":"forward",meta:n.options.meta};return b(O),O})(),P=await j(C),{maxPages:F}=n.options,R=_?KC:UC;return{pages:R(S.pages,P,F),pageParams:R(S.pageParams,w,F)}};if(s&&l.length){const S=s==="backward",w=S?eS:Q1,_={pages:l,pageParams:o},E=w(r,_);d=await T(_,E,S)}else{const S=e??l.length;do{const w=u===0?o[0]??r.initialPageParam:Q1(r,d);if(u>0&&w==null)break;d=await T(d,w),u++}while(u<S)}return d};n.options.persister?n.fetchFn=()=>{var g,b;return(b=(g=n.options).persister)==null?void 0:b.call(g,x,{client:n.client,queryKey:n.queryKey,meta:n.options.meta,signal:n.signal},a)}:n.fetchFn=x}}}function Q1(e,{pages:n,pageParams:a}){const r=n.length-1;return n.length>0?e.getNextPageParam(n[r],n,a[r],a):void 0}function eS(e,{pages:n,pageParams:a}){var r;return n.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,n[0],n,a[0],a):void 0}var mu,vs,La,Yl,bs,Bi,T2,tS=(T2=class extends M2{constructor(n){super();at(this,bs);at(this,mu);at(this,vs);at(this,La);at(this,Yl);$e(this,mu,n.client),this.mutationId=n.mutationId,$e(this,La,n.mutationCache),$e(this,vs,[]),this.state=n.state||H2(),this.setOptions(n.options),this.scheduleGc()}setOptions(n){this.options=n,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(n){ce(this,vs).includes(n)||(ce(this,vs).push(n),this.clearGcTimeout(),ce(this,La).notify({type:"observerAdded",mutation:this,observer:n}))}removeObserver(n){$e(this,vs,ce(this,vs).filter(a=>a!==n)),this.scheduleGc(),ce(this,La).notify({type:"observerRemoved",mutation:this,observer:n})}optionalRemove(){ce(this,vs).length||(this.state.status==="pending"?this.scheduleGc():ce(this,La).remove(this))}continue(){var n;return((n=ce(this,Yl))==null?void 0:n.continue())??this.execute(this.state.variables)}async execute(n){var o,d,u,x,m,f,p,N,y,g,b,j,T,S,w,_,E,C,P,F;const a=()=>{vt(this,bs,Bi).call(this,{type:"continue"})},r={client:ce(this,mu),meta:this.options.meta,mutationKey:this.options.mutationKey};$e(this,Yl,O2({fn:()=>this.options.mutationFn?this.options.mutationFn(n,r):Promise.reject(new Error("No mutationFn found")),onFail:(R,O)=>{vt(this,bs,Bi).call(this,{type:"failed",failureCount:R,error:O})},onPause:()=>{vt(this,bs,Bi).call(this,{type:"pause"})},onContinue:a,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ce(this,La).canRun(this)}));const s=this.state.status==="pending",l=!ce(this,Yl).canStart();try{if(s)a();else{vt(this,bs,Bi).call(this,{type:"pending",variables:n,isPaused:l}),await((d=(o=ce(this,La).config).onMutate)==null?void 0:d.call(o,n,this,r));const O=await((x=(u=this.options).onMutate)==null?void 0:x.call(u,n,r));O!==this.state.context&&vt(this,bs,Bi).call(this,{type:"pending",context:O,variables:n,isPaused:l})}const R=await ce(this,Yl).start();return await((f=(m=ce(this,La).config).onSuccess)==null?void 0:f.call(m,R,n,this.state.context,this,r)),await((N=(p=this.options).onSuccess)==null?void 0:N.call(p,R,n,this.state.context,r)),await((g=(y=ce(this,La).config).onSettled)==null?void 0:g.call(y,R,null,this.state.variables,this.state.context,this,r)),await((j=(b=this.options).onSettled)==null?void 0:j.call(b,R,null,n,this.state.context,r)),vt(this,bs,Bi).call(this,{type:"success",data:R}),R}catch(R){try{await((S=(T=ce(this,La).config).onError)==null?void 0:S.call(T,R,n,this.state.context,this,r))}catch(O){Promise.reject(O)}try{await((_=(w=this.options).onError)==null?void 0:_.call(w,R,n,this.state.context,r))}catch(O){Promise.reject(O)}try{await((C=(E=ce(this,La).config).onSettled)==null?void 0:C.call(E,void 0,R,this.state.variables,this.state.context,this,r))}catch(O){Promise.reject(O)}try{await((F=(P=this.options).onSettled)==null?void 0:F.call(P,void 0,R,n,this.state.context,r))}catch(O){Promise.reject(O)}throw vt(this,bs,Bi).call(this,{type:"error",error:R}),R}finally{ce(this,La).runNext(this)}}},mu=new WeakMap,vs=new WeakMap,La=new WeakMap,Yl=new WeakMap,bs=new WeakSet,Bi=function(n){const a=r=>{switch(n.type){case"failed":return{...r,failureCount:n.failureCount,failureReason:n.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:n.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:n.isPaused,status:"pending",variables:n.variables,submittedAt:Date.now()};case"success":return{...r,data:n.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:n.error,failureCount:r.failureCount+1,failureReason:n.error,isPaused:!1,status:"error"}}};this.state=a(this.state),Kn.batch(()=>{ce(this,vs).forEach(r=>{r.onMutationUpdate(n)}),ce(this,La).notify({mutation:this,type:"updated",action:n})})},T2);function H2(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Qs,Yr,fu,C2,nS=(C2=class extends Dc{constructor(n={}){super();at(this,Qs);at(this,Yr);at(this,fu);this.config=n,$e(this,Qs,new Set),$e(this,Yr,new Map),$e(this,fu,0)}build(n,a,r){const s=new tS({client:n,mutationCache:this,mutationId:++Vh(this,fu)._,options:n.defaultMutationOptions(a),state:r});return this.add(s),s}add(n){ce(this,Qs).add(n);const a=Kh(n);if(typeof a=="string"){const r=ce(this,Yr).get(a);r?r.push(n):ce(this,Yr).set(a,[n])}this.notify({type:"added",mutation:n})}remove(n){if(ce(this,Qs).delete(n)){const a=Kh(n);if(typeof a=="string"){const r=ce(this,Yr).get(a);if(r)if(r.length>1){const s=r.indexOf(n);s!==-1&&r.splice(s,1)}else r[0]===n&&ce(this,Yr).delete(a)}}this.notify({type:"removed",mutation:n})}canRun(n){const a=Kh(n);if(typeof a=="string"){const r=ce(this,Yr).get(a),s=r==null?void 0:r.find(l=>l.state.status==="pending");return!s||s===n}else return!0}runNext(n){var r;const a=Kh(n);if(typeof a=="string"){const s=(r=ce(this,Yr).get(a))==null?void 0:r.find(l=>l!==n&&l.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Kn.batch(()=>{ce(this,Qs).forEach(n=>{this.notify({type:"removed",mutation:n})}),ce(this,Qs).clear(),ce(this,Yr).clear()})}getAll(){return Array.from(ce(this,Qs))}find(n){const a={exact:!0,...n};return this.getAll().find(r=>U1(a,r))}findAll(n={}){return this.getAll().filter(a=>U1(n,a))}notify(n){Kn.batch(()=>{this.listeners.forEach(a=>{a(n)})})}resumePausedMutations(){const n=this.getAll().filter(a=>a.state.isPaused);return Kn.batch(()=>Promise.all(n.map(a=>a.continue().catch(Pa))))}},Qs=new WeakMap,Yr=new WeakMap,fu=new WeakMap,C2);function Kh(e){var n;return(n=e.options.scope)==null?void 0:n.id}var Ys,Gi,Wa,Js,ii,l0,sp,S2,aS=(S2=class extends Dc{constructor(a,r){super();at(this,ii);at(this,Ys);at(this,Gi);at(this,Wa);at(this,Js);$e(this,Ys,a),this.setOptions(r),this.bindMethods(),vt(this,ii,l0).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(a){var s;const r=this.options;this.options=ce(this,Ys).defaultMutationOptions(a),m0(this.options,r)||ce(this,Ys).getMutationCache().notify({type:"observerOptionsUpdated",mutation:ce(this,Wa),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&ro(r.mutationKey)!==ro(this.options.mutationKey)?this.reset():((s=ce(this,Wa))==null?void 0:s.state.status)==="pending"&&ce(this,Wa).setOptions(this.options)}onUnsubscribe(){var a;this.hasListeners()||(a=ce(this,Wa))==null||a.removeObserver(this)}onMutationUpdate(a){vt(this,ii,l0).call(this),vt(this,ii,sp).call(this,a)}getCurrentResult(){return ce(this,Gi)}reset(){var a;(a=ce(this,Wa))==null||a.removeObserver(this),$e(this,Wa,void 0),vt(this,ii,l0).call(this),vt(this,ii,sp).call(this)}mutate(a,r){var s;return $e(this,Js,r),(s=ce(this,Wa))==null||s.removeObserver(this),$e(this,Wa,ce(this,Ys).getMutationCache().build(ce(this,Ys),this.options)),ce(this,Wa).addObserver(this),ce(this,Wa).execute(a)}},Ys=new WeakMap,Gi=new WeakMap,Wa=new WeakMap,Js=new WeakMap,ii=new WeakSet,l0=function(){var r;const a=((r=ce(this,Wa))==null?void 0:r.state)??H2();$e(this,Gi,{...a,isPending:a.status==="pending",isSuccess:a.status==="success",isError:a.status==="error",isIdle:a.status==="idle",mutate:this.mutate,reset:this.reset})},sp=function(a){Kn.batch(()=>{var r,s,l,o,d,u,x,m;if(ce(this,Js)&&this.hasListeners()){const f=ce(this,Gi).variables,p=ce(this,Gi).context,N={client:ce(this,Ys),meta:this.options.meta,mutationKey:this.options.mutationKey};if((a==null?void 0:a.type)==="success"){try{(s=(r=ce(this,Js)).onSuccess)==null||s.call(r,a.data,f,p,N)}catch(y){Promise.reject(y)}try{(o=(l=ce(this,Js)).onSettled)==null||o.call(l,a.data,null,f,p,N)}catch(y){Promise.reject(y)}}else if((a==null?void 0:a.type)==="error"){try{(u=(d=ce(this,Js)).onError)==null||u.call(d,a.error,f,p,N)}catch(y){Promise.reject(y)}try{(m=(x=ce(this,Js)).onSettled)==null||m.call(x,void 0,a.error,f,p,N)}catch(y){Promise.reject(y)}}}this.listeners.forEach(f=>{f(ce(this,Gi))})})},S2),Ns,_2,rS=(_2=class extends Dc{constructor(n={}){super();at(this,Ns);this.config=n,$e(this,Ns,new Map)}build(n,a,r){const s=a.queryKey,l=a.queryHash??Kp(s,a);let o=this.get(l);return o||(o=new QC({client:n,queryKey:s,queryHash:l,options:n.defaultQueryOptions(a),state:r,defaultOptions:n.getQueryDefaults(s)}),this.add(o)),o}add(n){ce(this,Ns).has(n.queryHash)||(ce(this,Ns).set(n.queryHash,n),this.notify({type:"added",query:n}))}remove(n){const a=ce(this,Ns).get(n.queryHash);a&&(n.destroy(),a===n&&ce(this,Ns).delete(n.queryHash),this.notify({type:"removed",query:n}))}clear(){Kn.batch(()=>{this.getAll().forEach(n=>{this.remove(n)})})}get(n){return ce(this,Ns).get(n)}getAll(){return[...ce(this,Ns).values()]}find(n){const a={exact:!0,...n};return this.getAll().find(r=>V1(a,r))}findAll(n={}){const a=this.getAll();return Object.keys(n).length>0?a.filter(r=>V1(n,r)):a}notify(n){Kn.batch(()=>{this.listeners.forEach(a=>{a(n)})})}onFocus(){Kn.batch(()=>{this.getAll().forEach(n=>{n.onFocus()})})}onOnline(){Kn.batch(()=>{this.getAll().forEach(n=>{n.onOnline()})})}},Ns=new WeakMap,_2),jn,qi,Wi,yc,vc,Xi,bc,Nc,E2,sS=(E2=class{constructor(e={}){at(this,jn);at(this,qi);at(this,Wi);at(this,yc);at(this,vc);at(this,Xi);at(this,bc);at(this,Nc);$e(this,jn,e.queryCache||new rS),$e(this,qi,e.mutationCache||new nS),$e(this,Wi,e.defaultOptions||{}),$e(this,yc,new Map),$e(this,vc,new Map),$e(this,Xi,0)}mount(){Vh(this,Xi)._++,ce(this,Xi)===1&&($e(this,bc,Gp.subscribe(async e=>{e&&(await this.resumePausedMutations(),ce(this,jn).onFocus())})),$e(this,Nc,f0.subscribe(async e=>{e&&(await this.resumePausedMutations(),ce(this,jn).onOnline())})))}unmount(){var e,n;Vh(this,Xi)._--,ce(this,Xi)===0&&((e=ce(this,bc))==null||e.call(this),$e(this,bc,void 0),(n=ce(this,Nc))==null||n.call(this),$e(this,Nc,void 0))}isFetching(e){return ce(this,jn).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ce(this,qi).findAll({...e,status:"pending"}).length}getQueryData(e){var a;const n=this.defaultQueryOptions({queryKey:e});return(a=ce(this,jn).get(n.queryHash))==null?void 0:a.state.data}ensureQueryData(e){const n=this.defaultQueryOptions(e),a=ce(this,jn).build(this,n),r=a.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&a.isStaleByTime(nl(n.staleTime,a))&&this.prefetchQuery(n),Promise.resolve(r))}getQueriesData(e){return ce(this,jn).findAll(e).map(({queryKey:n,state:a})=>{const r=a.data;return[n,r]})}setQueryData(e,n,a){const r=this.defaultQueryOptions({queryKey:e}),s=ce(this,jn).get(r.queryHash),l=s==null?void 0:s.state.data,o=BC(n,l);if(o!==void 0)return ce(this,jn).build(this,r).setData(o,{...a,manual:!0})}setQueriesData(e,n,a){return Kn.batch(()=>ce(this,jn).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,n,a)]))}getQueryState(e){var a;const n=this.defaultQueryOptions({queryKey:e});return(a=ce(this,jn).get(n.queryHash))==null?void 0:a.state}removeQueries(e){const n=ce(this,jn);Kn.batch(()=>{n.findAll(e).forEach(a=>{n.remove(a)})})}resetQueries(e,n){const a=ce(this,jn);return Kn.batch(()=>(a.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},n)))}cancelQueries(e,n={}){const a={revert:!0,...n},r=Kn.batch(()=>ce(this,jn).findAll(e).map(s=>s.cancel(a)));return Promise.all(r).then(Pa).catch(Pa)}invalidateQueries(e,n={}){return Kn.batch(()=>(ce(this,jn).findAll(e).forEach(a=>{a.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},n)))}refetchQueries(e,n={}){const a={...n,cancelRefetch:n.cancelRefetch??!0},r=Kn.batch(()=>ce(this,jn).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let l=s.fetch(void 0,a);return a.throwOnError||(l=l.catch(Pa)),s.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(r).then(Pa)}fetchQuery(e){const n=this.defaultQueryOptions(e);n.retry===void 0&&(n.retry=!1);const a=ce(this,jn).build(this,n);return a.isStaleByTime(nl(n.staleTime,a))?a.fetch(n):Promise.resolve(a.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Pa).catch(Pa)}fetchInfiniteQuery(e){return e.behavior=X1(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Pa).catch(Pa)}ensureInfiniteQueryData(e){return e.behavior=X1(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return f0.isOnline()?ce(this,qi).resumePausedMutations():Promise.resolve()}getQueryCache(){return ce(this,jn)}getMutationCache(){return ce(this,qi)}getDefaultOptions(){return ce(this,Wi)}setDefaultOptions(e){$e(this,Wi,e)}setQueryDefaults(e,n){ce(this,yc).set(ro(e),{queryKey:e,defaultOptions:n})}getQueryDefaults(e){const n=[...ce(this,yc).values()],a={};return n.forEach(r=>{Gd(e,r.queryKey)&&Object.assign(a,r.defaultOptions)}),a}setMutationDefaults(e,n){ce(this,vc).set(ro(e),{mutationKey:e,defaultOptions:n})}getMutationDefaults(e){const n=[...ce(this,vc).values()],a={};return n.forEach(r=>{Gd(e,r.mutationKey)&&Object.assign(a,r.defaultOptions)}),a}defaultQueryOptions(e){if(e._defaulted)return e;const n={...ce(this,Wi).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return n.queryHash||(n.queryHash=Kp(n.queryKey,n)),n.refetchOnReconnect===void 0&&(n.refetchOnReconnect=n.networkMode!=="always"),n.throwOnError===void 0&&(n.throwOnError=!!n.suspense),!n.networkMode&&n.persister&&(n.networkMode="offlineFirst"),n.queryFn===zp&&(n.enabled=!1),n}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ce(this,Wi).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ce(this,jn).clear(),ce(this,qi).clear()}},jn=new WeakMap,qi=new WeakMap,Wi=new WeakMap,yc=new WeakMap,vc=new WeakMap,Xi=new WeakMap,bc=new WeakMap,Nc=new WeakMap,E2),V2=D.createContext(void 0),Mt=e=>{const n=D.useContext(V2);if(!n)throw new Error("No QueryClient set, use QueryClientProvider to set one");return n},iS=({client:e,children:n})=>(D.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),t.jsx(V2.Provider,{value:e,children:n})),U2=D.createContext(!1),lS=()=>D.useContext(U2);U2.Provider;function oS(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var cS=D.createContext(oS()),dS=()=>D.useContext(cS),uS=(e,n,a)=>{const r=a!=null&&a.state.error&&typeof e.throwOnError=="function"?$p(e.throwOnError,[a.state.error,a]):e.throwOnError;(e.suspense||e.experimental_prefetchInRender||r)&&(n.isReset()||(e.retryOnMount=!1))},hS=e=>{D.useEffect(()=>{e.clearReset()},[e])},xS=({result:e,errorResetBoundary:n,throwOnError:a,query:r,suspense:s})=>e.isError&&!n.isReset()&&!e.isFetching&&r&&(s&&e.data===void 0||$p(a,[e.error,r])),mS=e=>{if(e.suspense){const a=s=>s==="static"?s:Math.max(s??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...s)=>a(r(...s)):a(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},fS=(e,n)=>e.isLoading&&e.isFetching&&!n,pS=(e,n)=>(e==null?void 0:e.suspense)&&n.isPending,Y1=(e,n,a)=>n.fetchOptimistic(e).catch(()=>{a.clearReset()});function gS(e,n,a){var p,N,y,g;const r=lS(),s=dS(),l=Mt(),o=l.defaultQueryOptions(e);(N=(p=l.getDefaultOptions().queries)==null?void 0:p._experimental_beforeQuery)==null||N.call(p,o);const d=l.getQueryCache().get(o.queryHash);o._optimisticResults=r?"isRestoring":"optimistic",mS(o),uS(o,s,d),hS(s);const u=!l.getQueryCache().get(o.queryHash),[x]=D.useState(()=>new n(l,o)),m=x.getOptimisticResult(o),f=!r&&e.subscribed!==!1;if(D.useSyncExternalStore(D.useCallback(b=>{const j=f?x.subscribe(Kn.batchCalls(b)):Pa;return x.updateResult(),j},[x,f]),()=>x.getCurrentResult(),()=>x.getCurrentResult()),D.useEffect(()=>{x.setOptions(o)},[o,x]),pS(o,m))throw Y1(o,x,s);if(xS({result:m,errorResetBoundary:s,throwOnError:o.throwOnError,query:d,suspense:o.suspense}))throw m.error;if((g=(y=l.getDefaultOptions().queries)==null?void 0:y._experimental_afterQuery)==null||g.call(y,o,m),o.experimental_prefetchInRender&&!ao&&fS(m,r)){const b=u?Y1(o,x,s):d==null?void 0:d.promise;b==null||b.catch(Pa).finally(()=>{x.updateResult()})}return o.notifyOnChangeProps?m:x.trackResult(m)}function Le(e,n){return gS(e,YC)}function De(e,n){const a=Mt(),[r]=D.useState(()=>new aS(a,e));D.useEffect(()=>{r.setOptions(e)},[r,e]);const s=D.useSyncExternalStore(D.useCallback(o=>r.subscribe(Kn.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),l=D.useCallback((o,d)=>{r.mutate(o,d).catch(Pa)},[r]);if(s.error&&$p(r.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:l,mutateAsync:s.mutate}}var yS=A2();/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qd(){return qd=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},qd.apply(this,arguments)}var Qi;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Qi||(Qi={}));const J1="popstate";function vS(e){e===void 0&&(e={});function n(r,s){let{pathname:l,search:o,hash:d}=r.location;return ip("",{pathname:l,search:o,hash:d},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function a(r,s){return typeof s=="string"?s:p0(s)}return NS(n,a,null,e)}function An(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function Wp(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function bS(){return Math.random().toString(36).substr(2,8)}function Z1(e,n){return{usr:e.state,key:e.key,idx:n}}function ip(e,n,a,r){return a===void 0&&(a=null),qd({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof n=="string"?Ac(n):n,{state:a,key:n&&n.key||r||bS()})}function p0(e){let{pathname:n="/",search:a="",hash:r=""}=e;return a&&a!=="?"&&(n+=a.charAt(0)==="?"?a:"?"+a),r&&r!=="#"&&(n+=r.charAt(0)==="#"?r:"#"+r),n}function Ac(e){let n={};if(e){let a=e.indexOf("#");a>=0&&(n.hash=e.substr(a),e=e.substr(0,a));let r=e.indexOf("?");r>=0&&(n.search=e.substr(r),e=e.substr(0,r)),e&&(n.pathname=e)}return n}function NS(e,n,a,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:l=!1}=r,o=s.history,d=Qi.Pop,u=null,x=m();x==null&&(x=0,o.replaceState(qd({},o.state,{idx:x}),""));function m(){return(o.state||{idx:null}).idx}function f(){d=Qi.Pop;let b=m(),j=b==null?null:b-x;x=b,u&&u({action:d,location:g.location,delta:j})}function p(b,j){d=Qi.Push;let T=ip(g.location,b,j);x=m()+1;let S=Z1(T,x),w=g.createHref(T);try{o.pushState(S,"",w)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;s.location.assign(w)}l&&u&&u({action:d,location:g.location,delta:1})}function N(b,j){d=Qi.Replace;let T=ip(g.location,b,j);x=m();let S=Z1(T,x),w=g.createHref(T);o.replaceState(S,"",w),l&&u&&u({action:d,location:g.location,delta:0})}function y(b){let j=s.location.origin!=="null"?s.location.origin:s.location.href,T=typeof b=="string"?b:p0(b);return T=T.replace(/ $/,"%20"),An(j,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,j)}let g={get action(){return d},get location(){return e(s,o)},listen(b){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(J1,f),u=b,()=>{s.removeEventListener(J1,f),u=null}},createHref(b){return n(s,b)},createURL:y,encodeLocation(b){let j=y(b);return{pathname:j.pathname,search:j.search,hash:j.hash}},push:p,replace:N,go(b){return o.go(b)}};return g}var eb;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(eb||(eb={}));function jS(e,n,a){return a===void 0&&(a="/"),wS(e,n,a)}function wS(e,n,a,r){let s=typeof n=="string"?Ac(n):n,l=Xp(s.pathname||"/",a);if(l==null)return null;let o=K2(e);kS(o);let d=null;for(let u=0;d==null&&u<o.length;++u){let x=OS(l);d=LS(o[u],x)}return d}function K2(e,n,a,r){n===void 0&&(n=[]),a===void 0&&(a=[]),r===void 0&&(r="");let s=(l,o,d)=>{let u={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};u.relativePath.startsWith("/")&&(An(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let x=al([r,u.relativePath]),m=a.concat(u);l.children&&l.children.length>0&&(An(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+x+'".')),K2(l.children,n,m,x)),!(l.path==null&&!l.index)&&n.push({path:x,score:AS(x,l.index),routesMeta:m})};return e.forEach((l,o)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))s(l,o);else for(let u of z2(l.path))s(l,o,u)}),n}function z2(e){let n=e.split("/");if(n.length===0)return[];let[a,...r]=n,s=a.endsWith("?"),l=a.replace(/\?$/,"");if(r.length===0)return s?[l,""]:[l];let o=z2(r.join("/")),d=[];return d.push(...o.map(u=>u===""?l:[l,u].join("/"))),s&&d.push(...o),d.map(u=>e.startsWith("/")&&u===""?"/":u)}function kS(e){e.sort((n,a)=>n.score!==a.score?a.score-n.score:FS(n.routesMeta.map(r=>r.childrenIndex),a.routesMeta.map(r=>r.childrenIndex)))}const TS=/^:[\w-]+$/,CS=3,SS=2,_S=1,ES=10,DS=-2,tb=e=>e==="*";function AS(e,n){let a=e.split("/"),r=a.length;return a.some(tb)&&(r+=DS),n&&(r+=SS),a.filter(s=>!tb(s)).reduce((s,l)=>s+(TS.test(l)?CS:l===""?_S:ES),r)}function FS(e,n){return e.length===n.length&&e.slice(0,-1).every((r,s)=>r===n[s])?e[e.length-1]-n[n.length-1]:0}function LS(e,n,a){let{routesMeta:r}=e,s={},l="/",o=[];for(let d=0;d<r.length;++d){let u=r[d],x=d===r.length-1,m=l==="/"?n:n.slice(l.length)||"/",f=PS({path:u.relativePath,caseSensitive:u.caseSensitive,end:x},m),p=u.route;if(!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:al([l,f.pathname]),pathnameBase:VS(al([l,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(l=al([l,f.pathnameBase]))}return o}function PS(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[a,r]=IS(e.path,e.caseSensitive,e.end),s=n.match(a);if(!s)return null;let l=s[0],o=l.replace(/(.)\/+$/,"$1"),d=s.slice(1);return{params:r.reduce((x,m,f)=>{let{paramName:p,isOptional:N}=m;if(p==="*"){let g=d[f]||"";o=l.slice(0,l.length-g.length).replace(/(.)\/+$/,"$1")}const y=d[f];return N&&!y?x[p]=void 0:x[p]=(y||"").replace(/%2F/g,"/"),x},{}),pathname:l,pathnameBase:o,pattern:e}}function IS(e,n,a){n===void 0&&(n=!1),a===void 0&&(a=!0),Wp(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,d,u)=>(r.push({paramName:d,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,n?void 0:"i"),r]}function OS(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return Wp(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+n+").")),e}}function Xp(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let a=n.endsWith("/")?n.length-1:n.length,r=e.charAt(a);return r&&r!=="/"?null:e.slice(a)||"/"}const MS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,RS=e=>MS.test(e);function BS(e,n){n===void 0&&(n="/");let{pathname:a,search:r="",hash:s=""}=typeof e=="string"?Ac(e):e,l;if(a)if(RS(a))l=a;else{if(a.includes("//")){let o=a;a=a.replace(/\/\/+/g,"/"),Wp(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+a))}a.startsWith("/")?l=nb(a.substring(1),"/"):l=nb(a,n)}else l=n;return{pathname:l,search:US(r),hash:KS(s)}}function nb(e,n){let a=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?a.length>1&&a.pop():s!=="."&&a.push(s)}),a.length>1?a.join("/"):"/"}function af(e,n,a,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+n+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function HS(e){return e.filter((n,a)=>a===0||n.route.path&&n.route.path.length>0)}function Qp(e,n){let a=HS(e);return n?a.map((r,s)=>s===a.length-1?r.pathname:r.pathnameBase):a.map(r=>r.pathnameBase)}function Yp(e,n,a,r){r===void 0&&(r=!1);let s;typeof e=="string"?s=Ac(e):(s=qd({},e),An(!s.pathname||!s.pathname.includes("?"),af("?","pathname","search",s)),An(!s.pathname||!s.pathname.includes("#"),af("#","pathname","hash",s)),An(!s.search||!s.search.includes("#"),af("#","search","hash",s)));let l=e===""||s.pathname==="",o=l?"/":s.pathname,d;if(o==null)d=a;else{let f=n.length-1;if(!r&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;s.pathname=p.join("/")}d=f>=0?n[f]:"/"}let u=BS(s,d),x=o&&o!=="/"&&o.endsWith("/"),m=(l||o===".")&&a.endsWith("/");return!u.pathname.endsWith("/")&&(x||m)&&(u.pathname+="/"),u}const al=e=>e.join("/").replace(/\/\/+/g,"/"),VS=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),US=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,KS=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function zS(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const $2=["post","put","patch","delete"];new Set($2);const $S=["get",...$2];new Set($S);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wd(){return Wd=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},Wd.apply(this,arguments)}const Jp=D.createContext(null),GS=D.createContext(null),dl=D.createContext(null),G0=D.createContext(null),Ds=D.createContext({outlet:null,matches:[],isDataRoute:!1}),G2=D.createContext(null);function qS(e,n){let{relative:a}=n===void 0?{}:n;Fc()||An(!1);let{basename:r,navigator:s}=D.useContext(dl),{hash:l,pathname:o,search:d}=W2(e,{relative:a}),u=o;return r!=="/"&&(u=o==="/"?r:al([r,o])),s.createHref({pathname:u,search:d,hash:l})}function Fc(){return D.useContext(G0)!=null}function As(){return Fc()||An(!1),D.useContext(G0).location}function q2(e){D.useContext(dl).static||D.useLayoutEffect(e)}function br(){let{isDataRoute:e}=D.useContext(Ds);return e?o3():WS()}function WS(){Fc()||An(!1);let e=D.useContext(Jp),{basename:n,future:a,navigator:r}=D.useContext(dl),{matches:s}=D.useContext(Ds),{pathname:l}=As(),o=JSON.stringify(Qp(s,a.v7_relativeSplatPath)),d=D.useRef(!1);return q2(()=>{d.current=!0}),D.useCallback(function(x,m){if(m===void 0&&(m={}),!d.current)return;if(typeof x=="number"){r.go(x);return}let f=Yp(x,JSON.parse(o),l,m.relative==="path");e==null&&n!=="/"&&(f.pathname=f.pathname==="/"?n:al([n,f.pathname])),(m.replace?r.replace:r.push)(f,m.state,m)},[n,r,o,l,e])}const XS=D.createContext(null);function QS(e){let n=D.useContext(Ds).outlet;return n&&D.createElement(XS.Provider,{value:e},n)}function q0(){let{matches:e}=D.useContext(Ds),n=e[e.length-1];return n?n.params:{}}function W2(e,n){let{relative:a}=n===void 0?{}:n,{future:r}=D.useContext(dl),{matches:s}=D.useContext(Ds),{pathname:l}=As(),o=JSON.stringify(Qp(s,r.v7_relativeSplatPath));return D.useMemo(()=>Yp(e,JSON.parse(o),l,a==="path"),[e,o,l,a])}function YS(e,n){return JS(e,n)}function JS(e,n,a,r){Fc()||An(!1);let{navigator:s}=D.useContext(dl),{matches:l}=D.useContext(Ds),o=l[l.length-1],d=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let x=As(),m;if(n){var f;let b=typeof n=="string"?Ac(n):n;u==="/"||(f=b.pathname)!=null&&f.startsWith(u)||An(!1),m=b}else m=x;let p=m.pathname||"/",N=p;if(u!=="/"){let b=u.replace(/^\//,"").split("/");N="/"+p.replace(/^\//,"").split("/").slice(b.length).join("/")}let y=jS(e,{pathname:N}),g=a3(y&&y.map(b=>Object.assign({},b,{params:Object.assign({},d,b.params),pathname:al([u,s.encodeLocation?s.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?u:al([u,s.encodeLocation?s.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),l,a,r);return n&&g?D.createElement(G0.Provider,{value:{location:Wd({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:Qi.Pop}},g):g}function ZS(){let e=l3(),n=zS(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return D.createElement(D.Fragment,null,D.createElement("h2",null,"Unexpected Application Error!"),D.createElement("h3",{style:{fontStyle:"italic"}},n),a?D.createElement("pre",{style:s},a):null,null)}const e3=D.createElement(ZS,null);class t3 extends D.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,a){return a.location!==n.location||a.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:a.error,location:a.location,revalidation:n.revalidation||a.revalidation}}componentDidCatch(n,a){console.error("React Router caught the following error during render",n,a)}render(){return this.state.error!==void 0?D.createElement(Ds.Provider,{value:this.props.routeContext},D.createElement(G2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function n3(e){let{routeContext:n,match:a,children:r}=e,s=D.useContext(Jp);return s&&s.static&&s.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=a.route.id),D.createElement(Ds.Provider,{value:n},r)}function a3(e,n,a,r){var s;if(n===void 0&&(n=[]),a===void 0&&(a=null),r===void 0&&(r=null),e==null){var l;if(!a)return null;if(a.errors)e=a.matches;else if((l=r)!=null&&l.v7_partialHydration&&n.length===0&&!a.initialized&&a.matches.length>0)e=a.matches;else return null}let o=e,d=(s=a)==null?void 0:s.errors;if(d!=null){let m=o.findIndex(f=>f.route.id&&(d==null?void 0:d[f.route.id])!==void 0);m>=0||An(!1),o=o.slice(0,Math.min(o.length,m+1))}let u=!1,x=-1;if(a&&r&&r.v7_partialHydration)for(let m=0;m<o.length;m++){let f=o[m];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(x=m),f.route.id){let{loaderData:p,errors:N}=a,y=f.route.loader&&p[f.route.id]===void 0&&(!N||N[f.route.id]===void 0);if(f.route.lazy||y){u=!0,x>=0?o=o.slice(0,x+1):o=[o[0]];break}}}return o.reduceRight((m,f,p)=>{let N,y=!1,g=null,b=null;a&&(N=d&&f.route.id?d[f.route.id]:void 0,g=f.route.errorElement||e3,u&&(x<0&&p===0?(c3("route-fallback"),y=!0,b=null):x===p&&(y=!0,b=f.route.hydrateFallbackElement||null)));let j=n.concat(o.slice(0,p+1)),T=()=>{let S;return N?S=g:y?S=b:f.route.Component?S=D.createElement(f.route.Component,null):f.route.element?S=f.route.element:S=m,D.createElement(n3,{match:f,routeContext:{outlet:m,matches:j,isDataRoute:a!=null},children:S})};return a&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?D.createElement(t3,{location:a.location,revalidation:a.revalidation,component:g,error:N,children:T(),routeContext:{outlet:null,matches:j,isDataRoute:!0}}):T()},null)}var X2=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(X2||{}),Q2=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(Q2||{});function r3(e){let n=D.useContext(Jp);return n||An(!1),n}function s3(e){let n=D.useContext(GS);return n||An(!1),n}function i3(e){let n=D.useContext(Ds);return n||An(!1),n}function Y2(e){let n=i3(),a=n.matches[n.matches.length-1];return a.route.id||An(!1),a.route.id}function l3(){var e;let n=D.useContext(G2),a=s3(),r=Y2();return n!==void 0?n:(e=a.errors)==null?void 0:e[r]}function o3(){let{router:e}=r3(X2.UseNavigateStable),n=Y2(Q2.UseNavigateStable),a=D.useRef(!1);return q2(()=>{a.current=!0}),D.useCallback(function(s,l){l===void 0&&(l={}),a.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Wd({fromRouteId:n},l)))},[e,n])}const ab={};function c3(e,n,a){ab[e]||(ab[e]=!0)}function d3(e,n){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function u3(e){let{to:n,replace:a,state:r,relative:s}=e;Fc()||An(!1);let{future:l,static:o}=D.useContext(dl),{matches:d}=D.useContext(Ds),{pathname:u}=As(),x=br(),m=Yp(n,Qp(d,l.v7_relativeSplatPath),u,s==="path"),f=JSON.stringify(m);return D.useEffect(()=>x(JSON.parse(f),{replace:a,state:r,relative:s}),[x,f,s,a,r]),null}function J2(e){return QS(e.context)}function nt(e){An(!1)}function h3(e){let{basename:n="/",children:a=null,location:r,navigationType:s=Qi.Pop,navigator:l,static:o=!1,future:d}=e;Fc()&&An(!1);let u=n.replace(/^\/*/,"/"),x=D.useMemo(()=>({basename:u,navigator:l,static:o,future:Wd({v7_relativeSplatPath:!1},d)}),[u,d,l,o]);typeof r=="string"&&(r=Ac(r));let{pathname:m="/",search:f="",hash:p="",state:N=null,key:y="default"}=r,g=D.useMemo(()=>{let b=Xp(m,u);return b==null?null:{location:{pathname:b,search:f,hash:p,state:N,key:y},navigationType:s}},[u,m,f,p,N,y,s]);return g==null?null:D.createElement(dl.Provider,{value:x},D.createElement(G0.Provider,{children:a,value:g}))}function x3(e){let{children:n,location:a}=e;return YS(lp(n),a)}new Promise(()=>{});function lp(e,n){n===void 0&&(n=[]);let a=[];return D.Children.forEach(e,(r,s)=>{if(!D.isValidElement(r))return;let l=[...n,s];if(r.type===D.Fragment){a.push.apply(a,lp(r.props.children,l));return}r.type!==nt&&An(!1),!r.props.index||!r.props.children||An(!1);let o={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=lp(r.props.children,l)),a.push(o)}),a}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function op(){return op=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},op.apply(this,arguments)}function m3(e,n){if(e==null)return{};var a={},r=Object.keys(e),s,l;for(l=0;l<r.length;l++)s=r[l],!(n.indexOf(s)>=0)&&(a[s]=e[s]);return a}function f3(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function p3(e,n){return e.button===0&&(!n||n==="_self")&&!f3(e)}function cp(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((n,a)=>{let r=e[a];return n.concat(Array.isArray(r)?r.map(s=>[a,s]):[[a,r]])},[]))}function g3(e,n){let a=cp(e);return n&&n.forEach((r,s)=>{a.has(s)||n.getAll(s).forEach(l=>{a.append(s,l)})}),a}const y3=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],v3="6";try{window.__reactRouterVersion=v3}catch{}const b3="startTransition",rb=DC[b3];function N3(e){let{basename:n,children:a,future:r,window:s}=e,l=D.useRef();l.current==null&&(l.current=vS({window:s,v5Compat:!0}));let o=l.current,[d,u]=D.useState({action:o.action,location:o.location}),{v7_startTransition:x}=r||{},m=D.useCallback(f=>{x&&rb?rb(()=>u(f)):u(f)},[u,x]);return D.useLayoutEffect(()=>o.listen(m),[o,m]),D.useEffect(()=>d3(r),[r]),D.createElement(h3,{basename:n,children:a,location:d.location,navigationType:d.action,navigator:o,future:r})}const j3=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",w3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ua=D.forwardRef(function(n,a){let{onClick:r,relative:s,reloadDocument:l,replace:o,state:d,target:u,to:x,preventScrollReset:m,viewTransition:f}=n,p=m3(n,y3),{basename:N}=D.useContext(dl),y,g=!1;if(typeof x=="string"&&w3.test(x)&&(y=x,j3))try{let S=new URL(window.location.href),w=x.startsWith("//")?new URL(S.protocol+x):new URL(x),_=Xp(w.pathname,N);w.origin===S.origin&&_!=null?x=_+w.search+w.hash:g=!0}catch{}let b=qS(x,{relative:s}),j=k3(x,{replace:o,state:d,target:u,preventScrollReset:m,relative:s,viewTransition:f});function T(S){r&&r(S),S.defaultPrevented||j(S)}return D.createElement("a",op({},p,{href:y||b,onClick:g||l?r:T,ref:a,target:u}))});var sb;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(sb||(sb={}));var ib;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(ib||(ib={}));function k3(e,n){let{target:a,replace:r,state:s,preventScrollReset:l,relative:o,viewTransition:d}=n===void 0?{}:n,u=br(),x=As(),m=W2(e,{relative:o});return D.useCallback(f=>{if(p3(f,a)){f.preventDefault();let p=r!==void 0?r:p0(x)===p0(m);u(e,{replace:p,state:s,preventScrollReset:l,relative:o,viewTransition:d})}},[x,u,m,r,s,a,e,l,o,d])}function T3(e){let n=D.useRef(cp(e)),a=D.useRef(!1),r=As(),s=D.useMemo(()=>g3(r.search,a.current?null:n.current),[r.search]),l=br(),o=D.useCallback((d,u)=>{const x=cp(typeof d=="function"?d(s):d);a.current=!0,l("?"+x,u)},[l,s]);return[s,o]}let C3={data:""},S3=e=>{if(typeof window=="object"){let n=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return n.nonce=window.__nonce__,n.parentNode||(e||document.head).appendChild(n),n.firstChild}return e||C3},_3=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,E3=/\/\*[^]*?\*\/|  +/g,lb=/\n+/g,Hi=(e,n)=>{let a="",r="",s="";for(let l in e){let o=e[l];l[0]=="@"?l[1]=="i"?a=l+" "+o+";":r+=l[1]=="f"?Hi(o,l):l+"{"+Hi(o,l[1]=="k"?"":n)+"}":typeof o=="object"?r+=Hi(o,n?n.replace(/([^,])+/g,d=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,d):d?d+" "+u:u)):l):o!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=Hi.p?Hi.p(l,o):l+":"+o+";")}return a+(n&&s?n+"{"+s+"}":s)+r},$s={},Z2=e=>{if(typeof e=="object"){let n="";for(let a in e)n+=a+Z2(e[a]);return n}return e},D3=(e,n,a,r,s)=>{let l=Z2(e),o=$s[l]||($s[l]=(u=>{let x=0,m=11;for(;x<u.length;)m=101*m+u.charCodeAt(x++)>>>0;return"go"+m})(l));if(!$s[o]){let u=l!==e?e:(x=>{let m,f,p=[{}];for(;m=_3.exec(x.replace(E3,""));)m[4]?p.shift():m[3]?(f=m[3].replace(lb," ").trim(),p.unshift(p[0][f]=p[0][f]||{})):p[0][m[1]]=m[2].replace(lb," ").trim();return p[0]})(e);$s[o]=Hi(s?{["@keyframes "+o]:u}:u,a?"":"."+o)}let d=a&&$s.g?$s.g:null;return a&&($s.g=$s[o]),((u,x,m,f)=>{f?x.data=x.data.replace(f,u):x.data.indexOf(u)===-1&&(x.data=m?u+x.data:x.data+u)})($s[o],n,r,d),o},A3=(e,n,a)=>e.reduce((r,s,l)=>{let o=n[l];if(o&&o.call){let d=o(a),u=d&&d.props&&d.props.className||/^go/.test(d)&&d;o=u?"."+u:d&&typeof d=="object"?d.props?"":Hi(d,""):d===!1?"":d}return r+s+(o??"")},"");function W0(e){let n=this||{},a=e.call?e(n.p):e;return D3(a.unshift?a.raw?A3(a,[].slice.call(arguments,1),n.p):a.reduce((r,s)=>Object.assign(r,s&&s.call?s(n.p):s),{}):a,S3(n.target),n.g,n.o,n.k)}let ej,dp,up;W0.bind({g:1});let li=W0.bind({k:1});function F3(e,n,a,r){Hi.p=n,ej=e,dp=a,up=r}function ul(e,n){let a=this||{};return function(){let r=arguments;function s(l,o){let d=Object.assign({},l),u=d.className||s.className;a.p=Object.assign({theme:dp&&dp()},d),a.o=/ *go\d+/.test(u),d.className=W0.apply(a,r)+(u?" "+u:"");let x=e;return e[0]&&(x=d.as||e,delete d.as),up&&x[0]&&up(d),ej(x,d)}return s}}var L3=e=>typeof e=="function",g0=(e,n)=>L3(e)?e(n):e,P3=(()=>{let e=0;return()=>(++e).toString()})(),tj=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let n=matchMedia("(prefers-reduced-motion: reduce)");e=!n||n.matches}return e}})(),I3=20,Zp="default",nj=(e,n)=>{let{toastLimit:a}=e.settings;switch(n.type){case 0:return{...e,toasts:[n.toast,...e.toasts].slice(0,a)};case 1:return{...e,toasts:e.toasts.map(o=>o.id===n.toast.id?{...o,...n.toast}:o)};case 2:let{toast:r}=n;return nj(e,{type:e.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=n;return{...e,toasts:e.toasts.map(o=>o.id===s||s===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return n.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==n.toastId)};case 5:return{...e,pausedAt:n.time};case 6:let l=n.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+l}))}}},o0=[],aj={toasts:[],pausedAt:void 0,settings:{toastLimit:I3}},ks={},rj=(e,n=Zp)=>{ks[n]=nj(ks[n]||aj,e),o0.forEach(([a,r])=>{a===n&&r(ks[n])})},sj=e=>Object.keys(ks).forEach(n=>rj(e,n)),O3=e=>Object.keys(ks).find(n=>ks[n].toasts.some(a=>a.id===e)),X0=(e=Zp)=>n=>{rj(n,e)},M3={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},R3=(e={},n=Zp)=>{let[a,r]=D.useState(ks[n]||aj),s=D.useRef(ks[n]);D.useEffect(()=>(s.current!==ks[n]&&r(ks[n]),o0.push([n,r]),()=>{let o=o0.findIndex(([d])=>d===n);o>-1&&o0.splice(o,1)}),[n]);let l=a.toasts.map(o=>{var d,u,x;return{...e,...e[o.type],...o,removeDelay:o.removeDelay||((d=e[o.type])==null?void 0:d.removeDelay)||(e==null?void 0:e.removeDelay),duration:o.duration||((u=e[o.type])==null?void 0:u.duration)||(e==null?void 0:e.duration)||M3[o.type],style:{...e.style,...(x=e[o.type])==null?void 0:x.style,...o.style}}});return{...a,toasts:l}},B3=(e,n="blank",a)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:n,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...a,id:(a==null?void 0:a.id)||P3()}),pu=e=>(n,a)=>{let r=B3(n,e,a);return X0(r.toasterId||O3(r.id))({type:2,toast:r}),r.id},xt=(e,n)=>pu("blank")(e,n);xt.error=pu("error");xt.success=pu("success");xt.loading=pu("loading");xt.custom=pu("custom");xt.dismiss=(e,n)=>{let a={type:3,toastId:e};n?X0(n)(a):sj(a)};xt.dismissAll=e=>xt.dismiss(void 0,e);xt.remove=(e,n)=>{let a={type:4,toastId:e};n?X0(n)(a):sj(a)};xt.removeAll=e=>xt.remove(void 0,e);xt.promise=(e,n,a)=>{let r=xt.loading(n.loading,{...a,...a==null?void 0:a.loading});return typeof e=="function"&&(e=e()),e.then(s=>{let l=n.success?g0(n.success,s):void 0;return l?xt.success(l,{id:r,...a,...a==null?void 0:a.success}):xt.dismiss(r),s}).catch(s=>{let l=n.error?g0(n.error,s):void 0;l?xt.error(l,{id:r,...a,...a==null?void 0:a.error}):xt.dismiss(r)}),e};var H3=1e3,V3=(e,n="default")=>{let{toasts:a,pausedAt:r}=R3(e,n),s=D.useRef(new Map).current,l=D.useCallback((f,p=H3)=>{if(s.has(f))return;let N=setTimeout(()=>{s.delete(f),o({type:4,toastId:f})},p);s.set(f,N)},[]);D.useEffect(()=>{if(r)return;let f=Date.now(),p=a.map(N=>{if(N.duration===1/0)return;let y=(N.duration||0)+N.pauseDuration-(f-N.createdAt);if(y<0){N.visible&&xt.dismiss(N.id);return}return setTimeout(()=>xt.dismiss(N.id,n),y)});return()=>{p.forEach(N=>N&&clearTimeout(N))}},[a,r,n]);let o=D.useCallback(X0(n),[n]),d=D.useCallback(()=>{o({type:5,time:Date.now()})},[o]),u=D.useCallback((f,p)=>{o({type:1,toast:{id:f,height:p}})},[o]),x=D.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),m=D.useCallback((f,p)=>{let{reverseOrder:N=!1,gutter:y=8,defaultPosition:g}=p||{},b=a.filter(S=>(S.position||g)===(f.position||g)&&S.height),j=b.findIndex(S=>S.id===f.id),T=b.filter((S,w)=>w<j&&S.visible).length;return b.filter(S=>S.visible).slice(...N?[T+1]:[0,T]).reduce((S,w)=>S+(w.height||0)+y,0)},[a]);return D.useEffect(()=>{a.forEach(f=>{if(f.dismissed)l(f.id,f.removeDelay);else{let p=s.get(f.id);p&&(clearTimeout(p),s.delete(f.id))}})},[a,l]),{toasts:a,handlers:{updateHeight:u,startPause:d,endPause:x,calculateOffset:m}}},U3=li`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,K3=li`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,z3=li`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,$3=ul("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${U3} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${K3} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${z3} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,G3=li`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,q3=ul("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${G3} 1s linear infinite;
`,W3=li`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,X3=li`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Q3=ul("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${W3} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${X3} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Y3=ul("div")`
  position: absolute;
`,J3=ul("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Z3=li`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,e_=ul("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Z3} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,t_=({toast:e})=>{let{icon:n,type:a,iconTheme:r}=e;return n!==void 0?typeof n=="string"?D.createElement(e_,null,n):n:a==="blank"?null:D.createElement(J3,null,D.createElement(q3,{...r}),a!=="loading"&&D.createElement(Y3,null,a==="error"?D.createElement($3,{...r}):D.createElement(Q3,{...r})))},n_=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,a_=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,r_="0%{opacity:0;} 100%{opacity:1;}",s_="0%{opacity:1;} 100%{opacity:0;}",i_=ul("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,l_=ul("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,o_=(e,n)=>{let a=e.includes("top")?1:-1,[r,s]=tj()?[r_,s_]:[n_(a),a_(a)];return{animation:n?`${li(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${li(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},c_=D.memo(({toast:e,position:n,style:a,children:r})=>{let s=e.height?o_(e.position||n||"top-center",e.visible):{opacity:0},l=D.createElement(t_,{toast:e}),o=D.createElement(l_,{...e.ariaProps},g0(e.message,e));return D.createElement(i_,{className:e.className,style:{...s,...a,...e.style}},typeof r=="function"?r({icon:l,message:o}):D.createElement(D.Fragment,null,l,o))});F3(D.createElement);var d_=({id:e,className:n,style:a,onHeightUpdate:r,children:s})=>{let l=D.useCallback(o=>{if(o){let d=()=>{let u=o.getBoundingClientRect().height;r(e,u)};d(),new MutationObserver(d).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return D.createElement("div",{ref:l,className:n,style:a},s)},u_=(e,n)=>{let a=e.includes("top"),r=a?{top:0}:{bottom:0},s=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:tj()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${n*(a?1:-1)}px)`,...r,...s}},h_=W0`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,zh=16,x_=({reverseOrder:e,position:n="top-center",toastOptions:a,gutter:r,children:s,toasterId:l,containerStyle:o,containerClassName:d})=>{let{toasts:u,handlers:x}=V3(a,l);return D.createElement("div",{"data-rht-toaster":l||"",style:{position:"fixed",zIndex:9999,top:zh,left:zh,right:zh,bottom:zh,pointerEvents:"none",...o},className:d,onMouseEnter:x.startPause,onMouseLeave:x.endPause},u.map(m=>{let f=m.position||n,p=x.calculateOffset(m,{reverseOrder:e,gutter:r,defaultPosition:n}),N=u_(f,p);return D.createElement(d_,{id:m.id,key:m.id,onHeightUpdate:x.updateHeight,className:m.visible?h_:"",style:N},m.type==="custom"?g0(m.message,m):s?s(m):D.createElement(c_,{toast:m,position:f}))}))},ie=xt;/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var m_={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f_=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),_e=(e,n)=>{const a=D.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:o,className:d="",children:u,...x},m)=>D.createElement("svg",{ref:m,...m_,width:s,height:s,stroke:r,strokeWidth:o?Number(l)*24/Number(s):l,className:["lucide",`lucide-${f_(e)}`,d].join(" "),...x},[...n.map(([f,p])=>D.createElement(f,p)),...Array.isArray(u)?u:[u]]));return a.displayName=`${e}`,a};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const di=_e("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=_e("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q0=_e("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p_=_e("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g_=_e("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ij=_e("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lj=_e("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jc=_e("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y_=_e("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v_=_e("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y0=_e("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=_e("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b_=_e("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ob=_e("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N_=_e("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rf=_e("CalendarRange",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=_e("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j_=_e("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oj=_e("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cj=_e("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=_e("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=_e("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ja=_e("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=_e("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qn=_e("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ol=_e("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w_=_e("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k_=_e("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T_=_e("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=_e("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C_=_e("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S_=_e("Command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dj=_e("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __=_e("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Id=_e("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=_e("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=_e("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eg=_e("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=_e("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uj=_e("FileDown",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ei=_e("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=_e("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tg=_e("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hj=_e("FolderTree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E_=_e("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D_=_e("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rl=_e("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A_=_e("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gu=_e("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y0=_e("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F_=_e("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yu=_e("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v0=_e("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L_=_e("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P_=_e("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=_e("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ti=_e("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I_=_e("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ng=_e("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ag=_e("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xd=_e("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O_=_e("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cb=_e("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const db=_e("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wc=_e("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J0=_e("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M_=_e("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xj=_e("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sf=_e("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=_e("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R_=_e("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B_=_e("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H_=_e("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hp=_e("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=_e("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V_=_e("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U_=_e("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K_=_e("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=_e("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vu=_e("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=_e("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z_=_e("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $_=_e("ScrollText",[["path",{d:"M8 21h12a2 2 0 0 0 2-2v-2H10v2a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v3h4",key:"13a6an"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M15 12h-5",key:"r7krc0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=_e("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bu=_e("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mj=_e("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=_e("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G_=_e("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0=_e("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q_=_e("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b0=_e("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fj=_e("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W_=_e("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X_=_e("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pj=_e("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gj=_e("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=_e("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xp=_e("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oi=_e("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z0=_e("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rg=_e("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=_e("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q_=_e("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y_=_e("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const so=_e("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=_e("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sg=_e("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ub=_e("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mo=_e("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mn=_e("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ig=_e("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function yj(e,n){return function(){return e.apply(n,arguments)}}const{toString:J_}=Object.prototype,{getPrototypeOf:lg}=Object,{iterator:ex,toStringTag:vj}=Symbol,tx=(e=>n=>{const a=J_.call(n);return e[a]||(e[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),ss=e=>(e=e.toLowerCase(),n=>tx(n)===e),nx=e=>n=>typeof n===e,{isArray:Lc}=Array,kc=nx("undefined");function Nu(e){return e!==null&&!kc(e)&&e.constructor!==null&&!kc(e.constructor)&&tr(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const bj=ss("ArrayBuffer");function Z_(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&bj(e.buffer),n}const e5=nx("string"),tr=nx("function"),Nj=nx("number"),ju=e=>e!==null&&typeof e=="object",t5=e=>e===!0||e===!1,d0=e=>{if(tx(e)!=="object")return!1;const n=lg(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(vj in e)&&!(ex in e)},n5=e=>{if(!ju(e)||Nu(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},a5=ss("Date"),r5=ss("File"),s5=ss("Blob"),i5=ss("FileList"),l5=e=>ju(e)&&tr(e.pipe),o5=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||tr(e.append)&&((n=tx(e))==="formdata"||n==="object"&&tr(e.toString)&&e.toString()==="[object FormData]"))},c5=ss("URLSearchParams"),[d5,u5,h5,x5]=["ReadableStream","Request","Response","Headers"].map(ss),m5=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function wu(e,n,{allOwnKeys:a=!1}={}){if(e===null||typeof e>"u")return;let r,s;if(typeof e!="object"&&(e=[e]),Lc(e))for(r=0,s=e.length;r<s;r++)n.call(null,e[r],r,e);else{if(Nu(e))return;const l=a?Object.getOwnPropertyNames(e):Object.keys(e),o=l.length;let d;for(r=0;r<o;r++)d=l[r],n.call(null,e[d],d,e)}}function jj(e,n){if(Nu(e))return null;n=n.toLowerCase();const a=Object.keys(e);let r=a.length,s;for(;r-- >0;)if(s=a[r],n===s.toLowerCase())return s;return null}const Hl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,wj=e=>!kc(e)&&e!==Hl;function mp(){const{caseless:e,skipUndefined:n}=wj(this)&&this||{},a={},r=(s,l)=>{const o=e&&jj(a,l)||l;d0(a[o])&&d0(s)?a[o]=mp(a[o],s):d0(s)?a[o]=mp({},s):Lc(s)?a[o]=s.slice():(!n||!kc(s))&&(a[o]=s)};for(let s=0,l=arguments.length;s<l;s++)arguments[s]&&wu(arguments[s],r);return a}const f5=(e,n,a,{allOwnKeys:r}={})=>(wu(n,(s,l)=>{a&&tr(s)?e[l]=yj(s,a):e[l]=s},{allOwnKeys:r}),e),p5=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),g5=(e,n,a,r)=>{e.prototype=Object.create(n.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),a&&Object.assign(e.prototype,a)},y5=(e,n,a,r)=>{let s,l,o;const d={};if(n=n||{},e==null)return n;do{for(s=Object.getOwnPropertyNames(e),l=s.length;l-- >0;)o=s[l],(!r||r(o,e,n))&&!d[o]&&(n[o]=e[o],d[o]=!0);e=a!==!1&&lg(e)}while(e&&(!a||a(e,n))&&e!==Object.prototype);return n},v5=(e,n,a)=>{e=String(e),(a===void 0||a>e.length)&&(a=e.length),a-=n.length;const r=e.indexOf(n,a);return r!==-1&&r===a},b5=e=>{if(!e)return null;if(Lc(e))return e;let n=e.length;if(!Nj(n))return null;const a=new Array(n);for(;n-- >0;)a[n]=e[n];return a},N5=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&lg(Uint8Array)),j5=(e,n)=>{const r=(e&&e[ex]).call(e);let s;for(;(s=r.next())&&!s.done;){const l=s.value;n.call(e,l[0],l[1])}},w5=(e,n)=>{let a;const r=[];for(;(a=e.exec(n))!==null;)r.push(a);return r},k5=ss("HTMLFormElement"),T5=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,r,s){return r.toUpperCase()+s}),hb=(({hasOwnProperty:e})=>(n,a)=>e.call(n,a))(Object.prototype),C5=ss("RegExp"),kj=(e,n)=>{const a=Object.getOwnPropertyDescriptors(e),r={};wu(a,(s,l)=>{let o;(o=n(s,l,e))!==!1&&(r[l]=o||s)}),Object.defineProperties(e,r)},S5=e=>{kj(e,(n,a)=>{if(tr(e)&&["arguments","caller","callee"].indexOf(a)!==-1)return!1;const r=e[a];if(tr(r)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")})}})},_5=(e,n)=>{const a={},r=s=>{s.forEach(l=>{a[l]=!0})};return Lc(e)?r(e):r(String(e).split(n)),a},E5=()=>{},D5=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function A5(e){return!!(e&&tr(e.append)&&e[vj]==="FormData"&&e[ex])}const F5=e=>{const n=new Array(10),a=(r,s)=>{if(ju(r)){if(n.indexOf(r)>=0)return;if(Nu(r))return r;if(!("toJSON"in r)){n[s]=r;const l=Lc(r)?[]:{};return wu(r,(o,d)=>{const u=a(o,s+1);!kc(u)&&(l[d]=u)}),n[s]=void 0,l}}return r};return a(e,0)},L5=ss("AsyncFunction"),P5=e=>e&&(ju(e)||tr(e))&&tr(e.then)&&tr(e.catch),Tj=((e,n)=>e?setImmediate:n?((a,r)=>(Hl.addEventListener("message",({source:s,data:l})=>{s===Hl&&l===a&&r.length&&r.shift()()},!1),s=>{r.push(s),Hl.postMessage(a,"*")}))(`axios@${Math.random()}`,[]):a=>setTimeout(a))(typeof setImmediate=="function",tr(Hl.postMessage)),I5=typeof queueMicrotask<"u"?queueMicrotask.bind(Hl):typeof process<"u"&&process.nextTick||Tj,O5=e=>e!=null&&tr(e[ex]),ke={isArray:Lc,isArrayBuffer:bj,isBuffer:Nu,isFormData:o5,isArrayBufferView:Z_,isString:e5,isNumber:Nj,isBoolean:t5,isObject:ju,isPlainObject:d0,isEmptyObject:n5,isReadableStream:d5,isRequest:u5,isResponse:h5,isHeaders:x5,isUndefined:kc,isDate:a5,isFile:r5,isBlob:s5,isRegExp:C5,isFunction:tr,isStream:l5,isURLSearchParams:c5,isTypedArray:N5,isFileList:i5,forEach:wu,merge:mp,extend:f5,trim:m5,stripBOM:p5,inherits:g5,toFlatObject:y5,kindOf:tx,kindOfTest:ss,endsWith:v5,toArray:b5,forEachEntry:j5,matchAll:w5,isHTMLForm:k5,hasOwnProperty:hb,hasOwnProp:hb,reduceDescriptors:kj,freezeMethods:S5,toObjectSet:_5,toCamelCase:T5,noop:E5,toFiniteNumber:D5,findKey:jj,global:Hl,isContextDefined:wj,isSpecCompliantForm:A5,toJSONObject:F5,isAsyncFn:L5,isThenable:P5,setImmediate:Tj,asap:I5,isIterable:O5};function pt(e,n,a,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),a&&(this.config=a),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}ke.inherits(pt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ke.toJSONObject(this.config),code:this.code,status:this.status}}});const Cj=pt.prototype,Sj={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Sj[e]={value:e}});Object.defineProperties(pt,Sj);Object.defineProperty(Cj,"isAxiosError",{value:!0});pt.from=(e,n,a,r,s,l)=>{const o=Object.create(Cj);ke.toFlatObject(e,o,function(m){return m!==Error.prototype},x=>x!=="isAxiosError");const d=e&&e.message?e.message:"Error",u=n==null&&e?e.code:n;return pt.call(o,d,u,a,r,s),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",l&&Object.assign(o,l),o};const M5=null;function fp(e){return ke.isPlainObject(e)||ke.isArray(e)}function _j(e){return ke.endsWith(e,"[]")?e.slice(0,-2):e}function xb(e,n,a){return e?e.concat(n).map(function(s,l){return s=_j(s),!a&&l?"["+s+"]":s}).join(a?".":""):n}function R5(e){return ke.isArray(e)&&!e.some(fp)}const B5=ke.toFlatObject(ke,{},null,function(n){return/^is[A-Z]/.test(n)});function ax(e,n,a){if(!ke.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,a=ke.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,b){return!ke.isUndefined(b[g])});const r=a.metaTokens,s=a.visitor||m,l=a.dots,o=a.indexes,u=(a.Blob||typeof Blob<"u"&&Blob)&&ke.isSpecCompliantForm(n);if(!ke.isFunction(s))throw new TypeError("visitor must be a function");function x(y){if(y===null)return"";if(ke.isDate(y))return y.toISOString();if(ke.isBoolean(y))return y.toString();if(!u&&ke.isBlob(y))throw new pt("Blob is not supported. Use a Buffer instead.");return ke.isArrayBuffer(y)||ke.isTypedArray(y)?u&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function m(y,g,b){let j=y;if(y&&!b&&typeof y=="object"){if(ke.endsWith(g,"{}"))g=r?g:g.slice(0,-2),y=JSON.stringify(y);else if(ke.isArray(y)&&R5(y)||(ke.isFileList(y)||ke.endsWith(g,"[]"))&&(j=ke.toArray(y)))return g=_j(g),j.forEach(function(S,w){!(ke.isUndefined(S)||S===null)&&n.append(o===!0?xb([g],w,l):o===null?g:g+"[]",x(S))}),!1}return fp(y)?!0:(n.append(xb(b,g,l),x(y)),!1)}const f=[],p=Object.assign(B5,{defaultVisitor:m,convertValue:x,isVisitable:fp});function N(y,g){if(!ke.isUndefined(y)){if(f.indexOf(y)!==-1)throw Error("Circular reference detected in "+g.join("."));f.push(y),ke.forEach(y,function(j,T){(!(ke.isUndefined(j)||j===null)&&s.call(n,j,ke.isString(T)?T.trim():T,g,p))===!0&&N(j,g?g.concat(T):[T])}),f.pop()}}if(!ke.isObject(e))throw new TypeError("data must be an object");return N(e),n}function mb(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return n[r]})}function og(e,n){this._pairs=[],e&&ax(e,this,n)}const Ej=og.prototype;Ej.append=function(n,a){this._pairs.push([n,a])};Ej.toString=function(n){const a=n?function(r){return n.call(this,r,mb)}:mb;return this._pairs.map(function(s){return a(s[0])+"="+a(s[1])},"").join("&")};function H5(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Dj(e,n,a){if(!n)return e;const r=a&&a.encode||H5;ke.isFunction(a)&&(a={serialize:a});const s=a&&a.serialize;let l;if(s?l=s(n,a):l=ke.isURLSearchParams(n)?n.toString():new og(n,a).toString(r),l){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+l}return e}class fb{constructor(){this.handlers=[]}use(n,a,r){return this.handlers.push({fulfilled:n,rejected:a,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){ke.forEach(this.handlers,function(r){r!==null&&n(r)})}}const Aj={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},V5=typeof URLSearchParams<"u"?URLSearchParams:og,U5=typeof FormData<"u"?FormData:null,K5=typeof Blob<"u"?Blob:null,z5={isBrowser:!0,classes:{URLSearchParams:V5,FormData:U5,Blob:K5},protocols:["http","https","file","blob","url","data"]},cg=typeof window<"u"&&typeof document<"u",pp=typeof navigator=="object"&&navigator||void 0,$5=cg&&(!pp||["ReactNative","NativeScript","NS"].indexOf(pp.product)<0),G5=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",q5=cg&&window.location.href||"http://localhost",W5=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:cg,hasStandardBrowserEnv:$5,hasStandardBrowserWebWorkerEnv:G5,navigator:pp,origin:q5},Symbol.toStringTag,{value:"Module"})),ka={...W5,...z5};function X5(e,n){return ax(e,new ka.classes.URLSearchParams,{visitor:function(a,r,s,l){return ka.isNode&&ke.isBuffer(a)?(this.append(r,a.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...n})}function Q5(e){return ke.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function Y5(e){const n={},a=Object.keys(e);let r;const s=a.length;let l;for(r=0;r<s;r++)l=a[r],n[l]=e[l];return n}function Fj(e){function n(a,r,s,l){let o=a[l++];if(o==="__proto__")return!0;const d=Number.isFinite(+o),u=l>=a.length;return o=!o&&ke.isArray(s)?s.length:o,u?(ke.hasOwnProp(s,o)?s[o]=[s[o],r]:s[o]=r,!d):((!s[o]||!ke.isObject(s[o]))&&(s[o]=[]),n(a,r,s[o],l)&&ke.isArray(s[o])&&(s[o]=Y5(s[o])),!d)}if(ke.isFormData(e)&&ke.isFunction(e.entries)){const a={};return ke.forEachEntry(e,(r,s)=>{n(Q5(r),s,a,0)}),a}return null}function J5(e,n,a){if(ke.isString(e))try{return(n||JSON.parse)(e),ke.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(a||JSON.stringify)(e)}const ku={transitional:Aj,adapter:["xhr","http","fetch"],transformRequest:[function(n,a){const r=a.getContentType()||"",s=r.indexOf("application/json")>-1,l=ke.isObject(n);if(l&&ke.isHTMLForm(n)&&(n=new FormData(n)),ke.isFormData(n))return s?JSON.stringify(Fj(n)):n;if(ke.isArrayBuffer(n)||ke.isBuffer(n)||ke.isStream(n)||ke.isFile(n)||ke.isBlob(n)||ke.isReadableStream(n))return n;if(ke.isArrayBufferView(n))return n.buffer;if(ke.isURLSearchParams(n))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let d;if(l){if(r.indexOf("application/x-www-form-urlencoded")>-1)return X5(n,this.formSerializer).toString();if((d=ke.isFileList(n))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return ax(d?{"files[]":n}:n,u&&new u,this.formSerializer)}}return l||s?(a.setContentType("application/json",!1),J5(n)):n}],transformResponse:[function(n){const a=this.transitional||ku.transitional,r=a&&a.forcedJSONParsing,s=this.responseType==="json";if(ke.isResponse(n)||ke.isReadableStream(n))return n;if(n&&ke.isString(n)&&(r&&!this.responseType||s)){const o=!(a&&a.silentJSONParsing)&&s;try{return JSON.parse(n,this.parseReviver)}catch(d){if(o)throw d.name==="SyntaxError"?pt.from(d,pt.ERR_BAD_RESPONSE,this,null,this.response):d}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ka.classes.FormData,Blob:ka.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ke.forEach(["delete","get","head","post","put","patch"],e=>{ku.headers[e]={}});const Z5=ke.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),eE=e=>{const n={};let a,r,s;return e&&e.split(`
`).forEach(function(o){s=o.indexOf(":"),a=o.substring(0,s).trim().toLowerCase(),r=o.substring(s+1).trim(),!(!a||n[a]&&Z5[a])&&(a==="set-cookie"?n[a]?n[a].push(r):n[a]=[r]:n[a]=n[a]?n[a]+", "+r:r)}),n},pb=Symbol("internals");function wd(e){return e&&String(e).trim().toLowerCase()}function u0(e){return e===!1||e==null?e:ke.isArray(e)?e.map(u0):String(e)}function tE(e){const n=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=a.exec(e);)n[r[1]]=r[2];return n}const nE=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function lf(e,n,a,r,s){if(ke.isFunction(r))return r.call(this,n,a);if(s&&(n=a),!!ke.isString(n)){if(ke.isString(r))return n.indexOf(r)!==-1;if(ke.isRegExp(r))return r.test(n)}}function aE(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,a,r)=>a.toUpperCase()+r)}function rE(e,n){const a=ke.toCamelCase(" "+n);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+a,{value:function(s,l,o){return this[r].call(this,n,s,l,o)},configurable:!0})})}let nr=class{constructor(n){n&&this.set(n)}set(n,a,r){const s=this;function l(d,u,x){const m=wd(u);if(!m)throw new Error("header name must be a non-empty string");const f=ke.findKey(s,m);(!f||s[f]===void 0||x===!0||x===void 0&&s[f]!==!1)&&(s[f||u]=u0(d))}const o=(d,u)=>ke.forEach(d,(x,m)=>l(x,m,u));if(ke.isPlainObject(n)||n instanceof this.constructor)o(n,a);else if(ke.isString(n)&&(n=n.trim())&&!nE(n))o(eE(n),a);else if(ke.isObject(n)&&ke.isIterable(n)){let d={},u,x;for(const m of n){if(!ke.isArray(m))throw TypeError("Object iterator must return a key-value pair");d[x=m[0]]=(u=d[x])?ke.isArray(u)?[...u,m[1]]:[u,m[1]]:m[1]}o(d,a)}else n!=null&&l(a,n,r);return this}get(n,a){if(n=wd(n),n){const r=ke.findKey(this,n);if(r){const s=this[r];if(!a)return s;if(a===!0)return tE(s);if(ke.isFunction(a))return a.call(this,s,r);if(ke.isRegExp(a))return a.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,a){if(n=wd(n),n){const r=ke.findKey(this,n);return!!(r&&this[r]!==void 0&&(!a||lf(this,this[r],r,a)))}return!1}delete(n,a){const r=this;let s=!1;function l(o){if(o=wd(o),o){const d=ke.findKey(r,o);d&&(!a||lf(r,r[d],d,a))&&(delete r[d],s=!0)}}return ke.isArray(n)?n.forEach(l):l(n),s}clear(n){const a=Object.keys(this);let r=a.length,s=!1;for(;r--;){const l=a[r];(!n||lf(this,this[l],l,n,!0))&&(delete this[l],s=!0)}return s}normalize(n){const a=this,r={};return ke.forEach(this,(s,l)=>{const o=ke.findKey(r,l);if(o){a[o]=u0(s),delete a[l];return}const d=n?aE(l):String(l).trim();d!==l&&delete a[l],a[d]=u0(s),r[d]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const a=Object.create(null);return ke.forEach(this,(r,s)=>{r!=null&&r!==!1&&(a[s]=n&&ke.isArray(r)?r.join(", "):r)}),a}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,a])=>n+": "+a).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...a){const r=new this(n);return a.forEach(s=>r.set(s)),r}static accessor(n){const r=(this[pb]=this[pb]={accessors:{}}).accessors,s=this.prototype;function l(o){const d=wd(o);r[d]||(rE(s,o),r[d]=!0)}return ke.isArray(n)?n.forEach(l):l(n),this}};nr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ke.reduceDescriptors(nr.prototype,({value:e},n)=>{let a=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(r){this[a]=r}}});ke.freezeMethods(nr);function of(e,n){const a=this||ku,r=n||a,s=nr.from(r.headers);let l=r.data;return ke.forEach(e,function(d){l=d.call(a,l,s.normalize(),n?n.status:void 0)}),s.normalize(),l}function Lj(e){return!!(e&&e.__CANCEL__)}function Pc(e,n,a){pt.call(this,e??"canceled",pt.ERR_CANCELED,n,a),this.name="CanceledError"}ke.inherits(Pc,pt,{__CANCEL__:!0});function Pj(e,n,a){const r=a.config.validateStatus;!a.status||!r||r(a.status)?e(a):n(new pt("Request failed with status code "+a.status,[pt.ERR_BAD_REQUEST,pt.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}function sE(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function iE(e,n){e=e||10;const a=new Array(e),r=new Array(e);let s=0,l=0,o;return n=n!==void 0?n:1e3,function(u){const x=Date.now(),m=r[l];o||(o=x),a[s]=u,r[s]=x;let f=l,p=0;for(;f!==s;)p+=a[f++],f=f%e;if(s=(s+1)%e,s===l&&(l=(l+1)%e),x-o<n)return;const N=m&&x-m;return N?Math.round(p*1e3/N):void 0}}function lE(e,n){let a=0,r=1e3/n,s,l;const o=(x,m=Date.now())=>{a=m,s=null,l&&(clearTimeout(l),l=null),e(...x)};return[(...x)=>{const m=Date.now(),f=m-a;f>=r?o(x,m):(s=x,l||(l=setTimeout(()=>{l=null,o(s)},r-f)))},()=>s&&o(s)]}const N0=(e,n,a=3)=>{let r=0;const s=iE(50,250);return lE(l=>{const o=l.loaded,d=l.lengthComputable?l.total:void 0,u=o-r,x=s(u),m=o<=d;r=o;const f={loaded:o,total:d,progress:d?o/d:void 0,bytes:u,rate:x||void 0,estimated:x&&d&&m?(d-o)/x:void 0,event:l,lengthComputable:d!=null,[n?"download":"upload"]:!0};e(f)},a)},gb=(e,n)=>{const a=e!=null;return[r=>n[0]({lengthComputable:a,total:e,loaded:r}),n[1]]},yb=e=>(...n)=>ke.asap(()=>e(...n)),oE=ka.hasStandardBrowserEnv?((e,n)=>a=>(a=new URL(a,ka.origin),e.protocol===a.protocol&&e.host===a.host&&(n||e.port===a.port)))(new URL(ka.origin),ka.navigator&&/(msie|trident)/i.test(ka.navigator.userAgent)):()=>!0,cE=ka.hasStandardBrowserEnv?{write(e,n,a,r,s,l,o){if(typeof document>"u")return;const d=[`${e}=${encodeURIComponent(n)}`];ke.isNumber(a)&&d.push(`expires=${new Date(a).toUTCString()}`),ke.isString(r)&&d.push(`path=${r}`),ke.isString(s)&&d.push(`domain=${s}`),l===!0&&d.push("secure"),ke.isString(o)&&d.push(`SameSite=${o}`),document.cookie=d.join("; ")},read(e){if(typeof document>"u")return null;const n=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return n?decodeURIComponent(n[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function dE(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function uE(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function Ij(e,n,a){let r=!dE(n);return e&&(r||a==!1)?uE(e,n):n}const vb=e=>e instanceof nr?{...e}:e;function io(e,n){n=n||{};const a={};function r(x,m,f,p){return ke.isPlainObject(x)&&ke.isPlainObject(m)?ke.merge.call({caseless:p},x,m):ke.isPlainObject(m)?ke.merge({},m):ke.isArray(m)?m.slice():m}function s(x,m,f,p){if(ke.isUndefined(m)){if(!ke.isUndefined(x))return r(void 0,x,f,p)}else return r(x,m,f,p)}function l(x,m){if(!ke.isUndefined(m))return r(void 0,m)}function o(x,m){if(ke.isUndefined(m)){if(!ke.isUndefined(x))return r(void 0,x)}else return r(void 0,m)}function d(x,m,f){if(f in n)return r(x,m);if(f in e)return r(void 0,x)}const u={url:l,method:l,data:l,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:d,headers:(x,m,f)=>s(vb(x),vb(m),f,!0)};return ke.forEach(Object.keys({...e,...n}),function(m){const f=u[m]||s,p=f(e[m],n[m],m);ke.isUndefined(p)&&f!==d||(a[m]=p)}),a}const Oj=e=>{const n=io({},e);let{data:a,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:l,headers:o,auth:d}=n;if(n.headers=o=nr.from(o),n.url=Dj(Ij(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),d&&o.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):""))),ke.isFormData(a)){if(ka.hasStandardBrowserEnv||ka.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(ke.isFunction(a.getHeaders)){const u=a.getHeaders(),x=["content-type","content-length"];Object.entries(u).forEach(([m,f])=>{x.includes(m.toLowerCase())&&o.set(m,f)})}}if(ka.hasStandardBrowserEnv&&(r&&ke.isFunction(r)&&(r=r(n)),r||r!==!1&&oE(n.url))){const u=s&&l&&cE.read(l);u&&o.set(s,u)}return n},hE=typeof XMLHttpRequest<"u",xE=hE&&function(e){return new Promise(function(a,r){const s=Oj(e);let l=s.data;const o=nr.from(s.headers).normalize();let{responseType:d,onUploadProgress:u,onDownloadProgress:x}=s,m,f,p,N,y;function g(){N&&N(),y&&y(),s.cancelToken&&s.cancelToken.unsubscribe(m),s.signal&&s.signal.removeEventListener("abort",m)}let b=new XMLHttpRequest;b.open(s.method.toUpperCase(),s.url,!0),b.timeout=s.timeout;function j(){if(!b)return;const S=nr.from("getAllResponseHeaders"in b&&b.getAllResponseHeaders()),_={data:!d||d==="text"||d==="json"?b.responseText:b.response,status:b.status,statusText:b.statusText,headers:S,config:e,request:b};Pj(function(C){a(C),g()},function(C){r(C),g()},_),b=null}"onloadend"in b?b.onloadend=j:b.onreadystatechange=function(){!b||b.readyState!==4||b.status===0&&!(b.responseURL&&b.responseURL.indexOf("file:")===0)||setTimeout(j)},b.onabort=function(){b&&(r(new pt("Request aborted",pt.ECONNABORTED,e,b)),b=null)},b.onerror=function(w){const _=w&&w.message?w.message:"Network Error",E=new pt(_,pt.ERR_NETWORK,e,b);E.event=w||null,r(E),b=null},b.ontimeout=function(){let w=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const _=s.transitional||Aj;s.timeoutErrorMessage&&(w=s.timeoutErrorMessage),r(new pt(w,_.clarifyTimeoutError?pt.ETIMEDOUT:pt.ECONNABORTED,e,b)),b=null},l===void 0&&o.setContentType(null),"setRequestHeader"in b&&ke.forEach(o.toJSON(),function(w,_){b.setRequestHeader(_,w)}),ke.isUndefined(s.withCredentials)||(b.withCredentials=!!s.withCredentials),d&&d!=="json"&&(b.responseType=s.responseType),x&&([p,y]=N0(x,!0),b.addEventListener("progress",p)),u&&b.upload&&([f,N]=N0(u),b.upload.addEventListener("progress",f),b.upload.addEventListener("loadend",N)),(s.cancelToken||s.signal)&&(m=S=>{b&&(r(!S||S.type?new Pc(null,e,b):S),b.abort(),b=null)},s.cancelToken&&s.cancelToken.subscribe(m),s.signal&&(s.signal.aborted?m():s.signal.addEventListener("abort",m)));const T=sE(s.url);if(T&&ka.protocols.indexOf(T)===-1){r(new pt("Unsupported protocol "+T+":",pt.ERR_BAD_REQUEST,e));return}b.send(l||null)})},mE=(e,n)=>{const{length:a}=e=e?e.filter(Boolean):[];if(n||a){let r=new AbortController,s;const l=function(x){if(!s){s=!0,d();const m=x instanceof Error?x:this.reason;r.abort(m instanceof pt?m:new Pc(m instanceof Error?m.message:m))}};let o=n&&setTimeout(()=>{o=null,l(new pt(`timeout ${n} of ms exceeded`,pt.ETIMEDOUT))},n);const d=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(x=>{x.unsubscribe?x.unsubscribe(l):x.removeEventListener("abort",l)}),e=null)};e.forEach(x=>x.addEventListener("abort",l));const{signal:u}=r;return u.unsubscribe=()=>ke.asap(d),u}},fE=function*(e,n){let a=e.byteLength;if(a<n){yield e;return}let r=0,s;for(;r<a;)s=r+n,yield e.slice(r,s),r=s},pE=async function*(e,n){for await(const a of gE(e))yield*fE(a,n)},gE=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:a,value:r}=await n.read();if(a)break;yield r}}finally{await n.cancel()}},bb=(e,n,a,r)=>{const s=pE(e,n);let l=0,o,d=u=>{o||(o=!0,r&&r(u))};return new ReadableStream({async pull(u){try{const{done:x,value:m}=await s.next();if(x){d(),u.close();return}let f=m.byteLength;if(a){let p=l+=f;a(p)}u.enqueue(new Uint8Array(m))}catch(x){throw d(x),x}},cancel(u){return d(u),s.return()}},{highWaterMark:2})},Nb=64*1024,{isFunction:$h}=ke,yE=(({Request:e,Response:n})=>({Request:e,Response:n}))(ke.global),{ReadableStream:jb,TextEncoder:wb}=ke.global,kb=(e,...n)=>{try{return!!e(...n)}catch{return!1}},vE=e=>{e=ke.merge.call({skipUndefined:!0},yE,e);const{fetch:n,Request:a,Response:r}=e,s=n?$h(n):typeof fetch=="function",l=$h(a),o=$h(r);if(!s)return!1;const d=s&&$h(jb),u=s&&(typeof wb=="function"?(y=>g=>y.encode(g))(new wb):async y=>new Uint8Array(await new a(y).arrayBuffer())),x=l&&d&&kb(()=>{let y=!1;const g=new a(ka.origin,{body:new jb,method:"POST",get duplex(){return y=!0,"half"}}).headers.has("Content-Type");return y&&!g}),m=o&&d&&kb(()=>ke.isReadableStream(new r("").body)),f={stream:m&&(y=>y.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(y=>{!f[y]&&(f[y]=(g,b)=>{let j=g&&g[y];if(j)return j.call(g);throw new pt(`Response type '${y}' is not supported`,pt.ERR_NOT_SUPPORT,b)})});const p=async y=>{if(y==null)return 0;if(ke.isBlob(y))return y.size;if(ke.isSpecCompliantForm(y))return(await new a(ka.origin,{method:"POST",body:y}).arrayBuffer()).byteLength;if(ke.isArrayBufferView(y)||ke.isArrayBuffer(y))return y.byteLength;if(ke.isURLSearchParams(y)&&(y=y+""),ke.isString(y))return(await u(y)).byteLength},N=async(y,g)=>{const b=ke.toFiniteNumber(y.getContentLength());return b??p(g)};return async y=>{let{url:g,method:b,data:j,signal:T,cancelToken:S,timeout:w,onDownloadProgress:_,onUploadProgress:E,responseType:C,headers:P,withCredentials:F="same-origin",fetchOptions:R}=Oj(y),O=n||fetch;C=C?(C+"").toLowerCase():"text";let M=mE([T,S&&S.toAbortSignal()],w),q=null;const J=M&&M.unsubscribe&&(()=>{M.unsubscribe()});let B;try{if(E&&x&&b!=="get"&&b!=="head"&&(B=await N(P,j))!==0){let K=new a(g,{method:"POST",body:j,duplex:"half"}),L;if(ke.isFormData(j)&&(L=K.headers.get("content-type"))&&P.setContentType(L),K.body){const[X,I]=gb(B,N0(yb(E)));j=bb(K.body,Nb,X,I)}}ke.isString(F)||(F=F?"include":"omit");const ue=l&&"credentials"in a.prototype,te={...R,signal:M,method:b.toUpperCase(),headers:P.normalize().toJSON(),body:j,duplex:"half",credentials:ue?F:void 0};q=l&&new a(g,te);let Z=await(l?O(q,R):O(g,te));const Q=m&&(C==="stream"||C==="response");if(m&&(_||Q&&J)){const K={};["status","statusText","headers"].forEach(W=>{K[W]=Z[W]});const L=ke.toFiniteNumber(Z.headers.get("content-length")),[X,I]=_&&gb(L,N0(yb(_),!0))||[];Z=new r(bb(Z.body,Nb,X,()=>{I&&I(),J&&J()}),K)}C=C||"text";let fe=await f[ke.findKey(f,C)||"text"](Z,y);return!Q&&J&&J(),await new Promise((K,L)=>{Pj(K,L,{data:fe,headers:nr.from(Z.headers),status:Z.status,statusText:Z.statusText,config:y,request:q})})}catch(ue){throw J&&J(),ue&&ue.name==="TypeError"&&/Load failed|fetch/i.test(ue.message)?Object.assign(new pt("Network Error",pt.ERR_NETWORK,y,q),{cause:ue.cause||ue}):pt.from(ue,ue&&ue.code,y,q)}}},bE=new Map,Mj=e=>{let n=e&&e.env||{};const{fetch:a,Request:r,Response:s}=n,l=[r,s,a];let o=l.length,d=o,u,x,m=bE;for(;d--;)u=l[d],x=m.get(u),x===void 0&&m.set(u,x=d?new Map:vE(n)),m=x;return x};Mj();const dg={http:M5,xhr:xE,fetch:{get:Mj}};ke.forEach(dg,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const Tb=e=>`- ${e}`,NE=e=>ke.isFunction(e)||e===null||e===!1;function jE(e,n){e=ke.isArray(e)?e:[e];const{length:a}=e;let r,s;const l={};for(let o=0;o<a;o++){r=e[o];let d;if(s=r,!NE(r)&&(s=dg[(d=String(r)).toLowerCase()],s===void 0))throw new pt(`Unknown adapter '${d}'`);if(s&&(ke.isFunction(s)||(s=s.get(n))))break;l[d||"#"+o]=s}if(!s){const o=Object.entries(l).map(([u,x])=>`adapter ${u} `+(x===!1?"is not supported by the environment":"is not available in the build"));let d=a?o.length>1?`since :
`+o.map(Tb).join(`
`):" "+Tb(o[0]):"as no adapter specified";throw new pt("There is no suitable adapter to dispatch the request "+d,"ERR_NOT_SUPPORT")}return s}const Rj={getAdapter:jE,adapters:dg};function cf(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Pc(null,e)}function Cb(e){return cf(e),e.headers=nr.from(e.headers),e.data=of.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Rj.getAdapter(e.adapter||ku.adapter,e)(e).then(function(r){return cf(e),r.data=of.call(e,e.transformResponse,r),r.headers=nr.from(r.headers),r},function(r){return Lj(r)||(cf(e),r&&r.response&&(r.response.data=of.call(e,e.transformResponse,r.response),r.response.headers=nr.from(r.response.headers))),Promise.reject(r)})}const Bj="1.13.2",rx={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{rx[e]=function(r){return typeof r===e||"a"+(n<1?"n ":" ")+e}});const Sb={};rx.transitional=function(n,a,r){function s(l,o){return"[Axios v"+Bj+"] Transitional option '"+l+"'"+o+(r?". "+r:"")}return(l,o,d)=>{if(n===!1)throw new pt(s(o," has been removed"+(a?" in "+a:"")),pt.ERR_DEPRECATED);return a&&!Sb[o]&&(Sb[o]=!0,console.warn(s(o," has been deprecated since v"+a+" and will be removed in the near future"))),n?n(l,o,d):!0}};rx.spelling=function(n){return(a,r)=>(console.warn(`${r} is likely a misspelling of ${n}`),!0)};function wE(e,n,a){if(typeof e!="object")throw new pt("options must be an object",pt.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let s=r.length;for(;s-- >0;){const l=r[s],o=n[l];if(o){const d=e[l],u=d===void 0||o(d,l,e);if(u!==!0)throw new pt("option "+l+" must be "+u,pt.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new pt("Unknown option "+l,pt.ERR_BAD_OPTION)}}const h0={assertOptions:wE,validators:rx},xs=h0.validators;let Jl=class{constructor(n){this.defaults=n||{},this.interceptors={request:new fb,response:new fb}}async request(n,a){try{return await this._request(n,a)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const l=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?l&&!String(r.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+l):r.stack=l}catch{}}throw r}}_request(n,a){typeof n=="string"?(a=a||{},a.url=n):a=n||{},a=io(this.defaults,a);const{transitional:r,paramsSerializer:s,headers:l}=a;r!==void 0&&h0.assertOptions(r,{silentJSONParsing:xs.transitional(xs.boolean),forcedJSONParsing:xs.transitional(xs.boolean),clarifyTimeoutError:xs.transitional(xs.boolean)},!1),s!=null&&(ke.isFunction(s)?a.paramsSerializer={serialize:s}:h0.assertOptions(s,{encode:xs.function,serialize:xs.function},!0)),a.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?a.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:a.allowAbsoluteUrls=!0),h0.assertOptions(a,{baseUrl:xs.spelling("baseURL"),withXsrfToken:xs.spelling("withXSRFToken")},!0),a.method=(a.method||this.defaults.method||"get").toLowerCase();let o=l&&ke.merge(l.common,l[a.method]);l&&ke.forEach(["delete","get","head","post","put","patch","common"],y=>{delete l[y]}),a.headers=nr.concat(o,l);const d=[];let u=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(a)===!1||(u=u&&g.synchronous,d.unshift(g.fulfilled,g.rejected))});const x=[];this.interceptors.response.forEach(function(g){x.push(g.fulfilled,g.rejected)});let m,f=0,p;if(!u){const y=[Cb.bind(this),void 0];for(y.unshift(...d),y.push(...x),p=y.length,m=Promise.resolve(a);f<p;)m=m.then(y[f++],y[f++]);return m}p=d.length;let N=a;for(;f<p;){const y=d[f++],g=d[f++];try{N=y(N)}catch(b){g.call(this,b);break}}try{m=Cb.call(this,N)}catch(y){return Promise.reject(y)}for(f=0,p=x.length;f<p;)m=m.then(x[f++],x[f++]);return m}getUri(n){n=io(this.defaults,n);const a=Ij(n.baseURL,n.url,n.allowAbsoluteUrls);return Dj(a,n.params,n.paramsSerializer)}};ke.forEach(["delete","get","head","options"],function(n){Jl.prototype[n]=function(a,r){return this.request(io(r||{},{method:n,url:a,data:(r||{}).data}))}});ke.forEach(["post","put","patch"],function(n){function a(r){return function(l,o,d){return this.request(io(d||{},{method:n,headers:r?{"Content-Type":"multipart/form-data"}:{},url:l,data:o}))}}Jl.prototype[n]=a(),Jl.prototype[n+"Form"]=a(!0)});let kE=class Hj{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(l){a=l});const r=this;this.promise.then(s=>{if(!r._listeners)return;let l=r._listeners.length;for(;l-- >0;)r._listeners[l](s);r._listeners=null}),this.promise.then=s=>{let l;const o=new Promise(d=>{r.subscribe(d),l=d}).then(s);return o.cancel=function(){r.unsubscribe(l)},o},n(function(l,o,d){r.reason||(r.reason=new Pc(l,o,d),a(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const a=this._listeners.indexOf(n);a!==-1&&this._listeners.splice(a,1)}toAbortSignal(){const n=new AbortController,a=r=>{n.abort(r)};return this.subscribe(a),n.signal.unsubscribe=()=>this.unsubscribe(a),n.signal}static source(){let n;return{token:new Hj(function(s){n=s}),cancel:n}}};function TE(e){return function(a){return e.apply(null,a)}}function CE(e){return ke.isObject(e)&&e.isAxiosError===!0}const gp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(gp).forEach(([e,n])=>{gp[n]=e});function Vj(e){const n=new Jl(e),a=yj(Jl.prototype.request,n);return ke.extend(a,Jl.prototype,n,{allOwnKeys:!0}),ke.extend(a,n,null,{allOwnKeys:!0}),a.create=function(s){return Vj(io(e,s))},a}const Zt=Vj(ku);Zt.Axios=Jl;Zt.CanceledError=Pc;Zt.CancelToken=kE;Zt.isCancel=Lj;Zt.VERSION=Bj;Zt.toFormData=ax;Zt.AxiosError=pt;Zt.Cancel=Zt.CanceledError;Zt.all=function(n){return Promise.all(n)};Zt.spread=TE;Zt.isAxiosError=CE;Zt.mergeConfig=io;Zt.AxiosHeaders=nr;Zt.formToJSON=e=>Fj(ke.isHTMLForm(e)?new FormData(e):e);Zt.getAdapter=Rj.getAdapter;Zt.HttpStatusCode=gp;Zt.default=Zt;const{Axios:_U,AxiosError:EU,CanceledError:DU,isCancel:AU,CancelToken:FU,VERSION:LU,all:PU,Cancel:IU,isAxiosError:OU,spread:MU,toFormData:RU,AxiosHeaders:BU,HttpStatusCode:HU,formToJSON:VU,getAdapter:UU,mergeConfig:KU}=Zt,SE="tinh_luong_auth",na=Zt.create({baseURL:"/api/rbac",headers:{"Content-Type":"application/json"}});na.interceptors.request.use(e=>{const n=localStorage.getItem(SE);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const df={dangNhap:(e,n)=>na.post("/dang-nhap",{tenDangNhap:e,matKhau:n}).then(a=>a.data),dangXuat:e=>na.post("/dang-xuat",null,{headers:{Authorization:`Bearer ${e}`}}).then(n=>n.data),kiemTraToken:e=>na.get("/kiem-tra-token",{headers:{Authorization:`Bearer ${e}`}}).then(n=>n.data)},uf={layTatCa:()=>na.get("/nguoi-dung").then(e=>e.data),layTheoId:e=>na.get(`/nguoi-dung/${e}`).then(n=>n.data),taoMoi:e=>na.post("/nguoi-dung",e).then(n=>n.data),capNhat:(e,n)=>na.put(`/nguoi-dung/${e}`,n).then(a=>a.data),doiMatKhau:(e,n,a)=>na.put(`/nguoi-dung/${e}/doi-mat-khau`,{matKhauCu:n,matKhauMoi:a}).then(r=>r.data)},_b={layTatCa:()=>na.get("/vai-tro").then(e=>e.data),layTheoId:e=>na.get(`/vai-tro/${e}`).then(n=>n.data),taoMoi:e=>na.post("/vai-tro",e).then(n=>n.data),capNhat:(e,n)=>na.put(`/vai-tro/${e}`,n).then(a=>a.data),ganVaiTro:(e,n)=>na.post("/vai-tro/gan",{nguoiDungId:e,vaiTroId:n}).then(a=>a.data),goVaiTro:(e,n)=>na.delete("/vai-tro/go",{data:{nguoiDungId:e,vaiTroId:n}}).then(a=>a.data)},_E={layDanhSach:e=>na.get("/audit-log",{params:e}).then(n=>n.data),layTheoNguoiDung:e=>na.get(`/audit-log/nguoi-dung/${e}`).then(n=>n.data),layTheoBanGhi:(e,n)=>na.get(`/audit-log/ban-ghi/${e}/${n}`).then(a=>a.data)},Uj=D.createContext(void 0),Wo="tinh_luong_auth",EE=6e4;function DE({children:e}){const[n,a]=D.useState(null),[r,s]=D.useState(null),[l,o]=D.useState([]),[d,u]=D.useState([]),[x,m]=D.useState(!0),f=D.useCallback(()=>{localStorage.removeItem(Wo),s(null),a(null),o([]),u([])},[]),p=D.useCallback(()=>{const T=localStorage.getItem(Wo);if(T)try{const S=JSON.parse(T),w=new Date(S.hetHan),_=new Date;if(w<=_)return f(),window.location.href="/dang-nhap?expired=1",!1;const E=w.getTime()-_.getTime();return E<600*1e3&&E>0&&console.warn("Token sp ht hn trong",Math.floor(E/6e4),"pht"),!0}catch{return f(),!1}return!1},[f]);D.useEffect(()=>{const T=localStorage.getItem(Wo);if(T)try{const S=JSON.parse(T);new Date(S.hetHan)>new Date?(s(S.token),a(S.user),o(S.vaiTros),u(S.quyens)):localStorage.removeItem(Wo)}catch{localStorage.removeItem(Wo)}m(!1)},[]),D.useEffect(()=>{if(r){const T=setInterval(p,EE);return()=>clearInterval(T)}},[r,p]);const N=async(T,S)=>{const w=await df.dangNhap(T,S),_={token:w.token,user:w.nguoiDung,vaiTros:w.vaiTros,quyens:w.quyens,hetHan:w.hetHan};localStorage.setItem(Wo,JSON.stringify(_)),s(w.token),a(w.nguoiDung),o(w.vaiTros),u(w.quyens)},y=async()=>{if(r)try{await df.dangXuat(r)}catch{}f()},g=async()=>{if(r)try{(await df.kiemTraToken(r)).hieu_luc||(f(),window.location.href="/dang-nhap?expired=1")}catch{f()}},b=T=>d.includes(T)||l.includes("ADMIN"),j=T=>l.includes(T);return t.jsx(Uj.Provider,{value:{user:n,token:r,vaiTros:l,quyens:d,isAuthenticated:!!n,isLoading:x,dangNhap:N,dangXuat:y,coQuyen:b,coVaiTro:j,refreshToken:g},children:e})}function is(){const e=D.useContext(Uj);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}function Tt({children:e,quyen:n}){const{isAuthenticated:a,isLoading:r,coQuyen:s}=is();return r?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):a?n&&!s(n)?t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[t.jsx("h3",{className:"text-lg font-medium text-red-800",children:"Khng c quyn truy cp"}),t.jsx("p",{className:"text-red-600 mt-2",children:"Bn khng c quyn truy cp trang ny."})]}):t.jsx(t.Fragment,{children:e}):(window.location.href="/dang-nhap",null)}const hf=8,AE="payroll_favorites_";function Kj(){const{user:e,coQuyen:n,coVaiTro:a}=is(),[r,s]=D.useState([]),l=e?`${AE}${e.id}`:null;D.useEffect(()=>{if(l){const f=localStorage.getItem(l);if(f)try{const p=JSON.parse(f);Array.isArray(p)&&s(p)}catch{}}},[l]);const o=D.useCallback(f=>{l&&localStorage.setItem(l,JSON.stringify(f))},[l]),d=D.useCallback(f=>{s(p=>{let N;if(p.includes(f))N=p.filter(y=>y!==f);else{if(p.length>=hf)return p;N=[...p,f]}return o(N),N})},[o]),u=D.useCallback(f=>r.includes(f),[r]),x=r.length>=hf,m=D.useCallback(f=>!f||f.length===0||a("ADMIN")?!0:f.some(p=>n(p)||a(p)),[n,a]);return{favorites:r,toggleFavorite:d,isFavorite:u,isFull:x,maxFavorites:hf,filterByPermission:m}}const yp=[{id:"trang-chu",title:"",collapsible:!1,items:[{id:"trang-chu",label:"Trang ch",icon:Y0,path:"/",tags:["dashboard","home","tng quan"]},{id:"cong-nhan-vien",label:"Cng nhn vin",icon:c0,path:"/portal",tags:["portal","employee","self-service","mobile","pwa"],badge:"Mi"}]},{id:"cham-cong",title:"Chm cng",collapsible:!0,color:"teal",items:[{id:"cham-cong-menu",label:"Chm cng",icon:an,path:"/cham-cong",requiredPermissions:["CHAM_CONG_VIEW"],tags:["attendance","timesheet","gi lm"]},{id:"bang-cong-thang",label:"Bng cng thng",icon:rf,path:"/timesheet",requiredPermissions:["CHAM_CONG_VIEW"],tags:["timesheet","monthly","bng cng"]},{id:"xep-ca",label:"Xp ca",icon:Lt,requiredPermissions:["PHAN_CA_VIEW"],tags:["scheduling","shift","ca lm vic"],children:[{id:"danh-muc-ca",label:"Danh mc ca",icon:fj,path:"/xep-ca/danh-muc-ca",tags:["shift","ca"]},{id:"lich-phan-ca",label:"Lch phn ca",icon:rf,path:"/xep-ca/lich-phan-ca",tags:["schedule","calendar","lch"]}]},{id:"nghi-phep",label:"Ngh php",icon:N_,requiredPermissions:["NGHI_PHEP_VIEW"],tags:["leave","off","ngh"],children:[{id:"don-cua-toi",label:"n ngh ca ti",icon:ma,path:"/nghi-phep/don-cua-toi",tags:["my leave","n ca ti"]},{id:"duyet-nghi-phep",label:"Duyt ngh php",icon:Gn,path:"/nghi-phep/duyet",requiredPermissions:["NGHI_PHEP_DUYET"],tags:["approve","duyt"]},{id:"lich-nghi",label:"Lch ngh php",icon:rf,path:"/nghi-phep/lich",tags:["calendar","lch"]},{id:"loai-nghi",label:"Danh mc loi ngh",icon:P_,path:"/nghi-phep/loai-nghi",requiredPermissions:["ADMIN"],tags:["category","loi"]}]},{id:"yeu-cau",label:"Yu cu",icon:k_,requiredPermissions:["YEU_CAU_VIEW"],tags:["request","OT","tr gi","v sm","cng tc"],children:[{id:"don-yeu-cau-cua-toi",label:"n ca ti",icon:bu,path:"/yeu-cau/don-cua-toi",tags:["my request","n ca ti"]},{id:"duyet-yeu-cau",label:"Duyt yu cu",icon:Gn,path:"/yeu-cau/duyet",requiredPermissions:["YEU_CAU_DUYET_CAP_1","YEU_CAU_DUYET_CAP_2"],tags:["approve","duyt"]}]}]},{id:"ky-luong",title:"K lng",collapsible:!0,color:"blue",items:[{id:"bang-luong",label:"Bng lng",icon:ei,path:"/bang-luong",requiredPermissions:["BANG_LUONG_VIEW"],tags:["payroll","salary sheet","bng tnh"]},{id:"cau-hinh-cot-bang-luong",label:"Cu hnh ct",icon:ts,path:"/cau-hinh/bang-luong",requiredPermissions:["BANG_LUONG_VIEW"],tags:["column","config","cu hnh","ct"]}]},{id:"ung-luong",title:"ng lng",collapsible:!0,color:"purple",items:[{id:"bang-ung-luong",label:"Bng ng lng",icon:sg,path:"/ung-luong",requiredPermissions:["UNG_LUONG_VIEW"],tags:["advance","tm ng"]},{id:"cau-hinh-cot-ung-luong",label:"Cu hnh ct",icon:ts,path:"/cau-hinh/ung-luong",requiredPermissions:["UNG_LUONG_VIEW"],tags:["column","config","cu hnh","ct"]}]},{id:"so-luong",title:"S lng",collapsible:!0,color:"green",items:[{id:"so-luong-nhan-vien",label:"S lng nhn vin",icon:y_,path:"/so-luong/nhan-vien",requiredPermissions:["SO_LUONG_VIEW"],tags:["employee salary book","s lng"]},{id:"so-luong-phong-ban",label:"S lng phng ban",icon:lj,path:"/so-luong/phong-ban",requiredPermissions:["SO_LUONG_VIEW"],tags:["department salary","bo co phng ban"]}]},{id:"co-cau-luong",title:"C cu lng",collapsible:!0,color:"orange",items:[{id:"khoan-luong",label:"Khon lng",icon:U_,path:"/khoan-luong",requiredPermissions:["KHOAN_LUONG_VIEW"],tags:["salary component","thnh phn lng"]},{id:"quy-che",label:"Quy ch lng",icon:z_,path:"/quy-che",requiredPermissions:["QUY_CHE_VIEW"],tags:["rule","engine","cng thc","quy tc"]},{id:"su-kien",label:"S kin thng/pht",icon:ig,path:"/su-kien",requiredPermissions:["SU_KIEN_VIEW"],tags:["bonus","penalty","thng","pht"]}]},{id:"san-luong",title:"Sn lng",collapsible:!0,color:"emerald",items:[{id:"tra-cuu-san-luong",label:"Tra cu sn lng",icon:Vr,path:"/san-luong",requiredPermissions:["SAN_LUONG_VIEW"],tags:["tra cu","search","xem"]},{id:"import-chia-hang",label:"Chia hng",icon:J0,path:"/import-chia-hang",requiredPermissions:["SAN_LUONG_VIEW"],tags:["sorting","phn loi"]},{id:"import-giao-hang",label:"Giao hng",icon:Z0,path:"/import-giao-hang",requiredPermissions:["SAN_LUONG_VIEW"],tags:["delivery","vn chuyn"]},{id:"lich-su-import",label:"Lch s Import",icon:gu,path:"/lich-su-import",requiredPermissions:["SAN_LUONG_VIEW"],tags:["history","lch s"]},{id:"don-gia-san-luong",label:"n gi sn lng",icon:gr,path:"/san-luong/don-gia",requiredPermissions:["SAN_LUONG_VIEW"],tags:["n gi","pricing","cu hnh"]}]},{id:"du-lieu",title:"D liu",collapsible:!0,color:"slate",items:[{id:"nhan-vien",label:"Nhn vin",icon:Y_,path:"/nhan-vien",requiredPermissions:["NHAN_VIEN_VIEW"],tags:["employee","staff","nhn s"]},{id:"phong-ban",label:"Phng ban",icon:hj,path:"/phong-ban",requiredPermissions:["PHONG_BAN_VIEW"],tags:["department","t chc"]},{id:"nhom-nhan-vien",label:"Nhm nhn vin",icon:y0,path:"/nhom-nhan-vien",requiredPermissions:["NHOM_NV_VIEW"],tags:["group","team"]},{id:"kpi",label:"KPI",icon:W_,requiredPermissions:["KPI_VIEW"],tags:["performance","nh gi","hiu sut"],children:[{id:"kpi-template",label:"Template KPI",icon:T_,path:"/kpi/template",tags:["template","mu"]},{id:"kpi-ky-danh-gia",label:"K nh gi",icon:ij,path:"/kpi/ky-danh-gia",tags:["period","k"]},{id:"kpi-cau-hinh-thuong",label:"Cu hnh thng",icon:gr,path:"/kpi/cau-hinh-thuong",tags:["bonus","thng"]}]}]},{id:"thiet-lap",title:"Thit lp h thng",collapsible:!0,color:"cyan",items:[{id:"cai-dat",label:"Ci t h thng",icon:ts,path:"/cai-dat",requiredPermissions:["ADMIN"],tags:["settings","configuration","cu hnh"]},{id:"nguoi-dung",label:"Ngi dng",icon:Q_,path:"/quan-tri/nguoi-dung",requiredPermissions:["ADMIN"],tags:["user","account","ti khon"]},{id:"audit-log",label:"Nht k h thng",icon:$_,path:"/quan-tri/audit-log",requiredPermissions:["ADMIN"],tags:["log","history","nht k"]}]}];function zj(e){const n=[];for(const a of e)for(const r of a.items)n.push(r),r.children&&n.push(...r.children);return n}function FE({isOpen:e,isCollapsed:n,onToggleCollapse:a}){var q;const r=As(),{coQuyen:s,coVaiTro:l,user:o,dangXuat:d}=is(),{favorites:u,toggleFavorite:x,isFavorite:m,isFull:f}=Kj(),[p,N]=D.useState(["trang-chu","ky-luong","ung-luong"]),[y,g]=D.useState([]),[b,j]=D.useState(""),T=D.useCallback(J=>!J||J.length===0||l("ADMIN")?!0:J.some(B=>s(B)||l(B)),[s,l]),S=D.useCallback(J=>J.filter(B=>T(B.requiredPermissions)).map(B=>({...B,children:B.children?S(B.children):void 0})).filter(B=>!B.children||B.children.length>0),[T]),w=D.useCallback((J,B)=>{var Z;const ue=B.toLowerCase(),te=[];for(const Q of J){const fe=Q.label.toLowerCase().includes(ue),K=(Z=Q.tags)==null?void 0:Z.some(X=>X.toLowerCase().includes(ue)),L=Q.children?w(Q.children,B):[];(fe||K||L.length>0)&&te.push({...Q,children:L.length>0?L:Q.children})}return te},[]),_=D.useMemo(()=>{let J=yp.map(B=>({...B,items:S(B.items)})).filter(B=>B.items.length>0);return b&&(J=J.map(B=>({...B,items:w(B.items,b)})).filter(B=>B.items.length>0)),J},[S,w,b]),E=D.useMemo(()=>{if(u.length===0)return null;const J=zj(yp),B=u.map(ue=>J.find(te=>te.id===ue)).filter(ue=>!!ue&&T(ue.requiredPermissions));return B.length===0?null:{id:"favorites",title:"Yu thch",items:B}},[u,T]),C=J=>{N(B=>B.includes(J)?B.filter(ue=>ue!==J):[...B,J])},P=J=>{g(B=>B.includes(J)?B.filter(ue=>ue!==J):[...B,J])},F=(J,B)=>{J.preventDefault(),J.stopPropagation(),m(B.id)?(x(B.id),ie.success(` b "${B.label}" khi yu thch`)):f?ie.error("Ch c th ghim ti a 8 mc yu thch"):(x(B.id),ie.success(` thm "${B.label}" vo yu thch`))},R=J=>J.path==="/"?r.pathname==="/":J.path&&r.pathname.startsWith(J.path),O=(J,B=0)=>{var X;const ue=J.icon,te=J.children&&J.children.length>0,Z=y.includes(J.id),Q=R(J),fe=m(J.id),K=t.jsxs(t.Fragment,{children:[t.jsx("div",{className:`
          flex items-center justify-center w-9 h-9 rounded-xl transition-all
          ${Q?"bg-accent/20":"bg-transparent"}
        `,children:t.jsx(ue,{size:B>0?16:18,className:Q?"text-accent":"text-sidebar-muted",strokeWidth:Q?2.5:2})}),!n&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:`
              flex-1 truncate text-sm transition-colors
              ${Q?"text-white font-medium":"text-sidebar-muted"}
            `,children:J.label}),J.path&&t.jsx("button",{onClick:I=>F(I,J),className:`
                  p-1.5 rounded-lg opacity-0 group-hover:opacity-100 transition-all
                  ${fe?"opacity-100 text-yellow-400":"text-sidebar-muted hover:text-yellow-400"}
                  hover:bg-white/5
                `,title:fe?"B yu thch":"Thm vo yu thch",children:t.jsx(b0,{size:14,fill:fe?"currentColor":"none"})}),te&&t.jsx(Ja,{size:16,className:`text-sidebar-muted transition-transform ${Z?"rotate-180":""}`})]})]}),L=`
      group flex items-center gap-3 px-2 py-1.5 mx-2 rounded-xl transition-all duration-200
      ${Q?"bg-white/5 border border-accent/50 text-white":"hover:bg-white/5 border border-transparent"}
      ${B>0?"ml-4":""}
    `;return te?t.jsxs("div",{children:[t.jsx("button",{onClick:()=>P(J.id),className:L,style:{width:"calc(100% - 16px)"},title:n?J.label:void 0,children:K}),Z&&!n&&t.jsx("div",{className:"mt-1 space-y-0.5 ml-4 border-l border-white/10 pl-2",children:(X=J.children)==null?void 0:X.map(I=>O(I,B+1))})]},J.id):t.jsx(ua,{to:J.path||"#",className:L,title:n?J.label:void 0,children:K},J.id)},M=(J,B)=>{const ue=p.includes(J.id);return t.jsxs("div",{className:"mb-2",children:[!n&&t.jsxs("button",{onClick:()=>C(J.id),className:`
              w-full flex items-center justify-between px-4 py-2 
              text-[11px] font-semibold uppercase tracking-wider text-sidebar-muted
              hover:text-white/80 transition-colors
            `,children:[t.jsxs("span",{className:"flex items-center gap-2",children:[B&&t.jsx(b0,{size:12,className:"text-yellow-400",fill:"currentColor"}),J.title]}),t.jsx(qn,{size:12,className:`transition-transform ${ue?"rotate-90":""}`})]}),(ue||n)&&t.jsx("div",{className:"space-y-0.5",children:J.items.map(te=>O(te,0))})]},J.id)};return e?t.jsxs("aside",{className:`
        fixed left-0 top-0 bottom-0 z-50
        flex flex-col
        transition-all duration-300 ease-out
        ${n?"w-[72px]":"w-[260px]"}
      `,style:{background:"linear-gradient(180deg, #0B1220 0%, #0F1B2E 100%)",borderRadius:"0 32px 32px 0",margin:"12px 0 12px 12px",height:"calc(100vh - 24px)",boxShadow:"0 0 40px rgba(0, 0, 0, 0.3)"},children:[t.jsxs("div",{className:`
        flex items-center gap-3 px-5 py-6 border-b border-white/5
        ${n?"justify-center":""}
      `,children:[t.jsx("div",{className:`
          w-10 h-10 rounded-xl bg-gradient-to-br from-accent to-accent2 
          flex items-center justify-center shadow-glow-accent
        `,children:t.jsx(ig,{size:22,className:"text-sidebar-solid",strokeWidth:2.5})}),!n&&t.jsxs("div",{children:[t.jsx("h1",{className:"text-white font-bold text-lg tracking-tight",children:"HRM"}),t.jsx("p",{className:"text-sidebar-muted text-xs",children:"Qun l NS & Tnh lng"})]})]}),!n&&t.jsx("div",{className:"px-4 py-3",children:t.jsxs("div",{className:"relative",children:[t.jsx(Vr,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-sidebar-muted"}),t.jsx("input",{type:"text",value:b,onChange:J=>j(J.target.value),placeholder:"Tm nhanh (Ctrl+K)",className:`
                w-full pl-9 pr-8 py-2.5 text-sm rounded-xl
                bg-white/5 border border-white/10
                text-white placeholder:text-sidebar-muted
                focus:outline-none focus:ring-2 focus:ring-accent/50 focus:border-accent/50
                transition-all
              `}),b&&t.jsx("button",{onClick:()=>j(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-sidebar-muted hover:text-white",children:t.jsx(mn,{size:16})})]})}),t.jsxs("nav",{className:"flex-1 py-2 overflow-y-auto overflow-x-hidden scrollbar-thin",children:[E&&!b&&M(E,!0),E&&!b&&t.jsx("div",{className:"my-3 mx-4 border-t border-white/5"}),_.map(J=>M(J)),b&&_.length===0&&t.jsxs("div",{className:"px-4 py-8 text-center text-sidebar-muted text-sm",children:['Khng tm thy "',b,'"']})]}),t.jsxs("div",{className:"border-t border-white/5 p-3",children:[t.jsxs("div",{className:`flex items-center gap-2 ${n?"flex-col":""}`,children:[t.jsxs(ua,{to:"/ho-so",className:`
              flex items-center gap-3 flex-1 p-2 rounded-xl
              hover:bg-white/5 transition-all group
            `,title:n?(o==null?void 0:o.hoTen)||"H s":void 0,children:[t.jsx("div",{className:`
              w-9 h-9 rounded-xl bg-gradient-to-br from-purple-500 to-pink-500
              flex items-center justify-center text-white font-semibold text-sm
            `,children:((q=o==null?void 0:o.hoTen)==null?void 0:q.charAt(0))||"U"}),!n&&t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-white text-sm font-medium truncate",children:(o==null?void 0:o.hoTen)||"Ngi dng"}),t.jsx("p",{className:"text-sidebar-muted text-xs truncate",children:(o==null?void 0:o.email)||(o==null?void 0:o.tenDangNhap)})]})]}),t.jsxs("div",{className:`flex gap-1 ${n?"flex-col":""}`,children:[t.jsx(ua,{to:"/cai-dat",className:`
                p-2.5 rounded-xl text-sidebar-muted hover:text-white hover:bg-white/5
                transition-all
              `,title:"Ci t",children:t.jsx(ts,{size:18})}),t.jsx("button",{onClick:d,className:`
                p-2.5 rounded-xl text-sidebar-muted hover:text-red-400 hover:bg-red-500/10
                transition-all
              `,title:"ng xut",children:t.jsx(ng,{size:18})})]})]}),t.jsx("button",{onClick:a,className:`
            w-full mt-3 flex items-center justify-center gap-2 py-2.5 rounded-xl
            text-sidebar-muted hover:text-white hover:bg-white/5
            transition-all text-sm
          `,children:n?t.jsx(qn,{size:18}):t.jsxs(t.Fragment,{children:[t.jsx(Nr,{size:18}),t.jsx("span",{children:"Thu gn"})]})})]})]}):null}const vp=[{path:"/",label:"Trang ch",group:"Tng quan",quickActions:[{id:"tao-ky-luong",label:"To k lng",icon:Dt,type:"route",to:"/bang-luong?action=create",requiredPermissions:["BANG_LUONG_CREATE"]},{id:"import-excel",label:"Import Excel",icon:Ts,type:"route",to:"/import-excel",requiredPermissions:["IMPORT_EXCEL"]}]},{path:"/nhan-vien",label:"Nhn vin",group:"D liu u vo",quickActions:[{id:"them-nhan-vien",label:"Thm nhn vin",icon:Dt,type:"callback",callbackKey:"OPEN_ADD_NHAN_VIEN_MODAL",requiredPermissions:["NHAN_VIEN_CREATE"]},{id:"xuat-excel-nv",label:"Xut Excel",icon:ws,type:"callback",callbackKey:"EXPORT_NHAN_VIEN_EXCEL"}]},{path:"/nhan-vien/:id",label:"Chi tit nhn vin",parent:"/nhan-vien",dynamicLabel:e=>`Nhn vin #${e.id}`},{path:"/phong-ban",label:"Phng ban",group:"D liu u vo",quickActions:[{id:"them-phong-ban",label:"Thm phng ban",icon:Dt,type:"callback",callbackKey:"OPEN_ADD_PHONG_BAN_MODAL",requiredPermissions:["PHONG_BAN_CREATE"]}]},{path:"/nhom-nhan-vien",label:"Nhm nhn vin",group:"D liu u vo"},{path:"/cham-cong",label:"Chm cng",group:"D liu u vo",quickActions:[{id:"import-cham-cong",label:"Import chm cng",icon:Ts,type:"callback",callbackKey:"IMPORT_CHAM_CONG",requiredPermissions:["CHAM_CONG_IMPORT"]},{id:"tong-hop-ngay-cong",label:"Tng hp ngy cng",icon:ob,type:"callback",callbackKey:"TONG_HOP_NGAY_CONG"}]},{path:"/nghi-phep/don-cua-toi",label:"n ngh ca ti",group:"Ngh php",quickActions:[{id:"tao-don-nghi",label:"To n ngh",icon:Dt,type:"callback",callbackKey:"OPEN_TAO_DON_NGHI_MODAL"}]},{path:"/nghi-phep/duyet",label:"Duyt ngh php",group:"Ngh php",requiredPermissions:["NGHI_PHEP_DUYET"]},{path:"/nghi-phep/lich",label:"Lch ngh php",group:"Ngh php"},{path:"/nghi-phep/loai-nghi",label:"Danh mc loi ngh",group:"Ngh php",requiredPermissions:["ADMIN"],quickActions:[{id:"them-loai-nghi",label:"Thm loi ngh",icon:Dt,type:"callback",callbackKey:"OPEN_ADD_LOAI_NGHI_MODAL",requiredPermissions:["ADMIN"]}]},{path:"/kpi/template",label:"Template KPI",group:"KPI"},{path:"/kpi/ky-danh-gia",label:"K nh gi",group:"KPI"},{path:"/kpi/cau-hinh-thuong",label:"Cu hnh thng",group:"KPI"},{path:"/import-chia-hang",label:"Chia hng",group:"Sn lng",quickActions:[{id:"import-chia-hang",label:"Import file",icon:Ts,type:"callback",callbackKey:"IMPORT_CHIA_HANG"}]},{path:"/import-giao-hang",label:"Giao hng",group:"Sn lng",quickActions:[{id:"import-giao-hang",label:"Import file",icon:Ts,type:"callback",callbackKey:"IMPORT_GIAO_HANG"}]},{path:"/lich-su-import",label:"Lch s Import",group:"Sn lng"},{path:"/import-excel",label:"Import Excel",group:"D liu u vo"},{path:"/quy-che",label:"Quy ch lng",group:"Tnh lng",quickActions:[{id:"tao-rule",label:"To rule mi",icon:Dt,type:"callback",callbackKey:"OPEN_TAO_RULE_MODAL",requiredPermissions:["QUY_CHE_CREATE"]},{id:"preview-rule",label:"Preview",icon:hp,type:"route",to:"/rule-trace"}]},{path:"/quy-che/:id",label:"Chi tit quy ch",parent:"/quy-che",dynamicLabel:e=>`Quy ch #${e.id}`},{path:"/khoan-luong",label:"Khon lng",group:"Tnh lng",quickActions:[{id:"them-khoan-luong",label:"Thm khon lng",icon:Dt,type:"callback",callbackKey:"OPEN_ADD_KHOAN_LUONG_MODAL",requiredPermissions:["KHOAN_LUONG_CREATE"]}]},{path:"/su-kien",label:"S kin thng/pht",group:"Tnh lng"},{path:"/bang-luong",label:"Bng lng",group:"K lng",quickActions:[{id:"tao-bang-luong",label:"To bng lng",icon:Dt,type:"callback",callbackKey:"OPEN_TAO_BANG_LUONG_MODAL",requiredPermissions:["BANG_LUONG_CREATE"]}]},{path:"/bang-luong/:id",label:"Chi tit bng lng",parent:"/bang-luong",dynamicLabel:e=>`Bng lng #${e.id}`,quickActions:[{id:"snapshot",label:"Snapshot",icon:j_,type:"callback",callbackKey:"SNAPSHOT_BANG_LUONG"},{id:"chay-rule",label:"Chy Rule",icon:hp,type:"callback",callbackKey:"RUN_RULE_ENGINE",requiredPermissions:["BANG_LUONG_TINH"]},{id:"tinh-lai",label:"Tnh li",icon:yr,type:"callback",callbackKey:"TINH_LAI_LUONG"},{id:"chot-ky",label:"Cht k",icon:Gn,type:"callback",callbackKey:"CHOT_KY_LUONG",requiredPermissions:["BANG_LUONG_CHOT"]},{id:"khoa-ky",label:"Kho k",icon:ti,type:"callback",callbackKey:"KHOA_KY_LUONG",danger:!0,confirmMessage:"Kho vnh vin k lng ny? Sau khi kho s khng th m li.",confirmKeyword:"KHOA",requiredPermissions:["BANG_LUONG_KHOA"]},{id:"mo-khoa",label:"M kho",icon:rg,type:"callback",callbackKey:"MO_KHOA_BANG_LUONG",requiredPermissions:["BANG_LUONG_KHOA"]},{id:"xuat-excel",label:"Xut Excel",icon:ws,type:"callback",callbackKey:"EXPORT_BANG_LUONG_EXCEL"},{id:"gui-phieu-luong",label:"Gi phiu lng",icon:bu,type:"callback",callbackKey:"GUI_PHIEU_LUONG_TAT_CA"}]},{path:"/ung-luong",label:"Bng ng lng",group:"ng lng",quickActions:[{id:"tao-bang-ung",label:"To bng ng",icon:Dt,type:"callback",callbackKey:"OPEN_TAO_BANG_UNG_MODAL",requiredPermissions:["UNG_LUONG_CREATE"]}]},{path:"/ung-luong/:id",label:"Chi tit bng ng lng",parent:"/ung-luong",dynamicLabel:e=>`Bng ng #${e.id}`,quickActions:[{id:"tinh-eligibility",label:"Tnh eligibility",icon:ob,type:"callback",callbackKey:"TINH_ELIGIBILITY_UNG_LUONG"},{id:"chot-bang-ung",label:"Cht",icon:Gn,type:"callback",callbackKey:"CHOT_BANG_UNG_LUONG",requiredPermissions:["UNG_LUONG_CHOT"]},{id:"xuat-excel-ung",label:"Xut Excel",icon:ws,type:"callback",callbackKey:"EXPORT_UNG_LUONG_EXCEL"}]},{path:"/so-luong/nhan-vien",label:"S lng nhn vin",group:"Bo co",quickActions:[{id:"xuat-so-luong-nv",label:"Xut Excel",icon:ws,type:"callback",callbackKey:"EXPORT_SO_LUONG_NV"}]},{path:"/so-luong/phong-ban",label:"S lng phng ban",group:"Bo co",quickActions:[{id:"xuat-so-luong-pb",label:"Xut Excel",icon:ws,type:"callback",callbackKey:"EXPORT_SO_LUONG_PB"}]},{path:"/cai-dat",label:"Ci t h thng",group:"Thit lp",requiredPermissions:["ADMIN"]},{path:"/quan-tri/nguoi-dung",label:"Ngi dng",group:"Qun tr",requiredPermissions:["ADMIN"],quickActions:[{id:"them-nguoi-dung",label:"Thm ngi dng",icon:Dt,type:"callback",callbackKey:"OPEN_ADD_NGUOI_DUNG_MODAL",requiredPermissions:["ADMIN"]}]},{path:"/quan-tri/audit-log",label:"Audit Log",group:"Qun tr",requiredPermissions:["ADMIN"]},{path:"/rule-trace",label:"Rule Trace",group:"Tnh lng"}];function bp(e){const n=vp.find(a=>a.path===e);if(n)return n;for(const a of vp)if(a.path.includes(":")){const r=a.path.replace(/:[^/]+/g,"[^/]+");if(new RegExp(`^${r}$`).test(e))return a}}function LE(e,n){const a={},r=n.split("/"),s=e.split("/");for(let l=0;l<r.length;l++)if(r[l].startsWith(":")){const o=r[l].slice(1);a[o]=s[l]}return a}function PE(){const e=As(),n=D.useMemo(()=>{const a=[];e.pathname!=="/"&&a.push({label:"Trang ch",path:"/"});const r=bp(e.pathname);if(!r)return a;if(r.group&&r.group!=="Tng quan"&&a.push({label:r.group}),r.parent){const l=bp(r.parent);l&&a.push({label:l.label,path:l.path})}let s=r.label;if(r.dynamicLabel&&r.path.includes(":")){const l=LE(e.pathname,r.path);s=r.dynamicLabel(l)}return a.push({label:s}),a},[e.pathname]);return n.length<=1&&e.pathname==="/"?null:t.jsx("nav",{className:"flex items-center gap-1",children:n.map((a,r)=>{const s=r===n.length-1,l=r===0;return t.jsxs("div",{className:"flex items-center",children:[r>0&&t.jsx(qn,{size:14,className:"mx-1.5 text-text-muted"}),a.path&&!s?t.jsxs(ua,{to:a.path,className:`
                  flex items-center gap-1.5 px-2 py-1 rounded-lg
                  text-text-secondary text-sm
                  hover:text-text hover:bg-panel
                  transition-all
                `,children:[l&&t.jsx(Y0,{size:14}),t.jsx("span",{children:a.label})]}):t.jsx("span",{className:`
                  px-2 py-1 rounded-lg text-sm
                  ${s?"text-text font-medium bg-panel border border-border":"text-text-muted"}
                  max-w-[200px] truncate
                `,title:a.label,children:a.label})]},r)})})}const IE=[{id:1,type:"success",title:"Bng lng  tnh xong",message:"Bng lng thng 01/2026  c tnh ton thnh cng",time:"5 pht trc",read:!1},{id:2,type:"warning",title:"Cn duyt ng lng",message:"C 3 yu cu ng lng ch duyt",time:"1 gi trc",read:!1},{id:3,type:"info",title:"Import sn lng",message:"File chia hng thng 01  c import",time:"2 gi trc",read:!0}];function OE({sidebarCollapsed:e}){const[n,a]=D.useState(!1),[r,s]=D.useState(IE),l=D.useRef(null),o=r.filter(p=>!p.read).length;D.useEffect(()=>{const p=N=>{l.current&&!l.current.contains(N.target)&&a(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]);const d=p=>{s(N=>N.map(y=>y.id===p?{...y,read:!0}:y))},u=()=>{s(p=>p.map(N=>({...N,read:!0})))},x=()=>{s([])},m=p=>{switch(p){case"success":return t.jsx(cj,{size:16,className:"text-green-500"});case"warning":return t.jsx(sa,{size:16,className:"text-amber-500"});default:return t.jsx(yu,{size:16,className:"text-blue-500"})}},f=()=>{window.dispatchEvent(new CustomEvent("open-command-palette"))};return t.jsxs("header",{className:`
        fixed top-0 right-0 z-40
        h-16 flex items-center justify-between gap-4
        px-6 transition-all duration-300
        bg-bg-main/80 backdrop-blur-md
      `,style:{left:e?"96px":"284px"},children:[t.jsx("div",{className:"flex items-center gap-4",children:t.jsx(PE,{})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:f,className:`
            flex items-center gap-2 px-3 py-2 rounded-xl
            bg-panel border border-border
            text-text-secondary text-sm
            hover:bg-panel-hover hover:border-border-hover
            transition-all
            backdrop-blur-xl
          `,title:"Tm kim nhanh (Ctrl+K)",children:[t.jsx(Vr,{size:16}),t.jsx("span",{className:"hidden md:inline",children:"Tm kim..."}),t.jsxs("kbd",{className:`
            hidden md:inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded
            bg-bg-2 text-text-muted text-xs font-mono
          `,children:[t.jsx(S_,{size:10}),"K"]})]}),t.jsxs("div",{className:"relative",ref:l,children:[t.jsxs("button",{onClick:()=>a(!n),className:`
              relative p-2.5 rounded-xl
              bg-panel border border-border
              text-text-secondary
              hover:bg-panel-hover hover:text-text
              transition-all
              backdrop-blur-xl
            `,title:"Thng bo",children:[t.jsx(jc,{size:18}),o>0&&t.jsx("span",{className:`
                absolute -top-1 -right-1 min-w-[18px] h-[18px] 
                flex items-center justify-center
                bg-accent text-white text-xs font-medium
                rounded-full px-1
              `,children:o>9?"9+":o})]}),n&&t.jsxs("div",{className:`
              absolute top-full right-0 mt-2 w-80
              bg-panel border border-border rounded-xl
              shadow-xl overflow-hidden
              animate-in fade-in slide-in-from-top-2 duration-200
            `,children:[t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[t.jsx("h3",{className:"font-semibold text-text",children:"Thng bo"}),t.jsxs("div",{className:"flex items-center gap-2",children:[o>0&&t.jsx("button",{onClick:u,className:"text-xs text-accent hover:text-accent/80 transition-colors",title:"nh du tt c  c",children:t.jsx(Br,{size:14})}),r.length>0&&t.jsx("button",{onClick:x,className:"text-xs text-text-muted hover:text-text transition-colors",title:"Xa tt c",children:t.jsx(mn,{size:14})})]})]}),t.jsx("div",{className:"max-h-80 overflow-y-auto",children:r.length===0?t.jsxs("div",{className:"px-4 py-8 text-center text-text-muted",children:[t.jsx(jc,{size:32,className:"mx-auto mb-2 opacity-50"}),t.jsx("p",{children:"Khng c thng bo"})]}):r.map(p=>t.jsx("div",{onClick:()=>d(p.id),className:`
                        px-4 py-3 border-b border-border/50 last:border-0
                        hover:bg-panel-hover cursor-pointer transition-colors
                        ${p.read?"":"bg-accent/5"}
                      `,children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{className:"mt-0.5",children:m(p.type)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsx("p",{className:`text-sm font-medium ${p.read?"text-text-secondary":"text-text"}`,children:p.title}),!p.read&&t.jsx("span",{className:"w-2 h-2 bg-accent rounded-full flex-shrink-0 mt-1.5"})]}),t.jsx("p",{className:"text-xs text-text-muted mt-0.5 line-clamp-2",children:p.message}),t.jsx("p",{className:"text-xs text-text-muted/70 mt-1",children:p.time})]})]})},p.id))}),r.length>0&&t.jsx("div",{className:"px-4 py-2 border-t border-border bg-bg-2/50",children:t.jsx("button",{className:"w-full text-center text-xs text-accent hover:text-accent/80 py-1",children:"Xem tt c thng bo"})})]})]})]})]})}const ME=10,RE="payroll_recent_";function $j(){const{user:e}=is(),n=As(),[a,r]=D.useState([]),s=e?`${RE}${e.id}`:null;D.useEffect(()=>{if(s){const u=localStorage.getItem(s);if(u)try{const x=JSON.parse(u);Array.isArray(x)&&r(x)}catch{}}},[s]);const l=D.useCallback(u=>{s&&localStorage.setItem(s,JSON.stringify(u))},[s]);D.useEffect(()=>{if(!s)return;const u=bp(n.pathname);if(!u||n.pathname==="/dang-nhap")return;const x={path:n.pathname,title:u.label,time:Date.now()};r(m=>{const f=m.filter(N=>N.path!==x.path),p=[x,...f].slice(0,ME);return l(p),p})},[n.pathname,s,l]);const o=D.useCallback(u=>{r(x=>{const m=x.filter(f=>f.path!==u);return l(m),m})},[l]),d=D.useCallback(()=>{r([]),s&&localStorage.removeItem(s)},[s]);return{recentPages:a,removeRecent:o,clearRecent:d}}class BE{constructor(){Qm(this,"handlers",new Map);Qm(this,"listeners",new Set)}register(n,a){return this.handlers.set(n,a),this.notifyListeners(),()=>this.unregister(n)}unregister(n){this.handlers.delete(n),this.notifyListeners()}has(n){return this.handlers.has(n)}async execute(n){const a=this.handlers.get(n);return a?(await a(),!0):(console.warn(`Quick action "${n}" khng c handler ng k`),!1)}getRegisteredKeys(){return Array.from(this.handlers.keys())}subscribe(n){return this.listeners.add(n),()=>this.listeners.delete(n)}notifyListeners(){this.listeners.forEach(n=>n())}}const Gh=new BE;function HE(){const[,e]=D.useState(0);return D.useEffect(()=>{const n=Gh.subscribe(()=>{e(a=>a+1)});return()=>{n()}},[]),{has:n=>Gh.has(n),execute:n=>Gh.execute(n),keys:Gh.getRegisteredKeys()}}function VE({isOpen:e,onClose:n}){const a=br(),{coQuyen:r,coVaiTro:s}=is(),{favorites:l}=Kj(),{recentPages:o}=$j(),d=HE(),[u,x]=D.useState(""),[m,f]=D.useState(0),[p,N]=D.useState(null),[y,g]=D.useState(""),b=D.useRef(null),j=D.useRef(null);D.useEffect(()=>{e&&(x(""),f(0),N(null),setTimeout(()=>{var F;return(F=b.current)==null?void 0:F.focus()},50))},[e]);const T=D.useCallback(F=>!F||F.length===0||s("ADMIN")?!0:F.some(R=>r(R)||s(R)),[r,s]),S=D.useMemo(()=>{const F=[],R=zj(yp),O=u.toLowerCase();if(!u&&l.length>0){const J=l.map(B=>R.find(ue=>ue.id===B)).filter(B=>!!B&&T(B.requiredPermissions)).map(B=>({id:`fav-${B.id}`,type:"favorite",label:B.label,icon:t.jsx(B.icon,{size:16}),path:B.path}));J.length>0&&F.push({id:"favorites",title:"Yu thch",icon:t.jsx(b0,{size:14}),items:J})}if(!u&&o.length>0){const J=o.slice(0,5).map(B=>({id:`recent-${B.path}`,type:"recent",label:B.title,description:B.path,icon:t.jsx(an,{size:16}),path:B.path}));J.length>0&&F.push({id:"recent",title:"Gn y",icon:t.jsx(an,{size:14}),items:J})}const M=R.filter(J=>{var B;return!J.path||!T(J.requiredPermissions)?!1:u?J.label.toLowerCase().includes(O)||((B=J.tags)==null?void 0:B.some(ue=>ue.toLowerCase().includes(O))):!0}).map(J=>({id:`route-${J.id}`,type:"route",label:J.label,icon:t.jsx(J.icon,{size:16}),path:J.path}));M.length>0&&F.push({id:"routes",title:"i ti",icon:t.jsx(wc,{size:14}),items:u?M.slice(0,8):M.slice(0,5)});const q=[];for(const J of vp)if(J.quickActions)for(const B of J.quickActions){if(!T(B.requiredPermissions))continue;(!u||B.label.toLowerCase().includes(O)||J.label.toLowerCase().includes(O))&&q.push({id:`action-${J.path}-${B.id}`,type:"action",label:B.label,description:`trong ${J.label}`,icon:t.jsx(B.icon,{size:16}),action:B,danger:B.danger})}return q.length>0&&F.push({id:"actions",title:"Thao tc nhanh",icon:t.jsx(ig,{size:14}),items:u?q.slice(0,8):q.slice(0,5)}),s("ADMIN")&&!u&&F.push({id:"admin",title:"Qun tr",icon:t.jsx(ts,{size:14}),items:[{id:"admin-users",type:"route",label:"Qun l ngi dng",icon:t.jsx(ts,{size:16}),path:"/quan-tri/nguoi-dung"},{id:"admin-audit",type:"route",label:"Audit Log",icon:t.jsx(ts,{size:16}),path:"/quan-tri/audit-log"}]}),F},[u,l,o,T,s]),w=D.useMemo(()=>S.flatMap(F=>F.items),[S]);D.useEffect(()=>{const F=document.querySelector(`[data-index="${m}"]`);F==null||F.scrollIntoView({block:"nearest"})},[m]);const _=F=>{if(p){F.key==="Escape"?(N(null),g("")):F.key==="Enter"&&(!p.confirmKeyword||y.toUpperCase()===p.confirmKeyword.toUpperCase())&&(E(p),N(null),g(""));return}switch(F.key){case"ArrowDown":F.preventDefault(),f(R=>Math.min(R+1,w.length-1));break;case"ArrowUp":F.preventDefault(),f(R=>Math.max(R-1,0));break;case"Enter":F.preventDefault(),w[m]&&C(w[m]);break;case"Escape":n();break}},E=async F=>{n(),F.type==="route"&&F.to?a(F.to):F.type==="callback"&&F.callbackKey&&await d.execute(F.callbackKey)},C=F=>{if(F.type==="action"&&F.action){if(F.danger&&F.action.confirmKeyword){N(F.action);return}E(F.action)}else F.path&&(n(),a(F.path))},P=F=>u?F.split(new RegExp(`(${u})`,"gi")).map((O,M)=>O.toLowerCase()===u.toLowerCase()?t.jsx("mark",{className:"bg-[#53F39A]/30 text-[#53F39A] px-0.5 rounded",children:O},M):O):F;return e?t.jsxs("div",{className:"fixed inset-0 z-[100] flex items-start justify-center pt-[12vh]",children:[t.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-md",onClick:n}),t.jsx("div",{className:`
          relative w-full max-w-2xl overflow-hidden
          rounded-2xl border border-white/10
          bg-[#0B1220]/95 backdrop-blur-xl
          shadow-2xl shadow-black/40
          animate-fade-in
        `,onKeyDown:_,children:p?t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center gap-3 text-[#FF4D6D] mb-4",children:[t.jsx(sa,{size:24}),t.jsx("h3",{className:"text-lg font-semibold",children:"Xc nhn thao tc"})]}),t.jsx("p",{className:"text-slate-300 mb-4",children:p.confirmMessage||`Bn c chc mun "${p.label}"?`}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("label",{className:"block text-sm text-slate-400 mb-2",children:["G ",t.jsx("span",{className:"font-mono font-bold text-[#FF4D6D]",children:p.confirmKeyword}),"  xc nhn:"]}),t.jsx("input",{type:"text",value:y,onChange:F=>g(F.target.value),className:`
                  w-full px-4 py-3 rounded-xl
                  bg-white/5 border border-white/10
                  text-white placeholder-slate-500
                  focus:outline-none focus:ring-2 focus:ring-[#FF4D6D]/50 focus:border-[#FF4D6D]/50
                `,placeholder:`G ${p.confirmKeyword}...`,autoFocus:!0})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{N(null),g("")},className:"px-4 py-2 text-slate-400 hover:text-white hover:bg-white/10 rounded-xl transition-colors",children:"Hu"}),t.jsx("button",{onClick:()=>{(!p.confirmKeyword||y.toUpperCase()===p.confirmKeyword.toUpperCase())&&(E(p),N(null),g(""))},disabled:!!(p.confirmKeyword&&y.toUpperCase()!==p.confirmKeyword.toUpperCase()),className:"px-4 py-2 bg-[#FF4D6D] text-white rounded-xl hover:bg-[#FF4D6D]/80 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Xc nhn"})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-3 px-5 py-4 border-b border-white/10",children:[t.jsx(Vr,{size:20,className:"text-slate-500"}),t.jsx("input",{ref:b,type:"text",value:u,onChange:F=>{x(F.target.value),f(0)},placeholder:"Tm trang, thao tc...",className:`
                  flex-1 text-lg bg-transparent text-white
                  outline-none placeholder:text-slate-500
                `}),t.jsx("kbd",{className:"hidden sm:inline-flex items-center px-2 py-1 text-xs text-slate-500 bg-white/5 border border-white/10 rounded-lg",children:"ESC"}),t.jsx("button",{onClick:n,className:"p-1 text-slate-500 hover:text-white sm:hidden transition-colors",children:t.jsx(mn,{size:20})})]}),t.jsx("div",{ref:j,className:"max-h-[55vh] overflow-y-auto",children:S.length===0?t.jsxs("div",{className:"px-5 py-10 text-center text-slate-500",children:['Khng tm thy kt qu cho "',u,'"']}):S.map((F,R)=>{const O=S.slice(0,R).reduce((M,q)=>M+q.items.length,0);return t.jsxs("div",{className:"py-2",children:[t.jsxs("div",{className:"flex items-center gap-2 px-5 py-2 text-xs font-semibold text-slate-500 uppercase tracking-wider",children:[F.icon,F.title]}),F.items.map((M,q)=>{const J=O+q,B=J===m;return t.jsxs("button",{"data-index":J,onClick:()=>C(M),onMouseEnter:()=>f(J),className:`
                              w-full flex items-center gap-3 px-5 py-3 text-left transition-all duration-150
                              ${B?"bg-[#53F39A]/10 border-l-2 border-l-[#53F39A]":"border-l-2 border-l-transparent hover:bg-white/5"}
                              ${M.danger?"text-[#FF4D6D]":"text-slate-300"}
                            `,children:[t.jsx("span",{className:`
                              flex-shrink-0 w-8 h-8 rounded-lg flex items-center justify-center
                              ${B?"bg-[#53F39A]/20 text-[#53F39A]":M.danger?"bg-[#FF4D6D]/10 text-[#FF4D6D]":"bg-white/5 text-slate-400"}
                            `,children:M.icon}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:`font-medium ${B?"text-white":""}`,children:P(M.label)}),M.description&&t.jsx("div",{className:"text-xs text-slate-500 truncate",children:M.description})]}),M.type==="favorite"&&t.jsx(b0,{size:14,className:"text-amber-400",fill:"currentColor"})]},M.id)})]},F.id)})}),t.jsxs("div",{className:"flex items-center justify-between px-5 py-3 border-t border-white/10 bg-white/[0.02] text-xs text-slate-500",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("kbd",{className:"px-1.5 py-0.5 bg-white/5 border border-white/10 rounded",children:""}),t.jsx("span",{className:"hidden sm:inline",children:"di chuyn"})]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("kbd",{className:"px-1.5 py-0.5 bg-white/5 border border-white/10 rounded",children:""}),t.jsx("span",{className:"hidden sm:inline",children:"chn"})]})]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("kbd",{className:"px-1.5 py-0.5 bg-white/5 border border-white/10 rounded",children:"esc"}),t.jsx("span",{className:"hidden sm:inline",children:"ng"})]})]})]})})]}):null}function UE(){const[e,n]=D.useState(!1),a=D.useCallback(()=>n(!0),[]),r=D.useCallback(()=>n(!1),[]),s=D.useCallback(()=>n(l=>!l),[]);return D.useEffect(()=>{const l=o=>{(o.ctrlKey||o.metaKey)&&o.key==="k"&&(o.preventDefault(),s())};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[s]),{isOpen:e,open:a,close:r,toggle:s}}function KE(){document.documentElement.setAttribute("data-theme","light");const e=document.querySelector('meta[name="theme-color"]');e&&e.setAttribute("content","#f8fafc")}function zE(){KE()}function $E(){const[e,n]=D.useState(!0),[a,r]=D.useState(!1),s=UE();$j(),D.useEffect(()=>{zE()},[]),D.useEffect(()=>{const u=()=>{window.innerWidth<768?n(!1):window.innerWidth<1024?(n(!0),r(!0)):(n(!0),r(!1))};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),D.useEffect(()=>{const u=()=>s.open();return window.addEventListener("open-command-palette",u),()=>window.removeEventListener("open-command-palette",u)},[s]);const l=()=>{r(!a)},d=(a?72:260)+36;return t.jsxs("div",{className:"min-h-screen",style:{background:"var(--bg-app)"},children:[t.jsx(FE,{isOpen:e,isCollapsed:a,onToggleCollapse:l}),t.jsxs("div",{className:"min-h-screen transition-all duration-300",style:{marginLeft:e?`${d}px`:"24px",paddingRight:"24px"},children:[t.jsx(OE,{onToggleSidebar:l,sidebarCollapsed:a}),t.jsx("main",{className:"pt-20 pb-8",children:t.jsx("div",{className:"animate-fade-in",children:t.jsx(J2,{})})})]}),t.jsx(VE,{isOpen:s.isOpen,onClose:s.close}),e&&t.jsx("div",{className:"fixed inset-0 bg-black/30 z-40 lg:hidden backdrop-blur-sm",onClick:()=>n(!1)})]})}const Gj="tinh_luong_auth",he=Zt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});he.interceptors.request.use(e=>{const n=localStorage.getItem(Gj);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));he.interceptors.response.use(e=>e,e=>{var n;return((n=e.response)==null?void 0:n.status)===401&&(localStorage.removeItem(Gj),window.location.pathname!=="/dang-nhap"&&(window.location.href="/dang-nhap?expired=1")),Promise.reject(e)});const Jt={layTatCa:()=>he.get("/phong-ban").then(e=>e.data),layCayPhongBan:()=>he.get("/phong-ban/cay").then(e=>e.data),layTheoId:e=>he.get(`/phong-ban/${e}`).then(n=>n.data),taoMoi:e=>he.post("/phong-ban",e).then(n=>n.data),capNhat:(e,n)=>he.put(`/phong-ban/${e}`,n).then(a=>a.data),doiPhongBanCha:(e,n)=>he.put(`/phong-ban/${e}/doi-phong-ban-cha`,{phongBanChaId:n}).then(a=>a.data),ngungHoatDong:e=>he.post(`/phong-ban/${e}/ngung-hoat-dong`).then(n=>n.data),kichHoat:e=>he.post(`/phong-ban/${e}/kich-hoat`).then(n=>n.data),xoa:e=>he.delete(`/phong-ban/${e}`).then(n=>n.data),layDonViCon:e=>he.get(`/phong-ban/${e}/don-vi-con`).then(n=>n.data),taoDonViCon:(e,n)=>he.post(`/phong-ban/${e}/don-vi-con`,n).then(a=>a.data),capNhatDonViCon:(e,n)=>he.put(`/don-vi-con/${e}`,n).then(a=>a.data),ngungDonViCon:e=>he.post(`/don-vi-con/${e}/ngung-hoat-dong`).then(n=>n.data)},j0={THU_VIEC:{label:"Th vic",color:"bg-yellow-100 text-yellow-700"},CHINH_THUC:{label:"Chnh thc",color:"bg-green-100 text-green-700"},HOC_VIEC:{label:"Hc vic",color:"bg-blue-100 text-blue-700"},THUC_TAP:{label:"Thc tp",color:"bg-purple-100 text-purple-700"},CONG_TAC_VIEN:{label:"Cng tc vin",color:"bg-indigo-100 text-indigo-700"},THOI_VU:{label:"Thi v",color:"bg-orange-100 text-orange-700"}},ha={layTatCa:e=>he.get("/nhan-vien",{params:e}).then(n=>n.data),layTheoId:e=>he.get(`/nhan-vien/${e}`).then(n=>n.data),layMaTuDong:()=>he.get("/nhan-vien/ma-tu-dong").then(e=>e.data),taoMoi:e=>he.post("/nhan-vien",e).then(n=>n.data),capNhat:(e,n)=>he.put(`/nhan-vien/${e}`,n).then(a=>a.data),xoa:e=>he.delete(`/nhan-vien/${e}`).then(n=>n.data),layLichSuPhongBan:e=>he.get(`/nhan-vien/${e}/lich-su-phong-ban`).then(n=>n.data),chuyenPhongBan:(e,n)=>he.post(`/nhan-vien/${e}/chuyen-phong-ban`,n).then(a=>a.data)},pr={layTatCa:e=>he.get("/khoan-luong",{params:{loai:e}}).then(n=>n.data),layTheoId:e=>he.get(`/khoan-luong/${e}`).then(n=>n.data),taoMoi:e=>he.post("/khoan-luong",e).then(n=>n.data),capNhat:(e,n)=>he.put(`/khoan-luong/${e}`,n).then(a=>a.data),xoa:e=>he.delete(`/khoan-luong/${e}`).then(n=>n.data)},Or={layDanhSach:e=>he.get("/bang-luong",{params:e}).then(n=>n.data),layTheoId:e=>he.get(`/bang-luong/${e}`).then(n=>n.data),taoMoi:e=>he.post("/bang-luong",e).then(n=>n.data),capNhatChiTiet:e=>he.put("/bang-luong/chi-tiet/cap-nhat",e).then(n=>n.data),capNhatNhieuChiTiet:e=>he.put("/bang-luong/chi-tiet/cap-nhat-nhieu",{danhSach:e}).then(n=>n.data),chotBangLuong:(e,n)=>he.post(`/bang-luong/${e}/chot`,n).then(a=>a.data),moKhoa:e=>he.post(`/bang-luong/${e}/mo-khoa`).then(n=>n.data),khoa:e=>he.post(`/bang-luong/${e}/khoa`).then(n=>n.data),xoa:(e,n=!1)=>he.delete(`/bang-luong/${e}`,{params:{force:n?"true":void 0}}).then(a=>a.data),layLichSu:e=>he.get(`/bang-luong/${e}/lich-su`).then(n=>n.data),soSanhExcel:(e,n)=>he.post(`/bang-luong/${e}/so-sanh-excel`,{tongExcel:n}).then(a=>a.data),tinhLaiLuong:e=>he.post(`/bang-luong/${e}/tinh-lai-luong`).then(n=>n.data)},Np={layPhieuLuong:(e,n)=>he.get(`/bang-luong/${e}/phieu-luong/${n}`).then(a=>a.data),layPhieuLuongHtml:(e,n)=>he.get(`/bang-luong/${e}/phieu-luong/${n}/html`).then(a=>a.data),guiPhieuLuong:(e,n)=>he.post(`/bang-luong/${e}/gui-phieu-luong/${n}`).then(a=>a.data),guiTatCa:e=>he.post(`/bang-luong/${e}/gui-tat-ca`).then(n=>n.data)},x0={docHeader:e=>{const n=new FormData;return n.append("file",e),he.post("/import-excel/doc-header",n,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>a.data)},goiYMapping:e=>{const n=new FormData;return n.append("file",e),he.post("/import-excel/goi-y-mapping",n,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>a.data)},import:(e,n,a,r,s)=>{const l=new FormData;return l.append("file",e),l.append("thang",String(n)),l.append("nam",String(a)),l.append("phongBanId",String(r)),l.append("mappings",JSON.stringify(s)),he.post("/import-excel/import",l,{headers:{"Content-Type":"multipart/form-data"}}).then(o=>o.data)},export:(e,n)=>{const a=n?{columns:JSON.stringify(n)}:{};return he.get(`/import-excel/export/${e}`,{responseType:"blob",params:a})}},Xo={layTheoNhanVien:e=>he.get(`/phu-cap-nhan-vien/nhan-vien/${e}`).then(n=>n.data),layHieuLuc:e=>he.get(`/phu-cap-nhan-vien/nhan-vien/${e}/hieu-luc`).then(n=>n.data),layTheoThang:(e,n,a)=>he.get(`/phu-cap-nhan-vien/nhan-vien/${e}/theo-thang`,{params:{thang:n,nam:a}}).then(r=>r.data),layLichSu:(e,n)=>he.get(`/phu-cap-nhan-vien/nhan-vien/${e}/lich-su`,{params:{khoanLuongId:n}}).then(a=>a.data),taoPhuCap:e=>he.post("/phu-cap-nhan-vien",e).then(n=>n.data),ketThuc:(e,n,a)=>he.put(`/phu-cap-nhan-vien/${e}/ket-thuc`,{denNgay:n,nguoiCapNhat:a}).then(r=>r.data),tang:(e,n)=>he.post(`/phu-cap-nhan-vien/${e}/tang`,n).then(a=>a.data),tamDung:e=>he.put(`/phu-cap-nhan-vien/${e}/tam-dung`).then(n=>n.data),kichHoat:e=>he.put(`/phu-cap-nhan-vien/${e}/kich-hoat`).then(n=>n.data),thongKePhongBan:e=>he.get(`/phu-cap-nhan-vien/thong-ke/phong-ban/${e}`).then(n=>n.data)},Eb={layTatCa:e=>he.get(`/bang-luong/${e}/ngay-cong`).then(n=>n.data),layTheoNhanVien:(e,n)=>he.get(`/bang-luong/${e}/ngay-cong/${n}`).then(a=>a.data),khoiTao:e=>he.post(`/bang-luong/${e}/ngay-cong/khoi-tao`).then(n=>n.data),dieuChinh:(e,n,a)=>he.put(`/bang-luong/${e}/ngay-cong/${n}/dieu-chinh`,a).then(r=>r.data),xoaDieuChinh:(e,n)=>he.delete(`/bang-luong/${e}/ngay-cong/${n}/dieu-chinh`).then(a=>a.data)},Db={lay:()=>he.get("/thong-tin-cong-ty").then(e=>e.data),capNhat:e=>he.put("/thong-tin-cong-ty",e).then(n=>n.data)},kd={layTatCa:e=>he.get("/thong-tin-cong-ty/don-gia",{params:{phongBanId:e}}).then(n=>n.data),layTheoId:e=>he.get(`/thong-tin-cong-ty/don-gia/${e}`).then(n=>n.data),taoMoi:e=>he.post("/thong-tin-cong-ty/don-gia",e).then(n=>n.data),capNhat:(e,n)=>he.put(`/thong-tin-cong-ty/don-gia/${e}`,n).then(a=>a.data),xoa:e=>he.delete(`/thong-tin-cong-ty/don-gia/${e}`).then(n=>n.data),khoiTaoMau:()=>he.post("/thong-tin-cong-ty/don-gia/khoi-tao-mau").then(e=>e.data)},Xa={layDanhSach:e=>he.get("/ung-luong/bang",{params:e}).then(n=>n.data),layTheoId:e=>he.get(`/ung-luong/bang/${e}`).then(n=>n.data),taoMoi:e=>he.post("/ung-luong/bang",e).then(n=>n.data),capNhat:(e,n)=>he.put(`/ung-luong/bang/${e}`,n).then(a=>a.data),xoa:(e,n=!1)=>he.delete(`/ung-luong/bang/${e}`,{params:{force:n?"true":void 0}}).then(a=>a.data),sinhDanhSach:(e,n)=>he.post(`/ung-luong/bang/${e}/generate-danh-sach`,n||{}).then(a=>a.data),capNhatBulk:(e,n)=>he.put(`/ung-luong/bang/${e}/rows/bulk`,n).then(a=>a.data),setTheoTiLe:(e,n)=>he.post(`/ung-luong/bang/${e}/set-theo-ti-le`,n).then(a=>a.data),setSoTienCoDinh:(e,n)=>he.post(`/ung-luong/bang/${e}/set-so-tien-co-dinh`,n).then(a=>a.data),chot:e=>he.post(`/ung-luong/bang/${e}/chot`).then(n=>n.data),khoa:e=>he.post(`/ung-luong/bang/${e}/khoa`).then(n=>n.data),moKhoa:(e,n)=>he.post(`/ung-luong/bang/${e}/mo-khoa`,n).then(a=>a.data),ghiNhanKhauTru:(e,n)=>he.post(`/ung-luong/bang/${e}/ghi-nhan-khau-tru`,n).then(a=>a.data)},qj={layNhanVien:(e,n)=>{const a=`${n.tuNam}-${String(n.tuThang).padStart(2,"0")}-01`,r=new Date(n.denNam,n.denThang,0).toISOString().split("T")[0];return he.get(`/so-luong/nhan-vien/${e}`,{params:{tuNgay:a,denNgay:r}}).then(s=>s.data)},layPhongBan:(e,n)=>{const a=`${n.tuNam}-${String(n.tuThang).padStart(2,"0")}-01`,r=new Date(n.denNam,n.denThang,0).toISOString().split("T")[0];return he.get(`/so-luong/phong-ban/${e}`,{params:{tuNgay:a,denNgay:r}}).then(s=>s.data)},timKiem:e=>he.get("/so-luong/tim-kiem",{params:e}).then(n=>n.data)};function Ye(e){if(e==null)return"0";const n=typeof e=="string"?parseFloat(e):e;return isNaN(n)?"0":new Intl.NumberFormat("vi-VN").format(n)}function GE(e){if(!e)return 0;const n=e.replace(/[^\d]/g,"");return parseInt(n,10)||0}function js(e){return e?new Date(e).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):""}function qE(e){switch(e){case"NHAP":return"ang nhp";case"DA_CHOT":return" cht";case"KHOA":return" kha";default:return e}}function WE(e,n){const a=window.URL.createObjectURL(e),r=document.createElement("a");r.href=a,r.setAttribute("download",n),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(a)}function wt(...e){const n=[];for(const a of e)if(a){if(typeof a=="string")n.push(a);else if(typeof a=="number")n.push(String(a));else if(Array.isArray(a)){const r=wt(...a);r&&n.push(r)}}return n.join(" ").replace(/\s+/g," ").trim()}const st=D.forwardRef(({className:e,variant:n="default",padding:a="md",hover:r=!1,clickable:s=!1,children:l,...o},d)=>{const u="rounded-2xl transition-all duration-200",x={default:"bg-[var(--panel)] border border-[var(--border)]",glass:`
        bg-[var(--panel)]/80 backdrop-blur-xl 
        border border-white/10 
        shadow-lg shadow-black/5
      `,elevated:`
        bg-[var(--panel)] 
        border border-[var(--border)]
        shadow-xl shadow-black/10
      `,bordered:"bg-transparent border-2 border-[var(--border)]",gradient:`
        bg-gradient-to-br from-[var(--panel)] to-[var(--bg-2)]
        border border-[var(--border)]
      `},m={none:"",sm:"p-3",md:"p-5",lg:"p-6",xl:"p-8"},f=r?"hover:shadow-xl hover:border-[var(--accent)]/30 hover:-translate-y-0.5":"",p=s?"cursor-pointer active:scale-[0.99]":"";return t.jsx("div",{ref:d,className:wt(u,x[n],m[a],f,p,e),...o,children:l})});st.displayName="Card";const zn=D.forwardRef(({className:e,title:n,subtitle:a,action:r,icon:s,children:l,...o},d)=>t.jsxs("div",{ref:d,className:wt("flex items-start justify-between gap-4 mb-4",e),...o,children:[t.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[s&&t.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-xl bg-[var(--accent)]/10 flex items-center justify-center text-[var(--accent)]",children:s}),t.jsxs("div",{className:"flex-1 min-w-0",children:[n&&t.jsx("h3",{className:"text-lg font-semibold text-[var(--text-primary)] truncate",children:n}),a&&t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-0.5",children:a}),l]})]}),r&&t.jsx("div",{className:"flex-shrink-0",children:r})]}));zn.displayName="CardHeader";const Vt=D.forwardRef(({className:e,...n},a)=>t.jsx("div",{ref:a,className:wt("",e),...n}));Vt.displayName="CardContent";const XE=D.forwardRef(({className:e,separator:n=!0,...a},r)=>t.jsx("div",{ref:r,className:wt("flex items-center justify-between gap-4 mt-4 pt-4",n&&"border-t border-[var(--border)]",e),...a}));XE.displayName="CardFooter";const Wj=D.forwardRef(({className:e,title:n,value:a,subtitle:r,icon:s,trend:l,accentColor:o="green",...d},u)=>{const m={green:{bg:"bg-[#53F39A]/10",text:"text-[#53F39A]",glow:"shadow-[#53F39A]/20"},cyan:{bg:"bg-[#4FC3FF]/10",text:"text-[#4FC3FF]",glow:"shadow-[#4FC3FF]/20"},yellow:{bg:"bg-amber-500/10",text:"text-amber-400",glow:"shadow-amber-500/20"},red:{bg:"bg-[#FF4D6D]/10",text:"text-[#FF4D6D]",glow:"shadow-[#FF4D6D]/20"},purple:{bg:"bg-purple-500/10",text:"text-purple-400",glow:"shadow-purple-500/20"}}[o],f={up:"text-[#53F39A]",down:"text-[#FF4D6D]",neutral:"text-[var(--text-muted)]"},p={up:"",down:"",neutral:""};return t.jsxs(st,{ref:u,variant:"glass",className:wt("group hover:shadow-lg",m.glow,e),hover:!0,...d,children:[t.jsxs("div",{className:"flex items-start justify-between",children:[s&&t.jsx("div",{className:wt("w-12 h-12 rounded-xl flex items-center justify-center transition-transform group-hover:scale-110",m.bg,m.text),children:s}),l&&t.jsxs("div",{className:wt("flex items-center gap-1 text-sm font-medium",f[l.direction]),children:[t.jsx("span",{children:p[l.direction]}),t.jsxs("span",{children:[Math.abs(l.value),"%"]})]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("p",{className:"text-3xl font-bold text-[var(--text-primary)] tabular-nums",children:typeof a=="number"?a.toLocaleString("vi-VN"):a}),t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1",children:n}),r&&t.jsx("p",{className:"text-xs text-[var(--text-disabled)] mt-0.5",children:r})]})]})});Wj.displayName="StatCard";const ft=D.forwardRef(({className:e,variant:n="primary",size:a="md",rounded:r="xl",loading:s=!1,icon:l,iconPosition:o="left",fullWidth:d=!1,disabled:u,children:x,...m},f)=>{const p=u||s,N=`
      inline-flex items-center justify-center gap-2
      font-medium transition-all duration-200
      focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[var(--accent)]
      disabled:opacity-50 disabled:cursor-not-allowed
      active:scale-[0.98]
    `,y={primary:`
        bg-[var(--accent)] text-[#0B1220]
        hover:bg-[var(--accent)]/90
        shadow-lg shadow-[var(--accent)]/25
      `,secondary:`
        bg-[var(--bg-2)] text-[var(--text-primary)]
        border border-[var(--border)]
        hover:bg-[var(--bg-3)] hover:border-[var(--accent)]/30
      `,outline:`
        bg-transparent text-[var(--text-primary)]
        border-2 border-[var(--border)]
        hover:bg-[var(--bg-2)] hover:border-[var(--accent)]/50
      `,ghost:`
        bg-transparent text-[var(--text-secondary)]
        hover:bg-[var(--bg-2)] hover:text-[var(--text-primary)]
      `,danger:`
        bg-[#FF4D6D] text-white
        hover:bg-[#FF4D6D]/90
        shadow-lg shadow-[#FF4D6D]/25
      `,success:`
        bg-[#53F39A] text-[#0B1220]
        hover:bg-[#53F39A]/90
        shadow-lg shadow-[#53F39A]/25
      `},g={xs:"text-xs px-2.5 py-1.5 h-7",sm:"text-sm px-3 py-2 h-8",md:"text-sm px-4 py-2.5 h-10",lg:"text-base px-5 py-3 h-11",xl:"text-base px-6 py-3.5 h-12"},b={md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl",full:"rounded-full"};return t.jsxs("button",{ref:f,className:wt(N,y[n],g[a],b[r],d&&"w-full",e),disabled:p,...m,children:[s&&t.jsx(Rn,{className:"w-4 h-4 animate-spin"}),!s&&l&&o==="left"&&t.jsx("span",{className:"flex-shrink-0",children:l}),x&&t.jsx("span",{children:x}),!s&&l&&o==="right"&&t.jsx("span",{className:"flex-shrink-0",children:l})]})});ft.displayName="Button";const Xj=D.forwardRef(({className:e,variant:n="ghost",size:a="md",loading:r=!1,tooltip:s,disabled:l,children:o,...d},u)=>{const x=l||r,m=`
      inline-flex items-center justify-center
      rounded-xl transition-all duration-200
      focus:outline-none focus-visible:ring-2 focus-visible:ring-[var(--accent)]
      disabled:opacity-50 disabled:cursor-not-allowed
      active:scale-95
    `,f={primary:`
        bg-[var(--accent)] text-[#0B1220]
        hover:bg-[var(--accent)]/80
      `,secondary:`
        bg-[var(--bg-2)] text-[var(--text-secondary)]
        hover:bg-[var(--bg-3)] hover:text-[var(--text-primary)]
      `,ghost:`
        text-[var(--text-muted)]
        hover:bg-[var(--bg-2)] hover:text-[var(--text-primary)]
      `,danger:`
        text-[#FF4D6D]
        hover:bg-[#FF4D6D]/10
      `},p={xs:"w-6 h-6",sm:"w-8 h-8",md:"w-10 h-10",lg:"w-12 h-12"};return t.jsx("button",{ref:u,className:wt(m,f[n],p[a],e),disabled:x,title:s,...d,children:r?t.jsx(Rn,{className:"w-4 h-4 animate-spin"}):o})});Xj.displayName="IconButton";const Et=D.forwardRef(({className:e,variant:n="default",size:a="sm",dot:r=!1,icon:s,removable:l=!1,onRemove:o,children:d,...u},x)=>{const m=`
      inline-flex items-center gap-1.5
      font-medium rounded-full
      transition-colors duration-150
    `,f={default:"bg-[var(--accent)]/15 text-[var(--accent)]",success:"bg-[#53F39A]/15 text-[#53F39A]",warning:"bg-amber-500/15 text-amber-400",danger:"bg-[#FF4D6D]/15 text-[#FF4D6D]",info:"bg-[#4FC3FF]/15 text-[#4FC3FF]",neutral:"bg-[var(--bg-3)] text-[var(--text-muted)]"},p={xs:"text-[10px] px-1.5 py-0.5",sm:"text-xs px-2 py-0.5",md:"text-sm px-2.5 py-1"},N={default:"bg-[var(--accent)]",success:"bg-[#53F39A]",warning:"bg-amber-400",danger:"bg-[#FF4D6D]",info:"bg-[#4FC3FF]",neutral:"bg-[var(--text-muted)]"};return t.jsxs("span",{ref:x,className:wt(m,f[n],p[a],e),...u,children:[r&&t.jsx("span",{className:wt("w-1.5 h-1.5 rounded-full animate-pulse",N[n])}),s&&t.jsx("span",{className:"flex-shrink-0 w-3 h-3",children:s}),d,l&&t.jsx("button",{type:"button",onClick:y=>{y.stopPropagation(),o==null||o()},className:"ml-0.5 -mr-0.5 p-0.5 rounded-full hover:bg-white/20 transition-colors",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-3 h-3",children:t.jsx("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})})})]})});Et.displayName="Badge";const QE={active:{label:"Hot ng",variant:"success"},inactive:{label:"Ngng",variant:"neutral"},pending:{label:"Ch duyt",variant:"warning"},approved:{label:" duyt",variant:"success"},rejected:{label:"T chi",variant:"danger"},draft:{label:"Nhp",variant:"neutral"},completed:{label:"Hon thnh",variant:"info"}},YE=D.forwardRef(({status:e,className:n,...a},r)=>{const s=QE[e];return t.jsx(Et,{ref:r,variant:s.variant,dot:!0,className:n,...a,children:s.label})});YE.displayName="StatusBadge";const JE=D.forwardRef(({count:e,max:n=99,variant:a="danger",className:r,...s},l)=>{const o=e>n?`${n}+`:e,d=`
      inline-flex items-center justify-center
      min-w-[18px] h-[18px] px-1.5
      text-[10px] font-bold rounded-full
    `,u={default:"bg-[var(--accent)] text-[#0B1220]",danger:"bg-[#FF4D6D] text-white"};return e<=0?null:t.jsx("span",{ref:l,className:wt(d,u[a],r),...s,children:o})});JE.displayName="CounterBadge";const ug=D.forwardRef(({className:e,type:n="text",size:a="md",variant:r="default",error:s=!1,success:l=!1,icon:o,iconPosition:d="left",clearable:u=!1,onClear:x,value:m,...f},p)=>{const N=`
      w-full transition-all duration-200
      placeholder:text-[var(--text-disabled)]
      focus:outline-none
      disabled:opacity-50 disabled:cursor-not-allowed
    `,y={default:`
        bg-[var(--bg-1)] 
        border border-[var(--border)]
        focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
      `,filled:`
        bg-[var(--bg-2)] 
        border border-transparent
        focus:bg-[var(--bg-1)] focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
      `,ghost:`
        bg-transparent 
        border border-transparent
        hover:bg-[var(--bg-2)]
        focus:bg-[var(--bg-2)] focus:border-[var(--border)]
      `},g={sm:"h-8 px-3 text-sm rounded-lg",md:"h-10 px-4 text-sm rounded-xl",lg:"h-12 px-4 text-base rounded-xl"},b=s?"border-[#FF4D6D] focus:border-[#FF4D6D] focus:ring-[#FF4D6D]/20":l?"border-[#53F39A] focus:border-[#53F39A] focus:ring-[#53F39A]/20":"",j=!!o,T=u&&m,S=j&&d==="left"?"pl-10":"",w=j&&d==="right"||T?"pr-10":"";return t.jsxs("div",{className:"relative",children:[o&&d==="left"&&t.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)]",children:o}),t.jsx("input",{ref:p,type:n,value:m,className:wt(N,y[r],g[a],b,S,w,"text-[var(--text-primary)]",e),...f}),o&&d==="right"&&!T&&t.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)]",children:o}),T&&t.jsx("button",{type:"button",onClick:x,className:"absolute right-3 top-1/2 -translate-y-1/2 p-0.5 rounded-full text-[var(--text-muted)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-3)] transition-colors",children:t.jsx(mn,{size:14})})]})});ug.displayName="Input";const hg=D.forwardRef(({className:e,onSearch:n,...a},r)=>t.jsx(ug,{ref:r,type:"search",icon:t.jsx(Vr,{size:18}),iconPosition:"left",clearable:!0,placeholder:"Tm kim...",className:e,...a}));hg.displayName="SearchInput";const ZE=D.forwardRef(({className:e,...n},a)=>{const[r,s]=D.useState(!1);return t.jsxs("div",{className:"relative",children:[t.jsx(ug,{ref:a,type:r?"text":"password",className:wt("pr-10",e),...n}),t.jsx("button",{type:"button",onClick:()=>s(!r),className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 rounded-lg text-[var(--text-muted)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-3)] transition-colors",children:r?t.jsx(eg,{size:18}):t.jsx(Ra,{size:18})})]})});ZE.displayName="PasswordInput";const sx=D.forwardRef(({className:e,variant:n="default",error:a,success:r,...s},l)=>{const o=`
      w-full min-h-[100px] px-4 py-3
      text-sm text-[var(--text-primary)]
      rounded-xl resize-y
      transition-all duration-200
      placeholder:text-[var(--text-disabled)]
      focus:outline-none
      disabled:opacity-50 disabled:cursor-not-allowed
    `,d={default:`
        bg-[var(--bg-1)] 
        border border-[var(--border)]
        focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
      `,filled:`
        bg-[var(--bg-2)] 
        border border-transparent
        focus:bg-[var(--bg-1)] focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
      `},u=a?"border-[#FF4D6D] focus:border-[#FF4D6D] focus:ring-[#FF4D6D]/20":r?"border-[#53F39A] focus:border-[#53F39A] focus:ring-[#53F39A]/20":"";return t.jsx("textarea",{ref:l,className:wt(o,d[n],u,e),...s})});sx.displayName="Textarea";const e6=D.forwardRef(({className:e,loading:n,empty:a,emptyMessage:r="Khng c d liu",emptyIcon:s,children:l,...o},d)=>t.jsxs("div",{ref:d,className:wt("relative overflow-hidden rounded-2xl","bg-[var(--panel)] border border-[var(--border)]",e),...o,children:[n&&t.jsx("div",{className:"absolute inset-0 bg-[var(--panel)]/80 backdrop-blur-sm z-10 flex items-center justify-center",children:t.jsxs("div",{className:"flex flex-col items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 border-2 border-[var(--accent)] border-t-transparent rounded-full animate-spin"}),t.jsx("span",{className:"text-sm text-[var(--text-muted)]",children:"ang ti..."})]})}),a?t.jsxs("div",{className:"py-16 flex flex-col items-center justify-center text-center",children:[s&&t.jsx("div",{className:"w-16 h-16 rounded-2xl bg-[var(--bg-2)] flex items-center justify-center text-[var(--text-muted)] mb-4",children:s}),t.jsx("p",{className:"text-[var(--text-muted)]",children:r})]}):t.jsx("div",{className:"overflow-x-auto",children:l})]}));e6.displayName="TableContainer";const Qj=D.forwardRef(({className:e,compact:n,striped:a,hoverable:r=!0,...s},l)=>t.jsx("table",{ref:l,className:wt("w-full text-sm",n?"table-compact":"",a?"table-striped":"",r?"table-hoverable":"",e),...s}));Qj.displayName="Table";const Yj=D.forwardRef(({className:e,...n},a)=>t.jsx("thead",{ref:a,className:wt("bg-[var(--bg-2)] border-b border-[var(--border)]",e),...n}));Yj.displayName="TableHead";const Jj=D.forwardRef(({className:e,...n},a)=>t.jsx("tbody",{ref:a,className:wt("divide-y divide-[var(--border)]",e),...n}));Jj.displayName="TableBody";const Ad=D.forwardRef(({className:e,selected:n,clickable:a,...r},s)=>t.jsx("tr",{ref:s,className:wt("transition-colors","hover:bg-[var(--bg-2)]",n&&"bg-[var(--accent)]/5",a&&"cursor-pointer",e),...r}));Ad.displayName="TableRow";const Il=D.forwardRef(({className:e,children:n,sortable:a,sortDirection:r,onSort:s,align:l="left",...o},d)=>{const u={left:"text-left",center:"text-center",right:"text-right"};return t.jsx("th",{ref:d,className:wt("px-4 py-3 font-semibold text-xs uppercase tracking-wider","text-[var(--text-muted)]",u[l],a&&"cursor-pointer select-none hover:text-[var(--text-primary)] group",e),onClick:a?s:void 0,...o,children:t.jsxs("div",{className:wt("inline-flex items-center gap-1.5",l==="right"&&"flex-row-reverse",l==="center"&&"justify-center"),children:[n,a&&t.jsx("span",{className:wt("transition-colors",r?"text-[var(--accent)]":"text-[var(--text-disabled)] group-hover:text-[var(--text-muted)]"),children:r==="asc"?t.jsx(Ol,{size:14}):r==="desc"?t.jsx(Ja,{size:14}):t.jsx(w_,{size:14})})]})})});Il.displayName="TableHeadCell";const qs=D.forwardRef(({className:e,align:n="left",numeric:a,truncate:r,maxWidth:s,style:l,...o},d)=>{const u={left:"text-left",center:"text-center",right:"text-right"};return t.jsx("td",{ref:d,className:wt("px-4 py-3","text-[var(--text-primary)]",u[n],a&&"tabular-nums font-medium",r&&"truncate",e),style:{maxWidth:s?`${s}px`:void 0,...l},...o})});qs.displayName="TableCell";const t6=D.forwardRef(({className:e,...n},a)=>t.jsx("tfoot",{ref:a,className:wt("bg-[var(--bg-2)] border-t border-[var(--border)]",e),...n}));t6.displayName="TableFooter";const ns=({isOpen:e,onClose:n,children:a,size:r="md",closable:s=!0,closeOnOverlay:l=!0,closeOnEscape:o=!0,className:d})=>{if(D.useEffect(()=>{if(!e||!o)return;const m=f=>{f.key==="Escape"&&n()};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[e,o,n]),D.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),!e)return null;const u={sm:"max-w-sm",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-[90vw]"},x=t.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4",children:[t.jsx("div",{className:wt("absolute inset-0 bg-black/50","animate-in fade-in duration-200"),onClick:l?n:void 0}),t.jsxs("div",{className:wt("relative w-full",u[r],"bg-white","border border-[var(--border)]","rounded-2xl shadow-2xl shadow-black/40","animate-in fade-in zoom-in-95 duration-200",d),onClick:m=>m.stopPropagation(),children:[s&&t.jsx(Xj,{variant:"ghost",size:"sm",onClick:n,className:"absolute top-4 right-4 z-10",children:t.jsx(mn,{size:18})}),a]})]});return yS.createPortal(x,document.body)},Ss=({title:e,subtitle:n,icon:a,className:r})=>t.jsx("div",{className:wt("px-6 pt-6 pb-4",r),children:t.jsxs("div",{className:"flex items-start gap-4",children:[a&&t.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-xl bg-[var(--accent)]/10 flex items-center justify-center text-[var(--accent)]",children:a}),t.jsxs("div",{className:"flex-1 min-w-0 pr-8",children:[t.jsx("h2",{className:"text-xl font-semibold text-[var(--text-primary)]",children:e}),n&&t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1",children:n})]})]})}),_s=({children:e,className:n,padding:a=!0})=>t.jsx("div",{className:wt("max-h-[60vh] overflow-y-auto modal-scroll",a&&"px-6 py-4",n),children:e}),ni=({children:e,className:n})=>t.jsx("div",{className:wt("flex items-center justify-end gap-3","px-6 py-4","border-t border-[var(--border)]","bg-[var(--bg-2)]/50",n),children:e});function n6(){const e=new Date,[n,a]=D.useState(e.getMonth()+1),[r,s]=D.useState(e.getFullYear()),{data:l}=Le({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),{data:o}=Le({queryKey:["nhan-vien"],queryFn:()=>ha.layTatCa()}),{data:d}=Le({queryKey:["khoan-luong"],queryFn:()=>pr.layTatCa()}),{data:u}=Le({queryKey:["bang-luong"],queryFn:()=>Or.layDanhSach()}),x=(Array.isArray(o)?o:(o==null?void 0:o.data)||[]).filter(g=>g&&g.id),m=(Array.isArray(u)?u:(u==null?void 0:u.data)||[]).filter(g=>g&&g.id),f=D.useMemo(()=>{const g=new Set;return m.forEach(b=>{b.nam&&g.add(b.nam)}),g.add(e.getFullYear()),Array.from(g).sort((b,j)=>j-b)},[m]),p=D.useMemo(()=>m.filter(g=>g.thang===n&&g.nam===r).reduce((g,b)=>g+((b==null?void 0:b.thucLinh)||0),0)||0,[m,n,r]),N=[{label:"Phng ban",value:(l==null?void 0:l.length)||0,icon:Mr,color:"cyan",link:"/nhan-vien"},{label:"Nhn vin",value:(x==null?void 0:x.length)||0,icon:on,color:"green",link:"/nhan-vien"},{label:"Khon lng",value:(d==null?void 0:d.length)||0,icon:gr,color:"purple",link:"/khoan-luong"},{label:"Bng lng",value:(m==null?void 0:m.length)||0,icon:ei,color:"yellow",link:"/bang-luong"}],y=g=>{switch(g){case"NHAP":return t.jsx(Et,{variant:"neutral",dot:!0,children:"ang nhp"});case"DA_CHOT":return t.jsx(Et,{variant:"success",dot:!0,children:" cht"});case"KHOA":return t.jsx(Et,{variant:"info",dot:!0,children:" kha"});default:return t.jsx(Et,{variant:"neutral",children:g})}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-[var(--text-primary)] flex items-center gap-2",children:[t.jsx(q_,{size:24,className:"text-[var(--accent)]"}),"Tng quan H thng"]}),t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1",children:"Cho mng tr li! y l tng quan hot ng ca bn."})]}),t.jsxs(ua,{to:"/bang-luong",className:`
            inline-flex items-center gap-2 px-4 py-2.5 
            bg-[var(--accent)] text-[#0B1220] font-medium
            rounded-xl hover:bg-[var(--accent)]/90 
            shadow-lg shadow-[var(--accent)]/25
            transition-all duration-200
          `,children:[t.jsx(ei,{size:18}),"To bng lng",t.jsx(g_,{size:16})]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:N.map(g=>{const b=g.icon;return t.jsx(ua,{to:g.link,children:t.jsx(Wj,{title:g.label,value:g.value,icon:t.jsx(b,{size:24}),accentColor:g.color})},g.label)})}),t.jsxs(st,{variant:"glass",className:`
          relative overflow-hidden
          bg-gradient-to-br from-[#53F39A]/5 via-[var(--panel)] to-[#4FC3FF]/5
          border border-[var(--accent)]/20
        `,children:[t.jsx("div",{className:"absolute -top-20 -right-20 w-60 h-60 bg-[var(--accent)]/10 rounded-full blur-3xl"}),t.jsx("div",{className:"absolute -bottom-20 -left-20 w-40 h-40 bg-[#4FC3FF]/10 rounded-full blur-3xl"}),t.jsxs("div",{className:"relative flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-6",children:[t.jsx("div",{className:`
              p-5 rounded-2xl
              bg-gradient-to-br from-[#53F39A] to-[#4FC3FF]
              shadow-lg shadow-[#53F39A]/30
            `,children:t.jsx(oi,{size:32,className:"text-[#0B1220]"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-[var(--text-muted)] uppercase tracking-wider font-medium",children:"Tng qu lng"}),t.jsxs("p",{className:"text-4xl font-bold text-[var(--text-primary)] mt-1 tabular-nums",children:[Ye(p),t.jsx("span",{className:"text-lg text-[var(--text-muted)] ml-2 font-normal",children:"VN"})]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"relative",children:[t.jsx("select",{value:n,onChange:g=>a(Number(g.target.value)),className:`
                  appearance-none pl-4 pr-10 py-2.5
                  bg-[var(--bg-2)] border border-[var(--border)]
                  rounded-xl text-[var(--text-primary)]
                  text-sm font-medium cursor-pointer
                  hover:border-[var(--accent)]/50
                  focus:outline-none focus:ring-2 focus:ring-[var(--accent)]/30
                  transition-all
                `,children:Array.from({length:12},(g,b)=>b+1).map(g=>t.jsxs("option",{value:g,children:["Thng ",g]},g))}),t.jsx(Ja,{size:16,className:"absolute right-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)] pointer-events-none"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("select",{value:r,onChange:g=>s(Number(g.target.value)),className:`
                  appearance-none pl-4 pr-10 py-2.5
                  bg-[var(--bg-2)] border border-[var(--border)]
                  rounded-xl text-[var(--text-primary)]
                  text-sm font-medium cursor-pointer
                  hover:border-[var(--accent)]/50
                  focus:outline-none focus:ring-2 focus:ring-[var(--accent)]/30
                  transition-all
                `,children:f.map(g=>t.jsx("option",{value:g,children:g},g))}),t.jsx(Ja,{size:16,className:"absolute right-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)] pointer-events-none"})]})]})]})]}),t.jsxs(st,{variant:"glass",padding:"none",children:[t.jsx(zn,{title:t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(Lt,{size:20,className:"text-[var(--accent)]"}),"Bng lng gn y"]}),action:t.jsxs(ua,{to:"/bang-luong",className:`
                flex items-center gap-1 text-sm text-[var(--text-muted)]
                hover:text-[var(--accent)] transition-colors
              `,children:["Xem tt c",t.jsx(qn,{size:16})]}),className:"px-5 pt-5"}),m&&m.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-[var(--border)]",children:[t.jsx("th",{className:"text-left py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Thng/Nm"}),t.jsx("th",{className:"text-left py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Phng ban"}),t.jsx("th",{className:"text-right py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"S NV"}),t.jsx("th",{className:"text-right py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Thc lnh"}),t.jsx("th",{className:"text-center py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Trng thi"})]})}),t.jsx("tbody",{className:"divide-y divide-[var(--border)]",children:m.slice(0,5).map(g=>{var b;return t.jsxs("tr",{className:"hover:bg-[var(--bg-2)] transition-colors group",children:[t.jsx("td",{className:"py-4 px-5",children:t.jsxs(ua,{to:`/bang-luong/${g.id}`,className:`
                          font-medium text-[var(--text-primary)]
                          group-hover:text-[var(--accent)] transition-colors
                        `,children:["Thng ",g.thang,"/",g.nam]})}),t.jsx("td",{className:"py-4 px-5 text-[var(--text-secondary)]",children:((b=g.phongBan)==null?void 0:b.tenPhongBan)||"Tt c phng ban"}),t.jsx("td",{className:"py-4 px-5 text-right text-[var(--text-secondary)] tabular-nums",children:g.soNhanVien||0}),t.jsx("td",{className:"py-4 px-5 text-right font-semibold text-[var(--accent)] tabular-nums",children:Ye(g.thucLinh)}),t.jsx("td",{className:"py-4 px-5 text-center",children:y(g.trangThai)})]},g.id)})})]})}):t.jsxs("div",{className:"text-center py-12 px-5",children:[t.jsx("div",{className:`
              w-16 h-16 mx-auto mb-4 rounded-2xl
              bg-[var(--bg-2)] flex items-center justify-center
              text-[var(--text-muted)]
            `,children:t.jsx(ei,{size:28})}),t.jsxs("p",{className:"text-[var(--text-muted)]",children:["Cha c bng lng no."," ",t.jsx(ua,{to:"/bang-luong",className:"text-[var(--accent)] hover:underline",children:"To bng lng mi"})]})]})]})]})}function a6(){const{coVaiTro:e}=is(),n=e("ADMIN"),a=Mt(),[r,s]=D.useState(!1),[l,o]=D.useState(new Date().getFullYear()),[d,u]=D.useState(new Date().getMonth()+1),[x,m]=D.useState(),[f,p]=D.useState({thang:new Date().getMonth()+1,nam:new Date().getFullYear(),phongBanIds:[],tenBangLuong:""}),{data:N,isLoading:y}=Le({queryKey:["bang-luong",l,d,x],queryFn:()=>Or.layDanhSach({nam:l,thang:d,phongBanId:x})}),g=(Array.isArray(N)?N:(N==null?void 0:N.data)||[]).filter(E=>E&&E.id),{data:b}=Le({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),j=De({mutationFn:async E=>{const C=await Promise.allSettled(E.phongBanIds.map(R=>Or.taoMoi({thang:E.thang,nam:E.nam,phongBanId:R,tenBangLuong:E.phongBanIds.length>1?"":E.tenBangLuong}))),P=C.filter(R=>R.status==="fulfilled"),F=C.filter(R=>R.status==="rejected");return{successful:P,failed:F,total:C.length}},onSuccess:({successful:E,failed:C,total:P})=>{var F,R,O;if(a.invalidateQueries({queryKey:["bang-luong"]}),E.length>0&&C.length===0)ie.success(`To ${E.length} bng lng thnh cng!`);else if(E.length>0&&C.length>0)ie.success(`To ${E.length}/${P} bng lng thnh cng!`),ie.error(`${C.length} bng lng to tht bi`);else if(C.length>0){const q=((O=(R=(F=C[0].reason)==null?void 0:F.response)==null?void 0:R.data)==null?void 0:O.message)||"C li xy ra";ie.error(q)}E.length>0&&(s(!1),p({thang:new Date().getMonth()+1,nam:new Date().getFullYear(),phongBanIds:[],tenBangLuong:""}))},onError:E=>{var C,P;ie.error(((P=(C=E.response)==null?void 0:C.data)==null?void 0:P.message)||"C li xy ra")}}),T=De({mutationFn:({id:E,force:C})=>Or.xoa(E,C),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-luong"]}),ie.success("Xa bng lng thnh cng!")},onError:E=>{var C,P;ie.error(((P=(C=E.response)==null?void 0:C.data)==null?void 0:P.message)||"C li xy ra")}}),S=()=>{if(f.phongBanIds.length===0){ie.error("Vui lng chn t nht mt phng ban");return}j.mutate(f)},w=(E,C,P=!1)=>{if(!P&&C!=="NHAP"){ie.error("Ch c th xa bng lng ang  trng thi Nhp. ADMIN c th xa bng  kha.");return}confirm(P?" BN ANG XA BNG LNG  KHA! Hnh ng ny khng th hon tc. Bn c chc chn?":"Bn c chc mun xa bng lng ny?")&&T.mutate({id:E,force:P})},_=E=>{switch(E){case"NHAP":return t.jsx(Et,{variant:"neutral",dot:!0,children:"ang nhp"});case"DA_CHOT":return t.jsx(Et,{variant:"success",dot:!0,children:" cht"});case"KHOA":return t.jsx(Et,{variant:"info",dot:!0,children:" kha"});default:return t.jsx(Et,{variant:"neutral",children:qE(E)})}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-[var(--text-primary)] flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--accent)]/10 flex items-center justify-center",children:t.jsx(ei,{size:22,className:"text-[var(--accent)]"})}),"Qun l Bng lng"]}),t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1 ml-13",children:"To v qun l bng lng hng thng"})]}),t.jsx(ft,{onClick:()=>s(!0),icon:t.jsx(Dt,{size:18}),children:"To bng lng mi"})]}),t.jsx(st,{variant:"glass",padding:"md",children:t.jsxs("div",{className:"flex gap-4 items-end flex-wrap",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-[var(--text-muted)] mb-1.5 uppercase tracking-wider",children:"Nm"}),t.jsx("select",{value:l,onChange:E=>o(Number(E.target.value)),className:`
                h-10 px-4 rounded-xl
                bg-[var(--bg-1)] border border-[var(--border)]
                text-[var(--text-primary)]
                focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                transition-all
              `,children:[2024,2025,2026,2027].map(E=>t.jsx("option",{value:E,children:E},E))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-[var(--text-muted)] mb-1.5 uppercase tracking-wider",children:"Thng"}),t.jsxs("select",{value:d||"",onChange:E=>u(E.target.value?Number(E.target.value):void 0),className:`
                h-10 px-4 rounded-xl
                bg-[var(--bg-1)] border border-[var(--border)]
                text-[var(--text-primary)]
                focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                transition-all
              `,children:[t.jsx("option",{value:"",children:"Tt c"}),Array.from({length:12},(E,C)=>C+1).map(E=>t.jsxs("option",{value:E,children:["Thng ",E]},E))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-[var(--text-muted)] mb-1.5 uppercase tracking-wider",children:"Phng ban"}),t.jsxs("select",{value:x||"",onChange:E=>m(E.target.value?Number(E.target.value):void 0),className:`
                h-10 px-4 rounded-xl min-w-[200px]
                bg-[var(--bg-1)] border border-[var(--border)]
                text-[var(--text-primary)]
                focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                transition-all
              `,children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),b==null?void 0:b.map(E=>t.jsx("option",{value:E.id,children:E.tenPhongBan},E.id))]})]})]})}),t.jsx(st,{variant:"glass",padding:"none",children:y?t.jsx("div",{className:"flex items-center justify-center py-16",children:t.jsx("div",{className:"w-8 h-8 border-2 border-[var(--accent)] border-t-transparent rounded-full animate-spin"})}):g&&g.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-[var(--border)] bg-[var(--bg-2)]",children:[t.jsx("th",{className:"text-left py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Tn bng lng"}),t.jsx("th",{className:"text-center py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"K lng"}),t.jsx("th",{className:"text-left py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Phng ban"}),t.jsx("th",{className:"text-right py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"S NV"}),t.jsx("th",{className:"text-right py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Tng thu nhp"}),t.jsx("th",{className:"text-right py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Thc lnh"}),t.jsx("th",{className:"text-center py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Trng thi"}),t.jsx("th",{className:"text-center py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-[var(--border)]",children:g.map(E=>{var C;return t.jsxs("tr",{className:"hover:bg-[var(--bg-2)] transition-colors group",children:[t.jsx("td",{className:"py-4 px-5",children:t.jsx(ua,{to:`/bang-luong/${E.id}`,className:"font-medium text-[var(--text-primary)] group-hover:text-[var(--accent)] transition-colors",children:E.tenBangLuong||`Bng lng T${E.thang}/${E.nam}`})}),t.jsx("td",{className:"py-4 px-5 text-center",children:t.jsxs("span",{className:"inline-flex items-center gap-1.5 text-[var(--text-secondary)]",children:[t.jsx(Lt,{size:14,className:"text-[var(--text-muted)]"}),"T",E.thang,"/",E.nam]})}),t.jsx("td",{className:"py-4 px-5 text-[var(--text-secondary)]",children:((C=E.phongBan)==null?void 0:C.tenPhongBan)||""}),t.jsx("td",{className:"py-4 px-5 text-right text-[var(--text-secondary)] tabular-nums",children:E.soNhanVien||0}),t.jsx("td",{className:"py-4 px-5 text-right text-[var(--text-secondary)] tabular-nums",children:Ye(E.tongThuNhap)}),t.jsx("td",{className:"py-4 px-5 text-right font-semibold text-[var(--accent)] tabular-nums",children:Ye(E.thucLinh)}),t.jsx("td",{className:"py-4 px-5 text-center",children:_(E.trangThai)}),t.jsx("td",{className:"py-4 px-5",children:t.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t.jsx(ua,{to:`/bang-luong/${E.id}`,className:"p-2 text-[var(--text-muted)] hover:text-[var(--accent)] hover:bg-[var(--accent)]/10 rounded-lg transition-colors",title:"Xem chi tit",children:t.jsx(Ra,{size:18})}),E.trangThai==="NHAP"&&t.jsx("button",{onClick:()=>w(E.id,E.trangThai),className:"p-2 text-[var(--text-muted)] hover:text-[#FF4D6D] hover:bg-[#FF4D6D]/10 rounded-lg transition-colors",title:"Xa",children:t.jsx(er,{size:18})}),E.trangThai==="DA_CHOT"&&t.jsx("span",{className:"p-2 text-[var(--text-disabled)]",title:" cht",children:t.jsx(ti,{size:18})}),E.trangThai==="KHOA"&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"p-2 text-[var(--text-disabled)]",title:" kha",children:t.jsx(ti,{size:18})}),n&&t.jsx("button",{onClick:()=>w(E.id,E.trangThai,!0),className:"p-2 text-[#FF4D6D] hover:text-white hover:bg-[#FF4D6D] rounded-lg transition-colors",title:"ADMIN: Xa bng  kha",children:t.jsx(sa,{size:18})})]})]})})]},E.id)})})]})}):t.jsxs("div",{className:"text-center py-16",children:[t.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl bg-[var(--bg-2)] flex items-center justify-center text-[var(--text-muted)]",children:t.jsx(ei,{size:28})}),t.jsx("p",{className:"text-[var(--text-muted)]",children:"Cha c bng lng no"}),t.jsxs(ft,{onClick:()=>s(!0),variant:"secondary",size:"sm",className:"mt-4",children:[t.jsx(Dt,{size:16}),"To bng lng u tin"]})]})}),t.jsxs(ns,{isOpen:r,onClose:()=>s(!1),size:"md",children:[t.jsx(Ss,{title:"To bng lng mi",subtitle:"Chn k lng v phng ban  to bng lng",icon:t.jsx(ei,{size:24})}),t.jsx(_s,{children:t.jsxs("div",{className:"space-y-5",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-1.5",children:"Thng"}),t.jsx("select",{value:f.thang,onChange:E=>p({...f,thang:Number(E.target.value)}),className:`
                    w-full h-10 px-4 rounded-xl
                    bg-[var(--bg-1)] border border-[var(--border)]
                    text-[var(--text-primary)]
                    focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                  `,children:Array.from({length:12},(E,C)=>C+1).map(E=>t.jsxs("option",{value:E,children:["Thng ",E]},E))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-1.5",children:"Nm"}),t.jsx("select",{value:f.nam,onChange:E=>p({...f,nam:Number(E.target.value)}),className:`
                    w-full h-10 px-4 rounded-xl
                    bg-[var(--bg-1)] border border-[var(--border)]
                    text-[var(--text-primary)]
                    focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                  `,children:[2024,2025,2026,2027].map(E=>t.jsx("option",{value:E,children:E},E))})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-1.5",children:["Phng ban ",t.jsx("span",{className:"text-[#FF4D6D]",children:"*"}),t.jsx("span",{className:"text-[var(--text-muted)] font-normal ml-1",children:"(chn nhiu)"})]}),t.jsxs("div",{className:"border border-[var(--border)] rounded-xl max-h-48 overflow-y-auto bg-[var(--bg-1)] modal-scroll",children:[t.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-[var(--accent-light)] cursor-pointer border-b border-[var(--border)] transition-colors",children:[t.jsx("input",{type:"checkbox",checked:b&&f.phongBanIds.length===b.length,onChange:E=>{E.target.checked?p({...f,phongBanIds:(b==null?void 0:b.map(C=>C.id))||[]}):p({...f,phongBanIds:[]})},className:"flex-shrink-0"}),t.jsxs("span",{className:"font-medium text-[var(--accent)]",children:["Chn tt c (",(b==null?void 0:b.length)||0," phng ban)"]})]}),b==null?void 0:b.map(E=>t.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-[var(--accent-light)] cursor-pointer transition-colors",children:[t.jsx("input",{type:"checkbox",checked:f.phongBanIds.includes(E.id),onChange:C=>{C.target.checked?p({...f,phongBanIds:[...f.phongBanIds,E.id]}):p({...f,phongBanIds:f.phongBanIds.filter(P=>P!==E.id)})},className:"flex-shrink-0"}),t.jsx("span",{className:"text-[var(--text-primary)] flex-1",children:E.tenPhongBan}),f.phongBanIds.includes(E.id)&&t.jsx(Br,{className:"w-4 h-4 text-[var(--accent)] flex-shrink-0"})]},E.id))]}),f.phongBanIds.length>0&&t.jsxs("p",{className:"text-xs text-[var(--accent)] mt-1.5 font-medium",children:["  chn: ",f.phongBanIds.length," phng ban"]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-1.5",children:["Tn bng lng",t.jsx("span",{className:"text-[var(--text-muted)] font-normal ml-1",children:"(tu chn)"})]}),t.jsx("input",{type:"text",value:f.tenBangLuong,onChange:E=>p({...f,tenBangLuong:E.target.value}),className:`
                  w-full h-10 px-4 rounded-xl
                  bg-[var(--bg-1)] border border-[var(--border)]
                  text-[var(--text-primary)] placeholder:text-[var(--text-disabled)]
                  focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                `,placeholder:"T ng to nu  trng"})]})]})}),t.jsxs(ni,{children:[t.jsx(ft,{variant:"secondary",onClick:()=>s(!1),children:"Hu"}),t.jsx(ft,{onClick:S,loading:j.isPending,icon:t.jsx(Dt,{size:16}),children:"To bng lng"})]})]})]})}function r6(e,n){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const a=document.implementation.createHTMLDocument(),r=a.createElement("base"),s=a.createElement("a");return a.head.appendChild(r),a.body.appendChild(s),n&&(r.href=n),s.href=e,s.href}const s6=(()=>{let e=0;const n=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${n()}${e}`)})();function sl(e){const n=[];for(let a=0,r=e.length;a<r;a++)n.push(e[a]);return n}let Qo=null;function Zj(e={}){return Qo||(e.includeStyleProperties?(Qo=e.includeStyleProperties,Qo):(Qo=sl(window.getComputedStyle(document.documentElement)),Qo))}function w0(e,n){const r=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(n);return r?parseFloat(r.replace("px","")):0}function i6(e){const n=w0(e,"border-left-width"),a=w0(e,"border-right-width");return e.clientWidth+n+a}function l6(e){const n=w0(e,"border-top-width"),a=w0(e,"border-bottom-width");return e.clientHeight+n+a}function ew(e,n={}){const a=n.width||i6(e),r=n.height||l6(e);return{width:a,height:r}}function o6(){let e,n;try{n=process}catch{}const a=n&&n.env?n.env.devicePixelRatio:null;return a&&(e=parseInt(a,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const dr=16384;function c6(e){(e.width>dr||e.height>dr)&&(e.width>dr&&e.height>dr?e.width>e.height?(e.height*=dr/e.width,e.width=dr):(e.width*=dr/e.height,e.height=dr):e.width>dr?(e.height*=dr/e.width,e.width=dr):(e.width*=dr/e.height,e.height=dr))}function k0(e){return new Promise((n,a)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>n(r))})},r.onerror=a,r.crossOrigin="anonymous",r.decoding="async",r.src=e})}async function d6(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(n=>`data:image/svg+xml;charset=utf-8,${n}`)}async function u6(e,n,a){const r="http://www.w3.org/2000/svg",s=document.createElementNS(r,"svg"),l=document.createElementNS(r,"foreignObject");return s.setAttribute("width",`${n}`),s.setAttribute("height",`${a}`),s.setAttribute("viewBox",`0 0 ${n} ${a}`),l.setAttribute("width","100%"),l.setAttribute("height","100%"),l.setAttribute("x","0"),l.setAttribute("y","0"),l.setAttribute("externalResourcesRequired","true"),s.appendChild(l),l.appendChild(e),d6(s)}const ar=(e,n)=>{if(e instanceof n)return!0;const a=Object.getPrototypeOf(e);return a===null?!1:a.constructor.name===n.name||ar(a,n)};function h6(e){const n=e.getPropertyValue("content");return`${e.cssText} content: '${n.replace(/'|"/g,"")}';`}function x6(e,n){return Zj(n).map(a=>{const r=e.getPropertyValue(a),s=e.getPropertyPriority(a);return`${a}: ${r}${s?" !important":""};`}).join(" ")}function m6(e,n,a,r){const s=`.${e}:${n}`,l=a.cssText?h6(a):x6(a,r);return document.createTextNode(`${s}{${l}}`)}function Ab(e,n,a,r){const s=window.getComputedStyle(e,a),l=s.getPropertyValue("content");if(l===""||l==="none")return;const o=s6();try{n.className=`${n.className} ${o}`}catch{return}const d=document.createElement("style");d.appendChild(m6(o,a,s,r)),n.appendChild(d)}function f6(e,n,a){Ab(e,n,":before",a),Ab(e,n,":after",a)}const Fb="application/font-woff",Lb="image/jpeg",p6={woff:Fb,woff2:Fb,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Lb,jpeg:Lb,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function g6(e){const n=/\.([^./]*?)$/g.exec(e);return n?n[1]:""}function xg(e){const n=g6(e).toLowerCase();return p6[n]||""}function y6(e){return e.split(/,/)[1]}function jp(e){return e.search(/^(data:)/)!==-1}function v6(e,n){return`data:${n};base64,${e}`}async function tw(e,n,a){const r=await fetch(e,n);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const s=await r.blob();return new Promise((l,o)=>{const d=new FileReader;d.onerror=o,d.onloadend=()=>{try{l(a({res:r,result:d.result}))}catch(u){o(u)}},d.readAsDataURL(s)})}const xf={};function b6(e,n,a){let r=e.replace(/\?.*/,"");return a&&(r=e),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),n?`[${n}]${r}`:r}async function mg(e,n,a){const r=b6(e,n,a.includeQueryParams);if(xf[r]!=null)return xf[r];a.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let s;try{const l=await tw(e,a.fetchRequestInit,({res:o,result:d})=>(n||(n=o.headers.get("Content-Type")||""),y6(d)));s=v6(l,n)}catch(l){s=a.imagePlaceholder||"";let o=`Failed to fetch resource: ${e}`;l&&(o=typeof l=="string"?l:l.message),o&&console.warn(o)}return xf[r]=s,s}async function N6(e){const n=e.toDataURL();return n==="data:,"?e.cloneNode(!1):k0(n)}async function j6(e,n){if(e.currentSrc){const l=document.createElement("canvas"),o=l.getContext("2d");l.width=e.clientWidth,l.height=e.clientHeight,o==null||o.drawImage(e,0,0,l.width,l.height);const d=l.toDataURL();return k0(d)}const a=e.poster,r=xg(a),s=await mg(a,r,n);return k0(s)}async function w6(e,n){var a;try{if(!((a=e==null?void 0:e.contentDocument)===null||a===void 0)&&a.body)return await ix(e.contentDocument.body,n,!0)}catch{}return e.cloneNode(!1)}async function k6(e,n){return ar(e,HTMLCanvasElement)?N6(e):ar(e,HTMLVideoElement)?j6(e,n):ar(e,HTMLIFrameElement)?w6(e,n):e.cloneNode(nw(e))}const T6=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",nw=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function C6(e,n,a){var r,s;if(nw(n))return n;let l=[];return T6(e)&&e.assignedNodes?l=sl(e.assignedNodes()):ar(e,HTMLIFrameElement)&&(!((r=e.contentDocument)===null||r===void 0)&&r.body)?l=sl(e.contentDocument.body.childNodes):l=sl(((s=e.shadowRoot)!==null&&s!==void 0?s:e).childNodes),l.length===0||ar(e,HTMLVideoElement)||await l.reduce((o,d)=>o.then(()=>ix(d,a)).then(u=>{u&&n.appendChild(u)}),Promise.resolve()),n}function S6(e,n,a){const r=n.style;if(!r)return;const s=window.getComputedStyle(e);s.cssText?(r.cssText=s.cssText,r.transformOrigin=s.transformOrigin):Zj(a).forEach(l=>{let o=s.getPropertyValue(l);l==="font-size"&&o.endsWith("px")&&(o=`${Math.floor(parseFloat(o.substring(0,o.length-2)))-.1}px`),ar(e,HTMLIFrameElement)&&l==="display"&&o==="inline"&&(o="block"),l==="d"&&n.getAttribute("d")&&(o=`path(${n.getAttribute("d")})`),r.setProperty(l,o,s.getPropertyPriority(l))})}function _6(e,n){ar(e,HTMLTextAreaElement)&&(n.innerHTML=e.value),ar(e,HTMLInputElement)&&n.setAttribute("value",e.value)}function E6(e,n){if(ar(e,HTMLSelectElement)){const r=Array.from(n.children).find(s=>e.value===s.getAttribute("value"));r&&r.setAttribute("selected","")}}function D6(e,n,a){return ar(n,Element)&&(S6(e,n,a),f6(e,n,a),_6(e,n),E6(e,n)),n}async function A6(e,n){const a=e.querySelectorAll?e.querySelectorAll("use"):[];if(a.length===0)return e;const r={};for(let l=0;l<a.length;l++){const d=a[l].getAttribute("xlink:href");if(d){const u=e.querySelector(d),x=document.querySelector(d);!u&&x&&!r[d]&&(r[d]=await ix(x,n,!0))}}const s=Object.values(r);if(s.length){const l="http://www.w3.org/1999/xhtml",o=document.createElementNS(l,"svg");o.setAttribute("xmlns",l),o.style.position="absolute",o.style.width="0",o.style.height="0",o.style.overflow="hidden",o.style.display="none";const d=document.createElementNS(l,"defs");o.appendChild(d);for(let u=0;u<s.length;u++)d.appendChild(s[u]);e.appendChild(o)}return e}async function ix(e,n,a){return!a&&n.filter&&!n.filter(e)?null:Promise.resolve(e).then(r=>k6(r,n)).then(r=>C6(e,r,n)).then(r=>D6(e,r,n)).then(r=>A6(r,n))}const aw=/url\((['"]?)([^'"]+?)\1\)/g,F6=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,L6=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function P6(e){const n=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${n})(['"]?\\))`,"g")}function I6(e){const n=[];return e.replace(aw,(a,r,s)=>(n.push(s),a)),n.filter(a=>!jp(a))}async function O6(e,n,a,r,s){try{const l=a?r6(n,a):n,o=xg(n);let d;return s||(d=await mg(l,o,r)),e.replace(P6(n),`$1${d}$3`)}catch{}return e}function M6(e,{preferredFontFormat:n}){return n?e.replace(L6,a=>{for(;;){const[r,,s]=F6.exec(a)||[];if(!s)return"";if(s===n)return`src: ${r};`}}):e}function rw(e){return e.search(aw)!==-1}async function sw(e,n,a){if(!rw(e))return e;const r=M6(e,a);return I6(r).reduce((l,o)=>l.then(d=>O6(d,o,n,a)),Promise.resolve(r))}async function Yo(e,n,a){var r;const s=(r=n.style)===null||r===void 0?void 0:r.getPropertyValue(e);if(s){const l=await sw(s,null,a);return n.style.setProperty(e,l,n.style.getPropertyPriority(e)),!0}return!1}async function R6(e,n){await Yo("background",e,n)||await Yo("background-image",e,n),await Yo("mask",e,n)||await Yo("-webkit-mask",e,n)||await Yo("mask-image",e,n)||await Yo("-webkit-mask-image",e,n)}async function B6(e,n){const a=ar(e,HTMLImageElement);if(!(a&&!jp(e.src))&&!(ar(e,SVGImageElement)&&!jp(e.href.baseVal)))return;const r=a?e.src:e.href.baseVal,s=await mg(r,xg(r),n);await new Promise((l,o)=>{e.onload=l,e.onerror=n.onImageErrorHandler?(...u)=>{try{l(n.onImageErrorHandler(...u))}catch(x){o(x)}}:o;const d=e;d.decode&&(d.decode=l),d.loading==="lazy"&&(d.loading="eager"),a?(e.srcset="",e.src=s):e.href.baseVal=s})}async function H6(e,n){const r=sl(e.childNodes).map(s=>iw(s,n));await Promise.all(r).then(()=>e)}async function iw(e,n){ar(e,Element)&&(await R6(e,n),await B6(e,n),await H6(e,n))}function V6(e,n){const{style:a}=e;n.backgroundColor&&(a.backgroundColor=n.backgroundColor),n.width&&(a.width=`${n.width}px`),n.height&&(a.height=`${n.height}px`);const r=n.style;return r!=null&&Object.keys(r).forEach(s=>{a[s]=r[s]}),e}const Pb={};async function Ib(e){let n=Pb[e];if(n!=null)return n;const r=await(await fetch(e)).text();return n={url:e,cssText:r},Pb[e]=n,n}async function Ob(e,n){let a=e.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,l=(a.match(/url\([^)]+\)/g)||[]).map(async o=>{let d=o.replace(r,"$1");return d.startsWith("https://")||(d=new URL(d,e.url).href),tw(d,n.fetchRequestInit,({result:u})=>(a=a.replace(o,`url(${u})`),[o,u]))});return Promise.all(l).then(()=>a)}function Mb(e){if(e==null)return[];const n=[],a=/(\/\*[\s\S]*?\*\/)/gi;let r=e.replace(a,"");const s=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const u=s.exec(r);if(u===null)break;n.push(u[0])}r=r.replace(s,"");const l=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,o="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",d=new RegExp(o,"gi");for(;;){let u=l.exec(r);if(u===null){if(u=d.exec(r),u===null)break;l.lastIndex=d.lastIndex}else d.lastIndex=l.lastIndex;n.push(u[0])}return n}async function U6(e,n){const a=[],r=[];return e.forEach(s=>{if("cssRules"in s)try{sl(s.cssRules||[]).forEach((l,o)=>{if(l.type===CSSRule.IMPORT_RULE){let d=o+1;const u=l.href,x=Ib(u).then(m=>Ob(m,n)).then(m=>Mb(m).forEach(f=>{try{s.insertRule(f,f.startsWith("@import")?d+=1:s.cssRules.length)}catch(p){console.error("Error inserting rule from remote css",{rule:f,error:p})}})).catch(m=>{console.error("Error loading remote css",m.toString())});r.push(x)}})}catch(l){const o=e.find(d=>d.href==null)||document.styleSheets[0];s.href!=null&&r.push(Ib(s.href).then(d=>Ob(d,n)).then(d=>Mb(d).forEach(u=>{o.insertRule(u,o.cssRules.length)})).catch(d=>{console.error("Error loading remote stylesheet",d)})),console.error("Error inlining remote css file",l)}}),Promise.all(r).then(()=>(e.forEach(s=>{if("cssRules"in s)try{sl(s.cssRules||[]).forEach(l=>{a.push(l)})}catch(l){console.error(`Error while reading CSS rules from ${s.href}`,l)}}),a))}function K6(e){return e.filter(n=>n.type===CSSRule.FONT_FACE_RULE).filter(n=>rw(n.style.getPropertyValue("src")))}async function z6(e,n){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const a=sl(e.ownerDocument.styleSheets),r=await U6(a,n);return K6(r)}function lw(e){return e.trim().replace(/["']/g,"")}function $6(e){const n=new Set;function a(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(l=>{n.add(lw(l))}),Array.from(r.children).forEach(l=>{l instanceof HTMLElement&&a(l)})}return a(e),n}async function G6(e,n){const a=await z6(e,n),r=$6(e);return(await Promise.all(a.filter(l=>r.has(lw(l.style.fontFamily))).map(l=>{const o=l.parentStyleSheet?l.parentStyleSheet.href:null;return sw(l.cssText,o,n)}))).join(`
`)}async function q6(e,n){const a=n.fontEmbedCSS!=null?n.fontEmbedCSS:n.skipFonts?null:await G6(e,n);if(a){const r=document.createElement("style"),s=document.createTextNode(a);r.appendChild(s),e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)}}async function W6(e,n={}){const{width:a,height:r}=ew(e,n),s=await ix(e,n,!0);return await q6(s,n),await iw(s,n),V6(s,n),await u6(s,a,r)}async function X6(e,n={}){const{width:a,height:r}=ew(e,n),s=await W6(e,n),l=await k0(s),o=document.createElement("canvas"),d=o.getContext("2d"),u=n.pixelRatio||o6(),x=n.canvasWidth||a,m=n.canvasHeight||r;return o.width=x*u,o.height=m*u,n.skipAutoScale||c6(o),o.style.width=`${x}`,o.style.height=`${m}`,n.backgroundColor&&(d.fillStyle=n.backgroundColor,d.fillRect(0,0,o.width,o.height)),d.drawImage(l,0,0,o.width,o.height),o}async function Q6(e,n={}){return(await X6(e,n)).toDataURL()}const Td=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),ow=D.forwardRef(({data:e},n)=>{var s,l,o,d,u,x,m,f,p,N;const a=e.cacKhoanLuong.filter(y=>y.loai==="THU_NHAP"),r=e.cacKhoanLuong.filter(y=>y.loai==="KHAU_TRU");return t.jsxs("div",{ref:n,className:"bg-white rounded-xl shadow-lg overflow-hidden max-w-2xl mx-auto",style:{width:"700px",fontFamily:"system-ui, -apple-system, sans-serif"},children:[t.jsxs("div",{className:"text-white text-center py-8 px-6",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[t.jsx("h1",{className:"text-3xl font-bold mb-1",children:"PHIU LNG"}),t.jsxs("p",{className:"text-lg opacity-90",children:["Thng ",e.thang," / ",e.nam]})]}),t.jsxs("div",{className:"text-center py-4 px-6 border-b-2 border-dashed border-gray-200 bg-gray-50",children:[((s=e.congTy)==null?void 0:s.logo)&&t.jsx("img",{src:e.congTy.logo,alt:"Logo cng ty",className:"h-12 mx-auto mb-2 object-contain"}),t.jsx("h2",{className:"text-xl font-bold text-gray-800",children:((l=e.congTy)==null?void 0:l.tenCongTy)||"CNG TY"}),((o=e.congTy)==null?void 0:o.diaChi)&&t.jsx("p",{className:"text-sm text-gray-600",children:e.congTy.diaChi}),(((d=e.congTy)==null?void 0:d.dienThoai)||((u=e.congTy)==null?void 0:u.email))&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[((x=e.congTy)==null?void 0:x.dienThoai)&&`T: ${e.congTy.dienThoai}`,((m=e.congTy)==null?void 0:m.dienThoai)&&((f=e.congTy)==null?void 0:f.email)&&" | ",((p=e.congTy)==null?void 0:p.email)&&`Email: ${e.congTy.email}`]}),((N=e.congTy)==null?void 0:N.maSoThue)&&t.jsxs("p",{className:"text-xs text-gray-500",children:["MST: ",e.congTy.maSoThue]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 p-6 bg-gray-50 border-b border-gray-200",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500",children:"H v tn"}),t.jsx("p",{className:"font-semibold text-gray-800",children:e.hoTen})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500",children:"M nhn vin"}),t.jsx("p",{className:"font-semibold text-gray-800",children:e.maNhanVien})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500",children:"Phng ban"}),t.jsx("p",{className:"font-semibold text-gray-800",children:e.phongBan})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500",children:"Chc v"}),t.jsx("p",{className:"font-semibold text-gray-800",children:e.chucVu||"Nhn vin"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("span",{className:"text-xs text-gray-500",children:"Ngy cng thc t"}),t.jsxs("p",{className:"font-semibold text-gray-800",children:[t.jsx("span",{className:"text-blue-600",children:e.ngayCongThucTe})," / ",e.ngayCongLyThuyet," ngy"]})]})]}),t.jsxs("div",{className:"p-6 border-b border-gray-100",children:[t.jsx("h3",{className:"text-base font-bold text-gray-800 mb-4 pb-2 border-b-2 border-green-500 inline-block",children:"THU NHP"}),t.jsx("div",{className:"space-y-3",children:a.map((y,g)=>t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-600",children:y.tenKhoan}),t.jsx("span",{className:"font-medium text-green-600",children:Td(y.soTien)})]},g))})]}),t.jsxs("div",{className:"p-6 border-b border-gray-100",children:[t.jsx("h3",{className:"text-base font-bold text-gray-800 mb-4 pb-2 border-b-2 border-red-500 inline-block",children:"KHU TR"}),t.jsx("div",{className:"space-y-3",children:r.length>0?r.map((y,g)=>t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-600",children:y.tenKhoan}),t.jsxs("span",{className:"font-medium text-red-600",children:["-",Td(y.soTien)]})]},g)):t.jsx("p",{className:"text-gray-400 italic",children:"Khng c khon khu tr"})})]}),t.jsxs("div",{className:"p-6 text-white",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[t.jsxs("div",{className:"flex justify-between items-center py-2",children:[t.jsx("span",{className:"opacity-90",children:"Tng thu nhp:"}),t.jsx("span",{className:"font-semibold",children:Td(e.tongThuNhap)})]}),t.jsxs("div",{className:"flex justify-between items-center py-2",children:[t.jsx("span",{className:"opacity-90",children:"Tng khu tr:"}),t.jsxs("span",{className:"font-semibold",children:["-",Td(e.tongKhauTru)]})]}),t.jsxs("div",{className:"flex justify-between items-center pt-4 mt-4 border-t border-white/30",children:[t.jsx("span",{className:"text-xl font-bold",children:"THC LNH:"}),t.jsx("span",{className:"text-2xl font-bold",children:Td(e.thucLinh)})]})]}),t.jsxs("div",{className:"text-center py-4 px-6 text-sm text-gray-500 border-t border-gray-100",children:[t.jsx("p",{children:"Phiu lng c to t ng bi h thng tnh lng."}),t.jsx("p",{children:"Nu c thc mc, vui lng lin h phng Nhn s."})]})]})});ow.displayName="PhieuLuong";function Y6({isOpen:e,onClose:n,bangLuongId:a,nhanVienId:r,hoTen:s}){const l=D.useRef(null),[o,d]=D.useState(!1),{data:u,isLoading:x,error:m}=Le({queryKey:["phieu-luong",a,r],queryFn:()=>Np.layPhieuLuong(a,r),enabled:e}),f=De({mutationFn:()=>Np.guiPhieuLuong(a,r),onSuccess:y=>{y.success?ie.success(y.message):ie.error(y.message)},onError:()=>{ie.error("C li khi gi email")}}),p=D.useCallback(async()=>{if(!(!l.current||!u)){d(!0);try{const y=await Q6(l.current,{cacheBust:!0,pixelRatio:2,backgroundColor:"#ffffff"}),g=document.createElement("a");g.download=`phieu-luong-${u.maNhanVien}-thang-${u.thang}-${u.nam}.png`,g.href=y,g.click(),ie.success(" xut phiu lng thnh cng!")}catch(y){console.error("Export error:",y),ie.error("C li khi xut nh")}finally{d(!1)}}},[u]),N=D.useCallback(()=>{if(!(u!=null&&u.email)){ie.error("Nhn vin khng c email");return}f.mutate()},[u==null?void 0:u.email,f]);return e?t.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[t.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:n}),t.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col mx-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gray-50",children:[t.jsxs("h2",{className:"text-lg font-bold text-gray-800",children:["Phiu lng - ",s]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:p,disabled:o||x,className:"btn btn-secondary flex items-center gap-2",children:[o?t.jsx(Rn,{size:18,className:"animate-spin"}):t.jsx(F_,{size:18}),"Xut nh"]}),t.jsxs("button",{onClick:N,disabled:f.isPending||x||!(u!=null&&u.email),className:"btn btn-primary flex items-center gap-2",title:u!=null&&u.email?"Gi phiu lng qua email":"Nhn vin khng c email",children:[f.isPending?t.jsx(Rn,{size:18,className:"animate-spin"}):t.jsx(ag,{size:18}),"Gi email"]}),t.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-200 rounded-lg",children:t.jsx(mn,{size:20})})]})]}),t.jsx("div",{className:"flex-1 overflow-auto p-6 bg-gray-100",children:x?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx(Rn,{size:40,className:"animate-spin text-blue-500"})}):m?t.jsx("div",{className:"text-center py-8",children:t.jsx("p",{className:"text-red-500",children:"C li khi ti phiu lng"})}):u?t.jsx(ow,{ref:l,data:u}):null}),u&&t.jsxs("div",{className:"p-3 bg-gray-50 border-t text-sm text-gray-600 flex items-center justify-between",children:[t.jsxs("span",{children:["Email: ",u.email||t.jsx("span",{className:"italic text-gray-400",children:"Cha c"})]}),t.jsxs("span",{children:["Thc lnh: ",t.jsx("strong",{className:"text-green-600",children:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(u.thucLinh)})]})]})]})]}):null}function J6({ngayCong:e,onClose:n,onSave:a,isLoading:r}){var m,f,p;const[s,l]=D.useState(((m=e==null?void 0:e.ngayCongDieuChinh)==null?void 0:m.toString())||""),[o,d]=D.useState((e==null?void 0:e.ghiChu)||"");if(!e)return null;const u=e.ngayCongDieuChinh?Number(e.ngayCongDieuChinh):Number(e.soCongThucTe)+Number(e.soNgayNghiPhep),x=async N=>{if(N.preventDefault(),!s)return;const y=parseFloat(s);if(isNaN(y)||y<0){alert("S ngy cng khng hp l");return}await a(y,o||void 0)};return t.jsx("div",{className:"modal-overlay",onClick:n,children:t.jsxs("div",{className:"modal-content max-w-lg",onClick:N=>N.stopPropagation(),children:[t.jsxs("div",{className:"modal-header",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Lt,{className:"w-5 h-5"}),t.jsx("h3",{className:"text-lg font-semibold",children:"iu chnh ngy cng"})]}),t.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:t.jsx(mn,{className:"w-5 h-5"})})]}),t.jsxs("form",{onSubmit:x,children:[t.jsxs("div",{className:"modal-body space-y-4",children:[t.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-sm text-gray-600",children:"Nhn vin"}),t.jsx("div",{className:"font-semibold text-gray-900",children:((f=e.nhanVien)==null?void 0:f.hoTen)||"N/A"}),t.jsx("div",{className:"text-sm text-gray-500",children:((p=e.nhanVien)==null?void 0:p.maNhanVien)||"N/A"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Ngy cng l thuyt"}),t.jsx("div",{className:"text-xl font-bold text-blue-700",children:Number(e.ngayCongLyThuyet).toFixed(1)})]}),t.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"S cng thc t"}),t.jsx("div",{className:"text-xl font-bold text-green-700",children:Number(e.soCongThucTe).toFixed(1)})]}),t.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Ngh c php"}),t.jsx("div",{className:"text-xl font-bold text-yellow-700",children:Number(e.soNgayNghiPhep).toFixed(1)})]}),t.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Ngh khng php"}),t.jsx("div",{className:"text-xl font-bold text-red-700",children:Number(e.soNgayNghiKhongPhep).toFixed(1)})]})]}),t.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border-2 border-purple-200",children:[t.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Ngy cng hin ti (dng  tnh lng)"}),t.jsxs("div",{className:"text-2xl font-bold text-purple-700",children:[u.toFixed(1)," ngy"]}),e.ngayCongDieuChinh&&t.jsx("div",{className:"text-xs text-purple-600 mt-1",children:"  iu chnh th cng"})]}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsx("label",{className:"label",children:t.jsx("span",{className:"label-text font-semibold",children:"iu chnh ngy cng mi"})}),t.jsx("input",{type:"number",step:"0.5",min:"0",max:Number(e.ngayCongLyThuyet),className:"input input-bordered w-full",value:s,onChange:N=>l(N.target.value),placeholder:"Nhp s ngy cng",required:!0}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Nhp s ngy cng mi  iu chnh th cng"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"label",children:t.jsx("span",{className:"label-text font-semibold",children:"Ghi ch"})}),t.jsx("textarea",{className:"textarea textarea-bordered w-full",rows:3,value:o,onChange:N=>d(N.target.value),placeholder:"L do iu chnh..."})]}),t.jsxs("div",{className:"flex items-start gap-2 bg-yellow-50 p-3 rounded-lg border border-yellow-200",children:[t.jsx(di,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"text-sm text-yellow-800",children:[t.jsx("div",{className:"font-semibold mb-1",children:"Lu :"}),t.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[t.jsx("li",{children:"iu chnh ngy cng s nh hng n lng c bn"}),t.jsx("li",{children:"Nn c l do r rng trong phn ghi ch"}),t.jsx("li",{children:"C th xa iu chnh  tr v tnh t ng"})]})]})]})]}),t.jsxs("div",{className:"modal-footer",children:[t.jsx("button",{type:"button",onClick:n,className:"btn btn-ghost",children:"Hy"}),t.jsx("button",{type:"submit",className:"btn btn-primary",disabled:r||!s,children:r?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"loading loading-spinner loading-sm"}),"ang lu..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Es,{className:"w-4 h-4"}),"Lu iu chnh"]})})]})]})]})})}const Z6="column_config_";function fg(e,n){const a=`${Z6}${e}`,r=D.useRef(""),[s,l]=D.useState([]),o=D.useMemo(()=>{if(n.length===0)return[];try{const b=localStorage.getItem(a);if(b){const j=JSON.parse(b),T=new Map(j.columns.map(S=>[S.id,S]));return n.map((S,w)=>{const _=T.get(S.id);return _?{...S,visible:_.visible,order:_.order}:{...S,order:100+w}}).sort((S,w)=>S.order-w.order)}}catch(b){console.warn("Failed to load column config:",b)}return n.map((b,j)=>({...b,order:j}))},[n,a]);D.useEffect(()=>{const b=n.map(j=>j.id).join(",");o.length>0&&b!==r.current&&(l(o),r.current=b)},[o,n]);const d=D.useCallback(b=>{if(b.length===0)return;const j={columns:b.map(T=>({id:T.id,label:T.label,visible:T.visible,order:T.order,sticky:T.sticky})),version:1};localStorage.setItem(a,JSON.stringify(j))},[a]),u=D.useCallback(b=>{l(j=>{const T=j.map(S=>S.id===b&&!S.sticky?{...S,visible:!S.visible}:S);return d(T),T})},[d]),x=D.useCallback((b,j)=>{l(T=>{const S=T.map(w=>w.id===b&&!w.sticky?{...w,visible:j}:w);return d(S),S})},[d]),m=D.useCallback(()=>{l(b=>{const j=b.map(T=>({...T,visible:!0}));return d(j),j})},[d]),f=D.useCallback(()=>{l(b=>{const j=b.map(T=>({...T,visible:T.sticky||!1}));return d(j),j})},[d]),p=D.useCallback((b,j)=>{l(T=>{const S=[...T],[w]=S.splice(b,1);S.splice(j,0,w);const _=S.map((E,C)=>({...E,order:C}));return d(_),_})},[d]),N=D.useCallback(()=>{const b=n.map((j,T)=>({...j,order:T,visible:!0}));l(b),d(b),localStorage.removeItem(a)},[n,d,a]),y=s.filter(b=>b.visible).sort((b,j)=>b.order-j.order),g=D.useCallback(()=>y.map(b=>({id:b.id,label:b.label})),[y]);return{columns:s,visibleColumns:y,toggleColumn:u,setColumnVisibility:x,showAllColumns:m,hideOptionalColumns:f,moveColumn:p,resetColumns:N,getExportColumns:g}}function cw(e,n,a){const r=[{id:"stt",label:"STT",visible:!0,order:0,sticky:!0,width:"50px",align:"center"},{id:"maNV",label:"M NV",visible:!0,order:1,sticky:!0,width:"80px"},{id:"hoTen",label:"H tn",visible:!0,order:2,sticky:!0,width:"180px"},{id:"chucVu",label:"Chc v",visible:!0,order:3,width:"120px"},{id:"ngayCong",label:"Ngy cng",visible:!0,order:4,align:"center",bgColor:"bg-orange-100"},{id:"ncDieuChinh",label:"NC iu chnh",visible:!0,order:5,align:"center",bgColor:"bg-orange-100"}];let s=6;return n&&(a==="CHIA_HANG"||a==="CA_HAI")&&r.push({id:"spDat",label:"SP t",visible:!0,order:s++,align:"right",bgColor:"bg-cyan-100"},{id:"spLoi",label:"SP li",visible:!0,order:s++,align:"right",bgColor:"bg-cyan-100"}),n&&(a==="GIAO_HANG"||a==="CA_HAI")&&r.push({id:"klGiao",label:"KL giao (kg)",visible:!0,order:s++,align:"right",bgColor:"bg-teal-100"},{id:"treGio",label:"Tr gi",visible:!0,order:s++,align:"right",bgColor:"bg-teal-100"}),e.forEach(l=>{r.push({id:`kl_${l.id}`,label:l.tenKhoan,visible:!0,order:s++,align:"right",width:"120px"})}),r.push({id:"tongThuNhap",label:"Tng thu nhp",visible:!0,order:s++,align:"right",bgColor:"bg-blue-100"},{id:"khauTru",label:"Khu tr",visible:!0,order:s++,align:"right",bgColor:"bg-red-100"},{id:"thucLinh",label:"Thc lnh",visible:!0,order:s++,align:"right",bgColor:"bg-green-100"},{id:"phieuLuong",label:"Phiu lng",visible:!0,order:s++,align:"center",bgColor:"bg-purple-100"}),r}function eD(){return[{id:"stt",label:"STT",visible:!0,order:0,sticky:!0,width:"50px",align:"center"},{id:"maNV",label:"M NV",visible:!0,order:1,sticky:!0,width:"80px"},{id:"hoTen",label:"H tn",visible:!0,order:2,sticky:!0,width:"180px"},{id:"phongBan",label:"Phng ban",visible:!0,order:3,width:"150px"},{id:"soTien",label:"S tin ng",visible:!0,order:4,align:"right",width:"130px"},{id:"ngayUng",label:"Ngy ng",visible:!0,order:5,align:"center",width:"120px"},{id:"lyDo",label:"L do",visible:!0,order:6,width:"200px"},{id:"trangThai",label:"Trng thi",visible:!0,order:7,align:"center",width:"120px"},{id:"nguoiDuyet",label:"Ngi duyt",visible:!0,order:8,width:"150px"},{id:"ngayDuyet",label:"Ngy duyt",visible:!0,order:9,align:"center",width:"120px"},{id:"thaoTac",label:"Thao tc",visible:!0,order:10,align:"center",width:"100px"}]}function tD(){const{id:e}=q0(),n=br(),a=Mt(),[r,s]=D.useState(null),[l,o]=D.useState(new Map),[d,u]=D.useState(!1),[x,m]=D.useState(!1),[f,p]=D.useState(""),[N,y]=D.useState(null),[g,b]=D.useState(null),{data:j,isLoading:T}=Le({queryKey:["bang-luong",e],queryFn:()=>Or.layTheoId(Number(e)),enabled:!!e}),{data:S}=Le({queryKey:["ngay-cong",e],queryFn:()=>Eb.layTatCa(Number(e)),enabled:!!e}),{data:w}=Le({queryKey:["bang-luong-lich-su",e],queryFn:()=>Or.layLichSu(Number(e)),enabled:!!e&&d}),_=De({mutationFn:Or.capNhatNhieuChiTiet,onSuccess:()=>{a.invalidateQueries({queryKey:["bang-luong",e]}),o(new Map),ie.success("Lu thay i thnh cng!")},onError:()=>{ie.error("C li khi lu")}}),E=De({mutationFn:({nguoiChot:z})=>Or.chotBangLuong(Number(e),{nguoiChot:z}),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-luong",e]}),ie.success("Cht bng lng thnh cng!"),m(!1)},onError:()=>{ie.error("C li khi cht")}}),C=De({mutationFn:()=>Or.moKhoa(Number(e)),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-luong",e]}),ie.success("M kha thnh cng!")}}),P=De({mutationFn:()=>Np.guiTatCa(Number(e)),onSuccess:z=>{z.success>0&&ie.success(` gi ${z.success} phiu lng thnh cng!`),z.failed>0&&ie.error(`${z.failed} phiu lng gi tht bi`)},onError:()=>{ie.error("C li khi gi phiu lng")}}),F=De({mutationFn:({nhanVienId:z,ngayCongMoi:xe,ghiChu:H})=>Eb.dieuChinh(Number(e),z,{ngayCongMoi:xe,ghiChu:H}),onSuccess:()=>{a.invalidateQueries({queryKey:["ngay-cong",e]}),a.invalidateQueries({queryKey:["bang-luong",e]}),ie.success("Cp nht ngy cng thnh cng!"),b(null)},onError:()=>{ie.error("C li khi cp nht ngy cng")}}),R=De({mutationFn:()=>Or.tinhLaiLuong(Number(e)),onSuccess:z=>{a.invalidateQueries({queryKey:["bang-luong",e]}),ie.success(z.message)},onError:()=>{ie.error("C li khi tnh li lng")}}),O=z=>{const xe=S==null?void 0:S.find(H=>H.nhanVienId===z);if(xe)b(xe);else{const H=j==null?void 0:j.danhSachNhanVien.find(ne=>ne.nhanVienId===z);if(H&&j){const ne={id:0,bangLuongId:j.id,nhanVienId:z,ngayCongLyThuyet:j.ngayCongLyThuyet,soCongThucTe:H.ngayCongThucTe,soNgayNghiPhep:0,soNgayNghiKhongPhep:0,ngayCongDieuChinh:null,ghiChu:null,nhanVien:{id:z,maNhanVien:H.maNhanVien,hoTen:H.hoTen}};b(ne)}else ie.error("Khng tm thy thng tin nhn vin")}},M=async(z,xe)=>{g&&await F.mutateAsync({nhanVienId:g.nhanVienId,ngayCongMoi:z,ghiChu:xe})},q=(z,xe,H)=>{(j==null?void 0:j.trangThai)==="NHAP"&&s({nhanVienId:z,khoanLuongId:xe,value:H.toString()})},J=z=>{r&&s({...r,value:z})},B=()=>{var oe;if(!r||!j)return;const z=GE(r.value),xe=`${r.nhanVienId}-${r.khoanLuongId}`,H=j.danhSachNhanVien.find(Se=>Se.nhanVienId===r.nhanVienId),ne=((oe=H==null?void 0:H.cacKhoanLuong.find(Se=>Se.khoanLuongId===r.khoanLuongId))==null?void 0:oe.soTien)||0;if(z!==ne){const Se=new Map(l);Se.set(xe,{nhanVienId:r.nhanVienId,khoanLuongId:r.khoanLuongId,soTien:z}),o(Se)}s(null)},ue=z=>{z.key==="Enter"?B():z.key==="Escape"&&s(null)},te=()=>{if(l.size===0){ie("Khng c thay i  lu");return}const z=Array.from(l.values()).map(xe=>({bangLuongId:Number(e),...xe}));_.mutate(z)},Z=async()=>{try{const z=I(),xe=await x0.export(Number(e),z);WE(xe.data,`bang-luong-${e}.xlsx`),ie.success("Xut file thnh cng!")}catch{ie.error("C li khi xut file")}},Q=D.useCallback((z,xe,H)=>{const ne=`${z}-${xe}`,oe=l.get(ne);return oe?oe.soTien:H},[l]),fe=D.useCallback(z=>{let xe=0,H=0;for(const ne of z.cacKhoanLuong){const oe=Q(z.nhanVienId,ne.khoanLuongId,ne.soTien);ne.loai==="THU_NHAP"?xe+=oe:H+=oe}return l.forEach(ne=>{if(ne.nhanVienId===z.nhanVienId&&!z.cacKhoanLuong.find(Se=>Se.khoanLuongId===ne.khoanLuongId)){const Se=j==null?void 0:j.danhSachKhoanLuong.find(V=>V.id===ne.khoanLuongId);(Se==null?void 0:Se.loai)==="THU_NHAP"?xe+=ne.soTien:H+=ne.soTien}}),{tongThuNhap:xe,tongKhauTru:H,thucLinh:xe-H}},[Q,l,j==null?void 0:j.danhSachKhoanLuong]),K=l.size>0,L=D.useMemo(()=>j?cw(j.danhSachKhoanLuong,j.coSanLuong||!1,j.loaiSanLuong):[],[j]),{visibleColumns:X,getExportColumns:I}=fg("global_bang_luong",L);if(D.useEffect(()=>{const z=xe=>{if(K)return xe.preventDefault(),xe.returnValue="Bn c thay i cha lu. Bn c chc mun ri i?",xe.returnValue};return window.addEventListener("beforeunload",z),()=>window.removeEventListener("beforeunload",z)},[K]),T)return t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"text-gray-500",children:"ang ti..."})});if(!j)return t.jsxs("div",{className:"text-center py-8",children:[t.jsx("p",{className:"text-gray-500",children:"Khng tm thy bng lng"}),t.jsx("button",{onClick:()=>n("/bang-luong"),className:"btn btn-primary mt-4",children:"Quay li"})]});const W=j.trangThai==="NHAP";return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>n("/bang-luong"),className:"p-2 hover:bg-gray-200 rounded-lg",children:t.jsx(Q0,{size:20})}),t.jsxs("div",{children:[t.jsxs("h1",{className:"text-xl font-bold text-gray-800",children:["Bng lng ",j.phongBan.tenPhongBan]}),t.jsxs("p",{className:"text-sm text-gray-500",children:["Thng ",j.thang,"/",j.nam]})]}),t.jsxs("span",{className:`badge ${j.trangThai==="NHAP"?"badge-nhap":j.trangThai==="DA_CHOT"?"badge-da-chot":"badge-khoa"}`,children:[j.trangThai==="NHAP"&&"ang nhp",j.trangThai==="DA_CHOT"&&" cht",j.trangThai==="KHOA"&&" kha"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[l.size>0&&t.jsxs("span",{className:"text-sm text-orange-600 mr-2",children:[l.size," thay i cha lu"]}),W&&l.size>0&&t.jsxs("button",{onClick:te,disabled:_.isPending,className:"btn btn-success",children:[t.jsx(Es,{size:18}),"Lu (",l.size,")"]}),t.jsxs("button",{onClick:Z,className:"btn btn-secondary",children:[t.jsx(ws,{size:18}),"Xut Excel"]}),t.jsxs("button",{onClick:()=>u(!d),className:"btn btn-secondary",children:[t.jsx(gu,{size:18}),"Lch s"]}),t.jsxs("button",{onClick:()=>P.mutate(),disabled:P.isPending,className:"btn btn-secondary",title:"Gi phiu lng cho tt c nhn vin qua email",children:[P.isPending?t.jsx(Rn,{size:18,className:"animate-spin"}):t.jsx(ag,{size:18}),"Gi tt c"]}),W&&t.jsxs("button",{onClick:()=>R.mutate(),disabled:R.isPending,className:"btn btn-secondary",title:"Tnh li lng theo ngy cng",children:[R.isPending?t.jsx(Rn,{size:18,className:"animate-spin"}):t.jsx(yr,{size:18}),"Tnh li lng"]}),W&&t.jsxs("button",{onClick:()=>m(!0),className:"btn btn-primary",children:[t.jsx(ti,{size:18}),"Cht"]}),j.trangThai==="DA_CHOT"&&t.jsxs("button",{onClick:()=>C.mutate(),className:"btn btn-secondary",children:[t.jsx(rg,{size:18}),"M kha"]})]})]}),t.jsx("div",{className:"card overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"excel-table w-full",children:[t.jsx("thead",{children:t.jsx("tr",{children:X.map(z=>z.id==="stt"?t.jsx("th",{className:"sticky left-0 z-20 bg-gray-200",children:"STT"},z.id):z.id==="maNV"?t.jsx("th",{className:"sticky left-10 z-20 bg-gray-200 min-w-[80px]",children:"M NV"},z.id):z.id==="hoTen"?t.jsx("th",{className:"sticky left-[120px] z-20 bg-gray-200 min-w-[180px]",children:"H tn"},z.id):z.id==="chucVu"?t.jsx("th",{className:"min-w-[120px]",children:z.label},z.id):z.id==="ngayCong"?t.jsx("th",{className:"min-w-[80px] text-center bg-orange-100",children:z.label},z.id):z.id==="ncDieuChinh"?t.jsx("th",{className:"min-w-[100px] text-center bg-orange-100",children:z.label},z.id):z.id==="spDat"&&j.coSanLuong&&(j.loaiSanLuong==="CHIA_HANG"||j.loaiSanLuong==="CA_HAI")?t.jsx("th",{className:"min-w-[90px] text-right bg-cyan-100",children:z.label},z.id):z.id==="spLoi"&&j.coSanLuong&&(j.loaiSanLuong==="CHIA_HANG"||j.loaiSanLuong==="CA_HAI")?t.jsx("th",{className:"min-w-[80px] text-right bg-cyan-100",children:z.label},z.id):z.id==="klGiao"&&j.coSanLuong&&(j.loaiSanLuong==="GIAO_HANG"||j.loaiSanLuong==="CA_HAI")?t.jsx("th",{className:"min-w-[100px] text-right bg-teal-100",children:z.label},z.id):z.id==="treGio"&&j.coSanLuong&&(j.loaiSanLuong==="GIAO_HANG"||j.loaiSanLuong==="CA_HAI")?t.jsx("th",{className:"min-w-[80px] text-right bg-teal-100",children:z.label},z.id):z.id==="tongThuNhap"?t.jsx("th",{className:"min-w-[130px] text-right bg-blue-100",children:z.label},z.id):z.id==="khauTru"?t.jsx("th",{className:"min-w-[100px] text-right bg-red-100",children:z.label},z.id):z.id==="thucLinh"?t.jsx("th",{className:"min-w-[130px] text-right bg-green-100",children:z.label},z.id):z.id==="phieuLuong"?t.jsx("th",{className:"min-w-[80px] text-center bg-purple-100",children:z.label},z.id):z.id.startsWith("kl_")?t.jsx("th",{className:"min-w-[120px] text-right",children:z.label},z.id):null)})}),t.jsx("tbody",{children:j.danhSachNhanVien.map((z,xe)=>{const H=fe(z),ne=S==null?void 0:S.find(Se=>Se.nhanVienId===z.nhanVienId),oe=ne!=null&&ne.ngayCongDieuChinh?Number(ne.ngayCongDieuChinh):ne?Number(ne.soCongThucTe)+Number(ne.soNgayNghiPhep):z.ngayCongThucTe;return t.jsx("tr",{children:X.map(Se=>{var V,be,Oe,tt,Je,Re,Rt,un,hn,Cn,Ha;if(Se.id==="stt")return t.jsx("td",{className:"sticky left-0 bg-white",children:xe+1},Se.id);if(Se.id==="maNV")return t.jsx("td",{className:"sticky left-10 bg-white font-medium",children:z.maNhanVien},Se.id);if(Se.id==="hoTen")return t.jsx("td",{className:"sticky left-[120px] bg-white",children:z.hoTen},Se.id);if(Se.id==="chucVu")return t.jsx("td",{children:z.chucVu||"-"},Se.id);if(Se.id==="ngayCong")return t.jsxs("td",{className:"text-center bg-orange-50 relative group",children:[t.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t.jsxs("span",{className:`font-medium ${ne!=null&&ne.ngayCongDieuChinh?"text-orange-600":""}`,children:[oe.toFixed(1),"/",j.ngayCongLyThuyet]}),W&&t.jsx("button",{onClick:()=>O(z.nhanVienId),className:"opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-orange-200 rounded",title:"Chi tit v iu chnh",children:t.jsx(xj,{className:"w-3 h-3 text-orange-600"})}),(ne==null?void 0:ne.ngayCongDieuChinh)&&t.jsx("span",{className:"text-xs text-orange-600",title:" iu chnh th cng",children:""})]}),ne&&t.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[t.jsxs("span",{className:"text-green-600",children:[Number(ne.soNgayNghiPhep).toFixed(1),"P"]}),Number(ne.soNgayNghiKhongPhep)>0&&t.jsxs("span",{className:"text-red-600 ml-1",children:[Number(ne.soNgayNghiKhongPhep).toFixed(1),"KP"]})]})]},Se.id);if(Se.id==="ncDieuChinh")return t.jsx("td",{className:`text-center bg-orange-50 ${W?"cursor-pointer hover:bg-orange-100":""}`,onClick:()=>W&&O(z.nhanVienId),title:W?"Click  iu chnh ngy cng":"",children:ne!=null&&ne.ngayCongDieuChinh?t.jsx("span",{className:"font-medium text-orange-600",children:Number(ne.ngayCongDieuChinh).toFixed(1)}):t.jsx("span",{className:W?"text-blue-500 hover:underline":"text-gray-400",children:W?"Nhp":"-"})},Se.id);if(Se.id==="spDat"&&j.coSanLuong&&(j.loaiSanLuong==="CHIA_HANG"||j.loaiSanLuong==="CA_HAI"))return t.jsx("td",{className:"text-right bg-cyan-50 font-medium",children:((Oe=(be=(V=z.sanLuong)==null?void 0:V.chiaHang)==null?void 0:be.tongSpDat)==null?void 0:Oe.toLocaleString("vi-VN"))||"-"},Se.id);if(Se.id==="spLoi"&&j.coSanLuong&&(j.loaiSanLuong==="CHIA_HANG"||j.loaiSanLuong==="CA_HAI"))return t.jsx("td",{className:"text-right bg-cyan-50 text-red-600",children:((Re=(Je=(tt=z.sanLuong)==null?void 0:tt.chiaHang)==null?void 0:Je.tongSpLoi)==null?void 0:Re.toLocaleString("vi-VN"))||"-"},Se.id);if(Se.id==="klGiao"&&j.coSanLuong&&(j.loaiSanLuong==="GIAO_HANG"||j.loaiSanLuong==="CA_HAI"))return t.jsx("td",{className:"text-right bg-teal-50 font-medium",children:((hn=(un=(Rt=z.sanLuong)==null?void 0:Rt.giaoHang)==null?void 0:un.tongKhoiLuongThanhCong)==null?void 0:hn.toLocaleString("vi-VN"))||"-"},Se.id);if(Se.id==="treGio"&&j.coSanLuong&&(j.loaiSanLuong==="GIAO_HANG"||j.loaiSanLuong==="CA_HAI"))return t.jsx("td",{className:"text-right bg-teal-50 text-orange-600",children:((Ha=(Cn=z.sanLuong)==null?void 0:Cn.giaoHang)==null?void 0:Ha.tongSoLanTreGio)||"-"},Se.id);if(Se.id==="tongThuNhap")return t.jsx("td",{className:"number font-semibold bg-blue-50",children:Ye(H.tongThuNhap)},Se.id);if(Se.id==="khauTru")return t.jsx("td",{className:"number text-red-600 bg-red-50",children:Ye(H.tongKhauTru)},Se.id);if(Se.id==="thucLinh")return t.jsx("td",{className:"number font-bold text-green-600 bg-green-50",children:Ye(H.thucLinh)},Se.id);if(Se.id==="phieuLuong")return t.jsx("td",{className:"text-center bg-purple-50",children:t.jsx("button",{onClick:()=>y({id:z.nhanVienId,hoTen:z.hoTen}),className:"p-1.5 hover:bg-purple-200 rounded-lg text-purple-600 transition-colors",title:"Xem phiu lng",children:t.jsx(ma,{size:18})})},Se.id);if(Se.id.startsWith("kl_")){const Bn=parseInt(Se.id.replace("kl_","")),Be=z.cacKhoanLuong.find(fn=>fn.khoanLuongId===Bn),Qe=(Be==null?void 0:Be.soTien)||0,Ct=Q(z.nhanVienId,Bn,Qe),Ht=(r==null?void 0:r.nhanVienId)===z.nhanVienId&&(r==null?void 0:r.khoanLuongId)===Bn,kt=l.has(`${z.nhanVienId}-${Bn}`);return t.jsx("td",{className:`number ${W?"editable":""} ${kt?"bg-yellow-100":""}`,onClick:()=>q(z.nhanVienId,Bn,Ct),children:Ht?t.jsx("input",{type:"text",value:r.value,onChange:fn=>J(fn.target.value),onBlur:B,onKeyDown:ue,className:"cell-input",autoFocus:!0}):Ye(Ct)},Se.id)}return null})},z.nhanVienId)})}),t.jsx("tfoot",{children:t.jsx("tr",{className:"total-row",children:X.map(z=>{if(["stt","maNV","hoTen","chucVu"].includes(z.id)){if(z.id==="stt"){const xe=X.filter(H=>["stt","maNV","hoTen","chucVu"].includes(H.id)).length;return t.jsx("td",{colSpan:xe,className:"text-right font-bold",children:"TNG CNG"},z.id)}return null}if(z.id==="ngayCong")return t.jsx("td",{className:"bg-orange-100"},z.id);if(z.id==="ncDieuChinh")return t.jsx("td",{className:"bg-orange-100"},z.id);if(z.id==="spDat"&&j.coSanLuong&&(j.loaiSanLuong==="CHIA_HANG"||j.loaiSanLuong==="CA_HAI"))return t.jsx("td",{className:"number font-bold bg-cyan-100",children:j.danhSachNhanVien.reduce((xe,H)=>{var ne,oe;return xe+(((oe=(ne=H.sanLuong)==null?void 0:ne.chiaHang)==null?void 0:oe.tongSpDat)||0)},0).toLocaleString("vi-VN")},z.id);if(z.id==="spLoi"&&j.coSanLuong&&(j.loaiSanLuong==="CHIA_HANG"||j.loaiSanLuong==="CA_HAI"))return t.jsx("td",{className:"number font-bold text-red-600 bg-cyan-100",children:j.danhSachNhanVien.reduce((xe,H)=>{var ne,oe;return xe+(((oe=(ne=H.sanLuong)==null?void 0:ne.chiaHang)==null?void 0:oe.tongSpLoi)||0)},0).toLocaleString("vi-VN")},z.id);if(z.id==="klGiao"&&j.coSanLuong&&(j.loaiSanLuong==="GIAO_HANG"||j.loaiSanLuong==="CA_HAI"))return t.jsx("td",{className:"number font-bold bg-teal-100",children:j.danhSachNhanVien.reduce((xe,H)=>{var ne,oe;return xe+(((oe=(ne=H.sanLuong)==null?void 0:ne.giaoHang)==null?void 0:oe.tongKhoiLuongThanhCong)||0)},0).toLocaleString("vi-VN")},z.id);if(z.id==="treGio"&&j.coSanLuong&&(j.loaiSanLuong==="GIAO_HANG"||j.loaiSanLuong==="CA_HAI"))return t.jsx("td",{className:"number font-bold text-orange-600 bg-teal-100",children:j.danhSachNhanVien.reduce((xe,H)=>{var ne,oe;return xe+(((oe=(ne=H.sanLuong)==null?void 0:ne.giaoHang)==null?void 0:oe.tongSoLanTreGio)||0)},0)},z.id);if(z.id==="tongThuNhap")return t.jsx("td",{className:"number font-bold bg-blue-100",children:Ye(j.danhSachNhanVien.reduce((xe,H)=>xe+fe(H).tongThuNhap,0))},z.id);if(z.id==="khauTru")return t.jsx("td",{className:"number font-bold text-red-600 bg-red-100",children:Ye(j.danhSachNhanVien.reduce((xe,H)=>xe+fe(H).tongKhauTru,0))},z.id);if(z.id==="thucLinh")return t.jsx("td",{className:"number font-bold text-green-600 bg-green-100",children:Ye(j.danhSachNhanVien.reduce((xe,H)=>xe+fe(H).thucLinh,0))},z.id);if(z.id==="phieuLuong")return t.jsx("td",{className:"bg-purple-100"},z.id);if(z.id.startsWith("kl_")){const xe=parseInt(z.id.replace("kl_","")),H=j.danhSachNhanVien.reduce((ne,oe)=>{const Se=oe.cacKhoanLuong.find(V=>V.khoanLuongId===xe);return ne+Q(oe.nhanVienId,xe,(Se==null?void 0:Se.soTien)||0)},0);return t.jsx("td",{className:"number font-bold",children:Ye(H)},z.id)}return null})})})]})})}),d&&t.jsxs("div",{className:"card mt-4",children:[t.jsx("h3",{className:"font-semibold mb-3",children:"Lch s chnh sa"}),w&&w.length>0?t.jsx("div",{className:"max-h-64 overflow-y-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b",children:[t.jsx("th",{className:"text-left py-2",children:"Thi gian"}),t.jsx("th",{className:"text-left py-2",children:"Nhn vin"}),t.jsx("th",{className:"text-left py-2",children:"Khon"}),t.jsx("th",{className:"text-right py-2",children:"C"}),t.jsx("th",{className:"text-right py-2",children:"Mi"}),t.jsx("th",{className:"text-left py-2",children:"Ngi sa"})]})}),t.jsx("tbody",{children:w.map(z=>{var xe,H;return t.jsxs("tr",{className:"border-b",children:[t.jsx("td",{className:"py-2",children:new Date(z.ngayThayDoi).toLocaleString("vi-VN")}),t.jsx("td",{className:"py-2",children:(xe=z.nhanVien)==null?void 0:xe.hoTen}),t.jsx("td",{className:"py-2",children:(H=z.khoanLuong)==null?void 0:H.tenKhoan}),t.jsx("td",{className:"py-2 text-right",children:Ye(z.giaTriCu)}),t.jsx("td",{className:"py-2 text-right font-medium",children:Ye(z.giaTriMoi)}),t.jsx("td",{className:"py-2",children:z.nguoiThayDoi})]},z.id)})})]})}):t.jsx("p",{className:"text-gray-500",children:"Cha c lch s chnh sa"})]}),x&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Cht bng lng"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"Sau khi cht, bng lng s khng th chnh sa. Bn c chc chn?"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngi cht *"}),t.jsx("input",{type:"text",value:f,onChange:z=>p(z.target.value),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp tn ngi cht"})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsxs("button",{onClick:()=>m(!1),className:"btn btn-secondary",children:[t.jsx(mn,{size:18}),"Hy"]}),t.jsxs("button",{onClick:()=>E.mutate({nguoiChot:f}),disabled:!f||E.isPending,className:"btn btn-primary",children:[t.jsx(Br,{size:18}),"Xc nhn cht"]})]})]})}),N&&t.jsx(Y6,{isOpen:!!N,onClose:()=>y(null),bangLuongId:Number(e),nhanVienId:N.id,hoTen:N.hoTen}),g&&t.jsx(J6,{ngayCong:g,onClose:()=>b(null),onSave:M,isLoading:F.isPending})]})}const dw=["Thng 1","Thng 2","Thng 3","Thng 4","Thng 5","Thng 6","Thng 7","Thng 8","Thng 9","Thng 10","Thng 11","Thng 12"],nD=["Th1","Th2","Th3","Th4","Th5","Th6","Th7","Th8","Th9","Th10","Th11","Th12"],aD=["CN","T2","T3","T4","T5","T6","T7"];function Ut({value:e,onChange:n,className:a="",placeholder:r="Chn ngy",min:s,max:l,disabled:o=!1}){const[d,u]=D.useState(!1),[x,m]=D.useState(()=>e?new Date(e):new Date),f=D.useRef(null);D.useEffect(()=>{const C=P=>{f.current&&!f.current.contains(P.target)&&u(!1)};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]);const p=e?new Date(e):null,N=C=>{if(!C)return"";const P=new Date(C);return`${P.getDate().toString().padStart(2,"0")}/${(P.getMonth()+1).toString().padStart(2,"0")}/${P.getFullYear()}`},y=(C,P)=>new Date(C,P+1,0).getDate(),g=(C,P)=>new Date(C,P,1).getDay(),b=()=>{m(C=>new Date(C.getFullYear(),C.getMonth()-1,1))},j=()=>{m(C=>new Date(C.getFullYear(),C.getMonth()+1,1))},T=C=>{const P=new Date(x.getFullYear(),x.getMonth(),C),F=`${P.getFullYear()}-${(P.getMonth()+1).toString().padStart(2,"0")}-${C.toString().padStart(2,"0")}`;n(F),u(!1)},S=C=>{const P=new Date(x.getFullYear(),x.getMonth(),C);return!!(s&&P<new Date(s)||l&&P>new Date(l))},w=C=>{const P=new Date;return x.getFullYear()===P.getFullYear()&&x.getMonth()===P.getMonth()&&C===P.getDate()},_=C=>p?x.getFullYear()===p.getFullYear()&&x.getMonth()===p.getMonth()&&C===p.getDate():!1,E=()=>{const C=x.getFullYear(),P=x.getMonth(),F=y(C,P),R=g(C,P),O=[];for(let M=0;M<R;M++)O.push(null);for(let M=1;M<=F;M++)O.push(M);return t.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[aD.map(M=>t.jsx("div",{className:"text-center text-xs font-medium text-gray-500 py-1",children:M},M)),O.map((M,q)=>t.jsx("div",{className:"aspect-square",children:M!==null&&t.jsx("button",{type:"button",disabled:S(M),onClick:()=>T(M),className:`
                  w-full h-full rounded-lg text-sm transition-colors
                  ${_(M)?"bg-primary-600 text-white":w(M)?"bg-primary-100 text-primary-700":"hover:bg-gray-100"}
                  ${S(M)?"opacity-50 cursor-not-allowed":""}
                `,children:M})},q))]})};return t.jsxs("div",{ref:f,className:"relative",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",value:N(e),readOnly:!0,onClick:()=>!o&&u(!d),placeholder:r,disabled:o,className:`
            w-full px-3 py-2 pr-10 border rounded-lg cursor-pointer
            focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent
            ${o?"bg-gray-100 cursor-not-allowed":"bg-white"}
            ${a}
          `}),t.jsx(Lt,{size:18,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"})]}),d&&t.jsxs("div",{className:"absolute z-50 mt-1 p-3 bg-white rounded-xl shadow-lg border min-w-[280px]",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("button",{type:"button",onClick:b,className:"p-1 hover:bg-gray-100 rounded-lg",children:t.jsx(Nr,{size:20})}),t.jsxs("span",{className:"font-medium",children:[dw[x.getMonth()]," ",x.getFullYear()]}),t.jsx("button",{type:"button",onClick:j,className:"p-1 hover:bg-gray-100 rounded-lg",children:t.jsx(qn,{size:20})})]}),E(),t.jsxs("div",{className:"flex justify-between mt-3 pt-3 border-t",children:[t.jsx("button",{type:"button",onClick:()=>{n(""),u(!1)},className:"text-sm text-gray-500 hover:text-gray-700",children:"Xa"}),t.jsx("button",{type:"button",onClick:()=>{const C=new Date,P=`${C.getFullYear()}-${(C.getMonth()+1).toString().padStart(2,"0")}-${C.getDate().toString().padStart(2,"0")}`;n(P),u(!1)},className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Hm nay"})]})]})]})}function Tc({value:e,onChange:n,className:a="",placeholder:r="Chn thng",disabled:s=!1}){const[l,o]=D.useState(!1),[d,u]=D.useState(()=>e?parseInt(e.split("-")[0]):new Date().getFullYear()),x=D.useRef(null);D.useEffect(()=>{const y=g=>{x.current&&!x.current.contains(g.target)&&o(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]);const m=y=>{if(!y)return"";const[g,b]=y.split("-");return`${dw[parseInt(b)-1]} ${g}`},f=y=>{const g=`${d}-${(y+1).toString().padStart(2,"0")}`;n(g),o(!1)},p=y=>{if(!e)return!1;const[g,b]=e.split("-");return parseInt(g)===d&&parseInt(b)===y+1},N=y=>{const g=new Date;return d===g.getFullYear()&&y===g.getMonth()};return t.jsxs("div",{ref:x,className:"relative",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",value:m(e),readOnly:!0,onClick:()=>!s&&o(!l),placeholder:r,disabled:s,className:`
            w-full px-3 py-2 pr-10 border rounded-lg cursor-pointer
            focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent
            ${s?"bg-gray-100 cursor-not-allowed":"bg-white"}
            ${a}
          `}),t.jsx(Lt,{size:18,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"})]}),l&&t.jsxs("div",{className:"absolute z-50 mt-1 p-3 bg-white rounded-xl shadow-lg border min-w-[280px]",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("button",{type:"button",onClick:()=>u(y=>y-1),className:"p-1 hover:bg-gray-100 rounded-lg",children:t.jsx(Nr,{size:20})}),t.jsx("span",{className:"font-medium text-lg",children:d}),t.jsx("button",{type:"button",onClick:()=>u(y=>y+1),className:"p-1 hover:bg-gray-100 rounded-lg",children:t.jsx(qn,{size:20})})]}),t.jsx("div",{className:"grid grid-cols-4 gap-2",children:nD.map((y,g)=>t.jsx("button",{type:"button",onClick:()=>f(g),className:`
                  py-2 px-1 rounded-lg text-sm transition-colors
                  ${p(g)?"bg-primary-600 text-white":N(g)?"bg-primary-100 text-primary-700":"hover:bg-gray-100"}
                `,children:y},y))}),t.jsxs("div",{className:"flex justify-between mt-3 pt-3 border-t",children:[t.jsx("button",{type:"button",onClick:()=>{n(""),o(!1)},className:"text-sm text-gray-500 hover:text-gray-700",children:"Xa"}),t.jsx("button",{type:"button",onClick:()=>{const y=new Date,g=`${y.getFullYear()}-${(y.getMonth()+1).toString().padStart(2,"0")}`;n(g),o(!1)},className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Thng ny"})]})]})]})}const Rb={DANG_LAM:{label:"ang lm",color:"bg-green-100 text-green-700"},NGHI_VIEC:{label:" ngh",color:"bg-red-100 text-red-700"},TAM_NGHI:{label:"Tm ngh",color:"bg-yellow-100 text-yellow-700"}};function rD(){const e=Mt(),[n,a]=D.useState(!1),[r,s]=D.useState(),[l,o]=D.useState(""),[d,u]=D.useState(""),[x,m]=D.useState(""),[f,p]=D.useState({maNhanVien:"",hoTen:"",email:"",soDienThoai:"",phongBanId:0,chucVu:"",ngayVaoLam:"",gioiTinh:"",ngaySinh:"",diaChi:"",trangThai:"DANG_LAM",loaiNhanVien:"CHINH_THUC",dongBHXH:!0}),{data:N,isLoading:y}=Le({queryKey:["nhan-vien",r,l,x],queryFn:()=>ha.layTatCa({phongBanId:r,tuKhoa:x,trangThai:l||void 0})}),g=Array.isArray(N)?N:(N==null?void 0:N.data)||[],b=d?g.filter(R=>R.loaiNhanVien===d):g,{data:j}=Le({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),T=De({mutationFn:ha.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["nhan-vien"]}),ie.success("To nhn vin thnh cng!"),_()},onError:R=>{var O,M;ie.error(((M=(O=R.response)==null?void 0:O.data)==null?void 0:M.message)||"C li xy ra")}}),S=De({mutationFn:({id:R,data:O})=>ha.capNhat(R,O),onSuccess:()=>{e.invalidateQueries({queryKey:["nhan-vien"]}),ie.success("Cp nht thnh cng!"),_()},onError:R=>{var O,M;ie.error(((M=(O=R.response)==null?void 0:O.data)==null?void 0:M.message)||"C li xy ra")}}),w=De({mutationFn:ha.xoa,onSuccess:()=>{e.invalidateQueries({queryKey:["nhan-vien"]}),ie.success("Xa nhn vin thnh cng!")},onError:R=>{var O,M;ie.error(((M=(O=R.response)==null?void 0:O.data)==null?void 0:M.message)||"C li xy ra")}}),_=()=>{a(!1),p({maNhanVien:"",hoTen:"",email:"",soDienThoai:"",phongBanId:0,chucVu:"",ngayVaoLam:"",gioiTinh:"",ngaySinh:"",diaChi:"",trangThai:"DANG_LAM",loaiNhanVien:"CHINH_THUC",dongBHXH:!0})},E=async()=>{try{const{maNhanVien:R}=await ha.layMaTuDong();p(O=>({...O,maNhanVien:R})),a(!0)}catch{a(!0)}},C=R=>{confirm(`Khi phc nhn vin "${R.hoTen}" v trng thi ang lm?`)&&S.mutate({id:R.id,data:{trangThai:"DANG_LAM"}})},P=()=>{if(!f.maNhanVien||!f.hoTen||!f.phongBanId){ie.error("Vui lng in y  thng tin bt buc");return}T.mutate(f)},F=R=>{confirm(`Bn c chc mun xa nhn vin "${R.hoTen}"?`)&&w.mutate(R.id)};return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[t.jsx(on,{size:28}),"Qun l Nhn vin"]}),t.jsxs("button",{onClick:E,className:"btn btn-primary",children:[t.jsx(Dt,{size:20}),"Thm nhn vin"]})]}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx("div",{className:"flex-1",children:t.jsxs("div",{className:"relative",children:[t.jsx(Vr,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),t.jsx("input",{type:"text",value:x,onChange:R=>m(R.target.value),placeholder:"Tm kim theo tn, m NV, email...",className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]})}),t.jsx("div",{children:t.jsxs("select",{value:r||"",onChange:R=>s(R.target.value?Number(R.target.value):void 0),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),j==null?void 0:j.map(R=>t.jsx("option",{value:R.id,children:R.tenPhongBan},R.id))]})}),t.jsx("div",{children:t.jsxs("select",{value:l,onChange:R=>o(R.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c trng thi"}),t.jsx("option",{value:"DANG_LAM",children:"ang lm"}),t.jsx("option",{value:"NGHI_VIEC",children:" ngh"}),t.jsx("option",{value:"TAM_NGHI",children:"Tm ngh"})]})}),t.jsx("div",{children:t.jsxs("select",{value:d,onChange:R=>u(R.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c loi NV"}),t.jsx("option",{value:"CHINH_THUC",children:"Chnh thc"}),t.jsx("option",{value:"THU_VIEC",children:"Th vic"}),t.jsx("option",{value:"HOC_VIEC",children:"Hc vic"}),t.jsx("option",{value:"THUC_TAP",children:"Thc tp"}),t.jsx("option",{value:"CONG_TAC_VIEN",children:"Cng tc vin"}),t.jsx("option",{value:"THOI_VU",children:"Thi v"})]})})]})}),t.jsx("div",{className:"card",children:y?t.jsx("p",{className:"text-center py-8 text-gray-500",children:"ang ti..."}):b&&b.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"M NV"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"H tn"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Phng ban"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Chc v"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Loi NV"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"BHXH"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Trng thi"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Thao tc"})]})}),t.jsx("tbody",{children:b.map(R=>{var O,M,q,J,B;return t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4 font-medium",children:R.maNhanVien}),t.jsx("td",{className:"py-3 px-4",children:R.hoTen}),t.jsx("td",{className:"py-3 px-4",children:(O=R.phongBan)==null?void 0:O.tenPhongBan}),t.jsx("td",{className:"py-3 px-4",children:R.chucVu||"-"}),t.jsx("td",{className:"py-3 px-4 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${((M=j0[R.loaiNhanVien||"CHINH_THUC"])==null?void 0:M.color)||"bg-gray-100"}`,children:((q=j0[R.loaiNhanVien||"CHINH_THUC"])==null?void 0:q.label)||"Chnh thc"})}),t.jsx("td",{className:"py-3 px-4 text-center",children:R.dongBHXH!==!1?t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700",children:"C"}):t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-700",children:"Khng"})}),t.jsx("td",{className:"py-3 px-4 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${((J=Rb[R.trangThai])==null?void 0:J.color)||"bg-gray-100"}`,children:((B=Rb[R.trangThai])==null?void 0:B.label)||R.trangThai})}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsxs(ua,{to:`/nhan-vien/${R.id}`,className:"px-3 py-1.5 text-xs bg-blue-100 text-blue-700 hover:bg-blue-200 rounded flex items-center gap-1 font-medium",title:"Xem & chnh sa thng tin nhn vin",children:[t.jsx(Za,{size:14}),"Chi tit"]}),R.trangThai==="NGHI_VIEC"?t.jsx("button",{onClick:()=>C(R),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg",title:"Khi phc",children:t.jsx(vu,{size:18})}):t.jsx("button",{onClick:()=>F(R),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Cho ngh vic",children:t.jsx(er,{size:18})})]})})]},R.id)})})]})}):t.jsx("p",{className:"text-center py-8 text-gray-500",children:"Cha c nhn vin no"})}),n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-lg",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Thm nhn vin mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M nhn vin *"}),t.jsx("input",{type:"text",value:f.maNhanVien,onChange:R=>p({...f,maNhanVien:R.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"H tn *"}),t.jsx("input",{type:"text",value:f.hoTen,onChange:R=>p({...f,hoTen:R.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phng ban *"}),t.jsxs("select",{value:f.phongBanId,onChange:R=>p({...f,phongBanId:Number(R.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn phng ban --"}),j==null?void 0:j.map(R=>t.jsx("option",{value:R.id,children:R.tenPhongBan},R.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chc v"}),t.jsx("input",{type:"text",value:f.chucVu,onChange:R=>p({...f,chucVu:R.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gii tnh"}),t.jsxs("select",{value:f.gioiTinh,onChange:R=>p({...f,gioiTinh:R.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn --"}),t.jsx("option",{value:"NAM",children:"Nam"}),t.jsx("option",{value:"NU",children:"N"}),t.jsx("option",{value:"KHAC",children:"Khc"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy sinh"}),t.jsx(Ut,{value:f.ngaySinh,onChange:R=>p({...f,ngaySinh:R}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),t.jsx("input",{type:"email",value:f.email,onChange:R=>p({...f,email:R.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S in thoi"}),t.jsx("input",{type:"text",value:f.soDienThoai,onChange:R=>p({...f,soDienThoai:R.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"a ch"}),t.jsx("input",{type:"text",value:f.diaChi,onChange:R=>p({...f,diaChi:R.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp a ch..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy vo lm"}),t.jsx(Ut,{value:f.ngayVaoLam,onChange:R=>p({...f,ngayVaoLam:R}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi nhn vin"}),t.jsxs("select",{value:f.loaiNhanVien,onChange:R=>p({...f,loaiNhanVien:R.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"CHINH_THUC",children:"Chnh thc"}),t.jsx("option",{value:"THU_VIEC",children:"Th vic"}),t.jsx("option",{value:"HOC_VIEC",children:"Hc vic"}),t.jsx("option",{value:"THUC_TAP",children:"Thc tp"}),t.jsx("option",{value:"CONG_TAC_VIEN",children:"Cng tc vin"}),t.jsx("option",{value:"THOI_VU",children:"Thi v"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"ng BHXH"}),t.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:"dongBHXH",checked:f.dongBHXH===!0,onChange:()=>p({...f,dongBHXH:!0}),className:"w-4 h-4 text-blue-600"}),t.jsx("span",{children:"C ng"})]}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:"dongBHXH",checked:f.dongBHXH===!1,onChange:()=>p({...f,dongBHXH:!1}),className:"w-4 h-4 text-red-600"}),t.jsx("span",{children:"Khng ng"})]})]})]})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:_,className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:P,disabled:T.isPending||S.isPending,className:"btn btn-primary",children:T.isPending||S.isPending?"ang lu...":"Lu"})]})]})})]})}const sD=async e=>(await he.get(`/nhan-vien/${e}/hop-dong`)).data,iD=async(e,n)=>(await he.post(`/nhan-vien/${e}/hop-dong`,n)).data,lD=async(e,n)=>(await he.put(`/nhan-vien/hop-dong/${e}`,n)).data,oD=async(e,n)=>(await he.post(`/nhan-vien/hop-dong/${e}/ngung`,n)).data,cD=async e=>{await he.delete(`/nhan-vien/hop-dong/${e}`)},dD=async e=>(await he.get(`/nhan-vien/${e}/ngan-hang`)).data,uD=async(e,n)=>(await he.post(`/nhan-vien/${e}/ngan-hang`,n)).data,hD=async(e,n)=>(await he.put(`/nhan-vien/ngan-hang/${e}`,n)).data,xD=async e=>(await he.post(`/nhan-vien/ngan-hang/${e}/dat-mac-dinh`)).data,mD=async e=>{await he.delete(`/nhan-vien/ngan-hang/${e}`)},uw=async()=>(await he.get("/nhom-nhan-vien")).data,fD=async e=>(await he.post("/nhom-nhan-vien",e)).data,pD=async(e,n)=>(await he.put(`/nhom-nhan-vien/${e}`,n)).data,gD=async e=>{await he.delete(`/nhom-nhan-vien/${e}`)},Bb={THU_VIEC:"Th vic",MOT_NAM:"1 nm",BA_NAM:"3 nm",VO_THOI_HAN:"V thi hn"},yD={HIEU_LUC:"Hiu lc",HET_HAN:"Ht hn",HUY_BO:"Hy b"},vD=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e);function bD({nhanVienId:e}){const n=Mt(),[a,r]=D.useState(!1),[s,l]=D.useState(null),[o,d]=D.useState(null),[u,x]=D.useState({loaiHopDong:"VO_THOI_HAN",tuNgay:new Date().toISOString().split("T")[0],denNgay:"",luongCoBan:0,luongDongBH:0,heSoLuong:1,ghiChu:""}),[m,f]=D.useState({ngayKetThuc:new Date().toISOString().split("T")[0],lyDo:""}),{data:p,isLoading:N}=Le({queryKey:["hop-dong",e],queryFn:()=>sD(e)}),y=De({mutationFn:E=>iD(e,{...E,denNgay:E.denNgay||void 0}),onSuccess:()=>{ie.success("To hp ng thnh cng"),n.invalidateQueries({queryKey:["hop-dong",e]}),r(!1),T()},onError:E=>{var C,P;ie.error(((P=(C=E.response)==null?void 0:C.data)==null?void 0:P.message)||"Li to hp ng")}}),g=De({mutationFn:({id:E,data:C})=>lD(E,C),onSuccess:()=>{ie.success("Cp nht hp ng thnh cng"),n.invalidateQueries({queryKey:["hop-dong",e]}),l(null),T()},onError:E=>{var C,P;ie.error(((P=(C=E.response)==null?void 0:C.data)==null?void 0:P.message)||"Li cp nht")}}),b=De({mutationFn:({id:E,data:C})=>oD(E,C),onSuccess:()=>{ie.success(" ngng hp ng"),n.invalidateQueries({queryKey:["hop-dong",e]}),d(null)},onError:E=>{var C,P;ie.error(((P=(C=E.response)==null?void 0:C.data)==null?void 0:P.message)||"Li ngng hp ng")}}),j=De({mutationFn:cD,onSuccess:()=>{ie.success(" xa hp ng"),n.invalidateQueries({queryKey:["hop-dong",e]})},onError:E=>{var C,P;ie.error(((P=(C=E.response)==null?void 0:C.data)==null?void 0:P.message)||"Li xa")}}),T=()=>{x({loaiHopDong:"VO_THOI_HAN",tuNgay:new Date().toISOString().split("T")[0],denNgay:"",luongCoBan:0,luongDongBH:0,heSoLuong:1,ghiChu:""})},S=E=>{var C;x({loaiHopDong:E.loaiHopDong,tuNgay:E.tuNgay.split("T")[0],denNgay:((C=E.denNgay)==null?void 0:C.split("T")[0])||"",luongCoBan:Number(E.luongCoBan),luongDongBH:Number(E.luongDongBH||0),heSoLuong:Number(E.heSoLuong||1),ghiChu:E.ghiChu||""}),l(E.id),r(!0)},w=E=>{E.preventDefault(),s?g.mutate({id:s,data:u}):y.mutate(u)},_=E=>{E.preventDefault(),o&&b.mutate({id:o,data:m})};return N?t.jsx("div",{className:"p-4 text-center",children:"ang ti..."}):t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Lch s Hp ng / Lng"}),t.jsxs("button",{onClick:()=>{r(!0),l(null),T()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[t.jsx("span",{children:"+"})," Thm hp ng"]})]}),a&&t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[t.jsx("h4",{className:"font-medium mb-3",children:s?"Sa hp ng":"To hp ng mi"}),t.jsxs("form",{onSubmit:w,className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi hp ng"}),t.jsx("select",{value:u.loaiHopDong,onChange:E=>x({...u,loaiHopDong:E.target.value}),className:"w-full border rounded-lg px-3 py-2",children:Object.entries(Bb).map(([E,C])=>t.jsx("option",{value:E,children:C},E))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lng c bn"}),t.jsx("input",{type:"number",value:u.luongCoBan,onChange:E=>x({...u,luongCoBan:Number(E.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0,required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"T ngy"}),t.jsx(Ut,{value:u.tuNgay,onChange:E=>x({...u,tuNgay:E}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"n ngy ( trng nu v thi hn)"}),t.jsx(Ut,{value:u.denNgay,onChange:E=>x({...u,denNgay:E}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lng ng BH"}),t.jsx("input",{type:"number",value:u.luongDongBH,onChange:E=>x({...u,luongDongBH:Number(E.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"H s lng"}),t.jsx("input",{type:"number",step:"0.01",value:u.heSoLuong,onChange:E=>x({...u,heSoLuong:Number(E.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ghi ch"}),t.jsx("textarea",{value:u.ghiChu,onChange:E=>x({...u,ghiChu:E.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),t.jsxs("div",{className:"col-span-2 flex gap-2",children:[t.jsx("button",{type:"submit",disabled:y.isPending||g.isPending,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:s?"Cp nht":"To mi"}),t.jsx("button",{type:"button",onClick:()=>{r(!1),l(null)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Hy"})]})]})]}),o&&t.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[t.jsx("h4",{className:"font-medium mb-3 text-yellow-800",children:"Ngng hp ng sm"}),t.jsxs("form",{onSubmit:_,className:"flex gap-4 items-end",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy kt thc"}),t.jsx(Ut,{value:m.ngayKetThuc,onChange:E=>f({...m,ngayKetThuc:E}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"L do"}),t.jsx("input",{type:"text",value:m.lyDo,onChange:E=>f({...m,lyDo:E.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp l do..."})]}),t.jsx("button",{type:"submit",disabled:b.isPending,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:opacity-50",children:"Xc nhn"}),t.jsx("button",{type:"button",onClick:()=>d(null),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Hy"})]})]}),t.jsx("div",{className:"relative",children:(p==null?void 0:p.length)===0?t.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:"Cha c hp ng no"}):t.jsx("div",{className:"space-y-4",children:p==null?void 0:p.map((E,C)=>t.jsxs("div",{className:`relative pl-8 pb-4 ${C<((p==null?void 0:p.length)||0)-1?"border-l-2 border-gray-200":""}`,children:[t.jsx("div",{className:`absolute left-[-5px] w-3 h-3 rounded-full ${E.trangThai==="HIEU_LUC"?"bg-green-500":"bg-gray-400"}`}),t.jsxs("div",{className:`bg-white rounded-lg shadow p-4 ${E.trangThai==="HIEU_LUC"?"border-l-4 border-green-500":""}`,children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-semibold",children:Bb[E.loaiHopDong]}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${E.trangThai==="HIEU_LUC"?"bg-green-100 text-green-800":E.trangThai==="HET_HAN"?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"}`,children:yD[E.trangThai]})]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[new Date(E.tuNgay).toLocaleDateString("vi-VN"),"  ",E.denNgay?new Date(E.denNgay).toLocaleDateString("vi-VN"):"V thi hn"]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-lg font-bold text-blue-600",children:vD(Number(E.luongCoBan))}),E.heSoLuong&&t.jsxs("div",{className:"text-xs text-gray-500",children:["H s: ",E.heSoLuong]})]})]}),E.ghiChu&&t.jsx("div",{className:"text-sm text-gray-500 mt-2 italic",children:E.ghiChu}),t.jsxs("div",{className:"flex gap-2 mt-3",children:[t.jsx("button",{onClick:()=>S(E),className:"text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100",children:"Sa"}),E.trangThai==="HIEU_LUC"&&t.jsx("button",{onClick:()=>d(E.id),className:"text-xs px-2 py-1 bg-yellow-50 text-yellow-600 rounded hover:bg-yellow-100",children:"Ngng sm"}),t.jsx("button",{onClick:()=>{confirm("Xc nhn xa hp ng ny?")&&j.mutate(E.id)},className:"text-xs px-2 py-1 bg-red-50 text-red-600 rounded hover:bg-red-100",children:"Xa"})]})]})]},E.id))})})]})}const Hb=[{code:"VCB",name:"Vietcombank"},{code:"TCB",name:"Techcombank"},{code:"BIDV",name:"BIDV"},{code:"VTB",name:"Vietinbank"},{code:"ACB",name:"ACB"},{code:"MBB",name:"MB Bank"},{code:"VPB",name:"VPBank"},{code:"TPB",name:"TPBank"},{code:"STB",name:"Sacombank"},{code:"SHB",name:"SHB"},{code:"MSB",name:"MSB"},{code:"OCB",name:"OCB"},{code:"HDB",name:"HDBank"},{code:"SCB",name:"SCB"},{code:"EIB",name:"Eximbank"},{code:"AGRI",name:"Agribank"},{code:"KHAC",name:"Khc"}];function ND({nhanVienId:e}){const n=Mt(),[a,r]=D.useState(!1),[s,l]=D.useState(null),[o,d]=D.useState({tenNganHang:"VCB",chiNhanh:"",soTaiKhoan:"",chuTaiKhoan:"",laMacDinh:!1,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""}),{data:u,isLoading:x}=Le({queryKey:["ngan-hang",e],queryFn:()=>dD(e)}),m=De({mutationFn:T=>uD(e,{...T,denNgay:T.denNgay||void 0}),onSuccess:()=>{ie.success("Thm ti khon ngn hng thnh cng"),n.invalidateQueries({queryKey:["ngan-hang",e]}),r(!1),y()},onError:T=>{var S,w;ie.error(((w=(S=T.response)==null?void 0:S.data)==null?void 0:w.message)||"Li thm ti khon")}}),f=De({mutationFn:({id:T,data:S})=>hD(T,S),onSuccess:()=>{ie.success("Cp nht ti khon thnh cng"),n.invalidateQueries({queryKey:["ngan-hang",e]}),l(null),r(!1),y()},onError:T=>{var S,w;ie.error(((w=(S=T.response)==null?void 0:S.data)==null?void 0:w.message)||"Li cp nht")}}),p=De({mutationFn:mD,onSuccess:()=>{ie.success(" xa ti khon"),n.invalidateQueries({queryKey:["ngan-hang",e]})},onError:T=>{var S,w;ie.error(((w=(S=T.response)==null?void 0:S.data)==null?void 0:w.message)||"Li xa")}}),N=De({mutationFn:xD,onSuccess:()=>{ie.success(" t lm mc nh"),n.invalidateQueries({queryKey:["ngan-hang",e]})},onError:T=>{var S,w;ie.error(((w=(S=T.response)==null?void 0:S.data)==null?void 0:w.message)||"Li")}}),y=()=>{d({tenNganHang:"VCB",chiNhanh:"",soTaiKhoan:"",chuTaiKhoan:"",laMacDinh:!1,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""})},g=T=>{var S,w;d({tenNganHang:T.tenNganHang,chiNhanh:T.chiNhanh||"",soTaiKhoan:T.soTaiKhoan,chuTaiKhoan:T.chuTaiKhoan,laMacDinh:T.laMacDinh,tuNgay:((S=T.tuNgay)==null?void 0:S.split("T")[0])||"",denNgay:((w=T.denNgay)==null?void 0:w.split("T")[0])||"",ghiChu:T.ghiChu||""}),l(T.id),r(!0)},b=T=>{T.preventDefault(),s?f.mutate({id:s,data:o}):m.mutate(o)},j=T=>{const S=Hb.find(w=>w.code===T);return S?S.name:T};return x?t.jsx("div",{className:"p-4 text-center",children:"ang ti..."}):t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Ti khon Ngn hng"}),t.jsxs("button",{onClick:()=>{r(!0),l(null),y()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[t.jsx("span",{children:"+"})," Thm ti khon"]})]}),a&&t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[t.jsx("h4",{className:"font-medium mb-3",children:s?"Sa ti khon":"Thm ti khon mi"}),t.jsxs("form",{onSubmit:b,className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngn hng"}),t.jsx("select",{value:o.tenNganHang,onChange:T=>d({...o,tenNganHang:T.target.value}),className:"w-full border rounded-lg px-3 py-2",children:Hb.map(T=>t.jsx("option",{value:T.code,children:T.name},T.code))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chi nhnh"}),t.jsx("input",{type:"text",value:o.chiNhanh,onChange:T=>d({...o,chiNhanh:T.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: H Ni, TP.HCM..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S ti khon *"}),t.jsx("input",{type:"text",value:o.soTaiKhoan,onChange:T=>d({...o,soTaiKhoan:T.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp s ti khon",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ch ti khon *"}),t.jsx("input",{type:"text",value:o.chuTaiKhoan,onChange:T=>d({...o,chuTaiKhoan:T.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"NGUYEN VAN A",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hiu lc t"}),t.jsx(Ut,{value:o.tuNgay,onChange:T=>d({...o,tuNgay:T}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hiu lc n"}),t.jsx(Ut,{value:o.denNgay,onChange:T=>d({...o,denNgay:T}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ghi ch"}),t.jsx("input",{type:"text",value:o.ghiChu,onChange:T=>d({...o,ghiChu:T.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ti khon nhn lng, ti khon ph..."})]}),t.jsx("div",{className:"col-span-2",children:t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:o.laMacDinh,onChange:T=>d({...o,laMacDinh:T.target.checked}),className:"w-4 h-4 rounded"}),t.jsx("span",{className:"text-sm",children:"t lm ti khon mc nh"})]})}),t.jsxs("div",{className:"col-span-2 flex gap-2",children:[t.jsx("button",{type:"submit",disabled:m.isPending||f.isPending,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:s?"Cp nht":"Thm"}),t.jsx("button",{type:"button",onClick:()=>{r(!1),l(null)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Hy"})]})]})]}),t.jsx("div",{className:"grid gap-4",children:(u==null?void 0:u.length)===0?t.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:"Cha c ti khon ngn hng no"}):u==null?void 0:u.map(T=>t.jsxs("div",{className:`bg-white rounded-lg shadow p-4 ${T.laMacDinh?"border-l-4 border-green-500":""}`,children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 font-bold text-sm",children:T.tenNganHang.slice(0,3)}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-semibold",children:j(T.tenNganHang)}),T.chiNhanh&&t.jsxs("span",{className:"text-sm text-gray-500",children:["- ",T.chiNhanh]}),T.laMacDinh&&t.jsx("span",{className:"text-xs px-2 py-0.5 bg-green-100 text-green-800 rounded-full",children:"Mc nh"})]}),t.jsx("div",{className:"text-lg font-mono text-gray-800",children:T.soTaiKhoan}),t.jsx("div",{className:"text-sm text-gray-500",children:T.chuTaiKhoan})]})]}),t.jsxs("div",{className:"flex flex-col items-end gap-2",children:[T.tuNgay&&t.jsxs("div",{className:"text-xs text-gray-400",children:[new Date(T.tuNgay).toLocaleDateString("vi-VN"),T.denNgay&&`  ${new Date(T.denNgay).toLocaleDateString("vi-VN")}`]}),t.jsxs("div",{className:"flex gap-2",children:[!T.laMacDinh&&t.jsx("button",{onClick:()=>N.mutate(T.id),className:"text-xs px-2 py-1 bg-green-50 text-green-600 rounded hover:bg-green-100",children:"t mc nh"}),t.jsx("button",{onClick:()=>g(T),className:"text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100",children:"Sa"}),t.jsx("button",{onClick:()=>{confirm("Xc nhn xa ti khon ny?")&&p.mutate(T.id)},className:"text-xs px-2 py-1 bg-red-50 text-red-600 rounded hover:bg-red-100",children:"Xa"})]})]})]}),T.ghiChu&&t.jsx("div",{className:"text-sm text-gray-500 mt-2 italic",children:T.ghiChu})]},T.id))})]})}function jD({nhanVienId:e}){const n=Mt(),[a,r]=D.useState(null),{data:s,isLoading:l}=Le({queryKey:["nhan-vien-nhom",e],queryFn:async()=>(await he.get(`/nhan-vien/${e}/nhom`)).data}),{data:o}=Le({queryKey:["nhom-nhan-vien"],queryFn:()=>uw()}),d=o==null?void 0:o.filter(p=>!(s!=null&&s.some(N=>N.nhom.id===p.id))),u=De({mutationFn:async p=>he.post(`/nhan-vien/${e}/them-vao-nhom`,{nhomId:p,tuNgay:new Date().toISOString().split("T")[0]}),onSuccess:()=>{ie.success(" thm vo nhm"),n.invalidateQueries({queryKey:["nhan-vien-nhom",e]}),r(null)},onError:p=>{var N,y;ie.error(((y=(N=p.response)==null?void 0:N.data)==null?void 0:y.message)||"Li thm vo nhm")}}),x=De({mutationFn:async p=>he.post(`/nhan-vien/${e}/go-khoi-nhom`,{nhomId:p,denNgay:new Date().toISOString().split("T")[0]}),onSuccess:()=>{ie.success(" g khi nhm"),n.invalidateQueries({queryKey:["nhan-vien-nhom",e]})},onError:p=>{var N,y;ie.error(((y=(N=p.response)==null?void 0:N.data)==null?void 0:y.message)||"Li g khi nhm")}}),m=()=>{a&&u.mutate(a)},f=p=>{confirm("Xc nhn g khi nhm?")&&x.mutate(p)};return l?t.jsx("div",{className:"p-4 text-center",children:"ang ti..."}):t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"flex justify-between items-center",children:t.jsx("h3",{className:"text-lg font-semibold",children:"Nhm Nhn vin"})}),d&&d.length>0&&t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[t.jsx("h4",{className:"font-medium mb-3",children:"Thm vo nhm"}),t.jsxs("div",{className:"flex gap-2 items-center",children:[t.jsxs("select",{value:a||"",onChange:p=>r(Number(p.target.value)),className:"flex-1 border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn nhm --"}),d.map(p=>t.jsxs("option",{value:p.id,children:[p.tenNhom," ",p.moTa&&`(${p.moTa})`]},p.id))]}),t.jsx("button",{onClick:m,disabled:!a,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:"Thm"})]})]}),t.jsx("div",{className:"grid gap-3",children:(s==null?void 0:s.length)===0?t.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:"Nhn vin cha thuc nhm no"}):s==null?void 0:s.map(p=>t.jsxs("div",{className:"bg-white rounded-lg shadow p-4 flex justify-between items-center",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-white font-bold",style:{backgroundColor:p.nhom.mauSac||"#6B7280"},children:p.nhom.tenNhom.charAt(0).toUpperCase()}),t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold",children:p.nhom.tenNhom}),p.nhom.moTa&&t.jsx("div",{className:"text-sm text-gray-500",children:p.nhom.moTa}),t.jsxs("div",{className:"text-xs text-gray-400",children:["T ",new Date(p.tuNgay).toLocaleDateString("vi-VN"),p.denNgay&&` n ${new Date(p.denNgay).toLocaleDateString("vi-VN")}`]})]})]}),t.jsx("button",{onClick:()=>f(p.nhom.id),className:"text-xs px-3 py-1 bg-red-50 text-red-600 rounded hover:bg-red-100",children:"G khi nhm"})]},p.id))}),t.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-sm text-gray-600",children:[t.jsx("strong",{children:"Lu :"})," Nhm nhn vin c s dng trong Rule Engine  p dng cc quy tc tnh lng cho tng nhm ring bit (VD: nhm Qun l, nhm K thut, nhm Sales...)."]})]})}const wD=({nhanVienId:e})=>{const[n,a]=D.useState(null),[r,s]=D.useState(!0),[l,o]=D.useState(!1),[d,u]=D.useState(!1),[x,m]=D.useState({mstCaNhan:"",soCmndCccd:"",ngayCap:"",noiCap:"",soNguoiPhuThuoc:0,ghiChu:""}),f=async()=>{try{s(!0);const b=(await he.get(`/nhan-vien/${e}/thue-bh`)).data;a(b),b&&m({mstCaNhan:b.mstCaNhan||"",soCmndCccd:b.soCmndCccd||"",ngayCap:b.ngayCap?b.ngayCap.split("T")[0]:"",noiCap:b.noiCap||"",soNguoiPhuThuoc:b.soNguoiPhuThuoc||0,ghiChu:b.ghiChu||""})}catch(g){console.error("Li khi ti thng tin thu/BHXH:",g)}finally{s(!1)}};D.useEffect(()=>{f()},[e]);const p=g=>{const{name:b,value:j}=g.target;m(T=>({...T,[b]:b==="soNguoiPhuThuoc"?parseInt(j)||0:j}))},N=async()=>{try{o(!0),await he.post(`/nhan-vien/${e}/thue-bh`,x),await f(),u(!1)}catch(g){console.error("Li khi lu thng tin thu/BHXH:",g),alert("C li xy ra khi lu thng tin")}finally{o(!1)}},y=()=>{m(n?{mstCaNhan:n.mstCaNhan||"",soCmndCccd:n.soCmndCccd||"",ngayCap:n.ngayCap?n.ngayCap.split("T")[0]:"",noiCap:n.noiCap||"",soNguoiPhuThuoc:n.soNguoiPhuThuoc||0,ghiChu:n.ghiChu||""}:{mstCaNhan:"",soCmndCccd:"",ngayCap:"",noiCap:"",soNguoiPhuThuoc:0,ghiChu:""}),u(!1)};return r?t.jsx("div",{className:"flex justify-center items-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Thng tin Thu & BHXH"}),d?t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:y,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:N,disabled:l,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:l?"ang lu...":"Lu"})]}):t.jsx("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:n?"Chnh sa":"Thm thng tin"})]}),t.jsxs("div",{className:"bg-white border rounded-lg p-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S CMND/CCCD"}),d?t.jsx("input",{type:"text",name:"soCmndCccd",value:x.soCmndCccd,onChange:p,placeholder:"Nhp s CMND/CCCD",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:(n==null?void 0:n.soCmndCccd)||""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy cp"}),d?t.jsx(Ut,{value:x.ngayCap,onChange:g=>m(b=>({...b,ngayCap:g})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:n!=null&&n.ngayCap?new Date(n.ngayCap).toLocaleDateString("vi-VN"):""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ni cp"}),d?t.jsx("input",{type:"text",name:"noiCap",value:x.noiCap,onChange:p,placeholder:"Nhp ni cp",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:(n==null?void 0:n.noiCap)||""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M s thu c nhn"}),d?t.jsx("input",{type:"text",name:"mstCaNhan",value:x.mstCaNhan,onChange:p,placeholder:"Nhp m s thu",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:(n==null?void 0:n.mstCaNhan)||""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S ngi ph thuc"}),d?t.jsx("input",{type:"number",name:"soNguoiPhuThuoc",min:"0",value:x.soNguoiPhuThuoc,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsxs("p",{className:"text-gray-900",children:[(n==null?void 0:n.soNguoiPhuThuoc)??0," ngi"]})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),d?t.jsx("textarea",{name:"ghiChu",value:x.ghiChu,onChange:p,rows:3,placeholder:"Nhp ghi ch (nu c)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:(n==null?void 0:n.ghiChu)||""})]})]}),t.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[t.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:" Thng tin gim tr thu TNCN"}),t.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[t.jsx("p",{children:" Gim tr bn thn: 11.000.000 /thng"}),t.jsx("p",{children:" Gim tr ngi ph thuc: 4.400.000 /ngi/thng"}),t.jsx("p",{children:t.jsxs("strong",{children:["Tng gim tr: ",(11e6+(x.soNguoiPhuThuoc||0)*44e5).toLocaleString("vi-VN")," /thng"]})})]})]})]}),n&&t.jsxs("div",{className:"text-sm text-gray-500",children:["Cp nht ln cui: ",new Date().toLocaleDateString("vi-VN")]})]})};function kD({nhanVienId:e}){var l;const{data:n,isLoading:a}=Le({queryKey:["lich-su-phong-ban",e],queryFn:()=>ha.layLichSuPhongBan(e)});if(a)return t.jsxs("div",{className:"card animate-pulse",children:[t.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-4"}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"h-16 bg-gray-200 rounded"}),t.jsx("div",{className:"h-16 bg-gray-200 rounded"})]})]});const r=n==null?void 0:n.find(o=>!o.denNgay),s=(n==null?void 0:n.filter(o=>o.denNgay))||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"card border-l-4 border-l-green-500",children:[t.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2 text-lg",children:[t.jsx(Mr,{className:"text-green-600",size:20}),"Phng ban hin ti"]}),r?t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:t.jsx(Mr,{className:"text-green-600",size:24})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium text-gray-900 text-lg",children:((l=r.phongBan)==null?void 0:l.tenPhongBan)||"N/A"}),r.donViCon&&t.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1 mt-1",children:[t.jsx(on,{size:14}),r.donViCon.loaiDonVi,": ",r.donViCon.tenDonVi]}),t.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1 mt-2",children:[t.jsx(Lt,{size:14}),"T: ",js(r.tuNgay)]}),r.ghiChu&&t.jsx("div",{className:"text-sm text-gray-500 mt-2 italic",children:r.ghiChu})]}),t.jsx("div",{className:"px-3 py-1 rounded-full bg-green-100 text-green-700 text-sm font-medium",children:"ang lm vic"})]}):t.jsxs("div",{className:"text-center text-gray-500 py-4",children:[t.jsx(Xd,{size:40,className:"mx-auto text-gray-300 mb-2"}),t.jsx("p",{children:"Cha c thng tin phng ban"})]})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2 text-lg",children:[t.jsx(an,{className:"text-gray-600",size:20}),"Lch s chuyn phng ban",s.length>0&&t.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:[s.length," ln"]})]}),s.length>0?t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute left-6 top-0 bottom-0 w-0.5 bg-gray-200"}),t.jsx("div",{className:"space-y-4",children:s.map(o=>{var d;return t.jsxs("div",{className:"relative flex items-start gap-4 pl-2",children:[t.jsx("div",{className:"absolute left-4 w-4 h-4 bg-gray-300 rounded-full border-2 border-white z-10"}),t.jsxs("div",{className:"ml-10 flex-1 bg-gray-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:((d=o.phongBan)==null?void 0:d.tenPhongBan)||"N/A"}),o.donViCon&&t.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1 mt-1",children:[t.jsx(on,{size:12}),o.donViCon.loaiDonVi,": ",o.donViCon.tenDonVi]})]}),t.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[t.jsx("div",{children:js(o.tuNgay)}),t.jsxs("div",{children:[" ",js(o.denNgay)]})]})]}),o.ghiChu&&t.jsx("div",{className:"text-sm text-gray-500 mt-2 italic",children:o.ghiChu})]})]},o.id)})})]}):t.jsxs("div",{className:"text-center text-gray-500 py-8",children:[t.jsx(an,{size:40,className:"mx-auto text-gray-300 mb-2"}),t.jsx("p",{children:"Cha c lch s chuyn phng ban"}),t.jsx("p",{className:"text-sm",children:"Nhn vin cha tng chuyn phng ban"})]})]})]})}function TD(){var ne,oe,Se;const{id:e}=q0(),n=parseInt(e),a=Mt(),[r,s]=D.useState("thong-tin"),[l,o]=D.useState(!1),[d,u]=D.useState(null),[x,m]=D.useState(null),[f,p]=D.useState(!1),[N,y]=D.useState({hoTen:"",email:"",soDienThoai:"",phongBanId:0,chucVu:"",gioiTinh:"",ngaySinh:"",diaChi:"",ngayVaoLam:"",luongCoBan:0,loaiNhanVien:"CHINH_THUC",dongBHXH:!0}),[g,b]=D.useState({khoanLuongId:0,soTien:0,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""}),[j,T]=D.useState({soTienMoi:0,tuNgay:new Date().toISOString().split("T")[0],ghiChu:""}),[S,w]=D.useState({denNgay:new Date().toISOString().split("T")[0]}),{data:_,isLoading:E}=Le({queryKey:["nhan-vien",n],queryFn:()=>ha.layTheoId(n)}),{data:C}=Le({queryKey:["phong-ban"],queryFn:()=>Jt.layTatCa()}),{data:P,isLoading:F}=Le({queryKey:["phu-cap",n],queryFn:()=>Xo.layTheoNhanVien(n)}),{data:R}=Le({queryKey:["khoan-luong","THU_NHAP"],queryFn:()=>pr.layTatCa("THU_NHAP")}),O=De({mutationFn:V=>Xo.taoPhuCap(V),onSuccess:()=>{ie.success("Thm ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]}),o(!1),te()},onError:V=>{var be,Oe;ie.error(((Oe=(be=V.response)==null?void 0:be.data)==null?void 0:Oe.message)||"C li xy ra")}}),M=De({mutationFn:({id:V,data:be})=>Xo.tang(V,be),onSuccess:()=>{ie.success("iu chnh ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]}),u(null)},onError:V=>{var be,Oe;ie.error(((Oe=(be=V.response)==null?void 0:be.data)==null?void 0:Oe.message)||"C li xy ra")}}),q=De({mutationFn:({id:V,denNgay:be})=>Xo.ketThuc(V,be,"Admin"),onSuccess:()=>{ie.success("Kt thc ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]}),m(null)},onError:V=>{var be,Oe;ie.error(((Oe=(be=V.response)==null?void 0:be.data)==null?void 0:Oe.message)||"C li xy ra")}}),J=De({mutationFn:V=>Xo.tamDung(V),onSuccess:()=>{ie.success("Tm dng ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]})}}),B=De({mutationFn:V=>Xo.kichHoat(V),onSuccess:()=>{ie.success("Kch hot ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]})}}),ue=De({mutationFn:V=>ha.capNhat(n,V),onSuccess:()=>{ie.success("Cp nht thng tin nhn vin thnh cng"),a.invalidateQueries({queryKey:["nhan-vien",n]}),p(!1)},onError:V=>{var be,Oe;ie.error(((Oe=(be=V.response)==null?void 0:be.data)==null?void 0:Oe.message)||"C li xy ra khi cp nht")}});D.useEffect(()=>{_&&y({hoTen:_.hoTen||"",email:_.email||"",soDienThoai:_.soDienThoai||"",phongBanId:_.phongBanId||0,chucVu:_.chucVu||"",gioiTinh:_.gioiTinh||"",ngaySinh:_.ngaySinh?new Date(_.ngaySinh).toISOString().split("T")[0]:"",diaChi:_.diaChi||"",ngayVaoLam:_.ngayVaoLam?new Date(_.ngayVaoLam).toISOString().split("T")[0]:"",luongCoBan:_.luongCoBan||0,loaiNhanVien:_.loaiNhanVien||"CHINH_THUC",dongBHXH:_.dongBHXH!==!1})},[_]);const te=()=>{b({khoanLuongId:0,soTien:0,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""})},Z=()=>{if(!g.khoanLuongId){ie.error("Vui lng chn khon ph cp");return}if(g.soTien<=0){ie.error("S tin phi > 0");return}O.mutate({nhanVienId:n,khoanLuongId:g.khoanLuongId,soTien:g.soTien,tuNgay:g.tuNgay,denNgay:g.denNgay||void 0,ghiChu:g.ghiChu||void 0,nguoiTao:"Admin"})},Q=()=>{if(d){if(j.soTienMoi<=0){ie.error("S tin mi phi > 0");return}M.mutate({id:d.id,data:{soTienMoi:j.soTienMoi,tuNgay:j.tuNgay,ghiChu:j.ghiChu||void 0,nguoiTao:"Admin"}})}},fe=()=>{x&&q.mutate({id:x.id,denNgay:S.denNgay})},K=()=>{var V,be,Oe,tt;if(!N.hoTen.trim()){ie.error("Vui lng nhp h tn");return}if(!N.phongBanId){ie.error("Vui lng chn phng ban");return}ue.mutate({hoTen:N.hoTen.trim(),email:((V=N.email)==null?void 0:V.trim())||null,soDienThoai:((be=N.soDienThoai)==null?void 0:be.trim())||null,phongBanId:N.phongBanId,chucVu:((Oe=N.chucVu)==null?void 0:Oe.trim())||null,gioiTinh:N.gioiTinh||null,ngaySinh:N.ngaySinh||null,diaChi:((tt=N.diaChi)==null?void 0:tt.trim())||null,ngayVaoLam:N.ngayVaoLam||null,luongCoBan:N.luongCoBan||0,loaiNhanVien:N.loaiNhanVien,dongBHXH:N.dongBHXH})},L=()=>{_&&y({hoTen:_.hoTen||"",email:_.email||"",soDienThoai:_.soDienThoai||"",phongBanId:_.phongBanId||0,chucVu:_.chucVu||"",gioiTinh:_.gioiTinh||"",ngaySinh:_.ngaySinh?new Date(_.ngaySinh).toISOString().split("T")[0]:"",diaChi:_.diaChi||"",ngayVaoLam:_.ngayVaoLam?new Date(_.ngayVaoLam).toISOString().split("T")[0]:"",luongCoBan:_.luongCoBan||0,loaiNhanVien:_.loaiNhanVien||"CHINH_THUC",dongBHXH:_.dongBHXH!==!1}),p(!1)},X=(P==null?void 0:P.filter(V=>V.trangThai==="HIEU_LUC"))||[],I=(P==null?void 0:P.filter(V=>V.trangThai==="TAM_DUNG"))||[],W=(P==null?void 0:P.filter(V=>V.trangThai==="KET_THUC"))||[],z=X.reduce((V,be)=>V+Number(be.soTien||0),0);if(E)return t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});if(!_)return t.jsx("div",{className:"text-center py-12 text-gray-500",children:"Khng tm thy nhn vin"});const xe=V=>{switch(V){case"HIEU_LUC":return"bg-green-100 text-green-800";case"TAM_DUNG":return"bg-yellow-100 text-yellow-800";case"KET_THUC":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},H=V=>{switch(V){case"HIEU_LUC":return"Hiu lc";case"TAM_DUNG":return"Tm dng";case"KET_THUC":return"Kt thc";default:return V}};return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[t.jsx(ua,{to:"/nhan-vien",className:"p-2 hover:bg-gray-100 rounded-lg",children:t.jsx(Q0,{size:24})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:_.hoTen}),t.jsxs("p",{className:"text-gray-500",children:[_.maNhanVien," - ",_.chucVu||"Nhn vin"]})]})]}),t.jsxs("div",{className:"flex gap-2 mb-6 border-b overflow-x-auto",children:[t.jsxs("button",{onClick:()=>s("thong-tin"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="thong-tin"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(so,{size:18,className:"inline-block mr-2"}),"Thng tin"]}),t.jsxs("button",{onClick:()=>s("hop-dong"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="hop-dong"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(ma,{size:18,className:"inline-block mr-2"}),"Hp ng / Lng"]}),t.jsxs("button",{onClick:()=>s("phu-cap"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="phu-cap"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(sg,{size:18,className:"inline-block mr-2"}),"Ph cp",X.length>0&&t.jsx("span",{className:"ml-2 bg-primary-100 text-primary-700 px-2 py-0.5 rounded-full text-xs",children:X.length})]}),t.jsxs("button",{onClick:()=>s("lich-su"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="lich-su"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(gu,{size:18,className:"inline-block mr-2"}),"Lch s ph cp"]}),t.jsxs("button",{onClick:()=>s("lich-su-phong-ban"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="lich-su-phong-ban"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(Mr,{size:18,className:"inline-block mr-2"}),"Lch s phng ban"]})]}),r==="thong-tin"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:[t.jsx(so,{size:20}),"Thng tin c bn"]}),f?t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:L,className:"btn btn-secondary flex items-center gap-2",disabled:ue.isPending,children:[t.jsx(mn,{size:16}),"Hy"]}),t.jsxs("button",{onClick:K,className:"btn btn-primary flex items-center gap-2",disabled:ue.isPending,children:[t.jsx(Es,{size:16}),ue.isPending?"ang lu...":"Lu"]})]}):t.jsxs("button",{onClick:()=>p(!0),className:"btn btn-secondary flex items-center gap-2",children:[t.jsx(R_,{size:16}),"Chnh sa"]})]}),f?t.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"M nhn vin"}),t.jsx("p",{className:"font-medium text-gray-400",children:_.maNhanVien}),t.jsx("span",{className:"text-xs text-gray-400",children:"(Khng th sa)"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"H tn *"}),t.jsx("input",{type:"text",value:N.hoTen,onChange:V=>y({...N,hoTen:V.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp h tn"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phng ban *"}),t.jsxs("select",{value:N.phongBanId,onChange:V=>y({...N,phongBanId:parseInt(V.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn phng ban --"}),C==null?void 0:C.map(V=>t.jsx("option",{value:V.id,children:V.tenPhongBan},V.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chc v"}),t.jsx("input",{type:"text",value:N.chucVu,onChange:V=>y({...N,chucVu:V.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp chc v"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gii tnh"}),t.jsxs("select",{value:N.gioiTinh,onChange:V=>y({...N,gioiTinh:V.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn gii tnh --"}),t.jsx("option",{value:"NAM",children:"Nam"}),t.jsx("option",{value:"NU",children:"N"}),t.jsx("option",{value:"KHAC",children:"Khc"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy sinh"}),t.jsx(Ut,{value:N.ngaySinh,onChange:V=>y({...N,ngaySinh:V}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),t.jsx("input",{type:"email",value:N.email,onChange:V=>y({...N,email:V.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp email"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S in thoi"}),t.jsx("input",{type:"tel",value:N.soDienThoai,onChange:V=>y({...N,soDienThoai:V.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp s in thoi"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"a ch"}),t.jsx("input",{type:"text",value:N.diaChi,onChange:V=>y({...N,diaChi:V.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp a ch"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy vo lm"}),t.jsx(Ut,{value:N.ngayVaoLam,onChange:V=>y({...N,ngayVaoLam:V}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lng c bn"}),t.jsx("input",{type:"number",value:N.luongCoBan,onChange:V=>y({...N,luongCoBan:parseFloat(V.target.value)||0}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp lng c bn",min:0,step:1e5})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi nhn vin"}),t.jsxs("select",{value:N.loaiNhanVien,onChange:V=>y({...N,loaiNhanVien:V.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"CHINH_THUC",children:"Chnh thc"}),t.jsx("option",{value:"THU_VIEC",children:"Th vic"}),t.jsx("option",{value:"HOC_VIEC",children:"Hc vic"}),t.jsx("option",{value:"THUC_TAP",children:"Thc tp"}),t.jsx("option",{value:"CONG_TAC_VIEN",children:"Cng tc vin"}),t.jsx("option",{value:"THOI_VU",children:"Thi v"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"ng BHXH"}),t.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:"editDongBHXH",checked:N.dongBHXH===!0,onChange:()=>y({...N,dongBHXH:!0}),className:"w-4 h-4 text-blue-600"}),t.jsx("span",{children:"C ng"})]}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:"editDongBHXH",checked:N.dongBHXH===!1,onChange:()=>y({...N,dongBHXH:!1}),className:"w-4 h-4 text-red-600"}),t.jsx("span",{children:"Khng ng"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Tng ph cp hin ti"}),t.jsx("p",{className:"font-medium text-green-600",children:Ye(z)}),t.jsx("span",{className:"text-xs text-gray-400",children:"(T ng tnh t cc khon ph cp)"})]})]}):t.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"M nhn vin"}),t.jsx("p",{className:"font-medium",children:_.maNhanVien})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"H tn"}),t.jsx("p",{className:"font-medium",children:_.hoTen})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Phng ban"}),t.jsx("p",{className:"font-medium",children:(ne=_.phongBan)==null?void 0:ne.tenPhongBan})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Chc v"}),t.jsx("p",{className:"font-medium",children:_.chucVu||"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Gii tnh"}),t.jsx("p",{className:"font-medium",children:_.gioiTinh==="NAM"?"Nam":_.gioiTinh==="NU"?"N":_.gioiTinh==="KHAC"?"Khc":"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Ngy sinh"}),t.jsx("p",{className:"font-medium",children:_.ngaySinh?js(_.ngaySinh):"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Email"}),t.jsx("p",{className:"font-medium",children:_.email||"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"S in thoi"}),t.jsx("p",{className:"font-medium",children:_.soDienThoai||"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"a ch"}),t.jsx("p",{className:"font-medium",children:_.diaChi||"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Ngy vo lm"}),t.jsx("p",{className:"font-medium",children:_.ngayVaoLam?js(_.ngayVaoLam):"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Lng c bn"}),t.jsx("p",{className:"font-medium text-primary-600",children:Ye(_.luongCoBan)})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Loi nhn vin"}),t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${((oe=j0[_.loaiNhanVien||"CHINH_THUC"])==null?void 0:oe.color)||"bg-gray-100"}`,children:((Se=j0[_.loaiNhanVien||"CHINH_THUC"])==null?void 0:Se.label)||"Chnh thc"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"ng BHXH"}),_.dongBHXH!==!1?t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700",children:"C ng"}):t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-700",children:"Khng ng"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Tng ph cp hin ti"}),t.jsx("p",{className:"font-medium text-green-600",children:Ye(z)})]})]})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[t.jsx(Mr,{size:20}),"Ti khon ngn hng"]}),t.jsx(ND,{nhanVienId:n})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[t.jsx(ma,{size:20}),"Thng tin Thu & BHXH"]}),t.jsx(wD,{nhanVienId:n})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[t.jsx(on,{size:20}),"Nhm nhn vin"]}),t.jsx(jD,{nhanVienId:n})]})]}),r==="hop-dong"&&t.jsx("div",{className:"card",children:t.jsx(bD,{nhanVienId:n})}),r==="phu-cap"&&t.jsxs("div",{children:[t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"card bg-green-50",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Ph cp hiu lc"}),t.jsx("p",{className:"text-2xl font-bold text-green-600",children:X.length}),t.jsxs("p",{className:"text-sm text-green-600",children:[Ye(z),"/thng"]})]}),t.jsxs("div",{className:"card bg-yellow-50",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Tm dng"}),t.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:I.length})]}),t.jsxs("div",{className:"card bg-gray-50",children:[t.jsx("p",{className:"text-sm text-gray-600",children:" kt thc"}),t.jsx("p",{className:"text-2xl font-bold text-gray-600",children:W.length})]})]}),t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h3",{className:"font-semibold text-lg",children:"Danh sch ph cp"}),t.jsxs("button",{onClick:()=>o(!0),className:"btn btn-primary",children:[t.jsx(Dt,{size:20}),"Thm ph cp"]})]}),X.length>0&&t.jsxs("div",{className:"card mb-4",children:[t.jsxs("h4",{className:"font-medium text-green-700 mb-3 flex items-center gap-2",children:[t.jsx("span",{className:"w-3 h-3 bg-green-500 rounded-full"}),"ang hiu lc (",X.length,")"]}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Khon ph cp"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"T ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"n ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Ghi ch"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Thao tc"})]})}),t.jsx("tbody",{children:X.map(V=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3 font-medium",children:V.khoanLuong.tenKhoan}),t.jsx("td",{className:"py-2 px-3 text-right font-semibold text-primary-600",children:Ye(V.soTien)}),t.jsx("td",{className:"py-2 px-3",children:js(V.tuNgay)}),t.jsx("td",{className:"py-2 px-3",children:V.denNgay?js(V.denNgay):"Khng xc nh"}),t.jsx("td",{className:"py-2 px-3 text-gray-500 text-sm",children:V.ghiChu||"-"}),t.jsx("td",{className:"py-2 px-3",children:t.jsxs("div",{className:"flex justify-center gap-1",children:[t.jsx("button",{onClick:()=>{u(V),T({soTienMoi:V.soTien,tuNgay:new Date().toISOString().split("T")[0],ghiChu:""})},className:"p-1 hover:bg-blue-100 rounded text-blue-600",title:"iu chnh",children:t.jsx(oi,{size:18})}),t.jsx("button",{onClick:()=>J.mutate(V.id),className:"p-1 hover:bg-yellow-100 rounded text-yellow-600",title:"Tm dng",children:t.jsx(M_,{size:18})}),t.jsx("button",{onClick:()=>{m(V),w({denNgay:new Date().toISOString().split("T")[0]})},className:"p-1 hover:bg-red-100 rounded text-red-600",title:"Kt thc",children:t.jsx(Lt,{size:18})})]})})]},V.id))})]})]}),I.length>0&&t.jsxs("div",{className:"card mb-4",children:[t.jsxs("h4",{className:"font-medium text-yellow-700 mb-3 flex items-center gap-2",children:[t.jsx("span",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),"Tm dng (",I.length,")"]}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Khon ph cp"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Trng thi"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Thao tc"})]})}),t.jsx("tbody",{children:I.map(V=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3",children:V.khoanLuong.tenKhoan}),t.jsx("td",{className:"py-2 px-3 text-right",children:Ye(V.soTien)}),t.jsx("td",{className:"py-2 px-3",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${xe(V.trangThai)}`,children:H(V.trangThai)})}),t.jsx("td",{className:"py-2 px-3 text-center",children:t.jsx("button",{onClick:()=>B.mutate(V.id),className:"p-1 hover:bg-green-100 rounded text-green-600",title:"Kch hot li",children:t.jsx(hp,{size:18})})})]},V.id))})]})]}),F?t.jsx("div",{className:"text-center py-8",children:"ang ti..."}):(P==null?void 0:P.length)===0?t.jsxs("div",{className:"card text-center py-8 text-gray-500",children:[t.jsx(di,{size:48,className:"mx-auto mb-4 text-gray-300"}),t.jsx("p",{children:"Nhn vin cha c ph cp no"}),t.jsxs("button",{onClick:()=>o(!0),className:"btn btn-primary mt-4",children:[t.jsx(Dt,{size:20}),"Thm ph cp u tin"]})]}):null]}),r==="lich-su"&&t.jsxs("div",{className:"card",children:[t.jsx("h3",{className:"font-semibold mb-4",children:"Lch s thay i ph cp"}),P&&P.length>0?t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Khon ph cp"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"T ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"n ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Trng thi"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Ghi ch"})]})}),t.jsx("tbody",{children:P.map(V=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3",children:V.khoanLuong.tenKhoan}),t.jsx("td",{className:"py-2 px-3 text-right font-medium",children:Ye(V.soTien)}),t.jsx("td",{className:"py-2 px-3",children:js(V.tuNgay)}),t.jsx("td",{className:"py-2 px-3",children:V.denNgay?js(V.denNgay):"-"}),t.jsx("td",{className:"py-2 px-3",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${xe(V.trangThai)}`,children:H(V.trangThai)})}),t.jsx("td",{className:"py-2 px-3 text-gray-500 text-sm",children:V.ghiChu||"-"})]},V.id))})]}):t.jsx("p",{className:"text-gray-500 text-center py-8",children:"Cha c d liu lch s"})]}),r==="lich-su-phong-ban"&&t.jsx(kD,{nhanVienId:n}),l&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm ph cp mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Khon ph cp *"}),t.jsxs("select",{value:g.khoanLuongId,onChange:V=>b({...g,khoanLuongId:Number(V.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn khon ph cp --"}),R==null?void 0:R.map(V=>t.jsx("option",{value:V.id,children:V.tenKhoan},V.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S tin *"}),t.jsx("input",{type:"number",value:g.soTien,onChange:V=>b({...g,soTien:Number(V.target.value)}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: 500000"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy bt u *"}),t.jsx(Ut,{value:g.tuNgay,onChange:V=>b({...g,tuNgay:V}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy kt thc (ty chn)"}),t.jsx(Ut,{value:g.denNgay,onChange:V=>b({...g,denNgay:V}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ghi ch"}),t.jsx("textarea",{value:g.ghiChu,onChange:V=>b({...g,ghiChu:V.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[t.jsx("button",{onClick:()=>o(!1),className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:Z,disabled:O.isPending,className:"btn btn-primary",children:O.isPending?"ang lu...":"Thm ph cp"})]})]})}),d&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"iu chnh ph cp"}),t.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg mb-4",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Khon ph cp"}),t.jsx("p",{className:"font-medium",children:d.khoanLuong.tenKhoan}),t.jsxs("p",{className:"text-sm text-gray-500",children:["Hin ti: ",Ye(d.soTien)]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S tin mi *"}),t.jsx("input",{type:"number",value:j.soTienMoi,onChange:V=>T({...j,soTienMoi:Number(V.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy hiu lc mi *"}),t.jsx(Ut,{value:j.tuNgay,onChange:V=>T({...j,tuNgay:V}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"L do iu chnh"}),t.jsx("textarea",{value:j.ghiChu,onChange:V=>T({...j,ghiChu:V.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[t.jsx("button",{onClick:()=>u(null),className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:Q,disabled:M.isPending,className:"btn btn-primary",children:M.isPending?"ang lu...":"iu chnh"})]})]})}),x&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Kt thc ph cp"}),t.jsxs("div",{className:"bg-red-50 p-3 rounded-lg mb-4",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Khon ph cp"}),t.jsx("p",{className:"font-medium",children:x.khoanLuong.tenKhoan}),t.jsxs("p",{className:"text-sm text-red-600",children:["S tin: ",Ye(x.soTien)]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy kt thc *"}),t.jsx(Ut,{value:S.denNgay,onChange:V=>w({denNgay:V}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[t.jsx("button",{onClick:()=>m(null),className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:fe,disabled:q.isPending,className:"btn btn-danger",children:q.isPending?"ang lu...":"Kt thc"})]})]})})]})}function CD(){const e=Mt(),[n,a]=D.useState(!1),[r,s]=D.useState(null),[l,o]=D.useState({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",chiuThue:!1,moTa:""}),{data:d,isLoading:u}=Le({queryKey:["khoan-luong"],queryFn:()=>pr.layTatCa()}),x=De({mutationFn:pr.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["khoan-luong"]}),ie.success("To khon lng thnh cng!"),p()},onError:T=>{var S,w;ie.error(((w=(S=T.response)==null?void 0:S.data)==null?void 0:w.message)||"C li xy ra")}}),m=De({mutationFn:({id:T,data:S})=>pr.capNhat(T,S),onSuccess:()=>{e.invalidateQueries({queryKey:["khoan-luong"]}),ie.success("Cp nht thnh cng!"),p()},onError:T=>{var S,w;ie.error(((w=(S=T.response)==null?void 0:S.data)==null?void 0:w.message)||"C li xy ra")}}),f=De({mutationFn:pr.xoa,onSuccess:()=>{e.invalidateQueries({queryKey:["khoan-luong"]}),ie.success("Xa khon lng thnh cng!")},onError:T=>{var S,w;ie.error(((w=(S=T.response)==null?void 0:S.data)==null?void 0:w.message)||"C li xy ra")}}),p=()=>{a(!1),s(null),o({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",chiuThue:!1,moTa:""})},N=T=>{s(T),o({maKhoan:T.maKhoan,tenKhoan:T.tenKhoan,loai:T.loai,chiuThue:T.chiuThue,moTa:T.moTa||""}),a(!0)},y=()=>{if(!l.maKhoan||!l.tenKhoan){ie.error("Vui lng in y  thng tin bt buc");return}r?m.mutate({id:r.id,data:l}):x.mutate(l)},g=T=>{confirm(`Bn c chc mun xa khon lng "${T.tenKhoan}"?`)&&f.mutate(T.id)},b=(d==null?void 0:d.filter(T=>T.loai==="THU_NHAP"))||[],j=(d==null?void 0:d.filter(T=>T.loai==="KHAU_TRU"))||[];return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[t.jsx(gr,{size:28}),"Qun l Khon lng"]}),t.jsxs("button",{onClick:()=>a(!0),className:"btn btn-primary",children:[t.jsx(Dt,{size:20}),"Thm khon lng"]})]}),u?t.jsx("p",{className:"text-center py-8 text-gray-500",children:"ang ti..."}):t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"card",children:[t.jsxs("h2",{className:"text-lg font-semibold text-green-700 mb-4 flex items-center gap-2",children:[t.jsx("span",{className:"w-3 h-3 bg-green-500 rounded-full"}),"Cc khon Thu nhp (",b.length,")"]}),t.jsxs("div",{className:"space-y-2",children:[b.map(T=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(rl,{size:16,className:"text-gray-400 cursor-grab"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:T.tenKhoan}),t.jsxs("p",{className:"text-xs text-gray-500",children:[T.maKhoan,T.chiuThue&&t.jsx("span",{className:"ml-2 px-1.5 py-0.5 bg-orange-100 text-orange-700 rounded",children:"Chu thu"})]})]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:()=>N(T),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-lg",children:t.jsx(Za,{size:16})}),t.jsx("button",{onClick:()=>g(T),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg",children:t.jsx(er,{size:16})})]})]},T.id)),b.length===0&&t.jsx("p",{className:"text-gray-500 text-center py-4",children:"Cha c khon thu nhp"})]})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h2",{className:"text-lg font-semibold text-red-700 mb-4 flex items-center gap-2",children:[t.jsx("span",{className:"w-3 h-3 bg-red-500 rounded-full"}),"Cc khon Khu tr (",j.length,")"]}),t.jsxs("div",{className:"space-y-2",children:[j.map(T=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(rl,{size:16,className:"text-gray-400 cursor-grab"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:T.tenKhoan}),t.jsx("p",{className:"text-xs text-gray-500",children:T.maKhoan})]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:()=>N(T),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-lg",children:t.jsx(Za,{size:16})}),t.jsx("button",{onClick:()=>g(T),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg",children:t.jsx(er,{size:16})})]})]},T.id)),j.length===0&&t.jsx("p",{className:"text-gray-500 text-center py-4",children:"Cha c khon khu tr (BHXH, thu s thm  y)"})]})]})]}),n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:r?"Sa khon lng":"Thm khon lng mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M khon *"}),t.jsx("input",{type:"text",value:l.maKhoan,onChange:T=>o({...l,maKhoan:T.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: PHU_CAP_XE",disabled:!!r})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tn khon *"}),t.jsx("input",{type:"text",value:l.tenKhoan,onChange:T=>o({...l,tenKhoan:T.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ph cp xe"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi"}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"radio",name:"loai",checked:l.loai==="THU_NHAP",onChange:()=>o({...l,loai:"THU_NHAP"})}),t.jsx("span",{className:"text-green-700",children:"Thu nhp (+)"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"radio",name:"loai",checked:l.loai==="KHAU_TRU",onChange:()=>o({...l,loai:"KHAU_TRU"})}),t.jsx("span",{className:"text-red-700",children:"Khu tr (-)"})]})]})]}),t.jsx("div",{children:t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:l.chiuThue,onChange:T=>o({...l,chiuThue:T.target.checked})}),t.jsx("span",{className:"text-sm",children:"Khon ny chu thu TNCN"})]})}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M t"}),t.jsx("textarea",{value:l.moTa,onChange:T=>o({...l,moTa:T.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:p,className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:y,disabled:x.isPending||m.isPending,className:"btn btn-primary",children:x.isPending||m.isPending?"ang lu...":"Lu"})]})]})})]})}function SD(){const e=Mt(),n=D.useRef(null),[a,r]=D.useState("upload"),[s,l]=D.useState(null),[o,d]=D.useState([]),[u,x]=D.useState([]),[m,f]=D.useState([]),[p,N]=D.useState(new Date().getMonth()+1),[y,g]=D.useState(new Date().getFullYear()),[b,j]=D.useState(0),[T,S]=D.useState(null),{data:w}=Le({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),{data:_}=Le({queryKey:["khoan-luong"],queryFn:()=>pr.layTatCa()}),E=De({mutationFn:q=>x0.docHeader(q),onSuccess:q=>{d(q.headers),x(q.duLieuMau),C.mutate(s)},onError:()=>{ie.error("Khng th c file Excel")}}),C=De({mutationFn:q=>x0.goiYMapping(q),onSuccess:q=>{f(q),r("mapping")}}),P=De({mutationFn:()=>x0.import(s,p,y,b,m),onSuccess:q=>{S(q),r("result"),e.invalidateQueries({queryKey:["bang-luong"]}),q.thanhCong?ie.success("Import thnh cng!"):ie.error(`Import c ${q.dongLoi} dng li`)},onError:q=>{var J,B;ie.error(((B=(J=q.response)==null?void 0:J.data)==null?void 0:B.message)||"C li khi import")}}),F=q=>{var B;const J=(B=q.target.files)==null?void 0:B[0];if(J){if(!J.name.endsWith(".xlsx")&&!J.name.endsWith(".xls")){ie.error("Vui lng chn file Excel (.xlsx hoc .xls)");return}l(J),E.mutate(J)}},R=(q,J,B)=>{const ue=[...m];ue[q]={...ue[q],[J]:B},f(ue)},O=()=>{if(!b){ie.error("Vui lng chn phng ban");return}if(!m.some(J=>J.loaiMapping==="thong_tin"&&J.truongHeThong==="ma_nhan_vien")){ie.error("Cn mapping ct M nhn vin");return}P.mutate()},M=()=>{r("upload"),l(null),d([]),x([]),f([]),S(null),n.current&&(n.current.value="")};return t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2 mb-6",children:[t.jsx(Ts,{size:28}),"Import t Excel"]}),t.jsx("div",{className:"flex items-center gap-4 mb-8",children:["Upload file","Mapping ct","Kt qu"].map((q,J)=>{const B=["upload","mapping","result"],ue=a===B[J],te=B.indexOf(a)>J;return t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:`
                  w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold
                  ${ue?"bg-primary-600 text-white":""}
                  ${te?"bg-green-500 text-white":""}
                  ${!ue&&!te?"bg-gray-200 text-gray-500":""}
                `,children:te?"":J+1}),t.jsx("span",{className:ue?"font-semibold":"text-gray-500",children:q}),J<2&&t.jsx(p_,{size:16,className:"text-gray-400 ml-2"})]},q)})}),a==="upload"&&t.jsx("div",{className:"card",children:t.jsxs("div",{className:"text-center py-12",children:[t.jsx(ei,{size:64,className:"mx-auto text-gray-400 mb-4"}),t.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Chn file Excel  import"}),t.jsx("p",{className:"text-gray-500 mb-6",children:"H tr nh dng .xlsx v .xls"}),t.jsx("input",{ref:n,type:"file",accept:".xlsx,.xls",onChange:F,className:"hidden"}),t.jsxs("button",{onClick:()=>{var q;return(q=n.current)==null?void 0:q.click()},disabled:E.isPending,className:"btn btn-primary",children:[t.jsx(Ts,{size:20}),E.isPending?"ang c file...":"Chn file Excel"]})]})}),a==="mapping"&&t.jsxs("div",{children:[t.jsxs("div",{className:"card mb-6",children:[t.jsx("h3",{className:"font-semibold mb-4",children:"Thng tin import"}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"File"}),t.jsx("p",{className:"font-medium",children:s==null?void 0:s.name})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Thng"}),t.jsx("select",{value:p,onChange:q=>N(Number(q.target.value)),className:"w-full border rounded-lg px-3 py-2",children:Array.from({length:12},(q,J)=>J+1).map(q=>t.jsxs("option",{value:q,children:["Thng ",q]},q))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Nm"}),t.jsx("select",{value:y,onChange:q=>g(Number(q.target.value)),className:"w-full border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(q=>t.jsx("option",{value:q,children:q},q))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban *"}),t.jsxs("select",{value:b,onChange:q=>j(Number(q.target.value)),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn --"}),w==null?void 0:w.map(q=>t.jsx("option",{value:q.id,children:q.tenPhongBan},q.id))]})]})]})]}),t.jsxs("div",{className:"card mb-6",children:[t.jsx("h3",{className:"font-semibold mb-4",children:"Mapping ct Excel  Khon lng"}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Ct"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Tn ct Excel"}),t.jsx("th",{className:"text-left py-2 px-3",children:"D liu mu"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Loi"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Mapping"})]})}),t.jsx("tbody",{children:m.map((q,J)=>{var B;return t.jsxs("tr",{className:"border-b",children:[t.jsx("td",{className:"py-2 px-3",children:q.soCot}),t.jsx("td",{className:"py-2 px-3 font-medium",children:q.tenCot}),t.jsx("td",{className:"py-2 px-3 text-gray-500",children:((B=u[0])==null?void 0:B[J])||"-"}),t.jsx("td",{className:"py-2 px-3",children:t.jsxs("select",{value:q.loaiMapping,onChange:ue=>R(J,"loaiMapping",ue.target.value),className:"border rounded px-2 py-1 text-sm",children:[t.jsx("option",{value:"thong_tin",children:"Thng tin"}),t.jsx("option",{value:"khoan_luong",children:"Khon lng"})]})}),t.jsx("td",{className:"py-2 px-3",children:q.loaiMapping==="thong_tin"?t.jsxs("select",{value:q.truongHeThong||"",onChange:ue=>R(J,"truongHeThong",ue.target.value),className:"border rounded px-2 py-1 text-sm w-full",children:[t.jsx("option",{value:"",children:"-- B qua --"}),t.jsx("option",{value:"ma_nhan_vien",children:"M nhn vin"}),t.jsx("option",{value:"ho_ten",children:"H tn"}),t.jsx("option",{value:"phong_ban",children:"Phng ban"}),t.jsx("option",{value:"tong_luong_bo_qua",children:"Tng (b qua)"})]}):t.jsxs("select",{value:q.khoanLuongId||"",onChange:ue=>R(J,"khoanLuongId",Number(ue.target.value)||void 0),className:"border rounded px-2 py-1 text-sm w-full",children:[t.jsx("option",{value:"",children:"-- B qua --"}),_==null?void 0:_.map(ue=>t.jsx("option",{value:ue.id,children:ue.tenKhoan},ue.id))]})})]},J)})})]})})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("button",{onClick:M,className:"btn btn-secondary",children:"Quay li"}),t.jsx("button",{onClick:O,disabled:P.isPending,className:"btn btn-primary",children:P.isPending?"ang import...":"Bt u Import"})]})]}),a==="result"&&T&&t.jsxs("div",{children:[t.jsx("div",{className:`card mb-6 ${T.thanhCong?"bg-green-50":"bg-yellow-50"}`,children:t.jsxs("div",{className:"flex items-center gap-4",children:[T.thanhCong?t.jsx(Gn,{size:48,className:"text-green-500"}):t.jsx(di,{size:48,className:"text-yellow-500"}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold",children:T.thanhCong?"Import thnh cng!":"Import hon tt (c li)"}),t.jsxs("p",{className:"text-gray-600",children:[" import ",T.dongThanhCong,"/",T.tongDong," dng"]})]})]})}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"card text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-green-600",children:T.dongThanhCong}),t.jsx("p",{className:"text-gray-500",children:"Dng thnh cng"})]}),t.jsxs("div",{className:"card text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-red-600",children:T.dongLoi}),t.jsx("p",{className:"text-gray-500",children:"Dng li"})]}),t.jsxs("div",{className:"card text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-primary-600",children:Ye(T.tongTienImport)}),t.jsx("p",{className:"text-gray-500",children:"Tng tin import"})]})]}),T.chiTietLoi.length>0&&t.jsxs("div",{className:"card mb-6",children:[t.jsx("h3",{className:"font-semibold text-red-600 mb-3",children:"Chi tit li"}),t.jsx("div",{className:"max-h-48 overflow-y-auto",children:T.chiTietLoi.map((q,J)=>t.jsxs("div",{className:"flex items-center gap-2 py-2 border-b",children:[t.jsx(mo,{size:16,className:"text-red-500"}),t.jsxs("span",{className:"font-medium",children:["Dng ",q.dong,":"]}),t.jsx("span",{className:"text-gray-600",children:q.lyDo})]},J))})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx("button",{onClick:M,className:"btn btn-secondary",children:"Import file khc"}),t.jsx("a",{href:`/bang-luong/${T.bangLuongId}`,className:"btn btn-primary",children:"Xem bng lng"})]})]})]})}const mf={layDanhSach:(e,n,a)=>{const r=new URLSearchParams({thang:String(e),nam:String(n)});return a&&r.append("phongBanId",String(a)),he.get(`/cham-cong?${r}`)},layChamCongNhanVien:(e,n,a)=>he.get(`/cham-cong/nhan-vien/${e}?thang=${n}&nam=${a}`),luu:e=>he.post("/cham-cong",e),khoiTao:(e,n,a=26)=>he.post("/cham-cong/khoi-tao",{thang:e,nam:n,soCongChuan:a}),import:(e,n,a)=>he.post("/cham-cong/import",{thang:e,nam:n,duLieu:a})},ff={lay:e=>he.get(`/cham-cong/cau-hinh-phat/${e}`),capNhat:(e,n)=>he.put(`/cham-cong/cau-hinh-phat/${e}`,n),tinhPhat:(e,n,a)=>he.get(`/cham-cong/tinh-phat/${e}?thang=${n}&nam=${a}`)},_D={dongBoCSV:e=>he.post("/cham-cong/dong-bo-csv",{csvContent:e})};function ED(){const[e,n]=D.useState("cham-cong"),[a,r]=D.useState(new Date().getMonth()+1),[s,l]=D.useState(new Date().getFullYear()),[o,d]=D.useState(),[u,x]=D.useState([]),[m,f]=D.useState([]),[p,N]=D.useState(null),[y,g]=D.useState({}),[b,j]=D.useState(!1),[T,S]=D.useState(null),[w,_]=D.useState({}),[E,C]=D.useState(null),[P,F]=D.useState(null),[R,O]=D.useState(!1),M=D.useRef(null);D.useEffect(()=>{he.get("/phong-ban").then(L=>x(L.data))},[]),D.useEffect(()=>{q()},[a,s,o]),D.useEffect(()=>{e==="cau-hinh"&&J()},[e,s]);const q=async()=>{j(!0);try{const L=await mf.layDanhSach(a,s,o);f(L.data);const X={};for(const I of L.data)if(I.soLanDiMuon>0||I.soLanVeSom>0||Number(I.soNgayNghiKhongLuong)>0)try{const W=await ff.tinhPhat(I.nhanVienId,a,s);X[I.nhanVienId]=W.data}catch{}g(X)}catch{ie.error("Li ti d liu chm cng")}j(!1)},J=async()=>{try{const L=await ff.lay(s);N(L.data)}catch{ie.error("Li ti cu hnh pht")}},B=async()=>{if(confirm(`Khi to chm cng thng ${a}/${s} cho tt c nhn vin?`))try{const L=await mf.khoiTao(a,s,26);ie.success(`${L.data.message} -  to: ${L.data.created}, B qua: ${L.data.skipped}`),q()}catch{ie.error("Li khi to chm cng")}},ue=L=>{S(L.id),_({nhanVienId:L.nhanVienId,thang:L.thang,nam:L.nam,soCongChuan:Number(L.soCongChuan),soCongThucTe:Number(L.soCongThucTe),soNgayNghiPhep:Number(L.soNgayNghiPhep),soNgayNghiKhongLuong:Number(L.soNgayNghiKhongLuong),soGioOT:Number(L.soGioOT),soLanDiMuon:L.soLanDiMuon,soLanVeSom:L.soLanVeSom})},te=async()=>{if(w.nhanVienId)try{await mf.luu(w),ie.success(" lu chm cng"),S(null),_({}),q()}catch{ie.error("Li lu chm cng")}},Z=async()=>{if(p)try{await ff.capNhat(s,p),ie.success(" lu cu hnh pht")}catch{ie.error("Li lu cu hnh")}},Q=L=>new Intl.NumberFormat("vi-VN").format(L)+" ",fe=L=>{var I;const X=(I=L.target.files)==null?void 0:I[0];X&&(C(X),F(null))},K=async()=>{var L,X;if(!E){ie.error("Vui lng chn file CSV");return}O(!0);try{const I=await E.text(),W=await _D.dongBoCSV(I);F(W.data),ie.success(` ng b ${W.data.luuThanhCong} nhn vin thnh cng`),q()}catch(I){ie.error(((X=(L=I==null?void 0:I.response)==null?void 0:L.data)==null?void 0:X.message)||"Li ng b file")}O(!1)};return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex justify-between items-center",children:t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[t.jsx(an,{className:"text-primary-600"}),"Qun l Chm cng"]}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Theo di chm cng, i mun, ngh khng php"})]})}),t.jsx("div",{className:"border-b border-gray-200",children:t.jsxs("nav",{className:"flex gap-4",children:[t.jsxs("button",{onClick:()=>n("cham-cong"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${e==="cham-cong"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(on,{size:18,className:"inline mr-2"}),"Chm cng thng"]}),t.jsxs("button",{onClick:()=>n("dong-bo"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${e==="dong-bo"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(Ts,{size:18,className:"inline mr-2"}),"ng b my chm cng"]}),t.jsxs("button",{onClick:()=>n("cau-hinh"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${e==="cau-hinh"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(ts,{size:18,className:"inline mr-2"}),"Cu hnh pht"]})]})}),e==="cham-cong"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Thng"}),t.jsx("select",{value:a,onChange:L=>r(Number(L.target.value)),className:"border rounded-lg px-3 py-2",children:[...Array(12)].map((L,X)=>t.jsxs("option",{value:X+1,children:["Thng ",X+1]},X+1))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Nm"}),t.jsx("select",{value:s,onChange:L=>l(Number(L.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(L=>t.jsx("option",{value:L,children:L},L))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban"}),t.jsxs("select",{value:o||"",onChange:L=>d(L.target.value?Number(L.target.value):void 0),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),u.map(L=>t.jsx("option",{value:L.id,children:L.tenPhongBan},L.id))]})]}),t.jsxs("button",{onClick:q,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg",children:[t.jsx(yr,{size:18}),"Lm mi"]}),t.jsxs("button",{onClick:B,className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white hover:bg-primary-700 rounded-lg",children:[t.jsx(Lt,{size:18}),"Khi to thng"]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Cng chun"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Cng thc"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Ngh php"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Ngh KL"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"i mun"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"V sm"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"OT (gi)"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Tin pht"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:b?t.jsx("tr",{children:t.jsx("td",{colSpan:11,className:"px-4 py-8 text-center text-gray-500",children:"ang ti..."})}):m.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:11,className:"px-4 py-8 text-center text-gray-500",children:'Cha c d liu chm cng. Nhn "Khi to thng"  bt u.'})}):m.map(L=>{var z,xe,H,ne;const X=T===L.id,I=y[L.nhanVienId],W=L.soLanDiMuon>0||L.soLanVeSom>0||Number(L.soNgayNghiKhongLuong)>0;return t.jsxs("tr",{className:W?"bg-red-50":"",children:[t.jsxs("td",{className:"px-4 py-3",children:[t.jsx("div",{className:"font-medium text-gray-900",children:(z=L.nhanVien)==null?void 0:z.hoTen}),t.jsx("div",{className:"text-sm text-gray-500",children:(xe=L.nhanVien)==null?void 0:xe.maNhanVien})]}),t.jsx("td",{className:"px-4 py-3 text-gray-600",children:(ne=(H=L.nhanVien)==null?void 0:H.phongBan)==null?void 0:ne.tenPhongBan}),t.jsx("td",{className:"px-4 py-3 text-center",children:X?t.jsx("input",{type:"number",value:w.soCongChuan||0,onChange:oe=>_({...w,soCongChuan:Number(oe.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(L.soCongChuan)}),t.jsx("td",{className:"px-4 py-3 text-center",children:X?t.jsx("input",{type:"number",value:w.soCongThucTe||0,onChange:oe=>_({...w,soCongThucTe:Number(oe.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(L.soCongThucTe)}),t.jsx("td",{className:"px-4 py-3 text-center",children:X?t.jsx("input",{type:"number",value:w.soNgayNghiPhep||0,onChange:oe=>_({...w,soNgayNghiPhep:Number(oe.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(L.soNgayNghiPhep)}),t.jsx("td",{className:"px-4 py-3 text-center",children:X?t.jsx("input",{type:"number",value:w.soNgayNghiKhongLuong||0,onChange:oe=>_({...w,soNgayNghiKhongLuong:Number(oe.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):t.jsx("span",{className:Number(L.soNgayNghiKhongLuong)>0?"text-red-600 font-semibold":"",children:Number(L.soNgayNghiKhongLuong)})}),t.jsx("td",{className:"px-4 py-3 text-center",children:X?t.jsx("input",{type:"number",value:w.soLanDiMuon||0,onChange:oe=>_({...w,soLanDiMuon:Number(oe.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):t.jsx("span",{className:L.soLanDiMuon>0?"text-orange-600 font-semibold":"",children:L.soLanDiMuon})}),t.jsx("td",{className:"px-4 py-3 text-center",children:X?t.jsx("input",{type:"number",value:w.soLanVeSom||0,onChange:oe=>_({...w,soLanVeSom:Number(oe.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):t.jsx("span",{className:L.soLanVeSom>0?"text-orange-600 font-semibold":"",children:L.soLanVeSom})}),t.jsx("td",{className:"px-4 py-3 text-center text-blue-600",children:X?t.jsx("input",{type:"number",value:w.soGioOT||0,onChange:oe=>_({...w,soGioOT:Number(oe.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(L.soGioOT)}),t.jsx("td",{className:"px-4 py-3 text-right",children:I&&I.tongPhat>0&&t.jsx("div",{className:"text-red-600 font-semibold",title:`Pht i mun: ${Q(I.tienPhatDiMuon)}
Pht v sm: ${Q(I.tienPhatVeSom)}
Pht ngh KP: ${Q(I.tienPhatNghiKhongPhep)}
Tr lng: ${Q(I.truLuongNgayCong)}`,children:Q(I.tongPhat)})}),t.jsx("td",{className:"px-4 py-3 text-center",children:X?t.jsxs("div",{className:"flex gap-2 justify-center",children:[t.jsx("button",{onClick:te,className:"p-1 text-green-600 hover:bg-green-50 rounded",children:t.jsx(Es,{size:18})}),t.jsx("button",{onClick:()=>{S(null),_({})},className:"p-1 text-gray-600 hover:bg-gray-100 rounded",children:""})]}):t.jsx("button",{onClick:()=>ue(L),className:"p-1 text-primary-600 hover:bg-primary-50 rounded",children:"Sa"})})]},L.id)})})]})})}),m.length>0&&t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng nhn vin"}),t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:m.length})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"i mun"}),t.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[m.filter(L=>L.soLanDiMuon>0).length," NV"]})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Ngh khng php"}),t.jsxs("div",{className:"text-2xl font-bold text-red-600",children:[m.filter(L=>Number(L.soNgayNghiKhongLuong)>0).length," NV"]})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng tin pht"}),t.jsx("div",{className:"text-2xl font-bold text-red-600",children:Q(Object.values(y).reduce((L,X)=>L+X.tongPhat,0))})]})]})]}),e==="dong-bo"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(Ts,{className:"text-primary-600",size:20}),"Upload file CSV t my chm cng"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{onClick:()=>{var L;return(L=M.current)==null?void 0:L.click()},className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-primary-400 transition-colors",children:[t.jsx(ma,{className:"mx-auto text-gray-400 mb-3",size:48}),E?t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-800",children:E.name}),t.jsxs("p",{className:"text-sm text-gray-500",children:[(E.size/1024).toFixed(1)," KB"]})]}):t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-600",children:"Nhp  chn file CSV"}),t.jsx("p",{className:"text-sm text-gray-400",children:"H tr file t my chm cng (Access Controller)"})]}),t.jsx("input",{ref:M,type:"file",accept:".csv",onChange:fe,className:"hidden"})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsxs("button",{onClick:K,disabled:!E||R,className:"flex items-center gap-2 px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[R?t.jsx(yr,{size:18,className:"animate-spin"}):t.jsx(Ts,{size:18}),R?"ang x l...":"ng b d liu"]}),E&&t.jsx("button",{onClick:()=>{C(null),F(null),M.current&&(M.current.value="")},className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"Xa file"})]})]})]}),P&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng bn ghi"}),t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:P.tongBanGhi})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"S ngy cng"}),t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:P.tongNgay})]}),t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Lu thnh cng"}),t.jsxs("div",{className:"text-2xl font-bold text-green-600 flex items-center gap-2",children:[t.jsx(Gn,{size:24})," ",P.luuThanhCong]})]}),t.jsxs("div",{className:"bg-red-50 p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Li"}),t.jsxs("div",{className:"text-2xl font-bold text-red-600 flex items-center gap-2",children:[t.jsx(mo,{size:24})," ",P.luuThatBai]})]})]}),P.thongKe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b",children:t.jsx("h4",{className:"font-semibold",children:"Thng k theo nhn vin"})}),t.jsx("div",{className:"overflow-x-auto max-h-64",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Thng/Nm"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"S cng"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"i mun"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"V sm"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:P.thongKe.map((L,X)=>t.jsxs("tr",{className:L.soLanDiMuon>0||L.soLanVeSom>0?"bg-orange-50":"",children:[t.jsx("td",{className:"px-4 py-2 font-medium",children:L.maNhanVien}),t.jsxs("td",{className:"px-4 py-2 text-center",children:[L.thang,"/",L.nam]}),t.jsx("td",{className:"px-4 py-2 text-center text-blue-600 font-semibold",children:L.soCongThucTe}),t.jsx("td",{className:"px-4 py-2 text-center",children:t.jsx("span",{className:L.soLanDiMuon>0?"text-orange-600 font-semibold":"",children:L.soLanDiMuon})}),t.jsx("td",{className:"px-4 py-2 text-center",children:t.jsx("span",{className:L.soLanVeSom>0?"text-orange-600 font-semibold":"",children:L.soLanVeSom})})]},X))})]})})]}),P.chiTiet.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b",children:t.jsxs("h4",{className:"font-semibold",children:["Chi tit chm cng (",P.chiTiet.length," ngy)"]})}),t.jsxs("div",{className:"overflow-x-auto max-h-96",children:[t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Gi vo"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Gi ra"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:P.chiTiet.slice(0,100).map((L,X)=>t.jsxs("tr",{className:L.diMuon||L.veSom?"bg-orange-50":"",children:[t.jsx("td",{className:"px-4 py-2 font-medium",children:L.maNhanVien}),t.jsx("td",{className:"px-4 py-2",children:L.ngay}),t.jsxs("td",{className:"px-4 py-2 text-center",children:[t.jsx("span",{className:L.diMuon?"text-orange-600 font-semibold":"",children:L.gioVao||"-"}),L.diMuon&&t.jsxs("span",{className:"text-xs text-orange-500 ml-1",children:["(+",L.phutMuon,"p)"]})]}),t.jsxs("td",{className:"px-4 py-2 text-center",children:[t.jsx("span",{className:L.veSom?"text-orange-600 font-semibold":"",children:L.gioRa||"-"}),L.veSom&&t.jsxs("span",{className:"text-xs text-orange-500 ml-1",children:["(-",L.phutSom,"p)"]})]}),t.jsxs("td",{className:"px-4 py-2 text-center",children:[L.diMuon&&t.jsx("span",{className:"px-2 py-0.5 bg-orange-100 text-orange-700 text-xs rounded mr-1",children:"Mun"}),L.veSom&&t.jsx("span",{className:"px-2 py-0.5 bg-orange-100 text-orange-700 text-xs rounded",children:"Sm"}),!L.diMuon&&!L.veSom&&t.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded",children:"OK"})]})]},X))})]}),P.chiTiet.length>100&&t.jsxs("div",{className:"px-4 py-2 bg-gray-50 text-center text-sm text-gray-500",children:["Hin th 100/",P.chiTiet.length," bn ghi"]})]})]}),P.loi.length>0&&t.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[t.jsxs("h4",{className:"font-semibold text-red-800 mb-2",children:[" Li (",P.loi.length,")"]}),t.jsx("ul",{className:"text-sm text-red-700 space-y-1 list-disc ml-5",children:P.loi.map((L,X)=>t.jsx("li",{children:L},X))})]})]}),t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:" Hng dn:"}),t.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc ml-5",children:[t.jsx("li",{children:"Upload file CSV xut t my chm cng (Access Controller)"}),t.jsxs("li",{children:["Format: Tn ring, H, ",t.jsx("strong",{children:"ID (m NV)"}),", B phn, ",t.jsx("strong",{children:"Ngy"}),", ",t.jsx("strong",{children:"Thi gian"}),", ..."]}),t.jsx("li",{children:"H thng t ng nhn din gi vo (qut u bui sng) v gi ra (qut cui bui chiu)"}),t.jsx("li",{children:"So snh vi gi chun (cu hnh trong tab Cu hnh pht)  xc nh i mun/v sm"}),t.jsx("li",{children:"D liu s c tng hp theo thng v lu vo h thng"})]})]})]}),e==="cau-hinh"&&p&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx("label",{className:"font-medium",children:"Nm p dng:"}),t.jsx("select",{value:s,onChange:L=>l(Number(L.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(L=>t.jsx("option",{value:L,children:L},L))})]}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(sa,{className:"text-orange-500",size:20}),"Pht i mun (theo thng)"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"i mun 1-3 ln"}),t.jsx("input",{type:"number",value:Number(p.phatDiMuon1_3Lan),onChange:L=>N({...p,phatDiMuon1_3Lan:Number(L.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"i mun 4-6 ln"}),t.jsx("input",{type:"number",value:Number(p.phatDiMuon4_6Lan),onChange:L=>N({...p,phatDiMuon4_6Lan:Number(L.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"i mun trn 6 ln"}),t.jsx("input",{type:"number",value:Number(p.phatDiMuonTren6Lan),onChange:L=>N({...p,phatDiMuonTren6Lan:Number(L.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]})]}),t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(sa,{className:"text-orange-500",size:20}),"Pht v sm (theo thng)"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"V sm 1-3 ln"}),t.jsx("input",{type:"number",value:Number(p.phatVeSom1_3Lan),onChange:L=>N({...p,phatVeSom1_3Lan:Number(L.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"V sm 4-6 ln"}),t.jsx("input",{type:"number",value:Number(p.phatVeSom4_6Lan),onChange:L=>N({...p,phatVeSom4_6Lan:Number(L.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"V sm trn 6 ln"}),t.jsx("input",{type:"number",value:Number(p.phatVeSomTren6Lan),onChange:L=>N({...p,phatVeSomTren6Lan:Number(L.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]})]}),t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(sa,{className:"text-red-500",size:20}),"Ngh khng php"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Tin pht mi ngy (VN)"}),t.jsx("input",{type:"number",value:Number(p.phatNghiKhongPhep),onChange:L=>N({...p,phatNghiKhongPhep:Number(L.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",id:"truLuong",checked:p.truLuongNghiKhongPhep,onChange:L=>N({...p,truLuongNghiKhongPhep:L.target.checked}),className:"rounded"}),t.jsx("label",{htmlFor:"truLuong",className:"text-sm text-gray-700",children:"Tr thm lng theo ngy cng (Lng / Cng chun  S ngy ngh)"})]})]})]}),t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(an,{className:"text-blue-500",size:20}),"Gi lm vic chun"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Gi vo"}),t.jsx("input",{type:"time",value:p.gioVaoChuan,onChange:L=>N({...p,gioVaoChuan:L.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Gi ra"}),t.jsx("input",{type:"time",value:p.gioRaChuan,onChange:L=>N({...p,gioRaChuan:L.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"S pht c php tr"}),t.jsx("input",{type:"number",value:p.phutChoPhepTre,onChange:L=>N({...p,phutChoPhepTre:Number(L.target.value)}),className:"w-full border rounded-lg px-3 py-2"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Nhn vin n tr trong khong thi gian ny khng b tnh i mun"})]})]})]})]}),t.jsx("div",{className:"flex justify-end",children:t.jsxs("button",{onClick:Z,className:"flex items-center gap-2 px-6 py-2 bg-primary-600 text-white hover:bg-primary-700 rounded-lg",children:[t.jsx(Es,{size:18}),"Lu cu hnh"]})}),t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:" Cch tnh tin pht:"}),t.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc ml-5",children:[t.jsx("li",{children:"Pht i mun: Tnh theo s ln i mun trong thng (1-3, 4-6, hoc >6 ln)"}),t.jsx("li",{children:"Pht v sm: Tnh theo s ln v sm trong thng"}),t.jsx("li",{children:"Pht ngh khng php: Tin pht  S ngy ngh"}),t.jsx("li",{children:"Tr lng: (Lng c bn  Cng chun)  S ngy ngh khng php"}),t.jsx("li",{children:"Tng pht = Pht i mun + Pht v sm + Pht ngh KP + Tr lng"})]})]})]})]})}const hw=[{value:"VAN_HANH",label:"Vn hnh"},{value:"KINH_DOANH",label:"Kinh doanh"},{value:"VAN_PHONG",label:"Vn phng"},{value:"SAN_XUAT",label:"Sn xut"}],Vb=[{value:"TO",label:"T"},{value:"NHOM",label:"Nhm"},{value:"CA",label:"Ca"}];function xw({node:e,level:n=0,onEdit:a,onDelete:r,onAddChild:s,onManageDonViCon:l,expandedNodes:o,toggleExpand:d}){var m,f,p,N;const u=e.children&&e.children.length>0,x=o.has(e.id);return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 py-2 px-3 hover:bg-gray-50 rounded-lg group",style:{marginLeft:n*24},children:[t.jsx("button",{onClick:()=>d(e.id),className:`w-6 h-6 flex items-center justify-center rounded hover:bg-gray-200 ${u?"":"invisible"}`,children:x?t.jsx(Ja,{size:16}):t.jsx(qn,{size:16})}),t.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${n===0?"bg-primary-100 text-primary-600":n===1?"bg-blue-100 text-blue-600":n===2?"bg-green-100 text-green-600":"bg-orange-100 text-orange-600"}`,children:n===0?t.jsx(Mr,{size:16}):t.jsx(hj,{size:16})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-medium text-gray-900",children:e.tenPhongBan}),t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-600",children:e.maPhongBan}),e.loaiPhongBan&&t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-indigo-100 text-indigo-600",children:((m=hw.find(y=>y.value===e.loaiPhongBan))==null?void 0:m.label)||e.loaiPhongBan})]}),e.moTa&&t.jsx("div",{className:"text-xs text-gray-500 truncate",children:e.moTa})]}),t.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[t.jsxs("div",{className:"flex items-center gap-1 text-gray-500",title:"Nhn vin",children:[t.jsx(on,{size:14}),t.jsx("span",{children:((f=e._count)==null?void 0:f.nhanViens)||0})]}),(((p=e._count)==null?void 0:p.donViCons)||0)>0&&t.jsxs("div",{className:"flex items-center gap-1 text-gray-500",title:"n v con",children:[t.jsx(v0,{size:14}),t.jsx("span",{children:(N=e._count)==null?void 0:N.donViCons})]})]}),t.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[t.jsx("button",{onClick:()=>s(e.id),className:"p-1.5 text-green-600 hover:bg-green-50 rounded",title:"Thm phng ban con",children:t.jsx(Dt,{size:16})}),t.jsx("button",{onClick:()=>l(e),className:"p-1.5 text-purple-600 hover:bg-purple-50 rounded",title:"Qun l T/Ca",children:t.jsx(v0,{size:16})}),t.jsx("button",{onClick:()=>a(e),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:"Sa",children:t.jsx(Za,{size:16})}),t.jsx("button",{onClick:()=>r(e),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Ngng hot ng",children:t.jsx(er,{size:16})})]})]}),u&&x&&t.jsx("div",{children:e.children.map(y=>t.jsx(xw,{node:y,level:n+1,onEdit:a,onDelete:r,onAddChild:s,onManageDonViCon:l,expandedNodes:o,toggleExpand:d},y.id))})]})}function DD(){const e=Mt(),[n,a]=D.useState(""),[r,s]=D.useState(new Set),[l,o]=D.useState(!1),[d,u]=D.useState(!1),[x,m]=D.useState(null),[f,p]=D.useState(null),[N,y]=D.useState(null),[g,b]=D.useState({maPhongBan:"",tenPhongBan:"",moTa:"",loaiPhongBan:"",gioVaoChuan:"08:00",gioRaChuan:"17:00",phutChoPhepTre:5}),[j,T]=D.useState({maDonVi:"",tenDonVi:"",loaiDonVi:"TO"}),{data:S,isLoading:w}=Le({queryKey:["phong-ban-cay"],queryFn:Jt.layCayPhongBan}),{data:_}=Le({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),{data:E,refetch:C}=Le({queryKey:["don-vi-con",N==null?void 0:N.id],queryFn:()=>N?Jt.layDonViCon(N.id):Promise.resolve([]),enabled:!!N}),P=De({mutationFn:Jt.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["phong-ban-cay"]}),e.invalidateQueries({queryKey:["phong-ban"]}),te()},onError:I=>{var W,z;alert(((z=(W=I.response)==null?void 0:W.data)==null?void 0:z.message)||"C li xy ra")}}),F=De({mutationFn:({id:I,data:W})=>Jt.capNhat(I,W),onSuccess:()=>{e.invalidateQueries({queryKey:["phong-ban-cay"]}),e.invalidateQueries({queryKey:["phong-ban"]}),te()},onError:I=>{var W,z;alert(((z=(W=I.response)==null?void 0:W.data)==null?void 0:z.message)||"C li xy ra")}}),R=De({mutationFn:Jt.ngungHoatDong,onSuccess:()=>{e.invalidateQueries({queryKey:["phong-ban-cay"]}),e.invalidateQueries({queryKey:["phong-ban"]})},onError:I=>{var W,z;alert(((z=(W=I.response)==null?void 0:W.data)==null?void 0:z.message)||"Khng th ngng hot ng phng ban")}}),O=De({mutationFn:({phongBanId:I,data:W})=>Jt.taoDonViCon(I,W),onSuccess:()=>{C(),T({maDonVi:"",tenDonVi:"",loaiDonVi:"TO"})},onError:I=>{var W,z;alert(((z=(W=I.response)==null?void 0:W.data)==null?void 0:z.message)||"C li xy ra")}}),M=I=>{s(W=>{const z=new Set(W);return z.has(I)?z.delete(I):z.add(I),z})},q=()=>{const I=new Set,W=z=>{z.forEach(xe=>{I.add(xe.id),xe.children&&W(xe.children)})};S&&W(S),s(I)},J=()=>{s(new Set)},B=I=>{m(null),p(I||null),b({maPhongBan:"",tenPhongBan:"",moTa:"",loaiPhongBan:"",gioVaoChuan:"08:00",gioRaChuan:"17:00",phutChoPhepTre:5}),o(!0)},ue=I=>{m(I),p(I.phongBanChaId||null),b({maPhongBan:I.maPhongBan,tenPhongBan:I.tenPhongBan,moTa:I.moTa||"",loaiPhongBan:I.loaiPhongBan||"",gioVaoChuan:I.gioVaoChuan||"08:00",gioRaChuan:I.gioRaChuan||"17:00",phutChoPhepTre:I.phutChoPhepTre??5}),o(!0)},te=()=>{o(!1),m(null),p(null)},Z=I=>{if(I.preventDefault(),!g.maPhongBan.trim()||!g.tenPhongBan.trim()){alert("Vui lng nhp m v tn phng ban");return}const W={...g,phongBanChaId:f||void 0,loaiPhongBan:g.loaiPhongBan||void 0};x?F.mutate({id:x.id,data:W}):P.mutate(W)},Q=I=>{confirm(`Bn c chc mun ngng hot ng phng ban "${I.tenPhongBan}"?`)&&R.mutate(I.id)},fe=I=>{y(I),u(!0)},K=I=>{if(I.preventDefault(),!!N){if(!j.maDonVi.trim()||!j.tenDonVi.trim()){alert("Vui lng nhp m v tn n v");return}O.mutate({phongBanId:N.id,data:j})}},L=I=>I.reduce((W,z)=>W+1+(z.children?L(z.children):0),0),X=S?L(S):0;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Mr,{className:"w-8 h-8 text-primary-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Phng ban"}),t.jsx("p",{className:"text-gray-500",children:"Cu trc t chc cng ty dng cy phn cp"})]})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("button",{onClick:()=>B(),className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[t.jsx(Dt,{size:20}),"Thm phng ban"]})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary-100 flex items-center justify-center",children:t.jsx(Mr,{className:"w-6 h-6 text-primary-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng phng ban"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:X})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-green-100 flex items-center justify-center",children:t.jsx(on,{className:"w-6 h-6 text-green-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng nhn vin"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:(_==null?void 0:_.reduce((I,W)=>{var z;return I+(((z=W._count)==null?void 0:z.nhanViens)||0)},0))||0})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-purple-100 flex items-center justify-center",children:t.jsx(v0,{className:"w-6 h-6 text-purple-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng T/Ca"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:(_==null?void 0:_.reduce((I,W)=>{var z;return I+(((z=W._count)==null?void 0:z.donViCons)||0)},0))||0})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-100 flex items-center justify-center",children:t.jsx(D_,{className:"w-6 h-6 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Cp su nht"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Math.max(...(_==null?void 0:_.map(I=>I.capDo))||[0],0)})]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:q,className:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50",children:"M tt c"}),t.jsx("button",{onClick:J,className:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50",children:"Thu gn"})]}),t.jsxs("div",{className:"relative max-w-xs",children:[t.jsx(Vr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),t.jsx("input",{type:"text",placeholder:"Tm kim...",className:"w-full pl-9 pr-4 py-1.5 text-sm border rounded-lg focus:ring-2 focus:ring-primary-500",value:n,onChange:I=>a(I.target.value)})]})]}),t.jsx("div",{className:"p-4",children:w?t.jsx("div",{className:"text-center py-8 text-gray-500",children:"ang ti..."}):!S||S.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(Mr,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Cha c phng ban no"}),t.jsx("button",{onClick:()=>B(),className:"mt-3 text-primary-600 hover:text-primary-700 text-sm font-medium",children:"+ Thm phng ban u tin"})]}):t.jsx("div",{className:"space-y-1",children:S.map(I=>t.jsx(xw,{node:I,onEdit:ue,onDelete:Q,onAddChild:B,onManageDonViCon:fe,expandedNodes:r,toggleExpand:M},I.id))})})]}),l&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:x?"Cp nht phng ban":"Thm phng ban mi"}),t.jsxs("form",{onSubmit:Z,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban cha"}),t.jsxs("select",{value:f||"",onChange:I=>p(I.target.value?Number(I.target.value):null),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",children:[t.jsx("option",{value:"",children:"-- Khng c (phng ban gc) --"}),_==null?void 0:_.filter(I=>!x||I.id!==x.id).map(I=>t.jsxs("option",{value:I.id,children:["".repeat(I.capDo-1)," ",I.tenPhongBan]},I.id))]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["M phng ban ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:g.maPhongBan,onChange:I=>b({...g,maPhongBan:I.target.value.toUpperCase()}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"VD: HR, IT..."})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn phng ban ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:g.tenPhongBan,onChange:I=>b({...g,tenPhongBan:I.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"VD: Phng Nhn s..."})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi phng ban"}),t.jsxs("select",{value:g.loaiPhongBan,onChange:I=>b({...g,loaiPhongBan:I.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",children:[t.jsx("option",{value:"",children:"-- Chn loi --"}),hw.map(I=>t.jsx("option",{value:I.value,children:I.label},I.value))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("input",{type:"text",value:g.moTa,onChange:I=>b({...g,moTa:I.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"M t ngn..."})]})]}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(an,{className:"w-5 h-5 text-indigo-600"}),t.jsx("h3",{className:"font-medium text-gray-900",children:"Gi lm vic"})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi vo"}),t.jsx("input",{type:"time",value:g.gioVaoChuan,onChange:I=>b({...g,gioVaoChuan:I.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi ra"}),t.jsx("input",{type:"time",value:g.gioRaChuan,onChange:I=>b({...g,gioRaChuan:I.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cho php tr"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"number",min:"0",max:"60",value:g.phutChoPhepTre,onChange:I=>b({...g,phutChoPhepTre:Number(I.target.value)}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 pr-12"}),t.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm",children:"pht"})]})]})]})]}),t.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[t.jsx("button",{type:"button",onClick:te,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",disabled:P.isPending||F.isPending,className:"flex-1 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:P.isPending||F.isPending?"ang lu...":x?"Cp nht":"Thm mi"})]})]})]})}),d&&N&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["T/Ca/Nhm - ",N.tenPhongBan]}),t.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),t.jsxs("form",{onSubmit:K,className:"flex items-end gap-3 mb-4 p-4 bg-gray-50 rounded-lg",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M"}),t.jsx("input",{type:"text",value:j.maDonVi,onChange:I=>T({...j,maDonVi:I.target.value.toUpperCase()}),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"TO_A"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn"}),t.jsx("input",{type:"text",value:j.tenDonVi,onChange:I=>T({...j,tenDonVi:I.target.value}),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"T A"})]}),t.jsxs("div",{className:"w-32",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi"}),t.jsx("select",{value:j.loaiDonVi,onChange:I=>T({...j,loaiDonVi:I.target.value}),className:"w-full px-3 py-2 border rounded-lg text-sm",children:Vb.map(I=>t.jsx("option",{value:I.value,children:I.label},I.value))})]}),t.jsx("button",{type:"submit",disabled:O.isPending,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:t.jsx(Dt,{size:18})})]}),E&&E.length>0?t.jsx("div",{className:"divide-y",children:E.map(I=>{var W;return t.jsxs("div",{className:"flex items-center justify-between py-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${I.loaiDonVi==="TO"?"bg-blue-100 text-blue-600":I.loaiDonVi==="NHOM"?"bg-green-100 text-green-600":"bg-orange-100 text-orange-600"}`,children:t.jsx(v0,{size:16})}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:I.tenDonVi}),t.jsxs("div",{className:"text-xs text-gray-500",children:[I.maDonVi,"  ",(W=Vb.find(z=>z.value===I.loaiDonVi))==null?void 0:W.label]})]})]}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${I.trangThai==="HOAT_DONG"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:I.trangThai==="HOAT_DONG"?"Hot ng":"Ngng"})]},I.id)})}):t.jsx("div",{className:"text-center py-8 text-gray-500",children:"Cha c n v con no"})]})})]})}const qh={LUONG_THANG_CO_DINH:{label:"C nh theo thng",desc:"Nhn  s tin mi thng, khng ph thuc ngy cng"},THEO_NGAY_CONG:{label:"Theo ngy cng",desc:"Tnh theo cng thc: S tin  (Ngy cng thc t / Ngy cng l thuyt)"},CHUYEN_CAN_DIEU_KIEN:{label:"Chuyn cn c iu kin",desc:"Nhn  nu ngh khng php  2 ngy, mt ht nu > 2 ngy"}};function AD(){var J;const[e,n]=D.useState("phucap"),a=Mt(),[r,s]=D.useState(!1),[l,o]=D.useState(null),[d,u]=D.useState(""),[x,m]=D.useState({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",cachTinh:"LUONG_THANG_CO_DINH",chiuThue:!1,moTa:"",thuTu:0}),{data:f,isLoading:p}=Le({queryKey:["khoan-luong"],queryFn:()=>pr.layTatCa()}),N=(f==null?void 0:f.filter(B=>d===""||B.loai===d))||[],y=De({mutationFn:pr.taoMoi,onSuccess:()=>{a.invalidateQueries({queryKey:["khoan-luong"]}),ie.success("To ph cp thnh cng!"),j()},onError:B=>{var ue,te;ie.error(((te=(ue=B.response)==null?void 0:ue.data)==null?void 0:te.message)||"C li xy ra")}}),g=De({mutationFn:({id:B,data:ue})=>pr.capNhat(B,ue),onSuccess:()=>{a.invalidateQueries({queryKey:["khoan-luong"]}),ie.success("Cp nht ph cp thnh cng!"),j()},onError:B=>{var ue,te;ie.error(((te=(ue=B.response)==null?void 0:ue.data)==null?void 0:te.message)||"C li xy ra")}}),b=De({mutationFn:pr.xoa,onSuccess:()=>{a.invalidateQueries({queryKey:["khoan-luong"]}),ie.success("Xa ph cp thnh cng!")},onError:B=>{var ue,te;ie.error(((te=(ue=B.response)==null?void 0:ue.data)==null?void 0:te.message)||"C li xy ra")}}),j=()=>{s(!1),o(null),m({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",cachTinh:"LUONG_THANG_CO_DINH",chiuThue:!1,moTa:"",thuTu:0})},T=B=>{o(B),m({maKhoan:B.maKhoan,tenKhoan:B.tenKhoan,loai:B.loai,cachTinh:B.cachTinh||"LUONG_THANG_CO_DINH",chiuThue:B.chiuThue,moTa:B.moTa||"",thuTu:B.thuTu}),s(!0)},S=()=>{if(!x.maKhoan||!x.tenKhoan){ie.error("Vui lng in m v tn ph cp");return}l?g.mutate({id:l.id,data:x}):y.mutate(x)},w=B=>{confirm(`Bn c chc mun xa ph cp "${B.tenKhoan}"?`)&&b.mutate(B.id)},[_,E]=D.useState({nam:new Date().getFullYear(),tyLeBHXH_NV:8,tyLeBHYT_NV:1.5,tyLeBHTN_NV:1,tyLeBHXH_DN:17.5,tyLeBHYT_DN:3,tyLeBHTN_DN:1,tyLeBHXH_KPCCD_NV:.5,tyLeBHXH_KPCCD_DN:1,mucLuongCoSo:18e5,mucLuongToiThieu:496e4}),{data:C,isLoading:P}=Le({queryKey:["thong-tin-cong-ty"],queryFn:Db.lay}),[F,R]=D.useState({tenCongTy:"",maSoThue:"",diaChi:"",dienThoai:"",email:"",website:"",nguoiDaiDien:"",chucVuDaiDien:""});D.useEffect(()=>{C&&R(C)},[C]);const O=De({mutationFn:Db.capNhat,onSuccess:()=>{a.invalidateQueries({queryKey:["thong-tin-cong-ty"]}),ie.success("Cp nht thng tin cng ty thnh cng!")},onError:()=>{ie.error("C li khi cp nht thng tin cng ty")}}),M=async B=>{B.preventDefault(),ie.success("Lu cu hnh BHXH/Thu thnh cng!")},q=async B=>{B.preventDefault(),await O.mutateAsync(F)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(ts,{className:"w-8 h-8 text-blue-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Ci t h thng"}),t.jsx("p",{className:"text-gray-600",children:"Qun l cu hnh BHXH, thu v thng tin cng ty"})]})]}),t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"border-b",children:t.jsxs("div",{className:"flex gap-4",children:[t.jsx("button",{onClick:()=>n("phucap"),className:`px-4 py-3 font-medium border-b-2 transition-colors ${e==="phucap"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(E_,{className:"w-4 h-4"}),"Ph cp & Khon lng"]})}),t.jsx("button",{onClick:()=>n("bhxh"),className:`px-4 py-3 font-medium border-b-2 transition-colors ${e==="bhxh"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ma,{className:"w-4 h-4"}),"BHXH / Thu"]})}),t.jsx("button",{onClick:()=>n("congty"),className:`px-4 py-3 font-medium border-b-2 transition-colors ${e==="congty"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Mr,{className:"w-4 h-4"}),"Thng tin cng ty"]})})]})}),t.jsxs("div",{className:"p-6",children:[e==="phucap"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Danh sch Ph cp & Khon lng"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Cu hnh cc khon ph cp, thu nhp, khu tr p dng cho nhn vin"})]}),t.jsxs("button",{onClick:()=>s(!0),className:"btn btn-primary",children:[t.jsx(Dt,{size:18}),"Thm mi"]})]}),t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsxs("select",{value:d,onChange:B=>u(B.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c loi"}),t.jsx("option",{value:"THU_NHAP",children:"Thu nhp"}),t.jsx("option",{value:"KHAU_TRU",children:"Khu tr"})]}),t.jsxs("span",{className:"text-sm text-gray-500",children:["Tng: ",N.length," khon"]})]}),p?t.jsx("div",{className:"text-center py-8",children:t.jsx(Rn,{className:"w-8 h-8 animate-spin mx-auto text-blue-600"})}):t.jsx("div",{className:"overflow-x-auto border rounded-lg",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"M"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Tn khon"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Loi"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Cch tnh"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Chu thu"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Th t"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Thao tc"})]})}),t.jsx("tbody",{children:N.map(B=>{var ue;return t.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4 font-mono text-sm",children:B.maKhoan}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:B.tenKhoan}),B.moTa&&t.jsx("div",{className:"text-xs text-gray-500",children:B.moTa})]})}),t.jsx("td",{className:"py-3 px-4",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${B.loai==="THU_NHAP"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:B.loai==="THU_NHAP"?"Thu nhp":"Khu tr"})}),t.jsx("td",{className:"py-3 px-4",children:t.jsx("span",{className:"text-sm",children:((ue=qh[B.cachTinh])==null?void 0:ue.label)||B.cachTinh})}),t.jsx("td",{className:"py-3 px-4 text-center",children:B.chiuThue?t.jsx("span",{className:"text-green-600",children:""}):t.jsx("span",{className:"text-gray-400",children:"-"})}),t.jsx("td",{className:"py-3 px-4 text-center text-gray-500",children:B.thuTu}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>T(B),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Sa",children:t.jsx(Za,{size:16})}),t.jsx("button",{onClick:()=>w(B),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Xa",children:t.jsx(er,{size:16})})]})})]},B.id)})})]})}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Hng dn cch tnh lng"}),t.jsx("div",{className:"space-y-2 text-sm text-blue-800",children:Object.entries(qh).map(([B,ue])=>t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("span",{className:"font-medium min-w-[180px]",children:[ue.label,":"]}),t.jsx("span",{children:ue.desc})]},B))})]})]}),e==="bhxh"&&t.jsxs("form",{onSubmit:M,className:"space-y-6 max-w-3xl",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Cu hnh BHXH/BHYT/BHTN"}),t.jsx("div",{className:"grid grid-cols-2 gap-4 mb-6",children:t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Nm p dng"})}),t.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.nam,onChange:B=>E({..._,nam:Number(B.target.value)})})]})}),t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:[t.jsx("h4",{className:"font-semibold text-blue-900 mb-3",children:"T l ng Nhn vin (%)"}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHXH"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.tyLeBHXH_NV,onChange:B=>E({..._,tyLeBHXH_NV:Number(B.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHYT"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.tyLeBHYT_NV,onChange:B=>E({..._,tyLeBHYT_NV:Number(B.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHTN"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.tyLeBHTN_NV,onChange:B=>E({..._,tyLeBHTN_NV:Number(B.target.value)})})]})]})]}),t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg mb-4",children:[t.jsx("h4",{className:"font-semibold text-green-900 mb-3",children:"T l ng Doanh nghip (%)"}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHXH"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.tyLeBHXH_DN,onChange:B=>E({..._,tyLeBHXH_DN:Number(B.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHYT"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.tyLeBHYT_DN,onChange:B=>E({..._,tyLeBHYT_DN:Number(B.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHTN"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.tyLeBHTN_DN,onChange:B=>E({..._,tyLeBHTN_DN:Number(B.target.value)})})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Mc lng c s (VN)"})}),t.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.mucLuongCoSo,onChange:B=>E({..._,mucLuongCoSo:Number(B.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Mc lng ti thiu vng (VN)"})}),t.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.mucLuongToiThieu,onChange:B=>E({..._,mucLuongToiThieu:Number(B.target.value)})})]})]}),t.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 p-4 rounded-lg text-sm text-yellow-800",children:[t.jsx("strong",{children:"Lu :"})," Cc t l ny s c p dng cho tt c nhn vin khi tnh lng. Vui lng kim tra k trc khi lu."]})]}),t.jsx("div",{className:"flex justify-end gap-2",children:t.jsxs("button",{type:"submit",className:"btn btn-primary",children:[t.jsx(Es,{className:"w-4 h-4"}),"Lu cu hnh"]})})]}),e==="congty"&&t.jsx("form",{onSubmit:q,className:"space-y-6 max-w-3xl",children:P?t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx(Rn,{className:"w-8 h-8 animate-spin text-blue-600"})}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thng tin cng ty"}),t.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Tn cng ty *"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:F.tenCongTy||"",onChange:B=>R({...F,tenCongTy:B.target.value}),required:!0})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"M s thu"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:F.maSoThue||"",onChange:B=>R({...F,maSoThue:B.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"in thoi"})}),t.jsx("input",{type:"tel",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:F.dienThoai||"",onChange:B=>R({...F,dienThoai:B.target.value})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"a ch"})}),t.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",rows:2,value:F.diaChi||"",onChange:B=>R({...F,diaChi:B.target.value})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Email"})}),t.jsx("input",{type:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:F.email||"",onChange:B=>R({...F,email:B.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Website"})}),t.jsx("input",{type:"url",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:F.website||"",onChange:B=>R({...F,website:B.target.value})})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Ngi i din"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:F.nguoiDaiDien||"",onChange:B=>R({...F,nguoiDaiDien:B.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Chc v ngi i din"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:F.chucVuDaiDien||"",onChange:B=>R({...F,chucVuDaiDien:B.target.value})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Logo (URL)"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:F.logo||"",onChange:B=>R({...F,logo:B.target.value}),placeholder:"https://example.com/logo.png"}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Nhp URL ca logo cng ty (hin th trn phiu lng)"})]})]}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg text-sm text-blue-800 mt-4",children:[t.jsx("strong",{children:"Lu :"})," Thng tin ny s c hin th trn cc phiu lng khi xut."]})]}),t.jsx("div",{className:"flex justify-end gap-2",children:t.jsx("button",{type:"submit",className:"btn btn-primary",disabled:O.isPending,children:O.isPending?t.jsxs(t.Fragment,{children:[t.jsx(Rn,{className:"w-4 h-4 animate-spin"}),"ang lu..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Es,{className:"w-4 h-4"}),"Lu thng tin"]})})})]})})]})]}),r&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:l?"Sa khon ph cp":"Thm khon ph cp mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M khon *"}),t.jsx("input",{type:"text",value:x.maKhoan,onChange:B=>m({...x,maKhoan:B.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: PHU_CAP_AN_TRUA",disabled:!!l})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Th t hin th"}),t.jsx("input",{type:"number",value:x.thuTu,onChange:B=>m({...x,thuTu:Number(B.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tn khon *"}),t.jsx("input",{type:"text",value:x.tenKhoan,onChange:B=>m({...x,tenKhoan:B.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ph cp n tra"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi khon"}),t.jsxs("select",{value:x.loai,onChange:B=>m({...x,loai:B.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"THU_NHAP",children:"Thu nhp (cng vo lng)"}),t.jsx("option",{value:"KHAU_TRU",children:"Khu tr (tr khi lng)"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chu thu TNCN"}),t.jsxs("select",{value:x.chiuThue?"true":"false",onChange:B=>m({...x,chiuThue:B.target.value==="true"}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"false",children:"Khng chu thu"}),t.jsx("option",{value:"true",children:"C chu thu"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Cch tnh lng"}),t.jsx("select",{value:x.cachTinh,onChange:B=>m({...x,cachTinh:B.target.value}),className:"w-full border rounded-lg px-3 py-2",children:Object.entries(qh).map(([B,ue])=>t.jsx("option",{value:B,children:ue.label},B))}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:(J=qh[x.cachTinh])==null?void 0:J.desc})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M t"}),t.jsx("textarea",{value:x.moTa,onChange:B=>m({...x,moTa:B.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2,placeholder:"Ghi ch v khon ph cp ny..."})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:j,className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:S,disabled:y.isPending||g.isPending,className:"btn btn-primary",children:y.isPending||g.isPending?"ang lu...":"Lu"})]})]})})]})}function FD(){const e=Mt(),[n,a]=D.useState(!1),[r,s]=D.useState(null),[l,o]=D.useState({maNhom:"",tenNhom:"",moTa:"",mauSac:"#3B82F6",trangThai:!0}),{data:d,isLoading:u}=Le({queryKey:["nhom-nhan-vien"],queryFn:uw}),x=De({mutationFn:fD,onSuccess:()=>{ie.success("To nhm thnh cng"),e.invalidateQueries({queryKey:["nhom-nhan-vien"]}),a(!1),p()},onError:g=>{var b,j;ie.error(((j=(b=g.response)==null?void 0:b.data)==null?void 0:j.message)||"Li to nhm")}}),m=De({mutationFn:({id:g,data:b})=>pD(g,b),onSuccess:()=>{ie.success("Cp nht nhm thnh cng"),e.invalidateQueries({queryKey:["nhom-nhan-vien"]}),s(null),a(!1),p()},onError:g=>{var b,j;ie.error(((j=(b=g.response)==null?void 0:b.data)==null?void 0:j.message)||"Li cp nht")}}),f=De({mutationFn:gD,onSuccess:()=>{ie.success(" xa nhm"),e.invalidateQueries({queryKey:["nhom-nhan-vien"]})},onError:g=>{var b,j;ie.error(((j=(b=g.response)==null?void 0:b.data)==null?void 0:j.message)||"Li xa nhm")}}),p=()=>{o({maNhom:"",tenNhom:"",moTa:"",mauSac:"#3B82F6",trangThai:!0})},N=g=>{o({maNhom:g.maNhom,tenNhom:g.tenNhom,moTa:g.moTa||"",mauSac:g.mauSac||"#3B82F6",trangThai:g.trangThai}),s(g.id),a(!0)},y=g=>{g.preventDefault(),r?m.mutate({id:r,data:l}):x.mutate(l)};return u?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Qun l Nhm Nhn vin"}),t.jsxs("button",{onClick:()=>{a(!0),s(null),p()},className:"btn btn-primary flex items-center gap-2",children:[t.jsx(Dt,{size:20}),"Thm nhm"]})]}),n&&t.jsxs("div",{className:"card mb-6 bg-blue-50 border border-blue-200",children:[t.jsx("h3",{className:"font-semibold mb-4",children:r?"Sa nhm":"To nhm mi"}),t.jsxs("form",{onSubmit:y,className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M nhm *"}),t.jsx("input",{type:"text",value:l.maNhom,onChange:g=>o({...l,maNhom:g.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: NHOM_KT, NHOM_HR...",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tn nhm *"}),t.jsx("input",{type:"text",value:l.tenNhom,onChange:g=>o({...l,tenNhom:g.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Nhm K ton, Nhm HR...",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M t"}),t.jsx("input",{type:"text",value:l.moTa,onChange:g=>o({...l,moTa:g.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"M t ngn v nhm..."})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Mu sc"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"color",value:l.mauSac,onChange:g=>o({...l,mauSac:g.target.value}),className:"w-10 h-10 rounded cursor-pointer"}),t.jsx("span",{className:"text-sm text-gray-500",children:l.mauSac})]})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Trng thi"}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:l.trangThai,onChange:g=>o({...l,trangThai:g.target.checked}),className:"w-4 h-4 rounded"}),t.jsx("span",{className:"text-sm",children:"ang hot ng"})]})]})]}),t.jsxs("div",{className:"col-span-2 flex gap-2",children:[t.jsx("button",{type:"submit",disabled:x.isPending||m.isPending,className:"btn btn-primary",children:r?"Cp nht":"To mi"}),t.jsx("button",{type:"button",onClick:()=>{a(!1),s(null)},className:"btn btn-secondary",children:"Hy"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[d==null?void 0:d.map(g=>{var b;return t.jsxs("div",{className:`card ${g.trangThai?"":"opacity-60"}`,style:{borderLeftWidth:"4px",borderLeftColor:g.mauSac||"#6B7280"},children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center text-white font-bold text-lg",style:{backgroundColor:g.mauSac||"#6B7280"},children:g.tenNhom.charAt(0).toUpperCase()}),t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold",children:g.tenNhom}),t.jsx("div",{className:"text-xs text-gray-500",children:g.maNhom})]})]}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{onClick:()=>N(g),className:"p-1.5 hover:bg-blue-100 rounded text-blue-600",title:"Sa",children:t.jsx(Za,{size:16})}),t.jsx("button",{onClick:()=>{confirm(`Xc nhn xa nhm "${g.tenNhom}"?`)&&f.mutate(g.id)},className:"p-1.5 hover:bg-red-100 rounded text-red-600",title:"Xa",children:t.jsx(er,{size:16})})]})]}),g.moTa&&t.jsx("div",{className:"text-sm text-gray-600 mt-2",children:g.moTa}),t.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t",children:[t.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[t.jsx(on,{size:16}),t.jsxs("span",{children:[((b=g._count)==null?void 0:b.thanhViens)||0," thnh vin"]})]}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${g.trangThai?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:g.trangThai?"Hot ng":"Tm dng"})]})]},g.id)}),(d==null?void 0:d.length)===0&&t.jsxs("div",{className:"col-span-3 text-center py-12 text-gray-500 bg-gray-50 rounded-lg",children:[t.jsx(on,{size:48,className:"mx-auto mb-4 text-gray-300"}),t.jsx("p",{children:"Cha c nhm no"}),t.jsxs("button",{onClick:()=>{a(!0),s(null),p()},className:"btn btn-primary mt-4",children:[t.jsx(Dt,{size:20}),"To nhm u tin"]})]})]}),t.jsxs("div",{className:"mt-6 bg-blue-50 p-4 rounded-lg text-sm text-blue-800",children:[t.jsx("strong",{children:" Hng dn:"})," Nhm nhn vin c s dng trong Rule Engine  p dng cc quy tc tnh lng khc nhau cho tng nhm. V d: nhm Qun l c ph cp chc v, nhm K thut c ph cp c hi..."]})]})}function LD(){const e=br(),{dangNhap:n,isAuthenticated:a}=is(),[r,s]=D.useState(""),[l,o]=D.useState(""),[d,u]=D.useState(!1),[x,m]=D.useState("");if(a)return e("/",{replace:!0}),null;const f=async p=>{var N,y;if(p.preventDefault(),m(""),!r||!l){m("Vui lng nhp tn ng nhp v mt khu");return}u(!0);try{await n(r,l),e("/",{replace:!0})}catch(g){m(((y=(N=g.response)==null?void 0:N.data)==null?void 0:y.message)||"ng nhp tht bi")}finally{u(!1)}};return t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:t.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg p-8",children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-blue-100 mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"HRM - Qun l NS & Tnh lng"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"ng nhp  tip tc"})]}),x&&t.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:x}),t.jsxs("form",{onSubmit:f,className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"tenDangNhap",className:"block text-sm font-medium text-gray-700 mb-2",children:"Tn ng nhp"}),t.jsx("input",{type:"text",id:"tenDangNhap",value:r,onChange:p=>s(p.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition",placeholder:"Nhp tn ng nhp",autoComplete:"username"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"matKhau",className:"block text-sm font-medium text-gray-700 mb-2",children:"Mt khu"}),t.jsx("input",{type:"password",id:"matKhau",value:l,onChange:p=>o(p.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition",placeholder:"Nhp mt khu",autoComplete:"current-password"})]}),t.jsx("button",{type:"submit",disabled:d,className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium rounded-lg transition flex items-center justify-center",children:d?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"ang ng nhp..."]}):"ng nhp"})]}),t.jsx("div",{className:"mt-6 text-center",children:t.jsxs("p",{className:"text-sm text-gray-500",children:["Ti khon mc nh: ",t.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:"admin"})," / ",t.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:"admin123"})]})})]})})}const PD="tinh_luong_auth",Ya=Zt.create({baseURL:"/api/kpi",headers:{"Content-Type":"application/json"}});Ya.interceptors.request.use(e=>{const n=localStorage.getItem(PD);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const Jo={layTatCa:e=>Ya.get("/template",{params:e}).then(n=>n.data),layTheoId:e=>Ya.get(`/template/${e}`).then(n=>n.data),taoMoi:e=>Ya.post("/template",e).then(n=>n.data),capNhat:(e,n)=>Ya.put(`/template/${e}`,n).then(a=>a.data),themChiTieu:(e,n)=>Ya.post(`/template/${e}/chi-tieu`,n).then(a=>a.data),xoaChiTieu:e=>Ya.delete(`/chi-tieu/${e}`).then(n=>n.data)},pf={layTatCa:e=>Ya.get("/ky-danh-gia",{params:e}).then(n=>n.data),layTheoId:e=>Ya.get(`/ky-danh-gia/${e}`).then(n=>n.data),taoMoi:e=>Ya.post("/ky-danh-gia",e).then(n=>n.data),capNhatTrangThai:(e,n)=>Ya.put(`/ky-danh-gia/${e}/trang-thai`,{trangThai:n}).then(a=>a.data)},gf={layTheoNam:e=>Ya.get(`/cau-hinh-thuong/${e}`).then(n=>n.data),taoMoi:e=>Ya.post("/cau-hinh-thuong",e).then(n=>n.data),khoiTaoMacDinh:e=>Ya.post(`/cau-hinh-thuong/khoi-tao/${e}`).then(n=>n.data)};function ID(){var _,E;const[e,n]=D.useState([]),[a,r]=D.useState([]),[s,l]=D.useState(null),[o,d]=D.useState(!0),[u,x]=D.useState(!1),[m,f]=D.useState(!1),[p,N]=D.useState({maTemplate:"",tenTemplate:"",phongBanId:"",moTa:""}),[y,g]=D.useState({maChiTieu:"",tenChiTieu:"",donViTinh:"",trongSo:0,loaiChiTieu:"SO",chiTieuToiThieu:0,chiTieuMucTieu:0,chiTieuVuotMuc:0});D.useEffect(()=>{b()},[]);const b=async()=>{try{const[C,P]=await Promise.all([Jo.layTatCa(),Jt.layTatCa()]);n(C),r(P)}catch(C){console.error("Li ti d liu:",C)}finally{d(!1)}},j=async C=>{C.preventDefault();try{await Jo.taoMoi({maTemplate:p.maTemplate,tenTemplate:p.tenTemplate,phongBanId:p.phongBanId?parseInt(p.phongBanId):void 0,moTa:p.moTa||void 0}),x(!1),N({maTemplate:"",tenTemplate:"",phongBanId:"",moTa:""}),b()}catch(P){console.error("Li to template:",P)}},T=async C=>{var P;if(C.preventDefault(),!!s)try{await Jo.themChiTieu(s.id,{...y,thuTu:(((P=s.chiTieuKPIs)==null?void 0:P.length)||0)+1}),f(!1),g({maChiTieu:"",tenChiTieu:"",donViTinh:"",trongSo:0,loaiChiTieu:"SO",chiTieuToiThieu:0,chiTieuMucTieu:0,chiTieuVuotMuc:0}),b();const F=await Jo.layTheoId(s.id);l(F)}catch(F){console.error("Li thm ch tiu:",F)}},S=async C=>{if(confirm("Xc nhn xa ch tiu ny?"))try{if(await Jo.xoaChiTieu(C),b(),s){const P=await Jo.layTheoId(s.id);l(P)}}catch(P){console.error("Li xa ch tiu:",P)}},w=C=>(C==null?void 0:C.reduce((P,F)=>P+Number(F.trongSo),0))||0;return o?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Template KPI"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Thit lp cc ch tiu nh gi KPI"})]}),t.jsxs("button",{onClick:()=>x(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm Template"]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow",children:[t.jsx("div",{className:"p-4 border-b",children:t.jsx("h2",{className:"font-semibold text-gray-800",children:"Danh sch Template"})}),t.jsx("div",{className:"divide-y max-h-[600px] overflow-y-auto",children:e.length===0?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Cha c template no"}):e.map(C=>{var P;return t.jsx("div",{onClick:()=>l(C),className:`p-4 cursor-pointer hover:bg-gray-50 ${(s==null?void 0:s.id)===C.id?"bg-blue-50 border-l-4 border-blue-500":""}`,children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-900",children:C.tenTemplate}),t.jsx("p",{className:"text-sm text-gray-500",children:C.maTemplate}),C.phongBan&&t.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded",children:C.phongBan.tenPhongBan})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("span",{className:"text-sm text-gray-600",children:[((P=C.chiTieuKPIs)==null?void 0:P.length)||0," ch tiu"]}),t.jsxs("div",{className:`text-xs mt-1 ${w(C.chiTieuKPIs)===100?"text-green-600":"text-amber-600"}`,children:["Tng: ",w(C.chiTieuKPIs),"%"]})]})]})},C.id)})})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow",children:[t.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[t.jsx("h2",{className:"font-semibold text-gray-800",children:s?s.tenTemplate:"Chi tit Template"}),s&&t.jsxs("button",{onClick:()=>f(!0),className:"text-blue-600 hover:text-blue-700 text-sm flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm ch tiu"]})]}),s?t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[t.jsxs("p",{className:"text-sm",children:[t.jsx("span",{className:"font-medium",children:"M:"})," ",s.maTemplate]}),s.moTa&&t.jsxs("p",{className:"text-sm mt-1",children:[t.jsx("span",{className:"font-medium",children:"M t:"})," ",s.moTa]}),t.jsxs("p",{className:`text-sm mt-1 ${w(s.chiTieuKPIs)===100?"text-green-600":"text-amber-600"}`,children:[t.jsx("span",{className:"font-medium",children:"Tng trng s:"})," ",w(s.chiTieuKPIs),"%",w(s.chiTieuKPIs)!==100&&" (cn = 100%)"]})]}),t.jsx("div",{className:"space-y-3",children:((_=s.chiTieuKPIs)==null?void 0:_.length)===0?t.jsx("p",{className:"text-gray-500 text-center py-4",children:"Cha c ch tiu"}):(E=s.chiTieuKPIs)==null?void 0:E.map(C=>t.jsxs("div",{className:"border rounded-lg p-3",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900",children:C.tenChiTieu}),t.jsx("p",{className:"text-sm text-gray-500",children:C.maChiTieu})]}),t.jsx("button",{onClick:()=>S(C.id),className:"text-red-500 hover:text-red-700",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),t.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Trng s:"})," ",C.trongSo,"%"]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"n v:"})," ",C.donViTinh]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Loi:"})," ",C.loaiChiTieu]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Mc tiu:"})," ",Number(C.chiTieuMucTieu).toLocaleString()]})]})]},C.id))})]}):t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Chn mt template  xem chi tit"})]})]}),u&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm Template KPI"}),t.jsxs("form",{onSubmit:j,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M template *"}),t.jsx("input",{type:"text",value:p.maTemplate,onChange:C=>N({...p,maTemplate:C.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn template *"}),t.jsx("input",{type:"text",value:p.tenTemplate,onChange:C=>N({...p,tenTemplate:C.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:p.phongBanId,onChange:C=>N({...p,phongBanId:C.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- p dng chung --"}),a.map(C=>t.jsx("option",{value:C.id,children:C.tenPhongBan},C.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:p.moTa,onChange:C=>N({...p,moTa:C.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To"})]})]})]})}),m&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm Ch tiu KPI"}),t.jsxs("form",{onSubmit:T,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M ch tiu *"}),t.jsx("input",{type:"text",value:y.maChiTieu,onChange:C=>g({...y,maChiTieu:C.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn ch tiu *"}),t.jsx("input",{type:"text",value:y.tenChiTieu,onChange:C=>g({...y,tenChiTieu:C.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n v *"}),t.jsx("input",{type:"text",value:y.donViTinh,onChange:C=>g({...y,donViTinh:C.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VN, %, S...",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng s (%) *"}),t.jsx("input",{type:"number",value:y.trongSo,onChange:C=>g({...y,trongSo:Number(C.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0,max:100,required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi *"}),t.jsxs("select",{value:y.loaiChiTieu,onChange:C=>g({...y,loaiChiTieu:C.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[t.jsx("option",{value:"SO",children:"S lng"}),t.jsx("option",{value:"PHAN_TRAM",children:"Phn trm"}),t.jsx("option",{value:"TIEN",children:"Tin"}),t.jsx("option",{value:"DANH_GIA",children:"nh gi (1-5)"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ti thiu"}),t.jsx("input",{type:"number",value:y.chiTieuToiThieu,onChange:C=>g({...y,chiTieuToiThieu:Number(C.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mc tiu"}),t.jsx("input",{type:"number",value:y.chiTieuMucTieu,onChange:C=>g({...y,chiTieuMucTieu:Number(C.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vt mc"}),t.jsx("input",{type:"number",value:y.chiTieuVuotMuc,onChange:C=>g({...y,chiTieuVuotMuc:Number(C.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Thm"})]})]})]})})]})}const OD={THANG:"Thng",QUY:"Qu",NAM:"Nm"},Ub={CHUA_BAT_DAU:{label:"Cha bt u",color:"bg-gray-100 text-gray-600"},DANG_DIEN_RA:{label:"ang din ra",color:"bg-green-100 text-green-700"},DA_KET_THUC:{label:" kt thc",color:"bg-blue-100 text-blue-700"},DA_DONG:{label:" ng",color:"bg-red-100 text-red-700"}};function MD(){const[e,n]=D.useState([]),[a,r]=D.useState(!0),[s,l]=D.useState(!1),[o,d]=D.useState(new Date().getFullYear()),[u,x]=D.useState({maKy:"",tenKy:"",loaiKy:"THANG",tuNgay:"",denNgay:"",moTa:""});D.useEffect(()=>{m()},[o]);const m=async()=>{r(!0);try{const y=await pf.layTatCa({nam:o});n(y)}catch(y){console.error("Li ti d liu:",y)}finally{r(!1)}},f=async y=>{y.preventDefault();try{await pf.taoMoi({...u,moTa:u.moTa||void 0}),l(!1),x({maKy:"",tenKy:"",loaiKy:"THANG",tuNgay:"",denNgay:"",moTa:""}),m()}catch(g){console.error("Li to k nh gi:",g)}},p=async(y,g)=>{try{await pf.capNhatTrangThai(y,g),m()}catch(b){console.error("Li cp nht trng thi:",b)}},N=y=>new Date(y).toLocaleDateString("vi-VN");return a?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"K nh Gi KPI"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Qun l cc k nh gi hiu sut"})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx("select",{value:o,onChange:y=>d(Number(y.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(y=>t.jsxs("option",{value:y,children:["Nm ",y]},y))}),t.jsxs("button",{onClick:()=>l(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm K nh Gi"]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M k"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tn k"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Loi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"S nh gi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.length===0?t.jsx("tr",{children:t.jsxs("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:["Cha c k nh gi no trong nm ",o]})}):e.map(y=>{var g;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"font-mono text-sm text-gray-900",children:y.maKy})}),t.jsxs("td",{className:"px-6 py-4",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:y.tenKy}),y.moTa&&t.jsx("div",{className:"text-xs text-gray-500",children:y.moTa})]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded",children:OD[y.loaiKy]})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:[N(y.tuNgay)," - ",N(y.denNgay)]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 py-1 text-xs rounded ${Ub[y.trangThai].color}`,children:Ub[y.trangThai].label})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:((g=y._count)==null?void 0:g.danhGias)||0}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:t.jsxs("div",{className:"flex gap-2",children:[y.trangThai==="CHUA_BAT_DAU"&&t.jsx("button",{onClick:()=>p(y.id,"DANG_DIEN_RA"),className:"text-green-600 hover:text-green-800",children:"Bt u"}),y.trangThai==="DANG_DIEN_RA"&&t.jsx("button",{onClick:()=>p(y.id,"DA_KET_THUC"),className:"text-blue-600 hover:text-blue-800",children:"Kt thc"}),y.trangThai==="DA_KET_THUC"&&t.jsx("button",{onClick:()=>p(y.id,"DA_DONG"),className:"text-red-600 hover:text-red-800",children:"ng"}),t.jsx("a",{href:`/kpi/ky-danh-gia/${y.id}`,className:"text-indigo-600 hover:text-indigo-800",children:"Chi tit"})]})})]},y.id)})})]})}),s&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm K nh Gi"}),t.jsxs("form",{onSubmit:f,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M k *"}),t.jsx("input",{type:"text",value:u.maKy,onChange:y=>x({...u,maKy:y.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: KPI-2026-Q1",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi k *"}),t.jsxs("select",{value:u.loaiKy,onChange:y=>x({...u,loaiKy:y.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[t.jsx("option",{value:"THANG",children:"Thng"}),t.jsx("option",{value:"QUY",children:"Qu"}),t.jsx("option",{value:"NAM",children:"Nm"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn k *"}),t.jsx("input",{type:"text",value:u.tenKy,onChange:y=>x({...u,tenKy:y.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: nh gi KPI Qu 1/2026",required:!0})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T ngy *"}),t.jsx(Ut,{value:u.tuNgay,onChange:y=>x({...u,tuNgay:y}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n ngy *"}),t.jsx(Ut,{value:u.denNgay,onChange:y=>x({...u,denNgay:y}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:u.moTa,onChange:y=>x({...u,moTa:y.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To"})]})]})]})})]})}const yf={XUAT_SAC:{label:"Xut sc",color:"bg-purple-100 text-purple-700"},TOT:{label:"Tt",color:"bg-green-100 text-green-700"},KHA:{label:"Kh",color:"bg-blue-100 text-blue-700"},TRUNG_BINH:{label:"Trung bnh",color:"bg-yellow-100 text-yellow-700"},YEU:{label:"Yu",color:"bg-red-100 text-red-700"}};function RD(){const[e,n]=D.useState([]),[a,r]=D.useState(!0),[s,l]=D.useState(new Date().getFullYear()),[o,d]=D.useState(!1),[u,x]=D.useState({xepLoai:"TOT",diemToiThieu:0,diemToiDa:100,heSoThuong:1,moTa:""});D.useEffect(()=>{m()},[s]);const m=async()=>{r(!0);try{const N=await gf.layTheoNam(s);n(N)}catch(N){console.error("Li ti d liu:",N)}finally{r(!1)}},f=async()=>{if(confirm(`Khi to cu hnh thng mc nh cho nm ${s}?`))try{await gf.khoiTaoMacDinh(s),m()}catch(N){console.error("Li khi to:",N)}},p=async N=>{N.preventDefault();try{await gf.taoMoi({nam:s,...u,moTa:u.moTa||void 0}),d(!1),m()}catch(y){console.error("Li to cu hnh:",y)}};return a?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Cu hnh Thng KPI"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Thit lp h s thng theo mc xp loi"})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx("select",{value:s,onChange:N=>l(Number(N.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(N=>t.jsxs("option",{value:N,children:["Nm ",N]},N))}),t.jsx("button",{onClick:f,className:"border border-blue-600 text-blue-600 hover:bg-blue-50 px-4 py-2 rounded-lg",children:"Khi to mc nh"}),t.jsxs("button",{onClick:()=>d(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm Cu hnh"]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Xp loi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"im ti thiu"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"im ti a"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"H s thng"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M t"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Trng thi"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.length===0?t.jsx("tr",{children:t.jsxs("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:[t.jsxs("p",{children:["Cha c cu hnh thng cho nm ",s]}),t.jsx("button",{onClick:f,className:"mt-4 text-blue-600 hover:text-blue-700 underline",children:"Khi to cu hnh mc nh"})]})}):e.map(N=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-3 py-1 text-sm rounded-full font-medium ${yf[N.xepLoai].color}`,children:yf[N.xepLoai].label})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("span",{className:"text-gray-900 font-mono",children:[Number(N.diemToiThieu).toFixed(1),"%"]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("span",{className:"text-gray-900 font-mono",children:[Number(N.diemToiDa).toFixed(2),"%"]})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[t.jsxs("span",{className:"text-lg font-semibold text-indigo-600",children:[Number(N.heSoThuong),"x"]}),t.jsx("span",{className:"text-gray-500 text-sm ml-1",children:"lng c bn"})]}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("span",{className:"text-gray-600 text-sm",children:N.moTa||"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 py-1 text-xs rounded ${N.trangThai?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:N.trangThai?"Hot ng":"Ngng"})})]},N.id))})]})}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[t.jsx("h3",{className:"font-semibold text-blue-800 mb-3",children:" Cng thc tnh thng KPI"}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-blue-700",children:[t.jsxs("div",{children:[t.jsx("p",{children:t.jsx("strong",{children:"Tin thng = Lng c bn  H s thng"})}),t.jsx("p",{className:"mt-2",children:'V d: Nhn vin lng 15,000,000, xp loi "Tt" (h s 1.5x)'}),t.jsxs("p",{children:[" Thng = 15,000,000  1.5 = ",t.jsx("strong",{children:"22,500,000"})]})]}),t.jsxs("div",{children:[t.jsx("p",{children:t.jsx("strong",{children:"im KPI c tnh t:"})}),t.jsxs("ul",{className:"list-disc ml-4 mt-2",children:[t.jsx("li",{children:"Tng im =  (im ch tiu  Trng s)"}),t.jsx("li",{children:"im ch tiu = (Kt qu / Mc tiu)  100"}),t.jsx("li",{children:"Ti a 150% nu vt mc"})]})]})]})]}),o&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm Cu hnh Thng"}),t.jsxs("form",{onSubmit:p,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Xp loi *"}),t.jsx("select",{value:u.xepLoai,onChange:N=>x({...u,xepLoai:N.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:Object.entries(yf).map(([N,{label:y}])=>t.jsx("option",{value:N,children:y},N))})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"im ti thiu *"}),t.jsx("input",{type:"number",step:"0.01",value:u.diemToiThieu,onChange:N=>x({...u,diemToiThieu:Number(N.target.value)}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"im ti a *"}),t.jsx("input",{type:"number",step:"0.01",value:u.diemToiDa,onChange:N=>x({...u,diemToiDa:Number(N.target.value)}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"H s thng *"}),t.jsx("input",{type:"number",step:"0.1",value:u.heSoThuong,onChange:N=>x({...u,heSoThuong:Number(N.target.value)}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("input",{type:"text",value:u.moTa,onChange:N=>x({...u,moTa:N.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To"})]})]})]})})]})}const Kb={HOAT_DONG:{label:"Hot ng",color:"bg-green-100 text-green-700"},TAM_KHOA:{label:"Tm kha",color:"bg-yellow-100 text-yellow-700"},NGUNG_HOAT_DONG:{label:"Ngng",color:"bg-red-100 text-red-700"}};function BD(){const[e,n]=D.useState([]),[a,r]=D.useState([]),[s,l]=D.useState(!0),[o,d]=D.useState(!1),[u,x]=D.useState("nguoi-dung"),[m,f]=D.useState({tenDangNhap:"",matKhau:"",hoTen:"",email:"",soDienThoai:"",vaiTroIds:[]}),[p,N]=D.useState({maVaiTro:"",tenVaiTro:"",moTa:"",capDo:50});D.useEffect(()=>{y()},[]);const y=async()=>{try{const[w,_]=await Promise.all([uf.layTatCa(),_b.layTatCa()]);n(w),r(_)}catch(w){console.error("Li ti d liu:",w)}finally{l(!1)}},g=async w=>{w.preventDefault();try{await uf.taoMoi({tenDangNhap:m.tenDangNhap,matKhau:m.matKhau,hoTen:m.hoTen,email:m.email,soDienThoai:m.soDienThoai||void 0,vaiTroIds:m.vaiTroIds}),d(!1),f({tenDangNhap:"",matKhau:"",hoTen:"",email:"",soDienThoai:"",vaiTroIds:[]}),y()}catch(_){console.error("Li to ngi dng:",_)}},b=async w=>{w.preventDefault();try{await _b.taoMoi({maVaiTro:p.maVaiTro,tenVaiTro:p.tenVaiTro,moTa:p.moTa||void 0,capDo:p.capDo}),d(!1),N({maVaiTro:"",tenVaiTro:"",moTa:"",capDo:50}),y()}catch(_){console.error("Li to vai tr:",_)}},j=async(w,_)=>{try{await uf.capNhat(w,{trangThai:_}),y()}catch(E){console.error("Li cp nht:",E)}},T=w=>{f(_=>({..._,vaiTroIds:_.vaiTroIds.includes(w)?_.vaiTroIds.filter(E=>E!==w):[..._.vaiTroIds,w]}))},S=w=>w?new Date(w).toLocaleString("vi-VN"):"-";return s?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Ngi dng & Vai tr"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Phn quyn truy cp h thng"})]}),t.jsxs("button",{onClick:()=>d(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),u==="nguoi-dung"?"Thm Ngi dng":"Thm Vai tr"]})]}),t.jsx("div",{className:"border-b border-gray-200",children:t.jsxs("nav",{className:"-mb-px flex gap-6",children:[t.jsxs("button",{onClick:()=>x("nguoi-dung"),className:`py-3 px-1 border-b-2 font-medium text-sm ${u==="nguoi-dung"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Ngi dng (",e.length,")"]}),t.jsxs("button",{onClick:()=>x("vai-tro"),className:`py-3 px-1 border-b-2 font-medium text-sm ${u==="vai-tro"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Vai tr (",a.length,")"]})]})}),u==="nguoi-dung"?t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngi dng"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Vai tr"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ng nhp cui"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(w=>{var _,E,C;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:t.jsx("span",{className:"text-blue-600 font-medium",children:w.hoTen.charAt(0).toUpperCase()})}),t.jsxs("div",{className:"ml-3",children:[t.jsx("div",{className:"font-medium text-gray-900",children:w.hoTen}),t.jsxs("div",{className:"text-sm text-gray-500",children:["@",w.tenDangNhap]})]})]})}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:w.email}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("div",{className:"flex flex-wrap gap-1",children:((_=w.vaiTros)==null?void 0:_.map(P=>t.jsx("span",{className:"px-2 py-0.5 bg-indigo-100 text-indigo-700 text-xs rounded",children:P.vaiTro.tenVaiTro},P.id)))||t.jsx("span",{className:"text-gray-400 text-sm",children:"Cha gn"})})}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:S(w.lanDangNhapCuoi)}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("span",{className:`px-2 py-1 text-xs rounded ${((E=Kb[w.trangThai])==null?void 0:E.color)||"bg-gray-100"}`,children:((C=Kb[w.trangThai])==null?void 0:C.label)||w.trangThai})}),t.jsx("td",{className:"px-6 py-4 text-sm",children:t.jsxs("div",{className:"flex gap-2",children:[w.trangThai==="HOAT_DONG"&&t.jsx("button",{onClick:()=>j(w.id,"TAM_KHOA"),className:"text-yellow-600 hover:text-yellow-800",children:"Kha"}),w.trangThai==="TAM_KHOA"&&t.jsx("button",{onClick:()=>j(w.id,"HOAT_DONG"),className:"text-green-600 hover:text-green-800",children:"M kha"})]})})]},w.id)})})]})}):t.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map(w=>{var _,E,C,P,F;return t.jsxs("div",{className:"bg-white rounded-lg shadow p-5",children:[t.jsxs("div",{className:"flex justify-between items-start mb-3",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:w.tenVaiTro}),t.jsx("p",{className:"text-sm text-gray-500 font-mono",children:w.maVaiTro})]}),t.jsx("span",{className:`px-2 py-1 text-xs rounded ${w.trangThai?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:w.trangThai?"Hot ng":"Ngng"})]}),w.moTa&&t.jsx("p",{className:"text-sm text-gray-600 mb-3",children:w.moTa}),t.jsxs("div",{className:"flex justify-between items-center text-sm",children:[t.jsxs("span",{className:"text-gray-500",children:["Cp : ",w.capDo]}),t.jsxs("span",{className:"text-indigo-600",children:[((_=w._count)==null?void 0:_.nguoiDungs)||0," ngi dng"]})]}),t.jsxs("div",{className:"mt-3 pt-3 border-t",children:[t.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:["Quyn (",((E=w.quyens)==null?void 0:E.length)||0,"):"]}),t.jsxs("div",{className:"flex flex-wrap gap-1 max-h-20 overflow-y-auto",children:[(C=w.quyens)==null?void 0:C.slice(0,8).map(R=>t.jsx("span",{className:"px-1.5 py-0.5 bg-gray-100 text-gray-600 text-xs rounded",children:R.quyen.tenQuyen},R.id)),(((P=w.quyens)==null?void 0:P.length)||0)>8&&t.jsxs("span",{className:"px-1.5 py-0.5 bg-gray-200 text-gray-700 text-xs rounded",children:["+",(((F=w.quyens)==null?void 0:F.length)||0)-8," quyn"]})]})]})]},w.id)})}),o&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:u==="nguoi-dung"?"Thm Ngi dng":"Thm Vai tr"}),u==="nguoi-dung"?t.jsxs("form",{onSubmit:g,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn ng nhp *"}),t.jsx("input",{type:"text",value:m.tenDangNhap,onChange:w=>f({...m,tenDangNhap:w.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mt khu *"}),t.jsx("input",{type:"password",value:m.matKhau,onChange:w=>f({...m,matKhau:w.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"H tn *"}),t.jsx("input",{type:"text",value:m.hoTen,onChange:w=>f({...m,hoTen:w.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),t.jsx("input",{type:"email",value:m.email,onChange:w=>f({...m,email:w.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vai tr"}),t.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:a.map(w=>t.jsxs("label",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"checkbox",checked:m.vaiTroIds.includes(w.id),onChange:()=>T(w.id),className:"rounded"}),t.jsx("span",{className:"text-sm",children:w.tenVaiTro})]},w.id))})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border rounded-lg",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:"To"})]})]}):t.jsxs("form",{onSubmit:b,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M vai tr *"}),t.jsx("input",{type:"text",value:p.maVaiTro,onChange:w=>N({...p,maVaiTro:w.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: SUPERVISOR",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn vai tr *"}),t.jsx("input",{type:"text",value:p.tenVaiTro,onChange:w=>N({...p,tenVaiTro:w.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cp "}),t.jsx("input",{type:"number",value:p.capDo,onChange:w=>N({...p,capDo:Number(w.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:1,max:100})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:p.moTa,onChange:w=>N({...p,moTa:w.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border rounded-lg",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:"To"})]})]})]})})]})}const vf={TAO:{label:"To mi",color:"bg-green-100 text-green-700",icon:""},SUA:{label:"Cp nht",color:"bg-blue-100 text-blue-700",icon:""},XOA:{label:"Xa",color:"bg-red-100 text-red-700",icon:""},XEM:{label:"Xem",color:"bg-gray-100 text-gray-700",icon:""},DANG_NHAP:{label:"ng nhp",color:"bg-indigo-100 text-indigo-700",icon:""},DANG_XUAT:{label:"ng xut",color:"bg-purple-100 text-purple-700",icon:""},CHOT:{label:"Cht",color:"bg-yellow-100 text-yellow-700",icon:""},MO_KHOA:{label:"M kha",color:"bg-cyan-100 text-cyan-700",icon:""},DUYET:{label:"Duyt",color:"bg-emerald-100 text-emerald-700",icon:""},TU_CHOI:{label:"T chi",color:"bg-orange-100 text-orange-700",icon:""}};function HD(){var j,T;const[e,n]=D.useState([]),[a,r]=D.useState(!0),[s,l]=D.useState(null),[o,d]=D.useState(""),[u,x]=D.useState(""),[m,f]=D.useState(""),[p,N]=D.useState("");D.useEffect(()=>{y()},[o,u,m,p]);const y=async()=>{r(!0);try{const S=await _E.layDanhSach({hanhDong:o||void 0,bangDuLieu:u||void 0,tuNgay:m||void 0,denNgay:p||void 0}),w=Array.isArray(S)?S:(S==null?void 0:S.items)||[];n(w)}catch(S){console.error("Li ti d liu:",S)}finally{r(!1)}},g=S=>new Date(S).toLocaleString("vi-VN"),b=S=>S?JSON.stringify(S,null,2):null;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Audit Log"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Lch s thao tc trn h thng"})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hnh ng"}),t.jsxs("select",{value:o,onChange:S=>d(S.target.value),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),Object.entries(vf).map(([S,{label:w}])=>t.jsx("option",{value:S,children:w},S))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bng d liu"}),t.jsxs("select",{value:u,onChange:S=>x(S.target.value),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"NhanVien",children:"Nhn vin"}),t.jsx("option",{value:"BangLuong",children:"Bng lng"}),t.jsx("option",{value:"KhoanLuong",children:"Khon lng"}),t.jsx("option",{value:"PhongBan",children:"Phng ban"}),t.jsx("option",{value:"NguoiDung",children:"Ngi dng"}),t.jsx("option",{value:"DanhGiaKPI",children:"nh gi KPI"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T ngy"}),t.jsx(Ut,{value:m,onChange:f,className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n ngy"}),t.jsx(Ut,{value:p,onChange:N,className:"w-full border rounded-lg px-3 py-2"})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:a?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):e.length===0?t.jsx("div",{className:"p-12 text-center text-gray-500",children:"Khng c d liu audit log"}):t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngi dng"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Hnh ng"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Bng d liu"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ID bn ghi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Chi tit"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(S=>{const w=vf[S.hanhDong]||{label:S.hanhDong,color:"bg-gray-100",icon:""};return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:g(S.ngayTao)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:S.nguoiDung?t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:t.jsx("span",{className:"text-blue-600 text-xs font-medium",children:S.nguoiDung.hoTen.charAt(0)})}),t.jsx("span",{className:"ml-2 text-sm text-gray-900",children:S.nguoiDung.hoTen})]}):t.jsx("span",{className:"text-gray-400 text-sm",children:"H thng"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("span",{className:`px-2 py-1 text-xs rounded ${w.color}`,children:[w.icon," ",w.label]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:S.bangDuLieu||"-"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 font-mono",children:S.banGhiId||"-"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(S.duLieuCu||S.duLieuMoi)&&t.jsx("button",{onClick:()=>l(S),className:"text-blue-600 hover:text-blue-800 text-sm",children:"Xem chi tit"})})]},S.id)})})]})}),s&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-3xl max-h-[80vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex justify-between items-start mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Chi tit thay i"}),t.jsx("button",{onClick:()=>l(null),className:"text-gray-400 hover:text-gray-600",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Thi gian:"})," ",g(s.ngayTao)]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Ngi dng:"})," ",((j=s.nguoiDung)==null?void 0:j.hoTen)||"H thng"]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Hnh ng:"})," ",(T=vf[s.hanhDong])==null?void 0:T.label]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Bng:"})," ",s.bangDuLieu," #",s.banGhiId]}),s.ipAddress&&t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"IP:"})," ",s.ipAddress]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.duLieuCu&&t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-red-600 mb-2",children:"D liu c"}),t.jsx("pre",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-xs overflow-x-auto",children:b(s.duLieuCu)})]}),s.duLieuMoi&&t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-green-600 mb-2",children:"D liu mi"}),t.jsx("pre",{className:"bg-green-50 border border-green-200 rounded-lg p-3 text-xs overflow-x-auto",children:b(s.duLieuMoi)})]})]})]})})]})}const VD="tinh_luong_auth",_t=Zt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});_t.interceptors.request.use(e=>{const n=localStorage.getItem(VD);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const Ws={layDanhSach:e=>_t.get("/quy-che-luong",{params:e}).then(n=>n.data),layChiTiet:e=>_t.get(`/quy-che-luong/${e}`).then(n=>n.data),tao:e=>_t.post("/quy-che-luong",e).then(n=>n.data),capNhat:(e,n)=>_t.put(`/quy-che-luong/${e}`,n).then(a=>a.data),nhanBan:(e,n)=>_t.post(`/quy-che-luong/${e}/nhan-ban`,n).then(a=>a.data),kichHoat:e=>_t.post(`/quy-che-luong/${e}/kich-hoat`).then(n=>n.data),ngung:e=>_t.post(`/quy-che-luong/${e}/ngung`).then(n=>n.data),xoa:e=>_t.delete(`/quy-che-luong/${e}`).then(n=>n.data),layRules:e=>_t.get(`/quy-che-luong/${e}/rules`).then(n=>n.data),taoRule:(e,n)=>_t.post(`/quy-che-luong/${e}/rule`,n).then(a=>a.data),sapXepRules:(e,n)=>_t.put(`/quy-che-luong/${e}/sap-xep-rule`,{danhSachRuleId:n}).then(a=>a.data)},Od={layChiTiet:e=>_t.get(`/quy-che-rule/${e}`).then(n=>n.data),capNhat:(e,n)=>_t.put(`/quy-che-rule/${e}`,n).then(a=>a.data),xoa:e=>_t.delete(`/quy-che-rule/${e}`).then(n=>n.data),validate:e=>_t.post("/quy-che-rule/validate",e).then(n=>n.data),preview:e=>_t.post("/quy-che-rule/preview",e).then(n=>n.data)},Al={layDanhSach:e=>_t.get("/su-kien-thuong-phat",{params:e}).then(n=>n.data),layChiTiet:e=>_t.get(`/su-kien-thuong-phat/${e}`).then(n=>n.data),tao:e=>_t.post("/su-kien-thuong-phat",e).then(n=>n.data),capNhat:(e,n)=>_t.put(`/su-kien-thuong-phat/${e}`,n).then(a=>a.data),duyet:(e,n)=>_t.post(`/su-kien-thuong-phat/${e}/duyet`,{duyetBoi:n.duyetBoi||"admin",ghiChu:n.lyDo}).then(a=>a.data),duyetNhieu:e=>_t.post("/su-kien-thuong-phat/duyet-nhieu",{ids:e.danhSachId,duyetBoi:e.duyetBoi||"admin"}).then(n=>n.data),huy:e=>_t.post(`/su-kien-thuong-phat/${e}/huy`).then(n=>n.data),thongKe:(e,n,a)=>_t.get(`/su-kien-thuong-phat/thong-ke/${e}`,{params:{thang:n,nam:a}}).then(r=>r.data),layDanhMucSuKien:e=>_t.get("/su-kien-thuong-phat/danh-muc",{params:{loai:e}}).then(n=>n.data),taoDanhMucSuKien:e=>_t.post("/su-kien-thuong-phat/danh-muc",e).then(n=>n.data),khoiTaoDanhMucMau:()=>_t.post("/su-kien-thuong-phat/khoi-tao-danh-muc-mau").then(e=>e.data)},UD={chay:(e,n)=>_t.post(`/bang-luong/${e}/chay-rule-engine`,{nguoiThucHien:n}).then(a=>a.data),xemTrace:(e,n)=>_t.get(`/bang-luong/${e}/rule-trace`,{params:n?{nhanVienId:n}:void 0}).then(a=>a.data)},Md={goiYRule:(e,n,a)=>_t.post("/tro-ly-ai/goi-y-rule",{phongBanId:e,quyCheId:n,noiDungTiengViet:a}).then(r=>r.data),layContext:(e,n)=>_t.get(`/tro-ly-ai/context/${e}/${n}`).then(a=>a.data),apDungRule:(e,n,a)=>_t.post(`/tro-ly-ai/ap-dung/${e}`,{auditId:n,ruleDeXuat:a}).then(r=>r.data),huyDeXuat:e=>_t.post(`/tro-ly-ai/huy/${e}`).then(n=>n.data),lichSuDeXuat:e=>_t.get(`/tro-ly-ai/lich-su/${e}`).then(n=>n.data)},KD=({trangThai:e})=>{const a={NHAP:{bg:"bg-gray-100",text:"text-gray-800",label:"Nhp"},HIEU_LUC:{bg:"bg-green-100",text:"text-green-800",label:"Hiu lc"},TAM_DUNG:{bg:"bg-yellow-100",text:"text-yellow-800",label:"Tm dng"},NGUNG:{bg:"bg-red-100",text:"text-red-800",label:"Ngng"}}[e];return t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${a.bg} ${a.text}`,children:a.label})};function zD(){const e=br(),[n,a]=D.useState([]),[r,s]=D.useState([]),[l,o]=D.useState(!1),[d,u]=D.useState(""),[x,m]=D.useState(!1),[f,p]=D.useState({phongBanId:0,tenQuyChe:"",moTa:"",tuNgay:new Date().toISOString().split("T")[0]});D.useEffect(()=>{N(),y()},[d]);const N=async()=>{try{const _=await Jt.layTatCa();s(_)}catch(_){console.error("Li load phng ban:",_)}},y=async()=>{o(!0);try{const _=d?{phongBanId:d}:{},E=await Ws.layDanhSach(_);a(E)}catch(_){console.error("Li load quy ch:",_)}finally{o(!1)}},g=async()=>{if(!f.phongBanId||!f.tenQuyChe||!f.tuNgay){alert("Vui lng nhp y  thng tin");return}try{await Ws.tao({phongBanId:f.phongBanId,tenQuyChe:f.tenQuyChe,moTa:f.moTa,tuNgay:new Date(f.tuNgay)}),m(!1),p({phongBanId:0,tenQuyChe:"",moTa:"",tuNgay:new Date().toISOString().split("T")[0]}),y()}catch(_){console.error("Li to quy ch:",_),alert("Li to quy ch")}},b=async _=>{if(confirm("Kch hot quy ch ny? Cc quy ch khc cng phng ban s b ngng."))try{await Ws.kichHoat(_),y()}catch(E){console.error("Li kch hot:",E),alert("Li kch hot quy ch")}},j=async _=>{if(confirm("Ngng quy ch ny?"))try{await Ws.ngung(_),y()}catch(E){console.error("Li ngng:",E),alert("Li ngng quy ch")}},T=async(_,E)=>{const C=prompt("Tn quy ch mi:",`${E} (v2)`);if(C)try{const P=await Ws.nhanBan(_,{tenQuyChe:C,tuNgay:new Date});e(`/quy-che/${P.id}`)}catch(P){console.error("Li nhn bn:",P),alert("Li nhn bn quy ch")}},S=async _=>{if(confirm("Xa quy ch ny? Ch c th xa quy ch ang  trng thi Nhp."))try{await Ws.xoa(_),y()}catch(E){console.error("Li xa:",E),alert("Khng th xa quy ch ny")}},w=n.reduce((_,E)=>{var P;const C=((P=E.phongBan)==null?void 0:P.tenPhongBan)||"Khc";return _[C]||(_[C]=[]),_[C].push(E),_},{});return t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Quy ch lng"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Cu hnh quy ch lng theo phng ban vi cc rule t ng"})]}),t.jsxs("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"To quy ch mi"]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:t.jsx("div",{className:"flex items-center gap-4",children:t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:d,onChange:_=>u(_.target.value?Number(_.target.value):""),className:"border rounded-lg px-3 py-2 min-w-[200px]",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),r.map(_=>t.jsx("option",{value:_.id,children:_.tenPhongBan},_.id))]})]})})}),l&&t.jsx("div",{className:"text-center py-10",children:t.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}),!l&&t.jsxs("div",{className:"space-y-6",children:[Object.entries(w).map(([_,E])=>t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b",children:t.jsx("h2",{className:"font-semibold text-gray-900",children:_})}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tn quy ch"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Phin bn"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"S rule"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"T ngy"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:E.map(C=>{var P;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsxs("td",{className:"px-4 py-3",children:[t.jsx("button",{onClick:()=>e(`/quy-che/${C.id}`),className:"text-blue-600 hover:text-blue-800 font-medium",children:C.tenQuyChe}),C.moTa&&t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:C.moTa})]}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-sm",children:["v",C.phienBan]})}),t.jsx("td",{className:"px-4 py-3 text-center",children:((P=C._count)==null?void 0:P.rules)||0}),t.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-600",children:new Date(C.tuNgay).toLocaleDateString("vi-VN")}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx(KD,{trangThai:C.trangThai})}),t.jsx("td",{className:"px-4 py-3 text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx("button",{onClick:()=>e(`/quy-che/${C.id}`),className:"p-1 text-gray-400 hover:text-blue-600",title:"Cu hnh",children:t.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),C.trangThai==="NHAP"&&t.jsx("button",{onClick:()=>b(C.id),className:"p-1 text-gray-400 hover:text-green-600",title:"Kch hot",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),C.trangThai==="HIEU_LUC"&&t.jsx("button",{onClick:()=>j(C.id),className:"p-1 text-gray-400 hover:text-yellow-600",title:"Ngng",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("button",{onClick:()=>T(C.id,C.tenQuyChe),className:"p-1 text-gray-400 hover:text-purple-600",title:"Nhn bn",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),C.trangThai==="NHAP"&&t.jsx("button",{onClick:()=>S(C.id),className:"p-1 text-gray-400 hover:text-red-600",title:"Xa",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},C.id)})})]})]},_)),Object.keys(w).length===0&&t.jsx("div",{className:"bg-white rounded-lg shadow p-10 text-center text-gray-500",children:'Cha c quy ch no. Bm "To quy ch mi"  bt u.'})]}),x&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[t.jsx("div",{className:"px-6 py-4 border-b",children:t.jsx("h3",{className:"text-lg font-semibold",children:"To quy ch mi"})}),t.jsxs("div",{className:"px-6 py-4 space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Phng ban ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("select",{value:f.phongBanId,onChange:_=>p({...f,phongBanId:Number(_.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn phng ban --"}),r.map(_=>t.jsx("option",{value:_.id,children:_.tenPhongBan},_.id))]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn quy ch ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:f.tenQuyChe,onChange:_=>p({...f,tenQuyChe:_.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Quy ch lng phng Kho 2026"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:f.moTa,onChange:_=>p({...f,moTa:_.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:3,placeholder:"M t quy ch..."})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["p dng t ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ut,{value:f.tuNgay,onChange:_=>p({...f,tuNgay:_}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"px-6 py-4 border-t flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:g,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To quy ch"})]})]})})]})}const $D=["Pht i tr: 1-2 ln 50k/ln, t ln 3 tr ln 100k/ln","Trch nhim kho: cp 1 500k, cp 2 1tr, cp 3 1.5tr","Tin trch nhim = lng c bn * 0.15","Thng chuyn cn: 200k/thng nu khng ngh","Ph cp trch nhim c nh 500k/thng"],bf={CO_DINH:"C nh",THEO_HE_SO:"Theo h s",BAC_THANG:"Bc thang",THEO_SU_KIEN:"Theo s kin",CONG_THUC:"Cng thc"},zb={CONG_DON:"Cng dn",GHI_DE:"Ghi "};function GD({isOpen:e,onClose:n,phongBanId:a,quyCheId:r,onRuleApplied:s}){const l=D.useRef(null),o=D.useRef(null),[d,u]=D.useState(""),[x,m]=D.useState(!1),[f,p]=D.useState(null),[N,y]=D.useState(null),[g,b]=D.useState(!1),[j,T]=D.useState(!1),[S,w]=D.useState(null),[_,E]=D.useState(!1),[C,P]=D.useState(null),[F,R]=D.useState(!1),[O,M]=D.useState(null),[q,J]=D.useState("goi-y"),[B,ue]=D.useState(!1),[te,Z]=D.useState(!1),[Q,fe]=D.useState(!1),[K,L]=D.useState({luongCoBan:1e7,capTrachNhiem:2,heSoTrachNhiem:1.2,soLanDiTre:3,soLanNghiKhongPhep:0});D.useEffect(()=>{e&&a&&r&&(Md.layContext(a,r).then(y).catch(console.error),setTimeout(()=>{var be;return(be=l.current)==null?void 0:be.focus()},100))},[e,a,r]),D.useEffect(()=>{e||(u(""),p(null),w(null),P(null),M(null),R(!1),ue(!1),Z(!1),fe(!1))},[e]);const X=D.useCallback(be=>{e&&(be.key==="Escape"&&n(),(be.ctrlKey||be.metaKey)&&be.key==="Enter"&&d.trim()&&!x&&be.preventDefault())},[e,d,x,n]);D.useEffect(()=>(document.addEventListener("keydown",X),()=>document.removeEventListener("keydown",X)),[X]);const I=async()=>{if(d.trim()){m(!0),p(null),w(null),P(null);try{const be=await Md.goiYRule(a,r,d);p(be),be.ruleDeXuat&&M({...be.ruleDeXuat})}catch(be){console.error("Li gi  rule:",be),p({hopLeSoBo:!1,canLamRo:["C li xy ra khi x l yu cu. Vui lng th li."]})}finally{m(!1)}}},W=async()=>{if(!O)return;const be=ne();if(be.length>0){w({hopLe:!1,loi:["[Client] "+be.join(", [Client] ")]});return}T(!0);try{const Oe=await Od.validate({loaiRule:O.loaiRule,dieuKienJson:O.dieuKienJson,congThucJson:O.congThucJson});w({hopLe:Oe.hopLe,loi:Oe.danhSachLoi||[]})}catch(Oe){console.error("Li validate:",Oe),w({hopLe:!1,loi:["C li xy ra khi validate server"]})}finally{T(!1)}},z=async()=>{if(O){E(!0);try{const be=await Od.preview({quyCheId:r,duLieuGiaLap:K});P({soTien:be.tongTien,trace:be.trace.map(Oe=>`${Oe.ruleName}: ${Oe.message}  ${Oe.output.toLocaleString("vi-VN")}`).join(`
`)})}catch(be){console.error("Li preview:",be)}finally{E(!1)}}},xe=async()=>{if(O)try{await navigator.clipboard.writeText(JSON.stringify(O,null,2)),fe(!0),setTimeout(()=>fe(!1),2e3)}catch(be){console.error("Li copy:",be)}},H=()=>{f!=null&&f.ruleDeXuat&&M({...f.ruleDeXuat})},ne=()=>{const be=[];if(!O)return["Khng c rule  validate"];(!O.tenRule||O.tenRule.trim().length<3)&&be.push("Tn rule phi c t nht 3 k t"),O.khoanLuongMa||be.push("Cha chn khon lng");const Oe=O.congThucJson;switch(O.loaiRule){case"CO_DINH":(!Oe.soTien||Oe.soTien<=0)&&be.push("S tin c nh phi ln hn 0");break;case"THEO_HE_SO":Oe.base||be.push("Cha chn ngun tnh (base)"),(!Oe.heSo||Oe.heSo<=0)&&be.push("H s phi ln hn 0");break;case"BAC_THANG":{const tt=Oe.bac;!tt||tt.length===0?be.push("Phi c t nht 1 bc thang"):tt.forEach((Je,Re)=>{(Je.from===void 0||Je.to===void 0)&&be.push(`Bc ${Re+1}: Cha nh ngha khong from-to`),!Je.soTien&&!Je.soTienMoiLan&&be.push(`Bc ${Re+1}: Cha nh ngha s tin`)})}break;case"CONG_THUC":(!Oe.bieuThuc||Oe.bieuThuc.trim().length===0)&&be.push("Cha nhp biu thc cng thc");break;case"THEO_SU_KIEN":Oe.maSuKien||be.push("Cha chn m s kin");break}return be},oe=async()=>{if(!(f!=null&&f.auditId)||!O)return;const be=ne();if(be.length>0){w({hopLe:!1,loi:be}),alert(`Vui lng sa cc li trc khi p dng:

`+be.join(`
`));return}if(confirm(`Xc nhn p dng rule "${O.tenRule}"?

Loi: ${bf[O.loaiRule]}
Khon lng: ${O.khoanLuongMa}`)){b(!0);try{await Md.apDungRule(r,f.auditId,O),alert("  p dng rule thnh cng!"),s(),n()}catch(tt){console.error("Li p dng rule:",tt);const Je=tt instanceof Error?tt.message:"Li khng xc nh";alert(` C li khi p dng rule: ${Je}`)}finally{b(!1)}}},Se=be=>{u(be)},V=be=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(be);return e?t.jsxs("div",{className:"fixed inset-0 z-50 flex overflow-hidden",children:[t.jsx("div",{className:"flex-1 bg-black/50 backdrop-blur-sm animate-fadeIn",onClick:n}),t.jsxs("div",{ref:o,className:"w-[600px] max-w-full bg-white shadow-2xl flex flex-col h-full animate-slideInRight",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 text-white shadow-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:t.jsx(v_,{className:"h-6 w-6"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"font-semibold text-lg",children:"Tr l AI gi  Rule"}),t.jsx("p",{className:"text-sm text-white/80",children:"Nhp ting Vit  To rule t ng"})]})]}),t.jsx("button",{onClick:n,className:"p-2 hover:bg-white/20 rounded-lg transition-all hover:rotate-90",title:"ng (Escape)",children:t.jsx(mn,{className:"h-5 w-5"})})]}),t.jsxs("div",{className:"flex border-b bg-gray-50",children:[t.jsxs("button",{onClick:()=>J("goi-y"),className:`flex-1 py-3 text-sm font-medium transition-all ${q==="goi-y"?"border-b-2 border-blue-600 text-blue-600 bg-white":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[t.jsx(L_,{className:"h-4 w-4 inline mr-2"}),"Gi  Rule"]}),t.jsxs("button",{onClick:()=>J("lich-su"),className:`flex-1 py-3 text-sm font-medium transition-all ${q==="lich-su"?"border-b-2 border-blue-600 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[t.jsx(gu,{className:"h-4 w-4 inline mr-2"}),"Lch s"]})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[q==="goi-y"&&t.jsxs(t.Fragment,{children:[N&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-sm",children:[t.jsx("div",{className:"font-medium text-gray-700 mb-2",children:"Ng cnh hin ti:"}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-gray-600",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Phng ban:"})," ",t.jsx("span",{className:"font-medium",children:N.phongBan.tenPhongBan})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Quy ch:"})," ",t.jsxs("span",{className:"font-medium",children:["v",N.quyChe.phienBan]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Khon lng:"})," ",t.jsxs("span",{className:"font-medium",children:[N.khoanLuongs.length," khon"]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"S kin:"})," ",t.jsxs("span",{className:"font-medium",children:[N.danhMucSuKien.length," mc"]})]})]})]}),t.jsxs("div",{className:"animate-slideInUp",children:[t.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:" Mu gi :"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:$D.map((be,Oe)=>t.jsx("button",{onClick:()=>Se(be),className:"text-xs px-3 py-1.5 bg-blue-50 text-blue-700 rounded-full hover:bg-blue-100 hover:scale-105 transition-all",children:be.length>40?be.substring(0,37)+"...":be},Oe))})]}),t.jsxs("div",{className:"animate-slideInUp",style:{animationDelay:"0.1s"},children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" M t bng ting Vit:"}),t.jsx("textarea",{ref:l,value:d,onChange:be=>u(be.target.value),onKeyDown:be=>{(be.ctrlKey||be.metaKey)&&be.key==="Enter"&&(be.preventDefault(),d.trim()&&!x&&I())},placeholder:"V d: Pht i tr 1-2 ln 50k/ln, t ln 3 tr ln 100k/ln",className:"w-full h-28 px-3 py-2 border rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",disabled:x}),t.jsxs("div",{className:"flex items-center justify-between mt-1",children:[t.jsx("span",{className:"text-xs text-gray-400",children:"/Ctrl + Enter  gi"}),t.jsxs("span",{className:"text-xs text-gray-400",children:[d.length," k t"]})]}),t.jsx("button",{onClick:I,disabled:!d.trim()||x,className:"mt-2 w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-md hover:shadow-lg",children:x?t.jsxs(t.Fragment,{children:[t.jsx(Rn,{className:"h-4 w-4 animate-spin"}),"ang x l..."]}):t.jsxs(t.Fragment,{children:[t.jsx(bu,{className:"h-4 w-4"}),"To  xut"]})})]}),f&&t.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[t.jsxs("div",{className:`p-3 flex items-center gap-2 ${f.hopLeSoBo?"bg-green-50":"bg-yellow-50"}`,children:[f.hopLeSoBo?t.jsx(Gn,{className:"h-5 w-5 text-green-600"}):t.jsx(A_,{className:"h-5 w-5 text-yellow-600"}),t.jsx("span",{className:`font-medium ${f.hopLeSoBo?"text-green-700":"text-yellow-700"}`,children:f.hopLeSoBo?" to  xut thnh cng":"Cn lm r thm"})]}),f.canLamRo.length>0&&t.jsxs("div",{className:"p-3 bg-yellow-50 border-t",children:[t.jsx("div",{className:"text-sm font-medium text-yellow-800 mb-2",children:"Cu hi:"}),t.jsx("ul",{className:"space-y-1",children:f.canLamRo.map((be,Oe)=>t.jsxs("li",{className:"text-sm text-yellow-700 flex items-start gap-2",children:[t.jsx("span",{children:""}),t.jsx("span",{children:be})]},Oe))})]}),f.ruleDeXuat&&O&&t.jsxs("div",{className:"p-3 space-y-3",children:[f.tomTatRule&&t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Tm tt:"})," ",t.jsx("span",{className:"font-medium",children:f.tomTatRule})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2 text-sm",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Loi rule:"})," ",t.jsx("span",{className:"font-medium text-blue-600",children:bf[O.loaiRule]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Ch  gp:"})," ",t.jsx("span",{className:"font-medium",children:zb[O.cheDoGop]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Khon lng:"})," ",t.jsx("span",{className:"font-medium",children:O.khoanLuongMa})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"u tin:"})," ",t.jsx("span",{className:"font-medium",children:O.thuTuUuTien})]})]}),t.jsxs("div",{className:"pt-2 border-t flex items-center gap-2 flex-wrap",children:[t.jsxs("button",{onClick:()=>R(!F),className:"text-blue-600 hover:text-blue-800 text-sm flex items-center gap-1",children:[F?t.jsx(Ra,{className:"h-4 w-4"}):t.jsx(xj,{className:"h-4 w-4"}),F?"n JSON":"Xem JSON"]}),t.jsxs("button",{onClick:xe,className:"text-gray-600 hover:text-gray-800 text-sm flex items-center gap-1",children:[t.jsx(dj,{className:"h-4 w-4"}),Q?" copy!":"Copy JSON"]}),t.jsxs("button",{onClick:()=>ue(!B),className:"text-purple-600 hover:text-purple-800 text-sm flex items-center gap-1",children:[t.jsx(ts,{className:"h-4 w-4"}),B?"n form":"Chnh sa"]}),t.jsxs("button",{onClick:H,className:"text-orange-600 hover:text-orange-800 text-sm flex items-center gap-1",children:[t.jsx(vu,{className:"h-4 w-4"}),"Reset"]})]}),F&&t.jsx("pre",{className:"mt-2 p-2 bg-gray-800 text-green-400 rounded text-xs overflow-x-auto max-h-48",children:JSON.stringify(O,null,2)}),B&&t.jsxs("div",{className:"mt-2 p-3 bg-white border rounded-lg space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Tn rule"}),t.jsx("input",{type:"text",value:O.tenRule,onChange:be=>M({...O,tenRule:be.target.value}),className:"w-full px-2 py-1.5 border rounded text-sm"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Loi rule"}),t.jsx("select",{value:O.loaiRule,onChange:be=>M({...O,loaiRule:be.target.value}),className:"w-full px-2 py-1.5 border rounded text-sm",children:Object.entries(bf).map(([be,Oe])=>t.jsx("option",{value:be,children:Oe},be))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Ch  gp"}),t.jsx("select",{value:O.cheDoGop,onChange:be=>M({...O,cheDoGop:be.target.value}),className:"w-full px-2 py-1.5 border rounded text-sm",children:Object.entries(zb).map(([be,Oe])=>t.jsx("option",{value:be,children:Oe},be))})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Th t u tin"}),t.jsx("input",{type:"number",value:O.thuTuUuTien,onChange:be=>M({...O,thuTuUuTien:Number(be.target.value)}),className:"w-24 px-2 py-1.5 border rounded text-sm"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",id:"choPhepChinhTay",checked:O.choPhepChinhTay,onChange:be=>M({...O,choPhepChinhTay:be.target.checked})}),t.jsx("label",{htmlFor:"choPhepChinhTay",className:"text-sm text-gray-700",children:"Cho php chnh tay"})]})]})]}),f.giaiThich&&f.giaiThich.length>0&&t.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[t.jsx("div",{className:"text-sm font-medium text-blue-800 mb-1",children:"Gii thch:"}),t.jsx("ul",{className:"space-y-1",children:f.giaiThich.map((be,Oe)=>t.jsxs("li",{className:"text-sm text-blue-700 flex items-start gap-2",children:[t.jsx("span",{children:""}),t.jsx("span",{children:be})]},Oe))})]}),f.canhBao&&f.canhBao.length>0&&t.jsxs("div",{className:"bg-orange-50 rounded-lg p-3",children:[t.jsxs("div",{className:"text-sm font-medium text-orange-800 mb-1 flex items-center gap-1",children:[t.jsx(sa,{className:"h-4 w-4"}),"Cnh bo:"]}),t.jsx("ul",{className:"space-y-1",children:f.canhBao.map((be,Oe)=>t.jsxs("li",{className:"text-sm text-orange-700 flex items-start gap-2",children:[t.jsx("span",{children:""}),t.jsx("span",{children:be})]},Oe))})]}),S&&t.jsxs("div",{className:`rounded-lg p-3 ${S.hopLe?"bg-green-50":"bg-red-50"}`,children:[t.jsxs("div",{className:`text-sm font-medium mb-1 flex items-center gap-1 ${S.hopLe?"text-green-800":"text-red-800"}`,children:[S.hopLe?t.jsx(Gn,{className:"h-4 w-4"}):t.jsx(sa,{className:"h-4 w-4"}),S.hopLe?"Validate thnh cng":"Validate tht bi"]}),S.loi.length>0&&t.jsx("ul",{className:"space-y-1",children:S.loi.map((be,Oe)=>t.jsxs("li",{className:"text-sm text-red-700 flex items-start gap-2",children:[t.jsx("span",{children:""}),t.jsx("span",{children:be})]},Oe))})]}),C&&t.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[t.jsx("div",{className:"text-sm font-medium text-purple-800 mb-1",children:"Preview (d liu gi lp):"}),t.jsx("div",{className:"text-lg font-bold text-purple-600",children:V(C.soTien)}),t.jsx("div",{className:"text-xs text-purple-600 mt-1",children:C.trace})]}),t.jsxs("div",{className:"border rounded-lg",children:[t.jsxs("button",{onClick:()=>Z(!te),className:"w-full px-3 py-2 flex items-center justify-between text-sm text-gray-600 hover:bg-gray-50",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(ts,{className:"h-4 w-4"}),"Ci t d liu gi lp"]}),t.jsx("span",{children:te?"":""})]}),te&&t.jsx("div",{className:"p-3 border-t space-y-2",children:t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Lng c bn"}),t.jsx("input",{type:"number",value:K.luongCoBan,onChange:be=>L({...K,luongCoBan:Number(be.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"H s trch nhim"}),t.jsx("input",{type:"number",step:"0.1",value:K.heSoTrachNhiem,onChange:be=>L({...K,heSoTrachNhiem:Number(be.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Cp trch nhim"}),t.jsx("input",{type:"number",value:K.capTrachNhiem,onChange:be=>L({...K,capTrachNhiem:Number(be.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"S ln i tr"}),t.jsx("input",{type:"number",value:K.soLanDiTre,onChange:be=>L({...K,soLanDiTre:Number(be.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]})]})})]}),t.jsxs("div",{className:"flex gap-2 pt-2",children:[t.jsxs("button",{onClick:W,disabled:j,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 disabled:opacity-50 transition",children:[j?t.jsx(Rn,{className:"h-4 w-4 animate-spin"}):t.jsx(yr,{className:"h-4 w-4"}),"Validate"]}),t.jsxs("button",{onClick:z,disabled:_,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 border border-purple-600 text-purple-600 rounded-lg hover:bg-purple-50 disabled:opacity-50 transition",children:[_?t.jsx(Rn,{className:"h-4 w-4 animate-spin"}):t.jsx(Ra,{className:"h-4 w-4"}),"Preview"]}),t.jsxs("button",{onClick:oe,disabled:g,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition",children:[g?t.jsx(Rn,{className:"h-4 w-4 animate-spin"}):t.jsx(Br,{className:"h-4 w-4"}),"p dng"]})]})]})]})]}),q==="lich-su"&&t.jsx(qD,{quyCheId:r,onTaiSuDung:be=>{u(be),J("goi-y")}})]})]})]}):null}function qD({quyCheId:e,onTaiSuDung:n}){const[a,r]=D.useState([]),[s,l]=D.useState(!0);D.useEffect(()=>{Md.lichSuDeXuat(e).then(r).catch(console.error).finally(()=>l(!1))},[e]);const o=async u=>{if(confirm("Hy  xut ny?"))try{await Md.huyDeXuat(u),r(x=>x.map(m=>m.id===u?{...m,trangThai:"HUY"}:m))}catch(x){console.error("Li hy:",x)}};if(s)return t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx(Rn,{className:"h-6 w-6 animate-spin text-gray-400"})});if(a.length===0)return t.jsx("div",{className:"text-center py-8 text-gray-500",children:"Cha c lch s  xut no"});const d={DE_XUAT:{text:" xut",color:"bg-yellow-100 text-yellow-800"},DA_AP_DUNG:{text:" p dng",color:"bg-green-100 text-green-800"},HUY:{text:" hy",color:"bg-gray-100 text-gray-800"}};return t.jsx("div",{className:"space-y-3",children:a.map(u=>{var x,m;return t.jsxs("div",{className:"border rounded-lg p-3 hover:border-gray-300 transition",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("div",{className:"text-sm text-gray-500",children:[new Date(u.taoLuc).toLocaleString("vi-VN"),u.nguoiTao&&`  ${u.nguoiTao.hoTen}`]}),t.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${((x=d[u.trangThai])==null?void 0:x.color)||"bg-gray-100"}`,children:((m=d[u.trangThai])==null?void 0:m.text)||u.trangThai})]}),t.jsx("div",{className:"text-sm text-gray-700 line-clamp-2",children:u.promptGoc}),u.rule&&t.jsxs("div",{className:"mt-2 text-xs text-blue-600",children:[" Rule: ",u.rule.tenRule]}),t.jsxs("div",{className:"mt-2 flex gap-2",children:[t.jsxs("button",{onClick:()=>n==null?void 0:n(u.promptGoc),className:"text-xs text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[t.jsx(vu,{className:"h-3 w-3"}),"Ti s dng"]}),u.trangThai==="DE_XUAT"&&t.jsxs("button",{onClick:()=>o(u.id),className:"text-xs text-red-600 hover:text-red-800 flex items-center gap-1",children:[t.jsx(er,{className:"h-3 w-3"}),"Hy"]})]})]},u.id)})})}const pg={CO_DINH:"C nh",THEO_HE_SO:"Theo h s",BAC_THANG:"Bc thang",THEO_SU_KIEN:"Theo s kin",CONG_THUC:"Cng thc"},WD={CO_DINH:"bg-blue-100 text-blue-800",THEO_HE_SO:"bg-green-100 text-green-800",BAC_THANG:"bg-purple-100 text-purple-800",THEO_SU_KIEN:"bg-orange-100 text-orange-800",CONG_THUC:"bg-pink-100 text-pink-800"},XD=({rule:e,index:n,isSelected:a,onSelect:r,onDragStart:s,onDragOver:l,onDrop:o,isDragging:d})=>{var u;return t.jsx("div",{draggable:!0,onDragStart:s,onDragOver:l,onDrop:o,onClick:r,className:`
        p-3 rounded-lg border-2 cursor-pointer transition-all
        ${a?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}
        ${d?"opacity-50":""}
      `,children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"cursor-grab text-gray-400 hover:text-gray-600 mt-1",children:t.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{d:"M7 2a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 2zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 8zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 14zm6-8a2 2 0 1 0-.001-4.001A2 2 0 0 0 13 6zm0 2a2 2 0 1 0 .001 4.001A2 2 0 0 0 13 8zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 13 14z"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsxs("span",{className:"text-xs font-medium text-gray-500",children:["#",n+1]}),t.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${WD[e.loaiRule]}`,children:pg[e.loaiRule]})]}),t.jsx("h4",{className:"font-medium text-gray-900 truncate",children:e.tenRule}),t.jsx("p",{className:"text-sm text-gray-500 truncate mt-1",children:(u=e.khoanLuong)==null?void 0:u.tenKhoan})]}),t.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${e.trangThai?"bg-green-500":"bg-gray-300"}`})]})})},QD=({value:e,onChange:n})=>t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S tin c nh"}),t.jsx("input",{type:"number",value:e.soTien||"",onChange:a=>n({soTien:Number(a.target.value)}),className:"w-full border rounded-lg px-3 py-2",placeholder:"1000000"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.soTien?new Intl.NumberFormat("vi-VN").format(e.soTien)+"":""})]}),YD=({value:e,onChange:n})=>t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Base (ngun tnh)"}),t.jsxs("select",{value:e.base||"",onChange:a=>n({...e,base:a.target.value,heSo:e.heSo||1}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn --"}),t.jsx("option",{value:"LUONG_CO_BAN",children:"Lng c bn"}),t.jsx("option",{value:"HE_SO_TRACH_NHIEM",children:"H s trch nhim"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"H s"}),t.jsx("input",{type:"number",step:"0.01",value:e.heSo||"",onChange:a=>n({...e,base:e.base||"LUONG_CO_BAN",heSo:Number(a.target.value)}),className:"w-full border rounded-lg px-3 py-2",placeholder:"0.2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cng thm (ty chn)"}),t.jsx("input",{type:"number",value:e.congThem||"",onChange:a=>n({...e,base:e.base||"LUONG_CO_BAN",heSo:e.heSo||1,congThem:Number(a.target.value)||void 0}),className:"w-full border rounded-lg px-3 py-2",placeholder:"200000"})]})]}),JD=({value:e,onChange:n})=>{const a=e.bac||[{from:1,to:1,soTien:0}],r=()=>{const o=a[a.length-1];n({field:e.field||"cap_trach_nhiem",bac:[...a,{from:((o==null?void 0:o.to)||0)+1,to:((o==null?void 0:o.to)||0)+1,soTien:0}]})},s=o=>{a.length<=1||n({field:e.field||"cap_trach_nhiem",bac:a.filter((d,u)=>u!==o)})},l=(o,d)=>{n({field:e.field||"cap_trach_nhiem",bac:a.map((u,x)=>x===o?{...u,...d}:u)})};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng d liu"}),t.jsxs("select",{value:e.field||"",onChange:o=>n({...e,field:o.target.value,bac:a}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn --"}),t.jsx("option",{value:"cap_trach_nhiem",children:"Cp trch nhim"}),t.jsx("option",{value:"he_so_trach_nhiem",children:"H s trch nhim"})]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Bc thang"}),t.jsx("button",{type:"button",onClick:r,className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Thm bc"})]}),t.jsx("div",{className:"space-y-2",children:a.map((o,d)=>t.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded",children:[t.jsxs("span",{className:"text-sm text-gray-500 w-16",children:["Bc ",d+1]}),t.jsx("input",{type:"number",value:o.from,onChange:u=>l(d,{from:Number(u.target.value)}),className:"w-20 border rounded px-2 py-1 text-sm",placeholder:"T"}),t.jsx("span",{className:"text-gray-400",children:""}),t.jsx("input",{type:"number",value:o.to,onChange:u=>l(d,{to:Number(u.target.value)}),className:"w-20 border rounded px-2 py-1 text-sm",placeholder:"n"}),t.jsx("input",{type:"number",value:o.soTien||"",onChange:u=>l(d,{soTien:Number(u.target.value)}),className:"flex-1 border rounded px-2 py-1 text-sm",placeholder:"S tin"}),a.length>1&&t.jsx("button",{type:"button",onClick:()=>s(d),className:"text-red-500 hover:text-red-700",children:""})]},d))})]})]})},ZD=({value:e,onChange:n})=>t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Biu thc cng thc"}),t.jsx("textarea",{value:e.bieuThuc||"",onChange:a=>n({bieuThuc:a.target.value}),className:"w-full border rounded-lg px-3 py-2 font-mono text-sm",rows:3,placeholder:"LUONG_CO_BAN * HE_SO_TRACH_NHIEM + 200000"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Bin cho php: LUONG_CO_BAN, HE_SO_TRACH_NHIEM, CAP_TRACH_NHIEM, CONG_CHUAN, CONG_THUC_TE, ..."})]});function eA(){var Q,fe,K,L,X;const{id:e}=q0(),n=br(),[a,r]=D.useState(null),[s,l]=D.useState([]),[o,d]=D.useState([]),[u,x]=D.useState(null),[m,f]=D.useState(!0),[p,N]=D.useState(!1),[y,g]=D.useState(null),[b,j]=D.useState(!1),[T,S]=D.useState(!1),[w,_]=D.useState(null),[E,C]=D.useState("thongtin"),[P,F]=D.useState({tenRule:"",moTa:"",khoanLuongId:0,loaiRule:"CO_DINH",congThucJson:{soTien:0},dieuKienJson:{},cheDoGop:"GHI_DE",choPhepChinhTay:!0});D.useEffect(()=>{e&&R()},[e]);const R=async()=>{f(!0);try{const[I,W]=await Promise.all([Ws.layChiTiet(Number(e)),pr.layTatCa()]);r(I),l(I.rules||[]),d(W),I.rules&&I.rules.length>0&&O(I.rules[0])}catch(I){console.error("Li load d liu:",I)}finally{f(!1)}},O=I=>{x(I),F({tenRule:I.tenRule,moTa:I.moTa||"",khoanLuongId:I.khoanLuongId,loaiRule:I.loaiRule,congThucJson:JSON.parse(I.congThucJson),dieuKienJson:I.dieuKienJson?JSON.parse(I.dieuKienJson):{},cheDoGop:I.cheDoGop,choPhepChinhTay:I.choPhepChinhTay}),C("thongtin"),_(null)},M=I=>{g(I)},q=I=>{I.preventDefault()},J=async I=>{if(y===null||y===I){g(null);return}const W=[...s],[z]=W.splice(y,1);W.splice(I,0,z),l(W),g(null);try{await Ws.sapXepRules(Number(e),W.map(xe=>xe.id))}catch(xe){console.error("Li sp xp:",xe),R()}},B=async()=>{var I,W,z;if(u){N(!0);try{await Od.capNhat(u.id,{tenRule:P.tenRule,moTa:P.moTa,loaiRule:P.loaiRule,congThucJson:P.congThucJson,dieuKienJson:P.dieuKienJson,cheDoGop:P.cheDoGop,choPhepChinhTay:P.choPhepChinhTay}),R()}catch(xe){console.error("Li lu rule:",xe),alert(((z=(W=(I=xe.response)==null?void 0:I.data)==null?void 0:W.loi)==null?void 0:z.join(`
`))||"Li lu rule")}finally{N(!1)}}},ue=async()=>{if(u&&confirm("Xa rule ny?"))try{await Od.xoa(u.id),x(null),R()}catch(I){console.error("Li xa:",I),alert("Khng th xa rule ny")}},te=async()=>{if(e)try{const I=await Od.preview({quyCheId:Number(e),duLieuGiaLap:{LUONG_CO_BAN:1e7,CAP_TRACH_NHIEM:2,HE_SO_TRACH_NHIEM:1.2}});_(I),C("preview")}catch(I){console.error("Li preview:",I),alert("Li chy th")}},Z=async I=>{try{let W={soTien:0};I.loaiRule==="THEO_HE_SO"?W={base:"LUONG_CO_BAN",heSo:.1}:I.loaiRule==="BAC_THANG"?W={field:"cap_trach_nhiem",bac:[{from:1,to:1,soTien:5e5}]}:I.loaiRule==="CONG_THUC"&&(W={bieuThuc:"LUONG_CO_BAN * 0.1"}),await Ws.taoRule(Number(e),{khoanLuongId:I.khoanLuongId,tenRule:I.tenRule,loaiRule:I.loaiRule,congThucJson:W}),j(!1),R()}catch(W){console.error("Li thm rule:",W),alert("Li thm rule")}};return m?t.jsx("div",{className:"flex items-center justify-center h-96",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}):a?t.jsxs("div",{className:"h-screen flex flex-col",children:[t.jsx("div",{className:"bg-white border-b px-6 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>n("/quy-che"),className:"p-2 hover:bg-gray-100 rounded",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl font-bold",children:a.tenQuyChe}),t.jsxs("p",{className:"text-sm text-gray-500",children:[(Q=a.phongBan)==null?void 0:Q.tenPhongBan,"  Phin bn ",a.phienBan]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[!a.coDuocSua&&t.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded text-sm",children:" Quy ch  kho"}),t.jsx("button",{onClick:te,className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Chy th"}),t.jsxs("button",{onClick:()=>S(!0),disabled:!a.coDuocSua,className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 disabled:opacity-50 flex items-center gap-2",children:[t.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t.jsx("path",{d:"M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73A2 2 0 0 1 12 2z"}),t.jsx("path",{d:"M9 14a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"}),t.jsx("path",{d:"M15 14a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"})]}),"Tr l AI"]}),t.jsx("button",{onClick:()=>j(!0),disabled:!a.coDuocSua,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"+ Thm rule"})]})]})}),t.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[t.jsxs("div",{className:"w-80 border-r bg-gray-50 flex flex-col",children:[t.jsxs("div",{className:"p-4 border-b bg-white",children:[t.jsxs("h3",{className:"font-semibold text-gray-900",children:["Danh sch Rule (",s.length,")"]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ko th  sp xp th t u tin"})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[s.map((I,W)=>t.jsx(XD,{rule:I,index:W,isSelected:(u==null?void 0:u.id)===I.id,onSelect:()=>O(I),onDragStart:()=>M(W),onDragOver:q,onDrop:()=>J(W),isDragging:y===W},I.id)),s.length===0&&t.jsxs("div",{className:"text-center text-gray-500 py-10",children:["Cha c rule no.",t.jsx("br",{}),t.jsx("button",{onClick:()=>j(!0),className:"text-blue-600 hover:underline mt-2",children:"Thm rule u tin"})]})]})]}),t.jsx("div",{className:"flex-1 flex flex-col bg-white overflow-hidden",children:u?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"border-b",children:t.jsx("nav",{className:"flex px-6",children:["thongtin","dieukien","congthuc","preview"].map(I=>t.jsx("button",{onClick:()=>C(I),className:`px-4 py-3 text-sm font-medium border-b-2 -mb-px ${E===I?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:{thongtin:"Thng tin",dieukien:"iu kin",congthuc:"Cch tnh",preview:"Xem th"}[I]},I))})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[E==="thongtin"&&t.jsxs("div",{className:"space-y-4 max-w-lg",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn rule"}),t.jsx("input",{type:"text",value:P.tenRule,onChange:I=>F({...P,tenRule:I.target.value}),className:"w-full border rounded-lg px-3 py-2",disabled:!a.coDuocSua})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Khon lng"}),t.jsx("select",{value:P.khoanLuongId,onChange:I=>F({...P,khoanLuongId:Number(I.target.value)}),className:"w-full border rounded-lg px-3 py-2",disabled:!a.coDuocSua,children:o.map(I=>t.jsxs("option",{value:I.id,children:[I.tenKhoan," (",I.loai==="THU_NHAP"?"+":"-",")"]},I.id))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi rule"}),t.jsx("select",{value:P.loaiRule,onChange:I=>F({...P,loaiRule:I.target.value}),className:"w-full border rounded-lg px-3 py-2",disabled:!a.coDuocSua,children:Object.entries(pg).map(([I,W])=>t.jsx("option",{value:I,children:W},I))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:P.moTa,onChange:I=>F({...P,moTa:I.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:3,disabled:!a.coDuocSua})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:P.choPhepChinhTay,onChange:I=>F({...P,choPhepChinhTay:I.target.checked}),disabled:!a.coDuocSua}),t.jsx("span",{className:"text-sm",children:"Cho php chnh tay"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm",children:"Ch  gp:"}),t.jsxs("select",{value:P.cheDoGop,onChange:I=>F({...P,cheDoGop:I.target.value}),className:"border rounded px-2 py-1 text-sm",disabled:!a.coDuocSua,children:[t.jsx("option",{value:"GHI_DE",children:"Ghi "}),t.jsx("option",{value:"CONG_DON",children:"Cng dn"})]})]})]})]}),E==="dieukien"&&t.jsxs("div",{className:"max-w-lg space-y-4",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"iu kin p dng rule.  trng = p dng cho tt c nhn vin."}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vai tr"}),t.jsx("input",{type:"text",value:(((K=(fe=P.dieuKienJson)==null?void 0:fe.apDungCho)==null?void 0:K.vaiTro)||[]).join(", "),onChange:I=>{var W;return F({...P,dieuKienJson:{apDungCho:{...(W=P.dieuKienJson)==null?void 0:W.apDungCho,vaiTro:I.target.value?I.target.value.split(",").map(z=>z.trim()):void 0}}})},className:"w-full border rounded-lg px-3 py-2",placeholder:"TO_TRUONG, QUAN_LY",disabled:!a.coDuocSua}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Phn cch bng du phy"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cp trch nhim"}),t.jsx("input",{type:"text",value:(((X=(L=P.dieuKienJson)==null?void 0:L.apDungCho)==null?void 0:X.capTrachNhiem)||[]).join(", "),onChange:I=>{var W;return F({...P,dieuKienJson:{apDungCho:{...(W=P.dieuKienJson)==null?void 0:W.apDungCho,capTrachNhiem:I.target.value?I.target.value.split(",").map(z=>Number(z.trim())).filter(z=>!isNaN(z)):void 0}}})},className:"w-full border rounded-lg px-3 py-2",placeholder:"1, 2, 3",disabled:!a.coDuocSua})]})]}),E==="congthuc"&&t.jsxs("div",{className:"max-w-lg",children:[P.loaiRule==="CO_DINH"&&t.jsx(QD,{value:P.congThucJson,onChange:I=>F({...P,congThucJson:I})}),P.loaiRule==="THEO_HE_SO"&&t.jsx(YD,{value:P.congThucJson,onChange:I=>F({...P,congThucJson:I})}),P.loaiRule==="BAC_THANG"&&t.jsx(JD,{value:P.congThucJson,onChange:I=>F({...P,congThucJson:I})}),P.loaiRule==="CONG_THUC"&&t.jsx(ZD,{value:P.congThucJson,onChange:I=>F({...P,congThucJson:I})}),P.loaiRule==="THEO_SU_KIEN"&&t.jsx("div",{className:"text-gray-500",children:"Form s kin s c thm sau..."})]}),E==="preview"&&w&&t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"p-4 bg-blue-50 rounded-lg",children:t.jsxs("h4",{className:"font-semibold text-blue-900",children:["Tng tin: ",new Intl.NumberFormat("vi-VN").format(w.tongTien),""]})}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-2",children:"Chi tit"}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Khon lng"}),t.jsx("th",{className:"px-4 py-2 text-right text-sm",children:"S tin"}),t.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Gii thch"})]})}),t.jsx("tbody",{children:w.chiTiet.map((I,W)=>t.jsxs("tr",{className:"border-t",children:[t.jsx("td",{className:"px-4 py-2",children:I.khoanLuong}),t.jsx("td",{className:"px-4 py-2 text-right font-mono",children:new Intl.NumberFormat("vi-VN").format(I.soTien)}),t.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:I.giaiThich})]},W))})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-2",children:"Trace"}),t.jsx("div",{className:"space-y-2",children:w.trace.map((I,W)=>t.jsxs("div",{className:"p-3 bg-gray-50 rounded text-sm",children:[t.jsx("div",{className:"font-medium",children:I.ruleName}),t.jsx("div",{className:"text-gray-600",children:I.message}),t.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Output: ",new Intl.NumberFormat("vi-VN").format(I.output),""]})]},W))})]})]})]}),a.coDuocSua&&t.jsxs("div",{className:"border-t px-6 py-4 flex justify-between",children:[t.jsx("button",{onClick:ue,className:"px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg",children:"Xa rule"}),t.jsx("button",{onClick:B,disabled:p,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:p?"ang lu...":"Lu thay i"})]})]}):t.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:"Chn mt rule  xem chi tit"})})]}),b&&t.jsx(tA,{khoanLuongs:o,onClose:()=>j(!1),onAdd:Z}),t.jsx(GD,{isOpen:T,onClose:()=>S(!1),phongBanId:a.phongBanId,quyCheId:a.id,onRuleApplied:R})]}):t.jsx("div",{className:"p-6 text-center text-gray-500",children:"Khng tm thy quy ch"})}function tA({khoanLuongs:e,onClose:n,onAdd:a}){var l;const[r,s]=D.useState({khoanLuongId:((l=e[0])==null?void 0:l.id)||0,tenRule:"",loaiRule:"CO_DINH"});return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[t.jsx("div",{className:"px-6 py-4 border-b",children:t.jsx("h3",{className:"text-lg font-semibold",children:"Thm Rule mi"})}),t.jsxs("div",{className:"px-6 py-4 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn rule"}),t.jsx("input",{type:"text",value:r.tenRule,onChange:o=>s({...r,tenRule:o.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ph cp trch nhim t trng"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Khon lng"}),t.jsx("select",{value:r.khoanLuongId,onChange:o=>s({...r,khoanLuongId:Number(o.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:e.map(o=>t.jsxs("option",{value:o.id,children:[o.tenKhoan," (",o.loai==="THU_NHAP"?"+":"-",")"]},o.id))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi rule"}),t.jsx("select",{value:r.loaiRule,onChange:o=>s({...r,loaiRule:o.target.value}),className:"w-full border rounded-lg px-3 py-2",children:Object.entries(pg).map(([o,d])=>t.jsx("option",{value:o,children:d},o))})]})]}),t.jsxs("div",{className:"px-6 py-4 border-t flex justify-end gap-3",children:[t.jsx("button",{onClick:n,className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:()=>a(r),disabled:!r.tenRule||!r.khoanLuongId,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Thm rule"})]})]})})}const Nf={NHAP:{label:"Nhp",color:"bg-gray-100 text-gray-800"},DA_DUYET:{label:" duyt",color:"bg-green-100 text-green-800"},TU_CHOI:{label:"T chi",color:"bg-red-100 text-red-800"},HUY:{label:"Hu",color:"bg-gray-400 text-white"}},Cd={THUONG:{label:"Thng",color:"bg-green-100 text-green-800",icon:""},PHAT:{label:"Pht",color:"bg-red-100 text-red-800",icon:""}};function nA(){const[e,n]=D.useState([]),[a,r]=D.useState([]),[s,l]=D.useState([]),[o,d]=D.useState([]),[u,x]=D.useState(!0),[m,f]=D.useState(!1),[p,N]=D.useState(!1),[y,g]=D.useState([]),[b,j]=D.useState({}),[T,S]=D.useState({nhanVienId:0,phongBanId:0,ngay:new Date().toISOString().split("T")[0],loaiSuKien:"THUONG",maSuKien:"",giaTri:1,soTien:0,ghiChu:""}),[w,_]=D.useState({maSuKien:"",tenSuKien:"",loai:"THUONG",moTa:"",soTienMacDinh:0});D.useEffect(()=>{E()},[]);const E=async()=>{x(!0);try{const te={...b,tuNgay:b.tuNgay?new Date(b.tuNgay):void 0,denNgay:b.denNgay?new Date(b.denNgay):void 0},[Z,Q,fe,K]=await Promise.all([Al.layDanhSach(te),Al.layDanhMucSuKien(),Jt.layTatCa(),ha.layTatCa()]);n(Array.isArray(Z)?Z:[]),r(Q),l(fe);const L="data"in K?K.data:K;d(Array.isArray(L)?L:[])}catch(te){console.error("Li load d liu:",te)}finally{x(!1)}},C=()=>{E()},P=async()=>{try{await Al.tao({...T,ngay:new Date(T.ngay)}),f(!1),E(),q()}catch(te){console.error("Li to s kin:",te),alert("Li to s kin")}},F=async te=>{try{await Al.duyet(te,{trangThai:"DA_DUYET"}),E()}catch(Z){console.error("Li duyt:",Z),alert("Li duyt s kin")}},R=async te=>{const Z=prompt("L do t chi:");if(Z)try{await Al.duyet(te,{trangThai:"TU_CHOI",lyDo:Z}),E()}catch(Q){console.error("Li t chi:",Q)}},O=async()=>{if(y.length!==0&&confirm(`Duyt ${y.length} s kin?`))try{await Al.duyetNhieu({danhSachId:y,trangThai:"DA_DUYET"}),g([]),E()}catch(te){console.error("Li duyt nhiu:",te)}},M=async()=>{try{await Al.taoDanhMucSuKien(w),N(!1),E(),_({maSuKien:"",tenSuKien:"",loai:"THUONG",moTa:"",soTienMacDinh:0})}catch(te){console.error("Li to danh mc:",te),alert("Li to danh mc")}},q=()=>{S({nhanVienId:0,phongBanId:0,ngay:new Date().toISOString().split("T")[0],loaiSuKien:"THUONG",maSuKien:"",giaTri:1,soTien:0,ghiChu:""})},J=te=>{g(Z=>Z.includes(te)?Z.filter(Q=>Q!==te):[...Z,te])},B=()=>{const te=e.filter(Z=>Z.trangThai==="NHAP").map(Z=>Z.id);y.length===te.length?g([]):g(te)},ue=te=>{const Z=a.find(Q=>Q.maSuKien===te);S({...T,maSuKien:te,loaiSuKien:(Z==null?void 0:Z.loai)||"THUONG",soTien:(Z==null?void 0:Z.soTienMacDinh)||0})};return u?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}):t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"S kin Thng/Pht"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Qun l cc s kin thng, pht cho nhn vin"})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>N(!0),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Danh mc s kin"}),t.jsxs("button",{onClick:()=>f(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[t.jsx(Dt,{size:18}),"Thm s kin"]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban"}),t.jsxs("select",{value:b.phongBanId||"",onChange:te=>j({...b,phongBanId:Number(te.target.value)||void 0}),className:"border rounded-lg px-3 py-2 w-48",children:[t.jsx("option",{value:"",children:"Tt c"}),s.map(te=>t.jsx("option",{value:te.id,children:te.tenPhongBan},te.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Loi"}),t.jsxs("select",{value:b.loaiSuKien||"",onChange:te=>j({...b,loaiSuKien:te.target.value||void 0}),className:"border rounded-lg px-3 py-2 w-32",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"THUONG",children:"Thng"}),t.jsx("option",{value:"PHAT",children:"Pht"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Trng thi"}),t.jsxs("select",{value:b.trangThai||"",onChange:te=>j({...b,trangThai:te.target.value||void 0}),className:"border rounded-lg px-3 py-2 w-32",children:[t.jsx("option",{value:"",children:"Tt c"}),Object.entries(Nf).map(([te,{label:Z}])=>t.jsx("option",{value:te,children:Z},te))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"T ngy"}),t.jsx(Ut,{value:b.tuNgay||"",onChange:te=>j({...b,tuNgay:te}),className:"border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"n ngy"}),t.jsx(Ut,{value:b.denNgay||"",onChange:te=>j({...b,denNgay:te}),className:"border rounded-lg px-3 py-2"})]}),t.jsxs("button",{onClick:C,className:"px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 flex items-center gap-2",children:[t.jsx(tg,{size:16}),"Lc"]})]})}),y.length>0&&t.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 mb-4 flex items-center justify-between",children:[t.jsxs("span",{className:"text-blue-800",children:[" chn ",y.length," s kin"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:O,className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 text-sm",children:"Duyt tt c"}),t.jsx("button",{onClick:()=>g([]),className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 text-sm",children:"B chn"})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left w-10",children:t.jsx("input",{type:"checkbox",checked:e.filter(te=>te.trangThai==="NHAP").length>0&&y.length===e.filter(te=>te.trangThai==="NHAP").length,onChange:B})}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Ngy"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Loi"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M s kin"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"Gi tr"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"S tin"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Thao tc"})]})}),t.jsxs("tbody",{children:[e.map(te=>{var Z,Q,fe;return t.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3",children:te.trangThai==="NHAP"&&t.jsx("input",{type:"checkbox",checked:y.includes(te.id),onChange:()=>J(te.id)})}),t.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(te.ngay).toLocaleDateString("vi-VN")}),t.jsxs("td",{className:"px-4 py-3",children:[t.jsx("div",{className:"text-sm font-medium",children:(Z=te.nhanVien)==null?void 0:Z.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:(Q=te.nhanVien)==null?void 0:Q.maNhanVien})]}),t.jsx("td",{className:"px-4 py-3 text-sm",children:(fe=te.phongBan)==null?void 0:fe.tenPhongBan}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("span",{className:`px-2 py-1 rounded text-xs ${Cd[te.loaiSuKien].color}`,children:[Cd[te.loaiSuKien].icon," ",Cd[te.loaiSuKien].label]})}),t.jsx("td",{className:"px-4 py-3 text-sm font-mono",children:te.maSuKien}),t.jsx("td",{className:"px-4 py-3 text-sm text-right",children:te.giaTri}),t.jsxs("td",{className:"px-4 py-3 text-sm text-right font-mono",children:[new Intl.NumberFormat("vi-VN").format(te.soTien),""]}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded text-xs ${Nf[te.trangThai].color}`,children:Nf[te.trangThai].label})}),t.jsx("td",{className:"px-4 py-3 text-center",children:te.trangThai==="NHAP"&&t.jsxs("div",{className:"flex justify-center gap-1",children:[t.jsx("button",{onClick:()=>F(te.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Duyt",children:t.jsx(Br,{size:16})}),t.jsx("button",{onClick:()=>R(te.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"T chi",children:t.jsx(mn,{size:16})})]})})]},te.id)}),e.length===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:10,className:"px-4 py-10 text-center text-gray-500",children:"Khng c s kin no"})})]})]})}),m&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg",children:[t.jsx("div",{className:"px-6 py-4 border-b",children:t.jsx("h3",{className:"text-lg font-semibold",children:"Thm s kin Thng/Pht"})}),t.jsxs("div",{className:"px-6 py-4 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nhn vin"}),t.jsxs("select",{value:T.nhanVienId,onChange:te=>{const Z=o.find(Q=>Q.id===Number(te.target.value));S({...T,nhanVienId:Number(te.target.value),phongBanId:(Z==null?void 0:Z.phongBanId)||T.phongBanId})},className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn --"}),o.map(te=>t.jsxs("option",{value:te.id,children:[te.hoTen," (",te.maNhanVien,")"]},te.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy"}),t.jsx(Ut,{value:T.ngay,onChange:te=>S({...T,ngay:te}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi s kin"}),t.jsxs("select",{value:T.maSuKien,onChange:te=>ue(te.target.value),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn s kin --"}),t.jsx("optgroup",{label:"Thng",children:a.filter(te=>te.loai==="THUONG").map(te=>t.jsxs("option",{value:te.maSuKien,children:[te.tenSuKien," (",te.maSuKien,")"]},te.maSuKien))}),t.jsx("optgroup",{label:"Pht",children:a.filter(te=>te.loai==="PHAT").map(te=>t.jsxs("option",{value:te.maSuKien,children:[te.tenSuKien," (",te.maSuKien,")"]},te.maSuKien))})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi tr (ln/ngy/...)"}),t.jsx("input",{type:"number",value:T.giaTri,onChange:te=>S({...T,giaTri:Number(te.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:1})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S tin"}),t.jsx("input",{type:"number",value:T.soTien,onChange:te=>S({...T,soTien:Number(te.target.value)}),className:"w-full border rounded-lg px-3 py-2"}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[new Intl.NumberFormat("vi-VN").format(T.soTien),""]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),t.jsx("textarea",{value:T.ghiChu,onChange:te=>S({...T,ghiChu:te.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"px-6 py-4 border-t flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{f(!1),q()},className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:P,disabled:!T.nhanVienId||!T.maSuKien,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Thm s kin"})]})]})}),p&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[80vh] flex flex-col",children:[t.jsxs("div",{className:"px-6 py-4 border-b flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Danh mc S kin"}),t.jsx("button",{onClick:()=>N(!1),className:"p-2 hover:bg-gray-100 rounded",children:t.jsx(mn,{size:20})})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[t.jsx("h4",{className:"font-medium mb-3",children:"Thm danh mc mi"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsx("input",{type:"text",placeholder:"M s kin",value:w.maSuKien,onChange:te=>_({...w,maSuKien:te.target.value}),className:"border rounded px-3 py-2"}),t.jsx("input",{type:"text",placeholder:"Tn s kin",value:w.tenSuKien,onChange:te=>_({...w,tenSuKien:te.target.value}),className:"border rounded px-3 py-2"}),t.jsxs("select",{value:w.loai,onChange:te=>_({...w,loai:te.target.value}),className:"border rounded px-3 py-2",children:[t.jsx("option",{value:"THUONG",children:"Thng"}),t.jsx("option",{value:"PHAT",children:"Pht"})]}),t.jsx("input",{type:"number",placeholder:"S tin mc nh",value:w.soTienMacDinh||"",onChange:te=>_({...w,soTienMacDinh:Number(te.target.value)}),className:"border rounded px-3 py-2"})]}),t.jsx("div",{className:"mt-3 flex justify-end",children:t.jsx("button",{onClick:M,disabled:!w.maSuKien||!w.tenSuKien,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:"Thm"})})]}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-100",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-3 py-2 text-left text-sm",children:"M"}),t.jsx("th",{className:"px-3 py-2 text-left text-sm",children:"Tn"}),t.jsx("th",{className:"px-3 py-2 text-left text-sm",children:"Loi"}),t.jsx("th",{className:"px-3 py-2 text-right text-sm",children:"S tin mc nh"})]})}),t.jsx("tbody",{children:a.map(te=>t.jsxs("tr",{className:"border-t",children:[t.jsx("td",{className:"px-3 py-2 font-mono text-sm",children:te.maSuKien}),t.jsx("td",{className:"px-3 py-2",children:te.tenSuKien}),t.jsx("td",{className:"px-3 py-2",children:t.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Cd[te.loai].color}`,children:Cd[te.loai].label})}),t.jsx("td",{className:"px-3 py-2 text-right font-mono",children:te.soTienMacDinh?new Intl.NumberFormat("vi-VN").format(te.soTienMacDinh)+"":"-"})]},te.id))})]})]})]})})]})}const aA={CO_DINH:"C nh",THEO_HE_SO:"Theo h s",BAC_THANG:"Bc thang",THEO_SU_KIEN:"Theo s kin",CONG_THUC:"Cng thc"};function rA(){const[e]=T3(),n=Number(e.get("bangLuongId"))||0,[a,r]=D.useState(null),[s,l]=D.useState([]),[o,d]=D.useState(!0),[u,x]=D.useState(""),[m,f]=D.useState([]);D.useEffect(()=>{n&&p()},[n]);const p=async()=>{d(!0);try{const[j,T]=await Promise.all([Or.layTheoId(n),UD.xemTrace(n)]);r(j),l(T)}catch(j){console.error("Li load d liu:",j)}finally{d(!1)}},N=s.reduce((j,T)=>{const S=T.nhanVienId;return j[S]||(j[S]={nhanVien:T.nhanVien,traces:[]}),j[S].traces.push(T),j},{}),y=Object.entries(N).filter(([j,T])=>{var w,_;if(!u)return!0;const S=u.toLowerCase();return((w=T.nhanVien)==null?void 0:w.hoTen.toLowerCase().includes(S))||((_=T.nhanVien)==null?void 0:_.maNhanVien.toLowerCase().includes(S))}),g=j=>{f(T=>T.includes(j)?T.filter(S=>S!==j):[...T,j])},b=j=>new Intl.NumberFormat("vi-VN").format(j);return o?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}):t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[t.jsx(ua,{to:`/bang-luong/${n}`,className:"p-2 hover:bg-gray-100 rounded",children:t.jsx(Q0,{size:20})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Rule Trace - Gii trnh tnh lng"}),a&&t.jsxs("p",{className:"text-gray-500 mt-1",children:[a.phongBan.tenPhongBan," - Thng ",a.thang,"/",a.nam]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:t.jsxs("div",{className:"relative",children:[t.jsx(Vr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),t.jsx("input",{type:"text",placeholder:"Tm theo tn hoc m nhn vin...",value:u,onChange:j=>x(j.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]})}),t.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 mb-6 flex items-center justify-between",children:[t.jsx("div",{children:t.jsxs("span",{className:"text-blue-800",children:["Tng: ",Object.keys(N).length," nhn vin, ",s.length," dng trace"]})}),t.jsx("button",{onClick:()=>{m.length===Object.keys(N).length?f([]):f(Object.keys(N).map(Number))},className:"text-sm text-blue-600 hover:underline",children:m.length===Object.keys(N).length?"Thu gn tt c":"M rng tt c"})]}),t.jsxs("div",{className:"space-y-4",children:[y.map(([j,T])=>{var E,C;const S=Number(j),w=m.includes(S),_=T.traces.reduce((P,F)=>P+F.outputSoTien,0);return t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsxs("button",{onClick:()=>g(S),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-gray-50",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[w?t.jsx(Ja,{size:18,className:"text-gray-400"}):t.jsx(qn,{size:18,className:"text-gray-400"}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"font-medium",children:(E=T.nhanVien)==null?void 0:E.hoTen}),t.jsx("div",{className:"text-sm text-gray-500",children:(C=T.nhanVien)==null?void 0:C.maNhanVien})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"font-medium text-blue-600",children:[b(_),""]}),t.jsxs("div",{className:"text-sm text-gray-500",children:[T.traces.length," rules"]})]})]}),w&&t.jsx("div",{className:"border-t",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Quy ch"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Rule"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Khon lng"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500",children:"S tin"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Gii thch"})]})}),t.jsx("tbody",{children:T.traces.map(P=>{var F,R,O,M,q,J;return t.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[t.jsxs("td",{className:"px-4 py-2",children:[t.jsx("div",{className:"text-sm",children:(F=P.quyChe)==null?void 0:F.tenQuyChe}),t.jsxs("div",{className:"text-xs text-gray-500",children:["v",(R=P.quyChe)==null?void 0:R.phienBan]})]}),t.jsx("td",{className:"px-4 py-2",children:P.quyCheRule?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-sm",children:P.quyCheRule.tenRule}),t.jsx("div",{className:"text-xs text-gray-500",children:aA[P.quyCheRule.loaiRule]})]}):t.jsx("span",{className:"text-gray-400 text-sm",children:"-"})}),t.jsxs("td",{className:"px-4 py-2",children:[t.jsx("div",{className:"text-sm",children:(O=P.khoanLuong)==null?void 0:O.tenKhoan}),t.jsx("div",{className:"text-xs text-gray-500",children:(M=P.khoanLuong)==null?void 0:M.maKhoan})]}),t.jsx("td",{className:"px-4 py-2 text-right",children:t.jsxs("span",{className:`font-mono text-sm ${((q=P.khoanLuong)==null?void 0:q.loai)==="KHAU_TRU"?"text-red-600":"text-green-600"}`,children:[((J=P.khoanLuong)==null?void 0:J.loai)==="KHAU_TRU"?"-":"+",b(P.outputSoTien),""]})}),t.jsxs("td",{className:"px-4 py-2",children:[t.jsx("div",{className:"text-sm text-gray-600",children:P.messageGiaiThich}),P.inputJson&&t.jsxs("details",{className:"mt-1",children:[t.jsx("summary",{className:"text-xs text-blue-600 cursor-pointer",children:"Xem input"}),t.jsx("pre",{className:"mt-1 text-xs bg-gray-100 p-2 rounded overflow-x-auto",children:JSON.stringify(JSON.parse(P.inputJson),null,2)})]})]})]},P.id)})})]})})]},S)}),y.length===0&&t.jsx("div",{className:"text-center text-gray-500 py-10",children:"Khng c d liu trace"})]})]})}var jf={exports:{}},wf,$b;function sA(){if($b)return wf;$b=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return wf=e,wf}var kf,Gb;function iA(){if(Gb)return kf;Gb=1;var e=sA();function n(){}function a(){}return a.resetWarningCache=n,kf=function(){function r(o,d,u,x,m,f){if(f!==e){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}r.isRequired=r;function s(){return r}var l={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:s,element:r,elementType:r,instanceOf:s,node:r,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:a,resetWarningCache:n};return l.PropTypes=l,l},kf}var qb;function lA(){return qb||(qb=1,jf.exports=iA()()),jf.exports}var oA=lA();const Yt=Vp(oA);function fo(e,n,a,r){function s(l){return l instanceof a?l:new a(function(o){o(l)})}return new(a||(a=Promise))(function(l,o){function d(m){try{x(r.next(m))}catch(f){o(f)}}function u(m){try{x(r.throw(m))}catch(f){o(f)}}function x(m){m.done?l(m.value):s(m.value).then(d,u)}x((r=r.apply(e,n||[])).next())})}const cA=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function Cc(e,n,a){const r=dA(e),{webkitRelativePath:s}=e,l=typeof n=="string"?n:typeof s=="string"&&s.length>0?s:`./${e.name}`;return typeof r.path!="string"&&Wb(r,"path",l),Wb(r,"relativePath",l),r}function dA(e){const{name:n}=e;if(n&&n.lastIndexOf(".")!==-1&&!e.type){const r=n.split(".").pop().toLowerCase(),s=cA.get(r);s&&Object.defineProperty(e,"type",{value:s,writable:!1,configurable:!1,enumerable:!0})}return e}function Wb(e,n,a){Object.defineProperty(e,n,{value:a,writable:!1,configurable:!1,enumerable:!0})}const uA=[".DS_Store","Thumbs.db"];function hA(e){return fo(this,void 0,void 0,function*(){return T0(e)&&xA(e.dataTransfer)?gA(e.dataTransfer,e.type):mA(e)?fA(e):Array.isArray(e)&&e.every(n=>"getFile"in n&&typeof n.getFile=="function")?pA(e):[]})}function xA(e){return T0(e)}function mA(e){return T0(e)&&T0(e.target)}function T0(e){return typeof e=="object"&&e!==null}function fA(e){return wp(e.target.files).map(n=>Cc(n))}function pA(e){return fo(this,void 0,void 0,function*(){return(yield Promise.all(e.map(a=>a.getFile()))).map(a=>Cc(a))})}function gA(e,n){return fo(this,void 0,void 0,function*(){if(e.items){const a=wp(e.items).filter(s=>s.kind==="file");if(n!=="drop")return a;const r=yield Promise.all(a.map(yA));return Xb(mw(r))}return Xb(wp(e.files).map(a=>Cc(a)))})}function Xb(e){return e.filter(n=>uA.indexOf(n.name)===-1)}function wp(e){if(e===null)return[];const n=[];for(let a=0;a<e.length;a++){const r=e[a];n.push(r)}return n}function yA(e){if(typeof e.webkitGetAsEntry!="function")return Qb(e);const n=e.webkitGetAsEntry();return n&&n.isDirectory?fw(n):Qb(e,n)}function mw(e){return e.reduce((n,a)=>[...n,...Array.isArray(a)?mw(a):[a]],[])}function Qb(e,n){return fo(this,void 0,void 0,function*(){var a;if(globalThis.isSecureContext&&typeof e.getAsFileSystemHandle=="function"){const l=yield e.getAsFileSystemHandle();if(l===null)throw new Error(`${e} is not a File`);if(l!==void 0){const o=yield l.getFile();return o.handle=l,Cc(o)}}const r=e.getAsFile();if(!r)throw new Error(`${e} is not a File`);return Cc(r,(a=n==null?void 0:n.fullPath)!==null&&a!==void 0?a:void 0)})}function vA(e){return fo(this,void 0,void 0,function*(){return e.isDirectory?fw(e):bA(e)})}function fw(e){const n=e.createReader();return new Promise((a,r)=>{const s=[];function l(){n.readEntries(o=>fo(this,void 0,void 0,function*(){if(o.length){const d=Promise.all(o.map(vA));s.push(d),l()}else try{const d=yield Promise.all(s);a(d)}catch(d){r(d)}}),o=>{r(o)})}l()})}function bA(e){return fo(this,void 0,void 0,function*(){return new Promise((n,a)=>{e.file(r=>{const s=Cc(r,e.fullPath);n(s)},r=>{a(r)})})})}var Wh={},Yb;function NA(){return Yb||(Yb=1,Wh.__esModule=!0,Wh.default=function(e,n){if(e&&n){var a=Array.isArray(n)?n:n.split(",");if(a.length===0)return!0;var r=e.name||"",s=(e.type||"").toLowerCase(),l=s.replace(/\/.*$/,"");return a.some(function(o){var d=o.trim().toLowerCase();return d.charAt(0)==="."?r.toLowerCase().endsWith(d):d.endsWith("/*")?l===d.replace(/\/.*$/,""):s===d})}return!0}),Wh}var jA=NA();const Tf=Vp(jA);function Jb(e){return TA(e)||kA(e)||gw(e)||wA()}function wA(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kA(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function TA(e){if(Array.isArray(e))return kp(e)}function Zb(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),a.push.apply(a,r)}return a}function eN(e){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?Zb(Object(a),!0).forEach(function(r){pw(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Zb(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function pw(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function Qd(e,n){return _A(e)||SA(e,n)||gw(e,n)||CA()}function CA(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gw(e,n){if(e){if(typeof e=="string")return kp(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return kp(e,n)}}function kp(e,n){(n==null||n>e.length)&&(n=e.length);for(var a=0,r=new Array(n);a<n;a++)r[a]=e[a];return r}function SA(e,n){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var r=[],s=!0,l=!1,o,d;try{for(a=a.call(e);!(s=(o=a.next()).done)&&(r.push(o.value),!(n&&r.length===n));s=!0);}catch(u){l=!0,d=u}finally{try{!s&&a.return!=null&&a.return()}finally{if(l)throw d}}return r}}function _A(e){if(Array.isArray(e))return e}var EA=typeof Tf=="function"?Tf:Tf.default,DA="file-invalid-type",AA="file-too-large",FA="file-too-small",LA="too-many-files",PA=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=n.split(","),r=a.length>1?"one of ".concat(a.join(", ")):a[0];return{code:DA,message:"File type must be ".concat(r)}},tN=function(n){return{code:AA,message:"File is larger than ".concat(n," ").concat(n===1?"byte":"bytes")}},nN=function(n){return{code:FA,message:"File is smaller than ".concat(n," ").concat(n===1?"byte":"bytes")}},IA={code:LA,message:"Too many files"};function yw(e,n){var a=e.type==="application/x-moz-file"||EA(e,n);return[a,a?null:PA(n)]}function vw(e,n,a){if(Ml(e.size))if(Ml(n)&&Ml(a)){if(e.size>a)return[!1,tN(a)];if(e.size<n)return[!1,nN(n)]}else{if(Ml(n)&&e.size<n)return[!1,nN(n)];if(Ml(a)&&e.size>a)return[!1,tN(a)]}return[!0,null]}function Ml(e){return e!=null}function OA(e){var n=e.files,a=e.accept,r=e.minSize,s=e.maxSize,l=e.multiple,o=e.maxFiles,d=e.validator;return!l&&n.length>1||l&&o>=1&&n.length>o?!1:n.every(function(u){var x=yw(u,a),m=Qd(x,1),f=m[0],p=vw(u,r,s),N=Qd(p,1),y=N[0],g=d?d(u):null;return f&&y&&!g})}function C0(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function Xh(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(n){return n==="Files"||n==="application/x-moz-file"}):!!e.target&&!!e.target.files}function aN(e){e.preventDefault()}function MA(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function RA(e){return e.indexOf("Edge/")!==-1}function BA(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return MA(e)||RA(e)}function ms(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return function(r){for(var s=arguments.length,l=new Array(s>1?s-1:0),o=1;o<s;o++)l[o-1]=arguments[o];return n.some(function(d){return!C0(r)&&d&&d.apply(void 0,[r].concat(l)),C0(r)})}}function HA(){return"showOpenFilePicker"in window}function VA(e){if(Ml(e)){var n=Object.entries(e).filter(function(a){var r=Qd(a,2),s=r[0],l=r[1],o=!0;return bw(s)||(console.warn('Skipped "'.concat(s,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),o=!1),(!Array.isArray(l)||!l.every(Nw))&&(console.warn('Skipped "'.concat(s,'" because an invalid file extension was provided.')),o=!1),o}).reduce(function(a,r){var s=Qd(r,2),l=s[0],o=s[1];return eN(eN({},a),{},pw({},l,o))},{});return[{description:"Files",accept:n}]}return e}function UA(e){if(Ml(e))return Object.entries(e).reduce(function(n,a){var r=Qd(a,2),s=r[0],l=r[1];return[].concat(Jb(n),[s],Jb(l))},[]).filter(function(n){return bw(n)||Nw(n)}).join(",")}function KA(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function zA(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function bw(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||e==="application/*"||/\w+\/[-+.\w]+/g.test(e)}function Nw(e){return/^.*\.[\w]+$/.test(e)}var $A=["children"],GA=["open"],qA=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],WA=["refKey","onChange","onClick"];function XA(e){return JA(e)||YA(e)||jw(e)||QA()}function QA(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YA(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function JA(e){if(Array.isArray(e))return Tp(e)}function Cf(e,n){return tF(e)||eF(e,n)||jw(e,n)||ZA()}function ZA(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jw(e,n){if(e){if(typeof e=="string")return Tp(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Tp(e,n)}}function Tp(e,n){(n==null||n>e.length)&&(n=e.length);for(var a=0,r=new Array(n);a<n;a++)r[a]=e[a];return r}function eF(e,n){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var r=[],s=!0,l=!1,o,d;try{for(a=a.call(e);!(s=(o=a.next()).done)&&(r.push(o.value),!(n&&r.length===n));s=!0);}catch(u){l=!0,d=u}finally{try{!s&&a.return!=null&&a.return()}finally{if(l)throw d}}return r}}function tF(e){if(Array.isArray(e))return e}function rN(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),a.push.apply(a,r)}return a}function yn(e){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?rN(Object(a),!0).forEach(function(r){Cp(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):rN(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function Cp(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function S0(e,n){if(e==null)return{};var a=nF(e,n),r,s;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(s=0;s<l.length;s++)r=l[s],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function nF(e,n){if(e==null)return{};var a={},r=Object.keys(e),s,l;for(l=0;l<r.length;l++)s=r[l],!(n.indexOf(s)>=0)&&(a[s]=e[s]);return a}var gg=D.forwardRef(function(e,n){var a=e.children,r=S0(e,$A),s=yg(r),l=s.open,o=S0(s,GA);return D.useImperativeHandle(n,function(){return{open:l}},[l]),D2.createElement(D.Fragment,null,a(yn(yn({},o),{},{open:l})))});gg.displayName="Dropzone";var ww={disabled:!1,getFilesFromEvent:hA,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};gg.defaultProps=ww;gg.propTypes={children:Yt.func,accept:Yt.objectOf(Yt.arrayOf(Yt.string)),multiple:Yt.bool,preventDropOnDocument:Yt.bool,noClick:Yt.bool,noKeyboard:Yt.bool,noDrag:Yt.bool,noDragEventsBubbling:Yt.bool,minSize:Yt.number,maxSize:Yt.number,maxFiles:Yt.number,disabled:Yt.bool,getFilesFromEvent:Yt.func,onFileDialogCancel:Yt.func,onFileDialogOpen:Yt.func,useFsAccessApi:Yt.bool,autoFocus:Yt.bool,onDragEnter:Yt.func,onDragLeave:Yt.func,onDragOver:Yt.func,onDrop:Yt.func,onDropAccepted:Yt.func,onDropRejected:Yt.func,onError:Yt.func,validator:Yt.func};var Sp={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function yg(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=yn(yn({},ww),e),a=n.accept,r=n.disabled,s=n.getFilesFromEvent,l=n.maxSize,o=n.minSize,d=n.multiple,u=n.maxFiles,x=n.onDragEnter,m=n.onDragLeave,f=n.onDragOver,p=n.onDrop,N=n.onDropAccepted,y=n.onDropRejected,g=n.onFileDialogCancel,b=n.onFileDialogOpen,j=n.useFsAccessApi,T=n.autoFocus,S=n.preventDropOnDocument,w=n.noClick,_=n.noKeyboard,E=n.noDrag,C=n.noDragEventsBubbling,P=n.onError,F=n.validator,R=D.useMemo(function(){return UA(a)},[a]),O=D.useMemo(function(){return VA(a)},[a]),M=D.useMemo(function(){return typeof b=="function"?b:sN},[b]),q=D.useMemo(function(){return typeof g=="function"?g:sN},[g]),J=D.useRef(null),B=D.useRef(null),ue=D.useReducer(aF,Sp),te=Cf(ue,2),Z=te[0],Q=te[1],fe=Z.isFocused,K=Z.isFileDialogActive,L=D.useRef(typeof window<"u"&&window.isSecureContext&&j&&HA()),X=function(){!L.current&&K&&setTimeout(function(){if(B.current){var Qe=B.current.files;Qe.length||(Q({type:"closeDialog"}),q())}},300)};D.useEffect(function(){return window.addEventListener("focus",X,!1),function(){window.removeEventListener("focus",X,!1)}},[B,K,q,L]);var I=D.useRef([]),W=function(Qe){J.current&&J.current.contains(Qe.target)||(Qe.preventDefault(),I.current=[])};D.useEffect(function(){return S&&(document.addEventListener("dragover",aN,!1),document.addEventListener("drop",W,!1)),function(){S&&(document.removeEventListener("dragover",aN),document.removeEventListener("drop",W))}},[J,S]),D.useEffect(function(){return!r&&T&&J.current&&J.current.focus(),function(){}},[J,T,r]);var z=D.useCallback(function(Be){P?P(Be):console.error(Be)},[P]),xe=D.useCallback(function(Be){Be.preventDefault(),Be.persist(),hn(Be),I.current=[].concat(XA(I.current),[Be.target]),Xh(Be)&&Promise.resolve(s(Be)).then(function(Qe){if(!(C0(Be)&&!C)){var Ct=Qe.length,Ht=Ct>0&&OA({files:Qe,accept:R,minSize:o,maxSize:l,multiple:d,maxFiles:u,validator:F}),kt=Ct>0&&!Ht;Q({isDragAccept:Ht,isDragReject:kt,isDragActive:!0,type:"setDraggedFiles"}),x&&x(Be)}}).catch(function(Qe){return z(Qe)})},[s,x,z,C,R,o,l,d,u,F]),H=D.useCallback(function(Be){Be.preventDefault(),Be.persist(),hn(Be);var Qe=Xh(Be);if(Qe&&Be.dataTransfer)try{Be.dataTransfer.dropEffect="copy"}catch{}return Qe&&f&&f(Be),!1},[f,C]),ne=D.useCallback(function(Be){Be.preventDefault(),Be.persist(),hn(Be);var Qe=I.current.filter(function(Ht){return J.current&&J.current.contains(Ht)}),Ct=Qe.indexOf(Be.target);Ct!==-1&&Qe.splice(Ct,1),I.current=Qe,!(Qe.length>0)&&(Q({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),Xh(Be)&&m&&m(Be))},[J,m,C]),oe=D.useCallback(function(Be,Qe){var Ct=[],Ht=[];Be.forEach(function(kt){var fn=yw(kt,R),ot=Cf(fn,2),Bt=ot[0],Xn=ot[1],en=vw(kt,o,l),Ea=Cf(en,2),mi=Ea[0],Ps=Ea[1],Is=F?F(kt):null;if(Bt&&mi&&!Is)Ct.push(kt);else{var ls=[Xn,Ps];Is&&(ls=ls.concat(Is)),Ht.push({file:kt,errors:ls.filter(function(fi){return fi})})}}),(!d&&Ct.length>1||d&&u>=1&&Ct.length>u)&&(Ct.forEach(function(kt){Ht.push({file:kt,errors:[IA]})}),Ct.splice(0)),Q({acceptedFiles:Ct,fileRejections:Ht,isDragReject:Ht.length>0,type:"setFiles"}),p&&p(Ct,Ht,Qe),Ht.length>0&&y&&y(Ht,Qe),Ct.length>0&&N&&N(Ct,Qe)},[Q,d,R,o,l,u,p,N,y,F]),Se=D.useCallback(function(Be){Be.preventDefault(),Be.persist(),hn(Be),I.current=[],Xh(Be)&&Promise.resolve(s(Be)).then(function(Qe){C0(Be)&&!C||oe(Qe,Be)}).catch(function(Qe){return z(Qe)}),Q({type:"reset"})},[s,oe,z,C]),V=D.useCallback(function(){if(L.current){Q({type:"openDialog"}),M();var Be={multiple:d,types:O};window.showOpenFilePicker(Be).then(function(Qe){return s(Qe)}).then(function(Qe){oe(Qe,null),Q({type:"closeDialog"})}).catch(function(Qe){KA(Qe)?(q(Qe),Q({type:"closeDialog"})):zA(Qe)?(L.current=!1,B.current?(B.current.value=null,B.current.click()):z(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):z(Qe)});return}B.current&&(Q({type:"openDialog"}),M(),B.current.value=null,B.current.click())},[Q,M,q,j,oe,z,O,d]),be=D.useCallback(function(Be){!J.current||!J.current.isEqualNode(Be.target)||(Be.key===" "||Be.key==="Enter"||Be.keyCode===32||Be.keyCode===13)&&(Be.preventDefault(),V())},[J,V]),Oe=D.useCallback(function(){Q({type:"focus"})},[]),tt=D.useCallback(function(){Q({type:"blur"})},[]),Je=D.useCallback(function(){w||(BA()?setTimeout(V,0):V())},[w,V]),Re=function(Qe){return r?null:Qe},Rt=function(Qe){return _?null:Re(Qe)},un=function(Qe){return E?null:Re(Qe)},hn=function(Qe){C&&Qe.stopPropagation()},Cn=D.useMemo(function(){return function(){var Be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Qe=Be.refKey,Ct=Qe===void 0?"ref":Qe,Ht=Be.role,kt=Be.onKeyDown,fn=Be.onFocus,ot=Be.onBlur,Bt=Be.onClick,Xn=Be.onDragEnter,en=Be.onDragOver,Ea=Be.onDragLeave,mi=Be.onDrop,Ps=S0(Be,qA);return yn(yn(Cp({onKeyDown:Rt(ms(kt,be)),onFocus:Rt(ms(fn,Oe)),onBlur:Rt(ms(ot,tt)),onClick:Re(ms(Bt,Je)),onDragEnter:un(ms(Xn,xe)),onDragOver:un(ms(en,H)),onDragLeave:un(ms(Ea,ne)),onDrop:un(ms(mi,Se)),role:typeof Ht=="string"&&Ht!==""?Ht:"presentation"},Ct,J),!r&&!_?{tabIndex:0}:{}),Ps)}},[J,be,Oe,tt,Je,xe,H,ne,Se,_,E,r]),Ha=D.useCallback(function(Be){Be.stopPropagation()},[]),Bn=D.useMemo(function(){return function(){var Be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Qe=Be.refKey,Ct=Qe===void 0?"ref":Qe,Ht=Be.onChange,kt=Be.onClick,fn=S0(Be,WA),ot=Cp({accept:R,multiple:d,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:Re(ms(Ht,Se)),onClick:Re(ms(kt,Ha)),tabIndex:-1},Ct,B);return yn(yn({},ot),fn)}},[B,a,d,Se,r]);return yn(yn({},Z),{},{isFocused:fe&&!r,getRootProps:Cn,getInputProps:Bn,rootRef:J,inputRef:B,open:Re(V)})}function aF(e,n){switch(n.type){case"focus":return yn(yn({},e),{},{isFocused:!0});case"blur":return yn(yn({},e),{},{isFocused:!1});case"openDialog":return yn(yn({},Sp),{},{isFileDialogActive:!0});case"closeDialog":return yn(yn({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return yn(yn({},e),{},{isDragActive:n.isDragActive,isDragAccept:n.isDragAccept,isDragReject:n.isDragReject});case"setFiles":return yn(yn({},e),{},{acceptedFiles:n.acceptedFiles,fileRejections:n.fileRejections,isDragReject:n.isDragReject});case"reset":return yn({},Sp);default:return e}}function sN(){}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var _0={};_0.version="0.18.5";var kw=1252,rF=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],vg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},bg=function(e){rF.indexOf(e)!=-1&&(kw=vg[0]=e)};function sF(){bg(1252)}var Zr=function(e){bg(e)};function Ng(){Zr(1200),sF()}function iN(e){for(var n=[],a=0,r=e.length;a<r;++a)n[a]=e.charCodeAt(a);return n}function iF(e){for(var n=[],a=0;a<e.length>>1;++a)n[a]=String.fromCharCode(e.charCodeAt(2*a)+(e.charCodeAt(2*a+1)<<8));return n.join("")}function Tw(e){for(var n=[],a=0;a<e.length>>1;++a)n[a]=String.fromCharCode(e.charCodeAt(2*a+1)+(e.charCodeAt(2*a)<<8));return n.join("")}var Fd=function(e){var n=e.charCodeAt(0),a=e.charCodeAt(1);return n==255&&a==254?iF(e.slice(2)):n==254&&a==255?Tw(e.slice(2)):n==65279?e.slice(1):e},Qh=function(n){return String.fromCharCode(n)},lN=function(n){return String.fromCharCode(n)},Yd,Yi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Jd(e){for(var n="",a=0,r=0,s=0,l=0,o=0,d=0,u=0,x=0;x<e.length;)a=e.charCodeAt(x++),l=a>>2,r=e.charCodeAt(x++),o=(a&3)<<4|r>>4,s=e.charCodeAt(x++),d=(r&15)<<2|s>>6,u=s&63,isNaN(r)?d=u=64:isNaN(s)&&(u=64),n+=Yi.charAt(l)+Yi.charAt(o)+Yi.charAt(d)+Yi.charAt(u);return n}function vr(e){var n="",a=0,r=0,s=0,l=0,o=0,d=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var x=0;x<e.length;)l=Yi.indexOf(e.charAt(x++)),o=Yi.indexOf(e.charAt(x++)),a=l<<2|o>>4,n+=String.fromCharCode(a),d=Yi.indexOf(e.charAt(x++)),r=(o&15)<<4|d>>2,d!==64&&(n+=String.fromCharCode(r)),u=Yi.indexOf(e.charAt(x++)),s=(d&3)<<6|u,u!==64&&(n+=String.fromCharCode(s));return n}var bt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ui=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(n,a){return a?new Buffer(n,a):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}})();function il(e){return bt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function oN(e){return bt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var xr=function(n){return bt?ui(n,"binary"):n.split("").map(function(a){return a.charCodeAt(0)&255})};function lx(e){if(typeof ArrayBuffer>"u")return xr(e);for(var n=new ArrayBuffer(e.length),a=new Uint8Array(n),r=0;r!=e.length;++r)a[r]=e.charCodeAt(r)&255;return n}function hl(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var n=[],a=0;a<e.length;++a)n[a]=String.fromCharCode(e[a]);return n.join("")}function lF(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function jg(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return jg(new Uint8Array(e));for(var n=new Array(e.length),a=0;a<e.length;++a)n[a]=e[a];return n}var aa=bt?function(e){return Buffer.concat(e.map(function(n){return Buffer.isBuffer(n)?n:ui(n)}))}:function(e){if(typeof Uint8Array<"u"){var n=0,a=0;for(n=0;n<e.length;++n)a+=e[n].length;var r=new Uint8Array(a),s=0;for(n=0,a=0;n<e.length;a+=s,++n)if(s=e[n].length,e[n]instanceof Uint8Array)r.set(e[n],a);else{if(typeof e[n]=="string")throw"wtf";r.set(new Uint8Array(e[n]),a)}return r}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function oF(e){for(var n=[],a=0,r=e.length+250,s=il(e.length+255),l=0;l<e.length;++l){var o=e.charCodeAt(l);if(o<128)s[a++]=o;else if(o<2048)s[a++]=192|o>>6&31,s[a++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var d=e.charCodeAt(++l)&1023;s[a++]=240|o>>8&7,s[a++]=128|o>>2&63,s[a++]=128|d>>6&15|(o&3)<<4,s[a++]=128|d&63}else s[a++]=224|o>>12&15,s[a++]=128|o>>6&63,s[a++]=128|o&63;a>r&&(n.push(s.slice(0,a)),a=0,s=il(65535),r=65530)}return n.push(s.slice(0,a)),aa(n)}var Ba=/\u0000/g,Ld=/[\u0001-\u0006]/g;function ic(e){for(var n="",a=e.length-1;a>=0;)n+=e.charAt(a--);return n}function es(e,n){var a=""+e;return a.length>=n?a:wn("0",n-a.length)+a}function wg(e,n){var a=""+e;return a.length>=n?a:wn(" ",n-a.length)+a}function E0(e,n){var a=""+e;return a.length>=n?a:a+wn(" ",n-a.length)}function cF(e,n){var a=""+Math.round(e);return a.length>=n?a:wn("0",n-a.length)+a}function dF(e,n){var a=""+e;return a.length>=n?a:wn("0",n-a.length)+a}var cN=Math.pow(2,32);function Zo(e,n){if(e>cN||e<-cN)return cF(e,n);var a=Math.round(e);return dF(a,n)}function D0(e,n){return n=n||0,e.length>=7+n&&(e.charCodeAt(n)|32)===103&&(e.charCodeAt(n+1)|32)===101&&(e.charCodeAt(n+2)|32)===110&&(e.charCodeAt(n+3)|32)===101&&(e.charCodeAt(n+4)|32)===114&&(e.charCodeAt(n+5)|32)===97&&(e.charCodeAt(n+6)|32)===108}var dN=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Sf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function uF(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ct={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},uN={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},hF={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function A0(e,n,a){for(var r=e<0?-1:1,s=e*r,l=0,o=1,d=0,u=1,x=0,m=0,f=Math.floor(s);x<n&&(f=Math.floor(s),d=f*o+l,m=f*x+u,!(s-f<5e-8));)s=1/(s-f),l=o,o=d,u=x,x=m;if(m>n&&(x>n?(m=u,d=l):(m=x,d=o)),!a)return[0,r*d,m];var p=Math.floor(r*d/m);return[p,r*d-p*m,m]}function Vl(e,n,a){if(e>2958465||e<0)return null;var r=e|0,s=Math.floor(86400*(e-r)),l=0,o=[],d={D:r,T:s,u:86400*(e-r)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),n&&n.date1904&&(r+=1462),d.u>.9999&&(d.u=0,++s==86400&&(d.T=s=0,++r,++d.D)),r===60)o=a?[1317,10,29]:[1900,2,29],l=3;else if(r===0)o=a?[1317,8,29]:[1900,1,0],l=6;else{r>60&&--r;var u=new Date(1900,0,1);u.setDate(u.getDate()+r-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],l=u.getDay(),r<60&&(l=(l+6)%7),a&&(l=yF(u,o))}return d.y=o[0],d.m=o[1],d.d=o[2],d.S=s%60,s=Math.floor(s/60),d.M=s%60,s=Math.floor(s/60),d.H=s,d.q=l,d}var Cw=new Date(1899,11,31,0,0,0),xF=Cw.getTime(),mF=new Date(1900,2,1,0,0,0);function Sw(e,n){var a=e.getTime();return n?a-=1461*24*60*60*1e3:e>=mF&&(a+=1440*60*1e3),(a-(xF+(e.getTimezoneOffset()-Cw.getTimezoneOffset())*6e4))/(1440*60*1e3)}function kg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function fF(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function pF(e){var n=e<0?12:11,a=kg(e.toFixed(12));return a.length<=n||(a=e.toPrecision(10),a.length<=n)?a:e.toExponential(5)}function gF(e){var n=kg(e.toFixed(11));return n.length>(e<0?12:11)||n==="0"||n==="-0"?e.toPrecision(6):n}function Zd(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),a;return n>=-4&&n<=-1?a=e.toPrecision(10+n):Math.abs(n)<=9?a=pF(e):n===10?a=e.toFixed(10).substr(0,12):a=gF(e),kg(fF(a.toUpperCase()))}function lo(e,n){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Zd(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Hr(14,Sw(e,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+e)}function yF(e,n){n[0]-=581;var a=e.getDay();return e<60&&(a=(a+6)%7),a}function vF(e,n,a,r){var s="",l=0,o=0,d=a.y,u,x=0;switch(e){case 98:d=a.y+543;case 121:switch(n.length){case 1:case 2:u=d%100,x=2;break;default:u=d%1e4,x=4;break}break;case 109:switch(n.length){case 1:case 2:u=a.m,x=n.length;break;case 3:return Sf[a.m-1][1];case 5:return Sf[a.m-1][0];default:return Sf[a.m-1][2]}break;case 100:switch(n.length){case 1:case 2:u=a.d,x=n.length;break;case 3:return dN[a.q][0];default:return dN[a.q][1]}break;case 104:switch(n.length){case 1:case 2:u=1+(a.H+11)%12,x=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:u=a.H,x=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:u=a.M,x=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return a.u===0&&(n=="s"||n=="ss")?es(a.S,n.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,l=Math.round(o*(a.S+a.u)),l>=60*o&&(l=0),n==="s"?l===0?"0":""+l/o:(s=es(l,2+r),n==="ss"?s.substr(0,2):"."+s.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":u=a.D*24+a.H;break;case"[m]":case"[mm]":u=(a.D*24+a.H)*60+a.M;break;case"[s]":case"[ss]":u=((a.D*24+a.H)*60+a.M)*60+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+n}x=n.length===3?1:2;break;case 101:u=d,x=1;break}var m=x>0?es(u,x):"";return m}function Ji(e){var n=3;if(e.length<=n)return e;for(var a=e.length%n,r=e.substr(0,a);a!=e.length;a+=n)r+=(r.length>0?",":"")+e.substr(a,n);return r}var _w=/%/g;function bF(e,n,a){var r=n.replace(_w,""),s=n.length-r.length;return ai(e,r,a*Math.pow(10,2*s))+wn("%",s)}function NF(e,n,a){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return ai(e,n.substr(0,r),a/Math.pow(10,3*(n.length-r)))}function Ew(e,n){var a,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Ew(e,-n);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(n)*Math.LOG10E)%s;if(l<0&&(l+=s),a=(n/Math.pow(10,l)).toPrecision(r+1+(s+l)%s),a.indexOf("e")===-1){var o=Math.floor(Math.log(n)*Math.LOG10E);for(a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(o-a.length+l):a+="E+"+(o-l);a.substr(0,2)==="0.";)a=a.charAt(0)+a.substr(2,s)+"."+a.substr(2+s),a=a.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,u,x,m){return u+x+m.substr(0,(s+l)%s)+"."+m.substr(l)+"E"})}else a=n.toExponential(r);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var Dw=/# (\?+)( ?)\/( ?)(\d+)/;function jF(e,n,a){var r=parseInt(e[4],10),s=Math.round(n*r),l=Math.floor(s/r),o=s-l*r,d=r;return a+(l===0?"":""+l)+" "+(o===0?wn(" ",e[1].length+1+e[4].length):wg(o,e[1].length)+e[2]+"/"+e[3]+es(d,e[4].length))}function wF(e,n,a){return a+(n===0?"":""+n)+wn(" ",e[1].length+2+e[4].length)}var Aw=/^#*0*\.([0#]+)/,Fw=/\).*[0#]/,Lw=/\(###\) ###\\?-####/;function Ia(e){for(var n="",a,r=0;r!=e.length;++r)switch(a=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(a)}return n}function hN(e,n){var a=Math.pow(10,n);return""+Math.round(e*a)/a}function xN(e,n){var a=e-Math.floor(e),r=Math.pow(10,n);return n<(""+Math.round(a*r)).length?0:Math.round(a*r)}function kF(e,n){return n<(""+Math.round((e-Math.floor(e))*Math.pow(10,n))).length?1:0}function TF(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Er(e,n,a){if(e.charCodeAt(0)===40&&!n.match(Fw)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?Er("n",r,a):"("+Er("n",r,-a)+")"}if(n.charCodeAt(n.length-1)===44)return NF(e,n,a);if(n.indexOf("%")!==-1)return bF(e,n,a);if(n.indexOf("E")!==-1)return Ew(n,a);if(n.charCodeAt(0)===36)return"$"+Er(e,n.substr(n.charAt(1)==" "?2:1),a);var s,l,o,d,u=Math.abs(a),x=a<0?"-":"";if(n.match(/^00+$/))return x+Zo(u,n.length);if(n.match(/^[#?]+$/))return s=Zo(a,0),s==="0"&&(s=""),s.length>n.length?s:Ia(n.substr(0,n.length-s.length))+s;if(l=n.match(Dw))return jF(l,u,x);if(n.match(/^#+0+$/))return x+Zo(u,n.length-n.indexOf("0"));if(l=n.match(Aw))return s=hN(a,l[1].length).replace(/^([^\.]+)$/,"$1."+Ia(l[1])).replace(/\.$/,"."+Ia(l[1])).replace(/\.(\d*)$/,function(y,g){return"."+g+wn("0",Ia(l[1]).length-g.length)}),n.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),l=n.match(/^(0*)\.(#*)$/))return x+hN(u,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=n.match(/^#{1,3},##0(\.?)$/))return x+Ji(Zo(u,0));if(l=n.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+Er(e,n,-a):Ji(""+(Math.floor(a)+kF(a,l[1].length)))+"."+es(xN(a,l[1].length),l[1].length);if(l=n.match(/^#,#*,#0/))return Er(e,n.replace(/^#,#*,/,""),a);if(l=n.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ic(Er(e,n.replace(/[\\-]/g,""),a)),o=0,ic(ic(n.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<s.length?s.charAt(o++):y==="0"?"0":""}));if(n.match(Lw))return s=Er(e,"##########",a),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var m="";if(l=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),d=A0(u,Math.pow(10,o)-1,!1),s=""+x,m=ai("n",l[1],d[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),s+=m+l[2]+"/"+l[3],m=E0(d[2],o),m.length<l[4].length&&(m=Ia(l[4].substr(l[4].length-m.length))+m),s+=m,s;if(l=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),d=A0(u,Math.pow(10,o)-1,!0),x+(d[0]||(d[1]?"":"0"))+" "+(d[1]?wg(d[1],o)+l[2]+"/"+l[3]+E0(d[2],o):wn(" ",2*o+1+l[2].length+l[3].length));if(l=n.match(/^[#0?]+$/))return s=Zo(a,0),n.length<=s.length?s:Ia(n.substr(0,n.length-s.length))+s;if(l=n.match(/^([#0?]+)\.([#0]+)$/)){s=""+a.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=n.indexOf(".")-o,p=n.length-s.length-f;return Ia(n.substr(0,f)+s+n.substr(n.length-p))}if(l=n.match(/^00,000\.([#0]*0)$/))return o=xN(a,l[1].length),a<0?"-"+Er(e,n,-a):Ji(TF(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?es(0,3-y.length):"")+y})+"."+es(o,l[1].length);switch(n){case"###,##0.00":return Er(e,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var N=Ji(Zo(u,0));return N!=="0"?x+N:"";case"###,###.00":return Er(e,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return Er(e,"#,##0.00",a).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function CF(e,n,a){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return ai(e,n.substr(0,r),a/Math.pow(10,3*(n.length-r)))}function SF(e,n,a){var r=n.replace(_w,""),s=n.length-r.length;return ai(e,r,a*Math.pow(10,2*s))+wn("%",s)}function Pw(e,n){var a,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Pw(e,-n);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(n)*Math.LOG10E)%s;if(l<0&&(l+=s),a=(n/Math.pow(10,l)).toPrecision(r+1+(s+l)%s),!a.match(/[Ee]/)){var o=Math.floor(Math.log(n)*Math.LOG10E);a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(o-a.length+l):a+="E+"+(o-l),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,u,x,m){return u+x+m.substr(0,(s+l)%s)+"."+m.substr(l)+"E"})}else a=n.toExponential(r);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function ps(e,n,a){if(e.charCodeAt(0)===40&&!n.match(Fw)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?ps("n",r,a):"("+ps("n",r,-a)+")"}if(n.charCodeAt(n.length-1)===44)return CF(e,n,a);if(n.indexOf("%")!==-1)return SF(e,n,a);if(n.indexOf("E")!==-1)return Pw(n,a);if(n.charCodeAt(0)===36)return"$"+ps(e,n.substr(n.charAt(1)==" "?2:1),a);var s,l,o,d,u=Math.abs(a),x=a<0?"-":"";if(n.match(/^00+$/))return x+es(u,n.length);if(n.match(/^[#?]+$/))return s=""+a,a===0&&(s=""),s.length>n.length?s:Ia(n.substr(0,n.length-s.length))+s;if(l=n.match(Dw))return wF(l,u,x);if(n.match(/^#+0+$/))return x+es(u,n.length-n.indexOf("0"));if(l=n.match(Aw))return s=(""+a).replace(/^([^\.]+)$/,"$1."+Ia(l[1])).replace(/\.$/,"."+Ia(l[1])),s=s.replace(/\.(\d*)$/,function(y,g){return"."+g+wn("0",Ia(l[1]).length-g.length)}),n.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),l=n.match(/^(0*)\.(#*)$/))return x+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=n.match(/^#{1,3},##0(\.?)$/))return x+Ji(""+u);if(l=n.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+ps(e,n,-a):Ji(""+a)+"."+wn("0",l[1].length);if(l=n.match(/^#,#*,#0/))return ps(e,n.replace(/^#,#*,/,""),a);if(l=n.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ic(ps(e,n.replace(/[\\-]/g,""),a)),o=0,ic(ic(n.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<s.length?s.charAt(o++):y==="0"?"0":""}));if(n.match(Lw))return s=ps(e,"##########",a),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var m="";if(l=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),d=A0(u,Math.pow(10,o)-1,!1),s=""+x,m=ai("n",l[1],d[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),s+=m+l[2]+"/"+l[3],m=E0(d[2],o),m.length<l[4].length&&(m=Ia(l[4].substr(l[4].length-m.length))+m),s+=m,s;if(l=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),d=A0(u,Math.pow(10,o)-1,!0),x+(d[0]||(d[1]?"":"0"))+" "+(d[1]?wg(d[1],o)+l[2]+"/"+l[3]+E0(d[2],o):wn(" ",2*o+1+l[2].length+l[3].length));if(l=n.match(/^[#0?]+$/))return s=""+a,n.length<=s.length?s:Ia(n.substr(0,n.length-s.length))+s;if(l=n.match(/^([#0]+)\.([#0]+)$/)){s=""+a.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=n.indexOf(".")-o,p=n.length-s.length-f;return Ia(n.substr(0,f)+s+n.substr(n.length-p))}if(l=n.match(/^00,000\.([#0]*0)$/))return a<0?"-"+ps(e,n,-a):Ji(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?es(0,3-y.length):"")+y})+"."+es(0,l[1].length);switch(n){case"###,###":case"##,###":case"#,###":var N=Ji(""+u);return N!=="0"?x+N:"";default:if(n.match(/\.[0#?]*$/))return ps(e,n.slice(0,n.lastIndexOf(".")),a)+Ia(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function ai(e,n,a){return(a|0)===a?ps(e,n,a):Er(e,n,a)}function _F(e){for(var n=[],a=!1,r=0,s=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:a=!a;break;case 95:case 42:case 92:++r;break;case 59:n[n.length]=e.substr(s,r-s),s=r+1}if(n[n.length]=e.substr(s),a===!0)throw new Error("Format |"+e+"| unterminated string ");return n}var Iw=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ic(e){for(var n=0,a="",r="";n<e.length;)switch(a=e.charAt(n)){case"G":D0(e,n)&&(n+=6),n++;break;case'"':for(;e.charCodeAt(++n)!==34&&n<e.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(e.charAt(n+1)==="1"||e.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(n,3).toUpperCase()==="A/P"||e.substr(n,5).toUpperCase()==="AM/PM"||e.substr(n,5).toUpperCase()==="/")return!0;++n;break;case"[":for(r=a;e.charAt(n++)!=="]"&&n<e.length;)r+=e.charAt(n);if(r.match(Iw))return!0;break;case".":case"0":case"#":for(;n<e.length&&("0#?.,E+-%".indexOf(a=e.charAt(++n))>-1||a=="\\"&&e.charAt(n+1)=="-"&&"0#".indexOf(e.charAt(n+2))>-1););break;case"?":for(;e.charAt(++n)===a;);break;case"*":++n,(e.charAt(n)==" "||e.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<e.length&&"0123456789".indexOf(e.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function EF(e,n,a,r){for(var s=[],l="",o=0,d="",u="t",x,m,f,p="H";o<e.length;)switch(d=e.charAt(o)){case"G":if(!D0(e,o))throw new Error("unrecognized character "+d+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(l="";(f=e.charCodeAt(++o))!==34&&o<e.length;)l+=String.fromCharCode(f);s[s.length]={t:"t",v:l},++o;break;case"\\":var N=e.charAt(++o),y=N==="("||N===")"?N:"t";s[s.length]={t:y,v:N},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:n},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(x==null&&(x=Vl(n,a,e.charAt(o+1)==="2"),x==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},u=d,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||x==null&&(x=Vl(n,a),x==null))return"";for(l=d;++o<e.length&&e.charAt(o).toLowerCase()===d;)l+=d;d==="m"&&u.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=p),s[s.length]={t:d,v:l},u=d;break;case"A":case"a":case"":var g={t:d,v:d};if(x==null&&(x=Vl(n,a)),e.substr(o,3).toUpperCase()==="A/P"?(x!=null&&(g.v=x.H>=12?"P":"A"),g.t="T",p="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(x!=null&&(g.v=x.H>=12?"PM":"AM"),g.t="T",o+=5,p="h"):e.substr(o,5).toUpperCase()==="/"?(x!=null&&(g.v=x.H>=12?"":""),g.t="T",o+=5,p="h"):(g.t="t",++o),x==null&&g.t==="T")return"";s[s.length]=g,u=d;break;case"[":for(l=d;e.charAt(o++)!=="]"&&o<e.length;)l+=e.charAt(o);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(Iw)){if(x==null&&(x=Vl(n,a),x==null))return"";s[s.length]={t:"Z",v:l.toLowerCase()},u=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ic(e)||(s[s.length]={t:"t",v:l}));break;case".":if(x!=null){for(l=d;++o<e.length&&(d=e.charAt(o))==="0";)l+=d;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=d;++o<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(o))>-1;)l+=d;s[s.length]={t:"n",v:l};break;case"?":for(l=d;e.charAt(++o)===d;)l+=d;s[s.length]={t:d,v:l},u=d;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:r===1?"t":d,v:d},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=d;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)l+=e.charAt(o);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:d,v:d},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+e);s[s.length]={t:"t",v:d},++o;break}var b=0,j=0,T;for(o=s.length-1,u="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=p,u="h",b<1&&(b=1);break;case"s":(T=s[o].v.match(/\.0+$/))&&(j=Math.max(j,T[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":u=s[o].t;break;case"m":u==="s"&&(s[o].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&s[o].v.match(/[Hh]/)&&(b=1),b<2&&s[o].v.match(/[Mm]/)&&(b=2),b<3&&s[o].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M),x.M>=60&&(x.M=0,++x.H);break;case 2:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M);break}var S="",w;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=vF(s[o].t.charCodeAt(0),s[o].v,x,j),s[o].t="t";break;case"n":case"?":for(w=o+1;s[w]!=null&&((d=s[w].t)==="?"||d==="D"||(d===" "||d==="t")&&s[w+1]!=null&&(s[w+1].t==="?"||s[w+1].t==="t"&&s[w+1].v==="/")||s[o].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(s[w].v==="/"||s[w].v===" "&&s[w+1]!=null&&s[w+1].t=="?"));)s[o].v+=s[w].v,s[w]={v:"",t:";"},++w;S+=s[o].v,o=w-1;break;case"G":s[o].t="t",s[o].v=lo(n,a);break}var _="",E,C;if(S.length>0){S.charCodeAt(0)==40?(E=n<0&&S.charCodeAt(0)===45?-n:n,C=ai("n",S,E)):(E=n<0&&r>1?-n:n,C=ai("n",S,E),E<0&&s[0]&&s[0].t=="t"&&(C=C.substr(1),s[0].v="-"+s[0].v)),w=C.length-1;var P=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){P=o;break}var F=s.length;if(P===s.length&&C.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(w>=s[o].v.length-1?(w-=s[o].v.length,s[o].v=C.substr(w+1,s[o].v.length)):w<0?s[o].v="":(s[o].v=C.substr(0,w+1),w=-1),s[o].t="t",F=o);w>=0&&F<s.length&&(s[F].v=C.substr(0,w+1)+s[F].v)}else if(P!==s.length&&C.indexOf("E")===-1){for(w=C.indexOf(".")-1,o=P;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(m=s[o].v.indexOf(".")>-1&&o===P?s[o].v.indexOf(".")-1:s[o].v.length-1,_=s[o].v.substr(m+1);m>=0;--m)w>=0&&(s[o].v.charAt(m)==="0"||s[o].v.charAt(m)==="#")&&(_=C.charAt(w--)+_);s[o].v=_,s[o].t="t",F=o}for(w>=0&&F<s.length&&(s[F].v=C.substr(0,w+1)+s[F].v),w=C.indexOf(".")+1,o=P;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==P)){for(m=s[o].v.indexOf(".")>-1&&o===P?s[o].v.indexOf(".")+1:0,_=s[o].v.substr(0,m);m<s[o].v.length;++m)w<C.length&&(_+=C.charAt(w++));s[o].v=_,s[o].t="t",F=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(E=r>1&&n<0&&o>0&&s[o-1].v==="-"?-n:n,s[o].v=ai(s[o].t,s[o].v,E),s[o].t="t");var R="";for(o=0;o!==s.length;++o)s[o]!=null&&(R+=s[o].v);return R}var mN=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function fN(e,n){if(n==null)return!1;var a=parseFloat(n[2]);switch(n[1]){case"=":if(e==a)return!0;break;case">":if(e>a)return!0;break;case"<":if(e<a)return!0;break;case"<>":if(e!=a)return!0;break;case">=":if(e>=a)return!0;break;case"<=":if(e<=a)return!0;break}return!1}function DF(e,n){var a=_F(e),r=a.length,s=a[r-1].indexOf("@");if(r<4&&s>-1&&--r,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if(typeof n!="number")return[4,a.length===4||s>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=s>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=s>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=s>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"];break}var l=n>0?a[0]:n<0?a[1]:a[2];if(a[0].indexOf("[")===-1&&a[1].indexOf("[")===-1)return[r,l];if(a[0].match(/\[[=<>]/)!=null||a[1].match(/\[[=<>]/)!=null){var o=a[0].match(mN),d=a[1].match(mN);return fN(n,o)?[r,a[0]]:fN(n,d)?[r,a[1]]:[r,a[o!=null&&d!=null?2:1]]}return[r,l]}function Hr(e,n,a){a==null&&(a={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&a.dateNF?r=a.dateNF:r=e;break;case"number":e==14&&a.dateNF?r=a.dateNF:r=(a.table!=null?a.table:ct)[e],r==null&&(r=a.table&&a.table[uN[e]]||ct[uN[e]]),r==null&&(r=hF[e]||"General");break}if(D0(r,0))return lo(n,a);n instanceof Date&&(n=Sw(n,a.date1904));var s=DF(r,n);if(D0(s[1]))return lo(n,a);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return EF(s[1],n,a,s[0])}function ri(e,n){if(typeof n!="number"){n=+n||-1;for(var a=0;a<392;++a){if(ct[a]==null){n<0&&(n=a);continue}if(ct[a]==e){n=a;break}}n<0&&(n=391)}return ct[n]=e,n}function ox(e){for(var n=0;n!=392;++n)e[n]!==void 0&&ri(e[n],n)}function Oc(){ct=uF()}var AF={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Ow=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function FF(e){var n=typeof e=="number"?ct[e]:e;return n=n.replace(Ow,"(\\d+)"),new RegExp("^"+n+"$")}function LF(e,n,a){var r=-1,s=-1,l=-1,o=-1,d=-1,u=-1;(n.match(Ow)||[]).forEach(function(f,p){var N=parseInt(a[p+1],10);switch(f.toLowerCase().charAt(0)){case"y":r=N;break;case"d":l=N;break;case"h":o=N;break;case"s":u=N;break;case"m":o>=0?d=N:s=N;break}}),u>=0&&d==-1&&s>=0&&(d=s,s=-1);var x=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);x.length==7&&(x="0"+x),x.length==8&&(x="20"+x);var m=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&d==-1&&u==-1?x:r==-1&&s==-1&&l==-1?m:x+"T"+m}var PF=(function(){var e={};e.version="1.2.0";function n(){for(var C=0,P=new Array(256),F=0;F!=256;++F)C=F,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,P[F]=C;return typeof Int32Array<"u"?new Int32Array(P):P}var a=n();function r(C){var P=0,F=0,R=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)O[R]=C[R];for(R=0;R!=256;++R)for(F=C[R],P=256+R;P<4096;P+=256)F=O[P]=F>>>8^C[F&255];var M=[];for(R=1;R!=16;++R)M[R-1]=typeof Int32Array<"u"?O.subarray(R*256,R*256+256):O.slice(R*256,R*256+256);return M}var s=r(a),l=s[0],o=s[1],d=s[2],u=s[3],x=s[4],m=s[5],f=s[6],p=s[7],N=s[8],y=s[9],g=s[10],b=s[11],j=s[12],T=s[13],S=s[14];function w(C,P){for(var F=P^-1,R=0,O=C.length;R<O;)F=F>>>8^a[(F^C.charCodeAt(R++))&255];return~F}function _(C,P){for(var F=P^-1,R=C.length-15,O=0;O<R;)F=S[C[O++]^F&255]^T[C[O++]^F>>8&255]^j[C[O++]^F>>16&255]^b[C[O++]^F>>>24]^g[C[O++]]^y[C[O++]]^N[C[O++]]^p[C[O++]]^f[C[O++]]^m[C[O++]]^x[C[O++]]^u[C[O++]]^d[C[O++]]^o[C[O++]]^l[C[O++]]^a[C[O++]];for(R+=15;O<R;)F=F>>>8^a[(F^C[O++])&255];return~F}function E(C,P){for(var F=P^-1,R=0,O=C.length,M=0,q=0;R<O;)M=C.charCodeAt(R++),M<128?F=F>>>8^a[(F^M)&255]:M<2048?(F=F>>>8^a[(F^(192|M>>6&31))&255],F=F>>>8^a[(F^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,q=C.charCodeAt(R++)&1023,F=F>>>8^a[(F^(240|M>>8&7))&255],F=F>>>8^a[(F^(128|M>>2&63))&255],F=F>>>8^a[(F^(128|q>>6&15|(M&3)<<4))&255],F=F>>>8^a[(F^(128|q&63))&255]):(F=F>>>8^a[(F^(224|M>>12&15))&255],F=F>>>8^a[(F^(128|M>>6&63))&255],F=F>>>8^a[(F^(128|M&63))&255]);return~F}return e.table=a,e.bstr=w,e.buf=_,e.str=E,e})(),rt=(function(){var n={};n.version="1.2.1";function a(G,ae){for(var Y=G.split("/"),ee=ae.split("/"),re=0,se=0,ve=Math.min(Y.length,ee.length);re<ve;++re){if(se=Y[re].length-ee[re].length)return se;if(Y[re]!=ee[re])return Y[re]<ee[re]?-1:1}return Y.length-ee.length}function r(G){if(G.charAt(G.length-1)=="/")return G.slice(0,-1).indexOf("/")===-1?G:r(G.slice(0,-1));var ae=G.lastIndexOf("/");return ae===-1?G:G.slice(0,ae+1)}function s(G){if(G.charAt(G.length-1)=="/")return s(G.slice(0,-1));var ae=G.lastIndexOf("/");return ae===-1?G:G.slice(ae+1)}function l(G,ae){typeof ae=="string"&&(ae=new Date(ae));var Y=ae.getHours();Y=Y<<6|ae.getMinutes(),Y=Y<<5|ae.getSeconds()>>>1,G.write_shift(2,Y);var ee=ae.getFullYear()-1980;ee=ee<<4|ae.getMonth()+1,ee=ee<<5|ae.getDate(),G.write_shift(2,ee)}function o(G){var ae=G.read_shift(2)&65535,Y=G.read_shift(2)&65535,ee=new Date,re=Y&31;Y>>>=5;var se=Y&15;Y>>>=4,ee.setMilliseconds(0),ee.setFullYear(Y+1980),ee.setMonth(se-1),ee.setDate(re);var ve=ae&31;ae>>>=5;var Ce=ae&63;return ae>>>=6,ee.setHours(ae),ee.setMinutes(Ce),ee.setSeconds(ve<<1),ee}function d(G){da(G,0);for(var ae={},Y=0;G.l<=G.length-4;){var ee=G.read_shift(2),re=G.read_shift(2),se=G.l+re,ve={};switch(ee){case 21589:Y=G.read_shift(1),Y&1&&(ve.mtime=G.read_shift(4)),re>5&&(Y&2&&(ve.atime=G.read_shift(4)),Y&4&&(ve.ctime=G.read_shift(4))),ve.mtime&&(ve.mt=new Date(ve.mtime*1e3));break}G.l=se,ae[ee]=ve}return ae}var u;function x(){return u||(u={})}function m(G,ae){if(G[0]==80&&G[1]==75)return ko(G,ae);if((G[0]|32)==109&&(G[1]|32)==105)return Mu(G,ae);if(G.length<512)throw new Error("CFB file size "+G.length+" < 512");var Y=3,ee=512,re=0,se=0,ve=0,Ce=0,ye=0,Ne=[],je=G.slice(0,512);da(je,0);var Pe=f(je);switch(Y=Pe[0],Y){case 3:ee=512;break;case 4:ee=4096;break;case 0:if(Pe[1]==0)return ko(G,ae);default:throw new Error("Major Version: Expected 3 or 4 saw "+Y)}ee!==512&&(je=G.slice(0,ee),da(je,28));var ze=G.slice(0,ee);p(je,Y);var qe=je.read_shift(4,"i");if(Y===3&&qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qe);je.l+=4,ve=je.read_shift(4,"i"),je.l+=4,je.chk("00100000","Mini Stream Cutoff Size: "),Ce=je.read_shift(4,"i"),re=je.read_shift(4,"i"),ye=je.read_shift(4,"i"),se=je.read_shift(4,"i");for(var He=-1,Me=0;Me<109&&(He=je.read_shift(4,"i"),!(He<0));++Me)Ne[Me]=He;var mt=N(G,ee);b(ye,se,mt,ee,Ne);var Qt=T(mt,ve,Ne,ee);Qt[ve].name="!Directory",re>0&&Ce!==q&&(Qt[Ce].name="!MiniFAT"),Qt[Ne[0]].name="!FAT",Qt.fat_addrs=Ne,Qt.ssz=ee;var tn={},Sn=[],yl=[],yi=[];S(ve,Qt,mt,Sn,re,tn,yl,Ce),y(yl,yi,Sn),Sn.shift();var os={FileIndex:yl,FullPaths:yi};return ae&&ae.raw&&(os.raw={header:ze,sectors:mt}),os}function f(G){if(G[G.l]==80&&G[G.l+1]==75)return[0,0];G.chk(J,"Header Signature: "),G.l+=16;var ae=G.read_shift(2,"u");return[G.read_shift(2,"u"),ae]}function p(G,ae){var Y=9;switch(G.l+=2,Y=G.read_shift(2)){case 9:if(ae!=3)throw new Error("Sector Shift: Expected 9 saw "+Y);break;case 12:if(ae!=4)throw new Error("Sector Shift: Expected 12 saw "+Y);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Y)}G.chk("0600","Mini Sector Shift: "),G.chk("000000000000","Reserved: ")}function N(G,ae){for(var Y=Math.ceil(G.length/ae)-1,ee=[],re=1;re<Y;++re)ee[re-1]=G.slice(re*ae,(re+1)*ae);return ee[Y-1]=G.slice(Y*ae),ee}function y(G,ae,Y){for(var ee=0,re=0,se=0,ve=0,Ce=0,ye=Y.length,Ne=[],je=[];ee<ye;++ee)Ne[ee]=je[ee]=ee,ae[ee]=Y[ee];for(;Ce<je.length;++Ce)ee=je[Ce],re=G[ee].L,se=G[ee].R,ve=G[ee].C,Ne[ee]===ee&&(re!==-1&&Ne[re]!==re&&(Ne[ee]=Ne[re]),se!==-1&&Ne[se]!==se&&(Ne[ee]=Ne[se])),ve!==-1&&(Ne[ve]=ee),re!==-1&&ee!=Ne[ee]&&(Ne[re]=Ne[ee],je.lastIndexOf(re)<Ce&&je.push(re)),se!==-1&&ee!=Ne[ee]&&(Ne[se]=Ne[ee],je.lastIndexOf(se)<Ce&&je.push(se));for(ee=1;ee<ye;++ee)Ne[ee]===ee&&(se!==-1&&Ne[se]!==se?Ne[ee]=Ne[se]:re!==-1&&Ne[re]!==re&&(Ne[ee]=Ne[re]));for(ee=1;ee<ye;++ee)if(G[ee].type!==0){if(Ce=ee,Ce!=Ne[Ce])do Ce=Ne[Ce],ae[ee]=ae[Ce]+"/"+ae[ee];while(Ce!==0&&Ne[Ce]!==-1&&Ce!=Ne[Ce]);Ne[ee]=-1}for(ae[0]+="/",ee=1;ee<ye;++ee)G[ee].type!==2&&(ae[ee]+="/")}function g(G,ae,Y){for(var ee=G.start,re=G.size,se=[],ve=ee;Y&&re>0&&ve>=0;)se.push(ae.slice(ve*M,ve*M+M)),re-=M,ve=Rl(Y,ve*4);return se.length===0?Te(0):aa(se).slice(0,G.size)}function b(G,ae,Y,ee,re){var se=q;if(G===q){if(ae!==0)throw new Error("DIFAT chain shorter than expected")}else if(G!==-1){var ve=Y[G],Ce=(ee>>>2)-1;if(!ve)return;for(var ye=0;ye<Ce&&(se=Rl(ve,ye*4))!==q;++ye)re.push(se);b(Rl(ve,ee-4),ae-1,Y,ee,re)}}function j(G,ae,Y,ee,re){var se=[],ve=[];re||(re=[]);var Ce=ee-1,ye=0,Ne=0;for(ye=ae;ye>=0;){re[ye]=!0,se[se.length]=ye,ve.push(G[ye]);var je=Y[Math.floor(ye*4/ee)];if(Ne=ye*4&Ce,ee<4+Ne)throw new Error("FAT boundary crossed: "+ye+" 4 "+ee);if(!G[je])break;ye=Rl(G[je],Ne)}return{nodes:se,data:SN([ve])}}function T(G,ae,Y,ee){var re=G.length,se=[],ve=[],Ce=[],ye=[],Ne=ee-1,je=0,Pe=0,ze=0,qe=0;for(je=0;je<re;++je)if(Ce=[],ze=je+ae,ze>=re&&(ze-=re),!ve[ze]){ye=[];var He=[];for(Pe=ze;Pe>=0;){He[Pe]=!0,ve[Pe]=!0,Ce[Ce.length]=Pe,ye.push(G[Pe]);var Me=Y[Math.floor(Pe*4/ee)];if(qe=Pe*4&Ne,ee<4+qe)throw new Error("FAT boundary crossed: "+Pe+" 4 "+ee);if(!G[Me]||(Pe=Rl(G[Me],qe),He[Pe]))break}se[ze]={nodes:Ce,data:SN([ye])}}return se}function S(G,ae,Y,ee,re,se,ve,Ce){for(var ye=0,Ne=ee.length?2:0,je=ae[G].data,Pe=0,ze=0,qe;Pe<je.length;Pe+=128){var He=je.slice(Pe,Pe+128);da(He,64),ze=He.read_shift(2),qe=Ag(He,0,ze-Ne),ee.push(qe);var Me={name:qe,type:He.read_shift(1),color:He.read_shift(1),L:He.read_shift(4,"i"),R:He.read_shift(4,"i"),C:He.read_shift(4,"i"),clsid:He.read_shift(16),state:He.read_shift(4,"i"),start:0,size:0},mt=He.read_shift(2)+He.read_shift(2)+He.read_shift(2)+He.read_shift(2);mt!==0&&(Me.ct=w(He,He.l-8));var Qt=He.read_shift(2)+He.read_shift(2)+He.read_shift(2)+He.read_shift(2);Qt!==0&&(Me.mt=w(He,He.l-8)),Me.start=He.read_shift(4,"i"),Me.size=He.read_shift(4,"i"),Me.size<0&&Me.start<0&&(Me.size=Me.type=0,Me.start=q,Me.name=""),Me.type===5?(ye=Me.start,re>0&&ye!==q&&(ae[ye].name="!StreamData")):Me.size>=4096?(Me.storage="fat",ae[Me.start]===void 0&&(ae[Me.start]=j(Y,Me.start,ae.fat_addrs,ae.ssz)),ae[Me.start].name=Me.name,Me.content=ae[Me.start].data.slice(0,Me.size)):(Me.storage="minifat",Me.size<0?Me.size=0:ye!==q&&Me.start!==q&&ae[ye]&&(Me.content=g(Me,ae[ye].data,(ae[Ce]||{}).data))),Me.content&&da(Me.content,0),se[qe]=Me,ve.push(Me)}}function w(G,ae){return new Date((hr(G,ae+4)/1e7*Math.pow(2,32)+hr(G,ae)/1e7-11644473600)*1e3)}function _(G,ae){return x(),m(u.readFileSync(G),ae)}function E(G,ae){var Y=ae&&ae.type;switch(Y||bt&&Buffer.isBuffer(G)&&(Y="buffer"),Y||"base64"){case"file":return _(G,ae);case"base64":return m(xr(vr(G)),ae);case"binary":return m(xr(G),ae)}return m(G,ae)}function C(G,ae){var Y=ae||{},ee=Y.root||"Root Entry";if(G.FullPaths||(G.FullPaths=[]),G.FileIndex||(G.FileIndex=[]),G.FullPaths.length!==G.FileIndex.length)throw new Error("inconsistent CFB structure");G.FullPaths.length===0&&(G.FullPaths[0]=ee+"/",G.FileIndex[0]={name:ee,type:5}),Y.CLSID&&(G.FileIndex[0].clsid=Y.CLSID),P(G)}function P(G){var ae="Sh33tJ5";if(!rt.find(G,"/"+ae)){var Y=Te(4);Y[0]=55,Y[1]=Y[3]=50,Y[2]=54,G.FileIndex.push({name:ae,type:2,content:Y,size:4,L:69,R:69,C:69}),G.FullPaths.push(G.FullPaths[0]+ae),F(G)}}function F(G,ae){C(G);for(var Y=!1,ee=!1,re=G.FullPaths.length-1;re>=0;--re){var se=G.FileIndex[re];switch(se.type){case 0:ee?Y=!0:(G.FileIndex.pop(),G.FullPaths.pop());break;case 1:case 2:case 5:ee=!0,isNaN(se.R*se.L*se.C)&&(Y=!0),se.R>-1&&se.L>-1&&se.R==se.L&&(Y=!0);break;default:Y=!0;break}}if(!(!Y&&!ae)){var ve=new Date(1987,1,19),Ce=0,ye=Object.create?Object.create(null):{},Ne=[];for(re=0;re<G.FullPaths.length;++re)ye[G.FullPaths[re]]=!0,G.FileIndex[re].type!==0&&Ne.push([G.FullPaths[re],G.FileIndex[re]]);for(re=0;re<Ne.length;++re){var je=r(Ne[re][0]);ee=ye[je],ee||(Ne.push([je,{name:s(je).replace("/",""),type:1,clsid:ue,ct:ve,mt:ve,content:null}]),ye[je]=!0)}for(Ne.sort(function(qe,He){return a(qe[0],He[0])}),G.FullPaths=[],G.FileIndex=[],re=0;re<Ne.length;++re)G.FullPaths[re]=Ne[re][0],G.FileIndex[re]=Ne[re][1];for(re=0;re<Ne.length;++re){var Pe=G.FileIndex[re],ze=G.FullPaths[re];if(Pe.name=s(ze).replace("/",""),Pe.L=Pe.R=Pe.C=-(Pe.color=1),Pe.size=Pe.content?Pe.content.length:0,Pe.start=0,Pe.clsid=Pe.clsid||ue,re===0)Pe.C=Ne.length>1?1:-1,Pe.size=0,Pe.type=5;else if(ze.slice(-1)=="/"){for(Ce=re+1;Ce<Ne.length&&r(G.FullPaths[Ce])!=ze;++Ce);for(Pe.C=Ce>=Ne.length?-1:Ce,Ce=re+1;Ce<Ne.length&&r(G.FullPaths[Ce])!=r(ze);++Ce);Pe.R=Ce>=Ne.length?-1:Ce,Pe.type=1}else r(G.FullPaths[re+1]||"")==r(ze)&&(Pe.R=re+1),Pe.type=2}}}function R(G,ae){var Y=ae||{};if(Y.fileType=="mad")return pl(G,Y);switch(F(G),Y.fileType){case"zip":return gi(G,Y)}var ee=(function(qe){for(var He=0,Me=0,mt=0;mt<qe.FileIndex.length;++mt){var Qt=qe.FileIndex[mt];if(Qt.content){var tn=Qt.content.length;tn>0&&(tn<4096?He+=tn+63>>6:Me+=tn+511>>9)}}for(var Sn=qe.FullPaths.length+3>>2,yl=He+7>>3,yi=He+127>>7,os=yl+Me+Sn+yi,Qn=os+127>>7,Uc=Qn<=109?0:Math.ceil((Qn-109)/127);os+Qn+Uc+127>>7>Qn;)Uc=++Qn<=109?0:Math.ceil((Qn-109)/127);var _n=[1,Uc,Qn,yi,Sn,Me,He,0];return qe.FileIndex[0].size=He<<6,_n[7]=(qe.FileIndex[0].start=_n[0]+_n[1]+_n[2]+_n[3]+_n[4]+_n[5])+(_n[6]+7>>3),_n})(G),re=Te(ee[7]<<9),se=0,ve=0;{for(se=0;se<8;++se)re.write_shift(1,B[se]);for(se=0;se<8;++se)re.write_shift(2,0);for(re.write_shift(2,62),re.write_shift(2,3),re.write_shift(2,65534),re.write_shift(2,9),re.write_shift(2,6),se=0;se<3;++se)re.write_shift(2,0);for(re.write_shift(4,0),re.write_shift(4,ee[2]),re.write_shift(4,ee[0]+ee[1]+ee[2]+ee[3]-1),re.write_shift(4,0),re.write_shift(4,4096),re.write_shift(4,ee[3]?ee[0]+ee[1]+ee[2]-1:q),re.write_shift(4,ee[3]),re.write_shift(-4,ee[1]?ee[0]-1:q),re.write_shift(4,ee[1]),se=0;se<109;++se)re.write_shift(-4,se<ee[2]?ee[1]+se:-1)}if(ee[1])for(ve=0;ve<ee[1];++ve){for(;se<236+ve*127;++se)re.write_shift(-4,se<ee[2]?ee[1]+se:-1);re.write_shift(-4,ve===ee[1]-1?q:ve+1)}var Ce=function(qe){for(ve+=qe;se<ve-1;++se)re.write_shift(-4,se+1);qe&&(++se,re.write_shift(-4,q))};for(ve=se=0,ve+=ee[1];se<ve;++se)re.write_shift(-4,te.DIFSECT);for(ve+=ee[2];se<ve;++se)re.write_shift(-4,te.FATSECT);Ce(ee[3]),Ce(ee[4]);for(var ye=0,Ne=0,je=G.FileIndex[0];ye<G.FileIndex.length;++ye)je=G.FileIndex[ye],je.content&&(Ne=je.content.length,!(Ne<4096)&&(je.start=ve,Ce(Ne+511>>9)));for(Ce(ee[6]+7>>3);re.l&511;)re.write_shift(-4,te.ENDOFCHAIN);for(ve=se=0,ye=0;ye<G.FileIndex.length;++ye)je=G.FileIndex[ye],je.content&&(Ne=je.content.length,!(!Ne||Ne>=4096)&&(je.start=ve,Ce(Ne+63>>6)));for(;re.l&511;)re.write_shift(-4,te.ENDOFCHAIN);for(se=0;se<ee[4]<<2;++se){var Pe=G.FullPaths[se];if(!Pe||Pe.length===0){for(ye=0;ye<17;++ye)re.write_shift(4,0);for(ye=0;ye<3;++ye)re.write_shift(4,-1);for(ye=0;ye<12;++ye)re.write_shift(4,0);continue}je=G.FileIndex[se],se===0&&(je.start=je.size?je.start-1:q);var ze=se===0&&Y.root||je.name;if(Ne=2*(ze.length+1),re.write_shift(64,ze,"utf16le"),re.write_shift(2,Ne),re.write_shift(1,je.type),re.write_shift(1,je.color),re.write_shift(-4,je.L),re.write_shift(-4,je.R),re.write_shift(-4,je.C),je.clsid)re.write_shift(16,je.clsid,"hex");else for(ye=0;ye<4;++ye)re.write_shift(4,0);re.write_shift(4,je.state||0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,je.start),re.write_shift(4,je.size),re.write_shift(4,0)}for(se=1;se<G.FileIndex.length;++se)if(je=G.FileIndex[se],je.size>=4096)if(re.l=je.start+1<<9,bt&&Buffer.isBuffer(je.content))je.content.copy(re,re.l,0,je.size),re.l+=je.size+511&-512;else{for(ye=0;ye<je.size;++ye)re.write_shift(1,je.content[ye]);for(;ye&511;++ye)re.write_shift(1,0)}for(se=1;se<G.FileIndex.length;++se)if(je=G.FileIndex[se],je.size>0&&je.size<4096)if(bt&&Buffer.isBuffer(je.content))je.content.copy(re,re.l,0,je.size),re.l+=je.size+63&-64;else{for(ye=0;ye<je.size;++ye)re.write_shift(1,je.content[ye]);for(;ye&63;++ye)re.write_shift(1,0)}if(bt)re.l=re.length;else for(;re.l<re.length;)re.write_shift(1,0);return re}function O(G,ae){var Y=G.FullPaths.map(function(ye){return ye.toUpperCase()}),ee=Y.map(function(ye){var Ne=ye.split("/");return Ne[Ne.length-(ye.slice(-1)=="/"?2:1)]}),re=!1;ae.charCodeAt(0)===47?(re=!0,ae=Y[0].slice(0,-1)+ae):re=ae.indexOf("/")!==-1;var se=ae.toUpperCase(),ve=re===!0?Y.indexOf(se):ee.indexOf(se);if(ve!==-1)return G.FileIndex[ve];var Ce=!se.match(Ld);for(se=se.replace(Ba,""),Ce&&(se=se.replace(Ld,"!")),ve=0;ve<Y.length;++ve)if((Ce?Y[ve].replace(Ld,"!"):Y[ve]).replace(Ba,"")==se||(Ce?ee[ve].replace(Ld,"!"):ee[ve]).replace(Ba,"")==se)return G.FileIndex[ve];return null}var M=64,q=-2,J="d0cf11e0a1b11ae1",B=[208,207,17,224,161,177,26,225],ue="00000000000000000000000000000000",te={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:J,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ue,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Z(G,ae,Y){x();var ee=R(G,Y);u.writeFileSync(ae,ee)}function Q(G){for(var ae=new Array(G.length),Y=0;Y<G.length;++Y)ae[Y]=String.fromCharCode(G[Y]);return ae.join("")}function fe(G,ae){var Y=R(G,ae);switch(ae&&ae.type||"buffer"){case"file":return x(),u.writeFileSync(ae.filename,Y),Y;case"binary":return typeof Y=="string"?Y:Q(Y);case"base64":return Jd(typeof Y=="string"?Y:Q(Y));case"buffer":if(bt)return Buffer.isBuffer(Y)?Y:ui(Y);case"array":return typeof Y=="string"?xr(Y):Y}return Y}var K;function L(G){try{var ae=G.InflateRaw,Y=new ae;if(Y._processChunk(new Uint8Array([3,0]),Y._finishFlushFlag),Y.bytesRead)K=G;else throw new Error("zlib does not expose bytesRead")}catch(ee){console.error("cannot use native zlib: "+(ee.message||ee))}}function X(G,ae){if(!K)return ls(G,ae);var Y=K.InflateRaw,ee=new Y,re=ee._processChunk(G.slice(G.l),ee._finishFlushFlag);return G.l+=ee.bytesRead,re}function I(G){return K?K.deflateRawSync(G):ot(G)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function H(G){var ae=(G<<1|G<<11)&139536|(G<<5|G<<15)&558144;return(ae>>16|ae>>8|ae)&255}for(var ne=typeof Uint8Array<"u",oe=ne?new Uint8Array(256):[],Se=0;Se<256;++Se)oe[Se]=H(Se);function V(G,ae){var Y=oe[G&255];return ae<=8?Y>>>8-ae:(Y=Y<<8|oe[G>>8&255],ae<=16?Y>>>16-ae:(Y=Y<<8|oe[G>>16&255],Y>>>24-ae))}function be(G,ae){var Y=ae&7,ee=ae>>>3;return(G[ee]|(Y<=6?0:G[ee+1]<<8))>>>Y&3}function Oe(G,ae){var Y=ae&7,ee=ae>>>3;return(G[ee]|(Y<=5?0:G[ee+1]<<8))>>>Y&7}function tt(G,ae){var Y=ae&7,ee=ae>>>3;return(G[ee]|(Y<=4?0:G[ee+1]<<8))>>>Y&15}function Je(G,ae){var Y=ae&7,ee=ae>>>3;return(G[ee]|(Y<=3?0:G[ee+1]<<8))>>>Y&31}function Re(G,ae){var Y=ae&7,ee=ae>>>3;return(G[ee]|(Y<=1?0:G[ee+1]<<8))>>>Y&127}function Rt(G,ae,Y){var ee=ae&7,re=ae>>>3,se=(1<<Y)-1,ve=G[re]>>>ee;return Y<8-ee||(ve|=G[re+1]<<8-ee,Y<16-ee)||(ve|=G[re+2]<<16-ee,Y<24-ee)||(ve|=G[re+3]<<24-ee),ve&se}function un(G,ae,Y){var ee=ae&7,re=ae>>>3;return ee<=5?G[re]|=(Y&7)<<ee:(G[re]|=Y<<ee&255,G[re+1]=(Y&7)>>8-ee),ae+3}function hn(G,ae,Y){var ee=ae&7,re=ae>>>3;return Y=(Y&1)<<ee,G[re]|=Y,ae+1}function Cn(G,ae,Y){var ee=ae&7,re=ae>>>3;return Y<<=ee,G[re]|=Y&255,Y>>>=8,G[re+1]=Y,ae+8}function Ha(G,ae,Y){var ee=ae&7,re=ae>>>3;return Y<<=ee,G[re]|=Y&255,Y>>>=8,G[re+1]=Y&255,G[re+2]=Y>>>8,ae+16}function Bn(G,ae){var Y=G.length,ee=2*Y>ae?2*Y:ae+5,re=0;if(Y>=ae)return G;if(bt){var se=oN(ee);if(G.copy)G.copy(se);else for(;re<G.length;++re)se[re]=G[re];return se}else if(ne){var ve=new Uint8Array(ee);if(ve.set)ve.set(G);else for(;re<Y;++re)ve[re]=G[re];return ve}return G.length=ee,G}function Be(G){for(var ae=new Array(G),Y=0;Y<G;++Y)ae[Y]=0;return ae}function Qe(G,ae,Y){var ee=1,re=0,se=0,ve=0,Ce=0,ye=G.length,Ne=ne?new Uint16Array(32):Be(32);for(se=0;se<32;++se)Ne[se]=0;for(se=ye;se<Y;++se)G[se]=0;ye=G.length;var je=ne?new Uint16Array(ye):Be(ye);for(se=0;se<ye;++se)Ne[re=G[se]]++,ee<re&&(ee=re),je[se]=0;for(Ne[0]=0,se=1;se<=ee;++se)Ne[se+16]=Ce=Ce+Ne[se-1]<<1;for(se=0;se<ye;++se)Ce=G[se],Ce!=0&&(je[se]=Ne[Ce+16]++);var Pe=0;for(se=0;se<ye;++se)if(Pe=G[se],Pe!=0)for(Ce=V(je[se],ee)>>ee-Pe,ve=(1<<ee+4-Pe)-1;ve>=0;--ve)ae[Ce|ve<<Pe]=Pe&15|se<<4;return ee}var Ct=ne?new Uint16Array(512):Be(512),Ht=ne?new Uint16Array(32):Be(32);if(!ne){for(var kt=0;kt<512;++kt)Ct[kt]=0;for(kt=0;kt<32;++kt)Ht[kt]=0}(function(){for(var G=[],ae=0;ae<32;ae++)G.push(5);Qe(G,Ht,32);var Y=[];for(ae=0;ae<=143;ae++)Y.push(8);for(;ae<=255;ae++)Y.push(9);for(;ae<=279;ae++)Y.push(7);for(;ae<=287;ae++)Y.push(8);Qe(Y,Ct,288)})();var fn=(function(){for(var ae=ne?new Uint8Array(32768):[],Y=0,ee=0;Y<xe.length-1;++Y)for(;ee<xe[Y+1];++ee)ae[ee]=Y;for(;ee<32768;++ee)ae[ee]=29;var re=ne?new Uint8Array(259):[];for(Y=0,ee=0;Y<z.length-1;++Y)for(;ee<z[Y+1];++ee)re[ee]=Y;function se(Ce,ye){for(var Ne=0;Ne<Ce.length;){var je=Math.min(65535,Ce.length-Ne),Pe=Ne+je==Ce.length;for(ye.write_shift(1,+Pe),ye.write_shift(2,je),ye.write_shift(2,~je&65535);je-- >0;)ye[ye.l++]=Ce[Ne++]}return ye.l}function ve(Ce,ye){for(var Ne=0,je=0,Pe=ne?new Uint16Array(32768):[];je<Ce.length;){var ze=Math.min(65535,Ce.length-je);if(ze<10){for(Ne=un(ye,Ne,+(je+ze==Ce.length)),Ne&7&&(Ne+=8-(Ne&7)),ye.l=Ne/8|0,ye.write_shift(2,ze),ye.write_shift(2,~ze&65535);ze-- >0;)ye[ye.l++]=Ce[je++];Ne=ye.l*8;continue}Ne=un(ye,Ne,+(je+ze==Ce.length)+2);for(var qe=0;ze-- >0;){var He=Ce[je];qe=(qe<<5^He)&32767;var Me=-1,mt=0;if((Me=Pe[qe])&&(Me|=je&-32768,Me>je&&(Me-=32768),Me<je))for(;Ce[Me+mt]==Ce[je+mt]&&mt<250;)++mt;if(mt>2){He=re[mt],He<=22?Ne=Cn(ye,Ne,oe[He+1]>>1)-1:(Cn(ye,Ne,3),Ne+=5,Cn(ye,Ne,oe[He-23]>>5),Ne+=3);var Qt=He<8?0:He-4>>2;Qt>0&&(Ha(ye,Ne,mt-z[He]),Ne+=Qt),He=ae[je-Me],Ne=Cn(ye,Ne,oe[He]>>3),Ne-=3;var tn=He<4?0:He-2>>1;tn>0&&(Ha(ye,Ne,je-Me-xe[He]),Ne+=tn);for(var Sn=0;Sn<mt;++Sn)Pe[qe]=je&32767,qe=(qe<<5^Ce[je])&32767,++je;ze-=mt-1}else He<=143?He=He+48:Ne=hn(ye,Ne,1),Ne=Cn(ye,Ne,oe[He]),Pe[qe]=je&32767,++je}Ne=Cn(ye,Ne,0)-1}return ye.l=(Ne+7)/8|0,ye.l}return function(ye,Ne){return ye.length<8?se(ye,Ne):ve(ye,Ne)}})();function ot(G){var ae=Te(50+Math.floor(G.length*1.1)),Y=fn(G,ae);return ae.slice(0,Y)}var Bt=ne?new Uint16Array(32768):Be(32768),Xn=ne?new Uint16Array(32768):Be(32768),en=ne?new Uint16Array(128):Be(128),Ea=1,mi=1;function Ps(G,ae){var Y=Je(G,ae)+257;ae+=5;var ee=Je(G,ae)+1;ae+=5;var re=tt(G,ae)+4;ae+=4;for(var se=0,ve=ne?new Uint8Array(19):Be(19),Ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ye=1,Ne=ne?new Uint8Array(8):Be(8),je=ne?new Uint8Array(8):Be(8),Pe=ve.length,ze=0;ze<re;++ze)ve[W[ze]]=se=Oe(G,ae),ye<se&&(ye=se),Ne[se]++,ae+=3;var qe=0;for(Ne[0]=0,ze=1;ze<=ye;++ze)je[ze]=qe=qe+Ne[ze-1]<<1;for(ze=0;ze<Pe;++ze)(qe=ve[ze])!=0&&(Ce[ze]=je[qe]++);var He=0;for(ze=0;ze<Pe;++ze)if(He=ve[ze],He!=0){qe=oe[Ce[ze]]>>8-He;for(var Me=(1<<7-He)-1;Me>=0;--Me)en[qe|Me<<He]=He&7|ze<<3}var mt=[];for(ye=1;mt.length<Y+ee;)switch(qe=en[Re(G,ae)],ae+=qe&7,qe>>>=3){case 16:for(se=3+be(G,ae),ae+=2,qe=mt[mt.length-1];se-- >0;)mt.push(qe);break;case 17:for(se=3+Oe(G,ae),ae+=3;se-- >0;)mt.push(0);break;case 18:for(se=11+Re(G,ae),ae+=7;se-- >0;)mt.push(0);break;default:mt.push(qe),ye<qe&&(ye=qe);break}var Qt=mt.slice(0,Y),tn=mt.slice(Y);for(ze=Y;ze<286;++ze)Qt[ze]=0;for(ze=ee;ze<30;++ze)tn[ze]=0;return Ea=Qe(Qt,Bt,286),mi=Qe(tn,Xn,30),ae}function Is(G,ae){if(G[0]==3&&!(G[1]&3))return[il(ae),2];for(var Y=0,ee=0,re=oN(ae||1<<18),se=0,ve=re.length>>>0,Ce=0,ye=0;(ee&1)==0;){if(ee=Oe(G,Y),Y+=3,ee>>>1)ee>>1==1?(Ce=9,ye=5):(Y=Ps(G,Y),Ce=Ea,ye=mi);else{Y&7&&(Y+=8-(Y&7));var Ne=G[Y>>>3]|G[(Y>>>3)+1]<<8;if(Y+=32,Ne>0)for(!ae&&ve<se+Ne&&(re=Bn(re,se+Ne),ve=re.length);Ne-- >0;)re[se++]=G[Y>>>3],Y+=8;continue}for(;;){!ae&&ve<se+32767&&(re=Bn(re,se+32767),ve=re.length);var je=Rt(G,Y,Ce),Pe=ee>>>1==1?Ct[je]:Bt[je];if(Y+=Pe&15,Pe>>>=4,(Pe>>>8&255)===0)re[se++]=Pe;else{if(Pe==256)break;Pe-=257;var ze=Pe<8?0:Pe-4>>2;ze>5&&(ze=0);var qe=se+z[Pe];ze>0&&(qe+=Rt(G,Y,ze),Y+=ze),je=Rt(G,Y,ye),Pe=ee>>>1==1?Ht[je]:Xn[je],Y+=Pe&15,Pe>>>=4;var He=Pe<4?0:Pe-2>>1,Me=xe[Pe];for(He>0&&(Me+=Rt(G,Y,He),Y+=He),!ae&&ve<qe&&(re=Bn(re,qe+100),ve=re.length);se<qe;)re[se]=re[se-Me],++se}}}return ae?[re,Y+7>>>3]:[re.slice(0,se),Y+7>>>3]}function ls(G,ae){var Y=G.slice(G.l||0),ee=Is(Y,ae);return G.l+=ee[1],ee[0]}function fi(G,ae){if(G)typeof console<"u"&&console.error(ae);else throw new Error(ae)}function ko(G,ae){var Y=G;da(Y,0);var ee=[],re=[],se={FileIndex:ee,FullPaths:re};C(se,{root:ae.root});for(var ve=Y.length-4;(Y[ve]!=80||Y[ve+1]!=75||Y[ve+2]!=5||Y[ve+3]!=6)&&ve>=0;)--ve;Y.l=ve+4,Y.l+=4;var Ce=Y.read_shift(2);Y.l+=6;var ye=Y.read_shift(4);for(Y.l=ye,ve=0;ve<Ce;++ve){Y.l+=20;var Ne=Y.read_shift(4),je=Y.read_shift(4),Pe=Y.read_shift(2),ze=Y.read_shift(2),qe=Y.read_shift(2);Y.l+=8;var He=Y.read_shift(4),Me=d(Y.slice(Y.l+Pe,Y.l+Pe+ze));Y.l+=Pe+ze+qe;var mt=Y.l;Y.l=He+4,pi(Y,Ne,je,se,Me),Y.l=mt}return se}function pi(G,ae,Y,ee,re){G.l+=2;var se=G.read_shift(2),ve=G.read_shift(2),Ce=o(G);if(se&8257)throw new Error("Unsupported ZIP encryption");for(var ye=G.read_shift(4),Ne=G.read_shift(4),je=G.read_shift(4),Pe=G.read_shift(2),ze=G.read_shift(2),qe="",He=0;He<Pe;++He)qe+=String.fromCharCode(G[G.l++]);if(ze){var Me=d(G.slice(G.l,G.l+ze));(Me[21589]||{}).mt&&(Ce=Me[21589].mt),((re||{})[21589]||{}).mt&&(Ce=re[21589].mt)}G.l+=ze;var mt=G.slice(G.l,G.l+Ne);switch(ve){case 8:mt=X(G,je);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ve)}var Qt=!1;se&8&&(ye=G.read_shift(4),ye==134695760&&(ye=G.read_shift(4),Qt=!0),Ne=G.read_shift(4),je=G.read_shift(4)),Ne!=ae&&fi(Qt,"Bad compressed size: "+ae+" != "+Ne),je!=Y&&fi(Qt,"Bad uncompressed size: "+Y+" != "+je),Os(ee,qe,mt,{unsafe:!0,mt:Ce})}function gi(G,ae){var Y=ae||{},ee=[],re=[],se=Te(1),ve=Y.compression?8:0,Ce=0,ye=0,Ne=0,je=0,Pe=0,ze=G.FullPaths[0],qe=ze,He=G.FileIndex[0],Me=[],mt=0;for(ye=1;ye<G.FullPaths.length;++ye)if(qe=G.FullPaths[ye].slice(ze.length),He=G.FileIndex[ye],!(!He.size||!He.content||qe=="Sh33tJ5")){var Qt=je,tn=Te(qe.length);for(Ne=0;Ne<qe.length;++Ne)tn.write_shift(1,qe.charCodeAt(Ne)&127);tn=tn.slice(0,tn.l),Me[Pe]=PF.buf(He.content,0);var Sn=He.content;ve==8&&(Sn=I(Sn)),se=Te(30),se.write_shift(4,67324752),se.write_shift(2,20),se.write_shift(2,Ce),se.write_shift(2,ve),He.mt?l(se,He.mt):se.write_shift(4,0),se.write_shift(-4,Me[Pe]),se.write_shift(4,Sn.length),se.write_shift(4,He.content.length),se.write_shift(2,tn.length),se.write_shift(2,0),je+=se.length,ee.push(se),je+=tn.length,ee.push(tn),je+=Sn.length,ee.push(Sn),se=Te(46),se.write_shift(4,33639248),se.write_shift(2,0),se.write_shift(2,20),se.write_shift(2,Ce),se.write_shift(2,ve),se.write_shift(4,0),se.write_shift(-4,Me[Pe]),se.write_shift(4,Sn.length),se.write_shift(4,He.content.length),se.write_shift(2,tn.length),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(4,0),se.write_shift(4,Qt),mt+=se.l,re.push(se),mt+=tn.length,re.push(tn),++Pe}return se=Te(22),se.write_shift(4,101010256),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,Pe),se.write_shift(2,Pe),se.write_shift(4,mt),se.write_shift(4,je),se.write_shift(2,0),aa([aa(ee),aa(re),se])}var fl={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Lu(G,ae){if(G.ctype)return G.ctype;var Y=G.name||"",ee=Y.match(/\.([^\.]+)$/);return ee&&fl[ee[1]]||ae&&(ee=(Y=ae).match(/[\.\\]([^\.\\])+$/),ee&&fl[ee[1]])?fl[ee[1]]:"application/octet-stream"}function Pu(G){for(var ae=Jd(G),Y=[],ee=0;ee<ae.length;ee+=76)Y.push(ae.slice(ee,ee+76));return Y.join(`\r
`)+`\r
`}function Iu(G){var ae=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ne){var je=Ne.charCodeAt(0).toString(16).toUpperCase();return"="+(je.length==1?"0"+je:je)});ae=ae.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ae.charAt(0)==`
`&&(ae="=0D"+ae.slice(1)),ae=ae.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Y=[],ee=ae.split(`\r
`),re=0;re<ee.length;++re){var se=ee[re];if(se.length==0){Y.push("");continue}for(var ve=0;ve<se.length;){var Ce=76,ye=se.slice(ve,ve+Ce);ye.charAt(Ce-1)=="="?Ce--:ye.charAt(Ce-2)=="="?Ce-=2:ye.charAt(Ce-3)=="="&&(Ce-=3),ye=se.slice(ve,ve+Ce),ve+=Ce,ve<se.length&&(ye+="="),Y.push(ye)}}return Y.join(`\r
`)}function Ou(G){for(var ae=[],Y=0;Y<G.length;++Y){for(var ee=G[Y];Y<=G.length&&ee.charAt(ee.length-1)=="=";)ee=ee.slice(0,ee.length-1)+G[++Y];ae.push(ee)}for(var re=0;re<ae.length;++re)ae[re]=ae[re].replace(/[=][0-9A-Fa-f]{2}/g,function(se){return String.fromCharCode(parseInt(se.slice(1),16))});return xr(ae.join(`\r
`))}function Hc(G,ae,Y){for(var ee="",re="",se="",ve,Ce=0;Ce<10;++Ce){var ye=ae[Ce];if(!ye||ye.match(/^\s*$/))break;var Ne=ye.match(/^(.*?):\s*([^\s].*)$/);if(Ne)switch(Ne[1].toLowerCase()){case"content-location":ee=Ne[2].trim();break;case"content-type":se=Ne[2].trim();break;case"content-transfer-encoding":re=Ne[2].trim();break}}switch(++Ce,re.toLowerCase()){case"base64":ve=xr(vr(ae.slice(Ce).join("")));break;case"quoted-printable":ve=Ou(ae.slice(Ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+re)}var je=Os(G,ee.slice(Y.length),ve,{unsafe:!0});se&&(je.ctype=se)}function Mu(G,ae){if(Q(G.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Y=ae&&ae.root||"",ee=(bt&&Buffer.isBuffer(G)?G.toString("binary"):Q(G)).split(`\r
`),re=0,se="";for(re=0;re<ee.length;++re)if(se=ee[re],!!/^Content-Location:/i.test(se)&&(se=se.slice(se.indexOf("file")),Y||(Y=se.slice(0,se.lastIndexOf("/")+1)),se.slice(0,Y.length)!=Y))for(;Y.length>0&&(Y=Y.slice(0,Y.length-1),Y=Y.slice(0,Y.lastIndexOf("/")+1),se.slice(0,Y.length)!=Y););var ve=(ee[1]||"").match(/boundary="(.*?)"/);if(!ve)throw new Error("MAD cannot find boundary");var Ce="--"+(ve[1]||""),ye=[],Ne=[],je={FileIndex:ye,FullPaths:Ne};C(je);var Pe,ze=0;for(re=0;re<ee.length;++re){var qe=ee[re];qe!==Ce&&qe!==Ce+"--"||(ze++&&Hc(je,ee.slice(Pe,re),Y),Pe=re)}return je}function pl(G,ae){var Y=ae||{},ee=Y.boundary||"SheetJS";ee="------="+ee;for(var re=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ee.slice(2)+'"',"","",""],se=G.FullPaths[0],ve=se,Ce=G.FileIndex[0],ye=1;ye<G.FullPaths.length;++ye)if(ve=G.FullPaths[ye].slice(se.length),Ce=G.FileIndex[ye],!(!Ce.size||!Ce.content||ve=="Sh33tJ5")){ve=ve.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(mt){return"_x"+mt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(mt){return"_u"+mt.charCodeAt(0).toString(16)+"_"});for(var Ne=Ce.content,je=bt&&Buffer.isBuffer(Ne)?Ne.toString("binary"):Q(Ne),Pe=0,ze=Math.min(1024,je.length),qe=0,He=0;He<=ze;++He)(qe=je.charCodeAt(He))>=32&&qe<128&&++Pe;var Me=Pe>=ze*4/5;re.push(ee),re.push("Content-Location: "+(Y.root||"file:///C:/SheetJS/")+ve),re.push("Content-Transfer-Encoding: "+(Me?"quoted-printable":"base64")),re.push("Content-Type: "+Lu(Ce,ve)),re.push(""),re.push(Me?Iu(je):Pu(je))}return re.push(ee+`--\r
`),re.join(`\r
`)}function Vc(G){var ae={};return C(ae,G),ae}function Os(G,ae,Y,ee){var re=ee&&ee.unsafe;re||C(G);var se=!re&&rt.find(G,ae);if(!se){var ve=G.FullPaths[0];ae.slice(0,ve.length)==ve?ve=ae:(ve.slice(-1)!="/"&&(ve+="/"),ve=(ve+ae).replace("//","/")),se={name:s(ae),type:2},G.FileIndex.push(se),G.FullPaths.push(ve),re||rt.utils.cfb_gc(G)}return se.content=Y,se.size=Y?Y.length:0,ee&&(ee.CLSID&&(se.clsid=ee.CLSID),ee.mt&&(se.mt=ee.mt),ee.ct&&(se.ct=ee.ct)),se}function px(G,ae){C(G);var Y=rt.find(G,ae);if(Y){for(var ee=0;ee<G.FileIndex.length;++ee)if(G.FileIndex[ee]==Y)return G.FileIndex.splice(ee,1),G.FullPaths.splice(ee,1),!0}return!1}function gl(G,ae,Y){C(G);var ee=rt.find(G,ae);if(ee){for(var re=0;re<G.FileIndex.length;++re)if(G.FileIndex[re]==ee)return G.FileIndex[re].name=s(Y),G.FullPaths[re]=Y,!0}return!1}function To(G){F(G,!0)}return n.find=O,n.read=E,n.parse=m,n.write=fe,n.writeFile=Z,n.utils={cfb_new:Vc,cfb_add:Os,cfb_del:px,cfb_mov:gl,cfb_gc:To,ReadShift:Rd,CheckField:rk,prep_blob:da,bconcat:aa,use_zlib:L,_deflateRaw:ot,_inflateRaw:ls,consts:te},n})();function IF(e){return typeof e=="string"?lx(e):Array.isArray(e)?lF(e):e}function Tu(e,n,a){if(typeof Deno<"u"){if(a&&typeof n=="string")switch(a){case"utf8":n=new TextEncoder(a).encode(n);break;case"binary":n=lx(n);break;default:throw new Error("Unsupported encoding "+a)}return Deno.writeFileSync(e,n)}var r=a=="utf8"?Cs(n):n;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,e);if(typeof Blob<"u"){var s=new Blob([IF(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=l,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var d=File(e);return d.open("w"),d.encoding="binary",Array.isArray(n)&&(n=hl(n)),d.write(n),d.close(),n}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+e)}function OF(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(e);n.open("r"),n.encoding="binary";var a=n.read();return n.close(),a}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function Tn(e){for(var n=Object.keys(e),a=[],r=0;r<n.length;++r)Object.prototype.hasOwnProperty.call(e,n[r])&&a.push(n[r]);return a}function pN(e,n){for(var a=[],r=Tn(e),s=0;s!==r.length;++s)a[e[r[s]][n]]==null&&(a[e[r[s]][n]]=r[s]);return a}function cx(e){for(var n=[],a=Tn(e),r=0;r!==a.length;++r)n[e[a[r]]]=a[r];return n}function dx(e){for(var n=[],a=Tn(e),r=0;r!==a.length;++r)n[e[a[r]]]=parseInt(a[r],10);return n}function MF(e){for(var n=[],a=Tn(e),r=0;r!==a.length;++r)n[e[a[r]]]==null&&(n[e[a[r]]]=[]),n[e[a[r]]].push(a[r]);return n}var F0=new Date(1899,11,30,0,0,0);function Wn(e,n){var a=e.getTime(),r=F0.getTime()+(e.getTimezoneOffset()-F0.getTimezoneOffset())*6e4;return(a-r)/(1440*60*1e3)}var Mw=new Date,RF=F0.getTime()+(Mw.getTimezoneOffset()-F0.getTimezoneOffset())*6e4,gN=Mw.getTimezoneOffset();function ux(e){var n=new Date;return n.setTime(e*24*60*60*1e3+RF),n.getTimezoneOffset()!==gN&&n.setTime(n.getTime()+(n.getTimezoneOffset()-gN)*6e4),n}function BF(e){var n=0,a=0,r=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=s.length;++l)if(s[l]){switch(a=1,l>3&&(r=!0),s[l].slice(s[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[l].slice(s[l].length-1));case"D":a*=24;case"H":a*=60;case"M":if(r)a*=60;else throw new Error("Unsupported ISO Duration Field: M")}n+=a*parseInt(s[l],10)}return n}var yN=new Date("2017-02-19T19:06:09.000Z"),Rw=isNaN(yN.getFullYear())?new Date("2/19/17"):yN,HF=Rw.getFullYear()==2017;function cn(e,n){var a=new Date(e);if(HF)return n>0?a.setTime(a.getTime()+a.getTimezoneOffset()*60*1e3):n<0&&a.setTime(a.getTime()-a.getTimezoneOffset()*60*1e3),a;if(e instanceof Date)return e;if(Rw.getFullYear()==1917&&!isNaN(a.getFullYear())){var r=a.getFullYear();return e.indexOf(""+r)>-1||a.setFullYear(a.getFullYear()+100),a}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function oo(e,n){if(bt&&Buffer.isBuffer(e)){if(n){if(e[0]==255&&e[1]==254)return Cs(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Cs(Tw(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(e[0]==255&&e[1]==254)return Cs(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Cs(new TextDecoder("utf-16be").decode(e.slice(2)))}var a={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return a[l]||l})}catch{}for(var r=[],s=0;s!=e.length;++s)r.push(String.fromCharCode(e[s]));return r.join("")}function dn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=dn(e[a]));return n}function wn(e,n){for(var a="";a.length<n;)a+=e;return a}function as(e){var n=Number(e);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(e))return n;var a=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return a*=100,""});return!isNaN(n=Number(r))||(r=r.replace(/[(](.*)[)]/,function(s,l){return a=-a,l}),!isNaN(n=Number(r)))?n/a:n}var VF=["january","february","march","april","may","june","july","august","september","october","november","december"];function Sc(e){var n=new Date(e),a=new Date(NaN),r=n.getYear(),s=n.getMonth(),l=n.getDate();if(isNaN(l))return a;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&VF.indexOf(o)==-1)return a}else if(o.match(/[a-z]/))return a;return r<0||r>8099?a:(s>0||l>1)&&r!=101?n:e.match(/[^-0-9:,\/\\]/)?a:n}var UF=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(a,r,s){if(e||typeof r=="string")return a.split(r);for(var l=a.split(r),o=[l[0]],d=1;d<l.length;++d)o.push(s),o.push(l[d]);return o}})();function Bw(e){return e?e.content&&e.type?oo(e.content,!0):e.data?Fd(e.data):e.asNodeBuffer&&bt?Fd(e.asNodeBuffer().toString("binary")):e.asBinary?Fd(e.asBinary()):e._data&&e._data.getContent?Fd(oo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Hw(e){if(!e)return null;if(e.data)return iN(e.data);if(e.asNodeBuffer&&bt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var n=e._data.getContent();return typeof n=="string"?iN(n):Array.prototype.slice.call(n)}return e.content&&e.type?e.content:null}function KF(e){return e&&e.name.slice(-4)===".bin"?Hw(e):Bw(e)}function Fr(e,n){for(var a=e.FullPaths||Tn(e.files),r=n.toLowerCase().replace(/[\/]/g,"\\"),s=r.replace(/\\/g,"/"),l=0;l<a.length;++l){var o=a[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==o||s==o)return e.files?e.files[a[l]]:e.FileIndex[l]}return null}function Tg(e,n){var a=Fr(e,n);if(a==null)throw new Error("Cannot find file "+n+" in zip");return a}function On(e,n,a){if(!a)return KF(Tg(e,n));if(!n)return null;try{return On(e,n)}catch{return null}}function mr(e,n,a){if(!a)return Bw(Tg(e,n));if(!n)return null;try{return mr(e,n)}catch{return null}}function zF(e,n,a){return Hw(Tg(e,n))}function vN(e){for(var n=e.FullPaths||Tn(e.files),a=[],r=0;r<n.length;++r)n[r].slice(-1)!="/"&&a.push(n[r].replace(/^Root Entry[\/]/,""));return a.sort()}function yt(e,n,a){if(e.FullPaths){if(typeof a=="string"){var r;return bt?r=ui(a):r=oF(a),rt.utils.cfb_add(e,n,r)}rt.utils.cfb_add(e,n,a)}else e.file(n,a)}function Cg(){return rt.utils.cfb_new()}function Vw(e,n){switch(n.type){case"base64":return rt.read(e,{type:"base64"});case"binary":return rt.read(e,{type:"binary"});case"buffer":case"array":return rt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function Pd(e,n){if(e.charAt(0)=="/")return e.slice(1);var a=n.split("/");n.slice(-1)!="/"&&a.pop();for(var r=e.split("/");r.length!==0;){var s=r.shift();s===".."?a.pop():s!=="."&&a.push(s)}return a.join("/")}var Ln=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,$F=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,bN=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,GF=/<[^>]*>/g,_a=Ln.match(bN)?bN:GF,qF=/<\w*:/,WF=/<(\/?)\w+:/;function ut(e,n,a){for(var r={},s=0,l=0;s!==e.length&&!((l=e.charCodeAt(s))===32||l===10||l===13);++s);if(n||(r[0]=e.slice(0,s)),s===e.length)return r;var o=e.match($F),d=0,u="",x=0,m="",f="",p=1;if(o)for(x=0;x!=o.length;++x){for(f=o[x],l=0;l!=f.length&&f.charCodeAt(l)!==61;++l);for(m=f.slice(0,l).trim();f.charCodeAt(l+1)==32;)++l;for(p=(s=f.charCodeAt(l+1))==34||s==39?1:0,u=f.slice(l+1+p,f.length-p),d=0;d!=m.length&&m.charCodeAt(d)!==58;++d);if(d===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),r[m]=u,r[m.toLowerCase()]=u;else{var N=(d===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(d+1);if(r[N]&&m.slice(d-3,d)=="ext")continue;r[N]=u,r[N.toLowerCase()]=u}}return r}function Fs(e){return e.replace(WF,"<$1")}var Uw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Sg=cx(Uw),Ft=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function a(r){var s=r+"",l=s.indexOf("<![CDATA[");if(l==-1)return s.replace(e,function(d,u){return Uw[d]||String.fromCharCode(parseInt(u,d.indexOf("x")>-1?16:10))||d}).replace(n,function(d,u){return String.fromCharCode(parseInt(u,16))});var o=s.indexOf("]]>");return a(s.slice(0,l))+s.slice(l+9,o)+a(s.slice(o+3))}})(),_g=/[&<>'"]/g,XF=/[\u0000-\u0008\u000b-\u001f]/g;function qt(e){var n=e+"";return n.replace(_g,function(a){return Sg[a]}).replace(XF,function(a){return"_x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+"_"})}function NN(e){return qt(e).replace(/ /g,"_x0020_")}var Kw=/[\u0000-\u001f]/g;function Eg(e){var n=e+"";return n.replace(_g,function(a){return Sg[a]}).replace(/\n/g,"<br/>").replace(Kw,function(a){return"&#x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+";"})}function QF(e){var n=e+"";return n.replace(_g,function(a){return Sg[a]}).replace(Kw,function(a){return"&#x"+a.charCodeAt(0).toString(16).toUpperCase()+";"})}var jN=(function(){var e=/&#(\d+);/g;function n(a,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,n)}})();function YF(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function ln(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function _f(e){for(var n="",a=0,r=0,s=0,l=0,o=0,d=0;a<e.length;){if(r=e.charCodeAt(a++),r<128){n+=String.fromCharCode(r);continue}if(s=e.charCodeAt(a++),r>191&&r<224){o=(r&31)<<6,o|=s&63,n+=String.fromCharCode(o);continue}if(l=e.charCodeAt(a++),r<240){n+=String.fromCharCode((r&15)<<12|(s&63)<<6|l&63);continue}o=e.charCodeAt(a++),d=((r&7)<<18|(s&63)<<12|(l&63)<<6|o&63)-65536,n+=String.fromCharCode(55296+(d>>>10&1023)),n+=String.fromCharCode(56320+(d&1023))}return n}function wN(e){var n=il(2*e.length),a,r,s=1,l=0,o=0,d;for(r=0;r<e.length;r+=s)s=1,(d=e.charCodeAt(r))<128?a=d:d<224?(a=(d&31)*64+(e.charCodeAt(r+1)&63),s=2):d<240?(a=(d&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),s=3):(s=4,a=(d&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),a-=65536,o=55296+(a>>>10&1023),a=56320+(a&1023)),o!==0&&(n[l++]=o&255,n[l++]=o>>>8,o=0),n[l++]=a%256,n[l++]=a>>>8;return n.slice(0,l).toString("ucs2")}function kN(e){return ui(e,"binary").toString("utf8")}var Yh="foo bar baz",Xt=bt&&(kN(Yh)==_f(Yh)&&kN||wN(Yh)==_f(Yh)&&wN)||_f,Cs=bt?function(e){return ui(e,"utf8").toString("binary")}:function(e){for(var n=[],a=0,r=0,s=0;a<e.length;)switch(r=e.charCodeAt(a++),!0){case r<128:n.push(String.fromCharCode(r));break;case r<2048:n.push(String.fromCharCode(192+(r>>6))),n.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,s=e.charCodeAt(a++)-56320+(r<<10),n.push(String.fromCharCode(240+(s>>18&7))),n.push(String.fromCharCode(144+(s>>12&63))),n.push(String.fromCharCode(128+(s>>6&63))),n.push(String.fromCharCode(128+(s&63)));break;default:n.push(String.fromCharCode(224+(r>>12))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(r&63)))}return n.join("")},eu=(function(){var e={};return function(a,r){var s=a+"|"+(r||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+a+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+a+">",r||"")}})(),zw=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(a){for(var r=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)r=r.replace(e[s][0],e[s][1]);return r}})(),JF=(function(){var e={};return function(a){return e[a]!==void 0?e[a]:e[a]=new RegExp("<(?:vt:)?"+a+">([\\s\\S]*?)</(?:vt:)?"+a+">","g")}})(),ZF=/<\/?(?:vt:)?variant>/g,e8=/<(?:vt:)([^>]*)>([\s\S]*)</;function TN(e,n){var a=ut(e),r=e.match(JF(a.baseType))||[],s=[];if(r.length!=a.size){if(n.WTF)throw new Error("unexpected vector length "+r.length+" != "+a.size);return s}return r.forEach(function(l){var o=l.replace(ZF,"").match(e8);o&&s.push({v:Xt(o[2]),t:o[1]})}),s}var $w=/(^\s|\s$|\n)/;function xa(e,n){return"<"+e+(n.match($w)?' xml:space="preserve"':"")+">"+n+"</"+e+">"}function tu(e){return Tn(e).map(function(n){return" "+n+'="'+e[n]+'"'}).join("")}function Ue(e,n,a){return"<"+e+(a!=null?tu(a):"")+(n!=null?(n.match($w)?' xml:space="preserve"':"")+">"+n+"</"+e:"/")+">"}function _p(e,n){try{return e.toISOString().replace(/\.\d*/,"")}catch(a){if(n)throw a}return""}function t8(e,n){switch(typeof e){case"string":var a=Ue("vt:lpwstr",qt(e));return a=a.replace(/&quot;/g,"_x0022_"),a;case"number":return Ue((e|0)==e?"vt:i4":"vt:r8",qt(String(e)));case"boolean":return Ue("vt:bool",e?"true":"false")}if(e instanceof Date)return Ue("vt:filetime",_p(e));throw new Error("Unable to serialize "+e)}function Dg(e){if(bt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Xt(hl(jg(e)));throw new Error("Bad input format: expected Buffer or string")}var nu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,$n={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},po=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ur={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function n8(e,n){for(var a=1-2*(e[n+7]>>>7),r=((e[n+7]&127)<<4)+(e[n+6]>>>4&15),s=e[n+6]&15,l=5;l>=0;--l)s=s*256+e[n+l];return r==2047?s==0?a*(1/0):NaN:(r==0?r=-1022:(r-=1023,s+=Math.pow(2,52)),a*Math.pow(2,r-52)*s)}function a8(e,n,a){var r=(n<0||1/n==-1/0?1:0)<<7,s=0,l=0,o=r?-n:n;isFinite(o)?o==0?s=l=0:(s=Math.floor(Math.log(o)/Math.LN2),l=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?s=-1022:(l-=Math.pow(2,52),s+=1023)):(s=2047,l=isNaN(n)?26985:0);for(var d=0;d<=5;++d,l/=256)e[a+d]=l&255;e[a+6]=(s&15)<<4|l&15,e[a+7]=s>>4|r}var CN=function(e){for(var n=[],a=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var s=0,l=e[0][r].length;s<l;s+=a)n.push.apply(n,e[0][r].slice(s,s+a));return n},SN=bt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(n){return Buffer.isBuffer(n)?n:ui(n)})):CN(e)}:CN,_N=function(e,n,a){for(var r=[],s=n;s<a;s+=2)r.push(String.fromCharCode(Zs(e,s)));return r.join("").replace(Ba,"")},Ag=bt?function(e,n,a){return Buffer.isBuffer(e)?e.toString("utf16le",n,a).replace(Ba,""):_N(e,n,a)}:_N,EN=function(e,n,a){for(var r=[],s=n;s<n+a;++s)r.push(("0"+e[s].toString(16)).slice(-2));return r.join("")},Gw=bt?function(e,n,a){return Buffer.isBuffer(e)?e.toString("hex",n,n+a):EN(e,n,a)}:EN,DN=function(e,n,a){for(var r=[],s=n;s<a;s++)r.push(String.fromCharCode(nc(e,s)));return r.join("")},Cu=bt?function(n,a,r){return Buffer.isBuffer(n)?n.toString("utf8",a,r):DN(n,a,r)}:DN,qw=function(e,n){var a=hr(e,n);return a>0?Cu(e,n+4,n+4+a-1):""},Ww=qw,Xw=function(e,n){var a=hr(e,n);return a>0?Cu(e,n+4,n+4+a-1):""},Qw=Xw,Yw=function(e,n){var a=2*hr(e,n);return a>0?Cu(e,n+4,n+4+a-1):""},Jw=Yw,Zw=function(n,a){var r=hr(n,a);return r>0?Ag(n,a+4,a+4+r):""},ek=Zw,tk=function(e,n){var a=hr(e,n);return a>0?Cu(e,n+4,n+4+a):""},nk=tk,ak=function(e,n){return n8(e,n)},L0=ak,Fg=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};bt&&(Ww=function(n,a){if(!Buffer.isBuffer(n))return qw(n,a);var r=n.readUInt32LE(a);return r>0?n.toString("utf8",a+4,a+4+r-1):""},Qw=function(n,a){if(!Buffer.isBuffer(n))return Xw(n,a);var r=n.readUInt32LE(a);return r>0?n.toString("utf8",a+4,a+4+r-1):""},Jw=function(n,a){if(!Buffer.isBuffer(n))return Yw(n,a);var r=2*n.readUInt32LE(a);return n.toString("utf16le",a+4,a+4+r-1)},ek=function(n,a){if(!Buffer.isBuffer(n))return Zw(n,a);var r=n.readUInt32LE(a);return n.toString("utf16le",a+4,a+4+r)},nk=function(n,a){if(!Buffer.isBuffer(n))return tk(n,a);var r=n.readUInt32LE(a);return n.toString("utf8",a+4,a+4+r)},L0=function(n,a){return Buffer.isBuffer(n)?n.readDoubleLE(a):ak(n,a)},Fg=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var nc=function(e,n){return e[n]},Zs=function(e,n){return e[n+1]*256+e[n]},r8=function(e,n){var a=e[n+1]*256+e[n];return a<32768?a:(65535-a+1)*-1},hr=function(e,n){return e[n+3]*(1<<24)+(e[n+2]<<16)+(e[n+1]<<8)+e[n]},Rl=function(e,n){return e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]},s8=function(e,n){return e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]};function Rd(e,n){var a="",r,s,l=[],o,d,u,x;switch(n){case"dbcs":if(x=this.l,bt&&Buffer.isBuffer(this))a=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)a+=String.fromCharCode(Zs(this,x)),x+=2;e*=2;break;case"utf8":a=Cu(this,this.l,this.l+e);break;case"utf16le":e*=2,a=Ag(this,this.l,this.l+e);break;case"wstr":return Rd.call(this,e,"dbcs");case"lpstr-ansi":a=Ww(this,this.l),e=4+hr(this,this.l);break;case"lpstr-cp":a=Qw(this,this.l),e=4+hr(this,this.l);break;case"lpwstr":a=Jw(this,this.l),e=4+2*hr(this,this.l);break;case"lpp4":e=4+hr(this,this.l),a=ek(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+hr(this,this.l),a=nk(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,a="";(o=nc(this,this.l+e++))!==0;)l.push(Qh(o));a=l.join("");break;case"_wstr":for(e=0,a="";(o=Zs(this,this.l+e))!==0;)l.push(Qh(o)),e+=2;e+=2,a=l.join("");break;case"dbcs-cont":for(a="",x=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(x)!==-1)return o=nc(this,x),this.l=x+1,d=Rd.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),l.join("")+d;l.push(Qh(Zs(this,x))),x+=2}a=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(a="",x=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(x)!==-1)return o=nc(this,x),this.l=x+1,d=Rd.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),l.join("")+d;l.push(Qh(nc(this,x))),x+=1}a=l.join("");break;default:switch(e){case 1:return r=nc(this,this.l),this.l++,r;case 2:return r=(n==="i"?r8:Zs)(this,this.l),this.l+=2,r;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(r=(e>0?Rl:s8)(this,this.l),this.l+=4,r):(s=hr(this,this.l),this.l+=4,s);case 8:case-8:if(n==="f")return e==8?s=L0(this,this.l):s=L0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:a=Gw(this,this.l,e);break}}return this.l+=e,a}var i8=function(e,n,a){e[a]=n&255,e[a+1]=n>>>8&255,e[a+2]=n>>>16&255,e[a+3]=n>>>24&255},l8=function(e,n,a){e[a]=n&255,e[a+1]=n>>8&255,e[a+2]=n>>16&255,e[a+3]=n>>24&255},o8=function(e,n,a){e[a]=n&255,e[a+1]=n>>>8&255};function c8(e,n,a){var r=0,s=0;if(a==="dbcs"){for(s=0;s!=n.length;++s)o8(this,n.charCodeAt(s),this.l+2*s);r=2*n.length}else if(a==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=n.length;++s)this[this.l+s]=n.charCodeAt(s)&255;r=n.length}else if(a==="hex"){for(;s<e;++s)this[this.l++]=parseInt(n.slice(2*s,2*s+2),16)||0;return this}else if(a==="utf16le"){var l=Math.min(this.l+e,this.length);for(s=0;s<Math.min(n.length,e);++s){var o=n.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=n&255;break;case 2:r=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:r=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:r=4,i8(this,n,this.l);break;case 8:if(r=8,a==="f"){a8(this,n,this.l);break}case 16:break;case-4:r=4,l8(this,n,this.l);break}return this.l+=r,this}function rk(e,n){var a=Gw(this,this.l,e.length>>1);if(a!==e)throw new Error(n+"Expected "+e+" saw "+a);this.l+=e.length>>1}function da(e,n){e.l=n,e.read_shift=Rd,e.chk=rk,e.write_shift=c8}function Sa(e,n){e.l+=n}function Te(e){var n=il(e);return da(n,0),n}function hi(e,n,a){if(e){var r,s,l;da(e,e.l||0);for(var o=e.length,d=0,u=0;e.l<o;){d=e.read_shift(1),d&128&&(d=(d&127)+((e.read_shift(1)&127)<<7));var x=ou[d]||ou[65535];for(r=e.read_shift(1),l=r&127,s=1;s<4&&r&128;++s)l+=((r=e.read_shift(1))&127)<<7*s;u=e.l+l;var m=x.f&&x.f(e,l,a);if(e.l=u,n(m,x,d))return}}}function rr(){var e=[],n=bt?256:2048,a=function(x){var m=Te(x);return da(m,0),m},r=a(n),s=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},l=function(x){return r&&x<r.length-r.l?r:(s(),r=a(Math.max(x+1,n)))},o=function(){return s(),aa(e)},d=function(x){s(),r=x,r.l==null&&(r.l=r.length),l(n)};return{next:l,push:d,end:o,_bufs:e}}function Ee(e,n,a,r){var s=+n,l;if(!isNaN(s)){r||(r=ou[s].p||(a||[]).length||0),l=1+(s>=128?1:0)+1,r>=128&&++l,r>=16384&&++l,r>=2097152&&++l;var o=e.next(l);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var d=0;d!=4;++d)if(r>=128)o.write_shift(1,(r&127)+128),r>>=7;else{o.write_shift(1,r);break}r>0&&Fg(a)&&e.push(a)}}function Bd(e,n,a){var r=dn(e);if(n.s?(r.cRel&&(r.c+=n.s.c),r.rRel&&(r.r+=n.s.r)):(r.cRel&&(r.c+=n.c),r.rRel&&(r.r+=n.r)),!a||a.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function AN(e,n,a){var r=dn(e);return r.s=Bd(r.s,n.s,a),r.e=Bd(r.e,n.s,a),r}function Hd(e,n){if(e.cRel&&e.c<0)for(e=dn(e);e.c<0;)e.c+=n>8?16384:256;if(e.rRel&&e.r<0)for(e=dn(e);e.r<0;)e.r+=n>8?1048576:n>5?65536:16384;var a=dt(e);return!e.cRel&&e.cRel!=null&&(a=h8(a)),!e.rRel&&e.rRel!=null&&(a=d8(a)),a}function Ef(e,n){return e.s.r==0&&!e.s.rRel&&e.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+vn(e.s.c)+":"+(e.e.cRel?"":"$")+vn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(n.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Fn(e.s.r)+":"+(e.e.rRel?"":"$")+Fn(e.e.r):Hd(e.s,n.biff)+":"+Hd(e.e,n.biff)}function Lg(e){return parseInt(u8(e),10)-1}function Fn(e){return""+(e+1)}function d8(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function u8(e){return e.replace(/\$(\d+)$/,"$1")}function Pg(e){for(var n=x8(e),a=0,r=0;r!==n.length;++r)a=26*a+n.charCodeAt(r)-64;return a-1}function vn(e){if(e<0)throw new Error("invalid column "+e);var n="";for(++e;e;e=Math.floor((e-1)/26))n=String.fromCharCode((e-1)%26+65)+n;return n}function h8(e){return e.replace(/^([A-Z])/,"$$$1")}function x8(e){return e.replace(/^\$([A-Z])/,"$1")}function m8(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function bn(e){for(var n=0,a=0,r=0;r<e.length;++r){var s=e.charCodeAt(r);s>=48&&s<=57?n=10*n+(s-48):s>=65&&s<=90&&(a=26*a+(s-64))}return{c:a-1,r:n-1}}function dt(e){for(var n=e.c+1,a="";n;n=(n-1)/26|0)a=String.fromCharCode((n-1)%26+65)+a;return a+(e.r+1)}function sr(e){var n=e.indexOf(":");return n==-1?{s:bn(e),e:bn(e)}:{s:bn(e.slice(0,n)),e:bn(e.slice(n+1))}}function gt(e,n){return typeof n>"u"||typeof n=="number"?gt(e.s,e.e):(typeof e!="string"&&(e=dt(e)),typeof n!="string"&&(n=dt(n)),e==n?e:e+":"+n)}function Pt(e){var n={s:{c:0,r:0},e:{c:0,r:0}},a=0,r=0,s=0,l=e.length;for(a=0;r<l&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)a=26*a+s;for(n.s.c=--a,a=0;r<l&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)a=10*a+s;if(n.s.r=--a,r===l||s!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++r,a=0;r!=l&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)a=26*a+s;for(n.e.c=--a,a=0;r!=l&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)a=10*a+s;return n.e.r=--a,n}function FN(e,n){var a=e.t=="d"&&n instanceof Date;if(e.z!=null)try{return e.w=Hr(e.z,a?Wn(n):n)}catch{}try{return e.w=Hr((e.XF||{}).numFmtId||(a?14:0),a?Wn(n):n)}catch{return""+n}}function ci(e,n,a){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&a&&a.dateNF&&(e.z=a.dateNF),e.t=="e"?xi[e.v]||e.v:n==null?FN(e,e.v):FN(e,n))}function xl(e,n){var a=n&&n.sheet?n.sheet:"Sheet1",r={};return r[a]=e,{SheetNames:[a],Sheets:r}}function sk(e,n,a){var r=a||{},s=e?Array.isArray(e):r.dense,l=e||(s?[]:{}),o=0,d=0;if(l&&r.origin!=null){if(typeof r.origin=="number")o=r.origin;else{var u=typeof r.origin=="string"?bn(r.origin):r.origin;o=u.r,d=u.c}l["!ref"]||(l["!ref"]="A1:A1")}var x={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var m=Pt(l["!ref"]);x.s.c=m.s.c,x.s.r=m.s.r,x.e.c=Math.max(x.e.c,m.e.c),x.e.r=Math.max(x.e.r,m.e.r),o==-1&&(x.e.r=o=m.e.r+1)}for(var f=0;f!=n.length;++f)if(n[f]){if(!Array.isArray(n[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=n[f].length;++p)if(!(typeof n[f][p]>"u")){var N={v:n[f][p]},y=o+f,g=d+p;if(x.s.r>y&&(x.s.r=y),x.s.c>g&&(x.s.c=g),x.e.r<y&&(x.e.r=y),x.e.c<g&&(x.e.c=g),n[f][p]&&typeof n[f][p]=="object"&&!Array.isArray(n[f][p])&&!(n[f][p]instanceof Date))N=n[f][p];else if(Array.isArray(N.v)&&(N.f=n[f][p][1],N.v=N.v[0]),N.v===null)if(N.f)N.t="n";else if(r.nullError)N.t="e",N.v=0;else if(r.sheetStubs)N.t="z";else continue;else typeof N.v=="number"?N.t="n":typeof N.v=="boolean"?N.t="b":N.v instanceof Date?(N.z=r.dateNF||ct[14],r.cellDates?(N.t="d",N.w=Hr(N.z,Wn(N.v))):(N.t="n",N.v=Wn(N.v),N.w=Hr(N.z,N.v))):N.t="s";if(s)l[y]||(l[y]=[]),l[y][g]&&l[y][g].z&&(N.z=l[y][g].z),l[y][g]=N;else{var b=dt({c:g,r:y});l[b]&&l[b].z&&(N.z=l[b].z),l[b]=N}}}return x.s.c<1e7&&(l["!ref"]=gt(x)),l}function Mc(e,n){return sk(null,e,n)}function f8(e){return e.read_shift(4,"i")}function rs(e,n){return n||(n=Te(4)),n.write_shift(4,e),n}function Ca(e){var n=e.read_shift(4);return n===0?"":e.read_shift(n,"dbcs")}function ra(e,n){var a=!1;return n==null&&(a=!0,n=Te(4+2*e.length)),n.write_shift(4,e.length),e.length>0&&n.write_shift(0,e,"dbcs"),a?n.slice(0,n.l):n}function p8(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function g8(e,n){return n||(n=Te(4)),n.write_shift(2,0),n.write_shift(2,0),n}function Ig(e,n){var a=e.l,r=e.read_shift(1),s=Ca(e),l=[],o={t:s,h:s};if((r&1)!==0){for(var d=e.read_shift(4),u=0;u!=d;++u)l.push(p8(e));o.r=l}else o.r=[{ich:0,ifnt:0}];return e.l=a+n,o}function y8(e,n){var a=!1;return n==null&&(a=!0,n=Te(15+4*e.t.length)),n.write_shift(1,0),ra(e.t,n),a?n.slice(0,n.l):n}var v8=Ig;function b8(e,n){var a=!1;return n==null&&(a=!0,n=Te(23+4*e.t.length)),n.write_shift(1,1),ra(e.t,n),n.write_shift(4,1),g8({},n),a?n.slice(0,n.l):n}function Ur(e){var n=e.read_shift(4),a=e.read_shift(2);return a+=e.read_shift(1)<<16,e.l++,{c:n,iStyleRef:a}}function go(e,n){return n==null&&(n=Te(8)),n.write_shift(-4,e.c),n.write_shift(3,e.iStyleRef||e.s),n.write_shift(1,0),n}function yo(e){var n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:n}}function vo(e,n){return n==null&&(n=Te(4)),n.write_shift(3,e.iStyleRef||e.s),n.write_shift(1,0),n}var N8=Ca,ik=ra;function Og(e){var n=e.read_shift(4);return n===0||n===4294967295?"":e.read_shift(n,"dbcs")}function P0(e,n){var a=!1;return n==null&&(a=!0,n=Te(127)),n.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&n.write_shift(0,e,"dbcs"),a?n.slice(0,n.l):n}var j8=Ca,Ep=Og,Mg=P0;function Rg(e){var n=e.slice(e.l,e.l+4),a=n[0]&1,r=n[0]&2;e.l+=4;var s=r===0?L0([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):Rl(n,0)>>2;return a?s/100:s}function lk(e,n){n==null&&(n=Te(4));var a=0,r=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?r=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(r=1,a=1),r)n.write_shift(-4,((a?s:e)<<2)+(a+2));else throw new Error("unsupported RkNumber "+e)}function ok(e){var n={s:{},e:{}};return n.s.r=e.read_shift(4),n.e.r=e.read_shift(4),n.s.c=e.read_shift(4),n.e.c=e.read_shift(4),n}function w8(e,n){return n||(n=Te(16)),n.write_shift(4,e.s.r),n.write_shift(4,e.e.r),n.write_shift(4,e.s.c),n.write_shift(4,e.e.c),n}var bo=ok,Rc=w8;function Ta(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function co(e,n){return(n||Te(8)).write_shift(8,e,"f")}function k8(e){var n={},a=e.read_shift(1),r=a>>>1,s=e.read_shift(1),l=e.read_shift(2,"i"),o=e.read_shift(1),d=e.read_shift(1),u=e.read_shift(1);switch(e.l++,r){case 0:n.auto=1;break;case 1:n.index=s;var x=Zl[s];x&&(n.rgb=ru(x));break;case 2:n.rgb=ru([o,d,u]);break;case 3:n.theme=s;break}return l!=0&&(n.tint=l>0?l/32767:l/32768),n}function I0(e,n){if(n||(n=Te(8)),!e||e.auto)return n.write_shift(4,0),n.write_shift(4,0),n;e.index!=null?(n.write_shift(1,2),n.write_shift(1,e.index)):e.theme!=null?(n.write_shift(1,6),n.write_shift(1,e.theme)):(n.write_shift(1,5),n.write_shift(1,0));var a=e.tint||0;if(a>0?a*=32767:a<0&&(a*=32768),n.write_shift(2,a),!e.rgb||e.theme!=null)n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);else{var r=e.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),n.write_shift(1,parseInt(r.slice(0,2),16)),n.write_shift(1,parseInt(r.slice(2,4),16)),n.write_shift(1,parseInt(r.slice(4,6),16)),n.write_shift(1,255)}return n}function T8(e){var n=e.read_shift(1);e.l++;var a={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return a}function C8(e,n){n||(n=Te(2));var a=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return n.write_shift(1,a),n.write_shift(1,0),n}function ck(e,n){var a={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return a[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,n==1?"lpstr":"lpwstr")}function S8(e){return ck(e,1)}function _8(e){return ck(e,2)}var Bg=2,Qa=3,Jh=11,LN=12,O0=19,Zh=64,E8=65,D8=71,A8=4108,F8=4126,ta=80,dk=81,L8=[ta,dk],Dp={1:{n:"CodePage",t:Bg},2:{n:"Category",t:ta},3:{n:"PresentationFormat",t:ta},4:{n:"ByteCount",t:Qa},5:{n:"LineCount",t:Qa},6:{n:"ParagraphCount",t:Qa},7:{n:"SlideCount",t:Qa},8:{n:"NoteCount",t:Qa},9:{n:"HiddenCount",t:Qa},10:{n:"MultimediaClipCount",t:Qa},11:{n:"ScaleCrop",t:Jh},12:{n:"HeadingPairs",t:A8},13:{n:"TitlesOfParts",t:F8},14:{n:"Manager",t:ta},15:{n:"Company",t:ta},16:{n:"LinksUpToDate",t:Jh},17:{n:"CharacterCount",t:Qa},19:{n:"SharedDoc",t:Jh},22:{n:"HyperlinksChanged",t:Jh},23:{n:"AppVersion",t:Qa,p:"version"},24:{n:"DigSig",t:E8},26:{n:"ContentType",t:ta},27:{n:"ContentStatus",t:ta},28:{n:"Language",t:ta},29:{n:"Version",t:ta},255:{},2147483648:{n:"Locale",t:O0},2147483651:{n:"Behavior",t:O0},1919054434:{}},Ap={1:{n:"CodePage",t:Bg},2:{n:"Title",t:ta},3:{n:"Subject",t:ta},4:{n:"Author",t:ta},5:{n:"Keywords",t:ta},6:{n:"Comments",t:ta},7:{n:"Template",t:ta},8:{n:"LastAuthor",t:ta},9:{n:"RevNumber",t:ta},10:{n:"EditTime",t:Zh},11:{n:"LastPrinted",t:Zh},12:{n:"CreatedDate",t:Zh},13:{n:"ModifiedDate",t:Zh},14:{n:"PageCount",t:Qa},15:{n:"WordCount",t:Qa},16:{n:"CharCount",t:Qa},17:{n:"Thumbnail",t:D8},18:{n:"Application",t:ta},19:{n:"DocSecurity",t:Qa},255:{},2147483648:{n:"Locale",t:O0},2147483651:{n:"Behavior",t:O0},1919054434:{}},PN={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},P8=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function I8(e){return e.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var O8=I8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Zl=dn(O8),xi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},uk={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Fp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},e0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Hg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function M8(e){var n=Hg();if(!e||!e.match)return n;var a={};if((e.match(_a)||[]).forEach(function(r){var s=ut(r);switch(s[0].replace(qF,"<")){case"<?xml":break;case"<Types":n.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":a[s.Extension]=s.ContentType;break;case"<Override":n[Fp[s.ContentType]]!==void 0&&n[Fp[s.ContentType]].push(s.PartName);break}}),n.xmlns!==$n.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=a,delete n.calcchains,n}function hk(e,n){var a=MF(Fp),r=[],s;r[r.length]=Ln,r[r.length]=Ue("Types",null,{xmlns:$n.CT,"xmlns:xsd":$n.xsd,"xmlns:xsi":$n.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return Ue("Default",null,{Extension:u[0],ContentType:u[1]})}));var l=function(u){e[u]&&e[u].length>0&&(s=e[u][0],r[r.length]=Ue("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:e0[u][n.bookType]||e0[u].xlsx}))},o=function(u){(e[u]||[]).forEach(function(x){r[r.length]=Ue("Override",null,{PartName:(x[0]=="/"?"":"/")+x,ContentType:e0[u][n.bookType]||e0[u].xlsx})})},d=function(u){(e[u]||[]).forEach(function(x){r[r.length]=Ue("Override",null,{PartName:(x[0]=="/"?"":"/")+x,ContentType:a[u][0]})})};return l("workbooks"),o("sheets"),o("charts"),d("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(d),d("vba"),d("comments"),d("threadedcomments"),d("drawings"),o("metadata"),d("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var jt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function au(e){var n=e.lastIndexOf("/");return e.slice(0,n+1)+"_rels/"+e.slice(n+1)+".rels"}function Vd(e,n){var a={"!id":{}};if(!e)return a;n.charAt(0)!=="/"&&(n="/"+n);var r={};return(e.match(_a)||[]).forEach(function(s){var l=ut(s);if(l[0]==="<Relationship"){var o={};o.Type=l.Type,o.Target=l.Target,o.Id=l.Id,l.TargetMode&&(o.TargetMode=l.TargetMode);var d=l.TargetMode==="External"?l.Target:Pd(l.Target,n);a[d]=o,r[l.Id]=o}}),a["!id"]=r,a}function lc(e){var n=[Ln,Ue("Relationships",null,{xmlns:$n.RELS})];return Tn(e["!id"]).forEach(function(a){n[n.length]=Ue("Relationship",null,e["!id"][a])}),n.length>2&&(n[n.length]="</Relationships>",n[1]=n[1].replace("/>",">")),n.join("")}function Gt(e,n,a,r,s,l){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),n<0)for(n=e["!idx"];e["!id"]["rId"+n];++n);if(e["!idx"]=n+1,s.Id="rId"+n,s.Type=r,s.Target=a,[jt.HLINK,jt.XPATH,jt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+n);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,n}var R8="application/vnd.oasis.opendocument.spreadsheet";function B8(e,n){for(var a=Dg(e),r,s;r=nu.exec(a);)switch(r[3]){case"manifest":break;case"file-entry":if(s=ut(r[0],!1),s.path=="/"&&s.type!==R8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw r}}function H8(e){var n=[Ln];n.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),n.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var a=0;a<e.length;++a)n.push('  <manifest:file-entry manifest:full-path="'+e[a][0]+'" manifest:media-type="'+e[a][1]+`"/>
`);return n.push("</manifest:manifest>"),n.join("")}function IN(e,n,a){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(a||"odf")+"#"+n+`"/>
`,`  </rdf:Description>
`].join("")}function V8(e,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+n+`"/>
`,`  </rdf:Description>
`].join("")}function U8(e){var n=[Ln];n.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var a=0;a!=e.length;++a)n.push(IN(e[a][0],e[a][1])),n.push(V8("",e[a][0]));return n.push(IN("","Document","pkg")),n.push("</rdf:RDF>"),n.join("")}function xk(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+_0.version+"</meta:generator></office:meta></office:document-meta>"}var Rr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],K8=(function(){for(var e=new Array(Rr.length),n=0;n<Rr.length;++n){var a=Rr[n],r="(?:"+a[0].slice(0,a[0].indexOf(":"))+":)"+a[0].slice(a[0].indexOf(":")+1);e[n]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e})();function mk(e){var n={};e=Xt(e);for(var a=0;a<Rr.length;++a){var r=Rr[a],s=e.match(K8[a]);s!=null&&s.length>0&&(n[r[1]]=Ft(s[1])),r[2]==="date"&&n[r[1]]&&(n[r[1]]=cn(n[r[1]]))}return n}function Df(e,n,a,r,s){s[e]!=null||n==null||n===""||(s[e]=n,n=qt(n),r[r.length]=a?Ue(e,n,a):xa(e,n))}function fk(e,n){var a=n||{},r=[Ln,Ue("cp:coreProperties",null,{"xmlns:cp":$n.CORE_PROPS,"xmlns:dc":$n.dc,"xmlns:dcterms":$n.dcterms,"xmlns:dcmitype":$n.dcmitype,"xmlns:xsi":$n.xsi})],s={};if(!e&&!a.Props)return r.join("");e&&(e.CreatedDate!=null&&Df("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:_p(e.CreatedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},r,s),e.ModifiedDate!=null&&Df("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:_p(e.ModifiedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},r,s));for(var l=0;l!=Rr.length;++l){var o=Rr[l],d=a.Props&&a.Props[o[1]]!=null?a.Props[o[1]]:e?e[o[1]]:null;d===!0?d="1":d===!1?d="0":typeof d=="number"&&(d=String(d)),d!=null&&Df(o[0],d,null,r,s)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var eo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],pk=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function gk(e,n,a,r){var s=[];if(typeof e=="string")s=TN(e,r);else for(var l=0;l<e.length;++l)s=s.concat(e[l].map(function(m){return{v:m}}));var o=typeof n=="string"?TN(n,r).map(function(m){return m.v}):n,d=0,u=0;if(o.length>0)for(var x=0;x!==s.length;x+=2){switch(u=+s[x+1].v,s[x].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":a.Worksheets=u,a.SheetNames=o.slice(d,d+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":a.NamedRanges=u,a.DefinedNames=o.slice(d,d+u);break;case"Charts":case"Diagramme":a.Chartsheets=u,a.ChartNames=o.slice(d,d+u);break}d+=u}}function z8(e,n,a){var r={};return n||(n={}),e=Xt(e),eo.forEach(function(s){var l=(e.match(eu(s[0]))||[])[1];switch(s[2]){case"string":l&&(n[s[1]]=Ft(l));break;case"bool":n[s[1]]=l==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(r[s[1]]=o[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&gk(r.HeadingPairs,r.TitlesOfParts,n,a),n}function yk(e){var n=[],a=Ue;return e||(e={}),e.Application="SheetJS",n[n.length]=Ln,n[n.length]=Ue("Properties",null,{xmlns:$n.EXT_PROPS,"xmlns:vt":$n.vt}),eo.forEach(function(r){if(e[r[1]]!==void 0){var s;switch(r[2]){case"string":s=qt(String(e[r[1]]));break;case"bool":s=e[r[1]]?"true":"false";break}s!==void 0&&(n[n.length]=a(r[0],s))}}),n[n.length]=a("HeadingPairs",a("vt:vector",a("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+a("vt:variant",a("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),n[n.length]=a("TitlesOfParts",a("vt:vector",e.SheetNames.map(function(r){return"<vt:lpstr>"+qt(r)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var $8=/<[^>]+>[^<]*/g;function G8(e,n){var a={},r="",s=e.match($8);if(s)for(var l=0;l!=s.length;++l){var o=s[l],d=ut(o);switch(d[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Ft(d.name);break;case"</property>":r=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),x=u[0].slice(4),m=u[1];switch(x){case"lpstr":case"bstr":case"lpwstr":a[r]=Ft(m);break;case"bool":a[r]=ln(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":a[r]=parseInt(m,10);break;case"r4":case"r8":case"decimal":a[r]=parseFloat(m);break;case"filetime":case"date":a[r]=cn(m);break;case"cy":case"error":a[r]=Ft(m);break;default:if(x.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",o,x,u)}}else if(o.slice(0,2)!=="</"){if(n.WTF)throw new Error(o)}}}return a}function vk(e){var n=[Ln,Ue("Properties",null,{xmlns:$n.CUST_PROPS,"xmlns:vt":$n.vt})];if(!e)return n.join("");var a=1;return Tn(e).forEach(function(s){++a,n[n.length]=Ue("property",t8(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:a,name:qt(s)})}),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var Lp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Af;function q8(e,n,a){Af||(Af=cx(Lp)),n=Af[n]||n,e[n]=a}function W8(e,n){var a=[];return Tn(Lp).map(function(r){for(var s=0;s<Rr.length;++s)if(Rr[s][1]==r)return Rr[s];for(s=0;s<eo.length;++s)if(eo[s][1]==r)return eo[s];throw r}).forEach(function(r){if(e[r[1]]!=null){var s=n&&n.Props&&n.Props[r[1]]!=null?n.Props[r[1]]:e[r[1]];switch(r[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),a.push(xa(Lp[r[1]]||r[1],s))}}),Ue("DocumentProperties",a.join(""),{xmlns:ur.o})}function X8(e,n){var a=["Worksheets","SheetNames"],r="CustomDocumentProperties",s=[];return e&&Tn(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)){for(var o=0;o<Rr.length;++o)if(l==Rr[o][1])return;for(o=0;o<eo.length;++o)if(l==eo[o][1])return;for(o=0;o<a.length;++o)if(l==a[o])return;var d=e[l],u="string";typeof d=="number"?(u="float",d=String(d)):d===!0||d===!1?(u="boolean",d=d?"1":"0"):d=String(d),s.push(Ue(NN(l),d,{"dt:dt":u}))}}),n&&Tn(n).forEach(function(l){if(Object.prototype.hasOwnProperty.call(n,l)&&!(e&&Object.prototype.hasOwnProperty.call(e,l))){var o=n[l],d="string";typeof o=="number"?(d="float",o=String(o)):o===!0||o===!1?(d="boolean",o=o?"1":"0"):o instanceof Date?(d="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Ue(NN(l),o,{"dt:dt":d}))}}),"<"+r+' xmlns="'+ur.o+'">'+s.join("")+"</"+r+">"}function Vg(e){var n=e.read_shift(4),a=e.read_shift(4);return new Date((a/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Q8(e){var n=typeof e=="string"?new Date(Date.parse(e)):e,a=n.getTime()/1e3+11644473600,r=a%Math.pow(2,32),s=(a-r)/Math.pow(2,32);r*=1e7,s*=1e7;var l=r/Math.pow(2,32)|0;l>0&&(r=r%Math.pow(2,32),s+=l);var o=Te(8);return o.write_shift(4,r),o.write_shift(4,s),o}function bk(e,n,a){var r=e.l,s=e.read_shift(0,"lpstr-cp");if(a)for(;e.l-r&3;)++e.l;return s}function Nk(e,n,a){var r=e.read_shift(0,"lpwstr");return r}function jk(e,n,a){return n===31?Nk(e):bk(e,n,a)}function Pp(e,n,a){return jk(e,n,a===!1?0:4)}function Y8(e,n){if(!n)throw new Error("VtUnalignedString must have positive length");return jk(e,n,0)}function J8(e){for(var n=e.read_shift(4),a=[],r=0;r!=n;++r){var s=e.l;a[r]=e.read_shift(0,"lpwstr").replace(Ba,""),e.l-s&2&&(e.l+=2)}return a}function Z8(e){for(var n=e.read_shift(4),a=[],r=0;r!=n;++r)a[r]=e.read_shift(0,"lpstr-cp").replace(Ba,"");return a}function eL(e){var n=e.l,a=M0(e,dk);e[e.l]==0&&e[e.l+1]==0&&e.l-n&2&&(e.l+=2);var r=M0(e,Qa);return[a,r]}function tL(e){for(var n=e.read_shift(4),a=[],r=0;r<n/2;++r)a.push(eL(e));return a}function ON(e,n){for(var a=e.read_shift(4),r={},s=0;s!=a;++s){var l=e.read_shift(4),o=e.read_shift(4);r[l]=e.read_shift(o,n===1200?"utf16le":"utf8").replace(Ba,"").replace(Ld,"!"),n===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function wk(e){var n=e.read_shift(4),a=e.slice(e.l,e.l+n);return e.l+=n,(n&3)>0&&(e.l+=4-(n&3)&3),a}function nL(e){var n={};return n.Size=e.read_shift(4),e.l+=n.Size+3-(n.Size-1)%4,n}function M0(e,n,a){var r=e.read_shift(2),s,l=a||{};if(e.l+=2,n!==LN&&r!==n&&L8.indexOf(n)===-1&&!((n&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+n+" saw "+r);switch(n===LN?r:n){case 2:return s=e.read_shift(2,"i"),l.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return bk(e,r,4).replace(Ba,"");case 31:return Nk(e);case 64:return Vg(e);case 65:return wk(e);case 71:return nL(e);case 80:return Pp(e,r,!l.raw).replace(Ba,"");case 81:return Y8(e,r).replace(Ba,"");case 4108:return tL(e);case 4126:case 4127:return r==4127?J8(e):Z8(e);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+r)}}function MN(e,n){var a=Te(4),r=Te(4);switch(a.write_shift(4,e==80?31:e),e){case 3:r.write_shift(-4,n);break;case 5:r=Te(8),r.write_shift(8,n,"f");break;case 11:r.write_shift(4,n?1:0);break;case 64:r=Q8(n);break;case 31:case 80:for(r=Te(4+2*(n.length+1)+(n.length%2?0:2)),r.write_shift(4,n.length+1),r.write_shift(0,n,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}return aa([a,r])}function RN(e,n){var a=e.l,r=e.read_shift(4),s=e.read_shift(4),l=[],o=0,d=0,u=-1,x={};for(o=0;o!=s;++o){var m=e.read_shift(4),f=e.read_shift(4);l[o]=[m,f+a]}l.sort(function(T,S){return T[1]-S[1]});var p={};for(o=0;o!=s;++o){if(e.l!==l[o][1]){var N=!0;if(o>0&&n)switch(n[l[o-1][0]].t){case 2:e.l+2===l[o][1]&&(e.l+=2,N=!1);break;case 80:e.l<=l[o][1]&&(e.l=l[o][1],N=!1);break;case 4108:e.l<=l[o][1]&&(e.l=l[o][1],N=!1);break}if((!n||o==0)&&e.l<=l[o][1]&&(N=!1,e.l=l[o][1]),N)throw new Error("Read Error: Expected address "+l[o][1]+" at "+e.l+" :"+o)}if(n){var y=n[l[o][0]];if(p[y.n]=M0(e,y.t,{raw:!0}),y.p==="version"&&(p[y.n]=String(p[y.n]>>16)+"."+("0000"+String(p[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(p[y.n]){case 0:p[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Zr(d=p[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[y.n])}}else if(l[o][0]===1){if(d=p.CodePage=M0(e,Bg),Zr(d),u!==-1){var g=e.l;e.l=l[u][1],x=ON(e,d),e.l=g}}else if(l[o][0]===0){if(d===0){u=o,e.l=l[o+1][1];continue}x=ON(e,d)}else{var b=x[l[o][0]],j;switch(e[e.l]){case 65:e.l+=4,j=wk(e);break;case 30:e.l+=4,j=Pp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,j=Pp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,j=e.read_shift(4,"i");break;case 19:e.l+=4,j=e.read_shift(4);break;case 5:e.l+=4,j=e.read_shift(8,"f");break;case 11:e.l+=4,j=Dn(e,4);break;case 64:e.l+=4,j=cn(Vg(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[b]=j}}return e.l=a+r,p}var kk=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function aL(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function BN(e,n,a){var r=Te(8),s=[],l=[],o=8,d=0,u=Te(8),x=Te(8);if(u.write_shift(4,2),u.write_shift(4,1200),x.write_shift(4,1),l.push(u),s.push(x),o+=8+u.length,!n){x=Te(8),x.write_shift(4,0),s.unshift(x);var m=[Te(4)];for(m[0].write_shift(4,e.length),d=0;d<e.length;++d){var f=e[d][0];for(u=Te(8+2*(f.length+1)+(f.length%2?0:2)),u.write_shift(4,d+2),u.write_shift(4,f.length+1),u.write_shift(0,f,"dbcs");u.l!=u.length;)u.write_shift(1,0);m.push(u)}u=aa(m),l.unshift(u),o+=8+u.length}for(d=0;d<e.length;++d)if(!(n&&!n[e[d][0]])&&!(kk.indexOf(e[d][0])>-1||pk.indexOf(e[d][0])>-1)&&e[d][1]!=null){var p=e[d][1],N=0;if(n){N=+n[e[d][0]];var y=a[N];if(y.p=="version"&&typeof p=="string"){var g=p.split(".");p=(+g[0]<<16)+(+g[1]||0)}u=MN(y.t,p)}else{var b=aL(p);b==-1&&(b=31,p=String(p)),u=MN(b,p)}l.push(u),x=Te(8),x.write_shift(4,n?N:2+d),s.push(x),o+=8+u.length}var j=8*(l.length+1);for(d=0;d<l.length;++d)s[d].write_shift(4,j),j+=l[d].length;return r.write_shift(4,o),r.write_shift(4,l.length),aa([r].concat(s).concat(l))}function HN(e,n,a){var r=e.content;if(!r)return{};da(r,0);var s,l,o,d,u=0;r.chk("feff","Byte Order: "),r.read_shift(2);var x=r.read_shift(4),m=r.read_shift(16);if(m!==rt.utils.consts.HEADER_CLSID&&m!==a)throw new Error("Bad PropertySet CLSID "+m);if(s=r.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(l=r.read_shift(16),d=r.read_shift(4),s===1&&d!==r.l)throw new Error("Length mismatch: "+d+" !== "+r.l);s===2&&(o=r.read_shift(16),u=r.read_shift(4));var f=RN(r,n),p={SystemIdentifier:x};for(var N in f)p[N]=f[N];if(p.FMTID=l,s===1)return p;if(u-r.l==2&&(r.l+=2),r.l!==u)throw new Error("Length mismatch 2: "+r.l+" !== "+u);var y;try{y=RN(r,null)}catch{}for(N in y)p[N]=y[N];return p.FMTID=[l,o],p}function VN(e,n,a,r,s,l){var o=Te(s?68:48),d=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,rt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,n,"hex"),o.write_shift(4,s?68:48);var u=BN(e,a,r);if(d.push(u),s){var x=BN(s,null,null);o.write_shift(16,l,"hex"),o.write_shift(4,68+u.length),d.push(x)}return aa(d)}function Ri(e,n){return e.read_shift(n),null}function rL(e,n){n||(n=Te(e));for(var a=0;a<e;++a)n.write_shift(1,0);return n}function sL(e,n,a){for(var r=[],s=e.l+n;e.l<s;)r.push(a(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return r}function Dn(e,n){return e.read_shift(n)===1}function Oa(e,n){return n||(n=Te(2)),n.write_shift(2,+!!e),n}function Mn(e){return e.read_shift(2,"u")}function Pr(e,n){return n||(n=Te(2)),n.write_shift(2,e),n}function Tk(e,n){return sL(e,n,Mn)}function iL(e){var n=e.read_shift(1),a=e.read_shift(1);return a===1?n:n===1}function Ck(e,n,a){return a||(a=Te(2)),a.write_shift(1,n=="e"?+e:+!!e),a.write_shift(1,n=="e"?1:0),a}function Su(e,n,a){var r=e.read_shift(a&&a.biff>=12?2:1),s="sbcs-cont";if(a&&a.biff>=8,!a||a.biff==8){var l=e.read_shift(1);l&&(s="dbcs-cont")}else a.biff==12&&(s="wstr");a.biff>=2&&a.biff<=5&&(s="cpstr");var o=r?e.read_shift(r,s):"";return o}function lL(e){var n=e.read_shift(2),a=e.read_shift(1),r=a&4,s=a&8,l=1+(a&1),o=0,d,u={};s&&(o=e.read_shift(2)),r&&(d=e.read_shift(4));var x=l==2?"dbcs-cont":"sbcs-cont",m=n===0?"":e.read_shift(n,x);return s&&(e.l+=4*o),r&&(e.l+=d),u.t=m,s||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function oL(e){var n=e.t||"",a=Te(3);a.write_shift(2,n.length),a.write_shift(1,1);var r=Te(2*n.length);r.write_shift(2*n.length,n,"utf16le");var s=[a,r];return aa(s)}function uo(e,n,a){var r;if(a){if(a.biff>=2&&a.biff<=5)return e.read_shift(n,"cpstr");if(a.biff>=12)return e.read_shift(n,"dbcs-cont")}var s=e.read_shift(1);return s===0?r=e.read_shift(n,"sbcs-cont"):r=e.read_shift(n,"dbcs-cont"),r}function _u(e,n,a){var r=e.read_shift(a&&a.biff==2?1:2);return r===0?(e.l++,""):uo(e,r,a)}function No(e,n,a){if(a.biff>5)return _u(e,n,a);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,a.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Sk(e,n,a){return a||(a=Te(3+2*e.length)),a.write_shift(2,e.length),a.write_shift(1,1),a.write_shift(31,e,"utf16le"),a}function cL(e){var n=e.read_shift(1);e.l++;var a=e.read_shift(2);return e.l+=2,[n,a]}function dL(e){var n=e.read_shift(4),a=e.l,r=!1;n>24&&(e.l+=n-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=a);var s=e.read_shift((r?n-24:n)>>1,"utf16le").replace(Ba,"");return r&&(e.l+=24),s}function uL(e){for(var n=e.read_shift(2),a="";n-- >0;)a+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return a+r.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(l>>1,"utf16le").replace(Ba,"");return a+o}function hL(e,n){var a=e.read_shift(16);switch(a){case"e0c9ea79f9bace118c8200aa004ba90b":return dL(e);case"0303000000000000c000000000000046":return uL(e);default:throw new Error("Unsupported Moniker "+a)}}function t0(e){var n=e.read_shift(4),a=n>0?e.read_shift(n,"utf16le").replace(Ba,""):"";return a}function UN(e,n){n||(n=Te(6+e.length*2)),n.write_shift(4,1+e.length);for(var a=0;a<e.length;++a)n.write_shift(2,e.charCodeAt(a));return n.write_shift(2,0),n}function xL(e,n){var a=e.l+n,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var s=e.read_shift(2);e.l+=2;var l,o,d,u,x="",m,f;s&16&&(l=t0(e,a-e.l)),s&128&&(o=t0(e,a-e.l)),(s&257)===257&&(d=t0(e,a-e.l)),(s&257)===1&&(u=hL(e,a-e.l)),s&8&&(x=t0(e,a-e.l)),s&32&&(m=e.read_shift(16)),s&64&&(f=Vg(e)),e.l=a;var p=o||d||u||"";p&&x&&(p+="#"+x),p||(p="#"+x),s&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var N={Target:p};return m&&(N.guid=m),f&&(N.time=f),l&&(N.Tooltip=l),N}function mL(e){var n=Te(512),a=0,r=e.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var s=r.indexOf("#"),l=s>-1?31:23;switch(r.charAt(0)){case"#":l=28;break;case".":l&=-3;break}n.write_shift(4,2),n.write_shift(4,l);var o=[8,6815827,6619237,4849780,83];for(a=0;a<o.length;++a)n.write_shift(4,o[a]);if(l==28)r=r.slice(1),UN(r,n);else if(l&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<o.length;++a)n.write_shift(1,parseInt(o[a],16));var d=s>-1?r.slice(0,s):r;for(n.write_shift(4,2*(d.length+1)),a=0;a<d.length;++a)n.write_shift(2,d.charCodeAt(a));n.write_shift(2,0),l&8&&UN(s>-1?r.slice(s+1):"",n)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),a=0;a<o.length;++a)n.write_shift(1,parseInt(o[a],16));for(var u=0;r.slice(u*3,u*3+3)=="../"||r.slice(u*3,u*3+3)=="..\\";)++u;for(n.write_shift(2,u),n.write_shift(4,r.length-3*u+1),a=0;a<r.length-3*u;++a)n.write_shift(1,r.charCodeAt(a+3*u)&255);for(n.write_shift(1,0),n.write_shift(2,65535),n.write_shift(2,57005),a=0;a<6;++a)n.write_shift(4,0)}return n.slice(0,n.l)}function _k(e){var n=e.read_shift(1),a=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1);return[n,a,r,s]}function Ek(e,n){var a=_k(e);return a[3]=0,a}function Ls(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2);return{r:n,c:a,ixfe:r}}function ho(e,n,a,r){return r||(r=Te(6)),r.write_shift(2,e),r.write_shift(2,n),r.write_shift(2,a||0),r}function fL(e){var n=e.read_shift(2),a=e.read_shift(2);return e.l+=8,{type:n,flags:a}}function pL(e,n,a){return n===0?"":No(e,n,a)}function gL(e,n,a){var r=a.biff>8?4:2,s=e.read_shift(r),l=e.read_shift(r,"i"),o=e.read_shift(r,"i");return[s,l,o]}function Dk(e){var n=e.read_shift(2),a=Rg(e);return[n,a]}function yL(e,n,a){e.l+=4,n-=4;var r=e.l+n,s=Su(e,n,a),l=e.read_shift(2);if(r-=e.l,l!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+l);return e.l+=l,s}function hx(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{s:{c:r,r:n},e:{c:s,r:a}}}function Ak(e,n){return n||(n=Te(8)),n.write_shift(2,e.s.r),n.write_shift(2,e.e.r),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c),n}function Fk(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(1),s=e.read_shift(1);return{s:{c:r,r:n},e:{c:s,r:a}}}var vL=Fk;function Lk(e){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[a,n,r]}function bL(e){var n={};return e.l+=4,e.l+=16,n.fSharedNote=e.read_shift(2),e.l+=4,n}function NL(e){var n={};return e.l+=4,e.cf=e.read_shift(2),n}function va(e){e.l+=2,e.l+=e.read_shift(2)}var jL={0:va,4:va,5:va,6:va,7:NL,8:va,9:va,10:va,11:va,12:va,13:bL,14:va,15:va,16:va,17:va,18:va,19:va,20:va,21:Lk};function wL(e,n){for(var a=e.l+n,r=[];e.l<a;){var s=e.read_shift(2);e.l-=2;try{r.push(jL[s](e,a-e.l))}catch{return e.l=a,r}}return e.l!=a&&(e.l=a),r}function n0(e,n){var a={BIFFVer:0,dt:0};switch(a.BIFFVer=e.read_shift(2),n-=2,n>=2&&(a.dt=e.read_shift(2),e.l-=2),a.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+a.BIFFVer)}return e.read_shift(n),a}function Ug(e,n,a){var r=1536,s=16;switch(a.bookType){case"biff8":break;case"biff5":r=1280,s=8;break;case"biff4":r=4,s=6;break;case"biff3":r=3,s=6;break;case"biff2":r=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=Te(s);return l.write_shift(2,r),l.write_shift(2,n),s>4&&l.write_shift(2,29282),s>6&&l.write_shift(2,1997),s>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function kL(e,n){return n===0||e.read_shift(2),1200}function TL(e,n,a){if(a.enc)return e.l+=n,"";var r=e.l,s=No(e,0,a);return e.read_shift(n+r-e.l),s}function CL(e,n){var a=!n||n.biff==8,r=Te(a?112:54);for(r.write_shift(n.biff==8?2:1,7),a&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(a?0:536870912));r.l<r.length;)r.write_shift(1,a?0:32);return r}function SL(e,n,a){var r=a&&a.biff==8||n==2?e.read_shift(2):(e.l+=n,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function _L(e,n,a){var r=e.read_shift(4),s=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var o=Su(e,0,a);return o.length===0&&(o="Sheet1"),{pos:r,hs:s,dt:l,name:o}}function EL(e,n){var a=!n||n.biff>=8?2:1,r=Te(8+a*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),n.biff>=8&&r.write_shift(1,1),r.write_shift(a*e.name.length,e.name,n.biff<8?"sbcs":"utf16le");var s=r.slice(0,r.l);return s.l=r.l,s}function DL(e,n){for(var a=e.l+n,r=e.read_shift(4),s=e.read_shift(4),l=[],o=0;o!=s&&e.l<a;++o)l.push(lL(e));return l.Count=r,l.Unique=s,l}function AL(e,n){var a=Te(8);a.write_shift(4,e.Count),a.write_shift(4,e.Unique);for(var r=[],s=0;s<e.length;++s)r[s]=oL(e[s]);var l=aa([a].concat(r));return l.parts=[a.length].concat(r.map(function(o){return o.length})),l}function FL(e,n){var a={};return a.dsst=e.read_shift(2),e.l+=n-2,a}function LL(e){var n={};n.r=e.read_shift(2),n.c=e.read_shift(2),n.cnt=e.read_shift(2)-n.c;var a=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(n.level=r&7),r&32&&(n.hidden=!0),r&64&&(n.hpt=a/20),n}function PL(e){var n=fL(e);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var a=e.read_shift(4);return a!==0}function IL(e){return e.read_shift(2),e.read_shift(4)}function KN(e,n,a){var r=0;a&&a.biff==2||(r=e.read_shift(2));var s=e.read_shift(2);a&&a.biff==2&&(r=1-(s>>15),s&=32767);var l={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[l,s]}function OL(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),d=e.read_shift(2),u=e.read_shift(2),x=e.read_shift(2);return{Pos:[n,a],Dim:[r,s],Flags:l,CurTab:o,FirstTab:d,Selected:u,TabRatio:x}}function ML(){var e=Te(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function RL(e,n,a){if(a&&a.biff>=2&&a.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function BL(e){var n=Te(18),a=1718;return e&&e.RTL&&(a|=64),n.write_shift(2,a),n.write_shift(4,0),n.write_shift(4,64),n.write_shift(4,0),n.write_shift(4,0),n}function HL(){}function VL(e,n,a){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(a&&a.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=Su(e,0,a),r}function UL(e,n){var a=e.name||"Arial",r=n&&n.biff==5,s=r?15+a.length:16+2*a.length,l=Te(s);return l.write_shift(2,e.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,a.length),r||l.write_shift(1,1),l.write_shift((r?1:2)*a.length,a,r?"sbcs":"utf16le"),l}function KL(e){var n=Ls(e);return n.isst=e.read_shift(4),n}function zL(e,n,a,r){var s=Te(10);return ho(e,n,r,s),s.write_shift(4,a),s}function $L(e,n,a){a.biffguess&&a.biff==2&&(a.biff=5);var r=e.l+n,s=Ls(e);a.biff==2&&e.l++;var l=_u(e,r-e.l,a);return s.val=l,s}function GL(e,n,a,r,s){var l=!s||s.biff==8,o=Te(8+ +l+(1+l)*a.length);return ho(e,n,r,o),o.write_shift(2,a.length),l&&o.write_shift(1,1),o.write_shift((1+l)*a.length,a,l?"utf16le":"sbcs"),o}function qL(e,n,a){var r=e.read_shift(2),s=No(e,0,a);return[r,s]}function WL(e,n,a,r){var s=a&&a.biff==5;r||(r=Te(s?3+n.length:5+2*n.length)),r.write_shift(2,e),r.write_shift(s?1:2,n.length),s||r.write_shift(1,1),r.write_shift((s?1:2)*n.length,n,s?"sbcs":"utf16le");var l=r.length>r.l?r.slice(0,r.l):r;return l.l==null&&(l.l=l.length),l}var XL=No;function zN(e,n,a){var r=e.l+n,s=a.biff==8||!a.biff?4:2,l=e.read_shift(s),o=e.read_shift(s),d=e.read_shift(2),u=e.read_shift(2);return e.l=r,{s:{r:l,c:d},e:{r:o,c:u}}}function QL(e,n){var a=n.biff==8||!n.biff?4:2,r=Te(2*a+6);return r.write_shift(a,e.s.r),r.write_shift(a,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}function YL(e){var n=e.read_shift(2),a=e.read_shift(2),r=Dk(e);return{r:n,c:a,ixfe:r[0],rknum:r[1]}}function JL(e,n){for(var a=e.l+n-2,r=e.read_shift(2),s=e.read_shift(2),l=[];e.l<a;)l.push(Dk(e));if(e.l!==a)throw new Error("MulRK read error");var o=e.read_shift(2);if(l.length!=o-s+1)throw new Error("MulRK length mismatch");return{r,c:s,C:o,rkrec:l}}function ZL(e,n){for(var a=e.l+n-2,r=e.read_shift(2),s=e.read_shift(2),l=[];e.l<a;)l.push(e.read_shift(2));if(e.l!==a)throw new Error("MulBlank read error");var o=e.read_shift(2);if(l.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r,c:s,C:o,ixfe:l}}function eP(e,n,a,r){var s={},l=e.read_shift(4),o=e.read_shift(4),d=e.read_shift(4),u=e.read_shift(2);return s.patternType=P8[d>>26],r.cellStyles&&(s.alc=l&7,s.fWrap=l>>3&1,s.alcV=l>>4&7,s.fJustLast=l>>7&1,s.trot=l>>8&255,s.cIndent=l>>16&15,s.fShrinkToFit=l>>20&1,s.iReadOrder=l>>22&2,s.fAtrNum=l>>26&1,s.fAtrFnt=l>>27&1,s.fAtrAlc=l>>28&1,s.fAtrBdr=l>>29&1,s.fAtrPat=l>>30&1,s.fAtrProt=l>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=d&127,s.icvBottom=d>>7&127,s.icvDiag=d>>14&127,s.dgDiag=d>>21&15,s.icvFore=u&127,s.icvBack=u>>7&127,s.fsxButton=u>>14&1),s}function tP(e,n,a){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,n-=6,r.data=eP(e,n,r.fStyle,a),r}function $N(e,n,a,r){var s=a&&a.biff==5;r||(r=Te(s?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,n<<4));var l=0;return e.numFmtId>0&&s&&(l|=1024),r.write_shift(4,l),r.write_shift(4,0),s||r.write_shift(4,0),r.write_shift(2,0),r}function nP(e){e.l+=4;var n=[e.read_shift(2),e.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function aP(e){var n=Te(8);return n.write_shift(4,0),n.write_shift(2,0),n.write_shift(2,0),n}function GN(e,n,a){var r=Ls(e);(a.biff==2||n==9)&&++e.l;var s=iL(e);return r.val=s,r.t=s===!0||s===!1?"b":"e",r}function rP(e,n,a,r,s,l){var o=Te(8);return ho(e,n,r,o),Ck(a,l,o),o}function sP(e,n,a){a.biffguess&&a.biff==2&&(a.biff=5);var r=Ls(e),s=Ta(e);return r.val=s,r}function iP(e,n,a,r){var s=Te(14);return ho(e,n,r,s),co(a,s),s}var qN=pL;function lP(e,n,a){var r=e.l+n,s=e.read_shift(2),l=e.read_shift(2);if(a.sbcch=l,l==1025||l==14849)return[l,s];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var o=uo(e,l),d=[];r>e.l;)d.push(_u(e));return[l,s,o,d]}function WN(e,n,a){var r=e.read_shift(2),s,l={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return a.sbcch===14849&&(s=yL(e,n-2,a)),l.body=s||e.read_shift(n-2),typeof s=="string"&&(l.Name=s),l}var oP=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function XN(e,n,a){var r=e.l+n,s=e.read_shift(2),l=e.read_shift(1),o=e.read_shift(1),d=e.read_shift(a&&a.biff==2?1:2),u=0;(!a||a.biff>=5)&&(a.biff!=5&&(e.l+=2),u=e.read_shift(2),a.biff==5&&(e.l+=2),e.l+=4);var x=uo(e,o,a);s&32&&(x=oP[x.charCodeAt(0)]);var m=r-e.l;a&&a.biff==2&&--m;var f=r==e.l||d===0||!(m>0)?[]:w7(e,m,a,d);return{chKey:l,Name:x,itab:u,rgce:f}}function Pk(e,n,a){if(a.biff<8)return cP(e,n,a);for(var r=[],s=e.l+n,l=e.read_shift(a.biff>8?4:2);l--!==0;)r.push(gL(e,a.biff>8?12:6,a));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return r}function cP(e,n,a){e[e.l+1]==3&&e[e.l]++;var r=Su(e,n,a);return r.charCodeAt(0)==3?r.slice(1):r}function dP(e,n,a){if(a.biff<8){e.l+=n;return}var r=e.read_shift(2),s=e.read_shift(2),l=uo(e,r,a),o=uo(e,s,a);return[l,o]}function uP(e,n,a){var r=Fk(e);e.l++;var s=e.read_shift(1);return n-=8,[k7(e,n,a),s,r]}function QN(e,n,a){var r=vL(e);switch(a.biff){case 2:e.l++,n-=7;break;case 3:case 4:e.l+=2,n-=8;break;default:e.l+=6,n-=12}return[r,N7(e,n,a)]}function hP(e){var n=e.read_shift(4)!==0,a=e.read_shift(4)!==0,r=e.read_shift(4);return[n,a,r]}function xP(e,n,a){if(!(a.biff<8)){var r=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),d=No(e,0,a);return a.biff<8&&e.read_shift(1),[{r,c:s},d,o,l]}}function mP(e,n,a){return xP(e,n,a)}function fP(e,n){for(var a=[],r=e.read_shift(2);r--;)a.push(hx(e));return a}function pP(e){var n=Te(2+e.length*8);n.write_shift(2,e.length);for(var a=0;a<e.length;++a)Ak(e[a],n);return n}function gP(e,n,a){if(a&&a.biff<8)return vP(e,n,a);var r=Lk(e),s=wL(e,n-22,r[1]);return{cmo:r,ft:s}}var yP={8:function(e,n){var a=e.l+n;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=a,{fmt:r}}};function vP(e,n,a){e.l+=4;var r=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,n-=36;var o=[];return o.push((yP[r]||Sa)(e,n,a)),{cmo:[s,r,l],ft:o}}function bP(e,n,a){var r=e.l,s="";try{e.l+=4;var l=(a.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:o=cL(e,6,a);var d=e.read_shift(2);e.read_shift(2),Mn(e,2);var u=e.read_shift(2);e.l+=u;for(var x=1;x<e.lens.length-1;++x){if(e.l-r!=e.lens[x])throw new Error("TxO: bad continue record");var m=e[e.l],f=uo(e,e.lens[x+1]-e.lens[x]-1);if(s+=f,s.length>=(m?d:2*d))break}if(s.length!==d&&s.length!==d*2)throw new Error("cchText: "+d+" != "+s.length);return e.l=r+n,{t:s}}catch{return e.l=r+n,{t:s}}}function NP(e,n){var a=hx(e);e.l+=16;var r=xL(e,n-24);return[a,r]}function jP(e){var n=Te(24),a=bn(e[0]);n.write_shift(2,a.r),n.write_shift(2,a.r),n.write_shift(2,a.c),n.write_shift(2,a.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)n.write_shift(1,parseInt(r[s],16));return aa([n,mL(e[1])])}function wP(e,n){e.read_shift(2);var a=hx(e),r=e.read_shift((n-10)/2,"dbcs-cont");return r=r.replace(Ba,""),[a,r]}function kP(e){var n=e[1].Tooltip,a=Te(10+2*(n.length+1));a.write_shift(2,2048);var r=bn(e[0]);a.write_shift(2,r.r),a.write_shift(2,r.r),a.write_shift(2,r.c),a.write_shift(2,r.c);for(var s=0;s<n.length;++s)a.write_shift(2,n.charCodeAt(s));return a.write_shift(2,0),a}function TP(e){var n=[0,0],a;return a=e.read_shift(2),n[0]=PN[a]||a,a=e.read_shift(2),n[1]=PN[a]||a,n}function CP(e){return e||(e=Te(4)),e.write_shift(2,1),e.write_shift(2,1),e}function SP(e){for(var n=e.read_shift(2),a=[];n-- >0;)a.push(Ek(e));return a}function _P(e){for(var n=e.read_shift(2),a=[];n-- >0;)a.push(Ek(e));return a}function EP(e){e.l+=2;var n={cxfs:0,crc:0};return n.cxfs=e.read_shift(2),n.crc=e.read_shift(4),n}function Ik(e,n,a){if(!a.cellStyles)return Sa(e,n);var r=a&&a.biff>=12?4:2,s=e.read_shift(r),l=e.read_shift(r),o=e.read_shift(r),d=e.read_shift(r),u=e.read_shift(2);r==2&&(e.l+=2);var x={s,e:l,w:o,ixfe:d,flags:u};return(a.biff>=5||!a.biff)&&(x.level=u>>8&7),x}function DP(e,n){var a=Te(12);a.write_shift(2,n),a.write_shift(2,n),a.write_shift(2,e.width*256),a.write_shift(2,0);var r=0;return e.hidden&&(r|=1),a.write_shift(1,r),r=e.level||0,a.write_shift(1,r),a.write_shift(2,0),a}function AP(e,n){var a={};return n<32||(e.l+=16,a.header=Ta(e),a.footer=Ta(e),e.l+=2),a}function FP(e,n,a){var r={area:!1};if(a.biff!=5)return e.l+=n,r;var s=e.read_shift(1);return e.l+=3,s&16&&(r.area=!0),r}function LP(e){for(var n=Te(2*e),a=0;a<e;++a)n.write_shift(2,a+1);return n}var PP=Ls,IP=Tk,OP=_u;function MP(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(4),s={fmt:n,env:a,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,s}function RP(e,n,a){a.biffguess&&a.biff==5&&(a.biff=2);var r=Ls(e);++e.l;var s=No(e,n-7,a);return r.t="str",r.val=s,r}function BP(e){var n=Ls(e);++e.l;var a=Ta(e);return n.t="n",n.val=a,n}function HP(e,n,a){var r=Te(15);return Fu(r,e,n),r.write_shift(8,a,"f"),r}function VP(e){var n=Ls(e);++e.l;var a=e.read_shift(2);return n.t="n",n.val=a,n}function UP(e,n,a){var r=Te(9);return Fu(r,e,n),r.write_shift(2,a),r}function KP(e){var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,"sbcs-cont")}function zP(e,n){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=n-13}function $P(e,n,a){var r=e.l+n,s=Ls(e),l=e.read_shift(2),o=uo(e,l,a);return e.l=r,s.t="str",s.val=o,s}var GP=[2,3,48,49,131,139,140,245],Ip=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=cx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function a(d,u){var x=[],m=il(1);switch(u.type){case"base64":m=xr(vr(d));break;case"binary":m=xr(d);break;case"buffer":case"array":m=d;break}da(m,0);var f=m.read_shift(1),p=!!(f&136),N=!1,y=!1;switch(f){case 2:break;case 3:break;case 48:N=!0,p=!0;break;case 49:N=!0,p=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,b=521;f==2&&(g=m.read_shift(2)),m.l+=3,f!=2&&(g=m.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(b=m.read_shift(2));var j=m.read_shift(2),T=u.codepage||1252;f!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(T=e[m[m.l]]),m.l+=1,m.l+=2),y&&(m.l+=36);for(var S=[],w={},_=Math.min(m.length,f==2?521:b-10-(N?264:0)),E=y?32:11;m.l<_&&m[m.l]!=13;)switch(w={},w.name=Yd.utils.decode(T,m.slice(m.l,m.l+E)).replace(/[\u0000\r\n].*$/g,""),m.l+=E,w.type=String.fromCharCode(m.read_shift(1)),f!=2&&!y&&(w.offset=m.read_shift(4)),w.len=m.read_shift(1),f==2&&(w.offset=m.read_shift(2)),w.dec=m.read_shift(1),w.name.length&&S.push(w),f!=2&&(m.l+=y?13:14),w.type){case"B":(!N||w.len!=8)&&u.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(m[m.l]!==13&&(m.l=b-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=b;var C=0,P=0;for(x[0]=[],P=0;P!=S.length;++P)x[0][P]=S[P].name;for(;g-- >0;){if(m[m.l]===42){m.l+=j;continue}for(++m.l,x[++C]=[],P=0,P=0;P!=S.length;++P){var F=m.slice(m.l,m.l+S[P].len);m.l+=S[P].len,da(F,0);var R=Yd.utils.decode(T,F);switch(S[P].type){case"C":R.trim().length&&(x[C][P]=R.replace(/\s+$/,""));break;case"D":R.length===8?x[C][P]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):x[C][P]=R;break;case"F":x[C][P]=parseFloat(R.trim());break;case"+":case"I":x[C][P]=y?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":x[C][P]=!0;break;case"N":case"F":x[C][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));x[C][P]="##MEMO##"+(y?parseInt(R.trim(),10):F.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(x[C][P]=+R||0);break;case"@":x[C][P]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":x[C][P]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":x[C][P]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":x[C][P]=-F.read_shift(-8,"f");break;case"B":if(N&&S[P].len==8){x[C][P]=F.read_shift(8,"f");break}case"G":case"P":F.l+=S[P].len;break;case"0":if(S[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[P].type)}}}if(f!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return u&&u.sheetRows&&(x=x.slice(0,u.sheetRows)),u.DBF=S,x}function r(d,u){var x=u||{};x.dateNF||(x.dateNF="yyyymmdd");var m=Mc(a(d,x),x);return m["!cols"]=x.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete x.DBF,m}function s(d,u){try{return xl(r(d,u),u)}catch(x){if(u&&u.WTF)throw x}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function o(d,u){var x=u||{};if(+x.codepage>=0&&Zr(+x.codepage),x.type=="string")throw new Error("Cannot write DBF to JS string");var m=rr(),f=V0(d,{header:1,raw:!0,cellDates:!0}),p=f[0],N=f.slice(1),y=d["!cols"]||[],g=0,b=0,j=0,T=1;for(g=0;g<p.length;++g){if(((y[g]||{}).DBF||{}).name){p[g]=y[g].DBF.name,++j;continue}if(p[g]!=null){if(++j,typeof p[g]=="number"&&(p[g]=p[g].toString(10)),typeof p[g]!="string")throw new Error("DBF Invalid column name "+p[g]+" |"+typeof p[g]+"|");if(p.indexOf(p[g])!==g){for(b=0;b<1024;++b)if(p.indexOf(p[g]+"_"+b)==-1){p[g]+="_"+b;break}}}}var S=Pt(d["!ref"]),w=[],_=[],E=[];for(g=0;g<=S.e.c-S.s.c;++g){var C="",P="",F=0,R=[];for(b=0;b<N.length;++b)N[b][g]!=null&&R.push(N[b][g]);if(R.length==0||p[g]==null){w[g]="?";continue}for(b=0;b<R.length;++b){switch(typeof R[b]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=R[b]instanceof Date?"D":"C";break;default:P="C"}F=Math.max(F,String(R[b]).length),C=C&&C!=P?"C":P}F>250&&(F=250),P=((y[g]||{}).DBF||{}).type,P=="C"&&y[g].DBF.len>F&&(F=y[g].DBF.len),C=="B"&&P=="N"&&(C="N",E[g]=y[g].DBF.dec,F=y[g].DBF.len),_[g]=C=="C"||P=="N"?F:l[C]||0,T+=_[g],w[g]=C}var O=m.next(32);for(O.write_shift(4,318902576),O.write_shift(4,N.length),O.write_shift(2,296+32*j),O.write_shift(2,T),g=0;g<4;++g)O.write_shift(4,0);for(O.write_shift(4,0|(+n[kw]||3)<<8),g=0,b=0;g<p.length;++g)if(p[g]!=null){var M=m.next(32),q=(p[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,q,"sbcs"),M.write_shift(1,w[g]=="?"?"C":w[g],"sbcs"),M.write_shift(4,b),M.write_shift(1,_[g]||l[w[g]]||0),M.write_shift(1,E[g]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),b+=_[g]||l[w[g]]||0}var J=m.next(264);for(J.write_shift(4,13),g=0;g<65;++g)J.write_shift(4,0);for(g=0;g<N.length;++g){var B=m.next(T);for(B.write_shift(1,0),b=0;b<p.length;++b)if(p[b]!=null)switch(w[b]){case"L":B.write_shift(1,N[g][b]==null?63:N[g][b]?84:70);break;case"B":B.write_shift(8,N[g][b]||0,"f");break;case"N":var ue="0";for(typeof N[g][b]=="number"&&(ue=N[g][b].toFixed(E[b]||0)),j=0;j<_[b]-ue.length;++j)B.write_shift(1,32);B.write_shift(1,ue,"sbcs");break;case"D":N[g][b]?(B.write_shift(4,("0000"+N[g][b].getFullYear()).slice(-4),"sbcs"),B.write_shift(2,("00"+(N[g][b].getMonth()+1)).slice(-2),"sbcs"),B.write_shift(2,("00"+N[g][b].getDate()).slice(-2),"sbcs")):B.write_shift(8,"00000000","sbcs");break;case"C":var te=String(N[g][b]!=null?N[g][b]:"").slice(0,_[b]);for(B.write_shift(1,te,"sbcs"),j=0;j<_[b]-te.length;++j)B.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:s,to_sheet:r,from_sheet:o}})(),Ok=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+Tn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(p,N){var y=e[N];return typeof y=="number"?lN(y):y},r=function(p,N,y){var g=N.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return g==59?p:lN(g)};e["|"]=254;function s(p,N){switch(N.type){case"base64":return l(vr(p),N);case"binary":return l(p,N);case"buffer":return l(bt&&Buffer.isBuffer(p)?p.toString("binary"):hl(p),N);case"array":return l(oo(p),N)}throw new Error("Unrecognized type "+N.type)}function l(p,N){var y=p.split(/[\n\r]+/),g=-1,b=-1,j=0,T=0,S=[],w=[],_=null,E={},C=[],P=[],F=[],R=0,O;for(+N.codepage>=0&&Zr(+N.codepage);j!==y.length;++j){R=0;var M=y[j].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(n,a),q=M.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),J=q[0],B;if(M.length>0)switch(J){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&w.push(M.slice(3).replace(/;;/g,";"));break;case"C":var ue=!1,te=!1,Z=!1,Q=!1,fe=-1,K=-1;for(T=1;T<q.length;++T)switch(q[T].charAt(0)){case"A":break;case"X":b=parseInt(q[T].slice(1))-1,te=!0;break;case"Y":for(g=parseInt(q[T].slice(1))-1,te||(b=0),O=S.length;O<=g;++O)S[O]=[];break;case"K":B=q[T].slice(1),B.charAt(0)==='"'?B=B.slice(1,B.length-1):B==="TRUE"?B=!0:B==="FALSE"?B=!1:isNaN(as(B))?isNaN(Sc(B).getDate())||(B=cn(B)):(B=as(B),_!==null&&Ic(_)&&(B=ux(B))),ue=!0;break;case"E":Q=!0;var L=oc(q[T].slice(1),{r:g,c:b});S[g][b]=[S[g][b],L];break;case"S":Z=!0,S[g][b]=[S[g][b],"S5S"];break;case"G":break;case"R":fe=parseInt(q[T].slice(1))-1;break;case"C":K=parseInt(q[T].slice(1))-1;break;default:if(N&&N.WTF)throw new Error("SYLK bad record "+M)}if(ue&&(S[g][b]&&S[g][b].length==2?S[g][b][0]=B:S[g][b]=B,_=null),Z){if(Q)throw new Error("SYLK shared formula cannot have own formula");var X=fe>-1&&S[fe][K];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");S[g][b][1]=eT(X[1],{r:g-fe,c:b-K})}break;case"F":var I=0;for(T=1;T<q.length;++T)switch(q[T].charAt(0)){case"X":b=parseInt(q[T].slice(1))-1,++I;break;case"Y":for(g=parseInt(q[T].slice(1))-1,O=S.length;O<=g;++O)S[O]=[];break;case"M":R=parseInt(q[T].slice(1))/20;break;case"F":break;case"G":break;case"P":_=w[parseInt(q[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=q[T].slice(1).split(" "),O=parseInt(F[0],10);O<=parseInt(F[1],10);++O)R=parseInt(F[2],10),P[O-1]=R===0?{hidden:!0}:{wch:R},ll(P[O-1]);break;case"C":b=parseInt(q[T].slice(1))-1,P[b]||(P[b]={});break;case"R":g=parseInt(q[T].slice(1))-1,C[g]||(C[g]={}),R>0?(C[g].hpt=R,C[g].hpx=Ec(R)):R===0&&(C[g].hidden=!0);break;default:if(N&&N.WTF)throw new Error("SYLK bad record "+M)}I<1&&(_=null);break;default:if(N&&N.WTF)throw new Error("SYLK bad record "+M)}}return C.length>0&&(E["!rows"]=C),P.length>0&&(E["!cols"]=P),N&&N.sheetRows&&(S=S.slice(0,N.sheetRows)),[S,E]}function o(p,N){var y=s(p,N),g=y[0],b=y[1],j=Mc(g,N);return Tn(b).forEach(function(T){j[T]=b[T]}),j}function d(p,N){return xl(o(p,N),N)}function u(p,N,y,g){var b="C;Y"+(y+1)+";X"+(g+1)+";K";switch(p.t){case"n":b+=p.v||0,p.f&&!p.F&&(b+=";E"+Wg(p.f,{r:y,c:g}));break;case"b":b+=p.v?"TRUE":"FALSE";break;case"e":b+=p.w||p.v;break;case"d":b+='"'+(p.w||p.v)+'"';break;case"s":b+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function x(p,N){N.forEach(function(y,g){var b="F;W"+(g+1)+" "+(g+1)+" ";y.hidden?b+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=su(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=iu(y.wpx)),typeof y.wch=="number"&&(b+=Math.round(y.wch))),b.charAt(b.length-1)!=" "&&p.push(b)})}function m(p,N){N.forEach(function(y,g){var b="F;";y.hidden?b+="M0;":y.hpt?b+="M"+20*y.hpt+";":y.hpx&&(b+="M"+20*lu(y.hpx)+";"),b.length>2&&p.push(b+"R"+(g+1))})}function f(p,N){var y=["ID;PWXL;N;E"],g=[],b=Pt(p["!ref"]),j,T=Array.isArray(p),S=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),p["!cols"]&&x(y,p["!cols"]),p["!rows"]&&m(y,p["!rows"]),y.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var w=b.s.r;w<=b.e.r;++w)for(var _=b.s.c;_<=b.e.c;++_){var E=dt({r:w,c:_});j=T?(p[w]||[])[_]:p[E],!(!j||j.v==null&&(!j.f||j.F))&&g.push(u(j,p,w,_))}return y.join(S)+S+g.join(S)+S+"E"+S}return{to_workbook:d,to_sheet:o,from_sheet:f}})(),Mk=(function(){function e(l,o){switch(o.type){case"base64":return n(vr(l),o);case"binary":return n(l,o);case"buffer":return n(bt&&Buffer.isBuffer(l)?l.toString("binary"):hl(l),o);case"array":return n(oo(l),o)}throw new Error("Unrecognized type "+o.type)}function n(l,o){for(var d=l.split(`
`),u=-1,x=-1,m=0,f=[];m!==d.length;++m){if(d[m].trim()==="BOT"){f[++u]=[],x=0;continue}if(!(u<0)){var p=d[m].trim().split(","),N=p[0],y=p[1];++m;for(var g=d[m]||"";(g.match(/["]/g)||[]).length&1&&m<d.length-1;)g+=`
`+d[++m];switch(g=g.trim(),+N){case-1:if(g==="BOT"){f[++u]=[],x=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?f[u][x]=!0:g==="FALSE"?f[u][x]=!1:isNaN(as(y))?isNaN(Sc(y).getDate())?f[u][x]=y:f[u][x]=cn(y):f[u][x]=as(y),++x;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),f[u][x++]=g!==""?g:null;break}if(g==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function a(l,o){return Mc(e(l,o),o)}function r(l,o){return xl(a(l,o),o)}var s=(function(){var l=function(u,x,m,f,p){u.push(x),u.push(m+","+f),u.push('"'+p.replace(/"/g,'""')+'"')},o=function(u,x,m,f){u.push(x+","+m),u.push(x==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(u){var x=[],m=Pt(u["!ref"]),f,p=Array.isArray(u);l(x,"TABLE",0,1,"sheetjs"),l(x,"VECTORS",0,m.e.r-m.s.r+1,""),l(x,"TUPLES",0,m.e.c-m.s.c+1,""),l(x,"DATA",0,0,"");for(var N=m.s.r;N<=m.e.r;++N){o(x,-1,0,"BOT");for(var y=m.s.c;y<=m.e.c;++y){var g=dt({r:N,c:y});if(f=p?(u[N]||[])[y]:u[g],!f){o(x,1,0,"");continue}switch(f.t){case"n":var b=f.w;!b&&f.v!=null&&(b=f.v),b==null?f.f&&!f.F?o(x,1,0,"="+f.f):o(x,1,0,""):o(x,0,b,"V");break;case"b":o(x,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(x,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Hr(f.z||ct[14],Wn(cn(f.v)))),o(x,0,f.w,"V");break;default:o(x,1,0,"")}}}o(x,-1,0,"EOD");var j=`\r
`,T=x.join(j);return T}})();return{to_workbook:r,to_sheet:a,from_sheet:s}})(),Rk=(function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function a(f,p){for(var N=f.split(`
`),y=-1,g=-1,b=0,j=[];b!==N.length;++b){var T=N[b].trim().split(":");if(T[0]==="cell"){var S=bn(T[1]);if(j.length<=S.r)for(y=j.length;y<=S.r;++y)j[y]||(j[y]=[]);switch(y=S.r,g=S.c,T[2]){case"t":j[y][g]=e(T[3]);break;case"v":j[y][g]=+T[3];break;case"vtf":var w=T[T.length-1];case"vtc":switch(T[3]){case"nl":j[y][g]=!!+T[4];break;default:j[y][g]=+T[4];break}T[2]=="vtf"&&(j[y][g]=[j[y][g],w])}}}return p&&p.sheetRows&&(j=j.slice(0,p.sheetRows)),j}function r(f,p){return Mc(a(f,p),p)}function s(f,p){return xl(r(f,p),p)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,d=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function x(f){if(!f||!f["!ref"])return"";for(var p=[],N=[],y,g="",b=sr(f["!ref"]),j=Array.isArray(f),T=b.s.r;T<=b.e.r;++T)for(var S=b.s.c;S<=b.e.c;++S)if(g=dt({r:T,c:S}),y=j?(f[T]||[])[S]:f[g],!(!y||y.v==null||y.t==="z")){switch(N=["cell",g,"t"],y.t){case"s":case"str":N.push(n(y.v));break;case"n":y.f?(N[2]="vtf",N[3]="n",N[4]=y.v,N[5]=n(y.f)):(N[2]="v",N[3]=y.v);break;case"b":N[2]="vt"+(y.f?"f":"c"),N[3]="nl",N[4]=y.v?"1":"0",N[5]=n(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var w=Wn(cn(y.v));N[2]="vtc",N[3]="nd",N[4]=""+w,N[5]=y.w||Hr(y.z||ct[14],w);break;case"e":continue}p.push(N.join(":"))}return p.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function m(f){return[l,o,d,o,x(f),u].join(`
`)}return{to_workbook:s,to_sheet:r,from_sheet:m}})(),_c=(function(){function e(m,f,p,N,y){y.raw?f[p][N]=m:m===""||(m==="TRUE"?f[p][N]=!0:m==="FALSE"?f[p][N]=!1:isNaN(as(m))?isNaN(Sc(m).getDate())?f[p][N]=m:f[p][N]=cn(m):f[p][N]=as(m))}function n(m,f){var p=f||{},N=[];if(!m||m.length===0)return N;for(var y=m.split(/[\r\n]/),g=y.length-1;g>=0&&y[g].length===0;)--g;for(var b=10,j=0,T=0;T<=g;++T)j=y[T].indexOf(" "),j==-1?j=y[T].length:j++,b=Math.max(b,j);for(T=0;T<=g;++T){N[T]=[];var S=0;for(e(y[T].slice(0,b).trim(),N,T,S,p),S=1;S<=(y[T].length-b)/10+1;++S)e(y[T].slice(b+(S-1)*10,b+S*10).trim(),N,T,S,p)}return p.sheetRows&&(N=N.slice(0,p.sheetRows)),N}var a={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function s(m){for(var f={},p=!1,N=0,y=0;N<m.length;++N)(y=m.charCodeAt(N))==34?p=!p:!p&&y in a&&(f[y]=(f[y]||0)+1);y=[];for(N in f)Object.prototype.hasOwnProperty.call(f,N)&&y.push([f[N],N]);if(!y.length){f=r;for(N in f)Object.prototype.hasOwnProperty.call(f,N)&&y.push([f[N],N])}return y.sort(function(g,b){return g[0]-b[0]||r[g[1]]-r[b[1]]}),a[y.pop()[1]]||44}function l(m,f){var p=f||{},N="",y=p.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(N=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(N=m.charAt(4),m=m.slice(6)):N=s(m.slice(0,1024)):p&&p.FS?N=p.FS:N=s(m.slice(0,1024));var b=0,j=0,T=0,S=0,w=0,_=N.charCodeAt(0),E=!1,C=0,P=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var F=p.dateNF!=null?FF(p.dateNF):null;function R(){var O=m.slice(S,w),M={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)M.t="z";else if(p.raw)M.t="s",M.v=O;else if(O.trim().length===0)M.t="s",M.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(M.t="s",M.v=O.slice(2,-1).replace(/""/g,'"')):lM(O)?(M.t="n",M.f=O.slice(1)):(M.t="s",M.v=O);else if(O=="TRUE")M.t="b",M.v=!0;else if(O=="FALSE")M.t="b",M.v=!1;else if(!isNaN(T=as(O)))M.t="n",p.cellText!==!1&&(M.w=O),M.v=T;else if(!isNaN(Sc(O).getDate())||F&&O.match(F)){M.z=p.dateNF||ct[14];var q=0;F&&O.match(F)&&(O=LF(O,p.dateNF,O.match(F)||[]),q=1),p.cellDates?(M.t="d",M.v=cn(O,q)):(M.t="n",M.v=Wn(cn(O,q))),p.cellText!==!1&&(M.w=Hr(M.z,M.v instanceof Date?Wn(M.v):M.v)),p.cellNF||delete M.z}else M.t="s",M.v=O;if(M.t=="z"||(p.dense?(y[b]||(y[b]=[]),y[b][j]=M):y[dt({c:j,r:b})]=M),S=w+1,P=m.charCodeAt(S),g.e.c<j&&(g.e.c=j),g.e.r<b&&(g.e.r=b),C==_)++j;else if(j=0,++b,p.sheetRows&&p.sheetRows<=b)return!0}e:for(;w<m.length;++w)switch(C=m.charCodeAt(w)){case 34:P===34&&(E=!E);break;case _:case 10:case 13:if(!E&&R())break e;break}return w-S>0&&R(),y["!ref"]=gt(g),y}function o(m,f){return!(f&&f.PRN)||f.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?l(m,f):Mc(n(m,f),f)}function d(m,f){var p="",N=f.type=="string"?[0,0,0,0]:ay(m,f);switch(f.type){case"base64":p=vr(m);break;case"binary":p=m;break;case"buffer":f.codepage==65001?p=m.toString("utf8"):f.codepage&&typeof Yd<"u"||(p=bt&&Buffer.isBuffer(m)?m.toString("binary"):hl(m));break;case"array":p=oo(m);break;case"string":p=m;break;default:throw new Error("Unrecognized type "+f.type)}return N[0]==239&&N[1]==187&&N[2]==191?p=Xt(p.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?p=Xt(p):f.type=="binary"&&typeof Yd<"u",p.slice(0,19)=="socialcalc:version:"?Rk.to_sheet(f.type=="string"?p:Xt(p),f):o(p,f)}function u(m,f){return xl(d(m,f),f)}function x(m){for(var f=[],p=Pt(m["!ref"]),N,y=Array.isArray(m),g=p.s.r;g<=p.e.r;++g){for(var b=[],j=p.s.c;j<=p.e.c;++j){var T=dt({r:g,c:j});if(N=y?(m[g]||[])[j]:m[T],!N||N.v==null){b.push("          ");continue}for(var S=(N.w||(ci(N),N.w)||"").slice(0,10);S.length<10;)S+=" ";b.push(S+(j===0?" ":""))}f.push(b.join(""))}return f.join(`
`)}return{to_workbook:u,to_sheet:d,from_sheet:x}})();function qP(e,n){var a=n||{},r=!!a.WTF;a.WTF=!0;try{var s=Ok.to_workbook(e,a);return a.WTF=r,s}catch(l){if(a.WTF=r,!l.message.match(/SYLK bad record ID/)&&r)throw l;return _c.to_workbook(e,n)}}var to=(function(){function e(L,X,I){if(L){da(L,L.l||0);for(var W=I.Enum||fe;L.l<L.length;){var z=L.read_shift(2),xe=W[z]||W[65535],H=L.read_shift(2),ne=L.l+H,oe=xe.f&&xe.f(L,H,I);if(L.l=ne,X(oe,xe,z))return}}}function n(L,X){switch(X.type){case"base64":return a(xr(vr(L)),X);case"binary":return a(xr(L),X);case"buffer":case"array":return a(L,X)}throw"Unsupported type "+X.type}function a(L,X){if(!L)return L;var I=X||{},W=I.dense?[]:{},z="Sheet1",xe="",H=0,ne={},oe=[],Se=[],V={s:{r:0,c:0},e:{r:0,c:0}},be=I.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)I.Enum=fe,e(L,function(Re,Rt,un){switch(un){case 0:I.vers=Re,Re>=4096&&(I.qpro=!0);break;case 6:V=Re;break;case 204:Re&&(xe=Re);break;case 222:xe=Re;break;case 15:case 51:I.qpro||(Re[1].v=Re[1].v.slice(1));case 13:case 14:case 16:un==14&&(Re[2]&112)==112&&(Re[2]&15)>1&&(Re[2]&15)<15&&(Re[1].z=I.dateNF||ct[14],I.cellDates&&(Re[1].t="d",Re[1].v=ux(Re[1].v))),I.qpro&&Re[3]>H&&(W["!ref"]=gt(V),ne[z]=W,oe.push(z),W=I.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},H=Re[3],z=xe||"Sheet"+(H+1),xe="");var hn=I.dense?(W[Re[0].r]||[])[Re[0].c]:W[dt(Re[0])];if(hn){hn.t=Re[1].t,hn.v=Re[1].v,Re[1].z!=null&&(hn.z=Re[1].z),Re[1].f!=null&&(hn.f=Re[1].f);break}I.dense?(W[Re[0].r]||(W[Re[0].r]=[]),W[Re[0].r][Re[0].c]=Re[1]):W[dt(Re[0])]=Re[1];break}},I);else if(L[2]==26||L[2]==14)I.Enum=K,L[2]==14&&(I.qpro=!0,L.l=0),e(L,function(Re,Rt,un){switch(un){case 204:z=Re;break;case 22:Re[1].v=Re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Re[3]>H&&(W["!ref"]=gt(V),ne[z]=W,oe.push(z),W=I.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},H=Re[3],z="Sheet"+(H+1)),be>0&&Re[0].r>=be)break;I.dense?(W[Re[0].r]||(W[Re[0].r]=[]),W[Re[0].r][Re[0].c]=Re[1]):W[dt(Re[0])]=Re[1],V.e.c<Re[0].c&&(V.e.c=Re[0].c),V.e.r<Re[0].r&&(V.e.r=Re[0].r);break;case 27:Re[14e3]&&(Se[Re[14e3][0]]=Re[14e3][1]);break;case 1537:Se[Re[0]]=Re[1],Re[0]==H&&(z=Re[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(W["!ref"]=gt(V),ne[xe||z]=W,oe.push(xe||z),!Se.length)return{SheetNames:oe,Sheets:ne};for(var Oe={},tt=[],Je=0;Je<Se.length;++Je)ne[oe[Je]]?(tt.push(Se[Je]||oe[Je]),Oe[Se[Je]]=ne[Se[Je]]||ne[oe[Je]]):(tt.push(Se[Je]),Oe[Se[Je]]={"!ref":"A1"});return{SheetNames:tt,Sheets:Oe}}function r(L,X){var I=X||{};if(+I.codepage>=0&&Zr(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var W=rr(),z=Pt(L["!ref"]),xe=Array.isArray(L),H=[];Ke(W,0,l(1030)),Ke(W,6,u(z));for(var ne=Math.min(z.e.r,8191),oe=z.s.r;oe<=ne;++oe)for(var Se=Fn(oe),V=z.s.c;V<=z.e.c;++V){oe===z.s.r&&(H[V]=vn(V));var be=H[V]+Se,Oe=xe?(L[oe]||[])[V]:L[be];if(!(!Oe||Oe.t=="z"))if(Oe.t=="n")(Oe.v|0)==Oe.v&&Oe.v>=-32768&&Oe.v<=32767?Ke(W,13,N(oe,V,Oe.v)):Ke(W,14,g(oe,V,Oe.v));else{var tt=ci(Oe);Ke(W,15,f(oe,V,tt.slice(0,239)))}}return Ke(W,1),W.end()}function s(L,X){var I=X||{};if(+I.codepage>=0&&Zr(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var W=rr();Ke(W,0,o(L));for(var z=0,xe=0;z<L.SheetNames.length;++z)(L.Sheets[L.SheetNames[z]]||{})["!ref"]&&Ke(W,27,Q(L.SheetNames[z],xe++));var H=0;for(z=0;z<L.SheetNames.length;++z){var ne=L.Sheets[L.SheetNames[z]];if(!(!ne||!ne["!ref"])){for(var oe=Pt(ne["!ref"]),Se=Array.isArray(ne),V=[],be=Math.min(oe.e.r,8191),Oe=oe.s.r;Oe<=be;++Oe)for(var tt=Fn(Oe),Je=oe.s.c;Je<=oe.e.c;++Je){Oe===oe.s.r&&(V[Je]=vn(Je));var Re=V[Je]+tt,Rt=Se?(ne[Oe]||[])[Je]:ne[Re];if(!(!Rt||Rt.t=="z"))if(Rt.t=="n")Ke(W,23,R(Oe,Je,H,Rt.v));else{var un=ci(Rt);Ke(W,22,C(Oe,Je,H,un.slice(0,239)))}}++H}}return Ke(W,1),W.end()}function l(L){var X=Te(2);return X.write_shift(2,L),X}function o(L){var X=Te(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var I=0,W=0,z=0,xe=0;xe<L.SheetNames.length;++xe){var H=L.SheetNames[xe],ne=L.Sheets[H];if(!(!ne||!ne["!ref"])){++z;var oe=sr(ne["!ref"]);I<oe.e.r&&(I=oe.e.r),W<oe.e.c&&(W=oe.e.c)}}return I>8191&&(I=8191),X.write_shift(2,I),X.write_shift(1,z),X.write_shift(1,W),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function d(L,X,I){var W={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&I.qpro?(W.s.c=L.read_shift(1),L.l++,W.s.r=L.read_shift(2),W.e.c=L.read_shift(1),L.l++,W.e.r=L.read_shift(2),W):(W.s.c=L.read_shift(2),W.s.r=L.read_shift(2),X==12&&I.qpro&&(L.l+=2),W.e.c=L.read_shift(2),W.e.r=L.read_shift(2),X==12&&I.qpro&&(L.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function u(L){var X=Te(8);return X.write_shift(2,L.s.c),X.write_shift(2,L.s.r),X.write_shift(2,L.e.c),X.write_shift(2,L.e.r),X}function x(L,X,I){var W=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(W[0].c=L.read_shift(1),W[3]=L.read_shift(1),W[0].r=L.read_shift(2),L.l+=2):(W[2]=L.read_shift(1),W[0].c=L.read_shift(2),W[0].r=L.read_shift(2)),W}function m(L,X,I){var W=L.l+X,z=x(L,X,I);if(z[1].t="s",I.vers==20768){L.l++;var xe=L.read_shift(1);return z[1].v=L.read_shift(xe,"utf8"),z}return I.qpro&&L.l++,z[1].v=L.read_shift(W-L.l,"cstr"),z}function f(L,X,I){var W=Te(7+I.length);W.write_shift(1,255),W.write_shift(2,X),W.write_shift(2,L),W.write_shift(1,39);for(var z=0;z<W.length;++z){var xe=I.charCodeAt(z);W.write_shift(1,xe>=128?95:xe)}return W.write_shift(1,0),W}function p(L,X,I){var W=x(L,X,I);return W[1].v=L.read_shift(2,"i"),W}function N(L,X,I){var W=Te(7);return W.write_shift(1,255),W.write_shift(2,X),W.write_shift(2,L),W.write_shift(2,I,"i"),W}function y(L,X,I){var W=x(L,X,I);return W[1].v=L.read_shift(8,"f"),W}function g(L,X,I){var W=Te(13);return W.write_shift(1,255),W.write_shift(2,X),W.write_shift(2,L),W.write_shift(8,I,"f"),W}function b(L,X,I){var W=L.l+X,z=x(L,X,I);if(z[1].v=L.read_shift(8,"f"),I.qpro)L.l=W;else{var xe=L.read_shift(2);w(L.slice(L.l,L.l+xe),z),L.l+=xe}return z}function j(L,X,I){var W=X&32768;return X&=-32769,X=(W?L:0)+(X>=8192?X-16384:X),(W?"":"$")+(I?vn(X):Fn(X))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(L,X){da(L,0);for(var I=[],W=0,z="",xe="",H="",ne="";L.l<L.length;){var oe=L[L.l++];switch(oe){case 0:I.push(L.read_shift(8,"f"));break;case 1:xe=j(X[0].c,L.read_shift(2),!0),z=j(X[0].r,L.read_shift(2),!1),I.push(xe+z);break;case 2:{var Se=j(X[0].c,L.read_shift(2),!0),V=j(X[0].r,L.read_shift(2),!1);xe=j(X[0].c,L.read_shift(2),!0),z=j(X[0].r,L.read_shift(2),!1),I.push(Se+V+":"+xe+z)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(L.read_shift(2));break;case 6:{for(var be="";oe=L[L.l++];)be+=String.fromCharCode(oe);I.push('"'+be.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:ne=I.pop(),H=I.pop(),I.push(["AND","OR"][oe-20]+"("+H+","+ne+")");break;default:if(oe<32&&S[oe])ne=I.pop(),H=I.pop(),I.push(H+S[oe]+ne);else if(T[oe]){if(W=T[oe][1],W==69&&(W=L[L.l++]),W>I.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+I.join("|")+"|");return}var Oe=I.slice(-W);I.length-=W,I.push(T[oe][0]+"("+Oe.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}I.length==1?X[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function _(L){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=L.read_shift(2),X[3]=L[L.l++],X[0].c=L[L.l++],X}function E(L,X){var I=_(L);return I[1].t="s",I[1].v=L.read_shift(X-4,"cstr"),I}function C(L,X,I,W){var z=Te(6+W.length);z.write_shift(2,L),z.write_shift(1,I),z.write_shift(1,X),z.write_shift(1,39);for(var xe=0;xe<W.length;++xe){var H=W.charCodeAt(xe);z.write_shift(1,H>=128?95:H)}return z.write_shift(1,0),z}function P(L,X){var I=_(L);I[1].v=L.read_shift(2);var W=I[1].v>>1;if(I[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return I[1].v=W,I}function F(L,X){var I=_(L),W=L.read_shift(4),z=L.read_shift(4),xe=L.read_shift(2);if(xe==65535)return W===0&&z===3221225472?(I[1].t="e",I[1].v=15):W===0&&z===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var H=xe&32768;return xe=(xe&32767)-16446,I[1].v=(1-H*2)*(z*Math.pow(2,xe+32)+W*Math.pow(2,xe)),I}function R(L,X,I,W){var z=Te(14);if(z.write_shift(2,L),z.write_shift(1,I),z.write_shift(1,X),W==0)return z.write_shift(4,0),z.write_shift(4,0),z.write_shift(2,65535),z;var xe=0,H=0,ne=0,oe=0;return W<0&&(xe=1,W=-W),H=Math.log2(W)|0,W/=Math.pow(2,H-31),oe=W>>>0,(oe&2147483648)==0&&(W/=2,++H,oe=W>>>0),W-=oe,oe|=2147483648,oe>>>=0,W*=Math.pow(2,32),ne=W>>>0,z.write_shift(4,ne),z.write_shift(4,oe),H+=16383+(xe?32768:0),z.write_shift(2,H),z}function O(L,X){var I=F(L);return L.l+=X-14,I}function M(L,X){var I=_(L),W=L.read_shift(4);return I[1].v=W>>6,I}function q(L,X){var I=_(L),W=L.read_shift(8,"f");return I[1].v=W,I}function J(L,X){var I=q(L);return L.l+=X-10,I}function B(L,X){return L[L.l+X-1]==0?L.read_shift(X,"cstr"):""}function ue(L,X){var I=L[L.l++];I>X-1&&(I=X-1);for(var W="";W.length<I;)W+=String.fromCharCode(L[L.l++]);return W}function te(L,X,I){if(!(!I.qpro||X<21)){var W=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var z=L.read_shift(X-21,"cstr");return[W,z]}}function Z(L,X){for(var I={},W=L.l+X;L.l<W;){var z=L.read_shift(2);if(z==14e3){for(I[z]=[0,""],I[z][0]=L.read_shift(2);L[L.l];)I[z][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return I}function Q(L,X){var I=Te(5+L.length);I.write_shift(2,14e3),I.write_shift(2,X);for(var W=0;W<L.length;++W){var z=L.charCodeAt(W);I[I.l++]=z>127?95:z}return I[I.l++]=0,I}var fe={0:{n:"BOF",f:Mn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:B},222:{n:"SHEETNAMELP",f:ue},65535:{n:""}},K={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Z},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:J},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:B},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:te},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:s,to_workbook:n}})();function WP(e){var n={},a=e.match(_a),r=0,s=!1;if(a)for(;r!=a.length;++r){var l=ut(a[r]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;n.cp=vg[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=l.val;break;case"<sz":n.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":l.rgb&&(n.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(l[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+l[0])}}return n}var XP=(function(){var e=eu("t"),n=eu("rPr");function a(l){var o=l.match(e);if(!o)return{t:"s",v:""};var d={t:"s",v:Ft(o[1])},u=l.match(n);return u&&(d.s=WP(u[1])),d}var r=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(r,"").split(s).map(a).filter(function(d){return d.v})}})(),QP=(function(){var n=/(\r\n|\n)/g;function a(s,l,o){var d=[];s.u&&d.push("text-decoration: underline;"),s.uval&&d.push("text-underline-style:"+s.uval+";"),s.sz&&d.push("font-size:"+s.sz+"pt;"),s.outline&&d.push("text-effect: outline;"),s.shadow&&d.push("text-shadow: auto;"),l.push('<span style="'+d.join("")+'">'),s.b&&(l.push("<b>"),o.push("</b>")),s.i&&(l.push("<i>"),o.push("</i>")),s.strike&&(l.push("<s>"),o.push("</s>"));var u=s.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(l.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),s}function r(s){var l=[[],s.v,[]];return s.v?(s.s&&a(s.s,l[0],l[2]),l[0].join("")+l[1].replace(n,"<br/>")+l[2].join("")):""}return function(l){return l.map(r).join("")}})(),YP=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,JP=/<(?:\w+:)?r>/,ZP=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Kg(e,n){var a=n?n.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Ft(Xt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Xt(e),a&&(r.h=Eg(r.t))):e.match(JP)&&(r.r=Xt(e),r.t=Ft(Xt((e.replace(ZP,"").match(YP)||[]).join("").replace(_a,""))),a&&(r.h=QP(XP(r.r)))),r):{t:""}}var eI=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,tI=/<(?:\w+:)?(?:si|sstItem)>/g,nI=/<\/(?:\w+:)?(?:si|sstItem)>/;function aI(e,n){var a=[],r="";if(!e)return a;var s=e.match(eI);if(s){r=s[2].replace(tI,"").split(nI);for(var l=0;l!=r.length;++l){var o=Kg(r[l].trim(),n);o!=null&&(a[a.length]=o)}s=ut(s[1]),a.Count=s.count,a.Unique=s.uniqueCount}return a}var rI=/^\s|\s$|[\t\n\r]/;function Bk(e,n){if(!n.bookSST)return"";var a=[Ln];a[a.length]=Ue("sst",null,{xmlns:po[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(e[r]!=null){var s=e[r],l="<si>";s.r?l+=s.r:(l+="<t",s.t||(s.t=""),s.t.match(rI)&&(l+=' xml:space="preserve"'),l+=">"+qt(s.t)+"</t>"),l+="</si>",a[a.length]=l}return a.length>2&&(a[a.length]="</sst>",a[1]=a[1].replace("/>",">")),a.join("")}function sI(e){return[e.read_shift(4),e.read_shift(4)]}function iI(e,n){var a=[],r=!1;return hi(e,function(l,o,d){switch(d){case 159:a.Count=l[0],a.Unique=l[1];break;case 19:a.push(l);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(o.T,!r||n.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}function lI(e,n){return n||(n=Te(8)),n.write_shift(4,e.Count),n.write_shift(4,e.Unique),n}var oI=y8;function cI(e){var n=rr();Ee(n,159,lI(e));for(var a=0;a<e.length;++a)Ee(n,19,oI(e[a]));return Ee(n,160),n.end()}function Hk(e){for(var n=[],a=e.split(""),r=0;r<a.length;++r)n[r]=a[r].charCodeAt(0);return n}function si(e,n){var a={};return a.Major=e.read_shift(2),a.Minor=e.read_shift(2),n>=4&&(e.l+=n-4),a}function dI(e){var n={};return n.id=e.read_shift(0,"lpp4"),n.R=si(e,4),n.U=si(e,4),n.W=si(e,4),n}function uI(e){for(var n=e.read_shift(4),a=e.l+n-4,r={},s=e.read_shift(4),l=[];s-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=l,e.l!=a)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+a);return r}function hI(e){var n=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)n.push(uI(e));return n}function xI(e){var n=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)n.push(e.read_shift(0,"lpp4"));return n}function mI(e){var n={};return e.read_shift(4),e.l+=4,n.id=e.read_shift(0,"lpp4"),n.name=e.read_shift(0,"lpp4"),n.R=si(e,4),n.U=si(e,4),n.W=si(e,4),n}function fI(e){var n=mI(e);if(n.ename=e.read_shift(0,"8lpp4"),n.blksz=e.read_shift(4),n.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function Vk(e,n){var a=e.l+n,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var s=!1;switch(r.AlgID){case 26126:case 26127:case 26128:s=r.Flags==36;break;case 26625:s=r.Flags==4;break;case 0:s=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(a-e.l>>1,"utf16le"),e.l=a,r}function Uk(e,n){var a={},r=e.l+n;return e.l+=4,a.Salt=e.slice(e.l,e.l+16),e.l+=16,a.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),a.VerifierHash=e.slice(e.l,r),e.l=r,a}function pI(e){var n=si(e);switch(n.Minor){case 2:return[n.Minor,gI(e)];case 3:return[n.Minor,yI()];case 4:return[n.Minor,vI(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function gI(e){var n=e.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var a=e.read_shift(4),r=Vk(e,a),s=Uk(e,e.length-e.l);return{t:"Std",h:r,v:s}}function yI(){throw new Error("File is password-protected: ECMA-376 Extensible")}function vI(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var a=e.read_shift(e.length-e.l,"utf8"),r={};return a.replace(_a,function(l){var o=ut(l);switch(Fs(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(d){r[d]=o[d]});break;case"<dataIntegrity":r.encryptedHmacKey=o.encryptedHmacKey,r.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(o);break;default:throw o[0]}}),r}function bI(e,n){var a={},r=a.EncryptionVersionInfo=si(e,4);if(n-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);a.Flags=e.read_shift(4),n-=4;var s=e.read_shift(4);return n-=4,a.EncryptionHeader=Vk(e,s),n-=s,a.EncryptionVerifier=Uk(e,n),a}function NI(e){var n={},a=n.EncryptionVersionInfo=si(e,4);if(a.Major!=1||a.Minor!=1)throw"unrecognized version code "+a.Major+" : "+a.Minor;return n.Salt=e.read_shift(16),n.EncryptedVerifier=e.read_shift(16),n.EncryptedVerifierHash=e.read_shift(16),n}function zg(e){var n=0,a,r=Hk(e),s=r.length+1,l,o,d,u,x;for(a=il(s),a[0]=r.length,l=1;l!=s;++l)a[l]=r[l-1];for(l=s-1;l>=0;--l)o=a[l],d=(n&16384)===0?0:1,u=n<<1&32767,x=d|u,n=x^o;return n^52811}var Kk=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],a=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(o){return(o/2|o*128)&255},s=function(o,d){return r(o^d)},l=function(o){for(var d=n[o.length-1],u=104,x=o.length-1;x>=0;--x)for(var m=o[x],f=0;f!=7;++f)m&64&&(d^=a[u]),m*=2,--u;return d};return function(o){for(var d=Hk(o),u=l(d),x=d.length,m=il(16),f=0;f!=16;++f)m[f]=0;var p,N,y;for((x&1)===1&&(p=u>>8,m[x]=s(e[0],p),--x,p=u&255,N=d[d.length-1],m[x]=s(N,p));x>0;)--x,p=u>>8,m[x]=s(d[x],p),--x,p=u&255,m[x]=s(d[x],p);for(x=15,y=15-d.length;y>0;)p=u>>8,m[x]=s(e[y],p),--x,--y,p=u&255,m[x]=s(d[x],p),--x,--y;return m}})(),jI=function(e,n,a,r,s){s||(s=n),r||(r=Kk(e));var l,o;for(l=0;l!=n.length;++l)o=n[l],o^=r[a],o=(o>>5|o<<3)&255,s[l]=o,++a;return[s,a,r]},wI=function(e){var n=0,a=Kk(e);return function(r){var s=jI("",r,n,a);return n=s[1],s[0]}};function kI(e,n,a,r){var s={key:Mn(e),verificationBytes:Mn(e)};return a.password&&(s.verifier=zg(a.password)),r.valid=s.verificationBytes===s.verifier,r.valid&&(r.insitu=wI(a.password)),s}function TI(e,n,a){var r=a||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=NI(e):r.Data=bI(e,n),r}function CI(e,n,a){var r={Type:a.biff>=8?e.read_shift(2):0};return r.Type?TI(e,n-2,r):kI(e,a.biff>=8?n:n-2,a,r),r}var zk=(function(){function e(s,l){switch(l.type){case"base64":return n(vr(s),l);case"binary":return n(s,l);case"buffer":return n(bt&&Buffer.isBuffer(s)?s.toString("binary"):hl(s),l);case"array":return n(oo(s),l)}throw new Error("Unrecognized type "+l.type)}function n(s,l){var o=l||{},d=o.dense?[]:{},u=s.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var x={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(m,f){Array.isArray(d)&&(d[f]=[]);for(var p=/\\\w+\b/g,N=0,y,g=-1;y=p.exec(m);){switch(y[0]){case"\\cell":var b=m.slice(N,p.lastIndex-y[0].length);if(b[0]==" "&&(b=b.slice(1)),++g,b.length){var j={v:b,t:"s"};Array.isArray(d)?d[f][g]=j:d[dt({r:f,c:g})]=j}break}N=p.lastIndex}g>x.e.c&&(x.e.c=g)}),d["!ref"]=gt(x),d}function a(s,l){return xl(e(s,l),l)}function r(s){for(var l=["{\\rtf1\\ansi"],o=Pt(s["!ref"]),d,u=Array.isArray(s),x=o.s.r;x<=o.e.r;++x){l.push("\\trowd\\trautofit1");for(var m=o.s.c;m<=o.e.c;++m)l.push("\\cellx"+(m+1));for(l.push("\\pard\\intbl"),m=o.s.c;m<=o.e.c;++m){var f=dt({r:x,c:m});d=u?(s[x]||[])[m]:s[f],!(!d||d.v==null&&(!d.f||d.F))&&(l.push(" "+(d.w||(ci(d),d.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:a,to_sheet:e,from_sheet:r}})();function SI(e){var n=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function ru(e){for(var n=0,a=1;n!=3;++n)a=a*256+(e[n]>255?255:e[n]<0?0:e[n]);return a.toString(16).toUpperCase().slice(1)}function _I(e){var n=e[0]/255,a=e[1]/255,r=e[2]/255,s=Math.max(n,a,r),l=Math.min(n,a,r),o=s-l;if(o===0)return[0,0,n];var d=0,u=0,x=s+l;switch(u=o/(x>1?2-x:x),s){case n:d=((a-r)/o+6)%6;break;case a:d=(r-n)/o+2;break;case r:d=(n-a)/o+4;break}return[d/6,u,x/2]}function EI(e){var n=e[0],a=e[1],r=e[2],s=a*2*(r<.5?r:1-r),l=r-s/2,o=[l,l,l],d=6*n,u;if(a!==0)switch(d|0){case 0:case 6:u=s*d,o[0]+=s,o[1]+=u;break;case 1:u=s*(2-d),o[0]+=u,o[1]+=s;break;case 2:u=s*(d-2),o[1]+=s,o[2]+=u;break;case 3:u=s*(4-d),o[1]+=u,o[2]+=s;break;case 4:u=s*(d-4),o[2]+=s,o[0]+=u;break;case 5:u=s*(6-d),o[2]+=u,o[0]+=s;break}for(var x=0;x!=3;++x)o[x]=Math.round(o[x]*255);return o}function R0(e,n){if(n===0)return e;var a=_I(SI(e));return n<0?a[2]=a[2]*(1+n):a[2]=1-(1-a[2])*(1-n),ru(EI(a))}var $k=6,DI=15,AI=1,wa=$k;function su(e){return Math.floor((e+Math.round(128/wa)/256)*wa)}function iu(e){return Math.floor((e-5)/wa*100+.5)/100}function B0(e){return Math.round((e*wa+5)/wa*256)/256}function Ff(e){return B0(iu(su(e)))}function $g(e){var n=Math.abs(e-Ff(e)),a=wa;if(n>.005)for(wa=AI;wa<DI;++wa)Math.abs(e-Ff(e))<=n&&(n=Math.abs(e-Ff(e)),a=wa);wa=a}function ll(e){e.width?(e.wpx=su(e.width),e.wch=iu(e.wpx),e.MDW=wa):e.wpx?(e.wch=iu(e.wpx),e.width=B0(e.wch),e.MDW=wa):typeof e.wch=="number"&&(e.width=B0(e.wch),e.wpx=su(e.width),e.MDW=wa),e.customWidth&&delete e.customWidth}var FI=96,Gk=FI;function lu(e){return e*96/Gk}function Ec(e){return e*Gk/96}var LI={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function PI(e,n,a,r){n.Borders=[];var s={},l=!1;(e[0].match(_a)||[]).forEach(function(o){var d=ut(o);switch(Fs(d[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},d.diagonalUp&&(s.diagonalUp=ln(d.diagonalUp)),d.diagonalDown&&(s.diagonalDown=ln(d.diagonalDown)),n.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+d[0]+" in borders")}})}function II(e,n,a,r){n.Fills=[];var s={},l=!1;(e[0].match(_a)||[]).forEach(function(o){var d=ut(o);switch(Fs(d[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},n.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":d.patternType&&(s.patternType=d.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),d.indexed&&(s.bgColor.indexed=parseInt(d.indexed,10)),d.theme&&(s.bgColor.theme=parseInt(d.theme,10)),d.tint&&(s.bgColor.tint=parseFloat(d.tint)),d.rgb&&(s.bgColor.rgb=d.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),d.theme&&(s.fgColor.theme=parseInt(d.theme,10)),d.tint&&(s.fgColor.tint=parseFloat(d.tint)),d.rgb!=null&&(s.fgColor.rgb=d.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+d[0]+" in fills")}})}function OI(e,n,a,r){n.Fonts=[];var s={},l=!1;(e[0].match(_a)||[]).forEach(function(o){var d=ut(o);switch(Fs(d[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(s),s={};break;case"<name":d.val&&(s.name=Xt(d.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=d.val?ln(d.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=d.val?ln(d.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(d.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=d.val?ln(d.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=d.val?ln(d.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=d.val?ln(d.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=d.val?ln(d.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=d.val?ln(d.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":d.val&&(s.sz=+d.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":d.val&&(s.vertAlign=d.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":d.val&&(s.family=parseInt(d.val,10));break;case"<family/>":case"</family>":break;case"<scheme":d.val&&(s.scheme=d.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(d.val=="1")break;d.codepage=vg[parseInt(d.val,10)];break;case"<color":if(s.color||(s.color={}),d.auto&&(s.color.auto=ln(d.auto)),d.rgb)s.color.rgb=d.rgb.slice(-6);else if(d.indexed){s.color.index=parseInt(d.indexed,10);var u=Zl[s.color.index];s.color.index==81&&(u=Zl[1]),u||(u=Zl[1]),s.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else d.theme&&(s.color.theme=parseInt(d.theme,10),d.tint&&(s.color.tint=parseFloat(d.tint)),d.theme&&a.themeElements&&a.themeElements.clrScheme&&(s.color.rgb=R0(a.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+d[0]+" in fonts")}})}function MI(e,n,a){n.NumberFmt=[];for(var r=Tn(ct),s=0;s<r.length;++s)n.NumberFmt[r[s]]=ct[r[s]];var l=e[0].match(_a);if(l)for(s=0;s<l.length;++s){var o=ut(l[s]);switch(Fs(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var d=Ft(Xt(o.formatCode)),u=parseInt(o.numFmtId,10);if(n.NumberFmt[u]=d,u>0){if(u>392){for(u=392;u>60&&n.NumberFmt[u]!=null;--u);n.NumberFmt[u]=d}ri(d,u)}}break;case"</numFmt>":break;default:if(a.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function RI(e){var n=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var r=a[0];r<=a[1];++r)e[r]!=null&&(n[n.length]=Ue("numFmt",null,{numFmtId:r,formatCode:qt(e[r])}))}),n.length===1?"":(n[n.length]="</numFmts>",n[0]=Ue("numFmts",null,{count:n.length-2}).replace("/>",">"),n.join(""))}var a0=["numFmtId","fillId","fontId","borderId","xfId"],r0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function BI(e,n,a){n.CellXf=[];var r,s=!1;(e[0].match(_a)||[]).forEach(function(l){var o=ut(l),d=0;switch(Fs(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=o,delete r[0],d=0;d<a0.length;++d)r[a0[d]]&&(r[a0[d]]=parseInt(r[a0[d]],10));for(d=0;d<r0.length;++d)r[r0[d]]&&(r[r0[d]]=ln(r[r0[d]]));if(n.NumberFmt&&r.numFmtId>392){for(d=392;d>60;--d)if(n.NumberFmt[r.numFmtId]==n.NumberFmt[d]){r.numFmtId=d;break}}n.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=ln(o.wrapText)),r.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function HI(e){var n=[];return n[n.length]=Ue("cellXfs",null),e.forEach(function(a){n[n.length]=Ue("xf",null,a)}),n[n.length]="</cellXfs>",n.length===2?"":(n[0]=Ue("cellXfs",null,{count:n.length-2}).replace("/>",">"),n.join(""))}var VI=(function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,a=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(d,u,x){var m={};if(!d)return m;d=d.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=d.match(n))&&MI(f,m,x),(f=d.match(s))&&OI(f,m,u,x),(f=d.match(r))&&II(f,m,u,x),(f=d.match(l))&&PI(f,m,u,x),(f=d.match(a))&&BI(f,m,x),m}})();function qk(e,n){var a=[Ln,Ue("styleSheet",null,{xmlns:po[0],"xmlns:vt":$n.vt})],r;return e.SSF&&(r=RI(e.SSF))!=null&&(a[a.length]=r),a[a.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',a[a.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',a[a.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',a[a.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=HI(n.cellXfs))&&(a[a.length]=r),a[a.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',a[a.length]='<dxfs count="0"/>',a[a.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',a.length>2&&(a[a.length]="</styleSheet>",a[1]=a[1].replace("/>",">")),a.join("")}function UI(e,n){var a=e.read_shift(2),r=Ca(e);return[a,r]}function KI(e,n,a){a||(a=Te(6+4*n.length)),a.write_shift(2,e),ra(n,a);var r=a.length>a.l?a.slice(0,a.l):a;return a.l==null&&(a.l=a.length),r}function zI(e,n,a){var r={};r.sz=e.read_shift(2)/20;var s=T8(e);s.fItalic&&(r.italic=1),s.fCondense&&(r.condense=1),s.fExtend&&(r.extend=1),s.fShadow&&(r.shadow=1),s.fOutline&&(r.outline=1),s.fStrikeout&&(r.strike=1);var l=e.read_shift(2);switch(l===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(r.underline=o);var d=e.read_shift(1);d>0&&(r.family=d);var u=e.read_shift(1);switch(u>0&&(r.charset=u),e.l++,r.color=k8(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Ca(e),r}function $I(e,n){n||(n=Te(153)),n.write_shift(2,e.sz*20),C8(e,n),n.write_shift(2,e.bold?700:400);var a=0;e.vertAlign=="superscript"?a=1:e.vertAlign=="subscript"&&(a=2),n.write_shift(2,a),n.write_shift(1,e.underline||0),n.write_shift(1,e.family||0),n.write_shift(1,e.charset||0),n.write_shift(1,0),I0(e.color,n);var r=0;return r=2,n.write_shift(1,r),ra(e.name,n),n.length>n.l?n.slice(0,n.l):n}var GI=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Lf,qI=Sa;function YN(e,n){n||(n=Te(84)),Lf||(Lf=cx(GI));var a=Lf[e.patternType];a==null&&(a=40),n.write_shift(4,a);var r=0;if(a!=40)for(I0({auto:1},n),I0({auto:1},n);r<12;++r)n.write_shift(4,0);else{for(;r<4;++r)n.write_shift(4,0);for(;r<12;++r)n.write_shift(4,0)}return n.length>n.l?n.slice(0,n.l):n}function WI(e,n){var a=e.l+n,r=e.read_shift(2),s=e.read_shift(2);return e.l=a,{ixfe:r,numFmtId:s}}function Wk(e,n,a){a||(a=Te(16)),a.write_shift(2,n||0),a.write_shift(2,e.numFmtId||0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(1,0),a.write_shift(1,0);var r=0;return a.write_shift(1,r),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(1,0),a}function Sd(e,n){return n||(n=Te(10)),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(4,0),n}var XI=Sa;function QI(e,n){return n||(n=Te(51)),n.write_shift(1,0),Sd(null,n),Sd(null,n),Sd(null,n),Sd(null,n),Sd(null,n),n.length>n.l?n.slice(0,n.l):n}function YI(e,n){return n||(n=Te(52)),n.write_shift(4,e.xfId),n.write_shift(2,1),n.write_shift(1,0),n.write_shift(1,0),P0(e.name||"",n),n.length>n.l?n.slice(0,n.l):n}function JI(e,n,a){var r=Te(2052);return r.write_shift(4,e),P0(n,r),P0(a,r),r.length>r.l?r.slice(0,r.l):r}function ZI(e,n,a){var r={};r.NumberFmt=[];for(var s in ct)r.NumberFmt[s]=ct[s];r.CellXf=[],r.Fonts=[];var l=[],o=!1;return hi(e,function(u,x,m){switch(m){case 44:r.NumberFmt[u[0]]=u[1],ri(u[1],u[0]);break;case 43:r.Fonts.push(u),u.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(u.color.rgb=R0(n.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&r.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:l.push(m),o=!0;break;case 38:l.pop(),o=!1;break;default:if(x.T>0)l.push(m);else if(x.T<0)l.pop();else if(!o||a.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),r}function eO(e,n){if(n){var a=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)n[s]!=null&&++a}),a!=0&&(Ee(e,615,rs(a)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)n[s]!=null&&Ee(e,44,KI(s,n[s]))}),Ee(e,616))}}function tO(e){var n=1;Ee(e,611,rs(n)),Ee(e,43,$I({sz:12,color:{theme:1},name:"Calibri",family:2})),Ee(e,612)}function nO(e){var n=2;Ee(e,603,rs(n)),Ee(e,45,YN({patternType:"none"})),Ee(e,45,YN({patternType:"gray125"})),Ee(e,604)}function aO(e){var n=1;Ee(e,613,rs(n)),Ee(e,46,QI()),Ee(e,614)}function rO(e){var n=1;Ee(e,626,rs(n)),Ee(e,47,Wk({numFmtId:0},65535)),Ee(e,627)}function sO(e,n){Ee(e,617,rs(n.length)),n.forEach(function(a){Ee(e,47,Wk(a,0))}),Ee(e,618)}function iO(e){var n=1;Ee(e,619,rs(n)),Ee(e,48,YI({xfId:0,name:"Normal"})),Ee(e,620)}function lO(e){var n=0;Ee(e,505,rs(n)),Ee(e,506)}function oO(e){var n=0;Ee(e,508,JI(n,"TableStyleMedium9","PivotStyleMedium4")),Ee(e,509)}function cO(e,n){var a=rr();return Ee(a,278),eO(a,e.SSF),tO(a),nO(a),aO(a),rO(a),sO(a,n.cellXfs),iO(a),lO(a),oO(a),Ee(a,279),a.end()}var dO=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function uO(e,n,a){n.themeElements.clrScheme=[];var r={};(e[0].match(_a)||[]).forEach(function(s){var l=ut(s);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=l.val;break;case"<a:sysClr":r.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(n.themeElements.clrScheme[dO.indexOf(l[0])]=r,r={}):r.name=l[0].slice(3,l[0].length-1);break;default:if(a&&a.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function hO(){}function xO(){}var mO=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fO=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,pO=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function gO(e,n,a){n.themeElements={};var r;[["clrScheme",mO,uO],["fontScheme",fO,hO],["fmtScheme",pO,xO]].forEach(function(s){if(!(r=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](r,n,a)})}var yO=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Xk(e,n){(!e||e.length===0)&&(e=Gg());var a,r={};if(!(a=e.match(yO)))throw new Error("themeElements not found in theme");return gO(a[0],r,n),r.raw=e,r}function Gg(e,n){if(n&&n.themeXLSX)return n.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var a=[Ln];return a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join("")}function vO(e,n,a){var r=e.l+n,s=e.read_shift(4);if(s!==124226){if(!a.cellStyles){e.l=r;return}var l=e.slice(e.l);e.l=r;var o;try{o=Vw(l,{type:"array"})}catch{return}var d=mr(o,"theme/theme/theme1.xml",!0);if(d)return Xk(d,a)}}function bO(e){return e.read_shift(4)}function NO(e){var n={};switch(n.xclrType=e.read_shift(2),n.nTintShade=e.read_shift(2),n.xclrType){case 0:e.l+=4;break;case 1:n.xclrValue=jO(e,4);break;case 2:n.xclrValue=_k(e);break;case 3:n.xclrValue=bO(e);break;case 4:e.l+=4;break}return e.l+=8,n}function jO(e,n){return Sa(e,n)}function wO(e,n){return Sa(e,n)}function kO(e){var n=e.read_shift(2),a=e.read_shift(2)-4,r=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=NO(e);break;case 6:r[1]=wO(e,a);break;case 14:case 15:r[1]=e.read_shift(a===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+a)}return r}function TO(e,n){var a=e.l+n;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),l=[];s-- >0;)l.push(kO(e,a-e.l));return{ixfe:r,ext:l}}function CO(e,n){n.forEach(function(a){a[0]})}function SO(e,n){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ca(e)}}function _O(e){var n=Te(12+2*e.name.length);return n.write_shift(4,e.flags),n.write_shift(4,e.version),ra(e.name,n),n.slice(0,n.l)}function EO(e){for(var n=[],a=e.read_shift(4);a-- >0;)n.push([e.read_shift(4),e.read_shift(4)]);return n}function DO(e){var n=Te(4+8*e.length);n.write_shift(4,e.length);for(var a=0;a<e.length;++a)n.write_shift(4,e[a][0]),n.write_shift(4,e[a][1]);return n}function AO(e,n){var a=Te(8+2*n.length);return a.write_shift(4,e),ra(n,a),a.slice(0,a.l)}function FO(e){return e.l+=4,e.read_shift(4)!=0}function LO(e,n){var a=Te(8);return a.write_shift(4,e),a.write_shift(4,1),a}function PO(e,n,a){var r={Types:[],Cell:[],Value:[]},s=a||{},l=[],o=!1,d=2;return hi(e,function(u,x,m){switch(m){case 335:r.Types.push({name:u.name});break;case 51:u.forEach(function(f){d==1?r.Cell.push({type:r.Types[f[0]-1].name,index:f[1]}):d==0&&r.Value.push({type:r.Types[f[0]-1].name,index:f[1]})});break;case 337:d=u?1:0;break;case 338:d=2;break;case 35:l.push(m),o=!0;break;case 36:l.pop(),o=!1;break;default:if(!x.T){if(!o||s.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),r}function IO(){var e=rr();return Ee(e,332),Ee(e,334,rs(1)),Ee(e,335,_O({name:"XLDAPR",version:12e4,flags:3496657072})),Ee(e,336),Ee(e,339,AO(1,"XLDAPR")),Ee(e,52),Ee(e,35,rs(514)),Ee(e,4096,rs(0)),Ee(e,4097,Pr(1)),Ee(e,36),Ee(e,53),Ee(e,340),Ee(e,337,LO(1)),Ee(e,51,DO([[1,0]])),Ee(e,338),Ee(e,333),e.end()}function OO(e,n,a){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var s=!1,l=2,o;return e.replace(_a,function(d){var u=ut(d);switch(Fs(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var x=0;x<r.Types.length;++x)r.Types[x].name==u.name&&(o=r.Types[x]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?r.Cell.push({type:r.Types[u.t-1].name,index:+u.v}):l==0&&r.Value.push({type:r.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!s&&a.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return d}),r}function Qk(){var e=[Ln];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function MO(e){var n=[];if(!e)return n;var a=1;return(e.match(_a)||[]).forEach(function(r){var s=ut(r);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?a=s.i:s.i=a,n.push(s);break}}),n}function RO(e){var n={};n.i=e.read_shift(4);var a={};a.r=e.read_shift(4),a.c=e.read_shift(4),n.r=dt(a);var r=e.read_shift(1);return r&2&&(n.l="1"),r&8&&(n.a="1"),n}function BO(e,n,a){var r=[];return hi(e,function(l,o,d){switch(d){case 63:r.push(l);break;default:if(!o.T)throw new Error("Unexpected record 0x"+d.toString(16))}}),r}function HO(e,n,a,r){if(!e)return e;var s=r||{},l=!1;hi(e,function(d,u,x){switch(x){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!u.T){if(!l||s.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}},s)}function VO(e,n){if(!e)return"??";var a=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][a].Target}var sc=1024;function Yk(e,n){for(var a=[21600,21600],r=["m0,0l0",a[1],a[0],a[1],a[0],"0xe"].join(","),s=[Ue("xml",null,{"xmlns:v":ur.v,"xmlns:o":ur.o,"xmlns:x":ur.x,"xmlns:mv":ur.mv}).replace(/\/>/,">"),Ue("o:shapelayout",Ue("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ue("v:shapetype",[Ue("v:stroke",null,{joinstyle:"miter"}),Ue("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:a.join(","),path:r})];sc<e*1e3;)sc+=1e3;return n.forEach(function(l){var o=bn(l[0]),d={color2:"#BEFF82",type:"gradient"};d.type=="gradient"&&(d.angle="-180");var u=d.type=="gradient"?Ue("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,x=Ue("v:fill",u,d),m={on:"t",obscured:"t"};++sc,s=s.concat(["<v:shape"+tu({id:"_x0000_s"+sc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",x,Ue("v:shadow",null,m),Ue("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",xa("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),xa("x:AutoFill","False"),xa("x:Row",String(o.r)),xa("x:Column",String(o.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function JN(e,n,a,r){var s=Array.isArray(e),l;n.forEach(function(o){var d=bn(o.ref);if(s?(e[d.r]||(e[d.r]=[]),l=e[d.r][d.c]):l=e[o.ref],!l){l={t:"z"},s?e[d.r][d.c]=l:e[o.ref]=l;var u=Pt(e["!ref"]||"BDWGO1000001:A1");u.s.r>d.r&&(u.s.r=d.r),u.e.r<d.r&&(u.e.r=d.r),u.s.c>d.c&&(u.s.c=d.c),u.e.c<d.c&&(u.e.c=d.c);var x=gt(u);x!==e["!ref"]&&(e["!ref"]=x)}l.c||(l.c=[]);var m={a:o.author,t:o.t,r:o.r,T:a};o.h&&(m.h=o.h);for(var f=l.c.length-1;f>=0;--f){if(!a&&l.c[f].T)return;a&&!l.c[f].T&&l.c.splice(f,1)}if(a&&r){for(f=0;f<r.length;++f)if(m.a==r[f].id){m.a=r[f].name||m.a;break}}l.c.push(m)})}function UO(e,n){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var a=[],r=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var d=o.match(/<(?:\w+:)?author[^>]*>(.*)/);d&&a.push(d[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var d=o.match(/<(?:\w+:)?comment[^>]*>/);if(d){var u=ut(d[0]),x={author:u.authorId&&a[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},m=bn(u.ref);if(!(n.sheetRows&&n.sheetRows<=m.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!f&&!!f[1]&&Kg(f[1])||{r:"",t:"",h:""};x.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),x.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(x.h=p.h),r.push(x)}}}}),r}function Jk(e){var n=[Ln,Ue("comments",null,{xmlns:po[0]})],a=[];return n.push("<authors>"),e.forEach(function(r){r[1].forEach(function(s){var l=qt(s.a);a.indexOf(l)==-1&&(a.push(l),n.push("<author>"+l+"</author>")),s.T&&s.ID&&a.indexOf("tc="+s.ID)==-1&&(a.push("tc="+s.ID),n.push("<author>tc="+s.ID+"</author>"))})}),a.length==0&&(a.push("SheetJ5"),n.push("<author>SheetJ5</author>")),n.push("</authors>"),n.push("<commentList>"),e.forEach(function(r){var s=0,l=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?s=a.indexOf("tc="+r[1][0].ID):r[1].forEach(function(u){u.a&&(s=a.indexOf(qt(u.a))),l.push(u.t||"")}),n.push('<comment ref="'+r[0]+'" authorId="'+s+'"><text>'),l.length<=1)n.push(xa("t",qt(l[0]||"")));else{for(var o=`Comment:
    `+l[0]+`
`,d=1;d<l.length;++d)o+=`Reply:
    `+l[d]+`
`;n.push(xa("t",qt(o)))}n.push("</text></comment>")}),n.push("</commentList>"),n.length>2&&(n[n.length]="</comments>",n[1]=n[1].replace("/>",">")),n.join("")}function KO(e,n){var a=[],r=!1,s={},l=0;return e.replace(_a,function(d,u){var x=ut(d);switch(Fs(x[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:x.personId,guid:x.id,ref:x.ref,T:1};break;case"</threadedComment>":s.t!=null&&a.push(s);break;case"<text>":case"<text":l=u+d.length;break;case"</text>":s.t=e.slice(l,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+x[0]+" in threaded comments")}return d}),a}function zO(e,n,a){var r=[Ln,Ue("ThreadedComments",null,{xmlns:$n.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var l="";(s[1]||[]).forEach(function(o,d){if(!o.T){delete o.ID;return}o.a&&n.indexOf(o.a)==-1&&n.push(o.a);var u={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+a.tcid++).slice(-12)+"}"};d==0?l=u.id:u.parentId=l,o.ID=u.id,o.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+n.indexOf(o.a)).slice(-12)+"}"),r.push(Ue("threadedComment",xa("text",o.t||""),u))})}),r.push("</ThreadedComments>"),r.join("")}function $O(e,n){var a=[],r=!1;return e.replace(_a,function(l){var o=ut(l);switch(Fs(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":a.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return l}),a}function GO(e){var n=[Ln,Ue("personList",null,{xmlns:$n.TCMNT,"xmlns:x":po[0]}).replace(/[\/]>/,">")];return e.forEach(function(a,r){n.push(Ue("person",null,{displayName:a,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:a,providerId:"None"}))}),n.push("</personList>"),n.join("")}function qO(e){var n={};n.iauthor=e.read_shift(4);var a=bo(e);return n.rfx=a.s,n.ref=dt(a.s),e.l+=16,n}function WO(e,n){return n==null&&(n=Te(36)),n.write_shift(4,e[1].iauthor),Rc(e[0],n),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n}var XO=Ca;function QO(e){return ra(e.slice(0,54))}function YO(e,n){var a=[],r=[],s={},l=!1;return hi(e,function(d,u,x){switch(x){case 632:r.push(d);break;case 635:s=d;break;case 637:s.t=d.t,s.h=d.h,s.r=d.r;break;case 636:if(s.author=r[s.iauthor],delete s.iauthor,n.sheetRows&&s.rfx&&n.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,a.push(s);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!l||n.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}),a}function JO(e){var n=rr(),a=[];return Ee(n,628),Ee(n,630),e.forEach(function(r){r[1].forEach(function(s){a.indexOf(s.a)>-1||(a.push(s.a.slice(0,54)),Ee(n,632,QO(s.a)))})}),Ee(n,631),Ee(n,633),e.forEach(function(r){r[1].forEach(function(s){s.iauthor=a.indexOf(s.a);var l={s:bn(r[0]),e:bn(r[0])};Ee(n,635,WO([l,s])),s.t&&s.t.length>0&&Ee(n,637,b8(s)),Ee(n,636),delete s.iauthor})}),Ee(n,634),Ee(n,629),n.end()}var ZO="application/vnd.ms-office.vbaProject";function eM(e){var n=rt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(a,r){if(!(a.slice(-1)==="/"||!a.match(/_VBA_PROJECT_CUR/))){var s=a.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");rt.utils.cfb_add(n,s,e.FileIndex[r].content)}}),rt.write(n)}function tM(e,n){n.FullPaths.forEach(function(a,r){if(r!=0){var s=a.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&rt.utils.cfb_add(e,s,n.FileIndex[r].content)}})}var Zk=["xlsb","xlsm","xlam","biff8","xla"];function nM(){return{"!type":"dialog"}}function aM(){return{"!type":"dialog"}}function rM(){return{"!type":"macro"}}function sM(){return{"!type":"macro"}}var oc=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function a(r,s,l,o){var d=!1,u=!1;l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1)),o.length==0?d=!0:o.charAt(0)=="["&&(d=!0,o=o.slice(1,-1));var x=l.length>0?parseInt(l,10)|0:0,m=o.length>0?parseInt(o,10)|0:0;return d?m+=n.c:--m,u?x+=n.r:--x,s+(d?"":"$")+vn(m)+(u?"":"$")+Fn(x)}return function(s,l){return n=l,s.replace(e,a)}})(),qg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Wg=(function(){return function(n,a){return n.replace(qg,function(r,s,l,o,d,u){var x=Pg(o)-(l?0:a.c),m=Lg(u)-(d?0:a.r),f=m==0?"":d?m+1:"["+m+"]",p=x==0?"":l?x+1:"["+x+"]";return s+"R"+f+"C"+p})}})();function eT(e,n){return e.replace(qg,function(a,r,s,l,o,d){return r+(s=="$"?s+l:vn(Pg(l)+n.c))+(o=="$"?o+d:Fn(Lg(d)+n.r))})}function iM(e,n,a){var r=sr(n),s=r.s,l=bn(a),o={r:l.r-s.r,c:l.c-s.c};return eT(e,o)}function lM(e){return e.length!=1}function ZN(e){return e.replace(/_xlfn\./g,"")}function In(e){e.l+=1}function ol(e,n){var a=e.read_shift(2);return[a&16383,a>>14&1,a>>15&1]}function tT(e,n,a){var r=2;if(a){if(a.biff>=2&&a.biff<=5)return nT(e);a.biff==12&&(r=4)}var s=e.read_shift(r),l=e.read_shift(r),o=ol(e),d=ol(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:l,c:d[0],cRel:d[1],rRel:d[2]}}}function nT(e){var n=ol(e),a=ol(e),r=e.read_shift(1),s=e.read_shift(1);return{s:{r:n[0],c:r,cRel:n[1],rRel:n[2]},e:{r:a[0],c:s,cRel:a[1],rRel:a[2]}}}function oM(e,n,a){if(a.biff<8)return nT(e);var r=e.read_shift(a.biff==12?4:2),s=e.read_shift(a.biff==12?4:2),l=ol(e),o=ol(e);return{s:{r,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function aT(e,n,a){if(a&&a.biff>=2&&a.biff<=5)return cM(e);var r=e.read_shift(a&&a.biff==12?4:2),s=ol(e);return{r,c:s[0],cRel:s[1],rRel:s[2]}}function cM(e){var n=ol(e),a=e.read_shift(1);return{r:n[0],c:a,cRel:n[1],rRel:n[2]}}function dM(e){var n=e.read_shift(2),a=e.read_shift(2);return{r:n,c:a&255,fQuoted:!!(a&16384),cRel:a>>15,rRel:a>>15}}function uM(e,n,a){var r=a&&a.biff?a.biff:8;if(r>=2&&r<=5)return hM(e);var s=e.read_shift(r>=12?4:2),l=e.read_shift(2),o=(l&16384)>>14,d=(l&32768)>>15;if(l&=16383,d==1)for(;s>524287;)s-=1048576;if(o==1)for(;l>8191;)l=l-16384;return{r:s,c:l,cRel:o,rRel:d}}function hM(e){var n=e.read_shift(2),a=e.read_shift(1),r=(n&32768)>>15,s=(n&16384)>>14;return n&=16383,r==1&&n>=8192&&(n=n-16384),s==1&&a>=128&&(a=a-256),{r:n,c:a,cRel:s,rRel:r}}function xM(e,n,a){var r=(e[e.l++]&96)>>5,s=tT(e,a.biff>=2&&a.biff<=5?6:8,a);return[r,s]}function mM(e,n,a){var r=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),l=8;if(a)switch(a.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var o=tT(e,l,a);return[r,s,o]}function fM(e,n,a){var r=(e[e.l++]&96)>>5;return e.l+=a&&a.biff>8?12:a.biff<8?6:8,[r]}function pM(e,n,a){var r=(e[e.l++]&96)>>5,s=e.read_shift(2),l=8;if(a)switch(a.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[r,s]}function gM(e,n,a){var r=(e[e.l++]&96)>>5,s=oM(e,n-1,a);return[r,s]}function yM(e,n,a){var r=(e[e.l++]&96)>>5;return e.l+=a.biff==2?6:a.biff==12?14:7,[r]}function e2(e){var n=e[e.l+1]&1,a=1;return e.l+=4,[n,a]}function vM(e,n,a){e.l+=2;for(var r=e.read_shift(a&&a.biff==2?1:2),s=[],l=0;l<=r;++l)s.push(e.read_shift(a&&a.biff==2?1:2));return s}function bM(e,n,a){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(a&&a.biff==2?1:2)]}function NM(e,n,a){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(a&&a.biff==2?1:2)]}function jM(e){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(2)]}function wM(e,n,a){var r=e[e.l+1]&255?1:0;return e.l+=a&&a.biff==2?3:4,[r]}function rT(e){var n=e.read_shift(1),a=e.read_shift(1);return[n,a]}function kM(e){return e.read_shift(2),rT(e)}function TM(e){return e.read_shift(2),rT(e)}function CM(e,n,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=aT(e,0,a);return[r,s]}function SM(e,n,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=uM(e,0,a);return[r,s]}function _M(e,n,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);a&&a.biff==5&&(e.l+=12);var l=aT(e,0,a);return[r,s,l]}function EM(e,n,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(a&&a.biff<=3?1:2);return[F7[s],lT[s],r]}function DM(e,n,a){var r=e[e.l++],s=e.read_shift(1),l=a&&a.biff<=3?[r==88?-1:0,e.read_shift(1)]:AM(e);return[s,(l[0]===0?lT:A7)[l[1]]]}function AM(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function FM(e,n,a){e.l+=a&&a.biff==2?3:4}function LM(e,n,a){if(e.l++,a&&a.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),s=e.read_shift(a&&a.biff==2?1:2);return[r,s]}function PM(e){return e.l++,xi[e.read_shift(1)]}function IM(e){return e.l++,e.read_shift(2)}function OM(e){return e.l++,e.read_shift(1)!==0}function MM(e){return e.l++,Ta(e)}function RM(e,n,a){return e.l++,Su(e,n-1,a)}function BM(e,n){var a=[e.read_shift(1)];if(n==12)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2;break}switch(a[0]){case 4:a[1]=Dn(e,1)?"TRUE":"FALSE",n!=12&&(e.l+=7);break;case 37:case 16:a[1]=xi[e[e.l]],e.l+=n==12?4:8;break;case 0:e.l+=8;break;case 1:a[1]=Ta(e);break;case 2:a[1]=No(e,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function HM(e,n,a){for(var r=e.read_shift(a.biff==12?4:2),s=[],l=0;l!=r;++l)s.push((a.biff==12?bo:hx)(e));return s}function VM(e,n,a){var r=0,s=0;a.biff==12?(r=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),r=1+e.read_shift(2)),a.biff>=2&&a.biff<8&&(--r,--s==0&&(s=256));for(var l=0,o=[];l!=r&&(o[l]=[]);++l)for(var d=0;d!=s;++d)o[l][d]=BM(e,a.biff);return o}function UM(e,n,a){var r=e.read_shift(1)>>>5&3,s=!a||a.biff>=8?4:2,l=e.read_shift(s);switch(a.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,l]}function KM(e,n,a){if(a.biff==5)return zM(e);var r=e.read_shift(1)>>>5&3,s=e.read_shift(2),l=e.read_shift(4);return[r,s,l]}function zM(e){var n=e.read_shift(1)>>>5&3,a=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[n,a,r]}function $M(e,n,a){var r=e.read_shift(1)>>>5&3;e.l+=a&&a.biff==2?3:4;var s=e.read_shift(a&&a.biff==2?1:2);return[r,s]}function GM(e,n,a){var r=e.read_shift(1)>>>5&3,s=e.read_shift(a&&a.biff==2?1:2);return[r,s]}function qM(e,n,a){var r=e.read_shift(1)>>>5&3;return e.l+=4,a.biff<8&&e.l--,a.biff==12&&(e.l+=2),[r]}function WM(e,n,a){var r=(e[e.l++]&96)>>5,s=e.read_shift(2),l=4;if(a)switch(a.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[r,s]}var XM=Sa,QM=Sa,YM=Sa;function Eu(e,n,a){return e.l+=2,[dM(e)]}function Xg(e){return e.l+=6,[]}var JM=Eu,ZM=Xg,e7=Xg,t7=Eu;function sT(e){return e.l+=2,[Mn(e),e.read_shift(2)&1]}var n7=Eu,a7=sT,r7=Xg,s7=Eu,i7=Eu,l7=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function o7(e){e.l+=2;var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(4),s=e.read_shift(2),l=e.read_shift(2),o=l7[a>>2&31];return{ixti:n,coltype:a&3,rt:o,idx:r,c:s,C:l}}function c7(e){return e.l+=2,[e.read_shift(4)]}function d7(e,n,a){return e.l+=5,e.l+=2,e.l+=a.biff==2?1:4,["PTGSHEET"]}function u7(e,n,a){return e.l+=a.biff==2?4:5,["PTGENDSHEET"]}function h7(e){var n=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[n,a]}function x7(e){var n=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[n,a]}function m7(e){return e.l+=4,[0,0]}var t2={1:{n:"PtgExp",f:LM},2:{n:"PtgTbl",f:YM},3:{n:"PtgAdd",f:In},4:{n:"PtgSub",f:In},5:{n:"PtgMul",f:In},6:{n:"PtgDiv",f:In},7:{n:"PtgPower",f:In},8:{n:"PtgConcat",f:In},9:{n:"PtgLt",f:In},10:{n:"PtgLe",f:In},11:{n:"PtgEq",f:In},12:{n:"PtgGe",f:In},13:{n:"PtgGt",f:In},14:{n:"PtgNe",f:In},15:{n:"PtgIsect",f:In},16:{n:"PtgUnion",f:In},17:{n:"PtgRange",f:In},18:{n:"PtgUplus",f:In},19:{n:"PtgUminus",f:In},20:{n:"PtgPercent",f:In},21:{n:"PtgParen",f:In},22:{n:"PtgMissArg",f:In},23:{n:"PtgStr",f:RM},26:{n:"PtgSheet",f:d7},27:{n:"PtgEndSheet",f:u7},28:{n:"PtgErr",f:PM},29:{n:"PtgBool",f:OM},30:{n:"PtgInt",f:IM},31:{n:"PtgNum",f:MM},32:{n:"PtgArray",f:yM},33:{n:"PtgFunc",f:EM},34:{n:"PtgFuncVar",f:DM},35:{n:"PtgName",f:UM},36:{n:"PtgRef",f:CM},37:{n:"PtgArea",f:xM},38:{n:"PtgMemArea",f:$M},39:{n:"PtgMemErr",f:XM},40:{n:"PtgMemNoMem",f:QM},41:{n:"PtgMemFunc",f:GM},42:{n:"PtgRefErr",f:qM},43:{n:"PtgAreaErr",f:fM},44:{n:"PtgRefN",f:SM},45:{n:"PtgAreaN",f:gM},46:{n:"PtgMemAreaN",f:h7},47:{n:"PtgMemNoMemN",f:x7},57:{n:"PtgNameX",f:KM},58:{n:"PtgRef3d",f:_M},59:{n:"PtgArea3d",f:mM},60:{n:"PtgRefErr3d",f:WM},61:{n:"PtgAreaErr3d",f:pM},255:{}},f7={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},p7={1:{n:"PtgElfLel",f:sT},2:{n:"PtgElfRw",f:s7},3:{n:"PtgElfCol",f:JM},6:{n:"PtgElfRwV",f:i7},7:{n:"PtgElfColV",f:t7},10:{n:"PtgElfRadical",f:n7},11:{n:"PtgElfRadicalS",f:r7},13:{n:"PtgElfColS",f:ZM},15:{n:"PtgElfColSV",f:e7},16:{n:"PtgElfRadicalLel",f:a7},25:{n:"PtgList",f:o7},29:{n:"PtgSxName",f:c7},255:{}},g7={0:{n:"PtgAttrNoop",f:m7},1:{n:"PtgAttrSemi",f:wM},2:{n:"PtgAttrIf",f:NM},4:{n:"PtgAttrChoose",f:vM},8:{n:"PtgAttrGoto",f:bM},16:{n:"PtgAttrSum",f:FM},32:{n:"PtgAttrBaxcel",f:e2},33:{n:"PtgAttrBaxcel",f:e2},64:{n:"PtgAttrSpace",f:kM},65:{n:"PtgAttrSpaceSemi",f:TM},128:{n:"PtgAttrIfError",f:jM},255:{}};function Du(e,n,a,r){if(r.biff<8)return Sa(e,n);for(var s=e.l+n,l=[],o=0;o!==a.length;++o)switch(a[o][0]){case"PtgArray":a[o][1]=VM(e,0,r),l.push(a[o][1]);break;case"PtgMemArea":a[o][2]=HM(e,a[o][1],r),l.push(a[o][2]);break;case"PtgExp":r&&r.biff==12&&(a[o][1][1]=e.read_shift(4),l.push(a[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[o][0]}return n=s-e.l,n!==0&&l.push(Sa(e,n)),l}function Au(e,n,a){for(var r=e.l+n,s,l,o=[];r!=e.l;)n=r-e.l,l=e[e.l],s=t2[l]||t2[f7[l]],(l===24||l===25)&&(s=(l===24?p7:g7)[e[e.l+1]]),!s||!s.f?Sa(e,n):o.push([s.n,s.f(e,n,a)]);return o}function y7(e){for(var n=[],a=0;a<e.length;++a){for(var r=e[a],s=[],l=0;l<r.length;++l){var o=r[l];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}n.push(s.join(","))}return n.join(";")}var v7={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function b7(e,n){if(!e&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function iT(e,n,a){if(!e)return"SH33TJSERR0";if(a.biff>8&&(!e.XTI||!e.XTI[n]))return e.SheetNames[n];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[n];if(a.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":e.XTI[n-1];if(!r)return"SH33TJSERR1";var s="";if(a.biff>8)switch(e[r[0]][0]){case 357:return s=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 358:return a.SID!=null?e.SheetNames[a.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return s=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[r[0]][0][3]?(s=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?s:s+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function n2(e,n,a){var r=iT(e,n,a);return r=="#REF"?r:b7(r,a)}function ja(e,n,a,r,s){var l=s&&s.biff||8,o={s:{c:0,r:0}},d=[],u,x,m,f=0,p=0,N,y="";if(!e[0]||!e[0][0])return"";for(var g=-1,b="",j=0,T=e[0].length;j<T;++j){var S=e[0][j];switch(S[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=d.pop(),x=d.pop(),g>=0){switch(e[0][g][1][0]){case 0:b=wn(" ",e[0][g][1][1]);break;case 1:b=wn("\r",e[0][g][1][1]);break;default:if(b="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}x=x+b,g=-1}d.push(x+v7[S[0]]+u);break;case"PtgIsect":u=d.pop(),x=d.pop(),d.push(x+" "+u);break;case"PtgUnion":u=d.pop(),x=d.pop(),d.push(x+","+u);break;case"PtgRange":u=d.pop(),x=d.pop(),d.push(x+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=Bd(S[1][1],o,s),d.push(Hd(m,l));break;case"PtgRefN":m=a?Bd(S[1][1],a,s):S[1][1],d.push(Hd(m,l));break;case"PtgRef3d":f=S[1][1],m=Bd(S[1][2],o,s),y=n2(r,f,s),d.push(y+"!"+Hd(m,l));break;case"PtgFunc":case"PtgFuncVar":var w=S[1][0],_=S[1][1];w||(w=0),w&=127;var E=w==0?[]:d.slice(-w);d.length-=w,_==="User"&&(_=E.shift()),d.push(_+"("+E.join(",")+")");break;case"PtgBool":d.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":d.push(S[1]);break;case"PtgNum":d.push(String(S[1]));break;case"PtgStr":d.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":d.push(S[1]);break;case"PtgAreaN":N=AN(S[1][1],a?{s:a}:o,s),d.push(Ef(N,s));break;case"PtgArea":N=AN(S[1][1],o,s),d.push(Ef(N,s));break;case"PtgArea3d":f=S[1][1],N=S[1][2],y=n2(r,f,s),d.push(y+"!"+Ef(N,s));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=S[1][2];var C=(r.names||[])[p-1]||(r[0]||[])[p],P=C?C.Name:"SH33TJSNAME"+String(p);P&&P.slice(0,6)=="_xlfn."&&!s.xlfn&&(P=P.slice(6)),d.push(P);break;case"PtgNameX":var F=S[1][1];p=S[1][2];var R;if(s.biff<=5)F<0&&(F=-F),r[F]&&(R=r[F][p]);else{var O="";if(((r[F]||[])[0]||[])[0]==14849||(((r[F]||[])[0]||[])[0]==1025?r[F][p]&&r[F][p].itab>0&&(O=r.SheetNames[r[F][p].itab-1]+"!"):O=r.SheetNames[p-1]+"!"),r[F]&&r[F][p])O+=r[F][p].Name;else if(r[0]&&r[0][p])O+=r[0][p].Name;else{var M=(iT(r,F,s)||"").split(";;");M[p-1]?O=M[p-1]:O+="SH33TJSERRX"}d.push(O);break}R||(R={Name:"SH33TJSERRY"}),d.push(R.Name);break;case"PtgParen":var q="(",J=")";if(g>=0){switch(b="",e[0][g][1][0]){case 2:q=wn(" ",e[0][g][1][1])+q;break;case 3:q=wn("\r",e[0][g][1][1])+q;break;case 4:J=wn(" ",e[0][g][1][1])+J;break;case 5:J=wn("\r",e[0][g][1][1])+J;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}d.push(q+d.pop()+J);break;case"PtgRefErr":d.push("#REF!");break;case"PtgRefErr3d":d.push("#REF!");break;case"PtgExp":m={c:S[1][1],r:S[1][0]};var B={c:a.c,r:a.r};if(r.sharedf[dt(m)]){var ue=r.sharedf[dt(m)];d.push(ja(ue,o,B,r,s))}else{var te=!1;for(u=0;u!=r.arrayf.length;++u)if(x=r.arrayf[u],!(m.c<x[0].s.c||m.c>x[0].e.c)&&!(m.r<x[0].s.r||m.r>x[0].e.r)){d.push(ja(x[1],o,B,r,s)),te=!0;break}te||d.push(S[1])}break;case"PtgArray":d.push("{"+y7(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=j;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":d.push("");break;case"PtgAreaErr":d.push("#REF!");break;case"PtgAreaErr3d":d.push("#REF!");break;case"PtgList":d.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var Z=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&Z.indexOf(e[0][j][0])==-1){S=e[0][g];var Q=!0;switch(S[1][0]){case 4:Q=!1;case 0:b=wn(" ",S[1][1]);break;case 5:Q=!1;case 1:b=wn("\r",S[1][1]);break;default:if(b="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}d.push((Q?b:"")+d.pop()+(Q?"":b)),g=-1}}if(d.length>1&&s.WTF)throw new Error("bad formula stack");return d[0]}function N7(e,n,a){var r=e.l+n,s=a.biff==2?1:2,l,o=e.read_shift(s);if(o==65535)return[[],Sa(e,n-2)];var d=Au(e,o,a);return n!==o+s&&(l=Du(e,n-o-s,d,a)),e.l=r,[d,l]}function j7(e,n,a){var r=e.l+n,s=a.biff==2?1:2,l,o=e.read_shift(s);if(o==65535)return[[],Sa(e,n-2)];var d=Au(e,o,a);return n!==o+s&&(l=Du(e,n-o-s,d,a)),e.l=r,[d,l]}function w7(e,n,a,r){var s=e.l+n,l=Au(e,r,a),o;return s!==e.l&&(o=Du(e,s-e.l,l,a)),[l,o]}function k7(e,n,a){var r=e.l+n,s,l=e.read_shift(2),o=Au(e,l,a);return l==65535?[[],Sa(e,n-2)]:(n!==l+2&&(s=Du(e,r-l-2,o,a)),[o,s])}function T7(e){var n;if(Zs(e,e.l+6)!==65535)return[Ta(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return n=e[e.l+2]===1,e.l+=8,[n,"b"];case 2:return n=e[e.l+2],e.l+=8,[n,"e"];case 3:return e.l+=8,["","s"]}return[]}function C7(e){if(e==null){var n=Te(8);return n.write_shift(1,3),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,65535),n}else if(typeof e=="number")return co(e);return co(0)}function Pf(e,n,a){var r=e.l+n,s=Ls(e);a.biff==2&&++e.l;var l=T7(e),o=e.read_shift(1);a.biff!=2&&(e.read_shift(1),a.biff>=5&&e.read_shift(4));var d=j7(e,r-e.l,a);return{cell:s,val:l[0],formula:d,shared:o>>3&1,tt:l[1]}}function S7(e,n,a,r,s){var l=ho(n,a,s),o=C7(e.v),d=Te(6),u=33;d.write_shift(2,u),d.write_shift(4,0);for(var x=Te(e.bf.length),m=0;m<e.bf.length;++m)x[m]=e.bf[m];var f=aa([l,o,d,x]);return f}function xx(e,n,a){var r=e.read_shift(4),s=Au(e,r,a),l=e.read_shift(4),o=l>0?Du(e,l,s,a):null;return[s,o]}var _7=xx,mx=xx,E7=xx,D7=xx,A7={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},lT={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},F7={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function a2(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,a){return a.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function L7(e){var n="of:="+e.replace(qg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return n.replace(/;/g,"|").replace(/,/g,";")}function If(e){var n=e.split(":"),a=n[0].split(".")[0];return[a,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}function P7(e){return e.replace(/\./,"!")}var Ud={},cc={},Kd=typeof Map<"u";function Qg(e,n,a){var r=0,s=e.length;if(a){if(Kd?a.has(n):Object.prototype.hasOwnProperty.call(a,n)){for(var l=Kd?a.get(n):a[n];r<l.length;++r)if(e[l[r]].t===n)return e.Count++,l[r]}}else for(;r<s;++r)if(e[r].t===n)return e.Count++,r;return e[s]={t:n},e.Count++,e.Unique++,a&&(Kd?(a.has(n)||a.set(n,[]),a.get(n).push(s)):(Object.prototype.hasOwnProperty.call(a,n)||(a[n]=[]),a[n].push(s))),s}function fx(e,n){var a={min:e+1,max:e+1},r=-1;return n.MDW&&(wa=n.MDW),n.width!=null?a.customWidth=1:n.wpx!=null?r=iu(n.wpx):n.wch!=null&&(r=n.wch),r>-1?(a.width=B0(r),a.customWidth=1):n.width!=null&&(a.width=n.width),n.hidden&&(a.hidden=!0),n.level!=null&&(a.outlineLevel=a.level=n.level),a}function no(e,n){if(e){var a=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(a=[1,1,1,1,.5,.5]),e.left==null&&(e.left=a[0]),e.right==null&&(e.right=a[1]),e.top==null&&(e.top=a[2]),e.bottom==null&&(e.bottom=a[3]),e.header==null&&(e.header=a[4]),e.footer==null&&(e.footer=a[5])}}function ml(e,n,a){var r=a.revssf[n.z!=null?n.z:"General"],s=60,l=e.length;if(r==null&&a.ssf){for(;s<392;++s)if(a.ssf[s]==null){ri(n.z,s),a.ssf[s]=n.z,a.revssf[n.z]=r=s;break}}for(s=0;s!=l;++s)if(e[s].numFmtId===r)return s;return e[l]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function oT(e,n,a,r,s,l){try{r.cellNF&&(e.z=ct[n])}catch(d){if(r.WTF)throw d}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=cn(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(ct[n]==null&&ri(AF[n]||"General",n),e.t==="e")e.w=e.w||xi[e.v];else if(n===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zd(e.v);else if(e.t==="d"){var o=Wn(e.v);(o|0)===o?e.w=o.toString(10):e.w=Zd(o)}else{if(e.v===void 0)return"";e.w=lo(e.v,cc)}else e.t==="d"?e.w=Hr(n,Wn(e.v),cc):e.w=Hr(n,e.v,cc)}catch(d){if(r.WTF)throw d}if(r.cellStyles&&a!=null)try{e.s=l.Fills[a],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=R0(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=R0(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(d){if(r.WTF&&l.Fills)throw d}}}function I7(e,n,a){if(e&&e["!ref"]){var r=Pt(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+a+"): "+e["!ref"])}}function O7(e,n){var a=Pt(n);a.s.r<=a.e.r&&a.s.c<=a.e.c&&a.s.r>=0&&a.s.c>=0&&(e["!ref"]=gt(a))}var M7=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,R7=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,B7=/<(?:\w:)?hyperlink [^>]*>/mg,H7=/"(\w*:\w*)"/,V7=/<(?:\w:)?col\b[^>]*[\/]?>/g,U7=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,K7=/<(?:\w:)?pageMargins[^>]*\/>/g,cT=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,z7=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,$7=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function G7(e,n,a,r,s,l,o){if(!e)return e;r||(r={"!id":{}});var d=n.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},x="",m="",f=e.match(R7);f?(x=e.slice(0,f.index),m=e.slice(f.index+f[0].length)):x=m=e;var p=x.match(cT);p?Yg(p[0],d,s,a):(p=x.match(z7))&&W7(p[0],p[1]||"",d,s,a);var N=(x.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(N>0){var y=x.slice(N,N+50).match(H7);y&&O7(d,y[1])}var g=x.match($7);g&&g[1]&&lR(g[1],s);var b=[];if(n.cellStyles){var j=x.match(V7);j&&nR(b,j)}f&&dR(f[1],d,n,u,l,o);var T=m.match(U7);T&&(d["!autofilter"]=rR(T[0]));var S=[],w=m.match(M7);if(w)for(N=0;N!=w.length;++N)S[N]=Pt(w[N].slice(w[N].indexOf('"')+1));var _=m.match(B7);_&&Z7(d,_,r);var E=m.match(K7);if(E&&(d["!margins"]=eR(ut(E[0]))),!d["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(d["!ref"]=gt(u)),n.sheetRows>0&&d["!ref"]){var C=Pt(d["!ref"]);n.sheetRows<=+C.e.r&&(C.e.r=n.sheetRows-1,C.e.r>u.e.r&&(C.e.r=u.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>u.e.c&&(C.e.c=u.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),d["!fullref"]=d["!ref"],d["!ref"]=gt(C))}return b.length>0&&(d["!cols"]=b),S.length>0&&(d["!merges"]=S),d}function q7(e){if(e.length===0)return"";for(var n='<mergeCells count="'+e.length+'">',a=0;a!=e.length;++a)n+='<mergeCell ref="'+gt(e[a])+'"/>';return n+"</mergeCells>"}function Yg(e,n,a,r){var s=ut(e);a.Sheets[r]||(a.Sheets[r]={}),s.codeName&&(a.Sheets[r].CodeName=Ft(Xt(s.codeName)))}function W7(e,n,a,r,s){Yg(e.slice(0,e.indexOf(">")),a,r,s)}function X7(e,n,a,r,s){var l=!1,o={},d=null;if(r.bookType!=="xlsx"&&n.vbaraw){var u=n.SheetNames[a];try{n.Workbook&&(u=n.Workbook.Sheets[a].CodeName||u)}catch{}l=!0,o.codeName=Cs(qt(u))}if(e&&e["!outline"]){var x={summaryBelow:1,summaryRight:1};e["!outline"].above&&(x.summaryBelow=0),e["!outline"].left&&(x.summaryRight=0),d=(d||"")+Ue("outlinePr",null,x)}!l&&!d||(s[s.length]=Ue("sheetPr",d,o))}var Q7=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Y7=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function J7(e){var n={sheet:1};return Q7.forEach(function(a){e[a]!=null&&e[a]&&(n[a]="1")}),Y7.forEach(function(a){e[a]!=null&&!e[a]&&(n[a]="0")}),e.password&&(n.password=zg(e.password).toString(16).toUpperCase()),Ue("sheetProtection",null,n)}function Z7(e,n,a){for(var r=Array.isArray(e),s=0;s!=n.length;++s){var l=ut(Xt(n[s]),!0);if(!l.ref)return;var o=((a||{})["!id"]||[])[l.id];o?(l.Target=o.Target,l.location&&(l.Target+="#"+Ft(l.location))):(l.Target="#"+Ft(l.location),o={Target:l.Target,TargetMode:"Internal"}),l.Rel=o,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var d=Pt(l.ref),u=d.s.r;u<=d.e.r;++u)for(var x=d.s.c;x<=d.e.c;++x){var m=dt({c:x,r:u});r?(e[u]||(e[u]=[]),e[u][x]||(e[u][x]={t:"z",v:void 0}),e[u][x].l=l):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=l)}}}function eR(e){var n={};return["left","right","top","bottom","header","footer"].forEach(function(a){e[a]&&(n[a]=parseFloat(e[a]))}),n}function tR(e){return no(e),Ue("pageMargins",null,e)}function nR(e,n){for(var a=!1,r=0;r!=n.length;++r){var s=ut(n[r],!0);s.hidden&&(s.hidden=ln(s.hidden));var l=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!a&&s.width&&(a=!0,$g(s.width)),ll(s);l<=o;)e[l++]=dn(s)}}function aR(e,n){for(var a=["<cols>"],r,s=0;s!=n.length;++s)(r=n[s])&&(a[a.length]=Ue("col",null,fx(s,r)));return a[a.length]="</cols>",a.join("")}function rR(e){var n={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return n}function sR(e,n,a,r){var s=typeof e.ref=="string"?e.ref:gt(e.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var l=a.Workbook.Names,o=sr(s);o.s.r==o.e.r&&(o.e.r=sr(n["!ref"]).e.r,s=gt(o));for(var d=0;d<l.length;++d){var u=l[d];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r){u.Ref="'"+a.SheetNames[r]+"'!"+s;break}}return d==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+a.SheetNames[r]+"'!"+s}),Ue("autoFilter",null,{ref:s})}var iR=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function lR(e,n){n.Views||(n.Views=[{}]),(e.match(iR)||[]).forEach(function(a,r){var s=ut(a);n.Views[r]||(n.Views[r]={}),+s.zoomScale&&(n.Views[r].zoom=+s.zoomScale),ln(s.rightToLeft)&&(n.Views[r].RTL=!0)})}function oR(e,n,a,r){var s={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Ue("sheetViews",Ue("sheetView",null,s),{})}function cR(e,n,a,r){if(e.c&&a["!comments"].push([n,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",l=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=xi[e.v];break;case"d":r&&r.cellDates?s=cn(e.v,-1).toISOString():(e=dn(e),e.t="n",s=""+(e.v=Wn(cn(e.v)))),typeof e.z>"u"&&(e.z=ct[14]);break;default:s=e.v;break}var d=xa("v",qt(s)),u={r:n},x=ml(r.cellXfs,e,r);switch(x!==0&&(u.s=x),e.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){d=xa("v",""+Qg(r.Strings,e.v,r.revStrings)),u.t="s";break}u.t="str";break}if(e.t!=l&&(e.t=l,e.v=o),typeof e.f=="string"&&e.f){var m=e.F&&e.F.slice(0,n.length)==n?{t:"array",ref:e.F}:null;d=Ue("f",qt(e.f),m)+(e.v!=null?d:"")}return e.l&&a["!links"].push([n,e.l]),e.D&&(u.cm=1),Ue("c",d,u)}var dR=(function(){var e=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,a=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,l=eu("v"),o=eu("f");return function(u,x,m,f,p,N){for(var y=0,g="",b=[],j=[],T=0,S=0,w=0,_="",E,C,P=0,F=0,R,O,M=0,q=0,J=Array.isArray(N.CellXf),B,ue=[],te=[],Z=Array.isArray(x),Q=[],fe={},K=!1,L=!!m.sheetStubs,X=u.split(n),I=0,W=X.length;I!=W;++I){g=X[I].trim();var z=g.length;if(z!==0){var xe=0;e:for(y=0;y<z;++y)switch(g[y]){case">":if(g[y-1]!="/"){++y;break e}if(m&&m.cellStyles){if(C=ut(g.slice(xe,y),!0),P=C.r!=null?parseInt(C.r,10):P+1,F=-1,m.sheetRows&&m.sheetRows<P)continue;fe={},K=!1,C.ht&&(K=!0,fe.hpt=parseFloat(C.ht),fe.hpx=Ec(fe.hpt)),C.hidden=="1"&&(K=!0,fe.hidden=!0),C.outlineLevel!=null&&(K=!0,fe.level=+C.outlineLevel),K&&(Q[P-1]=fe)}break;case"<":xe=y;break}if(xe>=y)break;if(C=ut(g.slice(xe,y),!0),P=C.r!=null?parseInt(C.r,10):P+1,F=-1,!(m.sheetRows&&m.sheetRows<P)){f.s.r>P-1&&(f.s.r=P-1),f.e.r<P-1&&(f.e.r=P-1),m&&m.cellStyles&&(fe={},K=!1,C.ht&&(K=!0,fe.hpt=parseFloat(C.ht),fe.hpx=Ec(fe.hpt)),C.hidden=="1"&&(K=!0,fe.hidden=!0),C.outlineLevel!=null&&(K=!0,fe.level=+C.outlineLevel),K&&(Q[P-1]=fe)),b=g.slice(y).split(e);for(var H=0;H!=b.length&&b[H].trim().charAt(0)=="<";++H);for(b=b.slice(H),y=0;y!=b.length;++y)if(g=b[y].trim(),g.length!==0){if(j=g.match(a),T=y,S=0,w=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,j!=null&&j.length===2){for(T=0,_=j[1],S=0;S!=_.length&&!((w=_.charCodeAt(S)-64)<1||w>26);++S)T=26*T+w;--T,F=T}else++F;for(S=0;S!=g.length&&g.charCodeAt(S)!==62;++S);if(++S,C=ut(g.slice(0,S),!0),C.r||(C.r=dt({r:P-1,c:F})),_=g.slice(S),E={t:""},(j=_.match(l))!=null&&j[1]!==""&&(E.v=Ft(j[1])),m.cellFormula){if((j=_.match(o))!=null&&j[1]!==""){if(E.f=Ft(Xt(j[1])).replace(/\r\n/g,`
`),m.xlfn||(E.f=ZN(E.f)),j[0].indexOf('t="array"')>-1)E.F=(_.match(s)||[])[1],E.F.indexOf(":")>-1&&ue.push([Pt(E.F),E.F]);else if(j[0].indexOf('t="shared"')>-1){O=ut(j[0]);var ne=Ft(Xt(j[1]));m.xlfn||(ne=ZN(ne)),te[parseInt(O.si,10)]=[O,ne,C.r]}}else(j=_.match(/<f[^>]*\/>/))&&(O=ut(j[0]),te[O.si]&&(E.f=iM(te[O.si][1],te[O.si][2],C.r)));var oe=bn(C.r);for(S=0;S<ue.length;++S)oe.r>=ue[S][0].s.r&&oe.r<=ue[S][0].e.r&&oe.c>=ue[S][0].s.c&&oe.c<=ue[S][0].e.c&&(E.F=ue[S][1])}if(C.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(L)E.t="z";else continue;else E.t=C.t||"n";switch(f.s.c>F&&(f.s.c=F),f.e.c<F&&(f.e.c=F),E.t){case"n":if(E.v==""||E.v==null){if(!L)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!L)continue;E.t="z"}else R=Ud[parseInt(E.v,10)],E.v=R.t,E.r=R.r,m.cellHTML&&(E.h=R.h);break;case"str":E.t="s",E.v=E.v!=null?Xt(E.v):"",m.cellHTML&&(E.h=Eg(E.v));break;case"inlineStr":j=_.match(r),E.t="s",j!=null&&(R=Kg(j[1]))?(E.v=R.t,m.cellHTML&&(E.h=R.h)):E.v="";break;case"b":E.v=ln(E.v);break;case"d":m.cellDates?E.v=cn(E.v,1):(E.v=Wn(cn(E.v,1)),E.t="n");break;case"e":(!m||m.cellText!==!1)&&(E.w=E.v),E.v=uk[E.v];break}if(M=q=0,B=null,J&&C.s!==void 0&&(B=N.CellXf[C.s],B!=null&&(B.numFmtId!=null&&(M=B.numFmtId),m.cellStyles&&B.fillId!=null&&(q=B.fillId))),oT(E,M,q,m,p,N),m.cellDates&&J&&E.t=="n"&&Ic(ct[M])&&(E.t="d",E.v=ux(E.v)),C.cm&&m.xlmeta){var Se=(m.xlmeta.Cell||[])[+C.cm-1];Se&&Se.type=="XLDAPR"&&(E.D=!0)}if(Z){var V=bn(C.r);x[V.r]||(x[V.r]=[]),x[V.r][V.c]=E}else x[C.r]=E}}}}Q.length>0&&(x["!rows"]=Q)}})();function uR(e,n,a,r){var s=[],l=[],o=Pt(e["!ref"]),d="",u,x="",m=[],f=0,p=0,N=e["!rows"],y=Array.isArray(e),g={r:x},b,j=-1;for(p=o.s.c;p<=o.e.c;++p)m[p]=vn(p);for(f=o.s.r;f<=o.e.r;++f){for(l=[],x=Fn(f),p=o.s.c;p<=o.e.c;++p){u=m[p]+x;var T=y?(e[f]||[])[p]:e[u];T!==void 0&&(d=cR(T,u,e,n))!=null&&l.push(d)}(l.length>0||N&&N[f])&&(g={r:x},N&&N[f]&&(b=N[f],b.hidden&&(g.hidden=1),j=-1,b.hpx?j=lu(b.hpx):b.hpt&&(j=b.hpt),j>-1&&(g.ht=j,g.customHeight=1),b.level&&(g.outlineLevel=b.level)),s[s.length]=Ue("row",l.join(""),g))}if(N)for(;f<N.length;++f)N&&N[f]&&(g={r:f+1},b=N[f],b.hidden&&(g.hidden=1),j=-1,b.hpx?j=lu(b.hpx):b.hpt&&(j=b.hpt),j>-1&&(g.ht=j,g.customHeight=1),b.level&&(g.outlineLevel=b.level),s[s.length]=Ue("row","",g));return s.join("")}function dT(e,n,a,r){var s=[Ln,Ue("worksheet",null,{xmlns:po[0],"xmlns:r":$n.r})],l=a.SheetNames[e],o=0,d="",u=a.Sheets[l];u==null&&(u={});var x=u["!ref"]||"A1",m=Pt(x);if(m.e.c>16383||m.e.r>1048575){if(n.WTF)throw new Error("Range "+x+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),x=gt(m)}r||(r={}),u["!comments"]=[];var f=[];X7(u,a,e,n,s),s[s.length]=Ue("dimension",null,{ref:x}),s[s.length]=oR(u,n,e,a),n.sheetFormat&&(s[s.length]=Ue("sheetFormatPr",null,{defaultRowHeight:n.sheetFormat.defaultRowHeight||"16",baseColWidth:n.sheetFormat.baseColWidth||"10",outlineLevelRow:n.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(s[s.length]=aR(u,u["!cols"])),s[o=s.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(d=uR(u,n),d.length>0&&(s[s.length]=d)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),u["!protect"]&&(s[s.length]=J7(u["!protect"])),u["!autofilter"]!=null&&(s[s.length]=sR(u["!autofilter"],u,a,e)),u["!merges"]!=null&&u["!merges"].length>0&&(s[s.length]=q7(u["!merges"]));var p=-1,N,y=-1;return u["!links"].length>0&&(s[s.length]="<hyperlinks>",u["!links"].forEach(function(g){g[1].Target&&(N={ref:g[0]},g[1].Target.charAt(0)!="#"&&(y=Gt(r,-1,qt(g[1].Target).replace(/#.*$/,""),jt.HLINK),N["r:id"]="rId"+y),(p=g[1].Target.indexOf("#"))>-1&&(N.location=qt(g[1].Target.slice(p+1))),g[1].Tooltip&&(N.tooltip=qt(g[1].Tooltip)),s[s.length]=Ue("hyperlink",null,N))}),s[s.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(s[s.length]=tR(u["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&(s[s.length]=xa("ignoredErrors",Ue("ignoredError",null,{numberStoredAsText:1,sqref:x}))),f.length>0&&(y=Gt(r,-1,"../drawings/drawing"+(e+1)+".xml",jt.DRAW),s[s.length]=Ue("drawing",null,{"r:id":"rId"+y}),u["!drawing"]=f),u["!comments"].length>0&&(y=Gt(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",jt.VML),s[s.length]=Ue("legacyDrawing",null,{"r:id":"rId"+y}),u["!legacy"]=y),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function hR(e,n){var a={},r=e.l+n;a.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=r,l&7&&(a.level=l&7),l&16&&(a.hidden=!0),l&32&&(a.hpt=s/20),a}function xR(e,n,a){var r=Te(145),s=(a["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var l=320;s.hpx?l=lu(s.hpx)*20:s.hpt&&(l=s.hpt*20),r.write_shift(2,l),r.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var d=0,u=r.l;r.l+=4;for(var x={r:e,c:0},m=0;m<16;++m)if(!(n.s.c>m+1<<10||n.e.c<m<<10)){for(var f=-1,p=-1,N=m<<10;N<m+1<<10;++N){x.c=N;var y=Array.isArray(a)?(a[x.r]||[])[x.c]:a[dt(x)];y&&(f<0&&(f=N),p=N)}f<0||(++d,r.write_shift(4,f),r.write_shift(4,p))}var g=r.l;return r.l=u,r.write_shift(4,d),r.l=g,r.length>r.l?r.slice(0,r.l):r}function mR(e,n,a,r){var s=xR(r,a,n);(s.length>17||(n["!rows"]||[])[r])&&Ee(e,0,s)}var fR=bo,pR=Rc;function gR(){}function yR(e,n){var a={},r=e[e.l];return++e.l,a.above=!(r&64),a.left=!(r&128),e.l+=18,a.name=N8(e),a}function vR(e,n,a){a==null&&(a=Te(84+4*e.length));var r=192;n&&(n.above&&(r&=-65),n.left&&(r&=-129)),a.write_shift(1,r);for(var s=1;s<3;++s)a.write_shift(1,0);return I0({auto:1},a),a.write_shift(-4,-1),a.write_shift(-4,-1),ik(e,a),a.slice(0,a.l)}function bR(e){var n=Ur(e);return[n]}function NR(e,n,a){return a==null&&(a=Te(8)),go(n,a)}function jR(e){var n=yo(e);return[n]}function wR(e,n,a){return a==null&&(a=Te(4)),vo(n,a)}function kR(e){var n=Ur(e),a=e.read_shift(1);return[n,a,"b"]}function TR(e,n,a){return a==null&&(a=Te(9)),go(n,a),a.write_shift(1,e.v?1:0),a}function CR(e){var n=yo(e),a=e.read_shift(1);return[n,a,"b"]}function SR(e,n,a){return a==null&&(a=Te(5)),vo(n,a),a.write_shift(1,e.v?1:0),a}function _R(e){var n=Ur(e),a=e.read_shift(1);return[n,a,"e"]}function ER(e,n,a){return a==null&&(a=Te(9)),go(n,a),a.write_shift(1,e.v),a}function DR(e){var n=yo(e),a=e.read_shift(1);return[n,a,"e"]}function AR(e,n,a){return a==null&&(a=Te(8)),vo(n,a),a.write_shift(1,e.v),a.write_shift(2,0),a.write_shift(1,0),a}function FR(e){var n=Ur(e),a=e.read_shift(4);return[n,a,"s"]}function LR(e,n,a){return a==null&&(a=Te(12)),go(n,a),a.write_shift(4,n.v),a}function PR(e){var n=yo(e),a=e.read_shift(4);return[n,a,"s"]}function IR(e,n,a){return a==null&&(a=Te(8)),vo(n,a),a.write_shift(4,n.v),a}function OR(e){var n=Ur(e),a=Ta(e);return[n,a,"n"]}function MR(e,n,a){return a==null&&(a=Te(16)),go(n,a),co(e.v,a),a}function uT(e){var n=yo(e),a=Ta(e);return[n,a,"n"]}function RR(e,n,a){return a==null&&(a=Te(12)),vo(n,a),co(e.v,a),a}function BR(e){var n=Ur(e),a=Rg(e);return[n,a,"n"]}function HR(e,n,a){return a==null&&(a=Te(12)),go(n,a),lk(e.v,a),a}function VR(e){var n=yo(e),a=Rg(e);return[n,a,"n"]}function UR(e,n,a){return a==null&&(a=Te(8)),vo(n,a),lk(e.v,a),a}function KR(e){var n=Ur(e),a=Ig(e);return[n,a,"is"]}function zR(e){var n=Ur(e),a=Ca(e);return[n,a,"str"]}function $R(e,n,a){return a==null&&(a=Te(12+4*e.v.length)),go(n,a),ra(e.v,a),a.length>a.l?a.slice(0,a.l):a}function GR(e){var n=yo(e),a=Ca(e);return[n,a,"str"]}function qR(e,n,a){return a==null&&(a=Te(8+4*e.v.length)),vo(n,a),ra(e.v,a),a.length>a.l?a.slice(0,a.l):a}function WR(e,n,a){var r=e.l+n,s=Ur(e);s.r=a["!row"];var l=e.read_shift(1),o=[s,l,"b"];if(a.cellFormula){e.l+=2;var d=mx(e,r-e.l,a);o[3]=ja(d,null,s,a.supbooks,a)}else e.l=r;return o}function XR(e,n,a){var r=e.l+n,s=Ur(e);s.r=a["!row"];var l=e.read_shift(1),o=[s,l,"e"];if(a.cellFormula){e.l+=2;var d=mx(e,r-e.l,a);o[3]=ja(d,null,s,a.supbooks,a)}else e.l=r;return o}function QR(e,n,a){var r=e.l+n,s=Ur(e);s.r=a["!row"];var l=Ta(e),o=[s,l,"n"];if(a.cellFormula){e.l+=2;var d=mx(e,r-e.l,a);o[3]=ja(d,null,s,a.supbooks,a)}else e.l=r;return o}function YR(e,n,a){var r=e.l+n,s=Ur(e);s.r=a["!row"];var l=Ca(e),o=[s,l,"str"];if(a.cellFormula){e.l+=2;var d=mx(e,r-e.l,a);o[3]=ja(d,null,s,a.supbooks,a)}else e.l=r;return o}var JR=bo,ZR=Rc;function eB(e,n){return n==null&&(n=Te(4)),n.write_shift(4,e),n}function tB(e,n){var a=e.l+n,r=bo(e),s=Og(e),l=Ca(e),o=Ca(e),d=Ca(e);e.l=a;var u={rfx:r,relId:s,loc:l,display:d};return o&&(u.Tooltip=o),u}function nB(e,n){var a=Te(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Rc({s:bn(e[0]),e:bn(e[0])},a),Mg("rId"+n,a);var r=e[1].Target.indexOf("#"),s=r==-1?"":e[1].Target.slice(r+1);return ra(s||"",a),ra(e[1].Tooltip||"",a),ra("",a),a.slice(0,a.l)}function aB(){}function rB(e,n,a){var r=e.l+n,s=ok(e),l=e.read_shift(1),o=[s];if(o[2]=l,a.cellFormula){var d=_7(e,r-e.l,a);o[1]=d}else e.l=r;return o}function sB(e,n,a){var r=e.l+n,s=bo(e),l=[s];if(a.cellFormula){var o=D7(e,r-e.l,a);l[1]=o,e.l=r}else e.l=r;return l}function iB(e,n,a){a==null&&(a=Te(18));var r=fx(e,n);a.write_shift(-4,e),a.write_shift(-4,e),a.write_shift(4,(r.width||10)*256),a.write_shift(4,0);var s=0;return n.hidden&&(s|=1),typeof r.width=="number"&&(s|=2),n.level&&(s|=n.level<<8),a.write_shift(2,s),a}var hT=["left","right","top","bottom","header","footer"];function lB(e){var n={};return hT.forEach(function(a){n[a]=Ta(e)}),n}function oB(e,n){return n==null&&(n=Te(48)),no(e),hT.forEach(function(a){co(e[a],n)}),n}function cB(e){var n=e.read_shift(2);return e.l+=28,{RTL:n&32}}function dB(e,n,a){a==null&&(a=Te(30));var r=924;return(((n||{}).Views||[])[0]||{}).RTL&&(r|=32),a.write_shift(2,r),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(2,0),a.write_shift(2,100),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(4,0),a}function uB(e){var n=Te(24);return n.write_shift(4,4),n.write_shift(4,1),Rc(e,n),n}function hB(e,n){return n==null&&(n=Te(66)),n.write_shift(2,e.password?zg(e.password):0),n.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(a){a[1]?n.write_shift(4,e[a[0]]!=null&&!e[a[0]]?1:0):n.write_shift(4,e[a[0]]!=null&&e[a[0]]?0:1)}),n}function xB(){}function mB(){}function fB(e,n,a,r,s,l,o){if(!e)return e;var d=n||{};r||(r={"!id":{}});var u=d.dense?[]:{},x,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,p=!1,N,y,g,b,j,T,S,w,_,E=[];d.biff=12,d["!row"]=0;var C=0,P=!1,F=[],R={},O=d.supbooks||s.supbooks||[[]];if(O.sharedf=R,O.arrayf=F,O.SheetNames=s.SheetNames||s.Sheets.map(function(Z){return Z.name}),!d.supbooks&&(d.supbooks=O,s.Names))for(var M=0;M<s.Names.length;++M)O[0][M+1]=s.Names[M];var q=[],J=[],B=!1;ou[16]={n:"BrtShortReal",f:uT};var ue;if(hi(e,function(Q,fe,K){if(!p)switch(K){case 148:x=Q;break;case 0:N=Q,d.sheetRows&&d.sheetRows<=N.r&&(p=!0),w=Fn(b=N.r),d["!row"]=N.r,(Q.hidden||Q.hpt||Q.level!=null)&&(Q.hpt&&(Q.hpx=Ec(Q.hpt)),J[Q.r]=Q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:Q[2]},Q[2]){case"n":y.v=Q[1];break;case"s":S=Ud[Q[1]],y.v=S.t,y.r=S.r;break;case"b":y.v=!!Q[1];break;case"e":y.v=Q[1],d.cellText!==!1&&(y.w=xi[y.v]);break;case"str":y.t="s",y.v=Q[1];break;case"is":y.t="s",y.v=Q[1].t;break}if((g=o.CellXf[Q[0].iStyleRef])&&oT(y,g.numFmtId,null,d,l,o),j=Q[0].c==-1?j+1:Q[0].c,d.dense?(u[b]||(u[b]=[]),u[b][j]=y):u[vn(j)+w]=y,d.cellFormula){for(P=!1,C=0;C<F.length;++C){var L=F[C];N.r>=L[0].s.r&&N.r<=L[0].e.r&&j>=L[0].s.c&&j<=L[0].e.c&&(y.F=gt(L[0]),P=!0)}!P&&Q.length>3&&(y.f=Q[3])}if(m.s.r>N.r&&(m.s.r=N.r),m.s.c>j&&(m.s.c=j),m.e.r<N.r&&(m.e.r=N.r),m.e.c<j&&(m.e.c=j),d.cellDates&&g&&y.t=="n"&&Ic(ct[g.numFmtId])){var X=Vl(y.v);X&&(y.t="d",y.v=new Date(X.y,X.m-1,X.d,X.H,X.M,X.S,X.u))}ue&&(ue.type=="XLDAPR"&&(y.D=!0),ue=void 0);break;case 1:case 12:if(!d.sheetStubs||f)break;y={t:"z",v:void 0},j=Q[0].c==-1?j+1:Q[0].c,d.dense?(u[b]||(u[b]=[]),u[b][j]=y):u[vn(j)+w]=y,m.s.r>N.r&&(m.s.r=N.r),m.s.c>j&&(m.s.c=j),m.e.r<N.r&&(m.e.r=N.r),m.e.c<j&&(m.e.c=j),ue&&(ue.type=="XLDAPR"&&(y.D=!0),ue=void 0);break;case 176:E.push(Q);break;case 49:ue=((d.xlmeta||{}).Cell||[])[Q-1];break;case 494:var I=r["!id"][Q.relId];for(I?(Q.Target=I.Target,Q.loc&&(Q.Target+="#"+Q.loc),Q.Rel=I):Q.relId==""&&(Q.Target="#"+Q.loc),b=Q.rfx.s.r;b<=Q.rfx.e.r;++b)for(j=Q.rfx.s.c;j<=Q.rfx.e.c;++j)d.dense?(u[b]||(u[b]=[]),u[b][j]||(u[b][j]={t:"z",v:void 0}),u[b][j].l=Q):(T=dt({c:j,r:b}),u[T]||(u[T]={t:"z",v:void 0}),u[T].l=Q);break;case 426:if(!d.cellFormula)break;F.push(Q),_=d.dense?u[b][j]:u[vn(j)+w],_.f=ja(Q[1],m,{r:N.r,c:j},O,d),_.F=gt(Q[0]);break;case 427:if(!d.cellFormula)break;R[dt(Q[0].s)]=Q[1],_=d.dense?u[b][j]:u[vn(j)+w],_.f=ja(Q[1],m,{r:N.r,c:j},O,d);break;case 60:if(!d.cellStyles)break;for(;Q.e>=Q.s;)q[Q.e--]={width:Q.w/256,hidden:!!(Q.flags&1),level:Q.level},B||(B=!0,$g(Q.w/256)),ll(q[Q.e+1]);break;case 161:u["!autofilter"]={ref:gt(Q)};break;case 476:u["!margins"]=Q;break;case 147:s.Sheets[a]||(s.Sheets[a]={}),Q.name&&(s.Sheets[a].CodeName=Q.name),(Q.above||Q.left)&&(u["!outline"]={above:Q.above,left:Q.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),Q.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!fe.T){if(!f||d.WTF)throw new Error("Unexpected record 0x"+K.toString(16))}}},d),delete d.supbooks,delete d["!row"],!u["!ref"]&&(m.s.r<2e6||x&&(x.e.r>0||x.e.c>0||x.s.r>0||x.s.c>0))&&(u["!ref"]=gt(x||m)),d.sheetRows&&u["!ref"]){var te=Pt(u["!ref"]);d.sheetRows<=+te.e.r&&(te.e.r=d.sheetRows-1,te.e.r>m.e.r&&(te.e.r=m.e.r),te.e.r<te.s.r&&(te.s.r=te.e.r),te.e.c>m.e.c&&(te.e.c=m.e.c),te.e.c<te.s.c&&(te.s.c=te.e.c),u["!fullref"]=u["!ref"],u["!ref"]=gt(te))}return E.length>0&&(u["!merges"]=E),q.length>0&&(u["!cols"]=q),J.length>0&&(u["!rows"]=J),u}function pB(e,n,a,r,s,l,o){if(n.v===void 0)return!1;var d="";switch(n.t){case"b":d=n.v?"1":"0";break;case"d":n=dn(n),n.z=n.z||ct[14],n.v=Wn(cn(n.v)),n.t="n";break;case"n":case"e":d=""+n.v;break;default:d=n.v;break}var u={r:a,c:r};switch(u.s=ml(s.cellXfs,n,s),n.l&&l["!links"].push([dt(u),n.l]),n.c&&l["!comments"].push([dt(u),n.c]),n.t){case"s":case"str":return s.bookSST?(d=Qg(s.Strings,n.v,s.revStrings),u.t="s",u.v=d,o?Ee(e,18,IR(n,u)):Ee(e,7,LR(n,u))):(u.t="str",o?Ee(e,17,qR(n,u)):Ee(e,6,$R(n,u))),!0;case"n":return n.v==(n.v|0)&&n.v>-1e3&&n.v<1e3?o?Ee(e,13,UR(n,u)):Ee(e,2,HR(n,u)):o?Ee(e,16,RR(n,u)):Ee(e,5,MR(n,u)),!0;case"b":return u.t="b",o?Ee(e,15,SR(n,u)):Ee(e,4,TR(n,u)),!0;case"e":return u.t="e",o?Ee(e,14,AR(n,u)):Ee(e,3,ER(n,u)),!0}return o?Ee(e,12,wR(n,u)):Ee(e,1,NR(n,u)),!0}function gB(e,n,a,r){var s=Pt(n["!ref"]||"A1"),l,o="",d=[];Ee(e,145);var u=Array.isArray(n),x=s.e.r;n["!rows"]&&(x=Math.max(s.e.r,n["!rows"].length-1));for(var m=s.s.r;m<=x;++m){o=Fn(m),mR(e,n,s,m);var f=!1;if(m<=s.e.r)for(var p=s.s.c;p<=s.e.c;++p){m===s.s.r&&(d[p]=vn(p)),l=d[p]+o;var N=u?(n[m]||[])[p]:n[l];if(!N){f=!1;continue}f=pB(e,N,m,p,r,n,f)}}Ee(e,146)}function yB(e,n){!n||!n["!merges"]||(Ee(e,177,eB(n["!merges"].length)),n["!merges"].forEach(function(a){Ee(e,176,ZR(a))}),Ee(e,178))}function vB(e,n){!n||!n["!cols"]||(Ee(e,390),n["!cols"].forEach(function(a,r){a&&Ee(e,60,iB(r,a))}),Ee(e,391))}function bB(e,n){!n||!n["!ref"]||(Ee(e,648),Ee(e,649,uB(Pt(n["!ref"]))),Ee(e,650))}function NB(e,n,a){n["!links"].forEach(function(r){if(r[1].Target){var s=Gt(a,-1,r[1].Target.replace(/#.*$/,""),jt.HLINK);Ee(e,494,nB(r,s))}}),delete n["!links"]}function jB(e,n,a,r){if(n["!comments"].length>0){var s=Gt(r,-1,"../drawings/vmlDrawing"+(a+1)+".vml",jt.VML);Ee(e,551,Mg("rId"+s)),n["!legacy"]=s}}function wB(e,n,a,r){if(n["!autofilter"]){var s=n["!autofilter"],l=typeof s.ref=="string"?s.ref:gt(s.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var o=a.Workbook.Names,d=sr(l);d.s.r==d.e.r&&(d.e.r=sr(n["!ref"]).e.r,l=gt(d));for(var u=0;u<o.length;++u){var x=o[u];if(x.Name=="_xlnm._FilterDatabase"&&x.Sheet==r){x.Ref="'"+a.SheetNames[r]+"'!"+l;break}}u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+a.SheetNames[r]+"'!"+l}),Ee(e,161,Rc(Pt(l))),Ee(e,162)}}function kB(e,n,a){Ee(e,133),Ee(e,137,dB(n,a)),Ee(e,138),Ee(e,134)}function TB(e,n){n["!protect"]&&Ee(e,535,hB(n["!protect"]))}function CB(e,n,a,r){var s=rr(),l=a.SheetNames[e],o=a.Sheets[l]||{},d=l;try{a&&a.Workbook&&(d=a.Workbook.Sheets[e].CodeName||d)}catch{}var u=Pt(o["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(n.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Ee(s,129),(a.vbaraw||o["!outline"])&&Ee(s,147,vR(d,o["!outline"])),Ee(s,148,pR(u)),kB(s,o,a.Workbook),vB(s,o),gB(s,o,e,n),TB(s,o),wB(s,o,a,e),yB(s,o),NB(s,o,r),o["!margins"]&&Ee(s,476,oB(o["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&bB(s,o),jB(s,o,e,r),Ee(s,130),s.end()}function SB(e){var n=[],a=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var o=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(n[+o[1]]=a?+o[2]:o[2])});var s=Ft((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){r=l.replace(/<.*?>/g,"")}),[n,s,r]}function _B(e,n,a,r,s,l){var o=l||{"!type":"chart"};if(!e)return l;var d=0,u=0,x="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var p=SB(f);m.s.r=m.s.c=0,m.e.c=d,x=vn(d),p[0].forEach(function(N,y){o[x+Fn(y)]={t:"n",v:N,z:p[1]},u=y}),m.e.r<u&&(m.e.r=u),++d}),d>0&&(o["!ref"]=gt(m)),o}function EB(e,n,a,r,s){if(!e)return e;r||(r={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o,d=e.match(cT);return d&&Yg(d[0],l,s,a),(o=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=o[1]),r["!id"][l["!rel"]]&&(l["!drawel"]=r["!id"][l["!rel"]]),l}function DB(e,n){e.l+=10;var a=Ca(e);return{name:a}}function AB(e,n,a,r,s){if(!e)return e;r||(r={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o=!1;return hi(e,function(u,x,m){switch(m){case 550:l["!rel"]=u;break;case 651:s.Sheets[a]||(s.Sheets[a]={}),u.name&&(s.Sheets[a].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(x.T>0)){if(!(x.T<0)){if(!o||n.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},n),r["!id"][l["!rel"]]&&(l["!drawel"]=r["!id"][l["!rel"]]),l}var Jg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],FB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],LB=[],PB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function r2(e,n){for(var a=0;a!=e.length;++a)for(var r=e[a],s=0;s!=n.length;++s){var l=n[s];if(r[l[0]]==null)r[l[0]]=l[1];else switch(l[2]){case"bool":typeof r[l[0]]=="string"&&(r[l[0]]=ln(r[l[0]]));break;case"int":typeof r[l[0]]=="string"&&(r[l[0]]=parseInt(r[l[0]],10));break}}}function s2(e,n){for(var a=0;a!=n.length;++a){var r=n[a];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=ln(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function xT(e){s2(e.WBProps,Jg),s2(e.CalcPr,PB),r2(e.WBView,FB),r2(e.Sheets,LB),cc.date1904=ln(e.WBProps.date1904)}function IB(e){return!e.Workbook||!e.Workbook.WBProps?"false":ln(e.Workbook.WBProps.date1904)?"true":"false"}var OB="][*?/\\".split("");function mT(e,n){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var a=!0;return OB.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),a}function MB(e,n,a){e.forEach(function(r,s){mT(r);for(var l=0;l<s;++l)if(r==e[l])throw new Error("Duplicate Sheet Name: "+r);if(a){var o=n&&n[s]&&n[s].CodeName||r;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function RB(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var n=e.Workbook&&e.Workbook.Sheets||[];MB(e.SheetNames,n,!!e.vbaraw);for(var a=0;a<e.SheetNames.length;++a)I7(e.Sheets[e.SheetNames[a]],e.SheetNames[a],a)}var BB=/<\w+:workbook/;function HB(e,n){if(!e)throw new Error("Could not find file");var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,s="xmlns",l={},o=0;if(e.replace(_a,function(u,x){var m=ut(u);switch(Fs(m[0])){case"<?xml":break;case"<workbook":u.match(BB)&&(s="xmlns"+u.match(/<(\w+):/)[1]),a.xmlns=m[s];break;case"</workbook>":break;case"<fileVersion":delete m[0],a.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Jg.forEach(function(f){if(m[f[0]]!=null)switch(f[2]){case"bool":a.WBProps[f[0]]=ln(m[f[0]]);break;case"int":a.WBProps[f[0]]=parseInt(m[f[0]],10);break;default:a.WBProps[f[0]]=m[f[0]]}}),m.codeName&&(a.WBProps.CodeName=Xt(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],a.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=Ft(Xt(m.name)),delete m[0],a.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":l={},l.Name=Xt(m.name),m.comment&&(l.Comment=m.comment),m.localSheetId&&(l.Sheet=+m.localSheetId),ln(m.hidden||"0")&&(l.Hidden=!0),o=x+u.length;break;case"</definedName>":l.Ref=Ft(Xt(e.slice(o,x))),a.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete m[0],a.CalcPr=m;break;case"<calcPr/>":delete m[0],a.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&n.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return u}),po.indexOf(a.xmlns)===-1)throw new Error("Unknown Namespace: "+a.xmlns);return xT(a),a}function fT(e){var n=[Ln];n[n.length]=Ue("workbook",null,{xmlns:po[0],"xmlns:r":$n.r});var a=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Jg.forEach(function(d){e.Workbook.WBProps[d[0]]!=null&&e.Workbook.WBProps[d[0]]!=d[1]&&(r[d[0]]=e.Workbook.WBProps[d[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),n[n.length]=Ue("workbookPr",null,r);var s=e.Workbook&&e.Workbook.Sheets||[],l=0;if(s&&s[0]&&s[0].Hidden){for(n[n.length]="<bookViews>",l=0;l!=e.SheetNames.length&&!(!s[l]||!s[l].Hidden);++l);l==e.SheetNames.length&&(l=0),n[n.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',n[n.length]="</bookViews>"}for(n[n.length]="<sheets>",l=0;l!=e.SheetNames.length;++l){var o={name:qt(e.SheetNames[l].slice(0,31))};if(o.sheetId=""+(l+1),o["r:id"]="rId"+(l+1),s[l])switch(s[l].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}n[n.length]=Ue("sheet",null,o)}return n[n.length]="</sheets>",a&&(n[n.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(d){var u={name:d.Name};d.Comment&&(u.comment=d.Comment),d.Sheet!=null&&(u.localSheetId=""+d.Sheet),d.Hidden&&(u.hidden="1"),d.Ref&&(n[n.length]=Ue("definedName",qt(d.Ref),u))}),n[n.length]="</definedNames>"),n.length>2&&(n[n.length]="</workbook>",n[1]=n[1].replace("/>",">")),n.join("")}function VB(e,n){var a={};return a.Hidden=e.read_shift(4),a.iTabID=e.read_shift(4),a.strRelID=Ep(e),a.name=Ca(e),a}function UB(e,n){return n||(n=Te(127)),n.write_shift(4,e.Hidden),n.write_shift(4,e.iTabID),Mg(e.strRelID,n),ra(e.name.slice(0,31),n),n.length>n.l?n.slice(0,n.l):n}function KB(e,n){var a={},r=e.read_shift(4);a.defaultThemeVersion=e.read_shift(4);var s=n>8?Ca(e):"";return s.length>0&&(a.CodeName=s),a.autoCompressPictures=!!(r&65536),a.backupFile=!!(r&64),a.checkCompatibility=!!(r&4096),a.date1904=!!(r&1),a.filterPrivacy=!!(r&8),a.hidePivotFieldList=!!(r&1024),a.promptedSolutions=!!(r&16),a.publishItems=!!(r&2048),a.refreshAllConnections=!!(r&262144),a.saveExternalLinkValues=!!(r&128),a.showBorderUnselectedTables=!!(r&4),a.showInkAnnotation=!!(r&32),a.showObjects=["all","placeholders","none"][r>>13&3],a.showPivotChartFilter=!!(r&32768),a.updateLinks=["userSet","never","always"][r>>8&3],a}function zB(e,n){n||(n=Te(72));var a=0;return e&&e.filterPrivacy&&(a|=8),n.write_shift(4,a),n.write_shift(4,0),ik(e&&e.CodeName||"ThisWorkbook",n),n.slice(0,n.l)}function $B(e,n){var a={};return e.read_shift(4),a.ArchID=e.read_shift(4),e.l+=n-8,a}function GB(e,n,a){var r=e.l+n;e.l+=4,e.l+=1;var s=e.read_shift(4),l=j8(e),o=E7(e,0,a),d=Og(e);e.l=r;var u={Name:l,Ptg:o};return s<268435455&&(u.Sheet=s),d&&(u.Comment=d),u}function qB(e,n){var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],s=!1;n||(n={}),n.biff=12;var l=[],o=[[]];return o.SheetNames=[],o.XTI=[],ou[16]={n:"BrtFRTArchID$",f:$B},hi(e,function(u,x,m){switch(m){case 156:o.SheetNames.push(u.name),a.Sheets.push(u);break;case 153:a.WBProps=u;break;case 39:u.Sheet!=null&&(n.SID=u.Sheet),u.Ref=ja(u.Ptg,null,null,o,n),delete n.SID,delete u.Ptg,l.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([m,u]):o[0]=[m,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(m),s=!0;break;case 36:r.pop(),s=!1;break;case 37:r.push(m),s=!0;break;case 38:r.pop(),s=!1;break;case 16:break;default:if(!x.T){if(!s||n.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},n),xT(a),a.Names=l,a.supbooks=o,a}function WB(e,n){Ee(e,143);for(var a=0;a!=n.SheetNames.length;++a){var r=n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[a]&&n.Workbook.Sheets[a].Hidden||0,s={Hidden:r,iTabID:a+1,strRelID:"rId"+(a+1),name:n.SheetNames[a]};Ee(e,156,UB(s))}Ee(e,144)}function XB(e,n){n||(n=Te(127));for(var a=0;a!=4;++a)n.write_shift(4,0);return ra("SheetJS",n),ra(_0.version,n),ra(_0.version,n),ra("7262",n),n.length>n.l?n.slice(0,n.l):n}function QB(e,n){n||(n=Te(29)),n.write_shift(-4,0),n.write_shift(-4,460),n.write_shift(4,28800),n.write_shift(4,17600),n.write_shift(4,500),n.write_shift(4,e),n.write_shift(4,e);var a=120;return n.write_shift(1,a),n.length>n.l?n.slice(0,n.l):n}function YB(e,n){if(!(!n.Workbook||!n.Workbook.Sheets)){for(var a=n.Workbook.Sheets,r=0,s=-1,l=-1;r<a.length;++r)!a[r]||!a[r].Hidden&&s==-1?s=r:a[r].Hidden==1&&l==-1&&(l=r);l>s||(Ee(e,135),Ee(e,158,QB(s)),Ee(e,136))}}function JB(e,n){var a=rr();return Ee(a,131),Ee(a,128,XB()),Ee(a,153,zB(e.Workbook&&e.Workbook.WBProps||null)),YB(a,e),WB(a,e),Ee(a,132),a.end()}function ZB(e,n,a){return n.slice(-4)===".bin"?qB(e,a):HB(e,a)}function e9(e,n,a,r,s,l,o,d){return n.slice(-4)===".bin"?fB(e,r,a,s,l,o,d):G7(e,r,a,s,l,o,d)}function t9(e,n,a,r,s,l,o,d){return n.slice(-4)===".bin"?AB(e,r,a,s,l):EB(e,r,a,s,l)}function n9(e,n,a,r,s,l,o,d){return n.slice(-4)===".bin"?rM():sM()}function a9(e,n,a,r,s,l,o,d){return n.slice(-4)===".bin"?nM():aM()}function r9(e,n,a,r){return n.slice(-4)===".bin"?ZI(e,a,r):VI(e,a,r)}function s9(e,n,a){return Xk(e,a)}function i9(e,n,a){return n.slice(-4)===".bin"?iI(e,a):aI(e,a)}function l9(e,n,a){return n.slice(-4)===".bin"?YO(e,a):UO(e,a)}function o9(e,n,a){return n.slice(-4)===".bin"?BO(e):MO(e)}function c9(e,n,a,r){return a.slice(-4)===".bin"?HO(e,n,a,r):void 0}function d9(e,n,a){return n.slice(-4)===".bin"?PO(e,n,a):OO(e,n,a)}function u9(e,n,a){return(n.slice(-4)===".bin"?JB:fT)(e)}function h9(e,n,a,r,s){return(n.slice(-4)===".bin"?CB:dT)(e,a,r,s)}function x9(e,n,a){return(n.slice(-4)===".bin"?cO:qk)(e,a)}function m9(e,n,a){return(n.slice(-4)===".bin"?cI:Bk)(e,a)}function f9(e,n,a){return(n.slice(-4)===".bin"?JO:Jk)(e)}function p9(e){return(e.slice(-4)===".bin"?IO:Qk)()}var pT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,gT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Xr(e,n){var a=e.split(/\s+/),r=[];if(r[0]=a[0],a.length===1)return r;var s=e.match(pT),l,o,d,u;if(s)for(u=0;u!=s.length;++u)l=s[u].match(gT),(o=l[1].indexOf(":"))===-1?r[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?d="xmlns"+l[1].slice(6):d=l[1].slice(o+1),r[d]=l[2].slice(1,l[2].length-1));return r}function g9(e){var n=e.split(/\s+/),a={};if(n.length===1)return a;var r=e.match(pT),s,l,o,d;if(r)for(d=0;d!=r.length;++d)s=r[d].match(gT),(l=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(l+1),a[o]=s[2].slice(1,s[2].length-1));return a}var zd;function y9(e,n){var a=zd[e]||Ft(e);return a==="General"?lo(n):Hr(a,n)}function v9(e,n,a,r){var s=r;switch((a[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=ln(r);break;case"i2":case"int":s=parseInt(r,10);break;case"r4":case"float":s=parseFloat(r);break;case"date":case"dateTime.tz":s=cn(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+a[0])}e[Ft(n)]=s}function b9(e,n,a){if(e.t!=="z"){if(!a||a.cellText!==!1)try{e.t==="e"?e.w=e.w||xi[e.v]:n==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zd(e.v):e.w=lo(e.v):e.w=y9(n||"General",e.v)}catch(l){if(a.WTF)throw l}try{var r=zd[n]||n||"General";if(a.cellNF&&(e.z=r),a.cellDates&&e.t=="n"&&Ic(r)){var s=Vl(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(l){if(a.WTF)throw l}}}function N9(e,n,a){if(a.cellStyles&&n.Interior){var r=n.Interior;r.Pattern&&(r.patternType=LI[r.Pattern]||r.Pattern)}e[n.ID]=n}function j9(e,n,a,r,s,l,o,d,u,x){var m="General",f=r.StyleID,p={};x=x||{};var N=[],y=0;for(f===void 0&&d&&(f=d.StyleID),f===void 0&&o&&(f=o.StyleID);l[f]!==void 0&&(l[f].nf&&(m=l[f].nf),l[f].Interior&&N.push(l[f].Interior),!!l[f].Parent);)f=l[f].Parent;switch(a.Type){case"Boolean":r.t="b",r.v=ln(e);break;case"String":r.t="s",r.r=jN(Ft(e)),r.v=e.indexOf("<")>-1?Ft(n||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(cn(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),r.v!==r.v?r.v=Ft(e):r.v<60&&(r.v=r.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=uk[e],x.cellText!==!1&&(r.w=e);break;default:e==""&&n==""?r.t="z":(r.t="s",r.v=jN(n||e));break}if(b9(r,m,x),x.cellFormula!==!1)if(r.Formula){var g=Ft(r.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),r.f=oc(g,s),delete r.Formula,r.ArrayRange=="RC"?r.F=oc("RC:RC",s):r.ArrayRange&&(r.F=oc(r.ArrayRange,s),u.push([Pt(r.F),r.F]))}else for(y=0;y<u.length;++y)s.r>=u[y][0].s.r&&s.r<=u[y][0].e.r&&s.c>=u[y][0].s.c&&s.c<=u[y][0].e.c&&(r.F=u[y][1]);x.cellStyles&&(N.forEach(function(b){!p.patternType&&b.patternType&&(p.patternType=b.patternType)}),r.s=p),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function w9(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Of(e,n){var a=n||{};Oc();var r=Fd(Dg(e));(a.type=="binary"||a.type=="array"||a.type=="base64")&&(r=Xt(r));var s=r.slice(0,1024).toLowerCase(),l=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=dn(a);return o.type="string",_c.to_workbook(r,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Rt){s.indexOf("<"+Rt)>=0&&(l=!0)}),l)return oH(r,a);zd={"General Number":"General","General Date":ct[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ct[15],"Short Date":ct[14],"Long Time":ct[19],"Medium Time":ct[18],"Short Time":ct[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ct[2],Standard:ct[4],Percent:ct[10],Scientific:ct[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var d,u=[],x,m={},f=[],p=a.dense?[]:{},N="",y={},g={},b=Xr('<Data ss:Type="String">'),j=0,T=0,S=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},_={},E={},C="",P=0,F=[],R={},O={},M=0,q=[],J=[],B={},ue=[],te,Z=!1,Q=[],fe=[],K={},L=0,X=0,I={Sheets:[],WBProps:{date1904:!1}},W={};nu.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var z="";d=nu.exec(r);)switch(d[3]=(z=d[3]).toLowerCase()){case"data":if(z=="data"){if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&u.push([d[3],!0]);break}if(u[u.length-1][1])break;d[1]==="/"?j9(r.slice(j,d.index),C,b,u[u.length-1][0]=="comment"?B:y,{c:T,r:S},_,ue[T],g,Q,a):(C="",b=Xr(d[0]),j=d.index+d[0].length);break;case"cell":if(d[1]==="/")if(J.length>0&&(y.c=J),(!a.sheetRows||a.sheetRows>S)&&y.v!==void 0&&(a.dense?(p[S]||(p[S]=[]),p[S][T]=y):p[vn(T)+Fn(S)]=y),y.HRef&&(y.l={Target:Ft(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(L=T+(parseInt(y.MergeAcross,10)|0),X=S+(parseInt(y.MergeDown,10)|0),F.push({s:{c:T,r:S},e:{c:L,r:X}})),!a.sheetStubs)y.MergeAcross?T=L+1:++T;else if(y.MergeAcross||y.MergeDown){for(var xe=T;xe<=L;++xe)for(var H=S;H<=X;++H)(xe>T||H>S)&&(a.dense?(p[H]||(p[H]=[]),p[H][xe]={t:"z"}):p[vn(xe)+Fn(H)]={t:"z"});T=L+1}else++T;else y=g9(d[0]),y.Index&&(T=+y.Index-1),T<w.s.c&&(w.s.c=T),T>w.e.c&&(w.e.c=T),d[0].slice(-2)==="/>"&&++T,J=[];break;case"row":d[1]==="/"||d[0].slice(-2)==="/>"?(S<w.s.r&&(w.s.r=S),S>w.e.r&&(w.e.r=S),d[0].slice(-2)==="/>"&&(g=Xr(d[0]),g.Index&&(S=+g.Index-1)),T=0,++S):(g=Xr(d[0]),g.Index&&(S=+g.Index-1),K={},(g.AutoFitHeight=="0"||g.Height)&&(K.hpx=parseInt(g.Height,10),K.hpt=lu(K.hpx),fe[S]=K),g.Hidden=="1"&&(K.hidden=!0,fe[S]=K));break;case"worksheet":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"));f.push(N),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(p["!ref"]=gt(w),a.sheetRows&&a.sheetRows<=w.e.r&&(p["!fullref"]=p["!ref"],w.e.r=a.sheetRows-1,p["!ref"]=gt(w))),F.length&&(p["!merges"]=F),ue.length>0&&(p["!cols"]=ue),fe.length>0&&(p["!rows"]=fe),m[N]=p}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=T=0,u.push([d[3],!1]),x=Xr(d[0]),N=Ft(x.Name),p=a.dense?[]:{},F=[],Q=[],fe=[],W={name:N,Hidden:0},I.Sheets.push(W);break;case"table":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else{if(d[0].slice(-2)=="/>")break;u.push([d[3],!1]),ue=[],Z=!1}break;case"style":d[1]==="/"?N9(_,E,a):E=Xr(d[0]);break;case"numberformat":E.nf=Ft(Xr(d[0]).Format||"General"),zd[E.nf]&&(E.nf=zd[E.nf]);for(var ne=0;ne!=392&&ct[ne]!=E.nf;++ne);if(ne==392){for(ne=57;ne!=392;++ne)if(ct[ne]==null){ri(E.nf,ne);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(te=Xr(d[0]),te.Hidden&&(te.hidden=!0,delete te.Hidden),te.Width&&(te.wpx=parseInt(te.Width,10)),!Z&&te.wpx>10){Z=!0,wa=$k;for(var oe=0;oe<ue.length;++oe)ue[oe]&&ll(ue[oe])}Z&&ll(te),ue[te.Index-1||ue.length]=te;for(var Se=0;Se<+te.Span;++Se)ue[ue.length]=dn(te);break;case"namedrange":if(d[1]==="/")break;I.Names||(I.Names=[]);var V=ut(d[0]),be={Name:V.Name,Ref:oc(V.RefersTo.slice(1),{r:0,c:0})};I.Sheets.length>0&&(be.Sheet=I.Sheets.length-1),I.Names.push(be);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(d[0].slice(-2)==="/>")break;d[1]==="/"?C+=r.slice(P,d.index):P=d.index+d[0].length;break;case"interior":if(!a.cellStyles)break;E.Interior=Xr(d[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(d[0].slice(-2)==="/>")break;d[1]==="/"?q8(R,z,r.slice(M,d.index)):M=d.index+d[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else u.push([d[3],!1]);break;case"comment":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"));w9(B),J.push(B)}else u.push([d[3],!1]),x=Xr(d[0]),B={a:x.Author};break;case"autofilter":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else if(d[0].charAt(d[0].length-2)!=="/"){var Oe=Xr(d[0]);p["!autofilter"]={ref:oc(Oe.Range).replace(/\$/g,"")},u.push([d[3],!0])}break;case"name":break;case"datavalidation":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&u.push([d[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&u.push([d[3],!0]);break;case"null":break;default:if(u.length==0&&d[3]=="document"||u.length==0&&d[3]=="uof")return d2(r,a);var tt=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(d[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:tt=!1}break;case"componentoptions":switch(d[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:tt=!1}break;case"excelworkbook":switch(d[3]){case"date1904":I.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:tt=!1}break;case"workbookoptions":switch(d[3]){case"owcversion":break;case"height":break;case"width":break;default:tt=!1}break;case"worksheetoptions":switch(d[3]){case"visible":if(d[0].slice(-2)!=="/>")if(d[1]==="/")switch(r.slice(M,d.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else M=d.index+d[0].length;break;case"header":p["!margins"]||no(p["!margins"]={},"xlml"),isNaN(+ut(d[0]).Margin)||(p["!margins"].header=+ut(d[0]).Margin);break;case"footer":p["!margins"]||no(p["!margins"]={},"xlml"),isNaN(+ut(d[0]).Margin)||(p["!margins"].footer=+ut(d[0]).Margin);break;case"pagemargins":var Je=ut(d[0]);p["!margins"]||no(p["!margins"]={},"xlml"),isNaN(+Je.Top)||(p["!margins"].top=+Je.Top),isNaN(+Je.Left)||(p["!margins"].left=+Je.Left),isNaN(+Je.Right)||(p["!margins"].right=+Je.Right),isNaN(+Je.Bottom)||(p["!margins"].bottom=+Je.Bottom);break;case"displayrighttoleft":I.Views||(I.Views=[]),I.Views[0]||(I.Views[0]={}),I.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:tt=!1}break;case"pivottable":case"pivotcache":switch(d[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:tt=!1}break;case"pagebreaks":switch(d[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:tt=!1}break;case"autofilter":switch(d[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:tt=!1}break;case"querytable":switch(d[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:tt=!1}break;case"datavalidation":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:tt=!1}break;case"sorting":case"conditionalformatting":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:tt=!1}break;case"mapinfo":case"schema":case"data":switch(d[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:tt=!1}break;case"smarttags":break;default:tt=!1;break}if(tt||d[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+d[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(d[0].slice(-2)==="/>")break;d[1]==="/"?v9(O,z,q,r.slice(M,d.index)):(q=d,M=d.index+d[0].length);break}if(a.WTF)throw"Unrecognized tag: "+d[3]+"|"+u.join("|")}var Re={};return!a.bookSheets&&!a.bookProps&&(Re.Sheets=m),Re.SheetNames=f,Re.Workbook=I,Re.SSF=dn(ct),Re.Props=R,Re.Custprops=O,Re}function Op(e,n){switch(ty(n=n||{}),n.type||"base64"){case"base64":return Of(vr(e),n);case"binary":case"buffer":case"file":return Of(e,n);case"array":return Of(hl(e),n)}}function k9(e,n){var a=[];return e.Props&&a.push(W8(e.Props,n)),e.Custprops&&a.push(X8(e.Props,e.Custprops)),a.join("")}function T9(){return""}function C9(e,n){var a=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return n.cellXfs.forEach(function(r,s){var l=[];l.push(Ue("NumberFormat",null,{"ss:Format":qt(ct[r.numFmtId])}));var o={"ss:ID":"s"+(21+s)};a.push(Ue("Style",l.join(""),o))}),Ue("Styles",a.join(""))}function yT(e){return Ue("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Wg(e.Ref,{r:0,c:0})})}function S9(e){if(!((e||{}).Workbook||{}).Names)return"";for(var n=e.Workbook.Names,a=[],r=0;r<n.length;++r){var s=n[r];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||a.push(yT(s)))}return Ue("Names",a.join(""))}function _9(e,n,a,r){if(!e||!((r||{}).Workbook||{}).Names)return"";for(var s=r.Workbook.Names,l=[],o=0;o<s.length;++o){var d=s[o];d.Sheet==a&&(d.Name.match(/^_xlfn\./)||l.push(yT(d)))}return l.join("")}function E9(e,n,a,r){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Ue("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Ue("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Ue("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[a])if(r.Workbook.Sheets[a].Hidden)s.push(Ue("Visible",r.Workbook.Sheets[a].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<a&&!(r.Workbook.Sheets[l]&&!r.Workbook.Sheets[l].Hidden);++l);l==a&&s.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(xa("ProtectContents","True")),e["!protect"].objects&&s.push(xa("ProtectObjects","True")),e["!protect"].scenarios&&s.push(xa("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(xa("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(xa("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Ue("WorksheetOptions",s.join(""),{xmlns:ur.x})}function D9(e){return e.map(function(n){var a=YF(n.t||""),r=Ue("ss:Data",a,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ue("Comment",r,{"ss:Author":n.a})}).join("")}function A9(e,n,a,r,s,l,o){if(!e||e.v==null&&e.f==null)return"";var d={};if(e.f&&(d["ss:Formula"]="="+qt(Wg(e.f,o))),e.F&&e.F.slice(0,n.length)==n){var u=bn(e.F.slice(n.length+1));d["ss:ArrayRange"]="RC:R"+(u.r==o.r?"":"["+(u.r-o.r)+"]")+"C"+(u.c==o.c?"":"["+(u.c-o.c)+"]")}if(e.l&&e.l.Target&&(d["ss:HRef"]=qt(e.l.Target),e.l.Tooltip&&(d["x:HRefScreenTip"]=qt(e.l.Tooltip))),a["!merges"])for(var x=a["!merges"],m=0;m!=x.length;++m)x[m].s.c!=o.c||x[m].s.r!=o.r||(x[m].e.c>x[m].s.c&&(d["ss:MergeAcross"]=x[m].e.c-x[m].s.c),x[m].e.r>x[m].s.r&&(d["ss:MergeDown"]=x[m].e.r-x[m].s.r));var f="",p="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":f="Number",p=String(e.v);break;case"b":f="Boolean",p=e.v?"1":"0";break;case"e":f="Error",p=xi[e.v];break;case"d":f="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ct[14]);break;case"s":f="String",p=QF(e.v||"");break}var N=ml(r.cellXfs,e,r);d["ss:StyleID"]="s"+(21+N),d["ss:Index"]=o.c+1;var y=e.v!=null?p:"",g=e.t=="z"?"":'<Data ss:Type="'+f+'">'+y+"</Data>";return(e.c||[]).length>0&&(g+=D9(e.c)),Ue("Cell",g,d)}function F9(e,n){var a='<Row ss:Index="'+(e+1)+'"';return n&&(n.hpt&&!n.hpx&&(n.hpx=Ec(n.hpt)),n.hpx&&(a+=' ss:AutoFitHeight="0" ss:Height="'+n.hpx+'"'),n.hidden&&(a+=' ss:Hidden="1"')),a+">"}function L9(e,n,a,r){if(!e["!ref"])return"";var s=Pt(e["!ref"]),l=e["!merges"]||[],o=0,d=[];e["!cols"]&&e["!cols"].forEach(function(b,j){ll(b);var T=!!b.width,S=fx(j,b),w={"ss:Index":j+1};T&&(w["ss:Width"]=su(S.width)),b.hidden&&(w["ss:Hidden"]="1"),d.push(Ue("Column",null,w))});for(var u=Array.isArray(e),x=s.s.r;x<=s.e.r;++x){for(var m=[F9(x,(e["!rows"]||[])[x])],f=s.s.c;f<=s.e.c;++f){var p=!1;for(o=0;o!=l.length;++o)if(!(l[o].s.c>f)&&!(l[o].s.r>x)&&!(l[o].e.c<f)&&!(l[o].e.r<x)){(l[o].s.c!=f||l[o].s.r!=x)&&(p=!0);break}if(!p){var N={r:x,c:f},y=dt(N),g=u?(e[x]||[])[f]:e[y];m.push(A9(g,y,e,n,a,r,N))}}m.push("</Row>"),m.length>2&&d.push(m.join(""))}return d.join("")}function P9(e,n,a){var r=[],s=a.SheetNames[e],l=a.Sheets[s],o=l?_9(l,n,e,a):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=l?L9(l,n,e,a):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(E9(l,n,e,a)),r.join("")}function I9(e,n){n||(n={}),e.SSF||(e.SSF=dn(ct)),e.SSF&&(Oc(),ox(e.SSF),n.revssf=dx(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF,n.cellXfs=[],ml(n.cellXfs,{},{revssf:{General:0}}));var a=[];a.push(k9(e,n)),a.push(T9()),a.push(""),a.push("");for(var r=0;r<e.SheetNames.length;++r)a.push(Ue("Worksheet",P9(r,n,e),{"ss:Name":qt(e.SheetNames[r])}));return a[2]=C9(e,n),a[3]=S9(e),Ln+Ue("Workbook",a.join(""),{xmlns:ur.ss,"xmlns:o":ur.o,"xmlns:x":ur.x,"xmlns:ss":ur.ss,"xmlns:dt":ur.dt,"xmlns:html":ur.html})}function O9(e){var n={},a=e.content;if(a.l=28,n.AnsiUserType=a.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=S8(a),a.length-a.l<=4)return n;var r=a.read_shift(4);if(r==0||r>40||(a.l-=4,n.Reserved1=a.read_shift(0,"lpstr-ansi"),a.length-a.l<=4)||(r=a.read_shift(4),r!==1907505652)||(n.UnicodeClipboardFormat=_8(a),r=a.read_shift(4),r==0||r>40))return n;a.l-=4,n.Reserved2=a.read_shift(0,"lpwstr")}var M9=[60,1084,2066,2165,2175];function R9(e,n,a,r,s){var l=r,o=[],d=a.slice(a.l,a.l+l);if(s&&s.enc&&s.enc.insitu&&d.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(d)}o.push(d),a.l+=l;for(var u=Zs(a,a.l),x=Mp[u],m=0;x!=null&&M9.indexOf(u)>-1;)l=Zs(a,a.l+2),m=a.l+4,u==2066?m+=4:(u==2165||u==2175)&&(m+=12),d=a.slice(m,a.l+4+l),o.push(d),a.l+=4+l,x=Mp[u=Zs(a,a.l)];var f=aa(o);da(f,0);var p=0;f.lens=[];for(var N=0;N<o.length;++N)f.lens.push(p),p+=o[N].length;if(f.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+r;return n.f(f,f.length,s)}function fs(e,n,a){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,n.cellNF&&(e.z=ct[r])}catch(l){if(n.WTF)throw l}if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||xi[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Zd(e.v):e.w=lo(e.v):e.w=Hr(r,e.v,{date1904:!!a,dateNF:n&&n.dateNF})}catch(l){if(n.WTF)throw l}if(n.cellDates&&r&&e.t=="n"&&Ic(ct[r]||String(r))){var s=Vl(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function s0(e,n,a){return{v:e,ixfe:n,t:a}}function B9(e,n){var a={opts:{}},r={},s=n.dense?[]:{},l={},o={},d=null,u=[],x="",m={},f,p="",N,y,g,b,j={},T=[],S,w,_=[],E=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},F=function(ot){return ot<8?Zl[ot]:ot<64&&E[ot-8]||Zl[ot]},R=function(ot,Bt,Xn){var en=Bt.XF.data;if(!(!en||!en.patternType||!Xn||!Xn.cellStyles)){Bt.s={},Bt.s.patternType=en.patternType;var Ea;(Ea=ru(F(en.icvFore)))&&(Bt.s.fgColor={rgb:Ea}),(Ea=ru(F(en.icvBack)))&&(Bt.s.bgColor={rgb:Ea})}},O=function(ot,Bt,Xn){if(!(K>1)&&!(Xn.sheetRows&&ot.r>=Xn.sheetRows)){if(Xn.cellStyles&&Bt.XF&&Bt.XF.data&&R(ot,Bt,Xn),delete Bt.ixfe,delete Bt.XF,f=ot,p=dt(ot),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ot.r<o.s.r&&(o.s.r=ot.r),ot.c<o.s.c&&(o.s.c=ot.c),ot.r+1>o.e.r&&(o.e.r=ot.r+1),ot.c+1>o.e.c&&(o.e.c=ot.c+1),Xn.cellFormula&&Bt.f){for(var en=0;en<T.length;++en)if(!(T[en][0].s.c>ot.c||T[en][0].s.r>ot.r)&&!(T[en][0].e.c<ot.c||T[en][0].e.r<ot.r)){Bt.F=gt(T[en][0]),(T[en][0].s.c!=ot.c||T[en][0].s.r!=ot.r)&&delete Bt.f,Bt.f&&(Bt.f=""+ja(T[en][1],o,ot,Q,M));break}}Xn.dense?(s[ot.r]||(s[ot.r]=[]),s[ot.r][ot.c]=Bt):s[p]=Bt}},M={enc:!1,sbcch:0,snames:[],sharedf:j,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(M.password=n.password);var q,J=[],B=[],ue=[],te=[],Z=!1,Q=[];Q.SheetNames=M.snames,Q.sharedf=M.sharedf,Q.arrayf=M.arrayf,Q.names=[],Q.XTI=[];var fe=0,K=0,L=0,X=[],I=[],W;M.codepage=1200,Zr(1200);for(var z=!1;e.l<e.length-1;){var xe=e.l,H=e.read_shift(2);if(H===0&&fe===10)break;var ne=e.l===e.length?0:e.read_shift(2),oe=Mp[H];if(oe&&oe.f){if(n.bookSheets&&fe===133&&H!==133)break;if(fe=H,oe.r===2||oe.r==12){var Se=e.read_shift(2);if(ne-=2,!M.enc&&Se!==H&&((Se&255)<<8|Se>>8)!==H)throw new Error("rt mismatch: "+Se+"!="+H);oe.r==12&&(e.l+=10,ne-=10)}var V={};if(H===10?V=oe.f(e,ne,M):V=R9(H,oe,e,ne,M),K==0&&[9,521,1033,2057].indexOf(fe)===-1)continue;switch(H){case 34:a.opts.Date1904=C.WBProps.date1904=V;break;case 134:a.opts.WriteProtect=!0;break;case 47:if(M.enc||(e.l=0),M.enc=V,!n.password)throw new Error("File is password-protected");if(V.valid==null)throw new Error("Encryption scheme unsupported");if(!V.valid)throw new Error("Password is incorrect");break;case 92:M.lastuser=V;break;case 66:var be=Number(V);switch(be){case 21010:be=1200;break;case 32768:be=1e4;break;case 32769:be=1252;break}Zr(M.codepage=be),z=!0;break;case 317:M.rrtabid=V;break;case 25:M.winlocked=V;break;case 439:a.opts.RefreshAll=V;break;case 12:a.opts.CalcCount=V;break;case 16:a.opts.CalcDelta=V;break;case 17:a.opts.CalcIter=V;break;case 13:a.opts.CalcMode=V;break;case 14:a.opts.CalcPrecision=V;break;case 95:a.opts.CalcSaveRecalc=V;break;case 15:M.CalcRefMode=V;break;case 2211:a.opts.FullCalc=V;break;case 129:V.fDialog&&(s["!type"]="dialog"),V.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),V.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:_.push(V);break;case 430:Q.push([V]),Q[Q.length-1].XTI=[];break;case 35:case 547:Q[Q.length-1].push(V);break;case 24:case 536:W={Name:V.Name,Ref:ja(V.rgce,o,null,Q,M)},V.itab>0&&(W.Sheet=V.itab-1),Q.names.push(W),Q[0]||(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].push(V),V.Name=="_xlnm._FilterDatabase"&&V.itab>0&&V.rgce&&V.rgce[0]&&V.rgce[0][0]&&V.rgce[0][0][0]=="PtgArea3d"&&(I[V.itab-1]={ref:gt(V.rgce[0][0][1][2])});break;case 22:M.ExternCount=V;break;case 23:Q.length==0&&(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].XTI=Q[Q.length-1].XTI.concat(V),Q.XTI=Q.XTI.concat(V);break;case 2196:if(M.biff<8)break;W!=null&&(W.Comment=V[1]);break;case 18:s["!protect"]=V;break;case 19:V!==0&&M.WTF&&console.error("Password verifier: "+V);break;case 133:l[V.pos]=V,M.snames.push(V.name);break;case 10:{if(--K)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=gt(o),n.sheetRows&&n.sheetRows<=o.e.r){var Oe=o.e.r;o.e.r=n.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=gt(o),o.e.r=Oe}o.e.r++,o.e.c++}J.length>0&&(s["!merges"]=J),B.length>0&&(s["!objects"]=B),ue.length>0&&(s["!cols"]=ue),te.length>0&&(s["!rows"]=te),C.Sheets.push(P)}x===""?m=s:r[x]=s,s=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(M.biff===8&&(M.biff={9:2,521:3,1033:4}[H]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[V.BIFFVer]||8),M.biffguess=V.BIFFVer==0,V.BIFFVer==0&&V.dt==4096&&(M.biff=5,z=!0,Zr(M.codepage=28591)),M.biff==8&&V.BIFFVer==0&&V.dt==16&&(M.biff=2),K++)break;if(s=n.dense?[]:{},M.biff<8&&!z&&(z=!0,Zr(M.codepage=n.codepage||1252)),M.biff<5||V.BIFFVer==0&&V.dt==4096){x===""&&(x="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var tt={pos:e.l-ne,name:x};l[tt.pos]=tt,M.snames.push(x)}else x=(l[xe]||{name:""}).name;V.dt==32&&(s["!type"]="chart"),V.dt==64&&(s["!type"]="macro"),J=[],B=[],M.arrayf=T=[],ue=[],te=[],Z=!1,P={Hidden:(l[xe]||{hs:0}).hs,name:x}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(n.dense?(s[V.r]||[])[V.c]:s[dt({c:V.c,r:V.r})])&&++V.c,S={ixfe:V.ixfe,XF:_[V.ixfe]||{},v:V.val,t:"n"},L>0&&(S.z=X[S.ixfe>>8&63]),fs(S,n,a.opts.Date1904),O({c:V.c,r:V.r},S,n);break;case 5:case 517:S={ixfe:V.ixfe,XF:_[V.ixfe],v:V.val,t:V.t},L>0&&(S.z=X[S.ixfe>>8&63]),fs(S,n,a.opts.Date1904),O({c:V.c,r:V.r},S,n);break;case 638:S={ixfe:V.ixfe,XF:_[V.ixfe],v:V.rknum,t:"n"},L>0&&(S.z=X[S.ixfe>>8&63]),fs(S,n,a.opts.Date1904),O({c:V.c,r:V.r},S,n);break;case 189:for(var Je=V.c;Je<=V.C;++Je){var Re=V.rkrec[Je-V.c][0];S={ixfe:Re,XF:_[Re],v:V.rkrec[Je-V.c][1],t:"n"},L>0&&(S.z=X[S.ixfe>>8&63]),fs(S,n,a.opts.Date1904),O({c:Je,r:V.r},S,n)}break;case 6:case 518:case 1030:{if(V.val=="String"){d=V;break}if(S=s0(V.val,V.cell.ixfe,V.tt),S.XF=_[S.ixfe],n.cellFormula){var Rt=V.formula;if(Rt&&Rt[0]&&Rt[0][0]&&Rt[0][0][0]=="PtgExp"){var un=Rt[0][0][1][0],hn=Rt[0][0][1][1],Cn=dt({r:un,c:hn});j[Cn]?S.f=""+ja(V.formula,o,V.cell,Q,M):S.F=((n.dense?(s[un]||[])[hn]:s[Cn])||{}).F}else S.f=""+ja(V.formula,o,V.cell,Q,M)}L>0&&(S.z=X[S.ixfe>>8&63]),fs(S,n,a.opts.Date1904),O(V.cell,S,n),d=V}break;case 7:case 519:if(d)d.val=V,S=s0(V,d.cell.ixfe,"s"),S.XF=_[S.ixfe],n.cellFormula&&(S.f=""+ja(d.formula,o,d.cell,Q,M)),L>0&&(S.z=X[S.ixfe>>8&63]),fs(S,n,a.opts.Date1904),O(d.cell,S,n),d=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(V);var Ha=dt(V[0].s);if(N=n.dense?(s[V[0].s.r]||[])[V[0].s.c]:s[Ha],n.cellFormula&&N){if(!d||!Ha||!N)break;N.f=""+ja(V[1],o,V[0],Q,M),N.F=gt(V[0])}}break;case 1212:{if(!n.cellFormula)break;if(p){if(!d)break;j[dt(d.cell)]=V[0],N=n.dense?(s[d.cell.r]||[])[d.cell.c]:s[dt(d.cell)],(N||{}).f=""+ja(V[0],o,f,Q,M)}}break;case 253:S=s0(u[V.isst].t,V.ixfe,"s"),u[V.isst].h&&(S.h=u[V.isst].h),S.XF=_[S.ixfe],L>0&&(S.z=X[S.ixfe>>8&63]),fs(S,n,a.opts.Date1904),O({c:V.c,r:V.r},S,n);break;case 513:n.sheetStubs&&(S={ixfe:V.ixfe,XF:_[V.ixfe],t:"z"},L>0&&(S.z=X[S.ixfe>>8&63]),fs(S,n,a.opts.Date1904),O({c:V.c,r:V.r},S,n));break;case 190:if(n.sheetStubs)for(var Bn=V.c;Bn<=V.C;++Bn){var Be=V.ixfe[Bn-V.c];S={ixfe:Be,XF:_[Be],t:"z"},L>0&&(S.z=X[S.ixfe>>8&63]),fs(S,n,a.opts.Date1904),O({c:Bn,r:V.r},S,n)}break;case 214:case 516:case 4:S=s0(V.val,V.ixfe,"s"),S.XF=_[S.ixfe],L>0&&(S.z=X[S.ixfe>>8&63]),fs(S,n,a.opts.Date1904),O({c:V.c,r:V.r},S,n);break;case 0:case 512:K===1&&(o=V);break;case 252:u=V;break;case 1054:if(M.biff==4){X[L++]=V[1];for(var Qe=0;Qe<L+163&&ct[Qe]!=V[1];++Qe);Qe>=163&&ri(V[1],L+163)}else ri(V[1],V[0]);break;case 30:{X[L++]=V;for(var Ct=0;Ct<L+163&&ct[Ct]!=V;++Ct);Ct>=163&&ri(V,L+163)}break;case 229:J=J.concat(V);break;case 93:B[V.cmo[0]]=M.lastobj=V;break;case 438:M.lastobj.TxO=V;break;case 127:M.lastobj.ImData=V;break;case 440:for(b=V[0].s.r;b<=V[0].e.r;++b)for(g=V[0].s.c;g<=V[0].e.c;++g)N=n.dense?(s[b]||[])[g]:s[dt({c:g,r:b})],N&&(N.l=V[1]);break;case 2048:for(b=V[0].s.r;b<=V[0].e.r;++b)for(g=V[0].s.c;g<=V[0].e.c;++g)N=n.dense?(s[b]||[])[g]:s[dt({c:g,r:b})],N&&N.l&&(N.l.Tooltip=V[1]);break;case 28:{if(M.biff<=5&&M.biff>=2)break;N=n.dense?(s[V[0].r]||[])[V[0].c]:s[dt(V[0])];var Ht=B[V[2]];N||(n.dense?(s[V[0].r]||(s[V[0].r]=[]),N=s[V[0].r][V[0].c]={t:"z"}):N=s[dt(V[0])]={t:"z"},o.e.r=Math.max(o.e.r,V[0].r),o.s.r=Math.min(o.s.r,V[0].r),o.e.c=Math.max(o.e.c,V[0].c),o.s.c=Math.min(o.s.c,V[0].c)),N.c||(N.c=[]),y={a:V[1],t:Ht.TxO.t},N.c.push(y)}break;case 2173:CO(_[V.ixfe],V.ext);break;case 125:{if(!M.cellStyles)break;for(;V.e>=V.s;)ue[V.e--]={width:V.w/256,level:V.level||0,hidden:!!(V.flags&1)},Z||(Z=!0,$g(V.w/256)),ll(ue[V.e+1])}break;case 520:{var kt={};V.level!=null&&(te[V.r]=kt,kt.level=V.level),V.hidden&&(te[V.r]=kt,kt.hidden=!0),V.hpt&&(te[V.r]=kt,kt.hpt=V.hpt,kt.hpx=Ec(V.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||no(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[H]]=V;break;case 161:s["!margins"]||no(s["!margins"]={}),s["!margins"].header=V.header,s["!margins"].footer=V.footer;break;case 574:V.RTL&&(C.Views[0].RTL=!0);break;case 146:E=V;break;case 2198:q=V;break;case 140:w=V;break;case 442:x?P.CodeName=V||P.name:C.WBProps.CodeName=V||"ThisWorkbook";break}}else oe||console.error("Missing Info for XLS Record 0x"+H.toString(16)),e.l+=ne}return a.SheetNames=Tn(l).sort(function(fn,ot){return Number(fn)-Number(ot)}).map(function(fn){return l[fn].name}),n.bookSheets||(a.Sheets=r),!a.SheetNames.length&&m["!ref"]?(a.SheetNames.push("Sheet1"),a.Sheets&&(a.Sheets.Sheet1=m)):a.Preamble=m,a.Sheets&&I.forEach(function(fn,ot){a.Sheets[a.SheetNames[ot]]["!autofilter"]=fn}),a.Strings=u,a.SSF=dn(ct),M.enc&&(a.Encryption=M.enc),q&&(a.Themes=q),a.Metadata={},w!==void 0&&(a.Metadata.Country=w),Q.names.length>0&&(C.Names=Q.names),a.Workbook=C,a}var $d={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function H9(e,n,a){var r=rt.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var s=HN(r,Dp,$d.DSI);for(var l in s)n[l]=s[l]}catch(x){if(a.WTF)throw x}var o=rt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var d=HN(o,Ap,$d.SI);for(var u in d)n[u]==null&&(n[u]=d[u])}catch(x){if(a.WTF)throw x}n.HeadingPairs&&n.TitlesOfParts&&(gk(n.HeadingPairs,n.TitlesOfParts,n,a),delete n.HeadingPairs,delete n.TitlesOfParts)}function V9(e,n){var a=[],r=[],s=[],l=0,o,d=pN(Dp,"n"),u=pN(Ap,"n");if(e.Props)for(o=Tn(e.Props),l=0;l<o.length;++l)(Object.prototype.hasOwnProperty.call(d,o[l])?a:Object.prototype.hasOwnProperty.call(u,o[l])?r:s).push([o[l],e.Props[o[l]]]);if(e.Custprops)for(o=Tn(e.Custprops),l=0;l<o.length;++l)Object.prototype.hasOwnProperty.call(e.Props||{},o[l])||(Object.prototype.hasOwnProperty.call(d,o[l])?a:Object.prototype.hasOwnProperty.call(u,o[l])?r:s).push([o[l],e.Custprops[o[l]]]);var x=[];for(l=0;l<s.length;++l)kk.indexOf(s[l][0])>-1||pk.indexOf(s[l][0])>-1||s[l][1]!=null&&x.push(s[l]);r.length&&rt.utils.cfb_add(n,"/SummaryInformation",VN(r,$d.SI,u,Ap)),(a.length||x.length)&&rt.utils.cfb_add(n,"/DocumentSummaryInformation",VN(a,$d.DSI,d,Dp,x.length?x:null,$d.UDI))}function Zg(e,n){n||(n={}),ty(n),Ng(),n.codepage&&bg(n.codepage);var a,r;if(e.FullPaths){if(rt.find(e,"/encryption"))throw new Error("File is password-protected");a=rt.find(e,"!CompObj"),r=rt.find(e,"/Workbook")||rt.find(e,"/Book")}else{switch(n.type){case"base64":e=xr(vr(e));break;case"binary":e=xr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}da(e,0),r={content:e}}var s,l;if(a&&O9(a),n.bookProps&&!n.bookSheets)s={};else{var o=bt?"buffer":"array";if(r&&r.content)s=B9(r.content,n);else if((l=rt.find(e,"PerfectOffice_MAIN"))&&l.content)s=to.to_workbook(l.content,(n.type=o,n));else if((l=rt.find(e,"NativeContent_MAIN"))&&l.content)s=to.to_workbook(l.content,(n.type=o,n));else throw(l=rt.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&e.FullPaths&&rt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=eM(e))}var d={};return e.FullPaths&&H9(e,d,n),s.Props=s.Custprops=d,n.bookFiles&&(s.cfb=e),s}function U9(e,n){var a=n||{},r=rt.utils.cfb_new({root:"R"}),s="/Workbook";switch(a.bookType||"xls"){case"xls":a.bookType="biff8";case"xla":a.bookType||(a.bookType="xla");case"biff8":s="/Workbook",a.biff=8;break;case"biff5":s="/Book",a.biff=5;break;default:throw new Error("invalid type "+a.bookType+" for XLS CFB")}return rt.utils.cfb_add(r,s,vT(e,a)),a.biff==8&&(e.Props||e.Custprops)&&V9(e,r),a.biff==8&&e.vbaraw&&tM(r,rt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),r}var ou={0:{f:hR},1:{f:bR},2:{f:BR},3:{f:_R},4:{f:kR},5:{f:OR},6:{f:zR},7:{f:FR},8:{f:YR},9:{f:QR},10:{f:WR},11:{f:XR},12:{f:jR},13:{f:VR},14:{f:DR},15:{f:CR},16:{f:uT},17:{f:GR},18:{f:PR},19:{f:Ig},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:GB},40:{},42:{},43:{f:zI},44:{f:UI},45:{f:qI},46:{f:XI},47:{f:WI},48:{},49:{f:f8},50:{},51:{f:EO},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Ik},62:{f:KR},63:{f:RO},64:{f:xB},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Sa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:cB},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:yR},148:{f:fR,p:16},151:{f:aB},152:{},153:{f:KB},154:{},155:{},156:{f:VB},157:{},158:{},159:{T:1,f:sI},160:{T:-1},161:{T:1,f:bo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:JR},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:SO},336:{T:-1},337:{f:FO,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ep},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Pk},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:rB},427:{f:sB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:lB},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:gR},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:tB},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ep},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:XO},633:{T:1},634:{T:-1},635:{T:1,f:qO},636:{T:-1},637:{f:v8},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:DB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:mB},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Mp={6:{f:Pf},10:{f:Ri},12:{f:Mn},13:{f:Mn},14:{f:Dn},15:{f:Dn},16:{f:Ta},17:{f:Dn},18:{f:Dn},19:{f:Mn},20:{f:qN},21:{f:qN},23:{f:Pk},24:{f:XN},25:{f:Dn},26:{},27:{},28:{f:mP},29:{},34:{f:Dn},35:{f:WN},38:{f:Ta},39:{f:Ta},40:{f:Ta},41:{f:Ta},42:{f:Dn},43:{f:Dn},47:{f:CI},49:{f:VL},51:{f:Mn},60:{},61:{f:OL},64:{f:Dn},65:{f:HL},66:{f:Mn},77:{},80:{},81:{},82:{},85:{f:Mn},89:{},90:{},91:{},92:{f:TL},93:{f:gP},94:{},95:{f:Dn},96:{},97:{},99:{f:Dn},125:{f:Ik},128:{f:nP},129:{f:SL},130:{f:Mn},131:{f:Dn},132:{f:Dn},133:{f:_L},134:{},140:{f:TP},141:{f:Mn},144:{},146:{f:_P},151:{},152:{},153:{},154:{},155:{},156:{f:Mn},157:{},158:{},160:{f:IP},161:{f:AP},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:JL},190:{f:ZL},193:{f:Ri},197:{},198:{},199:{},200:{},201:{},202:{f:Dn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Mn},220:{},221:{f:Dn},222:{},224:{f:tP},225:{f:kL},226:{f:Ri},227:{},229:{f:fP},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:DL},253:{f:KL},255:{f:FL},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Tk},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Dn},353:{f:Ri},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:lP},431:{f:Dn},432:{},433:{},434:{},437:{},438:{f:bP},439:{f:Dn},440:{f:NP},441:{},442:{f:_u},443:{},444:{f:Mn},445:{},446:{},448:{f:Ri},449:{f:IL,r:2},450:{f:Ri},512:{f:zN},513:{f:PP},515:{f:sP},516:{f:$L},517:{f:GN},519:{f:OP},520:{f:LL},523:{},545:{f:QN},549:{f:KN},566:{},574:{f:RL},638:{f:YL},659:{},1048:{},1054:{f:qL},1084:{},1212:{f:uP},2048:{f:wP},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:n0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ri},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:EP,r:12},2173:{f:TO,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Dn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:dP,r:12},2197:{},2198:{f:vO,r:12},2199:{},2200:{},2201:{},2202:{f:hP,r:12},2203:{f:Ri},2204:{},2205:{},2206:{},2207:{},2211:{f:PL},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Mn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:FP},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:SP},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:zN},1:{},2:{f:VP},3:{f:BP},4:{f:RP},5:{f:GN},7:{f:KP},8:{},9:{f:n0},11:{},22:{f:Mn},30:{f:XL},31:{},32:{},33:{f:QN},36:{},37:{f:KN},50:{f:zP},62:{},52:{},67:{},68:{f:Mn},69:{},86:{},126:{},127:{f:MP},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:$P},223:{},234:{},354:{},421:{},518:{f:Pf},521:{f:n0},536:{f:XN},547:{f:WN},561:{},579:{},1030:{f:Pf},1033:{f:n0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ke(e,n,a,r){var s=n;if(!isNaN(s)){var l=r||(a||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,l),l>0&&Fg(a)&&e.push(a)}}function K9(e,n,a,r){var s=(a||[]).length||0;if(s<=8224)return Ke(e,n,a,s);var l=n;if(!isNaN(l)){for(var o=a.parts||[],d=0,u=0,x=0;x+(o[d]||8224)<=8224;)x+=o[d]||8224,d++;var m=e.next(4);for(m.write_shift(2,l),m.write_shift(2,x),e.push(a.slice(u,u+x)),u+=x;u<s;){for(m=e.next(4),m.write_shift(2,60),x=0;x+(o[d]||8224)<=8224;)x+=o[d]||8224,d++;m.write_shift(2,x),e.push(a.slice(u,u+x)),u+=x}}}function Fu(e,n,a){return e||(e=Te(7)),e.write_shift(2,n),e.write_shift(2,a),e.write_shift(2,0),e.write_shift(1,0),e}function z9(e,n,a,r){var s=Te(9);return Fu(s,e,n),Ck(a,r||"b",s),s}function $9(e,n,a){var r=Te(8+2*a.length);return Fu(r,e,n),r.write_shift(1,a.length),r.write_shift(a.length,a,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function G9(e,n,a,r){if(n.v!=null)switch(n.t){case"d":case"n":var s=n.t=="d"?Wn(cn(n.v)):n.v;s==(s|0)&&s>=0&&s<65536?Ke(e,2,UP(a,r,s)):Ke(e,3,HP(a,r,s));return;case"b":case"e":Ke(e,5,z9(a,r,n.v,n.t));return;case"s":case"str":Ke(e,4,$9(a,r,(n.v||"").slice(0,255)));return}Ke(e,1,Fu(null,a,r))}function q9(e,n,a,r){var s=Array.isArray(n),l=Pt(n["!ref"]||"A1"),o,d="",u=[];if(l.e.c>255||l.e.r>16383){if(r.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),o=gt(l)}for(var x=l.s.r;x<=l.e.r;++x){d=Fn(x);for(var m=l.s.c;m<=l.e.c;++m){x===l.s.r&&(u[m]=vn(m)),o=u[m]+d;var f=s?(n[x]||[])[m]:n[o];f&&G9(e,f,x,m)}}}function W9(e,n){for(var a=n||{},r=rr(),s=0,l=0;l<e.SheetNames.length;++l)e.SheetNames[l]==a.sheet&&(s=l);if(s==0&&a.sheet&&e.SheetNames[0]!=a.sheet)throw new Error("Sheet not found: "+a.sheet);return Ke(r,a.biff==4?1033:a.biff==3?521:9,Ug(e,16,a)),q9(r,e.Sheets[e.SheetNames[s]],s,a),Ke(r,10),r.end()}function X9(e,n,a){Ke(e,49,UL({sz:12,name:"Arial"},a))}function Q9(e,n,a){n&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)n[s]!=null&&Ke(e,1054,WL(s,n[s],a))})}function Y9(e,n){var a=Te(19);a.write_shift(4,2151),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,1),a.write_shift(4,0),Ke(e,2151,a),a=Te(39),a.write_shift(4,2152),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,0),a.write_shift(4,0),a.write_shift(2,1),a.write_shift(4,4),a.write_shift(2,0),Ak(Pt(n["!ref"]||"A1"),a),a.write_shift(4,4),Ke(e,2152,a)}function J9(e,n){for(var a=0;a<16;++a)Ke(e,224,$N({numFmtId:0,style:!0},0,n));n.cellXfs.forEach(function(r){Ke(e,224,$N(r,0,n))})}function Z9(e,n){for(var a=0;a<n["!links"].length;++a){var r=n["!links"][a];Ke(e,440,jP(r)),r[1].Tooltip&&Ke(e,2048,kP(r))}delete n["!links"]}function eH(e,n){if(n){var a=0;n.forEach(function(r,s){++a<=256&&r&&Ke(e,125,DP(fx(s,r),s))})}}function tH(e,n,a,r,s){var l=16+ml(s.cellXfs,n,s);if(n.v==null&&!n.bf){Ke(e,513,ho(a,r,l));return}if(n.bf)Ke(e,6,S7(n,a,r,s,l));else switch(n.t){case"d":case"n":var o=n.t=="d"?Wn(cn(n.v)):n.v;Ke(e,515,iP(a,r,o,l));break;case"b":case"e":Ke(e,517,rP(a,r,n.v,l,s,n.t));break;case"s":case"str":if(s.bookSST){var d=Qg(s.Strings,n.v,s.revStrings);Ke(e,253,zL(a,r,d,l))}else Ke(e,516,GL(a,r,(n.v||"").slice(0,255),l,s));break;default:Ke(e,513,ho(a,r,l))}}function nH(e,n,a){var r=rr(),s=a.SheetNames[e],l=a.Sheets[s]||{},o=(a||{}).Workbook||{},d=(o.Sheets||[])[e]||{},u=Array.isArray(l),x=n.biff==8,m,f="",p=[],N=Pt(l["!ref"]||"A1"),y=x?65536:16384;if(N.e.c>255||N.e.r>=y){if(n.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");N.e.c=Math.min(N.e.c,255),N.e.r=Math.min(N.e.c,y-1)}Ke(r,2057,Ug(a,16,n)),Ke(r,13,Pr(1)),Ke(r,12,Pr(100)),Ke(r,15,Oa(!0)),Ke(r,17,Oa(!1)),Ke(r,16,co(.001)),Ke(r,95,Oa(!0)),Ke(r,42,Oa(!1)),Ke(r,43,Oa(!1)),Ke(r,130,Pr(1)),Ke(r,128,aP()),Ke(r,131,Oa(!1)),Ke(r,132,Oa(!1)),x&&eH(r,l["!cols"]),Ke(r,512,QL(N,n)),x&&(l["!links"]=[]);for(var g=N.s.r;g<=N.e.r;++g){f=Fn(g);for(var b=N.s.c;b<=N.e.c;++b){g===N.s.r&&(p[b]=vn(b)),m=p[b]+f;var j=u?(l[g]||[])[b]:l[m];j&&(tH(r,j,g,b,n),x&&j.l&&l["!links"].push([m,j.l]))}}var T=d.CodeName||d.name||s;return x&&Ke(r,574,BL((o.Views||[])[0])),x&&(l["!merges"]||[]).length&&Ke(r,229,pP(l["!merges"])),x&&Z9(r,l),Ke(r,442,Sk(T)),x&&Y9(r,l),Ke(r,10),r.end()}function aH(e,n,a){var r=rr(),s=(e||{}).Workbook||{},l=s.Sheets||[],o=s.WBProps||{},d=a.biff==8,u=a.biff==5;if(Ke(r,2057,Ug(e,5,a)),a.bookType=="xla"&&Ke(r,135),Ke(r,225,d?Pr(1200):null),Ke(r,193,rL(2)),u&&Ke(r,191),u&&Ke(r,192),Ke(r,226),Ke(r,92,CL("SheetJS",a)),Ke(r,66,Pr(d?1200:1252)),d&&Ke(r,353,Pr(0)),d&&Ke(r,448),Ke(r,317,LP(e.SheetNames.length)),d&&e.vbaraw&&Ke(r,211),d&&e.vbaraw){var x=o.CodeName||"ThisWorkbook";Ke(r,442,Sk(x))}Ke(r,156,Pr(17)),Ke(r,25,Oa(!1)),Ke(r,18,Oa(!1)),Ke(r,19,Pr(0)),d&&Ke(r,431,Oa(!1)),d&&Ke(r,444,Pr(0)),Ke(r,61,ML()),Ke(r,64,Oa(!1)),Ke(r,141,Pr(0)),Ke(r,34,Oa(IB(e)=="true")),Ke(r,14,Oa(!0)),d&&Ke(r,439,Oa(!1)),Ke(r,218,Pr(0)),X9(r,e,a),Q9(r,e.SSF,a),J9(r,a),d&&Ke(r,352,Oa(!1));var m=r.end(),f=rr();d&&Ke(f,140,CP()),d&&a.Strings&&K9(f,252,AL(a.Strings)),Ke(f,10);var p=f.end(),N=rr(),y=0,g=0;for(g=0;g<e.SheetNames.length;++g)y+=(d?12:11)+(d?2:1)*e.SheetNames[g].length;var b=m.length+y+p.length;for(g=0;g<e.SheetNames.length;++g){var j=l[g]||{};Ke(N,133,EL({pos:b,hs:j.Hidden||0,dt:0,name:e.SheetNames[g]},a)),b+=n[g].length}var T=N.end();if(y!=T.length)throw new Error("BS8 "+y+" != "+T.length);var S=[];return m.length&&S.push(m),T.length&&S.push(T),p.length&&S.push(p),aa(S)}function rH(e,n){var a=n||{},r=[];e&&!e.SSF&&(e.SSF=dn(ct)),e&&e.SSF&&(Oc(),ox(e.SSF),a.revssf=dx(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF),a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,ny(a),a.cellXfs=[],ml(a.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)r[r.length]=nH(s,a,e);return r.unshift(aH(e,r,a)),aa(r)}function vT(e,n){for(var a=0;a<=e.SheetNames.length;++a){var r=e.Sheets[e.SheetNames[a]];if(!(!r||!r["!ref"])){var s=sr(r["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[a]+"' extends beyond column IV (255).  Data may be lost.")}}var l=n||{};switch(l.biff||2){case 8:case 5:return rH(e,n);case 4:case 3:case 2:return W9(e,n)}throw new Error("invalid type "+l.bookType+" for BIFF")}function i2(e,n){var a=n||{},r=a.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),o=s.index,d=l&&l.index||e.length,u=UF(e.slice(o,d),/(:?<tr[^>]*>)/i,"<tr>"),x=-1,m=0,f=0,p=0,N={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(o=0;o<u.length;++o){var g=u[o].trim(),b=g.slice(0,3).toLowerCase();if(b=="<tr"){if(++x,a.sheetRows&&a.sheetRows<=x){--x;break}m=0;continue}if(!(b!="<td"&&b!="<th")){var j=g.split(/<\/t[dh]>/i);for(d=0;d<j.length;++d){var T=j[d].trim();if(T.match(/<t[dh]/i)){for(var S=T,w=0;S.charAt(0)=="<"&&(w=S.indexOf(">"))>-1;)S=S.slice(w+1);for(var _=0;_<y.length;++_){var E=y[_];E.s.c==m&&E.s.r<x&&x<=E.e.r&&(m=E.e.c+1,_=-1)}var C=ut(T.slice(0,T.indexOf(">")));p=C.colspan?+C.colspan:1,((f=+C.rowspan)>1||p>1)&&y.push({s:{r:x,c:m},e:{r:x+(f||1)-1,c:m+p-1}});var P=C.t||C["data-t"]||"";if(!S.length){m+=p;continue}if(S=zw(S),N.s.r>x&&(N.s.r=x),N.e.r<x&&(N.e.r=x),N.s.c>m&&(N.s.c=m),N.e.c<m&&(N.e.c=m),!S.length){m+=p;continue}var F={t:"s",v:S};a.raw||!S.trim().length||P=="s"||(S==="TRUE"?F={t:"b",v:!0}:S==="FALSE"?F={t:"b",v:!1}:isNaN(as(S))?isNaN(Sc(S).getDate())||(F={t:"d",v:cn(S)},a.cellDates||(F={t:"n",v:Wn(F.v)}),F.z=a.dateNF||ct[14]):F={t:"n",v:as(S)}),a.dense?(r[x]||(r[x]=[]),r[x][m]=F):r[dt({r:x,c:m})]=F,m+=p}}}}return r["!ref"]=gt(N),y.length&&(r["!merges"]=y),r}function sH(e,n,a,r){for(var s=e["!merges"]||[],l=[],o=n.s.c;o<=n.e.c;++o){for(var d=0,u=0,x=0;x<s.length;++x)if(!(s[x].s.r>a||s[x].s.c>o)&&!(s[x].e.r<a||s[x].e.c<o)){if(s[x].s.r<a||s[x].s.c<o){d=-1;break}d=s[x].e.r-s[x].s.r+1,u=s[x].e.c-s[x].s.c+1;break}if(!(d<0)){var m=dt({r:a,c:o}),f=r.dense?(e[a]||[])[o]:e[m],p=f&&f.v!=null&&(f.h||Eg(f.w||(ci(f),f.w)||""))||"",N={};d>1&&(N.rowspan=d),u>1&&(N.colspan=u),r.editable?p='<span contenteditable="true">'+p+"</span>":f&&(N["data-t"]=f&&f.t||"z",f.v!=null&&(N["data-v"]=f.v),f.z!=null&&(N["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+f.l.Target+'">'+p+"</a>")),N.id=(r.id||"sjs")+"-"+m,l.push(Ue("td",p,N))}}var y="<tr>";return y+l.join("")+"</tr>"}var iH='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',lH="</body></html>";function oH(e,n){var a=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!a||a.length==0)throw new Error("Invalid HTML: could not find <table>");if(a.length==1)return xl(i2(a[0],n),n);var r=iy();return a.forEach(function(s,l){ly(r,i2(s,n),"Sheet"+(l+1))}),r}function cH(e,n,a){var r=[];return r.join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}function bT(e,n){var a=n||{},r=a.header!=null?a.header:iH,s=a.footer!=null?a.footer:lH,l=[r],o=sr(e["!ref"]);a.dense=Array.isArray(e),l.push(cH(e,o,a));for(var d=o.s.r;d<=o.e.r;++d)l.push(sH(e,o,d,a));return l.push("</table>"+s),l.join("")}function NT(e,n,a){var r=a||{},s=0,l=0;if(r.origin!=null)if(typeof r.origin=="number")s=r.origin;else{var o=typeof r.origin=="string"?bn(r.origin):r.origin;s=o.r,l=o.c}var d=n.getElementsByTagName("tr"),u=Math.min(r.sheetRows||1e7,d.length),x={s:{r:0,c:0},e:{r:s,c:l}};if(e["!ref"]){var m=sr(e["!ref"]);x.s.r=Math.min(x.s.r,m.s.r),x.s.c=Math.min(x.s.c,m.s.c),x.e.r=Math.max(x.e.r,m.e.r),x.e.c=Math.max(x.e.c,m.e.c),s==-1&&(x.e.r=s=m.e.r+1)}var f=[],p=0,N=e["!rows"]||(e["!rows"]=[]),y=0,g=0,b=0,j=0,T=0,S=0;for(e["!cols"]||(e["!cols"]=[]);y<d.length&&g<u;++y){var w=d[y];if(l2(w)){if(r.display)continue;N[g]={hidden:!0}}var _=w.children;for(b=j=0;b<_.length;++b){var E=_[b];if(!(r.display&&l2(E))){var C=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):zw(E.innerHTML),P=E.getAttribute("data-z")||E.getAttribute("z");for(p=0;p<f.length;++p){var F=f[p];F.s.c==j+l&&F.s.r<g+s&&g+s<=F.e.r&&(j=F.e.c+1-l,p=-1)}S=+E.getAttribute("colspan")||1,((T=+E.getAttribute("rowspan")||1)>1||S>1)&&f.push({s:{r:g+s,c:j+l},e:{r:g+s+(T||1)-1,c:j+l+(S||1)-1}});var R={t:"s",v:C},O=E.getAttribute("data-t")||E.getAttribute("t")||"";C!=null&&(C.length==0?R.t=O||"z":r.raw||C.trim().length==0||O=="s"||(C==="TRUE"?R={t:"b",v:!0}:C==="FALSE"?R={t:"b",v:!1}:isNaN(as(C))?isNaN(Sc(C).getDate())||(R={t:"d",v:cn(C)},r.cellDates||(R={t:"n",v:Wn(R.v)}),R.z=r.dateNF||ct[14]):R={t:"n",v:as(C)})),R.z===void 0&&P!=null&&(R.z=P);var M="",q=E.getElementsByTagName("A");if(q&&q.length)for(var J=0;J<q.length&&!(q[J].hasAttribute("href")&&(M=q[J].getAttribute("href"),M.charAt(0)!="#"));++J);M&&M.charAt(0)!="#"&&(R.l={Target:M}),r.dense?(e[g+s]||(e[g+s]=[]),e[g+s][j+l]=R):e[dt({c:j+l,r:g+s})]=R,x.e.c<j+l&&(x.e.c=j+l),j+=S}}++g}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),x.e.r=Math.max(x.e.r,g-1+s),e["!ref"]=gt(x),g>=u&&(e["!fullref"]=gt((x.e.r=d.length-y+g-1+s,x))),e}function jT(e,n){var a=n||{},r=a.dense?[]:{};return NT(r,e,n)}function dH(e,n){return xl(jT(e,n),n)}function l2(e){var n="",a=uH(e);return a&&(n=a(e).getPropertyValue("display")),n||(n=e.style&&e.style.display),n==="none"}function uH(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function hH(e){var n=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),a=Ft(n.replace(/<[^>]*>/g,""));return[a]}var o2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function wT(e,n){var a=n||{},r=Dg(e),s=[],l,o,d={name:""},u="",x=0,m,f,p={},N=[],y=a.dense?[]:{},g,b,j={value:""},T="",S=0,w=[],_=-1,E=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,F={},R=[],O={},M=0,q=0,J=[],B=1,ue=1,te=[],Z={Names:[]},Q={},fe=["",""],K=[],L={},X="",I=0,W=!1,z=!1,xe=0;for(nu.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=nu.exec(r);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?y["!ref"]=gt(C):y["!ref"]="A1:A1",a.sheetRows>0&&a.sheetRows<=C.e.r&&(y["!fullref"]=y["!ref"],C.e.r=a.sheetRows-1,y["!ref"]=gt(C)),R.length&&(y["!merges"]=R),J.length&&(y["!rows"]=J),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),N.push(m.name),p[m.name]=y,z=!1):g[0].charAt(g[0].length-2)!=="/"&&(m=ut(g[0],!1),_=E=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,y=a.dense?[]:{},R=[],J=[],z=!0);break;case"table-row-group":g[1]==="/"?--P:++P;break;case"table-row":case"":if(g[1]==="/"){_+=B,B=1;break}if(f=ut(g[0],!1),f.?_=f.-1:_==-1&&(_=0),B=+f["number-rows-repeated"]||1,B<10)for(xe=0;xe<B;++xe)P>0&&(J[_+xe]={level:P});E=-1;break;case"covered-table-cell":g[1]!=="/"&&++E,a.sheetStubs&&(a.dense?(y[_]||(y[_]=[]),y[_][E]={t:"z"}):y[dt({r:_,c:E})]={t:"z"}),T="",w=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++E,j=ut(g[0],!1),ue=parseInt(j["number-columns-repeated"]||"1",10),b={t:"z",v:null},j.formula&&a.cellFormula!=!1&&(b.f=a2(Ft(j.formula))),(j.||j["value-type"])=="string"&&(b.t="s",b.v=Ft(j["string-value"]||""),a.dense?(y[_]||(y[_]=[]),y[_][E]=b):y[dt({r:_,c:E})]=b),E+=ue-1;else if(g[1]!=="/"){++E,T="",S=0,w=[],ue=1;var H=B?_+B-1:_;if(E>C.e.c&&(C.e.c=E),E<C.s.c&&(C.s.c=E),_<C.s.r&&(C.s.r=_),H>C.e.r&&(C.e.r=H),j=ut(g[0],!1),K=[],L={},b={t:j.||j["value-type"],v:null},a.cellFormula)if(j.formula&&(j.formula=Ft(j.formula)),j["number-matrix-columns-spanned"]&&j["number-matrix-rows-spanned"]&&(M=parseInt(j["number-matrix-rows-spanned"],10)||0,q=parseInt(j["number-matrix-columns-spanned"],10)||0,O={s:{r:_,c:E},e:{r:_+M-1,c:E+q-1}},b.F=gt(O),te.push([O,b.F])),j.formula)b.f=a2(j.formula);else for(xe=0;xe<te.length;++xe)_>=te[xe][0].s.r&&_<=te[xe][0].e.r&&E>=te[xe][0].s.c&&E<=te[xe][0].e.c&&(b.F=te[xe][1]);switch((j["number-columns-spanned"]||j["number-rows-spanned"])&&(M=parseInt(j["number-rows-spanned"],10)||0,q=parseInt(j["number-columns-spanned"],10)||0,O={s:{r:_,c:E},e:{r:_+M-1,c:E+q-1}},R.push(O)),j["number-columns-repeated"]&&(ue=parseInt(j["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=ln(j["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(j.value);break;case"percentage":b.t="n",b.v=parseFloat(j.value);break;case"currency":b.t="n",b.v=parseFloat(j.value);break;case"date":b.t="d",b.v=cn(j["date-value"]),a.cellDates||(b.t="n",b.v=Wn(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=BF(j["time-value"])/86400,a.cellDates&&(b.t="d",b.v=ux(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(j.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",j["string-value"]!=null&&(T=Ft(j["string-value"]),w=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(W=!1,b.t==="s"&&(b.v=T||"",w.length&&(b.R=w),W=S==0),Q.Target&&(b.l=Q),K.length>0&&(b.c=K,K=[]),T&&a.cellText!==!1&&(b.w=T),W&&(b.t="z",delete b.v),(!W||a.sheetStubs)&&!(a.sheetRows&&a.sheetRows<=_))for(var ne=0;ne<B;++ne){if(ue=parseInt(j["number-columns-repeated"]||"1",10),a.dense)for(y[_+ne]||(y[_+ne]=[]),y[_+ne][E]=ne==0?b:dn(b);--ue>0;)y[_+ne][E+ue]=dn(b);else for(y[dt({r:_+ne,c:E})]=b;--ue>0;)y[dt({r:_+ne,c:E+ue})]=dn(b);C.e.c<=E&&(C.e.c=E)}ue=parseInt(j["number-columns-repeated"]||"1",10),E+=ue-1,ue=0,b={},T="",w=[]}Q={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((l=s.pop())[0]!==g[3])throw"Bad state: "+l}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((l=s.pop())[0]!==g[3])throw"Bad state: "+l;L.t=T,w.length&&(L.R=w),L.a=X,K.push(L)}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);X="",I=0,T="",S=0,w=[];break;case"creator":g[1]==="/"?X=r.slice(I,g.index):I=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((l=s.pop())[0]!==g[3])throw"Bad state: "+l}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);T="",S=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(F[d.name]=u,(l=s.pop())[0]!==g[3])throw"Bad state: "+l}else g[0].charAt(g[0].length-2)!=="/"&&(u="",d=ut(g[0],!1),s.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=ut(g[0],!1),u+=o2[g[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=ut(g[0],!1),u+=o2[g[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":u+=r.slice(x,g.index);break}else x=g.index+g[0].length;break;case"named-range":o=ut(g[0],!1),fe=If(o["cell-range-address"]);var oe={Name:o.name,Ref:fe[0]+"!"+fe[1]};z&&(oe.Sheet=N.length),Z.Names.push(oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(g[1]==="/"&&(!j||!j["string-value"])){var Se=hH(r.slice(S,g.index));T=(T.length>0?T+`
`:"")+Se[0]}else ut(g[0],!1),S=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{fe=If(ut(g[0])["target-range-address"]),p[fe[0]]["!autofilter"]={ref:fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(Q=ut(g[0],!1),!Q.href)break;Q.Target=Ft(Q.href),delete Q.href,Q.Target.charAt(0)=="#"&&Q.Target.indexOf(".")>-1?(fe=If(Q.Target.slice(1)),Q.Target="#"+fe[0]+"!"+fe[1]):Q.Target.match(/^\.\.[\\\/]/)&&(Q.Target=Q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(a.WTF)throw new Error(g)}}var V={Sheets:p,SheetNames:N,Workbook:Z};return a.bookSheets&&delete V.Sheets,V}function c2(e,n){n=n||{},Fr(e,"META-INF/manifest.xml")&&B8(On(e,"META-INF/manifest.xml"),n);var a=mr(e,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var r=wT(Xt(a),n);return Fr(e,"meta.xml")&&(r.Props=mk(On(e,"meta.xml"))),r}function d2(e,n){return wT(e,n)}var xH=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),n="<office:document-styles "+tu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Ln+n}})(),u2=(function(){var e=function(l){return qt(l).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},n=`          <table:table-cell />
`,a=`          <table:covered-table-cell/>
`,r=function(l,o,d){var u=[];u.push('      <table:table table:name="'+qt(o.SheetNames[d])+`" table:style-name="ta1">
`);var x=0,m=0,f=sr(l["!ref"]||"A1"),p=l["!merges"]||[],N=0,y=Array.isArray(l);if(l["!cols"])for(m=0;m<=f.e.c;++m)u.push("        <table:table-column"+(l["!cols"][m]?' table:style-name="co'+l["!cols"][m].ods+'"':"")+`></table:table-column>
`);var g="",b=l["!rows"]||[];for(x=0;x<f.s.r;++x)g=b[x]?' table:style-name="ro'+b[x].ods+'"':"",u.push("        <table:table-row"+g+`></table:table-row>
`);for(;x<=f.e.r;++x){for(g=b[x]?' table:style-name="ro'+b[x].ods+'"':"",u.push("        <table:table-row"+g+`>
`),m=0;m<f.s.c;++m)u.push(n);for(;m<=f.e.c;++m){var j=!1,T={},S="";for(N=0;N!=p.length;++N)if(!(p[N].s.c>m)&&!(p[N].s.r>x)&&!(p[N].e.c<m)&&!(p[N].e.r<x)){(p[N].s.c!=m||p[N].s.r!=x)&&(j=!0),T["table:number-columns-spanned"]=p[N].e.c-p[N].s.c+1,T["table:number-rows-spanned"]=p[N].e.r-p[N].s.r+1;break}if(j){u.push(a);continue}var w=dt({r:x,c:m}),_=y?(l[x]||[])[m]:l[w];if(_&&_.f&&(T["table:formula"]=qt(L7(_.f)),_.F&&_.F.slice(0,w.length)==w)){var E=sr(_.F);T["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,T["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!_){u.push(n);continue}switch(_.t){case"b":S=_.v?"TRUE":"FALSE",T["office:value-type"]="boolean",T["office:boolean-value"]=_.v?"true":"false";break;case"n":S=_.w||String(_.v||0),T["office:value-type"]="float",T["office:value"]=_.v||0;break;case"s":case"str":S=_.v==null?"":_.v,T["office:value-type"]="string";break;case"d":S=_.w||cn(_.v).toISOString(),T["office:value-type"]="date",T["office:date-value"]=cn(_.v).toISOString(),T["table:style-name"]="ce1";break;default:u.push(n);continue}var C=e(S);if(_.l&&_.l.Target){var P=_.l.Target;P=P.charAt(0)=="#"?"#"+P7(P.slice(1)):P,P.charAt(0)!="#"&&!P.match(/^\w+:/)&&(P="../"+P),C=Ue("text:a",C,{"xlink:href":P.replace(/&/g,"&amp;")})}u.push("          "+Ue("table:table-cell",Ue("text:p",C,{}),T)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},s=function(l,o){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var d=0;o.SheetNames.map(function(x){return o.Sheets[x]}).forEach(function(x){if(x&&x["!cols"]){for(var m=0;m<x["!cols"].length;++m)if(x["!cols"][m]){var f=x["!cols"][m];if(f.width==null&&f.wpx==null&&f.wch==null)continue;ll(f),f.ods=d;var p=x["!cols"][m].wpx+"px";l.push('  <style:style style:name="co'+d+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),l.push(`  </style:style>
`),++d}}});var u=0;o.SheetNames.map(function(x){return o.Sheets[x]}).forEach(function(x){if(x&&x["!rows"]){for(var m=0;m<x["!rows"].length;++m)if(x["!rows"][m]){x["!rows"][m].ods=u;var f=x["!rows"][m].hpx+"px";l.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),l.push(`  </style:style>
`),++u}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(o,d){var u=[Ln],x=tu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=tu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});d.bookType=="fods"?(u.push("<office:document"+x+m+`>
`),u.push(xk().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+x+`>
`),s(u,o),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)u.push(r(o.Sheets[o.SheetNames[f]],o,f));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),d.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}})();function kT(e,n){if(n.bookType=="fods")return u2(e,n);var a=Cg(),r="",s=[],l=[];return r="mimetype",yt(a,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",yt(a,r,u2(e,n)),s.push([r,"text/xml"]),l.push([r,"ContentFile"]),r="styles.xml",yt(a,r,xH(e,n)),s.push([r,"text/xml"]),l.push([r,"StylesFile"]),r="meta.xml",yt(a,r,Ln+xk()),s.push([r,"text/xml"]),l.push([r,"MetadataFile"]),r="manifest.rdf",yt(a,r,U8(l)),s.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",yt(a,r,H8(s)),a}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function xo(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Rp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Xt(hl(e))}function mH(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):xr(Cs(e))}function fH(e,n){e:for(var a=0;a<=e.length-n.length;++a){for(var r=0;r<n.length;++r)if(e[a+r]!=n[r])continue e;return!0}return!1}function cl(e){var n=e.reduce(function(s,l){return s+l.length},0),a=new Uint8Array(n),r=0;return e.forEach(function(s){a.set(s,r),r+=s.length}),a}function h2(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function pH(e,n){for(var a=(e[n+15]&127)<<7|e[n+14]>>1,r=e[n+14]&1,s=n+13;s>=n;--s)r=r*256+e[s];return(e[n+15]&128?-r:r)*Math.pow(10,a-6176)}function gH(e,n,a){var r=Math.floor(a==0?0:Math.LOG10E*Math.log(Math.abs(a)))+6176-20,s=a/Math.pow(10,r-6176);e[n+15]|=r>>7,e[n+14]|=(r&127)<<1;for(var l=0;s>=1;++l,s/=256)e[n+l]=s&255;e[n+15]|=a>=0?0:128}function cu(e,n){var a=n?n[0]:0,r=e[a]&127;e:if(e[a++]>=128&&(r|=(e[a]&127)<<7,e[a++]<128||(r|=(e[a]&127)<<14,e[a++]<128)||(r|=(e[a]&127)<<21,e[a++]<128)||(r+=(e[a]&127)*Math.pow(2,28),++a,e[a++]<128)||(r+=(e[a]&127)*Math.pow(2,35),++a,e[a++]<128)||(r+=(e[a]&127)*Math.pow(2,42),++a,e[a++]<128)))break e;return n&&(n[0]=a),r}function $t(e){var n=new Uint8Array(7);n[0]=e&127;var a=1;e:if(e>127){if(n[a-1]|=128,n[a]=e>>7&127,++a,e<=16383||(n[a-1]|=128,n[a]=e>>14&127,++a,e<=2097151)||(n[a-1]|=128,n[a]=e>>21&127,++a,e<=268435455)||(n[a-1]|=128,n[a]=e/256>>>21&127,++a,e<=34359738367)||(n[a-1]|=128,n[a]=e/65536>>>21&127,++a,e<=4398046511103))break e;n[a-1]|=128,n[a]=e/16777216>>>21&127,++a}return n.slice(0,a)}function kn(e){var n=0,a=e[n]&127;e:if(e[n++]>=128){if(a|=(e[n]&127)<<7,e[n++]<128||(a|=(e[n]&127)<<14,e[n++]<128)||(a|=(e[n]&127)<<21,e[n++]<128))break e;a|=(e[n]&127)<<28}return a}function Ot(e){for(var n=[],a=[0];a[0]<e.length;){var r=a[0],s=cu(e,a),l=s&7;s=Math.floor(s/8);var o=0,d;if(s==0)break;switch(l){case 0:{for(var u=a[0];e[a[0]++]>=128;);d=e.slice(u,a[0])}break;case 5:o=4,d=e.slice(a[0],a[0]+o),a[0]+=o;break;case 1:o=8,d=e.slice(a[0],a[0]+o),a[0]+=o;break;case 2:o=cu(e,a),d=e.slice(a[0],a[0]+o),a[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(s," at offset ").concat(r))}var x={data:d,type:l};n[s]==null?n[s]=[x]:n[s].push(x)}return n}function ca(e){var n=[];return e.forEach(function(a,r){a.forEach(function(s){s.data&&(n.push($t(r*8+s.type)),s.type==2&&n.push($t(s.data.length)),n.push(s.data))})}),cl(n)}function ey(e,n){return(e==null?void 0:e.map(function(a){return n(a.data)}))||[]}function Dr(e){for(var n,a=[],r=[0];r[0]<e.length;){var s=cu(e,r),l=Ot(e.slice(r[0],r[0]+s));r[0]+=s;var o={id:kn(l[1][0].data),messages:[]};l[2].forEach(function(d){var u=Ot(d.data),x=kn(u[3][0].data);o.messages.push({meta:u,data:e.slice(r[0],r[0]+x)}),r[0]+=x}),(n=l[3])!=null&&n[0]&&(o.merge=kn(l[3][0].data)>>>0>0),a.push(o)}return a}function ec(e){var n=[];return e.forEach(function(a){var r=[];r[1]=[{data:$t(a.id),type:0}],r[2]=[],a.merge!=null&&(r[3]=[{data:$t(+!!a.merge),type:0}]);var s=[];a.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:$t(o.data.length)}],r[2].push({data:ca(o.meta),type:2})});var l=ca(r);n.push($t(l.length)),n.push(l),s.forEach(function(o){return n.push(o)})}),cl(n)}function yH(e,n){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var a=[0],r=cu(n,a),s=[];a[0]<n.length;){var l=n[a[0]]&3;if(l==0){var o=n[a[0]++]>>2;if(o<60)++o;else{var d=o-59;o=n[a[0]],d>1&&(o|=n[a[0]+1]<<8),d>2&&(o|=n[a[0]+2]<<16),d>3&&(o|=n[a[0]+3]<<24),o>>>=0,o++,a[0]+=d}s.push(n.slice(a[0],a[0]+o)),a[0]+=o;continue}else{var u=0,x=0;if(l==1?(x=(n[a[0]]>>2&7)+4,u=(n[a[0]++]&224)<<3,u|=n[a[0]++]):(x=(n[a[0]++]>>2)+1,l==2?(u=n[a[0]]|n[a[0]+1]<<8,a[0]+=2):(u=(n[a[0]]|n[a[0]+1]<<8|n[a[0]+2]<<16|n[a[0]+3]<<24)>>>0,a[0]+=4)),s=[cl(s)],u==0)throw new Error("Invalid offset 0");if(u>s[0].length)throw new Error("Invalid offset beyond length");if(x>=u)for(s.push(s[0].slice(-u)),x-=u;x>=s[s.length-1].length;)s.push(s[s.length-1]),x-=s[s.length-1].length;s.push(s[0].slice(-u,-u+x))}}var m=cl(s);if(m.length!=r)throw new Error("Unexpected length: ".concat(m.length," != ").concat(r));return m}function Ar(e){for(var n=[],a=0;a<e.length;){var r=e[a++],s=e[a]|e[a+1]<<8|e[a+2]<<16;a+=3,n.push(yH(r,e.slice(a,a+s))),a+=s}if(a!==e.length)throw new Error("data is not a valid framed stream!");return cl(n)}function tc(e){for(var n=[],a=0;a<e.length;){var r=Math.min(e.length-a,268435455),s=new Uint8Array(4);n.push(s);var l=$t(r),o=l.length;n.push(l),r<=60?(o++,n.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,n.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,n.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,n.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,n.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),n.push(e.slice(a,a+r)),o+=r,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,a+=r}return cl(n)}function vH(e,n,a,r){var s=xo(e),l=s.getUint32(4,!0),o=(r>1?12:8)+h2(l&(r>1?3470:398))*4,d=-1,u=-1,x=NaN,m=new Date(2001,0,1);l&512&&(d=s.getUint32(o,!0),o+=4),o+=h2(l&(r>1?12288:4096))*4,l&16&&(u=s.getUint32(o,!0),o+=4),l&32&&(x=s.getFloat64(o,!0),o+=8),l&64&&(m.setTime(m.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:x};break;case 3:f={t:"s",v:n[u]};break;case 5:f={t:"d",v:m};break;case 6:f={t:"b",v:x>0};break;case 7:f={t:"n",v:x/86400};break;case 8:f={t:"e",v:0};break;case 9:if(d>-1)f={t:"s",v:a[d]};else if(u>-1)f={t:"s",v:n[u]};else if(!isNaN(x))f={t:"n",v:x};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function bH(e,n,a){var r=xo(e),s=r.getUint32(8,!0),l=12,o=-1,d=-1,u=NaN,x=NaN,m=new Date(2001,0,1);s&1&&(u=pH(e,l),l+=16),s&2&&(x=r.getFloat64(l,!0),l+=8),s&4&&(m.setTime(m.getTime()+r.getFloat64(l,!0)*1e3),l+=8),s&8&&(d=r.getUint32(l,!0),l+=4),s&16&&(o=r.getUint32(l,!0),l+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:n[d]};break;case 5:f={t:"d",v:m};break;case 6:f={t:"b",v:x>0};break;case 7:f={t:"n",v:x/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:a[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function Mf(e,n){var a=new Uint8Array(32),r=xo(a),s=12,l=0;switch(a[0]=5,e.t){case"n":a[1]=2,gH(a,s,e.v),l|=1,s+=16;break;case"b":a[1]=6,r.setFloat64(s,e.v?1:0,!0),l|=2,s+=8;break;case"s":if(n.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));a[1]=3,r.setUint32(s,n.indexOf(e.v),!0),l|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,l,!0),a.slice(0,s)}function Rf(e,n){var a=new Uint8Array(32),r=xo(a),s=12,l=0;switch(a[0]=3,e.t){case"n":a[2]=2,r.setFloat64(s,e.v,!0),l|=32,s+=8;break;case"b":a[2]=6,r.setFloat64(s,e.v?1:0,!0),l|=32,s+=8;break;case"s":if(n.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));a[2]=3,r.setUint32(s,n.indexOf(e.v),!0),l|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,l,!0),a.slice(0,s)}function NH(e,n,a){switch(e[0]){case 0:case 1:case 2:case 3:return vH(e,n,a,e[0]);case 5:return bH(e,n,a);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Na(e){var n=Ot(e);return cu(n[1][0].data)}function x2(e,n){var a=Ot(n.data),r=kn(a[1][0].data),s=a[3],l=[];return(s||[]).forEach(function(o){var d=Ot(o.data),u=kn(d[1][0].data)>>>0;switch(r){case 1:l[u]=Rp(d[3][0].data);break;case 8:{var x=e[Na(d[9][0].data)][0],m=Ot(x.data),f=e[Na(m[1][0].data)][0],p=kn(f.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var N=Ot(f.data);l[u]=N[3].map(function(y){return Rp(y.data)}).join("")}break}}),l}function jH(e,n){var a,r,s,l,o,d,u,x,m,f,p,N,y,g,b=Ot(e),j=kn(b[1][0].data)>>>0,T=kn(b[2][0].data)>>>0,S=((r=(a=b[8])==null?void 0:a[0])==null?void 0:r.data)&&kn(b[8][0].data)>0||!1,w,_;if((l=(s=b[7])==null?void 0:s[0])!=null&&l.data&&n!=0)w=(d=(o=b[7])==null?void 0:o[0])==null?void 0:d.data,_=(x=(u=b[6])==null?void 0:u[0])==null?void 0:x.data;else if((f=(m=b[4])==null?void 0:m[0])!=null&&f.data&&n!=1)w=(N=(p=b[4])==null?void 0:p[0])==null?void 0:N.data,_=(g=(y=b[3])==null?void 0:y[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var E=S?4:1,C=xo(w),P=[],F=0;F<w.length/2;++F){var R=C.getUint16(F*2,!0);R<65535&&P.push([F,R])}if(P.length!=T)throw"Expected ".concat(T," cells, found ").concat(P.length);var O=[];for(F=0;F<P.length-1;++F)O[P[F][0]]=_.subarray(P[F][1]*E,P[F+1][1]*E);return P.length>=1&&(O[P[P.length-1][0]]=_.subarray(P[P.length-1][1]*E)),{R:j,cells:O}}function wH(e,n){var a,r=Ot(n.data),s=(a=r==null?void 0:r[7])!=null&&a[0]?kn(r[7][0].data)>>>0>0?1:0:-1,l=ey(r[5],function(o){return jH(o,s)});return{nrows:kn(r[4][0].data)>>>0,data:l.reduce(function(o,d){return o[d.R]||(o[d.R]=[]),d.cells.forEach(function(u,x){if(o[d.R][x])throw new Error("Duplicate cell r=".concat(d.R," c=").concat(x));o[d.R][x]=u}),o},[])}}function kH(e,n,a){var r,s=Ot(n.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(kn(s[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(l.e.c=(kn(s[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));a["!ref"]=gt(l);var o=Ot(s[4][0].data),d=x2(e,e[Na(o[4][0].data)][0]),u=(r=o[17])!=null&&r[0]?x2(e,e[Na(o[17][0].data)][0]):[],x=Ot(o[3][0].data),m=0;x[1].forEach(function(f){var p=Ot(f.data),N=e[Na(p[2][0].data)][0],y=kn(N.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var g=wH(e,N);g.data.forEach(function(b,j){b.forEach(function(T,S){var w=dt({r:m+j,c:S}),_=NH(T,d,u);_&&(a[w]=_)})}),m+=g.nrows})}function TH(e,n){var a=Ot(n.data),r={"!ref":"A1"},s=e[Na(a[2][0].data)],l=kn(s[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return kH(e,s[0],r),r}function CH(e,n){var a,r=Ot(n.data),s={name:(a=r[1])!=null&&a[0]?Rp(r[1][0].data):"",sheets:[]},l=ey(r[2],Na);return l.forEach(function(o){e[o].forEach(function(d){var u=kn(d.meta[1][0].data);u==6e3&&s.sheets.push(TH(e,d))})}),s}function SH(e,n){var a=iy(),r=Ot(n.data),s=ey(r[1],Na);if(s.forEach(function(l){e[l].forEach(function(o){var d=kn(o.meta[1][0].data);if(d==2){var u=CH(e,o);u.sheets.forEach(function(x,m){ly(a,x,m==0?u.name:u.name+"_"+m,!0)})}})}),a.SheetNames.length==0)throw new Error("Empty NUMBERS file");return a}function Bf(e){var n,a,r,s,l={},o=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var x;try{x=Ar(u.content)}catch(f){return console.log("?? "+u.content.length+" "+(f.message||f))}var m;try{m=Dr(x)}catch(f){return console.log("## "+(f.message||f))}m.forEach(function(f){l[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var d=((s=(r=(a=(n=l==null?void 0:l[1])==null?void 0:n[0])==null?void 0:a.meta)==null?void 0:r[1])==null?void 0:s[0].data)&&kn(l[1][0].meta[1][0].data)==1&&l[1][0];if(d||o.forEach(function(u){l[u].forEach(function(x){var m=kn(x.meta[1][0].data)>>>0;if(m==1)if(!d)d=x;else throw new Error("Document has multiple roots")})}),!d)throw new Error("Cannot find Document root");return SH(l,d)}function _H(e,n,a){var r,s,l,o;if(!((r=e[6])!=null&&r[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var d=((o=(l=e[8])==null?void 0:l[0])==null?void 0:o.data)&&kn(e[8][0].data)>0||!1;if(d)throw"Math only works with normal offsets";for(var u=0,x=xo(e[7][0].data),m=0,f=[],p=xo(e[4][0].data),N=0,y=[],g=0;g<n.length;++g){if(n[g]==null){x.setUint16(g*2,65535,!0),p.setUint16(g*2,65535);continue}x.setUint16(g*2,m,!0),p.setUint16(g*2,N,!0);var b,j;switch(typeof n[g]){case"string":b=Mf({t:"s",v:n[g]},a),j=Rf({t:"s",v:n[g]},a);break;case"number":b=Mf({t:"n",v:n[g]},a),j=Rf({t:"n",v:n[g]},a);break;case"boolean":b=Mf({t:"b",v:n[g]},a),j=Rf({t:"b",v:n[g]},a);break;default:throw new Error("Unsupported value "+n[g])}f.push(b),m+=b.length,y.push(j),N+=j.length,++u}for(e[2][0].data=$t(u);g<e[7][0].data.length/2;++g)x.setUint16(g*2,65535,!0),p.setUint16(g*2,65535,!0);return e[6][0].data=cl(f),e[3][0].data=cl(y),u}function EH(e,n){if(!n||!n.numbers)throw new Error("Must pass a `numbers` option -- check the README");var a=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=sr(a["!ref"]);r.s.r=r.s.c=0;var s=!1;r.e.c>9&&(s=!0,r.e.c=9),r.e.r>49&&(s=!0,r.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(gt(r)));var l=V0(a,{range:r,header:1}),o=["~Sh33tJ5~"];l.forEach(function(X){return X.forEach(function(I){typeof I=="string"&&o.push(I)})});var d={},u=[],x=rt.read(n.numbers,{type:"base64"});x.FileIndex.map(function(X,I){return[X,x.FullPaths[I]]}).forEach(function(X){var I=X[0],W=X[1];if(I.type==2&&I.name.match(/\.iwa/)){var z=I.content,xe=Ar(z),H=Dr(xe);H.forEach(function(ne){u.push(ne.id),d[ne.id]={deps:[],location:W,type:kn(ne.messages[0].meta[1][0].data)}})}}),u.sort(function(X,I){return X-I});var m=u.filter(function(X){return X>1}).map(function(X){return[X,$t(X)]});x.FileIndex.map(function(X,I){return[X,x.FullPaths[I]]}).forEach(function(X){var I=X[0];if(X[1],!!I.name.match(/\.iwa/)){var W=Dr(Ar(I.content));W.forEach(function(z){z.messages.forEach(function(xe){m.forEach(function(H){z.messages.some(function(ne){return kn(ne.meta[1][0].data)!=11006&&fH(ne.data,H[1])})&&d[H[0]].deps.push(z.id)})})})}});for(var f=rt.find(x,d[1].location),p=Dr(Ar(f.content)),N,y=0;y<p.length;++y){var g=p[y];g.id==1&&(N=g)}var b=Na(Ot(N.messages[0].data)[1][0].data);for(f=rt.find(x,d[b].location),p=Dr(Ar(f.content)),y=0;y<p.length;++y)g=p[y],g.id==b&&(N=g);for(b=Na(Ot(N.messages[0].data)[2][0].data),f=rt.find(x,d[b].location),p=Dr(Ar(f.content)),y=0;y<p.length;++y)g=p[y],g.id==b&&(N=g);for(b=Na(Ot(N.messages[0].data)[2][0].data),f=rt.find(x,d[b].location),p=Dr(Ar(f.content)),y=0;y<p.length;++y)g=p[y],g.id==b&&(N=g);var j=Ot(N.messages[0].data);{j[6][0].data=$t(r.e.r+1),j[7][0].data=$t(r.e.c+1);var T=Na(j[46][0].data),S=rt.find(x,d[T].location),w=Dr(Ar(S.content));{for(var _=0;_<w.length&&w[_].id!=T;++_);if(w[_].id!=T)throw"Bad ColumnRowUIDMapArchive";var E=Ot(w[_].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var C=0;C<=r.e.c;++C){var P=[];P[1]=P[2]=[{type:0,data:$t(C+420690)}],E[1].push({type:2,data:ca(P)}),E[2].push({type:0,data:$t(C)}),E[3].push({type:0,data:$t(C)})}E[4]=[],E[5]=[],E[6]=[];for(var F=0;F<=r.e.r;++F)P=[],P[1]=P[2]=[{type:0,data:$t(F+726270)}],E[4].push({type:2,data:ca(P)}),E[5].push({type:0,data:$t(F)}),E[6].push({type:0,data:$t(F)});w[_].messages[0].data=ca(E)}S.content=tc(ec(w)),S.size=S.content.length,delete j[46];var R=Ot(j[4][0].data);{R[7][0].data=$t(r.e.r+1);var O=Ot(R[1][0].data),M=Na(O[2][0].data);S=rt.find(x,d[M].location),w=Dr(Ar(S.content));{if(w[0].id!=M)throw"Bad HeaderStorageBucket";var q=Ot(w[0].messages[0].data);for(F=0;F<l.length;++F){var J=Ot(q[2][0].data);J[1][0].data=$t(F),J[4][0].data=$t(l[F].length),q[2][F]={type:q[2][0].type,data:ca(J)}}w[0].messages[0].data=ca(q)}S.content=tc(ec(w)),S.size=S.content.length;var B=Na(R[2][0].data);S=rt.find(x,d[B].location),w=Dr(Ar(S.content));{if(w[0].id!=B)throw"Bad HeaderStorageBucket";for(q=Ot(w[0].messages[0].data),C=0;C<=r.e.c;++C)J=Ot(q[2][0].data),J[1][0].data=$t(C),J[4][0].data=$t(r.e.r+1),q[2][C]={type:q[2][0].type,data:ca(J)};w[0].messages[0].data=ca(q)}S.content=tc(ec(w)),S.size=S.content.length;var ue=Na(R[4][0].data);(function(){for(var X=rt.find(x,d[ue].location),I=Dr(Ar(X.content)),W,z=0;z<I.length;++z){var xe=I[z];xe.id==ue&&(W=xe)}var H=Ot(W.messages[0].data);{H[3]=[];var ne=[];o.forEach(function(V,be){ne[1]=[{type:0,data:$t(be)}],ne[2]=[{type:0,data:$t(1)}],ne[3]=[{type:2,data:mH(V)}],H[3].push({type:2,data:ca(ne)})})}W.messages[0].data=ca(H);var oe=ec(I),Se=tc(oe);X.content=Se,X.size=X.content.length})();var te=Ot(R[3][0].data);{var Z=te[1][0];delete te[2];var Q=Ot(Z.data);{var fe=Na(Q[2][0].data);(function(){for(var X=rt.find(x,d[fe].location),I=Dr(Ar(X.content)),W,z=0;z<I.length;++z){var xe=I[z];xe.id==fe&&(W=xe)}var H=Ot(W.messages[0].data);{delete H[6],delete te[7];var ne=new Uint8Array(H[5][0].data);H[5]=[];for(var oe=0,Se=0;Se<=r.e.r;++Se){var V=Ot(ne);oe+=_H(V,l[Se],o),V[1][0].data=$t(Se),H[5].push({data:ca(V),type:2})}H[1]=[{type:0,data:$t(r.e.c+1)}],H[2]=[{type:0,data:$t(r.e.r+1)}],H[3]=[{type:0,data:$t(oe)}],H[4]=[{type:0,data:$t(r.e.r+1)}]}W.messages[0].data=ca(H);var be=ec(I),Oe=tc(be);X.content=Oe,X.size=X.content.length})()}Z.data=ca(Q)}R[3][0].data=ca(te)}j[4][0].data=ca(R)}N.messages[0].data=ca(j);var K=ec(p),L=tc(K);return f.content=L,f.size=f.content.length,x}function TT(e){return function(a){for(var r=0;r!=e.length;++r){var s=e[r];a[s[0]]===void 0&&(a[s[0]]=s[1]),s[2]==="n"&&(a[s[0]]=Number(a[s[0]]))}}}function ty(e){TT([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function ny(e){TT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function DH(e){return jt.WS.indexOf(e)>-1?"sheet":e==jt.CS?"chart":e==jt.DS?"dialog":e==jt.MS?"macro":e&&e.length?e:"sheet"}function AH(e,n){if(!e)return 0;try{e=n.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,DH(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function FH(e,n,a,r,s,l,o,d,u,x,m,f){try{l[r]=Vd(mr(e,a,!0),n);var p=On(e,n),N;switch(d){case"sheet":N=e9(p,n,s,u,l[r],x,m,f);break;case"chart":if(N=t9(p,n,s,u,l[r],x,m,f),!N||!N["!drawel"])break;var y=Pd(N["!drawel"].Target,n),g=au(y),b=VO(mr(e,y,!0),Vd(mr(e,g,!0),y)),j=Pd(b,y),T=au(j);N=_B(mr(e,j,!0),j,u,Vd(mr(e,T,!0),j),x,N);break;case"macro":N=n9(p,n,s,u,l[r],x,m,f);break;case"dialog":N=a9(p,n,s,u,l[r],x,m,f);break;default:throw new Error("Unrecognized sheet type "+d)}o[r]=N;var S=[];l&&l[r]&&Tn(l[r]).forEach(function(w){var _="";if(l[r][w].Type==jt.CMNT){_=Pd(l[r][w].Target,n);var E=l9(On(e,_,!0),_,u);if(!E||!E.length)return;JN(N,E,!1)}l[r][w].Type==jt.TCMNT&&(_=Pd(l[r][w].Target,n),S=S.concat(KO(On(e,_,!0),u)))}),S&&S.length&&JN(N,S,!0,u.people||[])}catch(w){if(u.WTF)throw w}}function _r(e){return e.charAt(0)=="/"?e.slice(1):e}function CT(e,n){if(Oc(),n=n||{},ty(n),Fr(e,"META-INF/manifest.xml")||Fr(e,"objectdata.xml"))return c2(e,n);if(Fr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Bf<"u"){if(e.FileIndex)return Bf(e);var a=rt.utils.cfb_new();return vN(e).forEach(function(J){yt(a,J,zF(e,J))}),Bf(a)}throw new Error("Unsupported NUMBERS file")}if(!Fr(e,"[Content_Types].xml"))throw Fr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Fr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=vN(e),s=M8(mr(e,"[Content_Types].xml")),l=!1,o,d;if(s.workbooks.length===0&&(d="xl/workbook.xml",On(e,d,!0)&&s.workbooks.push(d)),s.workbooks.length===0){if(d="xl/workbook.bin",!On(e,d,!0))throw new Error("Could not find workbook");s.workbooks.push(d),l=!0}s.workbooks[0].slice(-3)=="bin"&&(l=!0);var u={},x={};if(!n.bookSheets&&!n.bookProps){if(Ud=[],s.sst)try{Ud=i9(On(e,_r(s.sst)),s.sst,n)}catch(J){if(n.WTF)throw J}n.cellStyles&&s.themes.length&&(u=s9(mr(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],n)),s.style&&(x=r9(On(e,_r(s.style)),s.style,u,n))}s.links.map(function(J){try{var B=Vd(mr(e,au(_r(J))),J);return c9(On(e,_r(J)),B,J,n)}catch{}});var m=ZB(On(e,_r(s.workbooks[0])),s.workbooks[0],n),f={},p="";s.coreprops.length&&(p=On(e,_r(s.coreprops[0]),!0),p&&(f=mk(p)),s.extprops.length!==0&&(p=On(e,_r(s.extprops[0]),!0),p&&z8(p,f,n)));var N={};(!n.bookSheets||n.bookProps)&&s.custprops.length!==0&&(p=mr(e,_r(s.custprops[0]),!0),p&&(N=G8(p,n)));var y={};if((n.bookSheets||n.bookProps)&&(m.Sheets?o=m.Sheets.map(function(B){return B.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),n.bookProps&&(y.Props=f,y.Custprops=N),n.bookSheets&&typeof o<"u"&&(y.SheetNames=o),n.bookSheets?y.SheetNames:n.bookProps))return y;o={};var g={};n.bookDeps&&s.calcchain&&(g=o9(On(e,_r(s.calcchain)),s.calcchain));var b=0,j={},T,S;{var w=m.Sheets;f.Worksheets=w.length,f.SheetNames=[];for(var _=0;_!=w.length;++_)f.SheetNames[_]=w[_].name}var E=l?"bin":"xml",C=s.workbooks[0].lastIndexOf("/"),P=(s.workbooks[0].slice(0,C+1)+"_rels/"+s.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");Fr(e,P)||(P="xl/_rels/workbook."+E+".rels");var F=Vd(mr(e,P,!0),P.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(n.xlmeta=d9(On(e,_r(s.metadata[0])),s.metadata[0],n)),(s.people||[]).length>=1&&(n.people=$O(On(e,_r(s.people[0])),n)),F&&(F=AH(F,m.Sheets));var R=On(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=f.Worksheets;++b){var O="sheet";if(F&&F[b]?(T="xl/"+F[b][1].replace(/[\/]?xl\//,""),Fr(e,T)||(T=F[b][1]),Fr(e,T)||(T=P.replace(/_rels\/.*$/,"")+F[b][1]),O=F[b][2]):(T="xl/worksheets/sheet"+(b+1-R)+"."+E,T=T.replace(/sheet0\./,"sheet.")),S=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(b!=n.sheets)continue e;break;case"string":if(f.SheetNames[b].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var M=!1,q=0;q!=n.sheets.length;++q)typeof n.sheets[q]=="number"&&n.sheets[q]==b&&(M=1),typeof n.sheets[q]=="string"&&n.sheets[q].toLowerCase()==f.SheetNames[b].toLowerCase()&&(M=1);if(!M)continue e}}FH(e,T,S,f.SheetNames[b],b,j,o,O,n,m,u,x)}return y={Directory:s,Workbook:m,Props:f,Custprops:N,Deps:g,Sheets:o,SheetNames:f.SheetNames,Strings:Ud,Styles:x,Themes:u,SSF:dn(ct)},n&&n.bookFiles&&(e.files?(y.keys=r,y.files=e.files):(y.keys=[],y.files={},e.FullPaths.forEach(function(J,B){J=J.replace(/^Root Entry[\/]/,""),y.keys.push(J),y.files[J]=e.FileIndex[B]}))),n&&n.bookVBA&&(s.vba.length>0?y.vbaraw=On(e,_r(s.vba[0]),!0):s.defaults&&s.defaults.bin===ZO&&(y.vbaraw=On(e,"xl/vbaProject.bin",!0))),y}function LH(e,n){var a=n||{},r="Workbook",s=rt.find(e,r);try{if(r="/!DataSpaces/Version",s=rt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(dI(s.content),r="/!DataSpaces/DataSpaceMap",s=rt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=hI(s.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=rt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=xI(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=rt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);fI(s.content)}catch{}if(r="/EncryptionInfo",s=rt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var d=pI(s.content);if(r="/EncryptedPackage",s=rt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(d[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(d[1],s.content,a.password||"",a);if(d[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(d[1],s.content,a.password||"",a);throw new Error("File is password-protected")}function PH(e,n){return n.bookType=="ods"?kT(e,n):n.bookType=="numbers"?EH(e,n):n.bookType=="xlsb"?IH(e,n):OH(e,n)}function IH(e,n){sc=1024,e&&!e.SSF&&(e.SSF=dn(ct)),e&&e.SSF&&(Oc(),ox(e.SSF),n.revssf=dx(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Kd?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var a=n.bookType=="xlsb"?"bin":"xml",r=Zk.indexOf(n.bookType)>-1,s=Hg();ny(n=n||{});var l=Cg(),o="",d=0;if(n.cellXfs=[],ml(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",yt(l,o,fk(e.Props,n)),s.coreprops.push(o),Gt(n.rels,2,o,jt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],x=0;x<e.SheetNames.length;++x)(e.Workbook.Sheets[x]||{}).Hidden!=2&&u.push(e.SheetNames[x]);e.Props.SheetNames=u}for(e.Props.Worksheets=e.Props.SheetNames.length,yt(l,o,yk(e.Props)),s.extprops.push(o),Gt(n.rels,3,o,jt.EXT_PROPS),e.Custprops!==e.Props&&Tn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",yt(l,o,vk(e.Custprops)),s.custprops.push(o),Gt(n.rels,4,o,jt.CUST_PROPS)),d=1;d<=e.SheetNames.length;++d){var m={"!id":{}},f=e.Sheets[e.SheetNames[d-1]],p=(f||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+d+"."+a,yt(l,o,h9(d-1,o,n,e,m)),s.sheets.push(o),Gt(n.wbrels,-1,"worksheets/sheet"+d+"."+a,jt.WS[0])}if(f){var N=f["!comments"],y=!1,g="";N&&N.length>0&&(g="xl/comments"+d+"."+a,yt(l,g,f9(N,g)),s.comments.push(g),Gt(m,-1,"../comments"+d+"."+a,jt.CMNT),y=!0),f["!legacy"]&&y&&yt(l,"xl/drawings/vmlDrawing"+d+".vml",Yk(d,f["!comments"])),delete f["!comments"],delete f["!legacy"]}m["!id"].rId1&&yt(l,au(o),lc(m))}return n.Strings!=null&&n.Strings.length>0&&(o="xl/sharedStrings."+a,yt(l,o,m9(n.Strings,o,n)),s.strs.push(o),Gt(n.wbrels,-1,"sharedStrings."+a,jt.SST)),o="xl/workbook."+a,yt(l,o,u9(e,o)),s.workbooks.push(o),Gt(n.rels,1,o,jt.WB),o="xl/theme/theme1.xml",yt(l,o,Gg(e.Themes,n)),s.themes.push(o),Gt(n.wbrels,-1,"theme/theme1.xml",jt.THEME),o="xl/styles."+a,yt(l,o,x9(e,o,n)),s.styles.push(o),Gt(n.wbrels,-1,"styles."+a,jt.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",yt(l,o,e.vbaraw),s.vba.push(o),Gt(n.wbrels,-1,"vbaProject.bin",jt.VBA)),o="xl/metadata."+a,yt(l,o,p9(o)),s.metadata.push(o),Gt(n.wbrels,-1,"metadata."+a,jt.XLMETA),yt(l,"[Content_Types].xml",hk(s,n)),yt(l,"_rels/.rels",lc(n.rels)),yt(l,"xl/_rels/workbook."+a+".rels",lc(n.wbrels)),delete n.revssf,delete n.ssf,l}function OH(e,n){sc=1024,e&&!e.SSF&&(e.SSF=dn(ct)),e&&e.SSF&&(Oc(),ox(e.SSF),n.revssf=dx(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Kd?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var a="xml",r=Zk.indexOf(n.bookType)>-1,s=Hg();ny(n=n||{});var l=Cg(),o="",d=0;if(n.cellXfs=[],ml(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",yt(l,o,fk(e.Props,n)),s.coreprops.push(o),Gt(n.rels,2,o,jt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],x=0;x<e.SheetNames.length;++x)(e.Workbook.Sheets[x]||{}).Hidden!=2&&u.push(e.SheetNames[x]);e.Props.SheetNames=u}e.Props.Worksheets=e.Props.SheetNames.length,yt(l,o,yk(e.Props)),s.extprops.push(o),Gt(n.rels,3,o,jt.EXT_PROPS),e.Custprops!==e.Props&&Tn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",yt(l,o,vk(e.Custprops)),s.custprops.push(o),Gt(n.rels,4,o,jt.CUST_PROPS));var m=["SheetJ5"];for(n.tcid=0,d=1;d<=e.SheetNames.length;++d){var f={"!id":{}},p=e.Sheets[e.SheetNames[d-1]],N=(p||{})["!type"]||"sheet";switch(N){case"chart":default:o="xl/worksheets/sheet"+d+"."+a,yt(l,o,dT(d-1,n,e,f)),s.sheets.push(o),Gt(n.wbrels,-1,"worksheets/sheet"+d+"."+a,jt.WS[0])}if(p){var y=p["!comments"],g=!1,b="";if(y&&y.length>0){var j=!1;y.forEach(function(T){T[1].forEach(function(S){S.T==!0&&(j=!0)})}),j&&(b="xl/threadedComments/threadedComment"+d+"."+a,yt(l,b,zO(y,m,n)),s.threadedcomments.push(b),Gt(f,-1,"../threadedComments/threadedComment"+d+"."+a,jt.TCMNT)),b="xl/comments"+d+"."+a,yt(l,b,Jk(y)),s.comments.push(b),Gt(f,-1,"../comments"+d+"."+a,jt.CMNT),g=!0}p["!legacy"]&&g&&yt(l,"xl/drawings/vmlDrawing"+d+".vml",Yk(d,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&yt(l,au(o),lc(f))}return n.Strings!=null&&n.Strings.length>0&&(o="xl/sharedStrings."+a,yt(l,o,Bk(n.Strings,n)),s.strs.push(o),Gt(n.wbrels,-1,"sharedStrings."+a,jt.SST)),o="xl/workbook."+a,yt(l,o,fT(e)),s.workbooks.push(o),Gt(n.rels,1,o,jt.WB),o="xl/theme/theme1.xml",yt(l,o,Gg(e.Themes,n)),s.themes.push(o),Gt(n.wbrels,-1,"theme/theme1.xml",jt.THEME),o="xl/styles."+a,yt(l,o,qk(e,n)),s.styles.push(o),Gt(n.wbrels,-1,"styles."+a,jt.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",yt(l,o,e.vbaraw),s.vba.push(o),Gt(n.wbrels,-1,"vbaProject.bin",jt.VBA)),o="xl/metadata."+a,yt(l,o,Qk()),s.metadata.push(o),Gt(n.wbrels,-1,"metadata."+a,jt.XLMETA),m.length>1&&(o="xl/persons/person.xml",yt(l,o,GO(m)),s.people.push(o),Gt(n.wbrels,-1,"persons/person.xml",jt.PEOPLE)),yt(l,"[Content_Types].xml",hk(s,n)),yt(l,"_rels/.rels",lc(n.rels)),yt(l,"xl/_rels/workbook."+a+".rels",lc(n.wbrels)),delete n.revssf,delete n.ssf,l}function ay(e,n){var a="";switch((n||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":a=vr(e.slice(0,12));break;case"binary":a=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3),a.charCodeAt(4),a.charCodeAt(5),a.charCodeAt(6),a.charCodeAt(7)]}function MH(e,n){return rt.find(e,"EncryptedPackage")?LH(e,n):Zg(e,n)}function RH(e,n){var a,r=e,s=n||{};return s.type||(s.type=bt&&Buffer.isBuffer(e)?"buffer":"base64"),a=Vw(r,s),CT(a,s)}function ST(e,n){var a=0;e:for(;a<e.length;)switch(e.charCodeAt(a)){case 10:case 13:case 32:++a;break;case 60:return Op(e.slice(a),n);default:break e}return _c.to_workbook(e,n)}function BH(e,n){var a="",r=ay(e,n);switch(n.type){case"base64":a=vr(e);break;case"binary":a=e;break;case"buffer":a=e.toString("binary");break;case"array":a=oo(e);break;default:throw new Error("Unrecognized type "+n.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(a=Xt(a)),n.type="binary",ST(a,n)}function HH(e,n){var a=e;return n.type=="base64"&&(a=vr(a)),a=Yd.utils.decode(1200,a.slice(2),"str"),n.type="binary",ST(a,n)}function VH(e){return e.match(/[^\x00-\x7F]/)?Cs(e):e}function Hf(e,n,a,r){return r?(a.type="string",_c.to_workbook(e,a)):_c.to_workbook(n,a)}function Bp(e,n){Ng();var a=n||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Bp(new Uint8Array(e),(a=dn(a),a.type="array",a));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!a.type&&(a.type=typeof Deno<"u"?"buffer":"array");var r=e,s=[0,0,0,0],l=!1;if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),cc={},a.dateNF&&(cc.dateNF=a.dateNF),a.type||(a.type=bt&&Buffer.isBuffer(e)?"buffer":"base64"),a.type=="file"&&(a.type=bt?"buffer":"binary",r=OF(e),typeof Uint8Array<"u"&&!bt&&(a.type="array")),a.type=="string"&&(l=!0,a.type="binary",a.codepage=65001,r=VH(e)),a.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),d=new Uint8Array(o);if(d.foo="bar",!d.foo)return a=dn(a),a.type="array",Bp(jg(r),a)}switch((s=ay(r,a))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return MH(rt.read(r,a),a);break;case 9:if(s[1]<=8)return Zg(r,a);break;case 60:return Op(r,a);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return qP(r,a);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return Mk.to_workbook(r,a);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?RH(r,a):Hf(e,r,a,l);case 239:return s[3]===60?Op(r,a):Hf(e,r,a,l);case 255:if(s[1]===254)return HH(r,a);if(s[1]===0&&s[2]===2&&s[3]===0)return to.to_workbook(r,a);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return to.to_workbook(r,a);break;case 3:case 131:case 139:case 140:return Ip.to_workbook(r,a);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return zk.to_workbook(r,a);break;case 10:case 13:case 32:return BH(r,a);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return GP.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Ip.to_workbook(r,a):Hf(e,r,a,l)}function _T(e,n){switch(n.type){case"base64":case"binary":break;case"buffer":case"array":n.type="";break;case"file":return Tu(n.file,rt.write(e,{type:bt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");default:throw new Error("Unrecognized type "+n.type)}return rt.write(e,n)}function UH(e,n){var a=dn(n||{}),r=PH(e,a);return KH(r,a)}function KH(e,n){var a={},r=bt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(n.compression&&(a.compression="DEFLATE"),n.password)a.type=r;else switch(n.type){case"base64":a.type="base64";break;case"binary":a.type="string";break;case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");case"buffer":case"file":a.type=r;break;default:throw new Error("Unrecognized type "+n.type)}var s=e.FullPaths?rt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[a.type]||a.type,compression:!!n.compression}):e.generate(a);if(typeof Deno<"u"&&typeof s=="string"){if(n.type=="binary"||n.type=="base64")return s;s=new Uint8Array(lx(s))}return n.password&&typeof encrypt_agile<"u"?_T(encrypt_agile(s,n.password),n):n.type==="file"?Tu(n.file,s):n.type=="string"?Xt(s):s}function zH(e,n){var a=n||{},r=U9(e,a);return _T(r,a)}function gs(e,n,a){a||(a="");var r=a+e;switch(n.type){case"base64":return Jd(Cs(r));case"binary":return Cs(r);case"string":return e;case"file":return Tu(n.file,r,"utf8");case"buffer":return bt?ui(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):gs(r,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function $H(e,n){switch(n.type){case"base64":return Jd(e);case"binary":return e;case"string":return e;case"file":return Tu(n.file,e,"binary");case"buffer":return bt?ui(e,"binary"):e.split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function i0(e,n){switch(n.type){case"string":case"base64":case"binary":for(var a="",r=0;r<e.length;++r)a+=String.fromCharCode(e[r]);return n.type=="base64"?Jd(a):n.type=="string"?Xt(a):a;case"file":return Tu(n.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+n.type)}}function ry(e,n){Ng(),RB(e);var a=dn(n||{});if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),a.type=="array"){a.type="binary";var r=ry(e,a);return a.type="array",lx(r)}var s=0;if(a.sheet&&(typeof a.sheet=="number"?s=a.sheet:s=e.SheetNames.indexOf(a.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+a.sheet+" : "+typeof a.sheet);switch(a.bookType||"xlsb"){case"xml":case"xlml":return gs(I9(e,a),a);case"slk":case"sylk":return gs(Ok.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"htm":case"html":return gs(bT(e.Sheets[e.SheetNames[s]],a),a);case"txt":return $H(ET(e.Sheets[e.SheetNames[s]],a),a);case"csv":return gs(sy(e.Sheets[e.SheetNames[s]],a),a,"\uFEFF");case"dif":return gs(Mk.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"dbf":return i0(Ip.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"prn":return gs(_c.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"rtf":return gs(zk.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"eth":return gs(Rk.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"fods":return gs(kT(e,a),a);case"wk1":return i0(to.sheet_to_wk1(e.Sheets[e.SheetNames[s]],a),a);case"wk3":return i0(to.book_to_wk3(e,a),a);case"biff2":a.biff||(a.biff=2);case"biff3":a.biff||(a.biff=3);case"biff4":return a.biff||(a.biff=4),i0(vT(e,a),a);case"biff5":a.biff||(a.biff=5);case"biff8":case"xla":case"xls":return a.biff||(a.biff=8),zH(e,a);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return UH(e,a);default:throw new Error("Unrecognized bookType |"+a.bookType+"|")}}function GH(e){if(!e.bookType){var n={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},a=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();a.match(/^\.[a-z]+$/)&&(e.bookType=a.slice(1)),e.bookType=n[e.bookType]||e.bookType}}function H0(e,n,a){var r={};return r.type="file",r.file=n,GH(r),ry(e,r)}function qH(e,n,a,r,s,l,o,d){var u=Fn(a),x=d.defval,m=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),f=!0,p=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:a,enumerable:!1})}catch{p.__rowNum__=a}else p.__rowNum__=a;if(!o||e[a])for(var N=n.s.c;N<=n.e.c;++N){var y=o?e[a][N]:e[r[N]+u];if(y===void 0||y.t===void 0){if(x===void 0)continue;l[N]!=null&&(p[l[N]]=x);continue}var g=y.v;switch(y.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(l[N]!=null){if(g==null)if(y.t=="e"&&g===null)p[l[N]]=null;else if(x!==void 0)p[l[N]]=x;else if(m&&g===null)p[l[N]]=null;else continue;else p[l[N]]=m&&(y.t!=="n"||y.t==="n"&&d.rawNumbers!==!1)?g:ci(y,g,d);g!=null&&(f=!1)}}return{row:p,isempty:f}}function V0(e,n){if(e==null||e["!ref"]==null)return[];var a={t:"n",v:0},r=0,s=1,l=[],o=0,d="",u={s:{r:0,c:0},e:{r:0,c:0}},x=n||{},m=x.range!=null?x.range:e["!ref"];switch(x.header===1?r=1:x.header==="A"?r=2:Array.isArray(x.header)?r=3:x.header==null&&(r=0),typeof m){case"string":u=Pt(m);break;case"number":u=Pt(e["!ref"]),u.s.r=m;break;default:u=m}r>0&&(s=0);var f=Fn(u.s.r),p=[],N=[],y=0,g=0,b=Array.isArray(e),j=u.s.r,T=0,S={};b&&!e[j]&&(e[j]=[]);var w=x.skipHidden&&e["!cols"]||[],_=x.skipHidden&&e["!rows"]||[];for(T=u.s.c;T<=u.e.c;++T)if(!(w[T]||{}).hidden)switch(p[T]=vn(T),a=b?e[j][T]:e[p[T]+f],r){case 1:l[T]=T-u.s.c;break;case 2:l[T]=p[T];break;case 3:l[T]=x.header[T-u.s.c];break;default:if(a==null&&(a={w:"__EMPTY",t:"s"}),d=o=ci(a,null,x),g=S[o]||0,!g)S[o]=1;else{do d=o+"_"+g++;while(S[d]);S[o]=g,S[d]=1}l[T]=d}for(j=u.s.r+s;j<=u.e.r;++j)if(!(_[j]||{}).hidden){var E=qH(e,u,j,p,r,l,b,x);(E.isempty===!1||(r===1?x.blankrows!==!1:x.blankrows))&&(N[y++]=E.row)}return N.length=y,N}var m2=/"/g;function WH(e,n,a,r,s,l,o,d){for(var u=!0,x=[],m="",f=Fn(a),p=n.s.c;p<=n.e.c;++p)if(r[p]){var N=d.dense?(e[a]||[])[p]:e[r[p]+f];if(N==null)m="";else if(N.v!=null){u=!1,m=""+(d.rawNumbers&&N.t=="n"?N.v:ci(N,null,d));for(var y=0,g=0;y!==m.length;++y)if((g=m.charCodeAt(y))===s||g===l||g===34||d.forceQuotes){m='"'+m.replace(m2,'""')+'"';break}m=="ID"&&(m='"ID"')}else N.f!=null&&!N.F?(u=!1,m="="+N.f,m.indexOf(",")>=0&&(m='"'+m.replace(m2,'""')+'"')):m="";x.push(m)}return d.blankrows===!1&&u?null:x.join(o)}function sy(e,n){var a=[],r=n??{};if(e==null||e["!ref"]==null)return"";var s=Pt(e["!ref"]),l=r.FS!==void 0?r.FS:",",o=l.charCodeAt(0),d=r.RS!==void 0?r.RS:`
`,u=d.charCodeAt(0),x=new RegExp((l=="|"?"\\|":l)+"+$"),m="",f=[];r.dense=Array.isArray(e);for(var p=r.skipHidden&&e["!cols"]||[],N=r.skipHidden&&e["!rows"]||[],y=s.s.c;y<=s.e.c;++y)(p[y]||{}).hidden||(f[y]=vn(y));for(var g=0,b=s.s.r;b<=s.e.r;++b)(N[b]||{}).hidden||(m=WH(e,s,b,f,o,u,l,r),m!=null&&(r.strip&&(m=m.replace(x,"")),(m||r.blankrows!==!1)&&a.push((g++?d:"")+m)));return delete r.dense,a.join("")}function ET(e,n){n||(n={}),n.FS="	",n.RS=`
`;var a=sy(e,n);return a}function XH(e){var n="",a,r="";if(e==null||e["!ref"]==null)return[];var s=Pt(e["!ref"]),l="",o=[],d,u=[],x=Array.isArray(e);for(d=s.s.c;d<=s.e.c;++d)o[d]=vn(d);for(var m=s.s.r;m<=s.e.r;++m)for(l=Fn(m),d=s.s.c;d<=s.e.c;++d)if(n=o[d]+l,a=x?(e[m]||[])[d]:e[n],r="",a!==void 0){if(a.F!=null){if(n=a.F,!a.f)continue;r=a.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(a.f!=null)r=a.f;else{if(a.t=="z")continue;if(a.t=="n"&&a.v!=null)r=""+a.v;else if(a.t=="b")r=a.v?"TRUE":"FALSE";else if(a.w!==void 0)r="'"+a.w;else{if(a.v===void 0)continue;a.t=="s"?r="'"+a.v:r=""+a.v}}u[u.length]=n+"="+r}return u}function DT(e,n,a){var r=a||{},s=+!r.skipHeader,l=e||{},o=0,d=0;if(l&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var u=typeof r.origin=="string"?bn(r.origin):r.origin;o=u.r,d=u.c}var x,m={s:{c:0,r:0},e:{c:d,r:o+n.length-1+s}};if(l["!ref"]){var f=Pt(l["!ref"]);m.e.c=Math.max(m.e.c,f.e.c),m.e.r=Math.max(m.e.r,f.e.r),o==-1&&(o=f.e.r+1,m.e.r=o+n.length-1+s)}else o==-1&&(o=0,m.e.r=n.length-1+s);var p=r.header||[],N=0;n.forEach(function(g,b){Tn(g).forEach(function(j){(N=p.indexOf(j))==-1&&(p[N=p.length]=j);var T=g[j],S="z",w="",_=dt({c:d+N,r:o+b+s});x=du(l,_),T&&typeof T=="object"&&!(T instanceof Date)?l[_]=T:(typeof T=="number"?S="n":typeof T=="boolean"?S="b":typeof T=="string"?S="s":T instanceof Date?(S="d",r.cellDates||(S="n",T=Wn(T)),w=r.dateNF||ct[14]):T===null&&r.nullError&&(S="e",T=0),x?(x.t=S,x.v=T,delete x.w,delete x.R,w&&(x.z=w)):l[_]=x={t:S,v:T},w&&(x.z=w))})}),m.e.c=Math.max(m.e.c,d+p.length-1);var y=Fn(o);if(s)for(N=0;N<p.length;++N)l[vn(N+d)+y]={t:"s",v:p[N]};return l["!ref"]=gt(m),l}function QH(e,n){return DT(null,e,n)}function du(e,n,a){if(typeof n=="string"){if(Array.isArray(e)){var r=bn(n);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[n]||(e[n]={t:"z"})}return typeof n!="number"?du(e,dt(n)):du(e,dt({r:n,c:a||0}))}function YH(e,n){if(typeof n=="number"){if(n>=0&&e.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var a=e.SheetNames.indexOf(n);if(a>-1)return a;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function iy(){return{SheetNames:[],Sheets:{}}}function ly(e,n,a,r){var s=1;if(!a)for(;s<=65535&&e.SheetNames.indexOf(a="Sheet"+s)!=-1;++s,a=void 0);if(!a||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(a)>=0){var l=a.match(/(^.*?)(\d+)$/);s=l&&+l[2]||0;var o=l&&l[1]||a;for(++s;s<=65535&&e.SheetNames.indexOf(a=o+s)!=-1;++s);}if(mT(a),e.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");return e.SheetNames.push(a),e.Sheets[a]=n,a}function JH(e,n,a){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=YH(e,n);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}e.Workbook.Sheets[r].Hidden=a}function ZH(e,n){return e.z=n,e}function AT(e,n,a){return n?(e.l={Target:n},a&&(e.l.Tooltip=a)):delete e.l,e}function eV(e,n,a){return AT(e,"#"+n,a)}function tV(e,n,a){e.c||(e.c=[]),e.c.push({t:n,a:a||"SheetJS"})}function nV(e,n,a,r){for(var s=typeof n!="string"?n:Pt(n),l=typeof n=="string"?n:gt(n),o=s.s.r;o<=s.e.r;++o)for(var d=s.s.c;d<=s.e.c;++d){var u=du(e,o,d);u.t="n",u.F=l,delete u.v,o==s.s.r&&d==s.s.c&&(u.f=a,r&&(u.D=!0))}return e}var Jr={encode_col:vn,encode_row:Fn,encode_cell:dt,encode_range:gt,decode_col:Pg,decode_row:Lg,split_cell:m8,decode_cell:bn,decode_range:sr,format_cell:ci,sheet_add_aoa:sk,sheet_add_json:DT,sheet_add_dom:NT,aoa_to_sheet:Mc,json_to_sheet:QH,table_to_sheet:jT,table_to_book:dH,sheet_to_csv:sy,sheet_to_txt:ET,sheet_to_json:V0,sheet_to_html:bT,sheet_to_formulae:XH,sheet_to_row_object_array:V0,sheet_get_cell:du,book_new:iy,book_append_sheet:ly,book_set_sheet_visibility:JH,cell_set_number_format:ZH,cell_set_hyperlink:AT,cell_set_internal_link:eV,cell_add_comment:tV,sheet_set_array_formula:nV,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const FT=Object.freeze(Object.defineProperty({__proto__:null,CFB:rt,parse_xlscfb:Zg,parse_zip:CT,read:Bp,utils:Jr,write:ry,writeFile:H0,writeFileSync:H0},Symbol.toStringTag,{value:"Module"})),aV="modulepreload",rV=function(e){return"/"+e},f2={},LT=function(n,a,r){let s=Promise.resolve();if(a&&a.length>0){let o=function(x){return Promise.all(x.map(m=>Promise.resolve(m).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),u=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));s=o(a.map(x=>{if(x=rV(x),x in f2)return;f2[x]=!0;const m=x.endsWith(".css"),f=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${f}`))return;const p=document.createElement("link");if(p.rel=m?"stylesheet":aV,m||(p.as="script"),p.crossOrigin="",p.href=x,u&&p.setAttribute("nonce",u),document.head.appendChild(p),m)return new Promise((N,y)=>{p.addEventListener("load",N),p.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${x}`)))})}))}function l(o){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=o,window.dispatchEvent(d),!d.defaultPrevented)throw o}return s.then(o=>{for(const d of o||[])d.status==="rejected"&&l(d.reason);return n().catch(l)})},sV=async(e,n,a)=>(await he.post("/san-luong/chia-hang/preview",{rows:e,thang:n,nam:a})).data,iV=async(e,n,a)=>(await he.post("/san-luong/chia-hang/confirm",{rows:e,tenFile:n,fileHash:a})).data,lV=async(e,n,a)=>(await he.post("/san-luong/giao-hang/preview",{rows:e,thang:n,nam:a})).data,oV=async(e,n,a)=>(await he.post("/san-luong/giao-hang/confirm",{rows:e,tenFile:n,fileHash:a})).data,cV=async e=>{const n=await he.get("/san-luong/lich-su-import",{params:{loaiImport:e.loaiImport,tuNgay:e.tuNgay,denNgay:e.denNgay}}),a=Array.isArray(n.data)?n.data:[];let r=a;e.trangThai&&(r=a.filter(u=>u.trangThai===e.trangThai));const s=e.page||1,l=e.limit||20,o=(s-1)*l,d=o+l;return{items:r.slice(o,d),total:r.length}},dV=async e=>{const{read:n,utils:a}=await LT(async()=>{const{read:d,utils:u}=await Promise.resolve().then(()=>FT);return{read:d,utils:u}},void 0),r=await e.arrayBuffer(),s=n(r,{type:"array"}),l=s.Sheets[s.SheetNames[0]];return a.sheet_to_json(l).map(d=>({maNhanVien:String(d["M NV"]||d.MaNhanVien||d.maNhanVien||""),ngay:PT(d.Ngy||d.ngay),sanPhamDat:Number(d["SP t"]||d.sanPhamDat||0),sanPhamLoi:Number(d["SP Li"]||d.sanPhamLoi||0),tongSanPham:Number(d["Tng SP"]||d.tongSanPham||0)}))},uV=async e=>{const{read:n,utils:a}=await LT(async()=>{const{read:d,utils:u}=await Promise.resolve().then(()=>FT);return{read:d,utils:u}},void 0),r=await e.arrayBuffer(),s=n(r,{type:"array"}),l=s.Sheets[s.SheetNames[0]];return a.sheet_to_json(l).map(d=>({maNhanVien:String(d["M NV"]||d.MaNhanVien||d.maNhanVien||""),ngay:PT(d.Ngy||d.ngay),khoiLuong:Number(d["Khi lng"]||d.khoiLuong||0),donGia:Number(d["n gi"]||d.donGia||0),phatTre:Number(d["Pht tr"]||d.phatTre||0),phatKhongLayPhieu:Number(d["Pht KL phiu"]||d.phatKhongLayPhieu||0)}))};function PT(e){if(!e)return"";if(typeof e=="number")return new Date((e-25569)*86400*1e3).toISOString().split("T")[0];if(typeof e=="string"){const n=e.split("/");if(n.length===3){const[a,r,s]=n;return`${s}-${r.padStart(2,"0")}-${a.padStart(2,"0")}`}if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e}return String(e)}const IT=async e=>{const n=await e.arrayBuffer(),a=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(a)).map(s=>s.toString(16).padStart(2,"0")).join("")},hV=()=>{const[e,n]=D.useState(null),[a,r]=D.useState([]),[s,l]=D.useState(null),[o,d]=D.useState(!1),[u,x]=D.useState(!1),[m,f]=D.useState(new Date().getMonth()+1),[p,N]=D.useState(new Date().getFullYear()),[y,g]=D.useState(null),[b,j]=D.useState(!1);D.useEffect(()=>{Jt.layTatCa().then(R=>{const O=R.find(M=>(M.trangThai==="ACTIVE"||M.trangThai==="HOAT_DONG")&&(M.tenPhongBan.toLowerCase().includes("chia hng")||M.tenPhongBan.toLowerCase().includes("chia hang")||M.loaiPhongBan==="CHIA_HANG"));O&&g(O)})},[]);const T=async()=>{if(!y){xt.error("Khng tm thy b phn Chia Hng trong h thng");return}j(!0);try{const R=await ha.layTatCa({phongBanId:y.id,trangThai:"DANG_LAM"}),O=Array.isArray(R)?R:R.data||[];if(O.length===0){xt.error("Phng ban ny khng c nhn vin ang lm vic");return}const M=[];O.forEach(Z=>{M.push({"M NV":Z.maNhanVien,"Tn NV":Z.hoTen,Ngy:`01/${String(m).padStart(2,"0")}/${p}`,"SP t":"","SP Li":"","Tng SP":""})});const q=Jr.json_to_sheet(M);q["!cols"]=[{wch:12},{wch:25},{wch:12},{wch:10},{wch:10},{wch:10}];const J=Jr.book_new();Jr.book_append_sheet(J,q,"Chia Hng");const B=[{Ct:"M NV","M t":"M nhn vin (bt buc)","V d":"NV001"},{Ct:"Tn NV","M t":"Tn nhn vin (ch  tham kho)","V d":"Nguyn Vn A"},{Ct:"Ngy","M t":"Ngy lm vic (dd/MM/yyyy)","V d":"01/01/2026"},{Ct:"SP t","M t":"S sn phm t chun","V d":"100"},{Ct:"SP Li","M t":"S sn phm li","V d":"2"},{Ct:"Tng SP","M t":"Tng sn phm","V d":"102"},{Ct:"","M t":"","V d":""},{Ct:"Lu ","M t":"C th thm nhiu dng cho cc ngy khc nhau","V d":""},{Ct:"Cng thc","M t":"Quy i SP = SP t - (SP Li  5)","V d":""},{Ct:"","M t":"Tin sn lng = Quy i SP  320","V d":""}],ue=Jr.json_to_sheet(B);ue["!cols"]=[{wch:12},{wch:45},{wch:15}],Jr.book_append_sheet(J,ue,"Hng dn");const te=y.tenPhongBan.replace(/[\/:*?"<>|]/g,"");H0(J,`Template_ChiaHang_${te}_T${m}_${p}.xlsx`),xt.success(` ti template vi ${O.length} nhn vin`)}catch(R){console.error(R),xt.error("Li khi ti template")}finally{j(!1)}},S=D.useCallback(async R=>{const O=R[0];if(O){n(O),d(!0),l(null);try{const M=await dV(O);r(M),xt.success(` c ${M.length} dng t file`)}catch(M){xt.error("Li c file Excel"),console.error(M)}finally{d(!1)}}},[]),{getRootProps:w,getInputProps:_,isDragActive:E}=yg({onDrop:S,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"]},multiple:!1}),C=async()=>{var R,O;if(a.length===0){xt.error("Cha c d liu  preview");return}d(!0);try{const M=await sV(a,m,p);l(M),M.tongKhongHopLe>0?xt.error(`C ${M.tongKhongHopLe} dng khng hp l`):xt.success(`${M.tongHopLe} dng hp l, sn sng import`)}catch(M){const q=M;xt.error(((O=(R=q.response)==null?void 0:R.data)==null?void 0:O.message)||"Li preview")}finally{d(!1)}},P=async()=>{var R,O;if(!(!s||!e)){if(s.hopLe.length===0){xt.error("Khng c d liu hp l  import");return}x(!0);try{const M=await IT(e),q=await iV(s.hopLe,e.name,M);xt.success(`Import thnh cng! Thm mi: ${q.inserted}, Cp nht: ${q.updated}`),n(null),r([]),l(null)}catch(M){const q=M;xt.error(((O=(R=q.response)==null?void 0:R.data)==null?void 0:O.message)||"Li import")}finally{x(!1)}}},F=()=>{n(null),r([]),l(null)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Import Sn Lng Chia Hng"}),t.jsx("div",{className:"flex gap-2",children:(e||a.length>0)&&t.jsx("button",{onClick:F,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Reset"})})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"B phn:"}),t.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:(y==null?void 0:y.tenPhongBan)||"ang ti..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thng"}),t.jsx("select",{value:m,onChange:R=>f(Number(R.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:12},(R,O)=>t.jsxs("option",{value:O+1,children:["Thng ",O+1]},O+1))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nm"}),t.jsx("select",{value:p,onChange:R=>N(Number(R.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:5},(R,O)=>new Date().getFullYear()-2+O).map(R=>t.jsx("option",{value:R,children:R},R))})]}),t.jsx("button",{onClick:T,disabled:b||!y,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:b?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang ti..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Ti Template"]})})]}),t.jsxs("div",{...w(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${E?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,children:[t.jsx("input",{..._()}),t.jsxs("div",{className:"text-gray-600",children:[t.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),E?t.jsx("p",{className:"text-blue-600",children:"Th file vo y..."}):t.jsxs(t.Fragment,{children:[t.jsx("p",{children:"Ko th file Excel vo y, hoc click  chn file"}),t.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"H tr: .xlsx, .xls"})]})]})]}),e&&t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsxs("p",{className:"text-blue-800",children:[t.jsx("strong",{children:"File:"})," ",e.name," (",(e.size/1024).toFixed(1)," KB)"]}),t.jsxs("p",{className:"text-blue-600 text-sm mt-1",children:[" c ",a.length," dng d liu"]})]}),a.length>0&&!s&&t.jsx("button",{onClick:C,disabled:o,className:"w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2",children:o?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang x l..."]}):"Preview d liu"}),s&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[t.jsx("p",{className:"text-green-800 font-semibold text-lg",children:s.tongHopLe}),t.jsx("p",{className:"text-green-600 text-sm",children:"Dng hp l"})]}),t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[t.jsx("p",{className:"text-red-800 font-semibold text-lg",children:s.tongKhongHopLe}),t.jsx("p",{className:"text-red-600 text-sm",children:"Dng khng hp l"})]})]}),s.hopLe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-green-50 border-b border-green-200",children:t.jsxs("h3",{className:"font-semibold text-green-800",children:["D liu hp l (",s.hopLe.length,")"]})}),t.jsxs("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:[t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"SP t"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"SP Li"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Tng SP"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:s.hopLe.slice(0,100).map((R,O)=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-2 text-sm",children:R.maNhanVien}),t.jsx("td",{className:"px-4 py-2 text-sm",children:R.ngay}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:R.sanPhamDat}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:R.sanPhamLoi}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:R.tongSanPham})]},O))})]}),s.hopLe.length>100&&t.jsxs("p",{className:"text-center text-gray-500 py-2",children:["... v ",s.hopLe.length-100," dng na"]})]})]}),s.khongHopLe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-red-50 border-b border-red-200",children:t.jsxs("h3",{className:"font-semibold text-red-800",children:["D liu khng hp l (",s.khongHopLe.length,")"]})}),t.jsx("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"L do"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:s.khongHopLe.map((R,O)=>t.jsxs("tr",{className:"bg-red-50",children:[t.jsx("td",{className:"px-4 py-2 text-sm",children:R.row.maNhanVien}),t.jsx("td",{className:"px-4 py-2 text-sm",children:R.row.ngay}),t.jsx("td",{className:"px-4 py-2 text-sm text-red-600",children:R.lyDo})]},O))})]})})]}),s.hopLe.length>0&&t.jsxs("div",{className:"flex gap-4",children:[t.jsx("button",{onClick:C,disabled:o,className:"flex-1 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 disabled:opacity-50",children:"Preview li"}),t.jsx("button",{onClick:P,disabled:u,className:"flex-1 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center justify-center gap-2",children:u?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang import..."]}):`Import ${s.hopLe.length} dng`})]})]}),t.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[t.jsx("h3",{className:"font-semibold text-yellow-800 mb-2",children:"Hng dn"}),t.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1 list-disc list-inside",children:[t.jsx("li",{children:"File Excel cn c cc ct: M NV, Ngy, SP t, SP Li, Tng SP"}),t.jsx("li",{children:"Ngy c th  nh dng dd/MM/yyyy hoc yyyy-MM-dd"}),t.jsx("li",{children:"Nu d liu  tn ti (cng m NV + ngy) s c cp nht"}),t.jsxs("li",{children:["Cng thc: ",t.jsx("strong",{children:"Quy i SP = SP t - (SP Li  5)"}),", ",t.jsx("strong",{children:"Tin = Quy i  320"})]})]})]})]})},xV=()=>{const[e,n]=D.useState(null),[a,r]=D.useState([]),[s,l]=D.useState(null),[o,d]=D.useState(!1),[u,x]=D.useState(!1),[m,f]=D.useState(new Date().getMonth()+1),[p,N]=D.useState(new Date().getFullYear()),[y,g]=D.useState(null),[b,j]=D.useState(!1);D.useEffect(()=>{Jt.layTatCa().then(O=>{const M=O.find(q=>(q.trangThai==="ACTIVE"||q.trangThai==="HOAT_DONG")&&(q.tenPhongBan.toLowerCase().includes("giao hng")||q.tenPhongBan.toLowerCase().includes("giao hang")||q.loaiPhongBan==="GIAO_HANG"));M&&g(M)})},[]);const T=async()=>{if(!y){xt.error("Khng tm thy b phn Giao Hng trong h thng");return}j(!0);try{const O=await ha.layTatCa({phongBanId:y.id,trangThai:"DANG_LAM"}),M=Array.isArray(O)?O:O.data||[];if(M.length===0){xt.error("Phng ban ny khng c nhn vin ang lm vic");return}const q=[];M.forEach(Q=>{q.push({"M NV":Q.maNhanVien,"Tn NV":Q.hoTen,Ngy:`01/${String(m).padStart(2,"0")}/${p}`,"Khi lng":"","n gi":"","Pht tr":0,"Pht KL phiu":0})});const J=Jr.json_to_sheet(q);J["!cols"]=[{wch:12},{wch:25},{wch:12},{wch:12},{wch:12},{wch:12},{wch:15}];const B=Jr.book_new();Jr.book_append_sheet(B,J,"Giao Hng");const ue=[{Ct:"M NV","M t":"M nhn vin (bt buc)","V d":"NV001"},{Ct:"Tn NV","M t":"Tn nhn vin (ch  tham kho)","V d":"Nguyn Vn A"},{Ct:"Ngy","M t":"Ngy lm vic (dd/MM/yyyy)","V d":"01/01/2026"},{Ct:"Khi lng","M t":"Khi lng giao hng (kg)","V d":"50"},{Ct:"n gi","M t":"n gi theo kg (VN)","V d":"5000"},{Ct:"Pht tr","M t":"Tin pht giao tr (VN)","V d":"10000"},{Ct:"Pht KL phiu","M t":"Pht khng ly phiu (VN)","V d":"5000"},{Ct:"","M t":"","V d":""},{Ct:"Lu ","M t":"C th thm nhiu dng cho cc ngy khc nhau","V d":""},{Ct:"Cng thc","M t":"Tin = Khi lng  n gi - Pht tr - Pht KL phiu","V d":""}],te=Jr.json_to_sheet(ue);te["!cols"]=[{wch:15},{wch:50},{wch:15}],Jr.book_append_sheet(B,te,"Hng dn");const Z=y.tenPhongBan.replace(/[\/:*?"<>|]/g,"");H0(B,`Template_GiaoHang_${Z}_T${m}_${p}.xlsx`),xt.success(` ti template vi ${M.length} nhn vin`)}catch(O){console.error(O),xt.error("Li khi ti template")}finally{j(!1)}},S=D.useCallback(async O=>{const M=O[0];if(M){n(M),d(!0),l(null);try{const q=await uV(M);r(q),xt.success(` c ${q.length} dng t file`)}catch(q){xt.error("Li c file Excel"),console.error(q)}finally{d(!1)}}},[]),{getRootProps:w,getInputProps:_,isDragActive:E}=yg({onDrop:S,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"]},multiple:!1}),C=async()=>{var O,M;if(a.length===0){xt.error("Cha c d liu  preview");return}d(!0);try{const q=await lV(a,m,p);l(q),q.tongKhongHopLe>0?xt.error(`C ${q.tongKhongHopLe} dng khng hp l`):xt.success(`${q.tongHopLe} dng hp l, sn sng import`)}catch(q){const J=q;xt.error(((M=(O=J.response)==null?void 0:O.data)==null?void 0:M.message)||"Li preview")}finally{d(!1)}},P=async()=>{var O,M;if(!(!s||!e)){if(s.hopLe.length===0){xt.error("Khng c d liu hp l  import");return}x(!0);try{const q=await IT(e),J=await oV(s.hopLe,e.name,q);xt.success(`Import thnh cng! Thm mi: ${J.inserted}, Cp nht: ${J.updated}`),n(null),r([]),l(null)}catch(q){const J=q;xt.error(((M=(O=J.response)==null?void 0:O.data)==null?void 0:M.message)||"Li import")}finally{x(!1)}}},F=()=>{n(null),r([]),l(null)},R=O=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(O);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Import Sn Lng Giao Hng"}),t.jsx("div",{className:"flex gap-2",children:(e||a.length>0)&&t.jsx("button",{onClick:F,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Reset"})})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"B phn:"}),t.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:(y==null?void 0:y.tenPhongBan)||"ang ti..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thng"}),t.jsx("select",{value:m,onChange:O=>f(Number(O.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:12},(O,M)=>t.jsxs("option",{value:M+1,children:["Thng ",M+1]},M+1))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nm"}),t.jsx("select",{value:p,onChange:O=>N(Number(O.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:5},(O,M)=>new Date().getFullYear()-2+M).map(O=>t.jsx("option",{value:O,children:O},O))})]}),t.jsx("button",{onClick:T,disabled:b||!y,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:b?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang ti..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Ti Template"]})})]}),t.jsxs("div",{...w(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${E?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,children:[t.jsx("input",{..._()}),t.jsxs("div",{className:"text-gray-600",children:[t.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),E?t.jsx("p",{className:"text-blue-600",children:"Th file vo y..."}):t.jsxs(t.Fragment,{children:[t.jsx("p",{children:"Ko th file Excel vo y, hoc click  chn file"}),t.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"H tr: .xlsx, .xls"})]})]})]}),e&&t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsxs("p",{className:"text-blue-800",children:[t.jsx("strong",{children:"File:"})," ",e.name," (",(e.size/1024).toFixed(1)," KB)"]}),t.jsxs("p",{className:"text-blue-600 text-sm mt-1",children:[" c ",a.length," dng d liu"]})]}),a.length>0&&!s&&t.jsx("button",{onClick:C,disabled:o,className:"w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2",children:o?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang x l..."]}):"Preview d liu"}),s&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[t.jsx("p",{className:"text-green-800 font-semibold text-lg",children:s.tongHopLe}),t.jsx("p",{className:"text-green-600 text-sm",children:"Dng hp l"})]}),t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[t.jsx("p",{className:"text-red-800 font-semibold text-lg",children:s.tongKhongHopLe}),t.jsx("p",{className:"text-red-600 text-sm",children:"Dng khng hp l"})]})]}),s.hopLe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-green-50 border-b border-green-200",children:t.jsxs("h3",{className:"font-semibold text-green-800",children:["D liu hp l (",s.hopLe.length,")"]})}),t.jsxs("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:[t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Khi lng"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"n gi"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Pht tr"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Pht KLP"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:s.hopLe.slice(0,100).map((O,M)=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-2 text-sm",children:O.maNhanVien}),t.jsx("td",{className:"px-4 py-2 text-sm",children:O.ngay}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:O.khoiLuong}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:R(O.donGia)}),t.jsx("td",{className:"px-4 py-2 text-sm text-right text-red-600",children:R(O.phatTre)}),t.jsx("td",{className:"px-4 py-2 text-sm text-right text-red-600",children:R(O.phatKhongLayPhieu)})]},M))})]}),s.hopLe.length>100&&t.jsxs("p",{className:"text-center text-gray-500 py-2",children:["... v ",s.hopLe.length-100," dng na"]})]})]}),s.khongHopLe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-red-50 border-b border-red-200",children:t.jsxs("h3",{className:"font-semibold text-red-800",children:["D liu khng hp l (",s.khongHopLe.length,")"]})}),t.jsx("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"L do"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:s.khongHopLe.map((O,M)=>t.jsxs("tr",{className:"bg-red-50",children:[t.jsx("td",{className:"px-4 py-2 text-sm",children:O.row.maNhanVien}),t.jsx("td",{className:"px-4 py-2 text-sm",children:O.row.ngay}),t.jsx("td",{className:"px-4 py-2 text-sm text-red-600",children:O.lyDo})]},M))})]})})]}),s.hopLe.length>0&&t.jsxs("div",{className:"flex gap-4",children:[t.jsx("button",{onClick:C,disabled:o,className:"flex-1 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 disabled:opacity-50",children:"Preview li"}),t.jsx("button",{onClick:P,disabled:u,className:"flex-1 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center justify-center gap-2",children:u?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang import..."]}):`Import ${s.hopLe.length} dng`})]})]}),t.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[t.jsx("h3",{className:"font-semibold text-yellow-800 mb-2",children:"Hng dn"}),t.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1 list-disc list-inside",children:[t.jsx("li",{children:"File Excel cn c cc ct: M NV, Ngy, Khi lng, n gi, Pht tr, Pht KL phiu"}),t.jsx("li",{children:"Ngy c th  nh dng dd/MM/yyyy hoc yyyy-MM-dd"}),t.jsx("li",{children:"Nu d liu  tn ti (cng m NV + ngy) s c cp nht"}),t.jsxs("li",{children:["Cng thc: ",t.jsx("strong",{children:"Tin = Khi lng  n gi - Pht tr - Pht khng ly phiu"})]})]})]})]})},mV=()=>{const[e,n]=D.useState([]),[a,r]=D.useState(0),[s,l]=D.useState(!0),[o,d]=D.useState({loaiImport:void 0,trangThai:void 0,page:1,limit:20});D.useEffect(()=>{u()},[o]);const u=async()=>{var y,g;l(!0);try{const b=await cV(o);n(b.items),r(b.total)}catch(b){const j=b;xt.error(((g=(y=j.response)==null?void 0:y.data)==null?void 0:g.message)||"Li ti d liu")}finally{l(!1)}},x=y=>new Date(y).toLocaleString("vi-VN"),m=y=>{d(g=>({...g,loaiImport:y===""?void 0:y,page:1}))},f=y=>{d(g=>({...g,trangThai:y===""?void 0:y,page:1}))},p=y=>{d(g=>({...g,page:y}))},N=Math.ceil(a/(o.limit||20));return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Lch S Import Sn Lng"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(ua,{to:"/import-chia-hang",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Import Chia Hng"}),t.jsx(ua,{to:"/import-giao-hang",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Import Giao Hng"})]})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow flex gap-4 items-center flex-wrap",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi"}),t.jsxs("select",{value:o.loaiImport||"",onChange:y=>m(y.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"CHIA_HANG",children:"Chia hng"}),t.jsx("option",{value:"GIAO_HANG",children:"Giao hng"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng thi"}),t.jsxs("select",{value:o.trangThai||"",onChange:y=>f(y.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"THANH_CONG",children:"Thnh cng"}),t.jsx("option",{value:"THAT_BAI",children:"Tht bi"})]})]}),t.jsx("div",{className:"ml-auto",children:t.jsx("button",{onClick:u,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Lm mi"})})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[s?t.jsxs("div",{className:"p-8 text-center",children:[t.jsxs("svg",{className:"animate-spin h-8 w-8 mx-auto text-blue-600",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),t.jsx("p",{className:"text-gray-500 mt-2",children:"ang ti..."})]}):e.length===0?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Khng c d liu"}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Loi"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tn file"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thi gian"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ngi import"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"S dng"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thnh cng"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tht bi"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trng thi"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(y=>{var g;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:y.id}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:t.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${y.loaiImport==="CHIA_HANG"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:y.loaiImport==="CHIA_HANG"?"Chia hng":"Giao hng"})}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",title:y.tenFile,children:y.tenFile}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:x(y.importLuc)}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:((g=y.nguoiImport)==null?void 0:g.hoTen)||"N/A"}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-center",children:y.soDong}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-green-600 text-center font-medium",children:y.soDongHopLe}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-red-600 text-center font-medium",children:y.soDongLoi}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:t.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${y.trangThai==="THANH_CONG"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:y.trangThai==="THANH_CONG"?"Thnh cng":"Tht bi"})})]},y.id)})})]})}),N>1&&t.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 flex items-center justify-between",children:[t.jsxs("div",{className:"text-sm text-gray-700",children:["Hin th ",t.jsx("span",{className:"font-medium",children:(o.page-1)*o.limit+1})," n"," ",t.jsx("span",{className:"font-medium",children:Math.min(o.page*o.limit,a)})," trong"," ",t.jsx("span",{className:"font-medium",children:a})," kt qu"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>p(o.page-1),disabled:o.page===1,className:"px-3 py-1 border rounded-md text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Trc"}),Array.from({length:Math.min(5,N)},(y,g)=>{let b;return N<=5||o.page<=3?b=g+1:o.page>=N-2?b=N-4+g:b=o.page-2+g,t.jsx("button",{onClick:()=>p(b),className:`px-3 py-1 border rounded-md text-sm ${b===o.page?"bg-blue-600 text-white border-blue-600":"hover:bg-gray-50"}`,children:b},b)}),t.jsx("button",{onClick:()=>p(o.page+1),disabled:o.page===N,className:"px-3 py-1 border rounded-md text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Sau"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Tng s ln import"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:a})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Import chia hng"}),t.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:e.filter(y=>y.loaiImport==="CHIA_HANG").length})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Import giao hng"}),t.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:e.filter(y=>y.loaiImport==="GIAO_HANG").length})]})]})]})};function fV(){var C,P;const[e,n]=D.useState("chia-hang"),[a,r]=D.useState(new Date().getMonth()+1),[s,l]=D.useState(new Date().getFullYear()),[o,d]=D.useState(1),[u,x]=D.useState(""),m=20,{data:f,isLoading:p}=Le({queryKey:["san-luong","chia-hang",a,s,o,u],queryFn:async()=>(await he.get("/san-luong/chia-hang",{params:{thang:a,nam:s,page:o,limit:m,tuKhoa:u}})).data,enabled:e==="chia-hang"}),{data:N,isLoading:y}=Le({queryKey:["san-luong","giao-hang",a,s,o,u],queryFn:async()=>(await he.get("/san-luong/giao-hang",{params:{thang:a,nam:s,page:o,limit:m,tuKhoa:u}})).data,enabled:e==="giao-hang"}),{data:g}=Le({queryKey:["san-luong","thong-ke",e,a,s],queryFn:async()=>(await he.get(`/san-luong/${e}/thong-ke`,{params:{thang:a,nam:s}})).data}),b=e==="chia-hang"?f:N,j=e==="chia-hang"?p:y,T=Array.isArray(b)?b:(b==null?void 0:b.data)||[],S=((C=b==null?void 0:b.pagination)==null?void 0:C.total)||T.length,w=Math.ceil(S/m),_=async()=>{try{const F=await he.get(`/san-luong/${e}/export`,{params:{thang:a,nam:s},responseType:"blob"}),R=window.URL.createObjectURL(new Blob([F.data])),O=document.createElement("a");O.href=R,O.setAttribute("download",`san-luong-${e}-${a}-${s}.xlsx`),document.body.appendChild(O),O.click(),O.remove()}catch(F){console.error("Export error:",F)}},E=F=>(F==null?void 0:F.toLocaleString("vi-VN"))||"0";return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Tra cu Sn lng"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Xem chi tit sn lng Chia hng v Giao hng theo thng"})]}),t.jsxs("button",{onClick:_,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[t.jsx(ws,{size:18}),"Xut Excel"]})]}),t.jsxs("div",{className:"flex gap-2 border-b",children:[t.jsxs("button",{onClick:()=>{n("chia-hang"),d(1)},className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${e==="chia-hang"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(J0,{size:20}),"Chia hng"]}),t.jsxs("button",{onClick:()=>{n("giao-hang"),d(1)},className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${e==="giao-hang"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(Z0,{size:20}),"Giao hng"]})]}),t.jsxs("div",{className:"flex flex-wrap gap-4 items-center bg-gray-50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Lt,{size:18,className:"text-gray-400"}),t.jsx("select",{value:a,onChange:F=>{r(Number(F.target.value)),d(1)},className:"border rounded-lg px-3 py-2",children:Array.from({length:12},(F,R)=>t.jsxs("option",{value:R+1,children:["Thng ",R+1]},R+1))}),t.jsx("select",{value:s,onChange:F=>{l(Number(F.target.value)),d(1)},className:"border rounded-lg px-3 py-2",children:[2024,2025,2026].map(F=>t.jsx("option",{value:F,children:F},F))})]}),t.jsx("div",{className:"flex-1 min-w-[200px]",children:t.jsxs("div",{className:"relative",children:[t.jsx(Vr,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Tm theo m NV, tn...",value:u,onChange:F=>{x(F.target.value),d(1)},className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]})}),t.jsxs("div",{className:"text-sm text-gray-600",children:["Tng: ",t.jsx("span",{className:"font-semibold",children:E(S)})," bn ghi"]})]}),g&&t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:e==="chia-hang"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-blue-600",children:"Tng SP t"}),t.jsx("div",{className:"text-2xl font-bold text-blue-700",children:E(g.tongSpDat)})]}),t.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-red-600",children:"Tng SP li"}),t.jsx("div",{className:"text-2xl font-bold text-red-700",children:E(g.tongSpLoi)})]}),t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-green-600",children:"T l t"}),t.jsxs("div",{className:"text-2xl font-bold text-green-700",children:[((P=g.tyLeDat)==null?void 0:P.toFixed(1))||"0","%"]})]}),t.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-purple-600",children:"S NV"}),t.jsx("div",{className:"text-2xl font-bold text-purple-700",children:E(g.soNhanVien)})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-blue-600",children:"Tng KL (kg)"}),t.jsx("div",{className:"text-2xl font-bold text-blue-700",children:E(g.tongKhoiLuong)})]}),t.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-orange-600",children:"Tng tr gi"}),t.jsx("div",{className:"text-2xl font-bold text-orange-700",children:E(g.tongTreGio)})]}),t.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-red-600",children:"Khng ly phiu"}),t.jsx("div",{className:"text-2xl font-bold text-red-700",children:E(g.tongKhongLayPhieu)})]}),t.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-purple-600",children:"S NV"}),t.jsx("div",{className:"text-2xl font-bold text-purple-700",children:E(g.soNhanVien)})]})]})}),t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50 text-gray-600",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left",children:"Ngy"}),t.jsx("th",{className:"px-4 py-3 text-left",children:"M NV"}),t.jsx("th",{className:"px-4 py-3 text-left",children:"H tn"}),e==="chia-hang"?t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"px-4 py-3 text-right",children:"SP t"}),t.jsx("th",{className:"px-4 py-3 text-right",children:"SP li"}),t.jsx("th",{className:"px-4 py-3 text-right",children:"T l li"})]}):t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"px-4 py-3 text-right",children:"KL (kg)"}),t.jsx("th",{className:"px-4 py-3 text-right",children:"Tr gi"}),t.jsx("th",{className:"px-4 py-3 text-right",children:"Khng phiu"})]}),t.jsx("th",{className:"px-4 py-3 text-center",children:"Ngun"}),t.jsx("th",{className:"px-4 py-3 text-left",children:"Ghi ch"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-100",children:j?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"ang ti..."})}):T.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"Khng c d liu"})}):e==="chia-hang"?T.map(F=>{var R,O;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3",children:new Date(F.ngay).toLocaleDateString("vi-VN")}),t.jsx("td",{className:"px-4 py-3 font-medium",children:((R=F.nhanVien)==null?void 0:R.maNhanVien)||`NV${F.nhanVienId}`}),t.jsx("td",{className:"px-4 py-3",children:((O=F.nhanVien)==null?void 0:O.hoTen)||"-"}),t.jsx("td",{className:"px-4 py-3 text-right font-medium text-blue-600",children:E(F.soLuongSpDat)}),t.jsx("td",{className:"px-4 py-3 text-right text-red-600",children:E(F.soLuongSpLoi)}),t.jsx("td",{className:"px-4 py-3 text-right",children:F.soLuongSpDat>0?(F.soLuongSpLoi/F.soLuongSpDat*100).toFixed(1)+"%":"-"}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded text-xs ${F.nguonDuLieu==="IMPORT_EXCEL"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:F.nguonDuLieu==="IMPORT_EXCEL"?t.jsxs(t.Fragment,{children:[t.jsx(Gn,{size:12})," Import"]}):"Nhp tay"})}),t.jsx("td",{className:"px-4 py-3 text-gray-500 max-w-[200px] truncate",children:F.ghiChu||"-"})]},F.id)}):T.map(F=>{var R,O;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3",children:new Date(F.ngay).toLocaleDateString("vi-VN")}),t.jsx("td",{className:"px-4 py-3 font-medium",children:((R=F.nhanVien)==null?void 0:R.maNhanVien)||`NV${F.nhanVienId}`}),t.jsx("td",{className:"px-4 py-3",children:((O=F.nhanVien)==null?void 0:O.hoTen)||"-"}),t.jsx("td",{className:"px-4 py-3 text-right font-medium text-blue-600",children:E(Number(F.khoiLuongThanhCong))}),t.jsx("td",{className:"px-4 py-3 text-right",children:F.soLanTreGio>0?t.jsxs("span",{className:"text-orange-600 flex items-center justify-end gap-1",children:[t.jsx(di,{size:14})," ",F.soLanTreGio]}):t.jsx("span",{className:"text-green-600",children:"0"})}),t.jsx("td",{className:"px-4 py-3 text-right",children:F.soLanKhongLayPhieu>0?t.jsx("span",{className:"text-red-600",children:F.soLanKhongLayPhieu}):t.jsx("span",{className:"text-green-600",children:"0"})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded text-xs ${F.nguonDuLieu==="IMPORT_EXCEL"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:F.nguonDuLieu==="IMPORT_EXCEL"?t.jsxs(t.Fragment,{children:[t.jsx(Gn,{size:12})," Import"]}):"Nhp tay"})}),t.jsx("td",{className:"px-4 py-3 text-gray-500 max-w-[200px] truncate",children:F.ghiChu||"-"})]},F.id)})})]})}),w>1&&t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t bg-gray-50",children:[t.jsxs("div",{className:"text-sm text-gray-600",children:["Trang ",o," / ",w]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>d(F=>Math.max(1,F-1)),disabled:o===1,className:"p-2 rounded border hover:bg-gray-100 disabled:opacity-50",children:t.jsx(Nr,{size:18})}),t.jsx("button",{onClick:()=>d(F=>Math.min(w,F+1)),disabled:o>=w,className:"p-2 rounded border hover:bg-gray-100 disabled:opacity-50",children:t.jsx(qn,{size:18})})]})]})]})]})}function pV(){const e=Mt(),[n,a]=D.useState(!1),[r,s]=D.useState(null),[l,o]=D.useState({maBien:"",tenBien:"",moTa:"",giaTri:0,donVi:"VND"}),{data:d,isLoading:u}=Le({queryKey:["cau-hinh-don-gia"],queryFn:()=>kd.layTatCa()}),x=De({mutationFn:kd.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["cau-hinh-don-gia"]}),ie.success("To n gi thnh cng!"),N()},onError:w=>{var _,E;ie.error(((E=(_=w.response)==null?void 0:_.data)==null?void 0:E.message)||"C li xy ra")}}),m=De({mutationFn:({id:w,data:_})=>kd.capNhat(w,_),onSuccess:()=>{e.invalidateQueries({queryKey:["cau-hinh-don-gia"]}),ie.success("Cp nht n gi thnh cng!"),N()},onError:w=>{var _,E;ie.error(((E=(_=w.response)==null?void 0:_.data)==null?void 0:E.message)||"C li xy ra")}}),f=De({mutationFn:kd.xoa,onSuccess:()=>{e.invalidateQueries({queryKey:["cau-hinh-don-gia"]}),ie.success("Xa n gi thnh cng!")},onError:w=>{var _,E;ie.error(((E=(_=w.response)==null?void 0:_.data)==null?void 0:E.message)||"C li xy ra")}}),p=De({mutationFn:kd.khoiTaoMau,onSuccess:w=>{e.invalidateQueries({queryKey:["cau-hinh-don-gia"]}),ie.success(w.message||"Khi to n gi mu thnh cng!")},onError:w=>{var _,E;ie.error(((E=(_=w.response)==null?void 0:_.data)==null?void 0:E.message)||"C li xy ra")}}),N=()=>{a(!1),s(null),o({maBien:"",tenBien:"",moTa:"",giaTri:0,donVi:"VND"})},y=w=>{s(w),o({maBien:w.maBien,tenBien:w.tenBien,moTa:w.moTa||"",giaTri:Number(w.giaTri),donVi:w.donVi||"VND"}),a(!0)},g=()=>{if(!l.maBien||!l.tenBien){ie.error("Vui lng in m v tn n gi");return}r?m.mutate({id:r.id,data:{tenBien:l.tenBien,moTa:l.moTa,giaTri:l.giaTri,donVi:l.donVi}}):x.mutate(l)},b=w=>{confirm(`Bn c chc mun xa n gi "${w.tenBien}"?`)&&f.mutate(w.id)},j=(d==null?void 0:d.filter(w=>w.maBien.includes("SP")||w.maBien.includes("LOI")))||[],T=(d==null?void 0:d.filter(w=>w.maBien.includes("KHOI_LUONG")||w.maBien.includes("TRE")||w.maBien.includes("PHIEU")))||[],S=(d==null?void 0:d.filter(w=>!j.includes(w)&&!T.includes(w)))||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(gr,{className:"w-8 h-8 text-emerald-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"n gi Sn lng"}),t.jsx("p",{className:"text-gray-600",children:"Cu hnh n gi s dng trong tnh lng sn lng"})]})]}),t.jsxs("div",{className:"flex gap-2",children:[(!d||d.length===0)&&t.jsxs("button",{onClick:()=>p.mutate(),disabled:p.isPending,className:"btn btn-secondary",children:[t.jsx(ub,{size:18}),"Khi to mu"]}),t.jsxs("button",{onClick:()=>a(!0),className:"btn btn-primary",children:[t.jsx(Dt,{size:18}),"Thm n gi"]})]})]}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[t.jsx(yu,{className:"text-blue-500 flex-shrink-0 mt-0.5",size:20}),t.jsxs("div",{className:"text-sm text-blue-800",children:[t.jsx("p",{className:"font-medium mb-1",children:"n gi c s dng trong Quy ch lng"}),t.jsxs("ul",{className:"list-disc list-inside space-y-1 text-blue-700",children:[t.jsxs("li",{children:[t.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"DON_GIA_SP"})," - n gi sn phm chia hng"]}),t.jsxs("li",{children:[t.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"HE_SO_LOI"})," - H s pht sn phm li"]}),t.jsxs("li",{children:[t.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"DON_GIA_KHOI_LUONG"})," - n gi theo kg giao hng"]}),t.jsxs("li",{children:[t.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"DON_GIA_PHAT_TRE"})," - Pht tr gi giao hng"]})]})]})]}),u?t.jsx("div",{className:"flex justify-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600"})}):!d||d.length===0?t.jsxs("div",{className:"card p-8 text-center",children:[t.jsx(di,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Cha c n gi no"}),t.jsx("p",{className:"text-gray-500 mb-4",children:'Nhn "Khi to mu"  to cc n gi mc nh hoc thm th cng'}),t.jsxs("button",{onClick:()=>p.mutate(),disabled:p.isPending,className:"btn btn-primary",children:[t.jsx(ub,{size:18}),"Khi to mu"]})]}):t.jsxs("div",{className:"grid gap-6",children:[j.length>0&&t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"p-4 border-b bg-cyan-50 flex items-center gap-2",children:[t.jsx(J0,{className:"text-cyan-600",size:20}),t.jsx("h3",{className:"font-semibold text-cyan-800",children:"n gi Chia hng"})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M bin"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Tn"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M t"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"Gi tr"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"n v"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y",children:j.map(w=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-sm",children:w.maBien})}),t.jsx("td",{className:"px-4 py-3 font-medium",children:w.tenBien}),t.jsx("td",{className:"px-4 py-3 text-gray-500 text-sm",children:w.moTa}),t.jsx("td",{className:"px-4 py-3 text-right font-semibold text-emerald-600",children:w.donVi==="VND"?Ye(Number(w.giaTri)):Number(w.giaTri).toLocaleString()}),t.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-500",children:w.donVi}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>y(w),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",children:t.jsx(Za,{size:16})}),t.jsx("button",{onClick:()=>b(w),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",children:t.jsx(er,{size:16})})]})})]},w.id))})]})})]}),T.length>0&&t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"p-4 border-b bg-teal-50 flex items-center gap-2",children:[t.jsx(Z0,{className:"text-teal-600",size:20}),t.jsx("h3",{className:"font-semibold text-teal-800",children:"n gi Giao hng"})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M bin"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Tn"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M t"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"Gi tr"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"n v"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y",children:T.map(w=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-sm",children:w.maBien})}),t.jsx("td",{className:"px-4 py-3 font-medium",children:w.tenBien}),t.jsx("td",{className:"px-4 py-3 text-gray-500 text-sm",children:w.moTa}),t.jsx("td",{className:"px-4 py-3 text-right font-semibold text-emerald-600",children:w.donVi==="VND"?Ye(Number(w.giaTri)):Number(w.giaTri).toLocaleString()}),t.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-500",children:w.donVi}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>y(w),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",children:t.jsx(Za,{size:16})}),t.jsx("button",{onClick:()=>b(w),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",children:t.jsx(er,{size:16})})]})})]},w.id))})]})})]}),S.length>0&&t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"p-4 border-b bg-gray-50 flex items-center gap-2",children:[t.jsx(gr,{className:"text-gray-600",size:20}),t.jsx("h3",{className:"font-semibold text-gray-800",children:"n gi khc"})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M bin"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Tn"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M t"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"Gi tr"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"n v"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y",children:S.map(w=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-sm",children:w.maBien})}),t.jsx("td",{className:"px-4 py-3 font-medium",children:w.tenBien}),t.jsx("td",{className:"px-4 py-3 text-gray-500 text-sm",children:w.moTa}),t.jsx("td",{className:"px-4 py-3 text-right font-semibold text-emerald-600",children:w.donVi==="VND"?Ye(Number(w.giaTri)):Number(w.giaTri).toLocaleString()}),t.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-500",children:w.donVi}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>y(w),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",children:t.jsx(Za,{size:16})}),t.jsx("button",{onClick:()=>b(w),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",children:t.jsx(er,{size:16})})]})})]},w.id))})]})})]})]}),t.jsx(ns,{isOpen:n,onClose:N,children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:r?"Cp nht n gi":"Thm n gi mi"}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["M bin ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:l.maBien,onChange:w=>o({...l,maBien:w.target.value.toUpperCase()}),disabled:!!r,className:"w-full border rounded-lg px-3 py-2 disabled:bg-gray-100",placeholder:"VD: DON_GIA_SP"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"M bin s c s dng trong cng thc quy ch lng"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn n gi ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:l.tenBien,onChange:w=>o({...l,tenBien:w.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: n gi sn phm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:l.moTa,onChange:w=>o({...l,moTa:w.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2,placeholder:"M t chi tit..."})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Gi tr ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"number",value:l.giaTri,onChange:w=>o({...l,giaTri:Number(w.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n v"}),t.jsxs("select",{value:l.donVi,onChange:w=>o({...l,donVi:w.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"VND",children:"VND"}),t.jsx("option",{value:"HE_SO",children:"H s"}),t.jsx("option",{value:"PHAN_TRAM",children:"%"})]})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[t.jsx("button",{onClick:N,className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:g,disabled:x.isPending||m.isPending,className:"btn btn-primary",children:r?"Cp nht":"To mi"})]})]})})]})}const gV=e=>{switch(e){case"NHAP":return"bg-yellow-100 text-yellow-800";case"DA_CHOT":return"bg-blue-100 text-blue-800";case"DA_KHOA":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},yV=e=>{switch(e){case"NHAP":return"Nhp";case"DA_CHOT":return" cht";case"DA_KHOA":return" kha";default:return e}};function vV(){const e=Mt(),{coVaiTro:n}=is(),a=n("ADMIN"),[r,s]=D.useState(!1),[l,o]=D.useState(()=>{const P=new Date;return`${P.getFullYear()}-${String(P.getMonth()+1).padStart(2,"0")}`}),[d,u]=D.useState(),[x,m]=D.useState({thangNam:l,tuNgay:"",denNgay:"",ngayChiTra:"",phongBanId:void 0,ghiChu:""}),f=P=>{const F=`${P}-01`,R=`${P}-15`;m({...x,thangNam:P,tuNgay:F,denNgay:R})},{data:p,isLoading:N}=Le({queryKey:["bang-ung-luong",l,d],queryFn:()=>Xa.layDanhSach({thangNam:l,phongBanId:d})}),y=(p==null?void 0:p.data)||[],{data:g}=Le({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),b=De({mutationFn:Xa.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["bang-ung-luong"]}),ie.success("To bng ng lng thnh cng!"),s(!1),m({thangNam:l,tuNgay:"",denNgay:"",ngayChiTra:"",phongBanId:void 0,ghiChu:""})},onError:P=>{var F,R;ie.error(((R=(F=P.response)==null?void 0:F.data)==null?void 0:R.message)||"C li xy ra")}}),j=De({mutationFn:({id:P,force:F})=>Xa.xoa(P,F),onSuccess:()=>{e.invalidateQueries({queryKey:["bang-ung-luong"]}),ie.success("Xa bng ng lng thnh cng!")},onError:P=>{var F,R;ie.error(((R=(F=P.response)==null?void 0:F.data)==null?void 0:R.message)||"C li xy ra")}}),T=De({mutationFn:Xa.chot,onSuccess:()=>{e.invalidateQueries({queryKey:["bang-ung-luong"]}),ie.success("Cht bng ng lng thnh cng!")},onError:P=>{var F,R;ie.error(((R=(F=P.response)==null?void 0:F.data)==null?void 0:R.message)||"C li xy ra")}}),S=De({mutationFn:Xa.khoa,onSuccess:()=>{e.invalidateQueries({queryKey:["bang-ung-luong"]}),ie.success("Kha bng ng lng thnh cng!")},onError:P=>{var F,R;ie.error(((R=(F=P.response)==null?void 0:F.data)==null?void 0:R.message)||"C li xy ra")}}),w=()=>{if(!x.tuNgay||!x.denNgay){ie.error("Vui lng nhp y  thng tin");return}b.mutate(x)},_=(P,F,R=!1)=>{if(F!=="NHAP"&&!R){ie.error("Ch c th xa bng ng lng ang  trng thi Nhp");return}confirm(R?" CNH BO: Bn ang xa cng ch bng ng lng  kha. Thao tc ny s c ghi li. Tip tc?":"Bn c chc mun xa bng ng lng ny?")&&j.mutate({id:P,force:R})},E=(P,F)=>{if(F!=="NHAP"){ie.error("Ch c th cht bng ng lng ang  trng thi Nhp");return}confirm("Bn c chc mun cht bng ng lng ny?")&&T.mutate(P)},C=(P,F)=>{if(F!=="DA_CHOT"){ie.error("Ch c th kha bng ng lng  cht");return}confirm("Bn c chc mun kha bng ng lng ny?")&&S.mutate(P)};return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[t.jsx(sg,{size:28}),"Qun l Bng ng lng"]}),t.jsxs("button",{onClick:()=>{f(l),s(!0)},className:"btn btn-primary",children:[t.jsx(Dt,{size:20}),"To bng ng lng"]})]}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Thng/Nm"}),t.jsx(Tc,{value:l,onChange:o,className:"border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban"}),t.jsxs("select",{value:d||"",onChange:P=>u(P.target.value?Number(P.target.value):void 0),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),g==null?void 0:g.map(P=>t.jsx("option",{value:P.id,children:P.tenPhongBan},P.id))]})]})]})}),t.jsx("div",{className:"card",children:N?t.jsx("p",{className:"text-center py-8 text-gray-500",children:"ang ti..."}):y&&y.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b",children:[t.jsx("th",{className:"text-left py-3 px-4",children:"Phng ban"}),t.jsx("th",{className:"text-left py-3 px-4",children:"Thng/Nm"}),t.jsx("th",{className:"text-left py-3 px-4",children:"Ngy chi tr"}),t.jsx("th",{className:"text-right py-3 px-4",children:"S NV"}),t.jsx("th",{className:"text-right py-3 px-4",children:"Tng tin ng"}),t.jsx("th",{className:"text-center py-3 px-4",children:"Trng thi"}),t.jsx("th",{className:"text-center py-3 px-4",children:"Thao tc"})]})}),t.jsx("tbody",{children:y.map(P=>{var F,R;return t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4 font-medium",children:t.jsx(ua,{to:`/ung-luong/${P.id}`,className:"text-primary-600 hover:underline",children:((F=P.phongBan)==null?void 0:F.tenPhongBan)||"Tt c phng ban"})}),t.jsx("td",{className:"py-3 px-4",children:P.thangNam}),t.jsx("td",{className:"py-3 px-4",children:P.ngayChiTra?js(P.ngayChiTra):"-"}),t.jsxs("td",{className:"py-3 px-4 text-right",children:[P.soNhanVienUng,"/",((R=P._count)==null?void 0:R.chiTiets)||0]}),t.jsx("td",{className:"py-3 px-4 text-right font-medium text-blue-600",children:Ye(P.tongSoTienUng)}),t.jsx("td",{className:"py-3 px-4 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded text-sm ${gV(P.trangThai)}`,children:yV(P.trangThai)})}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex justify-center gap-2",children:[P.trangThai==="NHAP"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>E(P.id,P.trangThai),className:"p-2 text-green-600 hover:bg-green-50 rounded",title:"Cht",children:t.jsx(Br,{size:18})}),t.jsx("button",{onClick:()=>_(P.id,P.trangThai),className:"p-2 text-red-600 hover:bg-red-50 rounded",title:"Xa",children:t.jsx(er,{size:18})})]}),P.trangThai==="DA_CHOT"&&t.jsx("button",{onClick:()=>C(P.id,P.trangThai),className:"p-2 text-orange-600 hover:bg-orange-50 rounded",title:"Kha",children:t.jsx(ti,{size:18})}),P.trangThai==="DA_KHOA"&&a&&t.jsx("button",{onClick:()=>_(P.id,P.trangThai,!0),className:"p-2 text-red-600 hover:bg-red-50 rounded",title:"[Admin] Xa cng ch",children:t.jsx(sa,{size:18})})]})})]},P.id)})})]})}):t.jsx("p",{className:"text-center py-8 text-gray-500",children:'Cha c bng ng lng no. Nhn "To bng ng lng"  bt u.'})}),r&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"To bng ng lng mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Thng/Nm ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Tc,{value:x.thangNam,onChange:f,className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["T ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ut,{value:x.tuNgay,onChange:P=>m({...x,tuNgay:P}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["n ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ut,{value:x.denNgay,onChange:P=>m({...x,denNgay:P}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy chi tr"}),t.jsx(Ut,{value:x.ngayChiTra,onChange:P=>m({...x,ngayChiTra:P}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:x.phongBanId||"",onChange:P=>m({...x,phongBanId:P.target.value?Number(P.target.value):void 0}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),g==null?void 0:g.map(P=>t.jsx("option",{value:P.id,children:P.tenPhongBan},P.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),t.jsx("textarea",{value:x.ghiChu,onChange:P=>m({...x,ghiChu:P.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:w,disabled:b.isPending,className:"btn btn-primary",children:b.isPending?"ang to...":"To bng ng lng"})]})]})})]})}const bV=e=>{switch(e){case"NGHI_QUA_NHIEU":return"Ngh qu nhiu ngy";case"NGHI_KHONG_PHEP":return"Ngh khng php";case"KHONG_HOAT_DONG":return"Khng hot ng";default:return e||""}};function NV(){const{id:e}=q0(),n=br(),a=Mt(),r=Number(e),[s,l]=D.useState(new Map),[o,d]=D.useState(!1),[u,x]=D.useState(!1),[m,f]=D.useState(!1),[p,N]=D.useState(70),[y,g]=D.useState(0),[b,j]=D.useState(null),{data:T,isLoading:S,refetch:w}=Le({queryKey:["bang-ung-luong",r],queryFn:()=>Xa.layTheoId(r),enabled:!!r}),{data:_}=Le({queryKey:["bang-luong-list"],queryFn:()=>Or.layDanhSach({})}),E=(T==null?void 0:T.trangThai)==="NHAP",C=De({mutationFn:K=>Xa.sinhDanhSach(r,K),onSuccess:K=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),ie.success(` sinh ${K.soNhanVien} nhn vin (${K.soDuocUng}  iu kin)`)},onError:K=>{var L,X;ie.error(((X=(L=K.response)==null?void 0:L.data)==null?void 0:X.message)||"C li xy ra")}}),P=De({mutationFn:K=>Xa.capNhatBulk(r,K),onSuccess:K=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),l(new Map),K.errors&&K.errors.length>0?ie.error(`Cp nht ${K.soCapNhat} dng. Li: ${K.errors.length}`):ie.success(`Cp nht ${K.soCapNhat} dng thnh cng`)},onError:K=>{var L,X;ie.error(((X=(L=K.response)==null?void 0:L.data)==null?void 0:X.message)||"C li xy ra")}}),F=De({mutationFn:K=>Xa.setTheoTiLe(r,K),onSuccess:K=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),d(!1),ie.success(K.message)},onError:K=>{var L,X;ie.error(((X=(L=K.response)==null?void 0:L.data)==null?void 0:X.message)||"C li xy ra")}}),R=De({mutationFn:K=>Xa.setSoTienCoDinh(r,K),onSuccess:K=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),x(!1),ie.success(K.message)},onError:K=>{var L,X;ie.error(((X=(L=K.response)==null?void 0:L.data)==null?void 0:X.message)||"C li xy ra")}}),O=De({mutationFn:()=>Xa.chot(r),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),ie.success("Cht bng ng lng thnh cng!")},onError:K=>{var L,X;ie.error(((X=(L=K.response)==null?void 0:L.data)==null?void 0:X.message)||"C li xy ra")}}),M=De({mutationFn:()=>Xa.khoa(r),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),ie.success("Kha bng ng lng thnh cng!")},onError:K=>{var L,X;ie.error(((X=(L=K.response)==null?void 0:L.data)==null?void 0:X.message)||"C li xy ra")}}),q=De({mutationFn:K=>Xa.moKhoa(r,{lyDo:K}),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),ie.success("M kha bng ng lng thnh cng!")},onError:K=>{var L,X;ie.error(((X=(L=K.response)==null?void 0:L.data)==null?void 0:X.message)||"C li xy ra")}}),J=De({mutationFn:K=>Xa.ghiNhanKhauTru(r,K),onSuccess:K=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),f(!1),ie.success(K.message)},onError:K=>{var L,X;ie.error(((X=(L=K.response)==null?void 0:L.data)==null?void 0:X.message)||"C li xy ra")}}),B=D.useCallback((K,L,X)=>{l(I=>{const W=new Map(I),z=W.get(K)||{};return W.set(K,{...z,[L]:X}),W})},[]),ue=D.useCallback((K,L)=>{const X=s.get(K.id);return X&&L in X?X[L]:K[L]},[s]),te=D.useCallback((K,L)=>!(!K.duocPhepUng&&L>0||L>Number(K.mucToiDaDuocUng)),[]),Z=()=>{if(s.size===0){ie("Khng c thay i  lu",{icon:""});return}const K=Array.from(s.entries()).map(([L,X])=>({id:L,soTienUngDeXuat:X.soTienUngDeXuat,soTienUngDuyet:X.soTienUngDuyet,ghiChu:X.ghiChu??void 0}));P.mutate({chiTiets:K})},Q=D.useMemo(()=>{if(!(T!=null&&T.chiTiets))return{tongNV:0,tongDuocUng:0,tongTien:0};const K=T.chiTiets;return{tongNV:K.length,tongDuocUng:K.filter(L=>L.duocPhepUng).length,tongTien:K.reduce((L,X)=>{const I=s.get(X.id),W=(I==null?void 0:I.soTienUngDuyet)??X.soTienUngDuyet;return L+Number(W)},0)}},[T==null?void 0:T.chiTiets,s]);if(S)return t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});if(!T)return t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-500",children:"Khng tm thy bng ng lng"})});const fe=T.chiTiets||[];return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>n("/ung-luong"),className:"p-2 hover:bg-gray-100 rounded-full",children:t.jsx(Q0,{size:24})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:T.maBangUngLuong}),t.jsxs("p",{className:"text-gray-500",children:["K ",T.thangNam," | ",new Date(T.tuNgay).toLocaleDateString("vi-VN")," -"," ",new Date(T.denNgay).toLocaleDateString("vi-VN")]})]})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("span",{className:`px-3 py-1 rounded-full text-sm ${T.trangThai==="NHAP"?"bg-yellow-100 text-yellow-800":T.trangThai==="DA_CHOT"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:T.trangThai==="NHAP"?"Nhp":T.trangThai==="DA_CHOT"?" cht":" kha"})})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[t.jsxs("div",{className:"card",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng nhn vin"}),t.jsx("p",{className:"text-2xl font-bold text-gray-800",children:Q.tongNV})]}),t.jsxs("div",{className:"card",children:[t.jsx("p",{className:"text-sm text-gray-500",children:" iu kin ng"}),t.jsx("p",{className:"text-2xl font-bold text-green-600",children:Q.tongDuocUng})]}),t.jsxs("div",{className:"card",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Khng  iu kin"}),t.jsx("p",{className:"text-2xl font-bold text-red-600",children:Q.tongNV-Q.tongDuocUng})]}),t.jsxs("div",{className:"card",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng tin ng"}),t.jsx("p",{className:"text-2xl font-bold text-blue-600",children:Ye(Q.tongTien)})]})]}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"flex flex-wrap gap-2",children:[E&&t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>C.mutate({}),disabled:C.isPending,className:"btn btn-secondary",children:[t.jsx(on,{size:18}),"Sinh danh sch NV"]}),t.jsxs("button",{onClick:()=>d(!0),className:"btn btn-secondary",children:[t.jsx(B_,{size:18}),"Set theo % mc ti a"]}),t.jsxs("button",{onClick:()=>x(!0),className:"btn btn-secondary",children:[t.jsx(gr,{size:18}),"Set s tin c nh"]}),t.jsxs("button",{onClick:Z,disabled:s.size===0||P.isPending,className:"btn btn-primary",children:[t.jsx(Es,{size:18}),"Lu thay i (",s.size,")"]}),t.jsxs("button",{onClick:()=>{confirm("Bn c chc mun cht bng ng lng ny?")&&O.mutate()},disabled:fe.length===0,className:"btn bg-green-600 text-white hover:bg-green-700",children:[t.jsx(Br,{size:18}),"Cht"]})]}),T.trangThai==="DA_CHOT"&&t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>{confirm("Bn c chc mun kha bng ng lng ny?")&&M.mutate()},className:"btn bg-orange-600 text-white hover:bg-orange-700",children:[t.jsx(ti,{size:18}),"Kha"]}),t.jsxs("button",{onClick:()=>f(!0),disabled:T.daGhiNhanKhauTru,className:"btn btn-primary",children:[t.jsx(uj,{size:18}),T.daGhiNhanKhauTru?" ghi nhn khu tr":"Ghi nhn khu tr"]})]}),T.trangThai==="DA_KHOA"&&t.jsxs("button",{onClick:()=>{const K=prompt("Nhp l do m kha:");K&&q.mutate(K)},className:"btn bg-gray-600 text-white hover:bg-gray-700",children:[t.jsx(rg,{size:18}),"M kha"]}),t.jsx("button",{onClick:()=>w(),className:"btn btn-secondary ml-auto",children:t.jsx(K_,{size:18})})]})}),t.jsx("div",{className:"card overflow-x-auto",children:fe.length>0?t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-3 px-4 font-medium sticky left-0 bg-gray-50",children:"M NV"}),t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"H tn"}),t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Phng ban"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Ngy cng"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Ngh"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Ngh KP"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Tin cng ly k"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Mc ti a"}),t.jsx("th",{className:"text-center py-3 px-4 font-medium",children:"Eligible"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium bg-blue-50",children:"S tin  xut"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium bg-green-50",children:"S tin duyt"}),t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Ghi ch"})]})}),t.jsx("tbody",{children:fe.map(K=>{var W,z,xe;const L=ue(K,"soTienUngDuyet"),X=te(K,Number(L)),I=s.has(K.id);return t.jsxs("tr",{className:`border-b hover:bg-gray-50 ${K.duocPhepUng?"":"bg-red-50"} ${I?"bg-yellow-50":""}`,children:[t.jsx("td",{className:"py-2 px-4 font-medium sticky left-0 bg-white",children:(W=K.nhanVien)==null?void 0:W.maNhanVien}),t.jsx("td",{className:"py-2 px-4",children:(z=K.nhanVien)==null?void 0:z.hoTen}),t.jsx("td",{className:"py-2 px-4",children:(xe=K.phongBan)==null?void 0:xe.tenPhongBan}),t.jsxs("td",{className:"py-2 px-4 text-right",children:[Number(K.soNgayCong).toFixed(1),K.laTamTinh&&t.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs bg-yellow-100 text-yellow-700 rounded",title:"Tm tnh theo lch (cha c chm cng thc t)",children:"~"})]}),t.jsx("td",{className:"py-2 px-4 text-right",children:Number(K.soNgayNghi).toFixed(1)}),t.jsxs("td",{className:"py-2 px-4 text-right",children:[Number(K.soNgayNghiKhongPhep)>0&&t.jsx("span",{className:"text-red-600 font-medium",children:Number(K.soNgayNghiKhongPhep).toFixed(1)}),Number(K.soNgayNghiKhongPhep)===0&&"0"]}),t.jsx("td",{className:"py-2 px-4 text-right",children:Ye(K.tienCongLuyKe)}),t.jsx("td",{className:"py-2 px-4 text-right font-medium text-blue-600",children:Ye(K.mucToiDaDuocUng)}),t.jsx("td",{className:"py-2 px-4 text-center",children:K.duocPhepUng?t.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-green-100 text-green-600 rounded-full",children:t.jsx(Br,{size:14})}):t.jsx("span",{className:"inline-flex items-center gap-1 text-red-600",title:bV(K.lyDoKhongDat),children:t.jsx(di,{size:14})})}),t.jsx("td",{className:"py-2 px-4 bg-blue-50",children:t.jsx("input",{type:"number",min:"0",max:K.mucToiDaDuocUng,value:ue(K,"soTienUngDeXuat"),onChange:H=>B(K.id,"soTienUngDeXuat",Number(H.target.value)),disabled:!E||!K.duocPhepUng,className:`w-full px-2 py-1 border rounded text-right ${!E||!K.duocPhepUng?"bg-gray-100 cursor-not-allowed":"bg-white"}`})}),t.jsxs("td",{className:"py-2 px-4 bg-green-50",children:[t.jsx("input",{type:"number",min:"0",max:K.mucToiDaDuocUng,value:L,onChange:H=>B(K.id,"soTienUngDuyet",Number(H.target.value)),disabled:!E||!K.duocPhepUng,className:`w-full px-2 py-1 border rounded text-right ${!E||!K.duocPhepUng?"bg-gray-100 cursor-not-allowed":X?"bg-white":"border-red-500 bg-red-50"}`}),!X&&t.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Vt mc ti a"})]}),t.jsx("td",{className:"py-2 px-4",children:t.jsx("input",{type:"text",value:ue(K,"ghiChu")||"",onChange:H=>B(K.id,"ghiChu",H.target.value),disabled:!E,className:`w-full px-2 py-1 border rounded ${E?"bg-white":"bg-gray-100 cursor-not-allowed"}`,placeholder:"Ghi ch..."})})]},K.id)})})]}):t.jsxs("div",{className:"text-center py-12",children:[t.jsx(on,{size:48,className:"mx-auto text-gray-400 mb-4"}),t.jsx("p",{className:"text-gray-500 mb-4",children:"Cha c nhn vin no trong bng ng lng"}),E&&t.jsxs("button",{onClick:()=>C.mutate({}),disabled:C.isPending,className:"btn btn-primary",children:[t.jsx(on,{size:18}),"Sinh danh sch nhn vin"]})]})}),o&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Set theo % mc ti a"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T l (%)"}),t.jsx("input",{type:"number",min:"0",max:"100",value:p,onChange:K=>N(Number(K.target.value)),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"p dng cho tt c nhn vin  iu kin ng lng"}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:()=>F.mutate({tiLe:p,lamTron:1e4}),disabled:F.isPending,className:"btn btn-primary",children:F.isPending?"ang x l...":"p dng"})]})]})}),u&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Set s tin c nh"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S tin (VN)"}),t.jsx("input",{type:"number",min:"0",step:"100000",value:y,onChange:K=>g(Number(K.target.value)),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Ch p dng cho nhn vin c mc ti a >= s tin ny"}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:()=>R.mutate({soTien:y}),disabled:R.isPending,className:"btn btn-primary",children:R.isPending?"ang x l...":"p dng"})]})]})}),m&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Ghi nhn khu tr vo bng lng"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Chn bng lng p dng"}),t.jsxs("select",{value:b||"",onChange:K=>j(K.target.value?Number(K.target.value):null),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn bng lng --"}),(Array.isArray(_)?_:(_==null?void 0:_.data)||[]).map(K=>{var L;return t.jsxs("option",{value:K.id,children:["Thng ",K.thang,"/",K.nam," - ",((L=K.phongBan)==null?void 0:L.tenPhongBan)||"Tt c"]},K.id)})]})]}),t.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"H thng s to phiu iu chnh t ng  khu tr s tin ng t bng lng c chn."}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:()=>{if(!b){ie.error("Vui lng chn bng lng");return}J.mutate({bangLuongApDungId:b})},disabled:J.isPending||!b,className:"btn btn-primary",children:J.isPending?"ang x l...":"Ghi nhn"})]})]})})]})}function jV(){var g,b,j,T,S,w,_,E,C,P,F,R,O;const[e,n]=D.useState(""),[a,r]=D.useState(null),[s,l]=D.useState(()=>{const M=new Date;return M.setMonth(M.getMonth()-11),`${M.getFullYear()}-${String(M.getMonth()+1).padStart(2,"0")}`}),[o,d]=D.useState(()=>{const M=new Date;return`${M.getFullYear()}-${String(M.getMonth()+1).padStart(2,"0")}`}),[u,x]=D.useState("bangLuongs"),{data:m}=Le({queryKey:["nhan-vien-search",e],queryFn:()=>ha.layTatCa({tuKhoa:e,soLuong:20}),enabled:e.length>=2}),f=m?{data:Array.isArray(m)?m:m.data}:void 0,{data:p,isLoading:N}=Le({queryKey:["so-luong-nv",a,s,o],queryFn:()=>qj.layNhanVien(a,{tuThang:Number(s.split("-")[1]),tuNam:Number(s.split("-")[0]),denThang:Number(o.split("-")[1]),denNam:Number(o.split("-")[0])}),enabled:!!a}),y=M=>{x(u===M?null:M)};return t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"S lng nhn vin"}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tm nhn vin"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",value:e,onChange:M=>n(M.target.value),placeholder:"Nhp m hoc tn nhn vin...",className:"w-full border rounded-lg px-3 py-2 pl-10"}),t.jsx(Vr,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(f==null?void 0:f.data)&&f.data.length>0&&e.length>=2&&t.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-60 overflow-y-auto",children:f.data.map(M=>{var q;return t.jsxs("button",{onClick:()=>{r(M.id),n(`${M.maNhanVien} - ${M.hoTen}`)},className:"w-full text-left px-4 py-2 hover:bg-gray-50",children:[t.jsx("span",{className:"font-medium",children:M.maNhanVien})," - ",M.hoTen,t.jsx("span",{className:"text-gray-500 text-sm block",children:(q=M.phongBan)==null?void 0:q.tenPhongBan})]},M.id)})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T thng"}),t.jsx(Tc,{value:s,onChange:l,className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n thng"}),t.jsx(Tc,{value:o,onChange:d,className:"w-full border rounded-lg px-3 py-2"})]})]})}),p&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"card mb-6",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[t.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center",children:t.jsx(so,{size:32,className:"text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold",children:p.nhanVien.hoTen}),t.jsxs("p",{className:"text-gray-500",children:[p.nhanVien.maNhanVien," | ",(g=p.nhanVien.phongBan)==null?void 0:g.tenPhongBan]})]}),t.jsxs("button",{className:"btn btn-secondary ml-auto",children:[t.jsx(ws,{size:18}),"Xut Excel"]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng lng"}),t.jsx("p",{className:"text-lg font-bold text-gray-800",children:Ye(((b=p.tongKet)==null?void 0:b.tongLuong)??0)})]}),t.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng thng"}),t.jsx("p",{className:"text-lg font-bold text-green-600",children:Ye(((j=p.tongKet)==null?void 0:j.tongThuong)??0)})]}),t.jsxs("div",{className:"bg-red-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng pht"}),t.jsx("p",{className:"text-lg font-bold text-red-600",children:Ye(((T=p.tongKet)==null?void 0:T.tongPhat)??0)})]}),t.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng khu tr"}),t.jsx("p",{className:"text-lg font-bold text-orange-600",children:Ye(((S=p.tongKet)==null?void 0:S.tongKhauTru)??0)})]}),t.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng ng"}),t.jsx("p",{className:"text-lg font-bold text-purple-600",children:Ye(((w=p.tongKet)==null?void 0:w.tongUng)??0)})]}),t.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Thc nhn"}),t.jsx("p",{className:"text-lg font-bold text-blue-600",children:Ye(((_=p.tongKet)==null?void 0:_.tongThucNhan)??0)})]})]})]}),t.jsxs("div",{className:"card mb-4",children:[t.jsxs("button",{onClick:()=>y("bangLuongs"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(ei,{size:20}),"Lch s bng lng (",((E=p.bangLuongs)==null?void 0:E.length)??0,")"]}),u==="bangLuongs"?t.jsx(Ol,{}):t.jsx(Ja,{})]}),u==="bangLuongs"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Thng"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Ngy cng"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Lng c bn"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Ph cp"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Thng"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Khu tr"}),t.jsx("th",{className:"text-right py-2 px-3",children:"BHXH"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Thu TNCN"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Thc lnh"})]})}),t.jsx("tbody",{children:(C=p.bangLuongs)==null?void 0:C.map(M=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3 font-medium",children:M.thangNam}),t.jsx("td",{className:"py-2 px-3 text-right",children:M.ngayCong}),t.jsx("td",{className:"py-2 px-3 text-right",children:Ye(M.luongCoBan)}),t.jsx("td",{className:"py-2 px-3 text-right",children:Ye(M.phuCapTong)}),t.jsx("td",{className:"py-2 px-3 text-right text-green-600",children:Ye(M.thuongKPI+M.thuongThuNhap)}),t.jsx("td",{className:"py-2 px-3 text-right text-red-600",children:Ye(M.khauTruTong+M.ungLuong)}),t.jsx("td",{className:"py-2 px-3 text-right",children:Ye(M.bhxh+M.bhyt+M.bhtn)}),t.jsx("td",{className:"py-2 px-3 text-right",children:Ye(M.thueTNCN)}),t.jsx("td",{className:"py-2 px-3 text-right font-bold text-blue-600",children:Ye(M.thucLanh)})]},M.bangLuongId))})]})})]}),t.jsxs("div",{className:"card mb-4",children:[t.jsxs("button",{onClick:()=>y("dieuChinhs"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(Lt,{size:20}),"Phiu iu chnh (",((P=p.dieuChinhs)==null?void 0:P.length)??0,")"]}),u==="dieuChinhs"?t.jsx(Ol,{}):t.jsx(Ja,{})]}),u==="dieuChinhs"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Loi phiu"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Khon"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Loi khon"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Ghi ch"})]})}),t.jsx("tbody",{children:(F=p.dieuChinhs)==null?void 0:F.map((M,q)=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3",children:new Date(M.ngayTao).toLocaleDateString("vi-VN")}),t.jsx("td",{className:"py-2 px-3",children:M.loaiPhieu}),t.jsx("td",{className:"py-2 px-3",children:M.tenKhoanLuong}),t.jsx("td",{className:"py-2 px-3",children:t.jsx("span",{className:M.loaiKhoan==="CONG_THEM"?"text-green-600":"text-red-600",children:M.loaiKhoan==="CONG_THEM"?"Cng thm":"Tr bt"})}),t.jsxs("td",{className:`py-2 px-3 text-right ${M.loaiKhoan==="CONG_THEM"?"text-green-600":"text-red-600"}`,children:[M.loaiKhoan==="CONG_THEM"?"+":"-",Ye(M.soTien)]}),t.jsx("td",{className:"py-2 px-3 text-gray-500",children:M.ghiChu})]},q))})]})})]}),t.jsxs("div",{className:"card mb-4",children:[t.jsxs("button",{onClick:()=>y("ungLuongs"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(oi,{size:20}),"ng lng (",((R=p.ungLuongs)==null?void 0:R.length)??0,")"]}),u==="ungLuongs"?t.jsx(Ol,{}):t.jsx(Ja,{})]}),u==="ungLuongs"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"M bng"}),t.jsx("th",{className:"text-left py-2 px-3",children:"K"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin duyt"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Trng thi"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Ngy cht"})]})}),t.jsx("tbody",{children:(O=p.ungLuongs)==null?void 0:O.map(M=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3 font-medium",children:M.maBang}),t.jsx("td",{className:"py-2 px-3",children:M.thangNam}),t.jsx("td",{className:"py-2 px-3 text-right font-bold text-purple-600",children:Ye(M.soTienDuyet)}),t.jsx("td",{className:"py-2 px-3 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${M.trangThai==="DA_KHOA"?"bg-green-100 text-green-800":M.trangThai==="DA_CHOT"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:M.trangThai==="DA_KHOA"?" kha":M.trangThai==="DA_CHOT"?" cht":"Nhp"})}),t.jsx("td",{className:"py-2 px-3",children:M.ngayChot?new Date(M.ngayChot).toLocaleDateString("vi-VN"):"-"})]},M.bangUngLuongId))})]})})]}),p.kpis&&p.kpis.length>0&&t.jsxs("div",{className:"card mb-4",children:[t.jsxs("button",{onClick:()=>y("kpis"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(oi,{size:20}),"nh gi KPI (",p.kpis.length,")"]}),u==="kpis"?t.jsx(Ol,{}):t.jsx(Ja,{})]}),u==="kpis"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Thng"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Tng im"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Xp loi"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Tin thng"})]})}),t.jsx("tbody",{children:p.kpis.map(M=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsxs("td",{className:"py-2 px-3",children:[M.thang,"/",M.nam]}),t.jsx("td",{className:"py-2 px-3 text-right",children:M.tongDiem}),t.jsx("td",{className:"py-2 px-3 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${M.xepLoai==="A"?"bg-green-100 text-green-800":M.xepLoai==="B"?"bg-blue-100 text-blue-800":M.xepLoai==="C"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:M.xepLoai})}),t.jsx("td",{className:"py-2 px-3 text-right text-green-600",children:Ye(M.tienThuong)})]},M.kyDanhGiaId))})]})})]}),p.thuongPhats&&p.thuongPhats.length>0&&t.jsxs("div",{className:"card",children:[t.jsxs("button",{onClick:()=>y("thuongPhats"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(Lt,{size:20}),"Thng/Pht (",p.thuongPhats.length,")"]}),u==="thuongPhats"?t.jsx(Ol,{}):t.jsx(Ja,{})]}),u==="thuongPhats"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Ngy"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Loi"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Tn"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"L do"})]})}),t.jsx("tbody",{children:p.thuongPhats.map(M=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3",children:new Date(M.ngay).toLocaleDateString("vi-VN")}),t.jsx("td",{className:"py-2 px-3 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${M.loai==="THUONG"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:M.loai==="THUONG"?"Thng":"Pht"})}),t.jsx("td",{className:"py-2 px-3",children:M.ten}),t.jsxs("td",{className:`py-2 px-3 text-right ${M.loai==="THUONG"?"text-green-600":"text-red-600"}`,children:[M.loai==="THUONG"?"+":"-",Ye(M.soTien)]}),t.jsx("td",{className:"py-2 px-3 text-gray-500",children:M.lyDo})]},M.suKienId))})]})})]})]}),!a&&t.jsxs("div",{className:"card text-center py-12",children:[t.jsx(so,{size:48,className:"mx-auto text-gray-400 mb-4"}),t.jsx("p",{className:"text-gray-500",children:"Vui lng chn nhn vin  xem s lng"})]}),N&&t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})]})}function wV(){var m,f,p,N,y,g,b,j,T,S,w,_,E;const[e,n]=D.useState(null),[a,r]=D.useState(()=>{const C=new Date;return C.setMonth(C.getMonth()-11),`${C.getFullYear()}-${String(C.getMonth()+1).padStart(2,"0")}`}),[s,l]=D.useState(()=>{const C=new Date;return`${C.getFullYear()}-${String(C.getMonth()+1).padStart(2,"0")}`}),{data:o}=Le({queryKey:["phong-ban-list"],queryFn:Jt.layTatCa}),d=Array.isArray(o)?o:[],{data:u,isLoading:x}=Le({queryKey:["so-luong-pb",e,a,s],queryFn:()=>qj.layPhongBan(e,{tuThang:Number(a.split("-")[1]),tuNam:Number(a.split("-")[0]),denThang:Number(s.split("-")[1]),denNam:Number(s.split("-")[0])}),enabled:!!e});return t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"S lng phng ban"}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:e||"",onChange:C=>n(C.target.value?Number(C.target.value):null),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn phng ban --"}),d.map(C=>t.jsx("option",{value:C.id,children:C.tenPhongBan},C.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T thng"}),t.jsx(Tc,{value:a,onChange:r,className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n thng"}),t.jsx(Tc,{value:s,onChange:l,className:"w-full border rounded-lg px-3 py-2"})]})]})}),x&&t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),u&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"card mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-14 h-14 bg-blue-100 rounded-full flex items-center justify-center",children:t.jsx(Mr,{size:28,className:"text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold",children:(m=u.phongBan)==null?void 0:m.tenPhongBan}),t.jsxs("p",{className:"text-gray-500",children:["M: ",(f=u.phongBan)==null?void 0:f.maPhongBan]})]})]}),t.jsx("div",{className:"flex items-center gap-4",children:t.jsxs("button",{className:"btn btn-secondary",children:[t.jsx(ws,{size:18}),"Xut Excel"]})})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[t.jsx(on,{size:18}),t.jsx("span",{className:"text-sm",children:"S nhn vin"})]}),t.jsx("p",{className:"text-2xl font-bold text-gray-800",children:((p=u.theoNhanVien)==null?void 0:p.length)??0})]}),t.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[t.jsx(gr,{size:18}),t.jsx("span",{className:"text-sm",children:"Tng thu nhp"})]}),t.jsx("p",{className:"text-xl font-bold text-blue-600",children:Ye(((N=u.tongHop)==null?void 0:N.tongThuNhap)??0)})]}),t.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[t.jsx(oi,{size:18}),t.jsx("span",{className:"text-sm",children:"Tng thng"})]}),t.jsx("p",{className:"text-xl font-bold text-green-600",children:Ye(((y=u.tongHop)==null?void 0:y.tongThuong)??0)})]}),t.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[t.jsx(lj,{size:18}),t.jsx("span",{className:"text-sm",children:"Thc lnh"})]}),t.jsx("p",{className:"text-xl font-bold text-purple-600",children:Ye(((g=u.tongHop)==null?void 0:g.thucLinh)??0)})]})]})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["Chi tit theo nhn vin (",((b=u.theoNhanVien)==null?void 0:b.length)??0,")"]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"M NV"}),t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"H tn"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Thu nhp"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Khu tr"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Thng"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Pht"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Thc lnh"})]})}),t.jsx("tbody",{children:(j=u.theoNhanVien)==null?void 0:j.map(C=>{var P,F,R,O,M,q,J,B;return t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4 font-medium",children:(P=C.nhanVien)==null?void 0:P.maNhanVien}),t.jsx("td",{className:"py-3 px-4",children:(F=C.nhanVien)==null?void 0:F.hoTen}),t.jsx("td",{className:"py-3 px-4 text-right",children:Ye(((R=C.tongHop)==null?void 0:R.tongThuNhap)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-red-600",children:Ye(((O=C.tongHop)==null?void 0:O.tongKhauTru)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-green-600",children:Ye(((M=C.tongHop)==null?void 0:M.tongThuong)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-orange-600",children:Ye(((q=C.tongHop)==null?void 0:q.tongPhat)??0)}),t.jsx("td",{className:"py-3 px-4 text-right font-bold text-blue-600",children:Ye(((J=C.tongHop)==null?void 0:J.thucLinh)??0)})]},(B=C.nhanVien)==null?void 0:B.id)})}),t.jsx("tfoot",{className:"bg-gray-100 font-semibold",children:t.jsxs("tr",{children:[t.jsx("td",{colSpan:2,className:"py-3 px-4",children:"Tng cng"}),t.jsx("td",{className:"py-3 px-4 text-right",children:Ye(((T=u.tongHop)==null?void 0:T.tongThuNhap)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-red-600",children:Ye(((S=u.tongHop)==null?void 0:S.tongKhauTru)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-green-600",children:Ye(((w=u.tongHop)==null?void 0:w.tongThuong)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-orange-600",children:Ye(((_=u.tongHop)==null?void 0:_.tongPhat)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-blue-600",children:Ye(((E=u.tongHop)==null?void 0:E.thucLinh)??0)})]})})]})})]})]}),!e&&t.jsxs("div",{className:"card text-center py-12",children:[t.jsx(Mr,{size:48,className:"mx-auto text-gray-400 mb-4"}),t.jsx("p",{className:"text-gray-500",children:"Vui lng chn phng ban  xem s lng"})]})]})}function kV(){const[e,n]=D.useState(null),[a,r]=D.useState(null),{data:s,isLoading:l}=Le({queryKey:["khoan-luong-list"],queryFn:()=>pr.layTatCa()}),o=D.useMemo(()=>{if(!s||s.length===0)return[];const C=s.map(P=>({id:P.id,tenKhoan:P.tenKhoan,loai:P.loai}));return cw(C,!0,"CA_HAI")},[s]),{columns:d,visibleColumns:u,toggleColumn:x,moveColumn:m,resetColumns:f,showAllColumns:p}=fg("global_bang_luong",o),N=C=>{d[C].sticky||n(C)},y=(C,P)=>{C.preventDefault(),!d[P].sticky&&r(P)},g=()=>{e!==null&&a!==null&&e!==a&&(m(e,a),ie.success(" thay i th t ct")),n(null),r(null)},b=C=>{x(C);const P=d.find(F=>F.id===C);P&&ie.success(P.visible?` n ct "${P.label}"`:` hin ct "${P.label}"`)},j=()=>{f(),ie.success(" khi phc cu hnh mc nh")},T=()=>{p(),ie.success(" hin tt c cc ct")},S=d.filter(C=>C.sticky),w=d.filter(C=>!C.sticky),_=u.length,E=d.length;return l?t.jsxs("div",{className:"flex items-center justify-center h-64",children:[t.jsx(Rn,{className:"w-8 h-8 animate-spin text-blue-500"}),t.jsx("span",{className:"ml-2 text-gray-500",children:"ang ti danh sch khon lng..."})]}):t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-3",children:[t.jsx(mj,{className:"text-blue-500"}),"Cu hnh ct Bng lng"]}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Thit lp cc ct hin th v th t sp xp cho tt c bng lng"})]}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6 flex items-start gap-3",children:[t.jsx(yu,{className:"text-blue-500 flex-shrink-0 mt-0.5",size:20}),t.jsxs("div",{className:"text-sm text-blue-800",children:[t.jsx("p",{className:"font-medium mb-1",children:"Cu hnh ny p dng cho TT C bng lng"}),t.jsxs("ul",{className:"list-disc list-inside space-y-1 text-blue-700",children:[t.jsx("li",{children:"Cc ct c nh (STT, M NV, H tn) khng th n hoc di chuyn"}),t.jsx("li",{children:"Ko th  sp xp th t cc ct"}),t.jsx("li",{children:"Thay i c lu t ng"})]})]})]}),t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("div",{className:"flex items-center gap-4",children:t.jsxs("span",{className:"text-sm text-gray-600",children:["ang hin th: ",t.jsx("strong",{className:"text-blue-600",children:_})," / ",E," ct"]})}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:T,className:"flex items-center gap-2 px-3 py-2 text-sm rounded-lg bg-white border border-gray-200 hover:bg-gray-50 transition-colors",children:[t.jsx(Ra,{size:16}),"Hin tt c"]}),t.jsxs("button",{onClick:j,className:"flex items-center gap-2 px-3 py-2 text-sm rounded-lg bg-white border border-gray-200 hover:bg-gray-50 transition-colors",children:[t.jsx(vu,{size:16}),"Khi phc mc nh"]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden mb-4",children:[t.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:t.jsxs("h3",{className:"font-medium text-gray-700 flex items-center gap-2",children:[t.jsx(Gn,{size:16,className:"text-green-500"}),"Ct c nh (khng th thay i)"]})}),t.jsx("div",{className:"divide-y divide-gray-100",children:S.map(C=>t.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-gray-50/50",children:[t.jsx("div",{className:"w-6 h-6 flex items-center justify-center",children:t.jsx(rl,{size:16,className:"text-gray-300"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:C.label}),C.width&&t.jsxs("span",{className:"ml-2 text-xs text-gray-400",children:["(",C.width,")"]})]}),t.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:t.jsx(Ra,{size:16,className:"text-green-500"})})]},C.id))})]}),t.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:t.jsxs("h3",{className:"font-medium text-gray-700 flex items-center gap-2",children:[t.jsx(rl,{size:16,className:"text-gray-400"}),"Ct c th ty chnh (ko th  sp xp)"]})}),t.jsx("div",{className:"divide-y divide-gray-100",children:w.map(C=>{const P=d.findIndex(O=>O.id===C.id),F=e===P,R=a===P;return t.jsxs("div",{draggable:!C.sticky,onDragStart:()=>N(P),onDragOver:O=>y(O,P),onDragEnd:g,className:wt("flex items-center gap-3 px-4 py-3 transition-all",F&&"opacity-50 bg-blue-50",R&&"bg-blue-100 border-t-2 border-blue-400",!C.visible&&"bg-gray-50"),children:[t.jsx("div",{className:"w-6 h-6 flex items-center justify-center cursor-grab active:cursor-grabbing",children:t.jsx(rl,{size:16,className:"text-gray-400"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("span",{className:wt("text-sm font-medium",C.visible?"text-gray-700":"text-gray-400"),children:C.label}),C.bgColor&&t.jsx("span",{className:wt("ml-2 px-1.5 py-0.5 text-xs rounded",C.bgColor.replace("bg-","bg-").replace("100","200")),children:C.bgColor.replace("bg-","").replace("-100","")})]}),t.jsx("button",{onClick:()=>b(C.id),className:wt("w-8 h-8 flex items-center justify-center rounded-lg transition-colors",C.visible?"text-green-500 hover:bg-green-50":"text-gray-400 hover:bg-gray-100"),title:C.visible?"n ct":"Hin ct",children:C.visible?t.jsx(Ra,{size:16}):t.jsx(eg,{size:16})})]},C.id)})})]}),t.jsxs("div",{className:"mt-4 flex items-center justify-center gap-2 text-sm text-green-600",children:[t.jsx(Es,{size:16}),"Thay i c lu t ng"]})]})}function TV(){const[e,n]=D.useState(null),[a,r]=D.useState(null),s=D.useMemo(()=>eD(),[]),{columns:l,visibleColumns:o,toggleColumn:d,moveColumn:u,resetColumns:x,showAllColumns:m}=fg("global_ung_luong",s),f=_=>{l[_].sticky||n(_)},p=(_,E)=>{_.preventDefault(),!l[E].sticky&&r(E)},N=()=>{e!==null&&a!==null&&e!==a&&(u(e,a),ie.success(" thay i th t ct")),n(null),r(null)},y=_=>{d(_);const E=l.find(C=>C.id===_);E&&ie.success(E.visible?` n ct "${E.label}"`:` hin ct "${E.label}"`)},g=()=>{x(),ie.success(" khi phc cu hnh mc nh")},b=()=>{m(),ie.success(" hin tt c cc ct")},j=l.filter(_=>_.sticky),T=l.filter(_=>!_.sticky),S=o.length,w=l.length;return t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-3",children:[t.jsx(mj,{className:"text-purple-500"}),"Cu hnh ct Bng ng lng"]}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Thit lp cc ct hin th v th t sp xp cho tt c bng ng lng"})]}),t.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-4 mb-6 flex items-start gap-3",children:[t.jsx(yu,{className:"text-purple-500 flex-shrink-0 mt-0.5",size:20}),t.jsxs("div",{className:"text-sm text-purple-800",children:[t.jsx("p",{className:"font-medium mb-1",children:"Cu hnh ny p dng cho TT C bng ng lng"}),t.jsxs("ul",{className:"list-disc list-inside space-y-1 text-purple-700",children:[t.jsx("li",{children:"Cc ct c nh (STT, M NV, H tn) khng th n hoc di chuyn"}),t.jsx("li",{children:"Ko th  sp xp th t cc ct"}),t.jsx("li",{children:"Thay i c lu t ng"})]})]})]}),t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("div",{className:"flex items-center gap-4",children:t.jsxs("span",{className:"text-sm text-gray-600",children:["ang hin th: ",t.jsx("strong",{className:"text-purple-600",children:S})," / ",w," ct"]})}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-3 py-2 text-sm rounded-lg bg-white border border-gray-200 hover:bg-gray-50 transition-colors",children:[t.jsx(Ra,{size:16}),"Hin tt c"]}),t.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-3 py-2 text-sm rounded-lg bg-white border border-gray-200 hover:bg-gray-50 transition-colors",children:[t.jsx(vu,{size:16}),"Khi phc mc nh"]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden mb-4",children:[t.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:t.jsxs("h3",{className:"font-medium text-gray-700 flex items-center gap-2",children:[t.jsx(Gn,{size:16,className:"text-green-500"}),"Ct c nh (khng th thay i)"]})}),t.jsx("div",{className:"divide-y divide-gray-100",children:j.map(_=>t.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-gray-50/50",children:[t.jsx("div",{className:"w-6 h-6 flex items-center justify-center",children:t.jsx(rl,{size:16,className:"text-gray-300"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:_.label}),_.width&&t.jsxs("span",{className:"ml-2 text-xs text-gray-400",children:["(",_.width,")"]})]}),t.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:t.jsx(Ra,{size:16,className:"text-green-500"})})]},_.id))})]}),t.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:t.jsxs("h3",{className:"font-medium text-gray-700 flex items-center gap-2",children:[t.jsx(rl,{size:16,className:"text-gray-400"}),"Ct c th ty chnh (ko th  sp xp)"]})}),t.jsx("div",{className:"divide-y divide-gray-100",children:T.map(_=>{const E=l.findIndex(F=>F.id===_.id),C=e===E,P=a===E;return t.jsxs("div",{draggable:!_.sticky,onDragStart:()=>f(E),onDragOver:F=>p(F,E),onDragEnd:N,className:wt("flex items-center gap-3 px-4 py-3 transition-all",C&&"opacity-50 bg-purple-50",P&&"bg-purple-100 border-t-2 border-purple-400",!_.visible&&"bg-gray-50"),children:[t.jsx("div",{className:"w-6 h-6 flex items-center justify-center cursor-grab active:cursor-grabbing",children:t.jsx(rl,{size:16,className:"text-gray-400"})}),t.jsx("div",{className:"flex-1",children:t.jsx("span",{className:wt("text-sm font-medium",_.visible?"text-gray-700":"text-gray-400"),children:_.label})}),t.jsx("button",{onClick:()=>y(_.id),className:wt("w-8 h-8 flex items-center justify-center rounded-lg transition-colors",_.visible?"text-green-500 hover:bg-green-50":"text-gray-400 hover:bg-gray-100"),title:_.visible?"n ct":"Hin ct",children:_.visible?t.jsx(Ra,{size:16}):t.jsx(eg,{size:16})})]},_.id)})})]}),t.jsxs("div",{className:"mt-4 flex items-center justify-center gap-2 text-sm text-green-600",children:[t.jsx(Es,{size:16}),"Thay i c lu t ng"]})]})}const CV="tinh_luong_auth",oa=Zt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});oa.interceptors.request.use(e=>{const n=localStorage.getItem(CV);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const Ma={layDanhSachLoaiNghi:(e=!1)=>oa.get("/nghi-phep/loai-nghi",{params:{all:e}}).then(n=>n.data),layLoaiNghi:e=>oa.get(`/nghi-phep/loai-nghi/${e}`).then(n=>n.data),taoLoaiNghi:e=>oa.post("/nghi-phep/loai-nghi",e).then(n=>n.data),capNhatLoaiNghi:(e,n)=>oa.put(`/nghi-phep/loai-nghi/${e}`,n).then(a=>a.data),toggleLoaiNghi:e=>oa.post(`/nghi-phep/loai-nghi/${e}/toggle`).then(n=>n.data),layDanhSachDon:e=>oa.get("/nghi-phep/don",{params:e}).then(n=>n.data),layChiTietDon:e=>oa.get(`/nghi-phep/don/${e}`).then(n=>n.data),taoDon:e=>oa.post("/nghi-phep/don",e).then(n=>n.data),capNhatDon:(e,n)=>oa.put(`/nghi-phep/don/${e}`,n).then(a=>a.data),guiDuyet:e=>oa.post(`/nghi-phep/don/${e}/gui-duyet`).then(n=>n.data),duyetDon:(e,n)=>oa.post(`/nghi-phep/don/${e}/duyet`,{ghiChu:n}).then(a=>a.data),tuChoiDon:(e,n)=>oa.post(`/nghi-phep/don/${e}/tu-choi`,{lyDoTuChoi:n}).then(a=>a.data),huyDon:(e,n)=>oa.post(`/nghi-phep/don/${e}/huy`,{lyDo:n}).then(a=>a.data),rebuildMapping:e=>oa.post(`/nghi-phep/don/${e}/mapping/rebuild`).then(n=>n.data),layLichNghi:e=>oa.get("/nghi-phep/lich",{params:e}).then(n=>n.data),layLichNghiNhanVien:(e,n,a)=>oa.get(`/nghi-phep/nhan-vien/${e}/lich`,{params:{tuNgay:n,denNgay:a}}).then(r=>r.data)},U0=e=>({NHAP:"Nhp",GUI_DUYET:"Ch duyt",DA_DUYET:" duyt",TU_CHOI:"T chi",HUY:" hy"})[e]||e,Zi=e=>({NHAP:"gray",GUI_DUYET:"blue",DA_DUYET:"green",TU_CHOI:"red",HUY:"gray"})[e]||"gray",SV=e=>({CO_PHEP:"C php",KHONG_PHEP:"Khng php"})[e]||e;function _V(){const e=Mt(),[n,a]=D.useState(!1),[r,s]=D.useState(null),[l,o]=D.useState(!1),[d,u]=D.useState({maLoaiNghi:"",tenLoaiNghi:"",nhomLoai:"CO_PHEP",coTinhLuong:!0,coTinhChuyenCan:!1,thuTuHienThi:0}),{data:x,isLoading:m}=Le({queryKey:["loai-nghi",l],queryFn:()=>Ma.layDanhSachLoaiNghi(l)}),f=De({mutationFn:Ma.taoLoaiNghi,onSuccess:()=>{e.invalidateQueries({queryKey:["loai-nghi"]}),ie.success("To loi ngh thnh cng!"),y()},onError:j=>{var T,S;ie.error(((S=(T=j.response)==null?void 0:T.data)==null?void 0:S.message)||"C li xy ra")}}),p=De({mutationFn:({id:j,data:T})=>Ma.capNhatLoaiNghi(j,T),onSuccess:()=>{e.invalidateQueries({queryKey:["loai-nghi"]}),ie.success("Cp nht thnh cng!"),y()},onError:j=>{var T,S;ie.error(((S=(T=j.response)==null?void 0:T.data)==null?void 0:S.message)||"C li xy ra")}}),N=De({mutationFn:Ma.toggleLoaiNghi,onSuccess:j=>{e.invalidateQueries({queryKey:["loai-nghi"]}),ie.success(j.isActive?" kch hot":" v hiu ha")},onError:j=>{var T,S;ie.error(((S=(T=j.response)==null?void 0:T.data)==null?void 0:S.message)||"C li xy ra")}}),y=()=>{a(!1),s(null),u({maLoaiNghi:"",tenLoaiNghi:"",nhomLoai:"CO_PHEP",coTinhLuong:!0,coTinhChuyenCan:!1,thuTuHienThi:0})},g=j=>{s(j),u({maLoaiNghi:j.maLoaiNghi,tenLoaiNghi:j.tenLoaiNghi,nhomLoai:j.nhomLoai,coTinhLuong:j.coTinhLuong,coTinhChuyenCan:j.coTinhChuyenCan,thuTuHienThi:j.thuTuHienThi}),a(!0)},b=()=>{if(!d.maLoaiNghi||!d.tenLoaiNghi){ie.error("Vui lng in y  thng tin bt buc");return}if(r){const{maLoaiNghi:j,...T}=d;p.mutate({id:r.id,data:T})}else f.mutate(d)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Lt,{className:"w-8 h-8 text-indigo-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Danh mc loi ngh"}),t.jsx("p",{className:"text-gray-500",children:"Qun l cc loi ngh php trong h thng"})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[t.jsx("input",{type:"checkbox",checked:l,onChange:j=>o(j.target.checked),className:"rounded border-gray-300"}),"Hin th tt c"]}),t.jsxs("button",{onClick:()=>{y(),a(!0)},className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:[t.jsx(Dt,{className:"w-4 h-4"}),"Thm loi ngh"]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tn loi ngh"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nhm"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Tnh lng"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Tnh chuyn cn"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"ang ti..."})}):(x==null?void 0:x.length)===0?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"Cha c loi ngh no"})}):x==null?void 0:x.map(j=>t.jsxs("tr",{className:j.isActive?"":"bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-mono text-sm text-gray-900",children:j.maLoaiNghi}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:j.tenLoaiNghi}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${j.nhomLoai==="CO_PHEP"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:SV(j.nhomLoai)})}),t.jsx("td",{className:"px-6 py-4 text-center",children:j.coTinhLuong?t.jsx("span",{className:"text-green-600",children:""}):t.jsx("span",{className:"text-gray-400",children:""})}),t.jsx("td",{className:"px-6 py-4 text-center",children:j.coTinhChuyenCan?t.jsx("span",{className:"text-green-600",children:""}):t.jsx("span",{className:"text-gray-400",children:""})}),t.jsx("td",{className:"px-6 py-4 text-center",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${j.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:j.isActive?"Hot ng":"V hiu"})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[t.jsx("button",{onClick:()=>g(j),className:"text-indigo-600 hover:text-indigo-900 mr-3",title:"Sa",children:t.jsx(Za,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>N.mutate(j.id),className:`${j.isActive?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900"}`,title:j.isActive?"V hiu ha":"Kch hot",children:t.jsx(V_,{className:"w-4 h-4"})})]})]},j.id))})]})}),n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:r?"Sa loi ngh":"Thm loi ngh mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["M loi ngh ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:d.maLoaiNghi,onChange:j=>u({...d,maLoaiNghi:j.target.value.toUpperCase()}),disabled:!!r,className:"w-full border rounded-lg px-3 py-2 disabled:bg-gray-100",placeholder:"VD: PHEP_NAM"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn loi ngh ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:d.tenLoaiNghi,onChange:j=>u({...d,tenLoaiNghi:j.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Php nm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nhm loi ngh"}),t.jsxs("select",{value:d.nhomLoai,onChange:j=>u({...d,nhomLoai:j.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"CO_PHEP",children:"C php"}),t.jsx("option",{value:"KHONG_PHEP",children:"Khng php"})]})]}),t.jsxs("div",{className:"flex gap-6",children:[t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:d.coTinhLuong,onChange:j=>u({...d,coTinhLuong:j.target.checked}),className:"rounded border-gray-300"}),t.jsx("span",{className:"text-sm text-gray-700",children:"C tnh lng"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:d.coTinhChuyenCan,onChange:j=>u({...d,coTinhChuyenCan:j.target.checked}),className:"rounded border-gray-300"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Tnh chuyn cn"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Th t hin th"}),t.jsx("input",{type:"number",min:"0",value:d.thuTuHienThi,onChange:j=>u({...d,thuTuHienThi:parseInt(j.target.value)||0}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:y,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Hy"}),t.jsx("button",{onClick:b,disabled:f.isPending||p.isPending,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:f.isPending||p.isPending?"ang x l...":r?"Cp nht":"Thm mi"})]})]})})]})}function EV(){var O,M;const e=Mt(),{user:n}=is(),[a,r]=D.useState(!1),[s,l]=D.useState(null),[o,d]=D.useState(null),[u,x]=D.useState(""),[m,f]=D.useState(null),[p,N]=D.useState({nhanVienId:0,loaiNghiId:0,tuNgay:"",denNgay:"",lyDo:""}),{data:y}=Le({queryKey:["loai-nghi"],queryFn:()=>Ma.layDanhSachLoaiNghi()}),{data:g}=Le({queryKey:["nhan-vien-don-gian"],queryFn:()=>ha.layTatCa()});D.useEffect(()=>{if(g&&n){const J=(Array.isArray(g)?g:g.data||[]).find(B=>B.email===n.email||B.id===n.nhanVienId);J&&(f(J),N(B=>({...B,nhanVienId:J.id})))}},[g,n]);const{data:b,isLoading:j}=Le({queryKey:["don-nghi-phep",u,m==null?void 0:m.id],queryFn:()=>Ma.layDanhSachDon({nhanVienId:m==null?void 0:m.id,trangThai:u||void 0,limit:50}),enabled:!!m}),T=De({mutationFn:Ma.taoDon,onSuccess:()=>{e.invalidateQueries({queryKey:["don-nghi-phep"]}),ie.success("To n ngh php thnh cng!"),E()},onError:q=>{var J,B;ie.error(((B=(J=q.response)==null?void 0:J.data)==null?void 0:B.message)||"C li xy ra")}}),S=De({mutationFn:({id:q,data:J})=>Ma.capNhatDon(q,J),onSuccess:()=>{e.invalidateQueries({queryKey:["don-nghi-phep"]}),ie.success("Cp nht n thnh cng!"),E()},onError:q=>{var J,B;ie.error(((B=(J=q.response)==null?void 0:J.data)==null?void 0:B.message)||"C li xy ra")}}),w=De({mutationFn:Ma.guiDuyet,onSuccess:()=>{e.invalidateQueries({queryKey:["don-nghi-phep"]}),ie.success(" gi n  duyt!")},onError:q=>{var J,B;ie.error(((B=(J=q.response)==null?void 0:J.data)==null?void 0:B.message)||"C li xy ra")}}),_=De({mutationFn:q=>Ma.huyDon(q),onSuccess:()=>{e.invalidateQueries({queryKey:["don-nghi-phep"]}),ie.success(" hy n!")},onError:q=>{var J,B;ie.error(((B=(J=q.response)==null?void 0:J.data)==null?void 0:B.message)||"C li xy ra")}}),E=()=>{r(!1),l(null),N({nhanVienId:(m==null?void 0:m.id)||0,loaiNghiId:0,tuNgay:"",denNgay:"",lyDo:""})},C=q=>{l(q),N({nhanVienId:q.nhanVien.id,loaiNghiId:q.loaiNghi.id,tuNgay:q.tuNgay.split("T")[0],denNgay:q.denNgay.split("T")[0],lyDo:q.lyDo||""}),r(!0)},P=()=>{if(!p.loaiNghiId||!p.tuNgay||!p.denNgay){ie.error("Vui lng in y  thng tin bt buc");return}if(new Date(p.tuNgay)>new Date(p.denNgay)){ie.error("Ngy bt u phi nh hn hoc bng ngy kt thc");return}s?S.mutate({id:s.id,data:{loaiNghiId:p.loaiNghiId,tuNgay:p.tuNgay,denNgay:p.denNgay,lyDo:p.lyDo}}):T.mutate(p)},F=()=>{if(!p.tuNgay||!p.denNgay)return 0;const q=new Date(p.tuNgay),J=new Date(p.denNgay);let B=0;for(let ue=new Date(q);ue<=J;ue.setDate(ue.getDate()+1)){const te=ue.getDay();te!==0&&te!==6&&B++}return B},R=q=>new Date(q).toLocaleDateString("vi-VN");return m?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(ma,{className:"w-8 h-8 text-indigo-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"n ngh ca ti"}),t.jsxs("p",{className:"text-gray-500",children:[m.hoTen," - ",m.maNhanVien]})]})]}),t.jsxs("button",{onClick:()=>{E(),r(!0)},className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:[t.jsx(Dt,{className:"w-4 h-4"}),"To n ngh"]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Lc theo trng thi:"}),t.jsxs("select",{value:u,onChange:q=>x(q.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"NHAP",children:"Nhp"}),t.jsx("option",{value:"GUI_DUYET",children:"Ch duyt"}),t.jsx("option",{value:"DA_DUYET",children:" duyt"}),t.jsx("option",{value:"TU_CHOI",children:"T chi"}),t.jsx("option",{value:"HUY",children:" hy"})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M n"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Loi ngh"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"T ngy"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"n ngy"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"S ngy"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"ang ti..."})}):((O=b==null?void 0:b.items)==null?void 0:O.length)===0?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"Cha c n ngh no"})}):(M=b==null?void 0:b.items)==null?void 0:M.map(q=>t.jsxs("tr",{children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-mono text-sm text-gray-900",children:q.maDon}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:q.loaiNghi.tenLoaiNghi}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:R(q.tuNgay)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:R(q.denNgay)}),t.jsx("td",{className:"px-6 py-4 text-center text-sm text-gray-900",children:q.soNgayNghi}),t.jsx("td",{className:"px-6 py-4 text-center",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full bg-${Zi(q.trangThai)}-100 text-${Zi(q.trangThai)}-800`,children:U0(q.trangThai)})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[t.jsx("button",{onClick:()=>d(q),className:"text-gray-600 hover:text-gray-900 mr-2",title:"Xem chi tit",children:t.jsx(Ra,{className:"w-4 h-4"})}),(q.trangThai==="NHAP"||q.trangThai==="TU_CHOI")&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>C(q),className:"text-indigo-600 hover:text-indigo-900 mr-2",title:"Sa",children:t.jsx(Za,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>w.mutate(q.id),className:"text-blue-600 hover:text-blue-900 mr-2",title:"Gi duyt",children:t.jsx(bu,{className:"w-4 h-4"})})]}),q.trangThai!=="HUY"&&q.trangThai!=="DA_DUYET"&&t.jsx("button",{onClick:()=>{confirm("Bn c chc mun hy n ny?")&&_.mutate(q.id)},className:"text-red-600 hover:text-red-900",title:"Hy n",children:t.jsx(mn,{className:"w-4 h-4"})})]})]},q.id))})]})}),a&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:s?"Sa n ngh php":"To n ngh php mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Loi ngh ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("select",{value:p.loaiNghiId,onChange:q=>N({...p,loaiNghiId:parseInt(q.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn loi ngh --"}),y==null?void 0:y.map(q=>t.jsxs("option",{value:q.id,children:[q.tenLoaiNghi," (",q.coTinhLuong?"C lng":"Khng lng",")"]},q.id))]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["T ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ut,{value:p.tuNgay,onChange:q=>N({...p,tuNgay:q}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["n ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ut,{value:p.denNgay,onChange:q=>N({...p,denNgay:q}),className:"w-full border rounded-lg px-3 py-2"})]})]}),p.tuNgay&&p.denNgay&&t.jsx("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:t.jsxs("span",{className:"text-blue-700 font-medium",children:["S ngy ngh (khng tnh T7, CN): ",F()," ngy"]})}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"L do ngh"}),t.jsx("textarea",{value:p.lyDo,onChange:q=>N({...p,lyDo:q.target.value}),rows:3,className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp l do ngh (ty chn)"})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:E,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Hy"}),t.jsx("button",{onClick:P,disabled:T.isPending||S.isPending,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:T.isPending||S.isPending?"ang x l...":s?"Cp nht":"To n"})]})]})}),o&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h2",{className:"text-xl font-bold",children:"Chi tit n ngh"}),t.jsx("button",{onClick:()=>d(null),className:"text-gray-500 hover:text-gray-700",children:t.jsx(mn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"M n"}),t.jsx("p",{className:"font-mono font-medium",children:o.maDon})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Trng thi"}),t.jsx("p",{children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full bg-${Zi(o.trangThai)}-100 text-${Zi(o.trangThai)}-800`,children:U0(o.trangThai)})})]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Loi ngh"}),t.jsx("p",{className:"font-medium",children:o.loaiNghi.tenLoaiNghi})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"T ngy"}),t.jsx("p",{className:"font-medium",children:R(o.tuNgay)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"n ngy"}),t.jsx("p",{className:"font-medium",children:R(o.denNgay)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"S ngy"}),t.jsx("p",{className:"font-medium",children:o.soNgayNghi})]})]}),o.lyDo&&t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"L do"}),t.jsx("p",{className:"text-gray-700",children:o.lyDo})]}),o.nguoiDuyet&&t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Ngi duyt"}),t.jsx("p",{className:"font-medium",children:o.nguoiDuyet.hoTen}),o.ngayDuyet&&t.jsxs("p",{className:"text-sm text-gray-500",children:["Ngy duyt: ",R(o.ngayDuyet)]})]}),o.lyDoTuChoi&&t.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[t.jsx("span",{className:"text-sm text-red-600 font-medium",children:"L do t chi:"}),t.jsx("p",{className:"text-red-700",children:o.lyDoTuChoi})]})]}),t.jsx("div",{className:"flex justify-end mt-6",children:t.jsx("button",{onClick:()=>d(null),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"ng"})})]})})]}):t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Lt,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),t.jsx("p",{className:"text-gray-500",children:"ang ti thng tin nhn vin..."})]})})}function DV(){var T,S;const e=Mt(),[n,a]=D.useState(null),[r,s]=D.useState(null),[l,o]=D.useState(""),[d,u]=D.useState({phongBanId:void 0,trangThai:"GUI_DUYET",tuNgay:"",denNgay:"",page:1}),{data:x}=Le({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),{data:m,isLoading:f,refetch:p}=Le({queryKey:["don-nghi-phep-duyet",d],queryFn:()=>Ma.layDanhSachDon({phongBanId:d.phongBanId,trangThai:d.trangThai||void 0,tuNgay:d.tuNgay||void 0,denNgay:d.denNgay||void 0,page:d.page,limit:20})}),N=De({mutationFn:w=>Ma.duyetDon(w),onSuccess:w=>{e.invalidateQueries({queryKey:["don-nghi-phep-duyet"]}),ie.success(` duyt n ${w.maDon}!`)},onError:w=>{var _,E;ie.error(((E=(_=w.response)==null?void 0:_.data)==null?void 0:E.message)||"C li xy ra khi duyt")}}),y=De({mutationFn:({id:w,lyDo:_})=>Ma.tuChoiDon(w,_),onSuccess:w=>{e.invalidateQueries({queryKey:["don-nghi-phep-duyet"]}),ie.success(` t chi n ${w.maDon}`),s(null),o("")},onError:w=>{var _,E;ie.error(((E=(_=w.response)==null?void 0:_.data)==null?void 0:E.message)||"C li xy ra")}}),g=De({mutationFn:Ma.rebuildMapping,onSuccess:w=>{ie.success(` rebuild mapping: ${w.soNgayTao} ngy`)},onError:w=>{var _,E;ie.error(((E=(_=w.response)==null?void 0:_.data)==null?void 0:E.message)||"C li xy ra")}}),b=w=>new Date(w).toLocaleDateString("vi-VN"),j=()=>{if(r){if(!l.trim()){ie.error("Vui lng nhp l do t chi");return}y.mutate({id:r.id,lyDo:l})}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Gn,{className:"w-8 h-8 text-green-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Duyt ngh php"}),t.jsx("p",{className:"text-gray-500",children:"Xem xt v ph duyt n ngh php ca nhn vin"})]})]}),t.jsxs("button",{onClick:()=>p(),className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-800",children:[t.jsx(yr,{className:"w-4 h-4"}),"Lm mi"]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t.jsx(tg,{className:"w-4 h-4 inline mr-1"}),"Phng ban"]}),t.jsxs("select",{value:d.phongBanId||"",onChange:w=>u({...d,phongBanId:w.target.value?parseInt(w.target.value):void 0,page:1}),className:"border rounded-lg px-3 py-2 min-w-[180px]",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),x==null?void 0:x.map(w=>t.jsx("option",{value:w.id,children:w.tenPhongBan},w.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng thi"}),t.jsxs("select",{value:d.trangThai,onChange:w=>u({...d,trangThai:w.target.value,page:1}),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"GUI_DUYET",children:"Ch duyt"}),t.jsx("option",{value:"DA_DUYET",children:" duyt"}),t.jsx("option",{value:"TU_CHOI",children:"T chi"}),t.jsx("option",{value:"NHAP",children:"Nhp"}),t.jsx("option",{value:"HUY",children:" hy"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T ngy"}),t.jsx(Ut,{value:d.tuNgay,onChange:w=>u({...d,tuNgay:w,page:1}),className:"border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n ngy"}),t.jsx(Ut,{value:d.denNgay,onChange:w=>u({...d,denNgay:w,page:1}),className:"border rounded-lg px-3 py-2"})]}),t.jsx("button",{onClick:()=>u({phongBanId:void 0,trangThai:"GUI_DUYET",tuNgay:"",denNgay:"",page:1}),className:"px-3 py-2 text-sm text-gray-600 hover:text-gray-800",children:"t li"})]})}),t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M n"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Loi ngh"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"S ngy"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-4 text-center text-gray-500",children:"ang ti..."})}):((T=m==null?void 0:m.items)==null?void 0:T.length)===0?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-4 text-center text-gray-500",children:"Khng c n ngh php no"})}):(S=m==null?void 0:m.items)==null?void 0:S.map(w=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 whitespace-nowrap font-mono text-sm text-gray-900",children:w.maDon}),t.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:w.nhanVien.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:w.nhanVien.maNhanVien})]}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:w.phongBan.tenPhongBan}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:w.loaiNghi.tenLoaiNghi}),t.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:[b(w.tuNgay)," - ",b(w.denNgay)]}),t.jsx("td",{className:"px-4 py-3 text-center text-sm font-medium text-gray-900",children:w.soNgayNghi}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full bg-${Zi(w.trangThai)}-100 text-${Zi(w.trangThai)}-800`,children:U0(w.trangThai)})}),t.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm font-medium",children:[t.jsx("button",{onClick:()=>a(w),className:"text-gray-600 hover:text-gray-900 mr-2",title:"Xem chi tit",children:t.jsx(Ra,{className:"w-4 h-4"})}),w.trangThai==="GUI_DUYET"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>N.mutate(w.id),disabled:N.isPending,className:"text-green-600 hover:text-green-900 mr-2",title:"Duyt",children:t.jsx(Br,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>s(w),className:"text-red-600 hover:text-red-900",title:"T chi",children:t.jsx(mo,{className:"w-4 h-4"})})]}),w.trangThai==="DA_DUYET"&&t.jsx("button",{onClick:()=>g.mutate(w.id),disabled:g.isPending,className:"text-blue-600 hover:text-blue-900",title:"Rebuild mapping",children:t.jsx(yr,{className:"w-4 h-4"})})]})]},w.id))})]}),(m==null?void 0:m.pagination)&&m.pagination.totalPages>1&&t.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 flex items-center justify-between",children:[t.jsxs("div",{className:"text-sm text-gray-500",children:["Trang ",m.pagination.page," / ",m.pagination.totalPages," (",m.pagination.total," n)"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>u({...d,page:d.page-1}),disabled:d.page<=1,className:"p-2 text-gray-600 hover:text-gray-900 disabled:opacity-50",children:t.jsx(Nr,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>u({...d,page:d.page+1}),disabled:d.page>=m.pagination.totalPages,className:"p-2 text-gray-600 hover:text-gray-900 disabled:opacity-50",children:t.jsx(qn,{className:"w-4 h-4"})})]})]})]}),n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h2",{className:"text-xl font-bold",children:"Chi tit n ngh"}),t.jsx("button",{onClick:()=>a(null),className:"text-gray-500 hover:text-gray-700",children:t.jsx(mn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"M n"}),t.jsx("p",{className:"font-mono font-medium",children:n.maDon})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Trng thi"}),t.jsx("p",{children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full bg-${Zi(n.trangThai)}-100 text-${Zi(n.trangThai)}-800`,children:U0(n.trangThai)})})]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Nhn vin"}),t.jsxs("p",{className:"font-medium",children:[n.nhanVien.hoTen," (",n.nhanVien.maNhanVien,")"]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Phng ban"}),t.jsx("p",{className:"font-medium",children:n.phongBan.tenPhongBan})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Loi ngh"}),t.jsx("p",{className:"font-medium",children:n.loaiNghi.tenLoaiNghi})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"T ngy"}),t.jsx("p",{className:"font-medium",children:b(n.tuNgay)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"n ngy"}),t.jsx("p",{className:"font-medium",children:b(n.denNgay)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"S ngy"}),t.jsx("p",{className:"font-medium",children:n.soNgayNghi})]})]}),n.lyDo&&t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"L do"}),t.jsx("p",{className:"text-gray-700",children:n.lyDo})]}),n.nguoiDuyet&&t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Ngi duyt"}),t.jsx("p",{className:"font-medium",children:n.nguoiDuyet.hoTen}),n.ngayDuyet&&t.jsxs("p",{className:"text-sm text-gray-500",children:["Ngy duyt: ",b(n.ngayDuyet)]})]}),n.lyDoTuChoi&&t.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[t.jsx("span",{className:"text-sm text-red-600 font-medium",children:"L do t chi:"}),t.jsx("p",{className:"text-red-700",children:n.lyDoTuChoi})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[n.trangThai==="GUI_DUYET"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>{a(null),s(n)},className:"px-4 py-2 text-red-600 hover:text-red-800",children:"T chi"}),t.jsx("button",{onClick:()=>{N.mutate(n.id),a(null)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Duyt n"})]}),t.jsx("button",{onClick:()=>a(null),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"ng"})]})]})}),r&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4 text-red-600",children:"T chi n ngh"}),t.jsxs("p",{className:"text-gray-600 mb-4",children:["T chi n ",t.jsx("strong",{children:r.maDon})," ca"," ",t.jsx("strong",{children:r.nhanVien.hoTen}),"?"]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["L do t chi ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("textarea",{value:l,onChange:w=>o(w.target.value),rows:3,className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp l do t chi..."})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:()=>{s(null),o("")},className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Hy"}),t.jsx("button",{onClick:j,disabled:y.isPending,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:y.isPending?"ang x l...":"T chi"})]})]})})]})}function AV(){const[e,n]=D.useState(()=>{const y=new Date;return`${y.getFullYear()}-${String(y.getMonth()+1).padStart(2,"0")}`}),[a,r]=D.useState(),{tuNgay:s,denNgay:l}=D.useMemo(()=>{const[y,g]=e.split("-").map(Number),b=new Date(y,g-1,1),j=new Date(y,g,0);return{tuNgay:b.toISOString().split("T")[0],denNgay:j.toISOString().split("T")[0]}},[e]),{data:o}=Le({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),{data:d,isLoading:u}=Le({queryKey:["lich-nghi",s,l,a],queryFn:()=>Ma.layLichNghi({phongBanId:a,tuNgay:s,denNgay:l})}),x=D.useMemo(()=>{const[y,g]=e.split("-").map(Number),b=new Date(y,g-1,1),j=new Date(y,g,0),T=[];for(let S=new Date(b);S<=j;S.setDate(S.getDate()+1))T.push(new Date(S));return T},[e]),m=D.useMemo(()=>{const y=new Map;return d==null||d.forEach(g=>{g.chiTietNgays.forEach(b=>{const j=`${g.nhanVien.id}-${b.ngay.split("T")[0]}`;y.set(j,{loaiNghi:b.loaiNghi.tenLoaiNghi,nhomLoai:b.loaiNghi.nhomLoai})})}),y},[d]),f=y=>{const[g,b]=e.split("-").map(Number),j=new Date(g,b-1+y,1);n(`${j.getFullYear()}-${String(j.getMonth()+1).padStart(2,"0")}`)},p=()=>{const[y,g]=e.split("-").map(Number);return`Thng ${g}/${y}`},N=y=>{const g=y.getDay();return g===0||g===6};return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Lt,{className:"w-8 h-8 text-indigo-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Lch ngh php"}),t.jsx("p",{className:"text-gray-500",children:"Xem tng quan lch ngh php ca nhn vin"})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>f(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:t.jsx(Nr,{className:"w-5 h-5"})}),t.jsx("h2",{className:"text-lg font-semibold min-w-[140px] text-center",children:p()}),t.jsx("button",{onClick:()=>f(1),className:"p-2 hover:bg-gray-100 rounded-lg",children:t.jsx(qn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(tg,{className:"w-4 h-4 text-gray-500"}),t.jsxs("select",{value:a||"",onChange:y=>r(y.target.value?parseInt(y.target.value):void 0),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),o==null?void 0:o.map(y=>t.jsx("option",{value:y.id,children:y.tenPhongBan},y.id))]})]})]})}),t.jsxs("div",{className:"flex gap-4 text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"w-4 h-4 bg-green-200 rounded"}),t.jsx("span",{children:"Ngh c php"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"w-4 h-4 bg-red-200 rounded"}),t.jsx("span",{children:"Ngh khng php"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"w-4 h-4 bg-gray-200 rounded"}),t.jsx("span",{children:"Cui tun"})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:u?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"ang ti..."}):d!=null&&d.length?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"sticky left-0 bg-gray-50 px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase min-w-[200px] border-r",children:"Nhn vin"}),x.map(y=>t.jsxs("th",{className:`px-2 py-3 text-center text-xs font-medium uppercase min-w-[36px] ${N(y)?"bg-gray-100 text-gray-400":"text-gray-500"}`,children:[t.jsx("div",{children:y.getDate()}),t.jsx("div",{className:"text-[10px] font-normal",children:["CN","T2","T3","T4","T5","T6","T7"][y.getDay()]})]},y.toISOString()))]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:d.map(y=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsxs("td",{className:"sticky left-0 bg-white px-4 py-2 border-r",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:y.nhanVien.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:y.nhanVien.maNhanVien})]}),x.map(g=>{const b=g.toISOString().split("T")[0],j=`${y.nhanVien.id}-${b}`,T=m.get(j);return t.jsx("td",{className:`px-1 py-2 text-center ${N(g)?"bg-gray-50":""}`,children:T&&t.jsx("div",{className:`w-6 h-6 mx-auto rounded-full flex items-center justify-center text-xs font-medium cursor-pointer ${T.nhomLoai==="CO_PHEP"?"bg-green-200 text-green-800":"bg-red-200 text-red-800"}`,title:T.loaiNghi,children:T.nhomLoai==="CO_PHEP"?"P":"K"})},g.toISOString())})]},y.nhanVien.id))})]})}):t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Khng c lch ngh php trong thng ny"})}),d&&d.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsxs("h3",{className:"font-medium text-gray-700 mb-3",children:["Thng k thng ",p()]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:d.length}),t.jsx("div",{className:"text-sm text-gray-500",children:"Nhn vin c ngh"})]}),t.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:d.reduce((y,g)=>y+g.chiTietNgays.filter(b=>b.loaiNghi.nhomLoai==="CO_PHEP").length,0)}),t.jsx("div",{className:"text-sm text-gray-500",children:"Ngy ngh c php"})]}),t.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-red-600",children:d.reduce((y,g)=>y+g.chiTietNgays.filter(b=>b.loaiNghi.nhomLoai==="KHONG_PHEP").length,0)}),t.jsx("div",{className:"text-sm text-gray-500",children:"Ngy ngh khng php"})]}),t.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:d.reduce((y,g)=>y+g.chiTietNgays.length,0)}),t.jsx("div",{className:"text-sm text-gray-500",children:"Tng ngy ngh"})]})]})]})]})}const ac={layDanhSach:async e=>(await he.get("/ca-lam-viec",{params:e})).data,layDanhSachActive:async e=>(await he.get("/ca-lam-viec/active",{params:{phongBanId:e}})).data,layChiTiet:async e=>(await he.get(`/ca-lam-viec/${e}`)).data,tao:async e=>(await he.post("/ca-lam-viec",e)).data,capNhat:async(e,n)=>(await he.put(`/ca-lam-viec/${e}`,n)).data,xoa:async e=>(await he.delete(`/ca-lam-viec/${e}`)).data,toggleTrangThai:async e=>(await he.patch(`/ca-lam-viec/${e}/toggle`)).data},_d=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#06B6D4","#84CC16"];function FV(){const e=Mt(),[n,a]=D.useState(!1),[r,s]=D.useState(null),[l,o]=D.useState(""),[d,u]=D.useState(),[x,m]=D.useState(),[f,p]=D.useState({maCa:"",tenCa:"",gioVao:"08:00",gioRa:"17:00",nghiGiuaCaPhut:60,graceInPhut:5,graceLatePhut:5,isCaDem:!1,phongBanId:void 0,moTa:"",mauHienThi:_d[0]}),{data:N,isLoading:y}=Le({queryKey:["ca-lam-viec",d,x,l],queryFn:()=>ac.layDanhSach({phongBanId:d,trangThai:x,tuKhoa:l||void 0})}),{data:g}=Le({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),b=De({mutationFn:ac.tao,onSuccess:()=>{e.invalidateQueries({queryKey:["ca-lam-viec"]}),ie.success("To ca lm vic thnh cng"),E()},onError:O=>{var M,q;ie.error(((q=(M=O.response)==null?void 0:M.data)==null?void 0:q.message)||"C li xy ra")}}),j=De({mutationFn:({id:O,data:M})=>ac.capNhat(O,M),onSuccess:()=>{e.invalidateQueries({queryKey:["ca-lam-viec"]}),ie.success("Cp nht thnh cng"),E()},onError:O=>{var M,q;ie.error(((q=(M=O.response)==null?void 0:M.data)==null?void 0:q.message)||"C li xy ra")}}),T=De({mutationFn:ac.xoa,onSuccess:()=>{e.invalidateQueries({queryKey:["ca-lam-viec"]}),ie.success(" xa ca lm vic")},onError:O=>{var M,q;ie.error(((q=(M=O.response)==null?void 0:M.data)==null?void 0:q.message)||"C li xy ra")}}),S=De({mutationFn:ac.toggleTrangThai,onSuccess:O=>{e.invalidateQueries({queryKey:["ca-lam-viec"]}),ie.success(O.trangThai?" kch hot ca":" v hiu ha ca")}}),w=()=>{s(null),p({maCa:"",tenCa:"",gioVao:"08:00",gioRa:"17:00",nghiGiuaCaPhut:60,graceInPhut:5,graceLatePhut:5,isCaDem:!1,phongBanId:void 0,moTa:"",mauHienThi:_d[Math.floor(Math.random()*_d.length)]}),a(!0)},_=O=>{s(O),p({maCa:O.maCa,tenCa:O.tenCa,gioVao:O.gioVao,gioRa:O.gioRa,nghiGiuaCaPhut:O.nghiGiuaCaPhut,graceInPhut:O.graceInPhut,graceLatePhut:O.graceLatePhut,isCaDem:O.isCaDem,phongBanId:O.phongBanId||void 0,moTa:O.moTa||"",mauHienThi:O.mauHienThi||_d[0]}),a(!0)},E=()=>{a(!1),s(null)},C=O=>{if(O.preventDefault(),!f.maCa||!f.tenCa||!f.gioVao||!f.gioRa){ie.error("Vui lng in y  thng tin bt buc");return}r?j.mutate({id:r.id,data:{tenCa:f.tenCa,gioVao:f.gioVao,gioRa:f.gioRa,nghiGiuaCaPhut:f.nghiGiuaCaPhut,graceInPhut:f.graceInPhut,graceLatePhut:f.graceLatePhut,isCaDem:f.isCaDem,phongBanId:f.phongBanId,moTa:f.moTa,mauHienThi:f.mauHienThi}}):b.mutate(f)},P=O=>{confirm(`Bn c chc mun xa ca "${O.tenCa}"?`)&&T.mutate(O.id)},F=(O,M,q,J)=>{const[B,ue]=O.split(":").map(Number),[te,Z]=M.split(":").map(Number);let Q=B*60+ue,fe=te*60+Z;J&&fe<Q&&(fe+=1440);const K=fe-Q-q,L=Math.floor(K/60),X=K%60;return`${L}h${X>0?X+"p":""}`},R=(N==null?void 0:N.data)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Danh mc Ca lm vic"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Qun l cc ca lm vic trong cng ty"})]}),t.jsxs(ft,{onClick:w,className:"flex items-center gap-2",children:[t.jsx(Dt,{className:"w-4 h-4"}),"Thm ca mi"]})]}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex flex-wrap gap-4",children:[t.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[t.jsx(Vr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Tm theo m hoc tn ca...",value:l,onChange:O=>o(O.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary-500"})]}),t.jsxs("select",{value:d||"",onChange:O=>u(O.target.value?Number(O.target.value):void 0),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),g==null?void 0:g.map(O=>t.jsx("option",{value:O.id,children:O.tenPhongBan},O.id))]}),t.jsxs("select",{value:x===void 0?"":x?"active":"inactive",onChange:O=>{O.target.value===""?m(void 0):m(O.target.value==="active")},className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:[t.jsx("option",{value:"",children:"Tt c trng thi"}),t.jsx("option",{value:"active",children:"ang hot ng"}),t.jsx("option",{value:"inactive",children:"Ngng hot ng"})]})]})}),t.jsx(st,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Mu"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"M ca"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Tn ca"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Gi lm"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Thi lng"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:y?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"ang ti..."})}):R.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"Cha c ca lm vic no"})}):R.map(O=>{var M;return t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white shadow",style:{backgroundColor:O.mauHienThi||"#3B82F6"}})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"font-mono text-sm font-medium text-gray-900 dark:text-white",children:O.maCa})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-2",children:[O.isCaDem?t.jsx(db,{className:"w-4 h-4 text-indigo-500"}):t.jsx(fj,{className:"w-4 h-4 text-amber-500"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:O.tenCa})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[t.jsx(an,{className:"w-4 h-4 text-gray-400"}),t.jsxs("span",{className:"text-gray-900 dark:text-white",children:[O.gioVao," - ",O.gioRa]})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:F(O.gioVao,O.gioRa,O.nghiGiuaCaPhut,O.isCaDem)})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:O.phongBanId?(M=g==null?void 0:g.find(q=>q.id===O.phongBanId))==null?void 0:M.tenPhongBan:"Ton cng ty"})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("button",{onClick:()=>S.mutate(O.id),className:"inline-flex items-center gap-1",title:O.trangThai?"Click  v hiu ha":"Click  kch hot",children:O.trangThai?t.jsxs(t.Fragment,{children:[t.jsx(gj,{className:"w-6 h-6 text-green-500"}),t.jsx(Et,{variant:"success",children:"Hot ng"})]}):t.jsxs(t.Fragment,{children:[t.jsx(pj,{className:"w-6 h-6 text-gray-400"}),t.jsx(Et,{variant:"neutral",children:"Ngng"})]})})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>_(O),className:"p-2 text-gray-500 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",title:"Chnh sa",children:t.jsx(Za,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>P(O),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Xa",children:t.jsx(er,{className:"w-4 h-4"})})]})})]},O.id)})})]})})}),t.jsx(ns,{isOpen:n,onClose:E,size:"lg",children:t.jsxs("form",{onSubmit:C,children:[t.jsx(Ss,{title:r?"Chnh sa ca lm vic":"Thm ca lm vic mi"}),t.jsx(_s,{children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["M ca ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:f.maCa,onChange:O=>p({...f,maCa:O.target.value.toUpperCase()}),disabled:!!r,placeholder:"VD: CA_HANH_CHINH",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 disabled:bg-gray-100"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Tn ca ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:f.tenCa,onChange:O=>p({...f,tenCa:O.target.value}),placeholder:"VD: Ca hnh chnh",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Gi vo ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"time",value:f.gioVao,onChange:O=>p({...f,gioVao:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Gi ra ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"time",value:f.gioRa,onChange:O=>p({...f,gioRa:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ngh gia ca (pht)"}),t.jsx("input",{type:"number",min:0,max:120,value:f.nghiGiuaCaPhut,onChange:O=>p({...f,nghiGiuaCaPhut:Number(O.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Pht c php tr"}),t.jsx("input",{type:"number",min:0,max:60,value:f.graceLatePhut,onChange:O=>p({...f,graceLatePhut:Number(O.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"p dng cho phng ban"}),t.jsxs("select",{value:f.phongBanId||"",onChange:O=>p({...f,phongBanId:O.target.value?Number(O.target.value):void 0}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:[t.jsx("option",{value:"",children:"Ton cng ty"}),g==null?void 0:g.map(O=>t.jsx("option",{value:O.id,children:O.tenPhongBan},O.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Mu hin th"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"color",value:f.mauHienThi,onChange:O=>p({...f,mauHienThi:O.target.value}),className:"w-10 h-10 border-0 rounded cursor-pointer"}),t.jsx("div",{className:"flex gap-1",children:_d.map(O=>t.jsx("button",{type:"button",onClick:()=>p({...f,mauHienThi:O}),className:`w-6 h-6 rounded-full border-2 ${f.mauHienThi===O?"border-gray-800 dark:border-white":"border-transparent"}`,style:{backgroundColor:O}},O))})]})]}),t.jsx("div",{className:"md:col-span-2",children:t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:f.isCaDem,onChange:O=>p({...f,isCaDem:O.target.checked}),className:"w-4 h-4 text-primary-600 rounded"}),t.jsx(db,{className:"w-4 h-4 text-indigo-500"}),t.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Ca m (qua ngy, VD: 22:00 - 06:00)"})]})}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"M t"}),t.jsx("textarea",{value:f.moTa,onChange:O=>p({...f,moTa:O.target.value}),rows:2,placeholder:"Ghi ch v ca lm vic...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]})]})}),t.jsxs(ni,{children:[t.jsx(ft,{variant:"secondary",onClick:E,type:"button",children:"Hy"}),t.jsx(ft,{type:"submit",disabled:b.isPending||j.isPending,children:b.isPending||j.isPending?"ang x l...":r?"Cp nht":"To mi"})]})]})})]})}const Fl={layDanhSach:async e=>(await he.get("/phan-ca",{params:e})).data,layChiTiet:async e=>(await he.get(`/phan-ca/${e}`)).data,layCalendarView:async e=>(await he.get("/phan-ca/calendar",{params:e})).data,tao:async e=>(await he.post("/phan-ca",e)).data,capNhat:async(e,n)=>(await he.put(`/phan-ca/${e}`,n)).data,assignNgay:async(e,n)=>(await he.post(`/phan-ca/${e}/assign`,n)).data,assignBatch:async(e,n)=>(await he.post(`/phan-ca/${e}/assign-batch`,n)).data,copyTuan:async(e,n)=>(await he.post(`/phan-ca/${e}/copy-week`,n)).data,publish:async e=>(await he.post(`/phan-ca/${e}/publish`)).data,unpublish:async e=>(await he.post(`/phan-ca/${e}/unpublish`)).data,xoa:async e=>(await he.delete(`/phan-ca/${e}`)).data,xoaChiTiet:async(e,n)=>(await he.post(`/phan-ca/${e}/xoa-chi-tiet`,{chiTietIds:n})).data,layLichCuaToi:async(e,n)=>(await he.get("/phan-ca/lich-cua-toi",{params:{tuNgay:e,denNgay:n}})).data},p2=["CN","T2","T3","T4","T5","T6","T7"];function LV(){var xe;const e=Mt(),[n,a]=D.useState(()=>{const H=new Date;return`${H.getFullYear()}-${String(H.getMonth()+1).padStart(2,"0")}`}),[r,s]=D.useState(),[l,o]=D.useState(null),[d,u]=D.useState(!1),[x,m]=D.useState(!1),[f,p]=D.useState(!1),[N,y]=D.useState({nhanVienIds:[],caLamViecId:0,tuNgay:"",denNgay:"",ngoaiTruThu:[]}),[g,b]=D.useState({tuanNguon:"",tuanDich:""}),{data:j}=Le({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),{data:T}=Le({queryKey:["ca-lam-viec-active",r],queryFn:()=>ac.layDanhSachActive(r)}),{data:S}=Le({queryKey:["phan-ca",n,r],queryFn:()=>Fl.layDanhSach({thangNam:n,phongBanId:r})}),{data:w,isLoading:_}=Le({queryKey:["phan-ca-calendar",n,r],queryFn:()=>Fl.layCalendarView({thangNam:n,phongBanId:r}),enabled:!!n}),{data:E}=Le({queryKey:["nhan-vien",r],queryFn:()=>ha.layTatCa({phongBanId:r,trangThai:"DANG_LAM",soLuong:500})}),C=De({mutationFn:Fl.tao,onSuccess:H=>{e.invalidateQueries({queryKey:["phan-ca"]}),ie.success("To lch phn ca thnh cng"),o(H.id),u(!1)},onError:H=>{var ne,oe;ie.error(((oe=(ne=H.response)==null?void 0:ne.data)==null?void 0:oe.message)||"C li xy ra")}}),P=De({mutationFn:({lichId:H,payload:ne})=>Fl.assignBatch(H,ne),onSuccess:H=>{e.invalidateQueries({queryKey:["phan-ca-calendar"]}),ie.success(`${H.message} (${H.created} mi, ${H.updated} cp nht)`),m(!1)},onError:H=>{var ne,oe;ie.error(((oe=(ne=H.response)==null?void 0:ne.data)==null?void 0:oe.message)||"C li xy ra")}}),F=De({mutationFn:({lichId:H,payload:ne})=>Fl.copyTuan(H,ne),onSuccess:H=>{e.invalidateQueries({queryKey:["phan-ca-calendar"]}),ie.success(`${H.message}`),p(!1)},onError:H=>{var ne,oe;ie.error(((oe=(ne=H.response)==null?void 0:ne.data)==null?void 0:oe.message)||"C li xy ra")}}),R=De({mutationFn:Fl.publish,onSuccess:H=>{e.invalidateQueries({queryKey:["phan-ca"]}),e.invalidateQueries({queryKey:["phan-ca-calendar"]}),ie.success(`${H.message} (${H.mapped}  mapping)`)},onError:H=>{var ne,oe;ie.error(((oe=(ne=H.response)==null?void 0:ne.data)==null?void 0:oe.message)||"C li xy ra")}}),O=De({mutationFn:({lichId:H,payload:ne})=>Fl.assignNgay(H,ne),onSuccess:()=>{e.invalidateQueries({queryKey:["phan-ca-calendar"]})},onError:H=>{var ne,oe;ie.error(((oe=(ne=H.response)==null?void 0:ne.data)==null?void 0:oe.message)||"C li xy ra")}}),M=D.useMemo(()=>S!=null&&S.data?l?S.data.find(H=>H.id===l):S.data.find(H=>H.trangThai!=="HUY"):null,[S,l]),q=D.useMemo(()=>{const[H,ne]=n.split("-").map(Number),oe=new Date(H,ne-1,1),Se=new Date(H,ne,0),V=[],be=oe.getDay();for(let tt=be-1;tt>=0;tt--){const Je=new Date(H,ne-1,-tt);V.push({date:Je,dateStr:Je.toISOString().split("T")[0],isCurrentMonth:!1})}for(let tt=1;tt<=Se.getDate();tt++){const Je=new Date(H,ne-1,tt);V.push({date:Je,dateStr:Je.toISOString().split("T")[0],isCurrentMonth:!0})}const Oe=42-V.length;for(let tt=1;tt<=Oe;tt++){const Je=new Date(H,ne,tt);V.push({date:Je,dateStr:Je.toISOString().split("T")[0],isCurrentMonth:!1})}return V},[n]),J=()=>{const[H,ne]=n.split("-").map(Number),oe=new Date(H,ne-2,1);a(`${oe.getFullYear()}-${String(oe.getMonth()+1).padStart(2,"0")}`)},B=()=>{const[H,ne]=n.split("-").map(Number),oe=new Date(H,ne,1);a(`${oe.getFullYear()}-${String(oe.getMonth()+1).padStart(2,"0")}`)},ue=()=>{C.mutate({thangNam:n,phongBanId:r,tenLich:`Lch phn ca ${n}${r?` - PB${r}`:""}`})},te=(H,ne,oe)=>{if(!M||M.trangThai==="DA_CONG_BO")return;const Se=oe==null?void 0:oe.caLamViecId,V=Z(Se);V&&O.mutate({lichId:M.id,payload:{nhanVienId:H,ngay:ne,caLamViecId:V.id}})},Z=H=>{if(!T||T.length===0)return null;if(!H)return T[0];const oe=(T.findIndex(Se=>Se.id===H)+1)%(T.length+1);return oe===T.length?null:T[oe]},Q=()=>{if(M){if(!N.nhanVienIds.length||!N.caLamViecId||!N.tuNgay||!N.denNgay){ie.error("Vui lng in y  thng tin");return}P.mutate({lichId:M.id,payload:N})}},fe=()=>{if(M){if(!g.tuanNguon||!g.tuanDich){ie.error("Vui lng chn tun ngun v tun ch");return}F.mutate({lichId:M.id,payload:g})}},K=()=>{M&&confirm("Bn c chc mun cng b lch? Sau khi cng b s khng th chnh sa.")&&R.mutate(M.id)},[L,X]=n.split("-").map(Number),I=`Thng ${X}/${L}`,W=(w==null?void 0:w.nhanViens)||[],z=Array.isArray(E)?E:(E==null?void 0:E.data)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[t.jsx(Lt,{className:"w-6 h-6 text-primary-500"}),"Lch Phn Ca"]}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Phn ca lm vic cho nhn vin theo thng"})]}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[!M&&t.jsxs(ft,{onClick:()=>u(!0),className:"flex items-center gap-2",children:[t.jsx(Dt,{className:"w-4 h-4"}),"To lch mi"]}),M&&M.trangThai==="NHAP"&&t.jsxs(t.Fragment,{children:[t.jsxs(ft,{variant:"secondary",onClick:()=>{var H;y({nhanVienIds:[],caLamViecId:((H=T==null?void 0:T[0])==null?void 0:H.id)||0,tuNgay:`${n}-01`,denNgay:`${n}-${(w==null?void 0:w.soNgayTrongThang)||28}`,ngoaiTruThu:[0,6]}),m(!0)},className:"flex items-center gap-2",children:[t.jsx(on,{className:"w-4 h-4"}),"Phn ca hng lot"]}),t.jsxs(ft,{variant:"secondary",onClick:()=>p(!0),className:"flex items-center gap-2",children:[t.jsx(dj,{className:"w-4 h-4"}),"Copy tun"]}),t.jsxs(ft,{onClick:K,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700",children:[t.jsx(Ts,{className:"w-4 h-4"}),"Cng b lch"]})]})]})]}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:J,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(Nr,{className:"w-5 h-5"})}),t.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white min-w-[150px] text-center",children:I}),t.jsx("button",{onClick:B,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(qn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("select",{value:r||"",onChange:H=>s(H.target.value?Number(H.target.value):void 0),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),j==null?void 0:j.map(H=>t.jsx("option",{value:H.id,children:H.tenPhongBan},H.id))]}),(S==null?void 0:S.data)&&S.data.length>0&&t.jsx("select",{value:l||(M==null?void 0:M.id)||"",onChange:H=>o(Number(H.target.value)),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:S.data.map(H=>t.jsxs("option",{value:H.id,children:[H.tenLich," (",H.trangThai,")"]},H.id))})]}),M&&t.jsxs("div",{className:"flex items-center gap-2",children:[M.trangThai==="DA_CONG_BO"?t.jsxs(Et,{variant:"success",className:"flex items-center gap-1",children:[t.jsx(Gn,{className:"w-4 h-4"})," cng b"]}):M.trangThai==="NHAP"?t.jsx(Et,{variant:"warning",className:"flex items-center gap-1",children:"ang son tho"}):t.jsx(Et,{variant:"neutral",children:" hy"}),t.jsxs("span",{className:"text-sm text-gray-500",children:[((xe=M._count)==null?void 0:xe.chiTiets)||0," phn ca"]})]})]})}),T&&T.length>0&&t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[t.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Ch thch:"}),T.map(H=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:H.mauHienThi||"#3B82F6"}}),t.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:[H.tenCa," (",H.gioVao,"-",H.gioRa,")"]})]},H.id)),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded bg-gray-200 dark:bg-gray-700"}),t.jsx("span",{className:"text-sm text-gray-500",children:"Cha phn ca"})]})]})}),t.jsx(st,{className:"overflow-hidden",children:_?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"ang ti lch..."}):W.length===0?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Cha c nhn vin no. Hy chn phng ban hoc to lch phn ca mi."}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-800",children:[t.jsx("th",{className:"sticky left-0 z-10 bg-gray-50 dark:bg-gray-800 px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 border-b border-r min-w-[180px]",children:"Nhn vin"}),q.filter(H=>H.isCurrentMonth).map(H=>{const ne=H.date.getDay(),oe=ne===0||ne===6;return t.jsxs("th",{className:`px-1 py-2 text-center text-xs font-semibold border-b min-w-[60px] ${oe?"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-300"}`,children:[t.jsx("div",{children:p2[ne]}),t.jsx("div",{className:"text-lg font-bold",children:H.date.getDate()})]},H.dateStr)})]})}),t.jsx("tbody",{children:W.map(H=>t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50",children:[t.jsxs("td",{className:"sticky left-0 z-10 bg-white dark:bg-gray-900 px-4 py-2 border-b border-r",children:[t.jsx("div",{className:"font-medium text-gray-900 dark:text-white text-sm",children:H.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:H.maNhanVien})]}),q.filter(ne=>ne.isCurrentMonth).map(ne=>{const oe=H.ngays[ne.dateStr],Se=ne.date.getDay(),V=Se===0||Se===6,be=M&&M.trangThai==="NHAP";return t.jsx("td",{onClick:()=>be&&te(H.nhanVienId,ne.dateStr,oe),className:`px-1 py-1 border-b text-center cursor-pointer transition-colors ${V?"bg-red-50/50 dark:bg-red-900/10":""} ${be?"hover:bg-primary-50 dark:hover:bg-primary-900/20":""}`,children:oe?t.jsx("div",{className:"px-1 py-1 rounded text-xs font-medium text-white truncate",style:{backgroundColor:oe.mauHienThi||"#3B82F6"},title:`${oe.tenCa} (${oe.gioVao}-${oe.gioRa})`,children:oe.maCa}):t.jsx("div",{className:"px-1 py-1 rounded text-xs text-gray-400",children:"-"})},ne.dateStr)})]},H.nhanVienId))})]})})}),t.jsxs(ns,{isOpen:d,onClose:()=>u(!1),children:[t.jsx(Ss,{title:"To lch phn ca mi"}),t.jsx(_s,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Thng"}),t.jsx("input",{type:"month",value:n,onChange:H=>a(H.target.value),className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phng ban"}),t.jsxs("select",{value:r||"",onChange:H=>s(H.target.value?Number(H.target.value):void 0),className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Ton cng ty"}),j==null?void 0:j.map(H=>t.jsx("option",{value:H.id,children:H.tenPhongBan},H.id))]})]})]})}),t.jsxs(ni,{children:[t.jsx(ft,{variant:"secondary",onClick:()=>u(!1),children:"Hy"}),t.jsx(ft,{onClick:ue,disabled:C.isPending,children:C.isPending?"ang to...":"To lch"})]})]}),t.jsxs(ns,{isOpen:x,onClose:()=>m(!1),size:"lg",children:[t.jsx(Ss,{title:"Phn ca hng lot"}),t.jsx(_s,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Chn nhn vin ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("div",{className:"border rounded-lg p-2 max-h-48 overflow-y-auto",children:[t.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:N.nhanVienIds.length===z.length,onChange:H=>{y({...N,nhanVienIds:H.target.checked?z.map(ne=>ne.id):[]})},className:"w-4 h-4"}),t.jsx("span",{className:"font-medium",children:"Chn tt c"})]}),t.jsx("hr",{className:"my-2"}),z.map(H=>t.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:N.nhanVienIds.includes(H.id),onChange:ne=>{const oe=ne.target.checked?[...N.nhanVienIds,H.id]:N.nhanVienIds.filter(Se=>Se!==H.id);y({...N,nhanVienIds:oe})},className:"w-4 h-4"}),t.jsxs("span",{children:[H.hoTen," (",H.maNhanVien,")"]})]},H.id))]}),t.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[" chn: ",N.nhanVienIds.length," nhn vin"]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Ca lm vic ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("select",{value:N.caLamViecId,onChange:H=>y({...N,caLamViecId:Number(H.target.value)}),className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"-- Chn ca --"}),T==null?void 0:T.map(H=>t.jsxs("option",{value:H.id,children:[H.tenCa," (",H.gioVao," - ",H.gioRa,")"]},H.id))]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"T ngy"}),t.jsx("input",{type:"date",value:N.tuNgay,onChange:H=>y({...N,tuNgay:H.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"n ngy"}),t.jsx("input",{type:"date",value:N.denNgay,onChange:H=>y({...N,denNgay:H.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi tr cc ngy"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:p2.map((H,ne)=>t.jsxs("label",{className:`px-3 py-1 rounded-full cursor-pointer border ${N.ngoaiTruThu.includes(ne)?"bg-red-100 border-red-300 text-red-700":"bg-gray-100 border-gray-300"}`,children:[t.jsx("input",{type:"checkbox",className:"hidden",checked:N.ngoaiTruThu.includes(ne),onChange:oe=>{const Se=oe.target.checked?[...N.ngoaiTruThu,ne]:N.ngoaiTruThu.filter(V=>V!==ne);y({...N,ngoaiTruThu:Se})}}),H]},ne))})]})]})}),t.jsxs(ni,{children:[t.jsx(ft,{variant:"secondary",onClick:()=>m(!1),children:"Hy"}),t.jsx(ft,{onClick:Q,disabled:P.isPending,children:P.isPending?"ang x l...":"Phn ca"})]})]}),t.jsxs(ns,{isOpen:f,onClose:()=>p(!1),children:[t.jsx(Ss,{title:"Copy tun"}),t.jsx(_s,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tun ngun (chn ngy bt k trong tun)"}),t.jsx("input",{type:"date",value:g.tuanNguon,onChange:H=>b({...g,tuanNguon:H.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tun ch (chn ngy bt k trong tun)"}),t.jsx("input",{type:"date",value:g.tuanDich,onChange:H=>b({...g,tuanDich:H.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]})]})}),t.jsxs(ni,{children:[t.jsx(ft,{variant:"secondary",onClick:()=>p(!1),children:"Hy"}),t.jsx(ft,{onClick:fe,disabled:F.isPending,children:F.isPending?"ang copy...":"Copy tun"})]})]})]})}const K0=e=>({NHAP:"Nhp",CHO_DUYET_1:"Ch duyt (Cp 1)",CHO_DUYET_2:"Ch duyt (Cp 2)",DA_DUYET:" duyt",TU_CHOI:"T chi",HUY:" hy"})[e]||e,z0=e=>({NHAP:"bg-gray-100 text-gray-700",CHO_DUYET_1:"bg-yellow-100 text-yellow-700",CHO_DUYET_2:"bg-orange-100 text-orange-700",DA_DUYET:"bg-green-100 text-green-700",TU_CHOI:"bg-red-100 text-red-700",HUY:"bg-gray-100 text-gray-500"})[e]||"bg-gray-100 text-gray-700",Ul=e=>({OT:"",TRE_GIO:"",VE_SOM:"",CONG_TAC:"",LAM_TU_XA:""})[e]||"",ba={layDanhSachLoai:async e=>(await he.get("/yeu-cau/loai",{params:{all:e?"true":void 0}})).data,layLoai:async e=>(await he.get(`/yeu-cau/loai/${e}`)).data,taoLoai:async e=>(await he.post("/yeu-cau/loai",e)).data,capNhatLoai:async(e,n)=>(await he.put(`/yeu-cau/loai/${e}`,n)).data,toggleLoai:async e=>(await he.post(`/yeu-cau/loai/${e}/toggle`)).data,layDanhSachDon:async e=>(await he.get("/yeu-cau/don",{params:e})).data,layDonCuaToi:async e=>(await he.get("/yeu-cau/don/cua-toi",{params:e})).data,layChiTietDon:async e=>(await he.get(`/yeu-cau/don/${e}`)).data,taoDon:async e=>(await he.post("/yeu-cau/don",e)).data,capNhatDon:async(e,n)=>(await he.put(`/yeu-cau/don/${e}`,n)).data,guiDuyet:async e=>(await he.post(`/yeu-cau/don/${e}/gui-duyet`)).data,duyetCap1:async(e,n)=>(await he.post(`/yeu-cau/don/${e}/duyet-cap-1`,{ghiChu:n})).data,duyetCap2:async(e,n)=>(await he.post(`/yeu-cau/don/${e}/duyet-cap-2`,{ghiChu:n})).data,tuChoiCap1:async(e,n)=>(await he.post(`/yeu-cau/don/${e}/tu-choi-cap-1`,{lyDoTuChoi:n})).data,tuChoiCap2:async(e,n)=>(await he.post(`/yeu-cau/don/${e}/tu-choi-cap-2`,{lyDoTuChoi:n})).data,override:async(e,n,a)=>(await he.post(`/yeu-cau/don/${e}/override`,{lyDoOverride:n,duyet:a})).data,huyDon:async e=>(await he.post(`/yeu-cau/don/${e}/huy`)).data,layInboxCap1:async e=>(await he.get("/yeu-cau/inbox/cap-1",{params:e})).data,layInboxCap2:async e=>(await he.get("/yeu-cau/inbox/cap-2",{params:e})).data,duyetBatch:async(e,n,a)=>(await he.post("/yeu-cau/inbox/duyet-batch",{ids:e,cap:n,ghiChu:a})).data,layDanhSachWorkflowConfig:async(e,n)=>(await he.get("/yeu-cau/workflow-config",{params:{loaiYeuCauId:e,phongBanId:n}})).data,taoWorkflowConfig:async e=>(await he.post("/yeu-cau/workflow-config",e)).data,capNhatWorkflowConfig:async(e,n)=>(await he.put(`/yeu-cau/workflow-config/${e}`,n)).data};function PV(){var ue,te;const e=Mt(),{user:n}=is(),[a,r]=D.useState(!1),[s,l]=D.useState(null),[o,d]=D.useState(null),[u,x]=D.useState(""),[m,f]=D.useState(""),[p,N]=D.useState(null),[y,g]=D.useState({nhanVienId:0,loaiYeuCauId:0,ngayYeuCau:new Date().toISOString().split("T")[0],gioBatDau:"",gioKetThuc:"",diaDiem:"",lyDo:""}),{data:b}=Le({queryKey:["loai-yeu-cau"],queryFn:()=>ba.layDanhSachLoai()}),{data:j}=Le({queryKey:["nhan-vien-don-gian"],queryFn:()=>ha.layTatCa()});D.useEffect(()=>{if(j&&n){const Q=(Array.isArray(j)?j:j.data||[]).find(fe=>fe.email===n.email||fe.id===n.nhanVienId);Q&&(N(Q),g(fe=>({...fe,nhanVienId:Q.id})))}},[j,n]);const{data:T,isLoading:S}=Le({queryKey:["don-yeu-cau-cua-toi",u,m],queryFn:()=>ba.layDonCuaToi({trangThai:u||void 0,loaiYeuCauId:m||void 0,limit:50}),enabled:!0}),w=b==null?void 0:b.find(Z=>Z.id===y.loaiYeuCauId),_=De({mutationFn:ba.taoDon,onSuccess:()=>{e.invalidateQueries({queryKey:["don-yeu-cau-cua-toi"]}),ie.success("To n yu cu thnh cng!"),F()},onError:Z=>{var Q,fe;ie.error(((fe=(Q=Z.response)==null?void 0:Q.data)==null?void 0:fe.message)||"C li xy ra")}}),E=De({mutationFn:({id:Z,data:Q})=>ba.capNhatDon(Z,Q),onSuccess:()=>{e.invalidateQueries({queryKey:["don-yeu-cau-cua-toi"]}),ie.success("Cp nht n thnh cng!"),F()},onError:Z=>{var Q,fe;ie.error(((fe=(Q=Z.response)==null?void 0:Q.data)==null?void 0:fe.message)||"C li xy ra")}}),C=De({mutationFn:ba.guiDuyet,onSuccess:Z=>{e.invalidateQueries({queryKey:["don-yeu-cau-cua-toi"]}),ie.success(` gi n ${Z.maDon}  duyt!`)},onError:Z=>{var Q,fe;ie.error(((fe=(Q=Z.response)==null?void 0:Q.data)==null?void 0:fe.message)||"C li xy ra")}}),P=De({mutationFn:ba.huyDon,onSuccess:()=>{e.invalidateQueries({queryKey:["don-yeu-cau-cua-toi"]}),ie.success(" hy n!")},onError:Z=>{var Q,fe;ie.error(((fe=(Q=Z.response)==null?void 0:Q.data)==null?void 0:fe.message)||"C li xy ra")}}),F=()=>{g({nhanVienId:(p==null?void 0:p.id)||0,loaiYeuCauId:0,ngayYeuCau:new Date().toISOString().split("T")[0],gioBatDau:"",gioKetThuc:"",diaDiem:"",lyDo:""}),l(null),r(!1)},R=Z=>{l(Z),g({nhanVienId:Z.nhanVienId,loaiYeuCauId:Z.loaiYeuCauId,ngayYeuCau:Z.ngayYeuCau.split("T")[0],gioBatDau:Z.gioBatDau||"",gioKetThuc:Z.gioKetThuc||"",diaDiem:Z.diaDiem||"",lyDo:Z.lyDo}),r(!0)},O=()=>{var Z;if(!y.loaiYeuCauId){ie.error("Vui lng chn loi yu cu");return}if(!y.lyDo.trim()){ie.error("Vui lng nhp l do");return}if(w!=null&&w.yeuCauGioBatDau&&!y.gioBatDau){ie.error("Vui lng nhp gi bt u");return}if(w!=null&&w.yeuCauGioKetThuc&&!y.gioKetThuc){ie.error("Vui lng nhp gi kt thc");return}if(w!=null&&w.yeuCauDiaDiem&&!((Z=y.diaDiem)!=null&&Z.trim())){ie.error("Vui lng nhp a im");return}s?E.mutate({id:s.id,data:y}):_.mutate(y)},M=Z=>{confirm(`Gi n ${Z.maDon}  duyt?`)&&C.mutate(Z.id)},q=Z=>{confirm(`Hy n ${Z.maDon}?`)&&P.mutate(Z.id)},J=Z=>new Date(Z).toLocaleDateString("vi-VN"),B=(T==null?void 0:T.data)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"n yu cu ca ti"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"To v qun l n OT, Tr gi, V sm, Cng tc, Lm t xa"})]}),t.jsxs("button",{onClick:()=>{F(),r(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[t.jsx(Dt,{className:"w-5 h-5"}),"To n mi"]})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("select",{value:m,onChange:Z=>f(Z.target.value?Number(Z.target.value):""),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[t.jsx("option",{value:"",children:"Tt c loi"}),b==null?void 0:b.map(Z=>t.jsxs("option",{value:Z.id,children:[Ul(Z.maLoai)," ",Z.tenLoai]},Z.id))]}),t.jsxs("select",{value:u,onChange:Z=>x(Z.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[t.jsx("option",{value:"",children:"Tt c trng thi"}),t.jsx("option",{value:"NHAP",children:"Nhp"}),t.jsx("option",{value:"CHO_DUYET_1",children:"Ch duyt (Cp 1)"}),t.jsx("option",{value:"CHO_DUYET_2",children:"Ch duyt (Cp 2)"}),t.jsx("option",{value:"DA_DUYET",children:" duyt"}),t.jsx("option",{value:"TU_CHOI",children:"T chi"}),t.jsx("option",{value:"HUY",children:" hy"})]})]}),t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:S?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"ang ti..."}):B.length===0?t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx(ma,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Cha c n yu cu no"})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"M n"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Loi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:B.map(Z=>{var Q,fe;return t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:Z.maDon})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{children:Ul(((Q=Z.loaiYeuCau)==null?void 0:Q.maLoai)||"")}),t.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:(fe=Z.loaiYeuCau)==null?void 0:fe.tenLoai})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300",children:J(Z.ngayYeuCau)}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300",children:[Z.gioBatDau&&Z.gioKetThuc?`${Z.gioBatDau} - ${Z.gioKetThuc}`:Z.gioBatDau||"-",Z.soGio&&t.jsxs("span",{className:"ml-2 text-blue-600 dark:text-blue-400",children:["(",Z.soGio,"h)"]})]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${z0(Z.trangThai)}`,children:K0(Z.trangThai)})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx("button",{onClick:()=>d(Z),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Xem chi tit",children:t.jsx(Ra,{className:"w-4 h-4"})}),["NHAP","TU_CHOI"].includes(Z.trangThai)&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>R(Z),className:"p-2 text-gray-500 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg transition-colors",title:"Sa",children:t.jsx(Za,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>M(Z),className:"p-2 text-gray-500 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Gi duyt",children:t.jsx(bu,{className:"w-4 h-4"})})]}),["NHAP","CHO_DUYET_1","CHO_DUYET_2","TU_CHOI"].includes(Z.trangThai)&&t.jsx("button",{onClick:()=>q(Z),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Hy n",children:t.jsx(mn,{className:"w-4 h-4"})})]})})]},Z.id)})})]})})}),a&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[t.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:t.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:s?"Sa n yu cu":"To n yu cu mi"})}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Loi yu cu ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("select",{value:y.loaiYeuCauId,onChange:Z=>g({...y,loaiYeuCauId:Number(Z.target.value)}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",disabled:!!s,children:[t.jsx("option",{value:0,children:"-- Chn loi yu cu --"}),b==null?void 0:b.map(Z=>t.jsxs("option",{value:Z.id,children:[Ul(Z.maLoai)," ",Z.tenLoai]},Z.id))]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ut,{value:y.ngayYeuCau,onChange:Z=>g({...y,ngayYeuCau:Z})})]}),((w==null?void 0:w.yeuCauGioBatDau)||y.gioBatDau)&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Gi bt u ",(w==null?void 0:w.yeuCauGioBatDau)&&t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"time",value:y.gioBatDau,onChange:Z=>g({...y,gioBatDau:Z.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),((w==null?void 0:w.yeuCauGioKetThuc)||y.gioKetThuc)&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Gi kt thc ",(w==null?void 0:w.yeuCauGioKetThuc)&&t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"time",value:y.gioKetThuc,onChange:Z=>g({...y,gioKetThuc:Z.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),((w==null?void 0:w.yeuCauDiaDiem)||y.diaDiem)&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["a im ",(w==null?void 0:w.yeuCauDiaDiem)&&t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:y.diaDiem,onChange:Z=>g({...y,diaDiem:Z.target.value}),placeholder:"Nhp a im...",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["L do ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("textarea",{value:y.lyDo,onChange:Z=>g({...y,lyDo:Z.target.value}),placeholder:"Nhp l do yu cu...",rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none"})]})]}),t.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[t.jsx("button",{onClick:F,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700",children:"Hy"}),t.jsx("button",{onClick:O,disabled:_.isPending||E.isPending,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:_.isPending||E.isPending?"ang lu...":s?"Cp nht":"To n"})]})]})}),o&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Chi tit n ",o.maDon]}),t.jsx("button",{onClick:()=>d(null),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(mn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Loi yu cu"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[Ul(((ue=o.loaiYeuCau)==null?void 0:ue.maLoai)||"")," ",(te=o.loaiYeuCau)==null?void 0:te.tenLoai]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Trng thi"}),t.jsx("span",{className:`inline-block px-2 py-1 text-xs font-medium rounded-full ${z0(o.trangThai)}`,children:K0(o.trangThai)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Ngy yu cu"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:J(o.ngayYeuCau)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Thi gian"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[o.gioBatDau&&o.gioKetThuc?`${o.gioBatDau} - ${o.gioKetThuc}`:o.gioBatDau||"-",o.soGio&&` (${o.soGio}h)`]})]})]}),o.diaDiem&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"a im"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:o.diaDiem})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"L do"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:o.lyDo})]}),o.nguoiDuyet1&&t.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Duyt cp 1"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[o.nguoiDuyet1.hoTen," -"," ",o.ngayDuyet1&&J(o.ngayDuyet1)]}),o.ghiChuDuyet1&&t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:o.ghiChuDuyet1})]}),o.nguoiDuyet2&&t.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Duyt cp 2"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[o.nguoiDuyet2.hoTen," -"," ",o.ngayDuyet2&&J(o.ngayDuyet2)]}),o.ghiChuDuyet2&&t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:o.ghiChuDuyet2})]}),o.lyDoTuChoi&&t.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[t.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 font-medium",children:"L do t chi"}),t.jsx("p",{className:"text-red-700 dark:text-red-300",children:o.lyDoTuChoi})]}),o.isOverride&&t.jsxs("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[t.jsxs("p",{className:"text-sm text-yellow-600 dark:text-yellow-400 font-medium flex items-center gap-1",children:[t.jsx(di,{className:"w-4 h-4"})," Override"]}),t.jsx("p",{className:"text-yellow-700 dark:text-yellow-300",children:o.lyDoOverride})]})]})]})})]})}function IV(){var L,X,I,W,z,xe;const e=Mt(),[n,a]=D.useState("cap1"),[r,s]=D.useState(null),[l,o]=D.useState(null),[d,u]=D.useState(null),[x,m]=D.useState(""),[f,p]=D.useState(""),[N,y]=D.useState(!0),[g,b]=D.useState(new Set),[j,T]=D.useState({phongBanId:void 0,loaiYeuCauId:void 0,tuNgay:"",denNgay:"",page:1}),{data:S}=Le({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),{data:w}=Le({queryKey:["loai-yeu-cau"],queryFn:()=>ba.layDanhSachLoai()}),{data:_,isLoading:E,refetch:C}=Le({queryKey:["don-yeu-cau-duyet",n,j],queryFn:()=>n==="cap1"?ba.layInboxCap1({phongBanId:j.phongBanId,loaiYeuCauId:j.loaiYeuCauId,tuNgay:j.tuNgay||void 0,denNgay:j.denNgay||void 0,page:j.page,limit:20}):n==="cap2"?ba.layInboxCap2({phongBanId:j.phongBanId,loaiYeuCauId:j.loaiYeuCauId,tuNgay:j.tuNgay||void 0,denNgay:j.denNgay||void 0,page:j.page,limit:20}):ba.layDanhSachDon({phongBanId:j.phongBanId,loaiYeuCauId:j.loaiYeuCauId,tuNgay:j.tuNgay||void 0,denNgay:j.denNgay||void 0,page:j.page,limit:20})}),P=De({mutationFn:H=>ba.duyetCap1(H),onSuccess:H=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),ie.success(` duyt n ${H.maDon}!`)},onError:H=>{var ne,oe;ie.error(((oe=(ne=H.response)==null?void 0:ne.data)==null?void 0:oe.message)||"C li xy ra")}}),F=De({mutationFn:H=>ba.duyetCap2(H),onSuccess:H=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),ie.success(` duyt n ${H.maDon}!`)},onError:H=>{var ne,oe;ie.error(((oe=(ne=H.response)==null?void 0:ne.data)==null?void 0:oe.message)||"C li xy ra")}}),R=De({mutationFn:({id:H,lyDo:ne})=>ba.tuChoiCap1(H,ne),onSuccess:H=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),ie.success(` t chi n ${H.maDon}`),o(null),m("")},onError:H=>{var ne,oe;ie.error(((oe=(ne=H.response)==null?void 0:ne.data)==null?void 0:oe.message)||"C li xy ra")}}),O=De({mutationFn:({id:H,lyDo:ne})=>ba.tuChoiCap2(H,ne),onSuccess:H=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),ie.success(` t chi n ${H.maDon}`),o(null),m("")},onError:H=>{var ne,oe;ie.error(((oe=(ne=H.response)==null?void 0:ne.data)==null?void 0:oe.message)||"C li xy ra")}}),M=De({mutationFn:({id:H,lyDo:ne,duyet:oe})=>ba.override(H,ne,oe),onSuccess:H=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),ie.success(` override n ${H.maDon}`),u(null),p("")},onError:H=>{var ne,oe;ie.error(((oe=(ne=H.response)==null?void 0:ne.data)==null?void 0:oe.message)||"C li xy ra")}}),q=De({mutationFn:({ids:H,cap:ne})=>ba.duyetBatch(H,ne),onSuccess:H=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),ie.success(` duyt ${H.success} n thnh cng!`),H.failed>0&&ie.error(`${H.failed} n tht bi`),b(new Set)},onError:H=>{var ne,oe;ie.error(((oe=(ne=H.response)==null?void 0:ne.data)==null?void 0:oe.message)||"C li xy ra")}}),J=H=>new Date(H).toLocaleDateString("vi-VN"),B=H=>{H.trangThai==="CHO_DUYET_1"?P.mutate(H.id):H.trangThai==="CHO_DUYET_2"&&F.mutate(H.id)},ue=()=>{if(!l||!x.trim()){ie.error("Vui lng nhp l do t chi");return}l.trangThai==="CHO_DUYET_1"?R.mutate({id:l.id,lyDo:x}):O.mutate({id:l.id,lyDo:x})},te=()=>{if(!d||!f.trim()){ie.error("Vui lng nhp l do override");return}M.mutate({id:d.id,lyDo:f,duyet:N})},Z=()=>{if(g.size===0){ie.error("Cha chn n no");return}const H=n==="cap1"?1:2;q.mutate({ids:Array.from(g),cap:H})},Q=H=>{const ne=new Set(g);ne.has(H)?ne.delete(H):ne.add(H),b(ne)},fe=()=>{const H=(_==null?void 0:_.data)||[];g.size===H.length?b(new Set):b(new Set(H.map(ne=>ne.id)))},K=(_==null?void 0:_.data)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Duyt yu cu"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Duyt n OT, Tr gi, V sm, Cng tc ca nhn vin"})]}),t.jsxs("button",{onClick:()=>C(),className:"flex items-center gap-2 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700",children:[t.jsx(yr,{className:"w-4 h-4"}),"Lm mi"]})]}),t.jsxs("div",{className:"flex gap-2 border-b border-gray-200 dark:border-gray-700",children:[t.jsx("button",{onClick:()=>{a("cap1"),b(new Set)},className:`px-4 py-2 font-medium transition-colors ${n==="cap1"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Cp 1 (Manager)"}),t.jsx("button",{onClick:()=>{a("cap2"),b(new Set)},className:`px-4 py-2 font-medium transition-colors ${n==="cap2"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Cp 2 (HR)"}),t.jsx("button",{onClick:()=>{a("tat-ca"),b(new Set)},className:`px-4 py-2 font-medium transition-colors ${n==="tat-ca"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Tt c"})]}),t.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[t.jsxs("select",{value:j.phongBanId||"",onChange:H=>T({...j,phongBanId:H.target.value?Number(H.target.value):void 0,page:1}),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),S==null?void 0:S.map(H=>t.jsx("option",{value:H.id,children:H.tenPhongBan},H.id))]}),t.jsxs("select",{value:j.loaiYeuCauId||"",onChange:H=>T({...j,loaiYeuCauId:H.target.value?Number(H.target.value):void 0,page:1}),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[t.jsx("option",{value:"",children:"Tt c loi"}),w==null?void 0:w.map(H=>t.jsxs("option",{value:H.id,children:[Ul(H.maLoai)," ",H.tenLoai]},H.id))]}),g.size>0&&(n==="cap1"||n==="cap2")&&t.jsxs("button",{onClick:Z,disabled:q.isPending,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:[t.jsx(Gn,{className:"w-4 h-4"}),"Duyt ",g.size," n"]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[E?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"ang ti..."}):K.length===0?t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx(on,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Khng c n yu cu no"})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:t.jsxs("tr",{children:[(n==="cap1"||n==="cap2")&&t.jsx("th",{className:"px-4 py-3 text-left",children:t.jsx("input",{type:"checkbox",checked:g.size===K.length&&K.length>0,onChange:fe,className:"w-4 h-4 rounded"})}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"M n"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Loi"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:K.map(H=>{var ne,oe,Se,V;return t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[(n==="cap1"||n==="cap2")&&t.jsx("td",{className:"px-4 py-4",children:t.jsx("input",{type:"checkbox",checked:g.has(H.id),onChange:()=>Q(H.id),className:"w-4 h-4 rounded"})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:H.maDon})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:(ne=H.nhanVien)==null?void 0:ne.hoTen}),t.jsx("p",{className:"text-sm text-gray-500",children:(oe=H.nhanVien)==null?void 0:oe.maNhanVien})]})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{children:Ul(((Se=H.loaiYeuCau)==null?void 0:Se.maLoai)||"")}),t.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:(V=H.loaiYeuCau)==null?void 0:V.tenLoai})]})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300",children:J(H.ngayYeuCau)}),t.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300",children:[H.gioBatDau&&H.gioKetThuc?`${H.gioBatDau} - ${H.gioKetThuc}`:H.gioBatDau||"-",H.soGio&&t.jsxs("span",{className:"ml-2 text-blue-600 dark:text-blue-400",children:["(",H.soGio,"h)"]})]}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${z0(H.trangThai)}`,children:K0(H.trangThai)})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx("button",{onClick:()=>s(H),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Xem chi tit",children:t.jsx(Ra,{className:"w-4 h-4"})}),["CHO_DUYET_1","CHO_DUYET_2"].includes(H.trangThai)&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>B(H),className:"p-2 text-gray-500 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Duyt",children:t.jsx(Gn,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>o(H),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"T chi",children:t.jsx(mo,{className:"w-4 h-4"})})]}),n==="tat-ca"&&!["HUY"].includes(H.trangThai)&&t.jsx("button",{onClick:()=>{u(H),y(H.trangThai==="TU_CHOI")},className:"p-2 text-gray-500 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg transition-colors",title:"Override",children:t.jsx(sa,{className:"w-4 h-4"})})]})})]},H.id)})})]})}),(_==null?void 0:_.pagination)&&_.pagination.totalPages>1&&t.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[t.jsxs("span",{className:"text-sm text-gray-500",children:["Trang ",_.pagination.page," / ",_.pagination.totalPages," (",_.pagination.total," n)"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>T({...j,page:j.page-1}),disabled:j.page<=1,className:"p-2 border rounded-lg disabled:opacity-50",children:t.jsx(Nr,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>T({...j,page:j.page+1}),disabled:j.page>=_.pagination.totalPages,className:"p-2 border rounded-lg disabled:opacity-50",children:t.jsx(qn,{className:"w-4 h-4"})})]})]})]}),r&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Chi tit n ",r.maDon]}),t.jsx("button",{onClick:()=>s(null),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(mn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Nhn vin"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[(L=r.nhanVien)==null?void 0:L.hoTen," (",(X=r.nhanVien)==null?void 0:X.maNhanVien,")"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Phng ban"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:(I=r.phongBan)==null?void 0:I.tenPhongBan})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Loi yu cu"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[Ul(((W=r.loaiYeuCau)==null?void 0:W.maLoai)||"")," ",(z=r.loaiYeuCau)==null?void 0:z.tenLoai]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Trng thi"}),t.jsx("span",{className:`inline-block px-2 py-1 text-xs font-medium rounded-full ${z0(r.trangThai)}`,children:K0(r.trangThai)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Ngy yu cu"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:J(r.ngayYeuCau)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Thi gian"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[r.gioBatDau&&r.gioKetThuc?`${r.gioBatDau} - ${r.gioKetThuc}`:r.gioBatDau||"-",r.soGio&&` (${r.soGio}h)`]})]})]}),r.diaDiem&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"a im"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:r.diaDiem})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"L do"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:r.lyDo})]}),r.lyDoTuChoi&&t.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[t.jsx("p",{className:"text-sm text-red-600 font-medium",children:"L do t chi"}),t.jsx("p",{className:"text-red-700",children:r.lyDoTuChoi})]})]}),["CHO_DUYET_1","CHO_DUYET_2"].includes(r.trangThai)&&t.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{o(r),s(null)},className:"px-4 py-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50",children:"T chi"}),t.jsx("button",{onClick:()=>{B(r),s(null)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Duyt"})]})]})}),l&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md",children:[t.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["T chi n ",l.maDon]})}),t.jsxs("div",{className:"p-6",children:[t.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:["T chi yu cu ca ",t.jsx("strong",{children:(xe=l.nhanVien)==null?void 0:xe.hoTen}),"?"]}),t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["L do t chi ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("textarea",{value:x,onChange:H=>m(H.target.value),placeholder:"Nhp l do t chi...",rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none"})]}),t.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{o(null),m("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:ue,disabled:R.isPending||O.isPending,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:"T chi"})]})]})}),d&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md",children:[t.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Override n ",d.maDon]})}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"radio",checked:N,onChange:()=>y(!0),className:"w-4 h-4"}),t.jsx("span",{className:"text-green-600 font-medium",children:"Override Duyt"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"radio",checked:!N,onChange:()=>y(!1),className:"w-4 h-4"}),t.jsx("span",{className:"text-red-600 font-medium",children:"Override T chi"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["L do override ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("textarea",{value:f,onChange:H=>p(H.target.value),placeholder:"Nhp l do override...",rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none"})]})]}),t.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{u(null),p("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:te,disabled:M.isPending,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:opacity-50",children:"Override"})]})]})})]})}const el={layDanhSach:async e=>(await he.get("/thong-bao",{params:e})).data,demChuaDoc:async()=>(await he.get("/thong-bao/chua-doc")).data,danhDauDaDoc:async e=>(await he.put(`/thong-bao/${e}/da-doc`)).data,danhDauTatCaDaDoc:async()=>(await he.post("/thong-bao/da-doc-tat-ca")).data},OT=e=>{const n=new Date(e),r=new Date().getTime()-n.getTime(),s=Math.floor(r/6e4),l=Math.floor(r/36e5),o=Math.floor(r/864e5);return s<1?"Va xong":s<60?`${s} pht trc`:l<24?`${l} gi trc`:o<7?`${o} ngy trc`:n.toLocaleDateString("vi-VN")},MT=e=>{switch(e){case"YEU_CAU_MOI":return{icon:"",color:"text-blue-600"};case"YEU_CAU_DA_DUYET":return{icon:"",color:"text-green-600"};case"YEU_CAU_TU_CHOI":return{icon:"",color:"text-red-600"};case"NGHI_PHEP_MOI":return{icon:"",color:"text-blue-600"};case"NGHI_PHEP_DA_DUYET":return{icon:"",color:"text-green-600"};case"NGHI_PHEP_TU_CHOI":return{icon:"",color:"text-red-600"};case"LICH_PHAN_CA":return{icon:"",color:"text-purple-600"};case"PHIEU_LUONG":return{icon:"",color:"text-green-600"};case"HE_THONG":default:return{icon:"",color:"text-gray-600"}}};function OV({className:e=""}){var N;const n=br(),a=Mt(),[r,s]=D.useState(!1),l=D.useRef(null),{data:o}=Le({queryKey:["thong-bao","chua-doc"],queryFn:()=>el.demChuaDoc(),refetchInterval:3e4}),{data:d,isLoading:u}=Le({queryKey:["thong-bao","list",{limit:10}],queryFn:()=>el.layDanhSach({limit:10}),enabled:r}),x=De({mutationFn:y=>el.danhDauDaDoc(y),onSuccess:()=>{a.invalidateQueries({queryKey:["thong-bao"]})}}),m=De({mutationFn:()=>el.danhDauTatCaDaDoc(),onSuccess:()=>{a.invalidateQueries({queryKey:["thong-bao"]})}});D.useEffect(()=>{const y=g=>{l.current&&!l.current.contains(g.target)&&s(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]);const f=y=>{y.daDoc||x.mutate(y.id),y.link&&(n(y.link),s(!1))},p=(o==null?void 0:o.chuaDoc)||0;return t.jsxs("div",{className:`relative ${e}`,ref:l,children:[t.jsxs("button",{onClick:()=>s(!r),className:"relative p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"Thng bo",children:[t.jsx(jc,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"}),p>0&&t.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] flex items-center justify-center bg-red-500 text-white text-xs font-bold rounded-full px-1",children:p>99?"99+":p})]}),r&&t.jsxs("div",{className:"absolute right-0 top-full mt-2 w-80 max-h-[70vh] bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 overflow-hidden z-50 animate-scale-in",children:[t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Thng bo"}),t.jsxs("div",{className:"flex items-center gap-2",children:[p>0&&t.jsxs("button",{onClick:()=>m.mutate(),className:"text-xs text-blue-600 hover:text-blue-700 flex items-center gap-1",disabled:m.isPending,children:[t.jsx(oj,{className:"w-3 h-3"}),"c tt c"]}),t.jsx("button",{onClick:()=>s(!1),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:t.jsx(mn,{className:"w-4 h-4 text-gray-500"})})]})]}),t.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:u?t.jsx("div",{className:"p-4 text-center text-gray-500",children:"ang ti..."}):(N=d==null?void 0:d.data)!=null&&N.length?d.data.map(y=>{const{icon:g,color:b}=MT(y.loaiThongBao);return t.jsx("button",{onClick:()=>f(y),className:`w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors border-b border-gray-100 dark:border-gray-700 last:border-0 ${y.daDoc?"":"bg-blue-50/50 dark:bg-blue-900/20"}`,children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx("span",{className:`text-xl ${b}`,children:g}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsx("p",{className:`text-sm font-medium truncate ${y.daDoc?"text-gray-600 dark:text-gray-400":"text-gray-900 dark:text-white"}`,children:y.tieuDe}),!y.daDoc&&t.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-1.5"})]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5 line-clamp-2",children:y.noiDung}),t.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:OT(y.ngayTao)})]})]})},y.id)}):t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx(jc,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),t.jsx("p",{children:"Khng c thng bo"})]})}),d&&d.total>10&&t.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 p-2",children:t.jsxs("button",{onClick:()=>{n("/thong-bao"),s(!1)},className:"w-full text-center text-sm text-blue-600 hover:text-blue-700 py-2",children:["Xem tt c (",d.total,")"]})})]})]})}const Vf=[{id:"home",label:"Trang ch",icon:Y0,path:"/portal"},{id:"schedule",label:"Lch lm",icon:Lt,path:"/portal/lich-lam"},{id:"attendance",label:"Chm cng",icon:an,path:"/portal/cham-cong"},{id:"requests",label:"Yu cu",icon:ma,path:"/portal/yeu-cau"},{id:"profile",label:"C nhn",icon:so,path:"/portal/ca-nhan"}];function MV(){var x,m;const e=As(),n=br(),{user:a,dangXuat:r}=is(),[s,l]=D.useState(!1),o=((x=Vf.find(f=>e.pathname===f.path))==null?void 0:x.id)||"home",d=()=>{const f=Vf.find(p=>e.pathname.startsWith(p.path));return(f==null?void 0:f.label)||"Portal"},u=async()=>{await r(),n("/dang-nhap")};return t.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex flex-col",children:[t.jsx("header",{className:"sticky top-0 z-40 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-between max-w-lg mx-auto",children:[e.pathname!=="/portal"?t.jsx("button",{onClick:()=>n(-1),className:"p-2 -ml-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(Nr,{className:"w-5 h-5"})}):t.jsx("div",{className:"w-9"}),t.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:d()}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(OV,{}),t.jsx("button",{onClick:()=>l(!s),className:"p-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(O_,{className:"w-5 h-5"})})]})]})}),s&&t.jsx("div",{className:"fixed inset-0 z-50 bg-black/50",onClick:()=>l(!1),children:t.jsxs("div",{className:"absolute right-0 top-0 h-full w-64 bg-white dark:bg-gray-800 shadow-xl",onClick:f=>f.stopPropagation(),children:[t.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[t.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:"Menu"}),t.jsx("button",{onClick:()=>l(!1),className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(mn,{className:"w-5 h-5"})})]}),t.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-semibold",children:((m=a==null?void 0:a.hoTen)==null?void 0:m[0])||"U"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a==null?void 0:a.hoTen}),t.jsx("p",{className:"text-sm text-gray-500",children:a==null?void 0:a.email})]})]})}),t.jsxs("nav",{className:"p-2",children:[t.jsxs("button",{onClick:()=>n("/"),className:"w-full flex items-center gap-3 px-4 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:[t.jsx(Y0,{className:"w-5 h-5"}),t.jsx("span",{children:"V trang Admin"})]}),t.jsxs("button",{onClick:u,className:"w-full flex items-center gap-3 px-4 py-3 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg",children:[t.jsx(ng,{className:"w-5 h-5"}),t.jsx("span",{children:"ng xut"})]})]})]})}),t.jsx("main",{className:"flex-1 overflow-y-auto pb-20",children:t.jsx("div",{className:"max-w-lg mx-auto px-4 py-4",children:t.jsx(J2,{})})}),t.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-40 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 safe-area-pb",children:t.jsx("div",{className:"max-w-lg mx-auto flex items-center justify-around h-16",children:Vf.map(f=>{const p=f.icon,N=o===f.id;return t.jsxs("button",{onClick:()=>n(f.path),className:`flex flex-col items-center justify-center flex-1 h-full transition-colors ${N?"text-blue-600 dark:text-blue-400":"text-gray-500 dark:text-gray-400"}`,children:[t.jsx(p,{className:`w-5 h-5 mb-1 ${N?"stroke-[2.5]":""}`}),t.jsx("span",{className:`text-xs ${N?"font-medium":""}`,children:f.label})]},f.id)})})})]})}const Bc={getDashboard:async()=>(await he.get("/employee-portal/dashboard")).data,getLichLamViec:async e=>(await he.get("/employee-portal/lich-lam-viec",{params:e})).data,getChamCong:async e=>(await he.get("/employee-portal/cham-cong",{params:e})).data,getPhieuLuong:async e=>(await he.get("/employee-portal/phieu-luong",{params:e})).data,getChiTietPhieuLuong:async e=>(await he.get(`/employee-portal/phieu-luong/${e}`)).data,getSoDuPhep:async()=>(await he.get("/employee-portal/so-du-phep")).data,getHoSo:async()=>(await he.get("/employee-portal/ho-so")).data,checkIn:async()=>(await he.post("/employee-portal/check-in")).data,checkOut:async()=>(await he.post("/employee-portal/check-out")).data},RV=e=>["CN","T2","T3","T4","T5","T6","T7"][e]||"",BV=e=>["Ch nht","Th hai","Th ba","Th t","Th nm","Th su","Th by"][e]||"",$0=e=>{if(!e)return"--:--";const n=new Date(e);return`${String(n.getHours()).padStart(2,"0")}:${String(n.getMinutes()).padStart(2,"0")}`},Uf=e=>new Intl.NumberFormat("vi-VN").format(e)+"",HV="tinh_luong_auth",Un=Zt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});Un.interceptors.request.use(e=>{const n=localStorage.getItem(HV);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const fr={layDanhSachGeofence:e=>Un.get("/anti-fraud/geofence",{params:e}).then(n=>n.data),layGeofence:e=>Un.get(`/anti-fraud/geofence/${e}`).then(n=>n.data),taoGeofence:e=>Un.post("/anti-fraud/geofence",e).then(n=>n.data),capNhatGeofence:(e,n)=>Un.put(`/anti-fraud/geofence/${e}`,n).then(a=>a.data),xoaGeofence:e=>Un.delete(`/anti-fraud/geofence/${e}`).then(n=>n.data),layGeofenceCuaToi:()=>Un.get("/anti-fraud/my-geofence").then(e=>e.data),gpsCheckin:e=>Un.post("/anti-fraud/gps-checkin",e).then(n=>n.data),layLichSuGPS:e=>Un.get("/anti-fraud/gps-logs",{params:e}).then(n=>n.data),layLichSuGPSCuaToi:e=>Un.get("/anti-fraud/my-gps-logs",{params:e}).then(n=>n.data),thongKeGPS:(e,n,a)=>Un.get("/anti-fraud/thong-ke",{params:{tuNgay:e,denNgay:n,phongBanId:a}}).then(r=>r.data),layDanhSachThietBi:e=>Un.get("/anti-fraud/devices",{params:e}).then(n=>n.data),layThietBiNhanVien:e=>Un.get(`/anti-fraud/devices/${e}`).then(n=>n.data),layThietBiCuaToi:()=>Un.get("/anti-fraud/my-device").then(e=>e.data),kiemTraDevice:e=>Un.post("/anti-fraud/check-device",{deviceId:e}).then(n=>n.data),bindDevice:e=>Un.post("/anti-fraud/bind-device",e).then(n=>n.data),resetDevice:e=>Un.post("/anti-fraud/reset-device",e).then(n=>n.data),blockDevice:(e,n)=>Un.post(`/anti-fraud/block-device/${e}`,{lyDo:n}).then(a=>a.data),layLichSuThietBi:e=>Un.get("/anti-fraud/device-history",{params:e}).then(n=>n.data)},RT=()=>new Promise((e,n)=>{if(!navigator.geolocation){n(new Error("Trnh duyt khng h tr GPS"));return}navigator.geolocation.getCurrentPosition(a=>{e({viDo:a.coords.latitude,kinhDo:a.coords.longitude,doChinhXacMet:Math.round(a.coords.accuracy)})},a=>{switch(a.code){case a.PERMISSION_DENIED:n(new Error("Bn  t chi quyn truy cp GPS"));break;case a.POSITION_UNAVAILABLE:n(new Error("Khng th xc nh v tr"));break;case a.TIMEOUT:n(new Error("Qu thi gian ch GPS"));break;default:n(new Error("Li GPS khng xc nh"))}},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),VV=()=>{const e="tinh_luong_device_id";let n=localStorage.getItem(e);return n||(n=`WEB-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,localStorage.setItem(e,n)),n};function UV(){var b,j,T,S,w,_;const e=br(),n=Mt(),[a,r]=D.useState(null),[s,l]=D.useState("idle"),[o,d]=D.useState(null),{data:u,isLoading:x}=Le({queryKey:["employee-portal","dashboard"],queryFn:()=>Bc.getDashboard(),refetchInterval:6e4}),{data:m}=Le({queryKey:["my-geofences"],queryFn:()=>fr.layGeofenceCuaToi()}),f=De({mutationFn:async E=>{l("getting");let C={};const P=m==null?void 0:m.some(F=>F.batBuocGPS);if(P||m!=null&&m.length)try{C=await RT(),l("success")}catch(F){if(P)throw l("error"),new Error(F.message||"Khng th ly v tr GPS");l("idle")}return fr.gpsCheckin({loaiChamCong:E,viDo:C.viDo,kinhDo:C.kinhDo,doChinhXacMet:C.doChinhXacMet,deviceId:VV()})},onSuccess:E=>{var C;r(null),l("idle"),d({trongVung:E.trongVung,khoangCachMet:E.khoangCachMet,geofenceName:(C=E.geofence)==null?void 0:C.tenDiaDiem}),n.invalidateQueries({queryKey:["employee-portal","dashboard"]})},onError:E=>{var C,P;l("error"),r(((P=(C=E.response)==null?void 0:C.data)==null?void 0:P.message)||E.message||"Li khi chm cng")}}),p=f.isPending,N=()=>{var E;r(null),d(null),((E=u==null?void 0:u.chamCongHomNay)==null?void 0:E.trangThai)==="DA_VAO"?f.mutate("CHECK_OUT"):f.mutate("CHECK_IN")};if(x)return t.jsx("div",{className:"space-y-4",children:[1,2,3].map(E=>t.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"},E))});const g=(()=>{var C;const E=(C=u==null?void 0:u.chamCongHomNay)==null?void 0:C.trangThai;return E==="DA_RA"?{label:" ra",color:"text-green-600",bg:"bg-green-100 dark:bg-green-900/30"}:E==="DA_VAO"?{label:" vo",color:"text-blue-600",bg:"bg-blue-100 dark:bg-blue-900/30"}:{label:"Cha vo",color:"text-gray-500",bg:"bg-gray-100 dark:bg-gray-700"}})();return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 rounded-2xl p-5 text-white shadow-lg",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-blue-100 text-sm",children:"Xin cho,"}),t.jsx("h2",{className:"text-xl font-bold mt-1",children:u==null?void 0:u.nhanVien.hoTen}),t.jsxs("p",{className:"text-blue-200 text-sm mt-1",children:[u==null?void 0:u.nhanVien.chucVu,"  ",u==null?void 0:u.nhanVien.phongBan]})]}),t.jsx("div",{className:"w-12 h-12 rounded-full bg-white/20 flex items-center justify-center text-xl font-bold",children:((b=u==null?void 0:u.nhanVien.hoTen)==null?void 0:b[0])||"N"})]}),u!=null&&u.caHomNay?t.jsxs("div",{className:"mt-4 bg-white/10 rounded-xl p-3 flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:u.caHomNay.mauHienThi||"#3B82F6"},children:t.jsx(an,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm text-blue-100",children:"Ca hm nay"}),t.jsxs("p",{className:"font-semibold",children:[u.caHomNay.tenCa," (",u.caHomNay.gioVao," - ",u.caHomNay.gioRa,")"]})]})]}):t.jsxs("div",{className:"mt-4 bg-white/10 rounded-xl p-3 flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/20 flex items-center justify-center",children:t.jsx(Lt,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-blue-100",children:"Hm nay"}),t.jsx("p",{className:"font-semibold",children:"Khng c ca lm vic"})]})]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-5 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:`w-14 h-14 rounded-xl ${g.bg} flex items-center justify-center`,children:((j=u==null?void 0:u.chamCongHomNay)==null?void 0:j.trangThai)==="DA_RA"?t.jsx(Gn,{className:`w-7 h-7 ${g.color}`}):((T=u==null?void 0:u.chamCongHomNay)==null?void 0:T.trangThai)==="DA_VAO"?t.jsx(ng,{className:`w-7 h-7 ${g.color}`}):t.jsx(I_,{className:`w-7 h-7 ${g.color}`})}),t.jsxs("div",{children:[t.jsx("p",{className:`text-sm ${g.color} font-medium`,children:g.label}),((S=u==null?void 0:u.chamCongHomNay)==null?void 0:S.gioVao)&&t.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:["Vo: ",$0(u.chamCongHomNay.gioVao),u.chamCongHomNay.gioRa&&`  Ra: ${$0(u.chamCongHomNay.gioRa)}`]})]})]}),((w=u==null?void 0:u.chamCongHomNay)==null?void 0:w.trangThai)!=="DA_RA"&&t.jsx("button",{onClick:N,disabled:p,className:`px-4 py-2 rounded-xl font-medium transition-colors flex items-center gap-2 ${p?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} text-white`,children:p?t.jsxs(t.Fragment,{children:[t.jsx(Rn,{className:"w-4 h-4 animate-spin"}),"ang x l..."]}):((_=u==null?void 0:u.chamCongHomNay)==null?void 0:_.trangThai)==="DA_VAO"?"Check-out":"Check-in"})]}),a&&t.jsxs("p",{className:"text-sm text-red-500 mt-3 flex items-center gap-1",children:[t.jsx(sa,{className:"w-4 h-4"}),a]}),o&&t.jsxs("div",{className:`text-sm mt-3 flex items-center gap-2 ${o.trongVung?"text-green-600":"text-yellow-600"}`,children:[t.jsx(Xd,{className:"w-4 h-4"}),o.trongVung?t.jsxs("span",{children:[' Trong vng "',o.geofenceName,'"',o.khoangCachMet&&` (cch ${o.khoangCachMet}m)`]}):o.khoangCachMet?t.jsxs("span",{children:[" Ngoi vng cho php (cch ",o.khoangCachMet,"m)"]}):null]}),s==="getting"&&t.jsxs("p",{className:"text-sm text-blue-500 mt-3 flex items-center gap-2",children:[t.jsx(wc,{className:"w-4 h-4 animate-pulse"}),"ang ly v tr GPS..."]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[t.jsxs("button",{onClick:()=>e("/portal/yeu-cau"),className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700 text-center",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center mx-auto",children:t.jsx(ma,{className:"w-5 h-5 text-orange-600"})}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-2",children:(u==null?void 0:u.thongKe.soDonChoDuyet)||0}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"n ch duyt"})]}),t.jsxs("button",{onClick:()=>e("/portal/ca-nhan"),className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700 text-center",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 dark:bg-green-900/30 flex items-center justify-center mx-auto",children:t.jsx(Lt,{className:"w-5 h-5 text-green-600"})}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-2",children:(u==null?void 0:u.thongKe.soNgayPhepConLai)||0}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Php cn li"})]}),t.jsxs("button",{onClick:()=>e("/portal/cham-cong"),className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700 text-center",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center mx-auto",children:t.jsx(y0,{className:"w-5 h-5 text-blue-600"})}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-2",children:(u==null?void 0:u.thongKe.soNgayCongThang)||0}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Ngy cng"})]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-5 py-3 border-b border-gray-200 dark:border-gray-700",children:t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Thao tc nhanh"})}),t.jsx("div",{children:[{label:"Xem lch lm vic",icon:Lt,path:"/portal/lich-lam",color:"text-blue-600"},{label:"To n yu cu",icon:ma,path:"/portal/yeu-cau",color:"text-orange-600"},{label:"Xem phiu lng",icon:y0,path:"/portal/ca-nhan",color:"text-green-600"}].map(E=>t.jsxs("button",{onClick:()=>e(E.path),className:"w-full flex items-center justify-between px-5 py-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(E.icon,{className:`w-5 h-5 ${E.color}`}),t.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:E.label})]}),t.jsx(qn,{className:"w-5 h-5 text-gray-400"})]},E.path))})]})]})}function KV(){const[e,n]=D.useState(0),a=m=>{const f=new Date,p=f.getDay(),N=new Date(f);N.setDate(f.getDate()-(p===0?6:p-1)+m*7),N.setHours(0,0,0,0);const y=new Date(N);return y.setDate(N.getDate()+6),{monday:N,sunday:y}},{monday:r,sunday:s}=a(e),{data:l,isLoading:o}=Le({queryKey:["employee-portal","lich-lam-viec",r.toISOString()],queryFn:()=>Bc.getLichLamViec({tuNgay:r.toISOString().split("T")[0],denNgay:s.toISOString().split("T")[0]})}),d=()=>{const m=f=>`${f.getDate()}/${f.getMonth()+1}`;return`${m(r)} - ${m(s)}`},u=m=>{const f=new Date().toISOString().split("T")[0];return m===f},x=m=>{const f=new Date;return f.setHours(0,0,0,0),new Date(m)<f};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("button",{onClick:()=>n(e-1),className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(Nr,{className:"w-5 h-5"})}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:d()}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e===0?"Tun ny":e>0?`+${e} tun`:`${e} tun`})]}),t.jsx("button",{onClick:()=>n(e+1),className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(qn,{className:"w-5 h-5"})})]}),e!==0&&t.jsx("button",{onClick:()=>n(0),className:"w-full mt-3 py-2 text-sm text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg font-medium",children:"V tun hin ti"})]}),o?t.jsx("div",{className:"space-y-3",children:[1,2,3,4,5,6,7].map(m=>t.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"},m))}):t.jsx("div",{className:"space-y-3",children:l==null?void 0:l.map(m=>t.jsx("div",{className:`bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border transition-all ${u(m.ngay)?"border-blue-500 ring-2 ring-blue-100 dark:ring-blue-900/50":"border-gray-200 dark:border-gray-700"} ${x(m.ngay)&&!u(m.ngay)?"opacity-60":""}`,children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsxs("div",{className:`w-14 h-14 rounded-xl flex flex-col items-center justify-center ${u(m.ngay)?"bg-blue-600 text-white":m.thuTrongTuan===0||m.thuTrongTuan===6?"bg-gray-100 dark:bg-gray-700 text-gray-500":"bg-gray-50 dark:bg-gray-700/50 text-gray-700 dark:text-gray-300"}`,children:[t.jsx("span",{className:"text-xs font-medium",children:RV(m.thuTrongTuan)}),t.jsx("span",{className:"text-lg font-bold",children:new Date(m.ngay).getDate()})]}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[BV(m.thuTrongTuan),", ",new Date(m.ngay).toLocaleDateString("vi-VN")]}),m.nghiPhep?t.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 rounded-lg bg-green-100 dark:bg-green-900/30 flex items-center justify-center",children:t.jsx(C_,{className:"w-4 h-4 text-green-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-green-600",children:m.nghiPhep.loaiNghi}),t.jsx("p",{className:"text-xs text-gray-500",children:m.nghiPhep.trangThai})]})]}):m.ca?t.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:m.ca.mauHienThi||"#3B82F6"},children:t.jsx(y0,{className:"w-4 h-4 text-white"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:m.ca.tenCa}),t.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[m.ca.gioVao," - ",m.ca.gioRa]})]})]}):t.jsxs("div",{className:"mt-2 flex items-center gap-2 text-gray-400",children:[t.jsx(Lt,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"Khng c ca lm vic"})]})]})]})},m.ngay))})]})}function zV(){var g,b,j,T,S,w;const e=new Date,[n,a]=D.useState(e.getMonth()+1),[r,s]=D.useState(e.getFullYear()),{data:l,isLoading:o}=Le({queryKey:["employee-portal","cham-cong",n,r],queryFn:()=>Bc.getChamCong({thang:n,nam:r})}),d=n===e.getMonth()+1&&r===e.getFullYear(),{data:u,isLoading:x}=Le({queryKey:["employee-portal","san-luong",n,r],queryFn:async()=>{var _;try{const E=await he.get("/san-luong/my-stats",{params:{thang:n,nam:r}});return((_=E.data)==null?void 0:_.data)||E.data}catch{return null}},enabled:d}),m=()=>{n===1?(a(12),s(r-1)):a(n-1)},f=()=>{n===12?(a(1),s(r+1)):a(n+1)},p=_=>{switch(_){case"DU_CONG":return{text:" cng",color:"text-green-600 bg-green-50 dark:bg-green-900/30"};case"DI_TRE":return{text:"i tr",color:"text-yellow-600 bg-yellow-50 dark:bg-yellow-900/30"};case"VE_SOM":return{text:"V sm",color:"text-yellow-600 bg-yellow-50 dark:bg-yellow-900/30"};case"NGHI_KHONG_PHEP":return{text:"Ngh K.Php",color:"text-red-600 bg-red-50 dark:bg-red-900/30"};case"NGHI_CO_PHEP":return{text:"Ngh php",color:"text-blue-600 bg-blue-50 dark:bg-blue-900/30"};default:return{text:_,color:"text-gray-600 bg-gray-50 dark:bg-gray-700"}}},N={duCong:(l==null?void 0:l.filter(_=>_.trangThai==="DU_CONG").length)||0,diTre:(l==null?void 0:l.filter(_=>_.trangThai==="DI_TRE").length)||0,veSom:(l==null?void 0:l.filter(_=>_.trangThai==="VE_SOM").length)||0,nghiKhongPhep:(l==null?void 0:l.filter(_=>_.trangThai==="NGHI_KHONG_PHEP").length)||0},y=_=>{const E=new Date().toISOString().split("T")[0];return _===E};return t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("button",{onClick:m,className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(Nr,{className:"w-5 h-5"})}),t.jsx("div",{className:"text-center",children:t.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:["Thng ",n,"/",r]})}),t.jsx("button",{onClick:f,className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(qn,{className:"w-5 h-5"})})]})}),t.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[t.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 rounded-xl p-3 text-center",children:[t.jsx("p",{className:"text-xl font-bold text-green-600",children:N.duCong}),t.jsx("p",{className:"text-xs text-green-600",children:" cng"})]}),t.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/30 rounded-xl p-3 text-center",children:[t.jsx("p",{className:"text-xl font-bold text-yellow-600",children:N.diTre}),t.jsx("p",{className:"text-xs text-yellow-600",children:"i tr"})]}),t.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/30 rounded-xl p-3 text-center",children:[t.jsx("p",{className:"text-xl font-bold text-orange-600",children:N.veSom}),t.jsx("p",{className:"text-xs text-orange-600",children:"V sm"})]}),t.jsxs("div",{className:"bg-red-50 dark:bg-red-900/30 rounded-xl p-3 text-center",children:[t.jsx("p",{className:"text-xl font-bold text-red-600",children:N.nghiKhongPhep}),t.jsx("p",{className:"text-xs text-red-600",children:"K.Php"})]})]}),d&&t.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-500 rounded-2xl p-4 shadow-md text-white",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(oi,{className:"w-5 h-5"}),t.jsx("h3",{className:"font-semibold",children:"Sn lng thng ny"})]}),x?t.jsx("div",{className:"h-16 bg-white/20 rounded-xl animate-pulse"}):u?t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[(((g=u.chiaHang)==null?void 0:g.tongSanPham)>0||u.chiaHang)&&t.jsxs("div",{className:"bg-white/20 rounded-xl p-3",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx(J0,{className:"w-4 h-4"}),t.jsx("span",{className:"text-xs opacity-80",children:"Chia hng"})]}),t.jsxs("p",{className:"text-lg font-bold",children:[(((b=u.chiaHang)==null?void 0:b.tongSanPham)||0).toLocaleString("vi-VN"),t.jsx("span",{className:"text-xs font-normal ml-1",children:"SP"})]}),((j=u.chiaHang)==null?void 0:j.sanPhamLoi)>0&&t.jsxs("p",{className:"text-xs opacity-80",children:["Li: ",u.chiaHang.sanPhamLoi.toLocaleString("vi-VN")]})]}),(((T=u.giaoHang)==null?void 0:T.tongKhoiLuong)>0||u.giaoHang)&&t.jsxs("div",{className:"bg-white/20 rounded-xl p-3",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx(Z0,{className:"w-4 h-4"}),t.jsx("span",{className:"text-xs opacity-80",children:"Giao hng"})]}),t.jsxs("p",{className:"text-lg font-bold",children:[(((S=u.giaoHang)==null?void 0:S.tongKhoiLuong)||0).toLocaleString("vi-VN"),t.jsx("span",{className:"text-xs font-normal ml-1",children:"kg"})]}),((w=u.giaoHang)==null?void 0:w.soLuotGiao)>0&&t.jsxs("p",{className:"text-xs opacity-80",children:[u.giaoHang.soLuotGiao," lt giao"]})]}),u.diemKPI>0&&t.jsx("div",{className:"bg-white/20 rounded-xl p-3 col-span-2",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm",children:"im KPI"}),t.jsx("span",{className:"text-xl font-bold",children:u.diemKPI.toFixed(1)})]})}),!u.chiaHang&&!u.giaoHang&&!u.diemKPI&&t.jsx("div",{className:"col-span-2 text-center py-2 text-sm opacity-80",children:"Cha c d liu sn lng"})]}):t.jsx("div",{className:"text-center py-2 text-sm opacity-80",children:"Cha c d liu sn lng"})]}),o?t.jsx("div",{className:"space-y-3",children:[1,2,3,4,5].map(_=>t.jsx("div",{className:"h-16 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"},_))}):l&&l.length>0?t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:l.map((_,E)=>{const C=p(_.trangThai);return t.jsxs("div",{className:`flex items-center gap-4 px-4 py-3 ${E<l.length-1?"border-b border-gray-100 dark:border-gray-700":""} ${y(_.ngay)?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[t.jsxs("div",{className:"w-12 text-center",children:[t.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:new Date(_.ngay).getDate()}),t.jsx("p",{className:"text-xs text-gray-500",children:["CN","T2","T3","T4","T5","T6","T7"][new Date(_.ngay).getDay()]})]}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Vo:"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:$0(_.gioVaoThucTe)}),t.jsx("span",{className:"text-gray-400",children:""}),t.jsx("span",{className:"text-gray-500",children:"Ra:"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:$0(_.gioRaThucTe)})]}),_.ca&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Ca: ",_.ca.tenCa]})]}),t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-lg ${C.color}`,children:C.text})]},_.ngay)})}):t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx(an,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Cha c d liu chm cng"})]})]})}const Ll=[{value:"NGHI_PHEP",label:"Ngh php nm",icon:"",nhom:"NGHI_PHEP"},{value:"NGHI_KHONG_LUONG",label:"Ngh khng lng",icon:"",nhom:"NGHI_PHEP"},{value:"NGHI_OM",label:"Ngh m",icon:"",nhom:"NGHI_PHEP"},{value:"NGHI_VIEC_RIENG",label:"Ngh vic ring",icon:"",nhom:"NGHI_PHEP"},{value:"OT",label:"Lm thm gi",icon:"",nhom:"THOI_GIAN"},{value:"TRE_GIO",label:"i tr",icon:"",nhom:"THOI_GIAN"},{value:"VE_SOM",label:"V sm",icon:"",nhom:"THOI_GIAN"},{value:"CONG_TAC",label:"Cng tc",icon:"",nhom:"DI_CHUYEN"},{value:"WFH",label:"Lm vic t xa",icon:"",nhom:"DI_CHUYEN"}];function $V(){var y,g;const[e,n]=D.useState(!1),[a,r]=D.useState("ALL"),s=Mt(),[l,o]=D.useState({loai:"NGHI_PHEP",ngay:new Date().toISOString().split("T")[0],soNgay:1,soGio:1,lyDo:""}),{data:d,isLoading:u}=Le({queryKey:["employee-portal","yeu-cau",a],queryFn:async()=>{const b={};return a!=="ALL"&&(b.trangThai=a),(await he.get("/yeu-cau/my-requests",{params:b})).data.data||[]}}),x=De({mutationFn:async b=>(await he.post("/yeu-cau",b)).data,onSuccess:()=>{s.invalidateQueries({queryKey:["employee-portal","yeu-cau"]}),n(!1),o({loai:"NGHI_PHEP",ngay:new Date().toISOString().split("T")[0],soNgay:1,soGio:1,lyDo:""})}}),m=b=>{switch(b){case"DA_DUYET":return{text:" duyt",color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",icon:Br};case"TU_CHOI":return{text:"T chi",color:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",icon:mn};case"CHO_DUYET":default:return{text:"Ch duyt",color:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",icon:an}}},f=b=>{var j;return((j=Ll.find(T=>T.value===b))==null?void 0:j.label)||b},p=b=>{var j;return((j=Ll.find(T=>T.value===b))==null?void 0:j.icon)||""},N=b=>{if(b.preventDefault(),!l.lyDo.trim()){alert("Vui lng nhp l do");return}x.mutate(l)};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("button",{onClick:()=>n(!0),className:"w-full flex items-center justify-center gap-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 rounded-2xl font-medium shadow-md",children:[t.jsx(Dt,{className:"w-5 h-5"}),"To yu cu mi"]}),t.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:[{value:"ALL",label:"Tt c"},{value:"CHO_DUYET",label:"Ch duyt"},{value:"DA_DUYET",label:" duyt"},{value:"TU_CHOI",label:"T chi"}].map(b=>t.jsx("button",{onClick:()=>r(b.value),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors ${a===b.value?"bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300"}`,children:b.label},b.value))}),u?t.jsx("div",{className:"space-y-3",children:[1,2,3].map(b=>t.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"},b))}):d&&d.length>0?t.jsx("div",{className:"space-y-3",children:d.map(b=>{const j=m(b.trangThai),T=j.icon;return t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"text-2xl",children:p(b.loai)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:f(b.loai)}),t.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${j.color}`,children:[t.jsx(T,{className:"w-3 h-3"}),j.text]})]}),t.jsxs("p",{className:"text-sm text-gray-500 mb-1",children:[new Date(b.ngay).toLocaleDateString("vi-VN"),"  ",b.soGio," gi"]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:b.lyDo})]}),t.jsx(qn,{className:"w-5 h-5 text-gray-400"})]})},b.id)})}):t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx(di,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Cha c yu cu no"})]}),e&&t.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-end justify-center",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 w-full max-w-lg rounded-t-3xl p-6 pb-10 animate-slide-up",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"To yu cu mi"}),t.jsx("button",{onClick:()=>n(!1),className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(mn,{className:"w-5 h-5"})})]}),t.jsxs("form",{onSubmit:N,className:"space-y-4",children:[t.jsxs("div",{className:"max-h-[40vh] overflow-y-auto pr-1",children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:" Ngh php"}),t.jsx("div",{className:"grid grid-cols-2 gap-2 mb-4",children:Ll.filter(b=>b.nhom==="NGHI_PHEP").map(b=>t.jsxs("button",{type:"button",onClick:()=>o({...l,loai:b.value}),className:`flex items-center gap-2 px-3 py-2.5 rounded-xl border-2 transition-colors text-sm ${l.loai===b.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600"}`,children:[t.jsx("span",{className:"text-lg",children:b.icon}),t.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:b.label})]},b.value))}),t.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:" Thi gian"}),t.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:Ll.filter(b=>b.nhom==="THOI_GIAN").map(b=>t.jsxs("button",{type:"button",onClick:()=>o({...l,loai:b.value}),className:`flex items-center gap-1 px-3 py-2.5 rounded-xl border-2 transition-colors text-sm ${l.loai===b.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600"}`,children:[t.jsx("span",{className:"text-lg",children:b.icon}),t.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:b.label})]},b.value))}),t.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:" Di chuyn / Lm vic t xa"}),t.jsx("div",{className:"grid grid-cols-2 gap-2",children:Ll.filter(b=>b.nhom==="DI_CHUYEN").map(b=>t.jsxs("button",{type:"button",onClick:()=>o({...l,loai:b.value}),className:`flex items-center gap-2 px-3 py-2.5 rounded-xl border-2 transition-colors text-sm ${l.loai===b.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600"}`,children:[t.jsx("span",{className:"text-lg",children:b.icon}),t.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:b.label})]},b.value))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Ngy bt u"}),t.jsx("input",{type:"date",value:l.ngay,onChange:b=>o({...l,ngay:b.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),((y=Ll.find(b=>b.value===l.loai))==null?void 0:y.nhom)==="NGHI_PHEP"&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"S ngy ngh"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("input",{type:"number",min:"0.5",max:"30",step:"0.5",value:l.soNgay,onChange:b=>o({...l,soNgay:parseFloat(b.target.value)}),className:"flex-1 px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),t.jsx("span",{className:"text-sm text-gray-500",children:"ngy"})]})]}),((g=Ll.find(b=>b.value===l.loai))==null?void 0:g.nhom)==="THOI_GIAN"&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"S gi"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("input",{type:"number",min:"0.5",max:"12",step:"0.5",value:l.soGio,onChange:b=>o({...l,soGio:parseFloat(b.target.value)}),className:"flex-1 px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),t.jsx("span",{className:"text-sm text-gray-500",children:"gi"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"L do"}),t.jsx("textarea",{value:l.lyDo,onChange:b=>o({...l,lyDo:b.target.value}),rows:3,placeholder:"Nhp l do yu cu...",className:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none"})]}),t.jsx("button",{type:"submit",disabled:x.isPending,className:"w-full py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl font-medium disabled:opacity-50",children:x.isPending?"ang gi...":"Gi yu cu"})]})]})})]})}function GV(){const[e,n]=D.useState("ho-so");return t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-1 shadow-sm border border-gray-200 dark:border-gray-700",children:t.jsx("div",{className:"flex",children:[{id:"ho-so",label:"H s",icon:so},{id:"phieu-luong",label:"Phiu lng",icon:ma},{id:"so-du-phep",label:"S d php",icon:Lt}].map(a=>t.jsxs("button",{onClick:()=>n(a.id),className:`flex-1 flex items-center justify-center gap-1.5 py-2.5 rounded-xl text-sm font-medium transition-colors ${e===a.id?"bg-blue-500 text-white":"text-gray-600 dark:text-gray-300"}`,children:[t.jsx(a.icon,{className:"w-4 h-4"}),a.label]},a.id))})}),e==="ho-so"&&t.jsx(qV,{}),e==="phieu-luong"&&t.jsx(WV,{}),e==="so-du-phep"&&t.jsx(XV,{})]})}function qV(){var a;const{data:e,isLoading:n}=Le({queryKey:["employee-portal","ho-so"],queryFn:()=>Bc.getHoSo()});return n?t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"}),t.jsx("div",{className:"h-48 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"})]}):e?t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl p-6 text-white",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-16 h-16 bg-white/20 backdrop-blur rounded-full flex items-center justify-center text-2xl font-bold",children:e.hoTen.charAt(0)}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold",children:e.hoTen}),t.jsx("p",{className:"text-blue-100",children:e.maNhanVien}),e.chucVu&&t.jsx("p",{className:"text-sm text-blue-200 mt-1",children:e.chucVu})]})]})}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx(Ed,{icon:b_,label:"Phng ban",value:typeof e.phongBan=="object"?(a=e.phongBan)==null?void 0:a.tenPhongBan:e.phongBan||"Cha c"}),t.jsx(Ed,{icon:ag,label:"Email",value:e.email||"Cha cp nht"}),t.jsx(Ed,{icon:H_,label:"in thoi",value:e.soDienThoai||"Cha cp nht"}),t.jsx(Ed,{icon:Lt,label:"Ngy vo lm",value:e.ngayVaoLam?new Date(e.ngayVaoLam).toLocaleDateString("vi-VN"):"Cha c"}),t.jsx(Ed,{icon:__,label:"STK ngn hng",value:e.soTaiKhoan||"Cha cp nht",last:!0})]}),e.nganHang&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx(G_,{className:"w-5 h-5 text-blue-500"}),t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Thng tin ngn hng"})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("p",{className:"text-gray-500",children:"Ngn hng"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:e.nganHang.tenNganHang})]})]})]}):t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center",children:[t.jsx(so,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Khng tm thy thng tin"})]})}function Ed({icon:e,label:n,value:a,last:r=!1}){return t.jsxs("div",{className:`flex items-center gap-3 px-4 py-3 ${r?"":"border-b border-gray-100 dark:border-gray-700"}`,children:[t.jsx(e,{className:"w-5 h-5 text-gray-400"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-xs text-gray-500",children:n}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a})]})]})}function WV(){const{data:e,isLoading:n}=Le({queryKey:["employee-portal","phieu-luong"],queryFn:()=>Bc.getPhieuLuong()});if(n)return t.jsx("div",{className:"space-y-3",children:[1,2,3].map(r=>t.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"},r))});const a=(e==null?void 0:e.data)||[];return a.length===0?t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center",children:[t.jsx(ma,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Cha c phiu lng"})]}):t.jsx("div",{className:"space-y-3",children:a.map(r=>t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h4",{className:"font-semibold text-gray-900 dark:text-white",children:["Thng ",r.thang,"/",r.nam]}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:r.kyLuong})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-lg font-bold text-green-600",children:Uf(r.thucLinh)}),t.jsx("p",{className:"text-xs text-gray-500",children:"Thc nhn"})]})]}),t.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100 dark:border-gray-700",children:t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-500",children:"Thu nhp"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:Uf(r.tongThuNhap)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-500",children:"Khu tr"}),t.jsx("p",{className:"font-medium text-red-600",children:Uf(r.tongKhauTru)})]})]})})]},r.id))})}function XV(){var d;const{data:e,isLoading:n}=Le({queryKey:["employee-portal","so-du-phep"],queryFn:()=>Bc.getSoDuPhep()});if(n)return t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"}),t.jsx("div",{className:"h-24 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"})]});if(!e)return t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center",children:[t.jsx(Lt,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Khng c d liu"})]});const a=e.phepNam,r=(a==null?void 0:a.conLai)||0,s=(a==null?void 0:a.tongSo)||12,l=(a==null?void 0:a.daSuDung)||0,o=s>0?l/s*100:0;return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl p-6 text-white",children:[t.jsx("p",{className:"text-emerald-100 mb-2",children:"S ngy php cn li"}),t.jsxs("div",{className:"flex items-end gap-2",children:[t.jsx("span",{className:"text-5xl font-bold",children:r}),t.jsxs("span",{className:"text-emerald-200 mb-1",children:["/ ",s," ngy"]})]}),t.jsx("div",{className:"mt-4",children:t.jsx("div",{className:"h-2 bg-white/20 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-white rounded-full transition-all",style:{width:`${100-o}%`}})})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx("p",{className:"text-sm text-gray-500 mb-1",children:" s dng"}),t.jsx("p",{className:"text-2xl font-bold text-blue-600",children:l}),t.jsx("p",{className:"text-xs text-gray-400",children:"ngy"})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Loi ngh khc"}),t.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:((d=e.danhSachLoaiNghi)==null?void 0:d.length)||0}),t.jsx("p",{className:"text-xs text-gray-400",children:"loi"})]})]}),e.danhSachLoaiNghi&&e.danhSachLoaiNghi.length>0&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Chi tit cc loi ngh"}),t.jsx("div",{className:"space-y-2",children:e.danhSachLoaiNghi.map(u=>t.jsxs("div",{className:"flex justify-between items-center text-sm",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:u.tenLoai}),t.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[u.soNgayDaSuDung," ngy"]})]},u.maLoai))})]}),t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-2xl p-4",children:[t.jsx("h4",{className:"font-medium text-blue-800 dark:text-blue-300 mb-2",children:"Lu "}),t.jsxs("ul",{className:"text-sm text-blue-700 dark:text-blue-400 space-y-1",children:[t.jsxs("li",{children:[" S ngy php c tnh theo nm ",new Date().getFullYear()]}),t.jsx("li",{children:" Php khng s dng ht s chuyn sang nm sau (ti a 5 ngy)"}),t.jsx("li",{children:" Lin h HR  c h tr"})]})]})]})}function g2(){var j;const e=br(),n=Mt(),[a,r]=D.useState("tat-ca"),[s,l]=D.useState(1),o=20,{data:d,isLoading:u,refetch:x,isFetching:m}=Le({queryKey:["thong-bao","list",{page:s,limit:o,filter:a}],queryFn:()=>el.layDanhSach({page:s,limit:o,daDoc:a==="chua-doc"?!1:a==="da-doc"?!0:void 0})}),{data:f}=Le({queryKey:["thong-bao","chua-doc"],queryFn:()=>el.demChuaDoc()}),p=De({mutationFn:T=>el.danhDauDaDoc(T),onSuccess:()=>{n.invalidateQueries({queryKey:["thong-bao"]})}}),N=De({mutationFn:()=>el.danhDauTatCaDaDoc(),onSuccess:()=>{n.invalidateQueries({queryKey:["thong-bao"]})}}),y=T=>{T.daDoc||p.mutate(T.id),T.link&&e(T.link)},g=d?Math.ceil(d.total/o):1,b=(f==null?void 0:f.chuaDoc)||0;return t.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[t.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-10",children:t.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h1",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[t.jsx(jc,{className:"w-5 h-5"}),"Thng bo",b>0&&t.jsxs("span",{className:"bg-red-500 text-white text-xs px-2 py-0.5 rounded-full",children:[b," cha c"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>x(),disabled:m,className:"p-2 text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg disabled:opacity-50",title:"Lm mi",children:t.jsx(yr,{className:`w-4 h-4 ${m?"animate-spin":""}`})}),b>0&&t.jsxs("button",{onClick:()=>N.mutate(),disabled:N.isPending,className:"flex items-center gap-1 px-3 py-1.5 text-sm text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg disabled:opacity-50",children:[t.jsx(oj,{className:"w-4 h-4"}),"c tt c"]})]})]}),t.jsx("div",{className:"flex gap-1 bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[{id:"tat-ca",label:"Tt c"},{id:"chua-doc",label:"Cha c"},{id:"da-doc",label:" c"}].map(T=>t.jsxs("button",{onClick:()=>{r(T.id),l(1)},className:`flex-1 px-4 py-2 text-sm font-medium rounded-md transition-colors ${a===T.id?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:[T.label,T.id==="chua-doc"&&b>0&&t.jsxs("span",{className:"ml-1 text-xs text-red-500",children:["(",b,")"]})]},T.id))})]})}),t.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-4",children:[u?t.jsx("div",{className:"space-y-4",children:[...Array(5)].map((T,S)=>t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 animate-pulse",children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gray-200 dark:bg-gray-700 rounded-full"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"}),t.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-full"})]})]})},S))}):(j=d==null?void 0:d.data)!=null&&j.length?t.jsx("div",{className:"space-y-2",children:d.data.map(T=>{const{icon:S,color:w}=MT(T.loaiThongBao);return t.jsx("button",{onClick:()=>y(T),className:`w-full text-left bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm hover:shadow-md transition-all border border-gray-100 dark:border-gray-700 ${T.daDoc?"":"ring-2 ring-blue-500/20"}`,children:t.jsxs("div",{className:"flex gap-4",children:[t.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-xl ${T.daDoc?"bg-gray-100 dark:bg-gray-700":"bg-blue-100 dark:bg-blue-900/30"} ${w}`,children:S}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsx("h3",{className:`font-medium ${T.daDoc?"text-gray-600 dark:text-gray-400":"text-gray-900 dark:text-white"}`,children:T.tieuDe}),t.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[!T.daDoc&&t.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),t.jsx("span",{className:"text-xs text-gray-400",children:OT(T.ngayTao)})]})]}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1 line-clamp-2",children:T.noiDung}),T.link&&t.jsx("p",{className:"text-xs text-blue-500 mt-2",children:"Nhn  xem chi tit "})]})]})},T.id)})}):t.jsxs("div",{className:"text-center py-16",children:[t.jsx(jc,{className:"w-12 h-12 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:a==="chua-doc"?"Khng c thng bo cha c":a==="da-doc"?"Khng c thng bo  c":"Cha c thng bo no"})]}),d&&g>1&&t.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[t.jsx("button",{onClick:()=>l(T=>Math.max(1,T-1)),disabled:s===1,className:"px-4 py-2 text-sm bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg disabled:opacity-50 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Trc"}),t.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Trang ",s," / ",g]}),t.jsx("button",{onClick:()=>l(T=>Math.min(g,T+1)),disabled:s===g,className:"px-4 py-2 text-sm bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg disabled:opacity-50 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Sau"})]})]})]})}function QV(){const e=Mt(),[n,a]=D.useState(!1),[r,s]=D.useState(null),[l,o]=D.useState(),[d,u]=D.useState(""),[x,m]=D.useState({tenDiaDiem:"",diaChi:"",viDo:0,kinhDo:0,banKinhMet:100,phongBanId:void 0,apDungTatCa:!1,batBuocGPS:!0,chanNgoaiVung:!1}),{data:f,isLoading:p}=Le({queryKey:["geofences",l],queryFn:()=>fr.layDanhSachGeofence({phongBanId:l})}),{data:N}=Le({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),y=De({mutationFn:fr.taoGeofence,onSuccess:()=>{e.invalidateQueries({queryKey:["geofences"]}),ie.success("To geofence thnh cng"),w()},onError:F=>{var R,O;ie.error(((O=(R=F.response)==null?void 0:R.data)==null?void 0:O.message)||"C li xy ra")}}),g=De({mutationFn:({id:F,data:R})=>fr.capNhatGeofence(F,R),onSuccess:()=>{e.invalidateQueries({queryKey:["geofences"]}),ie.success("Cp nht thnh cng"),w()},onError:F=>{var R,O;ie.error(((O=(R=F.response)==null?void 0:R.data)==null?void 0:O.message)||"C li xy ra")}}),b=De({mutationFn:fr.xoaGeofence,onSuccess:()=>{e.invalidateQueries({queryKey:["geofences"]}),ie.success("Xa thnh cng")},onError:F=>{var R,O;ie.error(((O=(R=F.response)==null?void 0:R.data)==null?void 0:O.message)||"C li xy ra")}}),j=De({mutationFn:({id:F,trangThai:R})=>fr.capNhatGeofence(F,{trangThai:R}),onSuccess:()=>{e.invalidateQueries({queryKey:["geofences"]}),ie.success("Cp nht trng thi thnh cng")}}),T=()=>{s(null),m({tenDiaDiem:"",diaChi:"",viDo:0,kinhDo:0,banKinhMet:100,phongBanId:void 0,apDungTatCa:!1,batBuocGPS:!0,chanNgoaiVung:!1}),a(!0)},S=F=>{s(F),m({tenDiaDiem:F.tenDiaDiem,diaChi:F.diaChi||"",viDo:F.viDo,kinhDo:F.kinhDo,banKinhMet:F.banKinhMet,phongBanId:F.phongBanId,apDungTatCa:F.apDungTatCa,batBuocGPS:F.batBuocGPS,chanNgoaiVung:F.chanNgoaiVung}),a(!0)},w=()=>{a(!1),s(null)},_=F=>{if(F.preventDefault(),!x.tenDiaDiem.trim()){ie.error("Vui lng nhp tn a im");return}if(x.viDo===0&&x.kinhDo===0){ie.error("Vui lng nhp ta  GPS");return}r?g.mutate({id:r.id,data:x}):y.mutate(x)},E=F=>{confirm(`Bn c chc mun xa geofence "${F.tenDiaDiem}"?`)&&b.mutate(F.id)},C=async()=>{try{const F=await RT();m({...x,viDo:F.viDo,kinhDo:F.kinhDo}),ie.success(" ly v tr hin ti")}catch(F){ie.error(F.message)}},P=f==null?void 0:f.filter(F=>{var R;return F.tenDiaDiem.toLowerCase().includes(d.toLowerCase())||((R=F.diaChi)==null?void 0:R.toLowerCase().includes(d.toLowerCase()))});return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-[var(--text-primary)]",children:"Cu hnh Geofence"}),t.jsx("p",{className:"text-[var(--text-muted)]",children:"Qun l vng a l cho php chm cng GPS"})]}),t.jsxs(ft,{onClick:T,children:[t.jsx(Dt,{className:"w-4 h-4 mr-2"}),"Thm a im"]})]}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[t.jsx("div",{className:"flex-1",children:t.jsxs("div",{className:"relative",children:[t.jsx(Vr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Tm kim a im...",value:d,onChange:F=>u(F.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]})}),t.jsx("div",{className:"sm:w-64",children:t.jsxs("select",{value:l||"",onChange:F=>o(F.target.value?Number(F.target.value):void 0),className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),N==null?void 0:N.map(F=>t.jsx("option",{value:F.id,children:F.tenPhongBan},F.id))]})})]})}),t.jsx(st,{children:p?t.jsx("div",{className:"p-8 text-center text-[var(--text-muted)]",children:"ang ti..."}):P!=null&&P.length?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-[var(--bg-secondary)] border-b",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"a im"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Ta "}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Bn knh"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"p dng"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Cu hnh"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y",children:P.map(F=>t.jsxs("tr",{className:"hover:bg-[var(--bg-secondary)]/50",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center",children:t.jsx(Xd,{className:"w-5 h-5 text-primary-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:F.tenDiaDiem}),F.diaChi&&t.jsx("p",{className:"text-sm text-[var(--text-muted)]",children:F.diaChi})]})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:[F.viDo.toFixed(6),", ",F.kinhDo.toFixed(6)]})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsxs("span",{className:"font-medium",children:[F.banKinhMet,"m"]})}),t.jsx("td",{className:"px-4 py-3",children:F.apDungTatCa?t.jsx(Et,{variant:"info",children:"Ton cng ty"}):t.jsxs("span",{className:"text-sm text-[var(--text-muted)]",children:["Phng ban #",F.phongBanId]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[F.batBuocGPS&&t.jsxs(Et,{variant:"warning",className:"text-xs",children:[t.jsx(wc,{className:"w-3 h-3 mr-1"}),"GPS bt buc"]}),F.chanNgoaiVung&&t.jsxs(Et,{variant:"danger",className:"text-xs",children:[t.jsx(sa,{className:"w-3 h-3 mr-1"}),"Chn ngoi vng"]})]})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("button",{onClick:()=>j.mutate({id:F.id,trangThai:!F.trangThai}),className:"inline-flex items-center gap-1",children:F.trangThai?t.jsxs(t.Fragment,{children:[t.jsx(gj,{className:"w-6 h-6 text-green-500"}),t.jsx(Et,{variant:"success",children:"Hot ng"})]}):t.jsxs(t.Fragment,{children:[t.jsx(pj,{className:"w-6 h-6 text-gray-400"}),t.jsx(Et,{variant:"neutral",children:"Tt"})]})})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>S(F),className:"p-2 text-gray-500 hover:text-primary-600 hover:bg-primary-50 rounded-lg",title:"Chnh sa",children:t.jsx(Za,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>E(F),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Xa",children:t.jsx(er,{className:"w-4 h-4"})})]})})]},F.id))})]})}):t.jsxs("div",{className:"p-8 text-center text-[var(--text-muted)]",children:[t.jsx(Xd,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Cha c geofence no c cu hnh"})]})}),t.jsx(ns,{isOpen:n,onClose:w,size:"lg",children:t.jsxs("form",{onSubmit:_,children:[t.jsx(Ss,{title:r?"Chnh sa Geofence":"Thm a im mi"}),t.jsx(_s,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Tn a im ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:x.tenDiaDiem,onChange:F=>m({...x,tenDiaDiem:F.target.value}),placeholder:"VD: Vn phng chnh, Nh my ABC...",className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"a ch"}),t.jsx("input",{type:"text",value:x.diaChi,onChange:F=>m({...x,diaChi:F.target.value}),placeholder:"a ch y ...",className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["V  (Latitude) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"number",step:"any",value:x.viDo,onChange:F=>m({...x,viDo:parseFloat(F.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Kinh  (Longitude) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"number",step:"any",value:x.kinhDo,onChange:F=>m({...x,kinhDo:parseFloat(F.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg",required:!0})]})]}),t.jsx("div",{children:t.jsxs(ft,{type:"button",variant:"outline",onClick:C,className:"w-full",children:[t.jsx(wc,{className:"w-4 h-4 mr-2"}),"Ly v tr hin ti"]})}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Bn knh cho php (mt) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"number",min:"10",max:"5000",value:x.banKinhMet,onChange:F=>m({...x,banKinhMet:parseInt(F.target.value)||100}),className:"w-full px-3 py-2 border rounded-lg",required:!0}),t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1",children:"Khong cch ti a t im check-in n tm geofence"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Phm vi p dng"}),t.jsx("div",{className:"space-y-2",children:t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:x.apDungTatCa,onChange:F=>m({...x,apDungTatCa:F.target.checked,phongBanId:F.target.checked?void 0:x.phongBanId}),className:"rounded"}),t.jsx("span",{children:"p dng cho ton cng ty"})]})}),!x.apDungTatCa&&t.jsxs("select",{value:x.phongBanId||"",onChange:F=>m({...x,phongBanId:F.target.value?Number(F.target.value):void 0}),className:"w-full px-3 py-2 border rounded-lg mt-2",children:[t.jsx("option",{value:"",children:"Chn phng ban..."}),N==null?void 0:N.map(F=>t.jsx("option",{value:F.id,children:F.tenPhongBan},F.id))]})]}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Cu hnh bo mt"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("label",{className:"flex items-center gap-3 p-3 bg-[var(--bg-secondary)] rounded-lg cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:x.batBuocGPS,onChange:F=>m({...x,batBuocGPS:F.target.checked}),className:"rounded"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:"Bt buc bt GPS"}),t.jsx("p",{className:"text-sm text-[var(--text-muted)]",children:"Nhn vin phi bt GPS khi chm cng"})]})]}),t.jsxs("label",{className:"flex items-center gap-3 p-3 bg-[var(--bg-secondary)] rounded-lg cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:x.chanNgoaiVung,onChange:F=>m({...x,chanNgoaiVung:F.target.checked}),className:"rounded"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-red-600",children:"Chn check-in ngoi vng"}),t.jsx("p",{className:"text-sm text-[var(--text-muted)]",children:"Khng cho php chm cng nu ngoi bn knh cho php"})]})]})]})]})]})}),t.jsxs(ni,{children:[t.jsx(ft,{type:"button",variant:"secondary",onClick:w,children:"Hy"}),t.jsx(ft,{type:"submit",disabled:y.isPending||g.isPending,children:y.isPending||g.isPending?"ang lu...":r?t.jsxs(t.Fragment,{children:[t.jsx(Gn,{className:"w-4 h-4 mr-2"}),"Cp nht"]}):t.jsxs(t.Fragment,{children:[t.jsx(Dt,{className:"w-4 h-4 mr-2"}),"To mi"]})})]})]})})]})}function YV(){var E;const[e,n]=D.useState(),[a,r]=D.useState(),[s,l]=D.useState(),[o,d]=D.useState(()=>new Date().toISOString().split("T")[0]),[u,x]=D.useState(()=>new Date().toISOString().split("T")[0]),[m,f]=D.useState(1),p=20,{data:N,isLoading:y}=Le({queryKey:["gps-logs",e,s,o,u,m],queryFn:()=>fr.layLichSuGPS({nhanVienId:e,tuNgay:o,denNgay:u,trangThai:s,page:m,limit:p})}),{data:g}=Le({queryKey:["gps-thong-ke",o,u,a],queryFn:()=>fr.thongKeGPS(o,u,a),enabled:!!o&&!!u}),{data:b}=Le({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),{data:j}=Le({queryKey:["nhan-vien",a],queryFn:()=>ha.layTatCa({phongBanId:a,trangThai:"DANG_LAM",soLuong:500})}),T=C=>{switch(C){case"HOP_LE":return t.jsx(Gn,{className:"w-4 h-4 text-green-500"});case"NGOAI_VUNG":return t.jsx(mo,{className:"w-4 h-4 text-red-500"});case"CANH_BAO":return t.jsx(sa,{className:"w-4 h-4 text-yellow-500"});case"KHONG_CO_GPS":return t.jsx(wc,{className:"w-4 h-4 text-gray-400"});default:return null}},S=C=>{switch(C){case"HOP_LE":return t.jsx(Et,{variant:"success",children:"Hp l"});case"NGOAI_VUNG":return t.jsx(Et,{variant:"danger",children:"Ngoi vng"});case"CANH_BAO":return t.jsx(Et,{variant:"warning",children:"Cnh bo"});case"KHONG_CO_GPS":return t.jsx(Et,{variant:"neutral",children:"Khng GPS"});default:return t.jsx(Et,{variant:"neutral",children:C})}},w=C=>new Date(C).toLocaleString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),_=Array.isArray(j)?j:(j==null?void 0:j.data)||[];return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-[var(--text-primary)]",children:"Lch s GPS Chm cng"}),t.jsx("p",{className:"text-[var(--text-muted)]",children:"Theo di v kim tra v tr chm cng ca nhn vin"})]}),t.jsxs(ft,{variant:"outline",children:[t.jsx(ws,{className:"w-4 h-4 mr-2"}),"Xut Excel"]})]}),g&&t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[t.jsxs(st,{className:"p-4 text-center",children:[t.jsx("p",{className:"text-2xl font-bold",children:g.thongKe.tongBanGhi}),t.jsx("p",{className:"text-sm text-[var(--text-muted)]",children:"Tng bn ghi"})]}),t.jsxs(st,{className:"p-4 text-center bg-green-50",children:[t.jsx("p",{className:"text-2xl font-bold text-green-600",children:g.thongKe.hopLe}),t.jsxs("p",{className:"text-sm text-green-600",children:["Hp l (",g.thongKe.tyLeHopLe,"%)"]})]}),t.jsxs(st,{className:"p-4 text-center bg-red-50",children:[t.jsx("p",{className:"text-2xl font-bold text-red-600",children:g.thongKe.ngoaiVung}),t.jsx("p",{className:"text-sm text-red-600",children:"Ngoi vng"})]}),t.jsxs(st,{className:"p-4 text-center bg-yellow-50",children:[t.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:g.thongKe.canhBao}),t.jsx("p",{className:"text-sm text-yellow-600",children:"Cnh bo"})]}),t.jsxs(st,{className:"p-4 text-center bg-gray-50",children:[t.jsx("p",{className:"text-2xl font-bold text-gray-600",children:g.thongKe.khongGPS}),t.jsx("p",{className:"text-sm text-gray-600",children:"Khng GPS"})]})]}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"T ngy"}),t.jsx("input",{type:"date",value:o,onChange:C=>{d(C.target.value),f(1)},className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"n ngy"}),t.jsx("input",{type:"date",value:u,onChange:C=>{x(C.target.value),f(1)},className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phng ban"}),t.jsxs("select",{value:a||"",onChange:C=>{r(C.target.value?Number(C.target.value):void 0),n(void 0),f(1)},className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Tt c"}),b==null?void 0:b.map(C=>t.jsx("option",{value:C.id,children:C.tenPhongBan},C.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Nhn vin"}),t.jsxs("select",{value:e||"",onChange:C=>{n(C.target.value?Number(C.target.value):void 0),f(1)},className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Tt c"}),_.map(C=>t.jsxs("option",{value:C.id,children:[C.hoTen," (",C.maNhanVien,")"]},C.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Trng thi"}),t.jsxs("select",{value:s||"",onChange:C=>{l(C.target.value||void 0),f(1)},className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"HOP_LE",children:"Hp l"}),t.jsx("option",{value:"NGOAI_VUNG",children:"Ngoi vng"}),t.jsx("option",{value:"CANH_BAO",children:"Cnh bo"}),t.jsx("option",{value:"KHONG_CO_GPS",children:"Khng GPS"})]})]})]})}),t.jsx(st,{children:y?t.jsx("div",{className:"p-8 text-center text-[var(--text-muted)]",children:"ang ti..."}):(E=N==null?void 0:N.data)!=null&&E.length?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-[var(--bg-secondary)] border-b",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Thi gian"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Loi"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Ta "}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Geofence"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Khong cch"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Trng thi"})]})}),t.jsx("tbody",{className:"divide-y",children:N.data.map(C=>t.jsxs("tr",{className:"hover:bg-[var(--bg-secondary)]/50",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(an,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{className:"text-sm",children:w(C.thoiGian)})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("span",{className:"font-medium",children:["NV #",C.nhanVienId]})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx(Et,{variant:C.loaiChamCong==="CHECK_IN"?"success":"info",children:C.loaiChamCong==="CHECK_IN"?"Vo":"Ra"})}),t.jsxs("td",{className:"px-4 py-3",children:[C.viDo&&C.kinhDo?t.jsxs("a",{href:`https://maps.google.com/?q=${C.viDo},${C.kinhDo}`,target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:underline text-sm",children:[t.jsx(Xd,{className:"w-3 h-3 inline mr-1"}),C.viDo.toFixed(5),", ",C.kinhDo.toFixed(5)]}):t.jsx("span",{className:"text-gray-400 text-sm",children:"Khng c"}),C.doChinhXacMet&&t.jsxs("span",{className:"text-xs text-gray-400 ml-2",children:["(",C.doChinhXacMet,"m)"]})]}),t.jsx("td",{className:"px-4 py-3",children:C.geofence?t.jsx("span",{className:"text-sm",children:C.geofence.tenDiaDiem}):t.jsx("span",{className:"text-gray-400 text-sm",children:""})}),t.jsx("td",{className:"px-4 py-3 text-center",children:C.khoangCachMet!==void 0&&C.khoangCachMet!==null?t.jsxs("span",{className:`font-medium ${C.trongVung?"text-green-600":"text-red-600"}`,children:[C.khoangCachMet,"m"]}):t.jsx("span",{className:"text-gray-400",children:""})}),t.jsxs("td",{className:"px-4 py-3 text-center",children:[t.jsxs("div",{className:"flex items-center justify-center gap-1",children:[T(C.trangThai),S(C.trangThai)]}),C.ghiChu&&t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:C.ghiChu})]})]},C.id))})]})}),t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t",children:[t.jsxs("p",{className:"text-sm text-[var(--text-muted)]",children:["Hin th ",(m-1)*p+1,"-",Math.min(m*p,N.total)," /"," ",N.total," bn ghi"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ft,{variant:"outline",size:"sm",onClick:()=>f(C=>Math.max(1,C-1)),disabled:m===1,children:t.jsx(Nr,{className:"w-4 h-4"})}),t.jsxs("span",{className:"px-3 py-1 bg-[var(--bg-secondary)] rounded",children:[m," / ",N.totalPages||1]}),t.jsx(ft,{variant:"outline",size:"sm",onClick:()=>f(C=>C+1),disabled:m>=(N.totalPages||1),children:t.jsx(qn,{className:"w-4 h-4"})})]})]})]}):t.jsxs("div",{className:"p-8 text-center text-[var(--text-muted)]",children:[t.jsx(wc,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Khng c d liu GPS trong khong thi gian ny"})]})})]})}const Kf=e=>e?new Date(e).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-";function JV(){var _,E,C,P,F,R,O,M,q,J;const e=Mt(),[n,a]=D.useState(""),[r,s]=D.useState(""),[l,o]=D.useState(1),[d,u]=D.useState({open:!1}),[x,m]=D.useState(""),[f,p]=D.useState({open:!1}),{data:N,isLoading:y}=Le({queryKey:["devices",{search:n,trangThai:r,page:l}],queryFn:()=>fr.layDanhSachThietBi({search:n,trangThai:r,page:l,limit:20})}),{data:g}=Le({queryKey:["device-history",f.nhanVienId],queryFn:()=>f.nhanVienId?fr.layLichSuThietBi({nhanVienId:f.nhanVienId,limit:50}):null,enabled:f.open&&!!f.nhanVienId}),b=De({mutationFn:B=>fr.resetDevice(B),onSuccess:()=>{alert(" reset thit b thnh cng"),e.invalidateQueries({queryKey:["devices"]}),u({open:!1}),m("")},onError:B=>{alert(B.message||"C li xy ra")}}),j=De({mutationFn:({nhanVienId:B,lyDo:ue})=>fr.blockDevice(B,ue),onSuccess:()=>{alert(" kha thit b"),e.invalidateQueries({queryKey:["devices"]})},onError:B=>{alert(B.message||"C li xy ra")}}),T=()=>{if(!d.device||!x.trim()){alert("Vui lng nhp l do reset");return}b.mutate({nhanVienId:d.device.nhanVienId,lyDo:x})},S=B=>{switch(B){case"ACTIVE":return{label:"Hot ng",variant:"success",icon:cj};case"BLOCKED":return{label:" kha",variant:"danger",icon:ti};case"PENDING_RESET":return{label:"Ch reset",variant:"warning",icon:an};default:return{label:B,variant:"neutral",icon:sa}}},w=B=>{if(!B)return t.jsx(cb,{className:"h-4 w-4"});const ue=B.toLowerCase();return ue.includes("ios")||ue.includes("iphone")?t.jsx(c0,{className:"h-4 w-4"}):ue.includes("android")?t.jsx(c0,{className:"h-4 w-4"}):t.jsx(cb,{className:"h-4 w-4"})};return t.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold",children:"Qun l thit b"}),t.jsx("p",{className:"text-gray-500",children:"Sprint 8: Device Binding - Mi nhn vin ch c ng nhp t 1 thit b"})]})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Tng thit b"})}),t.jsx(Vt,{children:t.jsx("div",{className:"text-2xl font-bold",children:(N==null?void 0:N.total)||0})})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Hot ng"})}),t.jsx(Vt,{children:t.jsx("div",{className:"text-2xl font-bold text-green-600",children:((_=N==null?void 0:N.data)==null?void 0:_.filter(B=>B.trangThai==="ACTIVE").length)||0})})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Ch reset"})}),t.jsx(Vt,{children:t.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:((E=N==null?void 0:N.data)==null?void 0:E.filter(B=>B.trangThai==="PENDING_RESET").length)||0})})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("span",{className:"text-sm font-medium text-gray-500",children:" kha"})}),t.jsx(Vt,{children:t.jsx("div",{className:"text-2xl font-bold text-red-600",children:((C=N==null?void 0:N.data)==null?void 0:C.filter(B=>B.trangThai==="BLOCKED").length)||0})})]})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Danh sch thit b"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Qun l thit b  ng k ca nhn vin"})]})})}),t.jsxs(Vt,{children:[t.jsxs("div",{className:"flex gap-4 mb-4",children:[t.jsx("div",{className:"flex-1",children:t.jsx(hg,{placeholder:"Tm theo tn, m nhn vin...",value:n,onChange:B=>a(B.target.value)})}),t.jsxs("select",{className:"px-3 py-2 border rounded-lg bg-white",value:r,onChange:B=>s(B.target.value),children:[t.jsx("option",{value:"",children:"Tt c trng thi"}),t.jsx("option",{value:"ACTIVE",children:"Hot ng"}),t.jsx("option",{value:"PENDING_RESET",children:"Ch reset"}),t.jsx("option",{value:"BLOCKED",children:" kha"})]})]}),t.jsxs(Qj,{children:[t.jsx(Yj,{children:t.jsxs(Ad,{children:[t.jsx(Il,{children:"Nhn vin"}),t.jsx(Il,{children:"Thit b"}),t.jsx(Il,{children:"Trng thi"}),t.jsx(Il,{children:"Ngy ng k"}),t.jsx(Il,{children:"ng nhp cui"}),t.jsx(Il,{align:"right",children:"Thao tc"})]})}),t.jsx(Jj,{children:y?t.jsx(Ad,{children:t.jsx(qs,{colSpan:6,className:"text-center py-8",children:"ang ti..."})}):((P=N==null?void 0:N.data)==null?void 0:P.length)===0?t.jsx(Ad,{children:t.jsx(qs,{colSpan:6,className:"text-center py-8 text-gray-500",children:"Cha c thit b no c ng k"})}):(F=N==null?void 0:N.data)==null?void 0:F.map(B=>{var Z,Q,fe;const ue=S(B.trangThai),te=ue.icon;return t.jsxs(Ad,{children:[t.jsx(qs,{children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:((Z=B.nhanVien)==null?void 0:Z.hoTen)||"N/A"}),t.jsx("div",{className:"text-sm text-gray-500",children:(Q=B.nhanVien)==null?void 0:Q.maNhanVien})]})}),t.jsx(qs,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[w(B.platform),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:B.tenThietBi||"Khng xc nh"}),t.jsxs("div",{className:"text-xs text-gray-500 truncate max-w-[200px]",children:[(fe=B.deviceId)==null?void 0:fe.substring(0,20),"..."]})]})]})}),t.jsx(qs,{children:t.jsxs(Et,{variant:ue.variant,children:[t.jsx(te,{className:"h-3 w-3 mr-1"}),ue.label]})}),t.jsx(qs,{children:Kf(B.ngayDangKy)}),t.jsx(qs,{children:Kf(B.lanDangNhapCuoi)}),t.jsx(qs,{align:"right",children:t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(ft,{variant:"ghost",size:"sm",title:"Xem lch s",onClick:()=>p({open:!0,nhanVienId:B.nhanVienId}),children:t.jsx(gu,{className:"h-4 w-4"})}),B.trangThai!=="PENDING_RESET"&&t.jsx(ft,{variant:"ghost",size:"sm",title:"Reset thit b",onClick:()=>u({open:!0,device:B}),children:t.jsx(yr,{className:"h-4 w-4"})}),B.trangThai==="ACTIVE"&&t.jsx(ft,{variant:"ghost",size:"sm",title:"Kha thit b",onClick:()=>{confirm("Bn c chc mun kha thit b ny?")&&j.mutate({nhanVienId:B.nhanVienId,lyDo:"Kha th cng bi HR"})},children:t.jsx(ti,{className:"h-4 w-4"})})]})})]},B.id)})})]}),N&&N.totalPages>1&&t.jsxs("div",{className:"flex justify-center gap-2 mt-4",children:[t.jsx(ft,{variant:"outline",size:"sm",disabled:l===1,onClick:()=>o(B=>B-1),children:"Trc"}),t.jsxs("span",{className:"flex items-center px-4 text-sm",children:["Trang ",l," / ",N.totalPages]}),t.jsx(ft,{variant:"outline",size:"sm",disabled:l===N.totalPages,onClick:()=>o(B=>B+1),children:"Sau"})]})]})]}),t.jsxs(ns,{isOpen:d.open,onClose:()=>u({open:!1}),children:[t.jsx(Ss,{title:"Reset thit b"}),t.jsx(_s,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg",children:[t.jsx("div",{className:"font-medium",children:(O=(R=d.device)==null?void 0:R.nhanVien)==null?void 0:O.hoTen}),t.jsxs("div",{className:"text-sm text-gray-500",children:["Thit b hin ti: ",((M=d.device)==null?void 0:M.tenThietBi)||"Khng xc nh"]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"L do reset *"}),t.jsx(sx,{placeholder:"Nhp l do reset thit b...",value:x,onChange:B=>m(B.target.value),rows:3})]}),t.jsx("p",{className:"text-sm text-gray-500",children:"Reset s cho php nhn vin ng nhp t thit b mi"})]})}),t.jsxs(ni,{children:[t.jsx(ft,{variant:"outline",onClick:()=>u({open:!1}),children:"Hy"}),t.jsx(ft,{onClick:T,disabled:b.isPending,children:b.isPending?"ang x l...":"Xc nhn reset"})]})]}),t.jsxs(ns,{isOpen:f.open,onClose:()=>p({open:!1}),size:"lg",children:[t.jsx(Ss,{title:"Lch s thit b"}),t.jsx(_s,{className:"max-h-[60vh] overflow-y-auto",children:t.jsx("div",{className:"space-y-4",children:((q=g==null?void 0:g.data)==null?void 0:q.length)===0?t.jsx("p",{className:"text-center text-gray-500 py-8",children:"Cha c lch s"}):(J=g==null?void 0:g.data)==null?void 0:J.map(B=>t.jsxs("div",{className:"flex items-start gap-4 p-4 border rounded-lg",children:[t.jsxs("div",{className:`p-2 rounded-full ${B.hanhDong==="BIND"?"bg-green-100 text-green-600":B.hanhDong==="RESET"?"bg-yellow-100 text-yellow-600":B.hanhDong==="BLOCK"?"bg-red-100 text-red-600":"bg-gray-100"}`,children:[B.hanhDong==="BIND"&&t.jsx(c0,{className:"h-4 w-4"}),B.hanhDong==="RESET"&&t.jsx(yr,{className:"h-4 w-4"}),B.hanhDong==="BLOCK"&&t.jsx(ti,{className:"h-4 w-4"}),B.hanhDong==="LOGIN_BLOCKED"&&t.jsx(sa,{className:"h-4 w-4"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"font-medium",children:[B.hanhDong==="BIND"&&"ng k thit b mi",B.hanhDong==="RESET"&&"Reset thit b",B.hanhDong==="BLOCK"&&"Kha thit b",B.hanhDong==="LOGIN_BLOCKED"&&"Chn ng nhp t thit b l"]}),B.lyDo&&t.jsxs("div",{className:"text-sm text-gray-500",children:["L do: ",B.lyDo]}),B.nguoiThucHien&&t.jsxs("div",{className:"text-sm text-gray-500",children:["Thc hin bi: ",B.nguoiThucHien.hoTen]}),t.jsx("div",{className:"text-xs text-gray-400 mt-1",children:Kf(B.ngayTao)})]})]},B.id))})})]})]})}const ZV=async e=>(await he.get("/timesheet",{params:e})).data,eU=async e=>(await he.get("/timesheet/yeu-cau-sua-cong",{params:e})).data,tU=async e=>(await he.post("/timesheet/yeu-cau-sua-cong",e)).data,nU=async(e,n)=>(await he.post(`/timesheet/yeu-cau-sua-cong/${e}/duyet`,n)).data,aU=async e=>(await he.put("/timesheet/sua-cong-truc-tiep",e)).data,tl=e=>e?new Date(e).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}):"-",zf=e=>({DI_LAM:{label:"i lm",color:"success"},NGHI_PHEP:{label:"Ngh php",color:"info"},NGHI_KHONG_LUONG:{label:"Ngh KL",color:"warning"},NGHI_BENH:{label:"Ngh bnh",color:"warning"},NGHI_LE:{label:"Ngh l",color:"info"},CHUA_XAC_DINH:{label:"-",color:"neutral"},VANG_MAT:{label:"Vng",color:"danger"}})[e]||{label:e,color:"neutral"},y2=(e,n)=>e==="NGAY_LE"?"bg-red-100":n===0?"bg-red-50":n===6?"bg-yellow-50":"",rU=(e,n)=>new Date(n,e,0).getDate(),sU=e=>["CN","T2","T3","T4","T5","T6","T7"][e];function iU(){var ue,te;const e=Mt(),n=new Date,[a,r]=D.useState(n.getMonth()+1),[s,l]=D.useState(n.getFullYear()),[o,d]=D.useState(""),[u]=D.useState(),[x,m]=D.useState(null),[f,p]=D.useState(null),[N,y]=D.useState("view"),[g,b]=D.useState({gioVaoMoi:"",gioRaMoi:"",trangThaiMoi:"",lyDo:""}),[j,T]=D.useState(!1),{data:S,isLoading:w}=Le({queryKey:["bang-cong",{thang:a,nam:s,search:o,phongBanId:u}],queryFn:()=>ZV({thang:a,nam:s,search:o,phongBanId:u})}),{data:_}=Le({queryKey:["yeu-cau-sua-cong",{thang:a,nam:s,trangThaiDuyet:"CHO_DUYET"}],queryFn:()=>{const Z=new Date(s,a-1,1).toISOString().slice(0,10),Q=new Date(s,a,0).toISOString().slice(0,10);return eU({trangThaiDuyet:"CHO_DUYET",tuNgay:Z,denNgay:Q})}}),E=De({mutationFn:tU,onSuccess:()=>{alert(" to yu cu sa cng"),e.invalidateQueries({queryKey:["bang-cong"]}),e.invalidateQueries({queryKey:["yeu-cau-sua-cong"]}),q()},onError:Z=>{alert(Z.message||"C li xy ra")}}),C=De({mutationFn:aU,onSuccess:()=>{alert(" cp nht chm cng"),e.invalidateQueries({queryKey:["bang-cong"]}),q()},onError:Z=>{alert(Z.message||"C li xy ra")}}),P=De({mutationFn:({id:Z,payload:Q})=>nU(Z,Q),onSuccess:()=>{alert(" x l yu cu"),e.invalidateQueries({queryKey:["bang-cong"]}),e.invalidateQueries({queryKey:["yeu-cau-sua-cong"]})},onError:Z=>{alert(Z.message||"C li xy ra")}}),F=D.useMemo(()=>rU(a,s),[a,s]),R=()=>{a===1?(r(12),l(s-1)):r(a-1)},O=()=>{a===12?(r(1),l(s+1)):r(a+1)},M=(Z,Q,fe)=>{m(Z),p(Q),y(fe),b({gioVaoMoi:Q.gioVao?new Date(Q.gioVao).toTimeString().slice(0,5):"",gioRaMoi:Q.gioRa?new Date(Q.gioRa).toTimeString().slice(0,5):"",trangThaiMoi:Q.trangThai,lyDo:""})},q=()=>{m(null),p(null),y("view"),b({gioVaoMoi:"",gioRaMoi:"",trangThaiMoi:"",lyDo:""})},J=()=>{if(!(!x||!f))if(N==="request"){if(!g.lyDo.trim()){alert("Vui lng nhp l do");return}E.mutate({nhanVienId:x.nhanVienId,ngayChamCong:f.ngay,gioVaoMoi:g.gioVaoMoi?`${f.ngay}T${g.gioVaoMoi}:00`:void 0,gioRaMoi:g.gioRaMoi?`${f.ngay}T${g.gioRaMoi}:00`:void 0,trangThaiMoi:g.trangThaiMoi!==f.trangThai?g.trangThaiMoi:void 0,lyDo:g.lyDo})}else C.mutate({nhanVienId:x.nhanVienId,ngayChamCong:f.ngay,gioVao:g.gioVaoMoi?`${f.ngay}T${g.gioVaoMoi}:00`:void 0,gioRa:g.gioRaMoi?`${f.ngay}T${g.gioRaMoi}:00`:void 0,trangThai:g.trangThaiMoi,ghiChu:g.lyDo})},B=S==null?void 0:S.thongKe;return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[t.jsx(Lt,{className:"h-6 w-6"}),"Bng Cng Thng ",a,"/",s]}),t.jsx("p",{className:"text-gray-500",children:"Theo di chm cng v sa cng nhn vin"})]}),t.jsx("div",{className:"flex gap-2",children:t.jsxs(ft,{variant:"outline",onClick:()=>T(!0),children:[t.jsx(ma,{className:"h-4 w-4 mr-2"}),"Duyt sa cng (",((ue=_==null?void 0:_.data)==null?void 0:ue.length)||0,")"]})})]}),B&&t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[t.jsx(st,{children:t.jsx(Vt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(on,{className:"h-5 w-5 text-blue-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Nhn vin"}),t.jsx("p",{className:"text-xl font-bold",children:B.tongNhanVien})]})]})})}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Br,{className:"h-5 w-5 text-green-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Ngy cng"}),t.jsx("p",{className:"text-xl font-bold",children:B.tongNgayCong})]})]})})}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(X_,{className:"h-5 w-5 text-purple-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Gi OT"}),t.jsx("p",{className:"text-xl font-bold",children:B.tongGioOT.toFixed(1)})]})]})})}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(sa,{className:"h-5 w-5 text-orange-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"i tr"}),t.jsx("p",{className:"text-xl font-bold",children:B.tongLanDiTre})]})]})})}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(mn,{className:"h-5 w-5 text-red-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Ngh"}),t.jsx("p",{className:"text-xl font-bold",children:B.tongNgayNghi})]})]})})}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(an,{className:"h-5 w-5 text-cyan-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Ch duyt"}),t.jsx("p",{className:"text-xl font-bold",children:B.yeuCauSuaCong.choDuyet})]})]})})})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ft,{variant:"outline",size:"sm",onClick:R,children:t.jsx(Nr,{className:"h-4 w-4"})}),t.jsxs("span",{className:"font-medium text-lg min-w-[120px] text-center",children:["Thng ",a,"/",s]}),t.jsx(ft,{variant:"outline",size:"sm",onClick:O,children:t.jsx(qn,{className:"h-4 w-4"})})]}),t.jsx(hg,{placeholder:"Tm nhn vin...",value:o,onChange:Z=>d(Z.target.value),className:"w-64"})]})}),t.jsxs(Vt,{children:[w?t.jsx("div",{className:"text-center py-8",children:"ang ti..."}):(te=S==null?void 0:S.data)!=null&&te.length?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full border-collapse text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-50",children:[t.jsx("th",{className:"border px-3 py-2 text-left sticky left-0 bg-gray-50 z-10 min-w-[150px]",children:"Nhn vin"}),Array.from({length:F},(Z,Q)=>{const K=new Date(s,a-1,Q+1).getDay();return t.jsxs("th",{className:`border px-1 py-1 text-center min-w-[50px] ${y2("",K)}`,children:[t.jsx("div",{className:"text-xs",children:sU(K)}),t.jsx("div",{children:Q+1})]},Q)}),t.jsx("th",{className:"border px-2 py-2 text-center min-w-[60px] bg-gray-100",children:"Cng"}),t.jsx("th",{className:"border px-2 py-2 text-center min-w-[60px] bg-gray-100",children:"OT"})]})}),t.jsx("tbody",{children:S.data.map(Z=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsxs("td",{className:"border px-3 py-2 sticky left-0 bg-white z-10",children:[t.jsx("div",{className:"font-medium",children:Z.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:Z.maNhanVien})]}),Z.chiTiet.map(Q=>{const{label:fe,color:K}=zf(Q.trangThai);return t.jsxs("td",{className:`border px-1 py-1 text-center cursor-pointer hover:bg-blue-50 ${y2(Q.loaiNgay,Q.thuTrongTuan)}`,onClick:()=>M(Z,Q,"view"),children:[t.jsx("div",{className:"text-xs",children:Q.trangThai==="DI_LAM"?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-green-600",children:tl(Q.gioVao)}),t.jsx("div",{className:"text-blue-600",children:tl(Q.gioRa)})]}):t.jsx(Et,{variant:K,className:"text-[10px] px-1",children:fe})}),Q.coYeuCauSuaCong&&t.jsx(sf,{className:"h-3 w-3 text-orange-500 mx-auto"})]},Q.ngay)}),t.jsx("td",{className:"border px-2 py-2 text-center font-medium bg-gray-50",children:Z.tongKet.soNgayDiLam}),t.jsx("td",{className:"border px-2 py-2 text-center font-medium bg-gray-50",children:Z.tongKet.soGioOT.toFixed(1)})]},Z.nhanVienId))})]})}):t.jsx("div",{className:"text-center py-8 text-gray-500",children:"Khng c d liu"}),t.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-sm",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"w-3 h-3 bg-red-50 border"})," Ch nht"]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"w-3 h-3 bg-yellow-50 border"})," Th 7"]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"w-3 h-3 bg-red-100 border"})," Ngy l"]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(sf,{className:"h-3 w-3 text-orange-500"})," C yu cu sa"]})]})]})]}),t.jsxs(ns,{isOpen:!!f,onClose:q,children:[t.jsx(Ss,{title:N==="view"?"Chi tit chm cng":N==="edit"?"Sa cng trc tip":"Yu cu sa cng"}),t.jsx(_s,{children:f&&x&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Nhn vin:"}),t.jsx("span",{className:"ml-2 font-medium",children:x.hoTen})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Ngy:"}),t.jsx("span",{className:"ml-2 font-medium",children:f.ngay})]})]}),N==="view"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm border rounded p-3",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Gi vo:"}),t.jsx("span",{className:"ml-2",children:tl(f.gioVao)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Gi ra:"}),t.jsx("span",{className:"ml-2",children:tl(f.gioRa)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Trng thi:"}),t.jsx(Et,{variant:zf(f.trangThai).color,className:"ml-2",children:zf(f.trangThai).label})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Gi lm:"}),t.jsxs("span",{className:"ml-2",children:[f.soGioLam.toFixed(1),"h"]})]}),f.phutDiTre&&f.phutDiTre>0&&t.jsxs("div",{className:"text-orange-600",children:["i tr: ",f.phutDiTre," pht"]}),f.phutVeSom&&f.phutVeSom>0&&t.jsxs("div",{className:"text-orange-600",children:["V sm: ",f.phutVeSom," pht"]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(ft,{variant:"outline",onClick:()=>y("edit"),children:[t.jsx(sf,{className:"h-4 w-4 mr-2"}),"Sa trc tip"]}),t.jsxs(ft,{variant:"outline",onClick:()=>y("request"),children:[t.jsx(ma,{className:"h-4 w-4 mr-2"}),"To yu cu sa"]})]})]}):t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gi vo mi"}),t.jsx("input",{type:"time",className:"w-full border rounded px-3 py-2",value:g.gioVaoMoi,onChange:Z=>b({...g,gioVaoMoi:Z.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gi ra mi"}),t.jsx("input",{type:"time",className:"w-full border rounded px-3 py-2",value:g.gioRaMoi,onChange:Z=>b({...g,gioRaMoi:Z.target.value})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Trng thi"}),t.jsxs("select",{className:"w-full border rounded px-3 py-2",value:g.trangThaiMoi,onChange:Z=>b({...g,trangThaiMoi:Z.target.value}),children:[t.jsx("option",{value:"DI_LAM",children:"i lm"}),t.jsx("option",{value:"NGHI_PHEP",children:"Ngh php"}),t.jsx("option",{value:"NGHI_KHONG_LUONG",children:"Ngh khng lng"}),t.jsx("option",{value:"NGHI_BENH",children:"Ngh bnh"}),t.jsx("option",{value:"VANG_MAT",children:"Vng mt"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:N==="request"?"L do sa (bt buc)":"Ghi ch"}),t.jsx(sx,{placeholder:N==="request"?"Nhp l do yu cu sa cng...":"Ghi ch...",value:g.lyDo,onChange:Z=>b({...g,lyDo:Z.target.value}),rows:3})]})]})]})}),t.jsxs(ni,{children:[t.jsx(ft,{variant:"outline",onClick:q,children:"ng"}),N!=="view"&&t.jsx(ft,{onClick:J,disabled:E.isPending||C.isPending,children:E.isPending||C.isPending?"ang x l...":"Lu"})]})]}),t.jsx(lU,{open:j,onClose:()=>T(!1),yeuCauList:(_==null?void 0:_.data)||[],onDuyet:(Z,Q,fe)=>{P.mutate({id:Z,payload:{trangThaiDuyet:Q?"DA_DUYET":"TU_CHOI",lyDoTuChoi:fe}})},isLoading:P.isPending})]})}function lU({open:e,onClose:n,yeuCauList:a,onDuyet:r,isLoading:s}){const[l,o]=D.useState({});return t.jsxs(ns,{isOpen:e,onClose:n,size:"xl",children:[t.jsx(Ss,{title:"Duyt yu cu sa cng"}),t.jsx(_s,{children:a.length===0?t.jsx("div",{className:"text-center py-8 text-gray-500",children:"Khng c yu cu no ang ch duyt"}):t.jsx("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto",children:a.map(d=>{var u,x,m;return t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"font-medium",children:[(u=d.nhanVien)==null?void 0:u.hoTen," - ",(x=d.nhanVien)==null?void 0:x.maNhanVien]}),t.jsxs("div",{className:"text-sm text-gray-500",children:["Ngy: ",new Date(d.ngayChamCong).toLocaleDateString("vi-VN")]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Thay i:"}),d.gioVaoMoi&&t.jsxs("span",{className:"ml-2",children:["Gi vo: ",tl(d.gioVaoCu),"  ",tl(d.gioVaoMoi)]}),d.gioRaMoi&&t.jsxs("span",{className:"ml-2",children:["Gi ra: ",tl(d.gioRaCu),"  ",tl(d.gioRaMoi)]}),d.trangThaiMoi&&t.jsxs("span",{className:"ml-2",children:["Trng thi: ",d.trangThaiCu,"  ",d.trangThaiMoi]})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"L do:"}),t.jsx("span",{className:"ml-2",children:d.lyDo})]}),t.jsxs("div",{className:"text-xs text-gray-400",children:["Ngi to: ",(m=d.nguoiTao)==null?void 0:m.hoTen," - ",new Date(d.ngayTao).toLocaleString("vi-VN")]}),t.jsx(sx,{placeholder:"L do t chi (nu t chi)",value:l[d.id]||"",onChange:f=>o({...l,[d.id]:f.target.value}),rows:2,className:"mt-2"})]}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsxs(ft,{variant:"primary",size:"sm",onClick:()=>r(d.id,!0),disabled:s,children:[t.jsx(Br,{className:"h-4 w-4 mr-1"}),"Duyt"]}),t.jsxs(ft,{variant:"danger",size:"sm",onClick:()=>r(d.id,!1,l[d.id]),disabled:s,children:[t.jsx(mn,{className:"h-4 w-4 mr-1"}),"T chi"]})]})]})},d.id)})})}),t.jsx(ni,{children:t.jsx(ft,{variant:"outline",onClick:n,children:"ng"})})]})}const oU="tinh_luong_auth",rc=Zt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});rc.interceptors.request.use(e=>{const n=localStorage.getItem(oU);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e});const $f={sync:e=>rc.post("/payroll-sync/sync",e).then(n=>n.data),getProgress:e=>rc.get(`/payroll-sync/progress/${e}`).then(n=>n.data),getStatus:(e,n)=>rc.get("/payroll-sync/status",{params:{thang:e,nam:n}}).then(a=>a.data),getRuleTrace:e=>rc.get("/payroll-sync/rule-trace",{params:e}).then(n=>n.data),getRuleTraceByEmployee:(e,n,a)=>rc.get(`/payroll-sync/rule-trace/nhan-vien/${e}`,{params:{thang:n,nam:a}}).then(r=>r.data)},cU={CHAM_CONG:{label:"Chm cng",color:"bg-blue-100 text-blue-700",icon:an},YEU_CAU:{label:"n yu cu",color:"bg-purple-100 text-purple-700",icon:ma},NGHI_PHEP:{label:"Ngh php",color:"bg-green-100 text-green-700",icon:Lt},PHAN_CA:{label:"Phn ca",color:"bg-yellow-100 text-yellow-700",icon:on},GPS:{label:"GPS",color:"bg-orange-100 text-orange-700",icon:Id},KPI:{label:"KPI",color:"bg-pink-100 text-pink-700",icon:ij},MANUAL:{label:"Th cng",color:"bg-gray-100 text-gray-700",icon:ma},RULE_ENGINE:{label:"Rule Engine",color:"bg-indigo-100 text-indigo-700",icon:Id}};function dU(){var S,w;const e=Mt(),[n,a]=D.useState(new Date().getMonth()+1),[r,s]=D.useState(new Date().getFullYear()),[l,o]=D.useState(),[d,u]=D.useState(new Set),[x,m]=D.useState(null),{data:f}=Le({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),{data:p,isLoading:N}=Le({queryKey:["pipeline-status",n,r],queryFn:()=>$f.getStatus(n,r)}),{data:y,isLoading:g}=Le({queryKey:["rule-trace",n,r,l],queryFn:()=>$f.getRuleTrace({thang:n,nam:r,phongBanId:l})}),b=De({mutationFn:_=>$f.sync({bangLuongId:_}),onMutate:_=>{m(_)},onSuccess:_=>{var E;e.invalidateQueries({queryKey:["pipeline-status"]}),e.invalidateQueries({queryKey:["rule-trace"]}),e.invalidateQueries({queryKey:["bang-luong"]}),_.currentStep==="HOAN_THANH"?ie.success(`ng b hon thnh: ${((E=_.summary)==null?void 0:E.tongThayDoi)||0} thay i`):_.currentStep==="LOI"&&ie.error(`ng b tht bi: ${_.errors[0]||"C li xy ra"}`)},onError:_=>{ie.error(`Li ng b: ${_.message}`)},onSettled:()=>{m(null)}}),j=_=>{const E=new Set(d);E.has(_)?E.delete(_):E.add(_),u(E)},T=_=>{const C={CHUA_TAO:{color:"gray",label:"Cha to"},NHAP:{color:"yellow",label:"Nhp"},DA_TINH:{color:"blue",label:" tnh"},DA_KHOA:{color:"purple",label:" kha"},DA_DUYET:{color:"green",label:" duyt"}}[_]||{color:"gray",label:_};return t.jsx(Et,{variant:C.color,children:C.label})};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Pipeline ng B Lng"}),t.jsx("p",{className:"text-gray-500",children:"ng b d liu chm cng, ngh php, yu cu vo bng lng"})]})}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thng"}),t.jsx("select",{value:n,onChange:_=>a(Number(_.target.value)),className:"input",children:[...Array(12)].map((_,E)=>t.jsxs("option",{value:E+1,children:["Thng ",E+1]},E+1))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nm"}),t.jsx("select",{value:r,onChange:_=>s(Number(_.target.value)),className:"input",children:[2024,2025,2026].map(_=>t.jsx("option",{value:_,children:_},_))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:l||"",onChange:_=>o(_.target.value?Number(_.target.value):void 0),className:"input",children:[t.jsx("option",{value:"",children:"Tt c"}),f==null?void 0:f.map(_=>t.jsx("option",{value:_.id,children:_.tenPhongBan},_.id))]})]})]})}),t.jsxs(st,{children:[t.jsx("div",{className:"p-4 border-b border-gray-200",children:t.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(Id,{className:"w-5 h-5"}),"Trng thi Pipeline"]})}),N?t.jsx("div",{className:"p-8 text-center",children:t.jsx(Rn,{className:"w-8 h-8 animate-spin mx-auto text-blue-500"})}):t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[t.jsx("div",{className:"text-sm text-blue-600",children:"Tng nhn vin"}),t.jsx("div",{className:"text-2xl font-bold text-blue-700",children:(p==null?void 0:p.tongNhanVien)||0})]}),t.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[t.jsx("div",{className:"text-sm text-green-600",children:" sync hon thnh"}),t.jsx("div",{className:"text-2xl font-bold text-green-700",children:(p==null?void 0:p.tongDaSyncHoanThanh)||0})]}),t.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[t.jsx("div",{className:"text-sm text-yellow-600",children:"Cnh bo"}),t.jsx("div",{className:"text-2xl font-bold text-yellow-700",children:((S=p==null?void 0:p.warnings)==null?void 0:S.length)||0})]})]}),(p==null?void 0:p.warnings)&&p.warnings.length>0&&t.jsxs("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[t.jsxs("h3",{className:"font-medium text-yellow-800 flex items-center gap-2 mb-2",children:[t.jsx(di,{className:"w-4 h-4"}),"Cnh bo"]}),t.jsxs("ul",{className:"space-y-1",children:[p.warnings.slice(0,5).map((_,E)=>t.jsxs("li",{className:"text-sm text-yellow-700",children:[" ",_.moTa]},E)),p.warnings.length>5&&t.jsxs("li",{className:"text-sm text-yellow-600 italic",children:["... v ",p.warnings.length-5," cnh bo khc"]})]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Tng lng"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:(w=p==null?void 0:p.phongBans)==null?void 0:w.map(_=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 font-medium",children:_.tenPhongBan}),t.jsx("td",{className:"px-4 py-3 text-center",children:T(_.trangThai)}),t.jsx("td",{className:"px-4 py-3 text-right",children:_.tongNhanVien}),t.jsx("td",{className:"px-4 py-3 text-right",children:Ye(_.tongLuong)}),t.jsx("td",{className:"px-4 py-3 text-center",children:_.bangLuongId&&_.trangThai!=="DA_KHOA"&&_.trangThai!=="DA_DUYET"?t.jsxs(ft,{size:"sm",variant:"primary",onClick:()=>b.mutate(_.bangLuongId),disabled:x===_.bangLuongId,children:[x===_.bangLuongId?t.jsx(Rn,{className:"w-4 h-4 animate-spin"}):t.jsx(yr,{className:"w-4 h-4"}),t.jsx("span",{className:"ml-1",children:"Sync"})]}):_.trangThai==="CHUA_TAO"?t.jsx("span",{className:"text-sm text-gray-400",children:"Cha to BL"}):t.jsx("span",{className:"text-sm text-gray-400",children:" kha"})})]},_.phongBanId))})]})})]})]}),t.jsxs(st,{children:[t.jsxs("div",{className:"p-4 border-b border-gray-200",children:[t.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(Ra,{className:"w-5 h-5"}),"Rule Trace - Ngun D Liu"]}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Xem chi tit d liu c s dng  tnh lng t cc ngun khc nhau"})]}),g?t.jsx("div",{className:"p-8 text-center",children:t.jsx(Rn,{className:"w-8 h-8 animate-spin mx-auto text-blue-500"})}):y&&y.length>0?t.jsx("div",{className:"divide-y divide-gray-200",children:y.map(_=>{var E;return t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>j(_.ruleId*1e3+_.nhanVienId),children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center",children:t.jsx(Id,{className:"w-5 h-5 text-indigo-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:_.ruleName}),t.jsx("div",{className:"text-sm text-gray-500",children:_.hoTen})]})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-lg font-semibold text-green-600",children:Ye(_.ketQua)}),t.jsx("div",{className:"text-xs text-gray-400",children:new Date(_.ngayChay).toLocaleDateString("vi-VN")})]}),d.has(_.ruleId*1e3+_.nhanVienId)?t.jsx(Ol,{className:"w-5 h-5 text-gray-400"}):t.jsx(Ja,{className:"w-5 h-5 text-gray-400"})]})]}),d.has(_.ruleId*1e3+_.nhanVienId)&&t.jsxs("div",{className:"mt-4 pl-14 space-y-3",children:[t.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[t.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Chi tit tnh ton:"}),t.jsx("div",{className:"text-sm font-mono bg-white p-2 rounded border",children:_.chiTiet})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Ngun d liu:"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:(E=_.nguonDuLieu)==null?void 0:E.map((C,P)=>{const F=cU[C.type],R=F.icon;return t.jsxs("div",{className:`flex items-center gap-2 p-2 rounded-lg ${F.color}`,children:[t.jsx(R,{className:"w-4 h-4"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-sm font-medium",children:F.label}),t.jsxs("div",{className:"text-xs opacity-75",children:[C.sourceId," = ",String(C.value)]})]})]},P)})})]})]})]},`${_.ruleId}-${_.nhanVienId}`)})}):t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx(Id,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),t.jsxs("p",{children:["Cha c d liu rule trace cho thng ",n,"/",r]})]})]})]})}const Pl={getDiTreVeSom:e=>he.get("/reports/di-tre-ve-som",{params:e}),getOT:e=>he.get("/reports/ot",{params:e}),getNghiPhep:e=>he.get("/reports/nghi-phep",{params:e}),getQuyLuong:e=>he.get("/reports/quy-luong",{params:e}),getHeadcount:e=>he.get("/reports/headcount",{params:e}),getChamCong:e=>he.get("/reports/cham-cong",{params:e}),getDashboard:(e,n)=>he.get("/reports/dashboard",{params:{thang:e,nam:n}})},BT=new Date,uU=BT.getMonth()+1,hU=BT.getFullYear(),ys=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),xU=e=>new Date(e).toLocaleDateString("vi-VN");function mU(){var y,g,b,j,T,S,w;const[e,n]=D.useState("dashboard"),[a,r]=D.useState({thang:uU,nam:hU}),s=Le({queryKey:["reports","dashboard",a.thang,a.nam],queryFn:()=>Pl.getDashboard(a.thang,a.nam),enabled:e==="dashboard"}),l=Le({queryKey:["reports","di-tre",a],queryFn:()=>Pl.getDiTreVeSom(a),enabled:e==="di-tre"}),o=Le({queryKey:["reports","ot",a],queryFn:()=>Pl.getOT(a),enabled:e==="ot"}),d=Le({queryKey:["reports","nghi-phep",a],queryFn:()=>Pl.getNghiPhep(a),enabled:e==="nghi-phep"}),u=Le({queryKey:["reports","quy-luong",a],queryFn:()=>Pl.getQuyLuong(a),enabled:e==="quy-luong"}),x=Le({queryKey:["reports","headcount",a],queryFn:()=>Pl.getHeadcount(a),enabled:e==="headcount"}),m=Le({queryKey:["reports","cham-cong",a],queryFn:()=>Pl.getChamCong(a),enabled:e==="cham-cong"}),f=s.isLoading||l.isLoading||o.isLoading||d.isLoading||u.isLoading||x.isLoading||m.isLoading,p=()=>{switch(e){case"dashboard":s.refetch();break;case"di-tre":l.refetch();break;case"ot":o.refetch();break;case"nghi-phep":d.refetch();break;case"quy-luong":u.refetch();break;case"headcount":x.refetch();break;case"cham-cong":m.refetch();break}},N=[{key:"dashboard",label:"Dashboard"},{key:"di-tre",label:"i tr/V sm"},{key:"ot",label:"Tng ca (OT)"},{key:"nghi-phep",label:"Ngh php"},{key:"quy-luong",label:"Qu lng"},{key:"headcount",label:"Nhn s"},{key:"cham-cong",label:"Chm cng"}];return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Bo co & Thng k"}),t.jsx("p",{className:"text-slate-500",children:"Xem tng hp v chi tit cc bo co nhn s"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(ft,{variant:"outline",onClick:p,disabled:f,children:[t.jsx(yr,{className:`h-4 w-4 mr-2 ${f?"animate-spin":""}`}),"Lm mi"]}),t.jsxs(ft,{variant:"primary",children:[t.jsx(uj,{className:"h-4 w-4 mr-2"}),"Xut Excel"]})]})]}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-6",children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Thng"}),t.jsxs("div",{className:"relative",children:[t.jsx("select",{value:a.thang,onChange:_=>r({...a,thang:Number(_.target.value)}),className:"w-32 px-3 py-2 border border-slate-200 rounded-lg appearance-none focus:ring-2 focus:ring-blue-500 bg-white",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(_=>t.jsxs("option",{value:_,children:["Thng ",_]},_))}),t.jsx(Ja,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400 pointer-events-none"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Nm"}),t.jsxs("div",{className:"relative",children:[t.jsx("select",{value:a.nam,onChange:_=>r({...a,nam:Number(_.target.value)}),className:"w-28 px-3 py-2 border border-slate-200 rounded-lg appearance-none focus:ring-2 focus:ring-blue-500 bg-white",children:[2023,2024,2025,2026].map(_=>t.jsx("option",{value:_,children:_},_))}),t.jsx(Ja,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400 pointer-events-none"})]})]})]})})}),t.jsx("div",{className:"border-b border-slate-200",children:t.jsx("div",{className:"flex flex-wrap gap-1",children:N.map(_=>t.jsx("button",{onClick:()=>n(_.key),className:`px-4 py-3 text-sm font-medium transition-colors ${e===_.key?"text-blue-600 border-b-2 border-blue-600 -mb-[1px]":"text-slate-500 hover:text-slate-900"}`,children:_.label},_.key))})}),t.jsxs("div",{className:"mt-6",children:[e==="dashboard"&&t.jsx(fU,{data:(y=s.data)==null?void 0:y.data,isLoading:s.isLoading}),e==="di-tre"&&t.jsx(pU,{data:(g=l.data)==null?void 0:g.data,isLoading:l.isLoading}),e==="ot"&&t.jsx(gU,{data:(b=o.data)==null?void 0:b.data,isLoading:o.isLoading}),e==="nghi-phep"&&t.jsx(yU,{data:(j=d.data)==null?void 0:j.data,isLoading:d.isLoading}),e==="quy-luong"&&t.jsx(vU,{data:(T=u.data)==null?void 0:T.data,isLoading:u.isLoading}),e==="headcount"&&t.jsx(bU,{data:(S=x.data)==null?void 0:S.data,isLoading:x.isLoading}),e==="cham-cong"&&t.jsx(NU,{data:(w=m.data)==null?void 0:w.data,isLoading:m.isLoading})]})]})}function fU({data:e,isLoading:n}){return n?t.jsx(jo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:e.kpis.map((a,r)=>t.jsx(st,{children:t.jsxs(Vt,{className:"pt-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-slate-500",children:a.ten}),t.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[a.donVi==="VND"?ys(a.giaTri):a.giaTri.toLocaleString(),a.donVi!=="VND"&&t.jsx("span",{className:"text-sm ml-1",children:a.donVi})]})]}),t.jsxs("div",{className:`p-3 rounded-full bg-${a.mau}-100`,children:[a.icon==="users"&&t.jsx(on,{className:"h-6 w-6 text-blue-600"}),a.icon==="dollar"&&t.jsx(gr,{className:"h-6 w-6 text-green-600"}),a.icon==="clock"&&t.jsx(an,{className:"h-6 w-6 text-amber-600"}),a.icon==="calendar"&&t.jsx(Lt,{className:"h-6 w-6 text-purple-600"})]})]}),t.jsxs("div",{className:"mt-2 flex items-center text-sm",children:[a.soSanhThangTruoc>=0?t.jsx(oi,{className:"h-4 w-4 text-green-500 mr-1"}):t.jsx(xp,{className:"h-4 w-4 text-red-500 mr-1"}),t.jsxs("span",{className:a.soSanhThangTruoc>=0?"text-green-500":"text-red-500",children:[Math.abs(a.soSanhThangTruoc).toFixed(1),"%"]}),t.jsx("span",{className:"text-slate-500 ml-1",children:"so vi thng trc"})]})]})},r))}),e.alerts.length>0&&t.jsxs(st,{children:[t.jsx(zn,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(sa,{className:"h-5 w-5 text-amber-500"}),t.jsx("h3",{className:"font-semibold text-lg",children:"Cnh bo & Thng bo"})]})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-3",children:e.alerts.map((a,r)=>t.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg ${a.loai==="ERROR"?"bg-red-50 border border-red-200":a.loai==="WARNING"?"bg-amber-50 border border-amber-200":"bg-blue-50 border border-blue-200"}`,children:[a.loai==="ERROR"&&t.jsx(mo,{className:"h-5 w-5 text-red-500 mt-0.5"}),a.loai==="WARNING"&&t.jsx(sa,{className:"h-5 w-5 text-amber-500 mt-0.5"}),a.loai==="INFO"&&t.jsx(yu,{className:"h-5 w-5 text-blue-500 mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium",children:a.tieuDe}),t.jsx("p",{className:"text-sm text-slate-600",children:a.moTa})]}),t.jsx(Et,{variant:"neutral",children:a.soLuong})]},r))})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("h3",{className:"font-semibold",children:"Bin ng nhn s 6 thng"})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-4",children:e.bienDongNhanSu.map((a,r)=>{const s=Math.max(...e.bienDongNhanSu.map(l=>l.moiTuyen+l.nghiViec),1);return t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsxs("span",{children:["Thng ",a.thang]}),t.jsxs("span",{className:"text-green-600",children:["+",a.moiTuyen]}),t.jsxs("span",{className:"text-red-600",children:["-",a.nghiViec]})]}),t.jsxs("div",{className:"flex gap-1 h-2",children:[t.jsx("div",{className:"bg-green-500 rounded",style:{width:`${a.moiTuyen/s*100}%`}}),t.jsx("div",{className:"bg-red-500 rounded",style:{width:`${a.nghiViec/s*100}%`}})]})]},r)})})})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("h3",{className:"font-semibold",children:"Phn b qu lng theo phng ban"})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-3",children:e.phanBoLuongTheoPB.map((a,r)=>t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[t.jsx("span",{children:a.tenPhongBan}),t.jsxs("span",{className:"text-slate-600",children:[a.tyLe.toFixed(1),"%"]})]}),t.jsx("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full rounded-full",style:{width:`${a.tyLe}%`,backgroundColor:`hsl(${210+r*30}, 70%, 50%)`}})})]},r))})})]})]})]}):t.jsx(wo,{message:"Khng c d liu dashboard"})}function pU({data:e,isLoading:n}){return n?t.jsx(jo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsx(Wt,{title:"Nhn vin vi phm",value:e.summary.tongNhanVien,icon:t.jsx(on,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"Lt i tr",value:e.summary.tongLuotDiTre,icon:t.jsx(an,{className:"h-5 w-5"}),color:"red"}),t.jsx(Wt,{title:"Lt v sm",value:e.summary.tongLuotVeSom,icon:t.jsx(an,{className:"h-5 w-5"}),color:"amber"}),t.jsx(Wt,{title:"Tng pht tr",value:e.summary.tongPhutTre,unit:"pht",icon:t.jsx(an,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"Tng pht v sm",value:e.summary.tongPhutVeSom,unit:"pht",icon:t.jsx(an,{className:"h-5 w-5"})})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("h3",{className:"font-semibold",children:"Top nhn vin i tr nhiu nht"})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-3",children:e.summary.topDiTre.map((a,r)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-red-100 flex items-center justify-center text-red-600 font-bold",children:r+1}),t.jsx("span",{className:"font-medium",children:a.hoTen})]}),t.jsxs(Et,{variant:"danger",children:[a.soLan," ln"]})]},a.nhanVienId))})})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsxs("h3",{className:"font-semibold",children:["Chi tit (",e.chiTiet.length," bn ghi)"]})}),t.jsx(Vt,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-slate-200",children:[t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"M NV"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"H tn"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"Phng ban"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"Ngy"}),t.jsx("th",{className:"text-center p-3 font-medium text-slate-600",children:"Gi vo"}),t.jsx("th",{className:"text-center p-3 font-medium text-slate-600",children:"Gi ra"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Pht tr"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Pht v sm"})]})}),t.jsx("tbody",{children:e.chiTiet.slice(0,50).map((a,r)=>t.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[t.jsx("td",{className:"p-3",children:a.maNhanVien}),t.jsx("td",{className:"p-3",children:a.hoTen}),t.jsx("td",{className:"p-3",children:a.phongBan}),t.jsx("td",{className:"p-3",children:xU(a.ngay)}),t.jsx("td",{className:"text-center p-3",children:a.gioVao||"-"}),t.jsx("td",{className:"text-center p-3",children:a.gioRa||"-"}),t.jsx("td",{className:"text-right p-3",children:a.soPhutTre>0&&t.jsx("span",{className:"text-red-600 font-medium",children:a.soPhutTre})}),t.jsx("td",{className:"text-right p-3",children:a.soPhutVeSom>0&&t.jsx("span",{className:"text-amber-600 font-medium",children:a.soPhutVeSom})})]},r))})]})})})]})]}):t.jsx(wo,{message:"Khng c d liu i tr/v sm"})}function gU({data:e,isLoading:n}){return n?t.jsx(jo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsx(Wt,{title:"Nhn vin OT",value:e.summary.tongNhanVien,icon:t.jsx(on,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"Tng gi OT",value:e.summary.tongGioOT.toFixed(1),unit:"gi",icon:t.jsx(an,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Wt,{title:"Tng tin OT",value:ys(e.summary.tongTienOT),icon:t.jsx(gr,{className:"h-5 w-5"}),color:"green"}),t.jsx(Wt,{title:"TB gi OT/ngy",value:e.summary.trungBinhGioOTNgay.toFixed(2),unit:"gi",icon:t.jsx(an,{className:"h-5 w-5"})})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("h3",{className:"font-semibold",children:"Top phng ban OT nhiu nht"})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-3",children:e.summary.phongBanNhieuOTNhat.map((a,r)=>{const s=Math.max(...e.summary.phongBanNhieuOTNhat.map(l=>l.tongGio),1);return t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[t.jsx("span",{children:a.phongBan}),t.jsxs("span",{className:"font-medium",children:[a.tongGio.toFixed(1)," gi"]})]}),t.jsx("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${a.tongGio/s*100}%`}})})]},r)})})})]})]}):t.jsx(wo,{message:"Khng c d liu tng ca"})}function yU({data:e,isLoading:n}){return n?t.jsx(jo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsx(Wt,{title:"Tng n",value:e.summary.tongDon,icon:t.jsx(Lt,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"Tng ngy ngh",value:e.summary.tongNgayNghi,unit:"ngy",icon:t.jsx(Lt,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Wt,{title:" duyt",value:e.summary.daDuyet,icon:t.jsx(Lt,{className:"h-5 w-5"}),color:"green"}),t.jsx(Wt,{title:"Ch duyt",value:e.summary.choDuyet,icon:t.jsx(an,{className:"h-5 w-5"}),color:"amber"}),t.jsx(Wt,{title:"T chi",value:e.summary.tuChoi,icon:t.jsx(mo,{className:"h-5 w-5"}),color:"red"})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("h3",{className:"font-semibold",children:"Thng k theo loi ngh"})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-3",children:e.summary.theoLoai.map((a,r)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[t.jsx("span",{children:a.loai||"Cha phn loi"}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs(Et,{variant:"info",children:[a.soDon," n"]}),t.jsxs(Et,{variant:"warning",children:[a.soNgay," ngy"]})]})]},r))})})]})]}):t.jsx(wo,{message:"Khng c d liu ngh php"})}function vU({data:e,isLoading:n}){return n?t.jsx(jo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsx(Wt,{title:"Tng qu lng",value:ys(e.summary.tongQuyLuong),icon:t.jsx(gr,{className:"h-5 w-5"}),color:"green"}),t.jsx(Wt,{title:"Tng nhn vin",value:e.summary.tongNhanVien,icon:t.jsx(on,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"Lng trung bnh",value:ys(e.summary.luongTrungBinh),icon:t.jsx(gr,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Wt,{title:"Tng thu TNCN",value:ys(e.summary.tongThueTNCN),icon:t.jsx(gr,{className:"h-5 w-5"}),color:"red"})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("h3",{className:"font-semibold",children:"Qu lng theo phng ban"})}),t.jsx(Vt,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-slate-200",children:[t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"Phng ban"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Nhn vin"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Lng c bn"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Ph cp"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Thng"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Khu tr"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Thc lnh"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"T l"})]})}),t.jsx("tbody",{children:e.theoPhongBan.map((a,r)=>t.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[t.jsx("td",{className:"p-3 font-medium",children:a.tenPhongBan}),t.jsx("td",{className:"text-right p-3",children:a.tongNhanVien}),t.jsx("td",{className:"text-right p-3",children:ys(a.tongLuongCoBan)}),t.jsx("td",{className:"text-right p-3",children:ys(a.tongPhuCap)}),t.jsx("td",{className:"text-right p-3",children:ys(a.tongThuong)}),t.jsx("td",{className:"text-right p-3 text-red-600",children:ys(a.tongKhauTru)}),t.jsx("td",{className:"text-right p-3 font-medium text-green-600",children:ys(a.tongThucLinh)}),t.jsxs("td",{className:"text-right p-3",children:[a.tyLeQuyLuong.toFixed(1),"%"]})]},r))})]})})})]})]}):t.jsx(wo,{message:"Khng c d liu qu lng"})}function bU({data:e,isLoading:n}){return n?t.jsx(jo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsx(Wt,{title:"Tng nhn s",value:e.summary.tongNhanVien,icon:t.jsx(on,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"ang lm",value:e.summary.dangLam,icon:t.jsx(on,{className:"h-5 w-5"}),color:"green"}),t.jsx(Wt,{title:"Mi tuyn",value:e.summary.moiTuyenThang,icon:t.jsx(oi,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Wt,{title:"Ngh vic",value:e.summary.nghiViecThang,icon:t.jsx(xp,{className:"h-5 w-5"}),color:"red"}),t.jsx(Wt,{title:"T l ngh vic",value:`${e.summary.tyLeNghiViec.toFixed(1)}%`,icon:t.jsx(xp,{className:"h-5 w-5"}),color:"amber"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("h3",{className:"font-semibold",children:"Phn b theo gii tnh"})}),t.jsx(Vt,{children:t.jsxs("div",{className:"flex items-center justify-center gap-8",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-20 h-20 rounded-full bg-blue-100 flex items-center justify-center mx-auto mb-2",children:t.jsx("span",{className:"text-2xl font-bold text-blue-600",children:e.summary.theoGioiTinh.nam})}),t.jsx("span",{className:"text-slate-600",children:"Nam"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-20 h-20 rounded-full bg-pink-100 flex items-center justify-center mx-auto mb-2",children:t.jsx("span",{className:"text-2xl font-bold text-pink-600",children:e.summary.theoGioiTinh.nu})}),t.jsx("span",{className:"text-slate-600",children:"N"})]})]})})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("h3",{className:"font-semibold",children:"Phn b theo  tui"})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-3",children:[{label:"Di 25",value:e.summary.theoDoTuoi.duoi25},{label:"25-35",value:e.summary.theoDoTuoi.tu25den35},{label:"35-45",value:e.summary.theoDoTuoi.tu35den45},{label:"Trn 45",value:e.summary.theoDoTuoi.tren45}].map((a,r)=>t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[t.jsx("span",{children:a.label}),t.jsxs("span",{className:"font-medium",children:[a.value," ngi"]})]}),t.jsx("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-purple-500 rounded-full",style:{width:`${e.summary.tongNhanVien>0?a.value/e.summary.tongNhanVien*100:0}%`}})})]},r))})})]})]})]}):t.jsx(wo,{message:"Khng c d liu nhn s"})}function NU({data:e,isLoading:n}){return n?t.jsx(jo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsx(Wt,{title:"Ngy cng chun",value:e.summary.ngayCongChuan,unit:"ngy",icon:t.jsx(Lt,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"Tng nhn vin",value:e.summary.tongNhanVien,icon:t.jsx(on,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"TB ngy cng",value:e.summary.trungBinhNgayCong.toFixed(1),unit:"ngy",icon:t.jsx(Lt,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Wt,{title:"T l i lm",value:`${e.summary.tyLeDiLamTrungBinh.toFixed(1)}%`,icon:t.jsx(oi,{className:"h-5 w-5"}),color:"green"}),t.jsx(Wt,{title:"Tng gi OT",value:e.summary.tongGioOT.toFixed(1),unit:"gi",icon:t.jsx(an,{className:"h-5 w-5"}),color:"amber"})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsxs("h3",{className:"font-semibold",children:["Chi tit chm cng (",e.chiTiet.length," nhn vin)"]})}),t.jsx(Vt,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-slate-200",children:[t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"M NV"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"H tn"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"Phng ban"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Cng chun"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Cng thc"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Ngy ngh"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"i tr"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"V sm"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Gi OT"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"T l"})]})}),t.jsx("tbody",{children:e.chiTiet.slice(0,50).map((a,r)=>t.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[t.jsx("td",{className:"p-3",children:a.maNhanVien}),t.jsx("td",{className:"p-3",children:a.hoTen}),t.jsx("td",{className:"p-3",children:a.phongBan}),t.jsx("td",{className:"text-right p-3",children:a.ngayCongChuan}),t.jsx("td",{className:"text-right p-3 font-medium",children:a.ngayCongThuc}),t.jsx("td",{className:"text-right p-3",children:a.ngayNghi+a.ngayPhep}),t.jsx("td",{className:"text-right p-3",children:a.soLanDiTre>0&&t.jsx("span",{className:"text-red-600",children:a.soLanDiTre})}),t.jsx("td",{className:"text-right p-3",children:a.soLanVeSom>0&&t.jsx("span",{className:"text-amber-600",children:a.soLanVeSom})}),t.jsx("td",{className:"text-right p-3",children:a.tongGioOT>0&&t.jsx("span",{className:"text-blue-600",children:a.tongGioOT.toFixed(1)})}),t.jsx("td",{className:"text-right p-3",children:t.jsxs(Et,{variant:a.tyLeDiLam>=90?"success":a.tyLeDiLam>=80?"warning":"danger",children:[a.tyLeDiLam.toFixed(1),"%"]})})]},r))})]})})})]})]}):t.jsx(wo,{message:"Khng c d liu chm cng"})}function Wt({title:e,value:n,unit:a,icon:r,color:s="gray"}){const l={gray:"bg-slate-100",red:"bg-red-100",amber:"bg-amber-100",green:"bg-green-100",blue:"bg-blue-100"};return t.jsx(st,{children:t.jsx(Vt,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-slate-500",children:e}),t.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[n,a&&t.jsx("span",{className:"text-sm font-normal ml-1",children:a})]})]}),t.jsx("div",{className:`p-3 rounded-full ${l[s]||l.gray}`,children:r})]})})})}function jo(){return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[1,2,3,4].map(e=>t.jsx(st,{children:t.jsx(Vt,{className:"pt-6",children:t.jsx("div",{className:"h-16 bg-slate-200 animate-pulse rounded"})})},e))}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-6",children:t.jsx("div",{className:"h-64 bg-slate-200 animate-pulse rounded"})})})]})}function wo({message:e}){return t.jsx(st,{children:t.jsx(Vt,{className:"pt-6",children:t.jsxs("div",{className:"text-center py-12 text-slate-500",children:[t.jsx(Lt,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:e})]})})})}function jU(){return t.jsxs(x3,{children:[t.jsx(nt,{path:"/dang-nhap",element:t.jsx(LD,{})}),t.jsxs(nt,{path:"/",element:t.jsx($E,{}),children:[t.jsx(nt,{index:!0,element:t.jsx(n6,{})}),t.jsx(nt,{path:"bang-luong",element:t.jsx(a6,{})}),t.jsx(nt,{path:"bang-luong/:id",element:t.jsx(tD,{})}),t.jsx(nt,{path:"nhan-vien",element:t.jsx(rD,{})}),t.jsx(nt,{path:"nhan-vien/:id",element:t.jsx(TD,{})}),t.jsx(nt,{path:"nhom-nhan-vien",element:t.jsx(FD,{})}),t.jsx(nt,{path:"phong-ban",element:t.jsx(DD,{})}),t.jsx(nt,{path:"khoan-luong",element:t.jsx(CD,{})}),t.jsx(nt,{path:"cham-cong",element:t.jsx(ED,{})}),t.jsx(nt,{path:"import-excel",element:t.jsx(SD,{})}),t.jsx(nt,{path:"cai-dat",element:t.jsx(AD,{})}),t.jsx(nt,{path:"quy-che",element:t.jsx(Tt,{children:t.jsx(zD,{})})}),t.jsx(nt,{path:"quy-che/:id",element:t.jsx(Tt,{children:t.jsx(eA,{})})}),t.jsx(nt,{path:"su-kien",element:t.jsx(Tt,{children:t.jsx(nA,{})})}),t.jsx(nt,{path:"rule-trace",element:t.jsx(Tt,{children:t.jsx(rA,{})})}),t.jsx(nt,{path:"kpi/template",element:t.jsx(Tt,{children:t.jsx(ID,{})})}),t.jsx(nt,{path:"kpi/ky-danh-gia",element:t.jsx(Tt,{children:t.jsx(MD,{})})}),t.jsx(nt,{path:"kpi/cau-hinh-thuong",element:t.jsx(Tt,{children:t.jsx(RD,{})})}),t.jsx(nt,{path:"san-luong",element:t.jsx(Tt,{children:t.jsx(fV,{})})}),t.jsx(nt,{path:"san-luong/don-gia",element:t.jsx(Tt,{children:t.jsx(pV,{})})}),t.jsx(nt,{path:"import-chia-hang",element:t.jsx(Tt,{children:t.jsx(hV,{})})}),t.jsx(nt,{path:"import-giao-hang",element:t.jsx(Tt,{children:t.jsx(xV,{})})}),t.jsx(nt,{path:"lich-su-import",element:t.jsx(Tt,{children:t.jsx(mV,{})})}),t.jsx(nt,{path:"ung-luong",element:t.jsx(Tt,{children:t.jsx(vV,{})})}),t.jsx(nt,{path:"ung-luong/:id",element:t.jsx(Tt,{children:t.jsx(NV,{})})}),t.jsx(nt,{path:"cau-hinh/bang-luong",element:t.jsx(Tt,{children:t.jsx(kV,{})})}),t.jsx(nt,{path:"cau-hinh/ung-luong",element:t.jsx(Tt,{children:t.jsx(TV,{})})}),t.jsx(nt,{path:"so-luong/nhan-vien",element:t.jsx(Tt,{children:t.jsx(jV,{})})}),t.jsx(nt,{path:"so-luong/phong-ban",element:t.jsx(Tt,{children:t.jsx(wV,{})})}),t.jsx(nt,{path:"nghi-phep/loai-nghi",element:t.jsx(Tt,{children:t.jsx(_V,{})})}),t.jsx(nt,{path:"nghi-phep/don-cua-toi",element:t.jsx(Tt,{children:t.jsx(EV,{})})}),t.jsx(nt,{path:"nghi-phep/duyet",element:t.jsx(Tt,{children:t.jsx(DV,{})})}),t.jsx(nt,{path:"nghi-phep/lich",element:t.jsx(Tt,{children:t.jsx(AV,{})})}),t.jsx(nt,{path:"xep-ca/danh-muc-ca",element:t.jsx(Tt,{children:t.jsx(FV,{})})}),t.jsx(nt,{path:"xep-ca/lich-phan-ca",element:t.jsx(Tt,{children:t.jsx(LV,{})})}),t.jsx(nt,{path:"yeu-cau/don-cua-toi",element:t.jsx(Tt,{children:t.jsx(PV,{})})}),t.jsx(nt,{path:"yeu-cau/duyet",element:t.jsx(Tt,{children:t.jsx(IV,{})})}),t.jsx(nt,{path:"quan-tri/nguoi-dung",element:t.jsx(Tt,{children:t.jsx(BD,{})})}),t.jsx(nt,{path:"quan-tri/audit-log",element:t.jsx(Tt,{children:t.jsx(HD,{})})}),t.jsx(nt,{path:"anti-fraud/geofence",element:t.jsx(Tt,{children:t.jsx(QV,{})})}),t.jsx(nt,{path:"anti-fraud/gps-logs",element:t.jsx(Tt,{children:t.jsx(YV,{})})}),t.jsx(nt,{path:"anti-fraud/devices",element:t.jsx(Tt,{children:t.jsx(JV,{})})}),t.jsx(nt,{path:"timesheet",element:t.jsx(Tt,{children:t.jsx(iU,{})})}),t.jsx(nt,{path:"payroll-sync",element:t.jsx(Tt,{children:t.jsx(dU,{})})}),t.jsx(nt,{path:"reports",element:t.jsx(Tt,{children:t.jsx(mU,{})})}),t.jsx(nt,{path:"*",element:t.jsx(u3,{to:"/",replace:!0})})]}),t.jsxs(nt,{path:"/portal",element:t.jsx(Tt,{children:t.jsx(MV,{})}),children:[t.jsx(nt,{index:!0,element:t.jsx(UV,{})}),t.jsx(nt,{path:"lich-lam",element:t.jsx(KV,{})}),t.jsx(nt,{path:"cham-cong",element:t.jsx(zV,{})}),t.jsx(nt,{path:"yeu-cau",element:t.jsx($V,{})}),t.jsx(nt,{path:"ca-nhan",element:t.jsx(GV,{})}),t.jsx(nt,{path:"thong-bao",element:t.jsx(g2,{})})]}),t.jsx(nt,{path:"/thong-bao",element:t.jsx(Tt,{children:t.jsx(g2,{})})})]})}const wU=new sS({defaultOptions:{queries:{staleTime:300*1e3,retry:1}}});IC.createRoot(document.getElementById("root")).render(t.jsx(D.StrictMode,{children:t.jsx(iS,{client:wU,children:t.jsx(N3,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:t.jsxs(DE,{children:[t.jsx(jU,{}),t.jsx(x_,{position:"top-right",toastOptions:{duration:3e3,style:{background:"#333",color:"#fff"}}})]})})})}));
