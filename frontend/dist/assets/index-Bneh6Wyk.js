var T4=Object.defineProperty;var F1=e=>{throw TypeError(e)};var C4=(e,n,a)=>n in e?T4(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a;var Ym=(e,n,a)=>C4(e,typeof n!="symbol"?n+"":n,a),Jm=(e,n,a)=>n.has(e)||F1("Cannot "+a);var ce=(e,n,a)=>(Jm(e,n,"read from private field"),a?a.call(e):n.get(e)),at=(e,n,a)=>n.has(e)?F1("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(e):n.set(e,a),$e=(e,n,a,r)=>(Jm(e,n,"write to private field"),r?r.call(e,a):n.set(e,a),a),vt=(e,n,a)=>(Jm(e,n,"access private method"),a);var Uh=(e,n,a,r)=>({set _(s){$e(e,n,s,a)},get _(){return ce(e,n,r)}});function S4(e,n){for(var a=0;a<n.length;a++){const r=n[a];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const l=Object.getOwnPropertyDescriptor(r,s);l&&Object.defineProperty(e,s,l.get?l:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function a(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(s){if(s.ep)return;s.ep=!0;const l=a(s);fetch(s.href,l)}})();function Up(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Zm={exports:{}},jd={},ef={exports:{}},jt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L1;function _4(){if(L1)return jt;L1=1;var e=Symbol.for("react.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),o=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),f=Symbol.iterator;function p(K){return K===null||typeof K!="object"?null:(K=f&&K[f]||K["@@iterator"],typeof K=="function"?K:null)}var N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,g={};function b(K,L,Q){this.props=K,this.context=L,this.refs=g,this.updater=Q||N}b.prototype.isReactComponent={},b.prototype.setState=function(K,L){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,L,"setState")},b.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function j(){}j.prototype=b.prototype;function T(K,L,Q){this.props=K,this.context=L,this.refs=g,this.updater=Q||N}var _=T.prototype=new j;_.constructor=T,y(_,b.prototype),_.isPureReactComponent=!0;var w=Array.isArray,E=Object.prototype.hasOwnProperty,C={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function P(K,L,Q){var I,R={},te=null,ue=null;if(L!=null)for(I in L.ref!==void 0&&(ue=L.ref),L.key!==void 0&&(te=""+L.key),L)E.call(L,I)&&!S.hasOwnProperty(I)&&(R[I]=L[I]);var V=arguments.length-2;if(V===1)R.children=Q;else if(1<V){for(var le=Array(V),q=0;q<V;q++)le[q]=arguments[q+2];R.children=le}if(K&&K.defaultProps)for(I in V=K.defaultProps,V)R[I]===void 0&&(R[I]=V[I]);return{$$typeof:e,type:K,key:te,ref:ue,props:R,_owner:C.current}}function F(K,L){return{$$typeof:e,type:K.type,key:L,ref:K.ref,props:K.props,_owner:K._owner}}function B(K){return typeof K=="object"&&K!==null&&K.$$typeof===e}function O(K){var L={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(Q){return L[Q]})}var M=/\/+/g;function G(K,L){return typeof K=="object"&&K!==null&&K.key!=null?O(""+K.key):L.toString(36)}function J(K,L,Q,I,R){var te=typeof K;(te==="undefined"||te==="boolean")&&(K=null);var ue=!1;if(K===null)ue=!0;else switch(te){case"string":case"number":ue=!0;break;case"object":switch(K.$$typeof){case e:case n:ue=!0}}if(ue)return ue=K,R=R(ue),K=I===""?"."+G(ue,0):I,w(R)?(Q="",K!=null&&(Q=K.replace(M,"$&/")+"/"),J(R,L,Q,"",function(q){return q})):R!=null&&(B(R)&&(R=F(R,Q+(!R.key||ue&&ue.key===R.key?"":(""+R.key).replace(M,"$&/")+"/")+K)),L.push(R)),1;if(ue=0,I=I===""?".":I+":",w(K))for(var V=0;V<K.length;V++){te=K[V];var le=I+G(te,V);ue+=J(te,L,Q,le,R)}else if(le=p(K),typeof le=="function")for(K=le.call(K),V=0;!(te=K.next()).done;)te=te.value,le=I+G(te,V++),ue+=J(te,L,Q,le,R);else if(te==="object")throw L=String(K),Error("Objects are not valid as a React child (found: "+(L==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":L)+"). If you meant to render a collection of children, use an array instead.");return ue}function X(K,L,Q){if(K==null)return K;var I=[],R=0;return J(K,I,"","",function(te){return L.call(Q,te,R++)}),I}function fe(K){if(K._status===-1){var L=K._result;L=L(),L.then(function(Q){(K._status===0||K._status===-1)&&(K._status=1,K._result=Q)},function(Q){(K._status===0||K._status===-1)&&(K._status=2,K._result=Q)}),K._status===-1&&(K._status=0,K._result=L)}if(K._status===1)return K._result.default;throw K._result}var ne={current:null},H={transition:null},W={ReactCurrentDispatcher:ne,ReactCurrentBatchConfig:H,ReactCurrentOwner:C};function xe(){throw Error("act(...) is not supported in production builds of React.")}return jt.Children={map:X,forEach:function(K,L,Q){X(K,function(){L.apply(this,arguments)},Q)},count:function(K){var L=0;return X(K,function(){L++}),L},toArray:function(K){return X(K,function(L){return L})||[]},only:function(K){if(!B(K))throw Error("React.Children.only expected to receive a single React element child.");return K}},jt.Component=b,jt.Fragment=a,jt.Profiler=s,jt.PureComponent=T,jt.StrictMode=r,jt.Suspense=u,jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W,jt.act=xe,jt.cloneElement=function(K,L,Q){if(K==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+K+".");var I=y({},K.props),R=K.key,te=K.ref,ue=K._owner;if(L!=null){if(L.ref!==void 0&&(te=L.ref,ue=C.current),L.key!==void 0&&(R=""+L.key),K.type&&K.type.defaultProps)var V=K.type.defaultProps;for(le in L)E.call(L,le)&&!S.hasOwnProperty(le)&&(I[le]=L[le]===void 0&&V!==void 0?V[le]:L[le])}var le=arguments.length-2;if(le===1)I.children=Q;else if(1<le){V=Array(le);for(var q=0;q<le;q++)V[q]=arguments[q+2];I.children=V}return{$$typeof:e,type:K.type,key:R,ref:te,props:I,_owner:ue}},jt.createContext=function(K){return K={$$typeof:o,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},K.Provider={$$typeof:l,_context:K},K.Consumer=K},jt.createElement=P,jt.createFactory=function(K){var L=P.bind(null,K);return L.type=K,L},jt.createRef=function(){return{current:null}},jt.forwardRef=function(K){return{$$typeof:d,render:K}},jt.isValidElement=B,jt.lazy=function(K){return{$$typeof:m,_payload:{_status:-1,_result:K},_init:fe}},jt.memo=function(K,L){return{$$typeof:x,type:K,compare:L===void 0?null:L}},jt.startTransition=function(K){var L=H.transition;H.transition={};try{K()}finally{H.transition=L}},jt.unstable_act=xe,jt.useCallback=function(K,L){return ne.current.useCallback(K,L)},jt.useContext=function(K){return ne.current.useContext(K)},jt.useDebugValue=function(){},jt.useDeferredValue=function(K){return ne.current.useDeferredValue(K)},jt.useEffect=function(K,L){return ne.current.useEffect(K,L)},jt.useId=function(){return ne.current.useId()},jt.useImperativeHandle=function(K,L,Q){return ne.current.useImperativeHandle(K,L,Q)},jt.useInsertionEffect=function(K,L){return ne.current.useInsertionEffect(K,L)},jt.useLayoutEffect=function(K,L){return ne.current.useLayoutEffect(K,L)},jt.useMemo=function(K,L){return ne.current.useMemo(K,L)},jt.useReducer=function(K,L,Q){return ne.current.useReducer(K,L,Q)},jt.useRef=function(K){return ne.current.useRef(K)},jt.useState=function(K){return ne.current.useState(K)},jt.useSyncExternalStore=function(K,L,Q){return ne.current.useSyncExternalStore(K,L,Q)},jt.useTransition=function(){return ne.current.useTransition()},jt.version="18.3.1",jt}var P1;function Kp(){return P1||(P1=1,ef.exports=_4()),ef.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I1;function E4(){if(I1)return jd;I1=1;var e=Kp(),n=Symbol.for("react.element"),a=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function o(d,u,x){var m,f={},p=null,N=null;x!==void 0&&(p=""+x),u.key!==void 0&&(p=""+u.key),u.ref!==void 0&&(N=u.ref);for(m in u)r.call(u,m)&&!l.hasOwnProperty(m)&&(f[m]=u[m]);if(d&&d.defaultProps)for(m in u=d.defaultProps,u)f[m]===void 0&&(f[m]=u[m]);return{$$typeof:n,type:d,key:p,ref:N,props:f,_owner:s.current}}return jd.Fragment=a,jd.jsx=o,jd.jsxs=o,jd}var O1;function D4(){return O1||(O1=1,Zm.exports=E4()),Zm.exports}var t=D4(),D=Kp();const A2=Up(D),A4=S4({__proto__:null,default:A2},[D]);var Kh={},tf={exports:{}},Ga={},nf={exports:{}},af={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M1;function F4(){return M1||(M1=1,(function(e){function n(H,W){var xe=H.length;H.push(W);e:for(;0<xe;){var K=xe-1>>>1,L=H[K];if(0<s(L,W))H[K]=W,H[xe]=L,xe=K;else break e}}function a(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var W=H[0],xe=H.pop();if(xe!==W){H[0]=xe;e:for(var K=0,L=H.length,Q=L>>>1;K<Q;){var I=2*(K+1)-1,R=H[I],te=I+1,ue=H[te];if(0>s(R,xe))te<L&&0>s(ue,R)?(H[K]=ue,H[te]=xe,K=te):(H[K]=R,H[I]=xe,K=I);else if(te<L&&0>s(ue,xe))H[K]=ue,H[te]=xe,K=te;else break e}}return W}function s(H,W){var xe=H.sortIndex-W.sortIndex;return xe!==0?xe:H.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,d=o.now();e.unstable_now=function(){return o.now()-d}}var u=[],x=[],m=1,f=null,p=3,N=!1,y=!1,g=!1,b=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(H){for(var W=a(x);W!==null;){if(W.callback===null)r(x);else if(W.startTime<=H)r(x),W.sortIndex=W.expirationTime,n(u,W);else break;W=a(x)}}function w(H){if(g=!1,_(H),!y)if(a(u)!==null)y=!0,fe(E);else{var W=a(x);W!==null&&ne(w,W.startTime-H)}}function E(H,W){y=!1,g&&(g=!1,j(P),P=-1),N=!0;var xe=p;try{for(_(W),f=a(u);f!==null&&(!(f.expirationTime>W)||H&&!O());){var K=f.callback;if(typeof K=="function"){f.callback=null,p=f.priorityLevel;var L=K(f.expirationTime<=W);W=e.unstable_now(),typeof L=="function"?f.callback=L:f===a(u)&&r(u),_(W)}else r(u);f=a(u)}if(f!==null)var Q=!0;else{var I=a(x);I!==null&&ne(w,I.startTime-W),Q=!1}return Q}finally{f=null,p=xe,N=!1}}var C=!1,S=null,P=-1,F=5,B=-1;function O(){return!(e.unstable_now()-B<F)}function M(){if(S!==null){var H=e.unstable_now();B=H;var W=!0;try{W=S(!0,H)}finally{W?G():(C=!1,S=null)}}else C=!1}var G;if(typeof T=="function")G=function(){T(M)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,X=J.port2;J.port1.onmessage=M,G=function(){X.postMessage(null)}}else G=function(){b(M,0)};function fe(H){S=H,C||(C=!0,G())}function ne(H,W){P=b(function(){H(e.unstable_now())},W)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(H){H.callback=null},e.unstable_continueExecution=function(){y||N||(y=!0,fe(E))},e.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<H?Math.floor(1e3/H):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return a(u)},e.unstable_next=function(H){switch(p){case 1:case 2:case 3:var W=3;break;default:W=p}var xe=p;p=W;try{return H()}finally{p=xe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(H,W){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var xe=p;p=H;try{return W()}finally{p=xe}},e.unstable_scheduleCallback=function(H,W,xe){var K=e.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?K+xe:K):xe=K,H){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=xe+L,H={id:m++,callback:W,priorityLevel:H,startTime:xe,expirationTime:L,sortIndex:-1},xe>K?(H.sortIndex=xe,n(x,H),a(u)===null&&H===a(x)&&(g?(j(P),P=-1):g=!0,ne(w,xe-K))):(H.sortIndex=L,n(u,H),y||N||(y=!0,fe(E))),H},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(H){var W=p;return function(){var xe=p;p=W;try{return H.apply(this,arguments)}finally{p=xe}}}})(af)),af}var R1;function L4(){return R1||(R1=1,nf.exports=F4()),nf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B1;function P4(){if(B1)return Ga;B1=1;var e=Kp(),n=L4();function a(i){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+i,h=1;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+i+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function l(i,c){o(i,c),o(i+"Capture",c)}function o(i,c){for(s[i]=c,i=0;i<c.length;i++)r.add(c[i])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,x=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},f={};function p(i){return u.call(f,i)?!0:u.call(m,i)?!1:x.test(i)?f[i]=!0:(m[i]=!0,!1)}function N(i,c,h,v){if(h!==null&&h.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return v?!1:h!==null?!h.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function y(i,c,h,v){if(c===null||typeof c>"u"||N(i,c,h,v))return!0;if(v)return!1;if(h!==null)switch(h.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function g(i,c,h,v,k,A,U){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=v,this.attributeNamespace=k,this.mustUseProperty=h,this.propertyName=i,this.type=c,this.sanitizeURL=A,this.removeEmptyString=U}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){b[i]=new g(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var c=i[0];b[c]=new g(c,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){b[i]=new g(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){b[i]=new g(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){b[i]=new g(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){b[i]=new g(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){b[i]=new g(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){b[i]=new g(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){b[i]=new g(i,5,!1,i.toLowerCase(),null,!1,!1)});var j=/[\-:]([a-z])/g;function T(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var c=i.replace(j,T);b[c]=new g(c,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var c=i.replace(j,T);b[c]=new g(c,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var c=i.replace(j,T);b[c]=new g(c,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){b[i]=new g(i,1,!1,i.toLowerCase(),null,!1,!1)}),b.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){b[i]=new g(i,1,!1,i.toLowerCase(),null,!0,!0)});function _(i,c,h,v){var k=b.hasOwnProperty(c)?b[c]:null;(k!==null?k.type!==0:v||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(y(c,h,k,v)&&(h=null),v||k===null?p(c)&&(h===null?i.removeAttribute(c):i.setAttribute(c,""+h)):k.mustUseProperty?i[k.propertyName]=h===null?k.type===3?!1:"":h:(c=k.attributeName,v=k.attributeNamespace,h===null?i.removeAttribute(c):(k=k.type,h=k===3||k===4&&h===!0?"":""+h,v?i.setAttributeNS(v,c,h):i.setAttribute(c,h))))}var w=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,E=Symbol.for("react.element"),C=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),B=Symbol.for("react.provider"),O=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),X=Symbol.for("react.memo"),fe=Symbol.for("react.lazy"),ne=Symbol.for("react.offscreen"),H=Symbol.iterator;function W(i){return i===null||typeof i!="object"?null:(i=H&&i[H]||i["@@iterator"],typeof i=="function"?i:null)}var xe=Object.assign,K;function L(i){if(K===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);K=c&&c[1]||""}return`
`+K+i}var Q=!1;function I(i,c){if(!i||Q)return"";Q=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(je){var v=je}Reflect.construct(i,[],c)}else{try{c.call()}catch(je){v=je}i.call(c.prototype)}else{try{throw Error()}catch(je){v=je}i()}}catch(je){if(je&&v&&typeof je.stack=="string"){for(var k=je.stack.split(`
`),A=v.stack.split(`
`),U=k.length-1,oe=A.length-1;1<=U&&0<=oe&&k[U]!==A[oe];)oe--;for(;1<=U&&0<=oe;U--,oe--)if(k[U]!==A[oe]){if(U!==1||oe!==1)do if(U--,oe--,0>oe||k[U]!==A[oe]){var de=`
`+k[U].replace(" at new "," at ");return i.displayName&&de.includes("<anonymous>")&&(de=de.replace("<anonymous>",i.displayName)),de}while(1<=U&&0<=oe);break}}}finally{Q=!1,Error.prepareStackTrace=h}return(i=i?i.displayName||i.name:"")?L(i):""}function R(i){switch(i.tag){case 5:return L(i.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return i=I(i.type,!1),i;case 11:return i=I(i.type.render,!1),i;case 1:return i=I(i.type,!0),i;default:return""}}function te(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case S:return"Fragment";case C:return"Portal";case F:return"Profiler";case P:return"StrictMode";case G:return"Suspense";case J:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case O:return(i.displayName||"Context")+".Consumer";case B:return(i._context.displayName||"Context")+".Provider";case M:var c=i.render;return i=i.displayName,i||(i=c.displayName||c.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case X:return c=i.displayName||null,c!==null?c:te(i.type)||"Memo";case fe:c=i._payload,i=i._init;try{return te(i(c))}catch{}}return null}function ue(i){var c=i.type;switch(i.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=c.render,i=i.displayName||i.name||"",c.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return te(c);case 8:return c===P?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function V(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function le(i){var c=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function q(i){var c=le(i)?"checked":"value",h=Object.getOwnPropertyDescriptor(i.constructor.prototype,c),v=""+i[c];if(!i.hasOwnProperty(c)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var k=h.get,A=h.set;return Object.defineProperty(i,c,{configurable:!0,get:function(){return k.call(this)},set:function(U){v=""+U,A.call(this,U)}}),Object.defineProperty(i,c,{enumerable:h.enumerable}),{getValue:function(){return v},setValue:function(U){v=""+U},stopTracking:function(){i._valueTracker=null,delete i[c]}}}}function Le(i){i._valueTracker||(i._valueTracker=q(i))}function ee(i){if(!i)return!1;var c=i._valueTracker;if(!c)return!0;var h=c.getValue(),v="";return i&&(v=le(i)?i.checked?"true":"false":i.value),i=v,i!==h?(c.setValue(i),!0):!1}function ke(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Ke(i,c){var h=c.checked;return xe({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??i._wrapperState.initialChecked})}function tt(i,c){var h=c.defaultValue==null?"":c.defaultValue,v=c.checked!=null?c.checked:c.defaultChecked;h=V(c.value!=null?c.value:h),i._wrapperState={initialChecked:v,initialValue:h,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function Xe(i,c){c=c.checked,c!=null&&_(i,"checked",c,!1)}function Oe(i,c){Xe(i,c);var h=V(c.value),v=c.type;if(h!=null)v==="number"?(h===0&&i.value===""||i.value!=h)&&(i.value=""+h):i.value!==""+h&&(i.value=""+h);else if(v==="submit"||v==="reset"){i.removeAttribute("value");return}c.hasOwnProperty("value")?hn(i,c.type,h):c.hasOwnProperty("defaultValue")&&hn(i,c.type,V(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(i.defaultChecked=!!c.defaultChecked)}function Rt(i,c,h){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var v=c.type;if(!(v!=="submit"&&v!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+i._wrapperState.initialValue,h||c===i.value||(i.value=c),i.defaultValue=c}h=i.name,h!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,h!==""&&(i.name=h)}function hn(i,c,h){(c!=="number"||ke(i.ownerDocument)!==i)&&(h==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+h&&(i.defaultValue=""+h))}var xn=Array.isArray;function Cn(i,c,h,v){if(i=i.options,c){c={};for(var k=0;k<h.length;k++)c["$"+h[k]]=!0;for(h=0;h<i.length;h++)k=c.hasOwnProperty("$"+i[h].value),i[h].selected!==k&&(i[h].selected=k),k&&v&&(i[h].defaultSelected=!0)}else{for(h=""+V(h),c=null,k=0;k<i.length;k++){if(i[k].value===h){i[k].selected=!0,v&&(i[k].defaultSelected=!0);return}c!==null||i[k].disabled||(c=i[k])}c!==null&&(c.selected=!0)}}function ia(i,c){if(c.dangerouslySetInnerHTML!=null)throw Error(a(91));return xe({},c,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function la(i,c){var h=c.value;if(h==null){if(h=c.children,c=c.defaultValue,h!=null){if(c!=null)throw Error(a(92));if(xn(h)){if(1<h.length)throw Error(a(93));h=h[0]}c=h}c==null&&(c=""),h=c}i._wrapperState={initialValue:V(h)}}function Re(i,c){var h=V(c.value),v=V(c.defaultValue);h!=null&&(h=""+h,h!==i.value&&(i.value=h),c.defaultValue==null&&i.defaultValue!==h&&(i.defaultValue=h)),v!=null&&(i.defaultValue=""+v)}function Qe(i){var c=i.textContent;c===i._wrapperState.initialValue&&c!==""&&c!==null&&(i.value=c)}function Et(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ht(i,c){return i==null||i==="http://www.w3.org/1999/xhtml"?Et(c):i==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var Nt,Bn=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,h,v,k){MSApp.execUnsafeLocalFunction(function(){return i(c,h,v,k)})}:i})(function(i,c){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=c;else{for(Nt=Nt||document.createElement("div"),Nt.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Nt.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;c.firstChild;)i.appendChild(c.firstChild)}});function ot(i,c){if(c){var h=i.firstChild;if(h&&h===i.lastChild&&h.nodeType===3){h.nodeValue=c;return}}i.textContent=c}var Bt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Xn=["Webkit","ms","Moz","O"];Object.keys(Bt).forEach(function(i){Xn.forEach(function(c){c=c+i.charAt(0).toUpperCase()+i.substring(1),Bt[c]=Bt[i]})});function en(i,c,h){return c==null||typeof c=="boolean"||c===""?"":h||typeof c!="number"||c===0||Bt.hasOwnProperty(i)&&Bt[i]?(""+c).trim():c+"px"}function Da(i,c){i=i.style;for(var h in c)if(c.hasOwnProperty(h)){var v=h.indexOf("--")===0,k=en(h,c[h],v);h==="float"&&(h="cssFloat"),v?i.setProperty(h,k):i[h]=k}}var mi=xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ls(i,c){if(c){if(mi[i]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(a(137,i));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(a(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(a(61))}if(c.style!=null&&typeof c.style!="object")throw Error(a(62))}}function Ps(i,c){if(i.indexOf("-")===-1)return typeof c.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var os=null;function fi(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ko=null,pi=null,gi=null;function fl(i){if(i=ld(i)){if(typeof ko!="function")throw Error(a(280));var c=i.stateNode;c&&(c=ah(c),ko(i.stateNode,i.type,c))}}function Pu(i){pi?gi?gi.push(i):gi=[i]:pi=i}function Iu(){if(pi){var i=pi,c=gi;if(gi=pi=null,fl(i),c)for(i=0;i<c.length;i++)fl(c[i])}}function Ou(i,c){return i(c)}function Mu(){}var Hc=!1;function Ru(i,c,h){if(Hc)return i(c,h);Hc=!0;try{return Ou(i,c,h)}finally{Hc=!1,(pi!==null||gi!==null)&&(Mu(),Iu())}}function pl(i,c){var h=i.stateNode;if(h===null)return null;var v=ah(h);if(v===null)return null;h=v[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(i=i.type,v=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!v;break e;default:i=!1}if(i)return null;if(h&&typeof h!="function")throw Error(a(231,c,typeof h));return h}var Vc=!1;if(d)try{var Is={};Object.defineProperty(Is,"passive",{get:function(){Vc=!0}}),window.addEventListener("test",Is,Is),window.removeEventListener("test",Is,Is)}catch{Vc=!1}function gx(i,c,h,v,k,A,U,oe,de){var je=Array.prototype.slice.call(arguments,3);try{c.apply(h,je)}catch(Ae){this.onError(Ae)}}var gl=!1,To=null,z=!1,ae=null,Y={onError:function(i){gl=!0,To=i}};function Z(i,c,h,v,k,A,U,oe,de){gl=!1,To=null,gx.apply(Y,arguments)}function re(i,c,h,v,k,A,U,oe,de){if(Z.apply(this,arguments),gl){if(gl){var je=To;gl=!1,To=null}else throw Error(a(198));z||(z=!0,ae=je)}}function se(i){var c=i,h=i;if(i.alternate)for(;c.return;)c=c.return;else{i=c;do c=i,(c.flags&4098)!==0&&(h=c.return),i=c.return;while(i)}return c.tag===3?h:null}function ve(i){if(i.tag===13){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function Ce(i){if(se(i)!==i)throw Error(a(188))}function ye(i){var c=i.alternate;if(!c){if(c=se(i),c===null)throw Error(a(188));return c!==i?null:i}for(var h=i,v=c;;){var k=h.return;if(k===null)break;var A=k.alternate;if(A===null){if(v=k.return,v!==null){h=v;continue}break}if(k.child===A.child){for(A=k.child;A;){if(A===h)return Ce(k),i;if(A===v)return Ce(k),c;A=A.sibling}throw Error(a(188))}if(h.return!==v.return)h=k,v=A;else{for(var U=!1,oe=k.child;oe;){if(oe===h){U=!0,h=k,v=A;break}if(oe===v){U=!0,v=k,h=A;break}oe=oe.sibling}if(!U){for(oe=A.child;oe;){if(oe===h){U=!0,h=A,v=k;break}if(oe===v){U=!0,v=A,h=k;break}oe=oe.sibling}if(!U)throw Error(a(189))}}if(h.alternate!==v)throw Error(a(190))}if(h.tag!==3)throw Error(a(188));return h.stateNode.current===h?i:c}function be(i){return i=ye(i),i!==null?Ne(i):null}function Ne(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var c=Ne(i);if(c!==null)return c;i=i.sibling}return null}var Pe=n.unstable_scheduleCallback,ze=n.unstable_cancelCallback,qe=n.unstable_shouldYield,Be=n.unstable_requestPaint,Me=n.unstable_now,mt=n.unstable_getCurrentPriorityLevel,Qt=n.unstable_ImmediatePriority,tn=n.unstable_UserBlockingPriority,Sn=n.unstable_NormalPriority,yl=n.unstable_LowPriority,yi=n.unstable_IdlePriority,cs=null,Qn=null;function Uc(i){if(Qn&&typeof Qn.onCommitFiberRoot=="function")try{Qn.onCommitFiberRoot(cs,i,void 0,(i.current.flags&128)===128)}catch{}}var _n=Math.clz32?Math.clz32:KT,VT=Math.log,UT=Math.LN2;function KT(i){return i>>>=0,i===0?32:31-(VT(i)/UT|0)|0}var Bu=64,Hu=4194304;function Kc(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Vu(i,c){var h=i.pendingLanes;if(h===0)return 0;var v=0,k=i.suspendedLanes,A=i.pingedLanes,U=h&268435455;if(U!==0){var oe=U&~k;oe!==0?v=Kc(oe):(A&=U,A!==0&&(v=Kc(A)))}else U=h&~k,U!==0?v=Kc(U):A!==0&&(v=Kc(A));if(v===0)return 0;if(c!==0&&c!==v&&(c&k)===0&&(k=v&-v,A=c&-c,k>=A||k===16&&(A&4194240)!==0))return c;if((v&4)!==0&&(v|=h&16),c=i.entangledLanes,c!==0)for(i=i.entanglements,c&=v;0<c;)h=31-_n(c),k=1<<h,v|=i[h],c&=~k;return v}function zT(i,c){switch(i){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $T(i,c){for(var h=i.suspendedLanes,v=i.pingedLanes,k=i.expirationTimes,A=i.pendingLanes;0<A;){var U=31-_n(A),oe=1<<U,de=k[U];de===-1?((oe&h)===0||(oe&v)!==0)&&(k[U]=zT(oe,c)):de<=c&&(i.expiredLanes|=oe),A&=~oe}}function yx(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function cy(){var i=Bu;return Bu<<=1,(Bu&4194240)===0&&(Bu=64),i}function vx(i){for(var c=[],h=0;31>h;h++)c.push(i);return c}function zc(i,c,h){i.pendingLanes|=c,c!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,c=31-_n(c),i[c]=h}function GT(i,c){var h=i.pendingLanes&~c;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=c,i.mutableReadLanes&=c,i.entangledLanes&=c,c=i.entanglements;var v=i.eventTimes;for(i=i.expirationTimes;0<h;){var k=31-_n(h),A=1<<k;c[k]=0,v[k]=-1,i[k]=-1,h&=~A}}function bx(i,c){var h=i.entangledLanes|=c;for(i=i.entanglements;h;){var v=31-_n(h),k=1<<v;k&c|i[v]&c&&(i[v]|=c),h&=~k}}var Kt=0;function dy(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var uy,Nx,hy,xy,my,jx=!1,Uu=[],vi=null,bi=null,Ni=null,$c=new Map,Gc=new Map,ji=[],qT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fy(i,c){switch(i){case"focusin":case"focusout":vi=null;break;case"dragenter":case"dragleave":bi=null;break;case"mouseover":case"mouseout":Ni=null;break;case"pointerover":case"pointerout":$c.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gc.delete(c.pointerId)}}function qc(i,c,h,v,k,A){return i===null||i.nativeEvent!==A?(i={blockedOn:c,domEventName:h,eventSystemFlags:v,nativeEvent:A,targetContainers:[k]},c!==null&&(c=ld(c),c!==null&&Nx(c)),i):(i.eventSystemFlags|=v,c=i.targetContainers,k!==null&&c.indexOf(k)===-1&&c.push(k),i)}function WT(i,c,h,v,k){switch(c){case"focusin":return vi=qc(vi,i,c,h,v,k),!0;case"dragenter":return bi=qc(bi,i,c,h,v,k),!0;case"mouseover":return Ni=qc(Ni,i,c,h,v,k),!0;case"pointerover":var A=k.pointerId;return $c.set(A,qc($c.get(A)||null,i,c,h,v,k)),!0;case"gotpointercapture":return A=k.pointerId,Gc.set(A,qc(Gc.get(A)||null,i,c,h,v,k)),!0}return!1}function py(i){var c=vl(i.target);if(c!==null){var h=se(c);if(h!==null){if(c=h.tag,c===13){if(c=ve(h),c!==null){i.blockedOn=c,my(i.priority,function(){hy(h)});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){i.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Ku(i){if(i.blockedOn!==null)return!1;for(var c=i.targetContainers;0<c.length;){var h=kx(i.domEventName,i.eventSystemFlags,c[0],i.nativeEvent);if(h===null){h=i.nativeEvent;var v=new h.constructor(h.type,h);os=v,h.target.dispatchEvent(v),os=null}else return c=ld(h),c!==null&&Nx(c),i.blockedOn=h,!1;c.shift()}return!0}function gy(i,c,h){Ku(i)&&h.delete(c)}function XT(){jx=!1,vi!==null&&Ku(vi)&&(vi=null),bi!==null&&Ku(bi)&&(bi=null),Ni!==null&&Ku(Ni)&&(Ni=null),$c.forEach(gy),Gc.forEach(gy)}function Wc(i,c){i.blockedOn===c&&(i.blockedOn=null,jx||(jx=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,XT)))}function Xc(i){function c(k){return Wc(k,i)}if(0<Uu.length){Wc(Uu[0],i);for(var h=1;h<Uu.length;h++){var v=Uu[h];v.blockedOn===i&&(v.blockedOn=null)}}for(vi!==null&&Wc(vi,i),bi!==null&&Wc(bi,i),Ni!==null&&Wc(Ni,i),$c.forEach(c),Gc.forEach(c),h=0;h<ji.length;h++)v=ji[h],v.blockedOn===i&&(v.blockedOn=null);for(;0<ji.length&&(h=ji[0],h.blockedOn===null);)py(h),h.blockedOn===null&&ji.shift()}var Co=w.ReactCurrentBatchConfig,zu=!0;function QT(i,c,h,v){var k=Kt,A=Co.transition;Co.transition=null;try{Kt=1,wx(i,c,h,v)}finally{Kt=k,Co.transition=A}}function YT(i,c,h,v){var k=Kt,A=Co.transition;Co.transition=null;try{Kt=4,wx(i,c,h,v)}finally{Kt=k,Co.transition=A}}function wx(i,c,h,v){if(zu){var k=kx(i,c,h,v);if(k===null)Vx(i,c,v,$u,h),fy(i,v);else if(WT(k,i,c,h,v))v.stopPropagation();else if(fy(i,v),c&4&&-1<qT.indexOf(i)){for(;k!==null;){var A=ld(k);if(A!==null&&uy(A),A=kx(i,c,h,v),A===null&&Vx(i,c,v,$u,h),A===k)break;k=A}k!==null&&v.stopPropagation()}else Vx(i,c,v,null,h)}}var $u=null;function kx(i,c,h,v){if($u=null,i=fi(v),i=vl(i),i!==null)if(c=se(i),c===null)i=null;else if(h=c.tag,h===13){if(i=ve(c),i!==null)return i;i=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;i=null}else c!==i&&(i=null);return $u=i,null}function yy(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mt()){case Qt:return 1;case tn:return 4;case Sn:case yl:return 16;case yi:return 536870912;default:return 16}default:return 16}}var wi=null,Tx=null,Gu=null;function vy(){if(Gu)return Gu;var i,c=Tx,h=c.length,v,k="value"in wi?wi.value:wi.textContent,A=k.length;for(i=0;i<h&&c[i]===k[i];i++);var U=h-i;for(v=1;v<=U&&c[h-v]===k[A-v];v++);return Gu=k.slice(i,1<v?1-v:void 0)}function qu(i){var c=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&c===13&&(i=13)):i=c,i===10&&(i=13),32<=i||i===13?i:0}function Wu(){return!0}function by(){return!1}function ir(i){function c(h,v,k,A,U){this._reactName=h,this._targetInst=k,this.type=v,this.nativeEvent=A,this.target=U,this.currentTarget=null;for(var oe in i)i.hasOwnProperty(oe)&&(h=i[oe],this[oe]=h?h(A):A[oe]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?Wu:by,this.isPropagationStopped=by,this}return xe(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Wu)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Wu)},persist:function(){},isPersistent:Wu}),c}var So={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cx=ir(So),Qc=xe({},So,{view:0,detail:0}),JT=ir(Qc),Sx,_x,Yc,Xu=xe({},Qc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Dx,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Yc&&(Yc&&i.type==="mousemove"?(Sx=i.screenX-Yc.screenX,_x=i.screenY-Yc.screenY):_x=Sx=0,Yc=i),Sx)},movementY:function(i){return"movementY"in i?i.movementY:_x}}),Ny=ir(Xu),ZT=xe({},Xu,{dataTransfer:0}),eC=ir(ZT),tC=xe({},Qc,{relatedTarget:0}),Ex=ir(tC),nC=xe({},So,{animationName:0,elapsedTime:0,pseudoElement:0}),aC=ir(nC),rC=xe({},So,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),sC=ir(rC),iC=xe({},So,{data:0}),jy=ir(iC),lC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},oC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dC(i){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(i):(i=cC[i])?!!c[i]:!1}function Dx(){return dC}var uC=xe({},Qc,{key:function(i){if(i.key){var c=lC[i.key]||i.key;if(c!=="Unidentified")return c}return i.type==="keypress"?(i=qu(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?oC[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Dx,charCode:function(i){return i.type==="keypress"?qu(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?qu(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),hC=ir(uC),xC=xe({},Xu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wy=ir(xC),mC=xe({},Qc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Dx}),fC=ir(mC),pC=xe({},So,{propertyName:0,elapsedTime:0,pseudoElement:0}),gC=ir(pC),yC=xe({},Xu,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),vC=ir(yC),bC=[9,13,27,32],Ax=d&&"CompositionEvent"in window,Jc=null;d&&"documentMode"in document&&(Jc=document.documentMode);var NC=d&&"TextEvent"in window&&!Jc,ky=d&&(!Ax||Jc&&8<Jc&&11>=Jc),Ty=" ",Cy=!1;function Sy(i,c){switch(i){case"keyup":return bC.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _y(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var _o=!1;function jC(i,c){switch(i){case"compositionend":return _y(c);case"keypress":return c.which!==32?null:(Cy=!0,Ty);case"textInput":return i=c.data,i===Ty&&Cy?null:i;default:return null}}function wC(i,c){if(_o)return i==="compositionend"||!Ax&&Sy(i,c)?(i=vy(),Gu=Tx=wi=null,_o=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return ky&&c.locale!=="ko"?null:c.data;default:return null}}var kC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ey(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c==="input"?!!kC[i.type]:c==="textarea"}function Dy(i,c,h,v){Pu(v),c=eh(c,"onChange"),0<c.length&&(h=new Cx("onChange","change",null,h,v),i.push({event:h,listeners:c}))}var Zc=null,ed=null;function TC(i){Wy(i,0)}function Qu(i){var c=Lo(i);if(ee(c))return i}function CC(i,c){if(i==="change")return c}var Ay=!1;if(d){var Fx;if(d){var Lx="oninput"in document;if(!Lx){var Fy=document.createElement("div");Fy.setAttribute("oninput","return;"),Lx=typeof Fy.oninput=="function"}Fx=Lx}else Fx=!1;Ay=Fx&&(!document.documentMode||9<document.documentMode)}function Ly(){Zc&&(Zc.detachEvent("onpropertychange",Py),ed=Zc=null)}function Py(i){if(i.propertyName==="value"&&Qu(ed)){var c=[];Dy(c,ed,i,fi(i)),Ru(TC,c)}}function SC(i,c,h){i==="focusin"?(Ly(),Zc=c,ed=h,Zc.attachEvent("onpropertychange",Py)):i==="focusout"&&Ly()}function _C(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Qu(ed)}function EC(i,c){if(i==="click")return Qu(c)}function DC(i,c){if(i==="input"||i==="change")return Qu(c)}function AC(i,c){return i===c&&(i!==0||1/i===1/c)||i!==i&&c!==c}var Kr=typeof Object.is=="function"?Object.is:AC;function td(i,c){if(Kr(i,c))return!0;if(typeof i!="object"||i===null||typeof c!="object"||c===null)return!1;var h=Object.keys(i),v=Object.keys(c);if(h.length!==v.length)return!1;for(v=0;v<h.length;v++){var k=h[v];if(!u.call(c,k)||!Kr(i[k],c[k]))return!1}return!0}function Iy(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Oy(i,c){var h=Iy(i);i=0;for(var v;h;){if(h.nodeType===3){if(v=i+h.textContent.length,i<=c&&v>=c)return{node:h,offset:c-i};i=v}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Iy(h)}}function My(i,c){return i&&c?i===c?!0:i&&i.nodeType===3?!1:c&&c.nodeType===3?My(i,c.parentNode):"contains"in i?i.contains(c):i.compareDocumentPosition?!!(i.compareDocumentPosition(c)&16):!1:!1}function Ry(){for(var i=window,c=ke();c instanceof i.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)i=c.contentWindow;else break;c=ke(i.document)}return c}function Px(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c&&(c==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||c==="textarea"||i.contentEditable==="true")}function FC(i){var c=Ry(),h=i.focusedElem,v=i.selectionRange;if(c!==h&&h&&h.ownerDocument&&My(h.ownerDocument.documentElement,h)){if(v!==null&&Px(h)){if(c=v.start,i=v.end,i===void 0&&(i=c),"selectionStart"in h)h.selectionStart=c,h.selectionEnd=Math.min(i,h.value.length);else if(i=(c=h.ownerDocument||document)&&c.defaultView||window,i.getSelection){i=i.getSelection();var k=h.textContent.length,A=Math.min(v.start,k);v=v.end===void 0?A:Math.min(v.end,k),!i.extend&&A>v&&(k=v,v=A,A=k),k=Oy(h,A);var U=Oy(h,v);k&&U&&(i.rangeCount!==1||i.anchorNode!==k.node||i.anchorOffset!==k.offset||i.focusNode!==U.node||i.focusOffset!==U.offset)&&(c=c.createRange(),c.setStart(k.node,k.offset),i.removeAllRanges(),A>v?(i.addRange(c),i.extend(U.node,U.offset)):(c.setEnd(U.node,U.offset),i.addRange(c)))}}for(c=[],i=h;i=i.parentNode;)i.nodeType===1&&c.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<c.length;h++)i=c[h],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var LC=d&&"documentMode"in document&&11>=document.documentMode,Eo=null,Ix=null,nd=null,Ox=!1;function By(i,c,h){var v=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Ox||Eo==null||Eo!==ke(v)||(v=Eo,"selectionStart"in v&&Px(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),nd&&td(nd,v)||(nd=v,v=eh(Ix,"onSelect"),0<v.length&&(c=new Cx("onSelect","select",null,c,h),i.push({event:c,listeners:v}),c.target=Eo)))}function Yu(i,c){var h={};return h[i.toLowerCase()]=c.toLowerCase(),h["Webkit"+i]="webkit"+c,h["Moz"+i]="moz"+c,h}var Do={animationend:Yu("Animation","AnimationEnd"),animationiteration:Yu("Animation","AnimationIteration"),animationstart:Yu("Animation","AnimationStart"),transitionend:Yu("Transition","TransitionEnd")},Mx={},Hy={};d&&(Hy=document.createElement("div").style,"AnimationEvent"in window||(delete Do.animationend.animation,delete Do.animationiteration.animation,delete Do.animationstart.animation),"TransitionEvent"in window||delete Do.transitionend.transition);function Ju(i){if(Mx[i])return Mx[i];if(!Do[i])return i;var c=Do[i],h;for(h in c)if(c.hasOwnProperty(h)&&h in Hy)return Mx[i]=c[h];return i}var Vy=Ju("animationend"),Uy=Ju("animationiteration"),Ky=Ju("animationstart"),zy=Ju("transitionend"),$y=new Map,Gy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ki(i,c){$y.set(i,c),l(c,[i])}for(var Rx=0;Rx<Gy.length;Rx++){var Bx=Gy[Rx],PC=Bx.toLowerCase(),IC=Bx[0].toUpperCase()+Bx.slice(1);ki(PC,"on"+IC)}ki(Vy,"onAnimationEnd"),ki(Uy,"onAnimationIteration"),ki(Ky,"onAnimationStart"),ki("dblclick","onDoubleClick"),ki("focusin","onFocus"),ki("focusout","onBlur"),ki(zy,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ad="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),OC=new Set("cancel close invalid load scroll toggle".split(" ").concat(ad));function qy(i,c,h){var v=i.type||"unknown-event";i.currentTarget=h,re(v,c,void 0,i),i.currentTarget=null}function Wy(i,c){c=(c&4)!==0;for(var h=0;h<i.length;h++){var v=i[h],k=v.event;v=v.listeners;e:{var A=void 0;if(c)for(var U=v.length-1;0<=U;U--){var oe=v[U],de=oe.instance,je=oe.currentTarget;if(oe=oe.listener,de!==A&&k.isPropagationStopped())break e;qy(k,oe,je),A=de}else for(U=0;U<v.length;U++){if(oe=v[U],de=oe.instance,je=oe.currentTarget,oe=oe.listener,de!==A&&k.isPropagationStopped())break e;qy(k,oe,je),A=de}}}if(z)throw i=ae,z=!1,ae=null,i}function sn(i,c){var h=c[qx];h===void 0&&(h=c[qx]=new Set);var v=i+"__bubble";h.has(v)||(Xy(c,i,2,!1),h.add(v))}function Hx(i,c,h){var v=0;c&&(v|=4),Xy(h,i,v,c)}var Zu="_reactListening"+Math.random().toString(36).slice(2);function rd(i){if(!i[Zu]){i[Zu]=!0,r.forEach(function(h){h!=="selectionchange"&&(OC.has(h)||Hx(h,!1,i),Hx(h,!0,i))});var c=i.nodeType===9?i:i.ownerDocument;c===null||c[Zu]||(c[Zu]=!0,Hx("selectionchange",!1,c))}}function Xy(i,c,h,v){switch(yy(c)){case 1:var k=QT;break;case 4:k=YT;break;default:k=wx}h=k.bind(null,c,h,i),k=void 0,!Vc||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(k=!0),v?k!==void 0?i.addEventListener(c,h,{capture:!0,passive:k}):i.addEventListener(c,h,!0):k!==void 0?i.addEventListener(c,h,{passive:k}):i.addEventListener(c,h,!1)}function Vx(i,c,h,v,k){var A=v;if((c&1)===0&&(c&2)===0&&v!==null)e:for(;;){if(v===null)return;var U=v.tag;if(U===3||U===4){var oe=v.stateNode.containerInfo;if(oe===k||oe.nodeType===8&&oe.parentNode===k)break;if(U===4)for(U=v.return;U!==null;){var de=U.tag;if((de===3||de===4)&&(de=U.stateNode.containerInfo,de===k||de.nodeType===8&&de.parentNode===k))return;U=U.return}for(;oe!==null;){if(U=vl(oe),U===null)return;if(de=U.tag,de===5||de===6){v=A=U;continue e}oe=oe.parentNode}}v=v.return}Ru(function(){var je=A,Ae=fi(h),Ie=[];e:{var De=$y.get(i);if(De!==void 0){var Ge=Cx,Ye=i;switch(i){case"keypress":if(qu(h)===0)break e;case"keydown":case"keyup":Ge=hC;break;case"focusin":Ye="focus",Ge=Ex;break;case"focusout":Ye="blur",Ge=Ex;break;case"beforeblur":case"afterblur":Ge=Ex;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ge=Ny;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ge=eC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ge=fC;break;case Vy:case Uy:case Ky:Ge=aC;break;case zy:Ge=gC;break;case"scroll":Ge=JT;break;case"wheel":Ge=vC;break;case"copy":case"cut":case"paste":Ge=sC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ge=wy}var Je=(c&4)!==0,En=!Je&&i==="scroll",pe=Je?De!==null?De+"Capture":null:De;Je=[];for(var me=je,ge;me!==null;){ge=me;var He=ge.stateNode;if(ge.tag===5&&He!==null&&(ge=He,pe!==null&&(He=pl(me,pe),He!=null&&Je.push(sd(me,He,ge)))),En)break;me=me.return}0<Je.length&&(De=new Ge(De,Ye,null,h,Ae),Ie.push({event:De,listeners:Je}))}}if((c&7)===0){e:{if(De=i==="mouseover"||i==="pointerover",Ge=i==="mouseout"||i==="pointerout",De&&h!==os&&(Ye=h.relatedTarget||h.fromElement)&&(vl(Ye)||Ye[Os]))break e;if((Ge||De)&&(De=Ae.window===Ae?Ae:(De=Ae.ownerDocument)?De.defaultView||De.parentWindow:window,Ge?(Ye=h.relatedTarget||h.toElement,Ge=je,Ye=Ye?vl(Ye):null,Ye!==null&&(En=se(Ye),Ye!==En||Ye.tag!==5&&Ye.tag!==6)&&(Ye=null)):(Ge=null,Ye=je),Ge!==Ye)){if(Je=Ny,He="onMouseLeave",pe="onMouseEnter",me="mouse",(i==="pointerout"||i==="pointerover")&&(Je=wy,He="onPointerLeave",pe="onPointerEnter",me="pointer"),En=Ge==null?De:Lo(Ge),ge=Ye==null?De:Lo(Ye),De=new Je(He,me+"leave",Ge,h,Ae),De.target=En,De.relatedTarget=ge,He=null,vl(Ae)===je&&(Je=new Je(pe,me+"enter",Ye,h,Ae),Je.target=ge,Je.relatedTarget=En,He=Je),En=He,Ge&&Ye)t:{for(Je=Ge,pe=Ye,me=0,ge=Je;ge;ge=Ao(ge))me++;for(ge=0,He=pe;He;He=Ao(He))ge++;for(;0<me-ge;)Je=Ao(Je),me--;for(;0<ge-me;)pe=Ao(pe),ge--;for(;me--;){if(Je===pe||pe!==null&&Je===pe.alternate)break t;Je=Ao(Je),pe=Ao(pe)}Je=null}else Je=null;Ge!==null&&Qy(Ie,De,Ge,Je,!1),Ye!==null&&En!==null&&Qy(Ie,En,Ye,Je,!0)}}e:{if(De=je?Lo(je):window,Ge=De.nodeName&&De.nodeName.toLowerCase(),Ge==="select"||Ge==="input"&&De.type==="file")var et=CC;else if(Ey(De))if(Ay)et=DC;else{et=_C;var it=SC}else(Ge=De.nodeName)&&Ge.toLowerCase()==="input"&&(De.type==="checkbox"||De.type==="radio")&&(et=EC);if(et&&(et=et(i,je))){Dy(Ie,et,h,Ae);break e}it&&it(i,De,je),i==="focusout"&&(it=De._wrapperState)&&it.controlled&&De.type==="number"&&hn(De,"number",De.value)}switch(it=je?Lo(je):window,i){case"focusin":(Ey(it)||it.contentEditable==="true")&&(Eo=it,Ix=je,nd=null);break;case"focusout":nd=Ix=Eo=null;break;case"mousedown":Ox=!0;break;case"contextmenu":case"mouseup":case"dragend":Ox=!1,By(Ie,h,Ae);break;case"selectionchange":if(LC)break;case"keydown":case"keyup":By(Ie,h,Ae)}var lt;if(Ax)e:{switch(i){case"compositionstart":var ht="onCompositionStart";break e;case"compositionend":ht="onCompositionEnd";break e;case"compositionupdate":ht="onCompositionUpdate";break e}ht=void 0}else _o?Sy(i,h)&&(ht="onCompositionEnd"):i==="keydown"&&h.keyCode===229&&(ht="onCompositionStart");ht&&(ky&&h.locale!=="ko"&&(_o||ht!=="onCompositionStart"?ht==="onCompositionEnd"&&_o&&(lt=vy()):(wi=Ae,Tx="value"in wi?wi.value:wi.textContent,_o=!0)),it=eh(je,ht),0<it.length&&(ht=new jy(ht,i,null,h,Ae),Ie.push({event:ht,listeners:it}),lt?ht.data=lt:(lt=_y(h),lt!==null&&(ht.data=lt)))),(lt=NC?jC(i,h):wC(i,h))&&(je=eh(je,"onBeforeInput"),0<je.length&&(Ae=new jy("onBeforeInput","beforeinput",null,h,Ae),Ie.push({event:Ae,listeners:je}),Ae.data=lt))}Wy(Ie,c)})}function sd(i,c,h){return{instance:i,listener:c,currentTarget:h}}function eh(i,c){for(var h=c+"Capture",v=[];i!==null;){var k=i,A=k.stateNode;k.tag===5&&A!==null&&(k=A,A=pl(i,h),A!=null&&v.unshift(sd(i,A,k)),A=pl(i,c),A!=null&&v.push(sd(i,A,k))),i=i.return}return v}function Ao(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function Qy(i,c,h,v,k){for(var A=c._reactName,U=[];h!==null&&h!==v;){var oe=h,de=oe.alternate,je=oe.stateNode;if(de!==null&&de===v)break;oe.tag===5&&je!==null&&(oe=je,k?(de=pl(h,A),de!=null&&U.unshift(sd(h,de,oe))):k||(de=pl(h,A),de!=null&&U.push(sd(h,de,oe)))),h=h.return}U.length!==0&&i.push({event:c,listeners:U})}var MC=/\r\n?/g,RC=/\u0000|\uFFFD/g;function Yy(i){return(typeof i=="string"?i:""+i).replace(MC,`
`).replace(RC,"")}function th(i,c,h){if(c=Yy(c),Yy(i)!==c&&h)throw Error(a(425))}function nh(){}var Ux=null,Kx=null;function zx(i,c){return i==="textarea"||i==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var $x=typeof setTimeout=="function"?setTimeout:void 0,BC=typeof clearTimeout=="function"?clearTimeout:void 0,Jy=typeof Promise=="function"?Promise:void 0,HC=typeof queueMicrotask=="function"?queueMicrotask:typeof Jy<"u"?function(i){return Jy.resolve(null).then(i).catch(VC)}:$x;function VC(i){setTimeout(function(){throw i})}function Gx(i,c){var h=c,v=0;do{var k=h.nextSibling;if(i.removeChild(h),k&&k.nodeType===8)if(h=k.data,h==="/$"){if(v===0){i.removeChild(k),Xc(c);return}v--}else h!=="$"&&h!=="$?"&&h!=="$!"||v++;h=k}while(h);Xc(c)}function Ti(i){for(;i!=null;i=i.nextSibling){var c=i.nodeType;if(c===1||c===3)break;if(c===8){if(c=i.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return i}function Zy(i){i=i.previousSibling;for(var c=0;i;){if(i.nodeType===8){var h=i.data;if(h==="$"||h==="$!"||h==="$?"){if(c===0)return i;c--}else h==="/$"&&c++}i=i.previousSibling}return null}var Fo=Math.random().toString(36).slice(2),ds="__reactFiber$"+Fo,id="__reactProps$"+Fo,Os="__reactContainer$"+Fo,qx="__reactEvents$"+Fo,UC="__reactListeners$"+Fo,KC="__reactHandles$"+Fo;function vl(i){var c=i[ds];if(c)return c;for(var h=i.parentNode;h;){if(c=h[Os]||h[ds]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(i=Zy(i);i!==null;){if(h=i[ds])return h;i=Zy(i)}return c}i=h,h=i.parentNode}return null}function ld(i){return i=i[ds]||i[Os],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Lo(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(a(33))}function ah(i){return i[id]||null}var Wx=[],Po=-1;function Ci(i){return{current:i}}function ln(i){0>Po||(i.current=Wx[Po],Wx[Po]=null,Po--)}function nn(i,c){Po++,Wx[Po]=i.current,i.current=c}var Si={},pa=Ci(Si),Va=Ci(!1),bl=Si;function Io(i,c){var h=i.type.contextTypes;if(!h)return Si;var v=i.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===c)return v.__reactInternalMemoizedMaskedChildContext;var k={},A;for(A in h)k[A]=c[A];return v&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=c,i.__reactInternalMemoizedMaskedChildContext=k),k}function Ua(i){return i=i.childContextTypes,i!=null}function rh(){ln(Va),ln(pa)}function ev(i,c,h){if(pa.current!==Si)throw Error(a(168));nn(pa,c),nn(Va,h)}function tv(i,c,h){var v=i.stateNode;if(c=c.childContextTypes,typeof v.getChildContext!="function")return h;v=v.getChildContext();for(var k in v)if(!(k in c))throw Error(a(108,ue(i)||"Unknown",k));return xe({},h,v)}function sh(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Si,bl=pa.current,nn(pa,i),nn(Va,Va.current),!0}function nv(i,c,h){var v=i.stateNode;if(!v)throw Error(a(169));h?(i=tv(i,c,bl),v.__reactInternalMemoizedMergedChildContext=i,ln(Va),ln(pa),nn(pa,i)):ln(Va),nn(Va,h)}var Ms=null,ih=!1,Xx=!1;function av(i){Ms===null?Ms=[i]:Ms.push(i)}function zC(i){ih=!0,av(i)}function _i(){if(!Xx&&Ms!==null){Xx=!0;var i=0,c=Kt;try{var h=Ms;for(Kt=1;i<h.length;i++){var v=h[i];do v=v(!0);while(v!==null)}Ms=null,ih=!1}catch(k){throw Ms!==null&&(Ms=Ms.slice(i+1)),Pe(Qt,_i),k}finally{Kt=c,Xx=!1}}return null}var Oo=[],Mo=0,lh=null,oh=0,jr=[],wr=0,Nl=null,Rs=1,Bs="";function jl(i,c){Oo[Mo++]=oh,Oo[Mo++]=lh,lh=i,oh=c}function rv(i,c,h){jr[wr++]=Rs,jr[wr++]=Bs,jr[wr++]=Nl,Nl=i;var v=Rs;i=Bs;var k=32-_n(v)-1;v&=~(1<<k),h+=1;var A=32-_n(c)+k;if(30<A){var U=k-k%5;A=(v&(1<<U)-1).toString(32),v>>=U,k-=U,Rs=1<<32-_n(c)+k|h<<k|v,Bs=A+i}else Rs=1<<A|h<<k|v,Bs=i}function Qx(i){i.return!==null&&(jl(i,1),rv(i,1,0))}function Yx(i){for(;i===lh;)lh=Oo[--Mo],Oo[Mo]=null,oh=Oo[--Mo],Oo[Mo]=null;for(;i===Nl;)Nl=jr[--wr],jr[wr]=null,Bs=jr[--wr],jr[wr]=null,Rs=jr[--wr],jr[wr]=null}var lr=null,or=null,mn=!1,zr=null;function sv(i,c){var h=Sr(5,null,null,0);h.elementType="DELETED",h.stateNode=c,h.return=i,c=i.deletions,c===null?(i.deletions=[h],i.flags|=16):c.push(h)}function iv(i,c){switch(i.tag){case 5:var h=i.type;return c=c.nodeType!==1||h.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(i.stateNode=c,lr=i,or=Ti(c.firstChild),!0):!1;case 6:return c=i.pendingProps===""||c.nodeType!==3?null:c,c!==null?(i.stateNode=c,lr=i,or=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(h=Nl!==null?{id:Rs,overflow:Bs}:null,i.memoizedState={dehydrated:c,treeContext:h,retryLane:1073741824},h=Sr(18,null,null,0),h.stateNode=c,h.return=i,i.child=h,lr=i,or=null,!0):!1;default:return!1}}function Jx(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Zx(i){if(mn){var c=or;if(c){var h=c;if(!iv(i,c)){if(Jx(i))throw Error(a(418));c=Ti(h.nextSibling);var v=lr;c&&iv(i,c)?sv(v,h):(i.flags=i.flags&-4097|2,mn=!1,lr=i)}}else{if(Jx(i))throw Error(a(418));i.flags=i.flags&-4097|2,mn=!1,lr=i}}}function lv(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;lr=i}function ch(i){if(i!==lr)return!1;if(!mn)return lv(i),mn=!0,!1;var c;if((c=i.tag!==3)&&!(c=i.tag!==5)&&(c=i.type,c=c!=="head"&&c!=="body"&&!zx(i.type,i.memoizedProps)),c&&(c=or)){if(Jx(i))throw ov(),Error(a(418));for(;c;)sv(i,c),c=Ti(c.nextSibling)}if(lv(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));e:{for(i=i.nextSibling,c=0;i;){if(i.nodeType===8){var h=i.data;if(h==="/$"){if(c===0){or=Ti(i.nextSibling);break e}c--}else h!=="$"&&h!=="$!"&&h!=="$?"||c++}i=i.nextSibling}or=null}}else or=lr?Ti(i.stateNode.nextSibling):null;return!0}function ov(){for(var i=or;i;)i=Ti(i.nextSibling)}function Ro(){or=lr=null,mn=!1}function em(i){zr===null?zr=[i]:zr.push(i)}var $C=w.ReactCurrentBatchConfig;function od(i,c,h){if(i=h.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(a(309));var v=h.stateNode}if(!v)throw Error(a(147,i));var k=v,A=""+i;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===A?c.ref:(c=function(U){var oe=k.refs;U===null?delete oe[A]:oe[A]=U},c._stringRef=A,c)}if(typeof i!="string")throw Error(a(284));if(!h._owner)throw Error(a(290,i))}return i}function dh(i,c){throw i=Object.prototype.toString.call(c),Error(a(31,i==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":i))}function cv(i){var c=i._init;return c(i._payload)}function dv(i){function c(pe,me){if(i){var ge=pe.deletions;ge===null?(pe.deletions=[me],pe.flags|=16):ge.push(me)}}function h(pe,me){if(!i)return null;for(;me!==null;)c(pe,me),me=me.sibling;return null}function v(pe,me){for(pe=new Map;me!==null;)me.key!==null?pe.set(me.key,me):pe.set(me.index,me),me=me.sibling;return pe}function k(pe,me){return pe=Oi(pe,me),pe.index=0,pe.sibling=null,pe}function A(pe,me,ge){return pe.index=ge,i?(ge=pe.alternate,ge!==null?(ge=ge.index,ge<me?(pe.flags|=2,me):ge):(pe.flags|=2,me)):(pe.flags|=1048576,me)}function U(pe){return i&&pe.alternate===null&&(pe.flags|=2),pe}function oe(pe,me,ge,He){return me===null||me.tag!==6?(me=$m(ge,pe.mode,He),me.return=pe,me):(me=k(me,ge),me.return=pe,me)}function de(pe,me,ge,He){var et=ge.type;return et===S?Ae(pe,me,ge.props.children,He,ge.key):me!==null&&(me.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===fe&&cv(et)===me.type)?(He=k(me,ge.props),He.ref=od(pe,me,ge),He.return=pe,He):(He=Ph(ge.type,ge.key,ge.props,null,pe.mode,He),He.ref=od(pe,me,ge),He.return=pe,He)}function je(pe,me,ge,He){return me===null||me.tag!==4||me.stateNode.containerInfo!==ge.containerInfo||me.stateNode.implementation!==ge.implementation?(me=Gm(ge,pe.mode,He),me.return=pe,me):(me=k(me,ge.children||[]),me.return=pe,me)}function Ae(pe,me,ge,He,et){return me===null||me.tag!==7?(me=Dl(ge,pe.mode,He,et),me.return=pe,me):(me=k(me,ge),me.return=pe,me)}function Ie(pe,me,ge){if(typeof me=="string"&&me!==""||typeof me=="number")return me=$m(""+me,pe.mode,ge),me.return=pe,me;if(typeof me=="object"&&me!==null){switch(me.$$typeof){case E:return ge=Ph(me.type,me.key,me.props,null,pe.mode,ge),ge.ref=od(pe,null,me),ge.return=pe,ge;case C:return me=Gm(me,pe.mode,ge),me.return=pe,me;case fe:var He=me._init;return Ie(pe,He(me._payload),ge)}if(xn(me)||W(me))return me=Dl(me,pe.mode,ge,null),me.return=pe,me;dh(pe,me)}return null}function De(pe,me,ge,He){var et=me!==null?me.key:null;if(typeof ge=="string"&&ge!==""||typeof ge=="number")return et!==null?null:oe(pe,me,""+ge,He);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case E:return ge.key===et?de(pe,me,ge,He):null;case C:return ge.key===et?je(pe,me,ge,He):null;case fe:return et=ge._init,De(pe,me,et(ge._payload),He)}if(xn(ge)||W(ge))return et!==null?null:Ae(pe,me,ge,He,null);dh(pe,ge)}return null}function Ge(pe,me,ge,He,et){if(typeof He=="string"&&He!==""||typeof He=="number")return pe=pe.get(ge)||null,oe(me,pe,""+He,et);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case E:return pe=pe.get(He.key===null?ge:He.key)||null,de(me,pe,He,et);case C:return pe=pe.get(He.key===null?ge:He.key)||null,je(me,pe,He,et);case fe:var it=He._init;return Ge(pe,me,ge,it(He._payload),et)}if(xn(He)||W(He))return pe=pe.get(ge)||null,Ae(me,pe,He,et,null);dh(me,He)}return null}function Ye(pe,me,ge,He){for(var et=null,it=null,lt=me,ht=me=0,Zn=null;lt!==null&&ht<ge.length;ht++){lt.index>ht?(Zn=lt,lt=null):Zn=lt.sibling;var It=De(pe,lt,ge[ht],He);if(It===null){lt===null&&(lt=Zn);break}i&&lt&&It.alternate===null&&c(pe,lt),me=A(It,me,ht),it===null?et=It:it.sibling=It,it=It,lt=Zn}if(ht===ge.length)return h(pe,lt),mn&&jl(pe,ht),et;if(lt===null){for(;ht<ge.length;ht++)lt=Ie(pe,ge[ht],He),lt!==null&&(me=A(lt,me,ht),it===null?et=lt:it.sibling=lt,it=lt);return mn&&jl(pe,ht),et}for(lt=v(pe,lt);ht<ge.length;ht++)Zn=Ge(lt,pe,ht,ge[ht],He),Zn!==null&&(i&&Zn.alternate!==null&&lt.delete(Zn.key===null?ht:Zn.key),me=A(Zn,me,ht),it===null?et=Zn:it.sibling=Zn,it=Zn);return i&&lt.forEach(function(Mi){return c(pe,Mi)}),mn&&jl(pe,ht),et}function Je(pe,me,ge,He){var et=W(ge);if(typeof et!="function")throw Error(a(150));if(ge=et.call(ge),ge==null)throw Error(a(151));for(var it=et=null,lt=me,ht=me=0,Zn=null,It=ge.next();lt!==null&&!It.done;ht++,It=ge.next()){lt.index>ht?(Zn=lt,lt=null):Zn=lt.sibling;var Mi=De(pe,lt,It.value,He);if(Mi===null){lt===null&&(lt=Zn);break}i&&lt&&Mi.alternate===null&&c(pe,lt),me=A(Mi,me,ht),it===null?et=Mi:it.sibling=Mi,it=Mi,lt=Zn}if(It.done)return h(pe,lt),mn&&jl(pe,ht),et;if(lt===null){for(;!It.done;ht++,It=ge.next())It=Ie(pe,It.value,He),It!==null&&(me=A(It,me,ht),it===null?et=It:it.sibling=It,it=It);return mn&&jl(pe,ht),et}for(lt=v(pe,lt);!It.done;ht++,It=ge.next())It=Ge(lt,pe,ht,It.value,He),It!==null&&(i&&It.alternate!==null&&lt.delete(It.key===null?ht:It.key),me=A(It,me,ht),it===null?et=It:it.sibling=It,it=It);return i&&lt.forEach(function(k4){return c(pe,k4)}),mn&&jl(pe,ht),et}function En(pe,me,ge,He){if(typeof ge=="object"&&ge!==null&&ge.type===S&&ge.key===null&&(ge=ge.props.children),typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case E:e:{for(var et=ge.key,it=me;it!==null;){if(it.key===et){if(et=ge.type,et===S){if(it.tag===7){h(pe,it.sibling),me=k(it,ge.props.children),me.return=pe,pe=me;break e}}else if(it.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===fe&&cv(et)===it.type){h(pe,it.sibling),me=k(it,ge.props),me.ref=od(pe,it,ge),me.return=pe,pe=me;break e}h(pe,it);break}else c(pe,it);it=it.sibling}ge.type===S?(me=Dl(ge.props.children,pe.mode,He,ge.key),me.return=pe,pe=me):(He=Ph(ge.type,ge.key,ge.props,null,pe.mode,He),He.ref=od(pe,me,ge),He.return=pe,pe=He)}return U(pe);case C:e:{for(it=ge.key;me!==null;){if(me.key===it)if(me.tag===4&&me.stateNode.containerInfo===ge.containerInfo&&me.stateNode.implementation===ge.implementation){h(pe,me.sibling),me=k(me,ge.children||[]),me.return=pe,pe=me;break e}else{h(pe,me);break}else c(pe,me);me=me.sibling}me=Gm(ge,pe.mode,He),me.return=pe,pe=me}return U(pe);case fe:return it=ge._init,En(pe,me,it(ge._payload),He)}if(xn(ge))return Ye(pe,me,ge,He);if(W(ge))return Je(pe,me,ge,He);dh(pe,ge)}return typeof ge=="string"&&ge!==""||typeof ge=="number"?(ge=""+ge,me!==null&&me.tag===6?(h(pe,me.sibling),me=k(me,ge),me.return=pe,pe=me):(h(pe,me),me=$m(ge,pe.mode,He),me.return=pe,pe=me),U(pe)):h(pe,me)}return En}var Bo=dv(!0),uv=dv(!1),uh=Ci(null),hh=null,Ho=null,tm=null;function nm(){tm=Ho=hh=null}function am(i){var c=uh.current;ln(uh),i._currentValue=c}function rm(i,c,h){for(;i!==null;){var v=i.alternate;if((i.childLanes&c)!==c?(i.childLanes|=c,v!==null&&(v.childLanes|=c)):v!==null&&(v.childLanes&c)!==c&&(v.childLanes|=c),i===h)break;i=i.return}}function Vo(i,c){hh=i,tm=Ho=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&c)!==0&&(Ka=!0),i.firstContext=null)}function kr(i){var c=i._currentValue;if(tm!==i)if(i={context:i,memoizedValue:c,next:null},Ho===null){if(hh===null)throw Error(a(308));Ho=i,hh.dependencies={lanes:0,firstContext:i}}else Ho=Ho.next=i;return c}var wl=null;function sm(i){wl===null?wl=[i]:wl.push(i)}function hv(i,c,h,v){var k=c.interleaved;return k===null?(h.next=h,sm(c)):(h.next=k.next,k.next=h),c.interleaved=h,Hs(i,v)}function Hs(i,c){i.lanes|=c;var h=i.alternate;for(h!==null&&(h.lanes|=c),h=i,i=i.return;i!==null;)i.childLanes|=c,h=i.alternate,h!==null&&(h.childLanes|=c),h=i,i=i.return;return h.tag===3?h.stateNode:null}var Ei=!1;function im(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xv(i,c){i=i.updateQueue,c.updateQueue===i&&(c.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Vs(i,c){return{eventTime:i,lane:c,tag:0,payload:null,callback:null,next:null}}function Di(i,c,h){var v=i.updateQueue;if(v===null)return null;if(v=v.shared,(Ft&2)!==0){var k=v.pending;return k===null?c.next=c:(c.next=k.next,k.next=c),v.pending=c,Hs(i,h)}return k=v.interleaved,k===null?(c.next=c,sm(v)):(c.next=k.next,k.next=c),v.interleaved=c,Hs(i,h)}function xh(i,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194240)!==0)){var v=c.lanes;v&=i.pendingLanes,h|=v,c.lanes=h,bx(i,h)}}function mv(i,c){var h=i.updateQueue,v=i.alternate;if(v!==null&&(v=v.updateQueue,h===v)){var k=null,A=null;if(h=h.firstBaseUpdate,h!==null){do{var U={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};A===null?k=A=U:A=A.next=U,h=h.next}while(h!==null);A===null?k=A=c:A=A.next=c}else k=A=c;h={baseState:v.baseState,firstBaseUpdate:k,lastBaseUpdate:A,shared:v.shared,effects:v.effects},i.updateQueue=h;return}i=h.lastBaseUpdate,i===null?h.firstBaseUpdate=c:i.next=c,h.lastBaseUpdate=c}function mh(i,c,h,v){var k=i.updateQueue;Ei=!1;var A=k.firstBaseUpdate,U=k.lastBaseUpdate,oe=k.shared.pending;if(oe!==null){k.shared.pending=null;var de=oe,je=de.next;de.next=null,U===null?A=je:U.next=je,U=de;var Ae=i.alternate;Ae!==null&&(Ae=Ae.updateQueue,oe=Ae.lastBaseUpdate,oe!==U&&(oe===null?Ae.firstBaseUpdate=je:oe.next=je,Ae.lastBaseUpdate=de))}if(A!==null){var Ie=k.baseState;U=0,Ae=je=de=null,oe=A;do{var De=oe.lane,Ge=oe.eventTime;if((v&De)===De){Ae!==null&&(Ae=Ae.next={eventTime:Ge,lane:0,tag:oe.tag,payload:oe.payload,callback:oe.callback,next:null});e:{var Ye=i,Je=oe;switch(De=c,Ge=h,Je.tag){case 1:if(Ye=Je.payload,typeof Ye=="function"){Ie=Ye.call(Ge,Ie,De);break e}Ie=Ye;break e;case 3:Ye.flags=Ye.flags&-65537|128;case 0:if(Ye=Je.payload,De=typeof Ye=="function"?Ye.call(Ge,Ie,De):Ye,De==null)break e;Ie=xe({},Ie,De);break e;case 2:Ei=!0}}oe.callback!==null&&oe.lane!==0&&(i.flags|=64,De=k.effects,De===null?k.effects=[oe]:De.push(oe))}else Ge={eventTime:Ge,lane:De,tag:oe.tag,payload:oe.payload,callback:oe.callback,next:null},Ae===null?(je=Ae=Ge,de=Ie):Ae=Ae.next=Ge,U|=De;if(oe=oe.next,oe===null){if(oe=k.shared.pending,oe===null)break;De=oe,oe=De.next,De.next=null,k.lastBaseUpdate=De,k.shared.pending=null}}while(!0);if(Ae===null&&(de=Ie),k.baseState=de,k.firstBaseUpdate=je,k.lastBaseUpdate=Ae,c=k.shared.interleaved,c!==null){k=c;do U|=k.lane,k=k.next;while(k!==c)}else A===null&&(k.shared.lanes=0);Cl|=U,i.lanes=U,i.memoizedState=Ie}}function fv(i,c,h){if(i=c.effects,c.effects=null,i!==null)for(c=0;c<i.length;c++){var v=i[c],k=v.callback;if(k!==null){if(v.callback=null,v=h,typeof k!="function")throw Error(a(191,k));k.call(v)}}}var cd={},us=Ci(cd),dd=Ci(cd),ud=Ci(cd);function kl(i){if(i===cd)throw Error(a(174));return i}function lm(i,c){switch(nn(ud,c),nn(dd,i),nn(us,cd),i=c.nodeType,i){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Ht(null,"");break;default:i=i===8?c.parentNode:c,c=i.namespaceURI||null,i=i.tagName,c=Ht(c,i)}ln(us),nn(us,c)}function Uo(){ln(us),ln(dd),ln(ud)}function pv(i){kl(ud.current);var c=kl(us.current),h=Ht(c,i.type);c!==h&&(nn(dd,i),nn(us,h))}function om(i){dd.current===i&&(ln(us),ln(dd))}var fn=Ci(0);function fh(i){for(var c=i;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var cm=[];function dm(){for(var i=0;i<cm.length;i++)cm[i]._workInProgressVersionPrimary=null;cm.length=0}var ph=w.ReactCurrentDispatcher,um=w.ReactCurrentBatchConfig,Tl=0,pn=null,Hn=null,Yn=null,gh=!1,hd=!1,xd=0,GC=0;function ga(){throw Error(a(321))}function hm(i,c){if(c===null)return!1;for(var h=0;h<c.length&&h<i.length;h++)if(!Kr(i[h],c[h]))return!1;return!0}function xm(i,c,h,v,k,A){if(Tl=A,pn=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,ph.current=i===null||i.memoizedState===null?QC:YC,i=h(v,k),hd){A=0;do{if(hd=!1,xd=0,25<=A)throw Error(a(301));A+=1,Yn=Hn=null,c.updateQueue=null,ph.current=JC,i=h(v,k)}while(hd)}if(ph.current=bh,c=Hn!==null&&Hn.next!==null,Tl=0,Yn=Hn=pn=null,gh=!1,c)throw Error(a(300));return i}function mm(){var i=xd!==0;return xd=0,i}function hs(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yn===null?pn.memoizedState=Yn=i:Yn=Yn.next=i,Yn}function Tr(){if(Hn===null){var i=pn.alternate;i=i!==null?i.memoizedState:null}else i=Hn.next;var c=Yn===null?pn.memoizedState:Yn.next;if(c!==null)Yn=c,Hn=i;else{if(i===null)throw Error(a(310));Hn=i,i={memoizedState:Hn.memoizedState,baseState:Hn.baseState,baseQueue:Hn.baseQueue,queue:Hn.queue,next:null},Yn===null?pn.memoizedState=Yn=i:Yn=Yn.next=i}return Yn}function md(i,c){return typeof c=="function"?c(i):c}function fm(i){var c=Tr(),h=c.queue;if(h===null)throw Error(a(311));h.lastRenderedReducer=i;var v=Hn,k=v.baseQueue,A=h.pending;if(A!==null){if(k!==null){var U=k.next;k.next=A.next,A.next=U}v.baseQueue=k=A,h.pending=null}if(k!==null){A=k.next,v=v.baseState;var oe=U=null,de=null,je=A;do{var Ae=je.lane;if((Tl&Ae)===Ae)de!==null&&(de=de.next={lane:0,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null}),v=je.hasEagerState?je.eagerState:i(v,je.action);else{var Ie={lane:Ae,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null};de===null?(oe=de=Ie,U=v):de=de.next=Ie,pn.lanes|=Ae,Cl|=Ae}je=je.next}while(je!==null&&je!==A);de===null?U=v:de.next=oe,Kr(v,c.memoizedState)||(Ka=!0),c.memoizedState=v,c.baseState=U,c.baseQueue=de,h.lastRenderedState=v}if(i=h.interleaved,i!==null){k=i;do A=k.lane,pn.lanes|=A,Cl|=A,k=k.next;while(k!==i)}else k===null&&(h.lanes=0);return[c.memoizedState,h.dispatch]}function pm(i){var c=Tr(),h=c.queue;if(h===null)throw Error(a(311));h.lastRenderedReducer=i;var v=h.dispatch,k=h.pending,A=c.memoizedState;if(k!==null){h.pending=null;var U=k=k.next;do A=i(A,U.action),U=U.next;while(U!==k);Kr(A,c.memoizedState)||(Ka=!0),c.memoizedState=A,c.baseQueue===null&&(c.baseState=A),h.lastRenderedState=A}return[A,v]}function gv(){}function yv(i,c){var h=pn,v=Tr(),k=c(),A=!Kr(v.memoizedState,k);if(A&&(v.memoizedState=k,Ka=!0),v=v.queue,gm(Nv.bind(null,h,v,i),[i]),v.getSnapshot!==c||A||Yn!==null&&Yn.memoizedState.tag&1){if(h.flags|=2048,fd(9,bv.bind(null,h,v,k,c),void 0,null),Jn===null)throw Error(a(349));(Tl&30)!==0||vv(h,c,k)}return k}function vv(i,c,h){i.flags|=16384,i={getSnapshot:c,value:h},c=pn.updateQueue,c===null?(c={lastEffect:null,stores:null},pn.updateQueue=c,c.stores=[i]):(h=c.stores,h===null?c.stores=[i]:h.push(i))}function bv(i,c,h,v){c.value=h,c.getSnapshot=v,jv(c)&&wv(i)}function Nv(i,c,h){return h(function(){jv(c)&&wv(i)})}function jv(i){var c=i.getSnapshot;i=i.value;try{var h=c();return!Kr(i,h)}catch{return!0}}function wv(i){var c=Hs(i,1);c!==null&&Wr(c,i,1,-1)}function kv(i){var c=hs();return typeof i=="function"&&(i=i()),c.memoizedState=c.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:md,lastRenderedState:i},c.queue=i,i=i.dispatch=XC.bind(null,pn,i),[c.memoizedState,i]}function fd(i,c,h,v){return i={tag:i,create:c,destroy:h,deps:v,next:null},c=pn.updateQueue,c===null?(c={lastEffect:null,stores:null},pn.updateQueue=c,c.lastEffect=i.next=i):(h=c.lastEffect,h===null?c.lastEffect=i.next=i:(v=h.next,h.next=i,i.next=v,c.lastEffect=i)),i}function Tv(){return Tr().memoizedState}function yh(i,c,h,v){var k=hs();pn.flags|=i,k.memoizedState=fd(1|c,h,void 0,v===void 0?null:v)}function vh(i,c,h,v){var k=Tr();v=v===void 0?null:v;var A=void 0;if(Hn!==null){var U=Hn.memoizedState;if(A=U.destroy,v!==null&&hm(v,U.deps)){k.memoizedState=fd(c,h,A,v);return}}pn.flags|=i,k.memoizedState=fd(1|c,h,A,v)}function Cv(i,c){return yh(8390656,8,i,c)}function gm(i,c){return vh(2048,8,i,c)}function Sv(i,c){return vh(4,2,i,c)}function _v(i,c){return vh(4,4,i,c)}function Ev(i,c){if(typeof c=="function")return i=i(),c(i),function(){c(null)};if(c!=null)return i=i(),c.current=i,function(){c.current=null}}function Dv(i,c,h){return h=h!=null?h.concat([i]):null,vh(4,4,Ev.bind(null,c,i),h)}function ym(){}function Av(i,c){var h=Tr();c=c===void 0?null:c;var v=h.memoizedState;return v!==null&&c!==null&&hm(c,v[1])?v[0]:(h.memoizedState=[i,c],i)}function Fv(i,c){var h=Tr();c=c===void 0?null:c;var v=h.memoizedState;return v!==null&&c!==null&&hm(c,v[1])?v[0]:(i=i(),h.memoizedState=[i,c],i)}function Lv(i,c,h){return(Tl&21)===0?(i.baseState&&(i.baseState=!1,Ka=!0),i.memoizedState=h):(Kr(h,c)||(h=cy(),pn.lanes|=h,Cl|=h,i.baseState=!0),c)}function qC(i,c){var h=Kt;Kt=h!==0&&4>h?h:4,i(!0);var v=um.transition;um.transition={};try{i(!1),c()}finally{Kt=h,um.transition=v}}function Pv(){return Tr().memoizedState}function WC(i,c,h){var v=Pi(i);if(h={lane:v,action:h,hasEagerState:!1,eagerState:null,next:null},Iv(i))Ov(c,h);else if(h=hv(i,c,h,v),h!==null){var k=Fa();Wr(h,i,v,k),Mv(h,c,v)}}function XC(i,c,h){var v=Pi(i),k={lane:v,action:h,hasEagerState:!1,eagerState:null,next:null};if(Iv(i))Ov(c,k);else{var A=i.alternate;if(i.lanes===0&&(A===null||A.lanes===0)&&(A=c.lastRenderedReducer,A!==null))try{var U=c.lastRenderedState,oe=A(U,h);if(k.hasEagerState=!0,k.eagerState=oe,Kr(oe,U)){var de=c.interleaved;de===null?(k.next=k,sm(c)):(k.next=de.next,de.next=k),c.interleaved=k;return}}catch{}finally{}h=hv(i,c,k,v),h!==null&&(k=Fa(),Wr(h,i,v,k),Mv(h,c,v))}}function Iv(i){var c=i.alternate;return i===pn||c!==null&&c===pn}function Ov(i,c){hd=gh=!0;var h=i.pending;h===null?c.next=c:(c.next=h.next,h.next=c),i.pending=c}function Mv(i,c,h){if((h&4194240)!==0){var v=c.lanes;v&=i.pendingLanes,h|=v,c.lanes=h,bx(i,h)}}var bh={readContext:kr,useCallback:ga,useContext:ga,useEffect:ga,useImperativeHandle:ga,useInsertionEffect:ga,useLayoutEffect:ga,useMemo:ga,useReducer:ga,useRef:ga,useState:ga,useDebugValue:ga,useDeferredValue:ga,useTransition:ga,useMutableSource:ga,useSyncExternalStore:ga,useId:ga,unstable_isNewReconciler:!1},QC={readContext:kr,useCallback:function(i,c){return hs().memoizedState=[i,c===void 0?null:c],i},useContext:kr,useEffect:Cv,useImperativeHandle:function(i,c,h){return h=h!=null?h.concat([i]):null,yh(4194308,4,Ev.bind(null,c,i),h)},useLayoutEffect:function(i,c){return yh(4194308,4,i,c)},useInsertionEffect:function(i,c){return yh(4,2,i,c)},useMemo:function(i,c){var h=hs();return c=c===void 0?null:c,i=i(),h.memoizedState=[i,c],i},useReducer:function(i,c,h){var v=hs();return c=h!==void 0?h(c):c,v.memoizedState=v.baseState=c,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:c},v.queue=i,i=i.dispatch=WC.bind(null,pn,i),[v.memoizedState,i]},useRef:function(i){var c=hs();return i={current:i},c.memoizedState=i},useState:kv,useDebugValue:ym,useDeferredValue:function(i){return hs().memoizedState=i},useTransition:function(){var i=kv(!1),c=i[0];return i=qC.bind(null,i[1]),hs().memoizedState=i,[c,i]},useMutableSource:function(){},useSyncExternalStore:function(i,c,h){var v=pn,k=hs();if(mn){if(h===void 0)throw Error(a(407));h=h()}else{if(h=c(),Jn===null)throw Error(a(349));(Tl&30)!==0||vv(v,c,h)}k.memoizedState=h;var A={value:h,getSnapshot:c};return k.queue=A,Cv(Nv.bind(null,v,A,i),[i]),v.flags|=2048,fd(9,bv.bind(null,v,A,h,c),void 0,null),h},useId:function(){var i=hs(),c=Jn.identifierPrefix;if(mn){var h=Bs,v=Rs;h=(v&~(1<<32-_n(v)-1)).toString(32)+h,c=":"+c+"R"+h,h=xd++,0<h&&(c+="H"+h.toString(32)),c+=":"}else h=GC++,c=":"+c+"r"+h.toString(32)+":";return i.memoizedState=c},unstable_isNewReconciler:!1},YC={readContext:kr,useCallback:Av,useContext:kr,useEffect:gm,useImperativeHandle:Dv,useInsertionEffect:Sv,useLayoutEffect:_v,useMemo:Fv,useReducer:fm,useRef:Tv,useState:function(){return fm(md)},useDebugValue:ym,useDeferredValue:function(i){var c=Tr();return Lv(c,Hn.memoizedState,i)},useTransition:function(){var i=fm(md)[0],c=Tr().memoizedState;return[i,c]},useMutableSource:gv,useSyncExternalStore:yv,useId:Pv,unstable_isNewReconciler:!1},JC={readContext:kr,useCallback:Av,useContext:kr,useEffect:gm,useImperativeHandle:Dv,useInsertionEffect:Sv,useLayoutEffect:_v,useMemo:Fv,useReducer:pm,useRef:Tv,useState:function(){return pm(md)},useDebugValue:ym,useDeferredValue:function(i){var c=Tr();return Hn===null?c.memoizedState=i:Lv(c,Hn.memoizedState,i)},useTransition:function(){var i=pm(md)[0],c=Tr().memoizedState;return[i,c]},useMutableSource:gv,useSyncExternalStore:yv,useId:Pv,unstable_isNewReconciler:!1};function $r(i,c){if(i&&i.defaultProps){c=xe({},c),i=i.defaultProps;for(var h in i)c[h]===void 0&&(c[h]=i[h]);return c}return c}function vm(i,c,h,v){c=i.memoizedState,h=h(v,c),h=h==null?c:xe({},c,h),i.memoizedState=h,i.lanes===0&&(i.updateQueue.baseState=h)}var Nh={isMounted:function(i){return(i=i._reactInternals)?se(i)===i:!1},enqueueSetState:function(i,c,h){i=i._reactInternals;var v=Fa(),k=Pi(i),A=Vs(v,k);A.payload=c,h!=null&&(A.callback=h),c=Di(i,A,k),c!==null&&(Wr(c,i,k,v),xh(c,i,k))},enqueueReplaceState:function(i,c,h){i=i._reactInternals;var v=Fa(),k=Pi(i),A=Vs(v,k);A.tag=1,A.payload=c,h!=null&&(A.callback=h),c=Di(i,A,k),c!==null&&(Wr(c,i,k,v),xh(c,i,k))},enqueueForceUpdate:function(i,c){i=i._reactInternals;var h=Fa(),v=Pi(i),k=Vs(h,v);k.tag=2,c!=null&&(k.callback=c),c=Di(i,k,v),c!==null&&(Wr(c,i,v,h),xh(c,i,v))}};function Rv(i,c,h,v,k,A,U){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(v,A,U):c.prototype&&c.prototype.isPureReactComponent?!td(h,v)||!td(k,A):!0}function Bv(i,c,h){var v=!1,k=Si,A=c.contextType;return typeof A=="object"&&A!==null?A=kr(A):(k=Ua(c)?bl:pa.current,v=c.contextTypes,A=(v=v!=null)?Io(i,k):Si),c=new c(h,A),i.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Nh,i.stateNode=c,c._reactInternals=i,v&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=k,i.__reactInternalMemoizedMaskedChildContext=A),c}function Hv(i,c,h,v){i=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,v),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,v),c.state!==i&&Nh.enqueueReplaceState(c,c.state,null)}function bm(i,c,h,v){var k=i.stateNode;k.props=h,k.state=i.memoizedState,k.refs={},im(i);var A=c.contextType;typeof A=="object"&&A!==null?k.context=kr(A):(A=Ua(c)?bl:pa.current,k.context=Io(i,A)),k.state=i.memoizedState,A=c.getDerivedStateFromProps,typeof A=="function"&&(vm(i,c,A,h),k.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(c=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),c!==k.state&&Nh.enqueueReplaceState(k,k.state,null),mh(i,h,k,v),k.state=i.memoizedState),typeof k.componentDidMount=="function"&&(i.flags|=4194308)}function Ko(i,c){try{var h="",v=c;do h+=R(v),v=v.return;while(v);var k=h}catch(A){k=`
Error generating stack: `+A.message+`
`+A.stack}return{value:i,source:c,stack:k,digest:null}}function Nm(i,c,h){return{value:i,source:null,stack:h??null,digest:c??null}}function jm(i,c){try{console.error(c.value)}catch(h){setTimeout(function(){throw h})}}var ZC=typeof WeakMap=="function"?WeakMap:Map;function Vv(i,c,h){h=Vs(-1,h),h.tag=3,h.payload={element:null};var v=c.value;return h.callback=function(){_h||(_h=!0,Mm=v),jm(i,c)},h}function Uv(i,c,h){h=Vs(-1,h),h.tag=3;var v=i.type.getDerivedStateFromError;if(typeof v=="function"){var k=c.value;h.payload=function(){return v(k)},h.callback=function(){jm(i,c)}}var A=i.stateNode;return A!==null&&typeof A.componentDidCatch=="function"&&(h.callback=function(){jm(i,c),typeof v!="function"&&(Fi===null?Fi=new Set([this]):Fi.add(this));var U=c.stack;this.componentDidCatch(c.value,{componentStack:U!==null?U:""})}),h}function Kv(i,c,h){var v=i.pingCache;if(v===null){v=i.pingCache=new ZC;var k=new Set;v.set(c,k)}else k=v.get(c),k===void 0&&(k=new Set,v.set(c,k));k.has(h)||(k.add(h),i=x4.bind(null,i,c,h),c.then(i,i))}function zv(i){do{var c;if((c=i.tag===13)&&(c=i.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return i;i=i.return}while(i!==null);return null}function $v(i,c,h,v,k){return(i.mode&1)===0?(i===c?i.flags|=65536:(i.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(c=Vs(-1,1),c.tag=2,Di(h,c,1))),h.lanes|=1),i):(i.flags|=65536,i.lanes=k,i)}var e4=w.ReactCurrentOwner,Ka=!1;function Aa(i,c,h,v){c.child=i===null?uv(c,null,h,v):Bo(c,i.child,h,v)}function Gv(i,c,h,v,k){h=h.render;var A=c.ref;return Vo(c,k),v=xm(i,c,h,v,A,k),h=mm(),i!==null&&!Ka?(c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~k,Us(i,c,k)):(mn&&h&&Qx(c),c.flags|=1,Aa(i,c,v,k),c.child)}function qv(i,c,h,v,k){if(i===null){var A=h.type;return typeof A=="function"&&!zm(A)&&A.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(c.tag=15,c.type=A,Wv(i,c,A,v,k)):(i=Ph(h.type,null,v,c,c.mode,k),i.ref=c.ref,i.return=c,c.child=i)}if(A=i.child,(i.lanes&k)===0){var U=A.memoizedProps;if(h=h.compare,h=h!==null?h:td,h(U,v)&&i.ref===c.ref)return Us(i,c,k)}return c.flags|=1,i=Oi(A,v),i.ref=c.ref,i.return=c,c.child=i}function Wv(i,c,h,v,k){if(i!==null){var A=i.memoizedProps;if(td(A,v)&&i.ref===c.ref)if(Ka=!1,c.pendingProps=v=A,(i.lanes&k)!==0)(i.flags&131072)!==0&&(Ka=!0);else return c.lanes=i.lanes,Us(i,c,k)}return wm(i,c,h,v,k)}function Xv(i,c,h){var v=c.pendingProps,k=v.children,A=i!==null?i.memoizedState:null;if(v.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},nn($o,cr),cr|=h;else{if((h&1073741824)===0)return i=A!==null?A.baseLanes|h:h,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:i,cachePool:null,transitions:null},c.updateQueue=null,nn($o,cr),cr|=i,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=A!==null?A.baseLanes:h,nn($o,cr),cr|=v}else A!==null?(v=A.baseLanes|h,c.memoizedState=null):v=h,nn($o,cr),cr|=v;return Aa(i,c,k,h),c.child}function Qv(i,c){var h=c.ref;(i===null&&h!==null||i!==null&&i.ref!==h)&&(c.flags|=512,c.flags|=2097152)}function wm(i,c,h,v,k){var A=Ua(h)?bl:pa.current;return A=Io(c,A),Vo(c,k),h=xm(i,c,h,v,A,k),v=mm(),i!==null&&!Ka?(c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~k,Us(i,c,k)):(mn&&v&&Qx(c),c.flags|=1,Aa(i,c,h,k),c.child)}function Yv(i,c,h,v,k){if(Ua(h)){var A=!0;sh(c)}else A=!1;if(Vo(c,k),c.stateNode===null)wh(i,c),Bv(c,h,v),bm(c,h,v,k),v=!0;else if(i===null){var U=c.stateNode,oe=c.memoizedProps;U.props=oe;var de=U.context,je=h.contextType;typeof je=="object"&&je!==null?je=kr(je):(je=Ua(h)?bl:pa.current,je=Io(c,je));var Ae=h.getDerivedStateFromProps,Ie=typeof Ae=="function"||typeof U.getSnapshotBeforeUpdate=="function";Ie||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(oe!==v||de!==je)&&Hv(c,U,v,je),Ei=!1;var De=c.memoizedState;U.state=De,mh(c,v,U,k),de=c.memoizedState,oe!==v||De!==de||Va.current||Ei?(typeof Ae=="function"&&(vm(c,h,Ae,v),de=c.memoizedState),(oe=Ei||Rv(c,h,oe,v,De,de,je))?(Ie||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount()),typeof U.componentDidMount=="function"&&(c.flags|=4194308)):(typeof U.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=v,c.memoizedState=de),U.props=v,U.state=de,U.context=je,v=oe):(typeof U.componentDidMount=="function"&&(c.flags|=4194308),v=!1)}else{U=c.stateNode,xv(i,c),oe=c.memoizedProps,je=c.type===c.elementType?oe:$r(c.type,oe),U.props=je,Ie=c.pendingProps,De=U.context,de=h.contextType,typeof de=="object"&&de!==null?de=kr(de):(de=Ua(h)?bl:pa.current,de=Io(c,de));var Ge=h.getDerivedStateFromProps;(Ae=typeof Ge=="function"||typeof U.getSnapshotBeforeUpdate=="function")||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(oe!==Ie||De!==de)&&Hv(c,U,v,de),Ei=!1,De=c.memoizedState,U.state=De,mh(c,v,U,k);var Ye=c.memoizedState;oe!==Ie||De!==Ye||Va.current||Ei?(typeof Ge=="function"&&(vm(c,h,Ge,v),Ye=c.memoizedState),(je=Ei||Rv(c,h,je,v,De,Ye,de)||!1)?(Ae||typeof U.UNSAFE_componentWillUpdate!="function"&&typeof U.componentWillUpdate!="function"||(typeof U.componentWillUpdate=="function"&&U.componentWillUpdate(v,Ye,de),typeof U.UNSAFE_componentWillUpdate=="function"&&U.UNSAFE_componentWillUpdate(v,Ye,de)),typeof U.componentDidUpdate=="function"&&(c.flags|=4),typeof U.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof U.componentDidUpdate!="function"||oe===i.memoizedProps&&De===i.memoizedState||(c.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||oe===i.memoizedProps&&De===i.memoizedState||(c.flags|=1024),c.memoizedProps=v,c.memoizedState=Ye),U.props=v,U.state=Ye,U.context=de,v=je):(typeof U.componentDidUpdate!="function"||oe===i.memoizedProps&&De===i.memoizedState||(c.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||oe===i.memoizedProps&&De===i.memoizedState||(c.flags|=1024),v=!1)}return km(i,c,h,v,A,k)}function km(i,c,h,v,k,A){Qv(i,c);var U=(c.flags&128)!==0;if(!v&&!U)return k&&nv(c,h,!1),Us(i,c,A);v=c.stateNode,e4.current=c;var oe=U&&typeof h.getDerivedStateFromError!="function"?null:v.render();return c.flags|=1,i!==null&&U?(c.child=Bo(c,i.child,null,A),c.child=Bo(c,null,oe,A)):Aa(i,c,oe,A),c.memoizedState=v.state,k&&nv(c,h,!0),c.child}function Jv(i){var c=i.stateNode;c.pendingContext?ev(i,c.pendingContext,c.pendingContext!==c.context):c.context&&ev(i,c.context,!1),lm(i,c.containerInfo)}function Zv(i,c,h,v,k){return Ro(),em(k),c.flags|=256,Aa(i,c,h,v),c.child}var Tm={dehydrated:null,treeContext:null,retryLane:0};function Cm(i){return{baseLanes:i,cachePool:null,transitions:null}}function e1(i,c,h){var v=c.pendingProps,k=fn.current,A=!1,U=(c.flags&128)!==0,oe;if((oe=U)||(oe=i!==null&&i.memoizedState===null?!1:(k&2)!==0),oe?(A=!0,c.flags&=-129):(i===null||i.memoizedState!==null)&&(k|=1),nn(fn,k&1),i===null)return Zx(c),i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((c.mode&1)===0?c.lanes=1:i.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(U=v.children,i=v.fallback,A?(v=c.mode,A=c.child,U={mode:"hidden",children:U},(v&1)===0&&A!==null?(A.childLanes=0,A.pendingProps=U):A=Ih(U,v,0,null),i=Dl(i,v,h,null),A.return=c,i.return=c,A.sibling=i,c.child=A,c.child.memoizedState=Cm(h),c.memoizedState=Tm,i):Sm(c,U));if(k=i.memoizedState,k!==null&&(oe=k.dehydrated,oe!==null))return t4(i,c,U,v,oe,k,h);if(A){A=v.fallback,U=c.mode,k=i.child,oe=k.sibling;var de={mode:"hidden",children:v.children};return(U&1)===0&&c.child!==k?(v=c.child,v.childLanes=0,v.pendingProps=de,c.deletions=null):(v=Oi(k,de),v.subtreeFlags=k.subtreeFlags&14680064),oe!==null?A=Oi(oe,A):(A=Dl(A,U,h,null),A.flags|=2),A.return=c,v.return=c,v.sibling=A,c.child=v,v=A,A=c.child,U=i.child.memoizedState,U=U===null?Cm(h):{baseLanes:U.baseLanes|h,cachePool:null,transitions:U.transitions},A.memoizedState=U,A.childLanes=i.childLanes&~h,c.memoizedState=Tm,v}return A=i.child,i=A.sibling,v=Oi(A,{mode:"visible",children:v.children}),(c.mode&1)===0&&(v.lanes=h),v.return=c,v.sibling=null,i!==null&&(h=c.deletions,h===null?(c.deletions=[i],c.flags|=16):h.push(i)),c.child=v,c.memoizedState=null,v}function Sm(i,c){return c=Ih({mode:"visible",children:c},i.mode,0,null),c.return=i,i.child=c}function jh(i,c,h,v){return v!==null&&em(v),Bo(c,i.child,null,h),i=Sm(c,c.pendingProps.children),i.flags|=2,c.memoizedState=null,i}function t4(i,c,h,v,k,A,U){if(h)return c.flags&256?(c.flags&=-257,v=Nm(Error(a(422))),jh(i,c,U,v)):c.memoizedState!==null?(c.child=i.child,c.flags|=128,null):(A=v.fallback,k=c.mode,v=Ih({mode:"visible",children:v.children},k,0,null),A=Dl(A,k,U,null),A.flags|=2,v.return=c,A.return=c,v.sibling=A,c.child=v,(c.mode&1)!==0&&Bo(c,i.child,null,U),c.child.memoizedState=Cm(U),c.memoizedState=Tm,A);if((c.mode&1)===0)return jh(i,c,U,null);if(k.data==="$!"){if(v=k.nextSibling&&k.nextSibling.dataset,v)var oe=v.dgst;return v=oe,A=Error(a(419)),v=Nm(A,v,void 0),jh(i,c,U,v)}if(oe=(U&i.childLanes)!==0,Ka||oe){if(v=Jn,v!==null){switch(U&-U){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}k=(k&(v.suspendedLanes|U))!==0?0:k,k!==0&&k!==A.retryLane&&(A.retryLane=k,Hs(i,k),Wr(v,i,k,-1))}return Km(),v=Nm(Error(a(421))),jh(i,c,U,v)}return k.data==="$?"?(c.flags|=128,c.child=i.child,c=m4.bind(null,i),k._reactRetry=c,null):(i=A.treeContext,or=Ti(k.nextSibling),lr=c,mn=!0,zr=null,i!==null&&(jr[wr++]=Rs,jr[wr++]=Bs,jr[wr++]=Nl,Rs=i.id,Bs=i.overflow,Nl=c),c=Sm(c,v.children),c.flags|=4096,c)}function t1(i,c,h){i.lanes|=c;var v=i.alternate;v!==null&&(v.lanes|=c),rm(i.return,c,h)}function _m(i,c,h,v,k){var A=i.memoizedState;A===null?i.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:v,tail:h,tailMode:k}:(A.isBackwards=c,A.rendering=null,A.renderingStartTime=0,A.last=v,A.tail=h,A.tailMode=k)}function n1(i,c,h){var v=c.pendingProps,k=v.revealOrder,A=v.tail;if(Aa(i,c,v.children,h),v=fn.current,(v&2)!==0)v=v&1|2,c.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=c.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&t1(i,h,c);else if(i.tag===19)t1(i,h,c);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===c)break e;for(;i.sibling===null;){if(i.return===null||i.return===c)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}v&=1}if(nn(fn,v),(c.mode&1)===0)c.memoizedState=null;else switch(k){case"forwards":for(h=c.child,k=null;h!==null;)i=h.alternate,i!==null&&fh(i)===null&&(k=h),h=h.sibling;h=k,h===null?(k=c.child,c.child=null):(k=h.sibling,h.sibling=null),_m(c,!1,k,h,A);break;case"backwards":for(h=null,k=c.child,c.child=null;k!==null;){if(i=k.alternate,i!==null&&fh(i)===null){c.child=k;break}i=k.sibling,k.sibling=h,h=k,k=i}_m(c,!0,h,null,A);break;case"together":_m(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function wh(i,c){(c.mode&1)===0&&i!==null&&(i.alternate=null,c.alternate=null,c.flags|=2)}function Us(i,c,h){if(i!==null&&(c.dependencies=i.dependencies),Cl|=c.lanes,(h&c.childLanes)===0)return null;if(i!==null&&c.child!==i.child)throw Error(a(153));if(c.child!==null){for(i=c.child,h=Oi(i,i.pendingProps),c.child=h,h.return=c;i.sibling!==null;)i=i.sibling,h=h.sibling=Oi(i,i.pendingProps),h.return=c;h.sibling=null}return c.child}function n4(i,c,h){switch(c.tag){case 3:Jv(c),Ro();break;case 5:pv(c);break;case 1:Ua(c.type)&&sh(c);break;case 4:lm(c,c.stateNode.containerInfo);break;case 10:var v=c.type._context,k=c.memoizedProps.value;nn(uh,v._currentValue),v._currentValue=k;break;case 13:if(v=c.memoizedState,v!==null)return v.dehydrated!==null?(nn(fn,fn.current&1),c.flags|=128,null):(h&c.child.childLanes)!==0?e1(i,c,h):(nn(fn,fn.current&1),i=Us(i,c,h),i!==null?i.sibling:null);nn(fn,fn.current&1);break;case 19:if(v=(h&c.childLanes)!==0,(i.flags&128)!==0){if(v)return n1(i,c,h);c.flags|=128}if(k=c.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),nn(fn,fn.current),v)break;return null;case 22:case 23:return c.lanes=0,Xv(i,c,h)}return Us(i,c,h)}var a1,Em,r1,s1;a1=function(i,c){for(var h=c.child;h!==null;){if(h.tag===5||h.tag===6)i.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},Em=function(){},r1=function(i,c,h,v){var k=i.memoizedProps;if(k!==v){i=c.stateNode,kl(us.current);var A=null;switch(h){case"input":k=Ke(i,k),v=Ke(i,v),A=[];break;case"select":k=xe({},k,{value:void 0}),v=xe({},v,{value:void 0}),A=[];break;case"textarea":k=ia(i,k),v=ia(i,v),A=[];break;default:typeof k.onClick!="function"&&typeof v.onClick=="function"&&(i.onclick=nh)}Ls(h,v);var U;h=null;for(je in k)if(!v.hasOwnProperty(je)&&k.hasOwnProperty(je)&&k[je]!=null)if(je==="style"){var oe=k[je];for(U in oe)oe.hasOwnProperty(U)&&(h||(h={}),h[U]="")}else je!=="dangerouslySetInnerHTML"&&je!=="children"&&je!=="suppressContentEditableWarning"&&je!=="suppressHydrationWarning"&&je!=="autoFocus"&&(s.hasOwnProperty(je)?A||(A=[]):(A=A||[]).push(je,null));for(je in v){var de=v[je];if(oe=k!=null?k[je]:void 0,v.hasOwnProperty(je)&&de!==oe&&(de!=null||oe!=null))if(je==="style")if(oe){for(U in oe)!oe.hasOwnProperty(U)||de&&de.hasOwnProperty(U)||(h||(h={}),h[U]="");for(U in de)de.hasOwnProperty(U)&&oe[U]!==de[U]&&(h||(h={}),h[U]=de[U])}else h||(A||(A=[]),A.push(je,h)),h=de;else je==="dangerouslySetInnerHTML"?(de=de?de.__html:void 0,oe=oe?oe.__html:void 0,de!=null&&oe!==de&&(A=A||[]).push(je,de)):je==="children"?typeof de!="string"&&typeof de!="number"||(A=A||[]).push(je,""+de):je!=="suppressContentEditableWarning"&&je!=="suppressHydrationWarning"&&(s.hasOwnProperty(je)?(de!=null&&je==="onScroll"&&sn("scroll",i),A||oe===de||(A=[])):(A=A||[]).push(je,de))}h&&(A=A||[]).push("style",h);var je=A;(c.updateQueue=je)&&(c.flags|=4)}},s1=function(i,c,h,v){h!==v&&(c.flags|=4)};function pd(i,c){if(!mn)switch(i.tailMode){case"hidden":c=i.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?i.tail=null:h.sibling=null;break;case"collapsed":h=i.tail;for(var v=null;h!==null;)h.alternate!==null&&(v=h),h=h.sibling;v===null?c||i.tail===null?i.tail=null:i.tail.sibling=null:v.sibling=null}}function ya(i){var c=i.alternate!==null&&i.alternate.child===i.child,h=0,v=0;if(c)for(var k=i.child;k!==null;)h|=k.lanes|k.childLanes,v|=k.subtreeFlags&14680064,v|=k.flags&14680064,k.return=i,k=k.sibling;else for(k=i.child;k!==null;)h|=k.lanes|k.childLanes,v|=k.subtreeFlags,v|=k.flags,k.return=i,k=k.sibling;return i.subtreeFlags|=v,i.childLanes=h,c}function a4(i,c,h){var v=c.pendingProps;switch(Yx(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ya(c),null;case 1:return Ua(c.type)&&rh(),ya(c),null;case 3:return v=c.stateNode,Uo(),ln(Va),ln(pa),dm(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(i===null||i.child===null)&&(ch(c)?c.flags|=4:i===null||i.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,zr!==null&&(Hm(zr),zr=null))),Em(i,c),ya(c),null;case 5:om(c);var k=kl(ud.current);if(h=c.type,i!==null&&c.stateNode!=null)r1(i,c,h,v,k),i.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!v){if(c.stateNode===null)throw Error(a(166));return ya(c),null}if(i=kl(us.current),ch(c)){v=c.stateNode,h=c.type;var A=c.memoizedProps;switch(v[ds]=c,v[id]=A,i=(c.mode&1)!==0,h){case"dialog":sn("cancel",v),sn("close",v);break;case"iframe":case"object":case"embed":sn("load",v);break;case"video":case"audio":for(k=0;k<ad.length;k++)sn(ad[k],v);break;case"source":sn("error",v);break;case"img":case"image":case"link":sn("error",v),sn("load",v);break;case"details":sn("toggle",v);break;case"input":tt(v,A),sn("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!A.multiple},sn("invalid",v);break;case"textarea":la(v,A),sn("invalid",v)}Ls(h,A),k=null;for(var U in A)if(A.hasOwnProperty(U)){var oe=A[U];U==="children"?typeof oe=="string"?v.textContent!==oe&&(A.suppressHydrationWarning!==!0&&th(v.textContent,oe,i),k=["children",oe]):typeof oe=="number"&&v.textContent!==""+oe&&(A.suppressHydrationWarning!==!0&&th(v.textContent,oe,i),k=["children",""+oe]):s.hasOwnProperty(U)&&oe!=null&&U==="onScroll"&&sn("scroll",v)}switch(h){case"input":Le(v),Rt(v,A,!0);break;case"textarea":Le(v),Qe(v);break;case"select":case"option":break;default:typeof A.onClick=="function"&&(v.onclick=nh)}v=k,c.updateQueue=v,v!==null&&(c.flags|=4)}else{U=k.nodeType===9?k:k.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=Et(h)),i==="http://www.w3.org/1999/xhtml"?h==="script"?(i=U.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof v.is=="string"?i=U.createElement(h,{is:v.is}):(i=U.createElement(h),h==="select"&&(U=i,v.multiple?U.multiple=!0:v.size&&(U.size=v.size))):i=U.createElementNS(i,h),i[ds]=c,i[id]=v,a1(i,c,!1,!1),c.stateNode=i;e:{switch(U=Ps(h,v),h){case"dialog":sn("cancel",i),sn("close",i),k=v;break;case"iframe":case"object":case"embed":sn("load",i),k=v;break;case"video":case"audio":for(k=0;k<ad.length;k++)sn(ad[k],i);k=v;break;case"source":sn("error",i),k=v;break;case"img":case"image":case"link":sn("error",i),sn("load",i),k=v;break;case"details":sn("toggle",i),k=v;break;case"input":tt(i,v),k=Ke(i,v),sn("invalid",i);break;case"option":k=v;break;case"select":i._wrapperState={wasMultiple:!!v.multiple},k=xe({},v,{value:void 0}),sn("invalid",i);break;case"textarea":la(i,v),k=ia(i,v),sn("invalid",i);break;default:k=v}Ls(h,k),oe=k;for(A in oe)if(oe.hasOwnProperty(A)){var de=oe[A];A==="style"?Da(i,de):A==="dangerouslySetInnerHTML"?(de=de?de.__html:void 0,de!=null&&Bn(i,de)):A==="children"?typeof de=="string"?(h!=="textarea"||de!=="")&&ot(i,de):typeof de=="number"&&ot(i,""+de):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(s.hasOwnProperty(A)?de!=null&&A==="onScroll"&&sn("scroll",i):de!=null&&_(i,A,de,U))}switch(h){case"input":Le(i),Rt(i,v,!1);break;case"textarea":Le(i),Qe(i);break;case"option":v.value!=null&&i.setAttribute("value",""+V(v.value));break;case"select":i.multiple=!!v.multiple,A=v.value,A!=null?Cn(i,!!v.multiple,A,!1):v.defaultValue!=null&&Cn(i,!!v.multiple,v.defaultValue,!0);break;default:typeof k.onClick=="function"&&(i.onclick=nh)}switch(h){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return ya(c),null;case 6:if(i&&c.stateNode!=null)s1(i,c,i.memoizedProps,v);else{if(typeof v!="string"&&c.stateNode===null)throw Error(a(166));if(h=kl(ud.current),kl(us.current),ch(c)){if(v=c.stateNode,h=c.memoizedProps,v[ds]=c,(A=v.nodeValue!==h)&&(i=lr,i!==null))switch(i.tag){case 3:th(v.nodeValue,h,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&th(v.nodeValue,h,(i.mode&1)!==0)}A&&(c.flags|=4)}else v=(h.nodeType===9?h:h.ownerDocument).createTextNode(v),v[ds]=c,c.stateNode=v}return ya(c),null;case 13:if(ln(fn),v=c.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(mn&&or!==null&&(c.mode&1)!==0&&(c.flags&128)===0)ov(),Ro(),c.flags|=98560,A=!1;else if(A=ch(c),v!==null&&v.dehydrated!==null){if(i===null){if(!A)throw Error(a(318));if(A=c.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(a(317));A[ds]=c}else Ro(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;ya(c),A=!1}else zr!==null&&(Hm(zr),zr=null),A=!0;if(!A)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=h,c):(v=v!==null,v!==(i!==null&&i.memoizedState!==null)&&v&&(c.child.flags|=8192,(c.mode&1)!==0&&(i===null||(fn.current&1)!==0?Vn===0&&(Vn=3):Km())),c.updateQueue!==null&&(c.flags|=4),ya(c),null);case 4:return Uo(),Em(i,c),i===null&&rd(c.stateNode.containerInfo),ya(c),null;case 10:return am(c.type._context),ya(c),null;case 17:return Ua(c.type)&&rh(),ya(c),null;case 19:if(ln(fn),A=c.memoizedState,A===null)return ya(c),null;if(v=(c.flags&128)!==0,U=A.rendering,U===null)if(v)pd(A,!1);else{if(Vn!==0||i!==null&&(i.flags&128)!==0)for(i=c.child;i!==null;){if(U=fh(i),U!==null){for(c.flags|=128,pd(A,!1),v=U.updateQueue,v!==null&&(c.updateQueue=v,c.flags|=4),c.subtreeFlags=0,v=h,h=c.child;h!==null;)A=h,i=v,A.flags&=14680066,U=A.alternate,U===null?(A.childLanes=0,A.lanes=i,A.child=null,A.subtreeFlags=0,A.memoizedProps=null,A.memoizedState=null,A.updateQueue=null,A.dependencies=null,A.stateNode=null):(A.childLanes=U.childLanes,A.lanes=U.lanes,A.child=U.child,A.subtreeFlags=0,A.deletions=null,A.memoizedProps=U.memoizedProps,A.memoizedState=U.memoizedState,A.updateQueue=U.updateQueue,A.type=U.type,i=U.dependencies,A.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),h=h.sibling;return nn(fn,fn.current&1|2),c.child}i=i.sibling}A.tail!==null&&Me()>Go&&(c.flags|=128,v=!0,pd(A,!1),c.lanes=4194304)}else{if(!v)if(i=fh(U),i!==null){if(c.flags|=128,v=!0,h=i.updateQueue,h!==null&&(c.updateQueue=h,c.flags|=4),pd(A,!0),A.tail===null&&A.tailMode==="hidden"&&!U.alternate&&!mn)return ya(c),null}else 2*Me()-A.renderingStartTime>Go&&h!==1073741824&&(c.flags|=128,v=!0,pd(A,!1),c.lanes=4194304);A.isBackwards?(U.sibling=c.child,c.child=U):(h=A.last,h!==null?h.sibling=U:c.child=U,A.last=U)}return A.tail!==null?(c=A.tail,A.rendering=c,A.tail=c.sibling,A.renderingStartTime=Me(),c.sibling=null,h=fn.current,nn(fn,v?h&1|2:h&1),c):(ya(c),null);case 22:case 23:return Um(),v=c.memoizedState!==null,i!==null&&i.memoizedState!==null!==v&&(c.flags|=8192),v&&(c.mode&1)!==0?(cr&1073741824)!==0&&(ya(c),c.subtreeFlags&6&&(c.flags|=8192)):ya(c),null;case 24:return null;case 25:return null}throw Error(a(156,c.tag))}function r4(i,c){switch(Yx(c),c.tag){case 1:return Ua(c.type)&&rh(),i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 3:return Uo(),ln(Va),ln(pa),dm(),i=c.flags,(i&65536)!==0&&(i&128)===0?(c.flags=i&-65537|128,c):null;case 5:return om(c),null;case 13:if(ln(fn),i=c.memoizedState,i!==null&&i.dehydrated!==null){if(c.alternate===null)throw Error(a(340));Ro()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 19:return ln(fn),null;case 4:return Uo(),null;case 10:return am(c.type._context),null;case 22:case 23:return Um(),null;case 24:return null;default:return null}}var kh=!1,va=!1,s4=typeof WeakSet=="function"?WeakSet:Set,We=null;function zo(i,c){var h=i.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(v){bn(i,c,v)}else h.current=null}function Dm(i,c,h){try{h()}catch(v){bn(i,c,v)}}var i1=!1;function i4(i,c){if(Ux=zu,i=Ry(),Px(i)){if("selectionStart"in i)var h={start:i.selectionStart,end:i.selectionEnd};else e:{h=(h=i.ownerDocument)&&h.defaultView||window;var v=h.getSelection&&h.getSelection();if(v&&v.rangeCount!==0){h=v.anchorNode;var k=v.anchorOffset,A=v.focusNode;v=v.focusOffset;try{h.nodeType,A.nodeType}catch{h=null;break e}var U=0,oe=-1,de=-1,je=0,Ae=0,Ie=i,De=null;t:for(;;){for(var Ge;Ie!==h||k!==0&&Ie.nodeType!==3||(oe=U+k),Ie!==A||v!==0&&Ie.nodeType!==3||(de=U+v),Ie.nodeType===3&&(U+=Ie.nodeValue.length),(Ge=Ie.firstChild)!==null;)De=Ie,Ie=Ge;for(;;){if(Ie===i)break t;if(De===h&&++je===k&&(oe=U),De===A&&++Ae===v&&(de=U),(Ge=Ie.nextSibling)!==null)break;Ie=De,De=Ie.parentNode}Ie=Ge}h=oe===-1||de===-1?null:{start:oe,end:de}}else h=null}h=h||{start:0,end:0}}else h=null;for(Kx={focusedElem:i,selectionRange:h},zu=!1,We=c;We!==null;)if(c=We,i=c.child,(c.subtreeFlags&1028)!==0&&i!==null)i.return=c,We=i;else for(;We!==null;){c=We;try{var Ye=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Ye!==null){var Je=Ye.memoizedProps,En=Ye.memoizedState,pe=c.stateNode,me=pe.getSnapshotBeforeUpdate(c.elementType===c.type?Je:$r(c.type,Je),En);pe.__reactInternalSnapshotBeforeUpdate=me}break;case 3:var ge=c.stateNode.containerInfo;ge.nodeType===1?ge.textContent="":ge.nodeType===9&&ge.documentElement&&ge.removeChild(ge.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(a(163))}}catch(He){bn(c,c.return,He)}if(i=c.sibling,i!==null){i.return=c.return,We=i;break}We=c.return}return Ye=i1,i1=!1,Ye}function gd(i,c,h){var v=c.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var k=v=v.next;do{if((k.tag&i)===i){var A=k.destroy;k.destroy=void 0,A!==void 0&&Dm(c,h,A)}k=k.next}while(k!==v)}}function Th(i,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&i)===i){var v=h.create;h.destroy=v()}h=h.next}while(h!==c)}}function Am(i){var c=i.ref;if(c!==null){var h=i.stateNode;switch(i.tag){case 5:i=h;break;default:i=h}typeof c=="function"?c(i):c.current=i}}function l1(i){var c=i.alternate;c!==null&&(i.alternate=null,l1(c)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(c=i.stateNode,c!==null&&(delete c[ds],delete c[id],delete c[qx],delete c[UC],delete c[KC])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function o1(i){return i.tag===5||i.tag===3||i.tag===4}function c1(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||o1(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Fm(i,c,h){var v=i.tag;if(v===5||v===6)i=i.stateNode,c?h.nodeType===8?h.parentNode.insertBefore(i,c):h.insertBefore(i,c):(h.nodeType===8?(c=h.parentNode,c.insertBefore(i,h)):(c=h,c.appendChild(i)),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=nh));else if(v!==4&&(i=i.child,i!==null))for(Fm(i,c,h),i=i.sibling;i!==null;)Fm(i,c,h),i=i.sibling}function Lm(i,c,h){var v=i.tag;if(v===5||v===6)i=i.stateNode,c?h.insertBefore(i,c):h.appendChild(i);else if(v!==4&&(i=i.child,i!==null))for(Lm(i,c,h),i=i.sibling;i!==null;)Lm(i,c,h),i=i.sibling}var oa=null,Gr=!1;function Ai(i,c,h){for(h=h.child;h!==null;)d1(i,c,h),h=h.sibling}function d1(i,c,h){if(Qn&&typeof Qn.onCommitFiberUnmount=="function")try{Qn.onCommitFiberUnmount(cs,h)}catch{}switch(h.tag){case 5:va||zo(h,c);case 6:var v=oa,k=Gr;oa=null,Ai(i,c,h),oa=v,Gr=k,oa!==null&&(Gr?(i=oa,h=h.stateNode,i.nodeType===8?i.parentNode.removeChild(h):i.removeChild(h)):oa.removeChild(h.stateNode));break;case 18:oa!==null&&(Gr?(i=oa,h=h.stateNode,i.nodeType===8?Gx(i.parentNode,h):i.nodeType===1&&Gx(i,h),Xc(i)):Gx(oa,h.stateNode));break;case 4:v=oa,k=Gr,oa=h.stateNode.containerInfo,Gr=!0,Ai(i,c,h),oa=v,Gr=k;break;case 0:case 11:case 14:case 15:if(!va&&(v=h.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){k=v=v.next;do{var A=k,U=A.destroy;A=A.tag,U!==void 0&&((A&2)!==0||(A&4)!==0)&&Dm(h,c,U),k=k.next}while(k!==v)}Ai(i,c,h);break;case 1:if(!va&&(zo(h,c),v=h.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=h.memoizedProps,v.state=h.memoizedState,v.componentWillUnmount()}catch(oe){bn(h,c,oe)}Ai(i,c,h);break;case 21:Ai(i,c,h);break;case 22:h.mode&1?(va=(v=va)||h.memoizedState!==null,Ai(i,c,h),va=v):Ai(i,c,h);break;default:Ai(i,c,h)}}function u1(i){var c=i.updateQueue;if(c!==null){i.updateQueue=null;var h=i.stateNode;h===null&&(h=i.stateNode=new s4),c.forEach(function(v){var k=f4.bind(null,i,v);h.has(v)||(h.add(v),v.then(k,k))})}}function qr(i,c){var h=c.deletions;if(h!==null)for(var v=0;v<h.length;v++){var k=h[v];try{var A=i,U=c,oe=U;e:for(;oe!==null;){switch(oe.tag){case 5:oa=oe.stateNode,Gr=!1;break e;case 3:oa=oe.stateNode.containerInfo,Gr=!0;break e;case 4:oa=oe.stateNode.containerInfo,Gr=!0;break e}oe=oe.return}if(oa===null)throw Error(a(160));d1(A,U,k),oa=null,Gr=!1;var de=k.alternate;de!==null&&(de.return=null),k.return=null}catch(je){bn(k,c,je)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)h1(c,i),c=c.sibling}function h1(i,c){var h=i.alternate,v=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(qr(c,i),xs(i),v&4){try{gd(3,i,i.return),Th(3,i)}catch(Je){bn(i,i.return,Je)}try{gd(5,i,i.return)}catch(Je){bn(i,i.return,Je)}}break;case 1:qr(c,i),xs(i),v&512&&h!==null&&zo(h,h.return);break;case 5:if(qr(c,i),xs(i),v&512&&h!==null&&zo(h,h.return),i.flags&32){var k=i.stateNode;try{ot(k,"")}catch(Je){bn(i,i.return,Je)}}if(v&4&&(k=i.stateNode,k!=null)){var A=i.memoizedProps,U=h!==null?h.memoizedProps:A,oe=i.type,de=i.updateQueue;if(i.updateQueue=null,de!==null)try{oe==="input"&&A.type==="radio"&&A.name!=null&&Xe(k,A),Ps(oe,U);var je=Ps(oe,A);for(U=0;U<de.length;U+=2){var Ae=de[U],Ie=de[U+1];Ae==="style"?Da(k,Ie):Ae==="dangerouslySetInnerHTML"?Bn(k,Ie):Ae==="children"?ot(k,Ie):_(k,Ae,Ie,je)}switch(oe){case"input":Oe(k,A);break;case"textarea":Re(k,A);break;case"select":var De=k._wrapperState.wasMultiple;k._wrapperState.wasMultiple=!!A.multiple;var Ge=A.value;Ge!=null?Cn(k,!!A.multiple,Ge,!1):De!==!!A.multiple&&(A.defaultValue!=null?Cn(k,!!A.multiple,A.defaultValue,!0):Cn(k,!!A.multiple,A.multiple?[]:"",!1))}k[id]=A}catch(Je){bn(i,i.return,Je)}}break;case 6:if(qr(c,i),xs(i),v&4){if(i.stateNode===null)throw Error(a(162));k=i.stateNode,A=i.memoizedProps;try{k.nodeValue=A}catch(Je){bn(i,i.return,Je)}}break;case 3:if(qr(c,i),xs(i),v&4&&h!==null&&h.memoizedState.isDehydrated)try{Xc(c.containerInfo)}catch(Je){bn(i,i.return,Je)}break;case 4:qr(c,i),xs(i);break;case 13:qr(c,i),xs(i),k=i.child,k.flags&8192&&(A=k.memoizedState!==null,k.stateNode.isHidden=A,!A||k.alternate!==null&&k.alternate.memoizedState!==null||(Om=Me())),v&4&&u1(i);break;case 22:if(Ae=h!==null&&h.memoizedState!==null,i.mode&1?(va=(je=va)||Ae,qr(c,i),va=je):qr(c,i),xs(i),v&8192){if(je=i.memoizedState!==null,(i.stateNode.isHidden=je)&&!Ae&&(i.mode&1)!==0)for(We=i,Ae=i.child;Ae!==null;){for(Ie=We=Ae;We!==null;){switch(De=We,Ge=De.child,De.tag){case 0:case 11:case 14:case 15:gd(4,De,De.return);break;case 1:zo(De,De.return);var Ye=De.stateNode;if(typeof Ye.componentWillUnmount=="function"){v=De,h=De.return;try{c=v,Ye.props=c.memoizedProps,Ye.state=c.memoizedState,Ye.componentWillUnmount()}catch(Je){bn(v,h,Je)}}break;case 5:zo(De,De.return);break;case 22:if(De.memoizedState!==null){f1(Ie);continue}}Ge!==null?(Ge.return=De,We=Ge):f1(Ie)}Ae=Ae.sibling}e:for(Ae=null,Ie=i;;){if(Ie.tag===5){if(Ae===null){Ae=Ie;try{k=Ie.stateNode,je?(A=k.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none"):(oe=Ie.stateNode,de=Ie.memoizedProps.style,U=de!=null&&de.hasOwnProperty("display")?de.display:null,oe.style.display=en("display",U))}catch(Je){bn(i,i.return,Je)}}}else if(Ie.tag===6){if(Ae===null)try{Ie.stateNode.nodeValue=je?"":Ie.memoizedProps}catch(Je){bn(i,i.return,Je)}}else if((Ie.tag!==22&&Ie.tag!==23||Ie.memoizedState===null||Ie===i)&&Ie.child!==null){Ie.child.return=Ie,Ie=Ie.child;continue}if(Ie===i)break e;for(;Ie.sibling===null;){if(Ie.return===null||Ie.return===i)break e;Ae===Ie&&(Ae=null),Ie=Ie.return}Ae===Ie&&(Ae=null),Ie.sibling.return=Ie.return,Ie=Ie.sibling}}break;case 19:qr(c,i),xs(i),v&4&&u1(i);break;case 21:break;default:qr(c,i),xs(i)}}function xs(i){var c=i.flags;if(c&2){try{e:{for(var h=i.return;h!==null;){if(o1(h)){var v=h;break e}h=h.return}throw Error(a(160))}switch(v.tag){case 5:var k=v.stateNode;v.flags&32&&(ot(k,""),v.flags&=-33);var A=c1(i);Lm(i,A,k);break;case 3:case 4:var U=v.stateNode.containerInfo,oe=c1(i);Fm(i,oe,U);break;default:throw Error(a(161))}}catch(de){bn(i,i.return,de)}i.flags&=-3}c&4096&&(i.flags&=-4097)}function l4(i,c,h){We=i,x1(i)}function x1(i,c,h){for(var v=(i.mode&1)!==0;We!==null;){var k=We,A=k.child;if(k.tag===22&&v){var U=k.memoizedState!==null||kh;if(!U){var oe=k.alternate,de=oe!==null&&oe.memoizedState!==null||va;oe=kh;var je=va;if(kh=U,(va=de)&&!je)for(We=k;We!==null;)U=We,de=U.child,U.tag===22&&U.memoizedState!==null?p1(k):de!==null?(de.return=U,We=de):p1(k);for(;A!==null;)We=A,x1(A),A=A.sibling;We=k,kh=oe,va=je}m1(i)}else(k.subtreeFlags&8772)!==0&&A!==null?(A.return=k,We=A):m1(i)}}function m1(i){for(;We!==null;){var c=We;if((c.flags&8772)!==0){var h=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:va||Th(5,c);break;case 1:var v=c.stateNode;if(c.flags&4&&!va)if(h===null)v.componentDidMount();else{var k=c.elementType===c.type?h.memoizedProps:$r(c.type,h.memoizedProps);v.componentDidUpdate(k,h.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var A=c.updateQueue;A!==null&&fv(c,A,v);break;case 3:var U=c.updateQueue;if(U!==null){if(h=null,c.child!==null)switch(c.child.tag){case 5:h=c.child.stateNode;break;case 1:h=c.child.stateNode}fv(c,U,h)}break;case 5:var oe=c.stateNode;if(h===null&&c.flags&4){h=oe;var de=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":de.autoFocus&&h.focus();break;case"img":de.src&&(h.src=de.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var je=c.alternate;if(je!==null){var Ae=je.memoizedState;if(Ae!==null){var Ie=Ae.dehydrated;Ie!==null&&Xc(Ie)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(a(163))}va||c.flags&512&&Am(c)}catch(De){bn(c,c.return,De)}}if(c===i){We=null;break}if(h=c.sibling,h!==null){h.return=c.return,We=h;break}We=c.return}}function f1(i){for(;We!==null;){var c=We;if(c===i){We=null;break}var h=c.sibling;if(h!==null){h.return=c.return,We=h;break}We=c.return}}function p1(i){for(;We!==null;){var c=We;try{switch(c.tag){case 0:case 11:case 15:var h=c.return;try{Th(4,c)}catch(de){bn(c,h,de)}break;case 1:var v=c.stateNode;if(typeof v.componentDidMount=="function"){var k=c.return;try{v.componentDidMount()}catch(de){bn(c,k,de)}}var A=c.return;try{Am(c)}catch(de){bn(c,A,de)}break;case 5:var U=c.return;try{Am(c)}catch(de){bn(c,U,de)}}}catch(de){bn(c,c.return,de)}if(c===i){We=null;break}var oe=c.sibling;if(oe!==null){oe.return=c.return,We=oe;break}We=c.return}}var o4=Math.ceil,Ch=w.ReactCurrentDispatcher,Pm=w.ReactCurrentOwner,Cr=w.ReactCurrentBatchConfig,Ft=0,Jn=null,In=null,ca=0,cr=0,$o=Ci(0),Vn=0,yd=null,Cl=0,Sh=0,Im=0,vd=null,za=null,Om=0,Go=1/0,Ks=null,_h=!1,Mm=null,Fi=null,Eh=!1,Li=null,Dh=0,bd=0,Rm=null,Ah=-1,Fh=0;function Fa(){return(Ft&6)!==0?Me():Ah!==-1?Ah:Ah=Me()}function Pi(i){return(i.mode&1)===0?1:(Ft&2)!==0&&ca!==0?ca&-ca:$C.transition!==null?(Fh===0&&(Fh=cy()),Fh):(i=Kt,i!==0||(i=window.event,i=i===void 0?16:yy(i.type)),i)}function Wr(i,c,h,v){if(50<bd)throw bd=0,Rm=null,Error(a(185));zc(i,h,v),((Ft&2)===0||i!==Jn)&&(i===Jn&&((Ft&2)===0&&(Sh|=h),Vn===4&&Ii(i,ca)),$a(i,v),h===1&&Ft===0&&(c.mode&1)===0&&(Go=Me()+500,ih&&_i()))}function $a(i,c){var h=i.callbackNode;$T(i,c);var v=Vu(i,i===Jn?ca:0);if(v===0)h!==null&&ze(h),i.callbackNode=null,i.callbackPriority=0;else if(c=v&-v,i.callbackPriority!==c){if(h!=null&&ze(h),c===1)i.tag===0?zC(y1.bind(null,i)):av(y1.bind(null,i)),HC(function(){(Ft&6)===0&&_i()}),h=null;else{switch(dy(v)){case 1:h=Qt;break;case 4:h=tn;break;case 16:h=Sn;break;case 536870912:h=yi;break;default:h=Sn}h=C1(h,g1.bind(null,i))}i.callbackPriority=c,i.callbackNode=h}}function g1(i,c){if(Ah=-1,Fh=0,(Ft&6)!==0)throw Error(a(327));var h=i.callbackNode;if(qo()&&i.callbackNode!==h)return null;var v=Vu(i,i===Jn?ca:0);if(v===0)return null;if((v&30)!==0||(v&i.expiredLanes)!==0||c)c=Lh(i,v);else{c=v;var k=Ft;Ft|=2;var A=b1();(Jn!==i||ca!==c)&&(Ks=null,Go=Me()+500,_l(i,c));do try{u4();break}catch(oe){v1(i,oe)}while(!0);nm(),Ch.current=A,Ft=k,In!==null?c=0:(Jn=null,ca=0,c=Vn)}if(c!==0){if(c===2&&(k=yx(i),k!==0&&(v=k,c=Bm(i,k))),c===1)throw h=yd,_l(i,0),Ii(i,v),$a(i,Me()),h;if(c===6)Ii(i,v);else{if(k=i.current.alternate,(v&30)===0&&!c4(k)&&(c=Lh(i,v),c===2&&(A=yx(i),A!==0&&(v=A,c=Bm(i,A))),c===1))throw h=yd,_l(i,0),Ii(i,v),$a(i,Me()),h;switch(i.finishedWork=k,i.finishedLanes=v,c){case 0:case 1:throw Error(a(345));case 2:El(i,za,Ks);break;case 3:if(Ii(i,v),(v&130023424)===v&&(c=Om+500-Me(),10<c)){if(Vu(i,0)!==0)break;if(k=i.suspendedLanes,(k&v)!==v){Fa(),i.pingedLanes|=i.suspendedLanes&k;break}i.timeoutHandle=$x(El.bind(null,i,za,Ks),c);break}El(i,za,Ks);break;case 4:if(Ii(i,v),(v&4194240)===v)break;for(c=i.eventTimes,k=-1;0<v;){var U=31-_n(v);A=1<<U,U=c[U],U>k&&(k=U),v&=~A}if(v=k,v=Me()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*o4(v/1960))-v,10<v){i.timeoutHandle=$x(El.bind(null,i,za,Ks),v);break}El(i,za,Ks);break;case 5:El(i,za,Ks);break;default:throw Error(a(329))}}}return $a(i,Me()),i.callbackNode===h?g1.bind(null,i):null}function Bm(i,c){var h=vd;return i.current.memoizedState.isDehydrated&&(_l(i,c).flags|=256),i=Lh(i,c),i!==2&&(c=za,za=h,c!==null&&Hm(c)),i}function Hm(i){za===null?za=i:za.push.apply(za,i)}function c4(i){for(var c=i;;){if(c.flags&16384){var h=c.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var v=0;v<h.length;v++){var k=h[v],A=k.getSnapshot;k=k.value;try{if(!Kr(A(),k))return!1}catch{return!1}}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Ii(i,c){for(c&=~Im,c&=~Sh,i.suspendedLanes|=c,i.pingedLanes&=~c,i=i.expirationTimes;0<c;){var h=31-_n(c),v=1<<h;i[h]=-1,c&=~v}}function y1(i){if((Ft&6)!==0)throw Error(a(327));qo();var c=Vu(i,0);if((c&1)===0)return $a(i,Me()),null;var h=Lh(i,c);if(i.tag!==0&&h===2){var v=yx(i);v!==0&&(c=v,h=Bm(i,v))}if(h===1)throw h=yd,_l(i,0),Ii(i,c),$a(i,Me()),h;if(h===6)throw Error(a(345));return i.finishedWork=i.current.alternate,i.finishedLanes=c,El(i,za,Ks),$a(i,Me()),null}function Vm(i,c){var h=Ft;Ft|=1;try{return i(c)}finally{Ft=h,Ft===0&&(Go=Me()+500,ih&&_i())}}function Sl(i){Li!==null&&Li.tag===0&&(Ft&6)===0&&qo();var c=Ft;Ft|=1;var h=Cr.transition,v=Kt;try{if(Cr.transition=null,Kt=1,i)return i()}finally{Kt=v,Cr.transition=h,Ft=c,(Ft&6)===0&&_i()}}function Um(){cr=$o.current,ln($o)}function _l(i,c){i.finishedWork=null,i.finishedLanes=0;var h=i.timeoutHandle;if(h!==-1&&(i.timeoutHandle=-1,BC(h)),In!==null)for(h=In.return;h!==null;){var v=h;switch(Yx(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&rh();break;case 3:Uo(),ln(Va),ln(pa),dm();break;case 5:om(v);break;case 4:Uo();break;case 13:ln(fn);break;case 19:ln(fn);break;case 10:am(v.type._context);break;case 22:case 23:Um()}h=h.return}if(Jn=i,In=i=Oi(i.current,null),ca=cr=c,Vn=0,yd=null,Im=Sh=Cl=0,za=vd=null,wl!==null){for(c=0;c<wl.length;c++)if(h=wl[c],v=h.interleaved,v!==null){h.interleaved=null;var k=v.next,A=h.pending;if(A!==null){var U=A.next;A.next=k,v.next=U}h.pending=v}wl=null}return i}function v1(i,c){do{var h=In;try{if(nm(),ph.current=bh,gh){for(var v=pn.memoizedState;v!==null;){var k=v.queue;k!==null&&(k.pending=null),v=v.next}gh=!1}if(Tl=0,Yn=Hn=pn=null,hd=!1,xd=0,Pm.current=null,h===null||h.return===null){Vn=1,yd=c,In=null;break}e:{var A=i,U=h.return,oe=h,de=c;if(c=ca,oe.flags|=32768,de!==null&&typeof de=="object"&&typeof de.then=="function"){var je=de,Ae=oe,Ie=Ae.tag;if((Ae.mode&1)===0&&(Ie===0||Ie===11||Ie===15)){var De=Ae.alternate;De?(Ae.updateQueue=De.updateQueue,Ae.memoizedState=De.memoizedState,Ae.lanes=De.lanes):(Ae.updateQueue=null,Ae.memoizedState=null)}var Ge=zv(U);if(Ge!==null){Ge.flags&=-257,$v(Ge,U,oe,A,c),Ge.mode&1&&Kv(A,je,c),c=Ge,de=je;var Ye=c.updateQueue;if(Ye===null){var Je=new Set;Je.add(de),c.updateQueue=Je}else Ye.add(de);break e}else{if((c&1)===0){Kv(A,je,c),Km();break e}de=Error(a(426))}}else if(mn&&oe.mode&1){var En=zv(U);if(En!==null){(En.flags&65536)===0&&(En.flags|=256),$v(En,U,oe,A,c),em(Ko(de,oe));break e}}A=de=Ko(de,oe),Vn!==4&&(Vn=2),vd===null?vd=[A]:vd.push(A),A=U;do{switch(A.tag){case 3:A.flags|=65536,c&=-c,A.lanes|=c;var pe=Vv(A,de,c);mv(A,pe);break e;case 1:oe=de;var me=A.type,ge=A.stateNode;if((A.flags&128)===0&&(typeof me.getDerivedStateFromError=="function"||ge!==null&&typeof ge.componentDidCatch=="function"&&(Fi===null||!Fi.has(ge)))){A.flags|=65536,c&=-c,A.lanes|=c;var He=Uv(A,oe,c);mv(A,He);break e}}A=A.return}while(A!==null)}j1(h)}catch(et){c=et,In===h&&h!==null&&(In=h=h.return);continue}break}while(!0)}function b1(){var i=Ch.current;return Ch.current=bh,i===null?bh:i}function Km(){(Vn===0||Vn===3||Vn===2)&&(Vn=4),Jn===null||(Cl&268435455)===0&&(Sh&268435455)===0||Ii(Jn,ca)}function Lh(i,c){var h=Ft;Ft|=2;var v=b1();(Jn!==i||ca!==c)&&(Ks=null,_l(i,c));do try{d4();break}catch(k){v1(i,k)}while(!0);if(nm(),Ft=h,Ch.current=v,In!==null)throw Error(a(261));return Jn=null,ca=0,Vn}function d4(){for(;In!==null;)N1(In)}function u4(){for(;In!==null&&!qe();)N1(In)}function N1(i){var c=T1(i.alternate,i,cr);i.memoizedProps=i.pendingProps,c===null?j1(i):In=c,Pm.current=null}function j1(i){var c=i;do{var h=c.alternate;if(i=c.return,(c.flags&32768)===0){if(h=a4(h,c,cr),h!==null){In=h;return}}else{if(h=r4(h,c),h!==null){h.flags&=32767,In=h;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Vn=6,In=null;return}}if(c=c.sibling,c!==null){In=c;return}In=c=i}while(c!==null);Vn===0&&(Vn=5)}function El(i,c,h){var v=Kt,k=Cr.transition;try{Cr.transition=null,Kt=1,h4(i,c,h,v)}finally{Cr.transition=k,Kt=v}return null}function h4(i,c,h,v){do qo();while(Li!==null);if((Ft&6)!==0)throw Error(a(327));h=i.finishedWork;var k=i.finishedLanes;if(h===null)return null;if(i.finishedWork=null,i.finishedLanes=0,h===i.current)throw Error(a(177));i.callbackNode=null,i.callbackPriority=0;var A=h.lanes|h.childLanes;if(GT(i,A),i===Jn&&(In=Jn=null,ca=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||Eh||(Eh=!0,C1(Sn,function(){return qo(),null})),A=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||A){A=Cr.transition,Cr.transition=null;var U=Kt;Kt=1;var oe=Ft;Ft|=4,Pm.current=null,i4(i,h),h1(h,i),FC(Kx),zu=!!Ux,Kx=Ux=null,i.current=h,l4(h),Be(),Ft=oe,Kt=U,Cr.transition=A}else i.current=h;if(Eh&&(Eh=!1,Li=i,Dh=k),A=i.pendingLanes,A===0&&(Fi=null),Uc(h.stateNode),$a(i,Me()),c!==null)for(v=i.onRecoverableError,h=0;h<c.length;h++)k=c[h],v(k.value,{componentStack:k.stack,digest:k.digest});if(_h)throw _h=!1,i=Mm,Mm=null,i;return(Dh&1)!==0&&i.tag!==0&&qo(),A=i.pendingLanes,(A&1)!==0?i===Rm?bd++:(bd=0,Rm=i):bd=0,_i(),null}function qo(){if(Li!==null){var i=dy(Dh),c=Cr.transition,h=Kt;try{if(Cr.transition=null,Kt=16>i?16:i,Li===null)var v=!1;else{if(i=Li,Li=null,Dh=0,(Ft&6)!==0)throw Error(a(331));var k=Ft;for(Ft|=4,We=i.current;We!==null;){var A=We,U=A.child;if((We.flags&16)!==0){var oe=A.deletions;if(oe!==null){for(var de=0;de<oe.length;de++){var je=oe[de];for(We=je;We!==null;){var Ae=We;switch(Ae.tag){case 0:case 11:case 15:gd(8,Ae,A)}var Ie=Ae.child;if(Ie!==null)Ie.return=Ae,We=Ie;else for(;We!==null;){Ae=We;var De=Ae.sibling,Ge=Ae.return;if(l1(Ae),Ae===je){We=null;break}if(De!==null){De.return=Ge,We=De;break}We=Ge}}}var Ye=A.alternate;if(Ye!==null){var Je=Ye.child;if(Je!==null){Ye.child=null;do{var En=Je.sibling;Je.sibling=null,Je=En}while(Je!==null)}}We=A}}if((A.subtreeFlags&2064)!==0&&U!==null)U.return=A,We=U;else e:for(;We!==null;){if(A=We,(A.flags&2048)!==0)switch(A.tag){case 0:case 11:case 15:gd(9,A,A.return)}var pe=A.sibling;if(pe!==null){pe.return=A.return,We=pe;break e}We=A.return}}var me=i.current;for(We=me;We!==null;){U=We;var ge=U.child;if((U.subtreeFlags&2064)!==0&&ge!==null)ge.return=U,We=ge;else e:for(U=me;We!==null;){if(oe=We,(oe.flags&2048)!==0)try{switch(oe.tag){case 0:case 11:case 15:Th(9,oe)}}catch(et){bn(oe,oe.return,et)}if(oe===U){We=null;break e}var He=oe.sibling;if(He!==null){He.return=oe.return,We=He;break e}We=oe.return}}if(Ft=k,_i(),Qn&&typeof Qn.onPostCommitFiberRoot=="function")try{Qn.onPostCommitFiberRoot(cs,i)}catch{}v=!0}return v}finally{Kt=h,Cr.transition=c}}return!1}function w1(i,c,h){c=Ko(h,c),c=Vv(i,c,1),i=Di(i,c,1),c=Fa(),i!==null&&(zc(i,1,c),$a(i,c))}function bn(i,c,h){if(i.tag===3)w1(i,i,h);else for(;c!==null;){if(c.tag===3){w1(c,i,h);break}else if(c.tag===1){var v=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(Fi===null||!Fi.has(v))){i=Ko(h,i),i=Uv(c,i,1),c=Di(c,i,1),i=Fa(),c!==null&&(zc(c,1,i),$a(c,i));break}}c=c.return}}function x4(i,c,h){var v=i.pingCache;v!==null&&v.delete(c),c=Fa(),i.pingedLanes|=i.suspendedLanes&h,Jn===i&&(ca&h)===h&&(Vn===4||Vn===3&&(ca&130023424)===ca&&500>Me()-Om?_l(i,0):Im|=h),$a(i,c)}function k1(i,c){c===0&&((i.mode&1)===0?c=1:(c=Hu,Hu<<=1,(Hu&130023424)===0&&(Hu=4194304)));var h=Fa();i=Hs(i,c),i!==null&&(zc(i,c,h),$a(i,h))}function m4(i){var c=i.memoizedState,h=0;c!==null&&(h=c.retryLane),k1(i,h)}function f4(i,c){var h=0;switch(i.tag){case 13:var v=i.stateNode,k=i.memoizedState;k!==null&&(h=k.retryLane);break;case 19:v=i.stateNode;break;default:throw Error(a(314))}v!==null&&v.delete(c),k1(i,h)}var T1;T1=function(i,c,h){if(i!==null)if(i.memoizedProps!==c.pendingProps||Va.current)Ka=!0;else{if((i.lanes&h)===0&&(c.flags&128)===0)return Ka=!1,n4(i,c,h);Ka=(i.flags&131072)!==0}else Ka=!1,mn&&(c.flags&1048576)!==0&&rv(c,oh,c.index);switch(c.lanes=0,c.tag){case 2:var v=c.type;wh(i,c),i=c.pendingProps;var k=Io(c,pa.current);Vo(c,h),k=xm(null,c,v,i,k,h);var A=mm();return c.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Ua(v)?(A=!0,sh(c)):A=!1,c.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,im(c),k.updater=Nh,c.stateNode=k,k._reactInternals=c,bm(c,v,i,h),c=km(null,c,v,!0,A,h)):(c.tag=0,mn&&A&&Qx(c),Aa(null,c,k,h),c=c.child),c;case 16:v=c.elementType;e:{switch(wh(i,c),i=c.pendingProps,k=v._init,v=k(v._payload),c.type=v,k=c.tag=g4(v),i=$r(v,i),k){case 0:c=wm(null,c,v,i,h);break e;case 1:c=Yv(null,c,v,i,h);break e;case 11:c=Gv(null,c,v,i,h);break e;case 14:c=qv(null,c,v,$r(v.type,i),h);break e}throw Error(a(306,v,""))}return c;case 0:return v=c.type,k=c.pendingProps,k=c.elementType===v?k:$r(v,k),wm(i,c,v,k,h);case 1:return v=c.type,k=c.pendingProps,k=c.elementType===v?k:$r(v,k),Yv(i,c,v,k,h);case 3:e:{if(Jv(c),i===null)throw Error(a(387));v=c.pendingProps,A=c.memoizedState,k=A.element,xv(i,c),mh(c,v,null,h);var U=c.memoizedState;if(v=U.element,A.isDehydrated)if(A={element:v,isDehydrated:!1,cache:U.cache,pendingSuspenseBoundaries:U.pendingSuspenseBoundaries,transitions:U.transitions},c.updateQueue.baseState=A,c.memoizedState=A,c.flags&256){k=Ko(Error(a(423)),c),c=Zv(i,c,v,h,k);break e}else if(v!==k){k=Ko(Error(a(424)),c),c=Zv(i,c,v,h,k);break e}else for(or=Ti(c.stateNode.containerInfo.firstChild),lr=c,mn=!0,zr=null,h=uv(c,null,v,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Ro(),v===k){c=Us(i,c,h);break e}Aa(i,c,v,h)}c=c.child}return c;case 5:return pv(c),i===null&&Zx(c),v=c.type,k=c.pendingProps,A=i!==null?i.memoizedProps:null,U=k.children,zx(v,k)?U=null:A!==null&&zx(v,A)&&(c.flags|=32),Qv(i,c),Aa(i,c,U,h),c.child;case 6:return i===null&&Zx(c),null;case 13:return e1(i,c,h);case 4:return lm(c,c.stateNode.containerInfo),v=c.pendingProps,i===null?c.child=Bo(c,null,v,h):Aa(i,c,v,h),c.child;case 11:return v=c.type,k=c.pendingProps,k=c.elementType===v?k:$r(v,k),Gv(i,c,v,k,h);case 7:return Aa(i,c,c.pendingProps,h),c.child;case 8:return Aa(i,c,c.pendingProps.children,h),c.child;case 12:return Aa(i,c,c.pendingProps.children,h),c.child;case 10:e:{if(v=c.type._context,k=c.pendingProps,A=c.memoizedProps,U=k.value,nn(uh,v._currentValue),v._currentValue=U,A!==null)if(Kr(A.value,U)){if(A.children===k.children&&!Va.current){c=Us(i,c,h);break e}}else for(A=c.child,A!==null&&(A.return=c);A!==null;){var oe=A.dependencies;if(oe!==null){U=A.child;for(var de=oe.firstContext;de!==null;){if(de.context===v){if(A.tag===1){de=Vs(-1,h&-h),de.tag=2;var je=A.updateQueue;if(je!==null){je=je.shared;var Ae=je.pending;Ae===null?de.next=de:(de.next=Ae.next,Ae.next=de),je.pending=de}}A.lanes|=h,de=A.alternate,de!==null&&(de.lanes|=h),rm(A.return,h,c),oe.lanes|=h;break}de=de.next}}else if(A.tag===10)U=A.type===c.type?null:A.child;else if(A.tag===18){if(U=A.return,U===null)throw Error(a(341));U.lanes|=h,oe=U.alternate,oe!==null&&(oe.lanes|=h),rm(U,h,c),U=A.sibling}else U=A.child;if(U!==null)U.return=A;else for(U=A;U!==null;){if(U===c){U=null;break}if(A=U.sibling,A!==null){A.return=U.return,U=A;break}U=U.return}A=U}Aa(i,c,k.children,h),c=c.child}return c;case 9:return k=c.type,v=c.pendingProps.children,Vo(c,h),k=kr(k),v=v(k),c.flags|=1,Aa(i,c,v,h),c.child;case 14:return v=c.type,k=$r(v,c.pendingProps),k=$r(v.type,k),qv(i,c,v,k,h);case 15:return Wv(i,c,c.type,c.pendingProps,h);case 17:return v=c.type,k=c.pendingProps,k=c.elementType===v?k:$r(v,k),wh(i,c),c.tag=1,Ua(v)?(i=!0,sh(c)):i=!1,Vo(c,h),Bv(c,v,k),bm(c,v,k,h),km(null,c,v,!0,i,h);case 19:return n1(i,c,h);case 22:return Xv(i,c,h)}throw Error(a(156,c.tag))};function C1(i,c){return Pe(i,c)}function p4(i,c,h,v){this.tag=i,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sr(i,c,h,v){return new p4(i,c,h,v)}function zm(i){return i=i.prototype,!(!i||!i.isReactComponent)}function g4(i){if(typeof i=="function")return zm(i)?1:0;if(i!=null){if(i=i.$$typeof,i===M)return 11;if(i===X)return 14}return 2}function Oi(i,c){var h=i.alternate;return h===null?(h=Sr(i.tag,c,i.key,i.mode),h.elementType=i.elementType,h.type=i.type,h.stateNode=i.stateNode,h.alternate=i,i.alternate=h):(h.pendingProps=c,h.type=i.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=i.flags&14680064,h.childLanes=i.childLanes,h.lanes=i.lanes,h.child=i.child,h.memoizedProps=i.memoizedProps,h.memoizedState=i.memoizedState,h.updateQueue=i.updateQueue,c=i.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=i.sibling,h.index=i.index,h.ref=i.ref,h}function Ph(i,c,h,v,k,A){var U=2;if(v=i,typeof i=="function")zm(i)&&(U=1);else if(typeof i=="string")U=5;else e:switch(i){case S:return Dl(h.children,k,A,c);case P:U=8,k|=8;break;case F:return i=Sr(12,h,c,k|2),i.elementType=F,i.lanes=A,i;case G:return i=Sr(13,h,c,k),i.elementType=G,i.lanes=A,i;case J:return i=Sr(19,h,c,k),i.elementType=J,i.lanes=A,i;case ne:return Ih(h,k,A,c);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case B:U=10;break e;case O:U=9;break e;case M:U=11;break e;case X:U=14;break e;case fe:U=16,v=null;break e}throw Error(a(130,i==null?i:typeof i,""))}return c=Sr(U,h,c,k),c.elementType=i,c.type=v,c.lanes=A,c}function Dl(i,c,h,v){return i=Sr(7,i,v,c),i.lanes=h,i}function Ih(i,c,h,v){return i=Sr(22,i,v,c),i.elementType=ne,i.lanes=h,i.stateNode={isHidden:!1},i}function $m(i,c,h){return i=Sr(6,i,null,c),i.lanes=h,i}function Gm(i,c,h){return c=Sr(4,i.children!==null?i.children:[],i.key,c),c.lanes=h,c.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},c}function y4(i,c,h,v,k){this.tag=c,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vx(0),this.expirationTimes=vx(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vx(0),this.identifierPrefix=v,this.onRecoverableError=k,this.mutableSourceEagerHydrationData=null}function qm(i,c,h,v,k,A,U,oe,de){return i=new y4(i,c,h,oe,de),c===1?(c=1,A===!0&&(c|=8)):c=0,A=Sr(3,null,null,c),i.current=A,A.stateNode=i,A.memoizedState={element:v,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},im(A),i}function v4(i,c,h){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:C,key:v==null?null:""+v,children:i,containerInfo:c,implementation:h}}function S1(i){if(!i)return Si;i=i._reactInternals;e:{if(se(i)!==i||i.tag!==1)throw Error(a(170));var c=i;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Ua(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(a(171))}if(i.tag===1){var h=i.type;if(Ua(h))return tv(i,h,c)}return c}function _1(i,c,h,v,k,A,U,oe,de){return i=qm(h,v,!0,i,k,A,U,oe,de),i.context=S1(null),h=i.current,v=Fa(),k=Pi(h),A=Vs(v,k),A.callback=c??null,Di(h,A,k),i.current.lanes=k,zc(i,k,v),$a(i,v),i}function Oh(i,c,h,v){var k=c.current,A=Fa(),U=Pi(k);return h=S1(h),c.context===null?c.context=h:c.pendingContext=h,c=Vs(A,U),c.payload={element:i},v=v===void 0?null:v,v!==null&&(c.callback=v),i=Di(k,c,U),i!==null&&(Wr(i,k,U,A),xh(i,k,U)),U}function Mh(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function E1(i,c){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var h=i.retryLane;i.retryLane=h!==0&&h<c?h:c}}function Wm(i,c){E1(i,c),(i=i.alternate)&&E1(i,c)}function b4(){return null}var D1=typeof reportError=="function"?reportError:function(i){console.error(i)};function Xm(i){this._internalRoot=i}Rh.prototype.render=Xm.prototype.render=function(i){var c=this._internalRoot;if(c===null)throw Error(a(409));Oh(i,c,null,null)},Rh.prototype.unmount=Xm.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var c=i.containerInfo;Sl(function(){Oh(null,i,null,null)}),c[Os]=null}};function Rh(i){this._internalRoot=i}Rh.prototype.unstable_scheduleHydration=function(i){if(i){var c=xy();i={blockedOn:null,target:i,priority:c};for(var h=0;h<ji.length&&c!==0&&c<ji[h].priority;h++);ji.splice(h,0,i),h===0&&py(i)}};function Qm(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Bh(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function A1(){}function N4(i,c,h,v,k){if(k){if(typeof v=="function"){var A=v;v=function(){var je=Mh(U);A.call(je)}}var U=_1(c,v,i,0,null,!1,!1,"",A1);return i._reactRootContainer=U,i[Os]=U.current,rd(i.nodeType===8?i.parentNode:i),Sl(),U}for(;k=i.lastChild;)i.removeChild(k);if(typeof v=="function"){var oe=v;v=function(){var je=Mh(de);oe.call(je)}}var de=qm(i,0,!1,null,null,!1,!1,"",A1);return i._reactRootContainer=de,i[Os]=de.current,rd(i.nodeType===8?i.parentNode:i),Sl(function(){Oh(c,de,h,v)}),de}function Hh(i,c,h,v,k){var A=h._reactRootContainer;if(A){var U=A;if(typeof k=="function"){var oe=k;k=function(){var de=Mh(U);oe.call(de)}}Oh(c,U,i,k)}else U=N4(h,c,i,k,v);return Mh(U)}uy=function(i){switch(i.tag){case 3:var c=i.stateNode;if(c.current.memoizedState.isDehydrated){var h=Kc(c.pendingLanes);h!==0&&(bx(c,h|1),$a(c,Me()),(Ft&6)===0&&(Go=Me()+500,_i()))}break;case 13:Sl(function(){var v=Hs(i,1);if(v!==null){var k=Fa();Wr(v,i,1,k)}}),Wm(i,1)}},Nx=function(i){if(i.tag===13){var c=Hs(i,134217728);if(c!==null){var h=Fa();Wr(c,i,134217728,h)}Wm(i,134217728)}},hy=function(i){if(i.tag===13){var c=Pi(i),h=Hs(i,c);if(h!==null){var v=Fa();Wr(h,i,c,v)}Wm(i,c)}},xy=function(){return Kt},my=function(i,c){var h=Kt;try{return Kt=i,c()}finally{Kt=h}},ko=function(i,c,h){switch(c){case"input":if(Oe(i,h),c=h.name,h.type==="radio"&&c!=null){for(h=i;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<h.length;c++){var v=h[c];if(v!==i&&v.form===i.form){var k=ah(v);if(!k)throw Error(a(90));ee(v),Oe(v,k)}}}break;case"textarea":Re(i,h);break;case"select":c=h.value,c!=null&&Cn(i,!!h.multiple,c,!1)}},Ou=Vm,Mu=Sl;var j4={usingClientEntryPoint:!1,Events:[ld,Lo,ah,Pu,Iu,Vm]},Nd={findFiberByHostInstance:vl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},w4={bundleType:Nd.bundleType,version:Nd.version,rendererPackageName:Nd.rendererPackageName,rendererConfig:Nd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=be(i),i===null?null:i.stateNode},findFiberByHostInstance:Nd.findFiberByHostInstance||b4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vh.isDisabled&&Vh.supportsFiber)try{cs=Vh.inject(w4),Qn=Vh}catch{}}return Ga.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j4,Ga.createPortal=function(i,c){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Qm(c))throw Error(a(200));return v4(i,c,null,h)},Ga.createRoot=function(i,c){if(!Qm(i))throw Error(a(299));var h=!1,v="",k=D1;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onRecoverableError!==void 0&&(k=c.onRecoverableError)),c=qm(i,1,!1,null,null,h,!1,v,k),i[Os]=c.current,rd(i.nodeType===8?i.parentNode:i),new Xm(c)},Ga.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var c=i._reactInternals;if(c===void 0)throw typeof i.render=="function"?Error(a(188)):(i=Object.keys(i).join(","),Error(a(268,i)));return i=be(c),i=i===null?null:i.stateNode,i},Ga.flushSync=function(i){return Sl(i)},Ga.hydrate=function(i,c,h){if(!Bh(c))throw Error(a(200));return Hh(null,i,c,!0,h)},Ga.hydrateRoot=function(i,c,h){if(!Qm(i))throw Error(a(405));var v=h!=null&&h.hydratedSources||null,k=!1,A="",U=D1;if(h!=null&&(h.unstable_strictMode===!0&&(k=!0),h.identifierPrefix!==void 0&&(A=h.identifierPrefix),h.onRecoverableError!==void 0&&(U=h.onRecoverableError)),c=_1(c,null,i,1,h??null,k,!1,A,U),i[Os]=c.current,rd(i),v)for(i=0;i<v.length;i++)h=v[i],k=h._getVersion,k=k(h._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[h,k]:c.mutableSourceEagerHydrationData.push(h,k);return new Rh(c)},Ga.render=function(i,c,h){if(!Bh(c))throw Error(a(200));return Hh(null,i,c,!1,h)},Ga.unmountComponentAtNode=function(i){if(!Bh(i))throw Error(a(40));return i._reactRootContainer?(Sl(function(){Hh(null,null,i,!1,function(){i._reactRootContainer=null,i[Os]=null})}),!0):!1},Ga.unstable_batchedUpdates=Vm,Ga.unstable_renderSubtreeIntoContainer=function(i,c,h,v){if(!Bh(h))throw Error(a(200));if(i==null||i._reactInternals===void 0)throw Error(a(38));return Hh(i,c,h,!1,v)},Ga.version="18.3.1-next-f1338f8080-20240426",Ga}var H1;function F2(){if(H1)return tf.exports;H1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),tf.exports=P4(),tf.exports}var V1;function I4(){if(V1)return Kh;V1=1;var e=F2();return Kh.createRoot=e.createRoot,Kh.hydrateRoot=e.hydrateRoot,Kh}var O4=I4(),Dc=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},M4={setTimeout:(e,n)=>setTimeout(e,n),clearTimeout:e=>clearTimeout(e),setInterval:(e,n)=>setInterval(e,n),clearInterval:e=>clearInterval(e)},Vi,Vp,b2,R4=(b2=class{constructor(){at(this,Vi,M4);at(this,Vp,!1)}setTimeoutProvider(e){$e(this,Vi,e)}setTimeout(e,n){return ce(this,Vi).setTimeout(e,n)}clearTimeout(e){ce(this,Vi).clearTimeout(e)}setInterval(e,n){return ce(this,Vi).setInterval(e,n)}clearInterval(e){ce(this,Vi).clearInterval(e)}},Vi=new WeakMap,Vp=new WeakMap,b2),Bl=new R4;function B4(e){setTimeout(e,0)}var ao=typeof window>"u"||"Deno"in globalThis;function Ia(){}function H4(e,n){return typeof e=="function"?e(n):e}function qf(e){return typeof e=="number"&&e>=0&&e!==1/0}function L2(e,n){return Math.max(e+(n||0)-Date.now(),0)}function nl(e,n){return typeof e=="function"?e(n):e}function Ir(e,n){return typeof e=="function"?e(n):e}function U1(e,n){const{type:a="all",exact:r,fetchStatus:s,predicate:l,queryKey:o,stale:d}=e;if(o){if(r){if(n.queryHash!==zp(o,n.options))return!1}else if(!qd(n.queryKey,o))return!1}if(a!=="all"){const u=n.isActive();if(a==="active"&&!u||a==="inactive"&&u)return!1}return!(typeof d=="boolean"&&n.isStale()!==d||s&&s!==n.state.fetchStatus||l&&!l(n))}function K1(e,n){const{exact:a,status:r,predicate:s,mutationKey:l}=e;if(l){if(!n.options.mutationKey)return!1;if(a){if(ro(n.options.mutationKey)!==ro(l))return!1}else if(!qd(n.options.mutationKey,l))return!1}return!(r&&n.state.status!==r||s&&!s(n))}function zp(e,n){return((n==null?void 0:n.queryKeyHashFn)||ro)(e)}function ro(e){return JSON.stringify(e,(n,a)=>Wf(a)?Object.keys(a).sort().reduce((r,s)=>(r[s]=a[s],r),{}):a)}function qd(e,n){return e===n?!0:typeof e!=typeof n?!1:e&&n&&typeof e=="object"&&typeof n=="object"?Object.keys(n).every(a=>qd(e[a],n[a])):!1}var V4=Object.prototype.hasOwnProperty;function P2(e,n){if(e===n)return e;const a=z1(e)&&z1(n);if(!a&&!(Wf(e)&&Wf(n)))return n;const s=(a?e:Object.keys(e)).length,l=a?n:Object.keys(n),o=l.length,d=a?new Array(o):{};let u=0;for(let x=0;x<o;x++){const m=a?x:l[x],f=e[m],p=n[m];if(f===p){d[m]=f,(a?x<s:V4.call(e,m))&&u++;continue}if(f===null||p===null||typeof f!="object"||typeof p!="object"){d[m]=p;continue}const N=P2(f,p);d[m]=N,N===f&&u++}return s===o&&u===s?e:d}function f0(e,n){if(!n||Object.keys(e).length!==Object.keys(n).length)return!1;for(const a in e)if(e[a]!==n[a])return!1;return!0}function z1(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Wf(e){if(!$1(e))return!1;const n=e.constructor;if(n===void 0)return!0;const a=n.prototype;return!(!$1(a)||!a.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function $1(e){return Object.prototype.toString.call(e)==="[object Object]"}function U4(e){return new Promise(n=>{Bl.setTimeout(n,e)})}function Xf(e,n,a){return typeof a.structuralSharing=="function"?a.structuralSharing(e,n):a.structuralSharing!==!1?P2(e,n):n}function K4(e,n,a=0){const r=[...e,n];return a&&r.length>a?r.slice(1):r}function z4(e,n,a=0){const r=[n,...e];return a&&r.length>a?r.slice(0,-1):r}var $p=Symbol();function I2(e,n){return!e.queryFn&&(n!=null&&n.initialPromise)?()=>n.initialPromise:!e.queryFn||e.queryFn===$p?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function Gp(e,n){return typeof e=="function"?e(...n):!!e}function $4(e,n,a){let r=!1,s;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(s??(s=n()),r||(r=!0,s.aborted?a():s.addEventListener("abort",a,{once:!0})),s)}),e}var Kl,Ui,dc,N2,G4=(N2=class extends Dc{constructor(){super();at(this,Kl);at(this,Ui);at(this,dc);$e(this,dc,n=>{if(!ao&&window.addEventListener){const a=()=>n();return window.addEventListener("visibilitychange",a,!1),()=>{window.removeEventListener("visibilitychange",a)}}})}onSubscribe(){ce(this,Ui)||this.setEventListener(ce(this,dc))}onUnsubscribe(){var n;this.hasListeners()||((n=ce(this,Ui))==null||n.call(this),$e(this,Ui,void 0))}setEventListener(n){var a;$e(this,dc,n),(a=ce(this,Ui))==null||a.call(this),$e(this,Ui,n(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(n){ce(this,Kl)!==n&&($e(this,Kl,n),this.onFocus())}onFocus(){const n=this.isFocused();this.listeners.forEach(a=>{a(n)})}isFocused(){var n;return typeof ce(this,Kl)=="boolean"?ce(this,Kl):((n=globalThis.document)==null?void 0:n.visibilityState)!=="hidden"}},Kl=new WeakMap,Ui=new WeakMap,dc=new WeakMap,N2),qp=new G4;function Qf(){let e,n;const a=new Promise((s,l)=>{e=s,n=l});a.status="pending",a.catch(()=>{});function r(s){Object.assign(a,s),delete a.resolve,delete a.reject}return a.resolve=s=>{r({status:"fulfilled",value:s}),e(s)},a.reject=s=>{r({status:"rejected",reason:s}),n(s)},a}var q4=B4;function W4(){let e=[],n=0,a=d=>{d()},r=d=>{d()},s=q4;const l=d=>{n?e.push(d):s(()=>{a(d)})},o=()=>{const d=e;e=[],d.length&&s(()=>{r(()=>{d.forEach(u=>{a(u)})})})};return{batch:d=>{let u;n++;try{u=d()}finally{n--,n||o()}return u},batchCalls:d=>(...u)=>{l(()=>{d(...u)})},schedule:l,setNotifyFunction:d=>{a=d},setBatchNotifyFunction:d=>{r=d},setScheduler:d=>{s=d}}}var Kn=W4(),uc,Ki,hc,j2,X4=(j2=class extends Dc{constructor(){super();at(this,uc,!0);at(this,Ki);at(this,hc);$e(this,hc,n=>{if(!ao&&window.addEventListener){const a=()=>n(!0),r=()=>n(!1);return window.addEventListener("online",a,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",a),window.removeEventListener("offline",r)}}})}onSubscribe(){ce(this,Ki)||this.setEventListener(ce(this,hc))}onUnsubscribe(){var n;this.hasListeners()||((n=ce(this,Ki))==null||n.call(this),$e(this,Ki,void 0))}setEventListener(n){var a;$e(this,hc,n),(a=ce(this,Ki))==null||a.call(this),$e(this,Ki,n(this.setOnline.bind(this)))}setOnline(n){ce(this,uc)!==n&&($e(this,uc,n),this.listeners.forEach(r=>{r(n)}))}isOnline(){return ce(this,uc)}},uc=new WeakMap,Ki=new WeakMap,hc=new WeakMap,j2),p0=new X4;function Q4(e){return Math.min(1e3*2**e,3e4)}function O2(e){return(e??"online")==="online"?p0.isOnline():!0}var Yf=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function M2(e){let n=!1,a=0,r;const s=Qf(),l=()=>s.status!=="pending",o=g=>{var b;if(!l()){const j=new Yf(g);p(j),(b=e.onCancel)==null||b.call(e,j)}},d=()=>{n=!0},u=()=>{n=!1},x=()=>qp.isFocused()&&(e.networkMode==="always"||p0.isOnline())&&e.canRun(),m=()=>O2(e.networkMode)&&e.canRun(),f=g=>{l()||(r==null||r(),s.resolve(g))},p=g=>{l()||(r==null||r(),s.reject(g))},N=()=>new Promise(g=>{var b;r=j=>{(l()||x())&&g(j)},(b=e.onPause)==null||b.call(e)}).then(()=>{var g;r=void 0,l()||(g=e.onContinue)==null||g.call(e)}),y=()=>{if(l())return;let g;const b=a===0?e.initialPromise:void 0;try{g=b??e.fn()}catch(j){g=Promise.reject(j)}Promise.resolve(g).then(f).catch(j=>{var C;if(l())return;const T=e.retry??(ao?0:3),_=e.retryDelay??Q4,w=typeof _=="function"?_(a,j):_,E=T===!0||typeof T=="number"&&a<T||typeof T=="function"&&T(a,j);if(n||!E){p(j);return}a++,(C=e.onFail)==null||C.call(e,a,j),U4(w).then(()=>x()?void 0:N()).then(()=>{n?p(j):y()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r==null||r(),s),cancelRetry:d,continueRetry:u,canStart:m,start:()=>(m()?y():N().then(y),s)}}var zl,w2,R2=(w2=class{constructor(){at(this,zl)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),qf(this.gcTime)&&$e(this,zl,Bl.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(ao?1/0:300*1e3))}clearGcTimeout(){ce(this,zl)&&(Bl.clearTimeout(ce(this,zl)),$e(this,zl,void 0))}},zl=new WeakMap,w2),$l,xc,Lr,Gl,ea,hu,ql,Qr,$s,k2,Y4=(k2=class extends R2{constructor(n){super();at(this,Qr);at(this,$l);at(this,xc);at(this,Lr);at(this,Gl);at(this,ea);at(this,hu);at(this,ql);$e(this,ql,!1),$e(this,hu,n.defaultOptions),this.setOptions(n.options),this.observers=[],$e(this,Gl,n.client),$e(this,Lr,ce(this,Gl).getQueryCache()),this.queryKey=n.queryKey,this.queryHash=n.queryHash,$e(this,$l,q1(this.options)),this.state=n.state??ce(this,$l),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var n;return(n=ce(this,ea))==null?void 0:n.promise}setOptions(n){if(this.options={...ce(this,hu),...n},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const a=q1(this.options);a.data!==void 0&&(this.setState(G1(a.data,a.dataUpdatedAt)),$e(this,$l,a))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ce(this,Lr).remove(this)}setData(n,a){const r=Xf(this.state.data,n,this.options);return vt(this,Qr,$s).call(this,{data:r,type:"success",dataUpdatedAt:a==null?void 0:a.updatedAt,manual:a==null?void 0:a.manual}),r}setState(n,a){vt(this,Qr,$s).call(this,{type:"setState",state:n,setStateOptions:a})}cancel(n){var r,s;const a=(r=ce(this,ea))==null?void 0:r.promise;return(s=ce(this,ea))==null||s.cancel(n),a?a.then(Ia).catch(Ia):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ce(this,$l))}isActive(){return this.observers.some(n=>Ir(n.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===$p||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(n=>nl(n.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(n=>n.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(n=0){return this.state.data===void 0?!0:n==="static"?!1:this.state.isInvalidated?!0:!L2(this.state.dataUpdatedAt,n)}onFocus(){var a;const n=this.observers.find(r=>r.shouldFetchOnWindowFocus());n==null||n.refetch({cancelRefetch:!1}),(a=ce(this,ea))==null||a.continue()}onOnline(){var a;const n=this.observers.find(r=>r.shouldFetchOnReconnect());n==null||n.refetch({cancelRefetch:!1}),(a=ce(this,ea))==null||a.continue()}addObserver(n){this.observers.includes(n)||(this.observers.push(n),this.clearGcTimeout(),ce(this,Lr).notify({type:"observerAdded",query:this,observer:n}))}removeObserver(n){this.observers.includes(n)&&(this.observers=this.observers.filter(a=>a!==n),this.observers.length||(ce(this,ea)&&(ce(this,ql)?ce(this,ea).cancel({revert:!0}):ce(this,ea).cancelRetry()),this.scheduleGc()),ce(this,Lr).notify({type:"observerRemoved",query:this,observer:n}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||vt(this,Qr,$s).call(this,{type:"invalidate"})}async fetch(n,a){var u,x,m,f,p,N,y,g,b,j,T,_;if(this.state.fetchStatus!=="idle"&&((u=ce(this,ea))==null?void 0:u.status())!=="rejected"){if(this.state.data!==void 0&&(a!=null&&a.cancelRefetch))this.cancel({silent:!0});else if(ce(this,ea))return ce(this,ea).continueRetry(),ce(this,ea).promise}if(n&&this.setOptions(n),!this.options.queryFn){const w=this.observers.find(E=>E.options.queryFn);w&&this.setOptions(w.options)}const r=new AbortController,s=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>($e(this,ql,!0),r.signal)})},l=()=>{const w=I2(this.options,a),C=(()=>{const S={client:ce(this,Gl),queryKey:this.queryKey,meta:this.meta};return s(S),S})();return $e(this,ql,!1),this.options.persister?this.options.persister(w,C,this):w(C)},d=(()=>{const w={fetchOptions:a,options:this.options,queryKey:this.queryKey,client:ce(this,Gl),state:this.state,fetchFn:l};return s(w),w})();(x=this.options.behavior)==null||x.onFetch(d,this),$e(this,xc,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((m=d.fetchOptions)==null?void 0:m.meta))&&vt(this,Qr,$s).call(this,{type:"fetch",meta:(f=d.fetchOptions)==null?void 0:f.meta}),$e(this,ea,M2({initialPromise:a==null?void 0:a.initialPromise,fn:d.fetchFn,onCancel:w=>{w instanceof Yf&&w.revert&&this.setState({...ce(this,xc),fetchStatus:"idle"}),r.abort()},onFail:(w,E)=>{vt(this,Qr,$s).call(this,{type:"failed",failureCount:w,error:E})},onPause:()=>{vt(this,Qr,$s).call(this,{type:"pause"})},onContinue:()=>{vt(this,Qr,$s).call(this,{type:"continue"})},retry:d.options.retry,retryDelay:d.options.retryDelay,networkMode:d.options.networkMode,canRun:()=>!0}));try{const w=await ce(this,ea).start();if(w===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(w),(N=(p=ce(this,Lr).config).onSuccess)==null||N.call(p,w,this),(g=(y=ce(this,Lr).config).onSettled)==null||g.call(y,w,this.state.error,this),w}catch(w){if(w instanceof Yf){if(w.silent)return ce(this,ea).promise;if(w.revert){if(this.state.data===void 0)throw w;return this.state.data}}throw vt(this,Qr,$s).call(this,{type:"error",error:w}),(j=(b=ce(this,Lr).config).onError)==null||j.call(b,w,this),(_=(T=ce(this,Lr).config).onSettled)==null||_.call(T,this.state.data,w,this),w}finally{this.scheduleGc()}}},$l=new WeakMap,xc=new WeakMap,Lr=new WeakMap,Gl=new WeakMap,ea=new WeakMap,hu=new WeakMap,ql=new WeakMap,Qr=new WeakSet,$s=function(n){const a=r=>{switch(n.type){case"failed":return{...r,fetchFailureCount:n.failureCount,fetchFailureReason:n.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...B2(r.data,this.options),fetchMeta:n.meta??null};case"success":const s={...r,...G1(n.data,n.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!n.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return $e(this,xc,n.manual?s:void 0),s;case"error":const l=n.error;return{...r,error:l,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...n.state}}};this.state=a(this.state),Kn.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),ce(this,Lr).notify({query:this,type:"updated",action:n})})},k2);function B2(e,n){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:O2(n.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function G1(e,n){return{data:e,dataUpdatedAt:n??Date.now(),error:null,isInvalidated:!1,status:"success"}}function q1(e){const n=typeof e.initialData=="function"?e.initialData():e.initialData,a=n!==void 0,r=a?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:n,dataUpdateCount:0,dataUpdatedAt:a?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:a?"success":"pending",fetchStatus:"idle"}}var qa,Ct,xu,La,Wl,mc,Ws,zi,mu,fc,pc,Xl,Ql,$i,gc,Ut,Dd,Jf,Zf,ep,tp,np,ap,rp,H2,T2,J4=(T2=class extends Dc{constructor(n,a){super();at(this,Ut);at(this,qa);at(this,Ct);at(this,xu);at(this,La);at(this,Wl);at(this,mc);at(this,Ws);at(this,zi);at(this,mu);at(this,fc);at(this,pc);at(this,Xl);at(this,Ql);at(this,$i);at(this,gc,new Set);this.options=a,$e(this,qa,n),$e(this,zi,null),$e(this,Ws,Qf()),this.bindMethods(),this.setOptions(a)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(ce(this,Ct).addObserver(this),W1(ce(this,Ct),this.options)?vt(this,Ut,Dd).call(this):this.updateResult(),vt(this,Ut,tp).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return sp(ce(this,Ct),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return sp(ce(this,Ct),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,vt(this,Ut,np).call(this),vt(this,Ut,ap).call(this),ce(this,Ct).removeObserver(this)}setOptions(n){const a=this.options,r=ce(this,Ct);if(this.options=ce(this,qa).defaultQueryOptions(n),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Ir(this.options.enabled,ce(this,Ct))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");vt(this,Ut,rp).call(this),ce(this,Ct).setOptions(this.options),a._defaulted&&!f0(this.options,a)&&ce(this,qa).getQueryCache().notify({type:"observerOptionsUpdated",query:ce(this,Ct),observer:this});const s=this.hasListeners();s&&X1(ce(this,Ct),r,this.options,a)&&vt(this,Ut,Dd).call(this),this.updateResult(),s&&(ce(this,Ct)!==r||Ir(this.options.enabled,ce(this,Ct))!==Ir(a.enabled,ce(this,Ct))||nl(this.options.staleTime,ce(this,Ct))!==nl(a.staleTime,ce(this,Ct)))&&vt(this,Ut,Jf).call(this);const l=vt(this,Ut,Zf).call(this);s&&(ce(this,Ct)!==r||Ir(this.options.enabled,ce(this,Ct))!==Ir(a.enabled,ce(this,Ct))||l!==ce(this,$i))&&vt(this,Ut,ep).call(this,l)}getOptimisticResult(n){const a=ce(this,qa).getQueryCache().build(ce(this,qa),n),r=this.createResult(a,n);return eS(this,r)&&($e(this,La,r),$e(this,mc,this.options),$e(this,Wl,ce(this,Ct).state)),r}getCurrentResult(){return ce(this,La)}trackResult(n,a){return new Proxy(n,{get:(r,s)=>(this.trackProp(s),a==null||a(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&ce(this,Ws).status==="pending"&&ce(this,Ws).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,s))})}trackProp(n){ce(this,gc).add(n)}getCurrentQuery(){return ce(this,Ct)}refetch({...n}={}){return this.fetch({...n})}fetchOptimistic(n){const a=ce(this,qa).defaultQueryOptions(n),r=ce(this,qa).getQueryCache().build(ce(this,qa),a);return r.fetch().then(()=>this.createResult(r,a))}fetch(n){return vt(this,Ut,Dd).call(this,{...n,cancelRefetch:n.cancelRefetch??!0}).then(()=>(this.updateResult(),ce(this,La)))}createResult(n,a){var F;const r=ce(this,Ct),s=this.options,l=ce(this,La),o=ce(this,Wl),d=ce(this,mc),x=n!==r?n.state:ce(this,xu),{state:m}=n;let f={...m},p=!1,N;if(a._optimisticResults){const B=this.hasListeners(),O=!B&&W1(n,a),M=B&&X1(n,r,a,s);(O||M)&&(f={...f,...B2(m.data,n.options)}),a._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:y,errorUpdatedAt:g,status:b}=f;N=f.data;let j=!1;if(a.placeholderData!==void 0&&N===void 0&&b==="pending"){let B;l!=null&&l.isPlaceholderData&&a.placeholderData===(d==null?void 0:d.placeholderData)?(B=l.data,j=!0):B=typeof a.placeholderData=="function"?a.placeholderData((F=ce(this,pc))==null?void 0:F.state.data,ce(this,pc)):a.placeholderData,B!==void 0&&(b="success",N=Xf(l==null?void 0:l.data,B,a),p=!0)}if(a.select&&N!==void 0&&!j)if(l&&N===(o==null?void 0:o.data)&&a.select===ce(this,mu))N=ce(this,fc);else try{$e(this,mu,a.select),N=a.select(N),N=Xf(l==null?void 0:l.data,N,a),$e(this,fc,N),$e(this,zi,null)}catch(B){$e(this,zi,B)}ce(this,zi)&&(y=ce(this,zi),N=ce(this,fc),g=Date.now(),b="error");const T=f.fetchStatus==="fetching",_=b==="pending",w=b==="error",E=_&&T,C=N!==void 0,P={status:b,fetchStatus:f.fetchStatus,isPending:_,isSuccess:b==="success",isError:w,isInitialLoading:E,isLoading:E,data:N,dataUpdatedAt:f.dataUpdatedAt,error:y,errorUpdatedAt:g,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>x.dataUpdateCount||f.errorUpdateCount>x.errorUpdateCount,isFetching:T,isRefetching:T&&!_,isLoadingError:w&&!C,isPaused:f.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:w&&C,isStale:Wp(n,a),refetch:this.refetch,promise:ce(this,Ws),isEnabled:Ir(a.enabled,n)!==!1};if(this.options.experimental_prefetchInRender){const B=G=>{P.status==="error"?G.reject(P.error):P.data!==void 0&&G.resolve(P.data)},O=()=>{const G=$e(this,Ws,P.promise=Qf());B(G)},M=ce(this,Ws);switch(M.status){case"pending":n.queryHash===r.queryHash&&B(M);break;case"fulfilled":(P.status==="error"||P.data!==M.value)&&O();break;case"rejected":(P.status!=="error"||P.error!==M.reason)&&O();break}}return P}updateResult(){const n=ce(this,La),a=this.createResult(ce(this,Ct),this.options);if($e(this,Wl,ce(this,Ct).state),$e(this,mc,this.options),ce(this,Wl).data!==void 0&&$e(this,pc,ce(this,Ct)),f0(a,n))return;$e(this,La,a);const r=()=>{if(!n)return!0;const{notifyOnChangeProps:s}=this.options,l=typeof s=="function"?s():s;if(l==="all"||!l&&!ce(this,gc).size)return!0;const o=new Set(l??ce(this,gc));return this.options.throwOnError&&o.add("error"),Object.keys(ce(this,La)).some(d=>{const u=d;return ce(this,La)[u]!==n[u]&&o.has(u)})};vt(this,Ut,H2).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&vt(this,Ut,tp).call(this)}},qa=new WeakMap,Ct=new WeakMap,xu=new WeakMap,La=new WeakMap,Wl=new WeakMap,mc=new WeakMap,Ws=new WeakMap,zi=new WeakMap,mu=new WeakMap,fc=new WeakMap,pc=new WeakMap,Xl=new WeakMap,Ql=new WeakMap,$i=new WeakMap,gc=new WeakMap,Ut=new WeakSet,Dd=function(n){vt(this,Ut,rp).call(this);let a=ce(this,Ct).fetch(this.options,n);return n!=null&&n.throwOnError||(a=a.catch(Ia)),a},Jf=function(){vt(this,Ut,np).call(this);const n=nl(this.options.staleTime,ce(this,Ct));if(ao||ce(this,La).isStale||!qf(n))return;const r=L2(ce(this,La).dataUpdatedAt,n)+1;$e(this,Xl,Bl.setTimeout(()=>{ce(this,La).isStale||this.updateResult()},r))},Zf=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(ce(this,Ct)):this.options.refetchInterval)??!1},ep=function(n){vt(this,Ut,ap).call(this),$e(this,$i,n),!(ao||Ir(this.options.enabled,ce(this,Ct))===!1||!qf(ce(this,$i))||ce(this,$i)===0)&&$e(this,Ql,Bl.setInterval(()=>{(this.options.refetchIntervalInBackground||qp.isFocused())&&vt(this,Ut,Dd).call(this)},ce(this,$i)))},tp=function(){vt(this,Ut,Jf).call(this),vt(this,Ut,ep).call(this,vt(this,Ut,Zf).call(this))},np=function(){ce(this,Xl)&&(Bl.clearTimeout(ce(this,Xl)),$e(this,Xl,void 0))},ap=function(){ce(this,Ql)&&(Bl.clearInterval(ce(this,Ql)),$e(this,Ql,void 0))},rp=function(){const n=ce(this,qa).getQueryCache().build(ce(this,qa),this.options);if(n===ce(this,Ct))return;const a=ce(this,Ct);$e(this,Ct,n),$e(this,xu,n.state),this.hasListeners()&&(a==null||a.removeObserver(this),n.addObserver(this))},H2=function(n){Kn.batch(()=>{n.listeners&&this.listeners.forEach(a=>{a(ce(this,La))}),ce(this,qa).getQueryCache().notify({query:ce(this,Ct),type:"observerResultsUpdated"})})},T2);function Z4(e,n){return Ir(n.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&n.retryOnMount===!1)}function W1(e,n){return Z4(e,n)||e.state.data!==void 0&&sp(e,n,n.refetchOnMount)}function sp(e,n,a){if(Ir(n.enabled,e)!==!1&&nl(n.staleTime,e)!=="static"){const r=typeof a=="function"?a(e):a;return r==="always"||r!==!1&&Wp(e,n)}return!1}function X1(e,n,a,r){return(e!==n||Ir(r.enabled,e)===!1)&&(!a.suspense||e.state.status!=="error")&&Wp(e,a)}function Wp(e,n){return Ir(n.enabled,e)!==!1&&e.isStaleByTime(nl(n.staleTime,e))}function eS(e,n){return!f0(e.getCurrentResult(),n)}function Q1(e){return{onFetch:(n,a)=>{var m,f,p,N,y;const r=n.options,s=(p=(f=(m=n.fetchOptions)==null?void 0:m.meta)==null?void 0:f.fetchMore)==null?void 0:p.direction,l=((N=n.state.data)==null?void 0:N.pages)||[],o=((y=n.state.data)==null?void 0:y.pageParams)||[];let d={pages:[],pageParams:[]},u=0;const x=async()=>{let g=!1;const b=_=>{$4(_,()=>n.signal,()=>g=!0)},j=I2(n.options,n.fetchOptions),T=async(_,w,E)=>{if(g)return Promise.reject();if(w==null&&_.pages.length)return Promise.resolve(_);const S=(()=>{const O={client:n.client,queryKey:n.queryKey,pageParam:w,direction:E?"backward":"forward",meta:n.options.meta};return b(O),O})(),P=await j(S),{maxPages:F}=n.options,B=E?z4:K4;return{pages:B(_.pages,P,F),pageParams:B(_.pageParams,w,F)}};if(s&&l.length){const _=s==="backward",w=_?tS:Y1,E={pages:l,pageParams:o},C=w(r,E);d=await T(E,C,_)}else{const _=e??l.length;do{const w=u===0?o[0]??r.initialPageParam:Y1(r,d);if(u>0&&w==null)break;d=await T(d,w),u++}while(u<_)}return d};n.options.persister?n.fetchFn=()=>{var g,b;return(b=(g=n.options).persister)==null?void 0:b.call(g,x,{client:n.client,queryKey:n.queryKey,meta:n.options.meta,signal:n.signal},a)}:n.fetchFn=x}}}function Y1(e,{pages:n,pageParams:a}){const r=n.length-1;return n.length>0?e.getNextPageParam(n[r],n,a[r],a):void 0}function tS(e,{pages:n,pageParams:a}){var r;return n.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,n[0],n,a[0],a):void 0}var fu,bs,Pa,Yl,Ns,Bi,C2,nS=(C2=class extends R2{constructor(n){super();at(this,Ns);at(this,fu);at(this,bs);at(this,Pa);at(this,Yl);$e(this,fu,n.client),this.mutationId=n.mutationId,$e(this,Pa,n.mutationCache),$e(this,bs,[]),this.state=n.state||V2(),this.setOptions(n.options),this.scheduleGc()}setOptions(n){this.options=n,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(n){ce(this,bs).includes(n)||(ce(this,bs).push(n),this.clearGcTimeout(),ce(this,Pa).notify({type:"observerAdded",mutation:this,observer:n}))}removeObserver(n){$e(this,bs,ce(this,bs).filter(a=>a!==n)),this.scheduleGc(),ce(this,Pa).notify({type:"observerRemoved",mutation:this,observer:n})}optionalRemove(){ce(this,bs).length||(this.state.status==="pending"?this.scheduleGc():ce(this,Pa).remove(this))}continue(){var n;return((n=ce(this,Yl))==null?void 0:n.continue())??this.execute(this.state.variables)}async execute(n){var o,d,u,x,m,f,p,N,y,g,b,j,T,_,w,E,C,S,P,F;const a=()=>{vt(this,Ns,Bi).call(this,{type:"continue"})},r={client:ce(this,fu),meta:this.options.meta,mutationKey:this.options.mutationKey};$e(this,Yl,M2({fn:()=>this.options.mutationFn?this.options.mutationFn(n,r):Promise.reject(new Error("No mutationFn found")),onFail:(B,O)=>{vt(this,Ns,Bi).call(this,{type:"failed",failureCount:B,error:O})},onPause:()=>{vt(this,Ns,Bi).call(this,{type:"pause"})},onContinue:a,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ce(this,Pa).canRun(this)}));const s=this.state.status==="pending",l=!ce(this,Yl).canStart();try{if(s)a();else{vt(this,Ns,Bi).call(this,{type:"pending",variables:n,isPaused:l}),await((d=(o=ce(this,Pa).config).onMutate)==null?void 0:d.call(o,n,this,r));const O=await((x=(u=this.options).onMutate)==null?void 0:x.call(u,n,r));O!==this.state.context&&vt(this,Ns,Bi).call(this,{type:"pending",context:O,variables:n,isPaused:l})}const B=await ce(this,Yl).start();return await((f=(m=ce(this,Pa).config).onSuccess)==null?void 0:f.call(m,B,n,this.state.context,this,r)),await((N=(p=this.options).onSuccess)==null?void 0:N.call(p,B,n,this.state.context,r)),await((g=(y=ce(this,Pa).config).onSettled)==null?void 0:g.call(y,B,null,this.state.variables,this.state.context,this,r)),await((j=(b=this.options).onSettled)==null?void 0:j.call(b,B,null,n,this.state.context,r)),vt(this,Ns,Bi).call(this,{type:"success",data:B}),B}catch(B){try{await((_=(T=ce(this,Pa).config).onError)==null?void 0:_.call(T,B,n,this.state.context,this,r))}catch(O){Promise.reject(O)}try{await((E=(w=this.options).onError)==null?void 0:E.call(w,B,n,this.state.context,r))}catch(O){Promise.reject(O)}try{await((S=(C=ce(this,Pa).config).onSettled)==null?void 0:S.call(C,void 0,B,this.state.variables,this.state.context,this,r))}catch(O){Promise.reject(O)}try{await((F=(P=this.options).onSettled)==null?void 0:F.call(P,void 0,B,n,this.state.context,r))}catch(O){Promise.reject(O)}throw vt(this,Ns,Bi).call(this,{type:"error",error:B}),B}finally{ce(this,Pa).runNext(this)}}},fu=new WeakMap,bs=new WeakMap,Pa=new WeakMap,Yl=new WeakMap,Ns=new WeakSet,Bi=function(n){const a=r=>{switch(n.type){case"failed":return{...r,failureCount:n.failureCount,failureReason:n.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:n.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:n.isPaused,status:"pending",variables:n.variables,submittedAt:Date.now()};case"success":return{...r,data:n.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:n.error,failureCount:r.failureCount+1,failureReason:n.error,isPaused:!1,status:"error"}}};this.state=a(this.state),Kn.batch(()=>{ce(this,bs).forEach(r=>{r.onMutationUpdate(n)}),ce(this,Pa).notify({mutation:this,type:"updated",action:n})})},C2);function V2(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Xs,Yr,pu,S2,aS=(S2=class extends Dc{constructor(n={}){super();at(this,Xs);at(this,Yr);at(this,pu);this.config=n,$e(this,Xs,new Set),$e(this,Yr,new Map),$e(this,pu,0)}build(n,a,r){const s=new nS({client:n,mutationCache:this,mutationId:++Uh(this,pu)._,options:n.defaultMutationOptions(a),state:r});return this.add(s),s}add(n){ce(this,Xs).add(n);const a=zh(n);if(typeof a=="string"){const r=ce(this,Yr).get(a);r?r.push(n):ce(this,Yr).set(a,[n])}this.notify({type:"added",mutation:n})}remove(n){if(ce(this,Xs).delete(n)){const a=zh(n);if(typeof a=="string"){const r=ce(this,Yr).get(a);if(r)if(r.length>1){const s=r.indexOf(n);s!==-1&&r.splice(s,1)}else r[0]===n&&ce(this,Yr).delete(a)}}this.notify({type:"removed",mutation:n})}canRun(n){const a=zh(n);if(typeof a=="string"){const r=ce(this,Yr).get(a),s=r==null?void 0:r.find(l=>l.state.status==="pending");return!s||s===n}else return!0}runNext(n){var r;const a=zh(n);if(typeof a=="string"){const s=(r=ce(this,Yr).get(a))==null?void 0:r.find(l=>l!==n&&l.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Kn.batch(()=>{ce(this,Xs).forEach(n=>{this.notify({type:"removed",mutation:n})}),ce(this,Xs).clear(),ce(this,Yr).clear()})}getAll(){return Array.from(ce(this,Xs))}find(n){const a={exact:!0,...n};return this.getAll().find(r=>K1(a,r))}findAll(n={}){return this.getAll().filter(a=>K1(n,a))}notify(n){Kn.batch(()=>{this.listeners.forEach(a=>{a(n)})})}resumePausedMutations(){const n=this.getAll().filter(a=>a.state.isPaused);return Kn.batch(()=>Promise.all(n.map(a=>a.continue().catch(Ia))))}},Xs=new WeakMap,Yr=new WeakMap,pu=new WeakMap,S2);function zh(e){var n;return(n=e.options.scope)==null?void 0:n.id}var Qs,Gi,Wa,Ys,ii,o0,ip,_2,rS=(_2=class extends Dc{constructor(a,r){super();at(this,ii);at(this,Qs);at(this,Gi);at(this,Wa);at(this,Ys);$e(this,Qs,a),this.setOptions(r),this.bindMethods(),vt(this,ii,o0).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(a){var s;const r=this.options;this.options=ce(this,Qs).defaultMutationOptions(a),f0(this.options,r)||ce(this,Qs).getMutationCache().notify({type:"observerOptionsUpdated",mutation:ce(this,Wa),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&ro(r.mutationKey)!==ro(this.options.mutationKey)?this.reset():((s=ce(this,Wa))==null?void 0:s.state.status)==="pending"&&ce(this,Wa).setOptions(this.options)}onUnsubscribe(){var a;this.hasListeners()||(a=ce(this,Wa))==null||a.removeObserver(this)}onMutationUpdate(a){vt(this,ii,o0).call(this),vt(this,ii,ip).call(this,a)}getCurrentResult(){return ce(this,Gi)}reset(){var a;(a=ce(this,Wa))==null||a.removeObserver(this),$e(this,Wa,void 0),vt(this,ii,o0).call(this),vt(this,ii,ip).call(this)}mutate(a,r){var s;return $e(this,Ys,r),(s=ce(this,Wa))==null||s.removeObserver(this),$e(this,Wa,ce(this,Qs).getMutationCache().build(ce(this,Qs),this.options)),ce(this,Wa).addObserver(this),ce(this,Wa).execute(a)}},Qs=new WeakMap,Gi=new WeakMap,Wa=new WeakMap,Ys=new WeakMap,ii=new WeakSet,o0=function(){var r;const a=((r=ce(this,Wa))==null?void 0:r.state)??V2();$e(this,Gi,{...a,isPending:a.status==="pending",isSuccess:a.status==="success",isError:a.status==="error",isIdle:a.status==="idle",mutate:this.mutate,reset:this.reset})},ip=function(a){Kn.batch(()=>{var r,s,l,o,d,u,x,m;if(ce(this,Ys)&&this.hasListeners()){const f=ce(this,Gi).variables,p=ce(this,Gi).context,N={client:ce(this,Qs),meta:this.options.meta,mutationKey:this.options.mutationKey};if((a==null?void 0:a.type)==="success"){try{(s=(r=ce(this,Ys)).onSuccess)==null||s.call(r,a.data,f,p,N)}catch(y){Promise.reject(y)}try{(o=(l=ce(this,Ys)).onSettled)==null||o.call(l,a.data,null,f,p,N)}catch(y){Promise.reject(y)}}else if((a==null?void 0:a.type)==="error"){try{(u=(d=ce(this,Ys)).onError)==null||u.call(d,a.error,f,p,N)}catch(y){Promise.reject(y)}try{(m=(x=ce(this,Ys)).onSettled)==null||m.call(x,void 0,a.error,f,p,N)}catch(y){Promise.reject(y)}}}this.listeners.forEach(f=>{f(ce(this,Gi))})})},_2),js,E2,sS=(E2=class extends Dc{constructor(n={}){super();at(this,js);this.config=n,$e(this,js,new Map)}build(n,a,r){const s=a.queryKey,l=a.queryHash??zp(s,a);let o=this.get(l);return o||(o=new Y4({client:n,queryKey:s,queryHash:l,options:n.defaultQueryOptions(a),state:r,defaultOptions:n.getQueryDefaults(s)}),this.add(o)),o}add(n){ce(this,js).has(n.queryHash)||(ce(this,js).set(n.queryHash,n),this.notify({type:"added",query:n}))}remove(n){const a=ce(this,js).get(n.queryHash);a&&(n.destroy(),a===n&&ce(this,js).delete(n.queryHash),this.notify({type:"removed",query:n}))}clear(){Kn.batch(()=>{this.getAll().forEach(n=>{this.remove(n)})})}get(n){return ce(this,js).get(n)}getAll(){return[...ce(this,js).values()]}find(n){const a={exact:!0,...n};return this.getAll().find(r=>U1(a,r))}findAll(n={}){const a=this.getAll();return Object.keys(n).length>0?a.filter(r=>U1(n,r)):a}notify(n){Kn.batch(()=>{this.listeners.forEach(a=>{a(n)})})}onFocus(){Kn.batch(()=>{this.getAll().forEach(n=>{n.onFocus()})})}onOnline(){Kn.batch(()=>{this.getAll().forEach(n=>{n.onOnline()})})}},js=new WeakMap,E2),Nn,qi,Wi,yc,vc,Xi,bc,Nc,D2,iS=(D2=class{constructor(e={}){at(this,Nn);at(this,qi);at(this,Wi);at(this,yc);at(this,vc);at(this,Xi);at(this,bc);at(this,Nc);$e(this,Nn,e.queryCache||new sS),$e(this,qi,e.mutationCache||new aS),$e(this,Wi,e.defaultOptions||{}),$e(this,yc,new Map),$e(this,vc,new Map),$e(this,Xi,0)}mount(){Uh(this,Xi)._++,ce(this,Xi)===1&&($e(this,bc,qp.subscribe(async e=>{e&&(await this.resumePausedMutations(),ce(this,Nn).onFocus())})),$e(this,Nc,p0.subscribe(async e=>{e&&(await this.resumePausedMutations(),ce(this,Nn).onOnline())})))}unmount(){var e,n;Uh(this,Xi)._--,ce(this,Xi)===0&&((e=ce(this,bc))==null||e.call(this),$e(this,bc,void 0),(n=ce(this,Nc))==null||n.call(this),$e(this,Nc,void 0))}isFetching(e){return ce(this,Nn).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ce(this,qi).findAll({...e,status:"pending"}).length}getQueryData(e){var a;const n=this.defaultQueryOptions({queryKey:e});return(a=ce(this,Nn).get(n.queryHash))==null?void 0:a.state.data}ensureQueryData(e){const n=this.defaultQueryOptions(e),a=ce(this,Nn).build(this,n),r=a.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&a.isStaleByTime(nl(n.staleTime,a))&&this.prefetchQuery(n),Promise.resolve(r))}getQueriesData(e){return ce(this,Nn).findAll(e).map(({queryKey:n,state:a})=>{const r=a.data;return[n,r]})}setQueryData(e,n,a){const r=this.defaultQueryOptions({queryKey:e}),s=ce(this,Nn).get(r.queryHash),l=s==null?void 0:s.state.data,o=H4(n,l);if(o!==void 0)return ce(this,Nn).build(this,r).setData(o,{...a,manual:!0})}setQueriesData(e,n,a){return Kn.batch(()=>ce(this,Nn).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,n,a)]))}getQueryState(e){var a;const n=this.defaultQueryOptions({queryKey:e});return(a=ce(this,Nn).get(n.queryHash))==null?void 0:a.state}removeQueries(e){const n=ce(this,Nn);Kn.batch(()=>{n.findAll(e).forEach(a=>{n.remove(a)})})}resetQueries(e,n){const a=ce(this,Nn);return Kn.batch(()=>(a.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},n)))}cancelQueries(e,n={}){const a={revert:!0,...n},r=Kn.batch(()=>ce(this,Nn).findAll(e).map(s=>s.cancel(a)));return Promise.all(r).then(Ia).catch(Ia)}invalidateQueries(e,n={}){return Kn.batch(()=>(ce(this,Nn).findAll(e).forEach(a=>{a.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},n)))}refetchQueries(e,n={}){const a={...n,cancelRefetch:n.cancelRefetch??!0},r=Kn.batch(()=>ce(this,Nn).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let l=s.fetch(void 0,a);return a.throwOnError||(l=l.catch(Ia)),s.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(r).then(Ia)}fetchQuery(e){const n=this.defaultQueryOptions(e);n.retry===void 0&&(n.retry=!1);const a=ce(this,Nn).build(this,n);return a.isStaleByTime(nl(n.staleTime,a))?a.fetch(n):Promise.resolve(a.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Ia).catch(Ia)}fetchInfiniteQuery(e){return e.behavior=Q1(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Ia).catch(Ia)}ensureInfiniteQueryData(e){return e.behavior=Q1(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return p0.isOnline()?ce(this,qi).resumePausedMutations():Promise.resolve()}getQueryCache(){return ce(this,Nn)}getMutationCache(){return ce(this,qi)}getDefaultOptions(){return ce(this,Wi)}setDefaultOptions(e){$e(this,Wi,e)}setQueryDefaults(e,n){ce(this,yc).set(ro(e),{queryKey:e,defaultOptions:n})}getQueryDefaults(e){const n=[...ce(this,yc).values()],a={};return n.forEach(r=>{qd(e,r.queryKey)&&Object.assign(a,r.defaultOptions)}),a}setMutationDefaults(e,n){ce(this,vc).set(ro(e),{mutationKey:e,defaultOptions:n})}getMutationDefaults(e){const n=[...ce(this,vc).values()],a={};return n.forEach(r=>{qd(e,r.mutationKey)&&Object.assign(a,r.defaultOptions)}),a}defaultQueryOptions(e){if(e._defaulted)return e;const n={...ce(this,Wi).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return n.queryHash||(n.queryHash=zp(n.queryKey,n)),n.refetchOnReconnect===void 0&&(n.refetchOnReconnect=n.networkMode!=="always"),n.throwOnError===void 0&&(n.throwOnError=!!n.suspense),!n.networkMode&&n.persister&&(n.networkMode="offlineFirst"),n.queryFn===$p&&(n.enabled=!1),n}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ce(this,Wi).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ce(this,Nn).clear(),ce(this,qi).clear()}},Nn=new WeakMap,qi=new WeakMap,Wi=new WeakMap,yc=new WeakMap,vc=new WeakMap,Xi=new WeakMap,bc=new WeakMap,Nc=new WeakMap,D2),U2=D.createContext(void 0),Mt=e=>{const n=D.useContext(U2);if(!n)throw new Error("No QueryClient set, use QueryClientProvider to set one");return n},lS=({client:e,children:n})=>(D.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),t.jsx(U2.Provider,{value:e,children:n})),K2=D.createContext(!1),oS=()=>D.useContext(K2);K2.Provider;function cS(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var dS=D.createContext(cS()),uS=()=>D.useContext(dS),hS=(e,n,a)=>{const r=a!=null&&a.state.error&&typeof e.throwOnError=="function"?Gp(e.throwOnError,[a.state.error,a]):e.throwOnError;(e.suspense||e.experimental_prefetchInRender||r)&&(n.isReset()||(e.retryOnMount=!1))},xS=e=>{D.useEffect(()=>{e.clearReset()},[e])},mS=({result:e,errorResetBoundary:n,throwOnError:a,query:r,suspense:s})=>e.isError&&!n.isReset()&&!e.isFetching&&r&&(s&&e.data===void 0||Gp(a,[e.error,r])),fS=e=>{if(e.suspense){const a=s=>s==="static"?s:Math.max(s??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...s)=>a(r(...s)):a(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},pS=(e,n)=>e.isLoading&&e.isFetching&&!n,gS=(e,n)=>(e==null?void 0:e.suspense)&&n.isPending,J1=(e,n,a)=>n.fetchOptimistic(e).catch(()=>{a.clearReset()});function yS(e,n,a){var p,N,y,g;const r=oS(),s=uS(),l=Mt(),o=l.defaultQueryOptions(e);(N=(p=l.getDefaultOptions().queries)==null?void 0:p._experimental_beforeQuery)==null||N.call(p,o);const d=l.getQueryCache().get(o.queryHash);o._optimisticResults=r?"isRestoring":"optimistic",fS(o),hS(o,s,d),xS(s);const u=!l.getQueryCache().get(o.queryHash),[x]=D.useState(()=>new n(l,o)),m=x.getOptimisticResult(o),f=!r&&e.subscribed!==!1;if(D.useSyncExternalStore(D.useCallback(b=>{const j=f?x.subscribe(Kn.batchCalls(b)):Ia;return x.updateResult(),j},[x,f]),()=>x.getCurrentResult(),()=>x.getCurrentResult()),D.useEffect(()=>{x.setOptions(o)},[o,x]),gS(o,m))throw J1(o,x,s);if(mS({result:m,errorResetBoundary:s,throwOnError:o.throwOnError,query:d,suspense:o.suspense}))throw m.error;if((g=(y=l.getDefaultOptions().queries)==null?void 0:y._experimental_afterQuery)==null||g.call(y,o,m),o.experimental_prefetchInRender&&!ao&&pS(m,r)){const b=u?J1(o,x,s):d==null?void 0:d.promise;b==null||b.catch(Ia).finally(()=>{x.updateResult()})}return o.notifyOnChangeProps?m:x.trackResult(m)}function Fe(e,n){return yS(e,J4)}function Ee(e,n){const a=Mt(),[r]=D.useState(()=>new rS(a,e));D.useEffect(()=>{r.setOptions(e)},[r,e]);const s=D.useSyncExternalStore(D.useCallback(o=>r.subscribe(Kn.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),l=D.useCallback((o,d)=>{r.mutate(o,d).catch(Ia)},[r]);if(s.error&&Gp(r.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:l,mutateAsync:s.mutate}}var vS=F2();/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wd(){return Wd=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},Wd.apply(this,arguments)}var Qi;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Qi||(Qi={}));const Z1="popstate";function bS(e){e===void 0&&(e={});function n(r,s){let{pathname:l,search:o,hash:d}=r.location;return lp("",{pathname:l,search:o,hash:d},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function a(r,s){return typeof s=="string"?s:g0(s)}return jS(n,a,null,e)}function Fn(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function Xp(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function NS(){return Math.random().toString(36).substr(2,8)}function eb(e,n){return{usr:e.state,key:e.key,idx:n}}function lp(e,n,a,r){return a===void 0&&(a=null),Wd({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof n=="string"?Ac(n):n,{state:a,key:n&&n.key||r||NS()})}function g0(e){let{pathname:n="/",search:a="",hash:r=""}=e;return a&&a!=="?"&&(n+=a.charAt(0)==="?"?a:"?"+a),r&&r!=="#"&&(n+=r.charAt(0)==="#"?r:"#"+r),n}function Ac(e){let n={};if(e){let a=e.indexOf("#");a>=0&&(n.hash=e.substr(a),e=e.substr(0,a));let r=e.indexOf("?");r>=0&&(n.search=e.substr(r),e=e.substr(0,r)),e&&(n.pathname=e)}return n}function jS(e,n,a,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:l=!1}=r,o=s.history,d=Qi.Pop,u=null,x=m();x==null&&(x=0,o.replaceState(Wd({},o.state,{idx:x}),""));function m(){return(o.state||{idx:null}).idx}function f(){d=Qi.Pop;let b=m(),j=b==null?null:b-x;x=b,u&&u({action:d,location:g.location,delta:j})}function p(b,j){d=Qi.Push;let T=lp(g.location,b,j);x=m()+1;let _=eb(T,x),w=g.createHref(T);try{o.pushState(_,"",w)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;s.location.assign(w)}l&&u&&u({action:d,location:g.location,delta:1})}function N(b,j){d=Qi.Replace;let T=lp(g.location,b,j);x=m();let _=eb(T,x),w=g.createHref(T);o.replaceState(_,"",w),l&&u&&u({action:d,location:g.location,delta:0})}function y(b){let j=s.location.origin!=="null"?s.location.origin:s.location.href,T=typeof b=="string"?b:g0(b);return T=T.replace(/ $/,"%20"),Fn(j,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,j)}let g={get action(){return d},get location(){return e(s,o)},listen(b){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(Z1,f),u=b,()=>{s.removeEventListener(Z1,f),u=null}},createHref(b){return n(s,b)},createURL:y,encodeLocation(b){let j=y(b);return{pathname:j.pathname,search:j.search,hash:j.hash}},push:p,replace:N,go(b){return o.go(b)}};return g}var tb;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(tb||(tb={}));function wS(e,n,a){return a===void 0&&(a="/"),kS(e,n,a)}function kS(e,n,a,r){let s=typeof n=="string"?Ac(n):n,l=Qp(s.pathname||"/",a);if(l==null)return null;let o=z2(e);TS(o);let d=null;for(let u=0;d==null&&u<o.length;++u){let x=MS(l);d=PS(o[u],x)}return d}function z2(e,n,a,r){n===void 0&&(n=[]),a===void 0&&(a=[]),r===void 0&&(r="");let s=(l,o,d)=>{let u={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};u.relativePath.startsWith("/")&&(Fn(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let x=al([r,u.relativePath]),m=a.concat(u);l.children&&l.children.length>0&&(Fn(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+x+'".')),z2(l.children,n,m,x)),!(l.path==null&&!l.index)&&n.push({path:x,score:FS(x,l.index),routesMeta:m})};return e.forEach((l,o)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))s(l,o);else for(let u of $2(l.path))s(l,o,u)}),n}function $2(e){let n=e.split("/");if(n.length===0)return[];let[a,...r]=n,s=a.endsWith("?"),l=a.replace(/\?$/,"");if(r.length===0)return s?[l,""]:[l];let o=$2(r.join("/")),d=[];return d.push(...o.map(u=>u===""?l:[l,u].join("/"))),s&&d.push(...o),d.map(u=>e.startsWith("/")&&u===""?"/":u)}function TS(e){e.sort((n,a)=>n.score!==a.score?a.score-n.score:LS(n.routesMeta.map(r=>r.childrenIndex),a.routesMeta.map(r=>r.childrenIndex)))}const CS=/^:[\w-]+$/,SS=3,_S=2,ES=1,DS=10,AS=-2,nb=e=>e==="*";function FS(e,n){let a=e.split("/"),r=a.length;return a.some(nb)&&(r+=AS),n&&(r+=_S),a.filter(s=>!nb(s)).reduce((s,l)=>s+(CS.test(l)?SS:l===""?ES:DS),r)}function LS(e,n){return e.length===n.length&&e.slice(0,-1).every((r,s)=>r===n[s])?e[e.length-1]-n[n.length-1]:0}function PS(e,n,a){let{routesMeta:r}=e,s={},l="/",o=[];for(let d=0;d<r.length;++d){let u=r[d],x=d===r.length-1,m=l==="/"?n:n.slice(l.length)||"/",f=IS({path:u.relativePath,caseSensitive:u.caseSensitive,end:x},m),p=u.route;if(!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:al([l,f.pathname]),pathnameBase:US(al([l,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(l=al([l,f.pathnameBase]))}return o}function IS(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[a,r]=OS(e.path,e.caseSensitive,e.end),s=n.match(a);if(!s)return null;let l=s[0],o=l.replace(/(.)\/+$/,"$1"),d=s.slice(1);return{params:r.reduce((x,m,f)=>{let{paramName:p,isOptional:N}=m;if(p==="*"){let g=d[f]||"";o=l.slice(0,l.length-g.length).replace(/(.)\/+$/,"$1")}const y=d[f];return N&&!y?x[p]=void 0:x[p]=(y||"").replace(/%2F/g,"/"),x},{}),pathname:l,pathnameBase:o,pattern:e}}function OS(e,n,a){n===void 0&&(n=!1),a===void 0&&(a=!0),Xp(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,d,u)=>(r.push({paramName:d,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,n?void 0:"i"),r]}function MS(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return Xp(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+n+").")),e}}function Qp(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let a=n.endsWith("/")?n.length-1:n.length,r=e.charAt(a);return r&&r!=="/"?null:e.slice(a)||"/"}const RS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,BS=e=>RS.test(e);function HS(e,n){n===void 0&&(n="/");let{pathname:a,search:r="",hash:s=""}=typeof e=="string"?Ac(e):e,l;if(a)if(BS(a))l=a;else{if(a.includes("//")){let o=a;a=a.replace(/\/\/+/g,"/"),Xp(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+a))}a.startsWith("/")?l=ab(a.substring(1),"/"):l=ab(a,n)}else l=n;return{pathname:l,search:KS(r),hash:zS(s)}}function ab(e,n){let a=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?a.length>1&&a.pop():s!=="."&&a.push(s)}),a.length>1?a.join("/"):"/"}function rf(e,n,a,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+n+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function VS(e){return e.filter((n,a)=>a===0||n.route.path&&n.route.path.length>0)}function Yp(e,n){let a=VS(e);return n?a.map((r,s)=>s===a.length-1?r.pathname:r.pathnameBase):a.map(r=>r.pathnameBase)}function Jp(e,n,a,r){r===void 0&&(r=!1);let s;typeof e=="string"?s=Ac(e):(s=Wd({},e),Fn(!s.pathname||!s.pathname.includes("?"),rf("?","pathname","search",s)),Fn(!s.pathname||!s.pathname.includes("#"),rf("#","pathname","hash",s)),Fn(!s.search||!s.search.includes("#"),rf("#","search","hash",s)));let l=e===""||s.pathname==="",o=l?"/":s.pathname,d;if(o==null)d=a;else{let f=n.length-1;if(!r&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;s.pathname=p.join("/")}d=f>=0?n[f]:"/"}let u=HS(s,d),x=o&&o!=="/"&&o.endsWith("/"),m=(l||o===".")&&a.endsWith("/");return!u.pathname.endsWith("/")&&(x||m)&&(u.pathname+="/"),u}const al=e=>e.join("/").replace(/\/\/+/g,"/"),US=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),KS=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,zS=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function $S(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const G2=["post","put","patch","delete"];new Set(G2);const GS=["get",...G2];new Set(GS);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xd(){return Xd=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},Xd.apply(this,arguments)}const Zp=D.createContext(null),qS=D.createContext(null),dl=D.createContext(null),q0=D.createContext(null),Es=D.createContext({outlet:null,matches:[],isDataRoute:!1}),q2=D.createContext(null);function WS(e,n){let{relative:a}=n===void 0?{}:n;Fc()||Fn(!1);let{basename:r,navigator:s}=D.useContext(dl),{hash:l,pathname:o,search:d}=X2(e,{relative:a}),u=o;return r!=="/"&&(u=o==="/"?r:al([r,o])),s.createHref({pathname:u,search:d,hash:l})}function Fc(){return D.useContext(q0)!=null}function Ds(){return Fc()||Fn(!1),D.useContext(q0).location}function W2(e){D.useContext(dl).static||D.useLayoutEffect(e)}function br(){let{isDataRoute:e}=D.useContext(Es);return e?c3():XS()}function XS(){Fc()||Fn(!1);let e=D.useContext(Zp),{basename:n,future:a,navigator:r}=D.useContext(dl),{matches:s}=D.useContext(Es),{pathname:l}=Ds(),o=JSON.stringify(Yp(s,a.v7_relativeSplatPath)),d=D.useRef(!1);return W2(()=>{d.current=!0}),D.useCallback(function(x,m){if(m===void 0&&(m={}),!d.current)return;if(typeof x=="number"){r.go(x);return}let f=Jp(x,JSON.parse(o),l,m.relative==="path");e==null&&n!=="/"&&(f.pathname=f.pathname==="/"?n:al([n,f.pathname])),(m.replace?r.replace:r.push)(f,m.state,m)},[n,r,o,l,e])}const QS=D.createContext(null);function YS(e){let n=D.useContext(Es).outlet;return n&&D.createElement(QS.Provider,{value:e},n)}function W0(){let{matches:e}=D.useContext(Es),n=e[e.length-1];return n?n.params:{}}function X2(e,n){let{relative:a}=n===void 0?{}:n,{future:r}=D.useContext(dl),{matches:s}=D.useContext(Es),{pathname:l}=Ds(),o=JSON.stringify(Yp(s,r.v7_relativeSplatPath));return D.useMemo(()=>Jp(e,JSON.parse(o),l,a==="path"),[e,o,l,a])}function JS(e,n){return ZS(e,n)}function ZS(e,n,a,r){Fc()||Fn(!1);let{navigator:s}=D.useContext(dl),{matches:l}=D.useContext(Es),o=l[l.length-1],d=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let x=Ds(),m;if(n){var f;let b=typeof n=="string"?Ac(n):n;u==="/"||(f=b.pathname)!=null&&f.startsWith(u)||Fn(!1),m=b}else m=x;let p=m.pathname||"/",N=p;if(u!=="/"){let b=u.replace(/^\//,"").split("/");N="/"+p.replace(/^\//,"").split("/").slice(b.length).join("/")}let y=wS(e,{pathname:N}),g=r3(y&&y.map(b=>Object.assign({},b,{params:Object.assign({},d,b.params),pathname:al([u,s.encodeLocation?s.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?u:al([u,s.encodeLocation?s.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),l,a,r);return n&&g?D.createElement(q0.Provider,{value:{location:Xd({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:Qi.Pop}},g):g}function e3(){let e=o3(),n=$S(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return D.createElement(D.Fragment,null,D.createElement("h2",null,"Unexpected Application Error!"),D.createElement("h3",{style:{fontStyle:"italic"}},n),a?D.createElement("pre",{style:s},a):null,null)}const t3=D.createElement(e3,null);class n3 extends D.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,a){return a.location!==n.location||a.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:a.error,location:a.location,revalidation:n.revalidation||a.revalidation}}componentDidCatch(n,a){console.error("React Router caught the following error during render",n,a)}render(){return this.state.error!==void 0?D.createElement(Es.Provider,{value:this.props.routeContext},D.createElement(q2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function a3(e){let{routeContext:n,match:a,children:r}=e,s=D.useContext(Zp);return s&&s.static&&s.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=a.route.id),D.createElement(Es.Provider,{value:n},r)}function r3(e,n,a,r){var s;if(n===void 0&&(n=[]),a===void 0&&(a=null),r===void 0&&(r=null),e==null){var l;if(!a)return null;if(a.errors)e=a.matches;else if((l=r)!=null&&l.v7_partialHydration&&n.length===0&&!a.initialized&&a.matches.length>0)e=a.matches;else return null}let o=e,d=(s=a)==null?void 0:s.errors;if(d!=null){let m=o.findIndex(f=>f.route.id&&(d==null?void 0:d[f.route.id])!==void 0);m>=0||Fn(!1),o=o.slice(0,Math.min(o.length,m+1))}let u=!1,x=-1;if(a&&r&&r.v7_partialHydration)for(let m=0;m<o.length;m++){let f=o[m];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(x=m),f.route.id){let{loaderData:p,errors:N}=a,y=f.route.loader&&p[f.route.id]===void 0&&(!N||N[f.route.id]===void 0);if(f.route.lazy||y){u=!0,x>=0?o=o.slice(0,x+1):o=[o[0]];break}}}return o.reduceRight((m,f,p)=>{let N,y=!1,g=null,b=null;a&&(N=d&&f.route.id?d[f.route.id]:void 0,g=f.route.errorElement||t3,u&&(x<0&&p===0?(d3("route-fallback"),y=!0,b=null):x===p&&(y=!0,b=f.route.hydrateFallbackElement||null)));let j=n.concat(o.slice(0,p+1)),T=()=>{let _;return N?_=g:y?_=b:f.route.Component?_=D.createElement(f.route.Component,null):f.route.element?_=f.route.element:_=m,D.createElement(a3,{match:f,routeContext:{outlet:m,matches:j,isDataRoute:a!=null},children:_})};return a&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?D.createElement(n3,{location:a.location,revalidation:a.revalidation,component:g,error:N,children:T(),routeContext:{outlet:null,matches:j,isDataRoute:!0}}):T()},null)}var Q2=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(Q2||{}),Y2=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(Y2||{});function s3(e){let n=D.useContext(Zp);return n||Fn(!1),n}function i3(e){let n=D.useContext(qS);return n||Fn(!1),n}function l3(e){let n=D.useContext(Es);return n||Fn(!1),n}function J2(e){let n=l3(),a=n.matches[n.matches.length-1];return a.route.id||Fn(!1),a.route.id}function o3(){var e;let n=D.useContext(q2),a=i3(),r=J2();return n!==void 0?n:(e=a.errors)==null?void 0:e[r]}function c3(){let{router:e}=s3(Q2.UseNavigateStable),n=J2(Y2.UseNavigateStable),a=D.useRef(!1);return W2(()=>{a.current=!0}),D.useCallback(function(s,l){l===void 0&&(l={}),a.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Xd({fromRouteId:n},l)))},[e,n])}const rb={};function d3(e,n,a){rb[e]||(rb[e]=!0)}function u3(e,n){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function h3(e){let{to:n,replace:a,state:r,relative:s}=e;Fc()||Fn(!1);let{future:l,static:o}=D.useContext(dl),{matches:d}=D.useContext(Es),{pathname:u}=Ds(),x=br(),m=Jp(n,Yp(d,l.v7_relativeSplatPath),u,s==="path"),f=JSON.stringify(m);return D.useEffect(()=>x(JSON.parse(f),{replace:a,state:r,relative:s}),[x,f,s,a,r]),null}function Z2(e){return YS(e.context)}function nt(e){Fn(!1)}function x3(e){let{basename:n="/",children:a=null,location:r,navigationType:s=Qi.Pop,navigator:l,static:o=!1,future:d}=e;Fc()&&Fn(!1);let u=n.replace(/^\/*/,"/"),x=D.useMemo(()=>({basename:u,navigator:l,static:o,future:Xd({v7_relativeSplatPath:!1},d)}),[u,d,l,o]);typeof r=="string"&&(r=Ac(r));let{pathname:m="/",search:f="",hash:p="",state:N=null,key:y="default"}=r,g=D.useMemo(()=>{let b=Qp(m,u);return b==null?null:{location:{pathname:b,search:f,hash:p,state:N,key:y},navigationType:s}},[u,m,f,p,N,y,s]);return g==null?null:D.createElement(dl.Provider,{value:x},D.createElement(q0.Provider,{children:a,value:g}))}function m3(e){let{children:n,location:a}=e;return JS(op(n),a)}new Promise(()=>{});function op(e,n){n===void 0&&(n=[]);let a=[];return D.Children.forEach(e,(r,s)=>{if(!D.isValidElement(r))return;let l=[...n,s];if(r.type===D.Fragment){a.push.apply(a,op(r.props.children,l));return}r.type!==nt&&Fn(!1),!r.props.index||!r.props.children||Fn(!1);let o={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=op(r.props.children,l)),a.push(o)}),a}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function cp(){return cp=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},cp.apply(this,arguments)}function f3(e,n){if(e==null)return{};var a={},r=Object.keys(e),s,l;for(l=0;l<r.length;l++)s=r[l],!(n.indexOf(s)>=0)&&(a[s]=e[s]);return a}function p3(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function g3(e,n){return e.button===0&&(!n||n==="_self")&&!p3(e)}function dp(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((n,a)=>{let r=e[a];return n.concat(Array.isArray(r)?r.map(s=>[a,s]):[[a,r]])},[]))}function y3(e,n){let a=dp(e);return n&&n.forEach((r,s)=>{a.has(s)||n.getAll(s).forEach(l=>{a.append(s,l)})}),a}const v3=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],b3="6";try{window.__reactRouterVersion=b3}catch{}const N3="startTransition",sb=A4[N3];function j3(e){let{basename:n,children:a,future:r,window:s}=e,l=D.useRef();l.current==null&&(l.current=bS({window:s,v5Compat:!0}));let o=l.current,[d,u]=D.useState({action:o.action,location:o.location}),{v7_startTransition:x}=r||{},m=D.useCallback(f=>{x&&sb?sb(()=>u(f)):u(f)},[u,x]);return D.useLayoutEffect(()=>o.listen(m),[o,m]),D.useEffect(()=>u3(r),[r]),D.createElement(x3,{basename:n,children:a,location:d.location,navigationType:d.action,navigator:o,future:r})}const w3=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",k3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xa=D.forwardRef(function(n,a){let{onClick:r,relative:s,reloadDocument:l,replace:o,state:d,target:u,to:x,preventScrollReset:m,viewTransition:f}=n,p=f3(n,v3),{basename:N}=D.useContext(dl),y,g=!1;if(typeof x=="string"&&k3.test(x)&&(y=x,w3))try{let _=new URL(window.location.href),w=x.startsWith("//")?new URL(_.protocol+x):new URL(x),E=Qp(w.pathname,N);w.origin===_.origin&&E!=null?x=E+w.search+w.hash:g=!0}catch{}let b=WS(x,{relative:s}),j=T3(x,{replace:o,state:d,target:u,preventScrollReset:m,relative:s,viewTransition:f});function T(_){r&&r(_),_.defaultPrevented||j(_)}return D.createElement("a",cp({},p,{href:y||b,onClick:g||l?r:T,ref:a,target:u}))});var ib;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(ib||(ib={}));var lb;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(lb||(lb={}));function T3(e,n){let{target:a,replace:r,state:s,preventScrollReset:l,relative:o,viewTransition:d}=n===void 0?{}:n,u=br(),x=Ds(),m=X2(e,{relative:o});return D.useCallback(f=>{if(g3(f,a)){f.preventDefault();let p=r!==void 0?r:g0(x)===g0(m);u(e,{replace:p,state:s,preventScrollReset:l,relative:o,viewTransition:d})}},[x,u,m,r,s,a,e,l,o,d])}function C3(e){let n=D.useRef(dp(e)),a=D.useRef(!1),r=Ds(),s=D.useMemo(()=>y3(r.search,a.current?null:n.current),[r.search]),l=br(),o=D.useCallback((d,u)=>{const x=dp(typeof d=="function"?d(s):d);a.current=!0,l("?"+x,u)},[l,s]);return[s,o]}let S3={data:""},_3=e=>{if(typeof window=="object"){let n=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return n.nonce=window.__nonce__,n.parentNode||(e||document.head).appendChild(n),n.firstChild}return e||S3},E3=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,D3=/\/\*[^]*?\*\/|  +/g,ob=/\n+/g,Hi=(e,n)=>{let a="",r="",s="";for(let l in e){let o=e[l];l[0]=="@"?l[1]=="i"?a=l+" "+o+";":r+=l[1]=="f"?Hi(o,l):l+"{"+Hi(o,l[1]=="k"?"":n)+"}":typeof o=="object"?r+=Hi(o,n?n.replace(/([^,])+/g,d=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,d):d?d+" "+u:u)):l):o!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=Hi.p?Hi.p(l,o):l+":"+o+";")}return a+(n&&s?n+"{"+s+"}":s)+r},zs={},ej=e=>{if(typeof e=="object"){let n="";for(let a in e)n+=a+ej(e[a]);return n}return e},A3=(e,n,a,r,s)=>{let l=ej(e),o=zs[l]||(zs[l]=(u=>{let x=0,m=11;for(;x<u.length;)m=101*m+u.charCodeAt(x++)>>>0;return"go"+m})(l));if(!zs[o]){let u=l!==e?e:(x=>{let m,f,p=[{}];for(;m=E3.exec(x.replace(D3,""));)m[4]?p.shift():m[3]?(f=m[3].replace(ob," ").trim(),p.unshift(p[0][f]=p[0][f]||{})):p[0][m[1]]=m[2].replace(ob," ").trim();return p[0]})(e);zs[o]=Hi(s?{["@keyframes "+o]:u}:u,a?"":"."+o)}let d=a&&zs.g?zs.g:null;return a&&(zs.g=zs[o]),((u,x,m,f)=>{f?x.data=x.data.replace(f,u):x.data.indexOf(u)===-1&&(x.data=m?u+x.data:x.data+u)})(zs[o],n,r,d),o},F3=(e,n,a)=>e.reduce((r,s,l)=>{let o=n[l];if(o&&o.call){let d=o(a),u=d&&d.props&&d.props.className||/^go/.test(d)&&d;o=u?"."+u:d&&typeof d=="object"?d.props?"":Hi(d,""):d===!1?"":d}return r+s+(o??"")},"");function X0(e){let n=this||{},a=e.call?e(n.p):e;return A3(a.unshift?a.raw?F3(a,[].slice.call(arguments,1),n.p):a.reduce((r,s)=>Object.assign(r,s&&s.call?s(n.p):s),{}):a,_3(n.target),n.g,n.o,n.k)}let tj,up,hp;X0.bind({g:1});let li=X0.bind({k:1});function L3(e,n,a,r){Hi.p=n,tj=e,up=a,hp=r}function ul(e,n){let a=this||{};return function(){let r=arguments;function s(l,o){let d=Object.assign({},l),u=d.className||s.className;a.p=Object.assign({theme:up&&up()},d),a.o=/ *go\d+/.test(u),d.className=X0.apply(a,r)+(u?" "+u:"");let x=e;return e[0]&&(x=d.as||e,delete d.as),hp&&x[0]&&hp(d),tj(x,d)}return s}}var P3=e=>typeof e=="function",y0=(e,n)=>P3(e)?e(n):e,I3=(()=>{let e=0;return()=>(++e).toString()})(),nj=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let n=matchMedia("(prefers-reduced-motion: reduce)");e=!n||n.matches}return e}})(),O3=20,eg="default",aj=(e,n)=>{let{toastLimit:a}=e.settings;switch(n.type){case 0:return{...e,toasts:[n.toast,...e.toasts].slice(0,a)};case 1:return{...e,toasts:e.toasts.map(o=>o.id===n.toast.id?{...o,...n.toast}:o)};case 2:let{toast:r}=n;return aj(e,{type:e.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=n;return{...e,toasts:e.toasts.map(o=>o.id===s||s===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return n.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==n.toastId)};case 5:return{...e,pausedAt:n.time};case 6:let l=n.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+l}))}}},c0=[],rj={toasts:[],pausedAt:void 0,settings:{toastLimit:O3}},ks={},sj=(e,n=eg)=>{ks[n]=aj(ks[n]||rj,e),c0.forEach(([a,r])=>{a===n&&r(ks[n])})},ij=e=>Object.keys(ks).forEach(n=>sj(e,n)),M3=e=>Object.keys(ks).find(n=>ks[n].toasts.some(a=>a.id===e)),Q0=(e=eg)=>n=>{sj(n,e)},R3={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},B3=(e={},n=eg)=>{let[a,r]=D.useState(ks[n]||rj),s=D.useRef(ks[n]);D.useEffect(()=>(s.current!==ks[n]&&r(ks[n]),c0.push([n,r]),()=>{let o=c0.findIndex(([d])=>d===n);o>-1&&c0.splice(o,1)}),[n]);let l=a.toasts.map(o=>{var d,u,x;return{...e,...e[o.type],...o,removeDelay:o.removeDelay||((d=e[o.type])==null?void 0:d.removeDelay)||(e==null?void 0:e.removeDelay),duration:o.duration||((u=e[o.type])==null?void 0:u.duration)||(e==null?void 0:e.duration)||R3[o.type],style:{...e.style,...(x=e[o.type])==null?void 0:x.style,...o.style}}});return{...a,toasts:l}},H3=(e,n="blank",a)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:n,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...a,id:(a==null?void 0:a.id)||I3()}),gu=e=>(n,a)=>{let r=H3(n,e,a);return Q0(r.toasterId||M3(r.id))({type:2,toast:r}),r.id},xt=(e,n)=>gu("blank")(e,n);xt.error=gu("error");xt.success=gu("success");xt.loading=gu("loading");xt.custom=gu("custom");xt.dismiss=(e,n)=>{let a={type:3,toastId:e};n?Q0(n)(a):ij(a)};xt.dismissAll=e=>xt.dismiss(void 0,e);xt.remove=(e,n)=>{let a={type:4,toastId:e};n?Q0(n)(a):ij(a)};xt.removeAll=e=>xt.remove(void 0,e);xt.promise=(e,n,a)=>{let r=xt.loading(n.loading,{...a,...a==null?void 0:a.loading});return typeof e=="function"&&(e=e()),e.then(s=>{let l=n.success?y0(n.success,s):void 0;return l?xt.success(l,{id:r,...a,...a==null?void 0:a.success}):xt.dismiss(r),s}).catch(s=>{let l=n.error?y0(n.error,s):void 0;l?xt.error(l,{id:r,...a,...a==null?void 0:a.error}):xt.dismiss(r)}),e};var V3=1e3,U3=(e,n="default")=>{let{toasts:a,pausedAt:r}=B3(e,n),s=D.useRef(new Map).current,l=D.useCallback((f,p=V3)=>{if(s.has(f))return;let N=setTimeout(()=>{s.delete(f),o({type:4,toastId:f})},p);s.set(f,N)},[]);D.useEffect(()=>{if(r)return;let f=Date.now(),p=a.map(N=>{if(N.duration===1/0)return;let y=(N.duration||0)+N.pauseDuration-(f-N.createdAt);if(y<0){N.visible&&xt.dismiss(N.id);return}return setTimeout(()=>xt.dismiss(N.id,n),y)});return()=>{p.forEach(N=>N&&clearTimeout(N))}},[a,r,n]);let o=D.useCallback(Q0(n),[n]),d=D.useCallback(()=>{o({type:5,time:Date.now()})},[o]),u=D.useCallback((f,p)=>{o({type:1,toast:{id:f,height:p}})},[o]),x=D.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),m=D.useCallback((f,p)=>{let{reverseOrder:N=!1,gutter:y=8,defaultPosition:g}=p||{},b=a.filter(_=>(_.position||g)===(f.position||g)&&_.height),j=b.findIndex(_=>_.id===f.id),T=b.filter((_,w)=>w<j&&_.visible).length;return b.filter(_=>_.visible).slice(...N?[T+1]:[0,T]).reduce((_,w)=>_+(w.height||0)+y,0)},[a]);return D.useEffect(()=>{a.forEach(f=>{if(f.dismissed)l(f.id,f.removeDelay);else{let p=s.get(f.id);p&&(clearTimeout(p),s.delete(f.id))}})},[a,l]),{toasts:a,handlers:{updateHeight:u,startPause:d,endPause:x,calculateOffset:m}}},K3=li`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,z3=li`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,$3=li`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,G3=ul("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${K3} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${z3} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${$3} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,q3=li`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,W3=ul("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${q3} 1s linear infinite;
`,X3=li`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Q3=li`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Y3=ul("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${X3} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Q3} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,J3=ul("div")`
  position: absolute;
`,Z3=ul("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,e_=li`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,t_=ul("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${e_} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,n_=({toast:e})=>{let{icon:n,type:a,iconTheme:r}=e;return n!==void 0?typeof n=="string"?D.createElement(t_,null,n):n:a==="blank"?null:D.createElement(Z3,null,D.createElement(W3,{...r}),a!=="loading"&&D.createElement(J3,null,a==="error"?D.createElement(G3,{...r}):D.createElement(Y3,{...r})))},a_=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,r_=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,s_="0%{opacity:0;} 100%{opacity:1;}",i_="0%{opacity:1;} 100%{opacity:0;}",l_=ul("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,o_=ul("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,c_=(e,n)=>{let a=e.includes("top")?1:-1,[r,s]=nj()?[s_,i_]:[a_(a),r_(a)];return{animation:n?`${li(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${li(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},d_=D.memo(({toast:e,position:n,style:a,children:r})=>{let s=e.height?c_(e.position||n||"top-center",e.visible):{opacity:0},l=D.createElement(n_,{toast:e}),o=D.createElement(o_,{...e.ariaProps},y0(e.message,e));return D.createElement(l_,{className:e.className,style:{...s,...a,...e.style}},typeof r=="function"?r({icon:l,message:o}):D.createElement(D.Fragment,null,l,o))});L3(D.createElement);var u_=({id:e,className:n,style:a,onHeightUpdate:r,children:s})=>{let l=D.useCallback(o=>{if(o){let d=()=>{let u=o.getBoundingClientRect().height;r(e,u)};d(),new MutationObserver(d).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return D.createElement("div",{ref:l,className:n,style:a},s)},h_=(e,n)=>{let a=e.includes("top"),r=a?{top:0}:{bottom:0},s=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:nj()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${n*(a?1:-1)}px)`,...r,...s}},x_=X0`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,$h=16,m_=({reverseOrder:e,position:n="top-center",toastOptions:a,gutter:r,children:s,toasterId:l,containerStyle:o,containerClassName:d})=>{let{toasts:u,handlers:x}=U3(a,l);return D.createElement("div",{"data-rht-toaster":l||"",style:{position:"fixed",zIndex:9999,top:$h,left:$h,right:$h,bottom:$h,pointerEvents:"none",...o},className:d,onMouseEnter:x.startPause,onMouseLeave:x.endPause},u.map(m=>{let f=m.position||n,p=x.calculateOffset(m,{reverseOrder:e,gutter:r,defaultPosition:n}),N=h_(f,p);return D.createElement(u_,{id:m.id,key:m.id,onHeightUpdate:x.updateHeight,className:m.visible?x_:"",style:N},m.type==="custom"?y0(m.message,m):s?s(m):D.createElement(d_,{toast:m,position:f}))}))},ie=xt;/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var f_={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p_=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Se=(e,n)=>{const a=D.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:o,className:d="",children:u,...x},m)=>D.createElement("svg",{ref:m,...f_,width:s,height:s,stroke:r,strokeWidth:o?Number(l)*24/Number(s):l,className:["lucide",`lucide-${p_(e)}`,d].join(" "),...x},[...n.map(([f,p])=>D.createElement(f,p)),...Array.isArray(u)?u:[u]]));return a.displayName=`${e}`,a};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const di=Se("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=Se("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y0=Se("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g_=Se("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y_=Se("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lj=Se("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oj=Se("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jc=Se("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v_=Se("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b_=Se("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v0=Se("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=Se("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N_=Se("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cb=Se("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j_=Se("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sf=Se("CalendarRange",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=Se("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w_=Se("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cj=Se("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dj=Se("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=Se("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=Se("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ja=Se("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=Se("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qn=Se("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ol=Se("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k_=Se("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T_=Se("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C_=Se("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=Se("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S_=Se("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __=Se("Command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uj=Se("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E_=Se("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Od=Se("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=Se("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=Se("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tg=Se("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=Se("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hj=Se("FileDown",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ei=Se("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=Se("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ng=Se("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xj=Se("FolderTree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D_=Se("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A_=Se("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rl=Se("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F_=Se("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yu=Se("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J0=Se("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ad=Se("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vu=Se("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b0=Se("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L_=Se("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P_=Se("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=Se("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ti=Se("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I_=Se("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ag=Se("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rg=Se("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qd=Se("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O_=Se("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const db=Se("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ub=Se("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wc=Se("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z0=Se("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M_=Se("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mj=Se("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lf=Se("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=Se("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R_=Se("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B_=Se("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H_=Se("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xp=Se("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=Se("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V_=Se("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U_=Se("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K_=Se("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=Se("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bu=Se("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=Se("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z_=Se("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $_=Se("ScrollText",[["path",{d:"M8 21h12a2 2 0 0 0 2-2v-2H10v2a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v3h4",key:"13a6an"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M15 12h-5",key:"r7krc0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=Se("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nu=Se("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fj=Se("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=Se("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G_=Se("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d0=Se("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q_=Se("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N0=Se("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pj=Se("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W_=Se("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X_=Se("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gj=Se("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yj=Se("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=Se("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mp=Se("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oi=Se("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ex=Se("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sg=Se("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=Se("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q_=Se("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y_=Se("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const so=Se("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=Se("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ig=Se("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hb=Se("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mo=Se("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=Se("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lg=Se("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function vj(e,n){return function(){return e.apply(n,arguments)}}const{toString:J_}=Object.prototype,{getPrototypeOf:og}=Object,{iterator:tx,toStringTag:bj}=Symbol,nx=(e=>n=>{const a=J_.call(n);return e[a]||(e[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),is=e=>(e=e.toLowerCase(),n=>nx(n)===e),ax=e=>n=>typeof n===e,{isArray:Lc}=Array,kc=ax("undefined");function ju(e){return e!==null&&!kc(e)&&e.constructor!==null&&!kc(e.constructor)&&tr(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Nj=is("ArrayBuffer");function Z_(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&Nj(e.buffer),n}const e5=ax("string"),tr=ax("function"),jj=ax("number"),wu=e=>e!==null&&typeof e=="object",t5=e=>e===!0||e===!1,u0=e=>{if(nx(e)!=="object")return!1;const n=og(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(bj in e)&&!(tx in e)},n5=e=>{if(!wu(e)||ju(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},a5=is("Date"),r5=is("File"),s5=is("Blob"),i5=is("FileList"),l5=e=>wu(e)&&tr(e.pipe),o5=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||tr(e.append)&&((n=nx(e))==="formdata"||n==="object"&&tr(e.toString)&&e.toString()==="[object FormData]"))},c5=is("URLSearchParams"),[d5,u5,h5,x5]=["ReadableStream","Request","Response","Headers"].map(is),m5=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ku(e,n,{allOwnKeys:a=!1}={}){if(e===null||typeof e>"u")return;let r,s;if(typeof e!="object"&&(e=[e]),Lc(e))for(r=0,s=e.length;r<s;r++)n.call(null,e[r],r,e);else{if(ju(e))return;const l=a?Object.getOwnPropertyNames(e):Object.keys(e),o=l.length;let d;for(r=0;r<o;r++)d=l[r],n.call(null,e[d],d,e)}}function wj(e,n){if(ju(e))return null;n=n.toLowerCase();const a=Object.keys(e);let r=a.length,s;for(;r-- >0;)if(s=a[r],n===s.toLowerCase())return s;return null}const Hl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,kj=e=>!kc(e)&&e!==Hl;function fp(){const{caseless:e,skipUndefined:n}=kj(this)&&this||{},a={},r=(s,l)=>{const o=e&&wj(a,l)||l;u0(a[o])&&u0(s)?a[o]=fp(a[o],s):u0(s)?a[o]=fp({},s):Lc(s)?a[o]=s.slice():(!n||!kc(s))&&(a[o]=s)};for(let s=0,l=arguments.length;s<l;s++)arguments[s]&&ku(arguments[s],r);return a}const f5=(e,n,a,{allOwnKeys:r}={})=>(ku(n,(s,l)=>{a&&tr(s)?e[l]=vj(s,a):e[l]=s},{allOwnKeys:r}),e),p5=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),g5=(e,n,a,r)=>{e.prototype=Object.create(n.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),a&&Object.assign(e.prototype,a)},y5=(e,n,a,r)=>{let s,l,o;const d={};if(n=n||{},e==null)return n;do{for(s=Object.getOwnPropertyNames(e),l=s.length;l-- >0;)o=s[l],(!r||r(o,e,n))&&!d[o]&&(n[o]=e[o],d[o]=!0);e=a!==!1&&og(e)}while(e&&(!a||a(e,n))&&e!==Object.prototype);return n},v5=(e,n,a)=>{e=String(e),(a===void 0||a>e.length)&&(a=e.length),a-=n.length;const r=e.indexOf(n,a);return r!==-1&&r===a},b5=e=>{if(!e)return null;if(Lc(e))return e;let n=e.length;if(!jj(n))return null;const a=new Array(n);for(;n-- >0;)a[n]=e[n];return a},N5=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&og(Uint8Array)),j5=(e,n)=>{const r=(e&&e[tx]).call(e);let s;for(;(s=r.next())&&!s.done;){const l=s.value;n.call(e,l[0],l[1])}},w5=(e,n)=>{let a;const r=[];for(;(a=e.exec(n))!==null;)r.push(a);return r},k5=is("HTMLFormElement"),T5=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,r,s){return r.toUpperCase()+s}),xb=(({hasOwnProperty:e})=>(n,a)=>e.call(n,a))(Object.prototype),C5=is("RegExp"),Tj=(e,n)=>{const a=Object.getOwnPropertyDescriptors(e),r={};ku(a,(s,l)=>{let o;(o=n(s,l,e))!==!1&&(r[l]=o||s)}),Object.defineProperties(e,r)},S5=e=>{Tj(e,(n,a)=>{if(tr(e)&&["arguments","caller","callee"].indexOf(a)!==-1)return!1;const r=e[a];if(tr(r)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")})}})},_5=(e,n)=>{const a={},r=s=>{s.forEach(l=>{a[l]=!0})};return Lc(e)?r(e):r(String(e).split(n)),a},E5=()=>{},D5=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function A5(e){return!!(e&&tr(e.append)&&e[bj]==="FormData"&&e[tx])}const F5=e=>{const n=new Array(10),a=(r,s)=>{if(wu(r)){if(n.indexOf(r)>=0)return;if(ju(r))return r;if(!("toJSON"in r)){n[s]=r;const l=Lc(r)?[]:{};return ku(r,(o,d)=>{const u=a(o,s+1);!kc(u)&&(l[d]=u)}),n[s]=void 0,l}}return r};return a(e,0)},L5=is("AsyncFunction"),P5=e=>e&&(wu(e)||tr(e))&&tr(e.then)&&tr(e.catch),Cj=((e,n)=>e?setImmediate:n?((a,r)=>(Hl.addEventListener("message",({source:s,data:l})=>{s===Hl&&l===a&&r.length&&r.shift()()},!1),s=>{r.push(s),Hl.postMessage(a,"*")}))(`axios@${Math.random()}`,[]):a=>setTimeout(a))(typeof setImmediate=="function",tr(Hl.postMessage)),I5=typeof queueMicrotask<"u"?queueMicrotask.bind(Hl):typeof process<"u"&&process.nextTick||Cj,O5=e=>e!=null&&tr(e[tx]),we={isArray:Lc,isArrayBuffer:Nj,isBuffer:ju,isFormData:o5,isArrayBufferView:Z_,isString:e5,isNumber:jj,isBoolean:t5,isObject:wu,isPlainObject:u0,isEmptyObject:n5,isReadableStream:d5,isRequest:u5,isResponse:h5,isHeaders:x5,isUndefined:kc,isDate:a5,isFile:r5,isBlob:s5,isRegExp:C5,isFunction:tr,isStream:l5,isURLSearchParams:c5,isTypedArray:N5,isFileList:i5,forEach:ku,merge:fp,extend:f5,trim:m5,stripBOM:p5,inherits:g5,toFlatObject:y5,kindOf:nx,kindOfTest:is,endsWith:v5,toArray:b5,forEachEntry:j5,matchAll:w5,isHTMLForm:k5,hasOwnProperty:xb,hasOwnProp:xb,reduceDescriptors:Tj,freezeMethods:S5,toObjectSet:_5,toCamelCase:T5,noop:E5,toFiniteNumber:D5,findKey:wj,global:Hl,isContextDefined:kj,isSpecCompliantForm:A5,toJSONObject:F5,isAsyncFn:L5,isThenable:P5,setImmediate:Cj,asap:I5,isIterable:O5};function pt(e,n,a,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),a&&(this.config=a),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}we.inherits(pt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:we.toJSONObject(this.config),code:this.code,status:this.status}}});const Sj=pt.prototype,_j={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{_j[e]={value:e}});Object.defineProperties(pt,_j);Object.defineProperty(Sj,"isAxiosError",{value:!0});pt.from=(e,n,a,r,s,l)=>{const o=Object.create(Sj);we.toFlatObject(e,o,function(m){return m!==Error.prototype},x=>x!=="isAxiosError");const d=e&&e.message?e.message:"Error",u=n==null&&e?e.code:n;return pt.call(o,d,u,a,r,s),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",l&&Object.assign(o,l),o};const M5=null;function pp(e){return we.isPlainObject(e)||we.isArray(e)}function Ej(e){return we.endsWith(e,"[]")?e.slice(0,-2):e}function mb(e,n,a){return e?e.concat(n).map(function(s,l){return s=Ej(s),!a&&l?"["+s+"]":s}).join(a?".":""):n}function R5(e){return we.isArray(e)&&!e.some(pp)}const B5=we.toFlatObject(we,{},null,function(n){return/^is[A-Z]/.test(n)});function rx(e,n,a){if(!we.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,a=we.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,b){return!we.isUndefined(b[g])});const r=a.metaTokens,s=a.visitor||m,l=a.dots,o=a.indexes,u=(a.Blob||typeof Blob<"u"&&Blob)&&we.isSpecCompliantForm(n);if(!we.isFunction(s))throw new TypeError("visitor must be a function");function x(y){if(y===null)return"";if(we.isDate(y))return y.toISOString();if(we.isBoolean(y))return y.toString();if(!u&&we.isBlob(y))throw new pt("Blob is not supported. Use a Buffer instead.");return we.isArrayBuffer(y)||we.isTypedArray(y)?u&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function m(y,g,b){let j=y;if(y&&!b&&typeof y=="object"){if(we.endsWith(g,"{}"))g=r?g:g.slice(0,-2),y=JSON.stringify(y);else if(we.isArray(y)&&R5(y)||(we.isFileList(y)||we.endsWith(g,"[]"))&&(j=we.toArray(y)))return g=Ej(g),j.forEach(function(_,w){!(we.isUndefined(_)||_===null)&&n.append(o===!0?mb([g],w,l):o===null?g:g+"[]",x(_))}),!1}return pp(y)?!0:(n.append(mb(b,g,l),x(y)),!1)}const f=[],p=Object.assign(B5,{defaultVisitor:m,convertValue:x,isVisitable:pp});function N(y,g){if(!we.isUndefined(y)){if(f.indexOf(y)!==-1)throw Error("Circular reference detected in "+g.join("."));f.push(y),we.forEach(y,function(j,T){(!(we.isUndefined(j)||j===null)&&s.call(n,j,we.isString(T)?T.trim():T,g,p))===!0&&N(j,g?g.concat(T):[T])}),f.pop()}}if(!we.isObject(e))throw new TypeError("data must be an object");return N(e),n}function fb(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return n[r]})}function cg(e,n){this._pairs=[],e&&rx(e,this,n)}const Dj=cg.prototype;Dj.append=function(n,a){this._pairs.push([n,a])};Dj.toString=function(n){const a=n?function(r){return n.call(this,r,fb)}:fb;return this._pairs.map(function(s){return a(s[0])+"="+a(s[1])},"").join("&")};function H5(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Aj(e,n,a){if(!n)return e;const r=a&&a.encode||H5;we.isFunction(a)&&(a={serialize:a});const s=a&&a.serialize;let l;if(s?l=s(n,a):l=we.isURLSearchParams(n)?n.toString():new cg(n,a).toString(r),l){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+l}return e}class pb{constructor(){this.handlers=[]}use(n,a,r){return this.handlers.push({fulfilled:n,rejected:a,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){we.forEach(this.handlers,function(r){r!==null&&n(r)})}}const Fj={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},V5=typeof URLSearchParams<"u"?URLSearchParams:cg,U5=typeof FormData<"u"?FormData:null,K5=typeof Blob<"u"?Blob:null,z5={isBrowser:!0,classes:{URLSearchParams:V5,FormData:U5,Blob:K5},protocols:["http","https","file","blob","url","data"]},dg=typeof window<"u"&&typeof document<"u",gp=typeof navigator=="object"&&navigator||void 0,$5=dg&&(!gp||["ReactNative","NativeScript","NS"].indexOf(gp.product)<0),G5=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",q5=dg&&window.location.href||"http://localhost",W5=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:dg,hasStandardBrowserEnv:$5,hasStandardBrowserWebWorkerEnv:G5,navigator:gp,origin:q5},Symbol.toStringTag,{value:"Module"})),Ta={...W5,...z5};function X5(e,n){return rx(e,new Ta.classes.URLSearchParams,{visitor:function(a,r,s,l){return Ta.isNode&&we.isBuffer(a)?(this.append(r,a.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...n})}function Q5(e){return we.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function Y5(e){const n={},a=Object.keys(e);let r;const s=a.length;let l;for(r=0;r<s;r++)l=a[r],n[l]=e[l];return n}function Lj(e){function n(a,r,s,l){let o=a[l++];if(o==="__proto__")return!0;const d=Number.isFinite(+o),u=l>=a.length;return o=!o&&we.isArray(s)?s.length:o,u?(we.hasOwnProp(s,o)?s[o]=[s[o],r]:s[o]=r,!d):((!s[o]||!we.isObject(s[o]))&&(s[o]=[]),n(a,r,s[o],l)&&we.isArray(s[o])&&(s[o]=Y5(s[o])),!d)}if(we.isFormData(e)&&we.isFunction(e.entries)){const a={};return we.forEachEntry(e,(r,s)=>{n(Q5(r),s,a,0)}),a}return null}function J5(e,n,a){if(we.isString(e))try{return(n||JSON.parse)(e),we.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(a||JSON.stringify)(e)}const Tu={transitional:Fj,adapter:["xhr","http","fetch"],transformRequest:[function(n,a){const r=a.getContentType()||"",s=r.indexOf("application/json")>-1,l=we.isObject(n);if(l&&we.isHTMLForm(n)&&(n=new FormData(n)),we.isFormData(n))return s?JSON.stringify(Lj(n)):n;if(we.isArrayBuffer(n)||we.isBuffer(n)||we.isStream(n)||we.isFile(n)||we.isBlob(n)||we.isReadableStream(n))return n;if(we.isArrayBufferView(n))return n.buffer;if(we.isURLSearchParams(n))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let d;if(l){if(r.indexOf("application/x-www-form-urlencoded")>-1)return X5(n,this.formSerializer).toString();if((d=we.isFileList(n))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return rx(d?{"files[]":n}:n,u&&new u,this.formSerializer)}}return l||s?(a.setContentType("application/json",!1),J5(n)):n}],transformResponse:[function(n){const a=this.transitional||Tu.transitional,r=a&&a.forcedJSONParsing,s=this.responseType==="json";if(we.isResponse(n)||we.isReadableStream(n))return n;if(n&&we.isString(n)&&(r&&!this.responseType||s)){const o=!(a&&a.silentJSONParsing)&&s;try{return JSON.parse(n,this.parseReviver)}catch(d){if(o)throw d.name==="SyntaxError"?pt.from(d,pt.ERR_BAD_RESPONSE,this,null,this.response):d}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ta.classes.FormData,Blob:Ta.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};we.forEach(["delete","get","head","post","put","patch"],e=>{Tu.headers[e]={}});const Z5=we.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),eE=e=>{const n={};let a,r,s;return e&&e.split(`
`).forEach(function(o){s=o.indexOf(":"),a=o.substring(0,s).trim().toLowerCase(),r=o.substring(s+1).trim(),!(!a||n[a]&&Z5[a])&&(a==="set-cookie"?n[a]?n[a].push(r):n[a]=[r]:n[a]=n[a]?n[a]+", "+r:r)}),n},gb=Symbol("internals");function wd(e){return e&&String(e).trim().toLowerCase()}function h0(e){return e===!1||e==null?e:we.isArray(e)?e.map(h0):String(e)}function tE(e){const n=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=a.exec(e);)n[r[1]]=r[2];return n}const nE=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function of(e,n,a,r,s){if(we.isFunction(r))return r.call(this,n,a);if(s&&(n=a),!!we.isString(n)){if(we.isString(r))return n.indexOf(r)!==-1;if(we.isRegExp(r))return r.test(n)}}function aE(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,a,r)=>a.toUpperCase()+r)}function rE(e,n){const a=we.toCamelCase(" "+n);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+a,{value:function(s,l,o){return this[r].call(this,n,s,l,o)},configurable:!0})})}let nr=class{constructor(n){n&&this.set(n)}set(n,a,r){const s=this;function l(d,u,x){const m=wd(u);if(!m)throw new Error("header name must be a non-empty string");const f=we.findKey(s,m);(!f||s[f]===void 0||x===!0||x===void 0&&s[f]!==!1)&&(s[f||u]=h0(d))}const o=(d,u)=>we.forEach(d,(x,m)=>l(x,m,u));if(we.isPlainObject(n)||n instanceof this.constructor)o(n,a);else if(we.isString(n)&&(n=n.trim())&&!nE(n))o(eE(n),a);else if(we.isObject(n)&&we.isIterable(n)){let d={},u,x;for(const m of n){if(!we.isArray(m))throw TypeError("Object iterator must return a key-value pair");d[x=m[0]]=(u=d[x])?we.isArray(u)?[...u,m[1]]:[u,m[1]]:m[1]}o(d,a)}else n!=null&&l(a,n,r);return this}get(n,a){if(n=wd(n),n){const r=we.findKey(this,n);if(r){const s=this[r];if(!a)return s;if(a===!0)return tE(s);if(we.isFunction(a))return a.call(this,s,r);if(we.isRegExp(a))return a.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,a){if(n=wd(n),n){const r=we.findKey(this,n);return!!(r&&this[r]!==void 0&&(!a||of(this,this[r],r,a)))}return!1}delete(n,a){const r=this;let s=!1;function l(o){if(o=wd(o),o){const d=we.findKey(r,o);d&&(!a||of(r,r[d],d,a))&&(delete r[d],s=!0)}}return we.isArray(n)?n.forEach(l):l(n),s}clear(n){const a=Object.keys(this);let r=a.length,s=!1;for(;r--;){const l=a[r];(!n||of(this,this[l],l,n,!0))&&(delete this[l],s=!0)}return s}normalize(n){const a=this,r={};return we.forEach(this,(s,l)=>{const o=we.findKey(r,l);if(o){a[o]=h0(s),delete a[l];return}const d=n?aE(l):String(l).trim();d!==l&&delete a[l],a[d]=h0(s),r[d]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const a=Object.create(null);return we.forEach(this,(r,s)=>{r!=null&&r!==!1&&(a[s]=n&&we.isArray(r)?r.join(", "):r)}),a}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,a])=>n+": "+a).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...a){const r=new this(n);return a.forEach(s=>r.set(s)),r}static accessor(n){const r=(this[gb]=this[gb]={accessors:{}}).accessors,s=this.prototype;function l(o){const d=wd(o);r[d]||(rE(s,o),r[d]=!0)}return we.isArray(n)?n.forEach(l):l(n),this}};nr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);we.reduceDescriptors(nr.prototype,({value:e},n)=>{let a=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(r){this[a]=r}}});we.freezeMethods(nr);function cf(e,n){const a=this||Tu,r=n||a,s=nr.from(r.headers);let l=r.data;return we.forEach(e,function(d){l=d.call(a,l,s.normalize(),n?n.status:void 0)}),s.normalize(),l}function Pj(e){return!!(e&&e.__CANCEL__)}function Pc(e,n,a){pt.call(this,e??"canceled",pt.ERR_CANCELED,n,a),this.name="CanceledError"}we.inherits(Pc,pt,{__CANCEL__:!0});function Ij(e,n,a){const r=a.config.validateStatus;!a.status||!r||r(a.status)?e(a):n(new pt("Request failed with status code "+a.status,[pt.ERR_BAD_REQUEST,pt.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}function sE(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function iE(e,n){e=e||10;const a=new Array(e),r=new Array(e);let s=0,l=0,o;return n=n!==void 0?n:1e3,function(u){const x=Date.now(),m=r[l];o||(o=x),a[s]=u,r[s]=x;let f=l,p=0;for(;f!==s;)p+=a[f++],f=f%e;if(s=(s+1)%e,s===l&&(l=(l+1)%e),x-o<n)return;const N=m&&x-m;return N?Math.round(p*1e3/N):void 0}}function lE(e,n){let a=0,r=1e3/n,s,l;const o=(x,m=Date.now())=>{a=m,s=null,l&&(clearTimeout(l),l=null),e(...x)};return[(...x)=>{const m=Date.now(),f=m-a;f>=r?o(x,m):(s=x,l||(l=setTimeout(()=>{l=null,o(s)},r-f)))},()=>s&&o(s)]}const j0=(e,n,a=3)=>{let r=0;const s=iE(50,250);return lE(l=>{const o=l.loaded,d=l.lengthComputable?l.total:void 0,u=o-r,x=s(u),m=o<=d;r=o;const f={loaded:o,total:d,progress:d?o/d:void 0,bytes:u,rate:x||void 0,estimated:x&&d&&m?(d-o)/x:void 0,event:l,lengthComputable:d!=null,[n?"download":"upload"]:!0};e(f)},a)},yb=(e,n)=>{const a=e!=null;return[r=>n[0]({lengthComputable:a,total:e,loaded:r}),n[1]]},vb=e=>(...n)=>we.asap(()=>e(...n)),oE=Ta.hasStandardBrowserEnv?((e,n)=>a=>(a=new URL(a,Ta.origin),e.protocol===a.protocol&&e.host===a.host&&(n||e.port===a.port)))(new URL(Ta.origin),Ta.navigator&&/(msie|trident)/i.test(Ta.navigator.userAgent)):()=>!0,cE=Ta.hasStandardBrowserEnv?{write(e,n,a,r,s,l,o){if(typeof document>"u")return;const d=[`${e}=${encodeURIComponent(n)}`];we.isNumber(a)&&d.push(`expires=${new Date(a).toUTCString()}`),we.isString(r)&&d.push(`path=${r}`),we.isString(s)&&d.push(`domain=${s}`),l===!0&&d.push("secure"),we.isString(o)&&d.push(`SameSite=${o}`),document.cookie=d.join("; ")},read(e){if(typeof document>"u")return null;const n=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return n?decodeURIComponent(n[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function dE(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function uE(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function Oj(e,n,a){let r=!dE(n);return e&&(r||a==!1)?uE(e,n):n}const bb=e=>e instanceof nr?{...e}:e;function io(e,n){n=n||{};const a={};function r(x,m,f,p){return we.isPlainObject(x)&&we.isPlainObject(m)?we.merge.call({caseless:p},x,m):we.isPlainObject(m)?we.merge({},m):we.isArray(m)?m.slice():m}function s(x,m,f,p){if(we.isUndefined(m)){if(!we.isUndefined(x))return r(void 0,x,f,p)}else return r(x,m,f,p)}function l(x,m){if(!we.isUndefined(m))return r(void 0,m)}function o(x,m){if(we.isUndefined(m)){if(!we.isUndefined(x))return r(void 0,x)}else return r(void 0,m)}function d(x,m,f){if(f in n)return r(x,m);if(f in e)return r(void 0,x)}const u={url:l,method:l,data:l,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:d,headers:(x,m,f)=>s(bb(x),bb(m),f,!0)};return we.forEach(Object.keys({...e,...n}),function(m){const f=u[m]||s,p=f(e[m],n[m],m);we.isUndefined(p)&&f!==d||(a[m]=p)}),a}const Mj=e=>{const n=io({},e);let{data:a,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:l,headers:o,auth:d}=n;if(n.headers=o=nr.from(o),n.url=Aj(Oj(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),d&&o.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):""))),we.isFormData(a)){if(Ta.hasStandardBrowserEnv||Ta.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(we.isFunction(a.getHeaders)){const u=a.getHeaders(),x=["content-type","content-length"];Object.entries(u).forEach(([m,f])=>{x.includes(m.toLowerCase())&&o.set(m,f)})}}if(Ta.hasStandardBrowserEnv&&(r&&we.isFunction(r)&&(r=r(n)),r||r!==!1&&oE(n.url))){const u=s&&l&&cE.read(l);u&&o.set(s,u)}return n},hE=typeof XMLHttpRequest<"u",xE=hE&&function(e){return new Promise(function(a,r){const s=Mj(e);let l=s.data;const o=nr.from(s.headers).normalize();let{responseType:d,onUploadProgress:u,onDownloadProgress:x}=s,m,f,p,N,y;function g(){N&&N(),y&&y(),s.cancelToken&&s.cancelToken.unsubscribe(m),s.signal&&s.signal.removeEventListener("abort",m)}let b=new XMLHttpRequest;b.open(s.method.toUpperCase(),s.url,!0),b.timeout=s.timeout;function j(){if(!b)return;const _=nr.from("getAllResponseHeaders"in b&&b.getAllResponseHeaders()),E={data:!d||d==="text"||d==="json"?b.responseText:b.response,status:b.status,statusText:b.statusText,headers:_,config:e,request:b};Ij(function(S){a(S),g()},function(S){r(S),g()},E),b=null}"onloadend"in b?b.onloadend=j:b.onreadystatechange=function(){!b||b.readyState!==4||b.status===0&&!(b.responseURL&&b.responseURL.indexOf("file:")===0)||setTimeout(j)},b.onabort=function(){b&&(r(new pt("Request aborted",pt.ECONNABORTED,e,b)),b=null)},b.onerror=function(w){const E=w&&w.message?w.message:"Network Error",C=new pt(E,pt.ERR_NETWORK,e,b);C.event=w||null,r(C),b=null},b.ontimeout=function(){let w=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const E=s.transitional||Fj;s.timeoutErrorMessage&&(w=s.timeoutErrorMessage),r(new pt(w,E.clarifyTimeoutError?pt.ETIMEDOUT:pt.ECONNABORTED,e,b)),b=null},l===void 0&&o.setContentType(null),"setRequestHeader"in b&&we.forEach(o.toJSON(),function(w,E){b.setRequestHeader(E,w)}),we.isUndefined(s.withCredentials)||(b.withCredentials=!!s.withCredentials),d&&d!=="json"&&(b.responseType=s.responseType),x&&([p,y]=j0(x,!0),b.addEventListener("progress",p)),u&&b.upload&&([f,N]=j0(u),b.upload.addEventListener("progress",f),b.upload.addEventListener("loadend",N)),(s.cancelToken||s.signal)&&(m=_=>{b&&(r(!_||_.type?new Pc(null,e,b):_),b.abort(),b=null)},s.cancelToken&&s.cancelToken.subscribe(m),s.signal&&(s.signal.aborted?m():s.signal.addEventListener("abort",m)));const T=sE(s.url);if(T&&Ta.protocols.indexOf(T)===-1){r(new pt("Unsupported protocol "+T+":",pt.ERR_BAD_REQUEST,e));return}b.send(l||null)})},mE=(e,n)=>{const{length:a}=e=e?e.filter(Boolean):[];if(n||a){let r=new AbortController,s;const l=function(x){if(!s){s=!0,d();const m=x instanceof Error?x:this.reason;r.abort(m instanceof pt?m:new Pc(m instanceof Error?m.message:m))}};let o=n&&setTimeout(()=>{o=null,l(new pt(`timeout ${n} of ms exceeded`,pt.ETIMEDOUT))},n);const d=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(x=>{x.unsubscribe?x.unsubscribe(l):x.removeEventListener("abort",l)}),e=null)};e.forEach(x=>x.addEventListener("abort",l));const{signal:u}=r;return u.unsubscribe=()=>we.asap(d),u}},fE=function*(e,n){let a=e.byteLength;if(a<n){yield e;return}let r=0,s;for(;r<a;)s=r+n,yield e.slice(r,s),r=s},pE=async function*(e,n){for await(const a of gE(e))yield*fE(a,n)},gE=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:a,value:r}=await n.read();if(a)break;yield r}}finally{await n.cancel()}},Nb=(e,n,a,r)=>{const s=pE(e,n);let l=0,o,d=u=>{o||(o=!0,r&&r(u))};return new ReadableStream({async pull(u){try{const{done:x,value:m}=await s.next();if(x){d(),u.close();return}let f=m.byteLength;if(a){let p=l+=f;a(p)}u.enqueue(new Uint8Array(m))}catch(x){throw d(x),x}},cancel(u){return d(u),s.return()}},{highWaterMark:2})},jb=64*1024,{isFunction:Gh}=we,yE=(({Request:e,Response:n})=>({Request:e,Response:n}))(we.global),{ReadableStream:wb,TextEncoder:kb}=we.global,Tb=(e,...n)=>{try{return!!e(...n)}catch{return!1}},vE=e=>{e=we.merge.call({skipUndefined:!0},yE,e);const{fetch:n,Request:a,Response:r}=e,s=n?Gh(n):typeof fetch=="function",l=Gh(a),o=Gh(r);if(!s)return!1;const d=s&&Gh(wb),u=s&&(typeof kb=="function"?(y=>g=>y.encode(g))(new kb):async y=>new Uint8Array(await new a(y).arrayBuffer())),x=l&&d&&Tb(()=>{let y=!1;const g=new a(Ta.origin,{body:new wb,method:"POST",get duplex(){return y=!0,"half"}}).headers.has("Content-Type");return y&&!g}),m=o&&d&&Tb(()=>we.isReadableStream(new r("").body)),f={stream:m&&(y=>y.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(y=>{!f[y]&&(f[y]=(g,b)=>{let j=g&&g[y];if(j)return j.call(g);throw new pt(`Response type '${y}' is not supported`,pt.ERR_NOT_SUPPORT,b)})});const p=async y=>{if(y==null)return 0;if(we.isBlob(y))return y.size;if(we.isSpecCompliantForm(y))return(await new a(Ta.origin,{method:"POST",body:y}).arrayBuffer()).byteLength;if(we.isArrayBufferView(y)||we.isArrayBuffer(y))return y.byteLength;if(we.isURLSearchParams(y)&&(y=y+""),we.isString(y))return(await u(y)).byteLength},N=async(y,g)=>{const b=we.toFiniteNumber(y.getContentLength());return b??p(g)};return async y=>{let{url:g,method:b,data:j,signal:T,cancelToken:_,timeout:w,onDownloadProgress:E,onUploadProgress:C,responseType:S,headers:P,withCredentials:F="same-origin",fetchOptions:B}=Mj(y),O=n||fetch;S=S?(S+"").toLowerCase():"text";let M=mE([T,_&&_.toAbortSignal()],w),G=null;const J=M&&M.unsubscribe&&(()=>{M.unsubscribe()});let X;try{if(C&&x&&b!=="get"&&b!=="head"&&(X=await N(P,j))!==0){let K=new a(g,{method:"POST",body:j,duplex:"half"}),L;if(we.isFormData(j)&&(L=K.headers.get("content-type"))&&P.setContentType(L),K.body){const[Q,I]=yb(X,j0(vb(C)));j=Nb(K.body,jb,Q,I)}}we.isString(F)||(F=F?"include":"omit");const fe=l&&"credentials"in a.prototype,ne={...B,signal:M,method:b.toUpperCase(),headers:P.normalize().toJSON(),body:j,duplex:"half",credentials:fe?F:void 0};G=l&&new a(g,ne);let H=await(l?O(G,B):O(g,ne));const W=m&&(S==="stream"||S==="response");if(m&&(E||W&&J)){const K={};["status","statusText","headers"].forEach(R=>{K[R]=H[R]});const L=we.toFiniteNumber(H.headers.get("content-length")),[Q,I]=E&&yb(L,j0(vb(E),!0))||[];H=new r(Nb(H.body,jb,Q,()=>{I&&I(),J&&J()}),K)}S=S||"text";let xe=await f[we.findKey(f,S)||"text"](H,y);return!W&&J&&J(),await new Promise((K,L)=>{Ij(K,L,{data:xe,headers:nr.from(H.headers),status:H.status,statusText:H.statusText,config:y,request:G})})}catch(fe){throw J&&J(),fe&&fe.name==="TypeError"&&/Load failed|fetch/i.test(fe.message)?Object.assign(new pt("Network Error",pt.ERR_NETWORK,y,G),{cause:fe.cause||fe}):pt.from(fe,fe&&fe.code,y,G)}}},bE=new Map,Rj=e=>{let n=e&&e.env||{};const{fetch:a,Request:r,Response:s}=n,l=[r,s,a];let o=l.length,d=o,u,x,m=bE;for(;d--;)u=l[d],x=m.get(u),x===void 0&&m.set(u,x=d?new Map:vE(n)),m=x;return x};Rj();const ug={http:M5,xhr:xE,fetch:{get:Rj}};we.forEach(ug,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const Cb=e=>`- ${e}`,NE=e=>we.isFunction(e)||e===null||e===!1;function jE(e,n){e=we.isArray(e)?e:[e];const{length:a}=e;let r,s;const l={};for(let o=0;o<a;o++){r=e[o];let d;if(s=r,!NE(r)&&(s=ug[(d=String(r)).toLowerCase()],s===void 0))throw new pt(`Unknown adapter '${d}'`);if(s&&(we.isFunction(s)||(s=s.get(n))))break;l[d||"#"+o]=s}if(!s){const o=Object.entries(l).map(([u,x])=>`adapter ${u} `+(x===!1?"is not supported by the environment":"is not available in the build"));let d=a?o.length>1?`since :
`+o.map(Cb).join(`
`):" "+Cb(o[0]):"as no adapter specified";throw new pt("There is no suitable adapter to dispatch the request "+d,"ERR_NOT_SUPPORT")}return s}const Bj={getAdapter:jE,adapters:ug};function df(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Pc(null,e)}function Sb(e){return df(e),e.headers=nr.from(e.headers),e.data=cf.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Bj.getAdapter(e.adapter||Tu.adapter,e)(e).then(function(r){return df(e),r.data=cf.call(e,e.transformResponse,r),r.headers=nr.from(r.headers),r},function(r){return Pj(r)||(df(e),r&&r.response&&(r.response.data=cf.call(e,e.transformResponse,r.response),r.response.headers=nr.from(r.response.headers))),Promise.reject(r)})}const Hj="1.13.2",sx={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{sx[e]=function(r){return typeof r===e||"a"+(n<1?"n ":" ")+e}});const _b={};sx.transitional=function(n,a,r){function s(l,o){return"[Axios v"+Hj+"] Transitional option '"+l+"'"+o+(r?". "+r:"")}return(l,o,d)=>{if(n===!1)throw new pt(s(o," has been removed"+(a?" in "+a:"")),pt.ERR_DEPRECATED);return a&&!_b[o]&&(_b[o]=!0,console.warn(s(o," has been deprecated since v"+a+" and will be removed in the near future"))),n?n(l,o,d):!0}};sx.spelling=function(n){return(a,r)=>(console.warn(`${r} is likely a misspelling of ${n}`),!0)};function wE(e,n,a){if(typeof e!="object")throw new pt("options must be an object",pt.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let s=r.length;for(;s-- >0;){const l=r[s],o=n[l];if(o){const d=e[l],u=d===void 0||o(d,l,e);if(u!==!0)throw new pt("option "+l+" must be "+u,pt.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new pt("Unknown option "+l,pt.ERR_BAD_OPTION)}}const x0={assertOptions:wE,validators:sx},ms=x0.validators;let Jl=class{constructor(n){this.defaults=n||{},this.interceptors={request:new pb,response:new pb}}async request(n,a){try{return await this._request(n,a)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const l=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?l&&!String(r.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+l):r.stack=l}catch{}}throw r}}_request(n,a){typeof n=="string"?(a=a||{},a.url=n):a=n||{},a=io(this.defaults,a);const{transitional:r,paramsSerializer:s,headers:l}=a;r!==void 0&&x0.assertOptions(r,{silentJSONParsing:ms.transitional(ms.boolean),forcedJSONParsing:ms.transitional(ms.boolean),clarifyTimeoutError:ms.transitional(ms.boolean)},!1),s!=null&&(we.isFunction(s)?a.paramsSerializer={serialize:s}:x0.assertOptions(s,{encode:ms.function,serialize:ms.function},!0)),a.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?a.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:a.allowAbsoluteUrls=!0),x0.assertOptions(a,{baseUrl:ms.spelling("baseURL"),withXsrfToken:ms.spelling("withXSRFToken")},!0),a.method=(a.method||this.defaults.method||"get").toLowerCase();let o=l&&we.merge(l.common,l[a.method]);l&&we.forEach(["delete","get","head","post","put","patch","common"],y=>{delete l[y]}),a.headers=nr.concat(o,l);const d=[];let u=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(a)===!1||(u=u&&g.synchronous,d.unshift(g.fulfilled,g.rejected))});const x=[];this.interceptors.response.forEach(function(g){x.push(g.fulfilled,g.rejected)});let m,f=0,p;if(!u){const y=[Sb.bind(this),void 0];for(y.unshift(...d),y.push(...x),p=y.length,m=Promise.resolve(a);f<p;)m=m.then(y[f++],y[f++]);return m}p=d.length;let N=a;for(;f<p;){const y=d[f++],g=d[f++];try{N=y(N)}catch(b){g.call(this,b);break}}try{m=Sb.call(this,N)}catch(y){return Promise.reject(y)}for(f=0,p=x.length;f<p;)m=m.then(x[f++],x[f++]);return m}getUri(n){n=io(this.defaults,n);const a=Oj(n.baseURL,n.url,n.allowAbsoluteUrls);return Aj(a,n.params,n.paramsSerializer)}};we.forEach(["delete","get","head","options"],function(n){Jl.prototype[n]=function(a,r){return this.request(io(r||{},{method:n,url:a,data:(r||{}).data}))}});we.forEach(["post","put","patch"],function(n){function a(r){return function(l,o,d){return this.request(io(d||{},{method:n,headers:r?{"Content-Type":"multipart/form-data"}:{},url:l,data:o}))}}Jl.prototype[n]=a(),Jl.prototype[n+"Form"]=a(!0)});let kE=class Vj{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(l){a=l});const r=this;this.promise.then(s=>{if(!r._listeners)return;let l=r._listeners.length;for(;l-- >0;)r._listeners[l](s);r._listeners=null}),this.promise.then=s=>{let l;const o=new Promise(d=>{r.subscribe(d),l=d}).then(s);return o.cancel=function(){r.unsubscribe(l)},o},n(function(l,o,d){r.reason||(r.reason=new Pc(l,o,d),a(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const a=this._listeners.indexOf(n);a!==-1&&this._listeners.splice(a,1)}toAbortSignal(){const n=new AbortController,a=r=>{n.abort(r)};return this.subscribe(a),n.signal.unsubscribe=()=>this.unsubscribe(a),n.signal}static source(){let n;return{token:new Vj(function(s){n=s}),cancel:n}}};function TE(e){return function(a){return e.apply(null,a)}}function CE(e){return we.isObject(e)&&e.isAxiosError===!0}const yp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(yp).forEach(([e,n])=>{yp[n]=e});function Uj(e){const n=new Jl(e),a=vj(Jl.prototype.request,n);return we.extend(a,Jl.prototype,n,{allOwnKeys:!0}),we.extend(a,n,null,{allOwnKeys:!0}),a.create=function(s){return Uj(io(e,s))},a}const Zt=Uj(Tu);Zt.Axios=Jl;Zt.CanceledError=Pc;Zt.CancelToken=kE;Zt.isCancel=Pj;Zt.VERSION=Hj;Zt.toFormData=rx;Zt.AxiosError=pt;Zt.Cancel=Zt.CanceledError;Zt.all=function(n){return Promise.all(n)};Zt.spread=TE;Zt.isAxiosError=CE;Zt.mergeConfig=io;Zt.AxiosHeaders=nr;Zt.formToJSON=e=>Lj(we.isHTMLForm(e)?new FormData(e):e);Zt.getAdapter=Bj.getAdapter;Zt.HttpStatusCode=yp;Zt.default=Zt;const{Axios:AU,AxiosError:FU,CanceledError:LU,isCancel:PU,CancelToken:IU,VERSION:OU,all:MU,Cancel:RU,isAxiosError:BU,spread:HU,toFormData:VU,AxiosHeaders:UU,HttpStatusCode:KU,formToJSON:zU,getAdapter:$U,mergeConfig:GU}=Zt,SE="tinh_luong_auth",na=Zt.create({baseURL:"/api/rbac",headers:{"Content-Type":"application/json"}});na.interceptors.request.use(e=>{const n=localStorage.getItem(SE);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const uf={dangNhap:(e,n)=>na.post("/dang-nhap",{tenDangNhap:e,matKhau:n}).then(a=>a.data),dangXuat:e=>na.post("/dang-xuat",null,{headers:{Authorization:`Bearer ${e}`}}).then(n=>n.data),kiemTraToken:e=>na.get("/kiem-tra-token",{headers:{Authorization:`Bearer ${e}`}}).then(n=>n.data)},hf={layTatCa:()=>na.get("/nguoi-dung").then(e=>e.data),layTheoId:e=>na.get(`/nguoi-dung/${e}`).then(n=>n.data),taoMoi:e=>na.post("/nguoi-dung",e).then(n=>n.data),capNhat:(e,n)=>na.put(`/nguoi-dung/${e}`,n).then(a=>a.data),doiMatKhau:(e,n,a)=>na.put(`/nguoi-dung/${e}/doi-mat-khau`,{matKhauCu:n,matKhauMoi:a}).then(r=>r.data)},Eb={layTatCa:()=>na.get("/vai-tro").then(e=>e.data),layTheoId:e=>na.get(`/vai-tro/${e}`).then(n=>n.data),taoMoi:e=>na.post("/vai-tro",e).then(n=>n.data),capNhat:(e,n)=>na.put(`/vai-tro/${e}`,n).then(a=>a.data),ganVaiTro:(e,n)=>na.post("/vai-tro/gan",{nguoiDungId:e,vaiTroId:n}).then(a=>a.data),goVaiTro:(e,n)=>na.delete("/vai-tro/go",{data:{nguoiDungId:e,vaiTroId:n}}).then(a=>a.data)},_E={layDanhSach:e=>na.get("/audit-log",{params:e}).then(n=>n.data),layTheoNguoiDung:e=>na.get(`/audit-log/nguoi-dung/${e}`).then(n=>n.data),layTheoBanGhi:(e,n)=>na.get(`/audit-log/ban-ghi/${e}/${n}`).then(a=>a.data)},Kj=D.createContext(void 0),Wo="tinh_luong_auth",EE=6e4;function DE({children:e}){const[n,a]=D.useState(null),[r,s]=D.useState(null),[l,o]=D.useState([]),[d,u]=D.useState([]),[x,m]=D.useState(!0),f=D.useCallback(()=>{localStorage.removeItem(Wo),s(null),a(null),o([]),u([])},[]),p=D.useCallback(()=>{const T=localStorage.getItem(Wo);if(T)try{const _=JSON.parse(T),w=new Date(_.hetHan),E=new Date;if(w<=E)return f(),window.location.href="/dang-nhap?expired=1",!1;const C=w.getTime()-E.getTime();return C<600*1e3&&C>0&&console.warn("Token sp ht hn trong",Math.floor(C/6e4),"pht"),!0}catch{return f(),!1}return!1},[f]);D.useEffect(()=>{const T=localStorage.getItem(Wo);if(T)try{const _=JSON.parse(T);new Date(_.hetHan)>new Date?(s(_.token),a(_.user),o(_.vaiTros),u(_.quyens)):localStorage.removeItem(Wo)}catch{localStorage.removeItem(Wo)}m(!1)},[]),D.useEffect(()=>{if(r){const T=setInterval(p,EE);return()=>clearInterval(T)}},[r,p]);const N=async(T,_)=>{const w=await uf.dangNhap(T,_),E={token:w.token,user:w.nguoiDung,vaiTros:w.vaiTros,quyens:w.quyens,hetHan:w.hetHan};localStorage.setItem(Wo,JSON.stringify(E)),s(w.token),a(w.nguoiDung),o(w.vaiTros),u(w.quyens)},y=async()=>{if(r)try{await uf.dangXuat(r)}catch{}f()},g=async()=>{if(r)try{(await uf.kiemTraToken(r)).hieu_luc||(f(),window.location.href="/dang-nhap?expired=1")}catch{f()}},b=T=>d.includes(T)||l.includes("ADMIN"),j=T=>l.includes(T);return t.jsx(Kj.Provider,{value:{user:n,token:r,vaiTros:l,quyens:d,isAuthenticated:!!n,isLoading:x,dangNhap:N,dangXuat:y,coQuyen:b,coVaiTro:j,refreshToken:g},children:e})}function ls(){const e=D.useContext(Kj);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}function Tt({children:e,quyen:n}){const{isAuthenticated:a,isLoading:r,coQuyen:s}=ls();return r?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):a?n&&!s(n)?t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[t.jsx("h3",{className:"text-lg font-medium text-red-800",children:"Khng c quyn truy cp"}),t.jsx("p",{className:"text-red-600 mt-2",children:"Bn khng c quyn truy cp trang ny."})]}):t.jsx(t.Fragment,{children:e}):(window.location.href="/dang-nhap",null)}const xf=8,AE="payroll_favorites_";function zj(){const{user:e,coQuyen:n,coVaiTro:a}=ls(),[r,s]=D.useState([]),l=e?`${AE}${e.id}`:null;D.useEffect(()=>{if(l){const f=localStorage.getItem(l);if(f)try{const p=JSON.parse(f);Array.isArray(p)&&s(p)}catch{}}},[l]);const o=D.useCallback(f=>{l&&localStorage.setItem(l,JSON.stringify(f))},[l]),d=D.useCallback(f=>{s(p=>{let N;if(p.includes(f))N=p.filter(y=>y!==f);else{if(p.length>=xf)return p;N=[...p,f]}return o(N),N})},[o]),u=D.useCallback(f=>r.includes(f),[r]),x=r.length>=xf,m=D.useCallback(f=>!f||f.length===0||a("ADMIN")?!0:f.some(p=>n(p)||a(p)),[n,a]);return{favorites:r,toggleFavorite:d,isFavorite:u,isFull:x,maxFavorites:xf,filterByPermission:m}}const vp=[{id:"trang-chu",title:"",collapsible:!1,items:[{id:"trang-chu",label:"Trang ch",icon:J0,path:"/",tags:["dashboard","home","tng quan"]},{id:"cong-nhan-vien",label:"Cng nhn vin",icon:d0,path:"/portal",tags:["portal","employee","self-service","mobile","pwa"],badge:"Mi"}]},{id:"cham-cong",title:"Chm cng",collapsible:!0,color:"teal",items:[{id:"cham-cong-menu",label:"Chm cng",icon:an,path:"/cham-cong",requiredPermissions:["CHAM_CONG_VIEW"],tags:["attendance","timesheet","gi lm"]},{id:"bang-cong-thang",label:"Bng cng thng",icon:sf,path:"/timesheet",requiredPermissions:["CHAM_CONG_VIEW"],tags:["timesheet","monthly","bng cng"]},{id:"xep-ca",label:"Xp ca",icon:At,requiredPermissions:["PHAN_CA_VIEW"],tags:["scheduling","shift","ca lm vic"],children:[{id:"danh-muc-ca",label:"Danh mc ca",icon:pj,path:"/xep-ca/danh-muc-ca",tags:["shift","ca"]},{id:"lich-phan-ca",label:"Lch phn ca",icon:sf,path:"/xep-ca/lich-phan-ca",tags:["schedule","calendar","lch"]}]},{id:"nghi-phep",label:"Ngh php",icon:j_,requiredPermissions:["NGHI_PHEP_VIEW"],tags:["leave","off","ngh"],children:[{id:"don-cua-toi",label:"n ngh ca ti",icon:wn,path:"/nghi-phep/don-cua-toi",tags:["my leave","n ca ti"]},{id:"duyet-nghi-phep",label:"Duyt ngh php",icon:Gn,path:"/nghi-phep/duyet",requiredPermissions:["NGHI_PHEP_DUYET"],tags:["approve","duyt"]},{id:"lich-nghi",label:"Lch ngh php",icon:sf,path:"/nghi-phep/lich",tags:["calendar","lch"]},{id:"loai-nghi",label:"Danh mc loi ngh",icon:P_,path:"/nghi-phep/loai-nghi",requiredPermissions:["ADMIN"],tags:["category","loi"]}]},{id:"yeu-cau",label:"Yu cu",icon:T_,requiredPermissions:["YEU_CAU_VIEW"],tags:["request","OT","tr gi","v sm","cng tc"],children:[{id:"don-yeu-cau-cua-toi",label:"n ca ti",icon:Nu,path:"/yeu-cau/don-cua-toi",tags:["my request","n ca ti"]},{id:"duyet-yeu-cau",label:"Duyt yu cu",icon:Gn,path:"/yeu-cau/duyet",requiredPermissions:["YEU_CAU_DUYET_CAP_1","YEU_CAU_DUYET_CAP_2"],tags:["approve","duyt"]}]}]},{id:"ky-luong",title:"K lng",collapsible:!0,color:"blue",items:[{id:"bang-luong",label:"Bng lng",icon:ei,path:"/bang-luong",requiredPermissions:["BANG_LUONG_VIEW"],tags:["payroll","salary sheet","bng tnh"]},{id:"cau-hinh-cot-bang-luong",label:"Cu hnh ct",icon:ns,path:"/cau-hinh/bang-luong",requiredPermissions:["BANG_LUONG_VIEW"],tags:["column","config","cu hnh","ct"]}]},{id:"ung-luong",title:"ng lng",collapsible:!0,color:"purple",items:[{id:"bang-ung-luong",label:"Bng ng lng",icon:ig,path:"/ung-luong",requiredPermissions:["UNG_LUONG_VIEW"],tags:["advance","tm ng"]},{id:"cau-hinh-cot-ung-luong",label:"Cu hnh ct",icon:ns,path:"/cau-hinh/ung-luong",requiredPermissions:["UNG_LUONG_VIEW"],tags:["column","config","cu hnh","ct"]}]},{id:"so-luong",title:"S lng",collapsible:!0,color:"green",items:[{id:"so-luong-nhan-vien",label:"S lng nhn vin",icon:v_,path:"/so-luong/nhan-vien",requiredPermissions:["SO_LUONG_VIEW"],tags:["employee salary book","s lng"]},{id:"so-luong-phong-ban",label:"S lng phng ban",icon:oj,path:"/so-luong/phong-ban",requiredPermissions:["SO_LUONG_VIEW"],tags:["department salary","bo co phng ban"]}]},{id:"co-cau-luong",title:"C cu lng",collapsible:!0,color:"orange",items:[{id:"khoan-luong",label:"Khon lng",icon:U_,path:"/khoan-luong",requiredPermissions:["KHOAN_LUONG_VIEW"],tags:["salary component","thnh phn lng"]},{id:"quy-che",label:"Quy ch lng",icon:z_,path:"/quy-che",requiredPermissions:["QUY_CHE_VIEW"],tags:["rule","engine","cng thc","quy tc"]},{id:"su-kien",label:"S kin thng/pht",icon:lg,path:"/su-kien",requiredPermissions:["SU_KIEN_VIEW"],tags:["bonus","penalty","thng","pht"]}]},{id:"san-luong",title:"Sn lng",collapsible:!0,color:"emerald",items:[{id:"tra-cuu-san-luong",label:"Tra cu sn lng",icon:Vr,path:"/san-luong",requiredPermissions:["SAN_LUONG_VIEW"],tags:["tra cu","search","xem"]},{id:"import-chia-hang",label:"Chia hng",icon:Z0,path:"/import-chia-hang",requiredPermissions:["SAN_LUONG_VIEW"],tags:["sorting","phn loi"]},{id:"import-giao-hang",label:"Giao hng",icon:ex,path:"/import-giao-hang",requiredPermissions:["SAN_LUONG_VIEW"],tags:["delivery","vn chuyn"]},{id:"lich-su-import",label:"Lch s Import",icon:yu,path:"/lich-su-import",requiredPermissions:["SAN_LUONG_VIEW"],tags:["history","lch s"]},{id:"don-gia-san-luong",label:"n gi sn lng",icon:gr,path:"/san-luong/don-gia",requiredPermissions:["SAN_LUONG_VIEW"],tags:["n gi","pricing","cu hnh"]}]},{id:"du-lieu",title:"D liu",collapsible:!0,color:"slate",items:[{id:"nhan-vien",label:"Nhn vin",icon:Y_,path:"/nhan-vien",requiredPermissions:["NHAN_VIEN_VIEW"],tags:["employee","staff","nhn s"]},{id:"phong-ban",label:"Phng ban",icon:xj,path:"/phong-ban",requiredPermissions:["PHONG_BAN_VIEW"],tags:["department","t chc"]},{id:"nhom-nhan-vien",label:"Nhm nhn vin",icon:v0,path:"/nhom-nhan-vien",requiredPermissions:["NHOM_NV_VIEW"],tags:["group","team"]},{id:"kpi",label:"KPI",icon:W_,requiredPermissions:["KPI_VIEW"],tags:["performance","nh gi","hiu sut"],children:[{id:"kpi-template",label:"Template KPI",icon:C_,path:"/kpi/template",tags:["template","mu"]},{id:"kpi-ky-danh-gia",label:"K nh gi",icon:lj,path:"/kpi/ky-danh-gia",tags:["period","k"]},{id:"kpi-cau-hinh-thuong",label:"Cu hnh thng",icon:gr,path:"/kpi/cau-hinh-thuong",tags:["bonus","thng"]}]}]},{id:"thiet-lap",title:"Thit lp h thng",collapsible:!0,color:"cyan",items:[{id:"cai-dat",label:"Ci t h thng",icon:ns,path:"/cai-dat",requiredPermissions:["ADMIN"],tags:["settings","configuration","cu hnh"]},{id:"nguoi-dung",label:"Ngi dng",icon:Q_,path:"/quan-tri/nguoi-dung",requiredPermissions:["ADMIN"],tags:["user","account","ti khon"]},{id:"audit-log",label:"Nht k h thng",icon:$_,path:"/quan-tri/audit-log",requiredPermissions:["ADMIN"],tags:["log","history","nht k"]}]}];function $j(e){const n=[];for(const a of e)for(const r of a.items)n.push(r),r.children&&n.push(...r.children);return n}function FE({isOpen:e,isCollapsed:n,onToggleCollapse:a}){var G;const r=Ds(),{coQuyen:s,coVaiTro:l,user:o,dangXuat:d}=ls(),{favorites:u,toggleFavorite:x,isFavorite:m,isFull:f}=zj(),[p,N]=D.useState(["trang-chu","ky-luong","ung-luong"]),[y,g]=D.useState([]),[b,j]=D.useState(""),T=D.useCallback(J=>!J||J.length===0||l("ADMIN")?!0:J.some(X=>s(X)||l(X)),[s,l]),_=D.useCallback(J=>J.filter(X=>T(X.requiredPermissions)).map(X=>({...X,children:X.children?_(X.children):void 0})).filter(X=>!X.children||X.children.length>0),[T]),w=D.useCallback((J,X)=>{var H;const fe=X.toLowerCase(),ne=[];for(const W of J){const xe=W.label.toLowerCase().includes(fe),K=(H=W.tags)==null?void 0:H.some(Q=>Q.toLowerCase().includes(fe)),L=W.children?w(W.children,X):[];(xe||K||L.length>0)&&ne.push({...W,children:L.length>0?L:W.children})}return ne},[]),E=D.useMemo(()=>{let J=vp.map(X=>({...X,items:_(X.items)})).filter(X=>X.items.length>0);return b&&(J=J.map(X=>({...X,items:w(X.items,b)})).filter(X=>X.items.length>0)),J},[_,w,b]),C=D.useMemo(()=>{if(u.length===0)return null;const J=$j(vp),X=u.map(fe=>J.find(ne=>ne.id===fe)).filter(fe=>!!fe&&T(fe.requiredPermissions));return X.length===0?null:{id:"favorites",title:"Yu thch",items:X}},[u,T]),S=J=>{N(X=>X.includes(J)?X.filter(fe=>fe!==J):[...X,J])},P=J=>{g(X=>X.includes(J)?X.filter(fe=>fe!==J):[...X,J])},F=(J,X)=>{J.preventDefault(),J.stopPropagation(),m(X.id)?(x(X.id),ie.success(` b "${X.label}" khi yu thch`)):f?ie.error("Ch c th ghim ti a 8 mc yu thch"):(x(X.id),ie.success(` thm "${X.label}" vo yu thch`))},B=J=>J.path==="/"?r.pathname==="/":J.path&&r.pathname.startsWith(J.path),O=(J,X=0)=>{var Q;const fe=J.icon,ne=J.children&&J.children.length>0,H=y.includes(J.id),W=B(J),xe=m(J.id),K=t.jsxs(t.Fragment,{children:[t.jsx("div",{className:`
          flex items-center justify-center w-9 h-9 rounded-xl transition-all
          ${W?"bg-accent/20":"bg-transparent"}
        `,children:t.jsx(fe,{size:X>0?16:18,className:W?"text-accent":"text-sidebar-muted",strokeWidth:W?2.5:2})}),!n&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:`
              flex-1 truncate text-sm transition-colors
              ${W?"text-white font-medium":"text-sidebar-muted"}
            `,children:J.label}),J.path&&t.jsx("button",{onClick:I=>F(I,J),className:`
                  p-1.5 rounded-lg opacity-0 group-hover:opacity-100 transition-all
                  ${xe?"opacity-100 text-yellow-400":"text-sidebar-muted hover:text-yellow-400"}
                  hover:bg-white/5
                `,title:xe?"B yu thch":"Thm vo yu thch",children:t.jsx(N0,{size:14,fill:xe?"currentColor":"none"})}),ne&&t.jsx(Ja,{size:16,className:`text-sidebar-muted transition-transform ${H?"rotate-180":""}`})]})]}),L=`
      group flex items-center gap-3 px-2 py-1.5 mx-2 rounded-xl transition-all duration-200
      ${W?"bg-white/5 border border-accent/50 text-white":"hover:bg-white/5 border border-transparent"}
      ${X>0?"ml-4":""}
    `;return ne?t.jsxs("div",{children:[t.jsx("button",{onClick:()=>P(J.id),className:L,style:{width:"calc(100% - 16px)"},title:n?J.label:void 0,children:K}),H&&!n&&t.jsx("div",{className:"mt-1 space-y-0.5 ml-4 border-l border-white/10 pl-2",children:(Q=J.children)==null?void 0:Q.map(I=>O(I,X+1))})]},J.id):t.jsx(xa,{to:J.path||"#",className:L,title:n?J.label:void 0,children:K},J.id)},M=(J,X)=>{const fe=p.includes(J.id);return t.jsxs("div",{className:"mb-2",children:[!n&&t.jsxs("button",{onClick:()=>S(J.id),className:`
              w-full flex items-center justify-between px-4 py-2 
              text-[11px] font-semibold uppercase tracking-wider text-sidebar-muted
              hover:text-white/80 transition-colors
            `,children:[t.jsxs("span",{className:"flex items-center gap-2",children:[X&&t.jsx(N0,{size:12,className:"text-yellow-400",fill:"currentColor"}),J.title]}),t.jsx(qn,{size:12,className:`transition-transform ${fe?"rotate-90":""}`})]}),(fe||n)&&t.jsx("div",{className:"space-y-0.5",children:J.items.map(ne=>O(ne,0))})]},J.id)};return e?t.jsxs("aside",{className:`
        fixed left-0 top-0 bottom-0 z-50
        flex flex-col
        transition-all duration-300 ease-out
        ${n?"w-[72px]":"w-[260px]"}
      `,style:{background:"linear-gradient(180deg, #0B1220 0%, #0F1B2E 100%)",borderRadius:"0 32px 32px 0",margin:"12px 0 12px 12px",height:"calc(100vh - 24px)",boxShadow:"0 0 40px rgba(0, 0, 0, 0.3)"},children:[t.jsxs("div",{className:`
        flex items-center gap-3 px-5 py-6 border-b border-white/5
        ${n?"justify-center":""}
      `,children:[t.jsx("div",{className:`
          w-10 h-10 rounded-xl bg-gradient-to-br from-accent to-accent2 
          flex items-center justify-center shadow-glow-accent
        `,children:t.jsx(lg,{size:22,className:"text-sidebar-solid",strokeWidth:2.5})}),!n&&t.jsxs("div",{children:[t.jsx("h1",{className:"text-white font-bold text-lg tracking-tight",children:"HRM"}),t.jsx("p",{className:"text-sidebar-muted text-xs",children:"Qun l NS & Tnh lng"})]})]}),!n&&t.jsx("div",{className:"px-4 py-3",children:t.jsxs("div",{className:"relative",children:[t.jsx(Vr,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-sidebar-muted"}),t.jsx("input",{type:"text",value:b,onChange:J=>j(J.target.value),placeholder:"Tm nhanh (Ctrl+K)",className:`
                w-full pl-9 pr-8 py-2.5 text-sm rounded-xl
                bg-white/5 border border-white/10
                text-white placeholder:text-sidebar-muted
                focus:outline-none focus:ring-2 focus:ring-accent/50 focus:border-accent/50
                transition-all
              `}),b&&t.jsx("button",{onClick:()=>j(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-sidebar-muted hover:text-white",children:t.jsx(rn,{size:16})})]})}),t.jsxs("nav",{className:"flex-1 py-2 overflow-y-auto overflow-x-hidden scrollbar-thin",children:[C&&!b&&M(C,!0),C&&!b&&t.jsx("div",{className:"my-3 mx-4 border-t border-white/5"}),E.map(J=>M(J)),b&&E.length===0&&t.jsxs("div",{className:"px-4 py-8 text-center text-sidebar-muted text-sm",children:['Khng tm thy "',b,'"']})]}),t.jsxs("div",{className:"border-t border-white/5 p-3",children:[t.jsxs("div",{className:`flex items-center gap-2 ${n?"flex-col":""}`,children:[t.jsxs(xa,{to:"/ho-so",className:`
              flex items-center gap-3 flex-1 p-2 rounded-xl
              hover:bg-white/5 transition-all group
            `,title:n?(o==null?void 0:o.hoTen)||"H s":void 0,children:[t.jsx("div",{className:`
              w-9 h-9 rounded-xl bg-gradient-to-br from-purple-500 to-pink-500
              flex items-center justify-center text-white font-semibold text-sm
            `,children:((G=o==null?void 0:o.hoTen)==null?void 0:G.charAt(0))||"U"}),!n&&t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-white text-sm font-medium truncate",children:(o==null?void 0:o.hoTen)||"Ngi dng"}),t.jsx("p",{className:"text-sidebar-muted text-xs truncate",children:(o==null?void 0:o.email)||(o==null?void 0:o.tenDangNhap)})]})]}),t.jsxs("div",{className:`flex gap-1 ${n?"flex-col":""}`,children:[t.jsx(xa,{to:"/cai-dat",className:`
                p-2.5 rounded-xl text-sidebar-muted hover:text-white hover:bg-white/5
                transition-all
              `,title:"Ci t",children:t.jsx(ns,{size:18})}),t.jsx("button",{onClick:d,className:`
                p-2.5 rounded-xl text-sidebar-muted hover:text-red-400 hover:bg-red-500/10
                transition-all
              `,title:"ng xut",children:t.jsx(ag,{size:18})})]})]}),t.jsx("button",{onClick:a,className:`
            w-full mt-3 flex items-center justify-center gap-2 py-2.5 rounded-xl
            text-sidebar-muted hover:text-white hover:bg-white/5
            transition-all text-sm
          `,children:n?t.jsx(qn,{size:18}):t.jsxs(t.Fragment,{children:[t.jsx(Nr,{size:18}),t.jsx("span",{children:"Thu gn"})]})})]})]}):null}const bp=[{path:"/",label:"Trang ch",group:"Tng quan",quickActions:[{id:"tao-ky-luong",label:"To k lng",icon:Dt,type:"route",to:"/bang-luong?action=create",requiredPermissions:["BANG_LUONG_CREATE"]},{id:"import-excel",label:"Import Excel",icon:Zr,type:"route",to:"/import-excel",requiredPermissions:["IMPORT_EXCEL"]}]},{path:"/nhan-vien",label:"Nhn vin",group:"D liu u vo",quickActions:[{id:"them-nhan-vien",label:"Thm nhn vin",icon:Dt,type:"callback",callbackKey:"OPEN_ADD_NHAN_VIEN_MODAL",requiredPermissions:["NHAN_VIEN_CREATE"]},{id:"xuat-excel-nv",label:"Xut Excel",icon:ws,type:"callback",callbackKey:"EXPORT_NHAN_VIEN_EXCEL"}]},{path:"/nhan-vien/:id",label:"Chi tit nhn vin",parent:"/nhan-vien",dynamicLabel:e=>`Nhn vin #${e.id}`},{path:"/phong-ban",label:"Phng ban",group:"D liu u vo",quickActions:[{id:"them-phong-ban",label:"Thm phng ban",icon:Dt,type:"callback",callbackKey:"OPEN_ADD_PHONG_BAN_MODAL",requiredPermissions:["PHONG_BAN_CREATE"]}]},{path:"/nhom-nhan-vien",label:"Nhm nhn vin",group:"D liu u vo"},{path:"/cham-cong",label:"Chm cng",group:"D liu u vo",quickActions:[{id:"import-cham-cong",label:"Import chm cng",icon:Zr,type:"callback",callbackKey:"IMPORT_CHAM_CONG",requiredPermissions:["CHAM_CONG_IMPORT"]},{id:"tong-hop-ngay-cong",label:"Tng hp ngy cng",icon:cb,type:"callback",callbackKey:"TONG_HOP_NGAY_CONG"}]},{path:"/nghi-phep/don-cua-toi",label:"n ngh ca ti",group:"Ngh php",quickActions:[{id:"tao-don-nghi",label:"To n ngh",icon:Dt,type:"callback",callbackKey:"OPEN_TAO_DON_NGHI_MODAL"}]},{path:"/nghi-phep/duyet",label:"Duyt ngh php",group:"Ngh php",requiredPermissions:["NGHI_PHEP_DUYET"]},{path:"/nghi-phep/lich",label:"Lch ngh php",group:"Ngh php"},{path:"/nghi-phep/loai-nghi",label:"Danh mc loi ngh",group:"Ngh php",requiredPermissions:["ADMIN"],quickActions:[{id:"them-loai-nghi",label:"Thm loi ngh",icon:Dt,type:"callback",callbackKey:"OPEN_ADD_LOAI_NGHI_MODAL",requiredPermissions:["ADMIN"]}]},{path:"/kpi/template",label:"Template KPI",group:"KPI"},{path:"/kpi/ky-danh-gia",label:"K nh gi",group:"KPI"},{path:"/kpi/cau-hinh-thuong",label:"Cu hnh thng",group:"KPI"},{path:"/import-chia-hang",label:"Chia hng",group:"Sn lng",quickActions:[{id:"import-chia-hang",label:"Import file",icon:Zr,type:"callback",callbackKey:"IMPORT_CHIA_HANG"}]},{path:"/import-giao-hang",label:"Giao hng",group:"Sn lng",quickActions:[{id:"import-giao-hang",label:"Import file",icon:Zr,type:"callback",callbackKey:"IMPORT_GIAO_HANG"}]},{path:"/lich-su-import",label:"Lch s Import",group:"Sn lng"},{path:"/import-excel",label:"Import Excel",group:"D liu u vo"},{path:"/quy-che",label:"Quy ch lng",group:"Tnh lng",quickActions:[{id:"tao-rule",label:"To rule mi",icon:Dt,type:"callback",callbackKey:"OPEN_TAO_RULE_MODAL",requiredPermissions:["QUY_CHE_CREATE"]},{id:"preview-rule",label:"Preview",icon:xp,type:"route",to:"/rule-trace"}]},{path:"/quy-che/:id",label:"Chi tit quy ch",parent:"/quy-che",dynamicLabel:e=>`Quy ch #${e.id}`},{path:"/khoan-luong",label:"Khon lng",group:"Tnh lng",quickActions:[{id:"them-khoan-luong",label:"Thm khon lng",icon:Dt,type:"callback",callbackKey:"OPEN_ADD_KHOAN_LUONG_MODAL",requiredPermissions:["KHOAN_LUONG_CREATE"]}]},{path:"/su-kien",label:"S kin thng/pht",group:"Tnh lng"},{path:"/bang-luong",label:"Bng lng",group:"K lng",quickActions:[{id:"tao-bang-luong",label:"To bng lng",icon:Dt,type:"callback",callbackKey:"OPEN_TAO_BANG_LUONG_MODAL",requiredPermissions:["BANG_LUONG_CREATE"]}]},{path:"/bang-luong/:id",label:"Chi tit bng lng",parent:"/bang-luong",dynamicLabel:e=>`Bng lng #${e.id}`,quickActions:[{id:"snapshot",label:"Snapshot",icon:w_,type:"callback",callbackKey:"SNAPSHOT_BANG_LUONG"},{id:"chay-rule",label:"Chy Rule",icon:xp,type:"callback",callbackKey:"RUN_RULE_ENGINE",requiredPermissions:["BANG_LUONG_TINH"]},{id:"tinh-lai",label:"Tnh li",icon:yr,type:"callback",callbackKey:"TINH_LAI_LUONG"},{id:"chot-ky",label:"Cht k",icon:Gn,type:"callback",callbackKey:"CHOT_KY_LUONG",requiredPermissions:["BANG_LUONG_CHOT"]},{id:"khoa-ky",label:"Kho k",icon:ti,type:"callback",callbackKey:"KHOA_KY_LUONG",danger:!0,confirmMessage:"Kho vnh vin k lng ny? Sau khi kho s khng th m li.",confirmKeyword:"KHOA",requiredPermissions:["BANG_LUONG_KHOA"]},{id:"mo-khoa",label:"M kho",icon:sg,type:"callback",callbackKey:"MO_KHOA_BANG_LUONG",requiredPermissions:["BANG_LUONG_KHOA"]},{id:"xuat-excel",label:"Xut Excel",icon:ws,type:"callback",callbackKey:"EXPORT_BANG_LUONG_EXCEL"},{id:"gui-phieu-luong",label:"Gi phiu lng",icon:Nu,type:"callback",callbackKey:"GUI_PHIEU_LUONG_TAT_CA"}]},{path:"/ung-luong",label:"Bng ng lng",group:"ng lng",quickActions:[{id:"tao-bang-ung",label:"To bng ng",icon:Dt,type:"callback",callbackKey:"OPEN_TAO_BANG_UNG_MODAL",requiredPermissions:["UNG_LUONG_CREATE"]}]},{path:"/ung-luong/:id",label:"Chi tit bng ng lng",parent:"/ung-luong",dynamicLabel:e=>`Bng ng #${e.id}`,quickActions:[{id:"tinh-eligibility",label:"Tnh eligibility",icon:cb,type:"callback",callbackKey:"TINH_ELIGIBILITY_UNG_LUONG"},{id:"chot-bang-ung",label:"Cht",icon:Gn,type:"callback",callbackKey:"CHOT_BANG_UNG_LUONG",requiredPermissions:["UNG_LUONG_CHOT"]},{id:"xuat-excel-ung",label:"Xut Excel",icon:ws,type:"callback",callbackKey:"EXPORT_UNG_LUONG_EXCEL"}]},{path:"/so-luong/nhan-vien",label:"S lng nhn vin",group:"Bo co",quickActions:[{id:"xuat-so-luong-nv",label:"Xut Excel",icon:ws,type:"callback",callbackKey:"EXPORT_SO_LUONG_NV"}]},{path:"/so-luong/phong-ban",label:"S lng phng ban",group:"Bo co",quickActions:[{id:"xuat-so-luong-pb",label:"Xut Excel",icon:ws,type:"callback",callbackKey:"EXPORT_SO_LUONG_PB"}]},{path:"/cai-dat",label:"Ci t h thng",group:"Thit lp",requiredPermissions:["ADMIN"]},{path:"/quan-tri/nguoi-dung",label:"Ngi dng",group:"Qun tr",requiredPermissions:["ADMIN"],quickActions:[{id:"them-nguoi-dung",label:"Thm ngi dng",icon:Dt,type:"callback",callbackKey:"OPEN_ADD_NGUOI_DUNG_MODAL",requiredPermissions:["ADMIN"]}]},{path:"/quan-tri/audit-log",label:"Audit Log",group:"Qun tr",requiredPermissions:["ADMIN"]},{path:"/rule-trace",label:"Rule Trace",group:"Tnh lng"}];function Np(e){const n=bp.find(a=>a.path===e);if(n)return n;for(const a of bp)if(a.path.includes(":")){const r=a.path.replace(/:[^/]+/g,"[^/]+");if(new RegExp(`^${r}$`).test(e))return a}}function LE(e,n){const a={},r=n.split("/"),s=e.split("/");for(let l=0;l<r.length;l++)if(r[l].startsWith(":")){const o=r[l].slice(1);a[o]=s[l]}return a}function PE(){const e=Ds(),n=D.useMemo(()=>{const a=[];e.pathname!=="/"&&a.push({label:"Trang ch",path:"/"});const r=Np(e.pathname);if(!r)return a;if(r.group&&r.group!=="Tng quan"&&a.push({label:r.group}),r.parent){const l=Np(r.parent);l&&a.push({label:l.label,path:l.path})}let s=r.label;if(r.dynamicLabel&&r.path.includes(":")){const l=LE(e.pathname,r.path);s=r.dynamicLabel(l)}return a.push({label:s}),a},[e.pathname]);return n.length<=1&&e.pathname==="/"?null:t.jsx("nav",{className:"flex items-center gap-1",children:n.map((a,r)=>{const s=r===n.length-1,l=r===0;return t.jsxs("div",{className:"flex items-center",children:[r>0&&t.jsx(qn,{size:14,className:"mx-1.5 text-text-muted"}),a.path&&!s?t.jsxs(xa,{to:a.path,className:`
                  flex items-center gap-1.5 px-2 py-1 rounded-lg
                  text-text-secondary text-sm
                  hover:text-text hover:bg-panel
                  transition-all
                `,children:[l&&t.jsx(J0,{size:14}),t.jsx("span",{children:a.label})]}):t.jsx("span",{className:`
                  px-2 py-1 rounded-lg text-sm
                  ${s?"text-text font-medium bg-panel border border-border":"text-text-muted"}
                  max-w-[200px] truncate
                `,title:a.label,children:a.label})]},r)})})}const IE=[{id:1,type:"success",title:"Bng lng  tnh xong",message:"Bng lng thng 01/2026  c tnh ton thnh cng",time:"5 pht trc",read:!1},{id:2,type:"warning",title:"Cn duyt ng lng",message:"C 3 yu cu ng lng ch duyt",time:"1 gi trc",read:!1},{id:3,type:"info",title:"Import sn lng",message:"File chia hng thng 01  c import",time:"2 gi trc",read:!0}];function OE({sidebarCollapsed:e}){const[n,a]=D.useState(!1),[r,s]=D.useState(IE),l=D.useRef(null),o=r.filter(p=>!p.read).length;D.useEffect(()=>{const p=N=>{l.current&&!l.current.contains(N.target)&&a(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]);const d=p=>{s(N=>N.map(y=>y.id===p?{...y,read:!0}:y))},u=()=>{s(p=>p.map(N=>({...N,read:!0})))},x=()=>{s([])},m=p=>{switch(p){case"success":return t.jsx(dj,{size:16,className:"text-green-500"});case"warning":return t.jsx(sa,{size:16,className:"text-amber-500"});default:return t.jsx(vu,{size:16,className:"text-blue-500"})}},f=()=>{window.dispatchEvent(new CustomEvent("open-command-palette"))};return t.jsxs("header",{className:`
        fixed top-0 right-0 z-40
        h-16 flex items-center justify-between gap-4
        px-6 transition-all duration-300
        bg-bg-main/80 backdrop-blur-md
      `,style:{left:e?"96px":"284px"},children:[t.jsx("div",{className:"flex items-center gap-4",children:t.jsx(PE,{})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:f,className:`
            flex items-center gap-2 px-3 py-2 rounded-xl
            bg-panel border border-border
            text-text-secondary text-sm
            hover:bg-panel-hover hover:border-border-hover
            transition-all
            backdrop-blur-xl
          `,title:"Tm kim nhanh (Ctrl+K)",children:[t.jsx(Vr,{size:16}),t.jsx("span",{className:"hidden md:inline",children:"Tm kim..."}),t.jsxs("kbd",{className:`
            hidden md:inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded
            bg-bg-2 text-text-muted text-xs font-mono
          `,children:[t.jsx(__,{size:10}),"K"]})]}),t.jsxs("div",{className:"relative",ref:l,children:[t.jsxs("button",{onClick:()=>a(!n),className:`
              relative p-2.5 rounded-xl
              bg-panel border border-border
              text-text-secondary
              hover:bg-panel-hover hover:text-text
              transition-all
              backdrop-blur-xl
            `,title:"Thng bo",children:[t.jsx(jc,{size:18}),o>0&&t.jsx("span",{className:`
                absolute -top-1 -right-1 min-w-[18px] h-[18px] 
                flex items-center justify-center
                bg-accent text-white text-xs font-medium
                rounded-full px-1
              `,children:o>9?"9+":o})]}),n&&t.jsxs("div",{className:`
              absolute top-full right-0 mt-2 w-80
              bg-panel border border-border rounded-xl
              shadow-xl overflow-hidden
              animate-in fade-in slide-in-from-top-2 duration-200
            `,children:[t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[t.jsx("h3",{className:"font-semibold text-text",children:"Thng bo"}),t.jsxs("div",{className:"flex items-center gap-2",children:[o>0&&t.jsx("button",{onClick:u,className:"text-xs text-accent hover:text-accent/80 transition-colors",title:"nh du tt c  c",children:t.jsx(Br,{size:14})}),r.length>0&&t.jsx("button",{onClick:x,className:"text-xs text-text-muted hover:text-text transition-colors",title:"Xa tt c",children:t.jsx(rn,{size:14})})]})]}),t.jsx("div",{className:"max-h-80 overflow-y-auto",children:r.length===0?t.jsxs("div",{className:"px-4 py-8 text-center text-text-muted",children:[t.jsx(jc,{size:32,className:"mx-auto mb-2 opacity-50"}),t.jsx("p",{children:"Khng c thng bo"})]}):r.map(p=>t.jsx("div",{onClick:()=>d(p.id),className:`
                        px-4 py-3 border-b border-border/50 last:border-0
                        hover:bg-panel-hover cursor-pointer transition-colors
                        ${p.read?"":"bg-accent/5"}
                      `,children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{className:"mt-0.5",children:m(p.type)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsx("p",{className:`text-sm font-medium ${p.read?"text-text-secondary":"text-text"}`,children:p.title}),!p.read&&t.jsx("span",{className:"w-2 h-2 bg-accent rounded-full flex-shrink-0 mt-1.5"})]}),t.jsx("p",{className:"text-xs text-text-muted mt-0.5 line-clamp-2",children:p.message}),t.jsx("p",{className:"text-xs text-text-muted/70 mt-1",children:p.time})]})]})},p.id))}),r.length>0&&t.jsx("div",{className:"px-4 py-2 border-t border-border bg-bg-2/50",children:t.jsx("button",{className:"w-full text-center text-xs text-accent hover:text-accent/80 py-1",children:"Xem tt c thng bo"})})]})]})]})]})}const ME=10,RE="payroll_recent_";function Gj(){const{user:e}=ls(),n=Ds(),[a,r]=D.useState([]),s=e?`${RE}${e.id}`:null;D.useEffect(()=>{if(s){const u=localStorage.getItem(s);if(u)try{const x=JSON.parse(u);Array.isArray(x)&&r(x)}catch{}}},[s]);const l=D.useCallback(u=>{s&&localStorage.setItem(s,JSON.stringify(u))},[s]);D.useEffect(()=>{if(!s)return;const u=Np(n.pathname);if(!u||n.pathname==="/dang-nhap")return;const x={path:n.pathname,title:u.label,time:Date.now()};r(m=>{const f=m.filter(N=>N.path!==x.path),p=[x,...f].slice(0,ME);return l(p),p})},[n.pathname,s,l]);const o=D.useCallback(u=>{r(x=>{const m=x.filter(f=>f.path!==u);return l(m),m})},[l]),d=D.useCallback(()=>{r([]),s&&localStorage.removeItem(s)},[s]);return{recentPages:a,removeRecent:o,clearRecent:d}}class BE{constructor(){Ym(this,"handlers",new Map);Ym(this,"listeners",new Set)}register(n,a){return this.handlers.set(n,a),this.notifyListeners(),()=>this.unregister(n)}unregister(n){this.handlers.delete(n),this.notifyListeners()}has(n){return this.handlers.has(n)}async execute(n){const a=this.handlers.get(n);return a?(await a(),!0):!1}getRegisteredKeys(){return Array.from(this.handlers.keys())}subscribe(n){return this.listeners.add(n),()=>this.listeners.delete(n)}notifyListeners(){this.listeners.forEach(n=>n())}}const qh=new BE;function HE(){const[,e]=D.useState(0);return D.useEffect(()=>{const n=qh.subscribe(()=>{e(a=>a+1)});return()=>{n()}},[]),{has:n=>qh.has(n),execute:n=>qh.execute(n),keys:qh.getRegisteredKeys()}}function VE({isOpen:e,onClose:n}){const a=br(),{coQuyen:r,coVaiTro:s}=ls(),{favorites:l}=zj(),{recentPages:o}=Gj(),d=HE(),[u,x]=D.useState(""),[m,f]=D.useState(0),[p,N]=D.useState(null),[y,g]=D.useState(""),b=D.useRef(null),j=D.useRef(null);D.useEffect(()=>{e&&(x(""),f(0),N(null),setTimeout(()=>{var F;return(F=b.current)==null?void 0:F.focus()},50))},[e]);const T=D.useCallback(F=>!F||F.length===0||s("ADMIN")?!0:F.some(B=>r(B)||s(B)),[r,s]),_=D.useMemo(()=>{const F=[],B=$j(vp),O=u.toLowerCase();if(!u&&l.length>0){const J=l.map(X=>B.find(fe=>fe.id===X)).filter(X=>!!X&&T(X.requiredPermissions)).map(X=>({id:`fav-${X.id}`,type:"favorite",label:X.label,icon:t.jsx(X.icon,{size:16}),path:X.path}));J.length>0&&F.push({id:"favorites",title:"Yu thch",icon:t.jsx(N0,{size:14}),items:J})}if(!u&&o.length>0){const J=o.slice(0,5).map(X=>({id:`recent-${X.path}`,type:"recent",label:X.title,description:X.path,icon:t.jsx(an,{size:16}),path:X.path}));J.length>0&&F.push({id:"recent",title:"Gn y",icon:t.jsx(an,{size:14}),items:J})}const M=B.filter(J=>{var X;return!J.path||!T(J.requiredPermissions)?!1:u?J.label.toLowerCase().includes(O)||((X=J.tags)==null?void 0:X.some(fe=>fe.toLowerCase().includes(O))):!0}).map(J=>({id:`route-${J.id}`,type:"route",label:J.label,icon:t.jsx(J.icon,{size:16}),path:J.path}));M.length>0&&F.push({id:"routes",title:"i ti",icon:t.jsx(wc,{size:14}),items:u?M.slice(0,8):M.slice(0,5)});const G=[];for(const J of bp)if(J.quickActions)for(const X of J.quickActions){if(!T(X.requiredPermissions))continue;(!u||X.label.toLowerCase().includes(O)||J.label.toLowerCase().includes(O))&&G.push({id:`action-${J.path}-${X.id}`,type:"action",label:X.label,description:`trong ${J.label}`,icon:t.jsx(X.icon,{size:16}),action:X,danger:X.danger})}return G.length>0&&F.push({id:"actions",title:"Thao tc nhanh",icon:t.jsx(lg,{size:14}),items:u?G.slice(0,8):G.slice(0,5)}),s("ADMIN")&&!u&&F.push({id:"admin",title:"Qun tr",icon:t.jsx(ns,{size:14}),items:[{id:"admin-users",type:"route",label:"Qun l ngi dng",icon:t.jsx(ns,{size:16}),path:"/quan-tri/nguoi-dung"},{id:"admin-audit",type:"route",label:"Audit Log",icon:t.jsx(ns,{size:16}),path:"/quan-tri/audit-log"}]}),F},[u,l,o,T,s]),w=D.useMemo(()=>_.flatMap(F=>F.items),[_]);D.useEffect(()=>{const F=document.querySelector(`[data-index="${m}"]`);F==null||F.scrollIntoView({block:"nearest"})},[m]);const E=F=>{if(p){F.key==="Escape"?(N(null),g("")):F.key==="Enter"&&(!p.confirmKeyword||y.toUpperCase()===p.confirmKeyword.toUpperCase())&&(C(p),N(null),g(""));return}switch(F.key){case"ArrowDown":F.preventDefault(),f(B=>Math.min(B+1,w.length-1));break;case"ArrowUp":F.preventDefault(),f(B=>Math.max(B-1,0));break;case"Enter":F.preventDefault(),w[m]&&S(w[m]);break;case"Escape":n();break}},C=async F=>{n(),F.type==="route"&&F.to?a(F.to):F.type==="callback"&&F.callbackKey&&await d.execute(F.callbackKey)},S=F=>{if(F.type==="action"&&F.action){if(F.danger&&F.action.confirmKeyword){N(F.action);return}C(F.action)}else F.path&&(n(),a(F.path))},P=F=>u?F.split(new RegExp(`(${u})`,"gi")).map((O,M)=>O.toLowerCase()===u.toLowerCase()?t.jsx("mark",{className:"bg-[#53F39A]/30 text-[#53F39A] px-0.5 rounded",children:O},M):O):F;return e?t.jsxs("div",{className:"fixed inset-0 z-[100] flex items-start justify-center pt-[12vh]",children:[t.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-md",onClick:n}),t.jsx("div",{className:`
          relative w-full max-w-2xl overflow-hidden
          rounded-2xl border border-white/10
          bg-[#0B1220]/95 backdrop-blur-xl
          shadow-2xl shadow-black/40
          animate-fade-in
        `,onKeyDown:E,children:p?t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center gap-3 text-[#FF4D6D] mb-4",children:[t.jsx(sa,{size:24}),t.jsx("h3",{className:"text-lg font-semibold",children:"Xc nhn thao tc"})]}),t.jsx("p",{className:"text-slate-300 mb-4",children:p.confirmMessage||`Bn c chc mun "${p.label}"?`}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("label",{className:"block text-sm text-slate-400 mb-2",children:["G ",t.jsx("span",{className:"font-mono font-bold text-[#FF4D6D]",children:p.confirmKeyword}),"  xc nhn:"]}),t.jsx("input",{type:"text",value:y,onChange:F=>g(F.target.value),className:`
                  w-full px-4 py-3 rounded-xl
                  bg-white/5 border border-white/10
                  text-white placeholder-slate-500
                  focus:outline-none focus:ring-2 focus:ring-[#FF4D6D]/50 focus:border-[#FF4D6D]/50
                `,placeholder:`G ${p.confirmKeyword}...`,autoFocus:!0})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{N(null),g("")},className:"px-4 py-2 text-slate-400 hover:text-white hover:bg-white/10 rounded-xl transition-colors",children:"Hu"}),t.jsx("button",{onClick:()=>{(!p.confirmKeyword||y.toUpperCase()===p.confirmKeyword.toUpperCase())&&(C(p),N(null),g(""))},disabled:!!(p.confirmKeyword&&y.toUpperCase()!==p.confirmKeyword.toUpperCase()),className:"px-4 py-2 bg-[#FF4D6D] text-white rounded-xl hover:bg-[#FF4D6D]/80 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Xc nhn"})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-3 px-5 py-4 border-b border-white/10",children:[t.jsx(Vr,{size:20,className:"text-slate-500"}),t.jsx("input",{ref:b,type:"text",value:u,onChange:F=>{x(F.target.value),f(0)},placeholder:"Tm trang, thao tc...",className:`
                  flex-1 text-lg bg-transparent text-white
                  outline-none placeholder:text-slate-500
                `}),t.jsx("kbd",{className:"hidden sm:inline-flex items-center px-2 py-1 text-xs text-slate-500 bg-white/5 border border-white/10 rounded-lg",children:"ESC"}),t.jsx("button",{onClick:n,className:"p-1 text-slate-500 hover:text-white sm:hidden transition-colors",children:t.jsx(rn,{size:20})})]}),t.jsx("div",{ref:j,className:"max-h-[55vh] overflow-y-auto",children:_.length===0?t.jsxs("div",{className:"px-5 py-10 text-center text-slate-500",children:['Khng tm thy kt qu cho "',u,'"']}):_.map((F,B)=>{const O=_.slice(0,B).reduce((M,G)=>M+G.items.length,0);return t.jsxs("div",{className:"py-2",children:[t.jsxs("div",{className:"flex items-center gap-2 px-5 py-2 text-xs font-semibold text-slate-500 uppercase tracking-wider",children:[F.icon,F.title]}),F.items.map((M,G)=>{const J=O+G,X=J===m;return t.jsxs("button",{"data-index":J,onClick:()=>S(M),onMouseEnter:()=>f(J),className:`
                              w-full flex items-center gap-3 px-5 py-3 text-left transition-all duration-150
                              ${X?"bg-[#53F39A]/10 border-l-2 border-l-[#53F39A]":"border-l-2 border-l-transparent hover:bg-white/5"}
                              ${M.danger?"text-[#FF4D6D]":"text-slate-300"}
                            `,children:[t.jsx("span",{className:`
                              flex-shrink-0 w-8 h-8 rounded-lg flex items-center justify-center
                              ${X?"bg-[#53F39A]/20 text-[#53F39A]":M.danger?"bg-[#FF4D6D]/10 text-[#FF4D6D]":"bg-white/5 text-slate-400"}
                            `,children:M.icon}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:`font-medium ${X?"text-white":""}`,children:P(M.label)}),M.description&&t.jsx("div",{className:"text-xs text-slate-500 truncate",children:M.description})]}),M.type==="favorite"&&t.jsx(N0,{size:14,className:"text-amber-400",fill:"currentColor"})]},M.id)})]},F.id)})}),t.jsxs("div",{className:"flex items-center justify-between px-5 py-3 border-t border-white/10 bg-white/[0.02] text-xs text-slate-500",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("kbd",{className:"px-1.5 py-0.5 bg-white/5 border border-white/10 rounded",children:""}),t.jsx("span",{className:"hidden sm:inline",children:"di chuyn"})]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("kbd",{className:"px-1.5 py-0.5 bg-white/5 border border-white/10 rounded",children:""}),t.jsx("span",{className:"hidden sm:inline",children:"chn"})]})]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("kbd",{className:"px-1.5 py-0.5 bg-white/5 border border-white/10 rounded",children:"esc"}),t.jsx("span",{className:"hidden sm:inline",children:"ng"})]})]})]})})]}):null}function UE(){const[e,n]=D.useState(!1),a=D.useCallback(()=>n(!0),[]),r=D.useCallback(()=>n(!1),[]),s=D.useCallback(()=>n(l=>!l),[]);return D.useEffect(()=>{const l=o=>{(o.ctrlKey||o.metaKey)&&o.key==="k"&&(o.preventDefault(),s())};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[s]),{isOpen:e,open:a,close:r,toggle:s}}function KE(){document.documentElement.setAttribute("data-theme","light");const e=document.querySelector('meta[name="theme-color"]');e&&e.setAttribute("content","#f8fafc")}function zE(){KE()}function $E(){const[e,n]=D.useState(!0),[a,r]=D.useState(!1),s=UE();Gj(),D.useEffect(()=>{zE()},[]),D.useEffect(()=>{const u=()=>{window.innerWidth<768?n(!1):window.innerWidth<1024?(n(!0),r(!0)):(n(!0),r(!1))};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),D.useEffect(()=>{const u=()=>s.open();return window.addEventListener("open-command-palette",u),()=>window.removeEventListener("open-command-palette",u)},[s]);const l=()=>{r(!a)},d=(a?72:260)+36;return t.jsxs("div",{className:"min-h-screen",style:{background:"var(--bg-app)"},children:[t.jsx(FE,{isOpen:e,isCollapsed:a,onToggleCollapse:l}),t.jsxs("div",{className:"min-h-screen transition-all duration-300",style:{marginLeft:e?`${d}px`:"24px",paddingRight:"24px"},children:[t.jsx(OE,{onToggleSidebar:l,sidebarCollapsed:a}),t.jsx("main",{className:"pt-20 pb-8",children:t.jsx("div",{className:"animate-fade-in",children:t.jsx(Z2,{})})})]}),t.jsx(VE,{isOpen:s.isOpen,onClose:s.close}),e&&t.jsx("div",{className:"fixed inset-0 bg-black/30 z-40 lg:hidden backdrop-blur-sm",onClick:()=>n(!1)})]})}const qj="tinh_luong_auth",he=Zt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});he.interceptors.request.use(e=>{const n=localStorage.getItem(qj);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));he.interceptors.response.use(e=>e,e=>{var n;return((n=e.response)==null?void 0:n.status)===401&&(localStorage.removeItem(qj),window.location.pathname!=="/dang-nhap"&&(window.location.href="/dang-nhap?expired=1")),Promise.reject(e)});const Jt={layTatCa:()=>he.get("/phong-ban").then(e=>e.data),layCayPhongBan:()=>he.get("/phong-ban/cay").then(e=>e.data),layTheoId:e=>he.get(`/phong-ban/${e}`).then(n=>n.data),taoMoi:e=>he.post("/phong-ban",e).then(n=>n.data),capNhat:(e,n)=>he.put(`/phong-ban/${e}`,n).then(a=>a.data),doiPhongBanCha:(e,n)=>he.put(`/phong-ban/${e}/doi-phong-ban-cha`,{phongBanChaId:n}).then(a=>a.data),ngungHoatDong:e=>he.post(`/phong-ban/${e}/ngung-hoat-dong`).then(n=>n.data),kichHoat:e=>he.post(`/phong-ban/${e}/kich-hoat`).then(n=>n.data),xoa:e=>he.delete(`/phong-ban/${e}`).then(n=>n.data),layDonViCon:e=>he.get(`/phong-ban/${e}/don-vi-con`).then(n=>n.data),taoDonViCon:(e,n)=>he.post(`/phong-ban/${e}/don-vi-con`,n).then(a=>a.data),capNhatDonViCon:(e,n)=>he.put(`/don-vi-con/${e}`,n).then(a=>a.data),ngungDonViCon:e=>he.post(`/don-vi-con/${e}/ngung-hoat-dong`).then(n=>n.data)},w0={THU_VIEC:{label:"Th vic",color:"bg-yellow-100 text-yellow-700"},CHINH_THUC:{label:"Chnh thc",color:"bg-green-100 text-green-700"},HOC_VIEC:{label:"Hc vic",color:"bg-blue-100 text-blue-700"},THUC_TAP:{label:"Thc tp",color:"bg-purple-100 text-purple-700"},CONG_TAC_VIEN:{label:"Cng tc vin",color:"bg-indigo-100 text-indigo-700"},THOI_VU:{label:"Thi v",color:"bg-orange-100 text-orange-700"}},ma={layTatCa:e=>he.get("/nhan-vien",{params:e}).then(n=>n.data),layTheoId:e=>he.get(`/nhan-vien/${e}`).then(n=>n.data),layMaTuDong:()=>he.get("/nhan-vien/ma-tu-dong").then(e=>e.data),taoMoi:e=>he.post("/nhan-vien",e).then(n=>n.data),capNhat:(e,n)=>he.put(`/nhan-vien/${e}`,n).then(a=>a.data),xoa:e=>he.delete(`/nhan-vien/${e}`).then(n=>n.data),layLichSuPhongBan:e=>he.get(`/nhan-vien/${e}/lich-su-phong-ban`).then(n=>n.data),chuyenPhongBan:(e,n)=>he.post(`/nhan-vien/${e}/chuyen-phong-ban`,n).then(a=>a.data)},pr={layTatCa:e=>he.get("/khoan-luong",{params:{loai:e}}).then(n=>n.data),layTheoId:e=>he.get(`/khoan-luong/${e}`).then(n=>n.data),taoMoi:e=>he.post("/khoan-luong",e).then(n=>n.data),capNhat:(e,n)=>he.put(`/khoan-luong/${e}`,n).then(a=>a.data),xoa:e=>he.delete(`/khoan-luong/${e}`).then(n=>n.data)},Db={layCauHinhBHXH:e=>he.get(`/bhxh-thue/cau-hinh-bhxh/${e}`).then(n=>n.data),luuCauHinhBHXH:e=>he.post("/bhxh-thue/cau-hinh-bhxh",e).then(n=>n.data),khoiTaoMacDinh:()=>he.post("/bhxh-thue/khoi-tao-mac-dinh").then(e=>e.data),layCauHinhThue:e=>he.get(`/bhxh-thue/cau-hinh-thue/${e}`).then(n=>n.data)},Or={layDanhSach:e=>he.get("/bang-luong",{params:e}).then(n=>n.data),layTheoId:e=>he.get(`/bang-luong/${e}`).then(n=>n.data),taoMoi:e=>he.post("/bang-luong",e).then(n=>n.data),capNhatChiTiet:e=>he.put("/bang-luong/chi-tiet/cap-nhat",e).then(n=>n.data),capNhatNhieuChiTiet:e=>he.put("/bang-luong/chi-tiet/cap-nhat-nhieu",{danhSach:e}).then(n=>n.data),chotBangLuong:(e,n)=>he.post(`/bang-luong/${e}/chot`,n).then(a=>a.data),moKhoa:e=>he.post(`/bang-luong/${e}/mo-khoa`).then(n=>n.data),khoa:e=>he.post(`/bang-luong/${e}/khoa`).then(n=>n.data),xoa:(e,n=!1)=>he.delete(`/bang-luong/${e}`,{params:{force:n?"true":void 0}}).then(a=>a.data),layLichSu:e=>he.get(`/bang-luong/${e}/lich-su`).then(n=>n.data),soSanhExcel:(e,n)=>he.post(`/bang-luong/${e}/so-sanh-excel`,{tongExcel:n}).then(a=>a.data),tinhLaiLuong:e=>he.post(`/bang-luong/${e}/tinh-lai-luong`).then(n=>n.data)},jp={layPhieuLuong:(e,n)=>he.get(`/bang-luong/${e}/phieu-luong/${n}`).then(a=>a.data),layPhieuLuongHtml:(e,n)=>he.get(`/bang-luong/${e}/phieu-luong/${n}/html`).then(a=>a.data),guiPhieuLuong:(e,n)=>he.post(`/bang-luong/${e}/gui-phieu-luong/${n}`).then(a=>a.data),guiTatCa:e=>he.post(`/bang-luong/${e}/gui-tat-ca`).then(n=>n.data)},m0={docHeader:e=>{const n=new FormData;return n.append("file",e),he.post("/import-excel/doc-header",n,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>a.data)},goiYMapping:e=>{const n=new FormData;return n.append("file",e),he.post("/import-excel/goi-y-mapping",n,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>a.data)},import:(e,n,a,r,s)=>{const l=new FormData;return l.append("file",e),l.append("thang",String(n)),l.append("nam",String(a)),l.append("phongBanId",String(r)),l.append("mappings",JSON.stringify(s)),he.post("/import-excel/import",l,{headers:{"Content-Type":"multipart/form-data"}}).then(o=>o.data)},export:(e,n)=>{const a=n?{columns:JSON.stringify(n)}:{};return he.get(`/import-excel/export/${e}`,{responseType:"blob",params:a})}},Xo={layTheoNhanVien:e=>he.get(`/phu-cap-nhan-vien/nhan-vien/${e}`).then(n=>n.data),layHieuLuc:e=>he.get(`/phu-cap-nhan-vien/nhan-vien/${e}/hieu-luc`).then(n=>n.data),layTheoThang:(e,n,a)=>he.get(`/phu-cap-nhan-vien/nhan-vien/${e}/theo-thang`,{params:{thang:n,nam:a}}).then(r=>r.data),layLichSu:(e,n)=>he.get(`/phu-cap-nhan-vien/nhan-vien/${e}/lich-su`,{params:{khoanLuongId:n}}).then(a=>a.data),taoPhuCap:e=>he.post("/phu-cap-nhan-vien",e).then(n=>n.data),ketThuc:(e,n,a)=>he.put(`/phu-cap-nhan-vien/${e}/ket-thuc`,{denNgay:n,nguoiCapNhat:a}).then(r=>r.data),tang:(e,n)=>he.post(`/phu-cap-nhan-vien/${e}/tang`,n).then(a=>a.data),tamDung:e=>he.put(`/phu-cap-nhan-vien/${e}/tam-dung`).then(n=>n.data),kichHoat:e=>he.put(`/phu-cap-nhan-vien/${e}/kich-hoat`).then(n=>n.data),thongKePhongBan:e=>he.get(`/phu-cap-nhan-vien/thong-ke/phong-ban/${e}`).then(n=>n.data)},GE={layTatCa:e=>he.get(`/bang-luong/${e}/ngay-cong`).then(n=>n.data),layTheoNhanVien:(e,n)=>he.get(`/bang-luong/${e}/ngay-cong/${n}`).then(a=>a.data),khoiTao:e=>he.post(`/bang-luong/${e}/ngay-cong/khoi-tao`).then(n=>n.data),dieuChinh:(e,n,a)=>he.put(`/bang-luong/${e}/ngay-cong/${n}/dieu-chinh`,a).then(r=>r.data),xoaDieuChinh:(e,n)=>he.delete(`/bang-luong/${e}/ngay-cong/${n}/dieu-chinh`).then(a=>a.data)},Ab={lay:()=>he.get("/thong-tin-cong-ty").then(e=>e.data),capNhat:e=>he.put("/thong-tin-cong-ty",e).then(n=>n.data)},kd={layTatCa:e=>he.get("/thong-tin-cong-ty/don-gia",{params:{phongBanId:e}}).then(n=>n.data),layTheoId:e=>he.get(`/thong-tin-cong-ty/don-gia/${e}`).then(n=>n.data),taoMoi:e=>he.post("/thong-tin-cong-ty/don-gia",e).then(n=>n.data),capNhat:(e,n)=>he.put(`/thong-tin-cong-ty/don-gia/${e}`,n).then(a=>a.data),xoa:e=>he.delete(`/thong-tin-cong-ty/don-gia/${e}`).then(n=>n.data),khoiTaoMau:()=>he.post("/thong-tin-cong-ty/don-gia/khoi-tao-mau").then(e=>e.data)},Xa={layDanhSach:e=>he.get("/ung-luong/bang",{params:e}).then(n=>n.data),layTheoId:e=>he.get(`/ung-luong/bang/${e}`).then(n=>n.data),taoMoi:e=>he.post("/ung-luong/bang",e).then(n=>n.data),capNhat:(e,n)=>he.put(`/ung-luong/bang/${e}`,n).then(a=>a.data),xoa:(e,n=!1)=>he.delete(`/ung-luong/bang/${e}`,{params:{force:n?"true":void 0}}).then(a=>a.data),sinhDanhSach:(e,n)=>he.post(`/ung-luong/bang/${e}/generate-danh-sach`,n||{}).then(a=>a.data),capNhatBulk:(e,n)=>he.put(`/ung-luong/bang/${e}/rows/bulk`,n).then(a=>a.data),setTheoTiLe:(e,n)=>he.post(`/ung-luong/bang/${e}/set-theo-ti-le`,n).then(a=>a.data),setSoTienCoDinh:(e,n)=>he.post(`/ung-luong/bang/${e}/set-so-tien-co-dinh`,n).then(a=>a.data),chot:e=>he.post(`/ung-luong/bang/${e}/chot`).then(n=>n.data),khoa:e=>he.post(`/ung-luong/bang/${e}/khoa`).then(n=>n.data),moKhoa:(e,n)=>he.post(`/ung-luong/bang/${e}/mo-khoa`,n).then(a=>a.data),ghiNhanKhauTru:(e,n)=>he.post(`/ung-luong/bang/${e}/ghi-nhan-khau-tru`,n).then(a=>a.data)},Wj={layNhanVien:(e,n)=>{const a=`${n.tuNam}-${String(n.tuThang).padStart(2,"0")}-01`,r=new Date(n.denNam,n.denThang,0).toISOString().split("T")[0];return he.get(`/so-luong/nhan-vien/${e}`,{params:{tuNgay:a,denNgay:r}}).then(s=>s.data)},layPhongBan:(e,n)=>{const a=`${n.tuNam}-${String(n.tuThang).padStart(2,"0")}-01`,r=new Date(n.denNam,n.denThang,0).toISOString().split("T")[0];return he.get(`/so-luong/phong-ban/${e}`,{params:{tuNgay:a,denNgay:r}}).then(s=>s.data)},timKiem:e=>he.get("/so-luong/tim-kiem",{params:e}).then(n=>n.data)};function Ze(e){if(e==null)return"0";const n=typeof e=="string"?parseFloat(e):e;return isNaN(n)?"0":new Intl.NumberFormat("vi-VN").format(n)}function qE(e){if(!e)return 0;const n=e.replace(/[^\d]/g,"");return parseInt(n,10)||0}function Js(e){return e?new Date(e).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):""}function WE(e){switch(e){case"NHAP":return"ang nhp";case"DA_CHOT":return" cht";case"KHOA":return" kha";default:return e}}function XE(e,n){const a=window.URL.createObjectURL(e),r=document.createElement("a");r.href=a,r.setAttribute("download",n),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(a)}function kt(...e){const n=[];for(const a of e)if(a){if(typeof a=="string")n.push(a);else if(typeof a=="number")n.push(String(a));else if(Array.isArray(a)){const r=kt(...a);r&&n.push(r)}}return n.join(" ").replace(/\s+/g," ").trim()}const st=D.forwardRef(({className:e,variant:n="default",padding:a="md",hover:r=!1,clickable:s=!1,children:l,...o},d)=>{const u="rounded-2xl transition-all duration-200",x={default:"bg-[var(--panel)] border border-[var(--border)]",glass:`
        bg-[var(--panel)]/80 backdrop-blur-xl 
        border border-white/10 
        shadow-lg shadow-black/5
      `,elevated:`
        bg-[var(--panel)] 
        border border-[var(--border)]
        shadow-xl shadow-black/10
      `,bordered:"bg-transparent border-2 border-[var(--border)]",gradient:`
        bg-gradient-to-br from-[var(--panel)] to-[var(--bg-2)]
        border border-[var(--border)]
      `},m={none:"",sm:"p-3",md:"p-5",lg:"p-6",xl:"p-8"},f=r?"hover:shadow-xl hover:border-[var(--accent)]/30 hover:-translate-y-0.5":"",p=s?"cursor-pointer active:scale-[0.99]":"";return t.jsx("div",{ref:d,className:kt(u,x[n],m[a],f,p,e),...o,children:l})});st.displayName="Card";const zn=D.forwardRef(({className:e,title:n,subtitle:a,action:r,icon:s,children:l,...o},d)=>t.jsxs("div",{ref:d,className:kt("flex items-start justify-between gap-4 mb-4",e),...o,children:[t.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[s&&t.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-xl bg-[var(--accent)]/10 flex items-center justify-center text-[var(--accent)]",children:s}),t.jsxs("div",{className:"flex-1 min-w-0",children:[n&&t.jsx("h3",{className:"text-lg font-semibold text-[var(--text-primary)] truncate",children:n}),a&&t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-0.5",children:a}),l]})]}),r&&t.jsx("div",{className:"flex-shrink-0",children:r})]}));zn.displayName="CardHeader";const Vt=D.forwardRef(({className:e,...n},a)=>t.jsx("div",{ref:a,className:kt("",e),...n}));Vt.displayName="CardContent";const QE=D.forwardRef(({className:e,separator:n=!0,...a},r)=>t.jsx("div",{ref:r,className:kt("flex items-center justify-between gap-4 mt-4 pt-4",n&&"border-t border-[var(--border)]",e),...a}));QE.displayName="CardFooter";const Xj=D.forwardRef(({className:e,title:n,value:a,subtitle:r,icon:s,trend:l,accentColor:o="green",...d},u)=>{const m={green:{bg:"bg-[#53F39A]/10",text:"text-[#53F39A]",glow:"shadow-[#53F39A]/20"},cyan:{bg:"bg-[#4FC3FF]/10",text:"text-[#4FC3FF]",glow:"shadow-[#4FC3FF]/20"},yellow:{bg:"bg-amber-500/10",text:"text-amber-400",glow:"shadow-amber-500/20"},red:{bg:"bg-[#FF4D6D]/10",text:"text-[#FF4D6D]",glow:"shadow-[#FF4D6D]/20"},purple:{bg:"bg-purple-500/10",text:"text-purple-400",glow:"shadow-purple-500/20"}}[o],f={up:"text-[#53F39A]",down:"text-[#FF4D6D]",neutral:"text-[var(--text-muted)]"},p={up:"",down:"",neutral:""};return t.jsxs(st,{ref:u,variant:"glass",className:kt("group hover:shadow-lg",m.glow,e),hover:!0,...d,children:[t.jsxs("div",{className:"flex items-start justify-between",children:[s&&t.jsx("div",{className:kt("w-12 h-12 rounded-xl flex items-center justify-center transition-transform group-hover:scale-110",m.bg,m.text),children:s}),l&&t.jsxs("div",{className:kt("flex items-center gap-1 text-sm font-medium",f[l.direction]),children:[t.jsx("span",{children:p[l.direction]}),t.jsxs("span",{children:[Math.abs(l.value),"%"]})]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("p",{className:"text-3xl font-bold text-[var(--text-primary)] tabular-nums",children:typeof a=="number"?a.toLocaleString("vi-VN"):a}),t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1",children:n}),r&&t.jsx("p",{className:"text-xs text-[var(--text-disabled)] mt-0.5",children:r})]})]})});Xj.displayName="StatCard";const ft=D.forwardRef(({className:e,variant:n="primary",size:a="md",rounded:r="xl",loading:s=!1,icon:l,iconPosition:o="left",fullWidth:d=!1,disabled:u,children:x,...m},f)=>{const p=u||s,N=`
      inline-flex items-center justify-center gap-2
      font-medium transition-all duration-200
      focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[var(--accent)]
      disabled:opacity-50 disabled:cursor-not-allowed
      active:scale-[0.98]
    `,y={primary:`
        bg-[var(--accent)] text-[#0B1220]
        hover:bg-[var(--accent)]/90
        shadow-lg shadow-[var(--accent)]/25
      `,secondary:`
        bg-[var(--bg-2)] text-[var(--text-primary)]
        border border-[var(--border)]
        hover:bg-[var(--bg-3)] hover:border-[var(--accent)]/30
      `,outline:`
        bg-transparent text-[var(--text-primary)]
        border-2 border-[var(--border)]
        hover:bg-[var(--bg-2)] hover:border-[var(--accent)]/50
      `,ghost:`
        bg-transparent text-[var(--text-secondary)]
        hover:bg-[var(--bg-2)] hover:text-[var(--text-primary)]
      `,danger:`
        bg-[#FF4D6D] text-white
        hover:bg-[#FF4D6D]/90
        shadow-lg shadow-[#FF4D6D]/25
      `,success:`
        bg-[#53F39A] text-[#0B1220]
        hover:bg-[#53F39A]/90
        shadow-lg shadow-[#53F39A]/25
      `},g={xs:"text-xs px-2.5 py-1.5 h-7",sm:"text-sm px-3 py-2 h-8",md:"text-sm px-4 py-2.5 h-10",lg:"text-base px-5 py-3 h-11",xl:"text-base px-6 py-3.5 h-12"},b={md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl",full:"rounded-full"};return t.jsxs("button",{ref:f,className:kt(N,y[n],g[a],b[r],d&&"w-full",e),disabled:p,...m,children:[s&&t.jsx(An,{className:"w-4 h-4 animate-spin"}),!s&&l&&o==="left"&&t.jsx("span",{className:"flex-shrink-0",children:l}),x&&t.jsx("span",{children:x}),!s&&l&&o==="right"&&t.jsx("span",{className:"flex-shrink-0",children:l})]})});ft.displayName="Button";const Qj=D.forwardRef(({className:e,variant:n="ghost",size:a="md",loading:r=!1,tooltip:s,disabled:l,children:o,...d},u)=>{const x=l||r,m=`
      inline-flex items-center justify-center
      rounded-xl transition-all duration-200
      focus:outline-none focus-visible:ring-2 focus-visible:ring-[var(--accent)]
      disabled:opacity-50 disabled:cursor-not-allowed
      active:scale-95
    `,f={primary:`
        bg-[var(--accent)] text-[#0B1220]
        hover:bg-[var(--accent)]/80
      `,secondary:`
        bg-[var(--bg-2)] text-[var(--text-secondary)]
        hover:bg-[var(--bg-3)] hover:text-[var(--text-primary)]
      `,ghost:`
        text-[var(--text-muted)]
        hover:bg-[var(--bg-2)] hover:text-[var(--text-primary)]
      `,danger:`
        text-[#FF4D6D]
        hover:bg-[#FF4D6D]/10
      `},p={xs:"w-6 h-6",sm:"w-8 h-8",md:"w-10 h-10",lg:"w-12 h-12"};return t.jsx("button",{ref:u,className:kt(m,f[n],p[a],e),disabled:x,title:s,...d,children:r?t.jsx(An,{className:"w-4 h-4 animate-spin"}):o})});Qj.displayName="IconButton";const _t=D.forwardRef(({className:e,variant:n="default",size:a="sm",dot:r=!1,icon:s,removable:l=!1,onRemove:o,children:d,...u},x)=>{const m=`
      inline-flex items-center gap-1.5
      font-medium rounded-full
      transition-colors duration-150
    `,f={default:"bg-[var(--accent)]/15 text-[var(--accent)]",success:"bg-[#53F39A]/15 text-[#53F39A]",warning:"bg-amber-500/15 text-amber-400",danger:"bg-[#FF4D6D]/15 text-[#FF4D6D]",info:"bg-[#4FC3FF]/15 text-[#4FC3FF]",neutral:"bg-[var(--bg-3)] text-[var(--text-muted)]"},p={xs:"text-[10px] px-1.5 py-0.5",sm:"text-xs px-2 py-0.5",md:"text-sm px-2.5 py-1"},N={default:"bg-[var(--accent)]",success:"bg-[#53F39A]",warning:"bg-amber-400",danger:"bg-[#FF4D6D]",info:"bg-[#4FC3FF]",neutral:"bg-[var(--text-muted)]"};return t.jsxs("span",{ref:x,className:kt(m,f[n],p[a],e),...u,children:[r&&t.jsx("span",{className:kt("w-1.5 h-1.5 rounded-full animate-pulse",N[n])}),s&&t.jsx("span",{className:"flex-shrink-0 w-3 h-3",children:s}),d,l&&t.jsx("button",{type:"button",onClick:y=>{y.stopPropagation(),o==null||o()},className:"ml-0.5 -mr-0.5 p-0.5 rounded-full hover:bg-white/20 transition-colors",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-3 h-3",children:t.jsx("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})})})]})});_t.displayName="Badge";const YE={active:{label:"Hot ng",variant:"success"},inactive:{label:"Ngng",variant:"neutral"},pending:{label:"Ch duyt",variant:"warning"},approved:{label:" duyt",variant:"success"},rejected:{label:"T chi",variant:"danger"},draft:{label:"Nhp",variant:"neutral"},completed:{label:"Hon thnh",variant:"info"}},JE=D.forwardRef(({status:e,className:n,...a},r)=>{const s=YE[e];return t.jsx(_t,{ref:r,variant:s.variant,dot:!0,className:n,...a,children:s.label})});JE.displayName="StatusBadge";const ZE=D.forwardRef(({count:e,max:n=99,variant:a="danger",className:r,...s},l)=>{const o=e>n?`${n}+`:e,d=`
      inline-flex items-center justify-center
      min-w-[18px] h-[18px] px-1.5
      text-[10px] font-bold rounded-full
    `,u={default:"bg-[var(--accent)] text-[#0B1220]",danger:"bg-[#FF4D6D] text-white"};return e<=0?null:t.jsx("span",{ref:l,className:kt(d,u[a],r),...s,children:o})});ZE.displayName="CounterBadge";const hg=D.forwardRef(({className:e,type:n="text",size:a="md",variant:r="default",error:s=!1,success:l=!1,icon:o,iconPosition:d="left",clearable:u=!1,onClear:x,value:m,...f},p)=>{const N=`
      w-full transition-all duration-200
      placeholder:text-[var(--text-disabled)]
      focus:outline-none
      disabled:opacity-50 disabled:cursor-not-allowed
    `,y={default:`
        bg-[var(--bg-1)] 
        border border-[var(--border)]
        focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
      `,filled:`
        bg-[var(--bg-2)] 
        border border-transparent
        focus:bg-[var(--bg-1)] focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
      `,ghost:`
        bg-transparent 
        border border-transparent
        hover:bg-[var(--bg-2)]
        focus:bg-[var(--bg-2)] focus:border-[var(--border)]
      `},g={sm:"h-8 px-3 text-sm rounded-lg",md:"h-10 px-4 text-sm rounded-xl",lg:"h-12 px-4 text-base rounded-xl"},b=s?"border-[#FF4D6D] focus:border-[#FF4D6D] focus:ring-[#FF4D6D]/20":l?"border-[#53F39A] focus:border-[#53F39A] focus:ring-[#53F39A]/20":"",j=!!o,T=u&&m,_=j&&d==="left"?"pl-10":"",w=j&&d==="right"||T?"pr-10":"";return t.jsxs("div",{className:"relative",children:[o&&d==="left"&&t.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)]",children:o}),t.jsx("input",{ref:p,type:n,value:m,className:kt(N,y[r],g[a],b,_,w,"text-[var(--text-primary)]",e),...f}),o&&d==="right"&&!T&&t.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)]",children:o}),T&&t.jsx("button",{type:"button",onClick:x,className:"absolute right-3 top-1/2 -translate-y-1/2 p-0.5 rounded-full text-[var(--text-muted)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-3)] transition-colors",children:t.jsx(rn,{size:14})})]})});hg.displayName="Input";const xg=D.forwardRef(({className:e,onSearch:n,...a},r)=>t.jsx(hg,{ref:r,type:"search",icon:t.jsx(Vr,{size:18}),iconPosition:"left",clearable:!0,placeholder:"Tm kim...",className:e,...a}));xg.displayName="SearchInput";const e6=D.forwardRef(({className:e,...n},a)=>{const[r,s]=D.useState(!1);return t.jsxs("div",{className:"relative",children:[t.jsx(hg,{ref:a,type:r?"text":"password",className:kt("pr-10",e),...n}),t.jsx("button",{type:"button",onClick:()=>s(!r),className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 rounded-lg text-[var(--text-muted)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-3)] transition-colors",children:r?t.jsx(tg,{size:18}):t.jsx(Ba,{size:18})})]})});e6.displayName="PasswordInput";const ix=D.forwardRef(({className:e,variant:n="default",error:a,success:r,...s},l)=>{const o=`
      w-full min-h-[100px] px-4 py-3
      text-sm text-[var(--text-primary)]
      rounded-xl resize-y
      transition-all duration-200
      placeholder:text-[var(--text-disabled)]
      focus:outline-none
      disabled:opacity-50 disabled:cursor-not-allowed
    `,d={default:`
        bg-[var(--bg-1)] 
        border border-[var(--border)]
        focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
      `,filled:`
        bg-[var(--bg-2)] 
        border border-transparent
        focus:bg-[var(--bg-1)] focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
      `},u=a?"border-[#FF4D6D] focus:border-[#FF4D6D] focus:ring-[#FF4D6D]/20":r?"border-[#53F39A] focus:border-[#53F39A] focus:ring-[#53F39A]/20":"";return t.jsx("textarea",{ref:l,className:kt(o,d[n],u,e),...s})});ix.displayName="Textarea";const t6=D.forwardRef(({className:e,loading:n,empty:a,emptyMessage:r="Khng c d liu",emptyIcon:s,children:l,...o},d)=>t.jsxs("div",{ref:d,className:kt("relative overflow-hidden rounded-2xl","bg-[var(--panel)] border border-[var(--border)]",e),...o,children:[n&&t.jsx("div",{className:"absolute inset-0 bg-[var(--panel)]/80 backdrop-blur-sm z-10 flex items-center justify-center",children:t.jsxs("div",{className:"flex flex-col items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 border-2 border-[var(--accent)] border-t-transparent rounded-full animate-spin"}),t.jsx("span",{className:"text-sm text-[var(--text-muted)]",children:"ang ti..."})]})}),a?t.jsxs("div",{className:"py-16 flex flex-col items-center justify-center text-center",children:[s&&t.jsx("div",{className:"w-16 h-16 rounded-2xl bg-[var(--bg-2)] flex items-center justify-center text-[var(--text-muted)] mb-4",children:s}),t.jsx("p",{className:"text-[var(--text-muted)]",children:r})]}):t.jsx("div",{className:"overflow-x-auto",children:l})]}));t6.displayName="TableContainer";const Yj=D.forwardRef(({className:e,compact:n,striped:a,hoverable:r=!0,...s},l)=>t.jsx("table",{ref:l,className:kt("w-full text-sm",n?"table-compact":"",a?"table-striped":"",r?"table-hoverable":"",e),...s}));Yj.displayName="Table";const Jj=D.forwardRef(({className:e,...n},a)=>t.jsx("thead",{ref:a,className:kt("bg-[var(--bg-2)] border-b border-[var(--border)]",e),...n}));Jj.displayName="TableHead";const Zj=D.forwardRef(({className:e,...n},a)=>t.jsx("tbody",{ref:a,className:kt("divide-y divide-[var(--border)]",e),...n}));Zj.displayName="TableBody";const Fd=D.forwardRef(({className:e,selected:n,clickable:a,...r},s)=>t.jsx("tr",{ref:s,className:kt("transition-colors","hover:bg-[var(--bg-2)]",n&&"bg-[var(--accent)]/5",a&&"cursor-pointer",e),...r}));Fd.displayName="TableRow";const Il=D.forwardRef(({className:e,children:n,sortable:a,sortDirection:r,onSort:s,align:l="left",...o},d)=>{const u={left:"text-left",center:"text-center",right:"text-right"};return t.jsx("th",{ref:d,className:kt("px-4 py-3 font-semibold text-xs uppercase tracking-wider","text-[var(--text-muted)]",u[l],a&&"cursor-pointer select-none hover:text-[var(--text-primary)] group",e),onClick:a?s:void 0,...o,children:t.jsxs("div",{className:kt("inline-flex items-center gap-1.5",l==="right"&&"flex-row-reverse",l==="center"&&"justify-center"),children:[n,a&&t.jsx("span",{className:kt("transition-colors",r?"text-[var(--accent)]":"text-[var(--text-disabled)] group-hover:text-[var(--text-muted)]"),children:r==="asc"?t.jsx(Ol,{size:14}):r==="desc"?t.jsx(Ja,{size:14}):t.jsx(k_,{size:14})})]})})});Il.displayName="TableHeadCell";const Gs=D.forwardRef(({className:e,align:n="left",numeric:a,truncate:r,maxWidth:s,style:l,...o},d)=>{const u={left:"text-left",center:"text-center",right:"text-right"};return t.jsx("td",{ref:d,className:kt("px-4 py-3","text-[var(--text-primary)]",u[n],a&&"tabular-nums font-medium",r&&"truncate",e),style:{maxWidth:s?`${s}px`:void 0,...l},...o})});Gs.displayName="TableCell";const n6=D.forwardRef(({className:e,...n},a)=>t.jsx("tfoot",{ref:a,className:kt("bg-[var(--bg-2)] border-t border-[var(--border)]",e),...n}));n6.displayName="TableFooter";const as=({isOpen:e,onClose:n,children:a,size:r="md",closable:s=!0,closeOnOverlay:l=!0,closeOnEscape:o=!0,className:d})=>{if(D.useEffect(()=>{if(!e||!o)return;const m=f=>{f.key==="Escape"&&n()};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[e,o,n]),D.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),!e)return null;const u={sm:"max-w-sm",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-[90vw]"},x=t.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4",children:[t.jsx("div",{className:kt("absolute inset-0 bg-black/50","animate-in fade-in duration-200"),onClick:l?n:void 0}),t.jsxs("div",{className:kt("relative w-full",u[r],"bg-white","border border-[var(--border)]","rounded-2xl shadow-2xl shadow-black/40","animate-in fade-in zoom-in-95 duration-200",d),onClick:m=>m.stopPropagation(),children:[s&&t.jsx(Qj,{variant:"ghost",size:"sm",onClick:n,className:"absolute top-4 right-4 z-10",children:t.jsx(rn,{size:18})}),a]})]});return vS.createPortal(x,document.body)},Cs=({title:e,subtitle:n,icon:a,className:r})=>t.jsx("div",{className:kt("px-6 pt-6 pb-4",r),children:t.jsxs("div",{className:"flex items-start gap-4",children:[a&&t.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-xl bg-[var(--accent)]/10 flex items-center justify-center text-[var(--accent)]",children:a}),t.jsxs("div",{className:"flex-1 min-w-0 pr-8",children:[t.jsx("h2",{className:"text-xl font-semibold text-[var(--text-primary)]",children:e}),n&&t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1",children:n})]})]})}),Ss=({children:e,className:n,padding:a=!0})=>t.jsx("div",{className:kt("max-h-[60vh] overflow-y-auto modal-scroll",a&&"px-6 py-4",n),children:e}),ni=({children:e,className:n})=>t.jsx("div",{className:kt("flex items-center justify-end gap-3","px-6 py-4","border-t border-[var(--border)]","bg-[var(--bg-2)]/50",n),children:e});function a6(){const e=new Date,[n,a]=D.useState(e.getMonth()+1),[r,s]=D.useState(e.getFullYear()),{data:l}=Fe({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),{data:o}=Fe({queryKey:["nhan-vien"],queryFn:()=>ma.layTatCa()}),{data:d}=Fe({queryKey:["khoan-luong"],queryFn:()=>pr.layTatCa()}),{data:u}=Fe({queryKey:["bang-luong"],queryFn:()=>Or.layDanhSach()}),x=(Array.isArray(o)?o:(o==null?void 0:o.data)||[]).filter(g=>g&&g.id),m=(Array.isArray(u)?u:(u==null?void 0:u.data)||[]).filter(g=>g&&g.id),f=D.useMemo(()=>{const g=new Set;return m.forEach(b=>{b.nam&&g.add(b.nam)}),g.add(e.getFullYear()),Array.from(g).sort((b,j)=>j-b)},[m]),p=D.useMemo(()=>m.filter(g=>g.thang===n&&g.nam===r).reduce((g,b)=>g+((b==null?void 0:b.thucLinh)||0),0)||0,[m,n,r]),N=[{label:"Phng ban",value:(l==null?void 0:l.length)||0,icon:Mr,color:"cyan",link:"/nhan-vien"},{label:"Nhn vin",value:(x==null?void 0:x.length)||0,icon:cn,color:"green",link:"/nhan-vien"},{label:"Khon lng",value:(d==null?void 0:d.length)||0,icon:gr,color:"purple",link:"/khoan-luong"},{label:"Bng lng",value:(m==null?void 0:m.length)||0,icon:ei,color:"yellow",link:"/bang-luong"}],y=g=>{switch(g){case"NHAP":return t.jsx(_t,{variant:"neutral",dot:!0,children:"ang nhp"});case"DA_CHOT":return t.jsx(_t,{variant:"success",dot:!0,children:" cht"});case"KHOA":return t.jsx(_t,{variant:"info",dot:!0,children:" kha"});default:return t.jsx(_t,{variant:"neutral",children:g})}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-[var(--text-primary)] flex items-center gap-2",children:[t.jsx(q_,{size:24,className:"text-[var(--accent)]"}),"Tng quan H thng"]}),t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1",children:"Cho mng tr li! y l tng quan hot ng ca bn."})]}),t.jsxs(xa,{to:"/bang-luong",className:`
            inline-flex items-center gap-2 px-4 py-2.5 
            bg-[var(--accent)] text-[#0B1220] font-medium
            rounded-xl hover:bg-[var(--accent)]/90 
            shadow-lg shadow-[var(--accent)]/25
            transition-all duration-200
          `,children:[t.jsx(ei,{size:18}),"To bng lng",t.jsx(y_,{size:16})]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:N.map(g=>{const b=g.icon;return t.jsx(xa,{to:g.link,children:t.jsx(Xj,{title:g.label,value:g.value,icon:t.jsx(b,{size:24}),accentColor:g.color})},g.label)})}),t.jsxs(st,{variant:"glass",className:`
          relative overflow-hidden
          bg-gradient-to-br from-[#53F39A]/5 via-[var(--panel)] to-[#4FC3FF]/5
          border border-[var(--accent)]/20
        `,children:[t.jsx("div",{className:"absolute -top-20 -right-20 w-60 h-60 bg-[var(--accent)]/10 rounded-full blur-3xl"}),t.jsx("div",{className:"absolute -bottom-20 -left-20 w-40 h-40 bg-[#4FC3FF]/10 rounded-full blur-3xl"}),t.jsxs("div",{className:"relative flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-6",children:[t.jsx("div",{className:`
              p-5 rounded-2xl
              bg-gradient-to-br from-[#53F39A] to-[#4FC3FF]
              shadow-lg shadow-[#53F39A]/30
            `,children:t.jsx(oi,{size:32,className:"text-[#0B1220]"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-[var(--text-muted)] uppercase tracking-wider font-medium",children:"Tng qu lng"}),t.jsxs("p",{className:"text-4xl font-bold text-[var(--text-primary)] mt-1 tabular-nums",children:[Ze(p),t.jsx("span",{className:"text-lg text-[var(--text-muted)] ml-2 font-normal",children:"VN"})]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"relative",children:[t.jsx("select",{value:n,onChange:g=>a(Number(g.target.value)),className:`
                  appearance-none pl-4 pr-10 py-2.5
                  bg-[var(--bg-2)] border border-[var(--border)]
                  rounded-xl text-[var(--text-primary)]
                  text-sm font-medium cursor-pointer
                  hover:border-[var(--accent)]/50
                  focus:outline-none focus:ring-2 focus:ring-[var(--accent)]/30
                  transition-all
                `,children:Array.from({length:12},(g,b)=>b+1).map(g=>t.jsxs("option",{value:g,children:["Thng ",g]},g))}),t.jsx(Ja,{size:16,className:"absolute right-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)] pointer-events-none"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("select",{value:r,onChange:g=>s(Number(g.target.value)),className:`
                  appearance-none pl-4 pr-10 py-2.5
                  bg-[var(--bg-2)] border border-[var(--border)]
                  rounded-xl text-[var(--text-primary)]
                  text-sm font-medium cursor-pointer
                  hover:border-[var(--accent)]/50
                  focus:outline-none focus:ring-2 focus:ring-[var(--accent)]/30
                  transition-all
                `,children:f.map(g=>t.jsx("option",{value:g,children:g},g))}),t.jsx(Ja,{size:16,className:"absolute right-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)] pointer-events-none"})]})]})]})]}),t.jsxs(st,{variant:"glass",padding:"none",children:[t.jsx(zn,{title:t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(At,{size:20,className:"text-[var(--accent)]"}),"Bng lng gn y"]}),action:t.jsxs(xa,{to:"/bang-luong",className:`
                flex items-center gap-1 text-sm text-[var(--text-muted)]
                hover:text-[var(--accent)] transition-colors
              `,children:["Xem tt c",t.jsx(qn,{size:16})]}),className:"px-5 pt-5"}),m&&m.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-[var(--border)]",children:[t.jsx("th",{className:"text-left py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Thng/Nm"}),t.jsx("th",{className:"text-left py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Phng ban"}),t.jsx("th",{className:"text-right py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"S NV"}),t.jsx("th",{className:"text-right py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Thc lnh"}),t.jsx("th",{className:"text-center py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Trng thi"})]})}),t.jsx("tbody",{className:"divide-y divide-[var(--border)]",children:m.slice(0,5).map(g=>{var b;return t.jsxs("tr",{className:"hover:bg-[var(--bg-2)] transition-colors group",children:[t.jsx("td",{className:"py-4 px-5",children:t.jsxs(xa,{to:`/bang-luong/${g.id}`,className:`
                          font-medium text-[var(--text-primary)]
                          group-hover:text-[var(--accent)] transition-colors
                        `,children:["Thng ",g.thang,"/",g.nam]})}),t.jsx("td",{className:"py-4 px-5 text-[var(--text-secondary)]",children:((b=g.phongBan)==null?void 0:b.tenPhongBan)||"Tt c phng ban"}),t.jsx("td",{className:"py-4 px-5 text-right text-[var(--text-secondary)] tabular-nums",children:g.soNhanVien||0}),t.jsx("td",{className:"py-4 px-5 text-right font-semibold text-[var(--accent)] tabular-nums",children:Ze(g.thucLinh)}),t.jsx("td",{className:"py-4 px-5 text-center",children:y(g.trangThai)})]},g.id)})})]})}):t.jsxs("div",{className:"text-center py-12 px-5",children:[t.jsx("div",{className:`
              w-16 h-16 mx-auto mb-4 rounded-2xl
              bg-[var(--bg-2)] flex items-center justify-center
              text-[var(--text-muted)]
            `,children:t.jsx(ei,{size:28})}),t.jsxs("p",{className:"text-[var(--text-muted)]",children:["Cha c bng lng no."," ",t.jsx(xa,{to:"/bang-luong",className:"text-[var(--accent)] hover:underline",children:"To bng lng mi"})]})]})]})]})}function r6(){const{coVaiTro:e}=ls(),n=e("ADMIN"),a=Mt(),[r,s]=D.useState(!1),[l,o]=D.useState(new Date().getFullYear()),[d,u]=D.useState(new Date().getMonth()+1),[x,m]=D.useState(),[f,p]=D.useState({thang:new Date().getMonth()+1,nam:new Date().getFullYear(),phongBanIds:[],tenBangLuong:""}),{data:N,isLoading:y}=Fe({queryKey:["bang-luong",l,d,x],queryFn:()=>Or.layDanhSach({nam:l,thang:d,phongBanId:x})}),g=(Array.isArray(N)?N:(N==null?void 0:N.data)||[]).filter(C=>C&&C.id),{data:b}=Fe({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),j=Ee({mutationFn:async C=>{const S=await Promise.allSettled(C.phongBanIds.map(B=>Or.taoMoi({thang:C.thang,nam:C.nam,phongBanId:B,tenBangLuong:C.phongBanIds.length>1?"":C.tenBangLuong}))),P=S.filter(B=>B.status==="fulfilled"),F=S.filter(B=>B.status==="rejected");return{successful:P,failed:F,total:S.length}},onSuccess:({successful:C,failed:S,total:P})=>{var F,B,O;if(a.invalidateQueries({queryKey:["bang-luong"]}),C.length>0&&S.length===0)ie.success(`To ${C.length} bng lng thnh cng!`);else if(C.length>0&&S.length>0)ie.success(`To ${C.length}/${P} bng lng thnh cng!`),ie.error(`${S.length} bng lng to tht bi`);else if(S.length>0){const G=((O=(B=(F=S[0].reason)==null?void 0:F.response)==null?void 0:B.data)==null?void 0:O.message)||"C li xy ra";ie.error(G)}C.length>0&&(s(!1),p({thang:new Date().getMonth()+1,nam:new Date().getFullYear(),phongBanIds:[],tenBangLuong:""}))},onError:C=>{var S,P;ie.error(((P=(S=C.response)==null?void 0:S.data)==null?void 0:P.message)||"C li xy ra")}}),T=Ee({mutationFn:({id:C,force:S})=>Or.xoa(C,S),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-luong"]}),ie.success("Xa bng lng thnh cng!")},onError:C=>{var S,P;ie.error(((P=(S=C.response)==null?void 0:S.data)==null?void 0:P.message)||"C li xy ra")}}),_=()=>{if(f.phongBanIds.length===0){ie.error("Vui lng chn t nht mt phng ban");return}j.mutate(f)},w=(C,S,P=!1)=>{if(!P&&S!=="NHAP"){ie.error("Ch c th xa bng lng ang  trng thi Nhp. ADMIN c th xa bng  kha.");return}confirm(P?" BN ANG XA BNG LNG  KHA! Hnh ng ny khng th hon tc. Bn c chc chn?":"Bn c chc mun xa bng lng ny?")&&T.mutate({id:C,force:P})},E=C=>{switch(C){case"NHAP":return t.jsx(_t,{variant:"neutral",dot:!0,children:"ang nhp"});case"DA_CHOT":return t.jsx(_t,{variant:"success",dot:!0,children:" cht"});case"KHOA":return t.jsx(_t,{variant:"info",dot:!0,children:" kha"});default:return t.jsx(_t,{variant:"neutral",children:WE(C)})}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-[var(--text-primary)] flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--accent)]/10 flex items-center justify-center",children:t.jsx(ei,{size:22,className:"text-[var(--accent)]"})}),"Qun l Bng lng"]}),t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1 ml-13",children:"To v qun l bng lng hng thng"})]}),t.jsx(ft,{onClick:()=>s(!0),icon:t.jsx(Dt,{size:18}),children:"To bng lng mi"})]}),t.jsx(st,{variant:"glass",padding:"md",children:t.jsxs("div",{className:"flex gap-4 items-end flex-wrap",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-[var(--text-muted)] mb-1.5 uppercase tracking-wider",children:"Nm"}),t.jsx("select",{value:l,onChange:C=>o(Number(C.target.value)),className:`
                h-10 px-4 rounded-xl
                bg-[var(--bg-1)] border border-[var(--border)]
                text-[var(--text-primary)]
                focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                transition-all
              `,children:[2024,2025,2026,2027].map(C=>t.jsx("option",{value:C,children:C},C))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-[var(--text-muted)] mb-1.5 uppercase tracking-wider",children:"Thng"}),t.jsxs("select",{value:d||"",onChange:C=>u(C.target.value?Number(C.target.value):void 0),className:`
                h-10 px-4 rounded-xl
                bg-[var(--bg-1)] border border-[var(--border)]
                text-[var(--text-primary)]
                focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                transition-all
              `,children:[t.jsx("option",{value:"",children:"Tt c"}),Array.from({length:12},(C,S)=>S+1).map(C=>t.jsxs("option",{value:C,children:["Thng ",C]},C))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-[var(--text-muted)] mb-1.5 uppercase tracking-wider",children:"Phng ban"}),t.jsxs("select",{value:x||"",onChange:C=>m(C.target.value?Number(C.target.value):void 0),className:`
                h-10 px-4 rounded-xl min-w-[200px]
                bg-[var(--bg-1)] border border-[var(--border)]
                text-[var(--text-primary)]
                focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                transition-all
              `,children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),b==null?void 0:b.map(C=>t.jsx("option",{value:C.id,children:C.tenPhongBan},C.id))]})]})]})}),t.jsx(st,{variant:"glass",padding:"none",children:y?t.jsx("div",{className:"flex items-center justify-center py-16",children:t.jsx("div",{className:"w-8 h-8 border-2 border-[var(--accent)] border-t-transparent rounded-full animate-spin"})}):g&&g.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-[var(--border)] bg-[var(--bg-2)]",children:[t.jsx("th",{className:"text-left py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Tn bng lng"}),t.jsx("th",{className:"text-center py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"K lng"}),t.jsx("th",{className:"text-left py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Phng ban"}),t.jsx("th",{className:"text-right py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"S NV"}),t.jsx("th",{className:"text-right py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Tng thu nhp"}),t.jsx("th",{className:"text-right py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Thc lnh"}),t.jsx("th",{className:"text-center py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Trng thi"}),t.jsx("th",{className:"text-center py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-[var(--border)]",children:g.map(C=>{var S;return t.jsxs("tr",{className:"hover:bg-[var(--bg-2)] transition-colors group",children:[t.jsx("td",{className:"py-4 px-5",children:t.jsx(xa,{to:`/bang-luong/${C.id}`,className:"font-medium text-[var(--text-primary)] group-hover:text-[var(--accent)] transition-colors",children:C.tenBangLuong||`Bng lng T${C.thang}/${C.nam}`})}),t.jsx("td",{className:"py-4 px-5 text-center",children:t.jsxs("span",{className:"inline-flex items-center gap-1.5 text-[var(--text-secondary)]",children:[t.jsx(At,{size:14,className:"text-[var(--text-muted)]"}),"T",C.thang,"/",C.nam]})}),t.jsx("td",{className:"py-4 px-5 text-[var(--text-secondary)]",children:((S=C.phongBan)==null?void 0:S.tenPhongBan)||""}),t.jsx("td",{className:"py-4 px-5 text-right text-[var(--text-secondary)] tabular-nums",children:C.soNhanVien||0}),t.jsx("td",{className:"py-4 px-5 text-right text-[var(--text-secondary)] tabular-nums",children:Ze(C.tongThuNhap)}),t.jsx("td",{className:"py-4 px-5 text-right font-semibold text-[var(--accent)] tabular-nums",children:Ze(C.thucLinh)}),t.jsx("td",{className:"py-4 px-5 text-center",children:E(C.trangThai)}),t.jsx("td",{className:"py-4 px-5",children:t.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t.jsx(xa,{to:`/bang-luong/${C.id}`,className:"p-2 text-[var(--text-muted)] hover:text-[var(--accent)] hover:bg-[var(--accent)]/10 rounded-lg transition-colors",title:"Xem chi tit",children:t.jsx(Ba,{size:18})}),C.trangThai==="NHAP"&&t.jsx("button",{onClick:()=>w(C.id,C.trangThai),className:"p-2 text-[var(--text-muted)] hover:text-[#FF4D6D] hover:bg-[#FF4D6D]/10 rounded-lg transition-colors",title:"Xa",children:t.jsx(er,{size:18})}),C.trangThai==="DA_CHOT"&&t.jsx("span",{className:"p-2 text-[var(--text-disabled)]",title:" cht",children:t.jsx(ti,{size:18})}),C.trangThai==="KHOA"&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"p-2 text-[var(--text-disabled)]",title:" kha",children:t.jsx(ti,{size:18})}),n&&t.jsx("button",{onClick:()=>w(C.id,C.trangThai,!0),className:"p-2 text-[#FF4D6D] hover:text-white hover:bg-[#FF4D6D] rounded-lg transition-colors",title:"ADMIN: Xa bng  kha",children:t.jsx(sa,{size:18})})]})]})})]},C.id)})})]})}):t.jsxs("div",{className:"text-center py-16",children:[t.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl bg-[var(--bg-2)] flex items-center justify-center text-[var(--text-muted)]",children:t.jsx(ei,{size:28})}),t.jsx("p",{className:"text-[var(--text-muted)]",children:"Cha c bng lng no"}),t.jsxs(ft,{onClick:()=>s(!0),variant:"secondary",size:"sm",className:"mt-4",children:[t.jsx(Dt,{size:16}),"To bng lng u tin"]})]})}),t.jsxs(as,{isOpen:r,onClose:()=>s(!1),size:"md",children:[t.jsx(Cs,{title:"To bng lng mi",subtitle:"Chn k lng v phng ban  to bng lng",icon:t.jsx(ei,{size:24})}),t.jsx(Ss,{children:t.jsxs("div",{className:"space-y-5",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-1.5",children:"Thng"}),t.jsx("select",{value:f.thang,onChange:C=>p({...f,thang:Number(C.target.value)}),className:`
                    w-full h-10 px-4 rounded-xl
                    bg-[var(--bg-1)] border border-[var(--border)]
                    text-[var(--text-primary)]
                    focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                  `,children:Array.from({length:12},(C,S)=>S+1).map(C=>t.jsxs("option",{value:C,children:["Thng ",C]},C))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-1.5",children:"Nm"}),t.jsx("select",{value:f.nam,onChange:C=>p({...f,nam:Number(C.target.value)}),className:`
                    w-full h-10 px-4 rounded-xl
                    bg-[var(--bg-1)] border border-[var(--border)]
                    text-[var(--text-primary)]
                    focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                  `,children:[2024,2025,2026,2027].map(C=>t.jsx("option",{value:C,children:C},C))})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-1.5",children:["Phng ban ",t.jsx("span",{className:"text-[#FF4D6D]",children:"*"}),t.jsx("span",{className:"text-[var(--text-muted)] font-normal ml-1",children:"(chn nhiu)"})]}),t.jsxs("div",{className:"border border-[var(--border)] rounded-xl max-h-48 overflow-y-auto bg-[var(--bg-1)] modal-scroll",children:[t.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-[var(--accent-light)] cursor-pointer border-b border-[var(--border)] transition-colors",children:[t.jsx("input",{type:"checkbox",checked:b&&f.phongBanIds.length===b.length,onChange:C=>{C.target.checked?p({...f,phongBanIds:(b==null?void 0:b.map(S=>S.id))||[]}):p({...f,phongBanIds:[]})},className:"flex-shrink-0"}),t.jsxs("span",{className:"font-medium text-[var(--accent)]",children:["Chn tt c (",(b==null?void 0:b.length)||0," phng ban)"]})]}),b==null?void 0:b.map(C=>t.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-[var(--accent-light)] cursor-pointer transition-colors",children:[t.jsx("input",{type:"checkbox",checked:f.phongBanIds.includes(C.id),onChange:S=>{S.target.checked?p({...f,phongBanIds:[...f.phongBanIds,C.id]}):p({...f,phongBanIds:f.phongBanIds.filter(P=>P!==C.id)})},className:"flex-shrink-0"}),t.jsx("span",{className:"text-[var(--text-primary)] flex-1",children:C.tenPhongBan}),f.phongBanIds.includes(C.id)&&t.jsx(Br,{className:"w-4 h-4 text-[var(--accent)] flex-shrink-0"})]},C.id))]}),f.phongBanIds.length>0&&t.jsxs("p",{className:"text-xs text-[var(--accent)] mt-1.5 font-medium",children:["  chn: ",f.phongBanIds.length," phng ban"]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-1.5",children:["Tn bng lng",t.jsx("span",{className:"text-[var(--text-muted)] font-normal ml-1",children:"(tu chn)"})]}),t.jsx("input",{type:"text",value:f.tenBangLuong,onChange:C=>p({...f,tenBangLuong:C.target.value}),className:`
                  w-full h-10 px-4 rounded-xl
                  bg-[var(--bg-1)] border border-[var(--border)]
                  text-[var(--text-primary)] placeholder:text-[var(--text-disabled)]
                  focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                `,placeholder:"T ng to nu  trng"})]})]})}),t.jsxs(ni,{children:[t.jsx(ft,{variant:"secondary",onClick:()=>s(!1),children:"Hu"}),t.jsx(ft,{onClick:_,loading:j.isPending,icon:t.jsx(Dt,{size:16}),children:"To bng lng"})]})]})]})}function s6(e,n){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const a=document.implementation.createHTMLDocument(),r=a.createElement("base"),s=a.createElement("a");return a.head.appendChild(r),a.body.appendChild(s),n&&(r.href=n),s.href=e,s.href}const i6=(()=>{let e=0;const n=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${n()}${e}`)})();function sl(e){const n=[];for(let a=0,r=e.length;a<r;a++)n.push(e[a]);return n}let Qo=null;function ew(e={}){return Qo||(e.includeStyleProperties?(Qo=e.includeStyleProperties,Qo):(Qo=sl(window.getComputedStyle(document.documentElement)),Qo))}function k0(e,n){const r=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(n);return r?parseFloat(r.replace("px","")):0}function l6(e){const n=k0(e,"border-left-width"),a=k0(e,"border-right-width");return e.clientWidth+n+a}function o6(e){const n=k0(e,"border-top-width"),a=k0(e,"border-bottom-width");return e.clientHeight+n+a}function tw(e,n={}){const a=n.width||l6(e),r=n.height||o6(e);return{width:a,height:r}}function c6(){let e,n;try{n=process}catch{}const a=n&&n.env?n.env.devicePixelRatio:null;return a&&(e=parseInt(a,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const dr=16384;function d6(e){(e.width>dr||e.height>dr)&&(e.width>dr&&e.height>dr?e.width>e.height?(e.height*=dr/e.width,e.width=dr):(e.width*=dr/e.height,e.height=dr):e.width>dr?(e.height*=dr/e.width,e.width=dr):(e.width*=dr/e.height,e.height=dr))}function T0(e){return new Promise((n,a)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>n(r))})},r.onerror=a,r.crossOrigin="anonymous",r.decoding="async",r.src=e})}async function u6(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(n=>`data:image/svg+xml;charset=utf-8,${n}`)}async function h6(e,n,a){const r="http://www.w3.org/2000/svg",s=document.createElementNS(r,"svg"),l=document.createElementNS(r,"foreignObject");return s.setAttribute("width",`${n}`),s.setAttribute("height",`${a}`),s.setAttribute("viewBox",`0 0 ${n} ${a}`),l.setAttribute("width","100%"),l.setAttribute("height","100%"),l.setAttribute("x","0"),l.setAttribute("y","0"),l.setAttribute("externalResourcesRequired","true"),s.appendChild(l),l.appendChild(e),u6(s)}const ar=(e,n)=>{if(e instanceof n)return!0;const a=Object.getPrototypeOf(e);return a===null?!1:a.constructor.name===n.name||ar(a,n)};function x6(e){const n=e.getPropertyValue("content");return`${e.cssText} content: '${n.replace(/'|"/g,"")}';`}function m6(e,n){return ew(n).map(a=>{const r=e.getPropertyValue(a),s=e.getPropertyPriority(a);return`${a}: ${r}${s?" !important":""};`}).join(" ")}function f6(e,n,a,r){const s=`.${e}:${n}`,l=a.cssText?x6(a):m6(a,r);return document.createTextNode(`${s}{${l}}`)}function Fb(e,n,a,r){const s=window.getComputedStyle(e,a),l=s.getPropertyValue("content");if(l===""||l==="none")return;const o=i6();try{n.className=`${n.className} ${o}`}catch{return}const d=document.createElement("style");d.appendChild(f6(o,a,s,r)),n.appendChild(d)}function p6(e,n,a){Fb(e,n,":before",a),Fb(e,n,":after",a)}const Lb="application/font-woff",Pb="image/jpeg",g6={woff:Lb,woff2:Lb,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Pb,jpeg:Pb,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function y6(e){const n=/\.([^./]*?)$/g.exec(e);return n?n[1]:""}function mg(e){const n=y6(e).toLowerCase();return g6[n]||""}function v6(e){return e.split(/,/)[1]}function wp(e){return e.search(/^(data:)/)!==-1}function b6(e,n){return`data:${n};base64,${e}`}async function nw(e,n,a){const r=await fetch(e,n);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const s=await r.blob();return new Promise((l,o)=>{const d=new FileReader;d.onerror=o,d.onloadend=()=>{try{l(a({res:r,result:d.result}))}catch(u){o(u)}},d.readAsDataURL(s)})}const mf={};function N6(e,n,a){let r=e.replace(/\?.*/,"");return a&&(r=e),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),n?`[${n}]${r}`:r}async function fg(e,n,a){const r=N6(e,n,a.includeQueryParams);if(mf[r]!=null)return mf[r];a.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let s;try{const l=await nw(e,a.fetchRequestInit,({res:o,result:d})=>(n||(n=o.headers.get("Content-Type")||""),v6(d)));s=b6(l,n)}catch(l){s=a.imagePlaceholder||"";let o=`Failed to fetch resource: ${e}`;l&&(o=typeof l=="string"?l:l.message),o&&console.warn(o)}return mf[r]=s,s}async function j6(e){const n=e.toDataURL();return n==="data:,"?e.cloneNode(!1):T0(n)}async function w6(e,n){if(e.currentSrc){const l=document.createElement("canvas"),o=l.getContext("2d");l.width=e.clientWidth,l.height=e.clientHeight,o==null||o.drawImage(e,0,0,l.width,l.height);const d=l.toDataURL();return T0(d)}const a=e.poster,r=mg(a),s=await fg(a,r,n);return T0(s)}async function k6(e,n){var a;try{if(!((a=e==null?void 0:e.contentDocument)===null||a===void 0)&&a.body)return await lx(e.contentDocument.body,n,!0)}catch{}return e.cloneNode(!1)}async function T6(e,n){return ar(e,HTMLCanvasElement)?j6(e):ar(e,HTMLVideoElement)?w6(e,n):ar(e,HTMLIFrameElement)?k6(e,n):e.cloneNode(aw(e))}const C6=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",aw=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function S6(e,n,a){var r,s;if(aw(n))return n;let l=[];return C6(e)&&e.assignedNodes?l=sl(e.assignedNodes()):ar(e,HTMLIFrameElement)&&(!((r=e.contentDocument)===null||r===void 0)&&r.body)?l=sl(e.contentDocument.body.childNodes):l=sl(((s=e.shadowRoot)!==null&&s!==void 0?s:e).childNodes),l.length===0||ar(e,HTMLVideoElement)||await l.reduce((o,d)=>o.then(()=>lx(d,a)).then(u=>{u&&n.appendChild(u)}),Promise.resolve()),n}function _6(e,n,a){const r=n.style;if(!r)return;const s=window.getComputedStyle(e);s.cssText?(r.cssText=s.cssText,r.transformOrigin=s.transformOrigin):ew(a).forEach(l=>{let o=s.getPropertyValue(l);l==="font-size"&&o.endsWith("px")&&(o=`${Math.floor(parseFloat(o.substring(0,o.length-2)))-.1}px`),ar(e,HTMLIFrameElement)&&l==="display"&&o==="inline"&&(o="block"),l==="d"&&n.getAttribute("d")&&(o=`path(${n.getAttribute("d")})`),r.setProperty(l,o,s.getPropertyPriority(l))})}function E6(e,n){ar(e,HTMLTextAreaElement)&&(n.innerHTML=e.value),ar(e,HTMLInputElement)&&n.setAttribute("value",e.value)}function D6(e,n){if(ar(e,HTMLSelectElement)){const r=Array.from(n.children).find(s=>e.value===s.getAttribute("value"));r&&r.setAttribute("selected","")}}function A6(e,n,a){return ar(n,Element)&&(_6(e,n,a),p6(e,n,a),E6(e,n),D6(e,n)),n}async function F6(e,n){const a=e.querySelectorAll?e.querySelectorAll("use"):[];if(a.length===0)return e;const r={};for(let l=0;l<a.length;l++){const d=a[l].getAttribute("xlink:href");if(d){const u=e.querySelector(d),x=document.querySelector(d);!u&&x&&!r[d]&&(r[d]=await lx(x,n,!0))}}const s=Object.values(r);if(s.length){const l="http://www.w3.org/1999/xhtml",o=document.createElementNS(l,"svg");o.setAttribute("xmlns",l),o.style.position="absolute",o.style.width="0",o.style.height="0",o.style.overflow="hidden",o.style.display="none";const d=document.createElementNS(l,"defs");o.appendChild(d);for(let u=0;u<s.length;u++)d.appendChild(s[u]);e.appendChild(o)}return e}async function lx(e,n,a){return!a&&n.filter&&!n.filter(e)?null:Promise.resolve(e).then(r=>T6(r,n)).then(r=>S6(e,r,n)).then(r=>A6(e,r,n)).then(r=>F6(r,n))}const rw=/url\((['"]?)([^'"]+?)\1\)/g,L6=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,P6=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function I6(e){const n=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${n})(['"]?\\))`,"g")}function O6(e){const n=[];return e.replace(rw,(a,r,s)=>(n.push(s),a)),n.filter(a=>!wp(a))}async function M6(e,n,a,r,s){try{const l=a?s6(n,a):n,o=mg(n);let d;return s||(d=await fg(l,o,r)),e.replace(I6(n),`$1${d}$3`)}catch{}return e}function R6(e,{preferredFontFormat:n}){return n?e.replace(P6,a=>{for(;;){const[r,,s]=L6.exec(a)||[];if(!s)return"";if(s===n)return`src: ${r};`}}):e}function sw(e){return e.search(rw)!==-1}async function iw(e,n,a){if(!sw(e))return e;const r=R6(e,a);return O6(r).reduce((l,o)=>l.then(d=>M6(d,o,n,a)),Promise.resolve(r))}async function Yo(e,n,a){var r;const s=(r=n.style)===null||r===void 0?void 0:r.getPropertyValue(e);if(s){const l=await iw(s,null,a);return n.style.setProperty(e,l,n.style.getPropertyPriority(e)),!0}return!1}async function B6(e,n){await Yo("background",e,n)||await Yo("background-image",e,n),await Yo("mask",e,n)||await Yo("-webkit-mask",e,n)||await Yo("mask-image",e,n)||await Yo("-webkit-mask-image",e,n)}async function H6(e,n){const a=ar(e,HTMLImageElement);if(!(a&&!wp(e.src))&&!(ar(e,SVGImageElement)&&!wp(e.href.baseVal)))return;const r=a?e.src:e.href.baseVal,s=await fg(r,mg(r),n);await new Promise((l,o)=>{e.onload=l,e.onerror=n.onImageErrorHandler?(...u)=>{try{l(n.onImageErrorHandler(...u))}catch(x){o(x)}}:o;const d=e;d.decode&&(d.decode=l),d.loading==="lazy"&&(d.loading="eager"),a?(e.srcset="",e.src=s):e.href.baseVal=s})}async function V6(e,n){const r=sl(e.childNodes).map(s=>lw(s,n));await Promise.all(r).then(()=>e)}async function lw(e,n){ar(e,Element)&&(await B6(e,n),await H6(e,n),await V6(e,n))}function U6(e,n){const{style:a}=e;n.backgroundColor&&(a.backgroundColor=n.backgroundColor),n.width&&(a.width=`${n.width}px`),n.height&&(a.height=`${n.height}px`);const r=n.style;return r!=null&&Object.keys(r).forEach(s=>{a[s]=r[s]}),e}const Ib={};async function Ob(e){let n=Ib[e];if(n!=null)return n;const r=await(await fetch(e)).text();return n={url:e,cssText:r},Ib[e]=n,n}async function Mb(e,n){let a=e.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,l=(a.match(/url\([^)]+\)/g)||[]).map(async o=>{let d=o.replace(r,"$1");return d.startsWith("https://")||(d=new URL(d,e.url).href),nw(d,n.fetchRequestInit,({result:u})=>(a=a.replace(o,`url(${u})`),[o,u]))});return Promise.all(l).then(()=>a)}function Rb(e){if(e==null)return[];const n=[],a=/(\/\*[\s\S]*?\*\/)/gi;let r=e.replace(a,"");const s=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const u=s.exec(r);if(u===null)break;n.push(u[0])}r=r.replace(s,"");const l=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,o="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",d=new RegExp(o,"gi");for(;;){let u=l.exec(r);if(u===null){if(u=d.exec(r),u===null)break;l.lastIndex=d.lastIndex}else d.lastIndex=l.lastIndex;n.push(u[0])}return n}async function K6(e,n){const a=[],r=[];return e.forEach(s=>{if("cssRules"in s)try{sl(s.cssRules||[]).forEach((l,o)=>{if(l.type===CSSRule.IMPORT_RULE){let d=o+1;const u=l.href,x=Ob(u).then(m=>Mb(m,n)).then(m=>Rb(m).forEach(f=>{try{s.insertRule(f,f.startsWith("@import")?d+=1:s.cssRules.length)}catch(p){console.error("Error inserting rule from remote css",{rule:f,error:p})}})).catch(m=>{console.error("Error loading remote css",m.toString())});r.push(x)}})}catch(l){const o=e.find(d=>d.href==null)||document.styleSheets[0];s.href!=null&&r.push(Ob(s.href).then(d=>Mb(d,n)).then(d=>Rb(d).forEach(u=>{o.insertRule(u,o.cssRules.length)})).catch(d=>{console.error("Error loading remote stylesheet",d)})),console.error("Error inlining remote css file",l)}}),Promise.all(r).then(()=>(e.forEach(s=>{if("cssRules"in s)try{sl(s.cssRules||[]).forEach(l=>{a.push(l)})}catch(l){console.error(`Error while reading CSS rules from ${s.href}`,l)}}),a))}function z6(e){return e.filter(n=>n.type===CSSRule.FONT_FACE_RULE).filter(n=>sw(n.style.getPropertyValue("src")))}async function $6(e,n){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const a=sl(e.ownerDocument.styleSheets),r=await K6(a,n);return z6(r)}function ow(e){return e.trim().replace(/["']/g,"")}function G6(e){const n=new Set;function a(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(l=>{n.add(ow(l))}),Array.from(r.children).forEach(l=>{l instanceof HTMLElement&&a(l)})}return a(e),n}async function q6(e,n){const a=await $6(e,n),r=G6(e);return(await Promise.all(a.filter(l=>r.has(ow(l.style.fontFamily))).map(l=>{const o=l.parentStyleSheet?l.parentStyleSheet.href:null;return iw(l.cssText,o,n)}))).join(`
`)}async function W6(e,n){const a=n.fontEmbedCSS!=null?n.fontEmbedCSS:n.skipFonts?null:await q6(e,n);if(a){const r=document.createElement("style"),s=document.createTextNode(a);r.appendChild(s),e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)}}async function X6(e,n={}){const{width:a,height:r}=tw(e,n),s=await lx(e,n,!0);return await W6(s,n),await lw(s,n),U6(s,n),await h6(s,a,r)}async function Q6(e,n={}){const{width:a,height:r}=tw(e,n),s=await X6(e,n),l=await T0(s),o=document.createElement("canvas"),d=o.getContext("2d"),u=n.pixelRatio||c6(),x=n.canvasWidth||a,m=n.canvasHeight||r;return o.width=x*u,o.height=m*u,n.skipAutoScale||d6(o),o.style.width=`${x}`,o.style.height=`${m}`,n.backgroundColor&&(d.fillStyle=n.backgroundColor,d.fillRect(0,0,o.width,o.height)),d.drawImage(l,0,0,o.width,o.height),o}async function Y6(e,n={}){return(await Q6(e,n)).toDataURL()}const Td=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),cw=D.forwardRef(({data:e},n)=>{var s,l,o,d,u,x,m,f,p,N;const a=e.cacKhoanLuong.filter(y=>y.loai==="THU_NHAP"),r=e.cacKhoanLuong.filter(y=>y.loai==="KHAU_TRU");return t.jsxs("div",{ref:n,className:"bg-white rounded-xl shadow-lg overflow-hidden max-w-2xl mx-auto",style:{width:"700px",fontFamily:"system-ui, -apple-system, sans-serif"},children:[t.jsxs("div",{className:"text-white text-center py-8 px-6",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[t.jsx("h1",{className:"text-3xl font-bold mb-1",children:"PHIU LNG"}),t.jsxs("p",{className:"text-lg opacity-90",children:["Thng ",e.thang," / ",e.nam]})]}),t.jsxs("div",{className:"text-center py-4 px-6 border-b-2 border-dashed border-gray-200 bg-gray-50",children:[((s=e.congTy)==null?void 0:s.logo)&&t.jsx("img",{src:e.congTy.logo,alt:"Logo cng ty",className:"h-12 mx-auto mb-2 object-contain"}),t.jsx("h2",{className:"text-xl font-bold text-gray-800",children:((l=e.congTy)==null?void 0:l.tenCongTy)||"CNG TY"}),((o=e.congTy)==null?void 0:o.diaChi)&&t.jsx("p",{className:"text-sm text-gray-600",children:e.congTy.diaChi}),(((d=e.congTy)==null?void 0:d.dienThoai)||((u=e.congTy)==null?void 0:u.email))&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[((x=e.congTy)==null?void 0:x.dienThoai)&&`T: ${e.congTy.dienThoai}`,((m=e.congTy)==null?void 0:m.dienThoai)&&((f=e.congTy)==null?void 0:f.email)&&" | ",((p=e.congTy)==null?void 0:p.email)&&`Email: ${e.congTy.email}`]}),((N=e.congTy)==null?void 0:N.maSoThue)&&t.jsxs("p",{className:"text-xs text-gray-500",children:["MST: ",e.congTy.maSoThue]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 p-6 bg-gray-50 border-b border-gray-200",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500",children:"H v tn"}),t.jsx("p",{className:"font-semibold text-gray-800",children:e.hoTen})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500",children:"M nhn vin"}),t.jsx("p",{className:"font-semibold text-gray-800",children:e.maNhanVien})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500",children:"Phng ban"}),t.jsx("p",{className:"font-semibold text-gray-800",children:e.phongBan})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500",children:"Chc v"}),t.jsx("p",{className:"font-semibold text-gray-800",children:e.chucVu||"Nhn vin"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("span",{className:"text-xs text-gray-500",children:"Ngy cng thc t"}),t.jsxs("p",{className:"font-semibold text-gray-800",children:[t.jsx("span",{className:"text-blue-600",children:e.ngayCongThucTe})," / ",e.ngayCongLyThuyet," ngy"]})]})]}),t.jsxs("div",{className:"p-6 border-b border-gray-100",children:[t.jsx("h3",{className:"text-base font-bold text-gray-800 mb-4 pb-2 border-b-2 border-green-500 inline-block",children:"THU NHP"}),t.jsx("div",{className:"space-y-3",children:a.map((y,g)=>t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-600",children:y.tenKhoan}),t.jsx("span",{className:"font-medium text-green-600",children:Td(y.soTien)})]},g))})]}),t.jsxs("div",{className:"p-6 border-b border-gray-100",children:[t.jsx("h3",{className:"text-base font-bold text-gray-800 mb-4 pb-2 border-b-2 border-red-500 inline-block",children:"KHU TR"}),t.jsx("div",{className:"space-y-3",children:r.length>0?r.map((y,g)=>t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-600",children:y.tenKhoan}),t.jsxs("span",{className:"font-medium text-red-600",children:["-",Td(y.soTien)]})]},g)):t.jsx("p",{className:"text-gray-400 italic",children:"Khng c khon khu tr"})})]}),t.jsxs("div",{className:"p-6 text-white",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[t.jsxs("div",{className:"flex justify-between items-center py-2",children:[t.jsx("span",{className:"opacity-90",children:"Tng thu nhp:"}),t.jsx("span",{className:"font-semibold",children:Td(e.tongThuNhap)})]}),t.jsxs("div",{className:"flex justify-between items-center py-2",children:[t.jsx("span",{className:"opacity-90",children:"Tng khu tr:"}),t.jsxs("span",{className:"font-semibold",children:["-",Td(e.tongKhauTru)]})]}),t.jsxs("div",{className:"flex justify-between items-center pt-4 mt-4 border-t border-white/30",children:[t.jsx("span",{className:"text-xl font-bold",children:"THC LNH:"}),t.jsx("span",{className:"text-2xl font-bold",children:Td(e.thucLinh)})]})]}),t.jsxs("div",{className:"text-center py-4 px-6 text-sm text-gray-500 border-t border-gray-100",children:[t.jsx("p",{children:"Phiu lng c to t ng bi h thng tnh lng."}),t.jsx("p",{children:"Nu c thc mc, vui lng lin h phng Nhn s."})]})]})});cw.displayName="PhieuLuong";function J6({isOpen:e,onClose:n,bangLuongId:a,nhanVienId:r,hoTen:s}){const l=D.useRef(null),[o,d]=D.useState(!1),{data:u,isLoading:x,error:m}=Fe({queryKey:["phieu-luong",a,r],queryFn:()=>jp.layPhieuLuong(a,r),enabled:e}),f=Ee({mutationFn:()=>jp.guiPhieuLuong(a,r),onSuccess:y=>{y.success?ie.success(y.message):ie.error(y.message)},onError:()=>{ie.error("C li khi gi email")}}),p=D.useCallback(async()=>{if(!(!l.current||!u)){d(!0);try{const y=await Y6(l.current,{cacheBust:!0,pixelRatio:2,backgroundColor:"#ffffff"}),g=document.createElement("a");g.download=`phieu-luong-${u.maNhanVien}-thang-${u.thang}-${u.nam}.png`,g.href=y,g.click(),ie.success(" xut phiu lng thnh cng!")}catch(y){console.error("Export error:",y),ie.error("C li khi xut nh")}finally{d(!1)}}},[u]),N=D.useCallback(()=>{if(!(u!=null&&u.email)){ie.error("Nhn vin khng c email");return}f.mutate()},[u==null?void 0:u.email,f]);return e?t.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[t.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:n}),t.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col mx-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gray-50",children:[t.jsxs("h2",{className:"text-lg font-bold text-gray-800",children:["Phiu lng - ",s]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:p,disabled:o||x,className:"btn btn-secondary flex items-center gap-2",children:[o?t.jsx(An,{size:18,className:"animate-spin"}):t.jsx(Ad,{size:18}),"Xut nh"]}),t.jsxs("button",{onClick:N,disabled:f.isPending||x||!(u!=null&&u.email),className:"btn btn-primary flex items-center gap-2",title:u!=null&&u.email?"Gi phiu lng qua email":"Nhn vin khng c email",children:[f.isPending?t.jsx(An,{size:18,className:"animate-spin"}):t.jsx(rg,{size:18}),"Gi email"]}),t.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-200 rounded-lg",children:t.jsx(rn,{size:20})})]})]}),t.jsx("div",{className:"flex-1 overflow-auto p-6 bg-gray-100",children:x?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx(An,{size:40,className:"animate-spin text-blue-500"})}):m?t.jsx("div",{className:"text-center py-8",children:t.jsx("p",{className:"text-red-500",children:"C li khi ti phiu lng"})}):u?t.jsx(cw,{ref:l,data:u}):null}),u&&t.jsxs("div",{className:"p-3 bg-gray-50 border-t text-sm text-gray-600 flex items-center justify-between",children:[t.jsxs("span",{children:["Email: ",u.email||t.jsx("span",{className:"italic text-gray-400",children:"Cha c"})]}),t.jsxs("span",{children:["Thc lnh: ",t.jsx("strong",{className:"text-green-600",children:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(u.thucLinh)})]})]})]})]}):null}function Z6({ngayCong:e,onClose:n,onSave:a,isLoading:r}){var m,f,p;const[s,l]=D.useState(((m=e==null?void 0:e.ngayCongDieuChinh)==null?void 0:m.toString())||""),[o,d]=D.useState((e==null?void 0:e.ghiChu)||"");if(!e)return null;const u=e.ngayCongDieuChinh?Number(e.ngayCongDieuChinh):Number(e.soCongThucTe)+Number(e.soNgayNghiPhep),x=async N=>{if(N.preventDefault(),!s)return;const y=parseFloat(s);if(isNaN(y)||y<0){alert("S ngy cng khng hp l");return}await a(y,o||void 0)};return t.jsx("div",{className:"modal-overlay",onClick:n,children:t.jsxs("div",{className:"modal-content max-w-lg",onClick:N=>N.stopPropagation(),children:[t.jsxs("div",{className:"modal-header",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(At,{className:"w-5 h-5"}),t.jsx("h3",{className:"text-lg font-semibold",children:"iu chnh ngy cng"})]}),t.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:t.jsx(rn,{className:"w-5 h-5"})})]}),t.jsxs("form",{onSubmit:x,children:[t.jsxs("div",{className:"modal-body space-y-4",children:[t.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-sm text-gray-600",children:"Nhn vin"}),t.jsx("div",{className:"font-semibold text-gray-900",children:((f=e.nhanVien)==null?void 0:f.hoTen)||"N/A"}),t.jsx("div",{className:"text-sm text-gray-500",children:((p=e.nhanVien)==null?void 0:p.maNhanVien)||"N/A"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Ngy cng l thuyt"}),t.jsx("div",{className:"text-xl font-bold text-blue-700",children:Number(e.ngayCongLyThuyet).toFixed(1)})]}),t.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"S cng thc t"}),t.jsx("div",{className:"text-xl font-bold text-green-700",children:Number(e.soCongThucTe).toFixed(1)})]}),t.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Ngh c php"}),t.jsx("div",{className:"text-xl font-bold text-yellow-700",children:Number(e.soNgayNghiPhep).toFixed(1)})]}),t.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Ngh khng php"}),t.jsx("div",{className:"text-xl font-bold text-red-700",children:Number(e.soNgayNghiKhongPhep).toFixed(1)})]})]}),t.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border-2 border-purple-200",children:[t.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Ngy cng hin ti (dng  tnh lng)"}),t.jsxs("div",{className:"text-2xl font-bold text-purple-700",children:[u.toFixed(1)," ngy"]}),e.ngayCongDieuChinh&&t.jsx("div",{className:"text-xs text-purple-600 mt-1",children:"  iu chnh th cng"})]}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsx("label",{className:"label",children:t.jsx("span",{className:"label-text font-semibold",children:"iu chnh ngy cng mi"})}),t.jsx("input",{type:"number",step:"0.5",min:"0",max:Number(e.ngayCongLyThuyet),className:"input input-bordered w-full",value:s,onChange:N=>l(N.target.value),placeholder:"Nhp s ngy cng",required:!0}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Nhp s ngy cng mi  iu chnh th cng"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"label",children:t.jsx("span",{className:"label-text font-semibold",children:"Ghi ch"})}),t.jsx("textarea",{className:"textarea textarea-bordered w-full",rows:3,value:o,onChange:N=>d(N.target.value),placeholder:"L do iu chnh..."})]}),t.jsxs("div",{className:"flex items-start gap-2 bg-yellow-50 p-3 rounded-lg border border-yellow-200",children:[t.jsx(di,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"text-sm text-yellow-800",children:[t.jsx("div",{className:"font-semibold mb-1",children:"Lu :"}),t.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[t.jsx("li",{children:"iu chnh ngy cng s nh hng n lng c bn"}),t.jsx("li",{children:"Nn c l do r rng trong phn ghi ch"}),t.jsx("li",{children:"C th xa iu chnh  tr v tnh t ng"})]})]})]})]}),t.jsxs("div",{className:"modal-footer",children:[t.jsx("button",{type:"button",onClick:n,className:"btn btn-ghost",children:"Hy"}),t.jsx("button",{type:"submit",className:"btn btn-primary",disabled:r||!s,children:r?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"loading loading-spinner loading-sm"}),"ang lu..."]}):t.jsxs(t.Fragment,{children:[t.jsx(_s,{className:"w-4 h-4"}),"Lu iu chnh"]})})]})]})]})})}const eD="column_config_";function pg(e,n){const a=`${eD}${e}`,r=D.useRef(""),[s,l]=D.useState([]),o=D.useMemo(()=>{if(n.length===0)return[];try{const b=localStorage.getItem(a);if(b){const j=JSON.parse(b),T=new Map(j.columns.map(_=>[_.id,_]));return n.map((_,w)=>{const E=T.get(_.id);return E?{..._,visible:E.visible,order:E.order}:{..._,order:100+w}}).sort((_,w)=>_.order-w.order)}}catch(b){console.warn("Failed to load column config:",b)}return n.map((b,j)=>({...b,order:j}))},[n,a]);D.useEffect(()=>{const b=n.map(j=>j.id).join(",");o.length>0&&b!==r.current&&(l(o),r.current=b)},[o,n]);const d=D.useCallback(b=>{if(b.length===0)return;const j={columns:b.map(T=>({id:T.id,label:T.label,visible:T.visible,order:T.order,sticky:T.sticky})),version:1};localStorage.setItem(a,JSON.stringify(j))},[a]),u=D.useCallback(b=>{l(j=>{const T=j.map(_=>_.id===b&&!_.sticky?{..._,visible:!_.visible}:_);return d(T),T})},[d]),x=D.useCallback((b,j)=>{l(T=>{const _=T.map(w=>w.id===b&&!w.sticky?{...w,visible:j}:w);return d(_),_})},[d]),m=D.useCallback(()=>{l(b=>{const j=b.map(T=>({...T,visible:!0}));return d(j),j})},[d]),f=D.useCallback(()=>{l(b=>{const j=b.map(T=>({...T,visible:T.sticky||!1}));return d(j),j})},[d]),p=D.useCallback((b,j)=>{l(T=>{const _=[...T],[w]=_.splice(b,1);_.splice(j,0,w);const E=_.map((C,S)=>({...C,order:S}));return d(E),E})},[d]),N=D.useCallback(()=>{const b=n.map((j,T)=>({...j,order:T,visible:!0}));l(b),d(b),localStorage.removeItem(a)},[n,d,a]),y=s.filter(b=>b.visible).sort((b,j)=>b.order-j.order),g=D.useCallback(()=>y.map(b=>({id:b.id,label:b.label})),[y]);return{columns:s,visibleColumns:y,toggleColumn:u,setColumnVisibility:x,showAllColumns:m,hideOptionalColumns:f,moveColumn:p,resetColumns:N,getExportColumns:g}}function dw(e,n,a){const r=[{id:"stt",label:"STT",visible:!0,order:0,sticky:!0,width:"50px",align:"center"},{id:"maNV",label:"M NV",visible:!0,order:1,sticky:!0,width:"80px"},{id:"hoTen",label:"H tn",visible:!0,order:2,sticky:!0,width:"180px"},{id:"chucVu",label:"Chc v",visible:!0,order:3,width:"120px"},{id:"ngayCong",label:"Ngy cng",visible:!0,order:4,align:"center",bgColor:"bg-orange-100"}];let s=5;return n&&(a==="CHIA_HANG"||a==="CA_HAI")&&r.push({id:"spDat",label:"SP t",visible:!0,order:s++,align:"right",bgColor:"bg-cyan-100"},{id:"spLoi",label:"SP li",visible:!0,order:s++,align:"right",bgColor:"bg-cyan-100"}),n&&(a==="GIAO_HANG"||a==="CA_HAI")&&r.push({id:"klGiao",label:"KL giao (kg)",visible:!0,order:s++,align:"right",bgColor:"bg-teal-100"},{id:"treGio",label:"Tr gi",visible:!0,order:s++,align:"right",bgColor:"bg-teal-100"}),e.forEach(l=>{r.push({id:`kl_${l.id}`,label:l.tenKhoan,visible:!0,order:s++,align:"right",width:"120px"})}),r.push({id:"tongThuNhap",label:"Tng thu nhp",visible:!0,order:s++,align:"right",bgColor:"bg-blue-100"},{id:"khauTru",label:"Khu tr",visible:!0,order:s++,align:"right",bgColor:"bg-red-100"},{id:"thucLinh",label:"Thc lnh",visible:!0,order:s++,align:"right",bgColor:"bg-green-100"},{id:"phieuLuong",label:"Phiu lng",visible:!0,order:s++,align:"center",bgColor:"bg-purple-100"}),r}function tD(){return[{id:"stt",label:"STT",visible:!0,order:0,sticky:!0,width:"50px",align:"center"},{id:"maNV",label:"M NV",visible:!0,order:1,sticky:!0,width:"80px"},{id:"hoTen",label:"H tn",visible:!0,order:2,sticky:!0,width:"180px"},{id:"phongBan",label:"Phng ban",visible:!0,order:3,width:"150px"},{id:"soTien",label:"S tin ng",visible:!0,order:4,align:"right",width:"130px"},{id:"ngayUng",label:"Ngy ng",visible:!0,order:5,align:"center",width:"120px"},{id:"lyDo",label:"L do",visible:!0,order:6,width:"200px"},{id:"trangThai",label:"Trng thi",visible:!0,order:7,align:"center",width:"120px"},{id:"nguoiDuyet",label:"Ngi duyt",visible:!0,order:8,width:"150px"},{id:"ngayDuyet",label:"Ngy duyt",visible:!0,order:9,align:"center",width:"120px"},{id:"thaoTac",label:"Thao tc",visible:!0,order:10,align:"center",width:"100px"}]}function nD(){const{id:e}=W0(),n=br(),a=Mt(),[r,s]=D.useState(null),[l,o]=D.useState(new Map),[d,u]=D.useState(!1),[x,m]=D.useState(!1),[f,p]=D.useState(""),[N,y]=D.useState(null),[g,b]=D.useState(null),{data:j,isLoading:T}=Fe({queryKey:["bang-luong",e],queryFn:()=>Or.layTheoId(Number(e)),enabled:!!e}),{data:_}=Fe({queryKey:["bang-luong-lich-su",e],queryFn:()=>Or.layLichSu(Number(e)),enabled:!!e&&d}),w=Ee({mutationFn:Or.capNhatNhieuChiTiet,onSuccess:()=>{a.invalidateQueries({queryKey:["bang-luong",e]}),o(new Map),ie.success("Lu thay i thnh cng!")},onError:()=>{ie.error("C li khi lu")}}),E=Ee({mutationFn:({nguoiChot:R})=>Or.chotBangLuong(Number(e),{nguoiChot:R}),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-luong",e]}),ie.success("Cht bng lng thnh cng!"),m(!1)},onError:()=>{ie.error("C li khi cht")}}),C=Ee({mutationFn:()=>Or.moKhoa(Number(e)),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-luong",e]}),ie.success("M kha thnh cng!")}}),S=Ee({mutationFn:()=>jp.guiTatCa(Number(e)),onSuccess:R=>{R.success>0&&ie.success(` gi ${R.success} phiu lng thnh cng!`),R.failed>0&&ie.error(`${R.failed} phiu lng gi tht bi`)},onError:()=>{ie.error("C li khi gi phiu lng")}}),P=Ee({mutationFn:({nhanVienId:R,ngayCongMoi:te,ghiChu:ue})=>GE.dieuChinh(Number(e),R,{ngayCongMoi:te,ghiChu:ue}),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-luong",e]}),ie.success("Cp nht ngy cng thnh cng!"),b(null)},onError:()=>{ie.error("C li khi cp nht ngy cng")}}),F=Ee({mutationFn:()=>Or.tinhLaiLuong(Number(e)),onSuccess:R=>{a.invalidateQueries({queryKey:["bang-luong",e]}),ie.success(R.message)},onError:()=>{ie.error("C li khi tnh li lng")}}),B=R=>{const te=j==null?void 0:j.danhSachNhanVien.find(le=>le.nhanVienId===R);if(!te||!j){ie.error("Khng tm thy thng tin nhn vin");return}const ue=te.ngayCong,V={id:(ue==null?void 0:ue.id)||0,bangLuongId:j.id,nhanVienId:R,ngayCongLyThuyet:j.ngayCongLyThuyet,soCongThucTe:(ue==null?void 0:ue.soCongThucTe)??te.ngayCongThucTe,soNgayNghiPhep:(ue==null?void 0:ue.soNgayNghiPhep)??0,soNgayNghiKhongPhep:(ue==null?void 0:ue.soNgayNghiKhongPhep)??0,ngayCongDieuChinh:(ue==null?void 0:ue.ngayCongDieuChinh)??null,ghiChu:(ue==null?void 0:ue.ghiChu)??null,nhanVien:{id:R,maNhanVien:te.maNhanVien,hoTen:te.hoTen}};b(V)},O=async(R,te)=>{g&&await P.mutateAsync({nhanVienId:g.nhanVienId,ngayCongMoi:R,ghiChu:te})},M=(R,te,ue)=>{(j==null?void 0:j.trangThai)==="NHAP"&&s({nhanVienId:R,khoanLuongId:te,value:ue.toString()})},G=R=>{r&&s({...r,value:R})},J=()=>{var le;if(!r||!j)return;const R=qE(r.value),te=`${r.nhanVienId}-${r.khoanLuongId}`,ue=j.danhSachNhanVien.find(q=>q.nhanVienId===r.nhanVienId),V=((le=ue==null?void 0:ue.cacKhoanLuong.find(q=>q.khoanLuongId===r.khoanLuongId))==null?void 0:le.soTien)||0;if(R!==V){const q=new Map(l);q.set(te,{nhanVienId:r.nhanVienId,khoanLuongId:r.khoanLuongId,soTien:R}),o(q)}s(null)},X=R=>{R.key==="Enter"?J():R.key==="Escape"&&s(null)},fe=()=>{if(l.size===0){ie("Khng c thay i  lu");return}const R=Array.from(l.values()).map(te=>({bangLuongId:Number(e),...te}));w.mutate(R)},ne=async()=>{try{const R=Q(),te=await m0.export(Number(e),R);XE(te.data,`bang-luong-${e}.xlsx`),ie.success("Xut file thnh cng!")}catch{ie.error("C li khi xut file")}},H=D.useCallback((R,te,ue)=>{const V=`${R}-${te}`,le=l.get(V);return le?le.soTien:ue},[l]),W=D.useCallback(R=>{let te=0,ue=0;for(const V of R.cacKhoanLuong){const le=H(R.nhanVienId,V.khoanLuongId,V.soTien);V.loai==="THU_NHAP"?te+=le:ue+=le}return l.forEach(V=>{if(V.nhanVienId===R.nhanVienId&&!R.cacKhoanLuong.find(q=>q.khoanLuongId===V.khoanLuongId)){const q=j==null?void 0:j.danhSachKhoanLuong.find(Le=>Le.id===V.khoanLuongId);(q==null?void 0:q.loai)==="THU_NHAP"?te+=V.soTien:ue+=V.soTien}}),{tongThuNhap:te,tongKhauTru:ue,thucLinh:te-ue}},[H,l,j==null?void 0:j.danhSachKhoanLuong]),xe=l.size>0,K=D.useMemo(()=>j?dw(j.danhSachKhoanLuong,j.coSanLuong||!1,j.loaiSanLuong):[],[j]),{visibleColumns:L,getExportColumns:Q}=pg("global_bang_luong",K);if(D.useEffect(()=>{const R=te=>{if(xe)return te.preventDefault(),te.returnValue="Bn c thay i cha lu. Bn c chc mun ri i?",te.returnValue};return window.addEventListener("beforeunload",R),()=>window.removeEventListener("beforeunload",R)},[xe]),T)return t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"text-gray-500",children:"ang ti..."})});if(!j)return t.jsxs("div",{className:"text-center py-8",children:[t.jsx("p",{className:"text-gray-500",children:"Khng tm thy bng lng"}),t.jsx("button",{onClick:()=>n("/bang-luong"),className:"btn btn-primary mt-4",children:"Quay li"})]});const I=j.trangThai==="NHAP";return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>n("/bang-luong"),className:"p-2 hover:bg-gray-200 rounded-lg",children:t.jsx(Y0,{size:20})}),t.jsxs("div",{children:[t.jsxs("h1",{className:"text-xl font-bold text-gray-800",children:["Bng lng ",j.phongBan.tenPhongBan]}),t.jsxs("p",{className:"text-sm text-gray-500",children:["Thng ",j.thang,"/",j.nam]})]}),t.jsxs("span",{className:`badge ${j.trangThai==="NHAP"?"badge-nhap":j.trangThai==="DA_CHOT"?"badge-da-chot":"badge-khoa"}`,children:[j.trangThai==="NHAP"&&"ang nhp",j.trangThai==="DA_CHOT"&&" cht",j.trangThai==="KHOA"&&" kha"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[l.size>0&&t.jsxs("span",{className:"text-sm text-orange-600 mr-2",children:[l.size," thay i cha lu"]}),I&&l.size>0&&t.jsxs("button",{onClick:fe,disabled:w.isPending,className:"btn btn-success",children:[t.jsx(_s,{size:18}),"Lu (",l.size,")"]}),t.jsxs("button",{onClick:ne,className:"btn btn-secondary",children:[t.jsx(ws,{size:18}),"Xut Excel"]}),t.jsxs("button",{onClick:()=>u(!d),className:"btn btn-secondary",children:[t.jsx(yu,{size:18}),"Lch s"]}),t.jsxs("button",{onClick:()=>S.mutate(),disabled:S.isPending,className:"btn btn-secondary",title:"Gi phiu lng cho tt c nhn vin qua email",children:[S.isPending?t.jsx(An,{size:18,className:"animate-spin"}):t.jsx(rg,{size:18}),"Gi tt c"]}),I&&t.jsxs("button",{onClick:()=>F.mutate(),disabled:F.isPending,className:"btn btn-secondary",title:"Tnh li lng theo ngy cng",children:[F.isPending?t.jsx(An,{size:18,className:"animate-spin"}):t.jsx(yr,{size:18}),"Tnh li lng"]}),I&&t.jsxs("button",{onClick:()=>m(!0),className:"btn btn-primary",children:[t.jsx(ti,{size:18}),"Cht"]}),j.trangThai==="DA_CHOT"&&t.jsxs("button",{onClick:()=>C.mutate(),className:"btn btn-secondary",children:[t.jsx(sg,{size:18}),"M kha"]})]})]}),t.jsx("div",{className:"card overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"excel-table w-full",children:[t.jsx("thead",{children:t.jsx("tr",{children:L.map(R=>R.id==="stt"?t.jsx("th",{className:"sticky left-0 z-20 bg-gray-200",children:"STT"},R.id):R.id==="maNV"?t.jsx("th",{className:"sticky left-10 z-20 bg-gray-200 min-w-[80px]",children:"M NV"},R.id):R.id==="hoTen"?t.jsx("th",{className:"sticky left-[120px] z-20 bg-gray-200 min-w-[180px]",children:"H tn"},R.id):R.id==="chucVu"?t.jsx("th",{className:"min-w-[120px]",children:R.label},R.id):R.id==="ngayCong"?t.jsx("th",{className:"min-w-[80px] text-center bg-orange-100",children:R.label},R.id):R.id==="spDat"&&j.coSanLuong&&(j.loaiSanLuong==="CHIA_HANG"||j.loaiSanLuong==="CA_HAI")?t.jsx("th",{className:"min-w-[90px] text-right bg-cyan-100",children:R.label},R.id):R.id==="spLoi"&&j.coSanLuong&&(j.loaiSanLuong==="CHIA_HANG"||j.loaiSanLuong==="CA_HAI")?t.jsx("th",{className:"min-w-[80px] text-right bg-cyan-100",children:R.label},R.id):R.id==="klGiao"&&j.coSanLuong&&(j.loaiSanLuong==="GIAO_HANG"||j.loaiSanLuong==="CA_HAI")?t.jsx("th",{className:"min-w-[100px] text-right bg-teal-100",children:R.label},R.id):R.id==="treGio"&&j.coSanLuong&&(j.loaiSanLuong==="GIAO_HANG"||j.loaiSanLuong==="CA_HAI")?t.jsx("th",{className:"min-w-[80px] text-right bg-teal-100",children:R.label},R.id):R.id==="tongThuNhap"?t.jsx("th",{className:"min-w-[130px] text-right bg-blue-100",children:R.label},R.id):R.id==="khauTru"?t.jsx("th",{className:"min-w-[100px] text-right bg-red-100",children:R.label},R.id):R.id==="thucLinh"?t.jsx("th",{className:"min-w-[130px] text-right bg-green-100",children:R.label},R.id):R.id==="phieuLuong"?t.jsx("th",{className:"min-w-[80px] text-center bg-purple-100",children:R.label},R.id):R.id.startsWith("kl_")?t.jsx("th",{className:"min-w-[120px] text-right",children:R.label},R.id):null)})}),t.jsx("tbody",{children:j.danhSachNhanVien.map((R,te)=>{const ue=W(R),V=R.ngayCong,le=V!=null&&V.ngayCongDieuChinh?Number(V.ngayCongDieuChinh):V?Number(V.soCongThucTe)+Number(V.soNgayNghiPhep):R.ngayCongThucTe;return t.jsx("tr",{children:L.map(q=>{var Le,ee,ke,Ke,tt,Xe,Oe,Rt,hn,xn,Cn;if(q.id==="stt")return t.jsx("td",{className:"sticky left-0 bg-white",children:te+1},q.id);if(q.id==="maNV")return t.jsx("td",{className:"sticky left-10 bg-white font-medium",children:R.maNhanVien},q.id);if(q.id==="hoTen")return t.jsx("td",{className:"sticky left-[120px] bg-white",children:R.hoTen},q.id);if(q.id==="chucVu")return t.jsx("td",{children:R.chucVu||"-"},q.id);if(q.id==="ngayCong")return t.jsxs("td",{className:"text-center bg-orange-50 relative group",children:[t.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t.jsxs("span",{className:`font-medium ${V!=null&&V.ngayCongDieuChinh?"text-orange-600":""}`,children:[le.toFixed(1),"/",j.ngayCongLyThuyet]}),I&&t.jsx("button",{onClick:()=>B(R.nhanVienId),className:"opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-orange-200 rounded",title:"Chi tit v iu chnh",children:t.jsx(mj,{className:"w-3 h-3 text-orange-600"})}),(V==null?void 0:V.ngayCongDieuChinh)&&t.jsx("span",{className:"text-xs text-orange-600",title:" iu chnh th cng",children:""})]}),V&&t.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[t.jsxs("span",{className:"text-green-600",children:[Number(V.soNgayNghiPhep).toFixed(1),"P"]}),Number(V.soNgayNghiKhongPhep)>0&&t.jsxs("span",{className:"text-red-600 ml-1",children:[Number(V.soNgayNghiKhongPhep).toFixed(1),"KP"]})]})]},q.id);if(q.id==="spDat"&&j.coSanLuong&&(j.loaiSanLuong==="CHIA_HANG"||j.loaiSanLuong==="CA_HAI"))return t.jsx("td",{className:"text-right bg-cyan-50 font-medium",children:((ke=(ee=(Le=R.sanLuong)==null?void 0:Le.chiaHang)==null?void 0:ee.tongSpDat)==null?void 0:ke.toLocaleString("vi-VN"))||"-"},q.id);if(q.id==="spLoi"&&j.coSanLuong&&(j.loaiSanLuong==="CHIA_HANG"||j.loaiSanLuong==="CA_HAI"))return t.jsx("td",{className:"text-right bg-cyan-50 text-red-600",children:((Xe=(tt=(Ke=R.sanLuong)==null?void 0:Ke.chiaHang)==null?void 0:tt.tongSpLoi)==null?void 0:Xe.toLocaleString("vi-VN"))||"-"},q.id);if(q.id==="klGiao"&&j.coSanLuong&&(j.loaiSanLuong==="GIAO_HANG"||j.loaiSanLuong==="CA_HAI"))return t.jsx("td",{className:"text-right bg-teal-50 font-medium",children:((hn=(Rt=(Oe=R.sanLuong)==null?void 0:Oe.giaoHang)==null?void 0:Rt.tongKhoiLuongThanhCong)==null?void 0:hn.toLocaleString("vi-VN"))||"-"},q.id);if(q.id==="treGio"&&j.coSanLuong&&(j.loaiSanLuong==="GIAO_HANG"||j.loaiSanLuong==="CA_HAI"))return t.jsx("td",{className:"text-right bg-teal-50 text-orange-600",children:((Cn=(xn=R.sanLuong)==null?void 0:xn.giaoHang)==null?void 0:Cn.tongSoLanTreGio)||"-"},q.id);if(q.id==="tongThuNhap")return t.jsx("td",{className:"number font-semibold bg-blue-50",children:Ze(ue.tongThuNhap)},q.id);if(q.id==="khauTru")return t.jsx("td",{className:"number text-red-600 bg-red-50",children:Ze(ue.tongKhauTru)},q.id);if(q.id==="thucLinh")return t.jsx("td",{className:"number font-bold text-green-600 bg-green-50",children:Ze(ue.thucLinh)},q.id);if(q.id==="phieuLuong")return t.jsx("td",{className:"text-center bg-purple-50",children:t.jsx("button",{onClick:()=>y({id:R.nhanVienId,hoTen:R.hoTen}),className:"p-1.5 hover:bg-purple-200 rounded-lg text-purple-600 transition-colors",title:"Xem phiu lng",children:t.jsx(wn,{size:18})})},q.id);if(q.id.startsWith("kl_")){const ia=parseInt(q.id.replace("kl_","")),la=R.cacKhoanLuong.find(Nt=>Nt.khoanLuongId===ia),Re=(la==null?void 0:la.soTien)||0,Qe=H(R.nhanVienId,ia,Re),Et=(r==null?void 0:r.nhanVienId)===R.nhanVienId&&(r==null?void 0:r.khoanLuongId)===ia,Ht=l.has(`${R.nhanVienId}-${ia}`);return t.jsx("td",{className:`number ${I?"editable":""} ${Ht?"bg-yellow-100":""}`,onClick:()=>M(R.nhanVienId,ia,Qe),children:Et?t.jsx("input",{type:"text",value:r.value,onChange:Nt=>G(Nt.target.value),onBlur:J,onKeyDown:X,className:"cell-input",autoFocus:!0}):Ze(Qe)},q.id)}return null})},R.nhanVienId)})}),t.jsx("tfoot",{children:t.jsx("tr",{className:"total-row",children:L.map(R=>{if(["stt","maNV","hoTen","chucVu"].includes(R.id)){if(R.id==="stt"){const te=L.filter(ue=>["stt","maNV","hoTen","chucVu"].includes(ue.id)).length;return t.jsx("td",{colSpan:te,className:"text-right font-bold",children:"TNG CNG"},R.id)}return null}if(R.id==="ngayCong")return t.jsx("td",{className:"bg-orange-100"},R.id);if(R.id==="spDat"&&j.coSanLuong&&(j.loaiSanLuong==="CHIA_HANG"||j.loaiSanLuong==="CA_HAI"))return t.jsx("td",{className:"number font-bold bg-cyan-100",children:j.danhSachNhanVien.reduce((te,ue)=>{var V,le;return te+(((le=(V=ue.sanLuong)==null?void 0:V.chiaHang)==null?void 0:le.tongSpDat)||0)},0).toLocaleString("vi-VN")},R.id);if(R.id==="spLoi"&&j.coSanLuong&&(j.loaiSanLuong==="CHIA_HANG"||j.loaiSanLuong==="CA_HAI"))return t.jsx("td",{className:"number font-bold text-red-600 bg-cyan-100",children:j.danhSachNhanVien.reduce((te,ue)=>{var V,le;return te+(((le=(V=ue.sanLuong)==null?void 0:V.chiaHang)==null?void 0:le.tongSpLoi)||0)},0).toLocaleString("vi-VN")},R.id);if(R.id==="klGiao"&&j.coSanLuong&&(j.loaiSanLuong==="GIAO_HANG"||j.loaiSanLuong==="CA_HAI"))return t.jsx("td",{className:"number font-bold bg-teal-100",children:j.danhSachNhanVien.reduce((te,ue)=>{var V,le;return te+(((le=(V=ue.sanLuong)==null?void 0:V.giaoHang)==null?void 0:le.tongKhoiLuongThanhCong)||0)},0).toLocaleString("vi-VN")},R.id);if(R.id==="treGio"&&j.coSanLuong&&(j.loaiSanLuong==="GIAO_HANG"||j.loaiSanLuong==="CA_HAI"))return t.jsx("td",{className:"number font-bold text-orange-600 bg-teal-100",children:j.danhSachNhanVien.reduce((te,ue)=>{var V,le;return te+(((le=(V=ue.sanLuong)==null?void 0:V.giaoHang)==null?void 0:le.tongSoLanTreGio)||0)},0)},R.id);if(R.id==="tongThuNhap")return t.jsx("td",{className:"number font-bold bg-blue-100",children:Ze(j.danhSachNhanVien.reduce((te,ue)=>te+W(ue).tongThuNhap,0))},R.id);if(R.id==="khauTru")return t.jsx("td",{className:"number font-bold text-red-600 bg-red-100",children:Ze(j.danhSachNhanVien.reduce((te,ue)=>te+W(ue).tongKhauTru,0))},R.id);if(R.id==="thucLinh")return t.jsx("td",{className:"number font-bold text-green-600 bg-green-100",children:Ze(j.danhSachNhanVien.reduce((te,ue)=>te+W(ue).thucLinh,0))},R.id);if(R.id==="phieuLuong")return t.jsx("td",{className:"bg-purple-100"},R.id);if(R.id.startsWith("kl_")){const te=parseInt(R.id.replace("kl_","")),ue=j.danhSachNhanVien.reduce((V,le)=>{const q=le.cacKhoanLuong.find(Le=>Le.khoanLuongId===te);return V+H(le.nhanVienId,te,(q==null?void 0:q.soTien)||0)},0);return t.jsx("td",{className:"number font-bold",children:Ze(ue)},R.id)}return null})})})]})})}),d&&t.jsxs("div",{className:"card mt-4",children:[t.jsx("h3",{className:"font-semibold mb-3",children:"Lch s chnh sa"}),_&&_.length>0?t.jsx("div",{className:"max-h-64 overflow-y-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b",children:[t.jsx("th",{className:"text-left py-2",children:"Thi gian"}),t.jsx("th",{className:"text-left py-2",children:"Nhn vin"}),t.jsx("th",{className:"text-left py-2",children:"Khon"}),t.jsx("th",{className:"text-right py-2",children:"C"}),t.jsx("th",{className:"text-right py-2",children:"Mi"}),t.jsx("th",{className:"text-left py-2",children:"Ngi sa"})]})}),t.jsx("tbody",{children:_.map(R=>{var te,ue;return t.jsxs("tr",{className:"border-b",children:[t.jsx("td",{className:"py-2",children:new Date(R.ngayThayDoi).toLocaleString("vi-VN")}),t.jsx("td",{className:"py-2",children:(te=R.nhanVien)==null?void 0:te.hoTen}),t.jsx("td",{className:"py-2",children:(ue=R.khoanLuong)==null?void 0:ue.tenKhoan}),t.jsx("td",{className:"py-2 text-right",children:Ze(R.giaTriCu)}),t.jsx("td",{className:"py-2 text-right font-medium",children:Ze(R.giaTriMoi)}),t.jsx("td",{className:"py-2",children:R.nguoiThayDoi})]},R.id)})})]})}):t.jsx("p",{className:"text-gray-500",children:"Cha c lch s chnh sa"})]}),x&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Cht bng lng"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"Sau khi cht, bng lng s khng th chnh sa. Bn c chc chn?"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngi cht *"}),t.jsx("input",{type:"text",value:f,onChange:R=>p(R.target.value),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp tn ngi cht"})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsxs("button",{onClick:()=>m(!1),className:"btn btn-secondary",children:[t.jsx(rn,{size:18}),"Hy"]}),t.jsxs("button",{onClick:()=>E.mutate({nguoiChot:f}),disabled:!f||E.isPending,className:"btn btn-primary",children:[t.jsx(Br,{size:18}),"Xc nhn cht"]})]})]})}),N&&t.jsx(J6,{isOpen:!!N,onClose:()=>y(null),bangLuongId:Number(e),nhanVienId:N.id,hoTen:N.hoTen}),g&&t.jsx(Z6,{ngayCong:g,onClose:()=>b(null),onSave:O,isLoading:P.isPending})]})}const uw=["Thng 1","Thng 2","Thng 3","Thng 4","Thng 5","Thng 6","Thng 7","Thng 8","Thng 9","Thng 10","Thng 11","Thng 12"],aD=["Th1","Th2","Th3","Th4","Th5","Th6","Th7","Th8","Th9","Th10","Th11","Th12"],rD=["CN","T2","T3","T4","T5","T6","T7"];function Gt({value:e,onChange:n,className:a="",placeholder:r="Chn ngy",min:s,max:l,disabled:o=!1}){const[d,u]=D.useState(!1),[x,m]=D.useState(()=>e?new Date(e):new Date),f=D.useRef(null);D.useEffect(()=>{const S=P=>{f.current&&!f.current.contains(P.target)&&u(!1)};return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[]);const p=e?new Date(e):null,N=S=>{if(!S)return"";const P=new Date(S);return`${P.getDate().toString().padStart(2,"0")}/${(P.getMonth()+1).toString().padStart(2,"0")}/${P.getFullYear()}`},y=(S,P)=>new Date(S,P+1,0).getDate(),g=(S,P)=>new Date(S,P,1).getDay(),b=()=>{m(S=>new Date(S.getFullYear(),S.getMonth()-1,1))},j=()=>{m(S=>new Date(S.getFullYear(),S.getMonth()+1,1))},T=S=>{const P=new Date(x.getFullYear(),x.getMonth(),S),F=`${P.getFullYear()}-${(P.getMonth()+1).toString().padStart(2,"0")}-${S.toString().padStart(2,"0")}`;n(F),u(!1)},_=S=>{const P=new Date(x.getFullYear(),x.getMonth(),S);return!!(s&&P<new Date(s)||l&&P>new Date(l))},w=S=>{const P=new Date;return x.getFullYear()===P.getFullYear()&&x.getMonth()===P.getMonth()&&S===P.getDate()},E=S=>p?x.getFullYear()===p.getFullYear()&&x.getMonth()===p.getMonth()&&S===p.getDate():!1,C=()=>{const S=x.getFullYear(),P=x.getMonth(),F=y(S,P),B=g(S,P),O=[];for(let M=0;M<B;M++)O.push(null);for(let M=1;M<=F;M++)O.push(M);return t.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[rD.map(M=>t.jsx("div",{className:"text-center text-xs font-medium text-gray-500 py-1",children:M},M)),O.map((M,G)=>t.jsx("div",{className:"aspect-square",children:M!==null&&t.jsx("button",{type:"button",disabled:_(M),onClick:()=>T(M),className:`
                  w-full h-full rounded-lg text-sm transition-colors
                  ${E(M)?"bg-primary-600 text-white":w(M)?"bg-primary-100 text-primary-700":"hover:bg-gray-100"}
                  ${_(M)?"opacity-50 cursor-not-allowed":""}
                `,children:M})},G))]})};return t.jsxs("div",{ref:f,className:"relative",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",value:N(e),readOnly:!0,onClick:()=>!o&&u(!d),placeholder:r,disabled:o,className:`
            w-full px-3 py-2 pr-10 border rounded-lg cursor-pointer
            focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent
            ${o?"bg-gray-100 cursor-not-allowed":"bg-white"}
            ${a}
          `}),t.jsx(At,{size:18,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"})]}),d&&t.jsxs("div",{className:"absolute z-50 mt-1 p-3 bg-white rounded-xl shadow-lg border min-w-[280px]",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("button",{type:"button",onClick:b,className:"p-1 hover:bg-gray-100 rounded-lg",children:t.jsx(Nr,{size:20})}),t.jsxs("span",{className:"font-medium",children:[uw[x.getMonth()]," ",x.getFullYear()]}),t.jsx("button",{type:"button",onClick:j,className:"p-1 hover:bg-gray-100 rounded-lg",children:t.jsx(qn,{size:20})})]}),C(),t.jsxs("div",{className:"flex justify-between mt-3 pt-3 border-t",children:[t.jsx("button",{type:"button",onClick:()=>{n(""),u(!1)},className:"text-sm text-gray-500 hover:text-gray-700",children:"Xa"}),t.jsx("button",{type:"button",onClick:()=>{const S=new Date,P=`${S.getFullYear()}-${(S.getMonth()+1).toString().padStart(2,"0")}-${S.getDate().toString().padStart(2,"0")}`;n(P),u(!1)},className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Hm nay"})]})]})]})}function Tc({value:e,onChange:n,className:a="",placeholder:r="Chn thng",disabled:s=!1}){const[l,o]=D.useState(!1),[d,u]=D.useState(()=>e?parseInt(e.split("-")[0]):new Date().getFullYear()),x=D.useRef(null);D.useEffect(()=>{const y=g=>{x.current&&!x.current.contains(g.target)&&o(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]);const m=y=>{if(!y)return"";const[g,b]=y.split("-");return`${uw[parseInt(b)-1]} ${g}`},f=y=>{const g=`${d}-${(y+1).toString().padStart(2,"0")}`;n(g),o(!1)},p=y=>{if(!e)return!1;const[g,b]=e.split("-");return parseInt(g)===d&&parseInt(b)===y+1},N=y=>{const g=new Date;return d===g.getFullYear()&&y===g.getMonth()};return t.jsxs("div",{ref:x,className:"relative",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",value:m(e),readOnly:!0,onClick:()=>!s&&o(!l),placeholder:r,disabled:s,className:`
            w-full px-3 py-2 pr-10 border rounded-lg cursor-pointer
            focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent
            ${s?"bg-gray-100 cursor-not-allowed":"bg-white"}
            ${a}
          `}),t.jsx(At,{size:18,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"})]}),l&&t.jsxs("div",{className:"absolute z-50 mt-1 p-3 bg-white rounded-xl shadow-lg border min-w-[280px]",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("button",{type:"button",onClick:()=>u(y=>y-1),className:"p-1 hover:bg-gray-100 rounded-lg",children:t.jsx(Nr,{size:20})}),t.jsx("span",{className:"font-medium text-lg",children:d}),t.jsx("button",{type:"button",onClick:()=>u(y=>y+1),className:"p-1 hover:bg-gray-100 rounded-lg",children:t.jsx(qn,{size:20})})]}),t.jsx("div",{className:"grid grid-cols-4 gap-2",children:aD.map((y,g)=>t.jsx("button",{type:"button",onClick:()=>f(g),className:`
                  py-2 px-1 rounded-lg text-sm transition-colors
                  ${p(g)?"bg-primary-600 text-white":N(g)?"bg-primary-100 text-primary-700":"hover:bg-gray-100"}
                `,children:y},y))}),t.jsxs("div",{className:"flex justify-between mt-3 pt-3 border-t",children:[t.jsx("button",{type:"button",onClick:()=>{n(""),o(!1)},className:"text-sm text-gray-500 hover:text-gray-700",children:"Xa"}),t.jsx("button",{type:"button",onClick:()=>{const y=new Date,g=`${y.getFullYear()}-${(y.getMonth()+1).toString().padStart(2,"0")}`;n(g),o(!1)},className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Thng ny"})]})]})]})}const Bb={DANG_LAM:{label:"ang lm",color:"bg-green-100 text-green-700"},NGHI_VIEC:{label:" ngh",color:"bg-red-100 text-red-700"},TAM_NGHI:{label:"Tm ngh",color:"bg-yellow-100 text-yellow-700"}};function sD(){const e=Mt(),[n,a]=D.useState(!1),[r,s]=D.useState(),[l,o]=D.useState(""),[d,u]=D.useState(""),[x,m]=D.useState(""),[f,p]=D.useState({maNhanVien:"",hoTen:"",email:"",soDienThoai:"",phongBanId:0,chucVu:"",ngayVaoLam:"",gioiTinh:"",ngaySinh:"",diaChi:"",trangThai:"DANG_LAM",loaiNhanVien:"CHINH_THUC",dongBHXH:!0}),{data:N,isLoading:y}=Fe({queryKey:["nhan-vien",r,l,x],queryFn:()=>ma.layTatCa({phongBanId:r,tuKhoa:x,trangThai:l||void 0})}),g=Array.isArray(N)?N:(N==null?void 0:N.data)||[],b=d?g.filter(B=>B.loaiNhanVien===d):g,{data:j}=Fe({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),T=Ee({mutationFn:ma.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["nhan-vien"]}),ie.success("To nhn vin thnh cng!"),E()},onError:B=>{var O,M;ie.error(((M=(O=B.response)==null?void 0:O.data)==null?void 0:M.message)||"C li xy ra")}}),_=Ee({mutationFn:({id:B,data:O})=>ma.capNhat(B,O),onSuccess:()=>{e.invalidateQueries({queryKey:["nhan-vien"]}),ie.success("Cp nht thnh cng!"),E()},onError:B=>{var O,M;ie.error(((M=(O=B.response)==null?void 0:O.data)==null?void 0:M.message)||"C li xy ra")}}),w=Ee({mutationFn:ma.xoa,onSuccess:()=>{e.invalidateQueries({queryKey:["nhan-vien"]}),ie.success("Xa nhn vin thnh cng!")},onError:B=>{var O,M;ie.error(((M=(O=B.response)==null?void 0:O.data)==null?void 0:M.message)||"C li xy ra")}}),E=()=>{a(!1),p({maNhanVien:"",hoTen:"",email:"",soDienThoai:"",phongBanId:0,chucVu:"",ngayVaoLam:"",gioiTinh:"",ngaySinh:"",diaChi:"",trangThai:"DANG_LAM",loaiNhanVien:"CHINH_THUC",dongBHXH:!0})},C=async()=>{try{const{maNhanVien:B}=await ma.layMaTuDong();p(O=>({...O,maNhanVien:B})),a(!0)}catch{a(!0)}},S=B=>{confirm(`Khi phc nhn vin "${B.hoTen}" v trng thi ang lm?`)&&_.mutate({id:B.id,data:{trangThai:"DANG_LAM"}})},P=()=>{if(!f.maNhanVien||!f.hoTen||!f.phongBanId){ie.error("Vui lng in y  thng tin bt buc");return}T.mutate(f)},F=B=>{confirm(`Bn c chc mun xa nhn vin "${B.hoTen}"?`)&&w.mutate(B.id)};return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[t.jsx(cn,{size:28}),"Qun l Nhn vin"]}),t.jsxs("button",{onClick:C,className:"btn btn-primary",children:[t.jsx(Dt,{size:20}),"Thm nhn vin"]})]}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx("div",{className:"flex-1",children:t.jsxs("div",{className:"relative",children:[t.jsx(Vr,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),t.jsx("input",{type:"text",value:x,onChange:B=>m(B.target.value),placeholder:"Tm kim theo tn, m NV, email...",className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]})}),t.jsx("div",{children:t.jsxs("select",{value:r||"",onChange:B=>s(B.target.value?Number(B.target.value):void 0),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),j==null?void 0:j.map(B=>t.jsx("option",{value:B.id,children:B.tenPhongBan},B.id))]})}),t.jsx("div",{children:t.jsxs("select",{value:l,onChange:B=>o(B.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c trng thi"}),t.jsx("option",{value:"DANG_LAM",children:"ang lm"}),t.jsx("option",{value:"NGHI_VIEC",children:" ngh"}),t.jsx("option",{value:"TAM_NGHI",children:"Tm ngh"})]})}),t.jsx("div",{children:t.jsxs("select",{value:d,onChange:B=>u(B.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c loi NV"}),t.jsx("option",{value:"CHINH_THUC",children:"Chnh thc"}),t.jsx("option",{value:"THU_VIEC",children:"Th vic"}),t.jsx("option",{value:"HOC_VIEC",children:"Hc vic"}),t.jsx("option",{value:"THUC_TAP",children:"Thc tp"}),t.jsx("option",{value:"CONG_TAC_VIEN",children:"Cng tc vin"}),t.jsx("option",{value:"THOI_VU",children:"Thi v"})]})})]})}),t.jsx("div",{className:"card",children:y?t.jsx("p",{className:"text-center py-8 text-gray-500",children:"ang ti..."}):b&&b.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"M NV"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"H tn"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Phng ban"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Chc v"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Loi NV"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"BHXH"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Trng thi"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Thao tc"})]})}),t.jsx("tbody",{children:b.map(B=>{var O,M,G,J,X;return t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4 font-medium",children:B.maNhanVien}),t.jsx("td",{className:"py-3 px-4",children:B.hoTen}),t.jsx("td",{className:"py-3 px-4",children:(O=B.phongBan)==null?void 0:O.tenPhongBan}),t.jsx("td",{className:"py-3 px-4",children:B.chucVu||"-"}),t.jsx("td",{className:"py-3 px-4 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${((M=w0[B.loaiNhanVien||"CHINH_THUC"])==null?void 0:M.color)||"bg-gray-100"}`,children:((G=w0[B.loaiNhanVien||"CHINH_THUC"])==null?void 0:G.label)||"Chnh thc"})}),t.jsx("td",{className:"py-3 px-4 text-center",children:B.dongBHXH!==!1?t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700",children:"C"}):t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-700",children:"Khng"})}),t.jsx("td",{className:"py-3 px-4 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${((J=Bb[B.trangThai])==null?void 0:J.color)||"bg-gray-100"}`,children:((X=Bb[B.trangThai])==null?void 0:X.label)||B.trangThai})}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsxs(xa,{to:`/nhan-vien/${B.id}`,className:"px-3 py-1.5 text-xs bg-blue-100 text-blue-700 hover:bg-blue-200 rounded flex items-center gap-1 font-medium",title:"Xem & chnh sa thng tin nhn vin",children:[t.jsx(Za,{size:14}),"Chi tit"]}),B.trangThai==="NGHI_VIEC"?t.jsx("button",{onClick:()=>S(B),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg",title:"Khi phc",children:t.jsx(bu,{size:18})}):t.jsx("button",{onClick:()=>F(B),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Cho ngh vic",children:t.jsx(er,{size:18})})]})})]},B.id)})})]})}):t.jsx("p",{className:"text-center py-8 text-gray-500",children:"Cha c nhn vin no"})}),n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-lg",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Thm nhn vin mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M nhn vin *"}),t.jsx("input",{type:"text",value:f.maNhanVien,onChange:B=>p({...f,maNhanVien:B.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"H tn *"}),t.jsx("input",{type:"text",value:f.hoTen,onChange:B=>p({...f,hoTen:B.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phng ban *"}),t.jsxs("select",{value:f.phongBanId,onChange:B=>p({...f,phongBanId:Number(B.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn phng ban --"}),j==null?void 0:j.map(B=>t.jsx("option",{value:B.id,children:B.tenPhongBan},B.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chc v"}),t.jsx("input",{type:"text",value:f.chucVu,onChange:B=>p({...f,chucVu:B.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gii tnh"}),t.jsxs("select",{value:f.gioiTinh,onChange:B=>p({...f,gioiTinh:B.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn --"}),t.jsx("option",{value:"NAM",children:"Nam"}),t.jsx("option",{value:"NU",children:"N"}),t.jsx("option",{value:"KHAC",children:"Khc"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy sinh"}),t.jsx(Gt,{value:f.ngaySinh,onChange:B=>p({...f,ngaySinh:B}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),t.jsx("input",{type:"email",value:f.email,onChange:B=>p({...f,email:B.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S in thoi"}),t.jsx("input",{type:"text",value:f.soDienThoai,onChange:B=>p({...f,soDienThoai:B.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"a ch"}),t.jsx("input",{type:"text",value:f.diaChi,onChange:B=>p({...f,diaChi:B.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp a ch..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy vo lm"}),t.jsx(Gt,{value:f.ngayVaoLam,onChange:B=>p({...f,ngayVaoLam:B}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi nhn vin"}),t.jsxs("select",{value:f.loaiNhanVien,onChange:B=>p({...f,loaiNhanVien:B.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"CHINH_THUC",children:"Chnh thc"}),t.jsx("option",{value:"THU_VIEC",children:"Th vic"}),t.jsx("option",{value:"HOC_VIEC",children:"Hc vic"}),t.jsx("option",{value:"THUC_TAP",children:"Thc tp"}),t.jsx("option",{value:"CONG_TAC_VIEN",children:"Cng tc vin"}),t.jsx("option",{value:"THOI_VU",children:"Thi v"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"ng BHXH"}),t.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:"dongBHXH",checked:f.dongBHXH===!0,onChange:()=>p({...f,dongBHXH:!0}),className:"w-4 h-4 text-blue-600"}),t.jsx("span",{children:"C ng"})]}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:"dongBHXH",checked:f.dongBHXH===!1,onChange:()=>p({...f,dongBHXH:!1}),className:"w-4 h-4 text-red-600"}),t.jsx("span",{children:"Khng ng"})]})]})]})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:E,className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:P,disabled:T.isPending||_.isPending,className:"btn btn-primary",children:T.isPending||_.isPending?"ang lu...":"Lu"})]})]})})]})}const iD=async e=>(await he.get(`/nhan-vien/${e}/hop-dong`)).data,lD=async(e,n)=>(await he.post(`/nhan-vien/${e}/hop-dong`,n)).data,oD=async(e,n)=>(await he.put(`/nhan-vien/hop-dong/${e}`,n)).data,cD=async(e,n)=>(await he.post(`/nhan-vien/hop-dong/${e}/ngung`,n)).data,dD=async e=>{await he.delete(`/nhan-vien/hop-dong/${e}`)},uD=async e=>(await he.get(`/nhan-vien/${e}/ngan-hang`)).data,hD=async(e,n)=>(await he.post(`/nhan-vien/${e}/ngan-hang`,n)).data,xD=async(e,n)=>(await he.put(`/nhan-vien/ngan-hang/${e}`,n)).data,mD=async e=>(await he.post(`/nhan-vien/ngan-hang/${e}/dat-mac-dinh`)).data,fD=async e=>{await he.delete(`/nhan-vien/ngan-hang/${e}`)},hw=async()=>(await he.get("/nhom-nhan-vien")).data,pD=async e=>(await he.post("/nhom-nhan-vien",e)).data,gD=async(e,n)=>(await he.put(`/nhom-nhan-vien/${e}`,n)).data,yD=async e=>{await he.delete(`/nhom-nhan-vien/${e}`)},Hb={THU_VIEC:"Th vic",MOT_NAM:"1 nm",BA_NAM:"3 nm",VO_THOI_HAN:"V thi hn"},vD={HIEU_LUC:"Hiu lc",HET_HAN:"Ht hn",HUY_BO:"Hy b"},bD=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),ND=[{value:"CHINH_THUC",label:"Chnh thc"},{value:"THU_VIEC",label:"Th vic"},{value:"HOC_VIEC",label:"Hc vic"},{value:"THUC_TAP",label:"Thc tp"},{value:"CONG_TAC_VIEN",label:"Cng tc vin"},{value:"THOI_VU",label:"Thi v"}];function jD({nhanVienId:e}){const n=Mt(),[a,r]=D.useState(!1),[s,l]=D.useState(null),[o,d]=D.useState(null),[u,x]=D.useState({loaiHopDong:"VO_THOI_HAN",tuNgay:new Date().toISOString().split("T")[0],denNgay:"",luongCoBan:0,luongDongBH:0,heSoLuong:1,loaiNhanVien:"CHINH_THUC",ghiChu:"",fileHopDong:"",filesHopDong:[]}),[m,f]=D.useState({ngayKetThuc:new Date().toISOString().split("T")[0],lyDo:""}),{data:p,isLoading:N}=Fe({queryKey:["hop-dong",e],queryFn:()=>iD(e)}),y=Ee({mutationFn:C=>lD(e,{...C,denNgay:C.denNgay||void 0}),onSuccess:()=>{ie.success("To hp ng thnh cng"),n.invalidateQueries({queryKey:["hop-dong",e]}),r(!1),T()},onError:C=>{var S,P;ie.error(((P=(S=C.response)==null?void 0:S.data)==null?void 0:P.message)||"Li to hp ng")}}),g=Ee({mutationFn:({id:C,data:S})=>oD(C,S),onSuccess:()=>{ie.success("Cp nht hp ng thnh cng"),n.invalidateQueries({queryKey:["hop-dong",e]}),l(null),T()},onError:C=>{var S,P;ie.error(((P=(S=C.response)==null?void 0:S.data)==null?void 0:P.message)||"Li cp nht")}}),b=Ee({mutationFn:({id:C,data:S})=>cD(C,S),onSuccess:()=>{ie.success(" ngng hp ng"),n.invalidateQueries({queryKey:["hop-dong",e]}),d(null)},onError:C=>{var S,P;ie.error(((P=(S=C.response)==null?void 0:S.data)==null?void 0:P.message)||"Li ngng hp ng")}}),j=Ee({mutationFn:dD,onSuccess:()=>{ie.success(" xa hp ng"),n.invalidateQueries({queryKey:["hop-dong",e]})},onError:C=>{var S,P;ie.error(((P=(S=C.response)==null?void 0:S.data)==null?void 0:P.message)||"Li xa")}}),T=()=>{x({loaiHopDong:"VO_THOI_HAN",tuNgay:new Date().toISOString().split("T")[0],denNgay:"",luongCoBan:0,luongDongBH:0,heSoLuong:1,loaiNhanVien:"CHINH_THUC",ghiChu:"",fileHopDong:"",filesHopDong:[]})},_=C=>{var S;x({loaiHopDong:C.loaiHopDong,tuNgay:C.tuNgay.split("T")[0],denNgay:((S=C.denNgay)==null?void 0:S.split("T")[0])||"",luongCoBan:Number(C.luongCoBan),luongDongBH:Number(C.luongDongBH||0),heSoLuong:Number(C.heSoLuong||1),loaiNhanVien:C.loaiNhanVien||"CHINH_THUC",ghiChu:C.ghiChu||"",fileHopDong:C.fileHopDong||"",filesHopDong:C.filesHopDong||[]}),l(C.id),r(!0)},w=C=>{C.preventDefault(),s?g.mutate({id:s,data:u}):y.mutate(u)},E=C=>{C.preventDefault(),o&&b.mutate({id:o,data:m})};return N?t.jsx("div",{className:"p-4 text-center",children:"ang ti..."}):t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Lch s Hp ng / Lng"}),t.jsxs("button",{onClick:()=>{r(!0),l(null),T()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[t.jsx("span",{children:"+"})," Thm hp ng"]})]}),a&&t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[t.jsx("h4",{className:"font-medium mb-3",children:s?"Sa hp ng":"To hp ng mi"}),t.jsxs("form",{onSubmit:w,className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi hp ng"}),t.jsx("select",{value:u.loaiHopDong,onChange:C=>x({...u,loaiHopDong:C.target.value}),className:"w-full border rounded-lg px-3 py-2",children:Object.entries(Hb).map(([C,S])=>t.jsx("option",{value:C,children:S},C))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi nhn vin"}),t.jsx("select",{value:u.loaiNhanVien,onChange:C=>x({...u,loaiNhanVien:C.target.value}),className:"w-full border rounded-lg px-3 py-2",children:ND.map(C=>t.jsx("option",{value:C.value,children:C.label},C.value))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lng c bn"}),t.jsx("input",{type:"number",value:u.luongCoBan,onChange:C=>x({...u,luongCoBan:Number(C.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0,required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy vo lm / T ngy"}),t.jsx(Gt,{value:u.tuNgay,onChange:C=>x({...u,tuNgay:C}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"n ngy ( trng nu v thi hn)"}),t.jsx(Gt,{value:u.denNgay,onChange:C=>x({...u,denNgay:C}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lng ng BH"}),t.jsx("input",{type:"number",value:u.luongDongBH,onChange:C=>x({...u,luongDongBH:Number(C.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"H s lng"}),t.jsx("input",{type:"number",step:"0.01",value:u.heSoLuong,onChange:C=>x({...u,heSoLuong:Number(C.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0})]}),t.jsxs("div",{className:"col-span-2 border-t pt-4 mt-2",children:[t.jsxs("label",{className:"block text-sm font-medium mb-2",children:[t.jsx(Zr,{size:16,className:"inline mr-1"}),"File hp ng scan (hnh nh hoc PDF)"]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("input",{type:"text",value:u.fileHopDong,onChange:C=>x({...u,fileHopDong:C.target.value}),className:"w-full border rounded-lg px-3 py-2 text-sm",placeholder:"Nhp URL file hp ng (hnh hoc PDF)"}),u.fileHopDong&&t.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white rounded border",children:[u.fileHopDong.match(/\.(jpg|jpeg|png|gif|webp)$/i)?t.jsx(Ad,{size:16,className:"text-blue-500"}):t.jsx(wn,{size:16,className:"text-red-500"}),t.jsx("a",{href:u.fileHopDong,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline truncate flex-1",children:u.fileHopDong.split("/").pop()}),t.jsx("button",{type:"button",onClick:()=>x({...u,fileHopDong:""}),className:"text-gray-400 hover:text-red-500",children:t.jsx(rn,{size:14})})]}),t.jsxs("div",{className:"mt-2",children:[t.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Thm file khc (ty chn)"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",id:"newFileUrl",className:"flex-1 border rounded-lg px-3 py-2 text-sm",placeholder:"URL file b sung"}),t.jsx("button",{type:"button",onClick:()=>{const C=document.getElementById("newFileUrl");C.value&&(x({...u,filesHopDong:[...u.filesHopDong,C.value]}),C.value="")},className:"px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 text-sm",children:"Thm"})]}),u.filesHopDong.length>0&&t.jsx("div",{className:"mt-2 space-y-1",children:u.filesHopDong.map((C,S)=>t.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white rounded border text-sm",children:[C.match(/\.(jpg|jpeg|png|gif|webp)$/i)?t.jsx(Ad,{size:14,className:"text-blue-500"}):t.jsx(wn,{size:14,className:"text-red-500"}),t.jsx("a",{href:C,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline truncate flex-1",children:C.split("/").pop()}),t.jsx("button",{type:"button",onClick:()=>x({...u,filesHopDong:u.filesHopDong.filter((P,F)=>F!==S)}),className:"text-gray-400 hover:text-red-500",children:t.jsx(rn,{size:14})})]},S))})]})]})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ghi ch"}),t.jsx("textarea",{value:u.ghiChu,onChange:C=>x({...u,ghiChu:C.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),t.jsxs("div",{className:"col-span-2 flex gap-2",children:[t.jsx("button",{type:"submit",disabled:y.isPending||g.isPending,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:s?"Cp nht":"To mi"}),t.jsx("button",{type:"button",onClick:()=>{r(!1),l(null)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Hy"})]})]})]}),o&&t.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[t.jsx("h4",{className:"font-medium mb-3 text-yellow-800",children:"Ngng hp ng sm"}),t.jsxs("form",{onSubmit:E,className:"flex gap-4 items-end",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy kt thc"}),t.jsx(Gt,{value:m.ngayKetThuc,onChange:C=>f({...m,ngayKetThuc:C}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"L do"}),t.jsx("input",{type:"text",value:m.lyDo,onChange:C=>f({...m,lyDo:C.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp l do..."})]}),t.jsx("button",{type:"submit",disabled:b.isPending,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:opacity-50",children:"Xc nhn"}),t.jsx("button",{type:"button",onClick:()=>d(null),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Hy"})]})]}),t.jsx("div",{className:"relative",children:(p==null?void 0:p.length)===0?t.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:"Cha c hp ng no"}):t.jsx("div",{className:"space-y-4",children:p==null?void 0:p.map((C,S)=>{var P,F,B;return t.jsxs("div",{className:`relative pl-8 pb-4 ${S<((p==null?void 0:p.length)||0)-1?"border-l-2 border-gray-200":""}`,children:[t.jsx("div",{className:`absolute left-[-5px] w-3 h-3 rounded-full ${C.trangThai==="HIEU_LUC"?"bg-green-500":"bg-gray-400"}`}),t.jsxs("div",{className:`bg-white rounded-lg shadow p-4 ${C.trangThai==="HIEU_LUC"?"border-l-4 border-green-500":""}`,children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[t.jsx("span",{className:"font-semibold",children:Hb[C.loaiHopDong]}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${C.trangThai==="HIEU_LUC"?"bg-green-100 text-green-800":C.trangThai==="HET_HAN"?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"}`,children:vD[C.trangThai]}),C.loaiNhanVien&&t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${((P=w0[C.loaiNhanVien])==null?void 0:P.color)||"bg-gray-100"}`,children:((F=w0[C.loaiNhanVien])==null?void 0:F.label)||C.loaiNhanVien})]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[new Date(C.tuNgay).toLocaleDateString("vi-VN"),"  ",C.denNgay?new Date(C.denNgay).toLocaleDateString("vi-VN"):"V thi hn"]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-lg font-bold text-blue-600",children:bD(Number(C.luongCoBan))}),C.heSoLuong&&t.jsxs("div",{className:"text-xs text-gray-500",children:["H s: ",C.heSoLuong]})]})]}),C.ghiChu&&t.jsx("div",{className:"text-sm text-gray-500 mt-2 italic",children:C.ghiChu}),(C.fileHopDong||C.filesHopDong&&C.filesHopDong.length>0)&&t.jsxs("div",{className:"mt-3 pt-3 border-t",children:[t.jsxs("div",{className:"text-xs text-gray-500 mb-1 flex items-center gap-1",children:[t.jsx(wn,{size:12})," File nh km:"]}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[C.fileHopDong&&t.jsxs("a",{href:C.fileHopDong,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-600 rounded text-xs hover:bg-blue-100",children:[C.fileHopDong.match(/\.(jpg|jpeg|png|gif|webp)$/i)?t.jsx(Ad,{size:12}):t.jsx(wn,{size:12}),"File chnh"]}),(B=C.filesHopDong)==null?void 0:B.map((O,M)=>t.jsxs("a",{href:O,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 px-2 py-1 bg-gray-50 text-gray-600 rounded text-xs hover:bg-gray-100",children:[O.match(/\.(jpg|jpeg|png|gif|webp)$/i)?t.jsx(Ad,{size:12}):t.jsx(wn,{size:12}),"File ",M+2]},M))]})]}),t.jsxs("div",{className:"flex gap-2 mt-3",children:[t.jsx("button",{onClick:()=>_(C),className:"text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100",children:"Sa"}),C.trangThai==="HIEU_LUC"&&t.jsx("button",{onClick:()=>d(C.id),className:"text-xs px-2 py-1 bg-yellow-50 text-yellow-600 rounded hover:bg-yellow-100",children:"Ngng sm"}),t.jsx("button",{onClick:()=>{confirm("Xc nhn xa hp ng ny?")&&j.mutate(C.id)},className:"text-xs px-2 py-1 bg-red-50 text-red-600 rounded hover:bg-red-100",children:"Xa"})]})]})]},C.id)})})})]})}const Vb=[{code:"VCB",name:"Vietcombank"},{code:"TCB",name:"Techcombank"},{code:"BIDV",name:"BIDV"},{code:"VTB",name:"Vietinbank"},{code:"ACB",name:"ACB"},{code:"MBB",name:"MB Bank"},{code:"VPB",name:"VPBank"},{code:"TPB",name:"TPBank"},{code:"STB",name:"Sacombank"},{code:"SHB",name:"SHB"},{code:"MSB",name:"MSB"},{code:"OCB",name:"OCB"},{code:"HDB",name:"HDBank"},{code:"SCB",name:"SCB"},{code:"EIB",name:"Eximbank"},{code:"AGRI",name:"Agribank"},{code:"KHAC",name:"Khc"}];function wD({nhanVienId:e}){const n=Mt(),[a,r]=D.useState(!1),[s,l]=D.useState(null),[o,d]=D.useState({tenNganHang:"VCB",chiNhanh:"",soTaiKhoan:"",chuTaiKhoan:"",laMacDinh:!1,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""}),{data:u,isLoading:x}=Fe({queryKey:["ngan-hang",e],queryFn:()=>uD(e)}),m=Ee({mutationFn:T=>hD(e,{...T,denNgay:T.denNgay||void 0}),onSuccess:()=>{ie.success("Thm ti khon ngn hng thnh cng"),n.invalidateQueries({queryKey:["ngan-hang",e]}),r(!1),y()},onError:T=>{var _,w;ie.error(((w=(_=T.response)==null?void 0:_.data)==null?void 0:w.message)||"Li thm ti khon")}}),f=Ee({mutationFn:({id:T,data:_})=>xD(T,_),onSuccess:()=>{ie.success("Cp nht ti khon thnh cng"),n.invalidateQueries({queryKey:["ngan-hang",e]}),l(null),r(!1),y()},onError:T=>{var _,w;ie.error(((w=(_=T.response)==null?void 0:_.data)==null?void 0:w.message)||"Li cp nht")}}),p=Ee({mutationFn:fD,onSuccess:()=>{ie.success(" xa ti khon"),n.invalidateQueries({queryKey:["ngan-hang",e]})},onError:T=>{var _,w;ie.error(((w=(_=T.response)==null?void 0:_.data)==null?void 0:w.message)||"Li xa")}}),N=Ee({mutationFn:mD,onSuccess:()=>{ie.success(" t lm mc nh"),n.invalidateQueries({queryKey:["ngan-hang",e]})},onError:T=>{var _,w;ie.error(((w=(_=T.response)==null?void 0:_.data)==null?void 0:w.message)||"Li")}}),y=()=>{d({tenNganHang:"VCB",chiNhanh:"",soTaiKhoan:"",chuTaiKhoan:"",laMacDinh:!1,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""})},g=T=>{var _,w;d({tenNganHang:T.tenNganHang,chiNhanh:T.chiNhanh||"",soTaiKhoan:T.soTaiKhoan,chuTaiKhoan:T.chuTaiKhoan,laMacDinh:T.laMacDinh,tuNgay:((_=T.tuNgay)==null?void 0:_.split("T")[0])||"",denNgay:((w=T.denNgay)==null?void 0:w.split("T")[0])||"",ghiChu:T.ghiChu||""}),l(T.id),r(!0)},b=T=>{T.preventDefault(),s?f.mutate({id:s,data:o}):m.mutate(o)},j=T=>{const _=Vb.find(w=>w.code===T);return _?_.name:T};return x?t.jsx("div",{className:"p-4 text-center",children:"ang ti..."}):t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Ti khon Ngn hng"}),t.jsxs("button",{onClick:()=>{r(!0),l(null),y()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[t.jsx("span",{children:"+"})," Thm ti khon"]})]}),a&&t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[t.jsx("h4",{className:"font-medium mb-3",children:s?"Sa ti khon":"Thm ti khon mi"}),t.jsxs("form",{onSubmit:b,className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngn hng"}),t.jsx("select",{value:o.tenNganHang,onChange:T=>d({...o,tenNganHang:T.target.value}),className:"w-full border rounded-lg px-3 py-2",children:Vb.map(T=>t.jsx("option",{value:T.code,children:T.name},T.code))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chi nhnh"}),t.jsx("input",{type:"text",value:o.chiNhanh,onChange:T=>d({...o,chiNhanh:T.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: H Ni, TP.HCM..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S ti khon *"}),t.jsx("input",{type:"text",value:o.soTaiKhoan,onChange:T=>d({...o,soTaiKhoan:T.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp s ti khon",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ch ti khon *"}),t.jsx("input",{type:"text",value:o.chuTaiKhoan,onChange:T=>d({...o,chuTaiKhoan:T.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"NGUYEN VAN A",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hiu lc t"}),t.jsx(Gt,{value:o.tuNgay,onChange:T=>d({...o,tuNgay:T}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hiu lc n"}),t.jsx(Gt,{value:o.denNgay,onChange:T=>d({...o,denNgay:T}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ghi ch"}),t.jsx("input",{type:"text",value:o.ghiChu,onChange:T=>d({...o,ghiChu:T.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ti khon nhn lng, ti khon ph..."})]}),t.jsx("div",{className:"col-span-2",children:t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:o.laMacDinh,onChange:T=>d({...o,laMacDinh:T.target.checked}),className:"w-4 h-4 rounded"}),t.jsx("span",{className:"text-sm",children:"t lm ti khon mc nh"})]})}),t.jsxs("div",{className:"col-span-2 flex gap-2",children:[t.jsx("button",{type:"submit",disabled:m.isPending||f.isPending,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:s?"Cp nht":"Thm"}),t.jsx("button",{type:"button",onClick:()=>{r(!1),l(null)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Hy"})]})]})]}),t.jsx("div",{className:"grid gap-4",children:(u==null?void 0:u.length)===0?t.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:"Cha c ti khon ngn hng no"}):u==null?void 0:u.map(T=>t.jsxs("div",{className:`bg-white rounded-lg shadow p-4 ${T.laMacDinh?"border-l-4 border-green-500":""}`,children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 font-bold text-sm",children:T.tenNganHang.slice(0,3)}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-semibold",children:j(T.tenNganHang)}),T.chiNhanh&&t.jsxs("span",{className:"text-sm text-gray-500",children:["- ",T.chiNhanh]}),T.laMacDinh&&t.jsx("span",{className:"text-xs px-2 py-0.5 bg-green-100 text-green-800 rounded-full",children:"Mc nh"})]}),t.jsx("div",{className:"text-lg font-mono text-gray-800",children:T.soTaiKhoan}),t.jsx("div",{className:"text-sm text-gray-500",children:T.chuTaiKhoan})]})]}),t.jsxs("div",{className:"flex flex-col items-end gap-2",children:[T.tuNgay&&t.jsxs("div",{className:"text-xs text-gray-400",children:[new Date(T.tuNgay).toLocaleDateString("vi-VN"),T.denNgay&&`  ${new Date(T.denNgay).toLocaleDateString("vi-VN")}`]}),t.jsxs("div",{className:"flex gap-2",children:[!T.laMacDinh&&t.jsx("button",{onClick:()=>N.mutate(T.id),className:"text-xs px-2 py-1 bg-green-50 text-green-600 rounded hover:bg-green-100",children:"t mc nh"}),t.jsx("button",{onClick:()=>g(T),className:"text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100",children:"Sa"}),t.jsx("button",{onClick:()=>{confirm("Xc nhn xa ti khon ny?")&&p.mutate(T.id)},className:"text-xs px-2 py-1 bg-red-50 text-red-600 rounded hover:bg-red-100",children:"Xa"})]})]})]}),T.ghiChu&&t.jsx("div",{className:"text-sm text-gray-500 mt-2 italic",children:T.ghiChu})]},T.id))})]})}function kD({nhanVienId:e}){const n=Mt(),[a,r]=D.useState(null),{data:s,isLoading:l}=Fe({queryKey:["nhan-vien-nhom",e],queryFn:async()=>(await he.get(`/nhan-vien/${e}/nhom`)).data}),{data:o}=Fe({queryKey:["nhom-nhan-vien"],queryFn:()=>hw()}),d=o==null?void 0:o.filter(p=>!(s!=null&&s.some(N=>N.nhom.id===p.id))),u=Ee({mutationFn:async p=>he.post(`/nhan-vien/${e}/them-vao-nhom`,{nhomId:p,tuNgay:new Date().toISOString().split("T")[0]}),onSuccess:()=>{ie.success(" thm vo nhm"),n.invalidateQueries({queryKey:["nhan-vien-nhom",e]}),r(null)},onError:p=>{var N,y;ie.error(((y=(N=p.response)==null?void 0:N.data)==null?void 0:y.message)||"Li thm vo nhm")}}),x=Ee({mutationFn:async p=>he.post(`/nhan-vien/${e}/go-khoi-nhom`,{nhomId:p,denNgay:new Date().toISOString().split("T")[0]}),onSuccess:()=>{ie.success(" g khi nhm"),n.invalidateQueries({queryKey:["nhan-vien-nhom",e]})},onError:p=>{var N,y;ie.error(((y=(N=p.response)==null?void 0:N.data)==null?void 0:y.message)||"Li g khi nhm")}}),m=()=>{a&&u.mutate(a)},f=p=>{confirm("Xc nhn g khi nhm?")&&x.mutate(p)};return l?t.jsx("div",{className:"p-4 text-center",children:"ang ti..."}):t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"flex justify-between items-center",children:t.jsx("h3",{className:"text-lg font-semibold",children:"Nhm Nhn vin"})}),d&&d.length>0&&t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[t.jsx("h4",{className:"font-medium mb-3",children:"Thm vo nhm"}),t.jsxs("div",{className:"flex gap-2 items-center",children:[t.jsxs("select",{value:a||"",onChange:p=>r(Number(p.target.value)),className:"flex-1 border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn nhm --"}),d.map(p=>t.jsxs("option",{value:p.id,children:[p.tenNhom," ",p.moTa&&`(${p.moTa})`]},p.id))]}),t.jsx("button",{onClick:m,disabled:!a,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:"Thm"})]})]}),t.jsx("div",{className:"grid gap-3",children:(s==null?void 0:s.length)===0?t.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:"Nhn vin cha thuc nhm no"}):s==null?void 0:s.map(p=>t.jsxs("div",{className:"bg-white rounded-lg shadow p-4 flex justify-between items-center",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-white font-bold",style:{backgroundColor:p.nhom.mauSac||"#6B7280"},children:p.nhom.tenNhom.charAt(0).toUpperCase()}),t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold",children:p.nhom.tenNhom}),p.nhom.moTa&&t.jsx("div",{className:"text-sm text-gray-500",children:p.nhom.moTa}),t.jsxs("div",{className:"text-xs text-gray-400",children:["T ",new Date(p.tuNgay).toLocaleDateString("vi-VN"),p.denNgay&&` n ${new Date(p.denNgay).toLocaleDateString("vi-VN")}`]})]})]}),t.jsx("button",{onClick:()=>f(p.nhom.id),className:"text-xs px-3 py-1 bg-red-50 text-red-600 rounded hover:bg-red-100",children:"G khi nhm"})]},p.id))}),t.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-sm text-gray-600",children:[t.jsx("strong",{children:"Lu :"})," Nhm nhn vin c s dng trong Rule Engine  p dng cc quy tc tnh lng cho tng nhm ring bit (VD: nhm Qun l, nhm K thut, nhm Sales...)."]})]})}const TD=({nhanVienId:e})=>{const[n,a]=D.useState(null),[r,s]=D.useState(!0),[l,o]=D.useState(!1),[d,u]=D.useState(!1),[x,m]=D.useState({mstCaNhan:"",soCmndCccd:"",ngayCap:"",noiCap:"",soNguoiPhuThuoc:0,ghiChu:""}),f=async()=>{try{s(!0);const b=(await he.get(`/nhan-vien/${e}/thue-bh`)).data;a(b),b&&m({mstCaNhan:b.mstCaNhan||"",soCmndCccd:b.soCmndCccd||"",ngayCap:b.ngayCap?b.ngayCap.split("T")[0]:"",noiCap:b.noiCap||"",soNguoiPhuThuoc:b.soNguoiPhuThuoc||0,ghiChu:b.ghiChu||""})}catch(g){console.error("Li khi ti thng tin thu/BHXH:",g)}finally{s(!1)}};D.useEffect(()=>{f()},[e]);const p=g=>{const{name:b,value:j}=g.target;m(T=>({...T,[b]:b==="soNguoiPhuThuoc"?parseInt(j)||0:j}))},N=async()=>{try{o(!0),await he.post(`/nhan-vien/${e}/thue-bh`,x),await f(),u(!1)}catch(g){console.error("Li khi lu thng tin thu/BHXH:",g),alert("C li xy ra khi lu thng tin")}finally{o(!1)}},y=()=>{m(n?{mstCaNhan:n.mstCaNhan||"",soCmndCccd:n.soCmndCccd||"",ngayCap:n.ngayCap?n.ngayCap.split("T")[0]:"",noiCap:n.noiCap||"",soNguoiPhuThuoc:n.soNguoiPhuThuoc||0,ghiChu:n.ghiChu||""}:{mstCaNhan:"",soCmndCccd:"",ngayCap:"",noiCap:"",soNguoiPhuThuoc:0,ghiChu:""}),u(!1)};return r?t.jsx("div",{className:"flex justify-center items-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Thng tin Thu & BHXH"}),d?t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:y,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:N,disabled:l,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:l?"ang lu...":"Lu"})]}):t.jsx("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:n?"Chnh sa":"Thm thng tin"})]}),t.jsxs("div",{className:"bg-white border rounded-lg p-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S CMND/CCCD"}),d?t.jsx("input",{type:"text",name:"soCmndCccd",value:x.soCmndCccd,onChange:p,placeholder:"Nhp s CMND/CCCD",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:(n==null?void 0:n.soCmndCccd)||""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy cp"}),d?t.jsx(Gt,{value:x.ngayCap,onChange:g=>m(b=>({...b,ngayCap:g})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:n!=null&&n.ngayCap?new Date(n.ngayCap).toLocaleDateString("vi-VN"):""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ni cp"}),d?t.jsx("input",{type:"text",name:"noiCap",value:x.noiCap,onChange:p,placeholder:"Nhp ni cp",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:(n==null?void 0:n.noiCap)||""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M s thu c nhn"}),d?t.jsx("input",{type:"text",name:"mstCaNhan",value:x.mstCaNhan,onChange:p,placeholder:"Nhp m s thu",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:(n==null?void 0:n.mstCaNhan)||""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S ngi ph thuc"}),d?t.jsx("input",{type:"number",name:"soNguoiPhuThuoc",min:"0",value:x.soNguoiPhuThuoc,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsxs("p",{className:"text-gray-900",children:[(n==null?void 0:n.soNguoiPhuThuoc)??0," ngi"]})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),d?t.jsx("textarea",{name:"ghiChu",value:x.ghiChu,onChange:p,rows:3,placeholder:"Nhp ghi ch (nu c)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:(n==null?void 0:n.ghiChu)||""})]})]}),t.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[t.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:" Thng tin gim tr thu TNCN"}),t.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[t.jsx("p",{children:" Gim tr bn thn: 11.000.000 /thng"}),t.jsx("p",{children:" Gim tr ngi ph thuc: 4.400.000 /ngi/thng"}),t.jsx("p",{children:t.jsxs("strong",{children:["Tng gim tr: ",(11e6+(x.soNguoiPhuThuoc||0)*44e5).toLocaleString("vi-VN")," /thng"]})})]})]})]}),n&&t.jsxs("div",{className:"text-sm text-gray-500",children:["Cp nht ln cui: ",new Date().toLocaleDateString("vi-VN")]})]})};function CD({nhanVienId:e}){var l;const{data:n,isLoading:a}=Fe({queryKey:["lich-su-phong-ban",e],queryFn:()=>ma.layLichSuPhongBan(e)});if(a)return t.jsxs("div",{className:"card animate-pulse",children:[t.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-4"}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"h-16 bg-gray-200 rounded"}),t.jsx("div",{className:"h-16 bg-gray-200 rounded"})]})]});const r=n==null?void 0:n.find(o=>!o.denNgay),s=(n==null?void 0:n.filter(o=>o.denNgay))||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"card border-l-4 border-l-green-500",children:[t.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2 text-lg",children:[t.jsx(Mr,{className:"text-green-600",size:20}),"Phng ban hin ti"]}),r?t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:t.jsx(Mr,{className:"text-green-600",size:24})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium text-gray-900 text-lg",children:((l=r.phongBan)==null?void 0:l.tenPhongBan)||"N/A"}),r.donViCon&&t.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1 mt-1",children:[t.jsx(cn,{size:14}),r.donViCon.loaiDonVi,": ",r.donViCon.tenDonVi]}),t.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1 mt-2",children:[t.jsx(At,{size:14}),"T: ",Js(r.tuNgay)]}),r.ghiChu&&t.jsx("div",{className:"text-sm text-gray-500 mt-2 italic",children:r.ghiChu})]}),t.jsx("div",{className:"px-3 py-1 rounded-full bg-green-100 text-green-700 text-sm font-medium",children:"ang lm vic"})]}):t.jsxs("div",{className:"text-center text-gray-500 py-4",children:[t.jsx(Qd,{size:40,className:"mx-auto text-gray-300 mb-2"}),t.jsx("p",{children:"Cha c thng tin phng ban"})]})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2 text-lg",children:[t.jsx(an,{className:"text-gray-600",size:20}),"Lch s chuyn phng ban",s.length>0&&t.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:[s.length," ln"]})]}),s.length>0?t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute left-6 top-0 bottom-0 w-0.5 bg-gray-200"}),t.jsx("div",{className:"space-y-4",children:s.map(o=>{var d;return t.jsxs("div",{className:"relative flex items-start gap-4 pl-2",children:[t.jsx("div",{className:"absolute left-4 w-4 h-4 bg-gray-300 rounded-full border-2 border-white z-10"}),t.jsxs("div",{className:"ml-10 flex-1 bg-gray-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:((d=o.phongBan)==null?void 0:d.tenPhongBan)||"N/A"}),o.donViCon&&t.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1 mt-1",children:[t.jsx(cn,{size:12}),o.donViCon.loaiDonVi,": ",o.donViCon.tenDonVi]})]}),t.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[t.jsx("div",{children:Js(o.tuNgay)}),t.jsxs("div",{children:[" ",Js(o.denNgay)]})]})]}),o.ghiChu&&t.jsx("div",{className:"text-sm text-gray-500 mt-2 italic",children:o.ghiChu})]})]},o.id)})})]}):t.jsxs("div",{className:"text-center text-gray-500 py-8",children:[t.jsx(an,{size:40,className:"mx-auto text-gray-300 mb-2"}),t.jsx("p",{children:"Cha c lch s chuyn phng ban"}),t.jsx("p",{className:"text-sm",children:"Nhn vin cha tng chuyn phng ban"})]})]})]})}function SD(){var le;const{id:e}=W0(),n=parseInt(e),a=Mt(),[r,s]=D.useState("thong-tin"),[l,o]=D.useState(!1),[d,u]=D.useState(null),[x,m]=D.useState(null),[f,p]=D.useState(!1),[N,y]=D.useState({hoTen:"",email:"",soDienThoai:"",phongBanId:0,chucVu:"",gioiTinh:"",ngaySinh:"",diaChi:"",soCCCD:"",hinhCCCDTruoc:"",hinhCCCDSau:"",soDienThoaiKhanCap:"",nguoiLienHeKhanCap:"",quanHeKhanCap:"",dongBHXH:!0}),[g,b]=D.useState({khoanLuongId:0,soTien:0,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""}),[j,T]=D.useState({soTienMoi:0,tuNgay:new Date().toISOString().split("T")[0],ghiChu:""}),[_,w]=D.useState({denNgay:new Date().toISOString().split("T")[0]}),{data:E,isLoading:C}=Fe({queryKey:["nhan-vien",n],queryFn:()=>ma.layTheoId(n)}),{data:S}=Fe({queryKey:["phong-ban"],queryFn:()=>Jt.layTatCa()}),{data:P,isLoading:F}=Fe({queryKey:["phu-cap",n],queryFn:()=>Xo.layTheoNhanVien(n)}),{data:B}=Fe({queryKey:["khoan-luong","THU_NHAP"],queryFn:()=>pr.layTatCa("THU_NHAP")}),O=Ee({mutationFn:q=>Xo.taoPhuCap(q),onSuccess:()=>{ie.success("Thm ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]}),o(!1),ne()},onError:q=>{var Le,ee;ie.error(((ee=(Le=q.response)==null?void 0:Le.data)==null?void 0:ee.message)||"C li xy ra")}}),M=Ee({mutationFn:({id:q,data:Le})=>Xo.tang(q,Le),onSuccess:()=>{ie.success("iu chnh ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]}),u(null)},onError:q=>{var Le,ee;ie.error(((ee=(Le=q.response)==null?void 0:Le.data)==null?void 0:ee.message)||"C li xy ra")}}),G=Ee({mutationFn:({id:q,denNgay:Le})=>Xo.ketThuc(q,Le,"Admin"),onSuccess:()=>{ie.success("Kt thc ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]}),m(null)},onError:q=>{var Le,ee;ie.error(((ee=(Le=q.response)==null?void 0:Le.data)==null?void 0:ee.message)||"C li xy ra")}}),J=Ee({mutationFn:q=>Xo.tamDung(q),onSuccess:()=>{ie.success("Tm dng ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]})}}),X=Ee({mutationFn:q=>Xo.kichHoat(q),onSuccess:()=>{ie.success("Kch hot ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]})}}),fe=Ee({mutationFn:q=>ma.capNhat(n,q),onSuccess:()=>{ie.success("Cp nht thng tin nhn vin thnh cng"),a.invalidateQueries({queryKey:["nhan-vien",n]}),p(!1)},onError:q=>{var Le,ee;ie.error(((ee=(Le=q.response)==null?void 0:Le.data)==null?void 0:ee.message)||"C li xy ra khi cp nht")}});D.useEffect(()=>{E&&y({hoTen:E.hoTen||"",email:E.email||"",soDienThoai:E.soDienThoai||"",phongBanId:E.phongBanId||0,chucVu:E.chucVu||"",gioiTinh:E.gioiTinh||"",ngaySinh:E.ngaySinh?new Date(E.ngaySinh).toISOString().split("T")[0]:"",diaChi:E.diaChi||"",soCCCD:E.soCCCD||"",hinhCCCDTruoc:E.hinhCCCDTruoc||"",hinhCCCDSau:E.hinhCCCDSau||"",soDienThoaiKhanCap:E.soDienThoaiKhanCap||"",nguoiLienHeKhanCap:E.nguoiLienHeKhanCap||"",quanHeKhanCap:E.quanHeKhanCap||"",dongBHXH:E.dongBHXH!==!1})},[E]);const ne=()=>{b({khoanLuongId:0,soTien:0,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""})},H=()=>{if(!g.khoanLuongId){ie.error("Vui lng chn khon ph cp");return}if(g.soTien<=0){ie.error("S tin phi > 0");return}O.mutate({nhanVienId:n,khoanLuongId:g.khoanLuongId,soTien:g.soTien,tuNgay:g.tuNgay,denNgay:g.denNgay||void 0,ghiChu:g.ghiChu||void 0,nguoiTao:"Admin"})},W=()=>{if(d){if(j.soTienMoi<=0){ie.error("S tin mi phi > 0");return}M.mutate({id:d.id,data:{soTienMoi:j.soTienMoi,tuNgay:j.tuNgay,ghiChu:j.ghiChu||void 0,nguoiTao:"Admin"}})}},xe=()=>{x&&G.mutate({id:x.id,denNgay:_.denNgay})},K=()=>{var q,Le,ee,ke,Ke,tt,Xe,Oe;if(!N.hoTen.trim()){ie.error("Vui lng nhp h tn");return}if(!N.phongBanId){ie.error("Vui lng chn phng ban");return}fe.mutate({hoTen:N.hoTen.trim(),email:((q=N.email)==null?void 0:q.trim())||null,soDienThoai:((Le=N.soDienThoai)==null?void 0:Le.trim())||null,phongBanId:N.phongBanId,chucVu:((ee=N.chucVu)==null?void 0:ee.trim())||null,gioiTinh:N.gioiTinh||null,ngaySinh:N.ngaySinh||null,diaChi:((ke=N.diaChi)==null?void 0:ke.trim())||null,soCCCD:((Ke=N.soCCCD)==null?void 0:Ke.trim())||null,hinhCCCDTruoc:N.hinhCCCDTruoc||null,hinhCCCDSau:N.hinhCCCDSau||null,soDienThoaiKhanCap:((tt=N.soDienThoaiKhanCap)==null?void 0:tt.trim())||null,nguoiLienHeKhanCap:((Xe=N.nguoiLienHeKhanCap)==null?void 0:Xe.trim())||null,quanHeKhanCap:((Oe=N.quanHeKhanCap)==null?void 0:Oe.trim())||null,dongBHXH:N.dongBHXH})},L=()=>{E&&y({hoTen:E.hoTen||"",email:E.email||"",soDienThoai:E.soDienThoai||"",phongBanId:E.phongBanId||0,chucVu:E.chucVu||"",gioiTinh:E.gioiTinh||"",ngaySinh:E.ngaySinh?new Date(E.ngaySinh).toISOString().split("T")[0]:"",diaChi:E.diaChi||"",soCCCD:E.soCCCD||"",hinhCCCDTruoc:E.hinhCCCDTruoc||"",hinhCCCDSau:E.hinhCCCDSau||"",soDienThoaiKhanCap:E.soDienThoaiKhanCap||"",nguoiLienHeKhanCap:E.nguoiLienHeKhanCap||"",quanHeKhanCap:E.quanHeKhanCap||"",dongBHXH:E.dongBHXH!==!1}),p(!1)},Q=(P==null?void 0:P.filter(q=>q.trangThai==="HIEU_LUC"))||[],I=(P==null?void 0:P.filter(q=>q.trangThai==="TAM_DUNG"))||[],R=(P==null?void 0:P.filter(q=>q.trangThai==="KET_THUC"))||[],te=Q.reduce((q,Le)=>q+Number(Le.soTien||0),0);if(C)return t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});if(!E)return t.jsx("div",{className:"text-center py-12 text-gray-500",children:"Khng tm thy nhn vin"});const ue=q=>{switch(q){case"HIEU_LUC":return"bg-green-100 text-green-800";case"TAM_DUNG":return"bg-yellow-100 text-yellow-800";case"KET_THUC":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},V=q=>{switch(q){case"HIEU_LUC":return"Hiu lc";case"TAM_DUNG":return"Tm dng";case"KET_THUC":return"Kt thc";default:return q}};return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[t.jsx(xa,{to:"/nhan-vien",className:"p-2 hover:bg-gray-100 rounded-lg",children:t.jsx(Y0,{size:24})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:E.hoTen}),t.jsxs("p",{className:"text-gray-500",children:[E.maNhanVien," - ",E.chucVu||"Nhn vin"]})]})]}),t.jsxs("div",{className:"flex gap-2 mb-6 border-b overflow-x-auto",children:[t.jsxs("button",{onClick:()=>s("thong-tin"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="thong-tin"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(so,{size:18,className:"inline-block mr-2"}),"Thng tin"]}),t.jsxs("button",{onClick:()=>s("hop-dong"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="hop-dong"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(wn,{size:18,className:"inline-block mr-2"}),"Hp ng / Lng"]}),t.jsxs("button",{onClick:()=>s("phu-cap"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="phu-cap"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(ig,{size:18,className:"inline-block mr-2"}),"Ph cp",Q.length>0&&t.jsx("span",{className:"ml-2 bg-primary-100 text-primary-700 px-2 py-0.5 rounded-full text-xs",children:Q.length})]}),t.jsxs("button",{onClick:()=>s("lich-su"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="lich-su"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(yu,{size:18,className:"inline-block mr-2"}),"Lch s ph cp"]}),t.jsxs("button",{onClick:()=>s("lich-su-phong-ban"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="lich-su-phong-ban"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(Mr,{size:18,className:"inline-block mr-2"}),"Lch s phng ban"]})]}),r==="thong-tin"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:[t.jsx(so,{size:20}),"Thng tin c bn"]}),f?t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:L,className:"btn btn-secondary flex items-center gap-2",disabled:fe.isPending,children:[t.jsx(rn,{size:16}),"Hy"]}),t.jsxs("button",{onClick:K,className:"btn btn-primary flex items-center gap-2",disabled:fe.isPending,children:[t.jsx(_s,{size:16}),fe.isPending?"ang lu...":"Lu"]})]}):t.jsxs("button",{onClick:()=>p(!0),className:"btn btn-secondary flex items-center gap-2",children:[t.jsx(R_,{size:16}),"Chnh sa"]})]}),f?t.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"M nhn vin"}),t.jsx("p",{className:"font-medium text-gray-400",children:E.maNhanVien}),t.jsx("span",{className:"text-xs text-gray-400",children:"(Khng th sa)"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"H tn *"}),t.jsx("input",{type:"text",value:N.hoTen,onChange:q=>y({...N,hoTen:q.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp h tn"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phng ban *"}),t.jsxs("select",{value:N.phongBanId,onChange:q=>y({...N,phongBanId:parseInt(q.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn phng ban --"}),S==null?void 0:S.map(q=>t.jsx("option",{value:q.id,children:q.tenPhongBan},q.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chc v"}),t.jsx("input",{type:"text",value:N.chucVu,onChange:q=>y({...N,chucVu:q.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp chc v"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gii tnh"}),t.jsxs("select",{value:N.gioiTinh,onChange:q=>y({...N,gioiTinh:q.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn gii tnh --"}),t.jsx("option",{value:"NAM",children:"Nam"}),t.jsx("option",{value:"NU",children:"N"}),t.jsx("option",{value:"KHAC",children:"Khc"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy sinh"}),t.jsx(Gt,{value:N.ngaySinh,onChange:q=>y({...N,ngaySinh:q}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),t.jsx("input",{type:"email",value:N.email,onChange:q=>y({...N,email:q.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp email"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S in thoi"}),t.jsx("input",{type:"tel",value:N.soDienThoai,onChange:q=>y({...N,soDienThoai:q.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp s in thoi"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"a ch"}),t.jsx("input",{type:"text",value:N.diaChi,onChange:q=>y({...N,diaChi:q.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp a ch"})]}),t.jsxs("div",{className:"col-span-2 border-t pt-4 mt-2",children:[t.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Cn cc cng dn"}),t.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S CCCD/CMND"}),t.jsx("input",{type:"text",value:N.soCCCD,onChange:q=>y({...N,soCCCD:q.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp s CCCD"})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hnh CCCD mt trc"}),t.jsx("input",{type:"text",value:N.hinhCCCDTruoc,onChange:q=>y({...N,hinhCCCDTruoc:q.target.value}),className:"w-full border rounded-lg px-3 py-2 text-sm",placeholder:"URL hnh hoc upload"}),N.hinhCCCDTruoc&&t.jsx("img",{src:N.hinhCCCDTruoc,alt:"Preview",className:"mt-2 w-24 h-16 object-cover rounded border"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hnh CCCD mt sau"}),t.jsx("input",{type:"text",value:N.hinhCCCDSau,onChange:q=>y({...N,hinhCCCDSau:q.target.value}),className:"w-full border rounded-lg px-3 py-2 text-sm",placeholder:"URL hnh hoc upload"}),N.hinhCCCDSau&&t.jsx("img",{src:N.hinhCCCDSau,alt:"Preview",className:"mt-2 w-24 h-16 object-cover rounded border"})]})]})]})]}),t.jsxs("div",{className:"col-span-2 border-t pt-4 mt-2",children:[t.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Lin h khn cp (ngi thn)"}),t.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngi lin h"}),t.jsx("input",{type:"text",value:N.nguoiLienHeKhanCap,onChange:q=>y({...N,nguoiLienHeKhanCap:q.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Tn ngi thn"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Quan h"}),t.jsxs("select",{value:N.quanHeKhanCap,onChange:q=>y({...N,quanHeKhanCap:q.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn --"}),t.jsx("option",{value:"Cha",children:"Cha"}),t.jsx("option",{value:"M",children:"M"}),t.jsx("option",{value:"V",children:"V"}),t.jsx("option",{value:"Chng",children:"Chng"}),t.jsx("option",{value:"Anh/Ch/Em",children:"Anh/Ch/Em"}),t.jsx("option",{value:"Con",children:"Con"}),t.jsx("option",{value:"Khc",children:"Khc"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S in thoi"}),t.jsx("input",{type:"tel",value:N.soDienThoaiKhanCap,onChange:q=>y({...N,soDienThoaiKhanCap:q.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"ST khn cp"})]})]})]}),t.jsx("div",{className:"col-span-2 border-t pt-4 mt-2",children:t.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"ng BHXH"}),t.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:"editDongBHXH",checked:N.dongBHXH===!0,onChange:()=>y({...N,dongBHXH:!0}),className:"w-4 h-4 text-blue-600"}),t.jsx("span",{children:"C ng"})]}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:"editDongBHXH",checked:N.dongBHXH===!1,onChange:()=>y({...N,dongBHXH:!1}),className:"w-4 h-4 text-red-600"}),t.jsx("span",{children:"Khng ng"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Tng ph cp hin ti"}),t.jsx("p",{className:"font-medium text-green-600",children:Ze(te)}),t.jsx("span",{className:"text-xs text-gray-400",children:"(T ng tnh t cc khon ph cp)"})]})]})})]}):t.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"M nhn vin"}),t.jsx("p",{className:"font-medium",children:E.maNhanVien})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"H tn"}),t.jsx("p",{className:"font-medium",children:E.hoTen})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Phng ban"}),t.jsx("p",{className:"font-medium",children:(le=E.phongBan)==null?void 0:le.tenPhongBan})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Chc v"}),t.jsx("p",{className:"font-medium",children:E.chucVu||"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Gii tnh"}),t.jsx("p",{className:"font-medium",children:E.gioiTinh==="NAM"?"Nam":E.gioiTinh==="NU"?"N":E.gioiTinh==="KHAC"?"Khc":"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Ngy sinh"}),t.jsx("p",{className:"font-medium",children:E.ngaySinh?Js(E.ngaySinh):"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Email"}),t.jsx("p",{className:"font-medium",children:E.email||"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"S in thoi"}),t.jsx("p",{className:"font-medium",children:E.soDienThoai||"-"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"a ch"}),t.jsx("p",{className:"font-medium",children:E.diaChi||"-"})]}),t.jsxs("div",{className:"col-span-2 border-t pt-4 mt-2",children:[t.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Cn cc cng dn"}),t.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"S CCCD/CMND"}),t.jsx("p",{className:"font-medium",children:E.soCCCD||"-"})]}),t.jsxs("div",{className:"flex gap-4",children:[E.hinhCCCDTruoc&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500 mb-1",children:"Mt trc"}),t.jsx("img",{src:E.hinhCCCDTruoc,alt:"CCCD mt trc",className:"w-32 h-20 object-cover rounded border"})]}),E.hinhCCCDSau&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500 mb-1",children:"Mt sau"}),t.jsx("img",{src:E.hinhCCCDSau,alt:"CCCD mt sau",className:"w-32 h-20 object-cover rounded border"})]}),!E.hinhCCCDTruoc&&!E.hinhCCCDSau&&t.jsx("p",{className:"text-gray-400 text-sm",children:"Cha c hnh CCCD"})]})]})]}),t.jsxs("div",{className:"col-span-2 border-t pt-4 mt-2",children:[t.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Lin h khn cp (ngi thn)"}),t.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Ngi lin h"}),t.jsx("p",{className:"font-medium",children:E.nguoiLienHeKhanCap||"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Quan h"}),t.jsx("p",{className:"font-medium",children:E.quanHeKhanCap||"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"S in thoi"}),t.jsx("p",{className:"font-medium",children:E.soDienThoaiKhanCap||"-"})]})]})]}),t.jsx("div",{className:"col-span-2 border-t pt-4 mt-2",children:t.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"ng BHXH"}),E.dongBHXH!==!1?t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700",children:"C ng"}):t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-700",children:"Khng ng"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Tng ph cp hin ti"}),t.jsx("p",{className:"font-medium text-green-600",children:Ze(te)})]})]})})]})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[t.jsx(Mr,{size:20}),"Ti khon ngn hng"]}),t.jsx(wD,{nhanVienId:n})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[t.jsx(wn,{size:20}),"Thng tin Thu & BHXH"]}),t.jsx(TD,{nhanVienId:n})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[t.jsx(cn,{size:20}),"Nhm nhn vin"]}),t.jsx(kD,{nhanVienId:n})]})]}),r==="hop-dong"&&t.jsx("div",{className:"card",children:t.jsx(jD,{nhanVienId:n})}),r==="phu-cap"&&t.jsxs("div",{children:[t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"card bg-green-50",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Ph cp hiu lc"}),t.jsx("p",{className:"text-2xl font-bold text-green-600",children:Q.length}),t.jsxs("p",{className:"text-sm text-green-600",children:[Ze(te),"/thng"]})]}),t.jsxs("div",{className:"card bg-yellow-50",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Tm dng"}),t.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:I.length})]}),t.jsxs("div",{className:"card bg-gray-50",children:[t.jsx("p",{className:"text-sm text-gray-600",children:" kt thc"}),t.jsx("p",{className:"text-2xl font-bold text-gray-600",children:R.length})]})]}),t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h3",{className:"font-semibold text-lg",children:"Danh sch ph cp"}),t.jsxs("button",{onClick:()=>o(!0),className:"btn btn-primary",children:[t.jsx(Dt,{size:20}),"Thm ph cp"]})]}),Q.length>0&&t.jsxs("div",{className:"card mb-4",children:[t.jsxs("h4",{className:"font-medium text-green-700 mb-3 flex items-center gap-2",children:[t.jsx("span",{className:"w-3 h-3 bg-green-500 rounded-full"}),"ang hiu lc (",Q.length,")"]}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Khon ph cp"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"T ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"n ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Ghi ch"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Thao tc"})]})}),t.jsx("tbody",{children:Q.map(q=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3 font-medium",children:q.khoanLuong.tenKhoan}),t.jsx("td",{className:"py-2 px-3 text-right font-semibold text-primary-600",children:Ze(q.soTien)}),t.jsx("td",{className:"py-2 px-3",children:Js(q.tuNgay)}),t.jsx("td",{className:"py-2 px-3",children:q.denNgay?Js(q.denNgay):"Khng xc nh"}),t.jsx("td",{className:"py-2 px-3 text-gray-500 text-sm",children:q.ghiChu||"-"}),t.jsx("td",{className:"py-2 px-3",children:t.jsxs("div",{className:"flex justify-center gap-1",children:[t.jsx("button",{onClick:()=>{u(q),T({soTienMoi:q.soTien,tuNgay:new Date().toISOString().split("T")[0],ghiChu:""})},className:"p-1 hover:bg-blue-100 rounded text-blue-600",title:"iu chnh",children:t.jsx(oi,{size:18})}),t.jsx("button",{onClick:()=>J.mutate(q.id),className:"p-1 hover:bg-yellow-100 rounded text-yellow-600",title:"Tm dng",children:t.jsx(M_,{size:18})}),t.jsx("button",{onClick:()=>{m(q),w({denNgay:new Date().toISOString().split("T")[0]})},className:"p-1 hover:bg-red-100 rounded text-red-600",title:"Kt thc",children:t.jsx(At,{size:18})})]})})]},q.id))})]})]}),I.length>0&&t.jsxs("div",{className:"card mb-4",children:[t.jsxs("h4",{className:"font-medium text-yellow-700 mb-3 flex items-center gap-2",children:[t.jsx("span",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),"Tm dng (",I.length,")"]}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Khon ph cp"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Trng thi"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Thao tc"})]})}),t.jsx("tbody",{children:I.map(q=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3",children:q.khoanLuong.tenKhoan}),t.jsx("td",{className:"py-2 px-3 text-right",children:Ze(q.soTien)}),t.jsx("td",{className:"py-2 px-3",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${ue(q.trangThai)}`,children:V(q.trangThai)})}),t.jsx("td",{className:"py-2 px-3 text-center",children:t.jsx("button",{onClick:()=>X.mutate(q.id),className:"p-1 hover:bg-green-100 rounded text-green-600",title:"Kch hot li",children:t.jsx(xp,{size:18})})})]},q.id))})]})]}),F?t.jsx("div",{className:"text-center py-8",children:"ang ti..."}):(P==null?void 0:P.length)===0?t.jsxs("div",{className:"card text-center py-8 text-gray-500",children:[t.jsx(di,{size:48,className:"mx-auto mb-4 text-gray-300"}),t.jsx("p",{children:"Nhn vin cha c ph cp no"}),t.jsxs("button",{onClick:()=>o(!0),className:"btn btn-primary mt-4",children:[t.jsx(Dt,{size:20}),"Thm ph cp u tin"]})]}):null]}),r==="lich-su"&&t.jsxs("div",{className:"card",children:[t.jsx("h3",{className:"font-semibold mb-4",children:"Lch s thay i ph cp"}),P&&P.length>0?t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Khon ph cp"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"T ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"n ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Trng thi"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Ghi ch"})]})}),t.jsx("tbody",{children:P.map(q=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3",children:q.khoanLuong.tenKhoan}),t.jsx("td",{className:"py-2 px-3 text-right font-medium",children:Ze(q.soTien)}),t.jsx("td",{className:"py-2 px-3",children:Js(q.tuNgay)}),t.jsx("td",{className:"py-2 px-3",children:q.denNgay?Js(q.denNgay):"-"}),t.jsx("td",{className:"py-2 px-3",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${ue(q.trangThai)}`,children:V(q.trangThai)})}),t.jsx("td",{className:"py-2 px-3 text-gray-500 text-sm",children:q.ghiChu||"-"})]},q.id))})]}):t.jsx("p",{className:"text-gray-500 text-center py-8",children:"Cha c d liu lch s"})]}),r==="lich-su-phong-ban"&&t.jsx(CD,{nhanVienId:n}),l&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm ph cp mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Khon ph cp *"}),t.jsxs("select",{value:g.khoanLuongId,onChange:q=>b({...g,khoanLuongId:Number(q.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn khon ph cp --"}),B==null?void 0:B.map(q=>t.jsx("option",{value:q.id,children:q.tenKhoan},q.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S tin *"}),t.jsx("input",{type:"number",value:g.soTien,onChange:q=>b({...g,soTien:Number(q.target.value)}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: 500000"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy bt u *"}),t.jsx(Gt,{value:g.tuNgay,onChange:q=>b({...g,tuNgay:q}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy kt thc (ty chn)"}),t.jsx(Gt,{value:g.denNgay,onChange:q=>b({...g,denNgay:q}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ghi ch"}),t.jsx("textarea",{value:g.ghiChu,onChange:q=>b({...g,ghiChu:q.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[t.jsx("button",{onClick:()=>o(!1),className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:H,disabled:O.isPending,className:"btn btn-primary",children:O.isPending?"ang lu...":"Thm ph cp"})]})]})}),d&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"iu chnh ph cp"}),t.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg mb-4",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Khon ph cp"}),t.jsx("p",{className:"font-medium",children:d.khoanLuong.tenKhoan}),t.jsxs("p",{className:"text-sm text-gray-500",children:["Hin ti: ",Ze(d.soTien)]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S tin mi *"}),t.jsx("input",{type:"number",value:j.soTienMoi,onChange:q=>T({...j,soTienMoi:Number(q.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy hiu lc mi *"}),t.jsx(Gt,{value:j.tuNgay,onChange:q=>T({...j,tuNgay:q}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"L do iu chnh"}),t.jsx("textarea",{value:j.ghiChu,onChange:q=>T({...j,ghiChu:q.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[t.jsx("button",{onClick:()=>u(null),className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:W,disabled:M.isPending,className:"btn btn-primary",children:M.isPending?"ang lu...":"iu chnh"})]})]})}),x&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Kt thc ph cp"}),t.jsxs("div",{className:"bg-red-50 p-3 rounded-lg mb-4",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Khon ph cp"}),t.jsx("p",{className:"font-medium",children:x.khoanLuong.tenKhoan}),t.jsxs("p",{className:"text-sm text-red-600",children:["S tin: ",Ze(x.soTien)]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy kt thc *"}),t.jsx(Gt,{value:_.denNgay,onChange:q=>w({denNgay:q}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[t.jsx("button",{onClick:()=>m(null),className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:xe,disabled:G.isPending,className:"btn btn-danger",children:G.isPending?"ang lu...":"Kt thc"})]})]})})]})}function _D(){const e=Mt(),[n,a]=D.useState(!1),[r,s]=D.useState(null),[l,o]=D.useState({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",chiuThue:!1,moTa:""}),{data:d,isLoading:u}=Fe({queryKey:["khoan-luong"],queryFn:()=>pr.layTatCa()}),x=Ee({mutationFn:pr.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["khoan-luong"]}),ie.success("To khon lng thnh cng!"),p()},onError:T=>{var _,w;ie.error(((w=(_=T.response)==null?void 0:_.data)==null?void 0:w.message)||"C li xy ra")}}),m=Ee({mutationFn:({id:T,data:_})=>pr.capNhat(T,_),onSuccess:()=>{e.invalidateQueries({queryKey:["khoan-luong"]}),ie.success("Cp nht thnh cng!"),p()},onError:T=>{var _,w;ie.error(((w=(_=T.response)==null?void 0:_.data)==null?void 0:w.message)||"C li xy ra")}}),f=Ee({mutationFn:pr.xoa,onSuccess:()=>{e.invalidateQueries({queryKey:["khoan-luong"]}),ie.success("Xa khon lng thnh cng!")},onError:T=>{var _,w;ie.error(((w=(_=T.response)==null?void 0:_.data)==null?void 0:w.message)||"C li xy ra")}}),p=()=>{a(!1),s(null),o({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",chiuThue:!1,moTa:""})},N=T=>{s(T),o({maKhoan:T.maKhoan,tenKhoan:T.tenKhoan,loai:T.loai,chiuThue:T.chiuThue,moTa:T.moTa||""}),a(!0)},y=()=>{if(!l.maKhoan||!l.tenKhoan){ie.error("Vui lng in y  thng tin bt buc");return}r?m.mutate({id:r.id,data:l}):x.mutate(l)},g=T=>{confirm(`Bn c chc mun xa khon lng "${T.tenKhoan}"?`)&&f.mutate(T.id)},b=(d==null?void 0:d.filter(T=>T.loai==="THU_NHAP"))||[],j=(d==null?void 0:d.filter(T=>T.loai==="KHAU_TRU"))||[];return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[t.jsx(gr,{size:28}),"Qun l Khon lng"]}),t.jsxs("button",{onClick:()=>a(!0),className:"btn btn-primary",children:[t.jsx(Dt,{size:20}),"Thm khon lng"]})]}),u?t.jsx("p",{className:"text-center py-8 text-gray-500",children:"ang ti..."}):t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"card",children:[t.jsxs("h2",{className:"text-lg font-semibold text-green-700 mb-4 flex items-center gap-2",children:[t.jsx("span",{className:"w-3 h-3 bg-green-500 rounded-full"}),"Cc khon Thu nhp (",b.length,")"]}),t.jsxs("div",{className:"space-y-2",children:[b.map(T=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(rl,{size:16,className:"text-gray-400 cursor-grab"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:T.tenKhoan}),t.jsxs("p",{className:"text-xs text-gray-500",children:[T.maKhoan,T.chiuThue&&t.jsx("span",{className:"ml-2 px-1.5 py-0.5 bg-orange-100 text-orange-700 rounded",children:"Chu thu"})]})]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:()=>N(T),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-lg",children:t.jsx(Za,{size:16})}),t.jsx("button",{onClick:()=>g(T),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg",children:t.jsx(er,{size:16})})]})]},T.id)),b.length===0&&t.jsx("p",{className:"text-gray-500 text-center py-4",children:"Cha c khon thu nhp"})]})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h2",{className:"text-lg font-semibold text-red-700 mb-4 flex items-center gap-2",children:[t.jsx("span",{className:"w-3 h-3 bg-red-500 rounded-full"}),"Cc khon Khu tr (",j.length,")"]}),t.jsxs("div",{className:"space-y-2",children:[j.map(T=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(rl,{size:16,className:"text-gray-400 cursor-grab"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:T.tenKhoan}),t.jsx("p",{className:"text-xs text-gray-500",children:T.maKhoan})]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:()=>N(T),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-lg",children:t.jsx(Za,{size:16})}),t.jsx("button",{onClick:()=>g(T),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg",children:t.jsx(er,{size:16})})]})]},T.id)),j.length===0&&t.jsx("p",{className:"text-gray-500 text-center py-4",children:"Cha c khon khu tr (BHXH, thu s thm  y)"})]})]})]}),n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:r?"Sa khon lng":"Thm khon lng mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M khon *"}),t.jsx("input",{type:"text",value:l.maKhoan,onChange:T=>o({...l,maKhoan:T.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: PHU_CAP_XE",disabled:!!r})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tn khon *"}),t.jsx("input",{type:"text",value:l.tenKhoan,onChange:T=>o({...l,tenKhoan:T.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ph cp xe"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi"}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"radio",name:"loai",checked:l.loai==="THU_NHAP",onChange:()=>o({...l,loai:"THU_NHAP"})}),t.jsx("span",{className:"text-green-700",children:"Thu nhp (+)"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"radio",name:"loai",checked:l.loai==="KHAU_TRU",onChange:()=>o({...l,loai:"KHAU_TRU"})}),t.jsx("span",{className:"text-red-700",children:"Khu tr (-)"})]})]})]}),t.jsx("div",{children:t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:l.chiuThue,onChange:T=>o({...l,chiuThue:T.target.checked})}),t.jsx("span",{className:"text-sm",children:"Khon ny chu thu TNCN"})]})}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M t"}),t.jsx("textarea",{value:l.moTa,onChange:T=>o({...l,moTa:T.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:p,className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:y,disabled:x.isPending||m.isPending,className:"btn btn-primary",children:x.isPending||m.isPending?"ang lu...":"Lu"})]})]})})]})}function ED(){const e=Mt(),n=D.useRef(null),[a,r]=D.useState("upload"),[s,l]=D.useState(null),[o,d]=D.useState([]),[u,x]=D.useState([]),[m,f]=D.useState([]),[p,N]=D.useState(new Date().getMonth()+1),[y,g]=D.useState(new Date().getFullYear()),[b,j]=D.useState(0),[T,_]=D.useState(null),{data:w}=Fe({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),{data:E}=Fe({queryKey:["khoan-luong"],queryFn:()=>pr.layTatCa()}),C=Ee({mutationFn:G=>m0.docHeader(G),onSuccess:G=>{d(G.headers),x(G.duLieuMau),S.mutate(s)},onError:()=>{ie.error("Khng th c file Excel")}}),S=Ee({mutationFn:G=>m0.goiYMapping(G),onSuccess:G=>{f(G),r("mapping")}}),P=Ee({mutationFn:()=>m0.import(s,p,y,b,m),onSuccess:G=>{_(G),r("result"),e.invalidateQueries({queryKey:["bang-luong"]}),G.thanhCong?ie.success("Import thnh cng!"):ie.error(`Import c ${G.dongLoi} dng li`)},onError:G=>{var J,X;ie.error(((X=(J=G.response)==null?void 0:J.data)==null?void 0:X.message)||"C li khi import")}}),F=G=>{var X;const J=(X=G.target.files)==null?void 0:X[0];if(J){if(!J.name.endsWith(".xlsx")&&!J.name.endsWith(".xls")){ie.error("Vui lng chn file Excel (.xlsx hoc .xls)");return}l(J),C.mutate(J)}},B=(G,J,X)=>{const fe=[...m];fe[G]={...fe[G],[J]:X},f(fe)},O=()=>{if(!b){ie.error("Vui lng chn phng ban");return}if(!m.some(J=>J.loaiMapping==="thong_tin"&&J.truongHeThong==="ma_nhan_vien")){ie.error("Cn mapping ct M nhn vin");return}P.mutate()},M=()=>{r("upload"),l(null),d([]),x([]),f([]),_(null),n.current&&(n.current.value="")};return t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2 mb-6",children:[t.jsx(Zr,{size:28}),"Import t Excel"]}),t.jsx("div",{className:"flex items-center gap-4 mb-8",children:["Upload file","Mapping ct","Kt qu"].map((G,J)=>{const X=["upload","mapping","result"],fe=a===X[J],ne=X.indexOf(a)>J;return t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:`
                  w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold
                  ${fe?"bg-primary-600 text-white":""}
                  ${ne?"bg-green-500 text-white":""}
                  ${!fe&&!ne?"bg-gray-200 text-gray-500":""}
                `,children:ne?"":J+1}),t.jsx("span",{className:fe?"font-semibold":"text-gray-500",children:G}),J<2&&t.jsx(g_,{size:16,className:"text-gray-400 ml-2"})]},G)})}),a==="upload"&&t.jsx("div",{className:"card",children:t.jsxs("div",{className:"text-center py-12",children:[t.jsx(ei,{size:64,className:"mx-auto text-gray-400 mb-4"}),t.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Chn file Excel  import"}),t.jsx("p",{className:"text-gray-500 mb-6",children:"H tr nh dng .xlsx v .xls"}),t.jsx("input",{ref:n,type:"file",accept:".xlsx,.xls",onChange:F,className:"hidden"}),t.jsxs("button",{onClick:()=>{var G;return(G=n.current)==null?void 0:G.click()},disabled:C.isPending,className:"btn btn-primary",children:[t.jsx(Zr,{size:20}),C.isPending?"ang c file...":"Chn file Excel"]})]})}),a==="mapping"&&t.jsxs("div",{children:[t.jsxs("div",{className:"card mb-6",children:[t.jsx("h3",{className:"font-semibold mb-4",children:"Thng tin import"}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"File"}),t.jsx("p",{className:"font-medium",children:s==null?void 0:s.name})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Thng"}),t.jsx("select",{value:p,onChange:G=>N(Number(G.target.value)),className:"w-full border rounded-lg px-3 py-2",children:Array.from({length:12},(G,J)=>J+1).map(G=>t.jsxs("option",{value:G,children:["Thng ",G]},G))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Nm"}),t.jsx("select",{value:y,onChange:G=>g(Number(G.target.value)),className:"w-full border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(G=>t.jsx("option",{value:G,children:G},G))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban *"}),t.jsxs("select",{value:b,onChange:G=>j(Number(G.target.value)),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn --"}),w==null?void 0:w.map(G=>t.jsx("option",{value:G.id,children:G.tenPhongBan},G.id))]})]})]})]}),t.jsxs("div",{className:"card mb-6",children:[t.jsx("h3",{className:"font-semibold mb-4",children:"Mapping ct Excel  Khon lng"}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Ct"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Tn ct Excel"}),t.jsx("th",{className:"text-left py-2 px-3",children:"D liu mu"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Loi"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Mapping"})]})}),t.jsx("tbody",{children:m.map((G,J)=>{var X;return t.jsxs("tr",{className:"border-b",children:[t.jsx("td",{className:"py-2 px-3",children:G.soCot}),t.jsx("td",{className:"py-2 px-3 font-medium",children:G.tenCot}),t.jsx("td",{className:"py-2 px-3 text-gray-500",children:((X=u[0])==null?void 0:X[J])||"-"}),t.jsx("td",{className:"py-2 px-3",children:t.jsxs("select",{value:G.loaiMapping,onChange:fe=>B(J,"loaiMapping",fe.target.value),className:"border rounded px-2 py-1 text-sm",children:[t.jsx("option",{value:"thong_tin",children:"Thng tin"}),t.jsx("option",{value:"khoan_luong",children:"Khon lng"})]})}),t.jsx("td",{className:"py-2 px-3",children:G.loaiMapping==="thong_tin"?t.jsxs("select",{value:G.truongHeThong||"",onChange:fe=>B(J,"truongHeThong",fe.target.value),className:"border rounded px-2 py-1 text-sm w-full",children:[t.jsx("option",{value:"",children:"-- B qua --"}),t.jsx("option",{value:"ma_nhan_vien",children:"M nhn vin"}),t.jsx("option",{value:"ho_ten",children:"H tn"}),t.jsx("option",{value:"phong_ban",children:"Phng ban"}),t.jsx("option",{value:"tong_luong_bo_qua",children:"Tng (b qua)"})]}):t.jsxs("select",{value:G.khoanLuongId||"",onChange:fe=>B(J,"khoanLuongId",Number(fe.target.value)||void 0),className:"border rounded px-2 py-1 text-sm w-full",children:[t.jsx("option",{value:"",children:"-- B qua --"}),E==null?void 0:E.map(fe=>t.jsx("option",{value:fe.id,children:fe.tenKhoan},fe.id))]})})]},J)})})]})})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("button",{onClick:M,className:"btn btn-secondary",children:"Quay li"}),t.jsx("button",{onClick:O,disabled:P.isPending,className:"btn btn-primary",children:P.isPending?"ang import...":"Bt u Import"})]})]}),a==="result"&&T&&t.jsxs("div",{children:[t.jsx("div",{className:`card mb-6 ${T.thanhCong?"bg-green-50":"bg-yellow-50"}`,children:t.jsxs("div",{className:"flex items-center gap-4",children:[T.thanhCong?t.jsx(Gn,{size:48,className:"text-green-500"}):t.jsx(di,{size:48,className:"text-yellow-500"}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold",children:T.thanhCong?"Import thnh cng!":"Import hon tt (c li)"}),t.jsxs("p",{className:"text-gray-600",children:[" import ",T.dongThanhCong,"/",T.tongDong," dng"]})]})]})}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"card text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-green-600",children:T.dongThanhCong}),t.jsx("p",{className:"text-gray-500",children:"Dng thnh cng"})]}),t.jsxs("div",{className:"card text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-red-600",children:T.dongLoi}),t.jsx("p",{className:"text-gray-500",children:"Dng li"})]}),t.jsxs("div",{className:"card text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-primary-600",children:Ze(T.tongTienImport)}),t.jsx("p",{className:"text-gray-500",children:"Tng tin import"})]})]}),T.chiTietLoi.length>0&&t.jsxs("div",{className:"card mb-6",children:[t.jsx("h3",{className:"font-semibold text-red-600 mb-3",children:"Chi tit li"}),t.jsx("div",{className:"max-h-48 overflow-y-auto",children:T.chiTietLoi.map((G,J)=>t.jsxs("div",{className:"flex items-center gap-2 py-2 border-b",children:[t.jsx(mo,{size:16,className:"text-red-500"}),t.jsxs("span",{className:"font-medium",children:["Dng ",G.dong,":"]}),t.jsx("span",{className:"text-gray-600",children:G.lyDo})]},J))})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx("button",{onClick:M,className:"btn btn-secondary",children:"Import file khc"}),t.jsx("a",{href:`/bang-luong/${T.bangLuongId}`,className:"btn btn-primary",children:"Xem bng lng"})]})]})]})}const ff={layDanhSach:(e,n,a)=>{const r=new URLSearchParams({thang:String(e),nam:String(n)});return a&&r.append("phongBanId",String(a)),he.get(`/cham-cong?${r}`)},layChamCongNhanVien:(e,n,a)=>he.get(`/cham-cong/nhan-vien/${e}?thang=${n}&nam=${a}`),luu:e=>he.post("/cham-cong",e),khoiTao:(e,n,a=26)=>he.post("/cham-cong/khoi-tao",{thang:e,nam:n,soCongChuan:a}),import:(e,n,a)=>he.post("/cham-cong/import",{thang:e,nam:n,duLieu:a})},pf={lay:e=>he.get(`/cham-cong/cau-hinh-phat/${e}`),capNhat:(e,n)=>he.put(`/cham-cong/cau-hinh-phat/${e}`,n),tinhPhat:(e,n,a)=>he.get(`/cham-cong/tinh-phat/${e}?thang=${n}&nam=${a}`)},DD={dongBoCSV:e=>he.post("/cham-cong/dong-bo-csv",{csvContent:e})};function AD(){const[e,n]=D.useState("cham-cong"),[a,r]=D.useState(new Date().getMonth()+1),[s,l]=D.useState(new Date().getFullYear()),[o,d]=D.useState(),[u,x]=D.useState([]),[m,f]=D.useState([]),[p,N]=D.useState(null),[y,g]=D.useState({}),[b,j]=D.useState(!1),[T,_]=D.useState(null),[w,E]=D.useState({}),[C,S]=D.useState(null),[P,F]=D.useState(null),[B,O]=D.useState(!1),M=D.useRef(null);D.useEffect(()=>{he.get("/phong-ban").then(L=>x(L.data))},[]),D.useEffect(()=>{G()},[a,s,o]),D.useEffect(()=>{e==="cau-hinh"&&J()},[e,s]);const G=async()=>{j(!0);try{const L=await ff.layDanhSach(a,s,o);f(L.data);const Q={};for(const I of L.data)if(I.soLanDiMuon>0||I.soLanVeSom>0||Number(I.soNgayNghiKhongLuong)>0)try{const R=await pf.tinhPhat(I.nhanVienId,a,s);Q[I.nhanVienId]=R.data}catch{}g(Q)}catch{ie.error("Li ti d liu chm cng")}j(!1)},J=async()=>{try{const L=await pf.lay(s);N(L.data)}catch{ie.error("Li ti cu hnh pht")}},X=async()=>{if(confirm(`Khi to chm cng thng ${a}/${s} cho tt c nhn vin?`))try{const L=await ff.khoiTao(a,s,26);ie.success(`${L.data.message} -  to: ${L.data.created}, B qua: ${L.data.skipped}`),G()}catch{ie.error("Li khi to chm cng")}},fe=L=>{_(L.id),E({nhanVienId:L.nhanVienId,thang:L.thang,nam:L.nam,soCongChuan:Number(L.soCongChuan),soCongThucTe:Number(L.soCongThucTe),soNgayNghiPhep:Number(L.soNgayNghiPhep),soNgayNghiKhongLuong:Number(L.soNgayNghiKhongLuong),soGioOT:Number(L.soGioOT),soLanDiMuon:L.soLanDiMuon,soLanVeSom:L.soLanVeSom})},ne=async()=>{if(w.nhanVienId)try{await ff.luu(w),ie.success(" lu chm cng"),_(null),E({}),G()}catch{ie.error("Li lu chm cng")}},H=async()=>{if(p)try{await pf.capNhat(s,p),ie.success(" lu cu hnh pht")}catch{ie.error("Li lu cu hnh")}},W=L=>new Intl.NumberFormat("vi-VN").format(L)+" ",xe=L=>{var I;const Q=(I=L.target.files)==null?void 0:I[0];Q&&(S(Q),F(null))},K=async()=>{var L,Q;if(!C){ie.error("Vui lng chn file CSV");return}O(!0);try{const I=await C.text(),R=await DD.dongBoCSV(I);F(R.data),ie.success(` ng b ${R.data.luuThanhCong} nhn vin thnh cng`),G()}catch(I){ie.error(((Q=(L=I==null?void 0:I.response)==null?void 0:L.data)==null?void 0:Q.message)||"Li ng b file")}O(!1)};return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex justify-between items-center",children:t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[t.jsx(an,{className:"text-primary-600"}),"Qun l Chm cng"]}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Theo di chm cng, i mun, ngh khng php"})]})}),t.jsx("div",{className:"border-b border-gray-200",children:t.jsxs("nav",{className:"flex gap-4",children:[t.jsxs("button",{onClick:()=>n("cham-cong"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${e==="cham-cong"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(cn,{size:18,className:"inline mr-2"}),"Chm cng thng"]}),t.jsxs("button",{onClick:()=>n("dong-bo"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${e==="dong-bo"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(Zr,{size:18,className:"inline mr-2"}),"ng b my chm cng"]}),t.jsxs("button",{onClick:()=>n("cau-hinh"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${e==="cau-hinh"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(ns,{size:18,className:"inline mr-2"}),"Cu hnh pht"]})]})}),e==="cham-cong"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Thng"}),t.jsx("select",{value:a,onChange:L=>r(Number(L.target.value)),className:"border rounded-lg px-3 py-2",children:[...Array(12)].map((L,Q)=>t.jsxs("option",{value:Q+1,children:["Thng ",Q+1]},Q+1))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Nm"}),t.jsx("select",{value:s,onChange:L=>l(Number(L.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(L=>t.jsx("option",{value:L,children:L},L))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban"}),t.jsxs("select",{value:o||"",onChange:L=>d(L.target.value?Number(L.target.value):void 0),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),u.map(L=>t.jsx("option",{value:L.id,children:L.tenPhongBan},L.id))]})]}),t.jsxs("button",{onClick:G,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg",children:[t.jsx(yr,{size:18}),"Lm mi"]}),t.jsxs("button",{onClick:X,className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white hover:bg-primary-700 rounded-lg",children:[t.jsx(At,{size:18}),"Khi to thng"]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Cng chun"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Cng thc"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Ngh php"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Ngh KL"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"i mun"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"V sm"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"OT (gi)"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Tin pht"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:b?t.jsx("tr",{children:t.jsx("td",{colSpan:11,className:"px-4 py-8 text-center text-gray-500",children:"ang ti..."})}):m.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:11,className:"px-4 py-8 text-center text-gray-500",children:'Cha c d liu chm cng. Nhn "Khi to thng"  bt u.'})}):m.map(L=>{var te,ue,V,le;const Q=T===L.id,I=y[L.nhanVienId],R=L.soLanDiMuon>0||L.soLanVeSom>0||Number(L.soNgayNghiKhongLuong)>0;return t.jsxs("tr",{className:R?"bg-red-50":"",children:[t.jsxs("td",{className:"px-4 py-3",children:[t.jsx("div",{className:"font-medium text-gray-900",children:(te=L.nhanVien)==null?void 0:te.hoTen}),t.jsx("div",{className:"text-sm text-gray-500",children:(ue=L.nhanVien)==null?void 0:ue.maNhanVien})]}),t.jsx("td",{className:"px-4 py-3 text-gray-600",children:(le=(V=L.nhanVien)==null?void 0:V.phongBan)==null?void 0:le.tenPhongBan}),t.jsx("td",{className:"px-4 py-3 text-center",children:Q?t.jsx("input",{type:"number",value:w.soCongChuan||0,onChange:q=>E({...w,soCongChuan:Number(q.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(L.soCongChuan)}),t.jsx("td",{className:"px-4 py-3 text-center",children:Q?t.jsx("input",{type:"number",value:w.soCongThucTe||0,onChange:q=>E({...w,soCongThucTe:Number(q.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(L.soCongThucTe)}),t.jsx("td",{className:"px-4 py-3 text-center",children:Q?t.jsx("input",{type:"number",value:w.soNgayNghiPhep||0,onChange:q=>E({...w,soNgayNghiPhep:Number(q.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(L.soNgayNghiPhep)}),t.jsx("td",{className:"px-4 py-3 text-center",children:Q?t.jsx("input",{type:"number",value:w.soNgayNghiKhongLuong||0,onChange:q=>E({...w,soNgayNghiKhongLuong:Number(q.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):t.jsx("span",{className:Number(L.soNgayNghiKhongLuong)>0?"text-red-600 font-semibold":"",children:Number(L.soNgayNghiKhongLuong)})}),t.jsx("td",{className:"px-4 py-3 text-center",children:Q?t.jsx("input",{type:"number",value:w.soLanDiMuon||0,onChange:q=>E({...w,soLanDiMuon:Number(q.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):t.jsx("span",{className:L.soLanDiMuon>0?"text-orange-600 font-semibold":"",children:L.soLanDiMuon})}),t.jsx("td",{className:"px-4 py-3 text-center",children:Q?t.jsx("input",{type:"number",value:w.soLanVeSom||0,onChange:q=>E({...w,soLanVeSom:Number(q.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):t.jsx("span",{className:L.soLanVeSom>0?"text-orange-600 font-semibold":"",children:L.soLanVeSom})}),t.jsx("td",{className:"px-4 py-3 text-center text-blue-600",children:Q?t.jsx("input",{type:"number",value:w.soGioOT||0,onChange:q=>E({...w,soGioOT:Number(q.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(L.soGioOT)}),t.jsx("td",{className:"px-4 py-3 text-right",children:I&&I.tongPhat>0&&t.jsx("div",{className:"text-red-600 font-semibold",title:`Pht i mun: ${W(I.tienPhatDiMuon)}
Pht v sm: ${W(I.tienPhatVeSom)}
Pht ngh KP: ${W(I.tienPhatNghiKhongPhep)}
Tr lng: ${W(I.truLuongNgayCong)}`,children:W(I.tongPhat)})}),t.jsx("td",{className:"px-4 py-3 text-center",children:Q?t.jsxs("div",{className:"flex gap-2 justify-center",children:[t.jsx("button",{onClick:ne,className:"p-1 text-green-600 hover:bg-green-50 rounded",children:t.jsx(_s,{size:18})}),t.jsx("button",{onClick:()=>{_(null),E({})},className:"p-1 text-gray-600 hover:bg-gray-100 rounded",children:""})]}):t.jsx("button",{onClick:()=>fe(L),className:"p-1 text-primary-600 hover:bg-primary-50 rounded",children:"Sa"})})]},L.id)})})]})})}),m.length>0&&t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng nhn vin"}),t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:m.length})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"i mun"}),t.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[m.filter(L=>L.soLanDiMuon>0).length," NV"]})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Ngh khng php"}),t.jsxs("div",{className:"text-2xl font-bold text-red-600",children:[m.filter(L=>Number(L.soNgayNghiKhongLuong)>0).length," NV"]})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng tin pht"}),t.jsx("div",{className:"text-2xl font-bold text-red-600",children:W(Object.values(y).reduce((L,Q)=>L+Q.tongPhat,0))})]})]})]}),e==="dong-bo"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(Zr,{className:"text-primary-600",size:20}),"Upload file CSV t my chm cng"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{onClick:()=>{var L;return(L=M.current)==null?void 0:L.click()},className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-primary-400 transition-colors",children:[t.jsx(wn,{className:"mx-auto text-gray-400 mb-3",size:48}),C?t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-800",children:C.name}),t.jsxs("p",{className:"text-sm text-gray-500",children:[(C.size/1024).toFixed(1)," KB"]})]}):t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-600",children:"Nhp  chn file CSV"}),t.jsx("p",{className:"text-sm text-gray-400",children:"H tr file t my chm cng (Access Controller)"})]}),t.jsx("input",{ref:M,type:"file",accept:".csv",onChange:xe,className:"hidden"})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsxs("button",{onClick:K,disabled:!C||B,className:"flex items-center gap-2 px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[B?t.jsx(yr,{size:18,className:"animate-spin"}):t.jsx(Zr,{size:18}),B?"ang x l...":"ng b d liu"]}),C&&t.jsx("button",{onClick:()=>{S(null),F(null),M.current&&(M.current.value="")},className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"Xa file"})]})]})]}),P&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng bn ghi"}),t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:P.tongBanGhi})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"S ngy cng"}),t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:P.tongNgay})]}),t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Lu thnh cng"}),t.jsxs("div",{className:"text-2xl font-bold text-green-600 flex items-center gap-2",children:[t.jsx(Gn,{size:24})," ",P.luuThanhCong]})]}),t.jsxs("div",{className:"bg-red-50 p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Li"}),t.jsxs("div",{className:"text-2xl font-bold text-red-600 flex items-center gap-2",children:[t.jsx(mo,{size:24})," ",P.luuThatBai]})]})]}),P.thongKe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b",children:t.jsx("h4",{className:"font-semibold",children:"Thng k theo nhn vin"})}),t.jsx("div",{className:"overflow-x-auto max-h-64",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Thng/Nm"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"S cng"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"i mun"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"V sm"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:P.thongKe.map((L,Q)=>t.jsxs("tr",{className:L.soLanDiMuon>0||L.soLanVeSom>0?"bg-orange-50":"",children:[t.jsx("td",{className:"px-4 py-2 font-medium",children:L.maNhanVien}),t.jsxs("td",{className:"px-4 py-2 text-center",children:[L.thang,"/",L.nam]}),t.jsx("td",{className:"px-4 py-2 text-center text-blue-600 font-semibold",children:L.soCongThucTe}),t.jsx("td",{className:"px-4 py-2 text-center",children:t.jsx("span",{className:L.soLanDiMuon>0?"text-orange-600 font-semibold":"",children:L.soLanDiMuon})}),t.jsx("td",{className:"px-4 py-2 text-center",children:t.jsx("span",{className:L.soLanVeSom>0?"text-orange-600 font-semibold":"",children:L.soLanVeSom})})]},Q))})]})})]}),P.chiTiet.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b",children:t.jsxs("h4",{className:"font-semibold",children:["Chi tit chm cng (",P.chiTiet.length," ngy)"]})}),t.jsxs("div",{className:"overflow-x-auto max-h-96",children:[t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Gi vo"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Gi ra"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:P.chiTiet.slice(0,100).map((L,Q)=>t.jsxs("tr",{className:L.diMuon||L.veSom?"bg-orange-50":"",children:[t.jsx("td",{className:"px-4 py-2 font-medium",children:L.maNhanVien}),t.jsx("td",{className:"px-4 py-2",children:L.ngay}),t.jsxs("td",{className:"px-4 py-2 text-center",children:[t.jsx("span",{className:L.diMuon?"text-orange-600 font-semibold":"",children:L.gioVao||"-"}),L.diMuon&&t.jsxs("span",{className:"text-xs text-orange-500 ml-1",children:["(+",L.phutMuon,"p)"]})]}),t.jsxs("td",{className:"px-4 py-2 text-center",children:[t.jsx("span",{className:L.veSom?"text-orange-600 font-semibold":"",children:L.gioRa||"-"}),L.veSom&&t.jsxs("span",{className:"text-xs text-orange-500 ml-1",children:["(-",L.phutSom,"p)"]})]}),t.jsxs("td",{className:"px-4 py-2 text-center",children:[L.diMuon&&t.jsx("span",{className:"px-2 py-0.5 bg-orange-100 text-orange-700 text-xs rounded mr-1",children:"Mun"}),L.veSom&&t.jsx("span",{className:"px-2 py-0.5 bg-orange-100 text-orange-700 text-xs rounded",children:"Sm"}),!L.diMuon&&!L.veSom&&t.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded",children:"OK"})]})]},Q))})]}),P.chiTiet.length>100&&t.jsxs("div",{className:"px-4 py-2 bg-gray-50 text-center text-sm text-gray-500",children:["Hin th 100/",P.chiTiet.length," bn ghi"]})]})]}),P.loi.length>0&&t.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[t.jsxs("h4",{className:"font-semibold text-red-800 mb-2",children:[" Li (",P.loi.length,")"]}),t.jsx("ul",{className:"text-sm text-red-700 space-y-1 list-disc ml-5",children:P.loi.map((L,Q)=>t.jsx("li",{children:L},Q))})]})]}),t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:" Hng dn:"}),t.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc ml-5",children:[t.jsx("li",{children:"Upload file CSV xut t my chm cng (Access Controller)"}),t.jsxs("li",{children:["Format: Tn ring, H, ",t.jsx("strong",{children:"ID (m NV)"}),", B phn, ",t.jsx("strong",{children:"Ngy"}),", ",t.jsx("strong",{children:"Thi gian"}),", ..."]}),t.jsx("li",{children:"H thng t ng nhn din gi vo (qut u bui sng) v gi ra (qut cui bui chiu)"}),t.jsx("li",{children:"So snh vi gi chun (cu hnh trong tab Cu hnh pht)  xc nh i mun/v sm"}),t.jsx("li",{children:"D liu s c tng hp theo thng v lu vo h thng"})]})]})]}),e==="cau-hinh"&&p&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx("label",{className:"font-medium",children:"Nm p dng:"}),t.jsx("select",{value:s,onChange:L=>l(Number(L.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(L=>t.jsx("option",{value:L,children:L},L))})]}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(sa,{className:"text-orange-500",size:20}),"Pht i mun (theo thng)"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"i mun 1-3 ln"}),t.jsx("input",{type:"number",value:Number(p.phatDiMuon1_3Lan),onChange:L=>N({...p,phatDiMuon1_3Lan:Number(L.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"i mun 4-6 ln"}),t.jsx("input",{type:"number",value:Number(p.phatDiMuon4_6Lan),onChange:L=>N({...p,phatDiMuon4_6Lan:Number(L.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"i mun trn 6 ln"}),t.jsx("input",{type:"number",value:Number(p.phatDiMuonTren6Lan),onChange:L=>N({...p,phatDiMuonTren6Lan:Number(L.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]})]}),t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(sa,{className:"text-orange-500",size:20}),"Pht v sm (theo thng)"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"V sm 1-3 ln"}),t.jsx("input",{type:"number",value:Number(p.phatVeSom1_3Lan),onChange:L=>N({...p,phatVeSom1_3Lan:Number(L.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"V sm 4-6 ln"}),t.jsx("input",{type:"number",value:Number(p.phatVeSom4_6Lan),onChange:L=>N({...p,phatVeSom4_6Lan:Number(L.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"V sm trn 6 ln"}),t.jsx("input",{type:"number",value:Number(p.phatVeSomTren6Lan),onChange:L=>N({...p,phatVeSomTren6Lan:Number(L.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]})]}),t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(sa,{className:"text-red-500",size:20}),"Ngh khng php"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Tin pht mi ngy (VN)"}),t.jsx("input",{type:"number",value:Number(p.phatNghiKhongPhep),onChange:L=>N({...p,phatNghiKhongPhep:Number(L.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",id:"truLuong",checked:p.truLuongNghiKhongPhep,onChange:L=>N({...p,truLuongNghiKhongPhep:L.target.checked}),className:"rounded"}),t.jsx("label",{htmlFor:"truLuong",className:"text-sm text-gray-700",children:"Tr thm lng theo ngy cng (Lng / Cng chun  S ngy ngh)"})]})]})]}),t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(an,{className:"text-blue-500",size:20}),"Gi lm vic chun"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Gi vo"}),t.jsx("input",{type:"time",value:p.gioVaoChuan,onChange:L=>N({...p,gioVaoChuan:L.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Gi ra"}),t.jsx("input",{type:"time",value:p.gioRaChuan,onChange:L=>N({...p,gioRaChuan:L.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"S pht c php tr"}),t.jsx("input",{type:"number",value:p.phutChoPhepTre,onChange:L=>N({...p,phutChoPhepTre:Number(L.target.value)}),className:"w-full border rounded-lg px-3 py-2"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Nhn vin n tr trong khong thi gian ny khng b tnh i mun"})]})]})]})]}),t.jsx("div",{className:"flex justify-end",children:t.jsxs("button",{onClick:H,className:"flex items-center gap-2 px-6 py-2 bg-primary-600 text-white hover:bg-primary-700 rounded-lg",children:[t.jsx(_s,{size:18}),"Lu cu hnh"]})}),t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:" Cch tnh tin pht:"}),t.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc ml-5",children:[t.jsx("li",{children:"Pht i mun: Tnh theo s ln i mun trong thng (1-3, 4-6, hoc >6 ln)"}),t.jsx("li",{children:"Pht v sm: Tnh theo s ln v sm trong thng"}),t.jsx("li",{children:"Pht ngh khng php: Tin pht  S ngy ngh"}),t.jsx("li",{children:"Tr lng: (Lng c bn  Cng chun)  S ngy ngh khng php"}),t.jsx("li",{children:"Tng pht = Pht i mun + Pht v sm + Pht ngh KP + Tr lng"})]})]})]})]})}const xw=[{value:"VAN_HANH",label:"Vn hnh"},{value:"KINH_DOANH",label:"Kinh doanh"},{value:"VAN_PHONG",label:"Vn phng"},{value:"SAN_XUAT",label:"Sn xut"}],Ub=[{value:"TO",label:"T"},{value:"NHOM",label:"Nhm"},{value:"CA",label:"Ca"}],FD=[{value:"SAT_HALF_SUN_OFF",label:"Th 7 na ngy, Ch nht ngh"},{value:"FULL",label:"Lm c thng (khng ngh T7/CN)"}];function mw({node:e,level:n=0,onEdit:a,onDelete:r,onAddChild:s,onManageDonViCon:l,expandedNodes:o,toggleExpand:d}){var m,f,p,N;const u=e.children&&e.children.length>0,x=o.has(e.id);return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 py-2 px-3 hover:bg-gray-50 rounded-lg group",style:{marginLeft:n*24},children:[t.jsx("button",{onClick:()=>d(e.id),className:`w-6 h-6 flex items-center justify-center rounded hover:bg-gray-200 ${u?"":"invisible"}`,children:x?t.jsx(Ja,{size:16}):t.jsx(qn,{size:16})}),t.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${n===0?"bg-primary-100 text-primary-600":n===1?"bg-blue-100 text-blue-600":n===2?"bg-green-100 text-green-600":"bg-orange-100 text-orange-600"}`,children:n===0?t.jsx(Mr,{size:16}):t.jsx(xj,{size:16})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-medium text-gray-900",children:e.tenPhongBan}),t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-600",children:e.maPhongBan}),e.loaiPhongBan&&t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-indigo-100 text-indigo-600",children:((m=xw.find(y=>y.value===e.loaiPhongBan))==null?void 0:m.label)||e.loaiPhongBan})]}),e.moTa&&t.jsx("div",{className:"text-xs text-gray-500 truncate",children:e.moTa})]}),t.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[t.jsxs("div",{className:"flex items-center gap-1 text-gray-500",title:"Nhn vin",children:[t.jsx(cn,{size:14}),t.jsx("span",{children:((f=e._count)==null?void 0:f.nhanViens)||0})]}),(((p=e._count)==null?void 0:p.donViCons)||0)>0&&t.jsxs("div",{className:"flex items-center gap-1 text-gray-500",title:"n v con",children:[t.jsx(b0,{size:14}),t.jsx("span",{children:(N=e._count)==null?void 0:N.donViCons})]})]}),t.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[t.jsx("button",{onClick:()=>s(e.id),className:"p-1.5 text-green-600 hover:bg-green-50 rounded",title:"Thm phng ban con",children:t.jsx(Dt,{size:16})}),t.jsx("button",{onClick:()=>l(e),className:"p-1.5 text-purple-600 hover:bg-purple-50 rounded",title:"Qun l T/Ca",children:t.jsx(b0,{size:16})}),t.jsx("button",{onClick:()=>a(e),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:"Sa",children:t.jsx(Za,{size:16})}),t.jsx("button",{onClick:()=>r(e),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Ngng hot ng",children:t.jsx(er,{size:16})})]})]}),u&&x&&t.jsx("div",{children:e.children.map(y=>t.jsx(mw,{node:y,level:n+1,onEdit:a,onDelete:r,onAddChild:s,onManageDonViCon:l,expandedNodes:o,toggleExpand:d},y.id))})]})}function LD(){const e=Mt(),[n,a]=D.useState(""),[r,s]=D.useState(new Set),[l,o]=D.useState(!1),[d,u]=D.useState(!1),[x,m]=D.useState(null),[f,p]=D.useState(null),[N,y]=D.useState(null),[g,b]=D.useState({maPhongBan:"",tenPhongBan:"",moTa:"",loaiPhongBan:"",gioVaoChuan:"08:00",gioRaChuan:"17:00",phutChoPhepTre:5,quyTacNgayCong:"SAT_HALF_SUN_OFF",soNgayCongThang:null}),[j,T]=D.useState({maDonVi:"",tenDonVi:"",loaiDonVi:"TO"}),{data:_,isLoading:w}=Fe({queryKey:["phong-ban-cay"],queryFn:Jt.layCayPhongBan}),{data:E}=Fe({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),{data:C,refetch:S}=Fe({queryKey:["don-vi-con",N==null?void 0:N.id],queryFn:()=>N?Jt.layDonViCon(N.id):Promise.resolve([]),enabled:!!N}),P=Ee({mutationFn:Jt.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["phong-ban-cay"]}),e.invalidateQueries({queryKey:["phong-ban"]}),ne()},onError:I=>{var R,te;alert(((te=(R=I.response)==null?void 0:R.data)==null?void 0:te.message)||"C li xy ra")}}),F=Ee({mutationFn:({id:I,data:R})=>Jt.capNhat(I,R),onSuccess:()=>{e.invalidateQueries({queryKey:["phong-ban-cay"]}),e.invalidateQueries({queryKey:["phong-ban"]}),ne()},onError:I=>{var R,te;alert(((te=(R=I.response)==null?void 0:R.data)==null?void 0:te.message)||"C li xy ra")}}),B=Ee({mutationFn:Jt.ngungHoatDong,onSuccess:()=>{e.invalidateQueries({queryKey:["phong-ban-cay"]}),e.invalidateQueries({queryKey:["phong-ban"]})},onError:I=>{var R,te;alert(((te=(R=I.response)==null?void 0:R.data)==null?void 0:te.message)||"Khng th ngng hot ng phng ban")}}),O=Ee({mutationFn:({phongBanId:I,data:R})=>Jt.taoDonViCon(I,R),onSuccess:()=>{S(),T({maDonVi:"",tenDonVi:"",loaiDonVi:"TO"})},onError:I=>{var R,te;alert(((te=(R=I.response)==null?void 0:R.data)==null?void 0:te.message)||"C li xy ra")}}),M=I=>{s(R=>{const te=new Set(R);return te.has(I)?te.delete(I):te.add(I),te})},G=()=>{const I=new Set,R=te=>{te.forEach(ue=>{I.add(ue.id),ue.children&&R(ue.children)})};_&&R(_),s(I)},J=()=>{s(new Set)},X=I=>{m(null),p(I||null),b({maPhongBan:"",tenPhongBan:"",moTa:"",loaiPhongBan:"",gioVaoChuan:"08:00",gioRaChuan:"17:00",phutChoPhepTre:5,quyTacNgayCong:"SAT_HALF_SUN_OFF",soNgayCongThang:null}),o(!0)},fe=I=>{m(I),p(I.phongBanChaId||null),b({maPhongBan:I.maPhongBan,tenPhongBan:I.tenPhongBan,moTa:I.moTa||"",loaiPhongBan:I.loaiPhongBan||"",gioVaoChuan:I.gioVaoChuan||"08:00",gioRaChuan:I.gioRaChuan||"17:00",phutChoPhepTre:I.phutChoPhepTre??5,quyTacNgayCong:I.quyTacNgayCong||"SAT_HALF_SUN_OFF",soNgayCongThang:I.soNgayCongThang??null}),o(!0)},ne=()=>{o(!1),m(null),p(null)},H=I=>{if(I.preventDefault(),!g.maPhongBan.trim()||!g.tenPhongBan.trim()){alert("Vui lng nhp m v tn phng ban");return}const R={...g,phongBanChaId:f||void 0,loaiPhongBan:g.loaiPhongBan||void 0};x?F.mutate({id:x.id,data:R}):P.mutate(R)},W=I=>{confirm(`Bn c chc mun ngng hot ng phng ban "${I.tenPhongBan}"?`)&&B.mutate(I.id)},xe=I=>{y(I),u(!0)},K=I=>{if(I.preventDefault(),!!N){if(!j.maDonVi.trim()||!j.tenDonVi.trim()){alert("Vui lng nhp m v tn n v");return}O.mutate({phongBanId:N.id,data:j})}},L=I=>I.reduce((R,te)=>R+1+(te.children?L(te.children):0),0),Q=_?L(_):0;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Mr,{className:"w-8 h-8 text-primary-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Phng ban"}),t.jsx("p",{className:"text-gray-500",children:"Cu trc t chc cng ty dng cy phn cp"})]})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("button",{onClick:()=>X(),className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[t.jsx(Dt,{size:20}),"Thm phng ban"]})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary-100 flex items-center justify-center",children:t.jsx(Mr,{className:"w-6 h-6 text-primary-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng phng ban"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Q})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-green-100 flex items-center justify-center",children:t.jsx(cn,{className:"w-6 h-6 text-green-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng nhn vin"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:(E==null?void 0:E.reduce((I,R)=>{var te;return I+(((te=R._count)==null?void 0:te.nhanViens)||0)},0))||0})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-purple-100 flex items-center justify-center",children:t.jsx(b0,{className:"w-6 h-6 text-purple-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng T/Ca"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:(E==null?void 0:E.reduce((I,R)=>{var te;return I+(((te=R._count)==null?void 0:te.donViCons)||0)},0))||0})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-100 flex items-center justify-center",children:t.jsx(A_,{className:"w-6 h-6 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Cp su nht"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Math.max(...(E==null?void 0:E.map(I=>I.capDo))||[0],0)})]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:G,className:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50",children:"M tt c"}),t.jsx("button",{onClick:J,className:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50",children:"Thu gn"})]}),t.jsxs("div",{className:"relative max-w-xs",children:[t.jsx(Vr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),t.jsx("input",{type:"text",placeholder:"Tm kim...",className:"w-full pl-9 pr-4 py-1.5 text-sm border rounded-lg focus:ring-2 focus:ring-primary-500",value:n,onChange:I=>a(I.target.value)})]})]}),t.jsx("div",{className:"p-4",children:w?t.jsx("div",{className:"text-center py-8 text-gray-500",children:"ang ti..."}):!_||_.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(Mr,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Cha c phng ban no"}),t.jsx("button",{onClick:()=>X(),className:"mt-3 text-primary-600 hover:text-primary-700 text-sm font-medium",children:"+ Thm phng ban u tin"})]}):t.jsx("div",{className:"space-y-1",children:_.map(I=>t.jsx(mw,{node:I,onEdit:fe,onDelete:W,onAddChild:X,onManageDonViCon:xe,expandedNodes:r,toggleExpand:M},I.id))})})]}),l&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:x?"Cp nht phng ban":"Thm phng ban mi"}),t.jsxs("form",{onSubmit:H,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban cha"}),t.jsxs("select",{value:f||"",onChange:I=>p(I.target.value?Number(I.target.value):null),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",children:[t.jsx("option",{value:"",children:"-- Khng c (phng ban gc) --"}),E==null?void 0:E.filter(I=>!x||I.id!==x.id).map(I=>t.jsxs("option",{value:I.id,children:["".repeat(I.capDo-1)," ",I.tenPhongBan]},I.id))]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["M phng ban ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:g.maPhongBan,onChange:I=>b({...g,maPhongBan:I.target.value.toUpperCase()}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"VD: HR, IT..."})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn phng ban ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:g.tenPhongBan,onChange:I=>b({...g,tenPhongBan:I.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"VD: Phng Nhn s..."})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi phng ban"}),t.jsxs("select",{value:g.loaiPhongBan,onChange:I=>b({...g,loaiPhongBan:I.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",children:[t.jsx("option",{value:"",children:"-- Chn loi --"}),xw.map(I=>t.jsx("option",{value:I.value,children:I.label},I.value))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("input",{type:"text",value:g.moTa,onChange:I=>b({...g,moTa:I.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"M t ngn..."})]})]}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(an,{className:"w-5 h-5 text-indigo-600"}),t.jsx("h3",{className:"font-medium text-gray-900",children:"Gi lm vic"})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi vo"}),t.jsx("input",{type:"time",value:g.gioVaoChuan,onChange:I=>b({...g,gioVaoChuan:I.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi ra"}),t.jsx("input",{type:"time",value:g.gioRaChuan,onChange:I=>b({...g,gioRaChuan:I.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cho php tr"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"number",min:"0",max:"60",value:g.phutChoPhepTre,onChange:I=>b({...g,phutChoPhepTre:Number(I.target.value)}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 pr-12"}),t.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm",children:"pht"})]})]})]})]}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(At,{className:"w-5 h-5 text-indigo-600"}),t.jsx("h3",{className:"font-medium text-gray-900",children:"Ngy lm vic"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quy tc ngy cng"}),t.jsx("select",{value:g.quyTacNgayCong,onChange:I=>b({...g,quyTacNgayCong:I.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",children:FD.map(I=>t.jsx("option",{value:I.value,children:I.label},I.value))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S ngy cng c nh"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"number",min:"1",max:"31",value:g.soNgayCongThang??"",onChange:I=>b({...g,soNgayCongThang:I.target.value===""?null:Number(I.target.value)}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 pr-12",placeholder:"VD: 26"}),t.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm",children:"ngy"})]})]}),t.jsx("div",{className:"text-sm text-gray-500 flex items-center col-span-2",children:"Nu nhp s ngy c nh, h thng s u tin s ny (k c lm Ch nht)."})]})]}),t.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[t.jsx("button",{type:"button",onClick:ne,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",disabled:P.isPending||F.isPending,className:"flex-1 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:P.isPending||F.isPending?"ang lu...":x?"Cp nht":"Thm mi"})]})]})]})}),d&&N&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["T/Ca/Nhm - ",N.tenPhongBan]}),t.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),t.jsxs("form",{onSubmit:K,className:"flex items-end gap-3 mb-4 p-4 bg-gray-50 rounded-lg",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M"}),t.jsx("input",{type:"text",value:j.maDonVi,onChange:I=>T({...j,maDonVi:I.target.value.toUpperCase()}),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"TO_A"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn"}),t.jsx("input",{type:"text",value:j.tenDonVi,onChange:I=>T({...j,tenDonVi:I.target.value}),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"T A"})]}),t.jsxs("div",{className:"w-32",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi"}),t.jsx("select",{value:j.loaiDonVi,onChange:I=>T({...j,loaiDonVi:I.target.value}),className:"w-full px-3 py-2 border rounded-lg text-sm",children:Ub.map(I=>t.jsx("option",{value:I.value,children:I.label},I.value))})]}),t.jsx("button",{type:"submit",disabled:O.isPending,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:t.jsx(Dt,{size:18})})]}),C&&C.length>0?t.jsx("div",{className:"divide-y",children:C.map(I=>{var R;return t.jsxs("div",{className:"flex items-center justify-between py-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${I.loaiDonVi==="TO"?"bg-blue-100 text-blue-600":I.loaiDonVi==="NHOM"?"bg-green-100 text-green-600":"bg-orange-100 text-orange-600"}`,children:t.jsx(b0,{size:16})}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:I.tenDonVi}),t.jsxs("div",{className:"text-xs text-gray-500",children:[I.maDonVi,"  ",(R=Ub.find(te=>te.value===I.loaiDonVi))==null?void 0:R.label]})]})]}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${I.trangThai==="HOAT_DONG"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:I.trangThai==="HOAT_DONG"?"Hot ng":"Ngng"})]},I.id)})}):t.jsx("div",{className:"text-center py-8 text-gray-500",children:"Cha c n v con no"})]})})]})}const Wh={LUONG_THANG_CO_DINH:{label:"C nh theo thng",desc:"Nhn  s tin mi thng, khng ph thuc ngy cng"},THEO_NGAY_CONG:{label:"Theo ngy cng",desc:"Tnh theo cng thc: S tin  (Ngy cng thc t / Ngy cng l thuyt)"},CHUYEN_CAN_DIEU_KIEN:{label:"Chuyn cn c iu kin",desc:"Nhn  nu ngh khng php  2 ngy, mt ht nu > 2 ngy"}};function PD(){var ne;const[e,n]=D.useState("phucap"),a=Mt(),[r,s]=D.useState(!1),[l,o]=D.useState(null),[d,u]=D.useState(""),[x,m]=D.useState({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",cachTinh:"LUONG_THANG_CO_DINH",chiuThue:!1,moTa:"",thuTu:0}),{data:f,isLoading:p}=Fe({queryKey:["khoan-luong"],queryFn:()=>pr.layTatCa()}),N=(f==null?void 0:f.filter(H=>d===""||H.loai===d))||[],y=Ee({mutationFn:pr.taoMoi,onSuccess:()=>{a.invalidateQueries({queryKey:["khoan-luong"]}),ie.success("To ph cp thnh cng!"),j()},onError:H=>{var W,xe;ie.error(((xe=(W=H.response)==null?void 0:W.data)==null?void 0:xe.message)||"C li xy ra")}}),g=Ee({mutationFn:({id:H,data:W})=>pr.capNhat(H,W),onSuccess:()=>{a.invalidateQueries({queryKey:["khoan-luong"]}),ie.success("Cp nht ph cp thnh cng!"),j()},onError:H=>{var W,xe;ie.error(((xe=(W=H.response)==null?void 0:W.data)==null?void 0:xe.message)||"C li xy ra")}}),b=Ee({mutationFn:pr.xoa,onSuccess:()=>{a.invalidateQueries({queryKey:["khoan-luong"]}),ie.success("Xa ph cp thnh cng!")},onError:H=>{var W,xe;ie.error(((xe=(W=H.response)==null?void 0:W.data)==null?void 0:xe.message)||"C li xy ra")}}),j=()=>{s(!1),o(null),m({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",cachTinh:"LUONG_THANG_CO_DINH",chiuThue:!1,moTa:"",thuTu:0})},T=H=>{o(H),m({maKhoan:H.maKhoan,tenKhoan:H.tenKhoan,loai:H.loai,cachTinh:H.cachTinh||"LUONG_THANG_CO_DINH",chiuThue:H.chiuThue,moTa:H.moTa||"",thuTu:H.thuTu}),s(!0)},_=()=>{if(!x.maKhoan||!x.tenKhoan){ie.error("Vui lng in m v tn ph cp");return}l?g.mutate({id:l.id,data:x}):y.mutate(x)},w=H=>{confirm(`Bn c chc mun xa ph cp "${H.tenKhoan}"?`)&&b.mutate(H.id)},[E,C]=D.useState({nam:new Date().getFullYear(),tyLeBHXH_NV:8,tyLeBHYT_NV:1.5,tyLeBHTN_NV:1,tyLeBHXH_DN:17.5,tyLeBHYT_DN:3,tyLeBHTN_DN:1,luongCoSo:18e5,luongCoBanToiThieu:496e4,tranDongBHXH:0}),{data:S,isLoading:P}=Fe({queryKey:["thong-tin-cong-ty"],queryFn:Ab.lay}),{data:F,isLoading:B}=Fe({queryKey:["cau-hinh-bhxh",E.nam],queryFn:()=>Db.layCauHinhBHXH(E.nam),retry:!1}),[O,M]=D.useState({tenCongTy:"",maSoThue:"",diaChi:"",dienThoai:"",email:"",website:"",nguoiDaiDien:"",chucVuDaiDien:""});D.useEffect(()=>{S&&M(S)},[S]),D.useEffect(()=>{F&&C(H=>({...H,...F,nam:H.nam}))},[F]);const G=Ee({mutationFn:Ab.capNhat,onSuccess:()=>{a.invalidateQueries({queryKey:["thong-tin-cong-ty"]}),ie.success("Cp nht thng tin cng ty thnh cng!")},onError:()=>{ie.error("C li khi cp nht thng tin cng ty")}}),J=Ee({mutationFn:Db.luuCauHinhBHXH,onSuccess:()=>{a.invalidateQueries({queryKey:["cau-hinh-bhxh",E.nam]}),ie.success("Lu cu hnh BHXH/Thu thnh cng!")},onError:()=>{ie.error("C li khi lu cu hnh BHXH/Thu")}}),X=async H=>{H.preventDefault(),await J.mutateAsync(E)},fe=async H=>{H.preventDefault(),await G.mutateAsync(O)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(ns,{className:"w-8 h-8 text-blue-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Ci t h thng"}),t.jsx("p",{className:"text-gray-600",children:"Qun l cu hnh BHXH, thu v thng tin cng ty"})]})]}),t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"border-b",children:t.jsxs("div",{className:"flex gap-4",children:[t.jsx("button",{onClick:()=>n("phucap"),className:`px-4 py-3 font-medium border-b-2 transition-colors ${e==="phucap"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(D_,{className:"w-4 h-4"}),"Ph cp & Khon lng"]})}),t.jsx("button",{onClick:()=>n("bhxh"),className:`px-4 py-3 font-medium border-b-2 transition-colors ${e==="bhxh"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(wn,{className:"w-4 h-4"}),"BHXH / Thu"]})}),t.jsx("button",{onClick:()=>n("congty"),className:`px-4 py-3 font-medium border-b-2 transition-colors ${e==="congty"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Mr,{className:"w-4 h-4"}),"Thng tin cng ty"]})})]})}),t.jsxs("div",{className:"p-6",children:[e==="phucap"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Danh sch Ph cp & Khon lng"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Cu hnh cc khon ph cp, thu nhp, khu tr p dng cho nhn vin"})]}),t.jsxs("button",{onClick:()=>s(!0),className:"btn btn-primary",children:[t.jsx(Dt,{size:18}),"Thm mi"]})]}),t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsxs("select",{value:d,onChange:H=>u(H.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c loi"}),t.jsx("option",{value:"THU_NHAP",children:"Thu nhp"}),t.jsx("option",{value:"KHAU_TRU",children:"Khu tr"})]}),t.jsxs("span",{className:"text-sm text-gray-500",children:["Tng: ",N.length," khon"]})]}),p?t.jsx("div",{className:"text-center py-8",children:t.jsx(An,{className:"w-8 h-8 animate-spin mx-auto text-blue-600"})}):t.jsx("div",{className:"overflow-x-auto border rounded-lg",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"M"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Tn khon"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Loi"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Cch tnh"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Chu thu"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Th t"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Thao tc"})]})}),t.jsx("tbody",{children:N.map(H=>{var W;return t.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4 font-mono text-sm",children:H.maKhoan}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:H.tenKhoan}),H.moTa&&t.jsx("div",{className:"text-xs text-gray-500",children:H.moTa})]})}),t.jsx("td",{className:"py-3 px-4",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${H.loai==="THU_NHAP"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:H.loai==="THU_NHAP"?"Thu nhp":"Khu tr"})}),t.jsx("td",{className:"py-3 px-4",children:t.jsx("span",{className:"text-sm",children:((W=Wh[H.cachTinh])==null?void 0:W.label)||H.cachTinh})}),t.jsx("td",{className:"py-3 px-4 text-center",children:H.chiuThue?t.jsx("span",{className:"text-green-600",children:""}):t.jsx("span",{className:"text-gray-400",children:"-"})}),t.jsx("td",{className:"py-3 px-4 text-center text-gray-500",children:H.thuTu}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>T(H),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Sa",children:t.jsx(Za,{size:16})}),t.jsx("button",{onClick:()=>w(H),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Xa",children:t.jsx(er,{size:16})})]})})]},H.id)})})]})}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Hng dn cch tnh lng"}),t.jsx("div",{className:"space-y-2 text-sm text-blue-800",children:Object.entries(Wh).map(([H,W])=>t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("span",{className:"font-medium min-w-[180px]",children:[W.label,":"]}),t.jsx("span",{children:W.desc})]},H))})]})]}),e==="bhxh"&&t.jsxs("form",{onSubmit:X,className:"space-y-6 max-w-3xl",children:[B&&t.jsx("div",{className:"flex items-center justify-center py-4",children:t.jsx(An,{className:"w-6 h-6 animate-spin text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Cu hnh BHXH/BHYT/BHTN"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Nm p dng"})}),t.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:E.nam,onChange:H=>C({...E,nam:Number(H.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Trn ng BHXH (VN)"})}),t.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:E.tranDongBHXH,onChange:H=>C({...E,tranDongBHXH:Number(H.target.value)})})]})]}),t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:[t.jsx("h4",{className:"font-semibold text-blue-900 mb-3",children:"T l ng Nhn vin (%)"}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHXH"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:E.tyLeBHXH_NV,onChange:H=>C({...E,tyLeBHXH_NV:Number(H.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHYT"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:E.tyLeBHYT_NV,onChange:H=>C({...E,tyLeBHYT_NV:Number(H.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHTN"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:E.tyLeBHTN_NV,onChange:H=>C({...E,tyLeBHTN_NV:Number(H.target.value)})})]})]})]}),t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg mb-4",children:[t.jsx("h4",{className:"font-semibold text-green-900 mb-3",children:"T l ng Doanh nghip (%)"}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHXH"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:E.tyLeBHXH_DN,onChange:H=>C({...E,tyLeBHXH_DN:Number(H.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHYT"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:E.tyLeBHYT_DN,onChange:H=>C({...E,tyLeBHYT_DN:Number(H.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHTN"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:E.tyLeBHTN_DN,onChange:H=>C({...E,tyLeBHTN_DN:Number(H.target.value)})})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Mc lng c s (VN)"})}),t.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:E.luongCoSo,onChange:H=>C({...E,luongCoSo:Number(H.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Mc lng ti thiu vng (VN)"})}),t.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:E.luongCoBanToiThieu,onChange:H=>C({...E,luongCoBanToiThieu:Number(H.target.value)})})]})]}),t.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 p-4 rounded-lg text-sm text-yellow-800",children:[t.jsx("strong",{children:"Lu :"})," Cc t l ny s c p dng cho tt c nhn vin khi tnh lng. Vui lng kim tra k trc khi lu."]})]}),t.jsx("div",{className:"flex justify-end gap-2",children:t.jsxs("button",{type:"submit",className:"btn btn-primary",children:[t.jsx(_s,{className:"w-4 h-4"}),"Lu cu hnh"]})})]}),e==="congty"&&t.jsx("form",{onSubmit:fe,className:"space-y-6 max-w-3xl",children:P?t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx(An,{className:"w-8 h-8 animate-spin text-blue-600"})}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thng tin cng ty"}),t.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Tn cng ty *"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:O.tenCongTy||"",onChange:H=>M({...O,tenCongTy:H.target.value}),required:!0})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"M s thu"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:O.maSoThue||"",onChange:H=>M({...O,maSoThue:H.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"in thoi"})}),t.jsx("input",{type:"tel",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:O.dienThoai||"",onChange:H=>M({...O,dienThoai:H.target.value})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"a ch"})}),t.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",rows:2,value:O.diaChi||"",onChange:H=>M({...O,diaChi:H.target.value})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Email"})}),t.jsx("input",{type:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:O.email||"",onChange:H=>M({...O,email:H.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Website"})}),t.jsx("input",{type:"url",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:O.website||"",onChange:H=>M({...O,website:H.target.value})})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Ngi i din"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:O.nguoiDaiDien||"",onChange:H=>M({...O,nguoiDaiDien:H.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Chc v ngi i din"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:O.chucVuDaiDien||"",onChange:H=>M({...O,chucVuDaiDien:H.target.value})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Logo (URL)"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:O.logo||"",onChange:H=>M({...O,logo:H.target.value}),placeholder:"https://example.com/logo.png"}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Nhp URL ca logo cng ty (hin th trn phiu lng)"})]})]}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg text-sm text-blue-800 mt-4",children:[t.jsx("strong",{children:"Lu :"})," Thng tin ny s c hin th trn cc phiu lng khi xut."]})]}),t.jsx("div",{className:"flex justify-end gap-2",children:t.jsx("button",{type:"submit",className:"btn btn-primary",disabled:G.isPending,children:G.isPending?t.jsxs(t.Fragment,{children:[t.jsx(An,{className:"w-4 h-4 animate-spin"}),"ang lu..."]}):t.jsxs(t.Fragment,{children:[t.jsx(_s,{className:"w-4 h-4"}),"Lu thng tin"]})})})]})})]})]}),r&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:l?"Sa khon ph cp":"Thm khon ph cp mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M khon *"}),t.jsx("input",{type:"text",value:x.maKhoan,onChange:H=>m({...x,maKhoan:H.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: PHU_CAP_AN_TRUA",disabled:!!l})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Th t hin th"}),t.jsx("input",{type:"number",value:x.thuTu,onChange:H=>m({...x,thuTu:Number(H.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tn khon *"}),t.jsx("input",{type:"text",value:x.tenKhoan,onChange:H=>m({...x,tenKhoan:H.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ph cp n tra"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi khon"}),t.jsxs("select",{value:x.loai,onChange:H=>m({...x,loai:H.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"THU_NHAP",children:"Thu nhp (cng vo lng)"}),t.jsx("option",{value:"KHAU_TRU",children:"Khu tr (tr khi lng)"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chu thu TNCN"}),t.jsxs("select",{value:x.chiuThue?"true":"false",onChange:H=>m({...x,chiuThue:H.target.value==="true"}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"false",children:"Khng chu thu"}),t.jsx("option",{value:"true",children:"C chu thu"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Cch tnh lng"}),t.jsx("select",{value:x.cachTinh,onChange:H=>m({...x,cachTinh:H.target.value}),className:"w-full border rounded-lg px-3 py-2",children:Object.entries(Wh).map(([H,W])=>t.jsx("option",{value:H,children:W.label},H))}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:(ne=Wh[x.cachTinh])==null?void 0:ne.desc})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M t"}),t.jsx("textarea",{value:x.moTa,onChange:H=>m({...x,moTa:H.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2,placeholder:"Ghi ch v khon ph cp ny..."})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:j,className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:_,disabled:y.isPending||g.isPending,className:"btn btn-primary",children:y.isPending||g.isPending?"ang lu...":"Lu"})]})]})})]})}function ID(){const e=Mt(),[n,a]=D.useState(!1),[r,s]=D.useState(null),[l,o]=D.useState({maNhom:"",tenNhom:"",moTa:"",mauSac:"#3B82F6",trangThai:!0}),{data:d,isLoading:u}=Fe({queryKey:["nhom-nhan-vien"],queryFn:hw}),x=Ee({mutationFn:pD,onSuccess:()=>{ie.success("To nhm thnh cng"),e.invalidateQueries({queryKey:["nhom-nhan-vien"]}),a(!1),p()},onError:g=>{var b,j;ie.error(((j=(b=g.response)==null?void 0:b.data)==null?void 0:j.message)||"Li to nhm")}}),m=Ee({mutationFn:({id:g,data:b})=>gD(g,b),onSuccess:()=>{ie.success("Cp nht nhm thnh cng"),e.invalidateQueries({queryKey:["nhom-nhan-vien"]}),s(null),a(!1),p()},onError:g=>{var b,j;ie.error(((j=(b=g.response)==null?void 0:b.data)==null?void 0:j.message)||"Li cp nht")}}),f=Ee({mutationFn:yD,onSuccess:()=>{ie.success(" xa nhm"),e.invalidateQueries({queryKey:["nhom-nhan-vien"]})},onError:g=>{var b,j;ie.error(((j=(b=g.response)==null?void 0:b.data)==null?void 0:j.message)||"Li xa nhm")}}),p=()=>{o({maNhom:"",tenNhom:"",moTa:"",mauSac:"#3B82F6",trangThai:!0})},N=g=>{o({maNhom:g.maNhom,tenNhom:g.tenNhom,moTa:g.moTa||"",mauSac:g.mauSac||"#3B82F6",trangThai:g.trangThai}),s(g.id),a(!0)},y=g=>{g.preventDefault(),r?m.mutate({id:r,data:l}):x.mutate(l)};return u?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Qun l Nhm Nhn vin"}),t.jsxs("button",{onClick:()=>{a(!0),s(null),p()},className:"btn btn-primary flex items-center gap-2",children:[t.jsx(Dt,{size:20}),"Thm nhm"]})]}),n&&t.jsxs("div",{className:"card mb-6 bg-blue-50 border border-blue-200",children:[t.jsx("h3",{className:"font-semibold mb-4",children:r?"Sa nhm":"To nhm mi"}),t.jsxs("form",{onSubmit:y,className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M nhm *"}),t.jsx("input",{type:"text",value:l.maNhom,onChange:g=>o({...l,maNhom:g.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: NHOM_KT, NHOM_HR...",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tn nhm *"}),t.jsx("input",{type:"text",value:l.tenNhom,onChange:g=>o({...l,tenNhom:g.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Nhm K ton, Nhm HR...",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M t"}),t.jsx("input",{type:"text",value:l.moTa,onChange:g=>o({...l,moTa:g.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"M t ngn v nhm..."})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Mu sc"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"color",value:l.mauSac,onChange:g=>o({...l,mauSac:g.target.value}),className:"w-10 h-10 rounded cursor-pointer"}),t.jsx("span",{className:"text-sm text-gray-500",children:l.mauSac})]})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Trng thi"}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:l.trangThai,onChange:g=>o({...l,trangThai:g.target.checked}),className:"w-4 h-4 rounded"}),t.jsx("span",{className:"text-sm",children:"ang hot ng"})]})]})]}),t.jsxs("div",{className:"col-span-2 flex gap-2",children:[t.jsx("button",{type:"submit",disabled:x.isPending||m.isPending,className:"btn btn-primary",children:r?"Cp nht":"To mi"}),t.jsx("button",{type:"button",onClick:()=>{a(!1),s(null)},className:"btn btn-secondary",children:"Hy"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[d==null?void 0:d.map(g=>{var b;return t.jsxs("div",{className:`card ${g.trangThai?"":"opacity-60"}`,style:{borderLeftWidth:"4px",borderLeftColor:g.mauSac||"#6B7280"},children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center text-white font-bold text-lg",style:{backgroundColor:g.mauSac||"#6B7280"},children:g.tenNhom.charAt(0).toUpperCase()}),t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold",children:g.tenNhom}),t.jsx("div",{className:"text-xs text-gray-500",children:g.maNhom})]})]}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{onClick:()=>N(g),className:"p-1.5 hover:bg-blue-100 rounded text-blue-600",title:"Sa",children:t.jsx(Za,{size:16})}),t.jsx("button",{onClick:()=>{confirm(`Xc nhn xa nhm "${g.tenNhom}"?`)&&f.mutate(g.id)},className:"p-1.5 hover:bg-red-100 rounded text-red-600",title:"Xa",children:t.jsx(er,{size:16})})]})]}),g.moTa&&t.jsx("div",{className:"text-sm text-gray-600 mt-2",children:g.moTa}),t.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t",children:[t.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[t.jsx(cn,{size:16}),t.jsxs("span",{children:[((b=g._count)==null?void 0:b.thanhViens)||0," thnh vin"]})]}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${g.trangThai?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:g.trangThai?"Hot ng":"Tm dng"})]})]},g.id)}),(d==null?void 0:d.length)===0&&t.jsxs("div",{className:"col-span-3 text-center py-12 text-gray-500 bg-gray-50 rounded-lg",children:[t.jsx(cn,{size:48,className:"mx-auto mb-4 text-gray-300"}),t.jsx("p",{children:"Cha c nhm no"}),t.jsxs("button",{onClick:()=>{a(!0),s(null),p()},className:"btn btn-primary mt-4",children:[t.jsx(Dt,{size:20}),"To nhm u tin"]})]})]}),t.jsxs("div",{className:"mt-6 bg-blue-50 p-4 rounded-lg text-sm text-blue-800",children:[t.jsx("strong",{children:" Hng dn:"})," Nhm nhn vin c s dng trong Rule Engine  p dng cc quy tc tnh lng khc nhau cho tng nhm. V d: nhm Qun l c ph cp chc v, nhm K thut c ph cp c hi..."]})]})}function OD(){const e=br(),{dangNhap:n,isAuthenticated:a}=ls(),[r,s]=D.useState(""),[l,o]=D.useState(""),[d,u]=D.useState(!1),[x,m]=D.useState("");if(a)return e("/",{replace:!0}),null;const f=async p=>{var N,y;if(p.preventDefault(),m(""),!r||!l){m("Vui lng nhp tn ng nhp v mt khu");return}u(!0);try{await n(r,l),e("/",{replace:!0})}catch(g){m(((y=(N=g.response)==null?void 0:N.data)==null?void 0:y.message)||"ng nhp tht bi")}finally{u(!1)}};return t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:t.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg p-8",children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-blue-100 mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"HRM - Qun l NS & Tnh lng"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"ng nhp  tip tc"})]}),x&&t.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:x}),t.jsxs("form",{onSubmit:f,className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"tenDangNhap",className:"block text-sm font-medium text-gray-700 mb-2",children:"Tn ng nhp"}),t.jsx("input",{type:"text",id:"tenDangNhap",value:r,onChange:p=>s(p.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition",placeholder:"Nhp tn ng nhp",autoComplete:"username"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"matKhau",className:"block text-sm font-medium text-gray-700 mb-2",children:"Mt khu"}),t.jsx("input",{type:"password",id:"matKhau",value:l,onChange:p=>o(p.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition",placeholder:"Nhp mt khu",autoComplete:"current-password"})]}),t.jsx("button",{type:"submit",disabled:d,className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium rounded-lg transition flex items-center justify-center",children:d?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"ang ng nhp..."]}):"ng nhp"})]}),t.jsx("div",{className:"mt-6 text-center",children:t.jsxs("p",{className:"text-sm text-gray-500",children:["Ti khon mc nh: ",t.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:"admin"})," / ",t.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:"admin123"})]})})]})})}const MD="tinh_luong_auth",Ya=Zt.create({baseURL:"/api/kpi",headers:{"Content-Type":"application/json"}});Ya.interceptors.request.use(e=>{const n=localStorage.getItem(MD);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const Jo={layTatCa:e=>Ya.get("/template",{params:e}).then(n=>n.data),layTheoId:e=>Ya.get(`/template/${e}`).then(n=>n.data),taoMoi:e=>Ya.post("/template",e).then(n=>n.data),capNhat:(e,n)=>Ya.put(`/template/${e}`,n).then(a=>a.data),themChiTieu:(e,n)=>Ya.post(`/template/${e}/chi-tieu`,n).then(a=>a.data),xoaChiTieu:e=>Ya.delete(`/chi-tieu/${e}`).then(n=>n.data)},gf={layTatCa:e=>Ya.get("/ky-danh-gia",{params:e}).then(n=>n.data),layTheoId:e=>Ya.get(`/ky-danh-gia/${e}`).then(n=>n.data),taoMoi:e=>Ya.post("/ky-danh-gia",e).then(n=>n.data),capNhatTrangThai:(e,n)=>Ya.put(`/ky-danh-gia/${e}/trang-thai`,{trangThai:n}).then(a=>a.data)},yf={layTheoNam:e=>Ya.get(`/cau-hinh-thuong/${e}`).then(n=>n.data),taoMoi:e=>Ya.post("/cau-hinh-thuong",e).then(n=>n.data),khoiTaoMacDinh:e=>Ya.post(`/cau-hinh-thuong/khoi-tao/${e}`).then(n=>n.data)};function RD(){var E,C;const[e,n]=D.useState([]),[a,r]=D.useState([]),[s,l]=D.useState(null),[o,d]=D.useState(!0),[u,x]=D.useState(!1),[m,f]=D.useState(!1),[p,N]=D.useState({maTemplate:"",tenTemplate:"",phongBanId:"",moTa:""}),[y,g]=D.useState({maChiTieu:"",tenChiTieu:"",donViTinh:"",trongSo:0,loaiChiTieu:"SO",chiTieuToiThieu:0,chiTieuMucTieu:0,chiTieuVuotMuc:0});D.useEffect(()=>{b()},[]);const b=async()=>{try{const[S,P]=await Promise.all([Jo.layTatCa(),Jt.layTatCa()]);n(S),r(P)}catch(S){console.error("Li ti d liu:",S)}finally{d(!1)}},j=async S=>{S.preventDefault();try{await Jo.taoMoi({maTemplate:p.maTemplate,tenTemplate:p.tenTemplate,phongBanId:p.phongBanId?parseInt(p.phongBanId):void 0,moTa:p.moTa||void 0}),x(!1),N({maTemplate:"",tenTemplate:"",phongBanId:"",moTa:""}),b()}catch(P){console.error("Li to template:",P)}},T=async S=>{var P;if(S.preventDefault(),!!s)try{await Jo.themChiTieu(s.id,{...y,thuTu:(((P=s.chiTieuKPIs)==null?void 0:P.length)||0)+1}),f(!1),g({maChiTieu:"",tenChiTieu:"",donViTinh:"",trongSo:0,loaiChiTieu:"SO",chiTieuToiThieu:0,chiTieuMucTieu:0,chiTieuVuotMuc:0}),b();const F=await Jo.layTheoId(s.id);l(F)}catch(F){console.error("Li thm ch tiu:",F)}},_=async S=>{if(confirm("Xc nhn xa ch tiu ny?"))try{if(await Jo.xoaChiTieu(S),b(),s){const P=await Jo.layTheoId(s.id);l(P)}}catch(P){console.error("Li xa ch tiu:",P)}},w=S=>(S==null?void 0:S.reduce((P,F)=>P+Number(F.trongSo),0))||0;return o?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Template KPI"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Thit lp cc ch tiu nh gi KPI"})]}),t.jsxs("button",{onClick:()=>x(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm Template"]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow",children:[t.jsx("div",{className:"p-4 border-b",children:t.jsx("h2",{className:"font-semibold text-gray-800",children:"Danh sch Template"})}),t.jsx("div",{className:"divide-y max-h-[600px] overflow-y-auto",children:e.length===0?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Cha c template no"}):e.map(S=>{var P;return t.jsx("div",{onClick:()=>l(S),className:`p-4 cursor-pointer hover:bg-gray-50 ${(s==null?void 0:s.id)===S.id?"bg-blue-50 border-l-4 border-blue-500":""}`,children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-900",children:S.tenTemplate}),t.jsx("p",{className:"text-sm text-gray-500",children:S.maTemplate}),S.phongBan&&t.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded",children:S.phongBan.tenPhongBan})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("span",{className:"text-sm text-gray-600",children:[((P=S.chiTieuKPIs)==null?void 0:P.length)||0," ch tiu"]}),t.jsxs("div",{className:`text-xs mt-1 ${w(S.chiTieuKPIs)===100?"text-green-600":"text-amber-600"}`,children:["Tng: ",w(S.chiTieuKPIs),"%"]})]})]})},S.id)})})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow",children:[t.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[t.jsx("h2",{className:"font-semibold text-gray-800",children:s?s.tenTemplate:"Chi tit Template"}),s&&t.jsxs("button",{onClick:()=>f(!0),className:"text-blue-600 hover:text-blue-700 text-sm flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm ch tiu"]})]}),s?t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[t.jsxs("p",{className:"text-sm",children:[t.jsx("span",{className:"font-medium",children:"M:"})," ",s.maTemplate]}),s.moTa&&t.jsxs("p",{className:"text-sm mt-1",children:[t.jsx("span",{className:"font-medium",children:"M t:"})," ",s.moTa]}),t.jsxs("p",{className:`text-sm mt-1 ${w(s.chiTieuKPIs)===100?"text-green-600":"text-amber-600"}`,children:[t.jsx("span",{className:"font-medium",children:"Tng trng s:"})," ",w(s.chiTieuKPIs),"%",w(s.chiTieuKPIs)!==100&&" (cn = 100%)"]})]}),t.jsx("div",{className:"space-y-3",children:((E=s.chiTieuKPIs)==null?void 0:E.length)===0?t.jsx("p",{className:"text-gray-500 text-center py-4",children:"Cha c ch tiu"}):(C=s.chiTieuKPIs)==null?void 0:C.map(S=>t.jsxs("div",{className:"border rounded-lg p-3",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900",children:S.tenChiTieu}),t.jsx("p",{className:"text-sm text-gray-500",children:S.maChiTieu})]}),t.jsx("button",{onClick:()=>_(S.id),className:"text-red-500 hover:text-red-700",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),t.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Trng s:"})," ",S.trongSo,"%"]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"n v:"})," ",S.donViTinh]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Loi:"})," ",S.loaiChiTieu]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Mc tiu:"})," ",Number(S.chiTieuMucTieu).toLocaleString()]})]})]},S.id))})]}):t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Chn mt template  xem chi tit"})]})]}),u&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm Template KPI"}),t.jsxs("form",{onSubmit:j,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M template *"}),t.jsx("input",{type:"text",value:p.maTemplate,onChange:S=>N({...p,maTemplate:S.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn template *"}),t.jsx("input",{type:"text",value:p.tenTemplate,onChange:S=>N({...p,tenTemplate:S.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:p.phongBanId,onChange:S=>N({...p,phongBanId:S.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- p dng chung --"}),a.map(S=>t.jsx("option",{value:S.id,children:S.tenPhongBan},S.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:p.moTa,onChange:S=>N({...p,moTa:S.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To"})]})]})]})}),m&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm Ch tiu KPI"}),t.jsxs("form",{onSubmit:T,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M ch tiu *"}),t.jsx("input",{type:"text",value:y.maChiTieu,onChange:S=>g({...y,maChiTieu:S.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn ch tiu *"}),t.jsx("input",{type:"text",value:y.tenChiTieu,onChange:S=>g({...y,tenChiTieu:S.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n v *"}),t.jsx("input",{type:"text",value:y.donViTinh,onChange:S=>g({...y,donViTinh:S.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VN, %, S...",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng s (%) *"}),t.jsx("input",{type:"number",value:y.trongSo,onChange:S=>g({...y,trongSo:Number(S.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0,max:100,required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi *"}),t.jsxs("select",{value:y.loaiChiTieu,onChange:S=>g({...y,loaiChiTieu:S.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[t.jsx("option",{value:"SO",children:"S lng"}),t.jsx("option",{value:"PHAN_TRAM",children:"Phn trm"}),t.jsx("option",{value:"TIEN",children:"Tin"}),t.jsx("option",{value:"DANH_GIA",children:"nh gi (1-5)"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ti thiu"}),t.jsx("input",{type:"number",value:y.chiTieuToiThieu,onChange:S=>g({...y,chiTieuToiThieu:Number(S.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mc tiu"}),t.jsx("input",{type:"number",value:y.chiTieuMucTieu,onChange:S=>g({...y,chiTieuMucTieu:Number(S.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vt mc"}),t.jsx("input",{type:"number",value:y.chiTieuVuotMuc,onChange:S=>g({...y,chiTieuVuotMuc:Number(S.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Thm"})]})]})]})})]})}const BD={THANG:"Thng",QUY:"Qu",NAM:"Nm"},Kb={CHUA_BAT_DAU:{label:"Cha bt u",color:"bg-gray-100 text-gray-600"},DANG_DIEN_RA:{label:"ang din ra",color:"bg-green-100 text-green-700"},DA_KET_THUC:{label:" kt thc",color:"bg-blue-100 text-blue-700"},DA_DONG:{label:" ng",color:"bg-red-100 text-red-700"}};function HD(){const[e,n]=D.useState([]),[a,r]=D.useState(!0),[s,l]=D.useState(!1),[o,d]=D.useState(new Date().getFullYear()),[u,x]=D.useState({maKy:"",tenKy:"",loaiKy:"THANG",tuNgay:"",denNgay:"",moTa:""});D.useEffect(()=>{m()},[o]);const m=async()=>{r(!0);try{const y=await gf.layTatCa({nam:o});n(y)}catch(y){console.error("Li ti d liu:",y)}finally{r(!1)}},f=async y=>{y.preventDefault();try{await gf.taoMoi({...u,moTa:u.moTa||void 0}),l(!1),x({maKy:"",tenKy:"",loaiKy:"THANG",tuNgay:"",denNgay:"",moTa:""}),m()}catch(g){console.error("Li to k nh gi:",g)}},p=async(y,g)=>{try{await gf.capNhatTrangThai(y,g),m()}catch(b){console.error("Li cp nht trng thi:",b)}},N=y=>new Date(y).toLocaleDateString("vi-VN");return a?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"K nh Gi KPI"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Qun l cc k nh gi hiu sut"})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx("select",{value:o,onChange:y=>d(Number(y.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(y=>t.jsxs("option",{value:y,children:["Nm ",y]},y))}),t.jsxs("button",{onClick:()=>l(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm K nh Gi"]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M k"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tn k"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Loi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"S nh gi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.length===0?t.jsx("tr",{children:t.jsxs("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:["Cha c k nh gi no trong nm ",o]})}):e.map(y=>{var g;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"font-mono text-sm text-gray-900",children:y.maKy})}),t.jsxs("td",{className:"px-6 py-4",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:y.tenKy}),y.moTa&&t.jsx("div",{className:"text-xs text-gray-500",children:y.moTa})]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded",children:BD[y.loaiKy]})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:[N(y.tuNgay)," - ",N(y.denNgay)]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 py-1 text-xs rounded ${Kb[y.trangThai].color}`,children:Kb[y.trangThai].label})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:((g=y._count)==null?void 0:g.danhGias)||0}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:t.jsxs("div",{className:"flex gap-2",children:[y.trangThai==="CHUA_BAT_DAU"&&t.jsx("button",{onClick:()=>p(y.id,"DANG_DIEN_RA"),className:"text-green-600 hover:text-green-800",children:"Bt u"}),y.trangThai==="DANG_DIEN_RA"&&t.jsx("button",{onClick:()=>p(y.id,"DA_KET_THUC"),className:"text-blue-600 hover:text-blue-800",children:"Kt thc"}),y.trangThai==="DA_KET_THUC"&&t.jsx("button",{onClick:()=>p(y.id,"DA_DONG"),className:"text-red-600 hover:text-red-800",children:"ng"}),t.jsx("a",{href:`/kpi/ky-danh-gia/${y.id}`,className:"text-indigo-600 hover:text-indigo-800",children:"Chi tit"})]})})]},y.id)})})]})}),s&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm K nh Gi"}),t.jsxs("form",{onSubmit:f,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M k *"}),t.jsx("input",{type:"text",value:u.maKy,onChange:y=>x({...u,maKy:y.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: KPI-2026-Q1",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi k *"}),t.jsxs("select",{value:u.loaiKy,onChange:y=>x({...u,loaiKy:y.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[t.jsx("option",{value:"THANG",children:"Thng"}),t.jsx("option",{value:"QUY",children:"Qu"}),t.jsx("option",{value:"NAM",children:"Nm"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn k *"}),t.jsx("input",{type:"text",value:u.tenKy,onChange:y=>x({...u,tenKy:y.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: nh gi KPI Qu 1/2026",required:!0})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T ngy *"}),t.jsx(Gt,{value:u.tuNgay,onChange:y=>x({...u,tuNgay:y}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n ngy *"}),t.jsx(Gt,{value:u.denNgay,onChange:y=>x({...u,denNgay:y}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:u.moTa,onChange:y=>x({...u,moTa:y.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To"})]})]})]})})]})}const vf={XUAT_SAC:{label:"Xut sc",color:"bg-purple-100 text-purple-700"},TOT:{label:"Tt",color:"bg-green-100 text-green-700"},KHA:{label:"Kh",color:"bg-blue-100 text-blue-700"},TRUNG_BINH:{label:"Trung bnh",color:"bg-yellow-100 text-yellow-700"},YEU:{label:"Yu",color:"bg-red-100 text-red-700"}};function VD(){const[e,n]=D.useState([]),[a,r]=D.useState(!0),[s,l]=D.useState(new Date().getFullYear()),[o,d]=D.useState(!1),[u,x]=D.useState({xepLoai:"TOT",diemToiThieu:0,diemToiDa:100,heSoThuong:1,moTa:""});D.useEffect(()=>{m()},[s]);const m=async()=>{r(!0);try{const N=await yf.layTheoNam(s);n(N)}catch(N){console.error("Li ti d liu:",N)}finally{r(!1)}},f=async()=>{if(confirm(`Khi to cu hnh thng mc nh cho nm ${s}?`))try{await yf.khoiTaoMacDinh(s),m()}catch(N){console.error("Li khi to:",N)}},p=async N=>{N.preventDefault();try{await yf.taoMoi({nam:s,...u,moTa:u.moTa||void 0}),d(!1),m()}catch(y){console.error("Li to cu hnh:",y)}};return a?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Cu hnh Thng KPI"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Thit lp h s thng theo mc xp loi"})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx("select",{value:s,onChange:N=>l(Number(N.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(N=>t.jsxs("option",{value:N,children:["Nm ",N]},N))}),t.jsx("button",{onClick:f,className:"border border-blue-600 text-blue-600 hover:bg-blue-50 px-4 py-2 rounded-lg",children:"Khi to mc nh"}),t.jsxs("button",{onClick:()=>d(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm Cu hnh"]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Xp loi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"im ti thiu"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"im ti a"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"H s thng"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M t"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Trng thi"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.length===0?t.jsx("tr",{children:t.jsxs("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:[t.jsxs("p",{children:["Cha c cu hnh thng cho nm ",s]}),t.jsx("button",{onClick:f,className:"mt-4 text-blue-600 hover:text-blue-700 underline",children:"Khi to cu hnh mc nh"})]})}):e.map(N=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-3 py-1 text-sm rounded-full font-medium ${vf[N.xepLoai].color}`,children:vf[N.xepLoai].label})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("span",{className:"text-gray-900 font-mono",children:[Number(N.diemToiThieu).toFixed(1),"%"]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("span",{className:"text-gray-900 font-mono",children:[Number(N.diemToiDa).toFixed(2),"%"]})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[t.jsxs("span",{className:"text-lg font-semibold text-indigo-600",children:[Number(N.heSoThuong),"x"]}),t.jsx("span",{className:"text-gray-500 text-sm ml-1",children:"lng c bn"})]}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("span",{className:"text-gray-600 text-sm",children:N.moTa||"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 py-1 text-xs rounded ${N.trangThai?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:N.trangThai?"Hot ng":"Ngng"})})]},N.id))})]})}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[t.jsx("h3",{className:"font-semibold text-blue-800 mb-3",children:" Cng thc tnh thng KPI"}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-blue-700",children:[t.jsxs("div",{children:[t.jsx("p",{children:t.jsx("strong",{children:"Tin thng = Lng c bn  H s thng"})}),t.jsx("p",{className:"mt-2",children:'V d: Nhn vin lng 15,000,000, xp loi "Tt" (h s 1.5x)'}),t.jsxs("p",{children:[" Thng = 15,000,000  1.5 = ",t.jsx("strong",{children:"22,500,000"})]})]}),t.jsxs("div",{children:[t.jsx("p",{children:t.jsx("strong",{children:"im KPI c tnh t:"})}),t.jsxs("ul",{className:"list-disc ml-4 mt-2",children:[t.jsx("li",{children:"Tng im =  (im ch tiu  Trng s)"}),t.jsx("li",{children:"im ch tiu = (Kt qu / Mc tiu)  100"}),t.jsx("li",{children:"Ti a 150% nu vt mc"})]})]})]})]}),o&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm Cu hnh Thng"}),t.jsxs("form",{onSubmit:p,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Xp loi *"}),t.jsx("select",{value:u.xepLoai,onChange:N=>x({...u,xepLoai:N.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:Object.entries(vf).map(([N,{label:y}])=>t.jsx("option",{value:N,children:y},N))})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"im ti thiu *"}),t.jsx("input",{type:"number",step:"0.01",value:u.diemToiThieu,onChange:N=>x({...u,diemToiThieu:Number(N.target.value)}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"im ti a *"}),t.jsx("input",{type:"number",step:"0.01",value:u.diemToiDa,onChange:N=>x({...u,diemToiDa:Number(N.target.value)}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"H s thng *"}),t.jsx("input",{type:"number",step:"0.1",value:u.heSoThuong,onChange:N=>x({...u,heSoThuong:Number(N.target.value)}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("input",{type:"text",value:u.moTa,onChange:N=>x({...u,moTa:N.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To"})]})]})]})})]})}const zb={HOAT_DONG:{label:"Hot ng",color:"bg-green-100 text-green-700"},TAM_KHOA:{label:"Tm kha",color:"bg-yellow-100 text-yellow-700"},NGUNG_HOAT_DONG:{label:"Ngng",color:"bg-red-100 text-red-700"}};function UD(){const[e,n]=D.useState([]),[a,r]=D.useState([]),[s,l]=D.useState(!0),[o,d]=D.useState(!1),[u,x]=D.useState("nguoi-dung"),[m,f]=D.useState({tenDangNhap:"",matKhau:"",hoTen:"",email:"",soDienThoai:"",vaiTroIds:[]}),[p,N]=D.useState({maVaiTro:"",tenVaiTro:"",moTa:"",capDo:50});D.useEffect(()=>{y()},[]);const y=async()=>{try{const[w,E]=await Promise.all([hf.layTatCa(),Eb.layTatCa()]);n(w),r(E)}catch(w){console.error("Li ti d liu:",w)}finally{l(!1)}},g=async w=>{w.preventDefault();try{await hf.taoMoi({tenDangNhap:m.tenDangNhap,matKhau:m.matKhau,hoTen:m.hoTen,email:m.email,soDienThoai:m.soDienThoai||void 0,vaiTroIds:m.vaiTroIds}),d(!1),f({tenDangNhap:"",matKhau:"",hoTen:"",email:"",soDienThoai:"",vaiTroIds:[]}),y()}catch(E){console.error("Li to ngi dng:",E)}},b=async w=>{w.preventDefault();try{await Eb.taoMoi({maVaiTro:p.maVaiTro,tenVaiTro:p.tenVaiTro,moTa:p.moTa||void 0,capDo:p.capDo}),d(!1),N({maVaiTro:"",tenVaiTro:"",moTa:"",capDo:50}),y()}catch(E){console.error("Li to vai tr:",E)}},j=async(w,E)=>{try{await hf.capNhat(w,{trangThai:E}),y()}catch(C){console.error("Li cp nht:",C)}},T=w=>{f(E=>({...E,vaiTroIds:E.vaiTroIds.includes(w)?E.vaiTroIds.filter(C=>C!==w):[...E.vaiTroIds,w]}))},_=w=>w?new Date(w).toLocaleString("vi-VN"):"-";return s?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Ngi dng & Vai tr"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Phn quyn truy cp h thng"})]}),t.jsxs("button",{onClick:()=>d(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),u==="nguoi-dung"?"Thm Ngi dng":"Thm Vai tr"]})]}),t.jsx("div",{className:"border-b border-gray-200",children:t.jsxs("nav",{className:"-mb-px flex gap-6",children:[t.jsxs("button",{onClick:()=>x("nguoi-dung"),className:`py-3 px-1 border-b-2 font-medium text-sm ${u==="nguoi-dung"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Ngi dng (",e.length,")"]}),t.jsxs("button",{onClick:()=>x("vai-tro"),className:`py-3 px-1 border-b-2 font-medium text-sm ${u==="vai-tro"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Vai tr (",a.length,")"]})]})}),u==="nguoi-dung"?t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngi dng"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Vai tr"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ng nhp cui"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(w=>{var E,C,S;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:t.jsx("span",{className:"text-blue-600 font-medium",children:w.hoTen.charAt(0).toUpperCase()})}),t.jsxs("div",{className:"ml-3",children:[t.jsx("div",{className:"font-medium text-gray-900",children:w.hoTen}),t.jsxs("div",{className:"text-sm text-gray-500",children:["@",w.tenDangNhap]})]})]})}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:w.email}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("div",{className:"flex flex-wrap gap-1",children:((E=w.vaiTros)==null?void 0:E.map(P=>t.jsx("span",{className:"px-2 py-0.5 bg-indigo-100 text-indigo-700 text-xs rounded",children:P.vaiTro.tenVaiTro},P.id)))||t.jsx("span",{className:"text-gray-400 text-sm",children:"Cha gn"})})}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:_(w.lanDangNhapCuoi)}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("span",{className:`px-2 py-1 text-xs rounded ${((C=zb[w.trangThai])==null?void 0:C.color)||"bg-gray-100"}`,children:((S=zb[w.trangThai])==null?void 0:S.label)||w.trangThai})}),t.jsx("td",{className:"px-6 py-4 text-sm",children:t.jsxs("div",{className:"flex gap-2",children:[w.trangThai==="HOAT_DONG"&&t.jsx("button",{onClick:()=>j(w.id,"TAM_KHOA"),className:"text-yellow-600 hover:text-yellow-800",children:"Kha"}),w.trangThai==="TAM_KHOA"&&t.jsx("button",{onClick:()=>j(w.id,"HOAT_DONG"),className:"text-green-600 hover:text-green-800",children:"M kha"})]})})]},w.id)})})]})}):t.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map(w=>{var E,C,S,P,F;return t.jsxs("div",{className:"bg-white rounded-lg shadow p-5",children:[t.jsxs("div",{className:"flex justify-between items-start mb-3",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:w.tenVaiTro}),t.jsx("p",{className:"text-sm text-gray-500 font-mono",children:w.maVaiTro})]}),t.jsx("span",{className:`px-2 py-1 text-xs rounded ${w.trangThai?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:w.trangThai?"Hot ng":"Ngng"})]}),w.moTa&&t.jsx("p",{className:"text-sm text-gray-600 mb-3",children:w.moTa}),t.jsxs("div",{className:"flex justify-between items-center text-sm",children:[t.jsxs("span",{className:"text-gray-500",children:["Cp : ",w.capDo]}),t.jsxs("span",{className:"text-indigo-600",children:[((E=w._count)==null?void 0:E.nguoiDungs)||0," ngi dng"]})]}),t.jsxs("div",{className:"mt-3 pt-3 border-t",children:[t.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:["Quyn (",((C=w.quyens)==null?void 0:C.length)||0,"):"]}),t.jsxs("div",{className:"flex flex-wrap gap-1 max-h-20 overflow-y-auto",children:[(S=w.quyens)==null?void 0:S.slice(0,8).map(B=>t.jsx("span",{className:"px-1.5 py-0.5 bg-gray-100 text-gray-600 text-xs rounded",children:B.quyen.tenQuyen},B.id)),(((P=w.quyens)==null?void 0:P.length)||0)>8&&t.jsxs("span",{className:"px-1.5 py-0.5 bg-gray-200 text-gray-700 text-xs rounded",children:["+",(((F=w.quyens)==null?void 0:F.length)||0)-8," quyn"]})]})]})]},w.id)})}),o&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:u==="nguoi-dung"?"Thm Ngi dng":"Thm Vai tr"}),u==="nguoi-dung"?t.jsxs("form",{onSubmit:g,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn ng nhp *"}),t.jsx("input",{type:"text",value:m.tenDangNhap,onChange:w=>f({...m,tenDangNhap:w.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mt khu *"}),t.jsx("input",{type:"password",value:m.matKhau,onChange:w=>f({...m,matKhau:w.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"H tn *"}),t.jsx("input",{type:"text",value:m.hoTen,onChange:w=>f({...m,hoTen:w.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),t.jsx("input",{type:"email",value:m.email,onChange:w=>f({...m,email:w.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vai tr"}),t.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:a.map(w=>t.jsxs("label",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"checkbox",checked:m.vaiTroIds.includes(w.id),onChange:()=>T(w.id),className:"rounded"}),t.jsx("span",{className:"text-sm",children:w.tenVaiTro})]},w.id))})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border rounded-lg",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:"To"})]})]}):t.jsxs("form",{onSubmit:b,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M vai tr *"}),t.jsx("input",{type:"text",value:p.maVaiTro,onChange:w=>N({...p,maVaiTro:w.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: SUPERVISOR",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn vai tr *"}),t.jsx("input",{type:"text",value:p.tenVaiTro,onChange:w=>N({...p,tenVaiTro:w.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cp "}),t.jsx("input",{type:"number",value:p.capDo,onChange:w=>N({...p,capDo:Number(w.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:1,max:100})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:p.moTa,onChange:w=>N({...p,moTa:w.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border rounded-lg",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:"To"})]})]})]})})]})}const bf={TAO:{label:"To mi",color:"bg-green-100 text-green-700",icon:""},SUA:{label:"Cp nht",color:"bg-blue-100 text-blue-700",icon:""},XOA:{label:"Xa",color:"bg-red-100 text-red-700",icon:""},XEM:{label:"Xem",color:"bg-gray-100 text-gray-700",icon:""},DANG_NHAP:{label:"ng nhp",color:"bg-indigo-100 text-indigo-700",icon:""},DANG_XUAT:{label:"ng xut",color:"bg-purple-100 text-purple-700",icon:""},CHOT:{label:"Cht",color:"bg-yellow-100 text-yellow-700",icon:""},MO_KHOA:{label:"M kha",color:"bg-cyan-100 text-cyan-700",icon:""},DUYET:{label:"Duyt",color:"bg-emerald-100 text-emerald-700",icon:""},TU_CHOI:{label:"T chi",color:"bg-orange-100 text-orange-700",icon:""}};function KD(){var j,T;const[e,n]=D.useState([]),[a,r]=D.useState(!0),[s,l]=D.useState(null),[o,d]=D.useState(""),[u,x]=D.useState(""),[m,f]=D.useState(""),[p,N]=D.useState("");D.useEffect(()=>{y()},[o,u,m,p]);const y=async()=>{r(!0);try{const _=await _E.layDanhSach({hanhDong:o||void 0,bangDuLieu:u||void 0,tuNgay:m||void 0,denNgay:p||void 0}),w=Array.isArray(_)?_:(_==null?void 0:_.items)||[];n(w)}catch(_){console.error("Li ti d liu:",_)}finally{r(!1)}},g=_=>new Date(_).toLocaleString("vi-VN"),b=_=>_?JSON.stringify(_,null,2):null;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Audit Log"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Lch s thao tc trn h thng"})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hnh ng"}),t.jsxs("select",{value:o,onChange:_=>d(_.target.value),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),Object.entries(bf).map(([_,{label:w}])=>t.jsx("option",{value:_,children:w},_))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bng d liu"}),t.jsxs("select",{value:u,onChange:_=>x(_.target.value),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"NhanVien",children:"Nhn vin"}),t.jsx("option",{value:"BangLuong",children:"Bng lng"}),t.jsx("option",{value:"KhoanLuong",children:"Khon lng"}),t.jsx("option",{value:"PhongBan",children:"Phng ban"}),t.jsx("option",{value:"NguoiDung",children:"Ngi dng"}),t.jsx("option",{value:"DanhGiaKPI",children:"nh gi KPI"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T ngy"}),t.jsx(Gt,{value:m,onChange:f,className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n ngy"}),t.jsx(Gt,{value:p,onChange:N,className:"w-full border rounded-lg px-3 py-2"})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:a?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):e.length===0?t.jsx("div",{className:"p-12 text-center text-gray-500",children:"Khng c d liu audit log"}):t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngi dng"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Hnh ng"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Bng d liu"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ID bn ghi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Chi tit"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(_=>{const w=bf[_.hanhDong]||{label:_.hanhDong,color:"bg-gray-100",icon:""};return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:g(_.ngayTao)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:_.nguoiDung?t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:t.jsx("span",{className:"text-blue-600 text-xs font-medium",children:_.nguoiDung.hoTen.charAt(0)})}),t.jsx("span",{className:"ml-2 text-sm text-gray-900",children:_.nguoiDung.hoTen})]}):t.jsx("span",{className:"text-gray-400 text-sm",children:"H thng"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("span",{className:`px-2 py-1 text-xs rounded ${w.color}`,children:[w.icon," ",w.label]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:_.bangDuLieu||"-"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 font-mono",children:_.banGhiId||"-"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(_.duLieuCu||_.duLieuMoi)&&t.jsx("button",{onClick:()=>l(_),className:"text-blue-600 hover:text-blue-800 text-sm",children:"Xem chi tit"})})]},_.id)})})]})}),s&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-3xl max-h-[80vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex justify-between items-start mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Chi tit thay i"}),t.jsx("button",{onClick:()=>l(null),className:"text-gray-400 hover:text-gray-600",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Thi gian:"})," ",g(s.ngayTao)]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Ngi dng:"})," ",((j=s.nguoiDung)==null?void 0:j.hoTen)||"H thng"]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Hnh ng:"})," ",(T=bf[s.hanhDong])==null?void 0:T.label]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Bng:"})," ",s.bangDuLieu," #",s.banGhiId]}),s.ipAddress&&t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"IP:"})," ",s.ipAddress]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.duLieuCu&&t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-red-600 mb-2",children:"D liu c"}),t.jsx("pre",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-xs overflow-x-auto",children:b(s.duLieuCu)})]}),s.duLieuMoi&&t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-green-600 mb-2",children:"D liu mi"}),t.jsx("pre",{className:"bg-green-50 border border-green-200 rounded-lg p-3 text-xs overflow-x-auto",children:b(s.duLieuMoi)})]})]})]})})]})}const zD="tinh_luong_auth",St=Zt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});St.interceptors.request.use(e=>{const n=localStorage.getItem(zD);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const qs={layDanhSach:e=>St.get("/quy-che-luong",{params:e}).then(n=>n.data),layChiTiet:e=>St.get(`/quy-che-luong/${e}`).then(n=>n.data),tao:e=>St.post("/quy-che-luong",e).then(n=>n.data),capNhat:(e,n)=>St.put(`/quy-che-luong/${e}`,n).then(a=>a.data),nhanBan:(e,n)=>St.post(`/quy-che-luong/${e}/nhan-ban`,n).then(a=>a.data),kichHoat:e=>St.post(`/quy-che-luong/${e}/kich-hoat`).then(n=>n.data),ngung:e=>St.post(`/quy-che-luong/${e}/ngung`).then(n=>n.data),xoa:e=>St.delete(`/quy-che-luong/${e}`).then(n=>n.data),layRules:e=>St.get(`/quy-che-luong/${e}/rules`).then(n=>n.data),taoRule:(e,n)=>St.post(`/quy-che-luong/${e}/rule`,n).then(a=>a.data),sapXepRules:(e,n)=>St.put(`/quy-che-luong/${e}/sap-xep-rule`,{danhSachRuleId:n}).then(a=>a.data)},Md={layChiTiet:e=>St.get(`/quy-che-rule/${e}`).then(n=>n.data),capNhat:(e,n)=>St.put(`/quy-che-rule/${e}`,n).then(a=>a.data),xoa:e=>St.delete(`/quy-che-rule/${e}`).then(n=>n.data),validate:e=>St.post("/quy-che-rule/validate",e).then(n=>n.data),preview:e=>St.post("/quy-che-rule/preview",e).then(n=>n.data)},Al={layDanhSach:e=>St.get("/su-kien-thuong-phat",{params:e}).then(n=>n.data),layChiTiet:e=>St.get(`/su-kien-thuong-phat/${e}`).then(n=>n.data),tao:e=>St.post("/su-kien-thuong-phat",e).then(n=>n.data),capNhat:(e,n)=>St.put(`/su-kien-thuong-phat/${e}`,n).then(a=>a.data),duyet:(e,n)=>St.post(`/su-kien-thuong-phat/${e}/duyet`,{duyetBoi:n.duyetBoi||"admin",ghiChu:n.lyDo}).then(a=>a.data),duyetNhieu:e=>St.post("/su-kien-thuong-phat/duyet-nhieu",{ids:e.danhSachId,duyetBoi:e.duyetBoi||"admin"}).then(n=>n.data),huy:e=>St.post(`/su-kien-thuong-phat/${e}/huy`).then(n=>n.data),thongKe:(e,n,a)=>St.get(`/su-kien-thuong-phat/thong-ke/${e}`,{params:{thang:n,nam:a}}).then(r=>r.data),layDanhMucSuKien:e=>St.get("/su-kien-thuong-phat/danh-muc",{params:{loai:e}}).then(n=>n.data),taoDanhMucSuKien:e=>St.post("/su-kien-thuong-phat/danh-muc",e).then(n=>n.data),khoiTaoDanhMucMau:()=>St.post("/su-kien-thuong-phat/khoi-tao-danh-muc-mau").then(e=>e.data)},$D={chay:(e,n)=>St.post(`/bang-luong/${e}/chay-rule-engine`,{nguoiThucHien:n}).then(a=>a.data),xemTrace:(e,n)=>St.get(`/bang-luong/${e}/rule-trace`,{params:n?{nhanVienId:n}:void 0}).then(a=>a.data)},Rd={goiYRule:(e,n,a)=>St.post("/tro-ly-ai/goi-y-rule",{phongBanId:e,quyCheId:n,noiDungTiengViet:a}).then(r=>r.data),layContext:(e,n)=>St.get(`/tro-ly-ai/context/${e}/${n}`).then(a=>a.data),apDungRule:(e,n,a)=>St.post(`/tro-ly-ai/ap-dung/${e}`,{auditId:n,ruleDeXuat:a}).then(r=>r.data),huyDeXuat:e=>St.post(`/tro-ly-ai/huy/${e}`).then(n=>n.data),lichSuDeXuat:e=>St.get(`/tro-ly-ai/lich-su/${e}`).then(n=>n.data)},GD=({trangThai:e})=>{const a={NHAP:{bg:"bg-gray-100",text:"text-gray-800",label:"Nhp"},HIEU_LUC:{bg:"bg-green-100",text:"text-green-800",label:"Hiu lc"},TAM_DUNG:{bg:"bg-yellow-100",text:"text-yellow-800",label:"Tm dng"},NGUNG:{bg:"bg-red-100",text:"text-red-800",label:"Ngng"}}[e];return t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${a.bg} ${a.text}`,children:a.label})};function qD(){const e=br(),[n,a]=D.useState([]),[r,s]=D.useState([]),[l,o]=D.useState(!1),[d,u]=D.useState(""),[x,m]=D.useState(!1),[f,p]=D.useState({phongBanId:0,tenQuyChe:"",moTa:"",tuNgay:new Date().toISOString().split("T")[0]});D.useEffect(()=>{N(),y()},[d]);const N=async()=>{try{const C=await Jt.layTatCa();s(C)}catch(C){console.error("Li load phng ban:",C)}},y=async()=>{o(!0);try{const C=d?{phongBanId:d}:{},S=await qs.layDanhSach(C);a(S)}catch(C){console.error("Li load quy ch:",C)}finally{o(!1)}},g=C=>{var F,B;const S=C,P=(B=(F=S.response)==null?void 0:F.data)==null?void 0:B.message;return Array.isArray(P)?P.join(`
`):P||S.message||"Li to quy ch"},b=async()=>{if(!f.phongBanId||!f.tenQuyChe||!f.tuNgay){alert("Vui lng nhp y  thng tin");return}try{await qs.tao({phongBanId:f.phongBanId,tenQuyChe:f.tenQuyChe,moTa:f.moTa,tuNgay:new Date(f.tuNgay)}),m(!1),p({phongBanId:0,tenQuyChe:"",moTa:"",tuNgay:new Date().toISOString().split("T")[0]}),y()}catch(C){console.error("Li to quy ch:",C),alert(g(C))}},j=async C=>{if(confirm("Kch hot quy ch ny? Cc quy ch khc cng phng ban s b ngng."))try{await qs.kichHoat(C),y()}catch(S){console.error("Li kch hot:",S),alert("Li kch hot quy ch")}},T=async C=>{if(confirm("Ngng quy ch ny?"))try{await qs.ngung(C),y()}catch(S){console.error("Li ngng:",S),alert("Li ngng quy ch")}},_=async(C,S)=>{const P=prompt("Tn quy ch mi:",`${S} (v2)`);if(P)try{const F=await qs.nhanBan(C,{tenQuyChe:P,tuNgay:new Date});e(`/quy-che/${F.id}`)}catch(F){console.error("Li nhn bn:",F),alert("Li nhn bn quy ch")}},w=async C=>{if(confirm("Xa quy ch ny? Ch c th xa quy ch ang  trng thi Nhp."))try{await qs.xoa(C),y()}catch(S){console.error("Li xa:",S),alert("Khng th xa quy ch ny")}},E=n.reduce((C,S)=>{var F;const P=((F=S.phongBan)==null?void 0:F.tenPhongBan)||"Khc";return C[P]||(C[P]=[]),C[P].push(S),C},{});return t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Quy ch lng"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Cu hnh quy ch lng theo phng ban vi cc rule t ng"})]}),t.jsxs("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"To quy ch mi"]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:t.jsx("div",{className:"flex items-center gap-4",children:t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:d,onChange:C=>u(C.target.value?Number(C.target.value):""),className:"border rounded-lg px-3 py-2 min-w-[200px]",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),r.map(C=>t.jsx("option",{value:C.id,children:C.tenPhongBan},C.id))]})]})})}),l&&t.jsx("div",{className:"text-center py-10",children:t.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}),!l&&t.jsxs("div",{className:"space-y-6",children:[Object.entries(E).map(([C,S])=>t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b",children:t.jsx("h2",{className:"font-semibold text-gray-900",children:C})}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tn quy ch"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Phin bn"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"S rule"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"T ngy"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:S.map(P=>{var F;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsxs("td",{className:"px-4 py-3",children:[t.jsx("button",{onClick:()=>e(`/quy-che/${P.id}`),className:"text-blue-600 hover:text-blue-800 font-medium",children:P.tenQuyChe}),P.moTa&&t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:P.moTa})]}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-sm",children:["v",P.phienBan]})}),t.jsx("td",{className:"px-4 py-3 text-center",children:((F=P._count)==null?void 0:F.rules)||0}),t.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-600",children:new Date(P.tuNgay).toLocaleDateString("vi-VN")}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx(GD,{trangThai:P.trangThai})}),t.jsx("td",{className:"px-4 py-3 text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx("button",{onClick:()=>e(`/quy-che/${P.id}`),className:"p-1 text-gray-400 hover:text-blue-600",title:"Cu hnh",children:t.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),P.trangThai==="NHAP"&&t.jsx("button",{onClick:()=>j(P.id),className:"p-1 text-gray-400 hover:text-green-600",title:"Kch hot",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),P.trangThai==="HIEU_LUC"&&t.jsx("button",{onClick:()=>T(P.id),className:"p-1 text-gray-400 hover:text-yellow-600",title:"Ngng",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("button",{onClick:()=>_(P.id,P.tenQuyChe),className:"p-1 text-gray-400 hover:text-purple-600",title:"Nhn bn",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),P.trangThai==="NHAP"&&t.jsx("button",{onClick:()=>w(P.id),className:"p-1 text-gray-400 hover:text-red-600",title:"Xa",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},P.id)})})]})]},C)),Object.keys(E).length===0&&t.jsx("div",{className:"bg-white rounded-lg shadow p-10 text-center text-gray-500",children:'Cha c quy ch no. Bm "To quy ch mi"  bt u.'})]}),x&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[t.jsx("div",{className:"px-6 py-4 border-b",children:t.jsx("h3",{className:"text-lg font-semibold",children:"To quy ch mi"})}),t.jsxs("div",{className:"px-6 py-4 space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Phng ban ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("select",{value:f.phongBanId,onChange:C=>p({...f,phongBanId:Number(C.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn phng ban --"}),r.map(C=>t.jsx("option",{value:C.id,children:C.tenPhongBan},C.id))]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn quy ch ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:f.tenQuyChe,onChange:C=>p({...f,tenQuyChe:C.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Quy ch lng phng Kho 2026"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:f.moTa,onChange:C=>p({...f,moTa:C.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:3,placeholder:"M t quy ch..."})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["p dng t ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Gt,{value:f.tuNgay,onChange:C=>p({...f,tuNgay:C}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"px-6 py-4 border-t flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:b,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To quy ch"})]})]})})]})}const WD=["Pht i tr: 1-2 ln 50k/ln, t ln 3 tr ln 100k/ln","Trch nhim kho: cp 1 500k, cp 2 1tr, cp 3 1.5tr","Tin trch nhim = lng c bn * 0.15","Thng chuyn cn: 200k/thng nu khng ngh","Ph cp trch nhim c nh 500k/thng"],Nf={CO_DINH:"C nh",THEO_HE_SO:"Theo h s",BAC_THANG:"Bc thang",THEO_SU_KIEN:"Theo s kin",CONG_THUC:"Cng thc"},$b={CONG_DON:"Cng dn",GHI_DE:"Ghi "};function XD({isOpen:e,onClose:n,phongBanId:a,quyCheId:r,onRuleApplied:s}){const l=D.useRef(null),o=D.useRef(null),[d,u]=D.useState(""),[x,m]=D.useState(!1),[f,p]=D.useState(null),[N,y]=D.useState(null),[g,b]=D.useState(!1),[j,T]=D.useState(!1),[_,w]=D.useState(null),[E,C]=D.useState(!1),[S,P]=D.useState(null),[F,B]=D.useState(!1),[O,M]=D.useState(null),[G,J]=D.useState("goi-y"),[X,fe]=D.useState(!1),[ne,H]=D.useState(!1),[W,xe]=D.useState(!1),[K,L]=D.useState({luongCoBan:1e7,capTrachNhiem:2,heSoTrachNhiem:1.2,soLanDiTre:3,soLanNghiKhongPhep:0});D.useEffect(()=>{e&&a&&r&&(Rd.layContext(a,r).then(y).catch(console.error),setTimeout(()=>{var ke;return(ke=l.current)==null?void 0:ke.focus()},100))},[e,a,r]),D.useEffect(()=>{e||(u(""),p(null),w(null),P(null),M(null),B(!1),fe(!1),H(!1),xe(!1))},[e]);const Q=D.useCallback(ke=>{e&&(ke.key==="Escape"&&n(),(ke.ctrlKey||ke.metaKey)&&ke.key==="Enter"&&d.trim()&&!x&&ke.preventDefault())},[e,d,x,n]);D.useEffect(()=>(document.addEventListener("keydown",Q),()=>document.removeEventListener("keydown",Q)),[Q]);const I=async()=>{if(d.trim()){m(!0),p(null),w(null),P(null);try{const ke=await Rd.goiYRule(a,r,d);p(ke),ke.ruleDeXuat&&M({...ke.ruleDeXuat})}catch(ke){console.error("Li gi  rule:",ke),p({hopLeSoBo:!1,canLamRo:["C li xy ra khi x l yu cu. Vui lng th li."]})}finally{m(!1)}}},R=async()=>{if(!O)return;const ke=le();if(ke.length>0){w({hopLe:!1,loi:["[Client] "+ke.join(", [Client] ")]});return}T(!0);try{const Ke=await Md.validate({loaiRule:O.loaiRule,dieuKienJson:O.dieuKienJson,congThucJson:O.congThucJson});w({hopLe:Ke.hopLe,loi:Ke.danhSachLoi||[]})}catch(Ke){console.error("Li validate:",Ke),w({hopLe:!1,loi:["C li xy ra khi validate server"]})}finally{T(!1)}},te=async()=>{if(O){C(!0);try{const ke=await Md.preview({quyCheId:r,duLieuGiaLap:K});P({soTien:ke.tongTien,trace:ke.trace.map(Ke=>`${Ke.ruleName}: ${Ke.message}  ${Ke.output.toLocaleString("vi-VN")}`).join(`
`)})}catch(ke){console.error("Li preview:",ke)}finally{C(!1)}}},ue=async()=>{if(O)try{await navigator.clipboard.writeText(JSON.stringify(O,null,2)),xe(!0),setTimeout(()=>xe(!1),2e3)}catch(ke){console.error("Li copy:",ke)}},V=()=>{f!=null&&f.ruleDeXuat&&M({...f.ruleDeXuat})},le=()=>{const ke=[];if(!O)return["Khng c rule  validate"];(!O.tenRule||O.tenRule.trim().length<3)&&ke.push("Tn rule phi c t nht 3 k t"),O.khoanLuongMa||ke.push("Cha chn khon lng");const Ke=O.congThucJson;switch(O.loaiRule){case"CO_DINH":(!Ke.soTien||Ke.soTien<=0)&&ke.push("S tin c nh phi ln hn 0");break;case"THEO_HE_SO":Ke.base||ke.push("Cha chn ngun tnh (base)"),(!Ke.heSo||Ke.heSo<=0)&&ke.push("H s phi ln hn 0");break;case"BAC_THANG":{const tt=Ke.bac;!tt||tt.length===0?ke.push("Phi c t nht 1 bc thang"):tt.forEach((Xe,Oe)=>{(Xe.from===void 0||Xe.to===void 0)&&ke.push(`Bc ${Oe+1}: Cha nh ngha khong from-to`),!Xe.soTien&&!Xe.soTienMoiLan&&ke.push(`Bc ${Oe+1}: Cha nh ngha s tin`)})}break;case"CONG_THUC":(!Ke.bieuThuc||Ke.bieuThuc.trim().length===0)&&ke.push("Cha nhp biu thc cng thc");break;case"THEO_SU_KIEN":Ke.maSuKien||ke.push("Cha chn m s kin");break}return ke},q=async()=>{if(!(f!=null&&f.auditId)||!O)return;const ke=le();if(ke.length>0){w({hopLe:!1,loi:ke}),alert(`Vui lng sa cc li trc khi p dng:

`+ke.join(`
`));return}if(confirm(`Xc nhn p dng rule "${O.tenRule}"?

Loi: ${Nf[O.loaiRule]}
Khon lng: ${O.khoanLuongMa}`)){b(!0);try{await Rd.apDungRule(r,f.auditId,O),alert("  p dng rule thnh cng!"),s(),n()}catch(tt){console.error("Li p dng rule:",tt);const Xe=tt instanceof Error?tt.message:"Li khng xc nh";alert(` C li khi p dng rule: ${Xe}`)}finally{b(!1)}}},Le=ke=>{u(ke)},ee=ke=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(ke);return e?t.jsxs("div",{className:"fixed inset-0 z-50 flex overflow-hidden",children:[t.jsx("div",{className:"flex-1 bg-black/50 backdrop-blur-sm animate-fadeIn",onClick:n}),t.jsxs("div",{ref:o,className:"w-[600px] max-w-full bg-white shadow-2xl flex flex-col h-full animate-slideInRight",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 text-white shadow-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:t.jsx(b_,{className:"h-6 w-6"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"font-semibold text-lg",children:"Tr l AI gi  Rule"}),t.jsx("p",{className:"text-sm text-white/80",children:"Nhp ting Vit  To rule t ng"})]})]}),t.jsx("button",{onClick:n,className:"p-2 hover:bg-white/20 rounded-lg transition-all hover:rotate-90",title:"ng (Escape)",children:t.jsx(rn,{className:"h-5 w-5"})})]}),t.jsxs("div",{className:"flex border-b bg-gray-50",children:[t.jsxs("button",{onClick:()=>J("goi-y"),className:`flex-1 py-3 text-sm font-medium transition-all ${G==="goi-y"?"border-b-2 border-blue-600 text-blue-600 bg-white":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[t.jsx(L_,{className:"h-4 w-4 inline mr-2"}),"Gi  Rule"]}),t.jsxs("button",{onClick:()=>J("lich-su"),className:`flex-1 py-3 text-sm font-medium transition-all ${G==="lich-su"?"border-b-2 border-blue-600 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[t.jsx(yu,{className:"h-4 w-4 inline mr-2"}),"Lch s"]})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[G==="goi-y"&&t.jsxs(t.Fragment,{children:[N&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-sm",children:[t.jsx("div",{className:"font-medium text-gray-700 mb-2",children:"Ng cnh hin ti:"}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-gray-600",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Phng ban:"})," ",t.jsx("span",{className:"font-medium",children:N.phongBan.tenPhongBan})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Quy ch:"})," ",t.jsxs("span",{className:"font-medium",children:["v",N.quyChe.phienBan]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Khon lng:"})," ",t.jsxs("span",{className:"font-medium",children:[N.khoanLuongs.length," khon"]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"S kin:"})," ",t.jsxs("span",{className:"font-medium",children:[N.danhMucSuKien.length," mc"]})]})]})]}),t.jsxs("div",{className:"animate-slideInUp",children:[t.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:" Mu gi :"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:WD.map((ke,Ke)=>t.jsx("button",{onClick:()=>Le(ke),className:"text-xs px-3 py-1.5 bg-blue-50 text-blue-700 rounded-full hover:bg-blue-100 hover:scale-105 transition-all",children:ke.length>40?ke.substring(0,37)+"...":ke},Ke))})]}),t.jsxs("div",{className:"animate-slideInUp",style:{animationDelay:"0.1s"},children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" M t bng ting Vit:"}),t.jsx("textarea",{ref:l,value:d,onChange:ke=>u(ke.target.value),onKeyDown:ke=>{(ke.ctrlKey||ke.metaKey)&&ke.key==="Enter"&&(ke.preventDefault(),d.trim()&&!x&&I())},placeholder:"V d: Pht i tr 1-2 ln 50k/ln, t ln 3 tr ln 100k/ln",className:"w-full h-28 px-3 py-2 border rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",disabled:x}),t.jsxs("div",{className:"flex items-center justify-between mt-1",children:[t.jsx("span",{className:"text-xs text-gray-400",children:"/Ctrl + Enter  gi"}),t.jsxs("span",{className:"text-xs text-gray-400",children:[d.length," k t"]})]}),t.jsx("button",{onClick:I,disabled:!d.trim()||x,className:"mt-2 w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-md hover:shadow-lg",children:x?t.jsxs(t.Fragment,{children:[t.jsx(An,{className:"h-4 w-4 animate-spin"}),"ang x l..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Nu,{className:"h-4 w-4"}),"To  xut"]})})]}),f&&t.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[t.jsxs("div",{className:`p-3 flex items-center gap-2 ${f.hopLeSoBo?"bg-green-50":"bg-yellow-50"}`,children:[f.hopLeSoBo?t.jsx(Gn,{className:"h-5 w-5 text-green-600"}):t.jsx(F_,{className:"h-5 w-5 text-yellow-600"}),t.jsx("span",{className:`font-medium ${f.hopLeSoBo?"text-green-700":"text-yellow-700"}`,children:f.hopLeSoBo?" to  xut thnh cng":"Cn lm r thm"})]}),f.canLamRo.length>0&&t.jsxs("div",{className:"p-3 bg-yellow-50 border-t",children:[t.jsx("div",{className:"text-sm font-medium text-yellow-800 mb-2",children:"Cu hi:"}),t.jsx("ul",{className:"space-y-1",children:f.canLamRo.map((ke,Ke)=>t.jsxs("li",{className:"text-sm text-yellow-700 flex items-start gap-2",children:[t.jsx("span",{children:""}),t.jsx("span",{children:ke})]},Ke))})]}),f.ruleDeXuat&&O&&t.jsxs("div",{className:"p-3 space-y-3",children:[f.tomTatRule&&t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Tm tt:"})," ",t.jsx("span",{className:"font-medium",children:f.tomTatRule})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2 text-sm",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Loi rule:"})," ",t.jsx("span",{className:"font-medium text-blue-600",children:Nf[O.loaiRule]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Ch  gp:"})," ",t.jsx("span",{className:"font-medium",children:$b[O.cheDoGop]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Khon lng:"})," ",t.jsx("span",{className:"font-medium",children:O.khoanLuongMa})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"u tin:"})," ",t.jsx("span",{className:"font-medium",children:O.thuTuUuTien})]})]}),t.jsxs("div",{className:"pt-2 border-t flex items-center gap-2 flex-wrap",children:[t.jsxs("button",{onClick:()=>B(!F),className:"text-blue-600 hover:text-blue-800 text-sm flex items-center gap-1",children:[F?t.jsx(Ba,{className:"h-4 w-4"}):t.jsx(mj,{className:"h-4 w-4"}),F?"n JSON":"Xem JSON"]}),t.jsxs("button",{onClick:ue,className:"text-gray-600 hover:text-gray-800 text-sm flex items-center gap-1",children:[t.jsx(uj,{className:"h-4 w-4"}),W?" copy!":"Copy JSON"]}),t.jsxs("button",{onClick:()=>fe(!X),className:"text-purple-600 hover:text-purple-800 text-sm flex items-center gap-1",children:[t.jsx(ns,{className:"h-4 w-4"}),X?"n form":"Chnh sa"]}),t.jsxs("button",{onClick:V,className:"text-orange-600 hover:text-orange-800 text-sm flex items-center gap-1",children:[t.jsx(bu,{className:"h-4 w-4"}),"Reset"]})]}),F&&t.jsx("pre",{className:"mt-2 p-2 bg-gray-800 text-green-400 rounded text-xs overflow-x-auto max-h-48",children:JSON.stringify(O,null,2)}),X&&t.jsxs("div",{className:"mt-2 p-3 bg-white border rounded-lg space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Tn rule"}),t.jsx("input",{type:"text",value:O.tenRule,onChange:ke=>M({...O,tenRule:ke.target.value}),className:"w-full px-2 py-1.5 border rounded text-sm"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Loi rule"}),t.jsx("select",{value:O.loaiRule,onChange:ke=>M({...O,loaiRule:ke.target.value}),className:"w-full px-2 py-1.5 border rounded text-sm",children:Object.entries(Nf).map(([ke,Ke])=>t.jsx("option",{value:ke,children:Ke},ke))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Ch  gp"}),t.jsx("select",{value:O.cheDoGop,onChange:ke=>M({...O,cheDoGop:ke.target.value}),className:"w-full px-2 py-1.5 border rounded text-sm",children:Object.entries($b).map(([ke,Ke])=>t.jsx("option",{value:ke,children:Ke},ke))})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Th t u tin"}),t.jsx("input",{type:"number",value:O.thuTuUuTien,onChange:ke=>M({...O,thuTuUuTien:Number(ke.target.value)}),className:"w-24 px-2 py-1.5 border rounded text-sm"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",id:"choPhepChinhTay",checked:O.choPhepChinhTay,onChange:ke=>M({...O,choPhepChinhTay:ke.target.checked})}),t.jsx("label",{htmlFor:"choPhepChinhTay",className:"text-sm text-gray-700",children:"Cho php chnh tay"})]})]})]}),f.giaiThich&&f.giaiThich.length>0&&t.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[t.jsx("div",{className:"text-sm font-medium text-blue-800 mb-1",children:"Gii thch:"}),t.jsx("ul",{className:"space-y-1",children:f.giaiThich.map((ke,Ke)=>t.jsxs("li",{className:"text-sm text-blue-700 flex items-start gap-2",children:[t.jsx("span",{children:""}),t.jsx("span",{children:ke})]},Ke))})]}),f.canhBao&&f.canhBao.length>0&&t.jsxs("div",{className:"bg-orange-50 rounded-lg p-3",children:[t.jsxs("div",{className:"text-sm font-medium text-orange-800 mb-1 flex items-center gap-1",children:[t.jsx(sa,{className:"h-4 w-4"}),"Cnh bo:"]}),t.jsx("ul",{className:"space-y-1",children:f.canhBao.map((ke,Ke)=>t.jsxs("li",{className:"text-sm text-orange-700 flex items-start gap-2",children:[t.jsx("span",{children:""}),t.jsx("span",{children:ke})]},Ke))})]}),_&&t.jsxs("div",{className:`rounded-lg p-3 ${_.hopLe?"bg-green-50":"bg-red-50"}`,children:[t.jsxs("div",{className:`text-sm font-medium mb-1 flex items-center gap-1 ${_.hopLe?"text-green-800":"text-red-800"}`,children:[_.hopLe?t.jsx(Gn,{className:"h-4 w-4"}):t.jsx(sa,{className:"h-4 w-4"}),_.hopLe?"Validate thnh cng":"Validate tht bi"]}),_.loi.length>0&&t.jsx("ul",{className:"space-y-1",children:_.loi.map((ke,Ke)=>t.jsxs("li",{className:"text-sm text-red-700 flex items-start gap-2",children:[t.jsx("span",{children:""}),t.jsx("span",{children:ke})]},Ke))})]}),S&&t.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[t.jsx("div",{className:"text-sm font-medium text-purple-800 mb-1",children:"Preview (d liu gi lp):"}),t.jsx("div",{className:"text-lg font-bold text-purple-600",children:ee(S.soTien)}),t.jsx("div",{className:"text-xs text-purple-600 mt-1",children:S.trace})]}),t.jsxs("div",{className:"border rounded-lg",children:[t.jsxs("button",{onClick:()=>H(!ne),className:"w-full px-3 py-2 flex items-center justify-between text-sm text-gray-600 hover:bg-gray-50",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(ns,{className:"h-4 w-4"}),"Ci t d liu gi lp"]}),t.jsx("span",{children:ne?"":""})]}),ne&&t.jsx("div",{className:"p-3 border-t space-y-2",children:t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Lng c bn"}),t.jsx("input",{type:"number",value:K.luongCoBan,onChange:ke=>L({...K,luongCoBan:Number(ke.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"H s trch nhim"}),t.jsx("input",{type:"number",step:"0.1",value:K.heSoTrachNhiem,onChange:ke=>L({...K,heSoTrachNhiem:Number(ke.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Cp trch nhim"}),t.jsx("input",{type:"number",value:K.capTrachNhiem,onChange:ke=>L({...K,capTrachNhiem:Number(ke.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"S ln i tr"}),t.jsx("input",{type:"number",value:K.soLanDiTre,onChange:ke=>L({...K,soLanDiTre:Number(ke.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]})]})})]}),t.jsxs("div",{className:"flex gap-2 pt-2",children:[t.jsxs("button",{onClick:R,disabled:j,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 disabled:opacity-50 transition",children:[j?t.jsx(An,{className:"h-4 w-4 animate-spin"}):t.jsx(yr,{className:"h-4 w-4"}),"Validate"]}),t.jsxs("button",{onClick:te,disabled:E,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 border border-purple-600 text-purple-600 rounded-lg hover:bg-purple-50 disabled:opacity-50 transition",children:[E?t.jsx(An,{className:"h-4 w-4 animate-spin"}):t.jsx(Ba,{className:"h-4 w-4"}),"Preview"]}),t.jsxs("button",{onClick:q,disabled:g,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition",children:[g?t.jsx(An,{className:"h-4 w-4 animate-spin"}):t.jsx(Br,{className:"h-4 w-4"}),"p dng"]})]})]})]})]}),G==="lich-su"&&t.jsx(QD,{quyCheId:r,onTaiSuDung:ke=>{u(ke),J("goi-y")}})]})]})]}):null}function QD({quyCheId:e,onTaiSuDung:n}){const[a,r]=D.useState([]),[s,l]=D.useState(!0);D.useEffect(()=>{Rd.lichSuDeXuat(e).then(r).catch(console.error).finally(()=>l(!1))},[e]);const o=async u=>{if(confirm("Hy  xut ny?"))try{await Rd.huyDeXuat(u),r(x=>x.map(m=>m.id===u?{...m,trangThai:"HUY"}:m))}catch(x){console.error("Li hy:",x)}};if(s)return t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx(An,{className:"h-6 w-6 animate-spin text-gray-400"})});if(a.length===0)return t.jsx("div",{className:"text-center py-8 text-gray-500",children:"Cha c lch s  xut no"});const d={DE_XUAT:{text:" xut",color:"bg-yellow-100 text-yellow-800"},DA_AP_DUNG:{text:" p dng",color:"bg-green-100 text-green-800"},HUY:{text:" hy",color:"bg-gray-100 text-gray-800"}};return t.jsx("div",{className:"space-y-3",children:a.map(u=>{var x,m;return t.jsxs("div",{className:"border rounded-lg p-3 hover:border-gray-300 transition",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("div",{className:"text-sm text-gray-500",children:[new Date(u.taoLuc).toLocaleString("vi-VN"),u.nguoiTao&&`  ${u.nguoiTao.hoTen}`]}),t.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${((x=d[u.trangThai])==null?void 0:x.color)||"bg-gray-100"}`,children:((m=d[u.trangThai])==null?void 0:m.text)||u.trangThai})]}),t.jsx("div",{className:"text-sm text-gray-700 line-clamp-2",children:u.promptGoc}),u.rule&&t.jsxs("div",{className:"mt-2 text-xs text-blue-600",children:[" Rule: ",u.rule.tenRule]}),t.jsxs("div",{className:"mt-2 flex gap-2",children:[t.jsxs("button",{onClick:()=>n==null?void 0:n(u.promptGoc),className:"text-xs text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[t.jsx(bu,{className:"h-3 w-3"}),"Ti s dng"]}),u.trangThai==="DE_XUAT"&&t.jsxs("button",{onClick:()=>o(u.id),className:"text-xs text-red-600 hover:text-red-800 flex items-center gap-1",children:[t.jsx(er,{className:"h-3 w-3"}),"Hy"]})]})]},u.id)})})}const gg={CO_DINH:"C nh",THEO_HE_SO:"Theo h s",BAC_THANG:"Bc thang",THEO_SU_KIEN:"Theo s kin",CONG_THUC:"Cng thc"},YD={CO_DINH:"bg-blue-100 text-blue-800",THEO_HE_SO:"bg-green-100 text-green-800",BAC_THANG:"bg-purple-100 text-purple-800",THEO_SU_KIEN:"bg-orange-100 text-orange-800",CONG_THUC:"bg-pink-100 text-pink-800"},JD=({rule:e,index:n,isSelected:a,onSelect:r,onDragStart:s,onDragOver:l,onDrop:o,isDragging:d})=>{var u;return t.jsx("div",{draggable:!0,onDragStart:s,onDragOver:l,onDrop:o,onClick:r,className:`
        p-3 rounded-lg border-2 cursor-pointer transition-all
        ${a?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}
        ${d?"opacity-50":""}
      `,children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"cursor-grab text-gray-400 hover:text-gray-600 mt-1",children:t.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{d:"M7 2a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 2zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 8zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 14zm6-8a2 2 0 1 0-.001-4.001A2 2 0 0 0 13 6zm0 2a2 2 0 1 0 .001 4.001A2 2 0 0 0 13 8zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 13 14z"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsxs("span",{className:"text-xs font-medium text-gray-500",children:["#",n+1]}),t.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${YD[e.loaiRule]}`,children:gg[e.loaiRule]})]}),t.jsx("h4",{className:"font-medium text-gray-900 truncate",children:e.tenRule}),t.jsx("p",{className:"text-sm text-gray-500 truncate mt-1",children:(u=e.khoanLuong)==null?void 0:u.tenKhoan})]}),t.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${e.trangThai?"bg-green-500":"bg-gray-300"}`})]})})},ZD=({value:e,onChange:n})=>t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S tin c nh"}),t.jsx("input",{type:"number",value:e.soTien||"",onChange:a=>n({soTien:Number(a.target.value)}),className:"w-full border rounded-lg px-3 py-2",placeholder:"1000000"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.soTien?new Intl.NumberFormat("vi-VN").format(e.soTien)+"":""})]}),eA=({value:e,onChange:n})=>t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Base (ngun tnh)"}),t.jsxs("select",{value:e.base||"",onChange:a=>n({...e,base:a.target.value,heSo:e.heSo||1}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn --"}),t.jsx("option",{value:"LUONG_CO_BAN",children:"Lng c bn"}),t.jsx("option",{value:"HE_SO_TRACH_NHIEM",children:"H s trch nhim"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"H s"}),t.jsx("input",{type:"number",step:"0.01",value:e.heSo||"",onChange:a=>n({...e,base:e.base||"LUONG_CO_BAN",heSo:Number(a.target.value)}),className:"w-full border rounded-lg px-3 py-2",placeholder:"0.2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cng thm (ty chn)"}),t.jsx("input",{type:"number",value:e.congThem||"",onChange:a=>n({...e,base:e.base||"LUONG_CO_BAN",heSo:e.heSo||1,congThem:Number(a.target.value)||void 0}),className:"w-full border rounded-lg px-3 py-2",placeholder:"200000"})]})]}),tA=({value:e,onChange:n})=>{const a=e.bac||[{from:1,to:1,soTien:0}],r=()=>{const o=a[a.length-1];n({field:e.field||"cap_trach_nhiem",bac:[...a,{from:((o==null?void 0:o.to)||0)+1,to:((o==null?void 0:o.to)||0)+1,soTien:0}]})},s=o=>{a.length<=1||n({field:e.field||"cap_trach_nhiem",bac:a.filter((d,u)=>u!==o)})},l=(o,d)=>{n({field:e.field||"cap_trach_nhiem",bac:a.map((u,x)=>x===o?{...u,...d}:u)})};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng d liu"}),t.jsxs("select",{value:e.field||"",onChange:o=>n({...e,field:o.target.value,bac:a}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn --"}),t.jsx("option",{value:"cap_trach_nhiem",children:"Cp trch nhim"}),t.jsx("option",{value:"he_so_trach_nhiem",children:"H s trch nhim"})]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Bc thang"}),t.jsx("button",{type:"button",onClick:r,className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Thm bc"})]}),t.jsx("div",{className:"space-y-2",children:a.map((o,d)=>t.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded",children:[t.jsxs("span",{className:"text-sm text-gray-500 w-16",children:["Bc ",d+1]}),t.jsx("input",{type:"number",value:o.from,onChange:u=>l(d,{from:Number(u.target.value)}),className:"w-20 border rounded px-2 py-1 text-sm",placeholder:"T"}),t.jsx("span",{className:"text-gray-400",children:""}),t.jsx("input",{type:"number",value:o.to,onChange:u=>l(d,{to:Number(u.target.value)}),className:"w-20 border rounded px-2 py-1 text-sm",placeholder:"n"}),t.jsx("input",{type:"number",value:o.soTien||"",onChange:u=>l(d,{soTien:Number(u.target.value)}),className:"flex-1 border rounded px-2 py-1 text-sm",placeholder:"S tin"}),a.length>1&&t.jsx("button",{type:"button",onClick:()=>s(d),className:"text-red-500 hover:text-red-700",children:""})]},d))})]})]})},nA=({value:e,onChange:n})=>t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Biu thc cng thc"}),t.jsx("textarea",{value:e.bieuThuc||"",onChange:a=>n({bieuThuc:a.target.value}),className:"w-full border rounded-lg px-3 py-2 font-mono text-sm",rows:3,placeholder:"LUONG_CO_BAN * HE_SO_TRACH_NHIEM + 200000"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Bin cho php: LUONG_CO_BAN, HE_SO_TRACH_NHIEM, CAP_TRACH_NHIEM, CONG_CHUAN, CONG_THUC_TE, ..."})]});function aA(){var W,xe,K,L,Q;const{id:e}=W0(),n=br(),[a,r]=D.useState(null),[s,l]=D.useState([]),[o,d]=D.useState([]),[u,x]=D.useState(null),[m,f]=D.useState(!0),[p,N]=D.useState(!1),[y,g]=D.useState(null),[b,j]=D.useState(!1),[T,_]=D.useState(!1),[w,E]=D.useState(null),[C,S]=D.useState("thongtin"),[P,F]=D.useState({tenRule:"",moTa:"",khoanLuongId:0,loaiRule:"CO_DINH",congThucJson:{soTien:0},dieuKienJson:{},cheDoGop:"GHI_DE",choPhepChinhTay:!0});D.useEffect(()=>{e&&B()},[e]);const B=async()=>{f(!0);try{const[I,R]=await Promise.all([qs.layChiTiet(Number(e)),pr.layTatCa()]);r(I),l(I.rules||[]),d(R),I.rules&&I.rules.length>0&&O(I.rules[0])}catch(I){console.error("Li load d liu:",I)}finally{f(!1)}},O=I=>{x(I),F({tenRule:I.tenRule,moTa:I.moTa||"",khoanLuongId:I.khoanLuongId,loaiRule:I.loaiRule,congThucJson:JSON.parse(I.congThucJson),dieuKienJson:I.dieuKienJson?JSON.parse(I.dieuKienJson):{},cheDoGop:I.cheDoGop,choPhepChinhTay:I.choPhepChinhTay}),S("thongtin"),E(null)},M=I=>{g(I)},G=I=>{I.preventDefault()},J=async I=>{if(y===null||y===I){g(null);return}const R=[...s],[te]=R.splice(y,1);R.splice(I,0,te),l(R),g(null);try{await qs.sapXepRules(Number(e),R.map(ue=>ue.id))}catch(ue){console.error("Li sp xp:",ue),B()}},X=async()=>{var I,R,te;if(u){N(!0);try{await Md.capNhat(u.id,{tenRule:P.tenRule,moTa:P.moTa,loaiRule:P.loaiRule,congThucJson:P.congThucJson,dieuKienJson:P.dieuKienJson,cheDoGop:P.cheDoGop,choPhepChinhTay:P.choPhepChinhTay}),B()}catch(ue){console.error("Li lu rule:",ue),alert(((te=(R=(I=ue.response)==null?void 0:I.data)==null?void 0:R.loi)==null?void 0:te.join(`
`))||"Li lu rule")}finally{N(!1)}}},fe=async()=>{if(u&&confirm("Xa rule ny?"))try{await Md.xoa(u.id),x(null),B()}catch(I){console.error("Li xa:",I),alert("Khng th xa rule ny")}},ne=async()=>{if(e)try{const I=await Md.preview({quyCheId:Number(e),duLieuGiaLap:{LUONG_CO_BAN:1e7,CAP_TRACH_NHIEM:2,HE_SO_TRACH_NHIEM:1.2}});E(I),S("preview")}catch(I){console.error("Li preview:",I),alert("Li chy th")}},H=async I=>{try{let R={soTien:0};I.loaiRule==="THEO_HE_SO"?R={base:"LUONG_CO_BAN",heSo:.1}:I.loaiRule==="BAC_THANG"?R={field:"cap_trach_nhiem",bac:[{from:1,to:1,soTien:5e5}]}:I.loaiRule==="CONG_THUC"&&(R={bieuThuc:"LUONG_CO_BAN * 0.1"}),await qs.taoRule(Number(e),{khoanLuongId:I.khoanLuongId,tenRule:I.tenRule,loaiRule:I.loaiRule,congThucJson:R}),j(!1),B()}catch(R){console.error("Li thm rule:",R),alert("Li thm rule")}};return m?t.jsx("div",{className:"flex items-center justify-center h-96",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}):a?t.jsxs("div",{className:"h-screen flex flex-col",children:[t.jsx("div",{className:"bg-white border-b px-6 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>n("/quy-che"),className:"p-2 hover:bg-gray-100 rounded",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl font-bold",children:a.tenQuyChe}),t.jsxs("p",{className:"text-sm text-gray-500",children:[(W=a.phongBan)==null?void 0:W.tenPhongBan,"  Phin bn ",a.phienBan]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[!a.coDuocSua&&t.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded text-sm",children:" Quy ch  kho"}),t.jsx("button",{onClick:ne,className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Chy th"}),t.jsxs("button",{onClick:()=>_(!0),disabled:!a.coDuocSua,className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 disabled:opacity-50 flex items-center gap-2",children:[t.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t.jsx("path",{d:"M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73A2 2 0 0 1 12 2z"}),t.jsx("path",{d:"M9 14a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"}),t.jsx("path",{d:"M15 14a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"})]}),"Tr l AI"]}),t.jsx("button",{onClick:()=>j(!0),disabled:!a.coDuocSua,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"+ Thm rule"})]})]})}),t.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[t.jsxs("div",{className:"w-80 border-r bg-gray-50 flex flex-col",children:[t.jsxs("div",{className:"p-4 border-b bg-white",children:[t.jsxs("h3",{className:"font-semibold text-gray-900",children:["Danh sch Rule (",s.length,")"]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ko th  sp xp th t u tin"})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[s.map((I,R)=>t.jsx(JD,{rule:I,index:R,isSelected:(u==null?void 0:u.id)===I.id,onSelect:()=>O(I),onDragStart:()=>M(R),onDragOver:G,onDrop:()=>J(R),isDragging:y===R},I.id)),s.length===0&&t.jsxs("div",{className:"text-center text-gray-500 py-10",children:["Cha c rule no.",t.jsx("br",{}),t.jsx("button",{onClick:()=>j(!0),className:"text-blue-600 hover:underline mt-2",children:"Thm rule u tin"})]})]})]}),t.jsx("div",{className:"flex-1 flex flex-col bg-white overflow-hidden",children:u?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"border-b",children:t.jsx("nav",{className:"flex px-6",children:["thongtin","dieukien","congthuc","preview"].map(I=>t.jsx("button",{onClick:()=>S(I),className:`px-4 py-3 text-sm font-medium border-b-2 -mb-px ${C===I?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:{thongtin:"Thng tin",dieukien:"iu kin",congthuc:"Cch tnh",preview:"Xem th"}[I]},I))})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[C==="thongtin"&&t.jsxs("div",{className:"space-y-4 max-w-lg",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn rule"}),t.jsx("input",{type:"text",value:P.tenRule,onChange:I=>F({...P,tenRule:I.target.value}),className:"w-full border rounded-lg px-3 py-2",disabled:!a.coDuocSua})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Khon lng"}),t.jsx("select",{value:P.khoanLuongId,onChange:I=>F({...P,khoanLuongId:Number(I.target.value)}),className:"w-full border rounded-lg px-3 py-2",disabled:!a.coDuocSua,children:o.map(I=>t.jsxs("option",{value:I.id,children:[I.tenKhoan," (",I.loai==="THU_NHAP"?"+":"-",")"]},I.id))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi rule"}),t.jsx("select",{value:P.loaiRule,onChange:I=>F({...P,loaiRule:I.target.value}),className:"w-full border rounded-lg px-3 py-2",disabled:!a.coDuocSua,children:Object.entries(gg).map(([I,R])=>t.jsx("option",{value:I,children:R},I))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:P.moTa,onChange:I=>F({...P,moTa:I.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:3,disabled:!a.coDuocSua})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:P.choPhepChinhTay,onChange:I=>F({...P,choPhepChinhTay:I.target.checked}),disabled:!a.coDuocSua}),t.jsx("span",{className:"text-sm",children:"Cho php chnh tay"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm",children:"Ch  gp:"}),t.jsxs("select",{value:P.cheDoGop,onChange:I=>F({...P,cheDoGop:I.target.value}),className:"border rounded px-2 py-1 text-sm",disabled:!a.coDuocSua,children:[t.jsx("option",{value:"GHI_DE",children:"Ghi "}),t.jsx("option",{value:"CONG_DON",children:"Cng dn"})]})]})]})]}),C==="dieukien"&&t.jsxs("div",{className:"max-w-lg space-y-4",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"iu kin p dng rule.  trng = p dng cho tt c nhn vin."}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vai tr"}),t.jsx("input",{type:"text",value:(((K=(xe=P.dieuKienJson)==null?void 0:xe.apDungCho)==null?void 0:K.vaiTro)||[]).join(", "),onChange:I=>{var R;return F({...P,dieuKienJson:{apDungCho:{...(R=P.dieuKienJson)==null?void 0:R.apDungCho,vaiTro:I.target.value?I.target.value.split(",").map(te=>te.trim()):void 0}}})},className:"w-full border rounded-lg px-3 py-2",placeholder:"TO_TRUONG, QUAN_LY",disabled:!a.coDuocSua}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Phn cch bng du phy"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cp trch nhim"}),t.jsx("input",{type:"text",value:(((Q=(L=P.dieuKienJson)==null?void 0:L.apDungCho)==null?void 0:Q.capTrachNhiem)||[]).join(", "),onChange:I=>{var R;return F({...P,dieuKienJson:{apDungCho:{...(R=P.dieuKienJson)==null?void 0:R.apDungCho,capTrachNhiem:I.target.value?I.target.value.split(",").map(te=>Number(te.trim())).filter(te=>!isNaN(te)):void 0}}})},className:"w-full border rounded-lg px-3 py-2",placeholder:"1, 2, 3",disabled:!a.coDuocSua})]})]}),C==="congthuc"&&t.jsxs("div",{className:"max-w-lg",children:[P.loaiRule==="CO_DINH"&&t.jsx(ZD,{value:P.congThucJson,onChange:I=>F({...P,congThucJson:I})}),P.loaiRule==="THEO_HE_SO"&&t.jsx(eA,{value:P.congThucJson,onChange:I=>F({...P,congThucJson:I})}),P.loaiRule==="BAC_THANG"&&t.jsx(tA,{value:P.congThucJson,onChange:I=>F({...P,congThucJson:I})}),P.loaiRule==="CONG_THUC"&&t.jsx(nA,{value:P.congThucJson,onChange:I=>F({...P,congThucJson:I})}),P.loaiRule==="THEO_SU_KIEN"&&t.jsx("div",{className:"text-gray-500",children:"Form s kin s c thm sau..."})]}),C==="preview"&&w&&t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"p-4 bg-blue-50 rounded-lg",children:t.jsxs("h4",{className:"font-semibold text-blue-900",children:["Tng tin: ",new Intl.NumberFormat("vi-VN").format(w.tongTien),""]})}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-2",children:"Chi tit"}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Khon lng"}),t.jsx("th",{className:"px-4 py-2 text-right text-sm",children:"S tin"}),t.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Gii thch"})]})}),t.jsx("tbody",{children:w.chiTiet.map((I,R)=>t.jsxs("tr",{className:"border-t",children:[t.jsx("td",{className:"px-4 py-2",children:I.khoanLuong}),t.jsx("td",{className:"px-4 py-2 text-right font-mono",children:new Intl.NumberFormat("vi-VN").format(I.soTien)}),t.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:I.giaiThich})]},R))})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-2",children:"Trace"}),t.jsx("div",{className:"space-y-2",children:w.trace.map((I,R)=>t.jsxs("div",{className:"p-3 bg-gray-50 rounded text-sm",children:[t.jsx("div",{className:"font-medium",children:I.ruleName}),t.jsx("div",{className:"text-gray-600",children:I.message}),t.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Output: ",new Intl.NumberFormat("vi-VN").format(I.output),""]})]},R))})]})]})]}),a.coDuocSua&&t.jsxs("div",{className:"border-t px-6 py-4 flex justify-between",children:[t.jsx("button",{onClick:fe,className:"px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg",children:"Xa rule"}),t.jsx("button",{onClick:X,disabled:p,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:p?"ang lu...":"Lu thay i"})]})]}):t.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:"Chn mt rule  xem chi tit"})})]}),b&&t.jsx(rA,{khoanLuongs:o,onClose:()=>j(!1),onAdd:H}),t.jsx(XD,{isOpen:T,onClose:()=>_(!1),phongBanId:a.phongBanId,quyCheId:a.id,onRuleApplied:B})]}):t.jsx("div",{className:"p-6 text-center text-gray-500",children:"Khng tm thy quy ch"})}function rA({khoanLuongs:e,onClose:n,onAdd:a}){var l;const[r,s]=D.useState({khoanLuongId:((l=e[0])==null?void 0:l.id)||0,tenRule:"",loaiRule:"CO_DINH"});return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[t.jsx("div",{className:"px-6 py-4 border-b",children:t.jsx("h3",{className:"text-lg font-semibold",children:"Thm Rule mi"})}),t.jsxs("div",{className:"px-6 py-4 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn rule"}),t.jsx("input",{type:"text",value:r.tenRule,onChange:o=>s({...r,tenRule:o.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ph cp trch nhim t trng"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Khon lng"}),t.jsx("select",{value:r.khoanLuongId,onChange:o=>s({...r,khoanLuongId:Number(o.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:e.map(o=>t.jsxs("option",{value:o.id,children:[o.tenKhoan," (",o.loai==="THU_NHAP"?"+":"-",")"]},o.id))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi rule"}),t.jsx("select",{value:r.loaiRule,onChange:o=>s({...r,loaiRule:o.target.value}),className:"w-full border rounded-lg px-3 py-2",children:Object.entries(gg).map(([o,d])=>t.jsx("option",{value:o,children:d},o))})]})]}),t.jsxs("div",{className:"px-6 py-4 border-t flex justify-end gap-3",children:[t.jsx("button",{onClick:n,className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:()=>a(r),disabled:!r.tenRule||!r.khoanLuongId,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Thm rule"})]})]})})}const jf={NHAP:{label:"Nhp",color:"bg-gray-100 text-gray-800"},DA_DUYET:{label:" duyt",color:"bg-green-100 text-green-800"},TU_CHOI:{label:"T chi",color:"bg-red-100 text-red-800"},HUY:{label:"Hu",color:"bg-gray-400 text-white"}},Cd={THUONG:{label:"Thng",color:"bg-green-100 text-green-800",icon:""},PHAT:{label:"Pht",color:"bg-red-100 text-red-800",icon:""}};function sA(){const[e,n]=D.useState([]),[a,r]=D.useState([]),[s,l]=D.useState([]),[o,d]=D.useState([]),[u,x]=D.useState(!0),[m,f]=D.useState(!1),[p,N]=D.useState(!1),[y,g]=D.useState([]),[b,j]=D.useState({}),[T,_]=D.useState({nhanVienId:0,phongBanId:0,ngay:new Date().toISOString().split("T")[0],loaiSuKien:"THUONG",maSuKien:"",giaTri:1,soTien:0,ghiChu:""}),[w,E]=D.useState({maSuKien:"",tenSuKien:"",loai:"THUONG",moTa:"",soTienMacDinh:0});D.useEffect(()=>{C()},[]);const C=async()=>{x(!0);try{const ne={...b,tuNgay:b.tuNgay?new Date(b.tuNgay):void 0,denNgay:b.denNgay?new Date(b.denNgay):void 0},[H,W,xe,K]=await Promise.all([Al.layDanhSach(ne),Al.layDanhMucSuKien(),Jt.layTatCa(),ma.layTatCa()]);n(Array.isArray(H)?H:[]),r(W),l(xe);const L="data"in K?K.data:K;d(Array.isArray(L)?L:[])}catch(ne){console.error("Li load d liu:",ne)}finally{x(!1)}},S=()=>{C()},P=async()=>{try{await Al.tao({...T,ngay:new Date(T.ngay)}),f(!1),C(),G()}catch(ne){console.error("Li to s kin:",ne),alert("Li to s kin")}},F=async ne=>{try{await Al.duyet(ne,{trangThai:"DA_DUYET"}),C()}catch(H){console.error("Li duyt:",H),alert("Li duyt s kin")}},B=async ne=>{const H=prompt("L do t chi:");if(H)try{await Al.duyet(ne,{trangThai:"TU_CHOI",lyDo:H}),C()}catch(W){console.error("Li t chi:",W)}},O=async()=>{if(y.length!==0&&confirm(`Duyt ${y.length} s kin?`))try{await Al.duyetNhieu({danhSachId:y,trangThai:"DA_DUYET"}),g([]),C()}catch(ne){console.error("Li duyt nhiu:",ne)}},M=async()=>{try{await Al.taoDanhMucSuKien(w),N(!1),C(),E({maSuKien:"",tenSuKien:"",loai:"THUONG",moTa:"",soTienMacDinh:0})}catch(ne){console.error("Li to danh mc:",ne),alert("Li to danh mc")}},G=()=>{_({nhanVienId:0,phongBanId:0,ngay:new Date().toISOString().split("T")[0],loaiSuKien:"THUONG",maSuKien:"",giaTri:1,soTien:0,ghiChu:""})},J=ne=>{g(H=>H.includes(ne)?H.filter(W=>W!==ne):[...H,ne])},X=()=>{const ne=e.filter(H=>H.trangThai==="NHAP").map(H=>H.id);y.length===ne.length?g([]):g(ne)},fe=ne=>{const H=a.find(W=>W.maSuKien===ne);_({...T,maSuKien:ne,loaiSuKien:(H==null?void 0:H.loai)||"THUONG",soTien:(H==null?void 0:H.soTienMacDinh)||0})};return u?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}):t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"S kin Thng/Pht"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Qun l cc s kin thng, pht cho nhn vin"})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>N(!0),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Danh mc s kin"}),t.jsxs("button",{onClick:()=>f(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[t.jsx(Dt,{size:18}),"Thm s kin"]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban"}),t.jsxs("select",{value:b.phongBanId||"",onChange:ne=>j({...b,phongBanId:Number(ne.target.value)||void 0}),className:"border rounded-lg px-3 py-2 w-48",children:[t.jsx("option",{value:"",children:"Tt c"}),s.map(ne=>t.jsx("option",{value:ne.id,children:ne.tenPhongBan},ne.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Loi"}),t.jsxs("select",{value:b.loaiSuKien||"",onChange:ne=>j({...b,loaiSuKien:ne.target.value||void 0}),className:"border rounded-lg px-3 py-2 w-32",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"THUONG",children:"Thng"}),t.jsx("option",{value:"PHAT",children:"Pht"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Trng thi"}),t.jsxs("select",{value:b.trangThai||"",onChange:ne=>j({...b,trangThai:ne.target.value||void 0}),className:"border rounded-lg px-3 py-2 w-32",children:[t.jsx("option",{value:"",children:"Tt c"}),Object.entries(jf).map(([ne,{label:H}])=>t.jsx("option",{value:ne,children:H},ne))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"T ngy"}),t.jsx(Gt,{value:b.tuNgay||"",onChange:ne=>j({...b,tuNgay:ne}),className:"border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"n ngy"}),t.jsx(Gt,{value:b.denNgay||"",onChange:ne=>j({...b,denNgay:ne}),className:"border rounded-lg px-3 py-2"})]}),t.jsxs("button",{onClick:S,className:"px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 flex items-center gap-2",children:[t.jsx(ng,{size:16}),"Lc"]})]})}),y.length>0&&t.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 mb-4 flex items-center justify-between",children:[t.jsxs("span",{className:"text-blue-800",children:[" chn ",y.length," s kin"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:O,className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 text-sm",children:"Duyt tt c"}),t.jsx("button",{onClick:()=>g([]),className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 text-sm",children:"B chn"})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left w-10",children:t.jsx("input",{type:"checkbox",checked:e.filter(ne=>ne.trangThai==="NHAP").length>0&&y.length===e.filter(ne=>ne.trangThai==="NHAP").length,onChange:X})}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Ngy"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Loi"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M s kin"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"Gi tr"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"S tin"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Thao tc"})]})}),t.jsxs("tbody",{children:[e.map(ne=>{var H,W,xe;return t.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3",children:ne.trangThai==="NHAP"&&t.jsx("input",{type:"checkbox",checked:y.includes(ne.id),onChange:()=>J(ne.id)})}),t.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(ne.ngay).toLocaleDateString("vi-VN")}),t.jsxs("td",{className:"px-4 py-3",children:[t.jsx("div",{className:"text-sm font-medium",children:(H=ne.nhanVien)==null?void 0:H.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:(W=ne.nhanVien)==null?void 0:W.maNhanVien})]}),t.jsx("td",{className:"px-4 py-3 text-sm",children:(xe=ne.phongBan)==null?void 0:xe.tenPhongBan}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("span",{className:`px-2 py-1 rounded text-xs ${Cd[ne.loaiSuKien].color}`,children:[Cd[ne.loaiSuKien].icon," ",Cd[ne.loaiSuKien].label]})}),t.jsx("td",{className:"px-4 py-3 text-sm font-mono",children:ne.maSuKien}),t.jsx("td",{className:"px-4 py-3 text-sm text-right",children:ne.giaTri}),t.jsxs("td",{className:"px-4 py-3 text-sm text-right font-mono",children:[new Intl.NumberFormat("vi-VN").format(ne.soTien),""]}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded text-xs ${jf[ne.trangThai].color}`,children:jf[ne.trangThai].label})}),t.jsx("td",{className:"px-4 py-3 text-center",children:ne.trangThai==="NHAP"&&t.jsxs("div",{className:"flex justify-center gap-1",children:[t.jsx("button",{onClick:()=>F(ne.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Duyt",children:t.jsx(Br,{size:16})}),t.jsx("button",{onClick:()=>B(ne.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"T chi",children:t.jsx(rn,{size:16})})]})})]},ne.id)}),e.length===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:10,className:"px-4 py-10 text-center text-gray-500",children:"Khng c s kin no"})})]})]})}),m&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg",children:[t.jsx("div",{className:"px-6 py-4 border-b",children:t.jsx("h3",{className:"text-lg font-semibold",children:"Thm s kin Thng/Pht"})}),t.jsxs("div",{className:"px-6 py-4 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nhn vin"}),t.jsxs("select",{value:T.nhanVienId,onChange:ne=>{const H=o.find(W=>W.id===Number(ne.target.value));_({...T,nhanVienId:Number(ne.target.value),phongBanId:(H==null?void 0:H.phongBanId)||T.phongBanId})},className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn --"}),o.map(ne=>t.jsxs("option",{value:ne.id,children:[ne.hoTen," (",ne.maNhanVien,")"]},ne.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy"}),t.jsx(Gt,{value:T.ngay,onChange:ne=>_({...T,ngay:ne}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi s kin"}),t.jsxs("select",{value:T.maSuKien,onChange:ne=>fe(ne.target.value),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn s kin --"}),t.jsx("optgroup",{label:"Thng",children:a.filter(ne=>ne.loai==="THUONG").map(ne=>t.jsxs("option",{value:ne.maSuKien,children:[ne.tenSuKien," (",ne.maSuKien,")"]},ne.maSuKien))}),t.jsx("optgroup",{label:"Pht",children:a.filter(ne=>ne.loai==="PHAT").map(ne=>t.jsxs("option",{value:ne.maSuKien,children:[ne.tenSuKien," (",ne.maSuKien,")"]},ne.maSuKien))})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi tr (ln/ngy/...)"}),t.jsx("input",{type:"number",value:T.giaTri,onChange:ne=>_({...T,giaTri:Number(ne.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:1})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S tin"}),t.jsx("input",{type:"number",value:T.soTien,onChange:ne=>_({...T,soTien:Number(ne.target.value)}),className:"w-full border rounded-lg px-3 py-2"}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[new Intl.NumberFormat("vi-VN").format(T.soTien),""]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),t.jsx("textarea",{value:T.ghiChu,onChange:ne=>_({...T,ghiChu:ne.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"px-6 py-4 border-t flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{f(!1),G()},className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:P,disabled:!T.nhanVienId||!T.maSuKien,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Thm s kin"})]})]})}),p&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[80vh] flex flex-col",children:[t.jsxs("div",{className:"px-6 py-4 border-b flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Danh mc S kin"}),t.jsx("button",{onClick:()=>N(!1),className:"p-2 hover:bg-gray-100 rounded",children:t.jsx(rn,{size:20})})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[t.jsx("h4",{className:"font-medium mb-3",children:"Thm danh mc mi"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsx("input",{type:"text",placeholder:"M s kin",value:w.maSuKien,onChange:ne=>E({...w,maSuKien:ne.target.value}),className:"border rounded px-3 py-2"}),t.jsx("input",{type:"text",placeholder:"Tn s kin",value:w.tenSuKien,onChange:ne=>E({...w,tenSuKien:ne.target.value}),className:"border rounded px-3 py-2"}),t.jsxs("select",{value:w.loai,onChange:ne=>E({...w,loai:ne.target.value}),className:"border rounded px-3 py-2",children:[t.jsx("option",{value:"THUONG",children:"Thng"}),t.jsx("option",{value:"PHAT",children:"Pht"})]}),t.jsx("input",{type:"number",placeholder:"S tin mc nh",value:w.soTienMacDinh||"",onChange:ne=>E({...w,soTienMacDinh:Number(ne.target.value)}),className:"border rounded px-3 py-2"})]}),t.jsx("div",{className:"mt-3 flex justify-end",children:t.jsx("button",{onClick:M,disabled:!w.maSuKien||!w.tenSuKien,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:"Thm"})})]}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-100",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-3 py-2 text-left text-sm",children:"M"}),t.jsx("th",{className:"px-3 py-2 text-left text-sm",children:"Tn"}),t.jsx("th",{className:"px-3 py-2 text-left text-sm",children:"Loi"}),t.jsx("th",{className:"px-3 py-2 text-right text-sm",children:"S tin mc nh"})]})}),t.jsx("tbody",{children:a.map(ne=>t.jsxs("tr",{className:"border-t",children:[t.jsx("td",{className:"px-3 py-2 font-mono text-sm",children:ne.maSuKien}),t.jsx("td",{className:"px-3 py-2",children:ne.tenSuKien}),t.jsx("td",{className:"px-3 py-2",children:t.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Cd[ne.loai].color}`,children:Cd[ne.loai].label})}),t.jsx("td",{className:"px-3 py-2 text-right font-mono",children:ne.soTienMacDinh?new Intl.NumberFormat("vi-VN").format(ne.soTienMacDinh)+"":"-"})]},ne.id))})]})]})]})})]})}const iA={CO_DINH:"C nh",THEO_HE_SO:"Theo h s",BAC_THANG:"Bc thang",THEO_SU_KIEN:"Theo s kin",CONG_THUC:"Cng thc"};function lA(){const[e]=C3(),n=Number(e.get("bangLuongId"))||0,[a,r]=D.useState(null),[s,l]=D.useState([]),[o,d]=D.useState(!0),[u,x]=D.useState(""),[m,f]=D.useState([]);D.useEffect(()=>{n&&p()},[n]);const p=async()=>{d(!0);try{const[j,T]=await Promise.all([Or.layTheoId(n),$D.xemTrace(n)]);r(j),l(T)}catch(j){console.error("Li load d liu:",j)}finally{d(!1)}},N=s.reduce((j,T)=>{const _=T.nhanVienId;return j[_]||(j[_]={nhanVien:T.nhanVien,traces:[]}),j[_].traces.push(T),j},{}),y=Object.entries(N).filter(([j,T])=>{var w,E;if(!u)return!0;const _=u.toLowerCase();return((w=T.nhanVien)==null?void 0:w.hoTen.toLowerCase().includes(_))||((E=T.nhanVien)==null?void 0:E.maNhanVien.toLowerCase().includes(_))}),g=j=>{f(T=>T.includes(j)?T.filter(_=>_!==j):[...T,j])},b=j=>new Intl.NumberFormat("vi-VN").format(j);return o?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}):t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[t.jsx(xa,{to:`/bang-luong/${n}`,className:"p-2 hover:bg-gray-100 rounded",children:t.jsx(Y0,{size:20})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Rule Trace - Gii trnh tnh lng"}),a&&t.jsxs("p",{className:"text-gray-500 mt-1",children:[a.phongBan.tenPhongBan," - Thng ",a.thang,"/",a.nam]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:t.jsxs("div",{className:"relative",children:[t.jsx(Vr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),t.jsx("input",{type:"text",placeholder:"Tm theo tn hoc m nhn vin...",value:u,onChange:j=>x(j.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]})}),t.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 mb-6 flex items-center justify-between",children:[t.jsx("div",{children:t.jsxs("span",{className:"text-blue-800",children:["Tng: ",Object.keys(N).length," nhn vin, ",s.length," dng trace"]})}),t.jsx("button",{onClick:()=>{m.length===Object.keys(N).length?f([]):f(Object.keys(N).map(Number))},className:"text-sm text-blue-600 hover:underline",children:m.length===Object.keys(N).length?"Thu gn tt c":"M rng tt c"})]}),t.jsxs("div",{className:"space-y-4",children:[y.map(([j,T])=>{var C,S;const _=Number(j),w=m.includes(_),E=T.traces.reduce((P,F)=>P+F.outputSoTien,0);return t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsxs("button",{onClick:()=>g(_),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-gray-50",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[w?t.jsx(Ja,{size:18,className:"text-gray-400"}):t.jsx(qn,{size:18,className:"text-gray-400"}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"font-medium",children:(C=T.nhanVien)==null?void 0:C.hoTen}),t.jsx("div",{className:"text-sm text-gray-500",children:(S=T.nhanVien)==null?void 0:S.maNhanVien})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"font-medium text-blue-600",children:[b(E),""]}),t.jsxs("div",{className:"text-sm text-gray-500",children:[T.traces.length," rules"]})]})]}),w&&t.jsx("div",{className:"border-t",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Quy ch"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Rule"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Khon lng"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500",children:"S tin"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Gii thch"})]})}),t.jsx("tbody",{children:T.traces.map(P=>{var F,B,O,M,G,J;return t.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[t.jsxs("td",{className:"px-4 py-2",children:[t.jsx("div",{className:"text-sm",children:(F=P.quyChe)==null?void 0:F.tenQuyChe}),t.jsxs("div",{className:"text-xs text-gray-500",children:["v",(B=P.quyChe)==null?void 0:B.phienBan]})]}),t.jsx("td",{className:"px-4 py-2",children:P.quyCheRule?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-sm",children:P.quyCheRule.tenRule}),t.jsx("div",{className:"text-xs text-gray-500",children:iA[P.quyCheRule.loaiRule]})]}):t.jsx("span",{className:"text-gray-400 text-sm",children:"-"})}),t.jsxs("td",{className:"px-4 py-2",children:[t.jsx("div",{className:"text-sm",children:(O=P.khoanLuong)==null?void 0:O.tenKhoan}),t.jsx("div",{className:"text-xs text-gray-500",children:(M=P.khoanLuong)==null?void 0:M.maKhoan})]}),t.jsx("td",{className:"px-4 py-2 text-right",children:t.jsxs("span",{className:`font-mono text-sm ${((G=P.khoanLuong)==null?void 0:G.loai)==="KHAU_TRU"?"text-red-600":"text-green-600"}`,children:[((J=P.khoanLuong)==null?void 0:J.loai)==="KHAU_TRU"?"-":"+",b(P.outputSoTien),""]})}),t.jsxs("td",{className:"px-4 py-2",children:[t.jsx("div",{className:"text-sm text-gray-600",children:P.messageGiaiThich}),P.inputJson&&t.jsxs("details",{className:"mt-1",children:[t.jsx("summary",{className:"text-xs text-blue-600 cursor-pointer",children:"Xem input"}),t.jsx("pre",{className:"mt-1 text-xs bg-gray-100 p-2 rounded overflow-x-auto",children:JSON.stringify(JSON.parse(P.inputJson),null,2)})]})]})]},P.id)})})]})})]},_)}),y.length===0&&t.jsx("div",{className:"text-center text-gray-500 py-10",children:"Khng c d liu trace"})]})]})}var wf={exports:{}},kf,Gb;function oA(){if(Gb)return kf;Gb=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return kf=e,kf}var Tf,qb;function cA(){if(qb)return Tf;qb=1;var e=oA();function n(){}function a(){}return a.resetWarningCache=n,Tf=function(){function r(o,d,u,x,m,f){if(f!==e){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}r.isRequired=r;function s(){return r}var l={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:s,element:r,elementType:r,instanceOf:s,node:r,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:a,resetWarningCache:n};return l.PropTypes=l,l},Tf}var Wb;function dA(){return Wb||(Wb=1,wf.exports=cA()()),wf.exports}var uA=dA();const Yt=Up(uA);function fo(e,n,a,r){function s(l){return l instanceof a?l:new a(function(o){o(l)})}return new(a||(a=Promise))(function(l,o){function d(m){try{x(r.next(m))}catch(f){o(f)}}function u(m){try{x(r.throw(m))}catch(f){o(f)}}function x(m){m.done?l(m.value):s(m.value).then(d,u)}x((r=r.apply(e,n||[])).next())})}const hA=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function Cc(e,n,a){const r=xA(e),{webkitRelativePath:s}=e,l=typeof n=="string"?n:typeof s=="string"&&s.length>0?s:`./${e.name}`;return typeof r.path!="string"&&Xb(r,"path",l),Xb(r,"relativePath",l),r}function xA(e){const{name:n}=e;if(n&&n.lastIndexOf(".")!==-1&&!e.type){const r=n.split(".").pop().toLowerCase(),s=hA.get(r);s&&Object.defineProperty(e,"type",{value:s,writable:!1,configurable:!1,enumerable:!0})}return e}function Xb(e,n,a){Object.defineProperty(e,n,{value:a,writable:!1,configurable:!1,enumerable:!0})}const mA=[".DS_Store","Thumbs.db"];function fA(e){return fo(this,void 0,void 0,function*(){return C0(e)&&pA(e.dataTransfer)?bA(e.dataTransfer,e.type):gA(e)?yA(e):Array.isArray(e)&&e.every(n=>"getFile"in n&&typeof n.getFile=="function")?vA(e):[]})}function pA(e){return C0(e)}function gA(e){return C0(e)&&C0(e.target)}function C0(e){return typeof e=="object"&&e!==null}function yA(e){return kp(e.target.files).map(n=>Cc(n))}function vA(e){return fo(this,void 0,void 0,function*(){return(yield Promise.all(e.map(a=>a.getFile()))).map(a=>Cc(a))})}function bA(e,n){return fo(this,void 0,void 0,function*(){if(e.items){const a=kp(e.items).filter(s=>s.kind==="file");if(n!=="drop")return a;const r=yield Promise.all(a.map(NA));return Qb(fw(r))}return Qb(kp(e.files).map(a=>Cc(a)))})}function Qb(e){return e.filter(n=>mA.indexOf(n.name)===-1)}function kp(e){if(e===null)return[];const n=[];for(let a=0;a<e.length;a++){const r=e[a];n.push(r)}return n}function NA(e){if(typeof e.webkitGetAsEntry!="function")return Yb(e);const n=e.webkitGetAsEntry();return n&&n.isDirectory?pw(n):Yb(e,n)}function fw(e){return e.reduce((n,a)=>[...n,...Array.isArray(a)?fw(a):[a]],[])}function Yb(e,n){return fo(this,void 0,void 0,function*(){var a;if(globalThis.isSecureContext&&typeof e.getAsFileSystemHandle=="function"){const l=yield e.getAsFileSystemHandle();if(l===null)throw new Error(`${e} is not a File`);if(l!==void 0){const o=yield l.getFile();return o.handle=l,Cc(o)}}const r=e.getAsFile();if(!r)throw new Error(`${e} is not a File`);return Cc(r,(a=n==null?void 0:n.fullPath)!==null&&a!==void 0?a:void 0)})}function jA(e){return fo(this,void 0,void 0,function*(){return e.isDirectory?pw(e):wA(e)})}function pw(e){const n=e.createReader();return new Promise((a,r)=>{const s=[];function l(){n.readEntries(o=>fo(this,void 0,void 0,function*(){if(o.length){const d=Promise.all(o.map(jA));s.push(d),l()}else try{const d=yield Promise.all(s);a(d)}catch(d){r(d)}}),o=>{r(o)})}l()})}function wA(e){return fo(this,void 0,void 0,function*(){return new Promise((n,a)=>{e.file(r=>{const s=Cc(r,e.fullPath);n(s)},r=>{a(r)})})})}var Xh={},Jb;function kA(){return Jb||(Jb=1,Xh.__esModule=!0,Xh.default=function(e,n){if(e&&n){var a=Array.isArray(n)?n:n.split(",");if(a.length===0)return!0;var r=e.name||"",s=(e.type||"").toLowerCase(),l=s.replace(/\/.*$/,"");return a.some(function(o){var d=o.trim().toLowerCase();return d.charAt(0)==="."?r.toLowerCase().endsWith(d):d.endsWith("/*")?l===d.replace(/\/.*$/,""):s===d})}return!0}),Xh}var TA=kA();const Cf=Up(TA);function Zb(e){return _A(e)||SA(e)||yw(e)||CA()}function CA(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SA(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _A(e){if(Array.isArray(e))return Tp(e)}function eN(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),a.push.apply(a,r)}return a}function tN(e){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?eN(Object(a),!0).forEach(function(r){gw(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):eN(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function gw(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function Yd(e,n){return AA(e)||DA(e,n)||yw(e,n)||EA()}function EA(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yw(e,n){if(e){if(typeof e=="string")return Tp(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Tp(e,n)}}function Tp(e,n){(n==null||n>e.length)&&(n=e.length);for(var a=0,r=new Array(n);a<n;a++)r[a]=e[a];return r}function DA(e,n){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var r=[],s=!0,l=!1,o,d;try{for(a=a.call(e);!(s=(o=a.next()).done)&&(r.push(o.value),!(n&&r.length===n));s=!0);}catch(u){l=!0,d=u}finally{try{!s&&a.return!=null&&a.return()}finally{if(l)throw d}}return r}}function AA(e){if(Array.isArray(e))return e}var FA=typeof Cf=="function"?Cf:Cf.default,LA="file-invalid-type",PA="file-too-large",IA="file-too-small",OA="too-many-files",MA=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=n.split(","),r=a.length>1?"one of ".concat(a.join(", ")):a[0];return{code:LA,message:"File type must be ".concat(r)}},nN=function(n){return{code:PA,message:"File is larger than ".concat(n," ").concat(n===1?"byte":"bytes")}},aN=function(n){return{code:IA,message:"File is smaller than ".concat(n," ").concat(n===1?"byte":"bytes")}},RA={code:OA,message:"Too many files"};function vw(e,n){var a=e.type==="application/x-moz-file"||FA(e,n);return[a,a?null:MA(n)]}function bw(e,n,a){if(Ml(e.size))if(Ml(n)&&Ml(a)){if(e.size>a)return[!1,nN(a)];if(e.size<n)return[!1,aN(n)]}else{if(Ml(n)&&e.size<n)return[!1,aN(n)];if(Ml(a)&&e.size>a)return[!1,nN(a)]}return[!0,null]}function Ml(e){return e!=null}function BA(e){var n=e.files,a=e.accept,r=e.minSize,s=e.maxSize,l=e.multiple,o=e.maxFiles,d=e.validator;return!l&&n.length>1||l&&o>=1&&n.length>o?!1:n.every(function(u){var x=vw(u,a),m=Yd(x,1),f=m[0],p=bw(u,r,s),N=Yd(p,1),y=N[0],g=d?d(u):null;return f&&y&&!g})}function S0(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function Qh(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(n){return n==="Files"||n==="application/x-moz-file"}):!!e.target&&!!e.target.files}function rN(e){e.preventDefault()}function HA(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function VA(e){return e.indexOf("Edge/")!==-1}function UA(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return HA(e)||VA(e)}function fs(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return function(r){for(var s=arguments.length,l=new Array(s>1?s-1:0),o=1;o<s;o++)l[o-1]=arguments[o];return n.some(function(d){return!S0(r)&&d&&d.apply(void 0,[r].concat(l)),S0(r)})}}function KA(){return"showOpenFilePicker"in window}function zA(e){if(Ml(e)){var n=Object.entries(e).filter(function(a){var r=Yd(a,2),s=r[0],l=r[1],o=!0;return Nw(s)||(console.warn('Skipped "'.concat(s,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),o=!1),(!Array.isArray(l)||!l.every(jw))&&(console.warn('Skipped "'.concat(s,'" because an invalid file extension was provided.')),o=!1),o}).reduce(function(a,r){var s=Yd(r,2),l=s[0],o=s[1];return tN(tN({},a),{},gw({},l,o))},{});return[{description:"Files",accept:n}]}return e}function $A(e){if(Ml(e))return Object.entries(e).reduce(function(n,a){var r=Yd(a,2),s=r[0],l=r[1];return[].concat(Zb(n),[s],Zb(l))},[]).filter(function(n){return Nw(n)||jw(n)}).join(",")}function GA(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function qA(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function Nw(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||e==="application/*"||/\w+\/[-+.\w]+/g.test(e)}function jw(e){return/^.*\.[\w]+$/.test(e)}var WA=["children"],XA=["open"],QA=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],YA=["refKey","onChange","onClick"];function JA(e){return tF(e)||eF(e)||ww(e)||ZA()}function ZA(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eF(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tF(e){if(Array.isArray(e))return Cp(e)}function Sf(e,n){return rF(e)||aF(e,n)||ww(e,n)||nF()}function nF(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ww(e,n){if(e){if(typeof e=="string")return Cp(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Cp(e,n)}}function Cp(e,n){(n==null||n>e.length)&&(n=e.length);for(var a=0,r=new Array(n);a<n;a++)r[a]=e[a];return r}function aF(e,n){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var r=[],s=!0,l=!1,o,d;try{for(a=a.call(e);!(s=(o=a.next()).done)&&(r.push(o.value),!(n&&r.length===n));s=!0);}catch(u){l=!0,d=u}finally{try{!s&&a.return!=null&&a.return()}finally{if(l)throw d}}return r}}function rF(e){if(Array.isArray(e))return e}function sN(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),a.push.apply(a,r)}return a}function gn(e){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?sN(Object(a),!0).forEach(function(r){Sp(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):sN(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function Sp(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function _0(e,n){if(e==null)return{};var a=sF(e,n),r,s;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(s=0;s<l.length;s++)r=l[s],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function sF(e,n){if(e==null)return{};var a={},r=Object.keys(e),s,l;for(l=0;l<r.length;l++)s=r[l],!(n.indexOf(s)>=0)&&(a[s]=e[s]);return a}var yg=D.forwardRef(function(e,n){var a=e.children,r=_0(e,WA),s=vg(r),l=s.open,o=_0(s,XA);return D.useImperativeHandle(n,function(){return{open:l}},[l]),A2.createElement(D.Fragment,null,a(gn(gn({},o),{},{open:l})))});yg.displayName="Dropzone";var kw={disabled:!1,getFilesFromEvent:fA,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};yg.defaultProps=kw;yg.propTypes={children:Yt.func,accept:Yt.objectOf(Yt.arrayOf(Yt.string)),multiple:Yt.bool,preventDropOnDocument:Yt.bool,noClick:Yt.bool,noKeyboard:Yt.bool,noDrag:Yt.bool,noDragEventsBubbling:Yt.bool,minSize:Yt.number,maxSize:Yt.number,maxFiles:Yt.number,disabled:Yt.bool,getFilesFromEvent:Yt.func,onFileDialogCancel:Yt.func,onFileDialogOpen:Yt.func,useFsAccessApi:Yt.bool,autoFocus:Yt.bool,onDragEnter:Yt.func,onDragLeave:Yt.func,onDragOver:Yt.func,onDrop:Yt.func,onDropAccepted:Yt.func,onDropRejected:Yt.func,onError:Yt.func,validator:Yt.func};var _p={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function vg(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=gn(gn({},kw),e),a=n.accept,r=n.disabled,s=n.getFilesFromEvent,l=n.maxSize,o=n.minSize,d=n.multiple,u=n.maxFiles,x=n.onDragEnter,m=n.onDragLeave,f=n.onDragOver,p=n.onDrop,N=n.onDropAccepted,y=n.onDropRejected,g=n.onFileDialogCancel,b=n.onFileDialogOpen,j=n.useFsAccessApi,T=n.autoFocus,_=n.preventDropOnDocument,w=n.noClick,E=n.noKeyboard,C=n.noDrag,S=n.noDragEventsBubbling,P=n.onError,F=n.validator,B=D.useMemo(function(){return $A(a)},[a]),O=D.useMemo(function(){return zA(a)},[a]),M=D.useMemo(function(){return typeof b=="function"?b:iN},[b]),G=D.useMemo(function(){return typeof g=="function"?g:iN},[g]),J=D.useRef(null),X=D.useRef(null),fe=D.useReducer(iF,_p),ne=Sf(fe,2),H=ne[0],W=ne[1],xe=H.isFocused,K=H.isFileDialogActive,L=D.useRef(typeof window<"u"&&window.isSecureContext&&j&&KA()),Q=function(){!L.current&&K&&setTimeout(function(){if(X.current){var Qe=X.current.files;Qe.length||(W({type:"closeDialog"}),G())}},300)};D.useEffect(function(){return window.addEventListener("focus",Q,!1),function(){window.removeEventListener("focus",Q,!1)}},[X,K,G,L]);var I=D.useRef([]),R=function(Qe){J.current&&J.current.contains(Qe.target)||(Qe.preventDefault(),I.current=[])};D.useEffect(function(){return _&&(document.addEventListener("dragover",rN,!1),document.addEventListener("drop",R,!1)),function(){_&&(document.removeEventListener("dragover",rN),document.removeEventListener("drop",R))}},[J,_]),D.useEffect(function(){return!r&&T&&J.current&&J.current.focus(),function(){}},[J,T,r]);var te=D.useCallback(function(Re){P?P(Re):console.error(Re)},[P]),ue=D.useCallback(function(Re){Re.preventDefault(),Re.persist(),xn(Re),I.current=[].concat(JA(I.current),[Re.target]),Qh(Re)&&Promise.resolve(s(Re)).then(function(Qe){if(!(S0(Re)&&!S)){var Et=Qe.length,Ht=Et>0&&BA({files:Qe,accept:B,minSize:o,maxSize:l,multiple:d,maxFiles:u,validator:F}),Nt=Et>0&&!Ht;W({isDragAccept:Ht,isDragReject:Nt,isDragActive:!0,type:"setDraggedFiles"}),x&&x(Re)}}).catch(function(Qe){return te(Qe)})},[s,x,te,S,B,o,l,d,u,F]),V=D.useCallback(function(Re){Re.preventDefault(),Re.persist(),xn(Re);var Qe=Qh(Re);if(Qe&&Re.dataTransfer)try{Re.dataTransfer.dropEffect="copy"}catch{}return Qe&&f&&f(Re),!1},[f,S]),le=D.useCallback(function(Re){Re.preventDefault(),Re.persist(),xn(Re);var Qe=I.current.filter(function(Ht){return J.current&&J.current.contains(Ht)}),Et=Qe.indexOf(Re.target);Et!==-1&&Qe.splice(Et,1),I.current=Qe,!(Qe.length>0)&&(W({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),Qh(Re)&&m&&m(Re))},[J,m,S]),q=D.useCallback(function(Re,Qe){var Et=[],Ht=[];Re.forEach(function(Nt){var Bn=vw(Nt,B),ot=Sf(Bn,2),Bt=ot[0],Xn=ot[1],en=bw(Nt,o,l),Da=Sf(en,2),mi=Da[0],Ls=Da[1],Ps=F?F(Nt):null;if(Bt&&mi&&!Ps)Et.push(Nt);else{var os=[Xn,Ls];Ps&&(os=os.concat(Ps)),Ht.push({file:Nt,errors:os.filter(function(fi){return fi})})}}),(!d&&Et.length>1||d&&u>=1&&Et.length>u)&&(Et.forEach(function(Nt){Ht.push({file:Nt,errors:[RA]})}),Et.splice(0)),W({acceptedFiles:Et,fileRejections:Ht,isDragReject:Ht.length>0,type:"setFiles"}),p&&p(Et,Ht,Qe),Ht.length>0&&y&&y(Ht,Qe),Et.length>0&&N&&N(Et,Qe)},[W,d,B,o,l,u,p,N,y,F]),Le=D.useCallback(function(Re){Re.preventDefault(),Re.persist(),xn(Re),I.current=[],Qh(Re)&&Promise.resolve(s(Re)).then(function(Qe){S0(Re)&&!S||q(Qe,Re)}).catch(function(Qe){return te(Qe)}),W({type:"reset"})},[s,q,te,S]),ee=D.useCallback(function(){if(L.current){W({type:"openDialog"}),M();var Re={multiple:d,types:O};window.showOpenFilePicker(Re).then(function(Qe){return s(Qe)}).then(function(Qe){q(Qe,null),W({type:"closeDialog"})}).catch(function(Qe){GA(Qe)?(G(Qe),W({type:"closeDialog"})):qA(Qe)?(L.current=!1,X.current?(X.current.value=null,X.current.click()):te(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):te(Qe)});return}X.current&&(W({type:"openDialog"}),M(),X.current.value=null,X.current.click())},[W,M,G,j,q,te,O,d]),ke=D.useCallback(function(Re){!J.current||!J.current.isEqualNode(Re.target)||(Re.key===" "||Re.key==="Enter"||Re.keyCode===32||Re.keyCode===13)&&(Re.preventDefault(),ee())},[J,ee]),Ke=D.useCallback(function(){W({type:"focus"})},[]),tt=D.useCallback(function(){W({type:"blur"})},[]),Xe=D.useCallback(function(){w||(UA()?setTimeout(ee,0):ee())},[w,ee]),Oe=function(Qe){return r?null:Qe},Rt=function(Qe){return E?null:Oe(Qe)},hn=function(Qe){return C?null:Oe(Qe)},xn=function(Qe){S&&Qe.stopPropagation()},Cn=D.useMemo(function(){return function(){var Re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Qe=Re.refKey,Et=Qe===void 0?"ref":Qe,Ht=Re.role,Nt=Re.onKeyDown,Bn=Re.onFocus,ot=Re.onBlur,Bt=Re.onClick,Xn=Re.onDragEnter,en=Re.onDragOver,Da=Re.onDragLeave,mi=Re.onDrop,Ls=_0(Re,QA);return gn(gn(Sp({onKeyDown:Rt(fs(Nt,ke)),onFocus:Rt(fs(Bn,Ke)),onBlur:Rt(fs(ot,tt)),onClick:Oe(fs(Bt,Xe)),onDragEnter:hn(fs(Xn,ue)),onDragOver:hn(fs(en,V)),onDragLeave:hn(fs(Da,le)),onDrop:hn(fs(mi,Le)),role:typeof Ht=="string"&&Ht!==""?Ht:"presentation"},Et,J),!r&&!E?{tabIndex:0}:{}),Ls)}},[J,ke,Ke,tt,Xe,ue,V,le,Le,E,C,r]),ia=D.useCallback(function(Re){Re.stopPropagation()},[]),la=D.useMemo(function(){return function(){var Re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Qe=Re.refKey,Et=Qe===void 0?"ref":Qe,Ht=Re.onChange,Nt=Re.onClick,Bn=_0(Re,YA),ot=Sp({accept:B,multiple:d,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:Oe(fs(Ht,Le)),onClick:Oe(fs(Nt,ia)),tabIndex:-1},Et,X);return gn(gn({},ot),Bn)}},[X,a,d,Le,r]);return gn(gn({},H),{},{isFocused:xe&&!r,getRootProps:Cn,getInputProps:la,rootRef:J,inputRef:X,open:Oe(ee)})}function iF(e,n){switch(n.type){case"focus":return gn(gn({},e),{},{isFocused:!0});case"blur":return gn(gn({},e),{},{isFocused:!1});case"openDialog":return gn(gn({},_p),{},{isFileDialogActive:!0});case"closeDialog":return gn(gn({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return gn(gn({},e),{},{isDragActive:n.isDragActive,isDragAccept:n.isDragAccept,isDragReject:n.isDragReject});case"setFiles":return gn(gn({},e),{},{acceptedFiles:n.acceptedFiles,fileRejections:n.fileRejections,isDragReject:n.isDragReject});case"reset":return gn({},_p);default:return e}}function iN(){}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var E0={};E0.version="0.18.5";var Tw=1252,lF=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],bg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ng=function(e){lF.indexOf(e)!=-1&&(Tw=bg[0]=e)};function oF(){Ng(1252)}var es=function(e){Ng(e)};function jg(){es(1200),oF()}function lN(e){for(var n=[],a=0,r=e.length;a<r;++a)n[a]=e.charCodeAt(a);return n}function cF(e){for(var n=[],a=0;a<e.length>>1;++a)n[a]=String.fromCharCode(e.charCodeAt(2*a)+(e.charCodeAt(2*a+1)<<8));return n.join("")}function Cw(e){for(var n=[],a=0;a<e.length>>1;++a)n[a]=String.fromCharCode(e.charCodeAt(2*a+1)+(e.charCodeAt(2*a)<<8));return n.join("")}var Ld=function(e){var n=e.charCodeAt(0),a=e.charCodeAt(1);return n==255&&a==254?cF(e.slice(2)):n==254&&a==255?Cw(e.slice(2)):n==65279?e.slice(1):e},Yh=function(n){return String.fromCharCode(n)},oN=function(n){return String.fromCharCode(n)},Jd,Yi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Zd(e){for(var n="",a=0,r=0,s=0,l=0,o=0,d=0,u=0,x=0;x<e.length;)a=e.charCodeAt(x++),l=a>>2,r=e.charCodeAt(x++),o=(a&3)<<4|r>>4,s=e.charCodeAt(x++),d=(r&15)<<2|s>>6,u=s&63,isNaN(r)?d=u=64:isNaN(s)&&(u=64),n+=Yi.charAt(l)+Yi.charAt(o)+Yi.charAt(d)+Yi.charAt(u);return n}function vr(e){var n="",a=0,r=0,s=0,l=0,o=0,d=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var x=0;x<e.length;)l=Yi.indexOf(e.charAt(x++)),o=Yi.indexOf(e.charAt(x++)),a=l<<2|o>>4,n+=String.fromCharCode(a),d=Yi.indexOf(e.charAt(x++)),r=(o&15)<<4|d>>2,d!==64&&(n+=String.fromCharCode(r)),u=Yi.indexOf(e.charAt(x++)),s=(d&3)<<6|u,u!==64&&(n+=String.fromCharCode(s));return n}var bt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ui=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(n,a){return a?new Buffer(n,a):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}})();function il(e){return bt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function cN(e){return bt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var xr=function(n){return bt?ui(n,"binary"):n.split("").map(function(a){return a.charCodeAt(0)&255})};function ox(e){if(typeof ArrayBuffer>"u")return xr(e);for(var n=new ArrayBuffer(e.length),a=new Uint8Array(n),r=0;r!=e.length;++r)a[r]=e.charCodeAt(r)&255;return n}function hl(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var n=[],a=0;a<e.length;++a)n[a]=String.fromCharCode(e[a]);return n.join("")}function dF(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function wg(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return wg(new Uint8Array(e));for(var n=new Array(e.length),a=0;a<e.length;++a)n[a]=e[a];return n}var aa=bt?function(e){return Buffer.concat(e.map(function(n){return Buffer.isBuffer(n)?n:ui(n)}))}:function(e){if(typeof Uint8Array<"u"){var n=0,a=0;for(n=0;n<e.length;++n)a+=e[n].length;var r=new Uint8Array(a),s=0;for(n=0,a=0;n<e.length;a+=s,++n)if(s=e[n].length,e[n]instanceof Uint8Array)r.set(e[n],a);else{if(typeof e[n]=="string")throw"wtf";r.set(new Uint8Array(e[n]),a)}return r}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function uF(e){for(var n=[],a=0,r=e.length+250,s=il(e.length+255),l=0;l<e.length;++l){var o=e.charCodeAt(l);if(o<128)s[a++]=o;else if(o<2048)s[a++]=192|o>>6&31,s[a++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var d=e.charCodeAt(++l)&1023;s[a++]=240|o>>8&7,s[a++]=128|o>>2&63,s[a++]=128|d>>6&15|(o&3)<<4,s[a++]=128|d&63}else s[a++]=224|o>>12&15,s[a++]=128|o>>6&63,s[a++]=128|o&63;a>r&&(n.push(s.slice(0,a)),a=0,s=il(65535),r=65530)}return n.push(s.slice(0,a)),aa(n)}var Ha=/\u0000/g,Pd=/[\u0001-\u0006]/g;function ic(e){for(var n="",a=e.length-1;a>=0;)n+=e.charAt(a--);return n}function ts(e,n){var a=""+e;return a.length>=n?a:jn("0",n-a.length)+a}function kg(e,n){var a=""+e;return a.length>=n?a:jn(" ",n-a.length)+a}function D0(e,n){var a=""+e;return a.length>=n?a:a+jn(" ",n-a.length)}function hF(e,n){var a=""+Math.round(e);return a.length>=n?a:jn("0",n-a.length)+a}function xF(e,n){var a=""+e;return a.length>=n?a:jn("0",n-a.length)+a}var dN=Math.pow(2,32);function Zo(e,n){if(e>dN||e<-dN)return hF(e,n);var a=Math.round(e);return xF(a,n)}function A0(e,n){return n=n||0,e.length>=7+n&&(e.charCodeAt(n)|32)===103&&(e.charCodeAt(n+1)|32)===101&&(e.charCodeAt(n+2)|32)===110&&(e.charCodeAt(n+3)|32)===101&&(e.charCodeAt(n+4)|32)===114&&(e.charCodeAt(n+5)|32)===97&&(e.charCodeAt(n+6)|32)===108}var uN=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],_f=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function mF(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ct={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},hN={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},fF={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function F0(e,n,a){for(var r=e<0?-1:1,s=e*r,l=0,o=1,d=0,u=1,x=0,m=0,f=Math.floor(s);x<n&&(f=Math.floor(s),d=f*o+l,m=f*x+u,!(s-f<5e-8));)s=1/(s-f),l=o,o=d,u=x,x=m;if(m>n&&(x>n?(m=u,d=l):(m=x,d=o)),!a)return[0,r*d,m];var p=Math.floor(r*d/m);return[p,r*d-p*m,m]}function Vl(e,n,a){if(e>2958465||e<0)return null;var r=e|0,s=Math.floor(86400*(e-r)),l=0,o=[],d={D:r,T:s,u:86400*(e-r)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),n&&n.date1904&&(r+=1462),d.u>.9999&&(d.u=0,++s==86400&&(d.T=s=0,++r,++d.D)),r===60)o=a?[1317,10,29]:[1900,2,29],l=3;else if(r===0)o=a?[1317,8,29]:[1900,1,0],l=6;else{r>60&&--r;var u=new Date(1900,0,1);u.setDate(u.getDate()+r-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],l=u.getDay(),r<60&&(l=(l+6)%7),a&&(l=NF(u,o))}return d.y=o[0],d.m=o[1],d.d=o[2],d.S=s%60,s=Math.floor(s/60),d.M=s%60,s=Math.floor(s/60),d.H=s,d.q=l,d}var Sw=new Date(1899,11,31,0,0,0),pF=Sw.getTime(),gF=new Date(1900,2,1,0,0,0);function _w(e,n){var a=e.getTime();return n?a-=1461*24*60*60*1e3:e>=gF&&(a+=1440*60*1e3),(a-(pF+(e.getTimezoneOffset()-Sw.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Tg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function yF(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function vF(e){var n=e<0?12:11,a=Tg(e.toFixed(12));return a.length<=n||(a=e.toPrecision(10),a.length<=n)?a:e.toExponential(5)}function bF(e){var n=Tg(e.toFixed(11));return n.length>(e<0?12:11)||n==="0"||n==="-0"?e.toPrecision(6):n}function eu(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),a;return n>=-4&&n<=-1?a=e.toPrecision(10+n):Math.abs(n)<=9?a=vF(e):n===10?a=e.toFixed(10).substr(0,12):a=bF(e),Tg(yF(a.toUpperCase()))}function lo(e,n){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):eu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Hr(14,_w(e,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+e)}function NF(e,n){n[0]-=581;var a=e.getDay();return e<60&&(a=(a+6)%7),a}function jF(e,n,a,r){var s="",l=0,o=0,d=a.y,u,x=0;switch(e){case 98:d=a.y+543;case 121:switch(n.length){case 1:case 2:u=d%100,x=2;break;default:u=d%1e4,x=4;break}break;case 109:switch(n.length){case 1:case 2:u=a.m,x=n.length;break;case 3:return _f[a.m-1][1];case 5:return _f[a.m-1][0];default:return _f[a.m-1][2]}break;case 100:switch(n.length){case 1:case 2:u=a.d,x=n.length;break;case 3:return uN[a.q][0];default:return uN[a.q][1]}break;case 104:switch(n.length){case 1:case 2:u=1+(a.H+11)%12,x=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:u=a.H,x=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:u=a.M,x=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return a.u===0&&(n=="s"||n=="ss")?ts(a.S,n.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,l=Math.round(o*(a.S+a.u)),l>=60*o&&(l=0),n==="s"?l===0?"0":""+l/o:(s=ts(l,2+r),n==="ss"?s.substr(0,2):"."+s.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":u=a.D*24+a.H;break;case"[m]":case"[mm]":u=(a.D*24+a.H)*60+a.M;break;case"[s]":case"[ss]":u=((a.D*24+a.H)*60+a.M)*60+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+n}x=n.length===3?1:2;break;case 101:u=d,x=1;break}var m=x>0?ts(u,x):"";return m}function Ji(e){var n=3;if(e.length<=n)return e;for(var a=e.length%n,r=e.substr(0,a);a!=e.length;a+=n)r+=(r.length>0?",":"")+e.substr(a,n);return r}var Ew=/%/g;function wF(e,n,a){var r=n.replace(Ew,""),s=n.length-r.length;return ai(e,r,a*Math.pow(10,2*s))+jn("%",s)}function kF(e,n,a){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return ai(e,n.substr(0,r),a/Math.pow(10,3*(n.length-r)))}function Dw(e,n){var a,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Dw(e,-n);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(n)*Math.LOG10E)%s;if(l<0&&(l+=s),a=(n/Math.pow(10,l)).toPrecision(r+1+(s+l)%s),a.indexOf("e")===-1){var o=Math.floor(Math.log(n)*Math.LOG10E);for(a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(o-a.length+l):a+="E+"+(o-l);a.substr(0,2)==="0.";)a=a.charAt(0)+a.substr(2,s)+"."+a.substr(2+s),a=a.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,u,x,m){return u+x+m.substr(0,(s+l)%s)+"."+m.substr(l)+"E"})}else a=n.toExponential(r);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var Aw=/# (\?+)( ?)\/( ?)(\d+)/;function TF(e,n,a){var r=parseInt(e[4],10),s=Math.round(n*r),l=Math.floor(s/r),o=s-l*r,d=r;return a+(l===0?"":""+l)+" "+(o===0?jn(" ",e[1].length+1+e[4].length):kg(o,e[1].length)+e[2]+"/"+e[3]+ts(d,e[4].length))}function CF(e,n,a){return a+(n===0?"":""+n)+jn(" ",e[1].length+2+e[4].length)}var Fw=/^#*0*\.([0#]+)/,Lw=/\).*[0#]/,Pw=/\(###\) ###\\?-####/;function Oa(e){for(var n="",a,r=0;r!=e.length;++r)switch(a=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(a)}return n}function xN(e,n){var a=Math.pow(10,n);return""+Math.round(e*a)/a}function mN(e,n){var a=e-Math.floor(e),r=Math.pow(10,n);return n<(""+Math.round(a*r)).length?0:Math.round(a*r)}function SF(e,n){return n<(""+Math.round((e-Math.floor(e))*Math.pow(10,n))).length?1:0}function _F(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Er(e,n,a){if(e.charCodeAt(0)===40&&!n.match(Lw)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?Er("n",r,a):"("+Er("n",r,-a)+")"}if(n.charCodeAt(n.length-1)===44)return kF(e,n,a);if(n.indexOf("%")!==-1)return wF(e,n,a);if(n.indexOf("E")!==-1)return Dw(n,a);if(n.charCodeAt(0)===36)return"$"+Er(e,n.substr(n.charAt(1)==" "?2:1),a);var s,l,o,d,u=Math.abs(a),x=a<0?"-":"";if(n.match(/^00+$/))return x+Zo(u,n.length);if(n.match(/^[#?]+$/))return s=Zo(a,0),s==="0"&&(s=""),s.length>n.length?s:Oa(n.substr(0,n.length-s.length))+s;if(l=n.match(Aw))return TF(l,u,x);if(n.match(/^#+0+$/))return x+Zo(u,n.length-n.indexOf("0"));if(l=n.match(Fw))return s=xN(a,l[1].length).replace(/^([^\.]+)$/,"$1."+Oa(l[1])).replace(/\.$/,"."+Oa(l[1])).replace(/\.(\d*)$/,function(y,g){return"."+g+jn("0",Oa(l[1]).length-g.length)}),n.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),l=n.match(/^(0*)\.(#*)$/))return x+xN(u,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=n.match(/^#{1,3},##0(\.?)$/))return x+Ji(Zo(u,0));if(l=n.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+Er(e,n,-a):Ji(""+(Math.floor(a)+SF(a,l[1].length)))+"."+ts(mN(a,l[1].length),l[1].length);if(l=n.match(/^#,#*,#0/))return Er(e,n.replace(/^#,#*,/,""),a);if(l=n.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ic(Er(e,n.replace(/[\\-]/g,""),a)),o=0,ic(ic(n.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<s.length?s.charAt(o++):y==="0"?"0":""}));if(n.match(Pw))return s=Er(e,"##########",a),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var m="";if(l=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),d=F0(u,Math.pow(10,o)-1,!1),s=""+x,m=ai("n",l[1],d[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),s+=m+l[2]+"/"+l[3],m=D0(d[2],o),m.length<l[4].length&&(m=Oa(l[4].substr(l[4].length-m.length))+m),s+=m,s;if(l=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),d=F0(u,Math.pow(10,o)-1,!0),x+(d[0]||(d[1]?"":"0"))+" "+(d[1]?kg(d[1],o)+l[2]+"/"+l[3]+D0(d[2],o):jn(" ",2*o+1+l[2].length+l[3].length));if(l=n.match(/^[#0?]+$/))return s=Zo(a,0),n.length<=s.length?s:Oa(n.substr(0,n.length-s.length))+s;if(l=n.match(/^([#0?]+)\.([#0]+)$/)){s=""+a.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=n.indexOf(".")-o,p=n.length-s.length-f;return Oa(n.substr(0,f)+s+n.substr(n.length-p))}if(l=n.match(/^00,000\.([#0]*0)$/))return o=mN(a,l[1].length),a<0?"-"+Er(e,n,-a):Ji(_F(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ts(0,3-y.length):"")+y})+"."+ts(o,l[1].length);switch(n){case"###,##0.00":return Er(e,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var N=Ji(Zo(u,0));return N!=="0"?x+N:"";case"###,###.00":return Er(e,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return Er(e,"#,##0.00",a).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function EF(e,n,a){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return ai(e,n.substr(0,r),a/Math.pow(10,3*(n.length-r)))}function DF(e,n,a){var r=n.replace(Ew,""),s=n.length-r.length;return ai(e,r,a*Math.pow(10,2*s))+jn("%",s)}function Iw(e,n){var a,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Iw(e,-n);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(n)*Math.LOG10E)%s;if(l<0&&(l+=s),a=(n/Math.pow(10,l)).toPrecision(r+1+(s+l)%s),!a.match(/[Ee]/)){var o=Math.floor(Math.log(n)*Math.LOG10E);a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(o-a.length+l):a+="E+"+(o-l),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,u,x,m){return u+x+m.substr(0,(s+l)%s)+"."+m.substr(l)+"E"})}else a=n.toExponential(r);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function gs(e,n,a){if(e.charCodeAt(0)===40&&!n.match(Lw)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?gs("n",r,a):"("+gs("n",r,-a)+")"}if(n.charCodeAt(n.length-1)===44)return EF(e,n,a);if(n.indexOf("%")!==-1)return DF(e,n,a);if(n.indexOf("E")!==-1)return Iw(n,a);if(n.charCodeAt(0)===36)return"$"+gs(e,n.substr(n.charAt(1)==" "?2:1),a);var s,l,o,d,u=Math.abs(a),x=a<0?"-":"";if(n.match(/^00+$/))return x+ts(u,n.length);if(n.match(/^[#?]+$/))return s=""+a,a===0&&(s=""),s.length>n.length?s:Oa(n.substr(0,n.length-s.length))+s;if(l=n.match(Aw))return CF(l,u,x);if(n.match(/^#+0+$/))return x+ts(u,n.length-n.indexOf("0"));if(l=n.match(Fw))return s=(""+a).replace(/^([^\.]+)$/,"$1."+Oa(l[1])).replace(/\.$/,"."+Oa(l[1])),s=s.replace(/\.(\d*)$/,function(y,g){return"."+g+jn("0",Oa(l[1]).length-g.length)}),n.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),l=n.match(/^(0*)\.(#*)$/))return x+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=n.match(/^#{1,3},##0(\.?)$/))return x+Ji(""+u);if(l=n.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+gs(e,n,-a):Ji(""+a)+"."+jn("0",l[1].length);if(l=n.match(/^#,#*,#0/))return gs(e,n.replace(/^#,#*,/,""),a);if(l=n.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ic(gs(e,n.replace(/[\\-]/g,""),a)),o=0,ic(ic(n.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<s.length?s.charAt(o++):y==="0"?"0":""}));if(n.match(Pw))return s=gs(e,"##########",a),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var m="";if(l=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),d=F0(u,Math.pow(10,o)-1,!1),s=""+x,m=ai("n",l[1],d[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),s+=m+l[2]+"/"+l[3],m=D0(d[2],o),m.length<l[4].length&&(m=Oa(l[4].substr(l[4].length-m.length))+m),s+=m,s;if(l=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),d=F0(u,Math.pow(10,o)-1,!0),x+(d[0]||(d[1]?"":"0"))+" "+(d[1]?kg(d[1],o)+l[2]+"/"+l[3]+D0(d[2],o):jn(" ",2*o+1+l[2].length+l[3].length));if(l=n.match(/^[#0?]+$/))return s=""+a,n.length<=s.length?s:Oa(n.substr(0,n.length-s.length))+s;if(l=n.match(/^([#0]+)\.([#0]+)$/)){s=""+a.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=n.indexOf(".")-o,p=n.length-s.length-f;return Oa(n.substr(0,f)+s+n.substr(n.length-p))}if(l=n.match(/^00,000\.([#0]*0)$/))return a<0?"-"+gs(e,n,-a):Ji(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ts(0,3-y.length):"")+y})+"."+ts(0,l[1].length);switch(n){case"###,###":case"##,###":case"#,###":var N=Ji(""+u);return N!=="0"?x+N:"";default:if(n.match(/\.[0#?]*$/))return gs(e,n.slice(0,n.lastIndexOf(".")),a)+Oa(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function ai(e,n,a){return(a|0)===a?gs(e,n,a):Er(e,n,a)}function AF(e){for(var n=[],a=!1,r=0,s=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:a=!a;break;case 95:case 42:case 92:++r;break;case 59:n[n.length]=e.substr(s,r-s),s=r+1}if(n[n.length]=e.substr(s),a===!0)throw new Error("Format |"+e+"| unterminated string ");return n}var Ow=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ic(e){for(var n=0,a="",r="";n<e.length;)switch(a=e.charAt(n)){case"G":A0(e,n)&&(n+=6),n++;break;case'"':for(;e.charCodeAt(++n)!==34&&n<e.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(e.charAt(n+1)==="1"||e.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(n,3).toUpperCase()==="A/P"||e.substr(n,5).toUpperCase()==="AM/PM"||e.substr(n,5).toUpperCase()==="/")return!0;++n;break;case"[":for(r=a;e.charAt(n++)!=="]"&&n<e.length;)r+=e.charAt(n);if(r.match(Ow))return!0;break;case".":case"0":case"#":for(;n<e.length&&("0#?.,E+-%".indexOf(a=e.charAt(++n))>-1||a=="\\"&&e.charAt(n+1)=="-"&&"0#".indexOf(e.charAt(n+2))>-1););break;case"?":for(;e.charAt(++n)===a;);break;case"*":++n,(e.charAt(n)==" "||e.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<e.length&&"0123456789".indexOf(e.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function FF(e,n,a,r){for(var s=[],l="",o=0,d="",u="t",x,m,f,p="H";o<e.length;)switch(d=e.charAt(o)){case"G":if(!A0(e,o))throw new Error("unrecognized character "+d+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(l="";(f=e.charCodeAt(++o))!==34&&o<e.length;)l+=String.fromCharCode(f);s[s.length]={t:"t",v:l},++o;break;case"\\":var N=e.charAt(++o),y=N==="("||N===")"?N:"t";s[s.length]={t:y,v:N},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:n},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(x==null&&(x=Vl(n,a,e.charAt(o+1)==="2"),x==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},u=d,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||x==null&&(x=Vl(n,a),x==null))return"";for(l=d;++o<e.length&&e.charAt(o).toLowerCase()===d;)l+=d;d==="m"&&u.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=p),s[s.length]={t:d,v:l},u=d;break;case"A":case"a":case"":var g={t:d,v:d};if(x==null&&(x=Vl(n,a)),e.substr(o,3).toUpperCase()==="A/P"?(x!=null&&(g.v=x.H>=12?"P":"A"),g.t="T",p="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(x!=null&&(g.v=x.H>=12?"PM":"AM"),g.t="T",o+=5,p="h"):e.substr(o,5).toUpperCase()==="/"?(x!=null&&(g.v=x.H>=12?"":""),g.t="T",o+=5,p="h"):(g.t="t",++o),x==null&&g.t==="T")return"";s[s.length]=g,u=d;break;case"[":for(l=d;e.charAt(o++)!=="]"&&o<e.length;)l+=e.charAt(o);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(Ow)){if(x==null&&(x=Vl(n,a),x==null))return"";s[s.length]={t:"Z",v:l.toLowerCase()},u=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ic(e)||(s[s.length]={t:"t",v:l}));break;case".":if(x!=null){for(l=d;++o<e.length&&(d=e.charAt(o))==="0";)l+=d;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=d;++o<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(o))>-1;)l+=d;s[s.length]={t:"n",v:l};break;case"?":for(l=d;e.charAt(++o)===d;)l+=d;s[s.length]={t:d,v:l},u=d;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:r===1?"t":d,v:d},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=d;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)l+=e.charAt(o);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:d,v:d},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+e);s[s.length]={t:"t",v:d},++o;break}var b=0,j=0,T;for(o=s.length-1,u="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=p,u="h",b<1&&(b=1);break;case"s":(T=s[o].v.match(/\.0+$/))&&(j=Math.max(j,T[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":u=s[o].t;break;case"m":u==="s"&&(s[o].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&s[o].v.match(/[Hh]/)&&(b=1),b<2&&s[o].v.match(/[Mm]/)&&(b=2),b<3&&s[o].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M),x.M>=60&&(x.M=0,++x.H);break;case 2:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M);break}var _="",w;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=jF(s[o].t.charCodeAt(0),s[o].v,x,j),s[o].t="t";break;case"n":case"?":for(w=o+1;s[w]!=null&&((d=s[w].t)==="?"||d==="D"||(d===" "||d==="t")&&s[w+1]!=null&&(s[w+1].t==="?"||s[w+1].t==="t"&&s[w+1].v==="/")||s[o].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(s[w].v==="/"||s[w].v===" "&&s[w+1]!=null&&s[w+1].t=="?"));)s[o].v+=s[w].v,s[w]={v:"",t:";"},++w;_+=s[o].v,o=w-1;break;case"G":s[o].t="t",s[o].v=lo(n,a);break}var E="",C,S;if(_.length>0){_.charCodeAt(0)==40?(C=n<0&&_.charCodeAt(0)===45?-n:n,S=ai("n",_,C)):(C=n<0&&r>1?-n:n,S=ai("n",_,C),C<0&&s[0]&&s[0].t=="t"&&(S=S.substr(1),s[0].v="-"+s[0].v)),w=S.length-1;var P=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){P=o;break}var F=s.length;if(P===s.length&&S.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(w>=s[o].v.length-1?(w-=s[o].v.length,s[o].v=S.substr(w+1,s[o].v.length)):w<0?s[o].v="":(s[o].v=S.substr(0,w+1),w=-1),s[o].t="t",F=o);w>=0&&F<s.length&&(s[F].v=S.substr(0,w+1)+s[F].v)}else if(P!==s.length&&S.indexOf("E")===-1){for(w=S.indexOf(".")-1,o=P;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(m=s[o].v.indexOf(".")>-1&&o===P?s[o].v.indexOf(".")-1:s[o].v.length-1,E=s[o].v.substr(m+1);m>=0;--m)w>=0&&(s[o].v.charAt(m)==="0"||s[o].v.charAt(m)==="#")&&(E=S.charAt(w--)+E);s[o].v=E,s[o].t="t",F=o}for(w>=0&&F<s.length&&(s[F].v=S.substr(0,w+1)+s[F].v),w=S.indexOf(".")+1,o=P;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==P)){for(m=s[o].v.indexOf(".")>-1&&o===P?s[o].v.indexOf(".")+1:0,E=s[o].v.substr(0,m);m<s[o].v.length;++m)w<S.length&&(E+=S.charAt(w++));s[o].v=E,s[o].t="t",F=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(C=r>1&&n<0&&o>0&&s[o-1].v==="-"?-n:n,s[o].v=ai(s[o].t,s[o].v,C),s[o].t="t");var B="";for(o=0;o!==s.length;++o)s[o]!=null&&(B+=s[o].v);return B}var fN=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function pN(e,n){if(n==null)return!1;var a=parseFloat(n[2]);switch(n[1]){case"=":if(e==a)return!0;break;case">":if(e>a)return!0;break;case"<":if(e<a)return!0;break;case"<>":if(e!=a)return!0;break;case">=":if(e>=a)return!0;break;case"<=":if(e<=a)return!0;break}return!1}function LF(e,n){var a=AF(e),r=a.length,s=a[r-1].indexOf("@");if(r<4&&s>-1&&--r,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if(typeof n!="number")return[4,a.length===4||s>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=s>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=s>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=s>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"];break}var l=n>0?a[0]:n<0?a[1]:a[2];if(a[0].indexOf("[")===-1&&a[1].indexOf("[")===-1)return[r,l];if(a[0].match(/\[[=<>]/)!=null||a[1].match(/\[[=<>]/)!=null){var o=a[0].match(fN),d=a[1].match(fN);return pN(n,o)?[r,a[0]]:pN(n,d)?[r,a[1]]:[r,a[o!=null&&d!=null?2:1]]}return[r,l]}function Hr(e,n,a){a==null&&(a={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&a.dateNF?r=a.dateNF:r=e;break;case"number":e==14&&a.dateNF?r=a.dateNF:r=(a.table!=null?a.table:ct)[e],r==null&&(r=a.table&&a.table[hN[e]]||ct[hN[e]]),r==null&&(r=fF[e]||"General");break}if(A0(r,0))return lo(n,a);n instanceof Date&&(n=_w(n,a.date1904));var s=LF(r,n);if(A0(s[1]))return lo(n,a);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return FF(s[1],n,a,s[0])}function ri(e,n){if(typeof n!="number"){n=+n||-1;for(var a=0;a<392;++a){if(ct[a]==null){n<0&&(n=a);continue}if(ct[a]==e){n=a;break}}n<0&&(n=391)}return ct[n]=e,n}function cx(e){for(var n=0;n!=392;++n)e[n]!==void 0&&ri(e[n],n)}function Oc(){ct=mF()}var PF={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Mw=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function IF(e){var n=typeof e=="number"?ct[e]:e;return n=n.replace(Mw,"(\\d+)"),new RegExp("^"+n+"$")}function OF(e,n,a){var r=-1,s=-1,l=-1,o=-1,d=-1,u=-1;(n.match(Mw)||[]).forEach(function(f,p){var N=parseInt(a[p+1],10);switch(f.toLowerCase().charAt(0)){case"y":r=N;break;case"d":l=N;break;case"h":o=N;break;case"s":u=N;break;case"m":o>=0?d=N:s=N;break}}),u>=0&&d==-1&&s>=0&&(d=s,s=-1);var x=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);x.length==7&&(x="0"+x),x.length==8&&(x="20"+x);var m=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&d==-1&&u==-1?x:r==-1&&s==-1&&l==-1?m:x+"T"+m}var MF=(function(){var e={};e.version="1.2.0";function n(){for(var S=0,P=new Array(256),F=0;F!=256;++F)S=F,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,P[F]=S;return typeof Int32Array<"u"?new Int32Array(P):P}var a=n();function r(S){var P=0,F=0,B=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)O[B]=S[B];for(B=0;B!=256;++B)for(F=S[B],P=256+B;P<4096;P+=256)F=O[P]=F>>>8^S[F&255];var M=[];for(B=1;B!=16;++B)M[B-1]=typeof Int32Array<"u"?O.subarray(B*256,B*256+256):O.slice(B*256,B*256+256);return M}var s=r(a),l=s[0],o=s[1],d=s[2],u=s[3],x=s[4],m=s[5],f=s[6],p=s[7],N=s[8],y=s[9],g=s[10],b=s[11],j=s[12],T=s[13],_=s[14];function w(S,P){for(var F=P^-1,B=0,O=S.length;B<O;)F=F>>>8^a[(F^S.charCodeAt(B++))&255];return~F}function E(S,P){for(var F=P^-1,B=S.length-15,O=0;O<B;)F=_[S[O++]^F&255]^T[S[O++]^F>>8&255]^j[S[O++]^F>>16&255]^b[S[O++]^F>>>24]^g[S[O++]]^y[S[O++]]^N[S[O++]]^p[S[O++]]^f[S[O++]]^m[S[O++]]^x[S[O++]]^u[S[O++]]^d[S[O++]]^o[S[O++]]^l[S[O++]]^a[S[O++]];for(B+=15;O<B;)F=F>>>8^a[(F^S[O++])&255];return~F}function C(S,P){for(var F=P^-1,B=0,O=S.length,M=0,G=0;B<O;)M=S.charCodeAt(B++),M<128?F=F>>>8^a[(F^M)&255]:M<2048?(F=F>>>8^a[(F^(192|M>>6&31))&255],F=F>>>8^a[(F^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,G=S.charCodeAt(B++)&1023,F=F>>>8^a[(F^(240|M>>8&7))&255],F=F>>>8^a[(F^(128|M>>2&63))&255],F=F>>>8^a[(F^(128|G>>6&15|(M&3)<<4))&255],F=F>>>8^a[(F^(128|G&63))&255]):(F=F>>>8^a[(F^(224|M>>12&15))&255],F=F>>>8^a[(F^(128|M>>6&63))&255],F=F>>>8^a[(F^(128|M&63))&255]);return~F}return e.table=a,e.bstr=w,e.buf=E,e.str=C,e})(),rt=(function(){var n={};n.version="1.2.1";function a(z,ae){for(var Y=z.split("/"),Z=ae.split("/"),re=0,se=0,ve=Math.min(Y.length,Z.length);re<ve;++re){if(se=Y[re].length-Z[re].length)return se;if(Y[re]!=Z[re])return Y[re]<Z[re]?-1:1}return Y.length-Z.length}function r(z){if(z.charAt(z.length-1)=="/")return z.slice(0,-1).indexOf("/")===-1?z:r(z.slice(0,-1));var ae=z.lastIndexOf("/");return ae===-1?z:z.slice(0,ae+1)}function s(z){if(z.charAt(z.length-1)=="/")return s(z.slice(0,-1));var ae=z.lastIndexOf("/");return ae===-1?z:z.slice(ae+1)}function l(z,ae){typeof ae=="string"&&(ae=new Date(ae));var Y=ae.getHours();Y=Y<<6|ae.getMinutes(),Y=Y<<5|ae.getSeconds()>>>1,z.write_shift(2,Y);var Z=ae.getFullYear()-1980;Z=Z<<4|ae.getMonth()+1,Z=Z<<5|ae.getDate(),z.write_shift(2,Z)}function o(z){var ae=z.read_shift(2)&65535,Y=z.read_shift(2)&65535,Z=new Date,re=Y&31;Y>>>=5;var se=Y&15;Y>>>=4,Z.setMilliseconds(0),Z.setFullYear(Y+1980),Z.setMonth(se-1),Z.setDate(re);var ve=ae&31;ae>>>=5;var Ce=ae&63;return ae>>>=6,Z.setHours(ae),Z.setMinutes(Ce),Z.setSeconds(ve<<1),Z}function d(z){ha(z,0);for(var ae={},Y=0;z.l<=z.length-4;){var Z=z.read_shift(2),re=z.read_shift(2),se=z.l+re,ve={};switch(Z){case 21589:Y=z.read_shift(1),Y&1&&(ve.mtime=z.read_shift(4)),re>5&&(Y&2&&(ve.atime=z.read_shift(4)),Y&4&&(ve.ctime=z.read_shift(4))),ve.mtime&&(ve.mt=new Date(ve.mtime*1e3));break}z.l=se,ae[Z]=ve}return ae}var u;function x(){return u||(u={})}function m(z,ae){if(z[0]==80&&z[1]==75)return ko(z,ae);if((z[0]|32)==109&&(z[1]|32)==105)return Ru(z,ae);if(z.length<512)throw new Error("CFB file size "+z.length+" < 512");var Y=3,Z=512,re=0,se=0,ve=0,Ce=0,ye=0,be=[],Ne=z.slice(0,512);ha(Ne,0);var Pe=f(Ne);switch(Y=Pe[0],Y){case 3:Z=512;break;case 4:Z=4096;break;case 0:if(Pe[1]==0)return ko(z,ae);default:throw new Error("Major Version: Expected 3 or 4 saw "+Y)}Z!==512&&(Ne=z.slice(0,Z),ha(Ne,28));var ze=z.slice(0,Z);p(Ne,Y);var qe=Ne.read_shift(4,"i");if(Y===3&&qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qe);Ne.l+=4,ve=Ne.read_shift(4,"i"),Ne.l+=4,Ne.chk("00100000","Mini Stream Cutoff Size: "),Ce=Ne.read_shift(4,"i"),re=Ne.read_shift(4,"i"),ye=Ne.read_shift(4,"i"),se=Ne.read_shift(4,"i");for(var Be=-1,Me=0;Me<109&&(Be=Ne.read_shift(4,"i"),!(Be<0));++Me)be[Me]=Be;var mt=N(z,Z);b(ye,se,mt,Z,be);var Qt=T(mt,ve,be,Z);Qt[ve].name="!Directory",re>0&&Ce!==G&&(Qt[Ce].name="!MiniFAT"),Qt[be[0]].name="!FAT",Qt.fat_addrs=be,Qt.ssz=Z;var tn={},Sn=[],yl=[],yi=[];_(ve,Qt,mt,Sn,re,tn,yl,Ce),y(yl,yi,Sn),Sn.shift();var cs={FileIndex:yl,FullPaths:yi};return ae&&ae.raw&&(cs.raw={header:ze,sectors:mt}),cs}function f(z){if(z[z.l]==80&&z[z.l+1]==75)return[0,0];z.chk(J,"Header Signature: "),z.l+=16;var ae=z.read_shift(2,"u");return[z.read_shift(2,"u"),ae]}function p(z,ae){var Y=9;switch(z.l+=2,Y=z.read_shift(2)){case 9:if(ae!=3)throw new Error("Sector Shift: Expected 9 saw "+Y);break;case 12:if(ae!=4)throw new Error("Sector Shift: Expected 12 saw "+Y);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Y)}z.chk("0600","Mini Sector Shift: "),z.chk("000000000000","Reserved: ")}function N(z,ae){for(var Y=Math.ceil(z.length/ae)-1,Z=[],re=1;re<Y;++re)Z[re-1]=z.slice(re*ae,(re+1)*ae);return Z[Y-1]=z.slice(Y*ae),Z}function y(z,ae,Y){for(var Z=0,re=0,se=0,ve=0,Ce=0,ye=Y.length,be=[],Ne=[];Z<ye;++Z)be[Z]=Ne[Z]=Z,ae[Z]=Y[Z];for(;Ce<Ne.length;++Ce)Z=Ne[Ce],re=z[Z].L,se=z[Z].R,ve=z[Z].C,be[Z]===Z&&(re!==-1&&be[re]!==re&&(be[Z]=be[re]),se!==-1&&be[se]!==se&&(be[Z]=be[se])),ve!==-1&&(be[ve]=Z),re!==-1&&Z!=be[Z]&&(be[re]=be[Z],Ne.lastIndexOf(re)<Ce&&Ne.push(re)),se!==-1&&Z!=be[Z]&&(be[se]=be[Z],Ne.lastIndexOf(se)<Ce&&Ne.push(se));for(Z=1;Z<ye;++Z)be[Z]===Z&&(se!==-1&&be[se]!==se?be[Z]=be[se]:re!==-1&&be[re]!==re&&(be[Z]=be[re]));for(Z=1;Z<ye;++Z)if(z[Z].type!==0){if(Ce=Z,Ce!=be[Ce])do Ce=be[Ce],ae[Z]=ae[Ce]+"/"+ae[Z];while(Ce!==0&&be[Ce]!==-1&&Ce!=be[Ce]);be[Z]=-1}for(ae[0]+="/",Z=1;Z<ye;++Z)z[Z].type!==2&&(ae[Z]+="/")}function g(z,ae,Y){for(var Z=z.start,re=z.size,se=[],ve=Z;Y&&re>0&&ve>=0;)se.push(ae.slice(ve*M,ve*M+M)),re-=M,ve=Rl(Y,ve*4);return se.length===0?Te(0):aa(se).slice(0,z.size)}function b(z,ae,Y,Z,re){var se=G;if(z===G){if(ae!==0)throw new Error("DIFAT chain shorter than expected")}else if(z!==-1){var ve=Y[z],Ce=(Z>>>2)-1;if(!ve)return;for(var ye=0;ye<Ce&&(se=Rl(ve,ye*4))!==G;++ye)re.push(se);b(Rl(ve,Z-4),ae-1,Y,Z,re)}}function j(z,ae,Y,Z,re){var se=[],ve=[];re||(re=[]);var Ce=Z-1,ye=0,be=0;for(ye=ae;ye>=0;){re[ye]=!0,se[se.length]=ye,ve.push(z[ye]);var Ne=Y[Math.floor(ye*4/Z)];if(be=ye*4&Ce,Z<4+be)throw new Error("FAT boundary crossed: "+ye+" 4 "+Z);if(!z[Ne])break;ye=Rl(z[Ne],be)}return{nodes:se,data:_N([ve])}}function T(z,ae,Y,Z){var re=z.length,se=[],ve=[],Ce=[],ye=[],be=Z-1,Ne=0,Pe=0,ze=0,qe=0;for(Ne=0;Ne<re;++Ne)if(Ce=[],ze=Ne+ae,ze>=re&&(ze-=re),!ve[ze]){ye=[];var Be=[];for(Pe=ze;Pe>=0;){Be[Pe]=!0,ve[Pe]=!0,Ce[Ce.length]=Pe,ye.push(z[Pe]);var Me=Y[Math.floor(Pe*4/Z)];if(qe=Pe*4&be,Z<4+qe)throw new Error("FAT boundary crossed: "+Pe+" 4 "+Z);if(!z[Me]||(Pe=Rl(z[Me],qe),Be[Pe]))break}se[ze]={nodes:Ce,data:_N([ye])}}return se}function _(z,ae,Y,Z,re,se,ve,Ce){for(var ye=0,be=Z.length?2:0,Ne=ae[z].data,Pe=0,ze=0,qe;Pe<Ne.length;Pe+=128){var Be=Ne.slice(Pe,Pe+128);ha(Be,64),ze=Be.read_shift(2),qe=Fg(Be,0,ze-be),Z.push(qe);var Me={name:qe,type:Be.read_shift(1),color:Be.read_shift(1),L:Be.read_shift(4,"i"),R:Be.read_shift(4,"i"),C:Be.read_shift(4,"i"),clsid:Be.read_shift(16),state:Be.read_shift(4,"i"),start:0,size:0},mt=Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2);mt!==0&&(Me.ct=w(Be,Be.l-8));var Qt=Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2);Qt!==0&&(Me.mt=w(Be,Be.l-8)),Me.start=Be.read_shift(4,"i"),Me.size=Be.read_shift(4,"i"),Me.size<0&&Me.start<0&&(Me.size=Me.type=0,Me.start=G,Me.name=""),Me.type===5?(ye=Me.start,re>0&&ye!==G&&(ae[ye].name="!StreamData")):Me.size>=4096?(Me.storage="fat",ae[Me.start]===void 0&&(ae[Me.start]=j(Y,Me.start,ae.fat_addrs,ae.ssz)),ae[Me.start].name=Me.name,Me.content=ae[Me.start].data.slice(0,Me.size)):(Me.storage="minifat",Me.size<0?Me.size=0:ye!==G&&Me.start!==G&&ae[ye]&&(Me.content=g(Me,ae[ye].data,(ae[Ce]||{}).data))),Me.content&&ha(Me.content,0),se[qe]=Me,ve.push(Me)}}function w(z,ae){return new Date((hr(z,ae+4)/1e7*Math.pow(2,32)+hr(z,ae)/1e7-11644473600)*1e3)}function E(z,ae){return x(),m(u.readFileSync(z),ae)}function C(z,ae){var Y=ae&&ae.type;switch(Y||bt&&Buffer.isBuffer(z)&&(Y="buffer"),Y||"base64"){case"file":return E(z,ae);case"base64":return m(xr(vr(z)),ae);case"binary":return m(xr(z),ae)}return m(z,ae)}function S(z,ae){var Y=ae||{},Z=Y.root||"Root Entry";if(z.FullPaths||(z.FullPaths=[]),z.FileIndex||(z.FileIndex=[]),z.FullPaths.length!==z.FileIndex.length)throw new Error("inconsistent CFB structure");z.FullPaths.length===0&&(z.FullPaths[0]=Z+"/",z.FileIndex[0]={name:Z,type:5}),Y.CLSID&&(z.FileIndex[0].clsid=Y.CLSID),P(z)}function P(z){var ae="Sh33tJ5";if(!rt.find(z,"/"+ae)){var Y=Te(4);Y[0]=55,Y[1]=Y[3]=50,Y[2]=54,z.FileIndex.push({name:ae,type:2,content:Y,size:4,L:69,R:69,C:69}),z.FullPaths.push(z.FullPaths[0]+ae),F(z)}}function F(z,ae){S(z);for(var Y=!1,Z=!1,re=z.FullPaths.length-1;re>=0;--re){var se=z.FileIndex[re];switch(se.type){case 0:Z?Y=!0:(z.FileIndex.pop(),z.FullPaths.pop());break;case 1:case 2:case 5:Z=!0,isNaN(se.R*se.L*se.C)&&(Y=!0),se.R>-1&&se.L>-1&&se.R==se.L&&(Y=!0);break;default:Y=!0;break}}if(!(!Y&&!ae)){var ve=new Date(1987,1,19),Ce=0,ye=Object.create?Object.create(null):{},be=[];for(re=0;re<z.FullPaths.length;++re)ye[z.FullPaths[re]]=!0,z.FileIndex[re].type!==0&&be.push([z.FullPaths[re],z.FileIndex[re]]);for(re=0;re<be.length;++re){var Ne=r(be[re][0]);Z=ye[Ne],Z||(be.push([Ne,{name:s(Ne).replace("/",""),type:1,clsid:fe,ct:ve,mt:ve,content:null}]),ye[Ne]=!0)}for(be.sort(function(qe,Be){return a(qe[0],Be[0])}),z.FullPaths=[],z.FileIndex=[],re=0;re<be.length;++re)z.FullPaths[re]=be[re][0],z.FileIndex[re]=be[re][1];for(re=0;re<be.length;++re){var Pe=z.FileIndex[re],ze=z.FullPaths[re];if(Pe.name=s(ze).replace("/",""),Pe.L=Pe.R=Pe.C=-(Pe.color=1),Pe.size=Pe.content?Pe.content.length:0,Pe.start=0,Pe.clsid=Pe.clsid||fe,re===0)Pe.C=be.length>1?1:-1,Pe.size=0,Pe.type=5;else if(ze.slice(-1)=="/"){for(Ce=re+1;Ce<be.length&&r(z.FullPaths[Ce])!=ze;++Ce);for(Pe.C=Ce>=be.length?-1:Ce,Ce=re+1;Ce<be.length&&r(z.FullPaths[Ce])!=r(ze);++Ce);Pe.R=Ce>=be.length?-1:Ce,Pe.type=1}else r(z.FullPaths[re+1]||"")==r(ze)&&(Pe.R=re+1),Pe.type=2}}}function B(z,ae){var Y=ae||{};if(Y.fileType=="mad")return pl(z,Y);switch(F(z),Y.fileType){case"zip":return gi(z,Y)}var Z=(function(qe){for(var Be=0,Me=0,mt=0;mt<qe.FileIndex.length;++mt){var Qt=qe.FileIndex[mt];if(Qt.content){var tn=Qt.content.length;tn>0&&(tn<4096?Be+=tn+63>>6:Me+=tn+511>>9)}}for(var Sn=qe.FullPaths.length+3>>2,yl=Be+7>>3,yi=Be+127>>7,cs=yl+Me+Sn+yi,Qn=cs+127>>7,Uc=Qn<=109?0:Math.ceil((Qn-109)/127);cs+Qn+Uc+127>>7>Qn;)Uc=++Qn<=109?0:Math.ceil((Qn-109)/127);var _n=[1,Uc,Qn,yi,Sn,Me,Be,0];return qe.FileIndex[0].size=Be<<6,_n[7]=(qe.FileIndex[0].start=_n[0]+_n[1]+_n[2]+_n[3]+_n[4]+_n[5])+(_n[6]+7>>3),_n})(z),re=Te(Z[7]<<9),se=0,ve=0;{for(se=0;se<8;++se)re.write_shift(1,X[se]);for(se=0;se<8;++se)re.write_shift(2,0);for(re.write_shift(2,62),re.write_shift(2,3),re.write_shift(2,65534),re.write_shift(2,9),re.write_shift(2,6),se=0;se<3;++se)re.write_shift(2,0);for(re.write_shift(4,0),re.write_shift(4,Z[2]),re.write_shift(4,Z[0]+Z[1]+Z[2]+Z[3]-1),re.write_shift(4,0),re.write_shift(4,4096),re.write_shift(4,Z[3]?Z[0]+Z[1]+Z[2]-1:G),re.write_shift(4,Z[3]),re.write_shift(-4,Z[1]?Z[0]-1:G),re.write_shift(4,Z[1]),se=0;se<109;++se)re.write_shift(-4,se<Z[2]?Z[1]+se:-1)}if(Z[1])for(ve=0;ve<Z[1];++ve){for(;se<236+ve*127;++se)re.write_shift(-4,se<Z[2]?Z[1]+se:-1);re.write_shift(-4,ve===Z[1]-1?G:ve+1)}var Ce=function(qe){for(ve+=qe;se<ve-1;++se)re.write_shift(-4,se+1);qe&&(++se,re.write_shift(-4,G))};for(ve=se=0,ve+=Z[1];se<ve;++se)re.write_shift(-4,ne.DIFSECT);for(ve+=Z[2];se<ve;++se)re.write_shift(-4,ne.FATSECT);Ce(Z[3]),Ce(Z[4]);for(var ye=0,be=0,Ne=z.FileIndex[0];ye<z.FileIndex.length;++ye)Ne=z.FileIndex[ye],Ne.content&&(be=Ne.content.length,!(be<4096)&&(Ne.start=ve,Ce(be+511>>9)));for(Ce(Z[6]+7>>3);re.l&511;)re.write_shift(-4,ne.ENDOFCHAIN);for(ve=se=0,ye=0;ye<z.FileIndex.length;++ye)Ne=z.FileIndex[ye],Ne.content&&(be=Ne.content.length,!(!be||be>=4096)&&(Ne.start=ve,Ce(be+63>>6)));for(;re.l&511;)re.write_shift(-4,ne.ENDOFCHAIN);for(se=0;se<Z[4]<<2;++se){var Pe=z.FullPaths[se];if(!Pe||Pe.length===0){for(ye=0;ye<17;++ye)re.write_shift(4,0);for(ye=0;ye<3;++ye)re.write_shift(4,-1);for(ye=0;ye<12;++ye)re.write_shift(4,0);continue}Ne=z.FileIndex[se],se===0&&(Ne.start=Ne.size?Ne.start-1:G);var ze=se===0&&Y.root||Ne.name;if(be=2*(ze.length+1),re.write_shift(64,ze,"utf16le"),re.write_shift(2,be),re.write_shift(1,Ne.type),re.write_shift(1,Ne.color),re.write_shift(-4,Ne.L),re.write_shift(-4,Ne.R),re.write_shift(-4,Ne.C),Ne.clsid)re.write_shift(16,Ne.clsid,"hex");else for(ye=0;ye<4;++ye)re.write_shift(4,0);re.write_shift(4,Ne.state||0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,Ne.start),re.write_shift(4,Ne.size),re.write_shift(4,0)}for(se=1;se<z.FileIndex.length;++se)if(Ne=z.FileIndex[se],Ne.size>=4096)if(re.l=Ne.start+1<<9,bt&&Buffer.isBuffer(Ne.content))Ne.content.copy(re,re.l,0,Ne.size),re.l+=Ne.size+511&-512;else{for(ye=0;ye<Ne.size;++ye)re.write_shift(1,Ne.content[ye]);for(;ye&511;++ye)re.write_shift(1,0)}for(se=1;se<z.FileIndex.length;++se)if(Ne=z.FileIndex[se],Ne.size>0&&Ne.size<4096)if(bt&&Buffer.isBuffer(Ne.content))Ne.content.copy(re,re.l,0,Ne.size),re.l+=Ne.size+63&-64;else{for(ye=0;ye<Ne.size;++ye)re.write_shift(1,Ne.content[ye]);for(;ye&63;++ye)re.write_shift(1,0)}if(bt)re.l=re.length;else for(;re.l<re.length;)re.write_shift(1,0);return re}function O(z,ae){var Y=z.FullPaths.map(function(ye){return ye.toUpperCase()}),Z=Y.map(function(ye){var be=ye.split("/");return be[be.length-(ye.slice(-1)=="/"?2:1)]}),re=!1;ae.charCodeAt(0)===47?(re=!0,ae=Y[0].slice(0,-1)+ae):re=ae.indexOf("/")!==-1;var se=ae.toUpperCase(),ve=re===!0?Y.indexOf(se):Z.indexOf(se);if(ve!==-1)return z.FileIndex[ve];var Ce=!se.match(Pd);for(se=se.replace(Ha,""),Ce&&(se=se.replace(Pd,"!")),ve=0;ve<Y.length;++ve)if((Ce?Y[ve].replace(Pd,"!"):Y[ve]).replace(Ha,"")==se||(Ce?Z[ve].replace(Pd,"!"):Z[ve]).replace(Ha,"")==se)return z.FileIndex[ve];return null}var M=64,G=-2,J="d0cf11e0a1b11ae1",X=[208,207,17,224,161,177,26,225],fe="00000000000000000000000000000000",ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:G,FREESECT:-1,HEADER_SIGNATURE:J,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function H(z,ae,Y){x();var Z=B(z,Y);u.writeFileSync(ae,Z)}function W(z){for(var ae=new Array(z.length),Y=0;Y<z.length;++Y)ae[Y]=String.fromCharCode(z[Y]);return ae.join("")}function xe(z,ae){var Y=B(z,ae);switch(ae&&ae.type||"buffer"){case"file":return x(),u.writeFileSync(ae.filename,Y),Y;case"binary":return typeof Y=="string"?Y:W(Y);case"base64":return Zd(typeof Y=="string"?Y:W(Y));case"buffer":if(bt)return Buffer.isBuffer(Y)?Y:ui(Y);case"array":return typeof Y=="string"?xr(Y):Y}return Y}var K;function L(z){try{var ae=z.InflateRaw,Y=new ae;if(Y._processChunk(new Uint8Array([3,0]),Y._finishFlushFlag),Y.bytesRead)K=z;else throw new Error("zlib does not expose bytesRead")}catch(Z){console.error("cannot use native zlib: "+(Z.message||Z))}}function Q(z,ae){if(!K)return os(z,ae);var Y=K.InflateRaw,Z=new Y,re=Z._processChunk(z.slice(z.l),Z._finishFlushFlag);return z.l+=Z.bytesRead,re}function I(z){return K?K.deflateRawSync(z):ot(z)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ue=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function V(z){var ae=(z<<1|z<<11)&139536|(z<<5|z<<15)&558144;return(ae>>16|ae>>8|ae)&255}for(var le=typeof Uint8Array<"u",q=le?new Uint8Array(256):[],Le=0;Le<256;++Le)q[Le]=V(Le);function ee(z,ae){var Y=q[z&255];return ae<=8?Y>>>8-ae:(Y=Y<<8|q[z>>8&255],ae<=16?Y>>>16-ae:(Y=Y<<8|q[z>>16&255],Y>>>24-ae))}function ke(z,ae){var Y=ae&7,Z=ae>>>3;return(z[Z]|(Y<=6?0:z[Z+1]<<8))>>>Y&3}function Ke(z,ae){var Y=ae&7,Z=ae>>>3;return(z[Z]|(Y<=5?0:z[Z+1]<<8))>>>Y&7}function tt(z,ae){var Y=ae&7,Z=ae>>>3;return(z[Z]|(Y<=4?0:z[Z+1]<<8))>>>Y&15}function Xe(z,ae){var Y=ae&7,Z=ae>>>3;return(z[Z]|(Y<=3?0:z[Z+1]<<8))>>>Y&31}function Oe(z,ae){var Y=ae&7,Z=ae>>>3;return(z[Z]|(Y<=1?0:z[Z+1]<<8))>>>Y&127}function Rt(z,ae,Y){var Z=ae&7,re=ae>>>3,se=(1<<Y)-1,ve=z[re]>>>Z;return Y<8-Z||(ve|=z[re+1]<<8-Z,Y<16-Z)||(ve|=z[re+2]<<16-Z,Y<24-Z)||(ve|=z[re+3]<<24-Z),ve&se}function hn(z,ae,Y){var Z=ae&7,re=ae>>>3;return Z<=5?z[re]|=(Y&7)<<Z:(z[re]|=Y<<Z&255,z[re+1]=(Y&7)>>8-Z),ae+3}function xn(z,ae,Y){var Z=ae&7,re=ae>>>3;return Y=(Y&1)<<Z,z[re]|=Y,ae+1}function Cn(z,ae,Y){var Z=ae&7,re=ae>>>3;return Y<<=Z,z[re]|=Y&255,Y>>>=8,z[re+1]=Y,ae+8}function ia(z,ae,Y){var Z=ae&7,re=ae>>>3;return Y<<=Z,z[re]|=Y&255,Y>>>=8,z[re+1]=Y&255,z[re+2]=Y>>>8,ae+16}function la(z,ae){var Y=z.length,Z=2*Y>ae?2*Y:ae+5,re=0;if(Y>=ae)return z;if(bt){var se=cN(Z);if(z.copy)z.copy(se);else for(;re<z.length;++re)se[re]=z[re];return se}else if(le){var ve=new Uint8Array(Z);if(ve.set)ve.set(z);else for(;re<Y;++re)ve[re]=z[re];return ve}return z.length=Z,z}function Re(z){for(var ae=new Array(z),Y=0;Y<z;++Y)ae[Y]=0;return ae}function Qe(z,ae,Y){var Z=1,re=0,se=0,ve=0,Ce=0,ye=z.length,be=le?new Uint16Array(32):Re(32);for(se=0;se<32;++se)be[se]=0;for(se=ye;se<Y;++se)z[se]=0;ye=z.length;var Ne=le?new Uint16Array(ye):Re(ye);for(se=0;se<ye;++se)be[re=z[se]]++,Z<re&&(Z=re),Ne[se]=0;for(be[0]=0,se=1;se<=Z;++se)be[se+16]=Ce=Ce+be[se-1]<<1;for(se=0;se<ye;++se)Ce=z[se],Ce!=0&&(Ne[se]=be[Ce+16]++);var Pe=0;for(se=0;se<ye;++se)if(Pe=z[se],Pe!=0)for(Ce=ee(Ne[se],Z)>>Z-Pe,ve=(1<<Z+4-Pe)-1;ve>=0;--ve)ae[Ce|ve<<Pe]=Pe&15|se<<4;return Z}var Et=le?new Uint16Array(512):Re(512),Ht=le?new Uint16Array(32):Re(32);if(!le){for(var Nt=0;Nt<512;++Nt)Et[Nt]=0;for(Nt=0;Nt<32;++Nt)Ht[Nt]=0}(function(){for(var z=[],ae=0;ae<32;ae++)z.push(5);Qe(z,Ht,32);var Y=[];for(ae=0;ae<=143;ae++)Y.push(8);for(;ae<=255;ae++)Y.push(9);for(;ae<=279;ae++)Y.push(7);for(;ae<=287;ae++)Y.push(8);Qe(Y,Et,288)})();var Bn=(function(){for(var ae=le?new Uint8Array(32768):[],Y=0,Z=0;Y<ue.length-1;++Y)for(;Z<ue[Y+1];++Z)ae[Z]=Y;for(;Z<32768;++Z)ae[Z]=29;var re=le?new Uint8Array(259):[];for(Y=0,Z=0;Y<te.length-1;++Y)for(;Z<te[Y+1];++Z)re[Z]=Y;function se(Ce,ye){for(var be=0;be<Ce.length;){var Ne=Math.min(65535,Ce.length-be),Pe=be+Ne==Ce.length;for(ye.write_shift(1,+Pe),ye.write_shift(2,Ne),ye.write_shift(2,~Ne&65535);Ne-- >0;)ye[ye.l++]=Ce[be++]}return ye.l}function ve(Ce,ye){for(var be=0,Ne=0,Pe=le?new Uint16Array(32768):[];Ne<Ce.length;){var ze=Math.min(65535,Ce.length-Ne);if(ze<10){for(be=hn(ye,be,+(Ne+ze==Ce.length)),be&7&&(be+=8-(be&7)),ye.l=be/8|0,ye.write_shift(2,ze),ye.write_shift(2,~ze&65535);ze-- >0;)ye[ye.l++]=Ce[Ne++];be=ye.l*8;continue}be=hn(ye,be,+(Ne+ze==Ce.length)+2);for(var qe=0;ze-- >0;){var Be=Ce[Ne];qe=(qe<<5^Be)&32767;var Me=-1,mt=0;if((Me=Pe[qe])&&(Me|=Ne&-32768,Me>Ne&&(Me-=32768),Me<Ne))for(;Ce[Me+mt]==Ce[Ne+mt]&&mt<250;)++mt;if(mt>2){Be=re[mt],Be<=22?be=Cn(ye,be,q[Be+1]>>1)-1:(Cn(ye,be,3),be+=5,Cn(ye,be,q[Be-23]>>5),be+=3);var Qt=Be<8?0:Be-4>>2;Qt>0&&(ia(ye,be,mt-te[Be]),be+=Qt),Be=ae[Ne-Me],be=Cn(ye,be,q[Be]>>3),be-=3;var tn=Be<4?0:Be-2>>1;tn>0&&(ia(ye,be,Ne-Me-ue[Be]),be+=tn);for(var Sn=0;Sn<mt;++Sn)Pe[qe]=Ne&32767,qe=(qe<<5^Ce[Ne])&32767,++Ne;ze-=mt-1}else Be<=143?Be=Be+48:be=xn(ye,be,1),be=Cn(ye,be,q[Be]),Pe[qe]=Ne&32767,++Ne}be=Cn(ye,be,0)-1}return ye.l=(be+7)/8|0,ye.l}return function(ye,be){return ye.length<8?se(ye,be):ve(ye,be)}})();function ot(z){var ae=Te(50+Math.floor(z.length*1.1)),Y=Bn(z,ae);return ae.slice(0,Y)}var Bt=le?new Uint16Array(32768):Re(32768),Xn=le?new Uint16Array(32768):Re(32768),en=le?new Uint16Array(128):Re(128),Da=1,mi=1;function Ls(z,ae){var Y=Xe(z,ae)+257;ae+=5;var Z=Xe(z,ae)+1;ae+=5;var re=tt(z,ae)+4;ae+=4;for(var se=0,ve=le?new Uint8Array(19):Re(19),Ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ye=1,be=le?new Uint8Array(8):Re(8),Ne=le?new Uint8Array(8):Re(8),Pe=ve.length,ze=0;ze<re;++ze)ve[R[ze]]=se=Ke(z,ae),ye<se&&(ye=se),be[se]++,ae+=3;var qe=0;for(be[0]=0,ze=1;ze<=ye;++ze)Ne[ze]=qe=qe+be[ze-1]<<1;for(ze=0;ze<Pe;++ze)(qe=ve[ze])!=0&&(Ce[ze]=Ne[qe]++);var Be=0;for(ze=0;ze<Pe;++ze)if(Be=ve[ze],Be!=0){qe=q[Ce[ze]]>>8-Be;for(var Me=(1<<7-Be)-1;Me>=0;--Me)en[qe|Me<<Be]=Be&7|ze<<3}var mt=[];for(ye=1;mt.length<Y+Z;)switch(qe=en[Oe(z,ae)],ae+=qe&7,qe>>>=3){case 16:for(se=3+ke(z,ae),ae+=2,qe=mt[mt.length-1];se-- >0;)mt.push(qe);break;case 17:for(se=3+Ke(z,ae),ae+=3;se-- >0;)mt.push(0);break;case 18:for(se=11+Oe(z,ae),ae+=7;se-- >0;)mt.push(0);break;default:mt.push(qe),ye<qe&&(ye=qe);break}var Qt=mt.slice(0,Y),tn=mt.slice(Y);for(ze=Y;ze<286;++ze)Qt[ze]=0;for(ze=Z;ze<30;++ze)tn[ze]=0;return Da=Qe(Qt,Bt,286),mi=Qe(tn,Xn,30),ae}function Ps(z,ae){if(z[0]==3&&!(z[1]&3))return[il(ae),2];for(var Y=0,Z=0,re=cN(ae||1<<18),se=0,ve=re.length>>>0,Ce=0,ye=0;(Z&1)==0;){if(Z=Ke(z,Y),Y+=3,Z>>>1)Z>>1==1?(Ce=9,ye=5):(Y=Ls(z,Y),Ce=Da,ye=mi);else{Y&7&&(Y+=8-(Y&7));var be=z[Y>>>3]|z[(Y>>>3)+1]<<8;if(Y+=32,be>0)for(!ae&&ve<se+be&&(re=la(re,se+be),ve=re.length);be-- >0;)re[se++]=z[Y>>>3],Y+=8;continue}for(;;){!ae&&ve<se+32767&&(re=la(re,se+32767),ve=re.length);var Ne=Rt(z,Y,Ce),Pe=Z>>>1==1?Et[Ne]:Bt[Ne];if(Y+=Pe&15,Pe>>>=4,(Pe>>>8&255)===0)re[se++]=Pe;else{if(Pe==256)break;Pe-=257;var ze=Pe<8?0:Pe-4>>2;ze>5&&(ze=0);var qe=se+te[Pe];ze>0&&(qe+=Rt(z,Y,ze),Y+=ze),Ne=Rt(z,Y,ye),Pe=Z>>>1==1?Ht[Ne]:Xn[Ne],Y+=Pe&15,Pe>>>=4;var Be=Pe<4?0:Pe-2>>1,Me=ue[Pe];for(Be>0&&(Me+=Rt(z,Y,Be),Y+=Be),!ae&&ve<qe&&(re=la(re,qe+100),ve=re.length);se<qe;)re[se]=re[se-Me],++se}}}return ae?[re,Y+7>>>3]:[re.slice(0,se),Y+7>>>3]}function os(z,ae){var Y=z.slice(z.l||0),Z=Ps(Y,ae);return z.l+=Z[1],Z[0]}function fi(z,ae){if(z)typeof console<"u"&&console.error(ae);else throw new Error(ae)}function ko(z,ae){var Y=z;ha(Y,0);var Z=[],re=[],se={FileIndex:Z,FullPaths:re};S(se,{root:ae.root});for(var ve=Y.length-4;(Y[ve]!=80||Y[ve+1]!=75||Y[ve+2]!=5||Y[ve+3]!=6)&&ve>=0;)--ve;Y.l=ve+4,Y.l+=4;var Ce=Y.read_shift(2);Y.l+=6;var ye=Y.read_shift(4);for(Y.l=ye,ve=0;ve<Ce;++ve){Y.l+=20;var be=Y.read_shift(4),Ne=Y.read_shift(4),Pe=Y.read_shift(2),ze=Y.read_shift(2),qe=Y.read_shift(2);Y.l+=8;var Be=Y.read_shift(4),Me=d(Y.slice(Y.l+Pe,Y.l+Pe+ze));Y.l+=Pe+ze+qe;var mt=Y.l;Y.l=Be+4,pi(Y,be,Ne,se,Me),Y.l=mt}return se}function pi(z,ae,Y,Z,re){z.l+=2;var se=z.read_shift(2),ve=z.read_shift(2),Ce=o(z);if(se&8257)throw new Error("Unsupported ZIP encryption");for(var ye=z.read_shift(4),be=z.read_shift(4),Ne=z.read_shift(4),Pe=z.read_shift(2),ze=z.read_shift(2),qe="",Be=0;Be<Pe;++Be)qe+=String.fromCharCode(z[z.l++]);if(ze){var Me=d(z.slice(z.l,z.l+ze));(Me[21589]||{}).mt&&(Ce=Me[21589].mt),((re||{})[21589]||{}).mt&&(Ce=re[21589].mt)}z.l+=ze;var mt=z.slice(z.l,z.l+be);switch(ve){case 8:mt=Q(z,Ne);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ve)}var Qt=!1;se&8&&(ye=z.read_shift(4),ye==134695760&&(ye=z.read_shift(4),Qt=!0),be=z.read_shift(4),Ne=z.read_shift(4)),be!=ae&&fi(Qt,"Bad compressed size: "+ae+" != "+be),Ne!=Y&&fi(Qt,"Bad uncompressed size: "+Y+" != "+Ne),Is(Z,qe,mt,{unsafe:!0,mt:Ce})}function gi(z,ae){var Y=ae||{},Z=[],re=[],se=Te(1),ve=Y.compression?8:0,Ce=0,ye=0,be=0,Ne=0,Pe=0,ze=z.FullPaths[0],qe=ze,Be=z.FileIndex[0],Me=[],mt=0;for(ye=1;ye<z.FullPaths.length;++ye)if(qe=z.FullPaths[ye].slice(ze.length),Be=z.FileIndex[ye],!(!Be.size||!Be.content||qe=="Sh33tJ5")){var Qt=Ne,tn=Te(qe.length);for(be=0;be<qe.length;++be)tn.write_shift(1,qe.charCodeAt(be)&127);tn=tn.slice(0,tn.l),Me[Pe]=MF.buf(Be.content,0);var Sn=Be.content;ve==8&&(Sn=I(Sn)),se=Te(30),se.write_shift(4,67324752),se.write_shift(2,20),se.write_shift(2,Ce),se.write_shift(2,ve),Be.mt?l(se,Be.mt):se.write_shift(4,0),se.write_shift(-4,Me[Pe]),se.write_shift(4,Sn.length),se.write_shift(4,Be.content.length),se.write_shift(2,tn.length),se.write_shift(2,0),Ne+=se.length,Z.push(se),Ne+=tn.length,Z.push(tn),Ne+=Sn.length,Z.push(Sn),se=Te(46),se.write_shift(4,33639248),se.write_shift(2,0),se.write_shift(2,20),se.write_shift(2,Ce),se.write_shift(2,ve),se.write_shift(4,0),se.write_shift(-4,Me[Pe]),se.write_shift(4,Sn.length),se.write_shift(4,Be.content.length),se.write_shift(2,tn.length),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(4,0),se.write_shift(4,Qt),mt+=se.l,re.push(se),mt+=tn.length,re.push(tn),++Pe}return se=Te(22),se.write_shift(4,101010256),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,Pe),se.write_shift(2,Pe),se.write_shift(4,mt),se.write_shift(4,Ne),se.write_shift(2,0),aa([aa(Z),aa(re),se])}var fl={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Pu(z,ae){if(z.ctype)return z.ctype;var Y=z.name||"",Z=Y.match(/\.([^\.]+)$/);return Z&&fl[Z[1]]||ae&&(Z=(Y=ae).match(/[\.\\]([^\.\\])+$/),Z&&fl[Z[1]])?fl[Z[1]]:"application/octet-stream"}function Iu(z){for(var ae=Zd(z),Y=[],Z=0;Z<ae.length;Z+=76)Y.push(ae.slice(Z,Z+76));return Y.join(`\r
`)+`\r
`}function Ou(z){var ae=z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(be){var Ne=be.charCodeAt(0).toString(16).toUpperCase();return"="+(Ne.length==1?"0"+Ne:Ne)});ae=ae.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ae.charAt(0)==`
`&&(ae="=0D"+ae.slice(1)),ae=ae.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Y=[],Z=ae.split(`\r
`),re=0;re<Z.length;++re){var se=Z[re];if(se.length==0){Y.push("");continue}for(var ve=0;ve<se.length;){var Ce=76,ye=se.slice(ve,ve+Ce);ye.charAt(Ce-1)=="="?Ce--:ye.charAt(Ce-2)=="="?Ce-=2:ye.charAt(Ce-3)=="="&&(Ce-=3),ye=se.slice(ve,ve+Ce),ve+=Ce,ve<se.length&&(ye+="="),Y.push(ye)}}return Y.join(`\r
`)}function Mu(z){for(var ae=[],Y=0;Y<z.length;++Y){for(var Z=z[Y];Y<=z.length&&Z.charAt(Z.length-1)=="=";)Z=Z.slice(0,Z.length-1)+z[++Y];ae.push(Z)}for(var re=0;re<ae.length;++re)ae[re]=ae[re].replace(/[=][0-9A-Fa-f]{2}/g,function(se){return String.fromCharCode(parseInt(se.slice(1),16))});return xr(ae.join(`\r
`))}function Hc(z,ae,Y){for(var Z="",re="",se="",ve,Ce=0;Ce<10;++Ce){var ye=ae[Ce];if(!ye||ye.match(/^\s*$/))break;var be=ye.match(/^(.*?):\s*([^\s].*)$/);if(be)switch(be[1].toLowerCase()){case"content-location":Z=be[2].trim();break;case"content-type":se=be[2].trim();break;case"content-transfer-encoding":re=be[2].trim();break}}switch(++Ce,re.toLowerCase()){case"base64":ve=xr(vr(ae.slice(Ce).join("")));break;case"quoted-printable":ve=Mu(ae.slice(Ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+re)}var Ne=Is(z,Z.slice(Y.length),ve,{unsafe:!0});se&&(Ne.ctype=se)}function Ru(z,ae){if(W(z.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Y=ae&&ae.root||"",Z=(bt&&Buffer.isBuffer(z)?z.toString("binary"):W(z)).split(`\r
`),re=0,se="";for(re=0;re<Z.length;++re)if(se=Z[re],!!/^Content-Location:/i.test(se)&&(se=se.slice(se.indexOf("file")),Y||(Y=se.slice(0,se.lastIndexOf("/")+1)),se.slice(0,Y.length)!=Y))for(;Y.length>0&&(Y=Y.slice(0,Y.length-1),Y=Y.slice(0,Y.lastIndexOf("/")+1),se.slice(0,Y.length)!=Y););var ve=(Z[1]||"").match(/boundary="(.*?)"/);if(!ve)throw new Error("MAD cannot find boundary");var Ce="--"+(ve[1]||""),ye=[],be=[],Ne={FileIndex:ye,FullPaths:be};S(Ne);var Pe,ze=0;for(re=0;re<Z.length;++re){var qe=Z[re];qe!==Ce&&qe!==Ce+"--"||(ze++&&Hc(Ne,Z.slice(Pe,re),Y),Pe=re)}return Ne}function pl(z,ae){var Y=ae||{},Z=Y.boundary||"SheetJS";Z="------="+Z;for(var re=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Z.slice(2)+'"',"","",""],se=z.FullPaths[0],ve=se,Ce=z.FileIndex[0],ye=1;ye<z.FullPaths.length;++ye)if(ve=z.FullPaths[ye].slice(se.length),Ce=z.FileIndex[ye],!(!Ce.size||!Ce.content||ve=="Sh33tJ5")){ve=ve.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(mt){return"_x"+mt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(mt){return"_u"+mt.charCodeAt(0).toString(16)+"_"});for(var be=Ce.content,Ne=bt&&Buffer.isBuffer(be)?be.toString("binary"):W(be),Pe=0,ze=Math.min(1024,Ne.length),qe=0,Be=0;Be<=ze;++Be)(qe=Ne.charCodeAt(Be))>=32&&qe<128&&++Pe;var Me=Pe>=ze*4/5;re.push(Z),re.push("Content-Location: "+(Y.root||"file:///C:/SheetJS/")+ve),re.push("Content-Transfer-Encoding: "+(Me?"quoted-printable":"base64")),re.push("Content-Type: "+Pu(Ce,ve)),re.push(""),re.push(Me?Ou(Ne):Iu(Ne))}return re.push(Z+`--\r
`),re.join(`\r
`)}function Vc(z){var ae={};return S(ae,z),ae}function Is(z,ae,Y,Z){var re=Z&&Z.unsafe;re||S(z);var se=!re&&rt.find(z,ae);if(!se){var ve=z.FullPaths[0];ae.slice(0,ve.length)==ve?ve=ae:(ve.slice(-1)!="/"&&(ve+="/"),ve=(ve+ae).replace("//","/")),se={name:s(ae),type:2},z.FileIndex.push(se),z.FullPaths.push(ve),re||rt.utils.cfb_gc(z)}return se.content=Y,se.size=Y?Y.length:0,Z&&(Z.CLSID&&(se.clsid=Z.CLSID),Z.mt&&(se.mt=Z.mt),Z.ct&&(se.ct=Z.ct)),se}function gx(z,ae){S(z);var Y=rt.find(z,ae);if(Y){for(var Z=0;Z<z.FileIndex.length;++Z)if(z.FileIndex[Z]==Y)return z.FileIndex.splice(Z,1),z.FullPaths.splice(Z,1),!0}return!1}function gl(z,ae,Y){S(z);var Z=rt.find(z,ae);if(Z){for(var re=0;re<z.FileIndex.length;++re)if(z.FileIndex[re]==Z)return z.FileIndex[re].name=s(Y),z.FullPaths[re]=Y,!0}return!1}function To(z){F(z,!0)}return n.find=O,n.read=C,n.parse=m,n.write=xe,n.writeFile=H,n.utils={cfb_new:Vc,cfb_add:Is,cfb_del:gx,cfb_mov:gl,cfb_gc:To,ReadShift:Bd,CheckField:sk,prep_blob:ha,bconcat:aa,use_zlib:L,_deflateRaw:ot,_inflateRaw:os,consts:ne},n})();function RF(e){return typeof e=="string"?ox(e):Array.isArray(e)?dF(e):e}function Cu(e,n,a){if(typeof Deno<"u"){if(a&&typeof n=="string")switch(a){case"utf8":n=new TextEncoder(a).encode(n);break;case"binary":n=ox(n);break;default:throw new Error("Unsupported encoding "+a)}return Deno.writeFileSync(e,n)}var r=a=="utf8"?Ts(n):n;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,e);if(typeof Blob<"u"){var s=new Blob([RF(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=l,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var d=File(e);return d.open("w"),d.encoding="binary",Array.isArray(n)&&(n=hl(n)),d.write(n),d.close(),n}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+e)}function BF(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(e);n.open("r"),n.encoding="binary";var a=n.read();return n.close(),a}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function Tn(e){for(var n=Object.keys(e),a=[],r=0;r<n.length;++r)Object.prototype.hasOwnProperty.call(e,n[r])&&a.push(n[r]);return a}function gN(e,n){for(var a=[],r=Tn(e),s=0;s!==r.length;++s)a[e[r[s]][n]]==null&&(a[e[r[s]][n]]=r[s]);return a}function dx(e){for(var n=[],a=Tn(e),r=0;r!==a.length;++r)n[e[a[r]]]=a[r];return n}function ux(e){for(var n=[],a=Tn(e),r=0;r!==a.length;++r)n[e[a[r]]]=parseInt(a[r],10);return n}function HF(e){for(var n=[],a=Tn(e),r=0;r!==a.length;++r)n[e[a[r]]]==null&&(n[e[a[r]]]=[]),n[e[a[r]]].push(a[r]);return n}var L0=new Date(1899,11,30,0,0,0);function Wn(e,n){var a=e.getTime(),r=L0.getTime()+(e.getTimezoneOffset()-L0.getTimezoneOffset())*6e4;return(a-r)/(1440*60*1e3)}var Rw=new Date,VF=L0.getTime()+(Rw.getTimezoneOffset()-L0.getTimezoneOffset())*6e4,yN=Rw.getTimezoneOffset();function hx(e){var n=new Date;return n.setTime(e*24*60*60*1e3+VF),n.getTimezoneOffset()!==yN&&n.setTime(n.getTime()+(n.getTimezoneOffset()-yN)*6e4),n}function UF(e){var n=0,a=0,r=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=s.length;++l)if(s[l]){switch(a=1,l>3&&(r=!0),s[l].slice(s[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[l].slice(s[l].length-1));case"D":a*=24;case"H":a*=60;case"M":if(r)a*=60;else throw new Error("Unsupported ISO Duration Field: M")}n+=a*parseInt(s[l],10)}return n}var vN=new Date("2017-02-19T19:06:09.000Z"),Bw=isNaN(vN.getFullYear())?new Date("2/19/17"):vN,KF=Bw.getFullYear()==2017;function dn(e,n){var a=new Date(e);if(KF)return n>0?a.setTime(a.getTime()+a.getTimezoneOffset()*60*1e3):n<0&&a.setTime(a.getTime()-a.getTimezoneOffset()*60*1e3),a;if(e instanceof Date)return e;if(Bw.getFullYear()==1917&&!isNaN(a.getFullYear())){var r=a.getFullYear();return e.indexOf(""+r)>-1||a.setFullYear(a.getFullYear()+100),a}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function oo(e,n){if(bt&&Buffer.isBuffer(e)){if(n){if(e[0]==255&&e[1]==254)return Ts(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ts(Cw(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(e[0]==255&&e[1]==254)return Ts(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ts(new TextDecoder("utf-16be").decode(e.slice(2)))}var a={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return a[l]||l})}catch{}for(var r=[],s=0;s!=e.length;++s)r.push(String.fromCharCode(e[s]));return r.join("")}function un(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=un(e[a]));return n}function jn(e,n){for(var a="";a.length<n;)a+=e;return a}function rs(e){var n=Number(e);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(e))return n;var a=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return a*=100,""});return!isNaN(n=Number(r))||(r=r.replace(/[(](.*)[)]/,function(s,l){return a=-a,l}),!isNaN(n=Number(r)))?n/a:n}var zF=["january","february","march","april","may","june","july","august","september","october","november","december"];function Sc(e){var n=new Date(e),a=new Date(NaN),r=n.getYear(),s=n.getMonth(),l=n.getDate();if(isNaN(l))return a;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&zF.indexOf(o)==-1)return a}else if(o.match(/[a-z]/))return a;return r<0||r>8099?a:(s>0||l>1)&&r!=101?n:e.match(/[^-0-9:,\/\\]/)?a:n}var $F=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(a,r,s){if(e||typeof r=="string")return a.split(r);for(var l=a.split(r),o=[l[0]],d=1;d<l.length;++d)o.push(s),o.push(l[d]);return o}})();function Hw(e){return e?e.content&&e.type?oo(e.content,!0):e.data?Ld(e.data):e.asNodeBuffer&&bt?Ld(e.asNodeBuffer().toString("binary")):e.asBinary?Ld(e.asBinary()):e._data&&e._data.getContent?Ld(oo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Vw(e){if(!e)return null;if(e.data)return lN(e.data);if(e.asNodeBuffer&&bt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var n=e._data.getContent();return typeof n=="string"?lN(n):Array.prototype.slice.call(n)}return e.content&&e.type?e.content:null}function GF(e){return e&&e.name.slice(-4)===".bin"?Vw(e):Hw(e)}function Fr(e,n){for(var a=e.FullPaths||Tn(e.files),r=n.toLowerCase().replace(/[\/]/g,"\\"),s=r.replace(/\\/g,"/"),l=0;l<a.length;++l){var o=a[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==o||s==o)return e.files?e.files[a[l]]:e.FileIndex[l]}return null}function Cg(e,n){var a=Fr(e,n);if(a==null)throw new Error("Cannot find file "+n+" in zip");return a}function Mn(e,n,a){if(!a)return GF(Cg(e,n));if(!n)return null;try{return Mn(e,n)}catch{return null}}function mr(e,n,a){if(!a)return Hw(Cg(e,n));if(!n)return null;try{return mr(e,n)}catch{return null}}function qF(e,n,a){return Vw(Cg(e,n))}function bN(e){for(var n=e.FullPaths||Tn(e.files),a=[],r=0;r<n.length;++r)n[r].slice(-1)!="/"&&a.push(n[r].replace(/^Root Entry[\/]/,""));return a.sort()}function yt(e,n,a){if(e.FullPaths){if(typeof a=="string"){var r;return bt?r=ui(a):r=uF(a),rt.utils.cfb_add(e,n,r)}rt.utils.cfb_add(e,n,a)}else e.file(n,a)}function Sg(){return rt.utils.cfb_new()}function Uw(e,n){switch(n.type){case"base64":return rt.read(e,{type:"base64"});case"binary":return rt.read(e,{type:"binary"});case"buffer":case"array":return rt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function Id(e,n){if(e.charAt(0)=="/")return e.slice(1);var a=n.split("/");n.slice(-1)!="/"&&a.pop();for(var r=e.split("/");r.length!==0;){var s=r.shift();s===".."?a.pop():s!=="."&&a.push(s)}return a.join("/")}var Pn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,WF=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,NN=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,XF=/<[^>]*>/g,Ea=Pn.match(NN)?NN:XF,QF=/<\w*:/,YF=/<(\/?)\w+:/;function ut(e,n,a){for(var r={},s=0,l=0;s!==e.length&&!((l=e.charCodeAt(s))===32||l===10||l===13);++s);if(n||(r[0]=e.slice(0,s)),s===e.length)return r;var o=e.match(WF),d=0,u="",x=0,m="",f="",p=1;if(o)for(x=0;x!=o.length;++x){for(f=o[x],l=0;l!=f.length&&f.charCodeAt(l)!==61;++l);for(m=f.slice(0,l).trim();f.charCodeAt(l+1)==32;)++l;for(p=(s=f.charCodeAt(l+1))==34||s==39?1:0,u=f.slice(l+1+p,f.length-p),d=0;d!=m.length&&m.charCodeAt(d)!==58;++d);if(d===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),r[m]=u,r[m.toLowerCase()]=u;else{var N=(d===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(d+1);if(r[N]&&m.slice(d-3,d)=="ext")continue;r[N]=u,r[N.toLowerCase()]=u}}return r}function As(e){return e.replace(YF,"<$1")}var Kw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},_g=dx(Kw),Lt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function a(r){var s=r+"",l=s.indexOf("<![CDATA[");if(l==-1)return s.replace(e,function(d,u){return Kw[d]||String.fromCharCode(parseInt(u,d.indexOf("x")>-1?16:10))||d}).replace(n,function(d,u){return String.fromCharCode(parseInt(u,16))});var o=s.indexOf("]]>");return a(s.slice(0,l))+s.slice(l+9,o)+a(s.slice(o+3))}})(),Eg=/[&<>'"]/g,JF=/[\u0000-\u0008\u000b-\u001f]/g;function qt(e){var n=e+"";return n.replace(Eg,function(a){return _g[a]}).replace(JF,function(a){return"_x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+"_"})}function jN(e){return qt(e).replace(/ /g,"_x0020_")}var zw=/[\u0000-\u001f]/g;function Dg(e){var n=e+"";return n.replace(Eg,function(a){return _g[a]}).replace(/\n/g,"<br/>").replace(zw,function(a){return"&#x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+";"})}function ZF(e){var n=e+"";return n.replace(Eg,function(a){return _g[a]}).replace(zw,function(a){return"&#x"+a.charCodeAt(0).toString(16).toUpperCase()+";"})}var wN=(function(){var e=/&#(\d+);/g;function n(a,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,n)}})();function e8(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function on(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ef(e){for(var n="",a=0,r=0,s=0,l=0,o=0,d=0;a<e.length;){if(r=e.charCodeAt(a++),r<128){n+=String.fromCharCode(r);continue}if(s=e.charCodeAt(a++),r>191&&r<224){o=(r&31)<<6,o|=s&63,n+=String.fromCharCode(o);continue}if(l=e.charCodeAt(a++),r<240){n+=String.fromCharCode((r&15)<<12|(s&63)<<6|l&63);continue}o=e.charCodeAt(a++),d=((r&7)<<18|(s&63)<<12|(l&63)<<6|o&63)-65536,n+=String.fromCharCode(55296+(d>>>10&1023)),n+=String.fromCharCode(56320+(d&1023))}return n}function kN(e){var n=il(2*e.length),a,r,s=1,l=0,o=0,d;for(r=0;r<e.length;r+=s)s=1,(d=e.charCodeAt(r))<128?a=d:d<224?(a=(d&31)*64+(e.charCodeAt(r+1)&63),s=2):d<240?(a=(d&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),s=3):(s=4,a=(d&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),a-=65536,o=55296+(a>>>10&1023),a=56320+(a&1023)),o!==0&&(n[l++]=o&255,n[l++]=o>>>8,o=0),n[l++]=a%256,n[l++]=a>>>8;return n.slice(0,l).toString("ucs2")}function TN(e){return ui(e,"binary").toString("utf8")}var Jh="foo bar baz",Xt=bt&&(TN(Jh)==Ef(Jh)&&TN||kN(Jh)==Ef(Jh)&&kN)||Ef,Ts=bt?function(e){return ui(e,"utf8").toString("binary")}:function(e){for(var n=[],a=0,r=0,s=0;a<e.length;)switch(r=e.charCodeAt(a++),!0){case r<128:n.push(String.fromCharCode(r));break;case r<2048:n.push(String.fromCharCode(192+(r>>6))),n.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,s=e.charCodeAt(a++)-56320+(r<<10),n.push(String.fromCharCode(240+(s>>18&7))),n.push(String.fromCharCode(144+(s>>12&63))),n.push(String.fromCharCode(128+(s>>6&63))),n.push(String.fromCharCode(128+(s&63)));break;default:n.push(String.fromCharCode(224+(r>>12))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(r&63)))}return n.join("")},tu=(function(){var e={};return function(a,r){var s=a+"|"+(r||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+a+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+a+">",r||"")}})(),$w=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(a){for(var r=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)r=r.replace(e[s][0],e[s][1]);return r}})(),t8=(function(){var e={};return function(a){return e[a]!==void 0?e[a]:e[a]=new RegExp("<(?:vt:)?"+a+">([\\s\\S]*?)</(?:vt:)?"+a+">","g")}})(),n8=/<\/?(?:vt:)?variant>/g,a8=/<(?:vt:)([^>]*)>([\s\S]*)</;function CN(e,n){var a=ut(e),r=e.match(t8(a.baseType))||[],s=[];if(r.length!=a.size){if(n.WTF)throw new Error("unexpected vector length "+r.length+" != "+a.size);return s}return r.forEach(function(l){var o=l.replace(n8,"").match(a8);o&&s.push({v:Xt(o[2]),t:o[1]})}),s}var Gw=/(^\s|\s$|\n)/;function fa(e,n){return"<"+e+(n.match(Gw)?' xml:space="preserve"':"")+">"+n+"</"+e+">"}function nu(e){return Tn(e).map(function(n){return" "+n+'="'+e[n]+'"'}).join("")}function Ve(e,n,a){return"<"+e+(a!=null?nu(a):"")+(n!=null?(n.match(Gw)?' xml:space="preserve"':"")+">"+n+"</"+e:"/")+">"}function Ep(e,n){try{return e.toISOString().replace(/\.\d*/,"")}catch(a){if(n)throw a}return""}function r8(e,n){switch(typeof e){case"string":var a=Ve("vt:lpwstr",qt(e));return a=a.replace(/&quot;/g,"_x0022_"),a;case"number":return Ve((e|0)==e?"vt:i4":"vt:r8",qt(String(e)));case"boolean":return Ve("vt:bool",e?"true":"false")}if(e instanceof Date)return Ve("vt:filetime",Ep(e));throw new Error("Unable to serialize "+e)}function Ag(e){if(bt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Xt(hl(wg(e)));throw new Error("Bad input format: expected Buffer or string")}var au=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,$n={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},po=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ur={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function s8(e,n){for(var a=1-2*(e[n+7]>>>7),r=((e[n+7]&127)<<4)+(e[n+6]>>>4&15),s=e[n+6]&15,l=5;l>=0;--l)s=s*256+e[n+l];return r==2047?s==0?a*(1/0):NaN:(r==0?r=-1022:(r-=1023,s+=Math.pow(2,52)),a*Math.pow(2,r-52)*s)}function i8(e,n,a){var r=(n<0||1/n==-1/0?1:0)<<7,s=0,l=0,o=r?-n:n;isFinite(o)?o==0?s=l=0:(s=Math.floor(Math.log(o)/Math.LN2),l=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?s=-1022:(l-=Math.pow(2,52),s+=1023)):(s=2047,l=isNaN(n)?26985:0);for(var d=0;d<=5;++d,l/=256)e[a+d]=l&255;e[a+6]=(s&15)<<4|l&15,e[a+7]=s>>4|r}var SN=function(e){for(var n=[],a=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var s=0,l=e[0][r].length;s<l;s+=a)n.push.apply(n,e[0][r].slice(s,s+a));return n},_N=bt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(n){return Buffer.isBuffer(n)?n:ui(n)})):SN(e)}:SN,EN=function(e,n,a){for(var r=[],s=n;s<a;s+=2)r.push(String.fromCharCode(Zs(e,s)));return r.join("").replace(Ha,"")},Fg=bt?function(e,n,a){return Buffer.isBuffer(e)?e.toString("utf16le",n,a).replace(Ha,""):EN(e,n,a)}:EN,DN=function(e,n,a){for(var r=[],s=n;s<n+a;++s)r.push(("0"+e[s].toString(16)).slice(-2));return r.join("")},qw=bt?function(e,n,a){return Buffer.isBuffer(e)?e.toString("hex",n,n+a):DN(e,n,a)}:DN,AN=function(e,n,a){for(var r=[],s=n;s<a;s++)r.push(String.fromCharCode(nc(e,s)));return r.join("")},Su=bt?function(n,a,r){return Buffer.isBuffer(n)?n.toString("utf8",a,r):AN(n,a,r)}:AN,Ww=function(e,n){var a=hr(e,n);return a>0?Su(e,n+4,n+4+a-1):""},Xw=Ww,Qw=function(e,n){var a=hr(e,n);return a>0?Su(e,n+4,n+4+a-1):""},Yw=Qw,Jw=function(e,n){var a=2*hr(e,n);return a>0?Su(e,n+4,n+4+a-1):""},Zw=Jw,ek=function(n,a){var r=hr(n,a);return r>0?Fg(n,a+4,a+4+r):""},tk=ek,nk=function(e,n){var a=hr(e,n);return a>0?Su(e,n+4,n+4+a):""},ak=nk,rk=function(e,n){return s8(e,n)},P0=rk,Lg=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};bt&&(Xw=function(n,a){if(!Buffer.isBuffer(n))return Ww(n,a);var r=n.readUInt32LE(a);return r>0?n.toString("utf8",a+4,a+4+r-1):""},Yw=function(n,a){if(!Buffer.isBuffer(n))return Qw(n,a);var r=n.readUInt32LE(a);return r>0?n.toString("utf8",a+4,a+4+r-1):""},Zw=function(n,a){if(!Buffer.isBuffer(n))return Jw(n,a);var r=2*n.readUInt32LE(a);return n.toString("utf16le",a+4,a+4+r-1)},tk=function(n,a){if(!Buffer.isBuffer(n))return ek(n,a);var r=n.readUInt32LE(a);return n.toString("utf16le",a+4,a+4+r)},ak=function(n,a){if(!Buffer.isBuffer(n))return nk(n,a);var r=n.readUInt32LE(a);return n.toString("utf8",a+4,a+4+r)},P0=function(n,a){return Buffer.isBuffer(n)?n.readDoubleLE(a):rk(n,a)},Lg=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var nc=function(e,n){return e[n]},Zs=function(e,n){return e[n+1]*256+e[n]},l8=function(e,n){var a=e[n+1]*256+e[n];return a<32768?a:(65535-a+1)*-1},hr=function(e,n){return e[n+3]*(1<<24)+(e[n+2]<<16)+(e[n+1]<<8)+e[n]},Rl=function(e,n){return e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]},o8=function(e,n){return e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]};function Bd(e,n){var a="",r,s,l=[],o,d,u,x;switch(n){case"dbcs":if(x=this.l,bt&&Buffer.isBuffer(this))a=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)a+=String.fromCharCode(Zs(this,x)),x+=2;e*=2;break;case"utf8":a=Su(this,this.l,this.l+e);break;case"utf16le":e*=2,a=Fg(this,this.l,this.l+e);break;case"wstr":return Bd.call(this,e,"dbcs");case"lpstr-ansi":a=Xw(this,this.l),e=4+hr(this,this.l);break;case"lpstr-cp":a=Yw(this,this.l),e=4+hr(this,this.l);break;case"lpwstr":a=Zw(this,this.l),e=4+2*hr(this,this.l);break;case"lpp4":e=4+hr(this,this.l),a=tk(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+hr(this,this.l),a=ak(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,a="";(o=nc(this,this.l+e++))!==0;)l.push(Yh(o));a=l.join("");break;case"_wstr":for(e=0,a="";(o=Zs(this,this.l+e))!==0;)l.push(Yh(o)),e+=2;e+=2,a=l.join("");break;case"dbcs-cont":for(a="",x=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(x)!==-1)return o=nc(this,x),this.l=x+1,d=Bd.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),l.join("")+d;l.push(Yh(Zs(this,x))),x+=2}a=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(a="",x=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(x)!==-1)return o=nc(this,x),this.l=x+1,d=Bd.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),l.join("")+d;l.push(Yh(nc(this,x))),x+=1}a=l.join("");break;default:switch(e){case 1:return r=nc(this,this.l),this.l++,r;case 2:return r=(n==="i"?l8:Zs)(this,this.l),this.l+=2,r;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(r=(e>0?Rl:o8)(this,this.l),this.l+=4,r):(s=hr(this,this.l),this.l+=4,s);case 8:case-8:if(n==="f")return e==8?s=P0(this,this.l):s=P0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:a=qw(this,this.l,e);break}}return this.l+=e,a}var c8=function(e,n,a){e[a]=n&255,e[a+1]=n>>>8&255,e[a+2]=n>>>16&255,e[a+3]=n>>>24&255},d8=function(e,n,a){e[a]=n&255,e[a+1]=n>>8&255,e[a+2]=n>>16&255,e[a+3]=n>>24&255},u8=function(e,n,a){e[a]=n&255,e[a+1]=n>>>8&255};function h8(e,n,a){var r=0,s=0;if(a==="dbcs"){for(s=0;s!=n.length;++s)u8(this,n.charCodeAt(s),this.l+2*s);r=2*n.length}else if(a==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=n.length;++s)this[this.l+s]=n.charCodeAt(s)&255;r=n.length}else if(a==="hex"){for(;s<e;++s)this[this.l++]=parseInt(n.slice(2*s,2*s+2),16)||0;return this}else if(a==="utf16le"){var l=Math.min(this.l+e,this.length);for(s=0;s<Math.min(n.length,e);++s){var o=n.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=n&255;break;case 2:r=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:r=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:r=4,c8(this,n,this.l);break;case 8:if(r=8,a==="f"){i8(this,n,this.l);break}case 16:break;case-4:r=4,d8(this,n,this.l);break}return this.l+=r,this}function sk(e,n){var a=qw(this,this.l,e.length>>1);if(a!==e)throw new Error(n+"Expected "+e+" saw "+a);this.l+=e.length>>1}function ha(e,n){e.l=n,e.read_shift=Bd,e.chk=sk,e.write_shift=h8}function _a(e,n){e.l+=n}function Te(e){var n=il(e);return ha(n,0),n}function hi(e,n,a){if(e){var r,s,l;ha(e,e.l||0);for(var o=e.length,d=0,u=0;e.l<o;){d=e.read_shift(1),d&128&&(d=(d&127)+((e.read_shift(1)&127)<<7));var x=cu[d]||cu[65535];for(r=e.read_shift(1),l=r&127,s=1;s<4&&r&128;++s)l+=((r=e.read_shift(1))&127)<<7*s;u=e.l+l;var m=x.f&&x.f(e,l,a);if(e.l=u,n(m,x,d))return}}}function rr(){var e=[],n=bt?256:2048,a=function(x){var m=Te(x);return ha(m,0),m},r=a(n),s=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},l=function(x){return r&&x<r.length-r.l?r:(s(),r=a(Math.max(x+1,n)))},o=function(){return s(),aa(e)},d=function(x){s(),r=x,r.l==null&&(r.l=r.length),l(n)};return{next:l,push:d,end:o,_bufs:e}}function _e(e,n,a,r){var s=+n,l;if(!isNaN(s)){r||(r=cu[s].p||(a||[]).length||0),l=1+(s>=128?1:0)+1,r>=128&&++l,r>=16384&&++l,r>=2097152&&++l;var o=e.next(l);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var d=0;d!=4;++d)if(r>=128)o.write_shift(1,(r&127)+128),r>>=7;else{o.write_shift(1,r);break}r>0&&Lg(a)&&e.push(a)}}function Hd(e,n,a){var r=un(e);if(n.s?(r.cRel&&(r.c+=n.s.c),r.rRel&&(r.r+=n.s.r)):(r.cRel&&(r.c+=n.c),r.rRel&&(r.r+=n.r)),!a||a.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function FN(e,n,a){var r=un(e);return r.s=Hd(r.s,n.s,a),r.e=Hd(r.e,n.s,a),r}function Vd(e,n){if(e.cRel&&e.c<0)for(e=un(e);e.c<0;)e.c+=n>8?16384:256;if(e.rRel&&e.r<0)for(e=un(e);e.r<0;)e.r+=n>8?1048576:n>5?65536:16384;var a=dt(e);return!e.cRel&&e.cRel!=null&&(a=f8(a)),!e.rRel&&e.rRel!=null&&(a=x8(a)),a}function Df(e,n){return e.s.r==0&&!e.s.rRel&&e.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+yn(e.s.c)+":"+(e.e.cRel?"":"$")+yn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(n.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ln(e.s.r)+":"+(e.e.rRel?"":"$")+Ln(e.e.r):Vd(e.s,n.biff)+":"+Vd(e.e,n.biff)}function Pg(e){return parseInt(m8(e),10)-1}function Ln(e){return""+(e+1)}function x8(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function m8(e){return e.replace(/\$(\d+)$/,"$1")}function Ig(e){for(var n=p8(e),a=0,r=0;r!==n.length;++r)a=26*a+n.charCodeAt(r)-64;return a-1}function yn(e){if(e<0)throw new Error("invalid column "+e);var n="";for(++e;e;e=Math.floor((e-1)/26))n=String.fromCharCode((e-1)%26+65)+n;return n}function f8(e){return e.replace(/^([A-Z])/,"$$$1")}function p8(e){return e.replace(/^\$([A-Z])/,"$1")}function g8(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function vn(e){for(var n=0,a=0,r=0;r<e.length;++r){var s=e.charCodeAt(r);s>=48&&s<=57?n=10*n+(s-48):s>=65&&s<=90&&(a=26*a+(s-64))}return{c:a-1,r:n-1}}function dt(e){for(var n=e.c+1,a="";n;n=(n-1)/26|0)a=String.fromCharCode((n-1)%26+65)+a;return a+(e.r+1)}function sr(e){var n=e.indexOf(":");return n==-1?{s:vn(e),e:vn(e)}:{s:vn(e.slice(0,n)),e:vn(e.slice(n+1))}}function gt(e,n){return typeof n>"u"||typeof n=="number"?gt(e.s,e.e):(typeof e!="string"&&(e=dt(e)),typeof n!="string"&&(n=dt(n)),e==n?e:e+":"+n)}function Pt(e){var n={s:{c:0,r:0},e:{c:0,r:0}},a=0,r=0,s=0,l=e.length;for(a=0;r<l&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)a=26*a+s;for(n.s.c=--a,a=0;r<l&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)a=10*a+s;if(n.s.r=--a,r===l||s!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++r,a=0;r!=l&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)a=26*a+s;for(n.e.c=--a,a=0;r!=l&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)a=10*a+s;return n.e.r=--a,n}function LN(e,n){var a=e.t=="d"&&n instanceof Date;if(e.z!=null)try{return e.w=Hr(e.z,a?Wn(n):n)}catch{}try{return e.w=Hr((e.XF||{}).numFmtId||(a?14:0),a?Wn(n):n)}catch{return""+n}}function ci(e,n,a){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&a&&a.dateNF&&(e.z=a.dateNF),e.t=="e"?xi[e.v]||e.v:n==null?LN(e,e.v):LN(e,n))}function xl(e,n){var a=n&&n.sheet?n.sheet:"Sheet1",r={};return r[a]=e,{SheetNames:[a],Sheets:r}}function ik(e,n,a){var r=a||{},s=e?Array.isArray(e):r.dense,l=e||(s?[]:{}),o=0,d=0;if(l&&r.origin!=null){if(typeof r.origin=="number")o=r.origin;else{var u=typeof r.origin=="string"?vn(r.origin):r.origin;o=u.r,d=u.c}l["!ref"]||(l["!ref"]="A1:A1")}var x={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var m=Pt(l["!ref"]);x.s.c=m.s.c,x.s.r=m.s.r,x.e.c=Math.max(x.e.c,m.e.c),x.e.r=Math.max(x.e.r,m.e.r),o==-1&&(x.e.r=o=m.e.r+1)}for(var f=0;f!=n.length;++f)if(n[f]){if(!Array.isArray(n[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=n[f].length;++p)if(!(typeof n[f][p]>"u")){var N={v:n[f][p]},y=o+f,g=d+p;if(x.s.r>y&&(x.s.r=y),x.s.c>g&&(x.s.c=g),x.e.r<y&&(x.e.r=y),x.e.c<g&&(x.e.c=g),n[f][p]&&typeof n[f][p]=="object"&&!Array.isArray(n[f][p])&&!(n[f][p]instanceof Date))N=n[f][p];else if(Array.isArray(N.v)&&(N.f=n[f][p][1],N.v=N.v[0]),N.v===null)if(N.f)N.t="n";else if(r.nullError)N.t="e",N.v=0;else if(r.sheetStubs)N.t="z";else continue;else typeof N.v=="number"?N.t="n":typeof N.v=="boolean"?N.t="b":N.v instanceof Date?(N.z=r.dateNF||ct[14],r.cellDates?(N.t="d",N.w=Hr(N.z,Wn(N.v))):(N.t="n",N.v=Wn(N.v),N.w=Hr(N.z,N.v))):N.t="s";if(s)l[y]||(l[y]=[]),l[y][g]&&l[y][g].z&&(N.z=l[y][g].z),l[y][g]=N;else{var b=dt({c:g,r:y});l[b]&&l[b].z&&(N.z=l[b].z),l[b]=N}}}return x.s.c<1e7&&(l["!ref"]=gt(x)),l}function Mc(e,n){return ik(null,e,n)}function y8(e){return e.read_shift(4,"i")}function ss(e,n){return n||(n=Te(4)),n.write_shift(4,e),n}function Sa(e){var n=e.read_shift(4);return n===0?"":e.read_shift(n,"dbcs")}function ra(e,n){var a=!1;return n==null&&(a=!0,n=Te(4+2*e.length)),n.write_shift(4,e.length),e.length>0&&n.write_shift(0,e,"dbcs"),a?n.slice(0,n.l):n}function v8(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function b8(e,n){return n||(n=Te(4)),n.write_shift(2,0),n.write_shift(2,0),n}function Og(e,n){var a=e.l,r=e.read_shift(1),s=Sa(e),l=[],o={t:s,h:s};if((r&1)!==0){for(var d=e.read_shift(4),u=0;u!=d;++u)l.push(v8(e));o.r=l}else o.r=[{ich:0,ifnt:0}];return e.l=a+n,o}function N8(e,n){var a=!1;return n==null&&(a=!0,n=Te(15+4*e.t.length)),n.write_shift(1,0),ra(e.t,n),a?n.slice(0,n.l):n}var j8=Og;function w8(e,n){var a=!1;return n==null&&(a=!0,n=Te(23+4*e.t.length)),n.write_shift(1,1),ra(e.t,n),n.write_shift(4,1),b8({},n),a?n.slice(0,n.l):n}function Ur(e){var n=e.read_shift(4),a=e.read_shift(2);return a+=e.read_shift(1)<<16,e.l++,{c:n,iStyleRef:a}}function go(e,n){return n==null&&(n=Te(8)),n.write_shift(-4,e.c),n.write_shift(3,e.iStyleRef||e.s),n.write_shift(1,0),n}function yo(e){var n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:n}}function vo(e,n){return n==null&&(n=Te(4)),n.write_shift(3,e.iStyleRef||e.s),n.write_shift(1,0),n}var k8=Sa,lk=ra;function Mg(e){var n=e.read_shift(4);return n===0||n===4294967295?"":e.read_shift(n,"dbcs")}function I0(e,n){var a=!1;return n==null&&(a=!0,n=Te(127)),n.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&n.write_shift(0,e,"dbcs"),a?n.slice(0,n.l):n}var T8=Sa,Dp=Mg,Rg=I0;function Bg(e){var n=e.slice(e.l,e.l+4),a=n[0]&1,r=n[0]&2;e.l+=4;var s=r===0?P0([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):Rl(n,0)>>2;return a?s/100:s}function ok(e,n){n==null&&(n=Te(4));var a=0,r=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?r=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(r=1,a=1),r)n.write_shift(-4,((a?s:e)<<2)+(a+2));else throw new Error("unsupported RkNumber "+e)}function ck(e){var n={s:{},e:{}};return n.s.r=e.read_shift(4),n.e.r=e.read_shift(4),n.s.c=e.read_shift(4),n.e.c=e.read_shift(4),n}function C8(e,n){return n||(n=Te(16)),n.write_shift(4,e.s.r),n.write_shift(4,e.e.r),n.write_shift(4,e.s.c),n.write_shift(4,e.e.c),n}var bo=ck,Rc=C8;function Ca(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function co(e,n){return(n||Te(8)).write_shift(8,e,"f")}function S8(e){var n={},a=e.read_shift(1),r=a>>>1,s=e.read_shift(1),l=e.read_shift(2,"i"),o=e.read_shift(1),d=e.read_shift(1),u=e.read_shift(1);switch(e.l++,r){case 0:n.auto=1;break;case 1:n.index=s;var x=Zl[s];x&&(n.rgb=su(x));break;case 2:n.rgb=su([o,d,u]);break;case 3:n.theme=s;break}return l!=0&&(n.tint=l>0?l/32767:l/32768),n}function O0(e,n){if(n||(n=Te(8)),!e||e.auto)return n.write_shift(4,0),n.write_shift(4,0),n;e.index!=null?(n.write_shift(1,2),n.write_shift(1,e.index)):e.theme!=null?(n.write_shift(1,6),n.write_shift(1,e.theme)):(n.write_shift(1,5),n.write_shift(1,0));var a=e.tint||0;if(a>0?a*=32767:a<0&&(a*=32768),n.write_shift(2,a),!e.rgb||e.theme!=null)n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);else{var r=e.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),n.write_shift(1,parseInt(r.slice(0,2),16)),n.write_shift(1,parseInt(r.slice(2,4),16)),n.write_shift(1,parseInt(r.slice(4,6),16)),n.write_shift(1,255)}return n}function _8(e){var n=e.read_shift(1);e.l++;var a={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return a}function E8(e,n){n||(n=Te(2));var a=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return n.write_shift(1,a),n.write_shift(1,0),n}function dk(e,n){var a={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return a[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,n==1?"lpstr":"lpwstr")}function D8(e){return dk(e,1)}function A8(e){return dk(e,2)}var Hg=2,Qa=3,Zh=11,PN=12,M0=19,e0=64,F8=65,L8=71,P8=4108,I8=4126,ta=80,uk=81,O8=[ta,uk],Ap={1:{n:"CodePage",t:Hg},2:{n:"Category",t:ta},3:{n:"PresentationFormat",t:ta},4:{n:"ByteCount",t:Qa},5:{n:"LineCount",t:Qa},6:{n:"ParagraphCount",t:Qa},7:{n:"SlideCount",t:Qa},8:{n:"NoteCount",t:Qa},9:{n:"HiddenCount",t:Qa},10:{n:"MultimediaClipCount",t:Qa},11:{n:"ScaleCrop",t:Zh},12:{n:"HeadingPairs",t:P8},13:{n:"TitlesOfParts",t:I8},14:{n:"Manager",t:ta},15:{n:"Company",t:ta},16:{n:"LinksUpToDate",t:Zh},17:{n:"CharacterCount",t:Qa},19:{n:"SharedDoc",t:Zh},22:{n:"HyperlinksChanged",t:Zh},23:{n:"AppVersion",t:Qa,p:"version"},24:{n:"DigSig",t:F8},26:{n:"ContentType",t:ta},27:{n:"ContentStatus",t:ta},28:{n:"Language",t:ta},29:{n:"Version",t:ta},255:{},2147483648:{n:"Locale",t:M0},2147483651:{n:"Behavior",t:M0},1919054434:{}},Fp={1:{n:"CodePage",t:Hg},2:{n:"Title",t:ta},3:{n:"Subject",t:ta},4:{n:"Author",t:ta},5:{n:"Keywords",t:ta},6:{n:"Comments",t:ta},7:{n:"Template",t:ta},8:{n:"LastAuthor",t:ta},9:{n:"RevNumber",t:ta},10:{n:"EditTime",t:e0},11:{n:"LastPrinted",t:e0},12:{n:"CreatedDate",t:e0},13:{n:"ModifiedDate",t:e0},14:{n:"PageCount",t:Qa},15:{n:"WordCount",t:Qa},16:{n:"CharCount",t:Qa},17:{n:"Thumbnail",t:L8},18:{n:"Application",t:ta},19:{n:"DocSecurity",t:Qa},255:{},2147483648:{n:"Locale",t:M0},2147483651:{n:"Behavior",t:M0},1919054434:{}},IN={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},M8=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function R8(e){return e.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var B8=R8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Zl=un(B8),xi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},hk={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Lp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},t0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Vg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function H8(e){var n=Vg();if(!e||!e.match)return n;var a={};if((e.match(Ea)||[]).forEach(function(r){var s=ut(r);switch(s[0].replace(QF,"<")){case"<?xml":break;case"<Types":n.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":a[s.Extension]=s.ContentType;break;case"<Override":n[Lp[s.ContentType]]!==void 0&&n[Lp[s.ContentType]].push(s.PartName);break}}),n.xmlns!==$n.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=a,delete n.calcchains,n}function xk(e,n){var a=HF(Lp),r=[],s;r[r.length]=Pn,r[r.length]=Ve("Types",null,{xmlns:$n.CT,"xmlns:xsd":$n.xsd,"xmlns:xsi":$n.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return Ve("Default",null,{Extension:u[0],ContentType:u[1]})}));var l=function(u){e[u]&&e[u].length>0&&(s=e[u][0],r[r.length]=Ve("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:t0[u][n.bookType]||t0[u].xlsx}))},o=function(u){(e[u]||[]).forEach(function(x){r[r.length]=Ve("Override",null,{PartName:(x[0]=="/"?"":"/")+x,ContentType:t0[u][n.bookType]||t0[u].xlsx})})},d=function(u){(e[u]||[]).forEach(function(x){r[r.length]=Ve("Override",null,{PartName:(x[0]=="/"?"":"/")+x,ContentType:a[u][0]})})};return l("workbooks"),o("sheets"),o("charts"),d("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(d),d("vba"),d("comments"),d("threadedcomments"),d("drawings"),o("metadata"),d("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var wt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ru(e){var n=e.lastIndexOf("/");return e.slice(0,n+1)+"_rels/"+e.slice(n+1)+".rels"}function Ud(e,n){var a={"!id":{}};if(!e)return a;n.charAt(0)!=="/"&&(n="/"+n);var r={};return(e.match(Ea)||[]).forEach(function(s){var l=ut(s);if(l[0]==="<Relationship"){var o={};o.Type=l.Type,o.Target=l.Target,o.Id=l.Id,l.TargetMode&&(o.TargetMode=l.TargetMode);var d=l.TargetMode==="External"?l.Target:Id(l.Target,n);a[d]=o,r[l.Id]=o}}),a["!id"]=r,a}function lc(e){var n=[Pn,Ve("Relationships",null,{xmlns:$n.RELS})];return Tn(e["!id"]).forEach(function(a){n[n.length]=Ve("Relationship",null,e["!id"][a])}),n.length>2&&(n[n.length]="</Relationships>",n[1]=n[1].replace("/>",">")),n.join("")}function $t(e,n,a,r,s,l){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),n<0)for(n=e["!idx"];e["!id"]["rId"+n];++n);if(e["!idx"]=n+1,s.Id="rId"+n,s.Type=r,s.Target=a,[wt.HLINK,wt.XPATH,wt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+n);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,n}var V8="application/vnd.oasis.opendocument.spreadsheet";function U8(e,n){for(var a=Ag(e),r,s;r=au.exec(a);)switch(r[3]){case"manifest":break;case"file-entry":if(s=ut(r[0],!1),s.path=="/"&&s.type!==V8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw r}}function K8(e){var n=[Pn];n.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),n.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var a=0;a<e.length;++a)n.push('  <manifest:file-entry manifest:full-path="'+e[a][0]+'" manifest:media-type="'+e[a][1]+`"/>
`);return n.push("</manifest:manifest>"),n.join("")}function ON(e,n,a){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(a||"odf")+"#"+n+`"/>
`,`  </rdf:Description>
`].join("")}function z8(e,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+n+`"/>
`,`  </rdf:Description>
`].join("")}function $8(e){var n=[Pn];n.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var a=0;a!=e.length;++a)n.push(ON(e[a][0],e[a][1])),n.push(z8("",e[a][0]));return n.push(ON("","Document","pkg")),n.push("</rdf:RDF>"),n.join("")}function mk(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+E0.version+"</meta:generator></office:meta></office:document-meta>"}var Rr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],G8=(function(){for(var e=new Array(Rr.length),n=0;n<Rr.length;++n){var a=Rr[n],r="(?:"+a[0].slice(0,a[0].indexOf(":"))+":)"+a[0].slice(a[0].indexOf(":")+1);e[n]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e})();function fk(e){var n={};e=Xt(e);for(var a=0;a<Rr.length;++a){var r=Rr[a],s=e.match(G8[a]);s!=null&&s.length>0&&(n[r[1]]=Lt(s[1])),r[2]==="date"&&n[r[1]]&&(n[r[1]]=dn(n[r[1]]))}return n}function Af(e,n,a,r,s){s[e]!=null||n==null||n===""||(s[e]=n,n=qt(n),r[r.length]=a?Ve(e,n,a):fa(e,n))}function pk(e,n){var a=n||{},r=[Pn,Ve("cp:coreProperties",null,{"xmlns:cp":$n.CORE_PROPS,"xmlns:dc":$n.dc,"xmlns:dcterms":$n.dcterms,"xmlns:dcmitype":$n.dcmitype,"xmlns:xsi":$n.xsi})],s={};if(!e&&!a.Props)return r.join("");e&&(e.CreatedDate!=null&&Af("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Ep(e.CreatedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},r,s),e.ModifiedDate!=null&&Af("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Ep(e.ModifiedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},r,s));for(var l=0;l!=Rr.length;++l){var o=Rr[l],d=a.Props&&a.Props[o[1]]!=null?a.Props[o[1]]:e?e[o[1]]:null;d===!0?d="1":d===!1?d="0":typeof d=="number"&&(d=String(d)),d!=null&&Af(o[0],d,null,r,s)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var eo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],gk=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function yk(e,n,a,r){var s=[];if(typeof e=="string")s=CN(e,r);else for(var l=0;l<e.length;++l)s=s.concat(e[l].map(function(m){return{v:m}}));var o=typeof n=="string"?CN(n,r).map(function(m){return m.v}):n,d=0,u=0;if(o.length>0)for(var x=0;x!==s.length;x+=2){switch(u=+s[x+1].v,s[x].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":a.Worksheets=u,a.SheetNames=o.slice(d,d+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":a.NamedRanges=u,a.DefinedNames=o.slice(d,d+u);break;case"Charts":case"Diagramme":a.Chartsheets=u,a.ChartNames=o.slice(d,d+u);break}d+=u}}function q8(e,n,a){var r={};return n||(n={}),e=Xt(e),eo.forEach(function(s){var l=(e.match(tu(s[0]))||[])[1];switch(s[2]){case"string":l&&(n[s[1]]=Lt(l));break;case"bool":n[s[1]]=l==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(r[s[1]]=o[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&yk(r.HeadingPairs,r.TitlesOfParts,n,a),n}function vk(e){var n=[],a=Ve;return e||(e={}),e.Application="SheetJS",n[n.length]=Pn,n[n.length]=Ve("Properties",null,{xmlns:$n.EXT_PROPS,"xmlns:vt":$n.vt}),eo.forEach(function(r){if(e[r[1]]!==void 0){var s;switch(r[2]){case"string":s=qt(String(e[r[1]]));break;case"bool":s=e[r[1]]?"true":"false";break}s!==void 0&&(n[n.length]=a(r[0],s))}}),n[n.length]=a("HeadingPairs",a("vt:vector",a("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+a("vt:variant",a("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),n[n.length]=a("TitlesOfParts",a("vt:vector",e.SheetNames.map(function(r){return"<vt:lpstr>"+qt(r)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var W8=/<[^>]+>[^<]*/g;function X8(e,n){var a={},r="",s=e.match(W8);if(s)for(var l=0;l!=s.length;++l){var o=s[l],d=ut(o);switch(d[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Lt(d.name);break;case"</property>":r=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),x=u[0].slice(4),m=u[1];switch(x){case"lpstr":case"bstr":case"lpwstr":a[r]=Lt(m);break;case"bool":a[r]=on(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":a[r]=parseInt(m,10);break;case"r4":case"r8":case"decimal":a[r]=parseFloat(m);break;case"filetime":case"date":a[r]=dn(m);break;case"cy":case"error":a[r]=Lt(m);break;default:if(x.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",o,x,u)}}else if(o.slice(0,2)!=="</"){if(n.WTF)throw new Error(o)}}}return a}function bk(e){var n=[Pn,Ve("Properties",null,{xmlns:$n.CUST_PROPS,"xmlns:vt":$n.vt})];if(!e)return n.join("");var a=1;return Tn(e).forEach(function(s){++a,n[n.length]=Ve("property",r8(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:a,name:qt(s)})}),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var Pp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ff;function Q8(e,n,a){Ff||(Ff=dx(Pp)),n=Ff[n]||n,e[n]=a}function Y8(e,n){var a=[];return Tn(Pp).map(function(r){for(var s=0;s<Rr.length;++s)if(Rr[s][1]==r)return Rr[s];for(s=0;s<eo.length;++s)if(eo[s][1]==r)return eo[s];throw r}).forEach(function(r){if(e[r[1]]!=null){var s=n&&n.Props&&n.Props[r[1]]!=null?n.Props[r[1]]:e[r[1]];switch(r[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),a.push(fa(Pp[r[1]]||r[1],s))}}),Ve("DocumentProperties",a.join(""),{xmlns:ur.o})}function J8(e,n){var a=["Worksheets","SheetNames"],r="CustomDocumentProperties",s=[];return e&&Tn(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)){for(var o=0;o<Rr.length;++o)if(l==Rr[o][1])return;for(o=0;o<eo.length;++o)if(l==eo[o][1])return;for(o=0;o<a.length;++o)if(l==a[o])return;var d=e[l],u="string";typeof d=="number"?(u="float",d=String(d)):d===!0||d===!1?(u="boolean",d=d?"1":"0"):d=String(d),s.push(Ve(jN(l),d,{"dt:dt":u}))}}),n&&Tn(n).forEach(function(l){if(Object.prototype.hasOwnProperty.call(n,l)&&!(e&&Object.prototype.hasOwnProperty.call(e,l))){var o=n[l],d="string";typeof o=="number"?(d="float",o=String(o)):o===!0||o===!1?(d="boolean",o=o?"1":"0"):o instanceof Date?(d="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Ve(jN(l),o,{"dt:dt":d}))}}),"<"+r+' xmlns="'+ur.o+'">'+s.join("")+"</"+r+">"}function Ug(e){var n=e.read_shift(4),a=e.read_shift(4);return new Date((a/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Z8(e){var n=typeof e=="string"?new Date(Date.parse(e)):e,a=n.getTime()/1e3+11644473600,r=a%Math.pow(2,32),s=(a-r)/Math.pow(2,32);r*=1e7,s*=1e7;var l=r/Math.pow(2,32)|0;l>0&&(r=r%Math.pow(2,32),s+=l);var o=Te(8);return o.write_shift(4,r),o.write_shift(4,s),o}function Nk(e,n,a){var r=e.l,s=e.read_shift(0,"lpstr-cp");if(a)for(;e.l-r&3;)++e.l;return s}function jk(e,n,a){var r=e.read_shift(0,"lpwstr");return r}function wk(e,n,a){return n===31?jk(e):Nk(e,n,a)}function Ip(e,n,a){return wk(e,n,a===!1?0:4)}function eL(e,n){if(!n)throw new Error("VtUnalignedString must have positive length");return wk(e,n,0)}function tL(e){for(var n=e.read_shift(4),a=[],r=0;r!=n;++r){var s=e.l;a[r]=e.read_shift(0,"lpwstr").replace(Ha,""),e.l-s&2&&(e.l+=2)}return a}function nL(e){for(var n=e.read_shift(4),a=[],r=0;r!=n;++r)a[r]=e.read_shift(0,"lpstr-cp").replace(Ha,"");return a}function aL(e){var n=e.l,a=R0(e,uk);e[e.l]==0&&e[e.l+1]==0&&e.l-n&2&&(e.l+=2);var r=R0(e,Qa);return[a,r]}function rL(e){for(var n=e.read_shift(4),a=[],r=0;r<n/2;++r)a.push(aL(e));return a}function MN(e,n){for(var a=e.read_shift(4),r={},s=0;s!=a;++s){var l=e.read_shift(4),o=e.read_shift(4);r[l]=e.read_shift(o,n===1200?"utf16le":"utf8").replace(Ha,"").replace(Pd,"!"),n===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function kk(e){var n=e.read_shift(4),a=e.slice(e.l,e.l+n);return e.l+=n,(n&3)>0&&(e.l+=4-(n&3)&3),a}function sL(e){var n={};return n.Size=e.read_shift(4),e.l+=n.Size+3-(n.Size-1)%4,n}function R0(e,n,a){var r=e.read_shift(2),s,l=a||{};if(e.l+=2,n!==PN&&r!==n&&O8.indexOf(n)===-1&&!((n&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+n+" saw "+r);switch(n===PN?r:n){case 2:return s=e.read_shift(2,"i"),l.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return Nk(e,r,4).replace(Ha,"");case 31:return jk(e);case 64:return Ug(e);case 65:return kk(e);case 71:return sL(e);case 80:return Ip(e,r,!l.raw).replace(Ha,"");case 81:return eL(e,r).replace(Ha,"");case 4108:return rL(e);case 4126:case 4127:return r==4127?tL(e):nL(e);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+r)}}function RN(e,n){var a=Te(4),r=Te(4);switch(a.write_shift(4,e==80?31:e),e){case 3:r.write_shift(-4,n);break;case 5:r=Te(8),r.write_shift(8,n,"f");break;case 11:r.write_shift(4,n?1:0);break;case 64:r=Z8(n);break;case 31:case 80:for(r=Te(4+2*(n.length+1)+(n.length%2?0:2)),r.write_shift(4,n.length+1),r.write_shift(0,n,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}return aa([a,r])}function BN(e,n){var a=e.l,r=e.read_shift(4),s=e.read_shift(4),l=[],o=0,d=0,u=-1,x={};for(o=0;o!=s;++o){var m=e.read_shift(4),f=e.read_shift(4);l[o]=[m,f+a]}l.sort(function(T,_){return T[1]-_[1]});var p={};for(o=0;o!=s;++o){if(e.l!==l[o][1]){var N=!0;if(o>0&&n)switch(n[l[o-1][0]].t){case 2:e.l+2===l[o][1]&&(e.l+=2,N=!1);break;case 80:e.l<=l[o][1]&&(e.l=l[o][1],N=!1);break;case 4108:e.l<=l[o][1]&&(e.l=l[o][1],N=!1);break}if((!n||o==0)&&e.l<=l[o][1]&&(N=!1,e.l=l[o][1]),N)throw new Error("Read Error: Expected address "+l[o][1]+" at "+e.l+" :"+o)}if(n){var y=n[l[o][0]];if(p[y.n]=R0(e,y.t,{raw:!0}),y.p==="version"&&(p[y.n]=String(p[y.n]>>16)+"."+("0000"+String(p[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(p[y.n]){case 0:p[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:es(d=p[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[y.n])}}else if(l[o][0]===1){if(d=p.CodePage=R0(e,Hg),es(d),u!==-1){var g=e.l;e.l=l[u][1],x=MN(e,d),e.l=g}}else if(l[o][0]===0){if(d===0){u=o,e.l=l[o+1][1];continue}x=MN(e,d)}else{var b=x[l[o][0]],j;switch(e[e.l]){case 65:e.l+=4,j=kk(e);break;case 30:e.l+=4,j=Ip(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,j=Ip(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,j=e.read_shift(4,"i");break;case 19:e.l+=4,j=e.read_shift(4);break;case 5:e.l+=4,j=e.read_shift(8,"f");break;case 11:e.l+=4,j=Dn(e,4);break;case 64:e.l+=4,j=dn(Ug(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[b]=j}}return e.l=a+r,p}var Tk=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function iL(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function HN(e,n,a){var r=Te(8),s=[],l=[],o=8,d=0,u=Te(8),x=Te(8);if(u.write_shift(4,2),u.write_shift(4,1200),x.write_shift(4,1),l.push(u),s.push(x),o+=8+u.length,!n){x=Te(8),x.write_shift(4,0),s.unshift(x);var m=[Te(4)];for(m[0].write_shift(4,e.length),d=0;d<e.length;++d){var f=e[d][0];for(u=Te(8+2*(f.length+1)+(f.length%2?0:2)),u.write_shift(4,d+2),u.write_shift(4,f.length+1),u.write_shift(0,f,"dbcs");u.l!=u.length;)u.write_shift(1,0);m.push(u)}u=aa(m),l.unshift(u),o+=8+u.length}for(d=0;d<e.length;++d)if(!(n&&!n[e[d][0]])&&!(Tk.indexOf(e[d][0])>-1||gk.indexOf(e[d][0])>-1)&&e[d][1]!=null){var p=e[d][1],N=0;if(n){N=+n[e[d][0]];var y=a[N];if(y.p=="version"&&typeof p=="string"){var g=p.split(".");p=(+g[0]<<16)+(+g[1]||0)}u=RN(y.t,p)}else{var b=iL(p);b==-1&&(b=31,p=String(p)),u=RN(b,p)}l.push(u),x=Te(8),x.write_shift(4,n?N:2+d),s.push(x),o+=8+u.length}var j=8*(l.length+1);for(d=0;d<l.length;++d)s[d].write_shift(4,j),j+=l[d].length;return r.write_shift(4,o),r.write_shift(4,l.length),aa([r].concat(s).concat(l))}function VN(e,n,a){var r=e.content;if(!r)return{};ha(r,0);var s,l,o,d,u=0;r.chk("feff","Byte Order: "),r.read_shift(2);var x=r.read_shift(4),m=r.read_shift(16);if(m!==rt.utils.consts.HEADER_CLSID&&m!==a)throw new Error("Bad PropertySet CLSID "+m);if(s=r.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(l=r.read_shift(16),d=r.read_shift(4),s===1&&d!==r.l)throw new Error("Length mismatch: "+d+" !== "+r.l);s===2&&(o=r.read_shift(16),u=r.read_shift(4));var f=BN(r,n),p={SystemIdentifier:x};for(var N in f)p[N]=f[N];if(p.FMTID=l,s===1)return p;if(u-r.l==2&&(r.l+=2),r.l!==u)throw new Error("Length mismatch 2: "+r.l+" !== "+u);var y;try{y=BN(r,null)}catch{}for(N in y)p[N]=y[N];return p.FMTID=[l,o],p}function UN(e,n,a,r,s,l){var o=Te(s?68:48),d=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,rt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,n,"hex"),o.write_shift(4,s?68:48);var u=HN(e,a,r);if(d.push(u),s){var x=HN(s,null,null);o.write_shift(16,l,"hex"),o.write_shift(4,68+u.length),d.push(x)}return aa(d)}function Ri(e,n){return e.read_shift(n),null}function lL(e,n){n||(n=Te(e));for(var a=0;a<e;++a)n.write_shift(1,0);return n}function oL(e,n,a){for(var r=[],s=e.l+n;e.l<s;)r.push(a(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return r}function Dn(e,n){return e.read_shift(n)===1}function Ma(e,n){return n||(n=Te(2)),n.write_shift(2,+!!e),n}function Rn(e){return e.read_shift(2,"u")}function Pr(e,n){return n||(n=Te(2)),n.write_shift(2,e),n}function Ck(e,n){return oL(e,n,Rn)}function cL(e){var n=e.read_shift(1),a=e.read_shift(1);return a===1?n:n===1}function Sk(e,n,a){return a||(a=Te(2)),a.write_shift(1,n=="e"?+e:+!!e),a.write_shift(1,n=="e"?1:0),a}function _u(e,n,a){var r=e.read_shift(a&&a.biff>=12?2:1),s="sbcs-cont";if(a&&a.biff>=8,!a||a.biff==8){var l=e.read_shift(1);l&&(s="dbcs-cont")}else a.biff==12&&(s="wstr");a.biff>=2&&a.biff<=5&&(s="cpstr");var o=r?e.read_shift(r,s):"";return o}function dL(e){var n=e.read_shift(2),a=e.read_shift(1),r=a&4,s=a&8,l=1+(a&1),o=0,d,u={};s&&(o=e.read_shift(2)),r&&(d=e.read_shift(4));var x=l==2?"dbcs-cont":"sbcs-cont",m=n===0?"":e.read_shift(n,x);return s&&(e.l+=4*o),r&&(e.l+=d),u.t=m,s||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function uL(e){var n=e.t||"",a=Te(3);a.write_shift(2,n.length),a.write_shift(1,1);var r=Te(2*n.length);r.write_shift(2*n.length,n,"utf16le");var s=[a,r];return aa(s)}function uo(e,n,a){var r;if(a){if(a.biff>=2&&a.biff<=5)return e.read_shift(n,"cpstr");if(a.biff>=12)return e.read_shift(n,"dbcs-cont")}var s=e.read_shift(1);return s===0?r=e.read_shift(n,"sbcs-cont"):r=e.read_shift(n,"dbcs-cont"),r}function Eu(e,n,a){var r=e.read_shift(a&&a.biff==2?1:2);return r===0?(e.l++,""):uo(e,r,a)}function No(e,n,a){if(a.biff>5)return Eu(e,n,a);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,a.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function _k(e,n,a){return a||(a=Te(3+2*e.length)),a.write_shift(2,e.length),a.write_shift(1,1),a.write_shift(31,e,"utf16le"),a}function hL(e){var n=e.read_shift(1);e.l++;var a=e.read_shift(2);return e.l+=2,[n,a]}function xL(e){var n=e.read_shift(4),a=e.l,r=!1;n>24&&(e.l+=n-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=a);var s=e.read_shift((r?n-24:n)>>1,"utf16le").replace(Ha,"");return r&&(e.l+=24),s}function mL(e){for(var n=e.read_shift(2),a="";n-- >0;)a+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return a+r.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(l>>1,"utf16le").replace(Ha,"");return a+o}function fL(e,n){var a=e.read_shift(16);switch(a){case"e0c9ea79f9bace118c8200aa004ba90b":return xL(e);case"0303000000000000c000000000000046":return mL(e);default:throw new Error("Unsupported Moniker "+a)}}function n0(e){var n=e.read_shift(4),a=n>0?e.read_shift(n,"utf16le").replace(Ha,""):"";return a}function KN(e,n){n||(n=Te(6+e.length*2)),n.write_shift(4,1+e.length);for(var a=0;a<e.length;++a)n.write_shift(2,e.charCodeAt(a));return n.write_shift(2,0),n}function pL(e,n){var a=e.l+n,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var s=e.read_shift(2);e.l+=2;var l,o,d,u,x="",m,f;s&16&&(l=n0(e,a-e.l)),s&128&&(o=n0(e,a-e.l)),(s&257)===257&&(d=n0(e,a-e.l)),(s&257)===1&&(u=fL(e,a-e.l)),s&8&&(x=n0(e,a-e.l)),s&32&&(m=e.read_shift(16)),s&64&&(f=Ug(e)),e.l=a;var p=o||d||u||"";p&&x&&(p+="#"+x),p||(p="#"+x),s&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var N={Target:p};return m&&(N.guid=m),f&&(N.time=f),l&&(N.Tooltip=l),N}function gL(e){var n=Te(512),a=0,r=e.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var s=r.indexOf("#"),l=s>-1?31:23;switch(r.charAt(0)){case"#":l=28;break;case".":l&=-3;break}n.write_shift(4,2),n.write_shift(4,l);var o=[8,6815827,6619237,4849780,83];for(a=0;a<o.length;++a)n.write_shift(4,o[a]);if(l==28)r=r.slice(1),KN(r,n);else if(l&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<o.length;++a)n.write_shift(1,parseInt(o[a],16));var d=s>-1?r.slice(0,s):r;for(n.write_shift(4,2*(d.length+1)),a=0;a<d.length;++a)n.write_shift(2,d.charCodeAt(a));n.write_shift(2,0),l&8&&KN(s>-1?r.slice(s+1):"",n)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),a=0;a<o.length;++a)n.write_shift(1,parseInt(o[a],16));for(var u=0;r.slice(u*3,u*3+3)=="../"||r.slice(u*3,u*3+3)=="..\\";)++u;for(n.write_shift(2,u),n.write_shift(4,r.length-3*u+1),a=0;a<r.length-3*u;++a)n.write_shift(1,r.charCodeAt(a+3*u)&255);for(n.write_shift(1,0),n.write_shift(2,65535),n.write_shift(2,57005),a=0;a<6;++a)n.write_shift(4,0)}return n.slice(0,n.l)}function Ek(e){var n=e.read_shift(1),a=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1);return[n,a,r,s]}function Dk(e,n){var a=Ek(e);return a[3]=0,a}function Fs(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2);return{r:n,c:a,ixfe:r}}function ho(e,n,a,r){return r||(r=Te(6)),r.write_shift(2,e),r.write_shift(2,n),r.write_shift(2,a||0),r}function yL(e){var n=e.read_shift(2),a=e.read_shift(2);return e.l+=8,{type:n,flags:a}}function vL(e,n,a){return n===0?"":No(e,n,a)}function bL(e,n,a){var r=a.biff>8?4:2,s=e.read_shift(r),l=e.read_shift(r,"i"),o=e.read_shift(r,"i");return[s,l,o]}function Ak(e){var n=e.read_shift(2),a=Bg(e);return[n,a]}function NL(e,n,a){e.l+=4,n-=4;var r=e.l+n,s=_u(e,n,a),l=e.read_shift(2);if(r-=e.l,l!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+l);return e.l+=l,s}function xx(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{s:{c:r,r:n},e:{c:s,r:a}}}function Fk(e,n){return n||(n=Te(8)),n.write_shift(2,e.s.r),n.write_shift(2,e.e.r),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c),n}function Lk(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(1),s=e.read_shift(1);return{s:{c:r,r:n},e:{c:s,r:a}}}var jL=Lk;function Pk(e){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[a,n,r]}function wL(e){var n={};return e.l+=4,e.l+=16,n.fSharedNote=e.read_shift(2),e.l+=4,n}function kL(e){var n={};return e.l+=4,e.cf=e.read_shift(2),n}function ba(e){e.l+=2,e.l+=e.read_shift(2)}var TL={0:ba,4:ba,5:ba,6:ba,7:kL,8:ba,9:ba,10:ba,11:ba,12:ba,13:wL,14:ba,15:ba,16:ba,17:ba,18:ba,19:ba,20:ba,21:Pk};function CL(e,n){for(var a=e.l+n,r=[];e.l<a;){var s=e.read_shift(2);e.l-=2;try{r.push(TL[s](e,a-e.l))}catch{return e.l=a,r}}return e.l!=a&&(e.l=a),r}function a0(e,n){var a={BIFFVer:0,dt:0};switch(a.BIFFVer=e.read_shift(2),n-=2,n>=2&&(a.dt=e.read_shift(2),e.l-=2),a.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+a.BIFFVer)}return e.read_shift(n),a}function Kg(e,n,a){var r=1536,s=16;switch(a.bookType){case"biff8":break;case"biff5":r=1280,s=8;break;case"biff4":r=4,s=6;break;case"biff3":r=3,s=6;break;case"biff2":r=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=Te(s);return l.write_shift(2,r),l.write_shift(2,n),s>4&&l.write_shift(2,29282),s>6&&l.write_shift(2,1997),s>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function SL(e,n){return n===0||e.read_shift(2),1200}function _L(e,n,a){if(a.enc)return e.l+=n,"";var r=e.l,s=No(e,0,a);return e.read_shift(n+r-e.l),s}function EL(e,n){var a=!n||n.biff==8,r=Te(a?112:54);for(r.write_shift(n.biff==8?2:1,7),a&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(a?0:536870912));r.l<r.length;)r.write_shift(1,a?0:32);return r}function DL(e,n,a){var r=a&&a.biff==8||n==2?e.read_shift(2):(e.l+=n,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function AL(e,n,a){var r=e.read_shift(4),s=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var o=_u(e,0,a);return o.length===0&&(o="Sheet1"),{pos:r,hs:s,dt:l,name:o}}function FL(e,n){var a=!n||n.biff>=8?2:1,r=Te(8+a*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),n.biff>=8&&r.write_shift(1,1),r.write_shift(a*e.name.length,e.name,n.biff<8?"sbcs":"utf16le");var s=r.slice(0,r.l);return s.l=r.l,s}function LL(e,n){for(var a=e.l+n,r=e.read_shift(4),s=e.read_shift(4),l=[],o=0;o!=s&&e.l<a;++o)l.push(dL(e));return l.Count=r,l.Unique=s,l}function PL(e,n){var a=Te(8);a.write_shift(4,e.Count),a.write_shift(4,e.Unique);for(var r=[],s=0;s<e.length;++s)r[s]=uL(e[s]);var l=aa([a].concat(r));return l.parts=[a.length].concat(r.map(function(o){return o.length})),l}function IL(e,n){var a={};return a.dsst=e.read_shift(2),e.l+=n-2,a}function OL(e){var n={};n.r=e.read_shift(2),n.c=e.read_shift(2),n.cnt=e.read_shift(2)-n.c;var a=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(n.level=r&7),r&32&&(n.hidden=!0),r&64&&(n.hpt=a/20),n}function ML(e){var n=yL(e);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var a=e.read_shift(4);return a!==0}function RL(e){return e.read_shift(2),e.read_shift(4)}function zN(e,n,a){var r=0;a&&a.biff==2||(r=e.read_shift(2));var s=e.read_shift(2);a&&a.biff==2&&(r=1-(s>>15),s&=32767);var l={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[l,s]}function BL(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),d=e.read_shift(2),u=e.read_shift(2),x=e.read_shift(2);return{Pos:[n,a],Dim:[r,s],Flags:l,CurTab:o,FirstTab:d,Selected:u,TabRatio:x}}function HL(){var e=Te(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function VL(e,n,a){if(a&&a.biff>=2&&a.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function UL(e){var n=Te(18),a=1718;return e&&e.RTL&&(a|=64),n.write_shift(2,a),n.write_shift(4,0),n.write_shift(4,64),n.write_shift(4,0),n.write_shift(4,0),n}function KL(){}function zL(e,n,a){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(a&&a.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=_u(e,0,a),r}function $L(e,n){var a=e.name||"Arial",r=n&&n.biff==5,s=r?15+a.length:16+2*a.length,l=Te(s);return l.write_shift(2,e.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,a.length),r||l.write_shift(1,1),l.write_shift((r?1:2)*a.length,a,r?"sbcs":"utf16le"),l}function GL(e){var n=Fs(e);return n.isst=e.read_shift(4),n}function qL(e,n,a,r){var s=Te(10);return ho(e,n,r,s),s.write_shift(4,a),s}function WL(e,n,a){a.biffguess&&a.biff==2&&(a.biff=5);var r=e.l+n,s=Fs(e);a.biff==2&&e.l++;var l=Eu(e,r-e.l,a);return s.val=l,s}function XL(e,n,a,r,s){var l=!s||s.biff==8,o=Te(8+ +l+(1+l)*a.length);return ho(e,n,r,o),o.write_shift(2,a.length),l&&o.write_shift(1,1),o.write_shift((1+l)*a.length,a,l?"utf16le":"sbcs"),o}function QL(e,n,a){var r=e.read_shift(2),s=No(e,0,a);return[r,s]}function YL(e,n,a,r){var s=a&&a.biff==5;r||(r=Te(s?3+n.length:5+2*n.length)),r.write_shift(2,e),r.write_shift(s?1:2,n.length),s||r.write_shift(1,1),r.write_shift((s?1:2)*n.length,n,s?"sbcs":"utf16le");var l=r.length>r.l?r.slice(0,r.l):r;return l.l==null&&(l.l=l.length),l}var JL=No;function $N(e,n,a){var r=e.l+n,s=a.biff==8||!a.biff?4:2,l=e.read_shift(s),o=e.read_shift(s),d=e.read_shift(2),u=e.read_shift(2);return e.l=r,{s:{r:l,c:d},e:{r:o,c:u}}}function ZL(e,n){var a=n.biff==8||!n.biff?4:2,r=Te(2*a+6);return r.write_shift(a,e.s.r),r.write_shift(a,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}function eP(e){var n=e.read_shift(2),a=e.read_shift(2),r=Ak(e);return{r:n,c:a,ixfe:r[0],rknum:r[1]}}function tP(e,n){for(var a=e.l+n-2,r=e.read_shift(2),s=e.read_shift(2),l=[];e.l<a;)l.push(Ak(e));if(e.l!==a)throw new Error("MulRK read error");var o=e.read_shift(2);if(l.length!=o-s+1)throw new Error("MulRK length mismatch");return{r,c:s,C:o,rkrec:l}}function nP(e,n){for(var a=e.l+n-2,r=e.read_shift(2),s=e.read_shift(2),l=[];e.l<a;)l.push(e.read_shift(2));if(e.l!==a)throw new Error("MulBlank read error");var o=e.read_shift(2);if(l.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r,c:s,C:o,ixfe:l}}function aP(e,n,a,r){var s={},l=e.read_shift(4),o=e.read_shift(4),d=e.read_shift(4),u=e.read_shift(2);return s.patternType=M8[d>>26],r.cellStyles&&(s.alc=l&7,s.fWrap=l>>3&1,s.alcV=l>>4&7,s.fJustLast=l>>7&1,s.trot=l>>8&255,s.cIndent=l>>16&15,s.fShrinkToFit=l>>20&1,s.iReadOrder=l>>22&2,s.fAtrNum=l>>26&1,s.fAtrFnt=l>>27&1,s.fAtrAlc=l>>28&1,s.fAtrBdr=l>>29&1,s.fAtrPat=l>>30&1,s.fAtrProt=l>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=d&127,s.icvBottom=d>>7&127,s.icvDiag=d>>14&127,s.dgDiag=d>>21&15,s.icvFore=u&127,s.icvBack=u>>7&127,s.fsxButton=u>>14&1),s}function rP(e,n,a){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,n-=6,r.data=aP(e,n,r.fStyle,a),r}function GN(e,n,a,r){var s=a&&a.biff==5;r||(r=Te(s?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,n<<4));var l=0;return e.numFmtId>0&&s&&(l|=1024),r.write_shift(4,l),r.write_shift(4,0),s||r.write_shift(4,0),r.write_shift(2,0),r}function sP(e){e.l+=4;var n=[e.read_shift(2),e.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function iP(e){var n=Te(8);return n.write_shift(4,0),n.write_shift(2,0),n.write_shift(2,0),n}function qN(e,n,a){var r=Fs(e);(a.biff==2||n==9)&&++e.l;var s=cL(e);return r.val=s,r.t=s===!0||s===!1?"b":"e",r}function lP(e,n,a,r,s,l){var o=Te(8);return ho(e,n,r,o),Sk(a,l,o),o}function oP(e,n,a){a.biffguess&&a.biff==2&&(a.biff=5);var r=Fs(e),s=Ca(e);return r.val=s,r}function cP(e,n,a,r){var s=Te(14);return ho(e,n,r,s),co(a,s),s}var WN=vL;function dP(e,n,a){var r=e.l+n,s=e.read_shift(2),l=e.read_shift(2);if(a.sbcch=l,l==1025||l==14849)return[l,s];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var o=uo(e,l),d=[];r>e.l;)d.push(Eu(e));return[l,s,o,d]}function XN(e,n,a){var r=e.read_shift(2),s,l={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return a.sbcch===14849&&(s=NL(e,n-2,a)),l.body=s||e.read_shift(n-2),typeof s=="string"&&(l.Name=s),l}var uP=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function QN(e,n,a){var r=e.l+n,s=e.read_shift(2),l=e.read_shift(1),o=e.read_shift(1),d=e.read_shift(a&&a.biff==2?1:2),u=0;(!a||a.biff>=5)&&(a.biff!=5&&(e.l+=2),u=e.read_shift(2),a.biff==5&&(e.l+=2),e.l+=4);var x=uo(e,o,a);s&32&&(x=uP[x.charCodeAt(0)]);var m=r-e.l;a&&a.biff==2&&--m;var f=r==e.l||d===0||!(m>0)?[]:C7(e,m,a,d);return{chKey:l,Name:x,itab:u,rgce:f}}function Ik(e,n,a){if(a.biff<8)return hP(e,n,a);for(var r=[],s=e.l+n,l=e.read_shift(a.biff>8?4:2);l--!==0;)r.push(bL(e,a.biff>8?12:6,a));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return r}function hP(e,n,a){e[e.l+1]==3&&e[e.l]++;var r=_u(e,n,a);return r.charCodeAt(0)==3?r.slice(1):r}function xP(e,n,a){if(a.biff<8){e.l+=n;return}var r=e.read_shift(2),s=e.read_shift(2),l=uo(e,r,a),o=uo(e,s,a);return[l,o]}function mP(e,n,a){var r=Lk(e);e.l++;var s=e.read_shift(1);return n-=8,[S7(e,n,a),s,r]}function YN(e,n,a){var r=jL(e);switch(a.biff){case 2:e.l++,n-=7;break;case 3:case 4:e.l+=2,n-=8;break;default:e.l+=6,n-=12}return[r,k7(e,n,a)]}function fP(e){var n=e.read_shift(4)!==0,a=e.read_shift(4)!==0,r=e.read_shift(4);return[n,a,r]}function pP(e,n,a){if(!(a.biff<8)){var r=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),d=No(e,0,a);return a.biff<8&&e.read_shift(1),[{r,c:s},d,o,l]}}function gP(e,n,a){return pP(e,n,a)}function yP(e,n){for(var a=[],r=e.read_shift(2);r--;)a.push(xx(e));return a}function vP(e){var n=Te(2+e.length*8);n.write_shift(2,e.length);for(var a=0;a<e.length;++a)Fk(e[a],n);return n}function bP(e,n,a){if(a&&a.biff<8)return jP(e,n,a);var r=Pk(e),s=CL(e,n-22,r[1]);return{cmo:r,ft:s}}var NP={8:function(e,n){var a=e.l+n;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=a,{fmt:r}}};function jP(e,n,a){e.l+=4;var r=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,n-=36;var o=[];return o.push((NP[r]||_a)(e,n,a)),{cmo:[s,r,l],ft:o}}function wP(e,n,a){var r=e.l,s="";try{e.l+=4;var l=(a.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:o=hL(e,6,a);var d=e.read_shift(2);e.read_shift(2),Rn(e,2);var u=e.read_shift(2);e.l+=u;for(var x=1;x<e.lens.length-1;++x){if(e.l-r!=e.lens[x])throw new Error("TxO: bad continue record");var m=e[e.l],f=uo(e,e.lens[x+1]-e.lens[x]-1);if(s+=f,s.length>=(m?d:2*d))break}if(s.length!==d&&s.length!==d*2)throw new Error("cchText: "+d+" != "+s.length);return e.l=r+n,{t:s}}catch{return e.l=r+n,{t:s}}}function kP(e,n){var a=xx(e);e.l+=16;var r=pL(e,n-24);return[a,r]}function TP(e){var n=Te(24),a=vn(e[0]);n.write_shift(2,a.r),n.write_shift(2,a.r),n.write_shift(2,a.c),n.write_shift(2,a.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)n.write_shift(1,parseInt(r[s],16));return aa([n,gL(e[1])])}function CP(e,n){e.read_shift(2);var a=xx(e),r=e.read_shift((n-10)/2,"dbcs-cont");return r=r.replace(Ha,""),[a,r]}function SP(e){var n=e[1].Tooltip,a=Te(10+2*(n.length+1));a.write_shift(2,2048);var r=vn(e[0]);a.write_shift(2,r.r),a.write_shift(2,r.r),a.write_shift(2,r.c),a.write_shift(2,r.c);for(var s=0;s<n.length;++s)a.write_shift(2,n.charCodeAt(s));return a.write_shift(2,0),a}function _P(e){var n=[0,0],a;return a=e.read_shift(2),n[0]=IN[a]||a,a=e.read_shift(2),n[1]=IN[a]||a,n}function EP(e){return e||(e=Te(4)),e.write_shift(2,1),e.write_shift(2,1),e}function DP(e){for(var n=e.read_shift(2),a=[];n-- >0;)a.push(Dk(e));return a}function AP(e){for(var n=e.read_shift(2),a=[];n-- >0;)a.push(Dk(e));return a}function FP(e){e.l+=2;var n={cxfs:0,crc:0};return n.cxfs=e.read_shift(2),n.crc=e.read_shift(4),n}function Ok(e,n,a){if(!a.cellStyles)return _a(e,n);var r=a&&a.biff>=12?4:2,s=e.read_shift(r),l=e.read_shift(r),o=e.read_shift(r),d=e.read_shift(r),u=e.read_shift(2);r==2&&(e.l+=2);var x={s,e:l,w:o,ixfe:d,flags:u};return(a.biff>=5||!a.biff)&&(x.level=u>>8&7),x}function LP(e,n){var a=Te(12);a.write_shift(2,n),a.write_shift(2,n),a.write_shift(2,e.width*256),a.write_shift(2,0);var r=0;return e.hidden&&(r|=1),a.write_shift(1,r),r=e.level||0,a.write_shift(1,r),a.write_shift(2,0),a}function PP(e,n){var a={};return n<32||(e.l+=16,a.header=Ca(e),a.footer=Ca(e),e.l+=2),a}function IP(e,n,a){var r={area:!1};if(a.biff!=5)return e.l+=n,r;var s=e.read_shift(1);return e.l+=3,s&16&&(r.area=!0),r}function OP(e){for(var n=Te(2*e),a=0;a<e;++a)n.write_shift(2,a+1);return n}var MP=Fs,RP=Ck,BP=Eu;function HP(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(4),s={fmt:n,env:a,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,s}function VP(e,n,a){a.biffguess&&a.biff==5&&(a.biff=2);var r=Fs(e);++e.l;var s=No(e,n-7,a);return r.t="str",r.val=s,r}function UP(e){var n=Fs(e);++e.l;var a=Ca(e);return n.t="n",n.val=a,n}function KP(e,n,a){var r=Te(15);return Lu(r,e,n),r.write_shift(8,a,"f"),r}function zP(e){var n=Fs(e);++e.l;var a=e.read_shift(2);return n.t="n",n.val=a,n}function $P(e,n,a){var r=Te(9);return Lu(r,e,n),r.write_shift(2,a),r}function GP(e){var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,"sbcs-cont")}function qP(e,n){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=n-13}function WP(e,n,a){var r=e.l+n,s=Fs(e),l=e.read_shift(2),o=uo(e,l,a);return e.l=r,s.t="str",s.val=o,s}var XP=[2,3,48,49,131,139,140,245],Op=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=dx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function a(d,u){var x=[],m=il(1);switch(u.type){case"base64":m=xr(vr(d));break;case"binary":m=xr(d);break;case"buffer":case"array":m=d;break}ha(m,0);var f=m.read_shift(1),p=!!(f&136),N=!1,y=!1;switch(f){case 2:break;case 3:break;case 48:N=!0,p=!0;break;case 49:N=!0,p=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,b=521;f==2&&(g=m.read_shift(2)),m.l+=3,f!=2&&(g=m.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(b=m.read_shift(2));var j=m.read_shift(2),T=u.codepage||1252;f!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(T=e[m[m.l]]),m.l+=1,m.l+=2),y&&(m.l+=36);for(var _=[],w={},E=Math.min(m.length,f==2?521:b-10-(N?264:0)),C=y?32:11;m.l<E&&m[m.l]!=13;)switch(w={},w.name=Jd.utils.decode(T,m.slice(m.l,m.l+C)).replace(/[\u0000\r\n].*$/g,""),m.l+=C,w.type=String.fromCharCode(m.read_shift(1)),f!=2&&!y&&(w.offset=m.read_shift(4)),w.len=m.read_shift(1),f==2&&(w.offset=m.read_shift(2)),w.dec=m.read_shift(1),w.name.length&&_.push(w),f!=2&&(m.l+=y?13:14),w.type){case"B":(!N||w.len!=8)&&u.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(m[m.l]!==13&&(m.l=b-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=b;var S=0,P=0;for(x[0]=[],P=0;P!=_.length;++P)x[0][P]=_[P].name;for(;g-- >0;){if(m[m.l]===42){m.l+=j;continue}for(++m.l,x[++S]=[],P=0,P=0;P!=_.length;++P){var F=m.slice(m.l,m.l+_[P].len);m.l+=_[P].len,ha(F,0);var B=Jd.utils.decode(T,F);switch(_[P].type){case"C":B.trim().length&&(x[S][P]=B.replace(/\s+$/,""));break;case"D":B.length===8?x[S][P]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):x[S][P]=B;break;case"F":x[S][P]=parseFloat(B.trim());break;case"+":case"I":x[S][P]=y?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":x[S][P]=!0;break;case"N":case"F":x[S][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));x[S][P]="##MEMO##"+(y?parseInt(B.trim(),10):F.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(x[S][P]=+B||0);break;case"@":x[S][P]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":x[S][P]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":x[S][P]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":x[S][P]=-F.read_shift(-8,"f");break;case"B":if(N&&_[P].len==8){x[S][P]=F.read_shift(8,"f");break}case"G":case"P":F.l+=_[P].len;break;case"0":if(_[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[P].type)}}}if(f!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return u&&u.sheetRows&&(x=x.slice(0,u.sheetRows)),u.DBF=_,x}function r(d,u){var x=u||{};x.dateNF||(x.dateNF="yyyymmdd");var m=Mc(a(d,x),x);return m["!cols"]=x.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete x.DBF,m}function s(d,u){try{return xl(r(d,u),u)}catch(x){if(u&&u.WTF)throw x}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function o(d,u){var x=u||{};if(+x.codepage>=0&&es(+x.codepage),x.type=="string")throw new Error("Cannot write DBF to JS string");var m=rr(),f=U0(d,{header:1,raw:!0,cellDates:!0}),p=f[0],N=f.slice(1),y=d["!cols"]||[],g=0,b=0,j=0,T=1;for(g=0;g<p.length;++g){if(((y[g]||{}).DBF||{}).name){p[g]=y[g].DBF.name,++j;continue}if(p[g]!=null){if(++j,typeof p[g]=="number"&&(p[g]=p[g].toString(10)),typeof p[g]!="string")throw new Error("DBF Invalid column name "+p[g]+" |"+typeof p[g]+"|");if(p.indexOf(p[g])!==g){for(b=0;b<1024;++b)if(p.indexOf(p[g]+"_"+b)==-1){p[g]+="_"+b;break}}}}var _=Pt(d["!ref"]),w=[],E=[],C=[];for(g=0;g<=_.e.c-_.s.c;++g){var S="",P="",F=0,B=[];for(b=0;b<N.length;++b)N[b][g]!=null&&B.push(N[b][g]);if(B.length==0||p[g]==null){w[g]="?";continue}for(b=0;b<B.length;++b){switch(typeof B[b]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=B[b]instanceof Date?"D":"C";break;default:P="C"}F=Math.max(F,String(B[b]).length),S=S&&S!=P?"C":P}F>250&&(F=250),P=((y[g]||{}).DBF||{}).type,P=="C"&&y[g].DBF.len>F&&(F=y[g].DBF.len),S=="B"&&P=="N"&&(S="N",C[g]=y[g].DBF.dec,F=y[g].DBF.len),E[g]=S=="C"||P=="N"?F:l[S]||0,T+=E[g],w[g]=S}var O=m.next(32);for(O.write_shift(4,318902576),O.write_shift(4,N.length),O.write_shift(2,296+32*j),O.write_shift(2,T),g=0;g<4;++g)O.write_shift(4,0);for(O.write_shift(4,0|(+n[Tw]||3)<<8),g=0,b=0;g<p.length;++g)if(p[g]!=null){var M=m.next(32),G=(p[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,G,"sbcs"),M.write_shift(1,w[g]=="?"?"C":w[g],"sbcs"),M.write_shift(4,b),M.write_shift(1,E[g]||l[w[g]]||0),M.write_shift(1,C[g]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),b+=E[g]||l[w[g]]||0}var J=m.next(264);for(J.write_shift(4,13),g=0;g<65;++g)J.write_shift(4,0);for(g=0;g<N.length;++g){var X=m.next(T);for(X.write_shift(1,0),b=0;b<p.length;++b)if(p[b]!=null)switch(w[b]){case"L":X.write_shift(1,N[g][b]==null?63:N[g][b]?84:70);break;case"B":X.write_shift(8,N[g][b]||0,"f");break;case"N":var fe="0";for(typeof N[g][b]=="number"&&(fe=N[g][b].toFixed(C[b]||0)),j=0;j<E[b]-fe.length;++j)X.write_shift(1,32);X.write_shift(1,fe,"sbcs");break;case"D":N[g][b]?(X.write_shift(4,("0000"+N[g][b].getFullYear()).slice(-4),"sbcs"),X.write_shift(2,("00"+(N[g][b].getMonth()+1)).slice(-2),"sbcs"),X.write_shift(2,("00"+N[g][b].getDate()).slice(-2),"sbcs")):X.write_shift(8,"00000000","sbcs");break;case"C":var ne=String(N[g][b]!=null?N[g][b]:"").slice(0,E[b]);for(X.write_shift(1,ne,"sbcs"),j=0;j<E[b]-ne.length;++j)X.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:s,to_sheet:r,from_sheet:o}})(),Mk=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+Tn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(p,N){var y=e[N];return typeof y=="number"?oN(y):y},r=function(p,N,y){var g=N.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return g==59?p:oN(g)};e["|"]=254;function s(p,N){switch(N.type){case"base64":return l(vr(p),N);case"binary":return l(p,N);case"buffer":return l(bt&&Buffer.isBuffer(p)?p.toString("binary"):hl(p),N);case"array":return l(oo(p),N)}throw new Error("Unrecognized type "+N.type)}function l(p,N){var y=p.split(/[\n\r]+/),g=-1,b=-1,j=0,T=0,_=[],w=[],E=null,C={},S=[],P=[],F=[],B=0,O;for(+N.codepage>=0&&es(+N.codepage);j!==y.length;++j){B=0;var M=y[j].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(n,a),G=M.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),J=G[0],X;if(M.length>0)switch(J){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":G[1].charAt(0)=="P"&&w.push(M.slice(3).replace(/;;/g,";"));break;case"C":var fe=!1,ne=!1,H=!1,W=!1,xe=-1,K=-1;for(T=1;T<G.length;++T)switch(G[T].charAt(0)){case"A":break;case"X":b=parseInt(G[T].slice(1))-1,ne=!0;break;case"Y":for(g=parseInt(G[T].slice(1))-1,ne||(b=0),O=_.length;O<=g;++O)_[O]=[];break;case"K":X=G[T].slice(1),X.charAt(0)==='"'?X=X.slice(1,X.length-1):X==="TRUE"?X=!0:X==="FALSE"?X=!1:isNaN(rs(X))?isNaN(Sc(X).getDate())||(X=dn(X)):(X=rs(X),E!==null&&Ic(E)&&(X=hx(X))),fe=!0;break;case"E":W=!0;var L=oc(G[T].slice(1),{r:g,c:b});_[g][b]=[_[g][b],L];break;case"S":H=!0,_[g][b]=[_[g][b],"S5S"];break;case"G":break;case"R":xe=parseInt(G[T].slice(1))-1;break;case"C":K=parseInt(G[T].slice(1))-1;break;default:if(N&&N.WTF)throw new Error("SYLK bad record "+M)}if(fe&&(_[g][b]&&_[g][b].length==2?_[g][b][0]=X:_[g][b]=X,E=null),H){if(W)throw new Error("SYLK shared formula cannot have own formula");var Q=xe>-1&&_[xe][K];if(!Q||!Q[1])throw new Error("SYLK shared formula cannot find base");_[g][b][1]=tT(Q[1],{r:g-xe,c:b-K})}break;case"F":var I=0;for(T=1;T<G.length;++T)switch(G[T].charAt(0)){case"X":b=parseInt(G[T].slice(1))-1,++I;break;case"Y":for(g=parseInt(G[T].slice(1))-1,O=_.length;O<=g;++O)_[O]=[];break;case"M":B=parseInt(G[T].slice(1))/20;break;case"F":break;case"G":break;case"P":E=w[parseInt(G[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=G[T].slice(1).split(" "),O=parseInt(F[0],10);O<=parseInt(F[1],10);++O)B=parseInt(F[2],10),P[O-1]=B===0?{hidden:!0}:{wch:B},ll(P[O-1]);break;case"C":b=parseInt(G[T].slice(1))-1,P[b]||(P[b]={});break;case"R":g=parseInt(G[T].slice(1))-1,S[g]||(S[g]={}),B>0?(S[g].hpt=B,S[g].hpx=Ec(B)):B===0&&(S[g].hidden=!0);break;default:if(N&&N.WTF)throw new Error("SYLK bad record "+M)}I<1&&(E=null);break;default:if(N&&N.WTF)throw new Error("SYLK bad record "+M)}}return S.length>0&&(C["!rows"]=S),P.length>0&&(C["!cols"]=P),N&&N.sheetRows&&(_=_.slice(0,N.sheetRows)),[_,C]}function o(p,N){var y=s(p,N),g=y[0],b=y[1],j=Mc(g,N);return Tn(b).forEach(function(T){j[T]=b[T]}),j}function d(p,N){return xl(o(p,N),N)}function u(p,N,y,g){var b="C;Y"+(y+1)+";X"+(g+1)+";K";switch(p.t){case"n":b+=p.v||0,p.f&&!p.F&&(b+=";E"+Xg(p.f,{r:y,c:g}));break;case"b":b+=p.v?"TRUE":"FALSE";break;case"e":b+=p.w||p.v;break;case"d":b+='"'+(p.w||p.v)+'"';break;case"s":b+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function x(p,N){N.forEach(function(y,g){var b="F;W"+(g+1)+" "+(g+1)+" ";y.hidden?b+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=iu(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=lu(y.wpx)),typeof y.wch=="number"&&(b+=Math.round(y.wch))),b.charAt(b.length-1)!=" "&&p.push(b)})}function m(p,N){N.forEach(function(y,g){var b="F;";y.hidden?b+="M0;":y.hpt?b+="M"+20*y.hpt+";":y.hpx&&(b+="M"+20*ou(y.hpx)+";"),b.length>2&&p.push(b+"R"+(g+1))})}function f(p,N){var y=["ID;PWXL;N;E"],g=[],b=Pt(p["!ref"]),j,T=Array.isArray(p),_=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),p["!cols"]&&x(y,p["!cols"]),p["!rows"]&&m(y,p["!rows"]),y.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var w=b.s.r;w<=b.e.r;++w)for(var E=b.s.c;E<=b.e.c;++E){var C=dt({r:w,c:E});j=T?(p[w]||[])[E]:p[C],!(!j||j.v==null&&(!j.f||j.F))&&g.push(u(j,p,w,E))}return y.join(_)+_+g.join(_)+_+"E"+_}return{to_workbook:d,to_sheet:o,from_sheet:f}})(),Rk=(function(){function e(l,o){switch(o.type){case"base64":return n(vr(l),o);case"binary":return n(l,o);case"buffer":return n(bt&&Buffer.isBuffer(l)?l.toString("binary"):hl(l),o);case"array":return n(oo(l),o)}throw new Error("Unrecognized type "+o.type)}function n(l,o){for(var d=l.split(`
`),u=-1,x=-1,m=0,f=[];m!==d.length;++m){if(d[m].trim()==="BOT"){f[++u]=[],x=0;continue}if(!(u<0)){var p=d[m].trim().split(","),N=p[0],y=p[1];++m;for(var g=d[m]||"";(g.match(/["]/g)||[]).length&1&&m<d.length-1;)g+=`
`+d[++m];switch(g=g.trim(),+N){case-1:if(g==="BOT"){f[++u]=[],x=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?f[u][x]=!0:g==="FALSE"?f[u][x]=!1:isNaN(rs(y))?isNaN(Sc(y).getDate())?f[u][x]=y:f[u][x]=dn(y):f[u][x]=rs(y),++x;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),f[u][x++]=g!==""?g:null;break}if(g==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function a(l,o){return Mc(e(l,o),o)}function r(l,o){return xl(a(l,o),o)}var s=(function(){var l=function(u,x,m,f,p){u.push(x),u.push(m+","+f),u.push('"'+p.replace(/"/g,'""')+'"')},o=function(u,x,m,f){u.push(x+","+m),u.push(x==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(u){var x=[],m=Pt(u["!ref"]),f,p=Array.isArray(u);l(x,"TABLE",0,1,"sheetjs"),l(x,"VECTORS",0,m.e.r-m.s.r+1,""),l(x,"TUPLES",0,m.e.c-m.s.c+1,""),l(x,"DATA",0,0,"");for(var N=m.s.r;N<=m.e.r;++N){o(x,-1,0,"BOT");for(var y=m.s.c;y<=m.e.c;++y){var g=dt({r:N,c:y});if(f=p?(u[N]||[])[y]:u[g],!f){o(x,1,0,"");continue}switch(f.t){case"n":var b=f.w;!b&&f.v!=null&&(b=f.v),b==null?f.f&&!f.F?o(x,1,0,"="+f.f):o(x,1,0,""):o(x,0,b,"V");break;case"b":o(x,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(x,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Hr(f.z||ct[14],Wn(dn(f.v)))),o(x,0,f.w,"V");break;default:o(x,1,0,"")}}}o(x,-1,0,"EOD");var j=`\r
`,T=x.join(j);return T}})();return{to_workbook:r,to_sheet:a,from_sheet:s}})(),Bk=(function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function a(f,p){for(var N=f.split(`
`),y=-1,g=-1,b=0,j=[];b!==N.length;++b){var T=N[b].trim().split(":");if(T[0]==="cell"){var _=vn(T[1]);if(j.length<=_.r)for(y=j.length;y<=_.r;++y)j[y]||(j[y]=[]);switch(y=_.r,g=_.c,T[2]){case"t":j[y][g]=e(T[3]);break;case"v":j[y][g]=+T[3];break;case"vtf":var w=T[T.length-1];case"vtc":switch(T[3]){case"nl":j[y][g]=!!+T[4];break;default:j[y][g]=+T[4];break}T[2]=="vtf"&&(j[y][g]=[j[y][g],w])}}}return p&&p.sheetRows&&(j=j.slice(0,p.sheetRows)),j}function r(f,p){return Mc(a(f,p),p)}function s(f,p){return xl(r(f,p),p)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,d=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function x(f){if(!f||!f["!ref"])return"";for(var p=[],N=[],y,g="",b=sr(f["!ref"]),j=Array.isArray(f),T=b.s.r;T<=b.e.r;++T)for(var _=b.s.c;_<=b.e.c;++_)if(g=dt({r:T,c:_}),y=j?(f[T]||[])[_]:f[g],!(!y||y.v==null||y.t==="z")){switch(N=["cell",g,"t"],y.t){case"s":case"str":N.push(n(y.v));break;case"n":y.f?(N[2]="vtf",N[3]="n",N[4]=y.v,N[5]=n(y.f)):(N[2]="v",N[3]=y.v);break;case"b":N[2]="vt"+(y.f?"f":"c"),N[3]="nl",N[4]=y.v?"1":"0",N[5]=n(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var w=Wn(dn(y.v));N[2]="vtc",N[3]="nd",N[4]=""+w,N[5]=y.w||Hr(y.z||ct[14],w);break;case"e":continue}p.push(N.join(":"))}return p.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function m(f){return[l,o,d,o,x(f),u].join(`
`)}return{to_workbook:s,to_sheet:r,from_sheet:m}})(),_c=(function(){function e(m,f,p,N,y){y.raw?f[p][N]=m:m===""||(m==="TRUE"?f[p][N]=!0:m==="FALSE"?f[p][N]=!1:isNaN(rs(m))?isNaN(Sc(m).getDate())?f[p][N]=m:f[p][N]=dn(m):f[p][N]=rs(m))}function n(m,f){var p=f||{},N=[];if(!m||m.length===0)return N;for(var y=m.split(/[\r\n]/),g=y.length-1;g>=0&&y[g].length===0;)--g;for(var b=10,j=0,T=0;T<=g;++T)j=y[T].indexOf(" "),j==-1?j=y[T].length:j++,b=Math.max(b,j);for(T=0;T<=g;++T){N[T]=[];var _=0;for(e(y[T].slice(0,b).trim(),N,T,_,p),_=1;_<=(y[T].length-b)/10+1;++_)e(y[T].slice(b+(_-1)*10,b+_*10).trim(),N,T,_,p)}return p.sheetRows&&(N=N.slice(0,p.sheetRows)),N}var a={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function s(m){for(var f={},p=!1,N=0,y=0;N<m.length;++N)(y=m.charCodeAt(N))==34?p=!p:!p&&y in a&&(f[y]=(f[y]||0)+1);y=[];for(N in f)Object.prototype.hasOwnProperty.call(f,N)&&y.push([f[N],N]);if(!y.length){f=r;for(N in f)Object.prototype.hasOwnProperty.call(f,N)&&y.push([f[N],N])}return y.sort(function(g,b){return g[0]-b[0]||r[g[1]]-r[b[1]]}),a[y.pop()[1]]||44}function l(m,f){var p=f||{},N="",y=p.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(N=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(N=m.charAt(4),m=m.slice(6)):N=s(m.slice(0,1024)):p&&p.FS?N=p.FS:N=s(m.slice(0,1024));var b=0,j=0,T=0,_=0,w=0,E=N.charCodeAt(0),C=!1,S=0,P=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var F=p.dateNF!=null?IF(p.dateNF):null;function B(){var O=m.slice(_,w),M={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)M.t="z";else if(p.raw)M.t="s",M.v=O;else if(O.trim().length===0)M.t="s",M.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(M.t="s",M.v=O.slice(2,-1).replace(/""/g,'"')):dM(O)?(M.t="n",M.f=O.slice(1)):(M.t="s",M.v=O);else if(O=="TRUE")M.t="b",M.v=!0;else if(O=="FALSE")M.t="b",M.v=!1;else if(!isNaN(T=rs(O)))M.t="n",p.cellText!==!1&&(M.w=O),M.v=T;else if(!isNaN(Sc(O).getDate())||F&&O.match(F)){M.z=p.dateNF||ct[14];var G=0;F&&O.match(F)&&(O=OF(O,p.dateNF,O.match(F)||[]),G=1),p.cellDates?(M.t="d",M.v=dn(O,G)):(M.t="n",M.v=Wn(dn(O,G))),p.cellText!==!1&&(M.w=Hr(M.z,M.v instanceof Date?Wn(M.v):M.v)),p.cellNF||delete M.z}else M.t="s",M.v=O;if(M.t=="z"||(p.dense?(y[b]||(y[b]=[]),y[b][j]=M):y[dt({c:j,r:b})]=M),_=w+1,P=m.charCodeAt(_),g.e.c<j&&(g.e.c=j),g.e.r<b&&(g.e.r=b),S==E)++j;else if(j=0,++b,p.sheetRows&&p.sheetRows<=b)return!0}e:for(;w<m.length;++w)switch(S=m.charCodeAt(w)){case 34:P===34&&(C=!C);break;case E:case 10:case 13:if(!C&&B())break e;break}return w-_>0&&B(),y["!ref"]=gt(g),y}function o(m,f){return!(f&&f.PRN)||f.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?l(m,f):Mc(n(m,f),f)}function d(m,f){var p="",N=f.type=="string"?[0,0,0,0]:ry(m,f);switch(f.type){case"base64":p=vr(m);break;case"binary":p=m;break;case"buffer":f.codepage==65001?p=m.toString("utf8"):f.codepage&&typeof Jd<"u"||(p=bt&&Buffer.isBuffer(m)?m.toString("binary"):hl(m));break;case"array":p=oo(m);break;case"string":p=m;break;default:throw new Error("Unrecognized type "+f.type)}return N[0]==239&&N[1]==187&&N[2]==191?p=Xt(p.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?p=Xt(p):f.type=="binary"&&typeof Jd<"u",p.slice(0,19)=="socialcalc:version:"?Bk.to_sheet(f.type=="string"?p:Xt(p),f):o(p,f)}function u(m,f){return xl(d(m,f),f)}function x(m){for(var f=[],p=Pt(m["!ref"]),N,y=Array.isArray(m),g=p.s.r;g<=p.e.r;++g){for(var b=[],j=p.s.c;j<=p.e.c;++j){var T=dt({r:g,c:j});if(N=y?(m[g]||[])[j]:m[T],!N||N.v==null){b.push("          ");continue}for(var _=(N.w||(ci(N),N.w)||"").slice(0,10);_.length<10;)_+=" ";b.push(_+(j===0?" ":""))}f.push(b.join(""))}return f.join(`
`)}return{to_workbook:u,to_sheet:d,from_sheet:x}})();function QP(e,n){var a=n||{},r=!!a.WTF;a.WTF=!0;try{var s=Mk.to_workbook(e,a);return a.WTF=r,s}catch(l){if(a.WTF=r,!l.message.match(/SYLK bad record ID/)&&r)throw l;return _c.to_workbook(e,n)}}var to=(function(){function e(L,Q,I){if(L){ha(L,L.l||0);for(var R=I.Enum||xe;L.l<L.length;){var te=L.read_shift(2),ue=R[te]||R[65535],V=L.read_shift(2),le=L.l+V,q=ue.f&&ue.f(L,V,I);if(L.l=le,Q(q,ue,te))return}}}function n(L,Q){switch(Q.type){case"base64":return a(xr(vr(L)),Q);case"binary":return a(xr(L),Q);case"buffer":case"array":return a(L,Q)}throw"Unsupported type "+Q.type}function a(L,Q){if(!L)return L;var I=Q||{},R=I.dense?[]:{},te="Sheet1",ue="",V=0,le={},q=[],Le=[],ee={s:{r:0,c:0},e:{r:0,c:0}},ke=I.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)I.Enum=xe,e(L,function(Oe,Rt,hn){switch(hn){case 0:I.vers=Oe,Oe>=4096&&(I.qpro=!0);break;case 6:ee=Oe;break;case 204:Oe&&(ue=Oe);break;case 222:ue=Oe;break;case 15:case 51:I.qpro||(Oe[1].v=Oe[1].v.slice(1));case 13:case 14:case 16:hn==14&&(Oe[2]&112)==112&&(Oe[2]&15)>1&&(Oe[2]&15)<15&&(Oe[1].z=I.dateNF||ct[14],I.cellDates&&(Oe[1].t="d",Oe[1].v=hx(Oe[1].v))),I.qpro&&Oe[3]>V&&(R["!ref"]=gt(ee),le[te]=R,q.push(te),R=I.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},V=Oe[3],te=ue||"Sheet"+(V+1),ue="");var xn=I.dense?(R[Oe[0].r]||[])[Oe[0].c]:R[dt(Oe[0])];if(xn){xn.t=Oe[1].t,xn.v=Oe[1].v,Oe[1].z!=null&&(xn.z=Oe[1].z),Oe[1].f!=null&&(xn.f=Oe[1].f);break}I.dense?(R[Oe[0].r]||(R[Oe[0].r]=[]),R[Oe[0].r][Oe[0].c]=Oe[1]):R[dt(Oe[0])]=Oe[1];break}},I);else if(L[2]==26||L[2]==14)I.Enum=K,L[2]==14&&(I.qpro=!0,L.l=0),e(L,function(Oe,Rt,hn){switch(hn){case 204:te=Oe;break;case 22:Oe[1].v=Oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Oe[3]>V&&(R["!ref"]=gt(ee),le[te]=R,q.push(te),R=I.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},V=Oe[3],te="Sheet"+(V+1)),ke>0&&Oe[0].r>=ke)break;I.dense?(R[Oe[0].r]||(R[Oe[0].r]=[]),R[Oe[0].r][Oe[0].c]=Oe[1]):R[dt(Oe[0])]=Oe[1],ee.e.c<Oe[0].c&&(ee.e.c=Oe[0].c),ee.e.r<Oe[0].r&&(ee.e.r=Oe[0].r);break;case 27:Oe[14e3]&&(Le[Oe[14e3][0]]=Oe[14e3][1]);break;case 1537:Le[Oe[0]]=Oe[1],Oe[0]==V&&(te=Oe[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(R["!ref"]=gt(ee),le[ue||te]=R,q.push(ue||te),!Le.length)return{SheetNames:q,Sheets:le};for(var Ke={},tt=[],Xe=0;Xe<Le.length;++Xe)le[q[Xe]]?(tt.push(Le[Xe]||q[Xe]),Ke[Le[Xe]]=le[Le[Xe]]||le[q[Xe]]):(tt.push(Le[Xe]),Ke[Le[Xe]]={"!ref":"A1"});return{SheetNames:tt,Sheets:Ke}}function r(L,Q){var I=Q||{};if(+I.codepage>=0&&es(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var R=rr(),te=Pt(L["!ref"]),ue=Array.isArray(L),V=[];Ue(R,0,l(1030)),Ue(R,6,u(te));for(var le=Math.min(te.e.r,8191),q=te.s.r;q<=le;++q)for(var Le=Ln(q),ee=te.s.c;ee<=te.e.c;++ee){q===te.s.r&&(V[ee]=yn(ee));var ke=V[ee]+Le,Ke=ue?(L[q]||[])[ee]:L[ke];if(!(!Ke||Ke.t=="z"))if(Ke.t=="n")(Ke.v|0)==Ke.v&&Ke.v>=-32768&&Ke.v<=32767?Ue(R,13,N(q,ee,Ke.v)):Ue(R,14,g(q,ee,Ke.v));else{var tt=ci(Ke);Ue(R,15,f(q,ee,tt.slice(0,239)))}}return Ue(R,1),R.end()}function s(L,Q){var I=Q||{};if(+I.codepage>=0&&es(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var R=rr();Ue(R,0,o(L));for(var te=0,ue=0;te<L.SheetNames.length;++te)(L.Sheets[L.SheetNames[te]]||{})["!ref"]&&Ue(R,27,W(L.SheetNames[te],ue++));var V=0;for(te=0;te<L.SheetNames.length;++te){var le=L.Sheets[L.SheetNames[te]];if(!(!le||!le["!ref"])){for(var q=Pt(le["!ref"]),Le=Array.isArray(le),ee=[],ke=Math.min(q.e.r,8191),Ke=q.s.r;Ke<=ke;++Ke)for(var tt=Ln(Ke),Xe=q.s.c;Xe<=q.e.c;++Xe){Ke===q.s.r&&(ee[Xe]=yn(Xe));var Oe=ee[Xe]+tt,Rt=Le?(le[Ke]||[])[Xe]:le[Oe];if(!(!Rt||Rt.t=="z"))if(Rt.t=="n")Ue(R,23,B(Ke,Xe,V,Rt.v));else{var hn=ci(Rt);Ue(R,22,S(Ke,Xe,V,hn.slice(0,239)))}}++V}}return Ue(R,1),R.end()}function l(L){var Q=Te(2);return Q.write_shift(2,L),Q}function o(L){var Q=Te(26);Q.write_shift(2,4096),Q.write_shift(2,4),Q.write_shift(4,0);for(var I=0,R=0,te=0,ue=0;ue<L.SheetNames.length;++ue){var V=L.SheetNames[ue],le=L.Sheets[V];if(!(!le||!le["!ref"])){++te;var q=sr(le["!ref"]);I<q.e.r&&(I=q.e.r),R<q.e.c&&(R=q.e.c)}}return I>8191&&(I=8191),Q.write_shift(2,I),Q.write_shift(1,te),Q.write_shift(1,R),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(1,1),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(4,0),Q}function d(L,Q,I){var R={s:{c:0,r:0},e:{c:0,r:0}};return Q==8&&I.qpro?(R.s.c=L.read_shift(1),L.l++,R.s.r=L.read_shift(2),R.e.c=L.read_shift(1),L.l++,R.e.r=L.read_shift(2),R):(R.s.c=L.read_shift(2),R.s.r=L.read_shift(2),Q==12&&I.qpro&&(L.l+=2),R.e.c=L.read_shift(2),R.e.r=L.read_shift(2),Q==12&&I.qpro&&(L.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function u(L){var Q=Te(8);return Q.write_shift(2,L.s.c),Q.write_shift(2,L.s.r),Q.write_shift(2,L.e.c),Q.write_shift(2,L.e.r),Q}function x(L,Q,I){var R=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(R[0].c=L.read_shift(1),R[3]=L.read_shift(1),R[0].r=L.read_shift(2),L.l+=2):(R[2]=L.read_shift(1),R[0].c=L.read_shift(2),R[0].r=L.read_shift(2)),R}function m(L,Q,I){var R=L.l+Q,te=x(L,Q,I);if(te[1].t="s",I.vers==20768){L.l++;var ue=L.read_shift(1);return te[1].v=L.read_shift(ue,"utf8"),te}return I.qpro&&L.l++,te[1].v=L.read_shift(R-L.l,"cstr"),te}function f(L,Q,I){var R=Te(7+I.length);R.write_shift(1,255),R.write_shift(2,Q),R.write_shift(2,L),R.write_shift(1,39);for(var te=0;te<R.length;++te){var ue=I.charCodeAt(te);R.write_shift(1,ue>=128?95:ue)}return R.write_shift(1,0),R}function p(L,Q,I){var R=x(L,Q,I);return R[1].v=L.read_shift(2,"i"),R}function N(L,Q,I){var R=Te(7);return R.write_shift(1,255),R.write_shift(2,Q),R.write_shift(2,L),R.write_shift(2,I,"i"),R}function y(L,Q,I){var R=x(L,Q,I);return R[1].v=L.read_shift(8,"f"),R}function g(L,Q,I){var R=Te(13);return R.write_shift(1,255),R.write_shift(2,Q),R.write_shift(2,L),R.write_shift(8,I,"f"),R}function b(L,Q,I){var R=L.l+Q,te=x(L,Q,I);if(te[1].v=L.read_shift(8,"f"),I.qpro)L.l=R;else{var ue=L.read_shift(2);w(L.slice(L.l,L.l+ue),te),L.l+=ue}return te}function j(L,Q,I){var R=Q&32768;return Q&=-32769,Q=(R?L:0)+(Q>=8192?Q-16384:Q),(R?"":"$")+(I?yn(Q):Ln(Q))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(L,Q){ha(L,0);for(var I=[],R=0,te="",ue="",V="",le="";L.l<L.length;){var q=L[L.l++];switch(q){case 0:I.push(L.read_shift(8,"f"));break;case 1:ue=j(Q[0].c,L.read_shift(2),!0),te=j(Q[0].r,L.read_shift(2),!1),I.push(ue+te);break;case 2:{var Le=j(Q[0].c,L.read_shift(2),!0),ee=j(Q[0].r,L.read_shift(2),!1);ue=j(Q[0].c,L.read_shift(2),!0),te=j(Q[0].r,L.read_shift(2),!1),I.push(Le+ee+":"+ue+te)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(L.read_shift(2));break;case 6:{for(var ke="";q=L[L.l++];)ke+=String.fromCharCode(q);I.push('"'+ke.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:le=I.pop(),V=I.pop(),I.push(["AND","OR"][q-20]+"("+V+","+le+")");break;default:if(q<32&&_[q])le=I.pop(),V=I.pop(),I.push(V+_[q]+le);else if(T[q]){if(R=T[q][1],R==69&&(R=L[L.l++]),R>I.length){console.error("WK1 bad formula parse 0x"+q.toString(16)+":|"+I.join("|")+"|");return}var Ke=I.slice(-R);I.length-=R,I.push(T[q][0]+"("+Ke.join(",")+")")}else return q<=7?console.error("WK1 invalid opcode "+q.toString(16)):q<=24?console.error("WK1 unsupported op "+q.toString(16)):q<=30?console.error("WK1 invalid opcode "+q.toString(16)):q<=115?console.error("WK1 unsupported function opcode "+q.toString(16)):console.error("WK1 unrecognized opcode "+q.toString(16))}}I.length==1?Q[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function E(L){var Q=[{c:0,r:0},{t:"n",v:0},0];return Q[0].r=L.read_shift(2),Q[3]=L[L.l++],Q[0].c=L[L.l++],Q}function C(L,Q){var I=E(L);return I[1].t="s",I[1].v=L.read_shift(Q-4,"cstr"),I}function S(L,Q,I,R){var te=Te(6+R.length);te.write_shift(2,L),te.write_shift(1,I),te.write_shift(1,Q),te.write_shift(1,39);for(var ue=0;ue<R.length;++ue){var V=R.charCodeAt(ue);te.write_shift(1,V>=128?95:V)}return te.write_shift(1,0),te}function P(L,Q){var I=E(L);I[1].v=L.read_shift(2);var R=I[1].v>>1;if(I[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return I[1].v=R,I}function F(L,Q){var I=E(L),R=L.read_shift(4),te=L.read_shift(4),ue=L.read_shift(2);if(ue==65535)return R===0&&te===3221225472?(I[1].t="e",I[1].v=15):R===0&&te===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var V=ue&32768;return ue=(ue&32767)-16446,I[1].v=(1-V*2)*(te*Math.pow(2,ue+32)+R*Math.pow(2,ue)),I}function B(L,Q,I,R){var te=Te(14);if(te.write_shift(2,L),te.write_shift(1,I),te.write_shift(1,Q),R==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var ue=0,V=0,le=0,q=0;return R<0&&(ue=1,R=-R),V=Math.log2(R)|0,R/=Math.pow(2,V-31),q=R>>>0,(q&2147483648)==0&&(R/=2,++V,q=R>>>0),R-=q,q|=2147483648,q>>>=0,R*=Math.pow(2,32),le=R>>>0,te.write_shift(4,le),te.write_shift(4,q),V+=16383+(ue?32768:0),te.write_shift(2,V),te}function O(L,Q){var I=F(L);return L.l+=Q-14,I}function M(L,Q){var I=E(L),R=L.read_shift(4);return I[1].v=R>>6,I}function G(L,Q){var I=E(L),R=L.read_shift(8,"f");return I[1].v=R,I}function J(L,Q){var I=G(L);return L.l+=Q-10,I}function X(L,Q){return L[L.l+Q-1]==0?L.read_shift(Q,"cstr"):""}function fe(L,Q){var I=L[L.l++];I>Q-1&&(I=Q-1);for(var R="";R.length<I;)R+=String.fromCharCode(L[L.l++]);return R}function ne(L,Q,I){if(!(!I.qpro||Q<21)){var R=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var te=L.read_shift(Q-21,"cstr");return[R,te]}}function H(L,Q){for(var I={},R=L.l+Q;L.l<R;){var te=L.read_shift(2);if(te==14e3){for(I[te]=[0,""],I[te][0]=L.read_shift(2);L[L.l];)I[te][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return I}function W(L,Q){var I=Te(5+L.length);I.write_shift(2,14e3),I.write_shift(2,Q);for(var R=0;R<L.length;++R){var te=L.charCodeAt(R);I[I.l++]=te>127?95:te}return I[I.l++]=0,I}var xe={0:{n:"BOF",f:Rn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:X},222:{n:"SHEETNAMELP",f:fe},65535:{n:""}},K={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:C},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:H},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:G},40:{n:"FORMULA28",f:J},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:X},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:s,to_workbook:n}})();function YP(e){var n={},a=e.match(Ea),r=0,s=!1;if(a)for(;r!=a.length;++r){var l=ut(a[r]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;n.cp=bg[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=l.val;break;case"<sz":n.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":l.rgb&&(n.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(l[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+l[0])}}return n}var JP=(function(){var e=tu("t"),n=tu("rPr");function a(l){var o=l.match(e);if(!o)return{t:"s",v:""};var d={t:"s",v:Lt(o[1])},u=l.match(n);return u&&(d.s=YP(u[1])),d}var r=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(r,"").split(s).map(a).filter(function(d){return d.v})}})(),ZP=(function(){var n=/(\r\n|\n)/g;function a(s,l,o){var d=[];s.u&&d.push("text-decoration: underline;"),s.uval&&d.push("text-underline-style:"+s.uval+";"),s.sz&&d.push("font-size:"+s.sz+"pt;"),s.outline&&d.push("text-effect: outline;"),s.shadow&&d.push("text-shadow: auto;"),l.push('<span style="'+d.join("")+'">'),s.b&&(l.push("<b>"),o.push("</b>")),s.i&&(l.push("<i>"),o.push("</i>")),s.strike&&(l.push("<s>"),o.push("</s>"));var u=s.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(l.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),s}function r(s){var l=[[],s.v,[]];return s.v?(s.s&&a(s.s,l[0],l[2]),l[0].join("")+l[1].replace(n,"<br/>")+l[2].join("")):""}return function(l){return l.map(r).join("")}})(),eI=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,tI=/<(?:\w+:)?r>/,nI=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function zg(e,n){var a=n?n.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Lt(Xt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Xt(e),a&&(r.h=Dg(r.t))):e.match(tI)&&(r.r=Xt(e),r.t=Lt(Xt((e.replace(nI,"").match(eI)||[]).join("").replace(Ea,""))),a&&(r.h=ZP(JP(r.r)))),r):{t:""}}var aI=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,rI=/<(?:\w+:)?(?:si|sstItem)>/g,sI=/<\/(?:\w+:)?(?:si|sstItem)>/;function iI(e,n){var a=[],r="";if(!e)return a;var s=e.match(aI);if(s){r=s[2].replace(rI,"").split(sI);for(var l=0;l!=r.length;++l){var o=zg(r[l].trim(),n);o!=null&&(a[a.length]=o)}s=ut(s[1]),a.Count=s.count,a.Unique=s.uniqueCount}return a}var lI=/^\s|\s$|[\t\n\r]/;function Hk(e,n){if(!n.bookSST)return"";var a=[Pn];a[a.length]=Ve("sst",null,{xmlns:po[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(e[r]!=null){var s=e[r],l="<si>";s.r?l+=s.r:(l+="<t",s.t||(s.t=""),s.t.match(lI)&&(l+=' xml:space="preserve"'),l+=">"+qt(s.t)+"</t>"),l+="</si>",a[a.length]=l}return a.length>2&&(a[a.length]="</sst>",a[1]=a[1].replace("/>",">")),a.join("")}function oI(e){return[e.read_shift(4),e.read_shift(4)]}function cI(e,n){var a=[],r=!1;return hi(e,function(l,o,d){switch(d){case 159:a.Count=l[0],a.Unique=l[1];break;case 19:a.push(l);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(o.T,!r||n.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}function dI(e,n){return n||(n=Te(8)),n.write_shift(4,e.Count),n.write_shift(4,e.Unique),n}var uI=N8;function hI(e){var n=rr();_e(n,159,dI(e));for(var a=0;a<e.length;++a)_e(n,19,uI(e[a]));return _e(n,160),n.end()}function Vk(e){for(var n=[],a=e.split(""),r=0;r<a.length;++r)n[r]=a[r].charCodeAt(0);return n}function si(e,n){var a={};return a.Major=e.read_shift(2),a.Minor=e.read_shift(2),n>=4&&(e.l+=n-4),a}function xI(e){var n={};return n.id=e.read_shift(0,"lpp4"),n.R=si(e,4),n.U=si(e,4),n.W=si(e,4),n}function mI(e){for(var n=e.read_shift(4),a=e.l+n-4,r={},s=e.read_shift(4),l=[];s-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=l,e.l!=a)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+a);return r}function fI(e){var n=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)n.push(mI(e));return n}function pI(e){var n=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)n.push(e.read_shift(0,"lpp4"));return n}function gI(e){var n={};return e.read_shift(4),e.l+=4,n.id=e.read_shift(0,"lpp4"),n.name=e.read_shift(0,"lpp4"),n.R=si(e,4),n.U=si(e,4),n.W=si(e,4),n}function yI(e){var n=gI(e);if(n.ename=e.read_shift(0,"8lpp4"),n.blksz=e.read_shift(4),n.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function Uk(e,n){var a=e.l+n,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var s=!1;switch(r.AlgID){case 26126:case 26127:case 26128:s=r.Flags==36;break;case 26625:s=r.Flags==4;break;case 0:s=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(a-e.l>>1,"utf16le"),e.l=a,r}function Kk(e,n){var a={},r=e.l+n;return e.l+=4,a.Salt=e.slice(e.l,e.l+16),e.l+=16,a.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),a.VerifierHash=e.slice(e.l,r),e.l=r,a}function vI(e){var n=si(e);switch(n.Minor){case 2:return[n.Minor,bI(e)];case 3:return[n.Minor,NI()];case 4:return[n.Minor,jI(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function bI(e){var n=e.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var a=e.read_shift(4),r=Uk(e,a),s=Kk(e,e.length-e.l);return{t:"Std",h:r,v:s}}function NI(){throw new Error("File is password-protected: ECMA-376 Extensible")}function jI(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var a=e.read_shift(e.length-e.l,"utf8"),r={};return a.replace(Ea,function(l){var o=ut(l);switch(As(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(d){r[d]=o[d]});break;case"<dataIntegrity":r.encryptedHmacKey=o.encryptedHmacKey,r.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(o);break;default:throw o[0]}}),r}function wI(e,n){var a={},r=a.EncryptionVersionInfo=si(e,4);if(n-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);a.Flags=e.read_shift(4),n-=4;var s=e.read_shift(4);return n-=4,a.EncryptionHeader=Uk(e,s),n-=s,a.EncryptionVerifier=Kk(e,n),a}function kI(e){var n={},a=n.EncryptionVersionInfo=si(e,4);if(a.Major!=1||a.Minor!=1)throw"unrecognized version code "+a.Major+" : "+a.Minor;return n.Salt=e.read_shift(16),n.EncryptedVerifier=e.read_shift(16),n.EncryptedVerifierHash=e.read_shift(16),n}function $g(e){var n=0,a,r=Vk(e),s=r.length+1,l,o,d,u,x;for(a=il(s),a[0]=r.length,l=1;l!=s;++l)a[l]=r[l-1];for(l=s-1;l>=0;--l)o=a[l],d=(n&16384)===0?0:1,u=n<<1&32767,x=d|u,n=x^o;return n^52811}var zk=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],a=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(o){return(o/2|o*128)&255},s=function(o,d){return r(o^d)},l=function(o){for(var d=n[o.length-1],u=104,x=o.length-1;x>=0;--x)for(var m=o[x],f=0;f!=7;++f)m&64&&(d^=a[u]),m*=2,--u;return d};return function(o){for(var d=Vk(o),u=l(d),x=d.length,m=il(16),f=0;f!=16;++f)m[f]=0;var p,N,y;for((x&1)===1&&(p=u>>8,m[x]=s(e[0],p),--x,p=u&255,N=d[d.length-1],m[x]=s(N,p));x>0;)--x,p=u>>8,m[x]=s(d[x],p),--x,p=u&255,m[x]=s(d[x],p);for(x=15,y=15-d.length;y>0;)p=u>>8,m[x]=s(e[y],p),--x,--y,p=u&255,m[x]=s(d[x],p),--x,--y;return m}})(),TI=function(e,n,a,r,s){s||(s=n),r||(r=zk(e));var l,o;for(l=0;l!=n.length;++l)o=n[l],o^=r[a],o=(o>>5|o<<3)&255,s[l]=o,++a;return[s,a,r]},CI=function(e){var n=0,a=zk(e);return function(r){var s=TI("",r,n,a);return n=s[1],s[0]}};function SI(e,n,a,r){var s={key:Rn(e),verificationBytes:Rn(e)};return a.password&&(s.verifier=$g(a.password)),r.valid=s.verificationBytes===s.verifier,r.valid&&(r.insitu=CI(a.password)),s}function _I(e,n,a){var r=a||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=kI(e):r.Data=wI(e,n),r}function EI(e,n,a){var r={Type:a.biff>=8?e.read_shift(2):0};return r.Type?_I(e,n-2,r):SI(e,a.biff>=8?n:n-2,a,r),r}var $k=(function(){function e(s,l){switch(l.type){case"base64":return n(vr(s),l);case"binary":return n(s,l);case"buffer":return n(bt&&Buffer.isBuffer(s)?s.toString("binary"):hl(s),l);case"array":return n(oo(s),l)}throw new Error("Unrecognized type "+l.type)}function n(s,l){var o=l||{},d=o.dense?[]:{},u=s.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var x={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(m,f){Array.isArray(d)&&(d[f]=[]);for(var p=/\\\w+\b/g,N=0,y,g=-1;y=p.exec(m);){switch(y[0]){case"\\cell":var b=m.slice(N,p.lastIndex-y[0].length);if(b[0]==" "&&(b=b.slice(1)),++g,b.length){var j={v:b,t:"s"};Array.isArray(d)?d[f][g]=j:d[dt({r:f,c:g})]=j}break}N=p.lastIndex}g>x.e.c&&(x.e.c=g)}),d["!ref"]=gt(x),d}function a(s,l){return xl(e(s,l),l)}function r(s){for(var l=["{\\rtf1\\ansi"],o=Pt(s["!ref"]),d,u=Array.isArray(s),x=o.s.r;x<=o.e.r;++x){l.push("\\trowd\\trautofit1");for(var m=o.s.c;m<=o.e.c;++m)l.push("\\cellx"+(m+1));for(l.push("\\pard\\intbl"),m=o.s.c;m<=o.e.c;++m){var f=dt({r:x,c:m});d=u?(s[x]||[])[m]:s[f],!(!d||d.v==null&&(!d.f||d.F))&&(l.push(" "+(d.w||(ci(d),d.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:a,to_sheet:e,from_sheet:r}})();function DI(e){var n=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function su(e){for(var n=0,a=1;n!=3;++n)a=a*256+(e[n]>255?255:e[n]<0?0:e[n]);return a.toString(16).toUpperCase().slice(1)}function AI(e){var n=e[0]/255,a=e[1]/255,r=e[2]/255,s=Math.max(n,a,r),l=Math.min(n,a,r),o=s-l;if(o===0)return[0,0,n];var d=0,u=0,x=s+l;switch(u=o/(x>1?2-x:x),s){case n:d=((a-r)/o+6)%6;break;case a:d=(r-n)/o+2;break;case r:d=(n-a)/o+4;break}return[d/6,u,x/2]}function FI(e){var n=e[0],a=e[1],r=e[2],s=a*2*(r<.5?r:1-r),l=r-s/2,o=[l,l,l],d=6*n,u;if(a!==0)switch(d|0){case 0:case 6:u=s*d,o[0]+=s,o[1]+=u;break;case 1:u=s*(2-d),o[0]+=u,o[1]+=s;break;case 2:u=s*(d-2),o[1]+=s,o[2]+=u;break;case 3:u=s*(4-d),o[1]+=u,o[2]+=s;break;case 4:u=s*(d-4),o[2]+=s,o[0]+=u;break;case 5:u=s*(6-d),o[2]+=u,o[0]+=s;break}for(var x=0;x!=3;++x)o[x]=Math.round(o[x]*255);return o}function B0(e,n){if(n===0)return e;var a=AI(DI(e));return n<0?a[2]=a[2]*(1+n):a[2]=1-(1-a[2])*(1-n),su(FI(a))}var Gk=6,LI=15,PI=1,ka=Gk;function iu(e){return Math.floor((e+Math.round(128/ka)/256)*ka)}function lu(e){return Math.floor((e-5)/ka*100+.5)/100}function H0(e){return Math.round((e*ka+5)/ka*256)/256}function Lf(e){return H0(lu(iu(e)))}function Gg(e){var n=Math.abs(e-Lf(e)),a=ka;if(n>.005)for(ka=PI;ka<LI;++ka)Math.abs(e-Lf(e))<=n&&(n=Math.abs(e-Lf(e)),a=ka);ka=a}function ll(e){e.width?(e.wpx=iu(e.width),e.wch=lu(e.wpx),e.MDW=ka):e.wpx?(e.wch=lu(e.wpx),e.width=H0(e.wch),e.MDW=ka):typeof e.wch=="number"&&(e.width=H0(e.wch),e.wpx=iu(e.width),e.MDW=ka),e.customWidth&&delete e.customWidth}var II=96,qk=II;function ou(e){return e*96/qk}function Ec(e){return e*qk/96}var OI={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function MI(e,n,a,r){n.Borders=[];var s={},l=!1;(e[0].match(Ea)||[]).forEach(function(o){var d=ut(o);switch(As(d[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},d.diagonalUp&&(s.diagonalUp=on(d.diagonalUp)),d.diagonalDown&&(s.diagonalDown=on(d.diagonalDown)),n.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+d[0]+" in borders")}})}function RI(e,n,a,r){n.Fills=[];var s={},l=!1;(e[0].match(Ea)||[]).forEach(function(o){var d=ut(o);switch(As(d[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},n.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":d.patternType&&(s.patternType=d.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),d.indexed&&(s.bgColor.indexed=parseInt(d.indexed,10)),d.theme&&(s.bgColor.theme=parseInt(d.theme,10)),d.tint&&(s.bgColor.tint=parseFloat(d.tint)),d.rgb&&(s.bgColor.rgb=d.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),d.theme&&(s.fgColor.theme=parseInt(d.theme,10)),d.tint&&(s.fgColor.tint=parseFloat(d.tint)),d.rgb!=null&&(s.fgColor.rgb=d.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+d[0]+" in fills")}})}function BI(e,n,a,r){n.Fonts=[];var s={},l=!1;(e[0].match(Ea)||[]).forEach(function(o){var d=ut(o);switch(As(d[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(s),s={};break;case"<name":d.val&&(s.name=Xt(d.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=d.val?on(d.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=d.val?on(d.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(d.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=d.val?on(d.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=d.val?on(d.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=d.val?on(d.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=d.val?on(d.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=d.val?on(d.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":d.val&&(s.sz=+d.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":d.val&&(s.vertAlign=d.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":d.val&&(s.family=parseInt(d.val,10));break;case"<family/>":case"</family>":break;case"<scheme":d.val&&(s.scheme=d.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(d.val=="1")break;d.codepage=bg[parseInt(d.val,10)];break;case"<color":if(s.color||(s.color={}),d.auto&&(s.color.auto=on(d.auto)),d.rgb)s.color.rgb=d.rgb.slice(-6);else if(d.indexed){s.color.index=parseInt(d.indexed,10);var u=Zl[s.color.index];s.color.index==81&&(u=Zl[1]),u||(u=Zl[1]),s.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else d.theme&&(s.color.theme=parseInt(d.theme,10),d.tint&&(s.color.tint=parseFloat(d.tint)),d.theme&&a.themeElements&&a.themeElements.clrScheme&&(s.color.rgb=B0(a.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+d[0]+" in fonts")}})}function HI(e,n,a){n.NumberFmt=[];for(var r=Tn(ct),s=0;s<r.length;++s)n.NumberFmt[r[s]]=ct[r[s]];var l=e[0].match(Ea);if(l)for(s=0;s<l.length;++s){var o=ut(l[s]);switch(As(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var d=Lt(Xt(o.formatCode)),u=parseInt(o.numFmtId,10);if(n.NumberFmt[u]=d,u>0){if(u>392){for(u=392;u>60&&n.NumberFmt[u]!=null;--u);n.NumberFmt[u]=d}ri(d,u)}}break;case"</numFmt>":break;default:if(a.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function VI(e){var n=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var r=a[0];r<=a[1];++r)e[r]!=null&&(n[n.length]=Ve("numFmt",null,{numFmtId:r,formatCode:qt(e[r])}))}),n.length===1?"":(n[n.length]="</numFmts>",n[0]=Ve("numFmts",null,{count:n.length-2}).replace("/>",">"),n.join(""))}var r0=["numFmtId","fillId","fontId","borderId","xfId"],s0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function UI(e,n,a){n.CellXf=[];var r,s=!1;(e[0].match(Ea)||[]).forEach(function(l){var o=ut(l),d=0;switch(As(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=o,delete r[0],d=0;d<r0.length;++d)r[r0[d]]&&(r[r0[d]]=parseInt(r[r0[d]],10));for(d=0;d<s0.length;++d)r[s0[d]]&&(r[s0[d]]=on(r[s0[d]]));if(n.NumberFmt&&r.numFmtId>392){for(d=392;d>60;--d)if(n.NumberFmt[r.numFmtId]==n.NumberFmt[d]){r.numFmtId=d;break}}n.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=on(o.wrapText)),r.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function KI(e){var n=[];return n[n.length]=Ve("cellXfs",null),e.forEach(function(a){n[n.length]=Ve("xf",null,a)}),n[n.length]="</cellXfs>",n.length===2?"":(n[0]=Ve("cellXfs",null,{count:n.length-2}).replace("/>",">"),n.join(""))}var zI=(function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,a=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(d,u,x){var m={};if(!d)return m;d=d.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=d.match(n))&&HI(f,m,x),(f=d.match(s))&&BI(f,m,u,x),(f=d.match(r))&&RI(f,m,u,x),(f=d.match(l))&&MI(f,m,u,x),(f=d.match(a))&&UI(f,m,x),m}})();function Wk(e,n){var a=[Pn,Ve("styleSheet",null,{xmlns:po[0],"xmlns:vt":$n.vt})],r;return e.SSF&&(r=VI(e.SSF))!=null&&(a[a.length]=r),a[a.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',a[a.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',a[a.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',a[a.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=KI(n.cellXfs))&&(a[a.length]=r),a[a.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',a[a.length]='<dxfs count="0"/>',a[a.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',a.length>2&&(a[a.length]="</styleSheet>",a[1]=a[1].replace("/>",">")),a.join("")}function $I(e,n){var a=e.read_shift(2),r=Sa(e);return[a,r]}function GI(e,n,a){a||(a=Te(6+4*n.length)),a.write_shift(2,e),ra(n,a);var r=a.length>a.l?a.slice(0,a.l):a;return a.l==null&&(a.l=a.length),r}function qI(e,n,a){var r={};r.sz=e.read_shift(2)/20;var s=_8(e);s.fItalic&&(r.italic=1),s.fCondense&&(r.condense=1),s.fExtend&&(r.extend=1),s.fShadow&&(r.shadow=1),s.fOutline&&(r.outline=1),s.fStrikeout&&(r.strike=1);var l=e.read_shift(2);switch(l===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(r.underline=o);var d=e.read_shift(1);d>0&&(r.family=d);var u=e.read_shift(1);switch(u>0&&(r.charset=u),e.l++,r.color=S8(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Sa(e),r}function WI(e,n){n||(n=Te(153)),n.write_shift(2,e.sz*20),E8(e,n),n.write_shift(2,e.bold?700:400);var a=0;e.vertAlign=="superscript"?a=1:e.vertAlign=="subscript"&&(a=2),n.write_shift(2,a),n.write_shift(1,e.underline||0),n.write_shift(1,e.family||0),n.write_shift(1,e.charset||0),n.write_shift(1,0),O0(e.color,n);var r=0;return r=2,n.write_shift(1,r),ra(e.name,n),n.length>n.l?n.slice(0,n.l):n}var XI=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Pf,QI=_a;function JN(e,n){n||(n=Te(84)),Pf||(Pf=dx(XI));var a=Pf[e.patternType];a==null&&(a=40),n.write_shift(4,a);var r=0;if(a!=40)for(O0({auto:1},n),O0({auto:1},n);r<12;++r)n.write_shift(4,0);else{for(;r<4;++r)n.write_shift(4,0);for(;r<12;++r)n.write_shift(4,0)}return n.length>n.l?n.slice(0,n.l):n}function YI(e,n){var a=e.l+n,r=e.read_shift(2),s=e.read_shift(2);return e.l=a,{ixfe:r,numFmtId:s}}function Xk(e,n,a){a||(a=Te(16)),a.write_shift(2,n||0),a.write_shift(2,e.numFmtId||0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(1,0),a.write_shift(1,0);var r=0;return a.write_shift(1,r),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(1,0),a}function Sd(e,n){return n||(n=Te(10)),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(4,0),n}var JI=_a;function ZI(e,n){return n||(n=Te(51)),n.write_shift(1,0),Sd(null,n),Sd(null,n),Sd(null,n),Sd(null,n),Sd(null,n),n.length>n.l?n.slice(0,n.l):n}function eO(e,n){return n||(n=Te(52)),n.write_shift(4,e.xfId),n.write_shift(2,1),n.write_shift(1,0),n.write_shift(1,0),I0(e.name||"",n),n.length>n.l?n.slice(0,n.l):n}function tO(e,n,a){var r=Te(2052);return r.write_shift(4,e),I0(n,r),I0(a,r),r.length>r.l?r.slice(0,r.l):r}function nO(e,n,a){var r={};r.NumberFmt=[];for(var s in ct)r.NumberFmt[s]=ct[s];r.CellXf=[],r.Fonts=[];var l=[],o=!1;return hi(e,function(u,x,m){switch(m){case 44:r.NumberFmt[u[0]]=u[1],ri(u[1],u[0]);break;case 43:r.Fonts.push(u),u.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(u.color.rgb=B0(n.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&r.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:l.push(m),o=!0;break;case 38:l.pop(),o=!1;break;default:if(x.T>0)l.push(m);else if(x.T<0)l.pop();else if(!o||a.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),r}function aO(e,n){if(n){var a=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)n[s]!=null&&++a}),a!=0&&(_e(e,615,ss(a)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)n[s]!=null&&_e(e,44,GI(s,n[s]))}),_e(e,616))}}function rO(e){var n=1;_e(e,611,ss(n)),_e(e,43,WI({sz:12,color:{theme:1},name:"Calibri",family:2})),_e(e,612)}function sO(e){var n=2;_e(e,603,ss(n)),_e(e,45,JN({patternType:"none"})),_e(e,45,JN({patternType:"gray125"})),_e(e,604)}function iO(e){var n=1;_e(e,613,ss(n)),_e(e,46,ZI()),_e(e,614)}function lO(e){var n=1;_e(e,626,ss(n)),_e(e,47,Xk({numFmtId:0},65535)),_e(e,627)}function oO(e,n){_e(e,617,ss(n.length)),n.forEach(function(a){_e(e,47,Xk(a,0))}),_e(e,618)}function cO(e){var n=1;_e(e,619,ss(n)),_e(e,48,eO({xfId:0,name:"Normal"})),_e(e,620)}function dO(e){var n=0;_e(e,505,ss(n)),_e(e,506)}function uO(e){var n=0;_e(e,508,tO(n,"TableStyleMedium9","PivotStyleMedium4")),_e(e,509)}function hO(e,n){var a=rr();return _e(a,278),aO(a,e.SSF),rO(a),sO(a),iO(a),lO(a),oO(a,n.cellXfs),cO(a),dO(a),uO(a),_e(a,279),a.end()}var xO=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function mO(e,n,a){n.themeElements.clrScheme=[];var r={};(e[0].match(Ea)||[]).forEach(function(s){var l=ut(s);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=l.val;break;case"<a:sysClr":r.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(n.themeElements.clrScheme[xO.indexOf(l[0])]=r,r={}):r.name=l[0].slice(3,l[0].length-1);break;default:if(a&&a.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function fO(){}function pO(){}var gO=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,yO=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,vO=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function bO(e,n,a){n.themeElements={};var r;[["clrScheme",gO,mO],["fontScheme",yO,fO],["fmtScheme",vO,pO]].forEach(function(s){if(!(r=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](r,n,a)})}var NO=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Qk(e,n){(!e||e.length===0)&&(e=qg());var a,r={};if(!(a=e.match(NO)))throw new Error("themeElements not found in theme");return bO(a[0],r,n),r.raw=e,r}function qg(e,n){if(n&&n.themeXLSX)return n.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var a=[Pn];return a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join("")}function jO(e,n,a){var r=e.l+n,s=e.read_shift(4);if(s!==124226){if(!a.cellStyles){e.l=r;return}var l=e.slice(e.l);e.l=r;var o;try{o=Uw(l,{type:"array"})}catch{return}var d=mr(o,"theme/theme/theme1.xml",!0);if(d)return Qk(d,a)}}function wO(e){return e.read_shift(4)}function kO(e){var n={};switch(n.xclrType=e.read_shift(2),n.nTintShade=e.read_shift(2),n.xclrType){case 0:e.l+=4;break;case 1:n.xclrValue=TO(e,4);break;case 2:n.xclrValue=Ek(e);break;case 3:n.xclrValue=wO(e);break;case 4:e.l+=4;break}return e.l+=8,n}function TO(e,n){return _a(e,n)}function CO(e,n){return _a(e,n)}function SO(e){var n=e.read_shift(2),a=e.read_shift(2)-4,r=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=kO(e);break;case 6:r[1]=CO(e,a);break;case 14:case 15:r[1]=e.read_shift(a===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+a)}return r}function _O(e,n){var a=e.l+n;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),l=[];s-- >0;)l.push(SO(e,a-e.l));return{ixfe:r,ext:l}}function EO(e,n){n.forEach(function(a){a[0]})}function DO(e,n){return{flags:e.read_shift(4),version:e.read_shift(4),name:Sa(e)}}function AO(e){var n=Te(12+2*e.name.length);return n.write_shift(4,e.flags),n.write_shift(4,e.version),ra(e.name,n),n.slice(0,n.l)}function FO(e){for(var n=[],a=e.read_shift(4);a-- >0;)n.push([e.read_shift(4),e.read_shift(4)]);return n}function LO(e){var n=Te(4+8*e.length);n.write_shift(4,e.length);for(var a=0;a<e.length;++a)n.write_shift(4,e[a][0]),n.write_shift(4,e[a][1]);return n}function PO(e,n){var a=Te(8+2*n.length);return a.write_shift(4,e),ra(n,a),a.slice(0,a.l)}function IO(e){return e.l+=4,e.read_shift(4)!=0}function OO(e,n){var a=Te(8);return a.write_shift(4,e),a.write_shift(4,1),a}function MO(e,n,a){var r={Types:[],Cell:[],Value:[]},s=a||{},l=[],o=!1,d=2;return hi(e,function(u,x,m){switch(m){case 335:r.Types.push({name:u.name});break;case 51:u.forEach(function(f){d==1?r.Cell.push({type:r.Types[f[0]-1].name,index:f[1]}):d==0&&r.Value.push({type:r.Types[f[0]-1].name,index:f[1]})});break;case 337:d=u?1:0;break;case 338:d=2;break;case 35:l.push(m),o=!0;break;case 36:l.pop(),o=!1;break;default:if(!x.T){if(!o||s.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),r}function RO(){var e=rr();return _e(e,332),_e(e,334,ss(1)),_e(e,335,AO({name:"XLDAPR",version:12e4,flags:3496657072})),_e(e,336),_e(e,339,PO(1,"XLDAPR")),_e(e,52),_e(e,35,ss(514)),_e(e,4096,ss(0)),_e(e,4097,Pr(1)),_e(e,36),_e(e,53),_e(e,340),_e(e,337,OO(1)),_e(e,51,LO([[1,0]])),_e(e,338),_e(e,333),e.end()}function BO(e,n,a){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var s=!1,l=2,o;return e.replace(Ea,function(d){var u=ut(d);switch(As(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var x=0;x<r.Types.length;++x)r.Types[x].name==u.name&&(o=r.Types[x]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?r.Cell.push({type:r.Types[u.t-1].name,index:+u.v}):l==0&&r.Value.push({type:r.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!s&&a.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return d}),r}function Yk(){var e=[Pn];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function HO(e){var n=[];if(!e)return n;var a=1;return(e.match(Ea)||[]).forEach(function(r){var s=ut(r);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?a=s.i:s.i=a,n.push(s);break}}),n}function VO(e){var n={};n.i=e.read_shift(4);var a={};a.r=e.read_shift(4),a.c=e.read_shift(4),n.r=dt(a);var r=e.read_shift(1);return r&2&&(n.l="1"),r&8&&(n.a="1"),n}function UO(e,n,a){var r=[];return hi(e,function(l,o,d){switch(d){case 63:r.push(l);break;default:if(!o.T)throw new Error("Unexpected record 0x"+d.toString(16))}}),r}function KO(e,n,a,r){if(!e)return e;var s=r||{},l=!1;hi(e,function(d,u,x){switch(x){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!u.T){if(!l||s.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}},s)}function zO(e,n){if(!e)return"??";var a=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][a].Target}var sc=1024;function Jk(e,n){for(var a=[21600,21600],r=["m0,0l0",a[1],a[0],a[1],a[0],"0xe"].join(","),s=[Ve("xml",null,{"xmlns:v":ur.v,"xmlns:o":ur.o,"xmlns:x":ur.x,"xmlns:mv":ur.mv}).replace(/\/>/,">"),Ve("o:shapelayout",Ve("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ve("v:shapetype",[Ve("v:stroke",null,{joinstyle:"miter"}),Ve("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:a.join(","),path:r})];sc<e*1e3;)sc+=1e3;return n.forEach(function(l){var o=vn(l[0]),d={color2:"#BEFF82",type:"gradient"};d.type=="gradient"&&(d.angle="-180");var u=d.type=="gradient"?Ve("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,x=Ve("v:fill",u,d),m={on:"t",obscured:"t"};++sc,s=s.concat(["<v:shape"+nu({id:"_x0000_s"+sc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",x,Ve("v:shadow",null,m),Ve("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",fa("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),fa("x:AutoFill","False"),fa("x:Row",String(o.r)),fa("x:Column",String(o.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function ZN(e,n,a,r){var s=Array.isArray(e),l;n.forEach(function(o){var d=vn(o.ref);if(s?(e[d.r]||(e[d.r]=[]),l=e[d.r][d.c]):l=e[o.ref],!l){l={t:"z"},s?e[d.r][d.c]=l:e[o.ref]=l;var u=Pt(e["!ref"]||"BDWGO1000001:A1");u.s.r>d.r&&(u.s.r=d.r),u.e.r<d.r&&(u.e.r=d.r),u.s.c>d.c&&(u.s.c=d.c),u.e.c<d.c&&(u.e.c=d.c);var x=gt(u);x!==e["!ref"]&&(e["!ref"]=x)}l.c||(l.c=[]);var m={a:o.author,t:o.t,r:o.r,T:a};o.h&&(m.h=o.h);for(var f=l.c.length-1;f>=0;--f){if(!a&&l.c[f].T)return;a&&!l.c[f].T&&l.c.splice(f,1)}if(a&&r){for(f=0;f<r.length;++f)if(m.a==r[f].id){m.a=r[f].name||m.a;break}}l.c.push(m)})}function $O(e,n){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var a=[],r=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var d=o.match(/<(?:\w+:)?author[^>]*>(.*)/);d&&a.push(d[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var d=o.match(/<(?:\w+:)?comment[^>]*>/);if(d){var u=ut(d[0]),x={author:u.authorId&&a[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},m=vn(u.ref);if(!(n.sheetRows&&n.sheetRows<=m.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!f&&!!f[1]&&zg(f[1])||{r:"",t:"",h:""};x.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),x.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(x.h=p.h),r.push(x)}}}}),r}function Zk(e){var n=[Pn,Ve("comments",null,{xmlns:po[0]})],a=[];return n.push("<authors>"),e.forEach(function(r){r[1].forEach(function(s){var l=qt(s.a);a.indexOf(l)==-1&&(a.push(l),n.push("<author>"+l+"</author>")),s.T&&s.ID&&a.indexOf("tc="+s.ID)==-1&&(a.push("tc="+s.ID),n.push("<author>tc="+s.ID+"</author>"))})}),a.length==0&&(a.push("SheetJ5"),n.push("<author>SheetJ5</author>")),n.push("</authors>"),n.push("<commentList>"),e.forEach(function(r){var s=0,l=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?s=a.indexOf("tc="+r[1][0].ID):r[1].forEach(function(u){u.a&&(s=a.indexOf(qt(u.a))),l.push(u.t||"")}),n.push('<comment ref="'+r[0]+'" authorId="'+s+'"><text>'),l.length<=1)n.push(fa("t",qt(l[0]||"")));else{for(var o=`Comment:
    `+l[0]+`
`,d=1;d<l.length;++d)o+=`Reply:
    `+l[d]+`
`;n.push(fa("t",qt(o)))}n.push("</text></comment>")}),n.push("</commentList>"),n.length>2&&(n[n.length]="</comments>",n[1]=n[1].replace("/>",">")),n.join("")}function GO(e,n){var a=[],r=!1,s={},l=0;return e.replace(Ea,function(d,u){var x=ut(d);switch(As(x[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:x.personId,guid:x.id,ref:x.ref,T:1};break;case"</threadedComment>":s.t!=null&&a.push(s);break;case"<text>":case"<text":l=u+d.length;break;case"</text>":s.t=e.slice(l,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+x[0]+" in threaded comments")}return d}),a}function qO(e,n,a){var r=[Pn,Ve("ThreadedComments",null,{xmlns:$n.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var l="";(s[1]||[]).forEach(function(o,d){if(!o.T){delete o.ID;return}o.a&&n.indexOf(o.a)==-1&&n.push(o.a);var u={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+a.tcid++).slice(-12)+"}"};d==0?l=u.id:u.parentId=l,o.ID=u.id,o.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+n.indexOf(o.a)).slice(-12)+"}"),r.push(Ve("threadedComment",fa("text",o.t||""),u))})}),r.push("</ThreadedComments>"),r.join("")}function WO(e,n){var a=[],r=!1;return e.replace(Ea,function(l){var o=ut(l);switch(As(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":a.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return l}),a}function XO(e){var n=[Pn,Ve("personList",null,{xmlns:$n.TCMNT,"xmlns:x":po[0]}).replace(/[\/]>/,">")];return e.forEach(function(a,r){n.push(Ve("person",null,{displayName:a,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:a,providerId:"None"}))}),n.push("</personList>"),n.join("")}function QO(e){var n={};n.iauthor=e.read_shift(4);var a=bo(e);return n.rfx=a.s,n.ref=dt(a.s),e.l+=16,n}function YO(e,n){return n==null&&(n=Te(36)),n.write_shift(4,e[1].iauthor),Rc(e[0],n),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n}var JO=Sa;function ZO(e){return ra(e.slice(0,54))}function eM(e,n){var a=[],r=[],s={},l=!1;return hi(e,function(d,u,x){switch(x){case 632:r.push(d);break;case 635:s=d;break;case 637:s.t=d.t,s.h=d.h,s.r=d.r;break;case 636:if(s.author=r[s.iauthor],delete s.iauthor,n.sheetRows&&s.rfx&&n.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,a.push(s);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!l||n.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}),a}function tM(e){var n=rr(),a=[];return _e(n,628),_e(n,630),e.forEach(function(r){r[1].forEach(function(s){a.indexOf(s.a)>-1||(a.push(s.a.slice(0,54)),_e(n,632,ZO(s.a)))})}),_e(n,631),_e(n,633),e.forEach(function(r){r[1].forEach(function(s){s.iauthor=a.indexOf(s.a);var l={s:vn(r[0]),e:vn(r[0])};_e(n,635,YO([l,s])),s.t&&s.t.length>0&&_e(n,637,w8(s)),_e(n,636),delete s.iauthor})}),_e(n,634),_e(n,629),n.end()}var nM="application/vnd.ms-office.vbaProject";function aM(e){var n=rt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(a,r){if(!(a.slice(-1)==="/"||!a.match(/_VBA_PROJECT_CUR/))){var s=a.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");rt.utils.cfb_add(n,s,e.FileIndex[r].content)}}),rt.write(n)}function rM(e,n){n.FullPaths.forEach(function(a,r){if(r!=0){var s=a.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&rt.utils.cfb_add(e,s,n.FileIndex[r].content)}})}var eT=["xlsb","xlsm","xlam","biff8","xla"];function sM(){return{"!type":"dialog"}}function iM(){return{"!type":"dialog"}}function lM(){return{"!type":"macro"}}function oM(){return{"!type":"macro"}}var oc=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function a(r,s,l,o){var d=!1,u=!1;l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1)),o.length==0?d=!0:o.charAt(0)=="["&&(d=!0,o=o.slice(1,-1));var x=l.length>0?parseInt(l,10)|0:0,m=o.length>0?parseInt(o,10)|0:0;return d?m+=n.c:--m,u?x+=n.r:--x,s+(d?"":"$")+yn(m)+(u?"":"$")+Ln(x)}return function(s,l){return n=l,s.replace(e,a)}})(),Wg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Xg=(function(){return function(n,a){return n.replace(Wg,function(r,s,l,o,d,u){var x=Ig(o)-(l?0:a.c),m=Pg(u)-(d?0:a.r),f=m==0?"":d?m+1:"["+m+"]",p=x==0?"":l?x+1:"["+x+"]";return s+"R"+f+"C"+p})}})();function tT(e,n){return e.replace(Wg,function(a,r,s,l,o,d){return r+(s=="$"?s+l:yn(Ig(l)+n.c))+(o=="$"?o+d:Ln(Pg(d)+n.r))})}function cM(e,n,a){var r=sr(n),s=r.s,l=vn(a),o={r:l.r-s.r,c:l.c-s.c};return tT(e,o)}function dM(e){return e.length!=1}function e2(e){return e.replace(/_xlfn\./g,"")}function On(e){e.l+=1}function ol(e,n){var a=e.read_shift(2);return[a&16383,a>>14&1,a>>15&1]}function nT(e,n,a){var r=2;if(a){if(a.biff>=2&&a.biff<=5)return aT(e);a.biff==12&&(r=4)}var s=e.read_shift(r),l=e.read_shift(r),o=ol(e),d=ol(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:l,c:d[0],cRel:d[1],rRel:d[2]}}}function aT(e){var n=ol(e),a=ol(e),r=e.read_shift(1),s=e.read_shift(1);return{s:{r:n[0],c:r,cRel:n[1],rRel:n[2]},e:{r:a[0],c:s,cRel:a[1],rRel:a[2]}}}function uM(e,n,a){if(a.biff<8)return aT(e);var r=e.read_shift(a.biff==12?4:2),s=e.read_shift(a.biff==12?4:2),l=ol(e),o=ol(e);return{s:{r,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function rT(e,n,a){if(a&&a.biff>=2&&a.biff<=5)return hM(e);var r=e.read_shift(a&&a.biff==12?4:2),s=ol(e);return{r,c:s[0],cRel:s[1],rRel:s[2]}}function hM(e){var n=ol(e),a=e.read_shift(1);return{r:n[0],c:a,cRel:n[1],rRel:n[2]}}function xM(e){var n=e.read_shift(2),a=e.read_shift(2);return{r:n,c:a&255,fQuoted:!!(a&16384),cRel:a>>15,rRel:a>>15}}function mM(e,n,a){var r=a&&a.biff?a.biff:8;if(r>=2&&r<=5)return fM(e);var s=e.read_shift(r>=12?4:2),l=e.read_shift(2),o=(l&16384)>>14,d=(l&32768)>>15;if(l&=16383,d==1)for(;s>524287;)s-=1048576;if(o==1)for(;l>8191;)l=l-16384;return{r:s,c:l,cRel:o,rRel:d}}function fM(e){var n=e.read_shift(2),a=e.read_shift(1),r=(n&32768)>>15,s=(n&16384)>>14;return n&=16383,r==1&&n>=8192&&(n=n-16384),s==1&&a>=128&&(a=a-256),{r:n,c:a,cRel:s,rRel:r}}function pM(e,n,a){var r=(e[e.l++]&96)>>5,s=nT(e,a.biff>=2&&a.biff<=5?6:8,a);return[r,s]}function gM(e,n,a){var r=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),l=8;if(a)switch(a.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var o=nT(e,l,a);return[r,s,o]}function yM(e,n,a){var r=(e[e.l++]&96)>>5;return e.l+=a&&a.biff>8?12:a.biff<8?6:8,[r]}function vM(e,n,a){var r=(e[e.l++]&96)>>5,s=e.read_shift(2),l=8;if(a)switch(a.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[r,s]}function bM(e,n,a){var r=(e[e.l++]&96)>>5,s=uM(e,n-1,a);return[r,s]}function NM(e,n,a){var r=(e[e.l++]&96)>>5;return e.l+=a.biff==2?6:a.biff==12?14:7,[r]}function t2(e){var n=e[e.l+1]&1,a=1;return e.l+=4,[n,a]}function jM(e,n,a){e.l+=2;for(var r=e.read_shift(a&&a.biff==2?1:2),s=[],l=0;l<=r;++l)s.push(e.read_shift(a&&a.biff==2?1:2));return s}function wM(e,n,a){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(a&&a.biff==2?1:2)]}function kM(e,n,a){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(a&&a.biff==2?1:2)]}function TM(e){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(2)]}function CM(e,n,a){var r=e[e.l+1]&255?1:0;return e.l+=a&&a.biff==2?3:4,[r]}function sT(e){var n=e.read_shift(1),a=e.read_shift(1);return[n,a]}function SM(e){return e.read_shift(2),sT(e)}function _M(e){return e.read_shift(2),sT(e)}function EM(e,n,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=rT(e,0,a);return[r,s]}function DM(e,n,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=mM(e,0,a);return[r,s]}function AM(e,n,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);a&&a.biff==5&&(e.l+=12);var l=rT(e,0,a);return[r,s,l]}function FM(e,n,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(a&&a.biff<=3?1:2);return[I7[s],oT[s],r]}function LM(e,n,a){var r=e[e.l++],s=e.read_shift(1),l=a&&a.biff<=3?[r==88?-1:0,e.read_shift(1)]:PM(e);return[s,(l[0]===0?oT:P7)[l[1]]]}function PM(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function IM(e,n,a){e.l+=a&&a.biff==2?3:4}function OM(e,n,a){if(e.l++,a&&a.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),s=e.read_shift(a&&a.biff==2?1:2);return[r,s]}function MM(e){return e.l++,xi[e.read_shift(1)]}function RM(e){return e.l++,e.read_shift(2)}function BM(e){return e.l++,e.read_shift(1)!==0}function HM(e){return e.l++,Ca(e)}function VM(e,n,a){return e.l++,_u(e,n-1,a)}function UM(e,n){var a=[e.read_shift(1)];if(n==12)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2;break}switch(a[0]){case 4:a[1]=Dn(e,1)?"TRUE":"FALSE",n!=12&&(e.l+=7);break;case 37:case 16:a[1]=xi[e[e.l]],e.l+=n==12?4:8;break;case 0:e.l+=8;break;case 1:a[1]=Ca(e);break;case 2:a[1]=No(e,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function KM(e,n,a){for(var r=e.read_shift(a.biff==12?4:2),s=[],l=0;l!=r;++l)s.push((a.biff==12?bo:xx)(e));return s}function zM(e,n,a){var r=0,s=0;a.biff==12?(r=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),r=1+e.read_shift(2)),a.biff>=2&&a.biff<8&&(--r,--s==0&&(s=256));for(var l=0,o=[];l!=r&&(o[l]=[]);++l)for(var d=0;d!=s;++d)o[l][d]=UM(e,a.biff);return o}function $M(e,n,a){var r=e.read_shift(1)>>>5&3,s=!a||a.biff>=8?4:2,l=e.read_shift(s);switch(a.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,l]}function GM(e,n,a){if(a.biff==5)return qM(e);var r=e.read_shift(1)>>>5&3,s=e.read_shift(2),l=e.read_shift(4);return[r,s,l]}function qM(e){var n=e.read_shift(1)>>>5&3,a=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[n,a,r]}function WM(e,n,a){var r=e.read_shift(1)>>>5&3;e.l+=a&&a.biff==2?3:4;var s=e.read_shift(a&&a.biff==2?1:2);return[r,s]}function XM(e,n,a){var r=e.read_shift(1)>>>5&3,s=e.read_shift(a&&a.biff==2?1:2);return[r,s]}function QM(e,n,a){var r=e.read_shift(1)>>>5&3;return e.l+=4,a.biff<8&&e.l--,a.biff==12&&(e.l+=2),[r]}function YM(e,n,a){var r=(e[e.l++]&96)>>5,s=e.read_shift(2),l=4;if(a)switch(a.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[r,s]}var JM=_a,ZM=_a,e7=_a;function Du(e,n,a){return e.l+=2,[xM(e)]}function Qg(e){return e.l+=6,[]}var t7=Du,n7=Qg,a7=Qg,r7=Du;function iT(e){return e.l+=2,[Rn(e),e.read_shift(2)&1]}var s7=Du,i7=iT,l7=Qg,o7=Du,c7=Du,d7=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function u7(e){e.l+=2;var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(4),s=e.read_shift(2),l=e.read_shift(2),o=d7[a>>2&31];return{ixti:n,coltype:a&3,rt:o,idx:r,c:s,C:l}}function h7(e){return e.l+=2,[e.read_shift(4)]}function x7(e,n,a){return e.l+=5,e.l+=2,e.l+=a.biff==2?1:4,["PTGSHEET"]}function m7(e,n,a){return e.l+=a.biff==2?4:5,["PTGENDSHEET"]}function f7(e){var n=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[n,a]}function p7(e){var n=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[n,a]}function g7(e){return e.l+=4,[0,0]}var n2={1:{n:"PtgExp",f:OM},2:{n:"PtgTbl",f:e7},3:{n:"PtgAdd",f:On},4:{n:"PtgSub",f:On},5:{n:"PtgMul",f:On},6:{n:"PtgDiv",f:On},7:{n:"PtgPower",f:On},8:{n:"PtgConcat",f:On},9:{n:"PtgLt",f:On},10:{n:"PtgLe",f:On},11:{n:"PtgEq",f:On},12:{n:"PtgGe",f:On},13:{n:"PtgGt",f:On},14:{n:"PtgNe",f:On},15:{n:"PtgIsect",f:On},16:{n:"PtgUnion",f:On},17:{n:"PtgRange",f:On},18:{n:"PtgUplus",f:On},19:{n:"PtgUminus",f:On},20:{n:"PtgPercent",f:On},21:{n:"PtgParen",f:On},22:{n:"PtgMissArg",f:On},23:{n:"PtgStr",f:VM},26:{n:"PtgSheet",f:x7},27:{n:"PtgEndSheet",f:m7},28:{n:"PtgErr",f:MM},29:{n:"PtgBool",f:BM},30:{n:"PtgInt",f:RM},31:{n:"PtgNum",f:HM},32:{n:"PtgArray",f:NM},33:{n:"PtgFunc",f:FM},34:{n:"PtgFuncVar",f:LM},35:{n:"PtgName",f:$M},36:{n:"PtgRef",f:EM},37:{n:"PtgArea",f:pM},38:{n:"PtgMemArea",f:WM},39:{n:"PtgMemErr",f:JM},40:{n:"PtgMemNoMem",f:ZM},41:{n:"PtgMemFunc",f:XM},42:{n:"PtgRefErr",f:QM},43:{n:"PtgAreaErr",f:yM},44:{n:"PtgRefN",f:DM},45:{n:"PtgAreaN",f:bM},46:{n:"PtgMemAreaN",f:f7},47:{n:"PtgMemNoMemN",f:p7},57:{n:"PtgNameX",f:GM},58:{n:"PtgRef3d",f:AM},59:{n:"PtgArea3d",f:gM},60:{n:"PtgRefErr3d",f:YM},61:{n:"PtgAreaErr3d",f:vM},255:{}},y7={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},v7={1:{n:"PtgElfLel",f:iT},2:{n:"PtgElfRw",f:o7},3:{n:"PtgElfCol",f:t7},6:{n:"PtgElfRwV",f:c7},7:{n:"PtgElfColV",f:r7},10:{n:"PtgElfRadical",f:s7},11:{n:"PtgElfRadicalS",f:l7},13:{n:"PtgElfColS",f:n7},15:{n:"PtgElfColSV",f:a7},16:{n:"PtgElfRadicalLel",f:i7},25:{n:"PtgList",f:u7},29:{n:"PtgSxName",f:h7},255:{}},b7={0:{n:"PtgAttrNoop",f:g7},1:{n:"PtgAttrSemi",f:CM},2:{n:"PtgAttrIf",f:kM},4:{n:"PtgAttrChoose",f:jM},8:{n:"PtgAttrGoto",f:wM},16:{n:"PtgAttrSum",f:IM},32:{n:"PtgAttrBaxcel",f:t2},33:{n:"PtgAttrBaxcel",f:t2},64:{n:"PtgAttrSpace",f:SM},65:{n:"PtgAttrSpaceSemi",f:_M},128:{n:"PtgAttrIfError",f:TM},255:{}};function Au(e,n,a,r){if(r.biff<8)return _a(e,n);for(var s=e.l+n,l=[],o=0;o!==a.length;++o)switch(a[o][0]){case"PtgArray":a[o][1]=zM(e,0,r),l.push(a[o][1]);break;case"PtgMemArea":a[o][2]=KM(e,a[o][1],r),l.push(a[o][2]);break;case"PtgExp":r&&r.biff==12&&(a[o][1][1]=e.read_shift(4),l.push(a[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[o][0]}return n=s-e.l,n!==0&&l.push(_a(e,n)),l}function Fu(e,n,a){for(var r=e.l+n,s,l,o=[];r!=e.l;)n=r-e.l,l=e[e.l],s=n2[l]||n2[y7[l]],(l===24||l===25)&&(s=(l===24?v7:b7)[e[e.l+1]]),!s||!s.f?_a(e,n):o.push([s.n,s.f(e,n,a)]);return o}function N7(e){for(var n=[],a=0;a<e.length;++a){for(var r=e[a],s=[],l=0;l<r.length;++l){var o=r[l];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}n.push(s.join(","))}return n.join(";")}var j7={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function w7(e,n){if(!e&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function lT(e,n,a){if(!e)return"SH33TJSERR0";if(a.biff>8&&(!e.XTI||!e.XTI[n]))return e.SheetNames[n];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[n];if(a.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":e.XTI[n-1];if(!r)return"SH33TJSERR1";var s="";if(a.biff>8)switch(e[r[0]][0]){case 357:return s=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 358:return a.SID!=null?e.SheetNames[a.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return s=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[r[0]][0][3]?(s=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?s:s+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function a2(e,n,a){var r=lT(e,n,a);return r=="#REF"?r:w7(r,a)}function wa(e,n,a,r,s){var l=s&&s.biff||8,o={s:{c:0,r:0}},d=[],u,x,m,f=0,p=0,N,y="";if(!e[0]||!e[0][0])return"";for(var g=-1,b="",j=0,T=e[0].length;j<T;++j){var _=e[0][j];switch(_[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=d.pop(),x=d.pop(),g>=0){switch(e[0][g][1][0]){case 0:b=jn(" ",e[0][g][1][1]);break;case 1:b=jn("\r",e[0][g][1][1]);break;default:if(b="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}x=x+b,g=-1}d.push(x+j7[_[0]]+u);break;case"PtgIsect":u=d.pop(),x=d.pop(),d.push(x+" "+u);break;case"PtgUnion":u=d.pop(),x=d.pop(),d.push(x+","+u);break;case"PtgRange":u=d.pop(),x=d.pop(),d.push(x+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=Hd(_[1][1],o,s),d.push(Vd(m,l));break;case"PtgRefN":m=a?Hd(_[1][1],a,s):_[1][1],d.push(Vd(m,l));break;case"PtgRef3d":f=_[1][1],m=Hd(_[1][2],o,s),y=a2(r,f,s),d.push(y+"!"+Vd(m,l));break;case"PtgFunc":case"PtgFuncVar":var w=_[1][0],E=_[1][1];w||(w=0),w&=127;var C=w==0?[]:d.slice(-w);d.length-=w,E==="User"&&(E=C.shift()),d.push(E+"("+C.join(",")+")");break;case"PtgBool":d.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":d.push(_[1]);break;case"PtgNum":d.push(String(_[1]));break;case"PtgStr":d.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":d.push(_[1]);break;case"PtgAreaN":N=FN(_[1][1],a?{s:a}:o,s),d.push(Df(N,s));break;case"PtgArea":N=FN(_[1][1],o,s),d.push(Df(N,s));break;case"PtgArea3d":f=_[1][1],N=_[1][2],y=a2(r,f,s),d.push(y+"!"+Df(N,s));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=_[1][2];var S=(r.names||[])[p-1]||(r[0]||[])[p],P=S?S.Name:"SH33TJSNAME"+String(p);P&&P.slice(0,6)=="_xlfn."&&!s.xlfn&&(P=P.slice(6)),d.push(P);break;case"PtgNameX":var F=_[1][1];p=_[1][2];var B;if(s.biff<=5)F<0&&(F=-F),r[F]&&(B=r[F][p]);else{var O="";if(((r[F]||[])[0]||[])[0]==14849||(((r[F]||[])[0]||[])[0]==1025?r[F][p]&&r[F][p].itab>0&&(O=r.SheetNames[r[F][p].itab-1]+"!"):O=r.SheetNames[p-1]+"!"),r[F]&&r[F][p])O+=r[F][p].Name;else if(r[0]&&r[0][p])O+=r[0][p].Name;else{var M=(lT(r,F,s)||"").split(";;");M[p-1]?O=M[p-1]:O+="SH33TJSERRX"}d.push(O);break}B||(B={Name:"SH33TJSERRY"}),d.push(B.Name);break;case"PtgParen":var G="(",J=")";if(g>=0){switch(b="",e[0][g][1][0]){case 2:G=jn(" ",e[0][g][1][1])+G;break;case 3:G=jn("\r",e[0][g][1][1])+G;break;case 4:J=jn(" ",e[0][g][1][1])+J;break;case 5:J=jn("\r",e[0][g][1][1])+J;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}d.push(G+d.pop()+J);break;case"PtgRefErr":d.push("#REF!");break;case"PtgRefErr3d":d.push("#REF!");break;case"PtgExp":m={c:_[1][1],r:_[1][0]};var X={c:a.c,r:a.r};if(r.sharedf[dt(m)]){var fe=r.sharedf[dt(m)];d.push(wa(fe,o,X,r,s))}else{var ne=!1;for(u=0;u!=r.arrayf.length;++u)if(x=r.arrayf[u],!(m.c<x[0].s.c||m.c>x[0].e.c)&&!(m.r<x[0].s.r||m.r>x[0].e.r)){d.push(wa(x[1],o,X,r,s)),ne=!0;break}ne||d.push(_[1])}break;case"PtgArray":d.push("{"+N7(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=j;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":d.push("");break;case"PtgAreaErr":d.push("#REF!");break;case"PtgAreaErr3d":d.push("#REF!");break;case"PtgList":d.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var H=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&H.indexOf(e[0][j][0])==-1){_=e[0][g];var W=!0;switch(_[1][0]){case 4:W=!1;case 0:b=jn(" ",_[1][1]);break;case 5:W=!1;case 1:b=jn("\r",_[1][1]);break;default:if(b="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}d.push((W?b:"")+d.pop()+(W?"":b)),g=-1}}if(d.length>1&&s.WTF)throw new Error("bad formula stack");return d[0]}function k7(e,n,a){var r=e.l+n,s=a.biff==2?1:2,l,o=e.read_shift(s);if(o==65535)return[[],_a(e,n-2)];var d=Fu(e,o,a);return n!==o+s&&(l=Au(e,n-o-s,d,a)),e.l=r,[d,l]}function T7(e,n,a){var r=e.l+n,s=a.biff==2?1:2,l,o=e.read_shift(s);if(o==65535)return[[],_a(e,n-2)];var d=Fu(e,o,a);return n!==o+s&&(l=Au(e,n-o-s,d,a)),e.l=r,[d,l]}function C7(e,n,a,r){var s=e.l+n,l=Fu(e,r,a),o;return s!==e.l&&(o=Au(e,s-e.l,l,a)),[l,o]}function S7(e,n,a){var r=e.l+n,s,l=e.read_shift(2),o=Fu(e,l,a);return l==65535?[[],_a(e,n-2)]:(n!==l+2&&(s=Au(e,r-l-2,o,a)),[o,s])}function _7(e){var n;if(Zs(e,e.l+6)!==65535)return[Ca(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return n=e[e.l+2]===1,e.l+=8,[n,"b"];case 2:return n=e[e.l+2],e.l+=8,[n,"e"];case 3:return e.l+=8,["","s"]}return[]}function E7(e){if(e==null){var n=Te(8);return n.write_shift(1,3),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,65535),n}else if(typeof e=="number")return co(e);return co(0)}function If(e,n,a){var r=e.l+n,s=Fs(e);a.biff==2&&++e.l;var l=_7(e),o=e.read_shift(1);a.biff!=2&&(e.read_shift(1),a.biff>=5&&e.read_shift(4));var d=T7(e,r-e.l,a);return{cell:s,val:l[0],formula:d,shared:o>>3&1,tt:l[1]}}function D7(e,n,a,r,s){var l=ho(n,a,s),o=E7(e.v),d=Te(6),u=33;d.write_shift(2,u),d.write_shift(4,0);for(var x=Te(e.bf.length),m=0;m<e.bf.length;++m)x[m]=e.bf[m];var f=aa([l,o,d,x]);return f}function mx(e,n,a){var r=e.read_shift(4),s=Fu(e,r,a),l=e.read_shift(4),o=l>0?Au(e,l,s,a):null;return[s,o]}var A7=mx,fx=mx,F7=mx,L7=mx,P7={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},oT={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},I7={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function r2(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,a){return a.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function O7(e){var n="of:="+e.replace(Wg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return n.replace(/;/g,"|").replace(/,/g,";")}function Of(e){var n=e.split(":"),a=n[0].split(".")[0];return[a,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}function M7(e){return e.replace(/\./,"!")}var Kd={},cc={},zd=typeof Map<"u";function Yg(e,n,a){var r=0,s=e.length;if(a){if(zd?a.has(n):Object.prototype.hasOwnProperty.call(a,n)){for(var l=zd?a.get(n):a[n];r<l.length;++r)if(e[l[r]].t===n)return e.Count++,l[r]}}else for(;r<s;++r)if(e[r].t===n)return e.Count++,r;return e[s]={t:n},e.Count++,e.Unique++,a&&(zd?(a.has(n)||a.set(n,[]),a.get(n).push(s)):(Object.prototype.hasOwnProperty.call(a,n)||(a[n]=[]),a[n].push(s))),s}function px(e,n){var a={min:e+1,max:e+1},r=-1;return n.MDW&&(ka=n.MDW),n.width!=null?a.customWidth=1:n.wpx!=null?r=lu(n.wpx):n.wch!=null&&(r=n.wch),r>-1?(a.width=H0(r),a.customWidth=1):n.width!=null&&(a.width=n.width),n.hidden&&(a.hidden=!0),n.level!=null&&(a.outlineLevel=a.level=n.level),a}function no(e,n){if(e){var a=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(a=[1,1,1,1,.5,.5]),e.left==null&&(e.left=a[0]),e.right==null&&(e.right=a[1]),e.top==null&&(e.top=a[2]),e.bottom==null&&(e.bottom=a[3]),e.header==null&&(e.header=a[4]),e.footer==null&&(e.footer=a[5])}}function ml(e,n,a){var r=a.revssf[n.z!=null?n.z:"General"],s=60,l=e.length;if(r==null&&a.ssf){for(;s<392;++s)if(a.ssf[s]==null){ri(n.z,s),a.ssf[s]=n.z,a.revssf[n.z]=r=s;break}}for(s=0;s!=l;++s)if(e[s].numFmtId===r)return s;return e[l]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function cT(e,n,a,r,s,l){try{r.cellNF&&(e.z=ct[n])}catch(d){if(r.WTF)throw d}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=dn(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(ct[n]==null&&ri(PF[n]||"General",n),e.t==="e")e.w=e.w||xi[e.v];else if(n===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=eu(e.v);else if(e.t==="d"){var o=Wn(e.v);(o|0)===o?e.w=o.toString(10):e.w=eu(o)}else{if(e.v===void 0)return"";e.w=lo(e.v,cc)}else e.t==="d"?e.w=Hr(n,Wn(e.v),cc):e.w=Hr(n,e.v,cc)}catch(d){if(r.WTF)throw d}if(r.cellStyles&&a!=null)try{e.s=l.Fills[a],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=B0(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=B0(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(d){if(r.WTF&&l.Fills)throw d}}}function R7(e,n,a){if(e&&e["!ref"]){var r=Pt(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+a+"): "+e["!ref"])}}function B7(e,n){var a=Pt(n);a.s.r<=a.e.r&&a.s.c<=a.e.c&&a.s.r>=0&&a.s.c>=0&&(e["!ref"]=gt(a))}var H7=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,V7=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,U7=/<(?:\w:)?hyperlink [^>]*>/mg,K7=/"(\w*:\w*)"/,z7=/<(?:\w:)?col\b[^>]*[\/]?>/g,$7=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,G7=/<(?:\w:)?pageMargins[^>]*\/>/g,dT=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,q7=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,W7=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function X7(e,n,a,r,s,l,o){if(!e)return e;r||(r={"!id":{}});var d=n.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},x="",m="",f=e.match(V7);f?(x=e.slice(0,f.index),m=e.slice(f.index+f[0].length)):x=m=e;var p=x.match(dT);p?Jg(p[0],d,s,a):(p=x.match(q7))&&Y7(p[0],p[1]||"",d,s,a);var N=(x.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(N>0){var y=x.slice(N,N+50).match(K7);y&&B7(d,y[1])}var g=x.match(W7);g&&g[1]&&dR(g[1],s);var b=[];if(n.cellStyles){var j=x.match(z7);j&&sR(b,j)}f&&xR(f[1],d,n,u,l,o);var T=m.match($7);T&&(d["!autofilter"]=lR(T[0]));var _=[],w=m.match(H7);if(w)for(N=0;N!=w.length;++N)_[N]=Pt(w[N].slice(w[N].indexOf('"')+1));var E=m.match(U7);E&&nR(d,E,r);var C=m.match(G7);if(C&&(d["!margins"]=aR(ut(C[0]))),!d["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(d["!ref"]=gt(u)),n.sheetRows>0&&d["!ref"]){var S=Pt(d["!ref"]);n.sheetRows<=+S.e.r&&(S.e.r=n.sheetRows-1,S.e.r>u.e.r&&(S.e.r=u.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>u.e.c&&(S.e.c=u.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),d["!fullref"]=d["!ref"],d["!ref"]=gt(S))}return b.length>0&&(d["!cols"]=b),_.length>0&&(d["!merges"]=_),d}function Q7(e){if(e.length===0)return"";for(var n='<mergeCells count="'+e.length+'">',a=0;a!=e.length;++a)n+='<mergeCell ref="'+gt(e[a])+'"/>';return n+"</mergeCells>"}function Jg(e,n,a,r){var s=ut(e);a.Sheets[r]||(a.Sheets[r]={}),s.codeName&&(a.Sheets[r].CodeName=Lt(Xt(s.codeName)))}function Y7(e,n,a,r,s){Jg(e.slice(0,e.indexOf(">")),a,r,s)}function J7(e,n,a,r,s){var l=!1,o={},d=null;if(r.bookType!=="xlsx"&&n.vbaraw){var u=n.SheetNames[a];try{n.Workbook&&(u=n.Workbook.Sheets[a].CodeName||u)}catch{}l=!0,o.codeName=Ts(qt(u))}if(e&&e["!outline"]){var x={summaryBelow:1,summaryRight:1};e["!outline"].above&&(x.summaryBelow=0),e["!outline"].left&&(x.summaryRight=0),d=(d||"")+Ve("outlinePr",null,x)}!l&&!d||(s[s.length]=Ve("sheetPr",d,o))}var Z7=["objects","scenarios","selectLockedCells","selectUnlockedCells"],eR=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function tR(e){var n={sheet:1};return Z7.forEach(function(a){e[a]!=null&&e[a]&&(n[a]="1")}),eR.forEach(function(a){e[a]!=null&&!e[a]&&(n[a]="0")}),e.password&&(n.password=$g(e.password).toString(16).toUpperCase()),Ve("sheetProtection",null,n)}function nR(e,n,a){for(var r=Array.isArray(e),s=0;s!=n.length;++s){var l=ut(Xt(n[s]),!0);if(!l.ref)return;var o=((a||{})["!id"]||[])[l.id];o?(l.Target=o.Target,l.location&&(l.Target+="#"+Lt(l.location))):(l.Target="#"+Lt(l.location),o={Target:l.Target,TargetMode:"Internal"}),l.Rel=o,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var d=Pt(l.ref),u=d.s.r;u<=d.e.r;++u)for(var x=d.s.c;x<=d.e.c;++x){var m=dt({c:x,r:u});r?(e[u]||(e[u]=[]),e[u][x]||(e[u][x]={t:"z",v:void 0}),e[u][x].l=l):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=l)}}}function aR(e){var n={};return["left","right","top","bottom","header","footer"].forEach(function(a){e[a]&&(n[a]=parseFloat(e[a]))}),n}function rR(e){return no(e),Ve("pageMargins",null,e)}function sR(e,n){for(var a=!1,r=0;r!=n.length;++r){var s=ut(n[r],!0);s.hidden&&(s.hidden=on(s.hidden));var l=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!a&&s.width&&(a=!0,Gg(s.width)),ll(s);l<=o;)e[l++]=un(s)}}function iR(e,n){for(var a=["<cols>"],r,s=0;s!=n.length;++s)(r=n[s])&&(a[a.length]=Ve("col",null,px(s,r)));return a[a.length]="</cols>",a.join("")}function lR(e){var n={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return n}function oR(e,n,a,r){var s=typeof e.ref=="string"?e.ref:gt(e.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var l=a.Workbook.Names,o=sr(s);o.s.r==o.e.r&&(o.e.r=sr(n["!ref"]).e.r,s=gt(o));for(var d=0;d<l.length;++d){var u=l[d];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r){u.Ref="'"+a.SheetNames[r]+"'!"+s;break}}return d==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+a.SheetNames[r]+"'!"+s}),Ve("autoFilter",null,{ref:s})}var cR=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function dR(e,n){n.Views||(n.Views=[{}]),(e.match(cR)||[]).forEach(function(a,r){var s=ut(a);n.Views[r]||(n.Views[r]={}),+s.zoomScale&&(n.Views[r].zoom=+s.zoomScale),on(s.rightToLeft)&&(n.Views[r].RTL=!0)})}function uR(e,n,a,r){var s={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Ve("sheetViews",Ve("sheetView",null,s),{})}function hR(e,n,a,r){if(e.c&&a["!comments"].push([n,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",l=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=xi[e.v];break;case"d":r&&r.cellDates?s=dn(e.v,-1).toISOString():(e=un(e),e.t="n",s=""+(e.v=Wn(dn(e.v)))),typeof e.z>"u"&&(e.z=ct[14]);break;default:s=e.v;break}var d=fa("v",qt(s)),u={r:n},x=ml(r.cellXfs,e,r);switch(x!==0&&(u.s=x),e.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){d=fa("v",""+Yg(r.Strings,e.v,r.revStrings)),u.t="s";break}u.t="str";break}if(e.t!=l&&(e.t=l,e.v=o),typeof e.f=="string"&&e.f){var m=e.F&&e.F.slice(0,n.length)==n?{t:"array",ref:e.F}:null;d=Ve("f",qt(e.f),m)+(e.v!=null?d:"")}return e.l&&a["!links"].push([n,e.l]),e.D&&(u.cm=1),Ve("c",d,u)}var xR=(function(){var e=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,a=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,l=tu("v"),o=tu("f");return function(u,x,m,f,p,N){for(var y=0,g="",b=[],j=[],T=0,_=0,w=0,E="",C,S,P=0,F=0,B,O,M=0,G=0,J=Array.isArray(N.CellXf),X,fe=[],ne=[],H=Array.isArray(x),W=[],xe={},K=!1,L=!!m.sheetStubs,Q=u.split(n),I=0,R=Q.length;I!=R;++I){g=Q[I].trim();var te=g.length;if(te!==0){var ue=0;e:for(y=0;y<te;++y)switch(g[y]){case">":if(g[y-1]!="/"){++y;break e}if(m&&m.cellStyles){if(S=ut(g.slice(ue,y),!0),P=S.r!=null?parseInt(S.r,10):P+1,F=-1,m.sheetRows&&m.sheetRows<P)continue;xe={},K=!1,S.ht&&(K=!0,xe.hpt=parseFloat(S.ht),xe.hpx=Ec(xe.hpt)),S.hidden=="1"&&(K=!0,xe.hidden=!0),S.outlineLevel!=null&&(K=!0,xe.level=+S.outlineLevel),K&&(W[P-1]=xe)}break;case"<":ue=y;break}if(ue>=y)break;if(S=ut(g.slice(ue,y),!0),P=S.r!=null?parseInt(S.r,10):P+1,F=-1,!(m.sheetRows&&m.sheetRows<P)){f.s.r>P-1&&(f.s.r=P-1),f.e.r<P-1&&(f.e.r=P-1),m&&m.cellStyles&&(xe={},K=!1,S.ht&&(K=!0,xe.hpt=parseFloat(S.ht),xe.hpx=Ec(xe.hpt)),S.hidden=="1"&&(K=!0,xe.hidden=!0),S.outlineLevel!=null&&(K=!0,xe.level=+S.outlineLevel),K&&(W[P-1]=xe)),b=g.slice(y).split(e);for(var V=0;V!=b.length&&b[V].trim().charAt(0)=="<";++V);for(b=b.slice(V),y=0;y!=b.length;++y)if(g=b[y].trim(),g.length!==0){if(j=g.match(a),T=y,_=0,w=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,j!=null&&j.length===2){for(T=0,E=j[1],_=0;_!=E.length&&!((w=E.charCodeAt(_)-64)<1||w>26);++_)T=26*T+w;--T,F=T}else++F;for(_=0;_!=g.length&&g.charCodeAt(_)!==62;++_);if(++_,S=ut(g.slice(0,_),!0),S.r||(S.r=dt({r:P-1,c:F})),E=g.slice(_),C={t:""},(j=E.match(l))!=null&&j[1]!==""&&(C.v=Lt(j[1])),m.cellFormula){if((j=E.match(o))!=null&&j[1]!==""){if(C.f=Lt(Xt(j[1])).replace(/\r\n/g,`
`),m.xlfn||(C.f=e2(C.f)),j[0].indexOf('t="array"')>-1)C.F=(E.match(s)||[])[1],C.F.indexOf(":")>-1&&fe.push([Pt(C.F),C.F]);else if(j[0].indexOf('t="shared"')>-1){O=ut(j[0]);var le=Lt(Xt(j[1]));m.xlfn||(le=e2(le)),ne[parseInt(O.si,10)]=[O,le,S.r]}}else(j=E.match(/<f[^>]*\/>/))&&(O=ut(j[0]),ne[O.si]&&(C.f=cM(ne[O.si][1],ne[O.si][2],S.r)));var q=vn(S.r);for(_=0;_<fe.length;++_)q.r>=fe[_][0].s.r&&q.r<=fe[_][0].e.r&&q.c>=fe[_][0].s.c&&q.c<=fe[_][0].e.c&&(C.F=fe[_][1])}if(S.t==null&&C.v===void 0)if(C.f||C.F)C.v=0,C.t="n";else if(L)C.t="z";else continue;else C.t=S.t||"n";switch(f.s.c>F&&(f.s.c=F),f.e.c<F&&(f.e.c=F),C.t){case"n":if(C.v==""||C.v==null){if(!L)continue;C.t="z"}else C.v=parseFloat(C.v);break;case"s":if(typeof C.v>"u"){if(!L)continue;C.t="z"}else B=Kd[parseInt(C.v,10)],C.v=B.t,C.r=B.r,m.cellHTML&&(C.h=B.h);break;case"str":C.t="s",C.v=C.v!=null?Xt(C.v):"",m.cellHTML&&(C.h=Dg(C.v));break;case"inlineStr":j=E.match(r),C.t="s",j!=null&&(B=zg(j[1]))?(C.v=B.t,m.cellHTML&&(C.h=B.h)):C.v="";break;case"b":C.v=on(C.v);break;case"d":m.cellDates?C.v=dn(C.v,1):(C.v=Wn(dn(C.v,1)),C.t="n");break;case"e":(!m||m.cellText!==!1)&&(C.w=C.v),C.v=hk[C.v];break}if(M=G=0,X=null,J&&S.s!==void 0&&(X=N.CellXf[S.s],X!=null&&(X.numFmtId!=null&&(M=X.numFmtId),m.cellStyles&&X.fillId!=null&&(G=X.fillId))),cT(C,M,G,m,p,N),m.cellDates&&J&&C.t=="n"&&Ic(ct[M])&&(C.t="d",C.v=hx(C.v)),S.cm&&m.xlmeta){var Le=(m.xlmeta.Cell||[])[+S.cm-1];Le&&Le.type=="XLDAPR"&&(C.D=!0)}if(H){var ee=vn(S.r);x[ee.r]||(x[ee.r]=[]),x[ee.r][ee.c]=C}else x[S.r]=C}}}}W.length>0&&(x["!rows"]=W)}})();function mR(e,n,a,r){var s=[],l=[],o=Pt(e["!ref"]),d="",u,x="",m=[],f=0,p=0,N=e["!rows"],y=Array.isArray(e),g={r:x},b,j=-1;for(p=o.s.c;p<=o.e.c;++p)m[p]=yn(p);for(f=o.s.r;f<=o.e.r;++f){for(l=[],x=Ln(f),p=o.s.c;p<=o.e.c;++p){u=m[p]+x;var T=y?(e[f]||[])[p]:e[u];T!==void 0&&(d=hR(T,u,e,n))!=null&&l.push(d)}(l.length>0||N&&N[f])&&(g={r:x},N&&N[f]&&(b=N[f],b.hidden&&(g.hidden=1),j=-1,b.hpx?j=ou(b.hpx):b.hpt&&(j=b.hpt),j>-1&&(g.ht=j,g.customHeight=1),b.level&&(g.outlineLevel=b.level)),s[s.length]=Ve("row",l.join(""),g))}if(N)for(;f<N.length;++f)N&&N[f]&&(g={r:f+1},b=N[f],b.hidden&&(g.hidden=1),j=-1,b.hpx?j=ou(b.hpx):b.hpt&&(j=b.hpt),j>-1&&(g.ht=j,g.customHeight=1),b.level&&(g.outlineLevel=b.level),s[s.length]=Ve("row","",g));return s.join("")}function uT(e,n,a,r){var s=[Pn,Ve("worksheet",null,{xmlns:po[0],"xmlns:r":$n.r})],l=a.SheetNames[e],o=0,d="",u=a.Sheets[l];u==null&&(u={});var x=u["!ref"]||"A1",m=Pt(x);if(m.e.c>16383||m.e.r>1048575){if(n.WTF)throw new Error("Range "+x+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),x=gt(m)}r||(r={}),u["!comments"]=[];var f=[];J7(u,a,e,n,s),s[s.length]=Ve("dimension",null,{ref:x}),s[s.length]=uR(u,n,e,a),n.sheetFormat&&(s[s.length]=Ve("sheetFormatPr",null,{defaultRowHeight:n.sheetFormat.defaultRowHeight||"16",baseColWidth:n.sheetFormat.baseColWidth||"10",outlineLevelRow:n.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(s[s.length]=iR(u,u["!cols"])),s[o=s.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(d=mR(u,n),d.length>0&&(s[s.length]=d)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),u["!protect"]&&(s[s.length]=tR(u["!protect"])),u["!autofilter"]!=null&&(s[s.length]=oR(u["!autofilter"],u,a,e)),u["!merges"]!=null&&u["!merges"].length>0&&(s[s.length]=Q7(u["!merges"]));var p=-1,N,y=-1;return u["!links"].length>0&&(s[s.length]="<hyperlinks>",u["!links"].forEach(function(g){g[1].Target&&(N={ref:g[0]},g[1].Target.charAt(0)!="#"&&(y=$t(r,-1,qt(g[1].Target).replace(/#.*$/,""),wt.HLINK),N["r:id"]="rId"+y),(p=g[1].Target.indexOf("#"))>-1&&(N.location=qt(g[1].Target.slice(p+1))),g[1].Tooltip&&(N.tooltip=qt(g[1].Tooltip)),s[s.length]=Ve("hyperlink",null,N))}),s[s.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(s[s.length]=rR(u["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&(s[s.length]=fa("ignoredErrors",Ve("ignoredError",null,{numberStoredAsText:1,sqref:x}))),f.length>0&&(y=$t(r,-1,"../drawings/drawing"+(e+1)+".xml",wt.DRAW),s[s.length]=Ve("drawing",null,{"r:id":"rId"+y}),u["!drawing"]=f),u["!comments"].length>0&&(y=$t(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",wt.VML),s[s.length]=Ve("legacyDrawing",null,{"r:id":"rId"+y}),u["!legacy"]=y),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function fR(e,n){var a={},r=e.l+n;a.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=r,l&7&&(a.level=l&7),l&16&&(a.hidden=!0),l&32&&(a.hpt=s/20),a}function pR(e,n,a){var r=Te(145),s=(a["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var l=320;s.hpx?l=ou(s.hpx)*20:s.hpt&&(l=s.hpt*20),r.write_shift(2,l),r.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var d=0,u=r.l;r.l+=4;for(var x={r:e,c:0},m=0;m<16;++m)if(!(n.s.c>m+1<<10||n.e.c<m<<10)){for(var f=-1,p=-1,N=m<<10;N<m+1<<10;++N){x.c=N;var y=Array.isArray(a)?(a[x.r]||[])[x.c]:a[dt(x)];y&&(f<0&&(f=N),p=N)}f<0||(++d,r.write_shift(4,f),r.write_shift(4,p))}var g=r.l;return r.l=u,r.write_shift(4,d),r.l=g,r.length>r.l?r.slice(0,r.l):r}function gR(e,n,a,r){var s=pR(r,a,n);(s.length>17||(n["!rows"]||[])[r])&&_e(e,0,s)}var yR=bo,vR=Rc;function bR(){}function NR(e,n){var a={},r=e[e.l];return++e.l,a.above=!(r&64),a.left=!(r&128),e.l+=18,a.name=k8(e),a}function jR(e,n,a){a==null&&(a=Te(84+4*e.length));var r=192;n&&(n.above&&(r&=-65),n.left&&(r&=-129)),a.write_shift(1,r);for(var s=1;s<3;++s)a.write_shift(1,0);return O0({auto:1},a),a.write_shift(-4,-1),a.write_shift(-4,-1),lk(e,a),a.slice(0,a.l)}function wR(e){var n=Ur(e);return[n]}function kR(e,n,a){return a==null&&(a=Te(8)),go(n,a)}function TR(e){var n=yo(e);return[n]}function CR(e,n,a){return a==null&&(a=Te(4)),vo(n,a)}function SR(e){var n=Ur(e),a=e.read_shift(1);return[n,a,"b"]}function _R(e,n,a){return a==null&&(a=Te(9)),go(n,a),a.write_shift(1,e.v?1:0),a}function ER(e){var n=yo(e),a=e.read_shift(1);return[n,a,"b"]}function DR(e,n,a){return a==null&&(a=Te(5)),vo(n,a),a.write_shift(1,e.v?1:0),a}function AR(e){var n=Ur(e),a=e.read_shift(1);return[n,a,"e"]}function FR(e,n,a){return a==null&&(a=Te(9)),go(n,a),a.write_shift(1,e.v),a}function LR(e){var n=yo(e),a=e.read_shift(1);return[n,a,"e"]}function PR(e,n,a){return a==null&&(a=Te(8)),vo(n,a),a.write_shift(1,e.v),a.write_shift(2,0),a.write_shift(1,0),a}function IR(e){var n=Ur(e),a=e.read_shift(4);return[n,a,"s"]}function OR(e,n,a){return a==null&&(a=Te(12)),go(n,a),a.write_shift(4,n.v),a}function MR(e){var n=yo(e),a=e.read_shift(4);return[n,a,"s"]}function RR(e,n,a){return a==null&&(a=Te(8)),vo(n,a),a.write_shift(4,n.v),a}function BR(e){var n=Ur(e),a=Ca(e);return[n,a,"n"]}function HR(e,n,a){return a==null&&(a=Te(16)),go(n,a),co(e.v,a),a}function hT(e){var n=yo(e),a=Ca(e);return[n,a,"n"]}function VR(e,n,a){return a==null&&(a=Te(12)),vo(n,a),co(e.v,a),a}function UR(e){var n=Ur(e),a=Bg(e);return[n,a,"n"]}function KR(e,n,a){return a==null&&(a=Te(12)),go(n,a),ok(e.v,a),a}function zR(e){var n=yo(e),a=Bg(e);return[n,a,"n"]}function $R(e,n,a){return a==null&&(a=Te(8)),vo(n,a),ok(e.v,a),a}function GR(e){var n=Ur(e),a=Og(e);return[n,a,"is"]}function qR(e){var n=Ur(e),a=Sa(e);return[n,a,"str"]}function WR(e,n,a){return a==null&&(a=Te(12+4*e.v.length)),go(n,a),ra(e.v,a),a.length>a.l?a.slice(0,a.l):a}function XR(e){var n=yo(e),a=Sa(e);return[n,a,"str"]}function QR(e,n,a){return a==null&&(a=Te(8+4*e.v.length)),vo(n,a),ra(e.v,a),a.length>a.l?a.slice(0,a.l):a}function YR(e,n,a){var r=e.l+n,s=Ur(e);s.r=a["!row"];var l=e.read_shift(1),o=[s,l,"b"];if(a.cellFormula){e.l+=2;var d=fx(e,r-e.l,a);o[3]=wa(d,null,s,a.supbooks,a)}else e.l=r;return o}function JR(e,n,a){var r=e.l+n,s=Ur(e);s.r=a["!row"];var l=e.read_shift(1),o=[s,l,"e"];if(a.cellFormula){e.l+=2;var d=fx(e,r-e.l,a);o[3]=wa(d,null,s,a.supbooks,a)}else e.l=r;return o}function ZR(e,n,a){var r=e.l+n,s=Ur(e);s.r=a["!row"];var l=Ca(e),o=[s,l,"n"];if(a.cellFormula){e.l+=2;var d=fx(e,r-e.l,a);o[3]=wa(d,null,s,a.supbooks,a)}else e.l=r;return o}function eB(e,n,a){var r=e.l+n,s=Ur(e);s.r=a["!row"];var l=Sa(e),o=[s,l,"str"];if(a.cellFormula){e.l+=2;var d=fx(e,r-e.l,a);o[3]=wa(d,null,s,a.supbooks,a)}else e.l=r;return o}var tB=bo,nB=Rc;function aB(e,n){return n==null&&(n=Te(4)),n.write_shift(4,e),n}function rB(e,n){var a=e.l+n,r=bo(e),s=Mg(e),l=Sa(e),o=Sa(e),d=Sa(e);e.l=a;var u={rfx:r,relId:s,loc:l,display:d};return o&&(u.Tooltip=o),u}function sB(e,n){var a=Te(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Rc({s:vn(e[0]),e:vn(e[0])},a),Rg("rId"+n,a);var r=e[1].Target.indexOf("#"),s=r==-1?"":e[1].Target.slice(r+1);return ra(s||"",a),ra(e[1].Tooltip||"",a),ra("",a),a.slice(0,a.l)}function iB(){}function lB(e,n,a){var r=e.l+n,s=ck(e),l=e.read_shift(1),o=[s];if(o[2]=l,a.cellFormula){var d=A7(e,r-e.l,a);o[1]=d}else e.l=r;return o}function oB(e,n,a){var r=e.l+n,s=bo(e),l=[s];if(a.cellFormula){var o=L7(e,r-e.l,a);l[1]=o,e.l=r}else e.l=r;return l}function cB(e,n,a){a==null&&(a=Te(18));var r=px(e,n);a.write_shift(-4,e),a.write_shift(-4,e),a.write_shift(4,(r.width||10)*256),a.write_shift(4,0);var s=0;return n.hidden&&(s|=1),typeof r.width=="number"&&(s|=2),n.level&&(s|=n.level<<8),a.write_shift(2,s),a}var xT=["left","right","top","bottom","header","footer"];function dB(e){var n={};return xT.forEach(function(a){n[a]=Ca(e)}),n}function uB(e,n){return n==null&&(n=Te(48)),no(e),xT.forEach(function(a){co(e[a],n)}),n}function hB(e){var n=e.read_shift(2);return e.l+=28,{RTL:n&32}}function xB(e,n,a){a==null&&(a=Te(30));var r=924;return(((n||{}).Views||[])[0]||{}).RTL&&(r|=32),a.write_shift(2,r),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(2,0),a.write_shift(2,100),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(4,0),a}function mB(e){var n=Te(24);return n.write_shift(4,4),n.write_shift(4,1),Rc(e,n),n}function fB(e,n){return n==null&&(n=Te(66)),n.write_shift(2,e.password?$g(e.password):0),n.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(a){a[1]?n.write_shift(4,e[a[0]]!=null&&!e[a[0]]?1:0):n.write_shift(4,e[a[0]]!=null&&e[a[0]]?0:1)}),n}function pB(){}function gB(){}function yB(e,n,a,r,s,l,o){if(!e)return e;var d=n||{};r||(r={"!id":{}});var u=d.dense?[]:{},x,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,p=!1,N,y,g,b,j,T,_,w,E,C=[];d.biff=12,d["!row"]=0;var S=0,P=!1,F=[],B={},O=d.supbooks||s.supbooks||[[]];if(O.sharedf=B,O.arrayf=F,O.SheetNames=s.SheetNames||s.Sheets.map(function(H){return H.name}),!d.supbooks&&(d.supbooks=O,s.Names))for(var M=0;M<s.Names.length;++M)O[0][M+1]=s.Names[M];var G=[],J=[],X=!1;cu[16]={n:"BrtShortReal",f:hT};var fe;if(hi(e,function(W,xe,K){if(!p)switch(K){case 148:x=W;break;case 0:N=W,d.sheetRows&&d.sheetRows<=N.r&&(p=!0),w=Ln(b=N.r),d["!row"]=N.r,(W.hidden||W.hpt||W.level!=null)&&(W.hpt&&(W.hpx=Ec(W.hpt)),J[W.r]=W);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:W[2]},W[2]){case"n":y.v=W[1];break;case"s":_=Kd[W[1]],y.v=_.t,y.r=_.r;break;case"b":y.v=!!W[1];break;case"e":y.v=W[1],d.cellText!==!1&&(y.w=xi[y.v]);break;case"str":y.t="s",y.v=W[1];break;case"is":y.t="s",y.v=W[1].t;break}if((g=o.CellXf[W[0].iStyleRef])&&cT(y,g.numFmtId,null,d,l,o),j=W[0].c==-1?j+1:W[0].c,d.dense?(u[b]||(u[b]=[]),u[b][j]=y):u[yn(j)+w]=y,d.cellFormula){for(P=!1,S=0;S<F.length;++S){var L=F[S];N.r>=L[0].s.r&&N.r<=L[0].e.r&&j>=L[0].s.c&&j<=L[0].e.c&&(y.F=gt(L[0]),P=!0)}!P&&W.length>3&&(y.f=W[3])}if(m.s.r>N.r&&(m.s.r=N.r),m.s.c>j&&(m.s.c=j),m.e.r<N.r&&(m.e.r=N.r),m.e.c<j&&(m.e.c=j),d.cellDates&&g&&y.t=="n"&&Ic(ct[g.numFmtId])){var Q=Vl(y.v);Q&&(y.t="d",y.v=new Date(Q.y,Q.m-1,Q.d,Q.H,Q.M,Q.S,Q.u))}fe&&(fe.type=="XLDAPR"&&(y.D=!0),fe=void 0);break;case 1:case 12:if(!d.sheetStubs||f)break;y={t:"z",v:void 0},j=W[0].c==-1?j+1:W[0].c,d.dense?(u[b]||(u[b]=[]),u[b][j]=y):u[yn(j)+w]=y,m.s.r>N.r&&(m.s.r=N.r),m.s.c>j&&(m.s.c=j),m.e.r<N.r&&(m.e.r=N.r),m.e.c<j&&(m.e.c=j),fe&&(fe.type=="XLDAPR"&&(y.D=!0),fe=void 0);break;case 176:C.push(W);break;case 49:fe=((d.xlmeta||{}).Cell||[])[W-1];break;case 494:var I=r["!id"][W.relId];for(I?(W.Target=I.Target,W.loc&&(W.Target+="#"+W.loc),W.Rel=I):W.relId==""&&(W.Target="#"+W.loc),b=W.rfx.s.r;b<=W.rfx.e.r;++b)for(j=W.rfx.s.c;j<=W.rfx.e.c;++j)d.dense?(u[b]||(u[b]=[]),u[b][j]||(u[b][j]={t:"z",v:void 0}),u[b][j].l=W):(T=dt({c:j,r:b}),u[T]||(u[T]={t:"z",v:void 0}),u[T].l=W);break;case 426:if(!d.cellFormula)break;F.push(W),E=d.dense?u[b][j]:u[yn(j)+w],E.f=wa(W[1],m,{r:N.r,c:j},O,d),E.F=gt(W[0]);break;case 427:if(!d.cellFormula)break;B[dt(W[0].s)]=W[1],E=d.dense?u[b][j]:u[yn(j)+w],E.f=wa(W[1],m,{r:N.r,c:j},O,d);break;case 60:if(!d.cellStyles)break;for(;W.e>=W.s;)G[W.e--]={width:W.w/256,hidden:!!(W.flags&1),level:W.level},X||(X=!0,Gg(W.w/256)),ll(G[W.e+1]);break;case 161:u["!autofilter"]={ref:gt(W)};break;case 476:u["!margins"]=W;break;case 147:s.Sheets[a]||(s.Sheets[a]={}),W.name&&(s.Sheets[a].CodeName=W.name),(W.above||W.left)&&(u["!outline"]={above:W.above,left:W.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),W.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!xe.T){if(!f||d.WTF)throw new Error("Unexpected record 0x"+K.toString(16))}}},d),delete d.supbooks,delete d["!row"],!u["!ref"]&&(m.s.r<2e6||x&&(x.e.r>0||x.e.c>0||x.s.r>0||x.s.c>0))&&(u["!ref"]=gt(x||m)),d.sheetRows&&u["!ref"]){var ne=Pt(u["!ref"]);d.sheetRows<=+ne.e.r&&(ne.e.r=d.sheetRows-1,ne.e.r>m.e.r&&(ne.e.r=m.e.r),ne.e.r<ne.s.r&&(ne.s.r=ne.e.r),ne.e.c>m.e.c&&(ne.e.c=m.e.c),ne.e.c<ne.s.c&&(ne.s.c=ne.e.c),u["!fullref"]=u["!ref"],u["!ref"]=gt(ne))}return C.length>0&&(u["!merges"]=C),G.length>0&&(u["!cols"]=G),J.length>0&&(u["!rows"]=J),u}function vB(e,n,a,r,s,l,o){if(n.v===void 0)return!1;var d="";switch(n.t){case"b":d=n.v?"1":"0";break;case"d":n=un(n),n.z=n.z||ct[14],n.v=Wn(dn(n.v)),n.t="n";break;case"n":case"e":d=""+n.v;break;default:d=n.v;break}var u={r:a,c:r};switch(u.s=ml(s.cellXfs,n,s),n.l&&l["!links"].push([dt(u),n.l]),n.c&&l["!comments"].push([dt(u),n.c]),n.t){case"s":case"str":return s.bookSST?(d=Yg(s.Strings,n.v,s.revStrings),u.t="s",u.v=d,o?_e(e,18,RR(n,u)):_e(e,7,OR(n,u))):(u.t="str",o?_e(e,17,QR(n,u)):_e(e,6,WR(n,u))),!0;case"n":return n.v==(n.v|0)&&n.v>-1e3&&n.v<1e3?o?_e(e,13,$R(n,u)):_e(e,2,KR(n,u)):o?_e(e,16,VR(n,u)):_e(e,5,HR(n,u)),!0;case"b":return u.t="b",o?_e(e,15,DR(n,u)):_e(e,4,_R(n,u)),!0;case"e":return u.t="e",o?_e(e,14,PR(n,u)):_e(e,3,FR(n,u)),!0}return o?_e(e,12,CR(n,u)):_e(e,1,kR(n,u)),!0}function bB(e,n,a,r){var s=Pt(n["!ref"]||"A1"),l,o="",d=[];_e(e,145);var u=Array.isArray(n),x=s.e.r;n["!rows"]&&(x=Math.max(s.e.r,n["!rows"].length-1));for(var m=s.s.r;m<=x;++m){o=Ln(m),gR(e,n,s,m);var f=!1;if(m<=s.e.r)for(var p=s.s.c;p<=s.e.c;++p){m===s.s.r&&(d[p]=yn(p)),l=d[p]+o;var N=u?(n[m]||[])[p]:n[l];if(!N){f=!1;continue}f=vB(e,N,m,p,r,n,f)}}_e(e,146)}function NB(e,n){!n||!n["!merges"]||(_e(e,177,aB(n["!merges"].length)),n["!merges"].forEach(function(a){_e(e,176,nB(a))}),_e(e,178))}function jB(e,n){!n||!n["!cols"]||(_e(e,390),n["!cols"].forEach(function(a,r){a&&_e(e,60,cB(r,a))}),_e(e,391))}function wB(e,n){!n||!n["!ref"]||(_e(e,648),_e(e,649,mB(Pt(n["!ref"]))),_e(e,650))}function kB(e,n,a){n["!links"].forEach(function(r){if(r[1].Target){var s=$t(a,-1,r[1].Target.replace(/#.*$/,""),wt.HLINK);_e(e,494,sB(r,s))}}),delete n["!links"]}function TB(e,n,a,r){if(n["!comments"].length>0){var s=$t(r,-1,"../drawings/vmlDrawing"+(a+1)+".vml",wt.VML);_e(e,551,Rg("rId"+s)),n["!legacy"]=s}}function CB(e,n,a,r){if(n["!autofilter"]){var s=n["!autofilter"],l=typeof s.ref=="string"?s.ref:gt(s.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var o=a.Workbook.Names,d=sr(l);d.s.r==d.e.r&&(d.e.r=sr(n["!ref"]).e.r,l=gt(d));for(var u=0;u<o.length;++u){var x=o[u];if(x.Name=="_xlnm._FilterDatabase"&&x.Sheet==r){x.Ref="'"+a.SheetNames[r]+"'!"+l;break}}u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+a.SheetNames[r]+"'!"+l}),_e(e,161,Rc(Pt(l))),_e(e,162)}}function SB(e,n,a){_e(e,133),_e(e,137,xB(n,a)),_e(e,138),_e(e,134)}function _B(e,n){n["!protect"]&&_e(e,535,fB(n["!protect"]))}function EB(e,n,a,r){var s=rr(),l=a.SheetNames[e],o=a.Sheets[l]||{},d=l;try{a&&a.Workbook&&(d=a.Workbook.Sheets[e].CodeName||d)}catch{}var u=Pt(o["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(n.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],_e(s,129),(a.vbaraw||o["!outline"])&&_e(s,147,jR(d,o["!outline"])),_e(s,148,vR(u)),SB(s,o,a.Workbook),jB(s,o),bB(s,o,e,n),_B(s,o),CB(s,o,a,e),NB(s,o),kB(s,o,r),o["!margins"]&&_e(s,476,uB(o["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&wB(s,o),TB(s,o,e,r),_e(s,130),s.end()}function DB(e){var n=[],a=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var o=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(n[+o[1]]=a?+o[2]:o[2])});var s=Lt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){r=l.replace(/<.*?>/g,"")}),[n,s,r]}function AB(e,n,a,r,s,l){var o=l||{"!type":"chart"};if(!e)return l;var d=0,u=0,x="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var p=DB(f);m.s.r=m.s.c=0,m.e.c=d,x=yn(d),p[0].forEach(function(N,y){o[x+Ln(y)]={t:"n",v:N,z:p[1]},u=y}),m.e.r<u&&(m.e.r=u),++d}),d>0&&(o["!ref"]=gt(m)),o}function FB(e,n,a,r,s){if(!e)return e;r||(r={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o,d=e.match(dT);return d&&Jg(d[0],l,s,a),(o=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=o[1]),r["!id"][l["!rel"]]&&(l["!drawel"]=r["!id"][l["!rel"]]),l}function LB(e,n){e.l+=10;var a=Sa(e);return{name:a}}function PB(e,n,a,r,s){if(!e)return e;r||(r={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o=!1;return hi(e,function(u,x,m){switch(m){case 550:l["!rel"]=u;break;case 651:s.Sheets[a]||(s.Sheets[a]={}),u.name&&(s.Sheets[a].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(x.T>0)){if(!(x.T<0)){if(!o||n.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},n),r["!id"][l["!rel"]]&&(l["!drawel"]=r["!id"][l["!rel"]]),l}var Zg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],IB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],OB=[],MB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function s2(e,n){for(var a=0;a!=e.length;++a)for(var r=e[a],s=0;s!=n.length;++s){var l=n[s];if(r[l[0]]==null)r[l[0]]=l[1];else switch(l[2]){case"bool":typeof r[l[0]]=="string"&&(r[l[0]]=on(r[l[0]]));break;case"int":typeof r[l[0]]=="string"&&(r[l[0]]=parseInt(r[l[0]],10));break}}}function i2(e,n){for(var a=0;a!=n.length;++a){var r=n[a];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=on(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function mT(e){i2(e.WBProps,Zg),i2(e.CalcPr,MB),s2(e.WBView,IB),s2(e.Sheets,OB),cc.date1904=on(e.WBProps.date1904)}function RB(e){return!e.Workbook||!e.Workbook.WBProps?"false":on(e.Workbook.WBProps.date1904)?"true":"false"}var BB="][*?/\\".split("");function fT(e,n){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var a=!0;return BB.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),a}function HB(e,n,a){e.forEach(function(r,s){fT(r);for(var l=0;l<s;++l)if(r==e[l])throw new Error("Duplicate Sheet Name: "+r);if(a){var o=n&&n[s]&&n[s].CodeName||r;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function VB(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var n=e.Workbook&&e.Workbook.Sheets||[];HB(e.SheetNames,n,!!e.vbaraw);for(var a=0;a<e.SheetNames.length;++a)R7(e.Sheets[e.SheetNames[a]],e.SheetNames[a],a)}var UB=/<\w+:workbook/;function KB(e,n){if(!e)throw new Error("Could not find file");var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,s="xmlns",l={},o=0;if(e.replace(Ea,function(u,x){var m=ut(u);switch(As(m[0])){case"<?xml":break;case"<workbook":u.match(UB)&&(s="xmlns"+u.match(/<(\w+):/)[1]),a.xmlns=m[s];break;case"</workbook>":break;case"<fileVersion":delete m[0],a.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Zg.forEach(function(f){if(m[f[0]]!=null)switch(f[2]){case"bool":a.WBProps[f[0]]=on(m[f[0]]);break;case"int":a.WBProps[f[0]]=parseInt(m[f[0]],10);break;default:a.WBProps[f[0]]=m[f[0]]}}),m.codeName&&(a.WBProps.CodeName=Xt(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],a.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=Lt(Xt(m.name)),delete m[0],a.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":l={},l.Name=Xt(m.name),m.comment&&(l.Comment=m.comment),m.localSheetId&&(l.Sheet=+m.localSheetId),on(m.hidden||"0")&&(l.Hidden=!0),o=x+u.length;break;case"</definedName>":l.Ref=Lt(Xt(e.slice(o,x))),a.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete m[0],a.CalcPr=m;break;case"<calcPr/>":delete m[0],a.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&n.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return u}),po.indexOf(a.xmlns)===-1)throw new Error("Unknown Namespace: "+a.xmlns);return mT(a),a}function pT(e){var n=[Pn];n[n.length]=Ve("workbook",null,{xmlns:po[0],"xmlns:r":$n.r});var a=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Zg.forEach(function(d){e.Workbook.WBProps[d[0]]!=null&&e.Workbook.WBProps[d[0]]!=d[1]&&(r[d[0]]=e.Workbook.WBProps[d[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),n[n.length]=Ve("workbookPr",null,r);var s=e.Workbook&&e.Workbook.Sheets||[],l=0;if(s&&s[0]&&s[0].Hidden){for(n[n.length]="<bookViews>",l=0;l!=e.SheetNames.length&&!(!s[l]||!s[l].Hidden);++l);l==e.SheetNames.length&&(l=0),n[n.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',n[n.length]="</bookViews>"}for(n[n.length]="<sheets>",l=0;l!=e.SheetNames.length;++l){var o={name:qt(e.SheetNames[l].slice(0,31))};if(o.sheetId=""+(l+1),o["r:id"]="rId"+(l+1),s[l])switch(s[l].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}n[n.length]=Ve("sheet",null,o)}return n[n.length]="</sheets>",a&&(n[n.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(d){var u={name:d.Name};d.Comment&&(u.comment=d.Comment),d.Sheet!=null&&(u.localSheetId=""+d.Sheet),d.Hidden&&(u.hidden="1"),d.Ref&&(n[n.length]=Ve("definedName",qt(d.Ref),u))}),n[n.length]="</definedNames>"),n.length>2&&(n[n.length]="</workbook>",n[1]=n[1].replace("/>",">")),n.join("")}function zB(e,n){var a={};return a.Hidden=e.read_shift(4),a.iTabID=e.read_shift(4),a.strRelID=Dp(e),a.name=Sa(e),a}function $B(e,n){return n||(n=Te(127)),n.write_shift(4,e.Hidden),n.write_shift(4,e.iTabID),Rg(e.strRelID,n),ra(e.name.slice(0,31),n),n.length>n.l?n.slice(0,n.l):n}function GB(e,n){var a={},r=e.read_shift(4);a.defaultThemeVersion=e.read_shift(4);var s=n>8?Sa(e):"";return s.length>0&&(a.CodeName=s),a.autoCompressPictures=!!(r&65536),a.backupFile=!!(r&64),a.checkCompatibility=!!(r&4096),a.date1904=!!(r&1),a.filterPrivacy=!!(r&8),a.hidePivotFieldList=!!(r&1024),a.promptedSolutions=!!(r&16),a.publishItems=!!(r&2048),a.refreshAllConnections=!!(r&262144),a.saveExternalLinkValues=!!(r&128),a.showBorderUnselectedTables=!!(r&4),a.showInkAnnotation=!!(r&32),a.showObjects=["all","placeholders","none"][r>>13&3],a.showPivotChartFilter=!!(r&32768),a.updateLinks=["userSet","never","always"][r>>8&3],a}function qB(e,n){n||(n=Te(72));var a=0;return e&&e.filterPrivacy&&(a|=8),n.write_shift(4,a),n.write_shift(4,0),lk(e&&e.CodeName||"ThisWorkbook",n),n.slice(0,n.l)}function WB(e,n){var a={};return e.read_shift(4),a.ArchID=e.read_shift(4),e.l+=n-8,a}function XB(e,n,a){var r=e.l+n;e.l+=4,e.l+=1;var s=e.read_shift(4),l=T8(e),o=F7(e,0,a),d=Mg(e);e.l=r;var u={Name:l,Ptg:o};return s<268435455&&(u.Sheet=s),d&&(u.Comment=d),u}function QB(e,n){var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],s=!1;n||(n={}),n.biff=12;var l=[],o=[[]];return o.SheetNames=[],o.XTI=[],cu[16]={n:"BrtFRTArchID$",f:WB},hi(e,function(u,x,m){switch(m){case 156:o.SheetNames.push(u.name),a.Sheets.push(u);break;case 153:a.WBProps=u;break;case 39:u.Sheet!=null&&(n.SID=u.Sheet),u.Ref=wa(u.Ptg,null,null,o,n),delete n.SID,delete u.Ptg,l.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([m,u]):o[0]=[m,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(m),s=!0;break;case 36:r.pop(),s=!1;break;case 37:r.push(m),s=!0;break;case 38:r.pop(),s=!1;break;case 16:break;default:if(!x.T){if(!s||n.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},n),mT(a),a.Names=l,a.supbooks=o,a}function YB(e,n){_e(e,143);for(var a=0;a!=n.SheetNames.length;++a){var r=n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[a]&&n.Workbook.Sheets[a].Hidden||0,s={Hidden:r,iTabID:a+1,strRelID:"rId"+(a+1),name:n.SheetNames[a]};_e(e,156,$B(s))}_e(e,144)}function JB(e,n){n||(n=Te(127));for(var a=0;a!=4;++a)n.write_shift(4,0);return ra("SheetJS",n),ra(E0.version,n),ra(E0.version,n),ra("7262",n),n.length>n.l?n.slice(0,n.l):n}function ZB(e,n){n||(n=Te(29)),n.write_shift(-4,0),n.write_shift(-4,460),n.write_shift(4,28800),n.write_shift(4,17600),n.write_shift(4,500),n.write_shift(4,e),n.write_shift(4,e);var a=120;return n.write_shift(1,a),n.length>n.l?n.slice(0,n.l):n}function eH(e,n){if(!(!n.Workbook||!n.Workbook.Sheets)){for(var a=n.Workbook.Sheets,r=0,s=-1,l=-1;r<a.length;++r)!a[r]||!a[r].Hidden&&s==-1?s=r:a[r].Hidden==1&&l==-1&&(l=r);l>s||(_e(e,135),_e(e,158,ZB(s)),_e(e,136))}}function tH(e,n){var a=rr();return _e(a,131),_e(a,128,JB()),_e(a,153,qB(e.Workbook&&e.Workbook.WBProps||null)),eH(a,e),YB(a,e),_e(a,132),a.end()}function nH(e,n,a){return n.slice(-4)===".bin"?QB(e,a):KB(e,a)}function aH(e,n,a,r,s,l,o,d){return n.slice(-4)===".bin"?yB(e,r,a,s,l,o,d):X7(e,r,a,s,l,o,d)}function rH(e,n,a,r,s,l,o,d){return n.slice(-4)===".bin"?PB(e,r,a,s,l):FB(e,r,a,s,l)}function sH(e,n,a,r,s,l,o,d){return n.slice(-4)===".bin"?lM():oM()}function iH(e,n,a,r,s,l,o,d){return n.slice(-4)===".bin"?sM():iM()}function lH(e,n,a,r){return n.slice(-4)===".bin"?nO(e,a,r):zI(e,a,r)}function oH(e,n,a){return Qk(e,a)}function cH(e,n,a){return n.slice(-4)===".bin"?cI(e,a):iI(e,a)}function dH(e,n,a){return n.slice(-4)===".bin"?eM(e,a):$O(e,a)}function uH(e,n,a){return n.slice(-4)===".bin"?UO(e):HO(e)}function hH(e,n,a,r){return a.slice(-4)===".bin"?KO(e,n,a,r):void 0}function xH(e,n,a){return n.slice(-4)===".bin"?MO(e,n,a):BO(e,n,a)}function mH(e,n,a){return(n.slice(-4)===".bin"?tH:pT)(e)}function fH(e,n,a,r,s){return(n.slice(-4)===".bin"?EB:uT)(e,a,r,s)}function pH(e,n,a){return(n.slice(-4)===".bin"?hO:Wk)(e,a)}function gH(e,n,a){return(n.slice(-4)===".bin"?hI:Hk)(e,a)}function yH(e,n,a){return(n.slice(-4)===".bin"?tM:Zk)(e)}function vH(e){return(e.slice(-4)===".bin"?RO:Yk)()}var gT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,yT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Xr(e,n){var a=e.split(/\s+/),r=[];if(r[0]=a[0],a.length===1)return r;var s=e.match(gT),l,o,d,u;if(s)for(u=0;u!=s.length;++u)l=s[u].match(yT),(o=l[1].indexOf(":"))===-1?r[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?d="xmlns"+l[1].slice(6):d=l[1].slice(o+1),r[d]=l[2].slice(1,l[2].length-1));return r}function bH(e){var n=e.split(/\s+/),a={};if(n.length===1)return a;var r=e.match(gT),s,l,o,d;if(r)for(d=0;d!=r.length;++d)s=r[d].match(yT),(l=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(l+1),a[o]=s[2].slice(1,s[2].length-1));return a}var $d;function NH(e,n){var a=$d[e]||Lt(e);return a==="General"?lo(n):Hr(a,n)}function jH(e,n,a,r){var s=r;switch((a[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=on(r);break;case"i2":case"int":s=parseInt(r,10);break;case"r4":case"float":s=parseFloat(r);break;case"date":case"dateTime.tz":s=dn(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+a[0])}e[Lt(n)]=s}function wH(e,n,a){if(e.t!=="z"){if(!a||a.cellText!==!1)try{e.t==="e"?e.w=e.w||xi[e.v]:n==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=eu(e.v):e.w=lo(e.v):e.w=NH(n||"General",e.v)}catch(l){if(a.WTF)throw l}try{var r=$d[n]||n||"General";if(a.cellNF&&(e.z=r),a.cellDates&&e.t=="n"&&Ic(r)){var s=Vl(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(l){if(a.WTF)throw l}}}function kH(e,n,a){if(a.cellStyles&&n.Interior){var r=n.Interior;r.Pattern&&(r.patternType=OI[r.Pattern]||r.Pattern)}e[n.ID]=n}function TH(e,n,a,r,s,l,o,d,u,x){var m="General",f=r.StyleID,p={};x=x||{};var N=[],y=0;for(f===void 0&&d&&(f=d.StyleID),f===void 0&&o&&(f=o.StyleID);l[f]!==void 0&&(l[f].nf&&(m=l[f].nf),l[f].Interior&&N.push(l[f].Interior),!!l[f].Parent);)f=l[f].Parent;switch(a.Type){case"Boolean":r.t="b",r.v=on(e);break;case"String":r.t="s",r.r=wN(Lt(e)),r.v=e.indexOf("<")>-1?Lt(n||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(dn(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),r.v!==r.v?r.v=Lt(e):r.v<60&&(r.v=r.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=hk[e],x.cellText!==!1&&(r.w=e);break;default:e==""&&n==""?r.t="z":(r.t="s",r.v=wN(n||e));break}if(wH(r,m,x),x.cellFormula!==!1)if(r.Formula){var g=Lt(r.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),r.f=oc(g,s),delete r.Formula,r.ArrayRange=="RC"?r.F=oc("RC:RC",s):r.ArrayRange&&(r.F=oc(r.ArrayRange,s),u.push([Pt(r.F),r.F]))}else for(y=0;y<u.length;++y)s.r>=u[y][0].s.r&&s.r<=u[y][0].e.r&&s.c>=u[y][0].s.c&&s.c<=u[y][0].e.c&&(r.F=u[y][1]);x.cellStyles&&(N.forEach(function(b){!p.patternType&&b.patternType&&(p.patternType=b.patternType)}),r.s=p),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function CH(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Mf(e,n){var a=n||{};Oc();var r=Ld(Ag(e));(a.type=="binary"||a.type=="array"||a.type=="base64")&&(r=Xt(r));var s=r.slice(0,1024).toLowerCase(),l=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=un(a);return o.type="string",_c.to_workbook(r,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Rt){s.indexOf("<"+Rt)>=0&&(l=!0)}),l)return u9(r,a);$d={"General Number":"General","General Date":ct[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ct[15],"Short Date":ct[14],"Long Time":ct[19],"Medium Time":ct[18],"Short Time":ct[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ct[2],Standard:ct[4],Percent:ct[10],Scientific:ct[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var d,u=[],x,m={},f=[],p=a.dense?[]:{},N="",y={},g={},b=Xr('<Data ss:Type="String">'),j=0,T=0,_=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},C={},S="",P=0,F=[],B={},O={},M=0,G=[],J=[],X={},fe=[],ne,H=!1,W=[],xe=[],K={},L=0,Q=0,I={Sheets:[],WBProps:{date1904:!1}},R={};au.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";d=au.exec(r);)switch(d[3]=(te=d[3]).toLowerCase()){case"data":if(te=="data"){if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&u.push([d[3],!0]);break}if(u[u.length-1][1])break;d[1]==="/"?TH(r.slice(j,d.index),S,b,u[u.length-1][0]=="comment"?X:y,{c:T,r:_},E,fe[T],g,W,a):(S="",b=Xr(d[0]),j=d.index+d[0].length);break;case"cell":if(d[1]==="/")if(J.length>0&&(y.c=J),(!a.sheetRows||a.sheetRows>_)&&y.v!==void 0&&(a.dense?(p[_]||(p[_]=[]),p[_][T]=y):p[yn(T)+Ln(_)]=y),y.HRef&&(y.l={Target:Lt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(L=T+(parseInt(y.MergeAcross,10)|0),Q=_+(parseInt(y.MergeDown,10)|0),F.push({s:{c:T,r:_},e:{c:L,r:Q}})),!a.sheetStubs)y.MergeAcross?T=L+1:++T;else if(y.MergeAcross||y.MergeDown){for(var ue=T;ue<=L;++ue)for(var V=_;V<=Q;++V)(ue>T||V>_)&&(a.dense?(p[V]||(p[V]=[]),p[V][ue]={t:"z"}):p[yn(ue)+Ln(V)]={t:"z"});T=L+1}else++T;else y=bH(d[0]),y.Index&&(T=+y.Index-1),T<w.s.c&&(w.s.c=T),T>w.e.c&&(w.e.c=T),d[0].slice(-2)==="/>"&&++T,J=[];break;case"row":d[1]==="/"||d[0].slice(-2)==="/>"?(_<w.s.r&&(w.s.r=_),_>w.e.r&&(w.e.r=_),d[0].slice(-2)==="/>"&&(g=Xr(d[0]),g.Index&&(_=+g.Index-1)),T=0,++_):(g=Xr(d[0]),g.Index&&(_=+g.Index-1),K={},(g.AutoFitHeight=="0"||g.Height)&&(K.hpx=parseInt(g.Height,10),K.hpt=ou(K.hpx),xe[_]=K),g.Hidden=="1"&&(K.hidden=!0,xe[_]=K));break;case"worksheet":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"));f.push(N),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(p["!ref"]=gt(w),a.sheetRows&&a.sheetRows<=w.e.r&&(p["!fullref"]=p["!ref"],w.e.r=a.sheetRows-1,p["!ref"]=gt(w))),F.length&&(p["!merges"]=F),fe.length>0&&(p["!cols"]=fe),xe.length>0&&(p["!rows"]=xe),m[N]=p}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=T=0,u.push([d[3],!1]),x=Xr(d[0]),N=Lt(x.Name),p=a.dense?[]:{},F=[],W=[],xe=[],R={name:N,Hidden:0},I.Sheets.push(R);break;case"table":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else{if(d[0].slice(-2)=="/>")break;u.push([d[3],!1]),fe=[],H=!1}break;case"style":d[1]==="/"?kH(E,C,a):C=Xr(d[0]);break;case"numberformat":C.nf=Lt(Xr(d[0]).Format||"General"),$d[C.nf]&&(C.nf=$d[C.nf]);for(var le=0;le!=392&&ct[le]!=C.nf;++le);if(le==392){for(le=57;le!=392;++le)if(ct[le]==null){ri(C.nf,le);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(ne=Xr(d[0]),ne.Hidden&&(ne.hidden=!0,delete ne.Hidden),ne.Width&&(ne.wpx=parseInt(ne.Width,10)),!H&&ne.wpx>10){H=!0,ka=Gk;for(var q=0;q<fe.length;++q)fe[q]&&ll(fe[q])}H&&ll(ne),fe[ne.Index-1||fe.length]=ne;for(var Le=0;Le<+ne.Span;++Le)fe[fe.length]=un(ne);break;case"namedrange":if(d[1]==="/")break;I.Names||(I.Names=[]);var ee=ut(d[0]),ke={Name:ee.Name,Ref:oc(ee.RefersTo.slice(1),{r:0,c:0})};I.Sheets.length>0&&(ke.Sheet=I.Sheets.length-1),I.Names.push(ke);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(d[0].slice(-2)==="/>")break;d[1]==="/"?S+=r.slice(P,d.index):P=d.index+d[0].length;break;case"interior":if(!a.cellStyles)break;C.Interior=Xr(d[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(d[0].slice(-2)==="/>")break;d[1]==="/"?Q8(B,te,r.slice(M,d.index)):M=d.index+d[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else u.push([d[3],!1]);break;case"comment":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"));CH(X),J.push(X)}else u.push([d[3],!1]),x=Xr(d[0]),X={a:x.Author};break;case"autofilter":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else if(d[0].charAt(d[0].length-2)!=="/"){var Ke=Xr(d[0]);p["!autofilter"]={ref:oc(Ke.Range).replace(/\$/g,"")},u.push([d[3],!0])}break;case"name":break;case"datavalidation":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&u.push([d[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&u.push([d[3],!0]);break;case"null":break;default:if(u.length==0&&d[3]=="document"||u.length==0&&d[3]=="uof")return u2(r,a);var tt=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(d[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:tt=!1}break;case"componentoptions":switch(d[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:tt=!1}break;case"excelworkbook":switch(d[3]){case"date1904":I.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:tt=!1}break;case"workbookoptions":switch(d[3]){case"owcversion":break;case"height":break;case"width":break;default:tt=!1}break;case"worksheetoptions":switch(d[3]){case"visible":if(d[0].slice(-2)!=="/>")if(d[1]==="/")switch(r.slice(M,d.index)){case"SheetHidden":R.Hidden=1;break;case"SheetVeryHidden":R.Hidden=2;break}else M=d.index+d[0].length;break;case"header":p["!margins"]||no(p["!margins"]={},"xlml"),isNaN(+ut(d[0]).Margin)||(p["!margins"].header=+ut(d[0]).Margin);break;case"footer":p["!margins"]||no(p["!margins"]={},"xlml"),isNaN(+ut(d[0]).Margin)||(p["!margins"].footer=+ut(d[0]).Margin);break;case"pagemargins":var Xe=ut(d[0]);p["!margins"]||no(p["!margins"]={},"xlml"),isNaN(+Xe.Top)||(p["!margins"].top=+Xe.Top),isNaN(+Xe.Left)||(p["!margins"].left=+Xe.Left),isNaN(+Xe.Right)||(p["!margins"].right=+Xe.Right),isNaN(+Xe.Bottom)||(p["!margins"].bottom=+Xe.Bottom);break;case"displayrighttoleft":I.Views||(I.Views=[]),I.Views[0]||(I.Views[0]={}),I.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:tt=!1}break;case"pivottable":case"pivotcache":switch(d[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:tt=!1}break;case"pagebreaks":switch(d[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:tt=!1}break;case"autofilter":switch(d[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:tt=!1}break;case"querytable":switch(d[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:tt=!1}break;case"datavalidation":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:tt=!1}break;case"sorting":case"conditionalformatting":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:tt=!1}break;case"mapinfo":case"schema":case"data":switch(d[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:tt=!1}break;case"smarttags":break;default:tt=!1;break}if(tt||d[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+d[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(d[0].slice(-2)==="/>")break;d[1]==="/"?jH(O,te,G,r.slice(M,d.index)):(G=d,M=d.index+d[0].length);break}if(a.WTF)throw"Unrecognized tag: "+d[3]+"|"+u.join("|")}var Oe={};return!a.bookSheets&&!a.bookProps&&(Oe.Sheets=m),Oe.SheetNames=f,Oe.Workbook=I,Oe.SSF=un(ct),Oe.Props=B,Oe.Custprops=O,Oe}function Mp(e,n){switch(ny(n=n||{}),n.type||"base64"){case"base64":return Mf(vr(e),n);case"binary":case"buffer":case"file":return Mf(e,n);case"array":return Mf(hl(e),n)}}function SH(e,n){var a=[];return e.Props&&a.push(Y8(e.Props,n)),e.Custprops&&a.push(J8(e.Props,e.Custprops)),a.join("")}function _H(){return""}function EH(e,n){var a=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return n.cellXfs.forEach(function(r,s){var l=[];l.push(Ve("NumberFormat",null,{"ss:Format":qt(ct[r.numFmtId])}));var o={"ss:ID":"s"+(21+s)};a.push(Ve("Style",l.join(""),o))}),Ve("Styles",a.join(""))}function vT(e){return Ve("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Xg(e.Ref,{r:0,c:0})})}function DH(e){if(!((e||{}).Workbook||{}).Names)return"";for(var n=e.Workbook.Names,a=[],r=0;r<n.length;++r){var s=n[r];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||a.push(vT(s)))}return Ve("Names",a.join(""))}function AH(e,n,a,r){if(!e||!((r||{}).Workbook||{}).Names)return"";for(var s=r.Workbook.Names,l=[],o=0;o<s.length;++o){var d=s[o];d.Sheet==a&&(d.Name.match(/^_xlfn\./)||l.push(vT(d)))}return l.join("")}function FH(e,n,a,r){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Ve("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Ve("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Ve("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[a])if(r.Workbook.Sheets[a].Hidden)s.push(Ve("Visible",r.Workbook.Sheets[a].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<a&&!(r.Workbook.Sheets[l]&&!r.Workbook.Sheets[l].Hidden);++l);l==a&&s.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(fa("ProtectContents","True")),e["!protect"].objects&&s.push(fa("ProtectObjects","True")),e["!protect"].scenarios&&s.push(fa("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(fa("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(fa("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Ve("WorksheetOptions",s.join(""),{xmlns:ur.x})}function LH(e){return e.map(function(n){var a=e8(n.t||""),r=Ve("ss:Data",a,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ve("Comment",r,{"ss:Author":n.a})}).join("")}function PH(e,n,a,r,s,l,o){if(!e||e.v==null&&e.f==null)return"";var d={};if(e.f&&(d["ss:Formula"]="="+qt(Xg(e.f,o))),e.F&&e.F.slice(0,n.length)==n){var u=vn(e.F.slice(n.length+1));d["ss:ArrayRange"]="RC:R"+(u.r==o.r?"":"["+(u.r-o.r)+"]")+"C"+(u.c==o.c?"":"["+(u.c-o.c)+"]")}if(e.l&&e.l.Target&&(d["ss:HRef"]=qt(e.l.Target),e.l.Tooltip&&(d["x:HRefScreenTip"]=qt(e.l.Tooltip))),a["!merges"])for(var x=a["!merges"],m=0;m!=x.length;++m)x[m].s.c!=o.c||x[m].s.r!=o.r||(x[m].e.c>x[m].s.c&&(d["ss:MergeAcross"]=x[m].e.c-x[m].s.c),x[m].e.r>x[m].s.r&&(d["ss:MergeDown"]=x[m].e.r-x[m].s.r));var f="",p="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":f="Number",p=String(e.v);break;case"b":f="Boolean",p=e.v?"1":"0";break;case"e":f="Error",p=xi[e.v];break;case"d":f="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ct[14]);break;case"s":f="String",p=ZF(e.v||"");break}var N=ml(r.cellXfs,e,r);d["ss:StyleID"]="s"+(21+N),d["ss:Index"]=o.c+1;var y=e.v!=null?p:"",g=e.t=="z"?"":'<Data ss:Type="'+f+'">'+y+"</Data>";return(e.c||[]).length>0&&(g+=LH(e.c)),Ve("Cell",g,d)}function IH(e,n){var a='<Row ss:Index="'+(e+1)+'"';return n&&(n.hpt&&!n.hpx&&(n.hpx=Ec(n.hpt)),n.hpx&&(a+=' ss:AutoFitHeight="0" ss:Height="'+n.hpx+'"'),n.hidden&&(a+=' ss:Hidden="1"')),a+">"}function OH(e,n,a,r){if(!e["!ref"])return"";var s=Pt(e["!ref"]),l=e["!merges"]||[],o=0,d=[];e["!cols"]&&e["!cols"].forEach(function(b,j){ll(b);var T=!!b.width,_=px(j,b),w={"ss:Index":j+1};T&&(w["ss:Width"]=iu(_.width)),b.hidden&&(w["ss:Hidden"]="1"),d.push(Ve("Column",null,w))});for(var u=Array.isArray(e),x=s.s.r;x<=s.e.r;++x){for(var m=[IH(x,(e["!rows"]||[])[x])],f=s.s.c;f<=s.e.c;++f){var p=!1;for(o=0;o!=l.length;++o)if(!(l[o].s.c>f)&&!(l[o].s.r>x)&&!(l[o].e.c<f)&&!(l[o].e.r<x)){(l[o].s.c!=f||l[o].s.r!=x)&&(p=!0);break}if(!p){var N={r:x,c:f},y=dt(N),g=u?(e[x]||[])[f]:e[y];m.push(PH(g,y,e,n,a,r,N))}}m.push("</Row>"),m.length>2&&d.push(m.join(""))}return d.join("")}function MH(e,n,a){var r=[],s=a.SheetNames[e],l=a.Sheets[s],o=l?AH(l,n,e,a):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=l?OH(l,n,e,a):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(FH(l,n,e,a)),r.join("")}function RH(e,n){n||(n={}),e.SSF||(e.SSF=un(ct)),e.SSF&&(Oc(),cx(e.SSF),n.revssf=ux(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF,n.cellXfs=[],ml(n.cellXfs,{},{revssf:{General:0}}));var a=[];a.push(SH(e,n)),a.push(_H()),a.push(""),a.push("");for(var r=0;r<e.SheetNames.length;++r)a.push(Ve("Worksheet",MH(r,n,e),{"ss:Name":qt(e.SheetNames[r])}));return a[2]=EH(e,n),a[3]=DH(e),Pn+Ve("Workbook",a.join(""),{xmlns:ur.ss,"xmlns:o":ur.o,"xmlns:x":ur.x,"xmlns:ss":ur.ss,"xmlns:dt":ur.dt,"xmlns:html":ur.html})}function BH(e){var n={},a=e.content;if(a.l=28,n.AnsiUserType=a.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=D8(a),a.length-a.l<=4)return n;var r=a.read_shift(4);if(r==0||r>40||(a.l-=4,n.Reserved1=a.read_shift(0,"lpstr-ansi"),a.length-a.l<=4)||(r=a.read_shift(4),r!==1907505652)||(n.UnicodeClipboardFormat=A8(a),r=a.read_shift(4),r==0||r>40))return n;a.l-=4,n.Reserved2=a.read_shift(0,"lpwstr")}var HH=[60,1084,2066,2165,2175];function VH(e,n,a,r,s){var l=r,o=[],d=a.slice(a.l,a.l+l);if(s&&s.enc&&s.enc.insitu&&d.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(d)}o.push(d),a.l+=l;for(var u=Zs(a,a.l),x=Rp[u],m=0;x!=null&&HH.indexOf(u)>-1;)l=Zs(a,a.l+2),m=a.l+4,u==2066?m+=4:(u==2165||u==2175)&&(m+=12),d=a.slice(m,a.l+4+l),o.push(d),a.l+=4+l,x=Rp[u=Zs(a,a.l)];var f=aa(o);ha(f,0);var p=0;f.lens=[];for(var N=0;N<o.length;++N)f.lens.push(p),p+=o[N].length;if(f.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+r;return n.f(f,f.length,s)}function ps(e,n,a){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,n.cellNF&&(e.z=ct[r])}catch(l){if(n.WTF)throw l}if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||xi[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=eu(e.v):e.w=lo(e.v):e.w=Hr(r,e.v,{date1904:!!a,dateNF:n&&n.dateNF})}catch(l){if(n.WTF)throw l}if(n.cellDates&&r&&e.t=="n"&&Ic(ct[r]||String(r))){var s=Vl(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function i0(e,n,a){return{v:e,ixfe:n,t:a}}function UH(e,n){var a={opts:{}},r={},s=n.dense?[]:{},l={},o={},d=null,u=[],x="",m={},f,p="",N,y,g,b,j={},T=[],_,w,E=[],C=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},F=function(ot){return ot<8?Zl[ot]:ot<64&&C[ot-8]||Zl[ot]},B=function(ot,Bt,Xn){var en=Bt.XF.data;if(!(!en||!en.patternType||!Xn||!Xn.cellStyles)){Bt.s={},Bt.s.patternType=en.patternType;var Da;(Da=su(F(en.icvFore)))&&(Bt.s.fgColor={rgb:Da}),(Da=su(F(en.icvBack)))&&(Bt.s.bgColor={rgb:Da})}},O=function(ot,Bt,Xn){if(!(K>1)&&!(Xn.sheetRows&&ot.r>=Xn.sheetRows)){if(Xn.cellStyles&&Bt.XF&&Bt.XF.data&&B(ot,Bt,Xn),delete Bt.ixfe,delete Bt.XF,f=ot,p=dt(ot),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ot.r<o.s.r&&(o.s.r=ot.r),ot.c<o.s.c&&(o.s.c=ot.c),ot.r+1>o.e.r&&(o.e.r=ot.r+1),ot.c+1>o.e.c&&(o.e.c=ot.c+1),Xn.cellFormula&&Bt.f){for(var en=0;en<T.length;++en)if(!(T[en][0].s.c>ot.c||T[en][0].s.r>ot.r)&&!(T[en][0].e.c<ot.c||T[en][0].e.r<ot.r)){Bt.F=gt(T[en][0]),(T[en][0].s.c!=ot.c||T[en][0].s.r!=ot.r)&&delete Bt.f,Bt.f&&(Bt.f=""+wa(T[en][1],o,ot,W,M));break}}Xn.dense?(s[ot.r]||(s[ot.r]=[]),s[ot.r][ot.c]=Bt):s[p]=Bt}},M={enc:!1,sbcch:0,snames:[],sharedf:j,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(M.password=n.password);var G,J=[],X=[],fe=[],ne=[],H=!1,W=[];W.SheetNames=M.snames,W.sharedf=M.sharedf,W.arrayf=M.arrayf,W.names=[],W.XTI=[];var xe=0,K=0,L=0,Q=[],I=[],R;M.codepage=1200,es(1200);for(var te=!1;e.l<e.length-1;){var ue=e.l,V=e.read_shift(2);if(V===0&&xe===10)break;var le=e.l===e.length?0:e.read_shift(2),q=Rp[V];if(q&&q.f){if(n.bookSheets&&xe===133&&V!==133)break;if(xe=V,q.r===2||q.r==12){var Le=e.read_shift(2);if(le-=2,!M.enc&&Le!==V&&((Le&255)<<8|Le>>8)!==V)throw new Error("rt mismatch: "+Le+"!="+V);q.r==12&&(e.l+=10,le-=10)}var ee={};if(V===10?ee=q.f(e,le,M):ee=VH(V,q,e,le,M),K==0&&[9,521,1033,2057].indexOf(xe)===-1)continue;switch(V){case 34:a.opts.Date1904=S.WBProps.date1904=ee;break;case 134:a.opts.WriteProtect=!0;break;case 47:if(M.enc||(e.l=0),M.enc=ee,!n.password)throw new Error("File is password-protected");if(ee.valid==null)throw new Error("Encryption scheme unsupported");if(!ee.valid)throw new Error("Password is incorrect");break;case 92:M.lastuser=ee;break;case 66:var ke=Number(ee);switch(ke){case 21010:ke=1200;break;case 32768:ke=1e4;break;case 32769:ke=1252;break}es(M.codepage=ke),te=!0;break;case 317:M.rrtabid=ee;break;case 25:M.winlocked=ee;break;case 439:a.opts.RefreshAll=ee;break;case 12:a.opts.CalcCount=ee;break;case 16:a.opts.CalcDelta=ee;break;case 17:a.opts.CalcIter=ee;break;case 13:a.opts.CalcMode=ee;break;case 14:a.opts.CalcPrecision=ee;break;case 95:a.opts.CalcSaveRecalc=ee;break;case 15:M.CalcRefMode=ee;break;case 2211:a.opts.FullCalc=ee;break;case 129:ee.fDialog&&(s["!type"]="dialog"),ee.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),ee.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:E.push(ee);break;case 430:W.push([ee]),W[W.length-1].XTI=[];break;case 35:case 547:W[W.length-1].push(ee);break;case 24:case 536:R={Name:ee.Name,Ref:wa(ee.rgce,o,null,W,M)},ee.itab>0&&(R.Sheet=ee.itab-1),W.names.push(R),W[0]||(W[0]=[],W[0].XTI=[]),W[W.length-1].push(ee),ee.Name=="_xlnm._FilterDatabase"&&ee.itab>0&&ee.rgce&&ee.rgce[0]&&ee.rgce[0][0]&&ee.rgce[0][0][0]=="PtgArea3d"&&(I[ee.itab-1]={ref:gt(ee.rgce[0][0][1][2])});break;case 22:M.ExternCount=ee;break;case 23:W.length==0&&(W[0]=[],W[0].XTI=[]),W[W.length-1].XTI=W[W.length-1].XTI.concat(ee),W.XTI=W.XTI.concat(ee);break;case 2196:if(M.biff<8)break;R!=null&&(R.Comment=ee[1]);break;case 18:s["!protect"]=ee;break;case 19:ee!==0&&M.WTF&&console.error("Password verifier: "+ee);break;case 133:l[ee.pos]=ee,M.snames.push(ee.name);break;case 10:{if(--K)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=gt(o),n.sheetRows&&n.sheetRows<=o.e.r){var Ke=o.e.r;o.e.r=n.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=gt(o),o.e.r=Ke}o.e.r++,o.e.c++}J.length>0&&(s["!merges"]=J),X.length>0&&(s["!objects"]=X),fe.length>0&&(s["!cols"]=fe),ne.length>0&&(s["!rows"]=ne),S.Sheets.push(P)}x===""?m=s:r[x]=s,s=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(M.biff===8&&(M.biff={9:2,521:3,1033:4}[V]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ee.BIFFVer]||8),M.biffguess=ee.BIFFVer==0,ee.BIFFVer==0&&ee.dt==4096&&(M.biff=5,te=!0,es(M.codepage=28591)),M.biff==8&&ee.BIFFVer==0&&ee.dt==16&&(M.biff=2),K++)break;if(s=n.dense?[]:{},M.biff<8&&!te&&(te=!0,es(M.codepage=n.codepage||1252)),M.biff<5||ee.BIFFVer==0&&ee.dt==4096){x===""&&(x="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var tt={pos:e.l-le,name:x};l[tt.pos]=tt,M.snames.push(x)}else x=(l[ue]||{name:""}).name;ee.dt==32&&(s["!type"]="chart"),ee.dt==64&&(s["!type"]="macro"),J=[],X=[],M.arrayf=T=[],fe=[],ne=[],H=!1,P={Hidden:(l[ue]||{hs:0}).hs,name:x}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(n.dense?(s[ee.r]||[])[ee.c]:s[dt({c:ee.c,r:ee.r})])&&++ee.c,_={ixfe:ee.ixfe,XF:E[ee.ixfe]||{},v:ee.val,t:"n"},L>0&&(_.z=Q[_.ixfe>>8&63]),ps(_,n,a.opts.Date1904),O({c:ee.c,r:ee.r},_,n);break;case 5:case 517:_={ixfe:ee.ixfe,XF:E[ee.ixfe],v:ee.val,t:ee.t},L>0&&(_.z=Q[_.ixfe>>8&63]),ps(_,n,a.opts.Date1904),O({c:ee.c,r:ee.r},_,n);break;case 638:_={ixfe:ee.ixfe,XF:E[ee.ixfe],v:ee.rknum,t:"n"},L>0&&(_.z=Q[_.ixfe>>8&63]),ps(_,n,a.opts.Date1904),O({c:ee.c,r:ee.r},_,n);break;case 189:for(var Xe=ee.c;Xe<=ee.C;++Xe){var Oe=ee.rkrec[Xe-ee.c][0];_={ixfe:Oe,XF:E[Oe],v:ee.rkrec[Xe-ee.c][1],t:"n"},L>0&&(_.z=Q[_.ixfe>>8&63]),ps(_,n,a.opts.Date1904),O({c:Xe,r:ee.r},_,n)}break;case 6:case 518:case 1030:{if(ee.val=="String"){d=ee;break}if(_=i0(ee.val,ee.cell.ixfe,ee.tt),_.XF=E[_.ixfe],n.cellFormula){var Rt=ee.formula;if(Rt&&Rt[0]&&Rt[0][0]&&Rt[0][0][0]=="PtgExp"){var hn=Rt[0][0][1][0],xn=Rt[0][0][1][1],Cn=dt({r:hn,c:xn});j[Cn]?_.f=""+wa(ee.formula,o,ee.cell,W,M):_.F=((n.dense?(s[hn]||[])[xn]:s[Cn])||{}).F}else _.f=""+wa(ee.formula,o,ee.cell,W,M)}L>0&&(_.z=Q[_.ixfe>>8&63]),ps(_,n,a.opts.Date1904),O(ee.cell,_,n),d=ee}break;case 7:case 519:if(d)d.val=ee,_=i0(ee,d.cell.ixfe,"s"),_.XF=E[_.ixfe],n.cellFormula&&(_.f=""+wa(d.formula,o,d.cell,W,M)),L>0&&(_.z=Q[_.ixfe>>8&63]),ps(_,n,a.opts.Date1904),O(d.cell,_,n),d=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(ee);var ia=dt(ee[0].s);if(N=n.dense?(s[ee[0].s.r]||[])[ee[0].s.c]:s[ia],n.cellFormula&&N){if(!d||!ia||!N)break;N.f=""+wa(ee[1],o,ee[0],W,M),N.F=gt(ee[0])}}break;case 1212:{if(!n.cellFormula)break;if(p){if(!d)break;j[dt(d.cell)]=ee[0],N=n.dense?(s[d.cell.r]||[])[d.cell.c]:s[dt(d.cell)],(N||{}).f=""+wa(ee[0],o,f,W,M)}}break;case 253:_=i0(u[ee.isst].t,ee.ixfe,"s"),u[ee.isst].h&&(_.h=u[ee.isst].h),_.XF=E[_.ixfe],L>0&&(_.z=Q[_.ixfe>>8&63]),ps(_,n,a.opts.Date1904),O({c:ee.c,r:ee.r},_,n);break;case 513:n.sheetStubs&&(_={ixfe:ee.ixfe,XF:E[ee.ixfe],t:"z"},L>0&&(_.z=Q[_.ixfe>>8&63]),ps(_,n,a.opts.Date1904),O({c:ee.c,r:ee.r},_,n));break;case 190:if(n.sheetStubs)for(var la=ee.c;la<=ee.C;++la){var Re=ee.ixfe[la-ee.c];_={ixfe:Re,XF:E[Re],t:"z"},L>0&&(_.z=Q[_.ixfe>>8&63]),ps(_,n,a.opts.Date1904),O({c:la,r:ee.r},_,n)}break;case 214:case 516:case 4:_=i0(ee.val,ee.ixfe,"s"),_.XF=E[_.ixfe],L>0&&(_.z=Q[_.ixfe>>8&63]),ps(_,n,a.opts.Date1904),O({c:ee.c,r:ee.r},_,n);break;case 0:case 512:K===1&&(o=ee);break;case 252:u=ee;break;case 1054:if(M.biff==4){Q[L++]=ee[1];for(var Qe=0;Qe<L+163&&ct[Qe]!=ee[1];++Qe);Qe>=163&&ri(ee[1],L+163)}else ri(ee[1],ee[0]);break;case 30:{Q[L++]=ee;for(var Et=0;Et<L+163&&ct[Et]!=ee;++Et);Et>=163&&ri(ee,L+163)}break;case 229:J=J.concat(ee);break;case 93:X[ee.cmo[0]]=M.lastobj=ee;break;case 438:M.lastobj.TxO=ee;break;case 127:M.lastobj.ImData=ee;break;case 440:for(b=ee[0].s.r;b<=ee[0].e.r;++b)for(g=ee[0].s.c;g<=ee[0].e.c;++g)N=n.dense?(s[b]||[])[g]:s[dt({c:g,r:b})],N&&(N.l=ee[1]);break;case 2048:for(b=ee[0].s.r;b<=ee[0].e.r;++b)for(g=ee[0].s.c;g<=ee[0].e.c;++g)N=n.dense?(s[b]||[])[g]:s[dt({c:g,r:b})],N&&N.l&&(N.l.Tooltip=ee[1]);break;case 28:{if(M.biff<=5&&M.biff>=2)break;N=n.dense?(s[ee[0].r]||[])[ee[0].c]:s[dt(ee[0])];var Ht=X[ee[2]];N||(n.dense?(s[ee[0].r]||(s[ee[0].r]=[]),N=s[ee[0].r][ee[0].c]={t:"z"}):N=s[dt(ee[0])]={t:"z"},o.e.r=Math.max(o.e.r,ee[0].r),o.s.r=Math.min(o.s.r,ee[0].r),o.e.c=Math.max(o.e.c,ee[0].c),o.s.c=Math.min(o.s.c,ee[0].c)),N.c||(N.c=[]),y={a:ee[1],t:Ht.TxO.t},N.c.push(y)}break;case 2173:EO(E[ee.ixfe],ee.ext);break;case 125:{if(!M.cellStyles)break;for(;ee.e>=ee.s;)fe[ee.e--]={width:ee.w/256,level:ee.level||0,hidden:!!(ee.flags&1)},H||(H=!0,Gg(ee.w/256)),ll(fe[ee.e+1])}break;case 520:{var Nt={};ee.level!=null&&(ne[ee.r]=Nt,Nt.level=ee.level),ee.hidden&&(ne[ee.r]=Nt,Nt.hidden=!0),ee.hpt&&(ne[ee.r]=Nt,Nt.hpt=ee.hpt,Nt.hpx=Ec(ee.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||no(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[V]]=ee;break;case 161:s["!margins"]||no(s["!margins"]={}),s["!margins"].header=ee.header,s["!margins"].footer=ee.footer;break;case 574:ee.RTL&&(S.Views[0].RTL=!0);break;case 146:C=ee;break;case 2198:G=ee;break;case 140:w=ee;break;case 442:x?P.CodeName=ee||P.name:S.WBProps.CodeName=ee||"ThisWorkbook";break}}else q||console.error("Missing Info for XLS Record 0x"+V.toString(16)),e.l+=le}return a.SheetNames=Tn(l).sort(function(Bn,ot){return Number(Bn)-Number(ot)}).map(function(Bn){return l[Bn].name}),n.bookSheets||(a.Sheets=r),!a.SheetNames.length&&m["!ref"]?(a.SheetNames.push("Sheet1"),a.Sheets&&(a.Sheets.Sheet1=m)):a.Preamble=m,a.Sheets&&I.forEach(function(Bn,ot){a.Sheets[a.SheetNames[ot]]["!autofilter"]=Bn}),a.Strings=u,a.SSF=un(ct),M.enc&&(a.Encryption=M.enc),G&&(a.Themes=G),a.Metadata={},w!==void 0&&(a.Metadata.Country=w),W.names.length>0&&(S.Names=W.names),a.Workbook=S,a}var Gd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function KH(e,n,a){var r=rt.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var s=VN(r,Ap,Gd.DSI);for(var l in s)n[l]=s[l]}catch(x){if(a.WTF)throw x}var o=rt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var d=VN(o,Fp,Gd.SI);for(var u in d)n[u]==null&&(n[u]=d[u])}catch(x){if(a.WTF)throw x}n.HeadingPairs&&n.TitlesOfParts&&(yk(n.HeadingPairs,n.TitlesOfParts,n,a),delete n.HeadingPairs,delete n.TitlesOfParts)}function zH(e,n){var a=[],r=[],s=[],l=0,o,d=gN(Ap,"n"),u=gN(Fp,"n");if(e.Props)for(o=Tn(e.Props),l=0;l<o.length;++l)(Object.prototype.hasOwnProperty.call(d,o[l])?a:Object.prototype.hasOwnProperty.call(u,o[l])?r:s).push([o[l],e.Props[o[l]]]);if(e.Custprops)for(o=Tn(e.Custprops),l=0;l<o.length;++l)Object.prototype.hasOwnProperty.call(e.Props||{},o[l])||(Object.prototype.hasOwnProperty.call(d,o[l])?a:Object.prototype.hasOwnProperty.call(u,o[l])?r:s).push([o[l],e.Custprops[o[l]]]);var x=[];for(l=0;l<s.length;++l)Tk.indexOf(s[l][0])>-1||gk.indexOf(s[l][0])>-1||s[l][1]!=null&&x.push(s[l]);r.length&&rt.utils.cfb_add(n,"/SummaryInformation",UN(r,Gd.SI,u,Fp)),(a.length||x.length)&&rt.utils.cfb_add(n,"/DocumentSummaryInformation",UN(a,Gd.DSI,d,Ap,x.length?x:null,Gd.UDI))}function ey(e,n){n||(n={}),ny(n),jg(),n.codepage&&Ng(n.codepage);var a,r;if(e.FullPaths){if(rt.find(e,"/encryption"))throw new Error("File is password-protected");a=rt.find(e,"!CompObj"),r=rt.find(e,"/Workbook")||rt.find(e,"/Book")}else{switch(n.type){case"base64":e=xr(vr(e));break;case"binary":e=xr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ha(e,0),r={content:e}}var s,l;if(a&&BH(a),n.bookProps&&!n.bookSheets)s={};else{var o=bt?"buffer":"array";if(r&&r.content)s=UH(r.content,n);else if((l=rt.find(e,"PerfectOffice_MAIN"))&&l.content)s=to.to_workbook(l.content,(n.type=o,n));else if((l=rt.find(e,"NativeContent_MAIN"))&&l.content)s=to.to_workbook(l.content,(n.type=o,n));else throw(l=rt.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&e.FullPaths&&rt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=aM(e))}var d={};return e.FullPaths&&KH(e,d,n),s.Props=s.Custprops=d,n.bookFiles&&(s.cfb=e),s}function $H(e,n){var a=n||{},r=rt.utils.cfb_new({root:"R"}),s="/Workbook";switch(a.bookType||"xls"){case"xls":a.bookType="biff8";case"xla":a.bookType||(a.bookType="xla");case"biff8":s="/Workbook",a.biff=8;break;case"biff5":s="/Book",a.biff=5;break;default:throw new Error("invalid type "+a.bookType+" for XLS CFB")}return rt.utils.cfb_add(r,s,bT(e,a)),a.biff==8&&(e.Props||e.Custprops)&&zH(e,r),a.biff==8&&e.vbaraw&&rM(r,rt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),r}var cu={0:{f:fR},1:{f:wR},2:{f:UR},3:{f:AR},4:{f:SR},5:{f:BR},6:{f:qR},7:{f:IR},8:{f:eB},9:{f:ZR},10:{f:YR},11:{f:JR},12:{f:TR},13:{f:zR},14:{f:LR},15:{f:ER},16:{f:hT},17:{f:XR},18:{f:MR},19:{f:Og},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:XB},40:{},42:{},43:{f:qI},44:{f:$I},45:{f:QI},46:{f:JI},47:{f:YI},48:{},49:{f:y8},50:{},51:{f:FO},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Ok},62:{f:GR},63:{f:VO},64:{f:pB},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:_a,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:hB},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:NR},148:{f:yR,p:16},151:{f:iB},152:{},153:{f:GB},154:{},155:{},156:{f:zB},157:{},158:{},159:{T:1,f:oI},160:{T:-1},161:{T:1,f:bo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:tB},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:DO},336:{T:-1},337:{f:IO,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Dp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ik},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:lB},427:{f:oB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:dB},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:bR},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:rB},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Dp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:JO},633:{T:1},634:{T:-1},635:{T:1,f:QO},636:{T:-1},637:{f:j8},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:LB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:gB},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Rp={6:{f:If},10:{f:Ri},12:{f:Rn},13:{f:Rn},14:{f:Dn},15:{f:Dn},16:{f:Ca},17:{f:Dn},18:{f:Dn},19:{f:Rn},20:{f:WN},21:{f:WN},23:{f:Ik},24:{f:QN},25:{f:Dn},26:{},27:{},28:{f:gP},29:{},34:{f:Dn},35:{f:XN},38:{f:Ca},39:{f:Ca},40:{f:Ca},41:{f:Ca},42:{f:Dn},43:{f:Dn},47:{f:EI},49:{f:zL},51:{f:Rn},60:{},61:{f:BL},64:{f:Dn},65:{f:KL},66:{f:Rn},77:{},80:{},81:{},82:{},85:{f:Rn},89:{},90:{},91:{},92:{f:_L},93:{f:bP},94:{},95:{f:Dn},96:{},97:{},99:{f:Dn},125:{f:Ok},128:{f:sP},129:{f:DL},130:{f:Rn},131:{f:Dn},132:{f:Dn},133:{f:AL},134:{},140:{f:_P},141:{f:Rn},144:{},146:{f:AP},151:{},152:{},153:{},154:{},155:{},156:{f:Rn},157:{},158:{},160:{f:RP},161:{f:PP},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:tP},190:{f:nP},193:{f:Ri},197:{},198:{},199:{},200:{},201:{},202:{f:Dn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Rn},220:{},221:{f:Dn},222:{},224:{f:rP},225:{f:SL},226:{f:Ri},227:{},229:{f:yP},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:LL},253:{f:GL},255:{f:IL},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Ck},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Dn},353:{f:Ri},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:dP},431:{f:Dn},432:{},433:{},434:{},437:{},438:{f:wP},439:{f:Dn},440:{f:kP},441:{},442:{f:Eu},443:{},444:{f:Rn},445:{},446:{},448:{f:Ri},449:{f:RL,r:2},450:{f:Ri},512:{f:$N},513:{f:MP},515:{f:oP},516:{f:WL},517:{f:qN},519:{f:BP},520:{f:OL},523:{},545:{f:YN},549:{f:zN},566:{},574:{f:VL},638:{f:eP},659:{},1048:{},1054:{f:QL},1084:{},1212:{f:mP},2048:{f:CP},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:a0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ri},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:FP,r:12},2173:{f:_O,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Dn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:xP,r:12},2197:{},2198:{f:jO,r:12},2199:{},2200:{},2201:{},2202:{f:fP,r:12},2203:{f:Ri},2204:{},2205:{},2206:{},2207:{},2211:{f:ML},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Rn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:IP},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:DP},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:$N},1:{},2:{f:zP},3:{f:UP},4:{f:VP},5:{f:qN},7:{f:GP},8:{},9:{f:a0},11:{},22:{f:Rn},30:{f:JL},31:{},32:{},33:{f:YN},36:{},37:{f:zN},50:{f:qP},62:{},52:{},67:{},68:{f:Rn},69:{},86:{},126:{},127:{f:HP},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:WP},223:{},234:{},354:{},421:{},518:{f:If},521:{f:a0},536:{f:QN},547:{f:XN},561:{},579:{},1030:{f:If},1033:{f:a0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ue(e,n,a,r){var s=n;if(!isNaN(s)){var l=r||(a||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,l),l>0&&Lg(a)&&e.push(a)}}function GH(e,n,a,r){var s=(a||[]).length||0;if(s<=8224)return Ue(e,n,a,s);var l=n;if(!isNaN(l)){for(var o=a.parts||[],d=0,u=0,x=0;x+(o[d]||8224)<=8224;)x+=o[d]||8224,d++;var m=e.next(4);for(m.write_shift(2,l),m.write_shift(2,x),e.push(a.slice(u,u+x)),u+=x;u<s;){for(m=e.next(4),m.write_shift(2,60),x=0;x+(o[d]||8224)<=8224;)x+=o[d]||8224,d++;m.write_shift(2,x),e.push(a.slice(u,u+x)),u+=x}}}function Lu(e,n,a){return e||(e=Te(7)),e.write_shift(2,n),e.write_shift(2,a),e.write_shift(2,0),e.write_shift(1,0),e}function qH(e,n,a,r){var s=Te(9);return Lu(s,e,n),Sk(a,r||"b",s),s}function WH(e,n,a){var r=Te(8+2*a.length);return Lu(r,e,n),r.write_shift(1,a.length),r.write_shift(a.length,a,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function XH(e,n,a,r){if(n.v!=null)switch(n.t){case"d":case"n":var s=n.t=="d"?Wn(dn(n.v)):n.v;s==(s|0)&&s>=0&&s<65536?Ue(e,2,$P(a,r,s)):Ue(e,3,KP(a,r,s));return;case"b":case"e":Ue(e,5,qH(a,r,n.v,n.t));return;case"s":case"str":Ue(e,4,WH(a,r,(n.v||"").slice(0,255)));return}Ue(e,1,Lu(null,a,r))}function QH(e,n,a,r){var s=Array.isArray(n),l=Pt(n["!ref"]||"A1"),o,d="",u=[];if(l.e.c>255||l.e.r>16383){if(r.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),o=gt(l)}for(var x=l.s.r;x<=l.e.r;++x){d=Ln(x);for(var m=l.s.c;m<=l.e.c;++m){x===l.s.r&&(u[m]=yn(m)),o=u[m]+d;var f=s?(n[x]||[])[m]:n[o];f&&XH(e,f,x,m)}}}function YH(e,n){for(var a=n||{},r=rr(),s=0,l=0;l<e.SheetNames.length;++l)e.SheetNames[l]==a.sheet&&(s=l);if(s==0&&a.sheet&&e.SheetNames[0]!=a.sheet)throw new Error("Sheet not found: "+a.sheet);return Ue(r,a.biff==4?1033:a.biff==3?521:9,Kg(e,16,a)),QH(r,e.Sheets[e.SheetNames[s]],s,a),Ue(r,10),r.end()}function JH(e,n,a){Ue(e,49,$L({sz:12,name:"Arial"},a))}function ZH(e,n,a){n&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)n[s]!=null&&Ue(e,1054,YL(s,n[s],a))})}function e9(e,n){var a=Te(19);a.write_shift(4,2151),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,1),a.write_shift(4,0),Ue(e,2151,a),a=Te(39),a.write_shift(4,2152),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,0),a.write_shift(4,0),a.write_shift(2,1),a.write_shift(4,4),a.write_shift(2,0),Fk(Pt(n["!ref"]||"A1"),a),a.write_shift(4,4),Ue(e,2152,a)}function t9(e,n){for(var a=0;a<16;++a)Ue(e,224,GN({numFmtId:0,style:!0},0,n));n.cellXfs.forEach(function(r){Ue(e,224,GN(r,0,n))})}function n9(e,n){for(var a=0;a<n["!links"].length;++a){var r=n["!links"][a];Ue(e,440,TP(r)),r[1].Tooltip&&Ue(e,2048,SP(r))}delete n["!links"]}function a9(e,n){if(n){var a=0;n.forEach(function(r,s){++a<=256&&r&&Ue(e,125,LP(px(s,r),s))})}}function r9(e,n,a,r,s){var l=16+ml(s.cellXfs,n,s);if(n.v==null&&!n.bf){Ue(e,513,ho(a,r,l));return}if(n.bf)Ue(e,6,D7(n,a,r,s,l));else switch(n.t){case"d":case"n":var o=n.t=="d"?Wn(dn(n.v)):n.v;Ue(e,515,cP(a,r,o,l));break;case"b":case"e":Ue(e,517,lP(a,r,n.v,l,s,n.t));break;case"s":case"str":if(s.bookSST){var d=Yg(s.Strings,n.v,s.revStrings);Ue(e,253,qL(a,r,d,l))}else Ue(e,516,XL(a,r,(n.v||"").slice(0,255),l,s));break;default:Ue(e,513,ho(a,r,l))}}function s9(e,n,a){var r=rr(),s=a.SheetNames[e],l=a.Sheets[s]||{},o=(a||{}).Workbook||{},d=(o.Sheets||[])[e]||{},u=Array.isArray(l),x=n.biff==8,m,f="",p=[],N=Pt(l["!ref"]||"A1"),y=x?65536:16384;if(N.e.c>255||N.e.r>=y){if(n.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");N.e.c=Math.min(N.e.c,255),N.e.r=Math.min(N.e.c,y-1)}Ue(r,2057,Kg(a,16,n)),Ue(r,13,Pr(1)),Ue(r,12,Pr(100)),Ue(r,15,Ma(!0)),Ue(r,17,Ma(!1)),Ue(r,16,co(.001)),Ue(r,95,Ma(!0)),Ue(r,42,Ma(!1)),Ue(r,43,Ma(!1)),Ue(r,130,Pr(1)),Ue(r,128,iP()),Ue(r,131,Ma(!1)),Ue(r,132,Ma(!1)),x&&a9(r,l["!cols"]),Ue(r,512,ZL(N,n)),x&&(l["!links"]=[]);for(var g=N.s.r;g<=N.e.r;++g){f=Ln(g);for(var b=N.s.c;b<=N.e.c;++b){g===N.s.r&&(p[b]=yn(b)),m=p[b]+f;var j=u?(l[g]||[])[b]:l[m];j&&(r9(r,j,g,b,n),x&&j.l&&l["!links"].push([m,j.l]))}}var T=d.CodeName||d.name||s;return x&&Ue(r,574,UL((o.Views||[])[0])),x&&(l["!merges"]||[]).length&&Ue(r,229,vP(l["!merges"])),x&&n9(r,l),Ue(r,442,_k(T)),x&&e9(r,l),Ue(r,10),r.end()}function i9(e,n,a){var r=rr(),s=(e||{}).Workbook||{},l=s.Sheets||[],o=s.WBProps||{},d=a.biff==8,u=a.biff==5;if(Ue(r,2057,Kg(e,5,a)),a.bookType=="xla"&&Ue(r,135),Ue(r,225,d?Pr(1200):null),Ue(r,193,lL(2)),u&&Ue(r,191),u&&Ue(r,192),Ue(r,226),Ue(r,92,EL("SheetJS",a)),Ue(r,66,Pr(d?1200:1252)),d&&Ue(r,353,Pr(0)),d&&Ue(r,448),Ue(r,317,OP(e.SheetNames.length)),d&&e.vbaraw&&Ue(r,211),d&&e.vbaraw){var x=o.CodeName||"ThisWorkbook";Ue(r,442,_k(x))}Ue(r,156,Pr(17)),Ue(r,25,Ma(!1)),Ue(r,18,Ma(!1)),Ue(r,19,Pr(0)),d&&Ue(r,431,Ma(!1)),d&&Ue(r,444,Pr(0)),Ue(r,61,HL()),Ue(r,64,Ma(!1)),Ue(r,141,Pr(0)),Ue(r,34,Ma(RB(e)=="true")),Ue(r,14,Ma(!0)),d&&Ue(r,439,Ma(!1)),Ue(r,218,Pr(0)),JH(r,e,a),ZH(r,e.SSF,a),t9(r,a),d&&Ue(r,352,Ma(!1));var m=r.end(),f=rr();d&&Ue(f,140,EP()),d&&a.Strings&&GH(f,252,PL(a.Strings)),Ue(f,10);var p=f.end(),N=rr(),y=0,g=0;for(g=0;g<e.SheetNames.length;++g)y+=(d?12:11)+(d?2:1)*e.SheetNames[g].length;var b=m.length+y+p.length;for(g=0;g<e.SheetNames.length;++g){var j=l[g]||{};Ue(N,133,FL({pos:b,hs:j.Hidden||0,dt:0,name:e.SheetNames[g]},a)),b+=n[g].length}var T=N.end();if(y!=T.length)throw new Error("BS8 "+y+" != "+T.length);var _=[];return m.length&&_.push(m),T.length&&_.push(T),p.length&&_.push(p),aa(_)}function l9(e,n){var a=n||{},r=[];e&&!e.SSF&&(e.SSF=un(ct)),e&&e.SSF&&(Oc(),cx(e.SSF),a.revssf=ux(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF),a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,ay(a),a.cellXfs=[],ml(a.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)r[r.length]=s9(s,a,e);return r.unshift(i9(e,r,a)),aa(r)}function bT(e,n){for(var a=0;a<=e.SheetNames.length;++a){var r=e.Sheets[e.SheetNames[a]];if(!(!r||!r["!ref"])){var s=sr(r["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[a]+"' extends beyond column IV (255).  Data may be lost.")}}var l=n||{};switch(l.biff||2){case 8:case 5:return l9(e,n);case 4:case 3:case 2:return YH(e,n)}throw new Error("invalid type "+l.bookType+" for BIFF")}function l2(e,n){var a=n||{},r=a.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),o=s.index,d=l&&l.index||e.length,u=$F(e.slice(o,d),/(:?<tr[^>]*>)/i,"<tr>"),x=-1,m=0,f=0,p=0,N={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(o=0;o<u.length;++o){var g=u[o].trim(),b=g.slice(0,3).toLowerCase();if(b=="<tr"){if(++x,a.sheetRows&&a.sheetRows<=x){--x;break}m=0;continue}if(!(b!="<td"&&b!="<th")){var j=g.split(/<\/t[dh]>/i);for(d=0;d<j.length;++d){var T=j[d].trim();if(T.match(/<t[dh]/i)){for(var _=T,w=0;_.charAt(0)=="<"&&(w=_.indexOf(">"))>-1;)_=_.slice(w+1);for(var E=0;E<y.length;++E){var C=y[E];C.s.c==m&&C.s.r<x&&x<=C.e.r&&(m=C.e.c+1,E=-1)}var S=ut(T.slice(0,T.indexOf(">")));p=S.colspan?+S.colspan:1,((f=+S.rowspan)>1||p>1)&&y.push({s:{r:x,c:m},e:{r:x+(f||1)-1,c:m+p-1}});var P=S.t||S["data-t"]||"";if(!_.length){m+=p;continue}if(_=$w(_),N.s.r>x&&(N.s.r=x),N.e.r<x&&(N.e.r=x),N.s.c>m&&(N.s.c=m),N.e.c<m&&(N.e.c=m),!_.length){m+=p;continue}var F={t:"s",v:_};a.raw||!_.trim().length||P=="s"||(_==="TRUE"?F={t:"b",v:!0}:_==="FALSE"?F={t:"b",v:!1}:isNaN(rs(_))?isNaN(Sc(_).getDate())||(F={t:"d",v:dn(_)},a.cellDates||(F={t:"n",v:Wn(F.v)}),F.z=a.dateNF||ct[14]):F={t:"n",v:rs(_)}),a.dense?(r[x]||(r[x]=[]),r[x][m]=F):r[dt({r:x,c:m})]=F,m+=p}}}}return r["!ref"]=gt(N),y.length&&(r["!merges"]=y),r}function o9(e,n,a,r){for(var s=e["!merges"]||[],l=[],o=n.s.c;o<=n.e.c;++o){for(var d=0,u=0,x=0;x<s.length;++x)if(!(s[x].s.r>a||s[x].s.c>o)&&!(s[x].e.r<a||s[x].e.c<o)){if(s[x].s.r<a||s[x].s.c<o){d=-1;break}d=s[x].e.r-s[x].s.r+1,u=s[x].e.c-s[x].s.c+1;break}if(!(d<0)){var m=dt({r:a,c:o}),f=r.dense?(e[a]||[])[o]:e[m],p=f&&f.v!=null&&(f.h||Dg(f.w||(ci(f),f.w)||""))||"",N={};d>1&&(N.rowspan=d),u>1&&(N.colspan=u),r.editable?p='<span contenteditable="true">'+p+"</span>":f&&(N["data-t"]=f&&f.t||"z",f.v!=null&&(N["data-v"]=f.v),f.z!=null&&(N["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+f.l.Target+'">'+p+"</a>")),N.id=(r.id||"sjs")+"-"+m,l.push(Ve("td",p,N))}}var y="<tr>";return y+l.join("")+"</tr>"}var c9='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',d9="</body></html>";function u9(e,n){var a=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!a||a.length==0)throw new Error("Invalid HTML: could not find <table>");if(a.length==1)return xl(l2(a[0],n),n);var r=ly();return a.forEach(function(s,l){oy(r,l2(s,n),"Sheet"+(l+1))}),r}function h9(e,n,a){var r=[];return r.join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}function NT(e,n){var a=n||{},r=a.header!=null?a.header:c9,s=a.footer!=null?a.footer:d9,l=[r],o=sr(e["!ref"]);a.dense=Array.isArray(e),l.push(h9(e,o,a));for(var d=o.s.r;d<=o.e.r;++d)l.push(o9(e,o,d,a));return l.push("</table>"+s),l.join("")}function jT(e,n,a){var r=a||{},s=0,l=0;if(r.origin!=null)if(typeof r.origin=="number")s=r.origin;else{var o=typeof r.origin=="string"?vn(r.origin):r.origin;s=o.r,l=o.c}var d=n.getElementsByTagName("tr"),u=Math.min(r.sheetRows||1e7,d.length),x={s:{r:0,c:0},e:{r:s,c:l}};if(e["!ref"]){var m=sr(e["!ref"]);x.s.r=Math.min(x.s.r,m.s.r),x.s.c=Math.min(x.s.c,m.s.c),x.e.r=Math.max(x.e.r,m.e.r),x.e.c=Math.max(x.e.c,m.e.c),s==-1&&(x.e.r=s=m.e.r+1)}var f=[],p=0,N=e["!rows"]||(e["!rows"]=[]),y=0,g=0,b=0,j=0,T=0,_=0;for(e["!cols"]||(e["!cols"]=[]);y<d.length&&g<u;++y){var w=d[y];if(o2(w)){if(r.display)continue;N[g]={hidden:!0}}var E=w.children;for(b=j=0;b<E.length;++b){var C=E[b];if(!(r.display&&o2(C))){var S=C.hasAttribute("data-v")?C.getAttribute("data-v"):C.hasAttribute("v")?C.getAttribute("v"):$w(C.innerHTML),P=C.getAttribute("data-z")||C.getAttribute("z");for(p=0;p<f.length;++p){var F=f[p];F.s.c==j+l&&F.s.r<g+s&&g+s<=F.e.r&&(j=F.e.c+1-l,p=-1)}_=+C.getAttribute("colspan")||1,((T=+C.getAttribute("rowspan")||1)>1||_>1)&&f.push({s:{r:g+s,c:j+l},e:{r:g+s+(T||1)-1,c:j+l+(_||1)-1}});var B={t:"s",v:S},O=C.getAttribute("data-t")||C.getAttribute("t")||"";S!=null&&(S.length==0?B.t=O||"z":r.raw||S.trim().length==0||O=="s"||(S==="TRUE"?B={t:"b",v:!0}:S==="FALSE"?B={t:"b",v:!1}:isNaN(rs(S))?isNaN(Sc(S).getDate())||(B={t:"d",v:dn(S)},r.cellDates||(B={t:"n",v:Wn(B.v)}),B.z=r.dateNF||ct[14]):B={t:"n",v:rs(S)})),B.z===void 0&&P!=null&&(B.z=P);var M="",G=C.getElementsByTagName("A");if(G&&G.length)for(var J=0;J<G.length&&!(G[J].hasAttribute("href")&&(M=G[J].getAttribute("href"),M.charAt(0)!="#"));++J);M&&M.charAt(0)!="#"&&(B.l={Target:M}),r.dense?(e[g+s]||(e[g+s]=[]),e[g+s][j+l]=B):e[dt({c:j+l,r:g+s})]=B,x.e.c<j+l&&(x.e.c=j+l),j+=_}}++g}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),x.e.r=Math.max(x.e.r,g-1+s),e["!ref"]=gt(x),g>=u&&(e["!fullref"]=gt((x.e.r=d.length-y+g-1+s,x))),e}function wT(e,n){var a=n||{},r=a.dense?[]:{};return jT(r,e,n)}function x9(e,n){return xl(wT(e,n),n)}function o2(e){var n="",a=m9(e);return a&&(n=a(e).getPropertyValue("display")),n||(n=e.style&&e.style.display),n==="none"}function m9(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function f9(e){var n=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),a=Lt(n.replace(/<[^>]*>/g,""));return[a]}var c2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function kT(e,n){var a=n||{},r=Ag(e),s=[],l,o,d={name:""},u="",x=0,m,f,p={},N=[],y=a.dense?[]:{},g,b,j={value:""},T="",_=0,w=[],E=-1,C=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,F={},B=[],O={},M=0,G=0,J=[],X=1,fe=1,ne=[],H={Names:[]},W={},xe=["",""],K=[],L={},Q="",I=0,R=!1,te=!1,ue=0;for(au.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=au.exec(r);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?y["!ref"]=gt(S):y["!ref"]="A1:A1",a.sheetRows>0&&a.sheetRows<=S.e.r&&(y["!fullref"]=y["!ref"],S.e.r=a.sheetRows-1,y["!ref"]=gt(S)),B.length&&(y["!merges"]=B),J.length&&(y["!rows"]=J),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),N.push(m.name),p[m.name]=y,te=!1):g[0].charAt(g[0].length-2)!=="/"&&(m=ut(g[0],!1),E=C=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,y=a.dense?[]:{},B=[],J=[],te=!0);break;case"table-row-group":g[1]==="/"?--P:++P;break;case"table-row":case"":if(g[1]==="/"){E+=X,X=1;break}if(f=ut(g[0],!1),f.?E=f.-1:E==-1&&(E=0),X=+f["number-rows-repeated"]||1,X<10)for(ue=0;ue<X;++ue)P>0&&(J[E+ue]={level:P});C=-1;break;case"covered-table-cell":g[1]!=="/"&&++C,a.sheetStubs&&(a.dense?(y[E]||(y[E]=[]),y[E][C]={t:"z"}):y[dt({r:E,c:C})]={t:"z"}),T="",w=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++C,j=ut(g[0],!1),fe=parseInt(j["number-columns-repeated"]||"1",10),b={t:"z",v:null},j.formula&&a.cellFormula!=!1&&(b.f=r2(Lt(j.formula))),(j.||j["value-type"])=="string"&&(b.t="s",b.v=Lt(j["string-value"]||""),a.dense?(y[E]||(y[E]=[]),y[E][C]=b):y[dt({r:E,c:C})]=b),C+=fe-1;else if(g[1]!=="/"){++C,T="",_=0,w=[],fe=1;var V=X?E+X-1:E;if(C>S.e.c&&(S.e.c=C),C<S.s.c&&(S.s.c=C),E<S.s.r&&(S.s.r=E),V>S.e.r&&(S.e.r=V),j=ut(g[0],!1),K=[],L={},b={t:j.||j["value-type"],v:null},a.cellFormula)if(j.formula&&(j.formula=Lt(j.formula)),j["number-matrix-columns-spanned"]&&j["number-matrix-rows-spanned"]&&(M=parseInt(j["number-matrix-rows-spanned"],10)||0,G=parseInt(j["number-matrix-columns-spanned"],10)||0,O={s:{r:E,c:C},e:{r:E+M-1,c:C+G-1}},b.F=gt(O),ne.push([O,b.F])),j.formula)b.f=r2(j.formula);else for(ue=0;ue<ne.length;++ue)E>=ne[ue][0].s.r&&E<=ne[ue][0].e.r&&C>=ne[ue][0].s.c&&C<=ne[ue][0].e.c&&(b.F=ne[ue][1]);switch((j["number-columns-spanned"]||j["number-rows-spanned"])&&(M=parseInt(j["number-rows-spanned"],10)||0,G=parseInt(j["number-columns-spanned"],10)||0,O={s:{r:E,c:C},e:{r:E+M-1,c:C+G-1}},B.push(O)),j["number-columns-repeated"]&&(fe=parseInt(j["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=on(j["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(j.value);break;case"percentage":b.t="n",b.v=parseFloat(j.value);break;case"currency":b.t="n",b.v=parseFloat(j.value);break;case"date":b.t="d",b.v=dn(j["date-value"]),a.cellDates||(b.t="n",b.v=Wn(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=UF(j["time-value"])/86400,a.cellDates&&(b.t="d",b.v=hx(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(j.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",j["string-value"]!=null&&(T=Lt(j["string-value"]),w=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(R=!1,b.t==="s"&&(b.v=T||"",w.length&&(b.R=w),R=_==0),W.Target&&(b.l=W),K.length>0&&(b.c=K,K=[]),T&&a.cellText!==!1&&(b.w=T),R&&(b.t="z",delete b.v),(!R||a.sheetStubs)&&!(a.sheetRows&&a.sheetRows<=E))for(var le=0;le<X;++le){if(fe=parseInt(j["number-columns-repeated"]||"1",10),a.dense)for(y[E+le]||(y[E+le]=[]),y[E+le][C]=le==0?b:un(b);--fe>0;)y[E+le][C+fe]=un(b);else for(y[dt({r:E+le,c:C})]=b;--fe>0;)y[dt({r:E+le,c:C+fe})]=un(b);S.e.c<=C&&(S.e.c=C)}fe=parseInt(j["number-columns-repeated"]||"1",10),C+=fe-1,fe=0,b={},T="",w=[]}W={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((l=s.pop())[0]!==g[3])throw"Bad state: "+l}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((l=s.pop())[0]!==g[3])throw"Bad state: "+l;L.t=T,w.length&&(L.R=w),L.a=Q,K.push(L)}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);Q="",I=0,T="",_=0,w=[];break;case"creator":g[1]==="/"?Q=r.slice(I,g.index):I=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((l=s.pop())[0]!==g[3])throw"Bad state: "+l}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);T="",_=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(F[d.name]=u,(l=s.pop())[0]!==g[3])throw"Bad state: "+l}else g[0].charAt(g[0].length-2)!=="/"&&(u="",d=ut(g[0],!1),s.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=ut(g[0],!1),u+=c2[g[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=ut(g[0],!1),u+=c2[g[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":u+=r.slice(x,g.index);break}else x=g.index+g[0].length;break;case"named-range":o=ut(g[0],!1),xe=Of(o["cell-range-address"]);var q={Name:o.name,Ref:xe[0]+"!"+xe[1]};te&&(q.Sheet=N.length),H.Names.push(q);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(g[1]==="/"&&(!j||!j["string-value"])){var Le=f9(r.slice(_,g.index));T=(T.length>0?T+`
`:"")+Le[0]}else ut(g[0],!1),_=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{xe=Of(ut(g[0])["target-range-address"]),p[xe[0]]["!autofilter"]={ref:xe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(W=ut(g[0],!1),!W.href)break;W.Target=Lt(W.href),delete W.href,W.Target.charAt(0)=="#"&&W.Target.indexOf(".")>-1?(xe=Of(W.Target.slice(1)),W.Target="#"+xe[0]+"!"+xe[1]):W.Target.match(/^\.\.[\\\/]/)&&(W.Target=W.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(a.WTF)throw new Error(g)}}var ee={Sheets:p,SheetNames:N,Workbook:H};return a.bookSheets&&delete ee.Sheets,ee}function d2(e,n){n=n||{},Fr(e,"META-INF/manifest.xml")&&U8(Mn(e,"META-INF/manifest.xml"),n);var a=mr(e,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var r=kT(Xt(a),n);return Fr(e,"meta.xml")&&(r.Props=fk(Mn(e,"meta.xml"))),r}function u2(e,n){return kT(e,n)}var p9=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),n="<office:document-styles "+nu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Pn+n}})(),h2=(function(){var e=function(l){return qt(l).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},n=`          <table:table-cell />
`,a=`          <table:covered-table-cell/>
`,r=function(l,o,d){var u=[];u.push('      <table:table table:name="'+qt(o.SheetNames[d])+`" table:style-name="ta1">
`);var x=0,m=0,f=sr(l["!ref"]||"A1"),p=l["!merges"]||[],N=0,y=Array.isArray(l);if(l["!cols"])for(m=0;m<=f.e.c;++m)u.push("        <table:table-column"+(l["!cols"][m]?' table:style-name="co'+l["!cols"][m].ods+'"':"")+`></table:table-column>
`);var g="",b=l["!rows"]||[];for(x=0;x<f.s.r;++x)g=b[x]?' table:style-name="ro'+b[x].ods+'"':"",u.push("        <table:table-row"+g+`></table:table-row>
`);for(;x<=f.e.r;++x){for(g=b[x]?' table:style-name="ro'+b[x].ods+'"':"",u.push("        <table:table-row"+g+`>
`),m=0;m<f.s.c;++m)u.push(n);for(;m<=f.e.c;++m){var j=!1,T={},_="";for(N=0;N!=p.length;++N)if(!(p[N].s.c>m)&&!(p[N].s.r>x)&&!(p[N].e.c<m)&&!(p[N].e.r<x)){(p[N].s.c!=m||p[N].s.r!=x)&&(j=!0),T["table:number-columns-spanned"]=p[N].e.c-p[N].s.c+1,T["table:number-rows-spanned"]=p[N].e.r-p[N].s.r+1;break}if(j){u.push(a);continue}var w=dt({r:x,c:m}),E=y?(l[x]||[])[m]:l[w];if(E&&E.f&&(T["table:formula"]=qt(O7(E.f)),E.F&&E.F.slice(0,w.length)==w)){var C=sr(E.F);T["table:number-matrix-columns-spanned"]=C.e.c-C.s.c+1,T["table:number-matrix-rows-spanned"]=C.e.r-C.s.r+1}if(!E){u.push(n);continue}switch(E.t){case"b":_=E.v?"TRUE":"FALSE",T["office:value-type"]="boolean",T["office:boolean-value"]=E.v?"true":"false";break;case"n":_=E.w||String(E.v||0),T["office:value-type"]="float",T["office:value"]=E.v||0;break;case"s":case"str":_=E.v==null?"":E.v,T["office:value-type"]="string";break;case"d":_=E.w||dn(E.v).toISOString(),T["office:value-type"]="date",T["office:date-value"]=dn(E.v).toISOString(),T["table:style-name"]="ce1";break;default:u.push(n);continue}var S=e(_);if(E.l&&E.l.Target){var P=E.l.Target;P=P.charAt(0)=="#"?"#"+M7(P.slice(1)):P,P.charAt(0)!="#"&&!P.match(/^\w+:/)&&(P="../"+P),S=Ve("text:a",S,{"xlink:href":P.replace(/&/g,"&amp;")})}u.push("          "+Ve("table:table-cell",Ve("text:p",S,{}),T)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},s=function(l,o){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var d=0;o.SheetNames.map(function(x){return o.Sheets[x]}).forEach(function(x){if(x&&x["!cols"]){for(var m=0;m<x["!cols"].length;++m)if(x["!cols"][m]){var f=x["!cols"][m];if(f.width==null&&f.wpx==null&&f.wch==null)continue;ll(f),f.ods=d;var p=x["!cols"][m].wpx+"px";l.push('  <style:style style:name="co'+d+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),l.push(`  </style:style>
`),++d}}});var u=0;o.SheetNames.map(function(x){return o.Sheets[x]}).forEach(function(x){if(x&&x["!rows"]){for(var m=0;m<x["!rows"].length;++m)if(x["!rows"][m]){x["!rows"][m].ods=u;var f=x["!rows"][m].hpx+"px";l.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),l.push(`  </style:style>
`),++u}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(o,d){var u=[Pn],x=nu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=nu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});d.bookType=="fods"?(u.push("<office:document"+x+m+`>
`),u.push(mk().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+x+`>
`),s(u,o),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)u.push(r(o.Sheets[o.SheetNames[f]],o,f));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),d.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}})();function TT(e,n){if(n.bookType=="fods")return h2(e,n);var a=Sg(),r="",s=[],l=[];return r="mimetype",yt(a,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",yt(a,r,h2(e,n)),s.push([r,"text/xml"]),l.push([r,"ContentFile"]),r="styles.xml",yt(a,r,p9(e,n)),s.push([r,"text/xml"]),l.push([r,"StylesFile"]),r="meta.xml",yt(a,r,Pn+mk()),s.push([r,"text/xml"]),l.push([r,"MetadataFile"]),r="manifest.rdf",yt(a,r,$8(l)),s.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",yt(a,r,K8(s)),a}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function xo(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Bp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Xt(hl(e))}function g9(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):xr(Ts(e))}function y9(e,n){e:for(var a=0;a<=e.length-n.length;++a){for(var r=0;r<n.length;++r)if(e[a+r]!=n[r])continue e;return!0}return!1}function cl(e){var n=e.reduce(function(s,l){return s+l.length},0),a=new Uint8Array(n),r=0;return e.forEach(function(s){a.set(s,r),r+=s.length}),a}function x2(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function v9(e,n){for(var a=(e[n+15]&127)<<7|e[n+14]>>1,r=e[n+14]&1,s=n+13;s>=n;--s)r=r*256+e[s];return(e[n+15]&128?-r:r)*Math.pow(10,a-6176)}function b9(e,n,a){var r=Math.floor(a==0?0:Math.LOG10E*Math.log(Math.abs(a)))+6176-20,s=a/Math.pow(10,r-6176);e[n+15]|=r>>7,e[n+14]|=(r&127)<<1;for(var l=0;s>=1;++l,s/=256)e[n+l]=s&255;e[n+15]|=a>=0?0:128}function du(e,n){var a=n?n[0]:0,r=e[a]&127;e:if(e[a++]>=128&&(r|=(e[a]&127)<<7,e[a++]<128||(r|=(e[a]&127)<<14,e[a++]<128)||(r|=(e[a]&127)<<21,e[a++]<128)||(r+=(e[a]&127)*Math.pow(2,28),++a,e[a++]<128)||(r+=(e[a]&127)*Math.pow(2,35),++a,e[a++]<128)||(r+=(e[a]&127)*Math.pow(2,42),++a,e[a++]<128)))break e;return n&&(n[0]=a),r}function zt(e){var n=new Uint8Array(7);n[0]=e&127;var a=1;e:if(e>127){if(n[a-1]|=128,n[a]=e>>7&127,++a,e<=16383||(n[a-1]|=128,n[a]=e>>14&127,++a,e<=2097151)||(n[a-1]|=128,n[a]=e>>21&127,++a,e<=268435455)||(n[a-1]|=128,n[a]=e/256>>>21&127,++a,e<=34359738367)||(n[a-1]|=128,n[a]=e/65536>>>21&127,++a,e<=4398046511103))break e;n[a-1]|=128,n[a]=e/16777216>>>21&127,++a}return n.slice(0,a)}function kn(e){var n=0,a=e[n]&127;e:if(e[n++]>=128){if(a|=(e[n]&127)<<7,e[n++]<128||(a|=(e[n]&127)<<14,e[n++]<128)||(a|=(e[n]&127)<<21,e[n++]<128))break e;a|=(e[n]&127)<<28}return a}function Ot(e){for(var n=[],a=[0];a[0]<e.length;){var r=a[0],s=du(e,a),l=s&7;s=Math.floor(s/8);var o=0,d;if(s==0)break;switch(l){case 0:{for(var u=a[0];e[a[0]++]>=128;);d=e.slice(u,a[0])}break;case 5:o=4,d=e.slice(a[0],a[0]+o),a[0]+=o;break;case 1:o=8,d=e.slice(a[0],a[0]+o),a[0]+=o;break;case 2:o=du(e,a),d=e.slice(a[0],a[0]+o),a[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(s," at offset ").concat(r))}var x={data:d,type:l};n[s]==null?n[s]=[x]:n[s].push(x)}return n}function ua(e){var n=[];return e.forEach(function(a,r){a.forEach(function(s){s.data&&(n.push(zt(r*8+s.type)),s.type==2&&n.push(zt(s.data.length)),n.push(s.data))})}),cl(n)}function ty(e,n){return(e==null?void 0:e.map(function(a){return n(a.data)}))||[]}function Dr(e){for(var n,a=[],r=[0];r[0]<e.length;){var s=du(e,r),l=Ot(e.slice(r[0],r[0]+s));r[0]+=s;var o={id:kn(l[1][0].data),messages:[]};l[2].forEach(function(d){var u=Ot(d.data),x=kn(u[3][0].data);o.messages.push({meta:u,data:e.slice(r[0],r[0]+x)}),r[0]+=x}),(n=l[3])!=null&&n[0]&&(o.merge=kn(l[3][0].data)>>>0>0),a.push(o)}return a}function ec(e){var n=[];return e.forEach(function(a){var r=[];r[1]=[{data:zt(a.id),type:0}],r[2]=[],a.merge!=null&&(r[3]=[{data:zt(+!!a.merge),type:0}]);var s=[];a.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:zt(o.data.length)}],r[2].push({data:ua(o.meta),type:2})});var l=ua(r);n.push(zt(l.length)),n.push(l),s.forEach(function(o){return n.push(o)})}),cl(n)}function N9(e,n){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var a=[0],r=du(n,a),s=[];a[0]<n.length;){var l=n[a[0]]&3;if(l==0){var o=n[a[0]++]>>2;if(o<60)++o;else{var d=o-59;o=n[a[0]],d>1&&(o|=n[a[0]+1]<<8),d>2&&(o|=n[a[0]+2]<<16),d>3&&(o|=n[a[0]+3]<<24),o>>>=0,o++,a[0]+=d}s.push(n.slice(a[0],a[0]+o)),a[0]+=o;continue}else{var u=0,x=0;if(l==1?(x=(n[a[0]]>>2&7)+4,u=(n[a[0]++]&224)<<3,u|=n[a[0]++]):(x=(n[a[0]++]>>2)+1,l==2?(u=n[a[0]]|n[a[0]+1]<<8,a[0]+=2):(u=(n[a[0]]|n[a[0]+1]<<8|n[a[0]+2]<<16|n[a[0]+3]<<24)>>>0,a[0]+=4)),s=[cl(s)],u==0)throw new Error("Invalid offset 0");if(u>s[0].length)throw new Error("Invalid offset beyond length");if(x>=u)for(s.push(s[0].slice(-u)),x-=u;x>=s[s.length-1].length;)s.push(s[s.length-1]),x-=s[s.length-1].length;s.push(s[0].slice(-u,-u+x))}}var m=cl(s);if(m.length!=r)throw new Error("Unexpected length: ".concat(m.length," != ").concat(r));return m}function Ar(e){for(var n=[],a=0;a<e.length;){var r=e[a++],s=e[a]|e[a+1]<<8|e[a+2]<<16;a+=3,n.push(N9(r,e.slice(a,a+s))),a+=s}if(a!==e.length)throw new Error("data is not a valid framed stream!");return cl(n)}function tc(e){for(var n=[],a=0;a<e.length;){var r=Math.min(e.length-a,268435455),s=new Uint8Array(4);n.push(s);var l=zt(r),o=l.length;n.push(l),r<=60?(o++,n.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,n.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,n.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,n.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,n.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),n.push(e.slice(a,a+r)),o+=r,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,a+=r}return cl(n)}function j9(e,n,a,r){var s=xo(e),l=s.getUint32(4,!0),o=(r>1?12:8)+x2(l&(r>1?3470:398))*4,d=-1,u=-1,x=NaN,m=new Date(2001,0,1);l&512&&(d=s.getUint32(o,!0),o+=4),o+=x2(l&(r>1?12288:4096))*4,l&16&&(u=s.getUint32(o,!0),o+=4),l&32&&(x=s.getFloat64(o,!0),o+=8),l&64&&(m.setTime(m.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:x};break;case 3:f={t:"s",v:n[u]};break;case 5:f={t:"d",v:m};break;case 6:f={t:"b",v:x>0};break;case 7:f={t:"n",v:x/86400};break;case 8:f={t:"e",v:0};break;case 9:if(d>-1)f={t:"s",v:a[d]};else if(u>-1)f={t:"s",v:n[u]};else if(!isNaN(x))f={t:"n",v:x};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function w9(e,n,a){var r=xo(e),s=r.getUint32(8,!0),l=12,o=-1,d=-1,u=NaN,x=NaN,m=new Date(2001,0,1);s&1&&(u=v9(e,l),l+=16),s&2&&(x=r.getFloat64(l,!0),l+=8),s&4&&(m.setTime(m.getTime()+r.getFloat64(l,!0)*1e3),l+=8),s&8&&(d=r.getUint32(l,!0),l+=4),s&16&&(o=r.getUint32(l,!0),l+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:n[d]};break;case 5:f={t:"d",v:m};break;case 6:f={t:"b",v:x>0};break;case 7:f={t:"n",v:x/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:a[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function Rf(e,n){var a=new Uint8Array(32),r=xo(a),s=12,l=0;switch(a[0]=5,e.t){case"n":a[1]=2,b9(a,s,e.v),l|=1,s+=16;break;case"b":a[1]=6,r.setFloat64(s,e.v?1:0,!0),l|=2,s+=8;break;case"s":if(n.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));a[1]=3,r.setUint32(s,n.indexOf(e.v),!0),l|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,l,!0),a.slice(0,s)}function Bf(e,n){var a=new Uint8Array(32),r=xo(a),s=12,l=0;switch(a[0]=3,e.t){case"n":a[2]=2,r.setFloat64(s,e.v,!0),l|=32,s+=8;break;case"b":a[2]=6,r.setFloat64(s,e.v?1:0,!0),l|=32,s+=8;break;case"s":if(n.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));a[2]=3,r.setUint32(s,n.indexOf(e.v),!0),l|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,l,!0),a.slice(0,s)}function k9(e,n,a){switch(e[0]){case 0:case 1:case 2:case 3:return j9(e,n,a,e[0]);case 5:return w9(e,n,a);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ja(e){var n=Ot(e);return du(n[1][0].data)}function m2(e,n){var a=Ot(n.data),r=kn(a[1][0].data),s=a[3],l=[];return(s||[]).forEach(function(o){var d=Ot(o.data),u=kn(d[1][0].data)>>>0;switch(r){case 1:l[u]=Bp(d[3][0].data);break;case 8:{var x=e[ja(d[9][0].data)][0],m=Ot(x.data),f=e[ja(m[1][0].data)][0],p=kn(f.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var N=Ot(f.data);l[u]=N[3].map(function(y){return Bp(y.data)}).join("")}break}}),l}function T9(e,n){var a,r,s,l,o,d,u,x,m,f,p,N,y,g,b=Ot(e),j=kn(b[1][0].data)>>>0,T=kn(b[2][0].data)>>>0,_=((r=(a=b[8])==null?void 0:a[0])==null?void 0:r.data)&&kn(b[8][0].data)>0||!1,w,E;if((l=(s=b[7])==null?void 0:s[0])!=null&&l.data&&n!=0)w=(d=(o=b[7])==null?void 0:o[0])==null?void 0:d.data,E=(x=(u=b[6])==null?void 0:u[0])==null?void 0:x.data;else if((f=(m=b[4])==null?void 0:m[0])!=null&&f.data&&n!=1)w=(N=(p=b[4])==null?void 0:p[0])==null?void 0:N.data,E=(g=(y=b[3])==null?void 0:y[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var C=_?4:1,S=xo(w),P=[],F=0;F<w.length/2;++F){var B=S.getUint16(F*2,!0);B<65535&&P.push([F,B])}if(P.length!=T)throw"Expected ".concat(T," cells, found ").concat(P.length);var O=[];for(F=0;F<P.length-1;++F)O[P[F][0]]=E.subarray(P[F][1]*C,P[F+1][1]*C);return P.length>=1&&(O[P[P.length-1][0]]=E.subarray(P[P.length-1][1]*C)),{R:j,cells:O}}function C9(e,n){var a,r=Ot(n.data),s=(a=r==null?void 0:r[7])!=null&&a[0]?kn(r[7][0].data)>>>0>0?1:0:-1,l=ty(r[5],function(o){return T9(o,s)});return{nrows:kn(r[4][0].data)>>>0,data:l.reduce(function(o,d){return o[d.R]||(o[d.R]=[]),d.cells.forEach(function(u,x){if(o[d.R][x])throw new Error("Duplicate cell r=".concat(d.R," c=").concat(x));o[d.R][x]=u}),o},[])}}function S9(e,n,a){var r,s=Ot(n.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(kn(s[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(l.e.c=(kn(s[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));a["!ref"]=gt(l);var o=Ot(s[4][0].data),d=m2(e,e[ja(o[4][0].data)][0]),u=(r=o[17])!=null&&r[0]?m2(e,e[ja(o[17][0].data)][0]):[],x=Ot(o[3][0].data),m=0;x[1].forEach(function(f){var p=Ot(f.data),N=e[ja(p[2][0].data)][0],y=kn(N.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var g=C9(e,N);g.data.forEach(function(b,j){b.forEach(function(T,_){var w=dt({r:m+j,c:_}),E=k9(T,d,u);E&&(a[w]=E)})}),m+=g.nrows})}function _9(e,n){var a=Ot(n.data),r={"!ref":"A1"},s=e[ja(a[2][0].data)],l=kn(s[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return S9(e,s[0],r),r}function E9(e,n){var a,r=Ot(n.data),s={name:(a=r[1])!=null&&a[0]?Bp(r[1][0].data):"",sheets:[]},l=ty(r[2],ja);return l.forEach(function(o){e[o].forEach(function(d){var u=kn(d.meta[1][0].data);u==6e3&&s.sheets.push(_9(e,d))})}),s}function D9(e,n){var a=ly(),r=Ot(n.data),s=ty(r[1],ja);if(s.forEach(function(l){e[l].forEach(function(o){var d=kn(o.meta[1][0].data);if(d==2){var u=E9(e,o);u.sheets.forEach(function(x,m){oy(a,x,m==0?u.name:u.name+"_"+m,!0)})}})}),a.SheetNames.length==0)throw new Error("Empty NUMBERS file");return a}function Hf(e){var n,a,r,s,l={},o=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var x;try{x=Ar(u.content)}catch(f){return console.log("?? "+u.content.length+" "+(f.message||f))}var m;try{m=Dr(x)}catch(f){return console.log("## "+(f.message||f))}m.forEach(function(f){l[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var d=((s=(r=(a=(n=l==null?void 0:l[1])==null?void 0:n[0])==null?void 0:a.meta)==null?void 0:r[1])==null?void 0:s[0].data)&&kn(l[1][0].meta[1][0].data)==1&&l[1][0];if(d||o.forEach(function(u){l[u].forEach(function(x){var m=kn(x.meta[1][0].data)>>>0;if(m==1)if(!d)d=x;else throw new Error("Document has multiple roots")})}),!d)throw new Error("Cannot find Document root");return D9(l,d)}function A9(e,n,a){var r,s,l,o;if(!((r=e[6])!=null&&r[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var d=((o=(l=e[8])==null?void 0:l[0])==null?void 0:o.data)&&kn(e[8][0].data)>0||!1;if(d)throw"Math only works with normal offsets";for(var u=0,x=xo(e[7][0].data),m=0,f=[],p=xo(e[4][0].data),N=0,y=[],g=0;g<n.length;++g){if(n[g]==null){x.setUint16(g*2,65535,!0),p.setUint16(g*2,65535);continue}x.setUint16(g*2,m,!0),p.setUint16(g*2,N,!0);var b,j;switch(typeof n[g]){case"string":b=Rf({t:"s",v:n[g]},a),j=Bf({t:"s",v:n[g]},a);break;case"number":b=Rf({t:"n",v:n[g]},a),j=Bf({t:"n",v:n[g]},a);break;case"boolean":b=Rf({t:"b",v:n[g]},a),j=Bf({t:"b",v:n[g]},a);break;default:throw new Error("Unsupported value "+n[g])}f.push(b),m+=b.length,y.push(j),N+=j.length,++u}for(e[2][0].data=zt(u);g<e[7][0].data.length/2;++g)x.setUint16(g*2,65535,!0),p.setUint16(g*2,65535,!0);return e[6][0].data=cl(f),e[3][0].data=cl(y),u}function F9(e,n){if(!n||!n.numbers)throw new Error("Must pass a `numbers` option -- check the README");var a=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=sr(a["!ref"]);r.s.r=r.s.c=0;var s=!1;r.e.c>9&&(s=!0,r.e.c=9),r.e.r>49&&(s=!0,r.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(gt(r)));var l=U0(a,{range:r,header:1}),o=["~Sh33tJ5~"];l.forEach(function(Q){return Q.forEach(function(I){typeof I=="string"&&o.push(I)})});var d={},u=[],x=rt.read(n.numbers,{type:"base64"});x.FileIndex.map(function(Q,I){return[Q,x.FullPaths[I]]}).forEach(function(Q){var I=Q[0],R=Q[1];if(I.type==2&&I.name.match(/\.iwa/)){var te=I.content,ue=Ar(te),V=Dr(ue);V.forEach(function(le){u.push(le.id),d[le.id]={deps:[],location:R,type:kn(le.messages[0].meta[1][0].data)}})}}),u.sort(function(Q,I){return Q-I});var m=u.filter(function(Q){return Q>1}).map(function(Q){return[Q,zt(Q)]});x.FileIndex.map(function(Q,I){return[Q,x.FullPaths[I]]}).forEach(function(Q){var I=Q[0];if(Q[1],!!I.name.match(/\.iwa/)){var R=Dr(Ar(I.content));R.forEach(function(te){te.messages.forEach(function(ue){m.forEach(function(V){te.messages.some(function(le){return kn(le.meta[1][0].data)!=11006&&y9(le.data,V[1])})&&d[V[0]].deps.push(te.id)})})})}});for(var f=rt.find(x,d[1].location),p=Dr(Ar(f.content)),N,y=0;y<p.length;++y){var g=p[y];g.id==1&&(N=g)}var b=ja(Ot(N.messages[0].data)[1][0].data);for(f=rt.find(x,d[b].location),p=Dr(Ar(f.content)),y=0;y<p.length;++y)g=p[y],g.id==b&&(N=g);for(b=ja(Ot(N.messages[0].data)[2][0].data),f=rt.find(x,d[b].location),p=Dr(Ar(f.content)),y=0;y<p.length;++y)g=p[y],g.id==b&&(N=g);for(b=ja(Ot(N.messages[0].data)[2][0].data),f=rt.find(x,d[b].location),p=Dr(Ar(f.content)),y=0;y<p.length;++y)g=p[y],g.id==b&&(N=g);var j=Ot(N.messages[0].data);{j[6][0].data=zt(r.e.r+1),j[7][0].data=zt(r.e.c+1);var T=ja(j[46][0].data),_=rt.find(x,d[T].location),w=Dr(Ar(_.content));{for(var E=0;E<w.length&&w[E].id!=T;++E);if(w[E].id!=T)throw"Bad ColumnRowUIDMapArchive";var C=Ot(w[E].messages[0].data);C[1]=[],C[2]=[],C[3]=[];for(var S=0;S<=r.e.c;++S){var P=[];P[1]=P[2]=[{type:0,data:zt(S+420690)}],C[1].push({type:2,data:ua(P)}),C[2].push({type:0,data:zt(S)}),C[3].push({type:0,data:zt(S)})}C[4]=[],C[5]=[],C[6]=[];for(var F=0;F<=r.e.r;++F)P=[],P[1]=P[2]=[{type:0,data:zt(F+726270)}],C[4].push({type:2,data:ua(P)}),C[5].push({type:0,data:zt(F)}),C[6].push({type:0,data:zt(F)});w[E].messages[0].data=ua(C)}_.content=tc(ec(w)),_.size=_.content.length,delete j[46];var B=Ot(j[4][0].data);{B[7][0].data=zt(r.e.r+1);var O=Ot(B[1][0].data),M=ja(O[2][0].data);_=rt.find(x,d[M].location),w=Dr(Ar(_.content));{if(w[0].id!=M)throw"Bad HeaderStorageBucket";var G=Ot(w[0].messages[0].data);for(F=0;F<l.length;++F){var J=Ot(G[2][0].data);J[1][0].data=zt(F),J[4][0].data=zt(l[F].length),G[2][F]={type:G[2][0].type,data:ua(J)}}w[0].messages[0].data=ua(G)}_.content=tc(ec(w)),_.size=_.content.length;var X=ja(B[2][0].data);_=rt.find(x,d[X].location),w=Dr(Ar(_.content));{if(w[0].id!=X)throw"Bad HeaderStorageBucket";for(G=Ot(w[0].messages[0].data),S=0;S<=r.e.c;++S)J=Ot(G[2][0].data),J[1][0].data=zt(S),J[4][0].data=zt(r.e.r+1),G[2][S]={type:G[2][0].type,data:ua(J)};w[0].messages[0].data=ua(G)}_.content=tc(ec(w)),_.size=_.content.length;var fe=ja(B[4][0].data);(function(){for(var Q=rt.find(x,d[fe].location),I=Dr(Ar(Q.content)),R,te=0;te<I.length;++te){var ue=I[te];ue.id==fe&&(R=ue)}var V=Ot(R.messages[0].data);{V[3]=[];var le=[];o.forEach(function(ee,ke){le[1]=[{type:0,data:zt(ke)}],le[2]=[{type:0,data:zt(1)}],le[3]=[{type:2,data:g9(ee)}],V[3].push({type:2,data:ua(le)})})}R.messages[0].data=ua(V);var q=ec(I),Le=tc(q);Q.content=Le,Q.size=Q.content.length})();var ne=Ot(B[3][0].data);{var H=ne[1][0];delete ne[2];var W=Ot(H.data);{var xe=ja(W[2][0].data);(function(){for(var Q=rt.find(x,d[xe].location),I=Dr(Ar(Q.content)),R,te=0;te<I.length;++te){var ue=I[te];ue.id==xe&&(R=ue)}var V=Ot(R.messages[0].data);{delete V[6],delete ne[7];var le=new Uint8Array(V[5][0].data);V[5]=[];for(var q=0,Le=0;Le<=r.e.r;++Le){var ee=Ot(le);q+=A9(ee,l[Le],o),ee[1][0].data=zt(Le),V[5].push({data:ua(ee),type:2})}V[1]=[{type:0,data:zt(r.e.c+1)}],V[2]=[{type:0,data:zt(r.e.r+1)}],V[3]=[{type:0,data:zt(q)}],V[4]=[{type:0,data:zt(r.e.r+1)}]}R.messages[0].data=ua(V);var ke=ec(I),Ke=tc(ke);Q.content=Ke,Q.size=Q.content.length})()}H.data=ua(W)}B[3][0].data=ua(ne)}j[4][0].data=ua(B)}N.messages[0].data=ua(j);var K=ec(p),L=tc(K);return f.content=L,f.size=f.content.length,x}function CT(e){return function(a){for(var r=0;r!=e.length;++r){var s=e[r];a[s[0]]===void 0&&(a[s[0]]=s[1]),s[2]==="n"&&(a[s[0]]=Number(a[s[0]]))}}}function ny(e){CT([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function ay(e){CT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function L9(e){return wt.WS.indexOf(e)>-1?"sheet":e==wt.CS?"chart":e==wt.DS?"dialog":e==wt.MS?"macro":e&&e.length?e:"sheet"}function P9(e,n){if(!e)return 0;try{e=n.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,L9(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function I9(e,n,a,r,s,l,o,d,u,x,m,f){try{l[r]=Ud(mr(e,a,!0),n);var p=Mn(e,n),N;switch(d){case"sheet":N=aH(p,n,s,u,l[r],x,m,f);break;case"chart":if(N=rH(p,n,s,u,l[r],x,m,f),!N||!N["!drawel"])break;var y=Id(N["!drawel"].Target,n),g=ru(y),b=zO(mr(e,y,!0),Ud(mr(e,g,!0),y)),j=Id(b,y),T=ru(j);N=AB(mr(e,j,!0),j,u,Ud(mr(e,T,!0),j),x,N);break;case"macro":N=sH(p,n,s,u,l[r],x,m,f);break;case"dialog":N=iH(p,n,s,u,l[r],x,m,f);break;default:throw new Error("Unrecognized sheet type "+d)}o[r]=N;var _=[];l&&l[r]&&Tn(l[r]).forEach(function(w){var E="";if(l[r][w].Type==wt.CMNT){E=Id(l[r][w].Target,n);var C=dH(Mn(e,E,!0),E,u);if(!C||!C.length)return;ZN(N,C,!1)}l[r][w].Type==wt.TCMNT&&(E=Id(l[r][w].Target,n),_=_.concat(GO(Mn(e,E,!0),u)))}),_&&_.length&&ZN(N,_,!0,u.people||[])}catch(w){if(u.WTF)throw w}}function _r(e){return e.charAt(0)=="/"?e.slice(1):e}function ST(e,n){if(Oc(),n=n||{},ny(n),Fr(e,"META-INF/manifest.xml")||Fr(e,"objectdata.xml"))return d2(e,n);if(Fr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Hf<"u"){if(e.FileIndex)return Hf(e);var a=rt.utils.cfb_new();return bN(e).forEach(function(J){yt(a,J,qF(e,J))}),Hf(a)}throw new Error("Unsupported NUMBERS file")}if(!Fr(e,"[Content_Types].xml"))throw Fr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Fr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=bN(e),s=H8(mr(e,"[Content_Types].xml")),l=!1,o,d;if(s.workbooks.length===0&&(d="xl/workbook.xml",Mn(e,d,!0)&&s.workbooks.push(d)),s.workbooks.length===0){if(d="xl/workbook.bin",!Mn(e,d,!0))throw new Error("Could not find workbook");s.workbooks.push(d),l=!0}s.workbooks[0].slice(-3)=="bin"&&(l=!0);var u={},x={};if(!n.bookSheets&&!n.bookProps){if(Kd=[],s.sst)try{Kd=cH(Mn(e,_r(s.sst)),s.sst,n)}catch(J){if(n.WTF)throw J}n.cellStyles&&s.themes.length&&(u=oH(mr(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],n)),s.style&&(x=lH(Mn(e,_r(s.style)),s.style,u,n))}s.links.map(function(J){try{var X=Ud(mr(e,ru(_r(J))),J);return hH(Mn(e,_r(J)),X,J,n)}catch{}});var m=nH(Mn(e,_r(s.workbooks[0])),s.workbooks[0],n),f={},p="";s.coreprops.length&&(p=Mn(e,_r(s.coreprops[0]),!0),p&&(f=fk(p)),s.extprops.length!==0&&(p=Mn(e,_r(s.extprops[0]),!0),p&&q8(p,f,n)));var N={};(!n.bookSheets||n.bookProps)&&s.custprops.length!==0&&(p=mr(e,_r(s.custprops[0]),!0),p&&(N=X8(p,n)));var y={};if((n.bookSheets||n.bookProps)&&(m.Sheets?o=m.Sheets.map(function(X){return X.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),n.bookProps&&(y.Props=f,y.Custprops=N),n.bookSheets&&typeof o<"u"&&(y.SheetNames=o),n.bookSheets?y.SheetNames:n.bookProps))return y;o={};var g={};n.bookDeps&&s.calcchain&&(g=uH(Mn(e,_r(s.calcchain)),s.calcchain));var b=0,j={},T,_;{var w=m.Sheets;f.Worksheets=w.length,f.SheetNames=[];for(var E=0;E!=w.length;++E)f.SheetNames[E]=w[E].name}var C=l?"bin":"xml",S=s.workbooks[0].lastIndexOf("/"),P=(s.workbooks[0].slice(0,S+1)+"_rels/"+s.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");Fr(e,P)||(P="xl/_rels/workbook."+C+".rels");var F=Ud(mr(e,P,!0),P.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(n.xlmeta=xH(Mn(e,_r(s.metadata[0])),s.metadata[0],n)),(s.people||[]).length>=1&&(n.people=WO(Mn(e,_r(s.people[0])),n)),F&&(F=P9(F,m.Sheets));var B=Mn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=f.Worksheets;++b){var O="sheet";if(F&&F[b]?(T="xl/"+F[b][1].replace(/[\/]?xl\//,""),Fr(e,T)||(T=F[b][1]),Fr(e,T)||(T=P.replace(/_rels\/.*$/,"")+F[b][1]),O=F[b][2]):(T="xl/worksheets/sheet"+(b+1-B)+"."+C,T=T.replace(/sheet0\./,"sheet.")),_=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(b!=n.sheets)continue e;break;case"string":if(f.SheetNames[b].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var M=!1,G=0;G!=n.sheets.length;++G)typeof n.sheets[G]=="number"&&n.sheets[G]==b&&(M=1),typeof n.sheets[G]=="string"&&n.sheets[G].toLowerCase()==f.SheetNames[b].toLowerCase()&&(M=1);if(!M)continue e}}I9(e,T,_,f.SheetNames[b],b,j,o,O,n,m,u,x)}return y={Directory:s,Workbook:m,Props:f,Custprops:N,Deps:g,Sheets:o,SheetNames:f.SheetNames,Strings:Kd,Styles:x,Themes:u,SSF:un(ct)},n&&n.bookFiles&&(e.files?(y.keys=r,y.files=e.files):(y.keys=[],y.files={},e.FullPaths.forEach(function(J,X){J=J.replace(/^Root Entry[\/]/,""),y.keys.push(J),y.files[J]=e.FileIndex[X]}))),n&&n.bookVBA&&(s.vba.length>0?y.vbaraw=Mn(e,_r(s.vba[0]),!0):s.defaults&&s.defaults.bin===nM&&(y.vbaraw=Mn(e,"xl/vbaProject.bin",!0))),y}function O9(e,n){var a=n||{},r="Workbook",s=rt.find(e,r);try{if(r="/!DataSpaces/Version",s=rt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(xI(s.content),r="/!DataSpaces/DataSpaceMap",s=rt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=fI(s.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=rt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=pI(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=rt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);yI(s.content)}catch{}if(r="/EncryptionInfo",s=rt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var d=vI(s.content);if(r="/EncryptedPackage",s=rt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(d[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(d[1],s.content,a.password||"",a);if(d[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(d[1],s.content,a.password||"",a);throw new Error("File is password-protected")}function M9(e,n){return n.bookType=="ods"?TT(e,n):n.bookType=="numbers"?F9(e,n):n.bookType=="xlsb"?R9(e,n):B9(e,n)}function R9(e,n){sc=1024,e&&!e.SSF&&(e.SSF=un(ct)),e&&e.SSF&&(Oc(),cx(e.SSF),n.revssf=ux(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,zd?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var a=n.bookType=="xlsb"?"bin":"xml",r=eT.indexOf(n.bookType)>-1,s=Vg();ay(n=n||{});var l=Sg(),o="",d=0;if(n.cellXfs=[],ml(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",yt(l,o,pk(e.Props,n)),s.coreprops.push(o),$t(n.rels,2,o,wt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],x=0;x<e.SheetNames.length;++x)(e.Workbook.Sheets[x]||{}).Hidden!=2&&u.push(e.SheetNames[x]);e.Props.SheetNames=u}for(e.Props.Worksheets=e.Props.SheetNames.length,yt(l,o,vk(e.Props)),s.extprops.push(o),$t(n.rels,3,o,wt.EXT_PROPS),e.Custprops!==e.Props&&Tn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",yt(l,o,bk(e.Custprops)),s.custprops.push(o),$t(n.rels,4,o,wt.CUST_PROPS)),d=1;d<=e.SheetNames.length;++d){var m={"!id":{}},f=e.Sheets[e.SheetNames[d-1]],p=(f||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+d+"."+a,yt(l,o,fH(d-1,o,n,e,m)),s.sheets.push(o),$t(n.wbrels,-1,"worksheets/sheet"+d+"."+a,wt.WS[0])}if(f){var N=f["!comments"],y=!1,g="";N&&N.length>0&&(g="xl/comments"+d+"."+a,yt(l,g,yH(N,g)),s.comments.push(g),$t(m,-1,"../comments"+d+"."+a,wt.CMNT),y=!0),f["!legacy"]&&y&&yt(l,"xl/drawings/vmlDrawing"+d+".vml",Jk(d,f["!comments"])),delete f["!comments"],delete f["!legacy"]}m["!id"].rId1&&yt(l,ru(o),lc(m))}return n.Strings!=null&&n.Strings.length>0&&(o="xl/sharedStrings."+a,yt(l,o,gH(n.Strings,o,n)),s.strs.push(o),$t(n.wbrels,-1,"sharedStrings."+a,wt.SST)),o="xl/workbook."+a,yt(l,o,mH(e,o)),s.workbooks.push(o),$t(n.rels,1,o,wt.WB),o="xl/theme/theme1.xml",yt(l,o,qg(e.Themes,n)),s.themes.push(o),$t(n.wbrels,-1,"theme/theme1.xml",wt.THEME),o="xl/styles."+a,yt(l,o,pH(e,o,n)),s.styles.push(o),$t(n.wbrels,-1,"styles."+a,wt.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",yt(l,o,e.vbaraw),s.vba.push(o),$t(n.wbrels,-1,"vbaProject.bin",wt.VBA)),o="xl/metadata."+a,yt(l,o,vH(o)),s.metadata.push(o),$t(n.wbrels,-1,"metadata."+a,wt.XLMETA),yt(l,"[Content_Types].xml",xk(s,n)),yt(l,"_rels/.rels",lc(n.rels)),yt(l,"xl/_rels/workbook."+a+".rels",lc(n.wbrels)),delete n.revssf,delete n.ssf,l}function B9(e,n){sc=1024,e&&!e.SSF&&(e.SSF=un(ct)),e&&e.SSF&&(Oc(),cx(e.SSF),n.revssf=ux(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,zd?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var a="xml",r=eT.indexOf(n.bookType)>-1,s=Vg();ay(n=n||{});var l=Sg(),o="",d=0;if(n.cellXfs=[],ml(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",yt(l,o,pk(e.Props,n)),s.coreprops.push(o),$t(n.rels,2,o,wt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],x=0;x<e.SheetNames.length;++x)(e.Workbook.Sheets[x]||{}).Hidden!=2&&u.push(e.SheetNames[x]);e.Props.SheetNames=u}e.Props.Worksheets=e.Props.SheetNames.length,yt(l,o,vk(e.Props)),s.extprops.push(o),$t(n.rels,3,o,wt.EXT_PROPS),e.Custprops!==e.Props&&Tn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",yt(l,o,bk(e.Custprops)),s.custprops.push(o),$t(n.rels,4,o,wt.CUST_PROPS));var m=["SheetJ5"];for(n.tcid=0,d=1;d<=e.SheetNames.length;++d){var f={"!id":{}},p=e.Sheets[e.SheetNames[d-1]],N=(p||{})["!type"]||"sheet";switch(N){case"chart":default:o="xl/worksheets/sheet"+d+"."+a,yt(l,o,uT(d-1,n,e,f)),s.sheets.push(o),$t(n.wbrels,-1,"worksheets/sheet"+d+"."+a,wt.WS[0])}if(p){var y=p["!comments"],g=!1,b="";if(y&&y.length>0){var j=!1;y.forEach(function(T){T[1].forEach(function(_){_.T==!0&&(j=!0)})}),j&&(b="xl/threadedComments/threadedComment"+d+"."+a,yt(l,b,qO(y,m,n)),s.threadedcomments.push(b),$t(f,-1,"../threadedComments/threadedComment"+d+"."+a,wt.TCMNT)),b="xl/comments"+d+"."+a,yt(l,b,Zk(y)),s.comments.push(b),$t(f,-1,"../comments"+d+"."+a,wt.CMNT),g=!0}p["!legacy"]&&g&&yt(l,"xl/drawings/vmlDrawing"+d+".vml",Jk(d,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&yt(l,ru(o),lc(f))}return n.Strings!=null&&n.Strings.length>0&&(o="xl/sharedStrings."+a,yt(l,o,Hk(n.Strings,n)),s.strs.push(o),$t(n.wbrels,-1,"sharedStrings."+a,wt.SST)),o="xl/workbook."+a,yt(l,o,pT(e)),s.workbooks.push(o),$t(n.rels,1,o,wt.WB),o="xl/theme/theme1.xml",yt(l,o,qg(e.Themes,n)),s.themes.push(o),$t(n.wbrels,-1,"theme/theme1.xml",wt.THEME),o="xl/styles."+a,yt(l,o,Wk(e,n)),s.styles.push(o),$t(n.wbrels,-1,"styles."+a,wt.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",yt(l,o,e.vbaraw),s.vba.push(o),$t(n.wbrels,-1,"vbaProject.bin",wt.VBA)),o="xl/metadata."+a,yt(l,o,Yk()),s.metadata.push(o),$t(n.wbrels,-1,"metadata."+a,wt.XLMETA),m.length>1&&(o="xl/persons/person.xml",yt(l,o,XO(m)),s.people.push(o),$t(n.wbrels,-1,"persons/person.xml",wt.PEOPLE)),yt(l,"[Content_Types].xml",xk(s,n)),yt(l,"_rels/.rels",lc(n.rels)),yt(l,"xl/_rels/workbook."+a+".rels",lc(n.wbrels)),delete n.revssf,delete n.ssf,l}function ry(e,n){var a="";switch((n||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":a=vr(e.slice(0,12));break;case"binary":a=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3),a.charCodeAt(4),a.charCodeAt(5),a.charCodeAt(6),a.charCodeAt(7)]}function H9(e,n){return rt.find(e,"EncryptedPackage")?O9(e,n):ey(e,n)}function V9(e,n){var a,r=e,s=n||{};return s.type||(s.type=bt&&Buffer.isBuffer(e)?"buffer":"base64"),a=Uw(r,s),ST(a,s)}function _T(e,n){var a=0;e:for(;a<e.length;)switch(e.charCodeAt(a)){case 10:case 13:case 32:++a;break;case 60:return Mp(e.slice(a),n);default:break e}return _c.to_workbook(e,n)}function U9(e,n){var a="",r=ry(e,n);switch(n.type){case"base64":a=vr(e);break;case"binary":a=e;break;case"buffer":a=e.toString("binary");break;case"array":a=oo(e);break;default:throw new Error("Unrecognized type "+n.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(a=Xt(a)),n.type="binary",_T(a,n)}function K9(e,n){var a=e;return n.type=="base64"&&(a=vr(a)),a=Jd.utils.decode(1200,a.slice(2),"str"),n.type="binary",_T(a,n)}function z9(e){return e.match(/[^\x00-\x7F]/)?Ts(e):e}function Vf(e,n,a,r){return r?(a.type="string",_c.to_workbook(e,a)):_c.to_workbook(n,a)}function Hp(e,n){jg();var a=n||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Hp(new Uint8Array(e),(a=un(a),a.type="array",a));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!a.type&&(a.type=typeof Deno<"u"?"buffer":"array");var r=e,s=[0,0,0,0],l=!1;if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),cc={},a.dateNF&&(cc.dateNF=a.dateNF),a.type||(a.type=bt&&Buffer.isBuffer(e)?"buffer":"base64"),a.type=="file"&&(a.type=bt?"buffer":"binary",r=BF(e),typeof Uint8Array<"u"&&!bt&&(a.type="array")),a.type=="string"&&(l=!0,a.type="binary",a.codepage=65001,r=z9(e)),a.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),d=new Uint8Array(o);if(d.foo="bar",!d.foo)return a=un(a),a.type="array",Hp(wg(r),a)}switch((s=ry(r,a))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return H9(rt.read(r,a),a);break;case 9:if(s[1]<=8)return ey(r,a);break;case 60:return Mp(r,a);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return QP(r,a);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return Rk.to_workbook(r,a);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?V9(r,a):Vf(e,r,a,l);case 239:return s[3]===60?Mp(r,a):Vf(e,r,a,l);case 255:if(s[1]===254)return K9(r,a);if(s[1]===0&&s[2]===2&&s[3]===0)return to.to_workbook(r,a);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return to.to_workbook(r,a);break;case 3:case 131:case 139:case 140:return Op.to_workbook(r,a);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return $k.to_workbook(r,a);break;case 10:case 13:case 32:return U9(r,a);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return XP.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Op.to_workbook(r,a):Vf(e,r,a,l)}function ET(e,n){switch(n.type){case"base64":case"binary":break;case"buffer":case"array":n.type="";break;case"file":return Cu(n.file,rt.write(e,{type:bt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");default:throw new Error("Unrecognized type "+n.type)}return rt.write(e,n)}function $9(e,n){var a=un(n||{}),r=M9(e,a);return G9(r,a)}function G9(e,n){var a={},r=bt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(n.compression&&(a.compression="DEFLATE"),n.password)a.type=r;else switch(n.type){case"base64":a.type="base64";break;case"binary":a.type="string";break;case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");case"buffer":case"file":a.type=r;break;default:throw new Error("Unrecognized type "+n.type)}var s=e.FullPaths?rt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[a.type]||a.type,compression:!!n.compression}):e.generate(a);if(typeof Deno<"u"&&typeof s=="string"){if(n.type=="binary"||n.type=="base64")return s;s=new Uint8Array(ox(s))}return n.password&&typeof encrypt_agile<"u"?ET(encrypt_agile(s,n.password),n):n.type==="file"?Cu(n.file,s):n.type=="string"?Xt(s):s}function q9(e,n){var a=n||{},r=$H(e,a);return ET(r,a)}function ys(e,n,a){a||(a="");var r=a+e;switch(n.type){case"base64":return Zd(Ts(r));case"binary":return Ts(r);case"string":return e;case"file":return Cu(n.file,r,"utf8");case"buffer":return bt?ui(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):ys(r,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function W9(e,n){switch(n.type){case"base64":return Zd(e);case"binary":return e;case"string":return e;case"file":return Cu(n.file,e,"binary");case"buffer":return bt?ui(e,"binary"):e.split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function l0(e,n){switch(n.type){case"string":case"base64":case"binary":for(var a="",r=0;r<e.length;++r)a+=String.fromCharCode(e[r]);return n.type=="base64"?Zd(a):n.type=="string"?Xt(a):a;case"file":return Cu(n.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+n.type)}}function sy(e,n){jg(),VB(e);var a=un(n||{});if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),a.type=="array"){a.type="binary";var r=sy(e,a);return a.type="array",ox(r)}var s=0;if(a.sheet&&(typeof a.sheet=="number"?s=a.sheet:s=e.SheetNames.indexOf(a.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+a.sheet+" : "+typeof a.sheet);switch(a.bookType||"xlsb"){case"xml":case"xlml":return ys(RH(e,a),a);case"slk":case"sylk":return ys(Mk.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"htm":case"html":return ys(NT(e.Sheets[e.SheetNames[s]],a),a);case"txt":return W9(DT(e.Sheets[e.SheetNames[s]],a),a);case"csv":return ys(iy(e.Sheets[e.SheetNames[s]],a),a,"\uFEFF");case"dif":return ys(Rk.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"dbf":return l0(Op.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"prn":return ys(_c.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"rtf":return ys($k.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"eth":return ys(Bk.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"fods":return ys(TT(e,a),a);case"wk1":return l0(to.sheet_to_wk1(e.Sheets[e.SheetNames[s]],a),a);case"wk3":return l0(to.book_to_wk3(e,a),a);case"biff2":a.biff||(a.biff=2);case"biff3":a.biff||(a.biff=3);case"biff4":return a.biff||(a.biff=4),l0(bT(e,a),a);case"biff5":a.biff||(a.biff=5);case"biff8":case"xla":case"xls":return a.biff||(a.biff=8),q9(e,a);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return $9(e,a);default:throw new Error("Unrecognized bookType |"+a.bookType+"|")}}function X9(e){if(!e.bookType){var n={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},a=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();a.match(/^\.[a-z]+$/)&&(e.bookType=a.slice(1)),e.bookType=n[e.bookType]||e.bookType}}function V0(e,n,a){var r={};return r.type="file",r.file=n,X9(r),sy(e,r)}function Q9(e,n,a,r,s,l,o,d){var u=Ln(a),x=d.defval,m=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),f=!0,p=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:a,enumerable:!1})}catch{p.__rowNum__=a}else p.__rowNum__=a;if(!o||e[a])for(var N=n.s.c;N<=n.e.c;++N){var y=o?e[a][N]:e[r[N]+u];if(y===void 0||y.t===void 0){if(x===void 0)continue;l[N]!=null&&(p[l[N]]=x);continue}var g=y.v;switch(y.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(l[N]!=null){if(g==null)if(y.t=="e"&&g===null)p[l[N]]=null;else if(x!==void 0)p[l[N]]=x;else if(m&&g===null)p[l[N]]=null;else continue;else p[l[N]]=m&&(y.t!=="n"||y.t==="n"&&d.rawNumbers!==!1)?g:ci(y,g,d);g!=null&&(f=!1)}}return{row:p,isempty:f}}function U0(e,n){if(e==null||e["!ref"]==null)return[];var a={t:"n",v:0},r=0,s=1,l=[],o=0,d="",u={s:{r:0,c:0},e:{r:0,c:0}},x=n||{},m=x.range!=null?x.range:e["!ref"];switch(x.header===1?r=1:x.header==="A"?r=2:Array.isArray(x.header)?r=3:x.header==null&&(r=0),typeof m){case"string":u=Pt(m);break;case"number":u=Pt(e["!ref"]),u.s.r=m;break;default:u=m}r>0&&(s=0);var f=Ln(u.s.r),p=[],N=[],y=0,g=0,b=Array.isArray(e),j=u.s.r,T=0,_={};b&&!e[j]&&(e[j]=[]);var w=x.skipHidden&&e["!cols"]||[],E=x.skipHidden&&e["!rows"]||[];for(T=u.s.c;T<=u.e.c;++T)if(!(w[T]||{}).hidden)switch(p[T]=yn(T),a=b?e[j][T]:e[p[T]+f],r){case 1:l[T]=T-u.s.c;break;case 2:l[T]=p[T];break;case 3:l[T]=x.header[T-u.s.c];break;default:if(a==null&&(a={w:"__EMPTY",t:"s"}),d=o=ci(a,null,x),g=_[o]||0,!g)_[o]=1;else{do d=o+"_"+g++;while(_[d]);_[o]=g,_[d]=1}l[T]=d}for(j=u.s.r+s;j<=u.e.r;++j)if(!(E[j]||{}).hidden){var C=Q9(e,u,j,p,r,l,b,x);(C.isempty===!1||(r===1?x.blankrows!==!1:x.blankrows))&&(N[y++]=C.row)}return N.length=y,N}var f2=/"/g;function Y9(e,n,a,r,s,l,o,d){for(var u=!0,x=[],m="",f=Ln(a),p=n.s.c;p<=n.e.c;++p)if(r[p]){var N=d.dense?(e[a]||[])[p]:e[r[p]+f];if(N==null)m="";else if(N.v!=null){u=!1,m=""+(d.rawNumbers&&N.t=="n"?N.v:ci(N,null,d));for(var y=0,g=0;y!==m.length;++y)if((g=m.charCodeAt(y))===s||g===l||g===34||d.forceQuotes){m='"'+m.replace(f2,'""')+'"';break}m=="ID"&&(m='"ID"')}else N.f!=null&&!N.F?(u=!1,m="="+N.f,m.indexOf(",")>=0&&(m='"'+m.replace(f2,'""')+'"')):m="";x.push(m)}return d.blankrows===!1&&u?null:x.join(o)}function iy(e,n){var a=[],r=n??{};if(e==null||e["!ref"]==null)return"";var s=Pt(e["!ref"]),l=r.FS!==void 0?r.FS:",",o=l.charCodeAt(0),d=r.RS!==void 0?r.RS:`
`,u=d.charCodeAt(0),x=new RegExp((l=="|"?"\\|":l)+"+$"),m="",f=[];r.dense=Array.isArray(e);for(var p=r.skipHidden&&e["!cols"]||[],N=r.skipHidden&&e["!rows"]||[],y=s.s.c;y<=s.e.c;++y)(p[y]||{}).hidden||(f[y]=yn(y));for(var g=0,b=s.s.r;b<=s.e.r;++b)(N[b]||{}).hidden||(m=Y9(e,s,b,f,o,u,l,r),m!=null&&(r.strip&&(m=m.replace(x,"")),(m||r.blankrows!==!1)&&a.push((g++?d:"")+m)));return delete r.dense,a.join("")}function DT(e,n){n||(n={}),n.FS="	",n.RS=`
`;var a=iy(e,n);return a}function J9(e){var n="",a,r="";if(e==null||e["!ref"]==null)return[];var s=Pt(e["!ref"]),l="",o=[],d,u=[],x=Array.isArray(e);for(d=s.s.c;d<=s.e.c;++d)o[d]=yn(d);for(var m=s.s.r;m<=s.e.r;++m)for(l=Ln(m),d=s.s.c;d<=s.e.c;++d)if(n=o[d]+l,a=x?(e[m]||[])[d]:e[n],r="",a!==void 0){if(a.F!=null){if(n=a.F,!a.f)continue;r=a.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(a.f!=null)r=a.f;else{if(a.t=="z")continue;if(a.t=="n"&&a.v!=null)r=""+a.v;else if(a.t=="b")r=a.v?"TRUE":"FALSE";else if(a.w!==void 0)r="'"+a.w;else{if(a.v===void 0)continue;a.t=="s"?r="'"+a.v:r=""+a.v}}u[u.length]=n+"="+r}return u}function AT(e,n,a){var r=a||{},s=+!r.skipHeader,l=e||{},o=0,d=0;if(l&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var u=typeof r.origin=="string"?vn(r.origin):r.origin;o=u.r,d=u.c}var x,m={s:{c:0,r:0},e:{c:d,r:o+n.length-1+s}};if(l["!ref"]){var f=Pt(l["!ref"]);m.e.c=Math.max(m.e.c,f.e.c),m.e.r=Math.max(m.e.r,f.e.r),o==-1&&(o=f.e.r+1,m.e.r=o+n.length-1+s)}else o==-1&&(o=0,m.e.r=n.length-1+s);var p=r.header||[],N=0;n.forEach(function(g,b){Tn(g).forEach(function(j){(N=p.indexOf(j))==-1&&(p[N=p.length]=j);var T=g[j],_="z",w="",E=dt({c:d+N,r:o+b+s});x=uu(l,E),T&&typeof T=="object"&&!(T instanceof Date)?l[E]=T:(typeof T=="number"?_="n":typeof T=="boolean"?_="b":typeof T=="string"?_="s":T instanceof Date?(_="d",r.cellDates||(_="n",T=Wn(T)),w=r.dateNF||ct[14]):T===null&&r.nullError&&(_="e",T=0),x?(x.t=_,x.v=T,delete x.w,delete x.R,w&&(x.z=w)):l[E]=x={t:_,v:T},w&&(x.z=w))})}),m.e.c=Math.max(m.e.c,d+p.length-1);var y=Ln(o);if(s)for(N=0;N<p.length;++N)l[yn(N+d)+y]={t:"s",v:p[N]};return l["!ref"]=gt(m),l}function Z9(e,n){return AT(null,e,n)}function uu(e,n,a){if(typeof n=="string"){if(Array.isArray(e)){var r=vn(n);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[n]||(e[n]={t:"z"})}return typeof n!="number"?uu(e,dt(n)):uu(e,dt({r:n,c:a||0}))}function eV(e,n){if(typeof n=="number"){if(n>=0&&e.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var a=e.SheetNames.indexOf(n);if(a>-1)return a;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function ly(){return{SheetNames:[],Sheets:{}}}function oy(e,n,a,r){var s=1;if(!a)for(;s<=65535&&e.SheetNames.indexOf(a="Sheet"+s)!=-1;++s,a=void 0);if(!a||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(a)>=0){var l=a.match(/(^.*?)(\d+)$/);s=l&&+l[2]||0;var o=l&&l[1]||a;for(++s;s<=65535&&e.SheetNames.indexOf(a=o+s)!=-1;++s);}if(fT(a),e.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");return e.SheetNames.push(a),e.Sheets[a]=n,a}function tV(e,n,a){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=eV(e,n);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}e.Workbook.Sheets[r].Hidden=a}function nV(e,n){return e.z=n,e}function FT(e,n,a){return n?(e.l={Target:n},a&&(e.l.Tooltip=a)):delete e.l,e}function aV(e,n,a){return FT(e,"#"+n,a)}function rV(e,n,a){e.c||(e.c=[]),e.c.push({t:n,a:a||"SheetJS"})}function sV(e,n,a,r){for(var s=typeof n!="string"?n:Pt(n),l=typeof n=="string"?n:gt(n),o=s.s.r;o<=s.e.r;++o)for(var d=s.s.c;d<=s.e.c;++d){var u=uu(e,o,d);u.t="n",u.F=l,delete u.v,o==s.s.r&&d==s.s.c&&(u.f=a,r&&(u.D=!0))}return e}var Jr={encode_col:yn,encode_row:Ln,encode_cell:dt,encode_range:gt,decode_col:Ig,decode_row:Pg,split_cell:g8,decode_cell:vn,decode_range:sr,format_cell:ci,sheet_add_aoa:ik,sheet_add_json:AT,sheet_add_dom:jT,aoa_to_sheet:Mc,json_to_sheet:Z9,table_to_sheet:wT,table_to_book:x9,sheet_to_csv:iy,sheet_to_txt:DT,sheet_to_json:U0,sheet_to_html:NT,sheet_to_formulae:J9,sheet_to_row_object_array:U0,sheet_get_cell:uu,book_new:ly,book_append_sheet:oy,book_set_sheet_visibility:tV,cell_set_number_format:nV,cell_set_hyperlink:FT,cell_set_internal_link:aV,cell_add_comment:rV,sheet_set_array_formula:sV,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const LT=Object.freeze(Object.defineProperty({__proto__:null,CFB:rt,parse_xlscfb:ey,parse_zip:ST,read:Hp,utils:Jr,write:sy,writeFile:V0,writeFileSync:V0},Symbol.toStringTag,{value:"Module"})),iV="modulepreload",lV=function(e){return"/"+e},p2={},PT=function(n,a,r){let s=Promise.resolve();if(a&&a.length>0){let o=function(x){return Promise.all(x.map(m=>Promise.resolve(m).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),u=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));s=o(a.map(x=>{if(x=lV(x),x in p2)return;p2[x]=!0;const m=x.endsWith(".css"),f=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${f}`))return;const p=document.createElement("link");if(p.rel=m?"stylesheet":iV,m||(p.as="script"),p.crossOrigin="",p.href=x,u&&p.setAttribute("nonce",u),document.head.appendChild(p),m)return new Promise((N,y)=>{p.addEventListener("load",N),p.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${x}`)))})}))}function l(o){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=o,window.dispatchEvent(d),!d.defaultPrevented)throw o}return s.then(o=>{for(const d of o||[])d.status==="rejected"&&l(d.reason);return n().catch(l)})},oV=async(e,n,a)=>(await he.post("/san-luong/chia-hang/preview",{rows:e,thang:n,nam:a})).data,cV=async(e,n,a)=>(await he.post("/san-luong/chia-hang/confirm",{rows:e,tenFile:n,fileHash:a})).data,dV=async(e,n,a)=>(await he.post("/san-luong/giao-hang/preview",{rows:e,thang:n,nam:a})).data,uV=async(e,n,a)=>(await he.post("/san-luong/giao-hang/confirm",{rows:e,tenFile:n,fileHash:a})).data,hV=async e=>{const n=await he.get("/san-luong/lich-su-import",{params:{loaiImport:e.loaiImport,tuNgay:e.tuNgay,denNgay:e.denNgay}}),a=Array.isArray(n.data)?n.data:[];let r=a;e.trangThai&&(r=a.filter(u=>u.trangThai===e.trangThai));const s=e.page||1,l=e.limit||20,o=(s-1)*l,d=o+l;return{items:r.slice(o,d),total:r.length}},xV=async e=>{const{read:n,utils:a}=await PT(async()=>{const{read:d,utils:u}=await Promise.resolve().then(()=>LT);return{read:d,utils:u}},void 0),r=await e.arrayBuffer(),s=n(r,{type:"array"}),l=s.Sheets[s.SheetNames[0]];return a.sheet_to_json(l).map(d=>({maNhanVien:String(d["M NV"]||d.MaNhanVien||d.maNhanVien||""),ngay:IT(d.Ngy||d.ngay),sanPhamDat:Number(d["SP t"]||d.sanPhamDat||0),sanPhamLoi:Number(d["SP Li"]||d.sanPhamLoi||0),tongSanPham:Number(d["Tng SP"]||d.tongSanPham||0)}))},mV=async e=>{const{read:n,utils:a}=await PT(async()=>{const{read:d,utils:u}=await Promise.resolve().then(()=>LT);return{read:d,utils:u}},void 0),r=await e.arrayBuffer(),s=n(r,{type:"array"}),l=s.Sheets[s.SheetNames[0]];return a.sheet_to_json(l).map(d=>({maNhanVien:String(d["M NV"]||d.MaNhanVien||d.maNhanVien||""),ngay:IT(d.Ngy||d.ngay),khoiLuong:Number(d["Khi lng"]||d.khoiLuong||0),donGia:Number(d["n gi"]||d.donGia||0),phatTre:Number(d["Pht tr"]||d.phatTre||0),phatKhongLayPhieu:Number(d["Pht KL phiu"]||d.phatKhongLayPhieu||0)}))};function IT(e){if(!e)return"";if(typeof e=="number")return new Date((e-25569)*86400*1e3).toISOString().split("T")[0];if(typeof e=="string"){const n=e.split("/");if(n.length===3){const[a,r,s]=n;return`${s}-${r.padStart(2,"0")}-${a.padStart(2,"0")}`}if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e}return String(e)}const OT=async e=>{const n=await e.arrayBuffer(),a=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(a)).map(s=>s.toString(16).padStart(2,"0")).join("")},fV=()=>{const[e,n]=D.useState(null),[a,r]=D.useState([]),[s,l]=D.useState(null),[o,d]=D.useState(!1),[u,x]=D.useState(!1),[m,f]=D.useState(new Date().getMonth()+1),[p,N]=D.useState(new Date().getFullYear()),[y,g]=D.useState(null),[b,j]=D.useState(!1);D.useEffect(()=>{Jt.layTatCa().then(B=>{const O=B.find(M=>(M.trangThai==="ACTIVE"||M.trangThai==="HOAT_DONG")&&(M.tenPhongBan.toLowerCase().includes("chia hng")||M.tenPhongBan.toLowerCase().includes("chia hang")||M.loaiPhongBan==="CHIA_HANG"));O&&g(O)})},[]);const T=async()=>{if(!y){xt.error("Khng tm thy b phn Chia Hng trong h thng");return}j(!0);try{const B=await ma.layTatCa({phongBanId:y.id,trangThai:"DANG_LAM"}),O=Array.isArray(B)?B:B.data||[];if(O.length===0){xt.error("Phng ban ny khng c nhn vin ang lm vic");return}const M=[];O.forEach(H=>{M.push({"M NV":H.maNhanVien,"Tn NV":H.hoTen,Ngy:`01/${String(m).padStart(2,"0")}/${p}`,"SP t":"","SP Li":"","Tng SP":""})});const G=Jr.json_to_sheet(M);G["!cols"]=[{wch:12},{wch:25},{wch:12},{wch:10},{wch:10},{wch:10}];const J=Jr.book_new();Jr.book_append_sheet(J,G,"Chia Hng");const X=[{Ct:"M NV","M t":"M nhn vin (bt buc)","V d":"NV001"},{Ct:"Tn NV","M t":"Tn nhn vin (ch  tham kho)","V d":"Nguyn Vn A"},{Ct:"Ngy","M t":"Ngy lm vic (dd/MM/yyyy)","V d":"01/01/2026"},{Ct:"SP t","M t":"S sn phm t chun","V d":"100"},{Ct:"SP Li","M t":"S sn phm li","V d":"2"},{Ct:"Tng SP","M t":"Tng sn phm","V d":"102"},{Ct:"","M t":"","V d":""},{Ct:"Lu ","M t":"C th thm nhiu dng cho cc ngy khc nhau","V d":""},{Ct:"Cng thc","M t":"Quy i SP = SP t - (SP Li  5)","V d":""},{Ct:"","M t":"Tin sn lng = Quy i SP  320","V d":""}],fe=Jr.json_to_sheet(X);fe["!cols"]=[{wch:12},{wch:45},{wch:15}],Jr.book_append_sheet(J,fe,"Hng dn");const ne=y.tenPhongBan.replace(/[\/:*?"<>|]/g,"");V0(J,`Template_ChiaHang_${ne}_T${m}_${p}.xlsx`),xt.success(` ti template vi ${O.length} nhn vin`)}catch(B){console.error(B),xt.error("Li khi ti template")}finally{j(!1)}},_=D.useCallback(async B=>{const O=B[0];if(O){n(O),d(!0),l(null);try{const M=await xV(O);r(M),xt.success(` c ${M.length} dng t file`)}catch(M){xt.error("Li c file Excel"),console.error(M)}finally{d(!1)}}},[]),{getRootProps:w,getInputProps:E,isDragActive:C}=vg({onDrop:_,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"]},multiple:!1}),S=async()=>{var B,O;if(a.length===0){xt.error("Cha c d liu  preview");return}d(!0);try{const M=await oV(a,m,p);l(M),M.tongKhongHopLe>0?xt.error(`C ${M.tongKhongHopLe} dng khng hp l`):xt.success(`${M.tongHopLe} dng hp l, sn sng import`)}catch(M){const G=M;xt.error(((O=(B=G.response)==null?void 0:B.data)==null?void 0:O.message)||"Li preview")}finally{d(!1)}},P=async()=>{var B,O;if(!(!s||!e)){if(s.hopLe.length===0){xt.error("Khng c d liu hp l  import");return}x(!0);try{const M=await OT(e),G=await cV(s.hopLe,e.name,M);xt.success(`Import thnh cng! Thm mi: ${G.inserted}, Cp nht: ${G.updated}`),n(null),r([]),l(null)}catch(M){const G=M;xt.error(((O=(B=G.response)==null?void 0:B.data)==null?void 0:O.message)||"Li import")}finally{x(!1)}}},F=()=>{n(null),r([]),l(null)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Import Sn Lng Chia Hng"}),t.jsx("div",{className:"flex gap-2",children:(e||a.length>0)&&t.jsx("button",{onClick:F,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Reset"})})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"B phn:"}),t.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:(y==null?void 0:y.tenPhongBan)||"ang ti..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thng"}),t.jsx("select",{value:m,onChange:B=>f(Number(B.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:12},(B,O)=>t.jsxs("option",{value:O+1,children:["Thng ",O+1]},O+1))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nm"}),t.jsx("select",{value:p,onChange:B=>N(Number(B.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:5},(B,O)=>new Date().getFullYear()-2+O).map(B=>t.jsx("option",{value:B,children:B},B))})]}),t.jsx("button",{onClick:T,disabled:b||!y,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:b?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang ti..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Ti Template"]})})]}),t.jsxs("div",{...w(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${C?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,children:[t.jsx("input",{...E()}),t.jsxs("div",{className:"text-gray-600",children:[t.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),C?t.jsx("p",{className:"text-blue-600",children:"Th file vo y..."}):t.jsxs(t.Fragment,{children:[t.jsx("p",{children:"Ko th file Excel vo y, hoc click  chn file"}),t.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"H tr: .xlsx, .xls"})]})]})]}),e&&t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsxs("p",{className:"text-blue-800",children:[t.jsx("strong",{children:"File:"})," ",e.name," (",(e.size/1024).toFixed(1)," KB)"]}),t.jsxs("p",{className:"text-blue-600 text-sm mt-1",children:[" c ",a.length," dng d liu"]})]}),a.length>0&&!s&&t.jsx("button",{onClick:S,disabled:o,className:"w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2",children:o?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang x l..."]}):"Preview d liu"}),s&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[t.jsx("p",{className:"text-green-800 font-semibold text-lg",children:s.tongHopLe}),t.jsx("p",{className:"text-green-600 text-sm",children:"Dng hp l"})]}),t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[t.jsx("p",{className:"text-red-800 font-semibold text-lg",children:s.tongKhongHopLe}),t.jsx("p",{className:"text-red-600 text-sm",children:"Dng khng hp l"})]})]}),s.hopLe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-green-50 border-b border-green-200",children:t.jsxs("h3",{className:"font-semibold text-green-800",children:["D liu hp l (",s.hopLe.length,")"]})}),t.jsxs("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:[t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"SP t"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"SP Li"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Tng SP"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:s.hopLe.slice(0,100).map((B,O)=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-2 text-sm",children:B.maNhanVien}),t.jsx("td",{className:"px-4 py-2 text-sm",children:B.ngay}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:B.sanPhamDat}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:B.sanPhamLoi}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:B.tongSanPham})]},O))})]}),s.hopLe.length>100&&t.jsxs("p",{className:"text-center text-gray-500 py-2",children:["... v ",s.hopLe.length-100," dng na"]})]})]}),s.khongHopLe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-red-50 border-b border-red-200",children:t.jsxs("h3",{className:"font-semibold text-red-800",children:["D liu khng hp l (",s.khongHopLe.length,")"]})}),t.jsx("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"L do"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:s.khongHopLe.map((B,O)=>t.jsxs("tr",{className:"bg-red-50",children:[t.jsx("td",{className:"px-4 py-2 text-sm",children:B.row.maNhanVien}),t.jsx("td",{className:"px-4 py-2 text-sm",children:B.row.ngay}),t.jsx("td",{className:"px-4 py-2 text-sm text-red-600",children:B.lyDo})]},O))})]})})]}),s.hopLe.length>0&&t.jsxs("div",{className:"flex gap-4",children:[t.jsx("button",{onClick:S,disabled:o,className:"flex-1 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 disabled:opacity-50",children:"Preview li"}),t.jsx("button",{onClick:P,disabled:u,className:"flex-1 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center justify-center gap-2",children:u?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang import..."]}):`Import ${s.hopLe.length} dng`})]})]}),t.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[t.jsx("h3",{className:"font-semibold text-yellow-800 mb-2",children:"Hng dn"}),t.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1 list-disc list-inside",children:[t.jsx("li",{children:"File Excel cn c cc ct: M NV, Ngy, SP t, SP Li, Tng SP"}),t.jsx("li",{children:"Ngy c th  nh dng dd/MM/yyyy hoc yyyy-MM-dd"}),t.jsx("li",{children:"Nu d liu  tn ti (cng m NV + ngy) s c cp nht"}),t.jsxs("li",{children:["Cng thc: ",t.jsx("strong",{children:"Quy i SP = SP t - (SP Li  5)"}),", ",t.jsx("strong",{children:"Tin = Quy i  320"})]})]})]})]})},pV=()=>{const[e,n]=D.useState(null),[a,r]=D.useState([]),[s,l]=D.useState(null),[o,d]=D.useState(!1),[u,x]=D.useState(!1),[m,f]=D.useState(new Date().getMonth()+1),[p,N]=D.useState(new Date().getFullYear()),[y,g]=D.useState(null),[b,j]=D.useState(!1);D.useEffect(()=>{Jt.layTatCa().then(O=>{const M=O.find(G=>(G.trangThai==="ACTIVE"||G.trangThai==="HOAT_DONG")&&(G.tenPhongBan.toLowerCase().includes("giao hng")||G.tenPhongBan.toLowerCase().includes("giao hang")||G.loaiPhongBan==="GIAO_HANG"));M&&g(M)})},[]);const T=async()=>{if(!y){xt.error("Khng tm thy b phn Giao Hng trong h thng");return}j(!0);try{const O=await ma.layTatCa({phongBanId:y.id,trangThai:"DANG_LAM"}),M=Array.isArray(O)?O:O.data||[];if(M.length===0){xt.error("Phng ban ny khng c nhn vin ang lm vic");return}const G=[];M.forEach(W=>{G.push({"M NV":W.maNhanVien,"Tn NV":W.hoTen,Ngy:`01/${String(m).padStart(2,"0")}/${p}`,"Khi lng":"","n gi":"","Pht tr":0,"Pht KL phiu":0})});const J=Jr.json_to_sheet(G);J["!cols"]=[{wch:12},{wch:25},{wch:12},{wch:12},{wch:12},{wch:12},{wch:15}];const X=Jr.book_new();Jr.book_append_sheet(X,J,"Giao Hng");const fe=[{Ct:"M NV","M t":"M nhn vin (bt buc)","V d":"NV001"},{Ct:"Tn NV","M t":"Tn nhn vin (ch  tham kho)","V d":"Nguyn Vn A"},{Ct:"Ngy","M t":"Ngy lm vic (dd/MM/yyyy)","V d":"01/01/2026"},{Ct:"Khi lng","M t":"Khi lng giao hng (kg)","V d":"50"},{Ct:"n gi","M t":"n gi theo kg (VN)","V d":"5000"},{Ct:"Pht tr","M t":"Tin pht giao tr (VN)","V d":"10000"},{Ct:"Pht KL phiu","M t":"Pht khng ly phiu (VN)","V d":"5000"},{Ct:"","M t":"","V d":""},{Ct:"Lu ","M t":"C th thm nhiu dng cho cc ngy khc nhau","V d":""},{Ct:"Cng thc","M t":"Tin = Khi lng  n gi - Pht tr - Pht KL phiu","V d":""}],ne=Jr.json_to_sheet(fe);ne["!cols"]=[{wch:15},{wch:50},{wch:15}],Jr.book_append_sheet(X,ne,"Hng dn");const H=y.tenPhongBan.replace(/[\/:*?"<>|]/g,"");V0(X,`Template_GiaoHang_${H}_T${m}_${p}.xlsx`),xt.success(` ti template vi ${M.length} nhn vin`)}catch(O){console.error(O),xt.error("Li khi ti template")}finally{j(!1)}},_=D.useCallback(async O=>{const M=O[0];if(M){n(M),d(!0),l(null);try{const G=await mV(M);r(G),xt.success(` c ${G.length} dng t file`)}catch(G){xt.error("Li c file Excel"),console.error(G)}finally{d(!1)}}},[]),{getRootProps:w,getInputProps:E,isDragActive:C}=vg({onDrop:_,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"]},multiple:!1}),S=async()=>{var O,M;if(a.length===0){xt.error("Cha c d liu  preview");return}d(!0);try{const G=await dV(a,m,p);l(G),G.tongKhongHopLe>0?xt.error(`C ${G.tongKhongHopLe} dng khng hp l`):xt.success(`${G.tongHopLe} dng hp l, sn sng import`)}catch(G){const J=G;xt.error(((M=(O=J.response)==null?void 0:O.data)==null?void 0:M.message)||"Li preview")}finally{d(!1)}},P=async()=>{var O,M;if(!(!s||!e)){if(s.hopLe.length===0){xt.error("Khng c d liu hp l  import");return}x(!0);try{const G=await OT(e),J=await uV(s.hopLe,e.name,G);xt.success(`Import thnh cng! Thm mi: ${J.inserted}, Cp nht: ${J.updated}`),n(null),r([]),l(null)}catch(G){const J=G;xt.error(((M=(O=J.response)==null?void 0:O.data)==null?void 0:M.message)||"Li import")}finally{x(!1)}}},F=()=>{n(null),r([]),l(null)},B=O=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(O);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Import Sn Lng Giao Hng"}),t.jsx("div",{className:"flex gap-2",children:(e||a.length>0)&&t.jsx("button",{onClick:F,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Reset"})})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"B phn:"}),t.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:(y==null?void 0:y.tenPhongBan)||"ang ti..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thng"}),t.jsx("select",{value:m,onChange:O=>f(Number(O.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:12},(O,M)=>t.jsxs("option",{value:M+1,children:["Thng ",M+1]},M+1))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nm"}),t.jsx("select",{value:p,onChange:O=>N(Number(O.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:5},(O,M)=>new Date().getFullYear()-2+M).map(O=>t.jsx("option",{value:O,children:O},O))})]}),t.jsx("button",{onClick:T,disabled:b||!y,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:b?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang ti..."]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Ti Template"]})})]}),t.jsxs("div",{...w(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${C?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,children:[t.jsx("input",{...E()}),t.jsxs("div",{className:"text-gray-600",children:[t.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),C?t.jsx("p",{className:"text-blue-600",children:"Th file vo y..."}):t.jsxs(t.Fragment,{children:[t.jsx("p",{children:"Ko th file Excel vo y, hoc click  chn file"}),t.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"H tr: .xlsx, .xls"})]})]})]}),e&&t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsxs("p",{className:"text-blue-800",children:[t.jsx("strong",{children:"File:"})," ",e.name," (",(e.size/1024).toFixed(1)," KB)"]}),t.jsxs("p",{className:"text-blue-600 text-sm mt-1",children:[" c ",a.length," dng d liu"]})]}),a.length>0&&!s&&t.jsx("button",{onClick:S,disabled:o,className:"w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2",children:o?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang x l..."]}):"Preview d liu"}),s&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[t.jsx("p",{className:"text-green-800 font-semibold text-lg",children:s.tongHopLe}),t.jsx("p",{className:"text-green-600 text-sm",children:"Dng hp l"})]}),t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[t.jsx("p",{className:"text-red-800 font-semibold text-lg",children:s.tongKhongHopLe}),t.jsx("p",{className:"text-red-600 text-sm",children:"Dng khng hp l"})]})]}),s.hopLe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-green-50 border-b border-green-200",children:t.jsxs("h3",{className:"font-semibold text-green-800",children:["D liu hp l (",s.hopLe.length,")"]})}),t.jsxs("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:[t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Khi lng"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"n gi"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Pht tr"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Pht KLP"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:s.hopLe.slice(0,100).map((O,M)=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-2 text-sm",children:O.maNhanVien}),t.jsx("td",{className:"px-4 py-2 text-sm",children:O.ngay}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:O.khoiLuong}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:B(O.donGia)}),t.jsx("td",{className:"px-4 py-2 text-sm text-right text-red-600",children:B(O.phatTre)}),t.jsx("td",{className:"px-4 py-2 text-sm text-right text-red-600",children:B(O.phatKhongLayPhieu)})]},M))})]}),s.hopLe.length>100&&t.jsxs("p",{className:"text-center text-gray-500 py-2",children:["... v ",s.hopLe.length-100," dng na"]})]})]}),s.khongHopLe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-red-50 border-b border-red-200",children:t.jsxs("h3",{className:"font-semibold text-red-800",children:["D liu khng hp l (",s.khongHopLe.length,")"]})}),t.jsx("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"L do"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:s.khongHopLe.map((O,M)=>t.jsxs("tr",{className:"bg-red-50",children:[t.jsx("td",{className:"px-4 py-2 text-sm",children:O.row.maNhanVien}),t.jsx("td",{className:"px-4 py-2 text-sm",children:O.row.ngay}),t.jsx("td",{className:"px-4 py-2 text-sm text-red-600",children:O.lyDo})]},M))})]})})]}),s.hopLe.length>0&&t.jsxs("div",{className:"flex gap-4",children:[t.jsx("button",{onClick:S,disabled:o,className:"flex-1 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 disabled:opacity-50",children:"Preview li"}),t.jsx("button",{onClick:P,disabled:u,className:"flex-1 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center justify-center gap-2",children:u?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang import..."]}):`Import ${s.hopLe.length} dng`})]})]}),t.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[t.jsx("h3",{className:"font-semibold text-yellow-800 mb-2",children:"Hng dn"}),t.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1 list-disc list-inside",children:[t.jsx("li",{children:"File Excel cn c cc ct: M NV, Ngy, Khi lng, n gi, Pht tr, Pht KL phiu"}),t.jsx("li",{children:"Ngy c th  nh dng dd/MM/yyyy hoc yyyy-MM-dd"}),t.jsx("li",{children:"Nu d liu  tn ti (cng m NV + ngy) s c cp nht"}),t.jsxs("li",{children:["Cng thc: ",t.jsx("strong",{children:"Tin = Khi lng  n gi - Pht tr - Pht khng ly phiu"})]})]})]})]})},gV=()=>{const[e,n]=D.useState([]),[a,r]=D.useState(0),[s,l]=D.useState(!0),[o,d]=D.useState({loaiImport:void 0,trangThai:void 0,page:1,limit:20});D.useEffect(()=>{u()},[o]);const u=async()=>{var y,g;l(!0);try{const b=await hV(o);n(b.items),r(b.total)}catch(b){const j=b;xt.error(((g=(y=j.response)==null?void 0:y.data)==null?void 0:g.message)||"Li ti d liu")}finally{l(!1)}},x=y=>new Date(y).toLocaleString("vi-VN"),m=y=>{d(g=>({...g,loaiImport:y===""?void 0:y,page:1}))},f=y=>{d(g=>({...g,trangThai:y===""?void 0:y,page:1}))},p=y=>{d(g=>({...g,page:y}))},N=Math.ceil(a/(o.limit||20));return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Lch S Import Sn Lng"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(xa,{to:"/import-chia-hang",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Import Chia Hng"}),t.jsx(xa,{to:"/import-giao-hang",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Import Giao Hng"})]})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow flex gap-4 items-center flex-wrap",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi"}),t.jsxs("select",{value:o.loaiImport||"",onChange:y=>m(y.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"CHIA_HANG",children:"Chia hng"}),t.jsx("option",{value:"GIAO_HANG",children:"Giao hng"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng thi"}),t.jsxs("select",{value:o.trangThai||"",onChange:y=>f(y.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"THANH_CONG",children:"Thnh cng"}),t.jsx("option",{value:"THAT_BAI",children:"Tht bi"})]})]}),t.jsx("div",{className:"ml-auto",children:t.jsx("button",{onClick:u,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Lm mi"})})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[s?t.jsxs("div",{className:"p-8 text-center",children:[t.jsxs("svg",{className:"animate-spin h-8 w-8 mx-auto text-blue-600",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),t.jsx("p",{className:"text-gray-500 mt-2",children:"ang ti..."})]}):e.length===0?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Khng c d liu"}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Loi"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tn file"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thi gian"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ngi import"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"S dng"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thnh cng"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tht bi"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trng thi"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(y=>{var g;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:y.id}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:t.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${y.loaiImport==="CHIA_HANG"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:y.loaiImport==="CHIA_HANG"?"Chia hng":"Giao hng"})}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",title:y.tenFile,children:y.tenFile}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:x(y.importLuc)}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:((g=y.nguoiImport)==null?void 0:g.hoTen)||"N/A"}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-center",children:y.soDong}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-green-600 text-center font-medium",children:y.soDongHopLe}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-red-600 text-center font-medium",children:y.soDongLoi}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:t.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${y.trangThai==="THANH_CONG"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:y.trangThai==="THANH_CONG"?"Thnh cng":"Tht bi"})})]},y.id)})})]})}),N>1&&t.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 flex items-center justify-between",children:[t.jsxs("div",{className:"text-sm text-gray-700",children:["Hin th ",t.jsx("span",{className:"font-medium",children:(o.page-1)*o.limit+1})," n"," ",t.jsx("span",{className:"font-medium",children:Math.min(o.page*o.limit,a)})," trong"," ",t.jsx("span",{className:"font-medium",children:a})," kt qu"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>p(o.page-1),disabled:o.page===1,className:"px-3 py-1 border rounded-md text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Trc"}),Array.from({length:Math.min(5,N)},(y,g)=>{let b;return N<=5||o.page<=3?b=g+1:o.page>=N-2?b=N-4+g:b=o.page-2+g,t.jsx("button",{onClick:()=>p(b),className:`px-3 py-1 border rounded-md text-sm ${b===o.page?"bg-blue-600 text-white border-blue-600":"hover:bg-gray-50"}`,children:b},b)}),t.jsx("button",{onClick:()=>p(o.page+1),disabled:o.page===N,className:"px-3 py-1 border rounded-md text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Sau"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Tng s ln import"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:a})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Import chia hng"}),t.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:e.filter(y=>y.loaiImport==="CHIA_HANG").length})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Import giao hng"}),t.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:e.filter(y=>y.loaiImport==="GIAO_HANG").length})]})]})]})};function yV(){var S,P;const[e,n]=D.useState("chia-hang"),[a,r]=D.useState(new Date().getMonth()+1),[s,l]=D.useState(new Date().getFullYear()),[o,d]=D.useState(1),[u,x]=D.useState(""),m=20,{data:f,isLoading:p}=Fe({queryKey:["san-luong","chia-hang",a,s,o,u],queryFn:async()=>(await he.get("/san-luong/chia-hang",{params:{thang:a,nam:s,page:o,limit:m,tuKhoa:u}})).data,enabled:e==="chia-hang"}),{data:N,isLoading:y}=Fe({queryKey:["san-luong","giao-hang",a,s,o,u],queryFn:async()=>(await he.get("/san-luong/giao-hang",{params:{thang:a,nam:s,page:o,limit:m,tuKhoa:u}})).data,enabled:e==="giao-hang"}),{data:g}=Fe({queryKey:["san-luong","thong-ke",e,a,s],queryFn:async()=>(await he.get(`/san-luong/${e}/thong-ke`,{params:{thang:a,nam:s}})).data}),b=e==="chia-hang"?f:N,j=e==="chia-hang"?p:y,T=Array.isArray(b)?b:(b==null?void 0:b.data)||[],_=((S=b==null?void 0:b.pagination)==null?void 0:S.total)||T.length,w=Math.ceil(_/m),E=async()=>{try{const F=await he.get(`/san-luong/${e}/export`,{params:{thang:a,nam:s},responseType:"blob"}),B=window.URL.createObjectURL(new Blob([F.data])),O=document.createElement("a");O.href=B,O.setAttribute("download",`san-luong-${e}-${a}-${s}.xlsx`),document.body.appendChild(O),O.click(),O.remove()}catch(F){console.error("Export error:",F)}},C=F=>(F==null?void 0:F.toLocaleString("vi-VN"))||"0";return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Tra cu Sn lng"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Xem chi tit sn lng Chia hng v Giao hng theo thng"})]}),t.jsxs("button",{onClick:E,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[t.jsx(ws,{size:18}),"Xut Excel"]})]}),t.jsxs("div",{className:"flex gap-2 border-b",children:[t.jsxs("button",{onClick:()=>{n("chia-hang"),d(1)},className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${e==="chia-hang"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(Z0,{size:20}),"Chia hng"]}),t.jsxs("button",{onClick:()=>{n("giao-hang"),d(1)},className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${e==="giao-hang"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(ex,{size:20}),"Giao hng"]})]}),t.jsxs("div",{className:"flex flex-wrap gap-4 items-center bg-gray-50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(At,{size:18,className:"text-gray-400"}),t.jsx("select",{value:a,onChange:F=>{r(Number(F.target.value)),d(1)},className:"border rounded-lg px-3 py-2",children:Array.from({length:12},(F,B)=>t.jsxs("option",{value:B+1,children:["Thng ",B+1]},B+1))}),t.jsx("select",{value:s,onChange:F=>{l(Number(F.target.value)),d(1)},className:"border rounded-lg px-3 py-2",children:[2024,2025,2026].map(F=>t.jsx("option",{value:F,children:F},F))})]}),t.jsx("div",{className:"flex-1 min-w-[200px]",children:t.jsxs("div",{className:"relative",children:[t.jsx(Vr,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Tm theo m NV, tn...",value:u,onChange:F=>{x(F.target.value),d(1)},className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]})}),t.jsxs("div",{className:"text-sm text-gray-600",children:["Tng: ",t.jsx("span",{className:"font-semibold",children:C(_)})," bn ghi"]})]}),g&&t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:e==="chia-hang"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-blue-600",children:"Tng SP t"}),t.jsx("div",{className:"text-2xl font-bold text-blue-700",children:C(g.tongSpDat)})]}),t.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-red-600",children:"Tng SP li"}),t.jsx("div",{className:"text-2xl font-bold text-red-700",children:C(g.tongSpLoi)})]}),t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-green-600",children:"T l t"}),t.jsxs("div",{className:"text-2xl font-bold text-green-700",children:[((P=g.tyLeDat)==null?void 0:P.toFixed(1))||"0","%"]})]}),t.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-purple-600",children:"S NV"}),t.jsx("div",{className:"text-2xl font-bold text-purple-700",children:C(g.soNhanVien)})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-blue-600",children:"Tng KL (kg)"}),t.jsx("div",{className:"text-2xl font-bold text-blue-700",children:C(g.tongKhoiLuong)})]}),t.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-orange-600",children:"Tng tr gi"}),t.jsx("div",{className:"text-2xl font-bold text-orange-700",children:C(g.tongTreGio)})]}),t.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-red-600",children:"Khng ly phiu"}),t.jsx("div",{className:"text-2xl font-bold text-red-700",children:C(g.tongKhongLayPhieu)})]}),t.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-purple-600",children:"S NV"}),t.jsx("div",{className:"text-2xl font-bold text-purple-700",children:C(g.soNhanVien)})]})]})}),t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50 text-gray-600",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left",children:"Ngy"}),t.jsx("th",{className:"px-4 py-3 text-left",children:"M NV"}),t.jsx("th",{className:"px-4 py-3 text-left",children:"H tn"}),e==="chia-hang"?t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"px-4 py-3 text-right",children:"SP t"}),t.jsx("th",{className:"px-4 py-3 text-right",children:"SP li"}),t.jsx("th",{className:"px-4 py-3 text-right",children:"T l li"})]}):t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"px-4 py-3 text-right",children:"KL (kg)"}),t.jsx("th",{className:"px-4 py-3 text-right",children:"Tr gi"}),t.jsx("th",{className:"px-4 py-3 text-right",children:"Khng phiu"})]}),t.jsx("th",{className:"px-4 py-3 text-center",children:"Ngun"}),t.jsx("th",{className:"px-4 py-3 text-left",children:"Ghi ch"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-100",children:j?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"ang ti..."})}):T.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"Khng c d liu"})}):e==="chia-hang"?T.map(F=>{var B,O;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3",children:new Date(F.ngay).toLocaleDateString("vi-VN")}),t.jsx("td",{className:"px-4 py-3 font-medium",children:((B=F.nhanVien)==null?void 0:B.maNhanVien)||`NV${F.nhanVienId}`}),t.jsx("td",{className:"px-4 py-3",children:((O=F.nhanVien)==null?void 0:O.hoTen)||"-"}),t.jsx("td",{className:"px-4 py-3 text-right font-medium text-blue-600",children:C(F.soLuongSpDat)}),t.jsx("td",{className:"px-4 py-3 text-right text-red-600",children:C(F.soLuongSpLoi)}),t.jsx("td",{className:"px-4 py-3 text-right",children:F.soLuongSpDat>0?(F.soLuongSpLoi/F.soLuongSpDat*100).toFixed(1)+"%":"-"}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded text-xs ${F.nguonDuLieu==="IMPORT_EXCEL"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:F.nguonDuLieu==="IMPORT_EXCEL"?t.jsxs(t.Fragment,{children:[t.jsx(Gn,{size:12})," Import"]}):"Nhp tay"})}),t.jsx("td",{className:"px-4 py-3 text-gray-500 max-w-[200px] truncate",children:F.ghiChu||"-"})]},F.id)}):T.map(F=>{var B,O;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3",children:new Date(F.ngay).toLocaleDateString("vi-VN")}),t.jsx("td",{className:"px-4 py-3 font-medium",children:((B=F.nhanVien)==null?void 0:B.maNhanVien)||`NV${F.nhanVienId}`}),t.jsx("td",{className:"px-4 py-3",children:((O=F.nhanVien)==null?void 0:O.hoTen)||"-"}),t.jsx("td",{className:"px-4 py-3 text-right font-medium text-blue-600",children:C(Number(F.khoiLuongThanhCong))}),t.jsx("td",{className:"px-4 py-3 text-right",children:F.soLanTreGio>0?t.jsxs("span",{className:"text-orange-600 flex items-center justify-end gap-1",children:[t.jsx(di,{size:14})," ",F.soLanTreGio]}):t.jsx("span",{className:"text-green-600",children:"0"})}),t.jsx("td",{className:"px-4 py-3 text-right",children:F.soLanKhongLayPhieu>0?t.jsx("span",{className:"text-red-600",children:F.soLanKhongLayPhieu}):t.jsx("span",{className:"text-green-600",children:"0"})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded text-xs ${F.nguonDuLieu==="IMPORT_EXCEL"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:F.nguonDuLieu==="IMPORT_EXCEL"?t.jsxs(t.Fragment,{children:[t.jsx(Gn,{size:12})," Import"]}):"Nhp tay"})}),t.jsx("td",{className:"px-4 py-3 text-gray-500 max-w-[200px] truncate",children:F.ghiChu||"-"})]},F.id)})})]})}),w>1&&t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t bg-gray-50",children:[t.jsxs("div",{className:"text-sm text-gray-600",children:["Trang ",o," / ",w]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>d(F=>Math.max(1,F-1)),disabled:o===1,className:"p-2 rounded border hover:bg-gray-100 disabled:opacity-50",children:t.jsx(Nr,{size:18})}),t.jsx("button",{onClick:()=>d(F=>Math.min(w,F+1)),disabled:o>=w,className:"p-2 rounded border hover:bg-gray-100 disabled:opacity-50",children:t.jsx(qn,{size:18})})]})]})]})]})}function vV(){const e=Mt(),[n,a]=D.useState(!1),[r,s]=D.useState(null),[l,o]=D.useState({maBien:"",tenBien:"",moTa:"",giaTri:0,donVi:"VND"}),{data:d,isLoading:u}=Fe({queryKey:["cau-hinh-don-gia"],queryFn:()=>kd.layTatCa()}),x=Ee({mutationFn:kd.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["cau-hinh-don-gia"]}),ie.success("To n gi thnh cng!"),N()},onError:w=>{var E,C;ie.error(((C=(E=w.response)==null?void 0:E.data)==null?void 0:C.message)||"C li xy ra")}}),m=Ee({mutationFn:({id:w,data:E})=>kd.capNhat(w,E),onSuccess:()=>{e.invalidateQueries({queryKey:["cau-hinh-don-gia"]}),ie.success("Cp nht n gi thnh cng!"),N()},onError:w=>{var E,C;ie.error(((C=(E=w.response)==null?void 0:E.data)==null?void 0:C.message)||"C li xy ra")}}),f=Ee({mutationFn:kd.xoa,onSuccess:()=>{e.invalidateQueries({queryKey:["cau-hinh-don-gia"]}),ie.success("Xa n gi thnh cng!")},onError:w=>{var E,C;ie.error(((C=(E=w.response)==null?void 0:E.data)==null?void 0:C.message)||"C li xy ra")}}),p=Ee({mutationFn:kd.khoiTaoMau,onSuccess:w=>{e.invalidateQueries({queryKey:["cau-hinh-don-gia"]}),ie.success(w.message||"Khi to n gi mu thnh cng!")},onError:w=>{var E,C;ie.error(((C=(E=w.response)==null?void 0:E.data)==null?void 0:C.message)||"C li xy ra")}}),N=()=>{a(!1),s(null),o({maBien:"",tenBien:"",moTa:"",giaTri:0,donVi:"VND"})},y=w=>{s(w),o({maBien:w.maBien,tenBien:w.tenBien,moTa:w.moTa||"",giaTri:Number(w.giaTri),donVi:w.donVi||"VND"}),a(!0)},g=()=>{if(!l.maBien||!l.tenBien){ie.error("Vui lng in m v tn n gi");return}r?m.mutate({id:r.id,data:{tenBien:l.tenBien,moTa:l.moTa,giaTri:l.giaTri,donVi:l.donVi}}):x.mutate(l)},b=w=>{confirm(`Bn c chc mun xa n gi "${w.tenBien}"?`)&&f.mutate(w.id)},j=(d==null?void 0:d.filter(w=>w.maBien.includes("SP")||w.maBien.includes("LOI")))||[],T=(d==null?void 0:d.filter(w=>w.maBien.includes("KHOI_LUONG")||w.maBien.includes("TRE")||w.maBien.includes("PHIEU")))||[],_=(d==null?void 0:d.filter(w=>!j.includes(w)&&!T.includes(w)))||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(gr,{className:"w-8 h-8 text-emerald-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"n gi Sn lng"}),t.jsx("p",{className:"text-gray-600",children:"Cu hnh n gi s dng trong tnh lng sn lng"})]})]}),t.jsxs("div",{className:"flex gap-2",children:[(!d||d.length===0)&&t.jsxs("button",{onClick:()=>p.mutate(),disabled:p.isPending,className:"btn btn-secondary",children:[t.jsx(hb,{size:18}),"Khi to mu"]}),t.jsxs("button",{onClick:()=>a(!0),className:"btn btn-primary",children:[t.jsx(Dt,{size:18}),"Thm n gi"]})]})]}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[t.jsx(vu,{className:"text-blue-500 flex-shrink-0 mt-0.5",size:20}),t.jsxs("div",{className:"text-sm text-blue-800",children:[t.jsx("p",{className:"font-medium mb-1",children:"n gi c s dng trong Quy ch lng"}),t.jsxs("ul",{className:"list-disc list-inside space-y-1 text-blue-700",children:[t.jsxs("li",{children:[t.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"DON_GIA_SP"})," - n gi sn phm chia hng"]}),t.jsxs("li",{children:[t.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"HE_SO_LOI"})," - H s pht sn phm li"]}),t.jsxs("li",{children:[t.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"DON_GIA_KHOI_LUONG"})," - n gi theo kg giao hng"]}),t.jsxs("li",{children:[t.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"DON_GIA_PHAT_TRE"})," - Pht tr gi giao hng"]})]})]})]}),u?t.jsx("div",{className:"flex justify-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600"})}):!d||d.length===0?t.jsxs("div",{className:"card p-8 text-center",children:[t.jsx(di,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Cha c n gi no"}),t.jsx("p",{className:"text-gray-500 mb-4",children:'Nhn "Khi to mu"  to cc n gi mc nh hoc thm th cng'}),t.jsxs("button",{onClick:()=>p.mutate(),disabled:p.isPending,className:"btn btn-primary",children:[t.jsx(hb,{size:18}),"Khi to mu"]})]}):t.jsxs("div",{className:"grid gap-6",children:[j.length>0&&t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"p-4 border-b bg-cyan-50 flex items-center gap-2",children:[t.jsx(Z0,{className:"text-cyan-600",size:20}),t.jsx("h3",{className:"font-semibold text-cyan-800",children:"n gi Chia hng"})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M bin"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Tn"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M t"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"Gi tr"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"n v"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y",children:j.map(w=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-sm",children:w.maBien})}),t.jsx("td",{className:"px-4 py-3 font-medium",children:w.tenBien}),t.jsx("td",{className:"px-4 py-3 text-gray-500 text-sm",children:w.moTa}),t.jsx("td",{className:"px-4 py-3 text-right font-semibold text-emerald-600",children:w.donVi==="VND"?Ze(Number(w.giaTri)):Number(w.giaTri).toLocaleString()}),t.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-500",children:w.donVi}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>y(w),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",children:t.jsx(Za,{size:16})}),t.jsx("button",{onClick:()=>b(w),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",children:t.jsx(er,{size:16})})]})})]},w.id))})]})})]}),T.length>0&&t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"p-4 border-b bg-teal-50 flex items-center gap-2",children:[t.jsx(ex,{className:"text-teal-600",size:20}),t.jsx("h3",{className:"font-semibold text-teal-800",children:"n gi Giao hng"})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M bin"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Tn"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M t"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"Gi tr"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"n v"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y",children:T.map(w=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-sm",children:w.maBien})}),t.jsx("td",{className:"px-4 py-3 font-medium",children:w.tenBien}),t.jsx("td",{className:"px-4 py-3 text-gray-500 text-sm",children:w.moTa}),t.jsx("td",{className:"px-4 py-3 text-right font-semibold text-emerald-600",children:w.donVi==="VND"?Ze(Number(w.giaTri)):Number(w.giaTri).toLocaleString()}),t.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-500",children:w.donVi}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>y(w),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",children:t.jsx(Za,{size:16})}),t.jsx("button",{onClick:()=>b(w),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",children:t.jsx(er,{size:16})})]})})]},w.id))})]})})]}),_.length>0&&t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"p-4 border-b bg-gray-50 flex items-center gap-2",children:[t.jsx(gr,{className:"text-gray-600",size:20}),t.jsx("h3",{className:"font-semibold text-gray-800",children:"n gi khc"})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M bin"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Tn"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M t"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"Gi tr"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"n v"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y",children:_.map(w=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-sm",children:w.maBien})}),t.jsx("td",{className:"px-4 py-3 font-medium",children:w.tenBien}),t.jsx("td",{className:"px-4 py-3 text-gray-500 text-sm",children:w.moTa}),t.jsx("td",{className:"px-4 py-3 text-right font-semibold text-emerald-600",children:w.donVi==="VND"?Ze(Number(w.giaTri)):Number(w.giaTri).toLocaleString()}),t.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-500",children:w.donVi}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>y(w),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",children:t.jsx(Za,{size:16})}),t.jsx("button",{onClick:()=>b(w),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",children:t.jsx(er,{size:16})})]})})]},w.id))})]})})]})]}),t.jsx(as,{isOpen:n,onClose:N,children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:r?"Cp nht n gi":"Thm n gi mi"}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["M bin ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:l.maBien,onChange:w=>o({...l,maBien:w.target.value.toUpperCase()}),disabled:!!r,className:"w-full border rounded-lg px-3 py-2 disabled:bg-gray-100",placeholder:"VD: DON_GIA_SP"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"M bin s c s dng trong cng thc quy ch lng"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn n gi ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:l.tenBien,onChange:w=>o({...l,tenBien:w.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: n gi sn phm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:l.moTa,onChange:w=>o({...l,moTa:w.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2,placeholder:"M t chi tit..."})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Gi tr ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"number",value:l.giaTri,onChange:w=>o({...l,giaTri:Number(w.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n v"}),t.jsxs("select",{value:l.donVi,onChange:w=>o({...l,donVi:w.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"VND",children:"VND"}),t.jsx("option",{value:"HE_SO",children:"H s"}),t.jsx("option",{value:"PHAN_TRAM",children:"%"})]})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[t.jsx("button",{onClick:N,className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:g,disabled:x.isPending||m.isPending,className:"btn btn-primary",children:r?"Cp nht":"To mi"})]})]})})]})}const bV=e=>{switch(e){case"NHAP":return"bg-yellow-100 text-yellow-800";case"DA_CHOT":return"bg-blue-100 text-blue-800";case"DA_KHOA":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},NV=e=>{switch(e){case"NHAP":return"Nhp";case"DA_CHOT":return" cht";case"DA_KHOA":return" kha";default:return e}};function jV(){const e=Mt(),{coVaiTro:n}=ls(),a=n("ADMIN"),[r,s]=D.useState(!1),[l,o]=D.useState(()=>{const P=new Date;return`${P.getFullYear()}-${String(P.getMonth()+1).padStart(2,"0")}`}),[d,u]=D.useState(),[x,m]=D.useState({thangNam:l,tuNgay:"",denNgay:"",ngayChiTra:"",phongBanId:void 0,ghiChu:""}),f=P=>{const F=`${P}-01`,B=`${P}-15`;m({...x,thangNam:P,tuNgay:F,denNgay:B})},{data:p,isLoading:N}=Fe({queryKey:["bang-ung-luong",l,d],queryFn:()=>Xa.layDanhSach({thangNam:l,phongBanId:d})}),y=(p==null?void 0:p.data)||[],{data:g}=Fe({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),b=Ee({mutationFn:Xa.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["bang-ung-luong"]}),ie.success("To bng ng lng thnh cng!"),s(!1),m({thangNam:l,tuNgay:"",denNgay:"",ngayChiTra:"",phongBanId:void 0,ghiChu:""})},onError:P=>{var F,B;ie.error(((B=(F=P.response)==null?void 0:F.data)==null?void 0:B.message)||"C li xy ra")}}),j=Ee({mutationFn:({id:P,force:F})=>Xa.xoa(P,F),onSuccess:()=>{e.invalidateQueries({queryKey:["bang-ung-luong"]}),ie.success("Xa bng ng lng thnh cng!")},onError:P=>{var F,B;ie.error(((B=(F=P.response)==null?void 0:F.data)==null?void 0:B.message)||"C li xy ra")}}),T=Ee({mutationFn:Xa.chot,onSuccess:()=>{e.invalidateQueries({queryKey:["bang-ung-luong"]}),ie.success("Cht bng ng lng thnh cng!")},onError:P=>{var F,B;ie.error(((B=(F=P.response)==null?void 0:F.data)==null?void 0:B.message)||"C li xy ra")}}),_=Ee({mutationFn:Xa.khoa,onSuccess:()=>{e.invalidateQueries({queryKey:["bang-ung-luong"]}),ie.success("Kha bng ng lng thnh cng!")},onError:P=>{var F,B;ie.error(((B=(F=P.response)==null?void 0:F.data)==null?void 0:B.message)||"C li xy ra")}}),w=()=>{if(!x.tuNgay||!x.denNgay){ie.error("Vui lng nhp y  thng tin");return}b.mutate(x)},E=(P,F,B=!1)=>{if(F!=="NHAP"&&!B){ie.error("Ch c th xa bng ng lng ang  trng thi Nhp");return}confirm(B?" CNH BO: Bn ang xa cng ch bng ng lng  kha. Thao tc ny s c ghi li. Tip tc?":"Bn c chc mun xa bng ng lng ny?")&&j.mutate({id:P,force:B})},C=(P,F)=>{if(F!=="NHAP"){ie.error("Ch c th cht bng ng lng ang  trng thi Nhp");return}confirm("Bn c chc mun cht bng ng lng ny?")&&T.mutate(P)},S=(P,F)=>{if(F!=="DA_CHOT"){ie.error("Ch c th kha bng ng lng  cht");return}confirm("Bn c chc mun kha bng ng lng ny?")&&_.mutate(P)};return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[t.jsx(ig,{size:28}),"Qun l Bng ng lng"]}),t.jsxs("button",{onClick:()=>{f(l),s(!0)},className:"btn btn-primary",children:[t.jsx(Dt,{size:20}),"To bng ng lng"]})]}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Thng/Nm"}),t.jsx(Tc,{value:l,onChange:o,className:"border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban"}),t.jsxs("select",{value:d||"",onChange:P=>u(P.target.value?Number(P.target.value):void 0),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),g==null?void 0:g.map(P=>t.jsx("option",{value:P.id,children:P.tenPhongBan},P.id))]})]})]})}),t.jsx("div",{className:"card",children:N?t.jsx("p",{className:"text-center py-8 text-gray-500",children:"ang ti..."}):y&&y.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b",children:[t.jsx("th",{className:"text-left py-3 px-4",children:"Phng ban"}),t.jsx("th",{className:"text-left py-3 px-4",children:"Thng/Nm"}),t.jsx("th",{className:"text-left py-3 px-4",children:"Ngy chi tr"}),t.jsx("th",{className:"text-right py-3 px-4",children:"S NV"}),t.jsx("th",{className:"text-right py-3 px-4",children:"Tng tin ng"}),t.jsx("th",{className:"text-center py-3 px-4",children:"Trng thi"}),t.jsx("th",{className:"text-center py-3 px-4",children:"Thao tc"})]})}),t.jsx("tbody",{children:y.map(P=>{var F,B;return t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4 font-medium",children:t.jsx(xa,{to:`/ung-luong/${P.id}`,className:"text-primary-600 hover:underline",children:((F=P.phongBan)==null?void 0:F.tenPhongBan)||"Tt c phng ban"})}),t.jsx("td",{className:"py-3 px-4",children:P.thangNam}),t.jsx("td",{className:"py-3 px-4",children:P.ngayChiTra?Js(P.ngayChiTra):"-"}),t.jsxs("td",{className:"py-3 px-4 text-right",children:[P.soNhanVienUng,"/",((B=P._count)==null?void 0:B.chiTiets)||0]}),t.jsx("td",{className:"py-3 px-4 text-right font-medium text-blue-600",children:Ze(P.tongSoTienUng)}),t.jsx("td",{className:"py-3 px-4 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded text-sm ${bV(P.trangThai)}`,children:NV(P.trangThai)})}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex justify-center gap-2",children:[P.trangThai==="NHAP"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>C(P.id,P.trangThai),className:"p-2 text-green-600 hover:bg-green-50 rounded",title:"Cht",children:t.jsx(Br,{size:18})}),t.jsx("button",{onClick:()=>E(P.id,P.trangThai),className:"p-2 text-red-600 hover:bg-red-50 rounded",title:"Xa",children:t.jsx(er,{size:18})})]}),P.trangThai==="DA_CHOT"&&t.jsx("button",{onClick:()=>S(P.id,P.trangThai),className:"p-2 text-orange-600 hover:bg-orange-50 rounded",title:"Kha",children:t.jsx(ti,{size:18})}),P.trangThai==="DA_KHOA"&&a&&t.jsx("button",{onClick:()=>E(P.id,P.trangThai,!0),className:"p-2 text-red-600 hover:bg-red-50 rounded",title:"[Admin] Xa cng ch",children:t.jsx(sa,{size:18})})]})})]},P.id)})})]})}):t.jsx("p",{className:"text-center py-8 text-gray-500",children:'Cha c bng ng lng no. Nhn "To bng ng lng"  bt u.'})}),r&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"To bng ng lng mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Thng/Nm ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Tc,{value:x.thangNam,onChange:f,className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["T ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Gt,{value:x.tuNgay,onChange:P=>m({...x,tuNgay:P}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["n ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Gt,{value:x.denNgay,onChange:P=>m({...x,denNgay:P}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy chi tr"}),t.jsx(Gt,{value:x.ngayChiTra,onChange:P=>m({...x,ngayChiTra:P}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:x.phongBanId||"",onChange:P=>m({...x,phongBanId:P.target.value?Number(P.target.value):void 0}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),g==null?void 0:g.map(P=>t.jsx("option",{value:P.id,children:P.tenPhongBan},P.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),t.jsx("textarea",{value:x.ghiChu,onChange:P=>m({...x,ghiChu:P.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:w,disabled:b.isPending,className:"btn btn-primary",children:b.isPending?"ang to...":"To bng ng lng"})]})]})})]})}const wV=e=>{switch(e){case"NGHI_QUA_NHIEU":return"Ngh qu nhiu ngy";case"NGHI_KHONG_PHEP":return"Ngh khng php";case"KHONG_HOAT_DONG":return"Khng hot ng";default:return e||""}};function kV(){const{id:e}=W0(),n=br(),a=Mt(),r=Number(e),[s,l]=D.useState(new Map),[o,d]=D.useState(!1),[u,x]=D.useState(!1),[m,f]=D.useState(!1),[p,N]=D.useState(70),[y,g]=D.useState(0),[b,j]=D.useState(null),{data:T,isLoading:_,refetch:w}=Fe({queryKey:["bang-ung-luong",r],queryFn:()=>Xa.layTheoId(r),enabled:!!r}),{data:E}=Fe({queryKey:["bang-luong-list"],queryFn:()=>Or.layDanhSach({})}),C=(T==null?void 0:T.trangThai)==="NHAP",S=Ee({mutationFn:K=>Xa.sinhDanhSach(r,K),onSuccess:K=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),ie.success(` sinh ${K.soNhanVien} nhn vin (${K.soDuocUng}  iu kin)`)},onError:K=>{var L,Q;ie.error(((Q=(L=K.response)==null?void 0:L.data)==null?void 0:Q.message)||"C li xy ra")}}),P=Ee({mutationFn:K=>Xa.capNhatBulk(r,K),onSuccess:K=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),l(new Map),K.errors&&K.errors.length>0?ie.error(`Cp nht ${K.soCapNhat} dng. Li: ${K.errors.length}`):ie.success(`Cp nht ${K.soCapNhat} dng thnh cng`)},onError:K=>{var L,Q;ie.error(((Q=(L=K.response)==null?void 0:L.data)==null?void 0:Q.message)||"C li xy ra")}}),F=Ee({mutationFn:K=>Xa.setTheoTiLe(r,K),onSuccess:K=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),d(!1),ie.success(K.message)},onError:K=>{var L,Q;ie.error(((Q=(L=K.response)==null?void 0:L.data)==null?void 0:Q.message)||"C li xy ra")}}),B=Ee({mutationFn:K=>Xa.setSoTienCoDinh(r,K),onSuccess:K=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),x(!1),ie.success(K.message)},onError:K=>{var L,Q;ie.error(((Q=(L=K.response)==null?void 0:L.data)==null?void 0:Q.message)||"C li xy ra")}}),O=Ee({mutationFn:()=>Xa.chot(r),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),ie.success("Cht bng ng lng thnh cng!")},onError:K=>{var L,Q;ie.error(((Q=(L=K.response)==null?void 0:L.data)==null?void 0:Q.message)||"C li xy ra")}}),M=Ee({mutationFn:()=>Xa.khoa(r),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),ie.success("Kha bng ng lng thnh cng!")},onError:K=>{var L,Q;ie.error(((Q=(L=K.response)==null?void 0:L.data)==null?void 0:Q.message)||"C li xy ra")}}),G=Ee({mutationFn:K=>Xa.moKhoa(r,{lyDo:K}),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),ie.success("M kha bng ng lng thnh cng!")},onError:K=>{var L,Q;ie.error(((Q=(L=K.response)==null?void 0:L.data)==null?void 0:Q.message)||"C li xy ra")}}),J=Ee({mutationFn:K=>Xa.ghiNhanKhauTru(r,K),onSuccess:K=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),f(!1),ie.success(K.message)},onError:K=>{var L,Q;ie.error(((Q=(L=K.response)==null?void 0:L.data)==null?void 0:Q.message)||"C li xy ra")}}),X=D.useCallback((K,L,Q)=>{l(I=>{const R=new Map(I),te=R.get(K)||{};return R.set(K,{...te,[L]:Q}),R})},[]),fe=D.useCallback((K,L)=>{const Q=s.get(K.id);return Q&&L in Q?Q[L]:K[L]},[s]),ne=D.useCallback((K,L)=>!(!K.duocPhepUng&&L>0||L>Number(K.mucToiDaDuocUng)),[]),H=()=>{if(s.size===0){ie("Khng c thay i  lu",{icon:""});return}const K=Array.from(s.entries()).map(([L,Q])=>({id:L,soTienUngDeXuat:Q.soTienUngDeXuat,soTienUngDuyet:Q.soTienUngDuyet,ghiChu:Q.ghiChu??void 0}));P.mutate({chiTiets:K})},W=D.useMemo(()=>{if(!(T!=null&&T.chiTiets))return{tongNV:0,tongDuocUng:0,tongTien:0};const K=T.chiTiets;return{tongNV:K.length,tongDuocUng:K.filter(L=>L.duocPhepUng).length,tongTien:K.reduce((L,Q)=>{const I=s.get(Q.id),R=(I==null?void 0:I.soTienUngDuyet)??Q.soTienUngDuyet;return L+Number(R)},0)}},[T==null?void 0:T.chiTiets,s]);if(_)return t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});if(!T)return t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-500",children:"Khng tm thy bng ng lng"})});const xe=T.chiTiets||[];return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>n("/ung-luong"),className:"p-2 hover:bg-gray-100 rounded-full",children:t.jsx(Y0,{size:24})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:T.maBangUngLuong}),t.jsxs("p",{className:"text-gray-500",children:["K ",T.thangNam," | ",new Date(T.tuNgay).toLocaleDateString("vi-VN")," -"," ",new Date(T.denNgay).toLocaleDateString("vi-VN")]})]})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("span",{className:`px-3 py-1 rounded-full text-sm ${T.trangThai==="NHAP"?"bg-yellow-100 text-yellow-800":T.trangThai==="DA_CHOT"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:T.trangThai==="NHAP"?"Nhp":T.trangThai==="DA_CHOT"?" cht":" kha"})})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[t.jsxs("div",{className:"card",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng nhn vin"}),t.jsx("p",{className:"text-2xl font-bold text-gray-800",children:W.tongNV})]}),t.jsxs("div",{className:"card",children:[t.jsx("p",{className:"text-sm text-gray-500",children:" iu kin ng"}),t.jsx("p",{className:"text-2xl font-bold text-green-600",children:W.tongDuocUng})]}),t.jsxs("div",{className:"card",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Khng  iu kin"}),t.jsx("p",{className:"text-2xl font-bold text-red-600",children:W.tongNV-W.tongDuocUng})]}),t.jsxs("div",{className:"card",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng tin ng"}),t.jsx("p",{className:"text-2xl font-bold text-blue-600",children:Ze(W.tongTien)})]})]}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"flex flex-wrap gap-2",children:[C&&t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>S.mutate({}),disabled:S.isPending,className:"btn btn-secondary",children:[t.jsx(cn,{size:18}),"Sinh danh sch NV"]}),t.jsxs("button",{onClick:()=>d(!0),className:"btn btn-secondary",children:[t.jsx(B_,{size:18}),"Set theo % mc ti a"]}),t.jsxs("button",{onClick:()=>x(!0),className:"btn btn-secondary",children:[t.jsx(gr,{size:18}),"Set s tin c nh"]}),t.jsxs("button",{onClick:H,disabled:s.size===0||P.isPending,className:"btn btn-primary",children:[t.jsx(_s,{size:18}),"Lu thay i (",s.size,")"]}),t.jsxs("button",{onClick:()=>{confirm("Bn c chc mun cht bng ng lng ny?")&&O.mutate()},disabled:xe.length===0,className:"btn bg-green-600 text-white hover:bg-green-700",children:[t.jsx(Br,{size:18}),"Cht"]})]}),T.trangThai==="DA_CHOT"&&t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>{confirm("Bn c chc mun kha bng ng lng ny?")&&M.mutate()},className:"btn bg-orange-600 text-white hover:bg-orange-700",children:[t.jsx(ti,{size:18}),"Kha"]}),t.jsxs("button",{onClick:()=>f(!0),disabled:T.daGhiNhanKhauTru,className:"btn btn-primary",children:[t.jsx(hj,{size:18}),T.daGhiNhanKhauTru?" ghi nhn khu tr":"Ghi nhn khu tr"]})]}),T.trangThai==="DA_KHOA"&&t.jsxs("button",{onClick:()=>{const K=prompt("Nhp l do m kha:");K&&G.mutate(K)},className:"btn bg-gray-600 text-white hover:bg-gray-700",children:[t.jsx(sg,{size:18}),"M kha"]}),t.jsx("button",{onClick:()=>w(),className:"btn btn-secondary ml-auto",children:t.jsx(K_,{size:18})})]})}),t.jsx("div",{className:"card overflow-x-auto",children:xe.length>0?t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-3 px-4 font-medium sticky left-0 bg-gray-50",children:"M NV"}),t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"H tn"}),t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Phng ban"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Ngy cng"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Ngh"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Ngh KP"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Tin cng ly k"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Mc ti a"}),t.jsx("th",{className:"text-center py-3 px-4 font-medium",children:"Eligible"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium bg-blue-50",children:"S tin  xut"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium bg-green-50",children:"S tin duyt"}),t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Ghi ch"})]})}),t.jsx("tbody",{children:xe.map(K=>{var R,te,ue;const L=fe(K,"soTienUngDuyet"),Q=ne(K,Number(L)),I=s.has(K.id);return t.jsxs("tr",{className:`border-b hover:bg-gray-50 ${K.duocPhepUng?"":"bg-red-50"} ${I?"bg-yellow-50":""}`,children:[t.jsx("td",{className:"py-2 px-4 font-medium sticky left-0 bg-white",children:(R=K.nhanVien)==null?void 0:R.maNhanVien}),t.jsx("td",{className:"py-2 px-4",children:(te=K.nhanVien)==null?void 0:te.hoTen}),t.jsx("td",{className:"py-2 px-4",children:(ue=K.phongBan)==null?void 0:ue.tenPhongBan}),t.jsxs("td",{className:"py-2 px-4 text-right",children:[Number(K.soNgayCong).toFixed(1),K.laTamTinh&&t.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs bg-yellow-100 text-yellow-700 rounded",title:"Tm tnh theo lch (cha c chm cng thc t)",children:"~"})]}),t.jsx("td",{className:"py-2 px-4 text-right",children:Number(K.soNgayNghi).toFixed(1)}),t.jsxs("td",{className:"py-2 px-4 text-right",children:[Number(K.soNgayNghiKhongPhep)>0&&t.jsx("span",{className:"text-red-600 font-medium",children:Number(K.soNgayNghiKhongPhep).toFixed(1)}),Number(K.soNgayNghiKhongPhep)===0&&"0"]}),t.jsx("td",{className:"py-2 px-4 text-right",children:Ze(K.tienCongLuyKe)}),t.jsx("td",{className:"py-2 px-4 text-right font-medium text-blue-600",children:Ze(K.mucToiDaDuocUng)}),t.jsx("td",{className:"py-2 px-4 text-center",children:K.duocPhepUng?t.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-green-100 text-green-600 rounded-full",children:t.jsx(Br,{size:14})}):t.jsx("span",{className:"inline-flex items-center gap-1 text-red-600",title:wV(K.lyDoKhongDat),children:t.jsx(di,{size:14})})}),t.jsx("td",{className:"py-2 px-4 bg-blue-50",children:t.jsx("input",{type:"number",min:"0",max:K.mucToiDaDuocUng,value:fe(K,"soTienUngDeXuat"),onChange:V=>X(K.id,"soTienUngDeXuat",Number(V.target.value)),disabled:!C||!K.duocPhepUng,className:`w-full px-2 py-1 border rounded text-right ${!C||!K.duocPhepUng?"bg-gray-100 cursor-not-allowed":"bg-white"}`})}),t.jsxs("td",{className:"py-2 px-4 bg-green-50",children:[t.jsx("input",{type:"number",min:"0",max:K.mucToiDaDuocUng,value:L,onChange:V=>X(K.id,"soTienUngDuyet",Number(V.target.value)),disabled:!C||!K.duocPhepUng,className:`w-full px-2 py-1 border rounded text-right ${!C||!K.duocPhepUng?"bg-gray-100 cursor-not-allowed":Q?"bg-white":"border-red-500 bg-red-50"}`}),!Q&&t.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Vt mc ti a"})]}),t.jsx("td",{className:"py-2 px-4",children:t.jsx("input",{type:"text",value:fe(K,"ghiChu")||"",onChange:V=>X(K.id,"ghiChu",V.target.value),disabled:!C,className:`w-full px-2 py-1 border rounded ${C?"bg-white":"bg-gray-100 cursor-not-allowed"}`,placeholder:"Ghi ch..."})})]},K.id)})})]}):t.jsxs("div",{className:"text-center py-12",children:[t.jsx(cn,{size:48,className:"mx-auto text-gray-400 mb-4"}),t.jsx("p",{className:"text-gray-500 mb-4",children:"Cha c nhn vin no trong bng ng lng"}),C&&t.jsxs("button",{onClick:()=>S.mutate({}),disabled:S.isPending,className:"btn btn-primary",children:[t.jsx(cn,{size:18}),"Sinh danh sch nhn vin"]})]})}),o&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Set theo % mc ti a"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T l (%)"}),t.jsx("input",{type:"number",min:"0",max:"100",value:p,onChange:K=>N(Number(K.target.value)),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"p dng cho tt c nhn vin  iu kin ng lng"}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:()=>F.mutate({tiLe:p,lamTron:1e4}),disabled:F.isPending,className:"btn btn-primary",children:F.isPending?"ang x l...":"p dng"})]})]})}),u&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Set s tin c nh"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S tin (VN)"}),t.jsx("input",{type:"number",min:"0",step:"100000",value:y,onChange:K=>g(Number(K.target.value)),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Ch p dng cho nhn vin c mc ti a >= s tin ny"}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:()=>B.mutate({soTien:y}),disabled:B.isPending,className:"btn btn-primary",children:B.isPending?"ang x l...":"p dng"})]})]})}),m&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Ghi nhn khu tr vo bng lng"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Chn bng lng p dng"}),t.jsxs("select",{value:b||"",onChange:K=>j(K.target.value?Number(K.target.value):null),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn bng lng --"}),(Array.isArray(E)?E:(E==null?void 0:E.data)||[]).map(K=>{var L;return t.jsxs("option",{value:K.id,children:["Thng ",K.thang,"/",K.nam," - ",((L=K.phongBan)==null?void 0:L.tenPhongBan)||"Tt c"]},K.id)})]})]}),t.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"H thng s to phiu iu chnh t ng  khu tr s tin ng t bng lng c chn."}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:()=>{if(!b){ie.error("Vui lng chn bng lng");return}J.mutate({bangLuongApDungId:b})},disabled:J.isPending||!b,className:"btn btn-primary",children:J.isPending?"ang x l...":"Ghi nhn"})]})]})})]})}function TV(){var g,b,j,T,_,w,E,C,S,P,F,B,O;const[e,n]=D.useState(""),[a,r]=D.useState(null),[s,l]=D.useState(()=>{const M=new Date;return M.setMonth(M.getMonth()-11),`${M.getFullYear()}-${String(M.getMonth()+1).padStart(2,"0")}`}),[o,d]=D.useState(()=>{const M=new Date;return`${M.getFullYear()}-${String(M.getMonth()+1).padStart(2,"0")}`}),[u,x]=D.useState("bangLuongs"),{data:m}=Fe({queryKey:["nhan-vien-search",e],queryFn:()=>ma.layTatCa({tuKhoa:e,soLuong:20}),enabled:e.length>=2}),f=m?{data:Array.isArray(m)?m:m.data}:void 0,{data:p,isLoading:N}=Fe({queryKey:["so-luong-nv",a,s,o],queryFn:()=>Wj.layNhanVien(a,{tuThang:Number(s.split("-")[1]),tuNam:Number(s.split("-")[0]),denThang:Number(o.split("-")[1]),denNam:Number(o.split("-")[0])}),enabled:!!a}),y=M=>{x(u===M?null:M)};return t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"S lng nhn vin"}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tm nhn vin"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",value:e,onChange:M=>n(M.target.value),placeholder:"Nhp m hoc tn nhn vin...",className:"w-full border rounded-lg px-3 py-2 pl-10"}),t.jsx(Vr,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(f==null?void 0:f.data)&&f.data.length>0&&e.length>=2&&t.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-60 overflow-y-auto",children:f.data.map(M=>{var G;return t.jsxs("button",{onClick:()=>{r(M.id),n(`${M.maNhanVien} - ${M.hoTen}`)},className:"w-full text-left px-4 py-2 hover:bg-gray-50",children:[t.jsx("span",{className:"font-medium",children:M.maNhanVien})," - ",M.hoTen,t.jsx("span",{className:"text-gray-500 text-sm block",children:(G=M.phongBan)==null?void 0:G.tenPhongBan})]},M.id)})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T thng"}),t.jsx(Tc,{value:s,onChange:l,className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n thng"}),t.jsx(Tc,{value:o,onChange:d,className:"w-full border rounded-lg px-3 py-2"})]})]})}),p&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"card mb-6",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[t.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center",children:t.jsx(so,{size:32,className:"text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold",children:p.nhanVien.hoTen}),t.jsxs("p",{className:"text-gray-500",children:[p.nhanVien.maNhanVien," | ",(g=p.nhanVien.phongBan)==null?void 0:g.tenPhongBan]})]}),t.jsxs("button",{className:"btn btn-secondary ml-auto",children:[t.jsx(ws,{size:18}),"Xut Excel"]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng lng"}),t.jsx("p",{className:"text-lg font-bold text-gray-800",children:Ze(((b=p.tongKet)==null?void 0:b.tongLuong)??0)})]}),t.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng thng"}),t.jsx("p",{className:"text-lg font-bold text-green-600",children:Ze(((j=p.tongKet)==null?void 0:j.tongThuong)??0)})]}),t.jsxs("div",{className:"bg-red-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng pht"}),t.jsx("p",{className:"text-lg font-bold text-red-600",children:Ze(((T=p.tongKet)==null?void 0:T.tongPhat)??0)})]}),t.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng khu tr"}),t.jsx("p",{className:"text-lg font-bold text-orange-600",children:Ze(((_=p.tongKet)==null?void 0:_.tongKhauTru)??0)})]}),t.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng ng"}),t.jsx("p",{className:"text-lg font-bold text-purple-600",children:Ze(((w=p.tongKet)==null?void 0:w.tongUng)??0)})]}),t.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Thc nhn"}),t.jsx("p",{className:"text-lg font-bold text-blue-600",children:Ze(((E=p.tongKet)==null?void 0:E.tongThucNhan)??0)})]})]})]}),t.jsxs("div",{className:"card mb-4",children:[t.jsxs("button",{onClick:()=>y("bangLuongs"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(ei,{size:20}),"Lch s bng lng (",((C=p.bangLuongs)==null?void 0:C.length)??0,")"]}),u==="bangLuongs"?t.jsx(Ol,{}):t.jsx(Ja,{})]}),u==="bangLuongs"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Thng"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Ngy cng"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Lng c bn"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Ph cp"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Thng"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Khu tr"}),t.jsx("th",{className:"text-right py-2 px-3",children:"BHXH"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Thu TNCN"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Thc lnh"})]})}),t.jsx("tbody",{children:(S=p.bangLuongs)==null?void 0:S.map(M=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3 font-medium",children:M.thangNam}),t.jsx("td",{className:"py-2 px-3 text-right",children:M.ngayCong}),t.jsx("td",{className:"py-2 px-3 text-right",children:Ze(M.luongCoBan)}),t.jsx("td",{className:"py-2 px-3 text-right",children:Ze(M.phuCapTong)}),t.jsx("td",{className:"py-2 px-3 text-right text-green-600",children:Ze(M.thuongKPI+M.thuongThuNhap)}),t.jsx("td",{className:"py-2 px-3 text-right text-red-600",children:Ze(M.khauTruTong+M.ungLuong)}),t.jsx("td",{className:"py-2 px-3 text-right",children:Ze(M.bhxh+M.bhyt+M.bhtn)}),t.jsx("td",{className:"py-2 px-3 text-right",children:Ze(M.thueTNCN)}),t.jsx("td",{className:"py-2 px-3 text-right font-bold text-blue-600",children:Ze(M.thucLanh)})]},M.bangLuongId))})]})})]}),t.jsxs("div",{className:"card mb-4",children:[t.jsxs("button",{onClick:()=>y("dieuChinhs"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(At,{size:20}),"Phiu iu chnh (",((P=p.dieuChinhs)==null?void 0:P.length)??0,")"]}),u==="dieuChinhs"?t.jsx(Ol,{}):t.jsx(Ja,{})]}),u==="dieuChinhs"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Loi phiu"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Khon"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Loi khon"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Ghi ch"})]})}),t.jsx("tbody",{children:(F=p.dieuChinhs)==null?void 0:F.map((M,G)=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3",children:new Date(M.ngayTao).toLocaleDateString("vi-VN")}),t.jsx("td",{className:"py-2 px-3",children:M.loaiPhieu}),t.jsx("td",{className:"py-2 px-3",children:M.tenKhoanLuong}),t.jsx("td",{className:"py-2 px-3",children:t.jsx("span",{className:M.loaiKhoan==="CONG_THEM"?"text-green-600":"text-red-600",children:M.loaiKhoan==="CONG_THEM"?"Cng thm":"Tr bt"})}),t.jsxs("td",{className:`py-2 px-3 text-right ${M.loaiKhoan==="CONG_THEM"?"text-green-600":"text-red-600"}`,children:[M.loaiKhoan==="CONG_THEM"?"+":"-",Ze(M.soTien)]}),t.jsx("td",{className:"py-2 px-3 text-gray-500",children:M.ghiChu})]},G))})]})})]}),t.jsxs("div",{className:"card mb-4",children:[t.jsxs("button",{onClick:()=>y("ungLuongs"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(oi,{size:20}),"ng lng (",((B=p.ungLuongs)==null?void 0:B.length)??0,")"]}),u==="ungLuongs"?t.jsx(Ol,{}):t.jsx(Ja,{})]}),u==="ungLuongs"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"M bng"}),t.jsx("th",{className:"text-left py-2 px-3",children:"K"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin duyt"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Trng thi"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Ngy cht"})]})}),t.jsx("tbody",{children:(O=p.ungLuongs)==null?void 0:O.map(M=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3 font-medium",children:M.maBang}),t.jsx("td",{className:"py-2 px-3",children:M.thangNam}),t.jsx("td",{className:"py-2 px-3 text-right font-bold text-purple-600",children:Ze(M.soTienDuyet)}),t.jsx("td",{className:"py-2 px-3 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${M.trangThai==="DA_KHOA"?"bg-green-100 text-green-800":M.trangThai==="DA_CHOT"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:M.trangThai==="DA_KHOA"?" kha":M.trangThai==="DA_CHOT"?" cht":"Nhp"})}),t.jsx("td",{className:"py-2 px-3",children:M.ngayChot?new Date(M.ngayChot).toLocaleDateString("vi-VN"):"-"})]},M.bangUngLuongId))})]})})]}),p.kpis&&p.kpis.length>0&&t.jsxs("div",{className:"card mb-4",children:[t.jsxs("button",{onClick:()=>y("kpis"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(oi,{size:20}),"nh gi KPI (",p.kpis.length,")"]}),u==="kpis"?t.jsx(Ol,{}):t.jsx(Ja,{})]}),u==="kpis"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Thng"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Tng im"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Xp loi"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Tin thng"})]})}),t.jsx("tbody",{children:p.kpis.map(M=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsxs("td",{className:"py-2 px-3",children:[M.thang,"/",M.nam]}),t.jsx("td",{className:"py-2 px-3 text-right",children:M.tongDiem}),t.jsx("td",{className:"py-2 px-3 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${M.xepLoai==="A"?"bg-green-100 text-green-800":M.xepLoai==="B"?"bg-blue-100 text-blue-800":M.xepLoai==="C"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:M.xepLoai})}),t.jsx("td",{className:"py-2 px-3 text-right text-green-600",children:Ze(M.tienThuong)})]},M.kyDanhGiaId))})]})})]}),p.thuongPhats&&p.thuongPhats.length>0&&t.jsxs("div",{className:"card",children:[t.jsxs("button",{onClick:()=>y("thuongPhats"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(At,{size:20}),"Thng/Pht (",p.thuongPhats.length,")"]}),u==="thuongPhats"?t.jsx(Ol,{}):t.jsx(Ja,{})]}),u==="thuongPhats"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Ngy"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Loi"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Tn"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"L do"})]})}),t.jsx("tbody",{children:p.thuongPhats.map(M=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3",children:new Date(M.ngay).toLocaleDateString("vi-VN")}),t.jsx("td",{className:"py-2 px-3 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${M.loai==="THUONG"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:M.loai==="THUONG"?"Thng":"Pht"})}),t.jsx("td",{className:"py-2 px-3",children:M.ten}),t.jsxs("td",{className:`py-2 px-3 text-right ${M.loai==="THUONG"?"text-green-600":"text-red-600"}`,children:[M.loai==="THUONG"?"+":"-",Ze(M.soTien)]}),t.jsx("td",{className:"py-2 px-3 text-gray-500",children:M.lyDo})]},M.suKienId))})]})})]})]}),!a&&t.jsxs("div",{className:"card text-center py-12",children:[t.jsx(so,{size:48,className:"mx-auto text-gray-400 mb-4"}),t.jsx("p",{className:"text-gray-500",children:"Vui lng chn nhn vin  xem s lng"})]}),N&&t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})]})}function CV(){var m,f,p,N,y,g,b,j,T,_,w,E,C;const[e,n]=D.useState(null),[a,r]=D.useState(()=>{const S=new Date;return S.setMonth(S.getMonth()-11),`${S.getFullYear()}-${String(S.getMonth()+1).padStart(2,"0")}`}),[s,l]=D.useState(()=>{const S=new Date;return`${S.getFullYear()}-${String(S.getMonth()+1).padStart(2,"0")}`}),{data:o}=Fe({queryKey:["phong-ban-list"],queryFn:Jt.layTatCa}),d=Array.isArray(o)?o:[],{data:u,isLoading:x}=Fe({queryKey:["so-luong-pb",e,a,s],queryFn:()=>Wj.layPhongBan(e,{tuThang:Number(a.split("-")[1]),tuNam:Number(a.split("-")[0]),denThang:Number(s.split("-")[1]),denNam:Number(s.split("-")[0])}),enabled:!!e});return t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"S lng phng ban"}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:e||"",onChange:S=>n(S.target.value?Number(S.target.value):null),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn phng ban --"}),d.map(S=>t.jsx("option",{value:S.id,children:S.tenPhongBan},S.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T thng"}),t.jsx(Tc,{value:a,onChange:r,className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n thng"}),t.jsx(Tc,{value:s,onChange:l,className:"w-full border rounded-lg px-3 py-2"})]})]})}),x&&t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),u&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"card mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-14 h-14 bg-blue-100 rounded-full flex items-center justify-center",children:t.jsx(Mr,{size:28,className:"text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold",children:(m=u.phongBan)==null?void 0:m.tenPhongBan}),t.jsxs("p",{className:"text-gray-500",children:["M: ",(f=u.phongBan)==null?void 0:f.maPhongBan]})]})]}),t.jsx("div",{className:"flex items-center gap-4",children:t.jsxs("button",{className:"btn btn-secondary",children:[t.jsx(ws,{size:18}),"Xut Excel"]})})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[t.jsx(cn,{size:18}),t.jsx("span",{className:"text-sm",children:"S nhn vin"})]}),t.jsx("p",{className:"text-2xl font-bold text-gray-800",children:((p=u.theoNhanVien)==null?void 0:p.length)??0})]}),t.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[t.jsx(gr,{size:18}),t.jsx("span",{className:"text-sm",children:"Tng thu nhp"})]}),t.jsx("p",{className:"text-xl font-bold text-blue-600",children:Ze(((N=u.tongHop)==null?void 0:N.tongThuNhap)??0)})]}),t.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[t.jsx(oi,{size:18}),t.jsx("span",{className:"text-sm",children:"Tng thng"})]}),t.jsx("p",{className:"text-xl font-bold text-green-600",children:Ze(((y=u.tongHop)==null?void 0:y.tongThuong)??0)})]}),t.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[t.jsx(oj,{size:18}),t.jsx("span",{className:"text-sm",children:"Thc lnh"})]}),t.jsx("p",{className:"text-xl font-bold text-purple-600",children:Ze(((g=u.tongHop)==null?void 0:g.thucLinh)??0)})]})]})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["Chi tit theo nhn vin (",((b=u.theoNhanVien)==null?void 0:b.length)??0,")"]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"M NV"}),t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"H tn"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Thu nhp"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Khu tr"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Thng"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Pht"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Thc lnh"})]})}),t.jsx("tbody",{children:(j=u.theoNhanVien)==null?void 0:j.map(S=>{var P,F,B,O,M,G,J,X;return t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4 font-medium",children:(P=S.nhanVien)==null?void 0:P.maNhanVien}),t.jsx("td",{className:"py-3 px-4",children:(F=S.nhanVien)==null?void 0:F.hoTen}),t.jsx("td",{className:"py-3 px-4 text-right",children:Ze(((B=S.tongHop)==null?void 0:B.tongThuNhap)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-red-600",children:Ze(((O=S.tongHop)==null?void 0:O.tongKhauTru)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-green-600",children:Ze(((M=S.tongHop)==null?void 0:M.tongThuong)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-orange-600",children:Ze(((G=S.tongHop)==null?void 0:G.tongPhat)??0)}),t.jsx("td",{className:"py-3 px-4 text-right font-bold text-blue-600",children:Ze(((J=S.tongHop)==null?void 0:J.thucLinh)??0)})]},(X=S.nhanVien)==null?void 0:X.id)})}),t.jsx("tfoot",{className:"bg-gray-100 font-semibold",children:t.jsxs("tr",{children:[t.jsx("td",{colSpan:2,className:"py-3 px-4",children:"Tng cng"}),t.jsx("td",{className:"py-3 px-4 text-right",children:Ze(((T=u.tongHop)==null?void 0:T.tongThuNhap)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-red-600",children:Ze(((_=u.tongHop)==null?void 0:_.tongKhauTru)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-green-600",children:Ze(((w=u.tongHop)==null?void 0:w.tongThuong)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-orange-600",children:Ze(((E=u.tongHop)==null?void 0:E.tongPhat)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-blue-600",children:Ze(((C=u.tongHop)==null?void 0:C.thucLinh)??0)})]})})]})})]})]}),!e&&t.jsxs("div",{className:"card text-center py-12",children:[t.jsx(Mr,{size:48,className:"mx-auto text-gray-400 mb-4"}),t.jsx("p",{className:"text-gray-500",children:"Vui lng chn phng ban  xem s lng"})]})]})}function SV(){const[e,n]=D.useState(null),[a,r]=D.useState(null),{data:s,isLoading:l}=Fe({queryKey:["khoan-luong-list"],queryFn:()=>pr.layTatCa()}),o=D.useMemo(()=>{if(!s||s.length===0)return[];const S=s.map(P=>({id:P.id,tenKhoan:P.tenKhoan,loai:P.loai}));return dw(S,!0,"CA_HAI")},[s]),{columns:d,visibleColumns:u,toggleColumn:x,moveColumn:m,resetColumns:f,showAllColumns:p}=pg("global_bang_luong",o),N=S=>{d[S].sticky||n(S)},y=(S,P)=>{S.preventDefault(),!d[P].sticky&&r(P)},g=()=>{e!==null&&a!==null&&e!==a&&(m(e,a),ie.success(" thay i th t ct")),n(null),r(null)},b=S=>{x(S);const P=d.find(F=>F.id===S);P&&ie.success(P.visible?` n ct "${P.label}"`:` hin ct "${P.label}"`)},j=()=>{f(),ie.success(" khi phc cu hnh mc nh")},T=()=>{p(),ie.success(" hin tt c cc ct")},_=d.filter(S=>S.sticky),w=d.filter(S=>!S.sticky),E=u.length,C=d.length;return l?t.jsxs("div",{className:"flex items-center justify-center h-64",children:[t.jsx(An,{className:"w-8 h-8 animate-spin text-blue-500"}),t.jsx("span",{className:"ml-2 text-gray-500",children:"ang ti danh sch khon lng..."})]}):t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-3",children:[t.jsx(fj,{className:"text-blue-500"}),"Cu hnh ct Bng lng"]}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Thit lp cc ct hin th v th t sp xp cho tt c bng lng"})]}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6 flex items-start gap-3",children:[t.jsx(vu,{className:"text-blue-500 flex-shrink-0 mt-0.5",size:20}),t.jsxs("div",{className:"text-sm text-blue-800",children:[t.jsx("p",{className:"font-medium mb-1",children:"Cu hnh ny p dng cho TT C bng lng"}),t.jsxs("ul",{className:"list-disc list-inside space-y-1 text-blue-700",children:[t.jsx("li",{children:"Cc ct c nh (STT, M NV, H tn) khng th n hoc di chuyn"}),t.jsx("li",{children:"Ko th  sp xp th t cc ct"}),t.jsx("li",{children:"Thay i c lu t ng"})]})]})]}),t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("div",{className:"flex items-center gap-4",children:t.jsxs("span",{className:"text-sm text-gray-600",children:["ang hin th: ",t.jsx("strong",{className:"text-blue-600",children:E})," / ",C," ct"]})}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:T,className:"flex items-center gap-2 px-3 py-2 text-sm rounded-lg bg-white border border-gray-200 hover:bg-gray-50 transition-colors",children:[t.jsx(Ba,{size:16}),"Hin tt c"]}),t.jsxs("button",{onClick:j,className:"flex items-center gap-2 px-3 py-2 text-sm rounded-lg bg-white border border-gray-200 hover:bg-gray-50 transition-colors",children:[t.jsx(bu,{size:16}),"Khi phc mc nh"]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden mb-4",children:[t.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:t.jsxs("h3",{className:"font-medium text-gray-700 flex items-center gap-2",children:[t.jsx(Gn,{size:16,className:"text-green-500"}),"Ct c nh (khng th thay i)"]})}),t.jsx("div",{className:"divide-y divide-gray-100",children:_.map(S=>t.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-gray-50/50",children:[t.jsx("div",{className:"w-6 h-6 flex items-center justify-center",children:t.jsx(rl,{size:16,className:"text-gray-300"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:S.label}),S.width&&t.jsxs("span",{className:"ml-2 text-xs text-gray-400",children:["(",S.width,")"]})]}),t.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:t.jsx(Ba,{size:16,className:"text-green-500"})})]},S.id))})]}),t.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:t.jsxs("h3",{className:"font-medium text-gray-700 flex items-center gap-2",children:[t.jsx(rl,{size:16,className:"text-gray-400"}),"Ct c th ty chnh (ko th  sp xp)"]})}),t.jsx("div",{className:"divide-y divide-gray-100",children:w.map(S=>{const P=d.findIndex(O=>O.id===S.id),F=e===P,B=a===P;return t.jsxs("div",{draggable:!S.sticky,onDragStart:()=>N(P),onDragOver:O=>y(O,P),onDragEnd:g,className:kt("flex items-center gap-3 px-4 py-3 transition-all",F&&"opacity-50 bg-blue-50",B&&"bg-blue-100 border-t-2 border-blue-400",!S.visible&&"bg-gray-50"),children:[t.jsx("div",{className:"w-6 h-6 flex items-center justify-center cursor-grab active:cursor-grabbing",children:t.jsx(rl,{size:16,className:"text-gray-400"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("span",{className:kt("text-sm font-medium",S.visible?"text-gray-700":"text-gray-400"),children:S.label}),S.bgColor&&t.jsx("span",{className:kt("ml-2 px-1.5 py-0.5 text-xs rounded",S.bgColor.replace("bg-","bg-").replace("100","200")),children:S.bgColor.replace("bg-","").replace("-100","")})]}),t.jsx("button",{onClick:()=>b(S.id),className:kt("w-8 h-8 flex items-center justify-center rounded-lg transition-colors",S.visible?"text-green-500 hover:bg-green-50":"text-gray-400 hover:bg-gray-100"),title:S.visible?"n ct":"Hin ct",children:S.visible?t.jsx(Ba,{size:16}):t.jsx(tg,{size:16})})]},S.id)})})]}),t.jsxs("div",{className:"mt-4 flex items-center justify-center gap-2 text-sm text-green-600",children:[t.jsx(_s,{size:16}),"Thay i c lu t ng"]})]})}function _V(){const[e,n]=D.useState(null),[a,r]=D.useState(null),s=D.useMemo(()=>tD(),[]),{columns:l,visibleColumns:o,toggleColumn:d,moveColumn:u,resetColumns:x,showAllColumns:m}=pg("global_ung_luong",s),f=E=>{l[E].sticky||n(E)},p=(E,C)=>{E.preventDefault(),!l[C].sticky&&r(C)},N=()=>{e!==null&&a!==null&&e!==a&&(u(e,a),ie.success(" thay i th t ct")),n(null),r(null)},y=E=>{d(E);const C=l.find(S=>S.id===E);C&&ie.success(C.visible?` n ct "${C.label}"`:` hin ct "${C.label}"`)},g=()=>{x(),ie.success(" khi phc cu hnh mc nh")},b=()=>{m(),ie.success(" hin tt c cc ct")},j=l.filter(E=>E.sticky),T=l.filter(E=>!E.sticky),_=o.length,w=l.length;return t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-3",children:[t.jsx(fj,{className:"text-purple-500"}),"Cu hnh ct Bng ng lng"]}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Thit lp cc ct hin th v th t sp xp cho tt c bng ng lng"})]}),t.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-4 mb-6 flex items-start gap-3",children:[t.jsx(vu,{className:"text-purple-500 flex-shrink-0 mt-0.5",size:20}),t.jsxs("div",{className:"text-sm text-purple-800",children:[t.jsx("p",{className:"font-medium mb-1",children:"Cu hnh ny p dng cho TT C bng ng lng"}),t.jsxs("ul",{className:"list-disc list-inside space-y-1 text-purple-700",children:[t.jsx("li",{children:"Cc ct c nh (STT, M NV, H tn) khng th n hoc di chuyn"}),t.jsx("li",{children:"Ko th  sp xp th t cc ct"}),t.jsx("li",{children:"Thay i c lu t ng"})]})]})]}),t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("div",{className:"flex items-center gap-4",children:t.jsxs("span",{className:"text-sm text-gray-600",children:["ang hin th: ",t.jsx("strong",{className:"text-purple-600",children:_})," / ",w," ct"]})}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-3 py-2 text-sm rounded-lg bg-white border border-gray-200 hover:bg-gray-50 transition-colors",children:[t.jsx(Ba,{size:16}),"Hin tt c"]}),t.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-3 py-2 text-sm rounded-lg bg-white border border-gray-200 hover:bg-gray-50 transition-colors",children:[t.jsx(bu,{size:16}),"Khi phc mc nh"]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden mb-4",children:[t.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:t.jsxs("h3",{className:"font-medium text-gray-700 flex items-center gap-2",children:[t.jsx(Gn,{size:16,className:"text-green-500"}),"Ct c nh (khng th thay i)"]})}),t.jsx("div",{className:"divide-y divide-gray-100",children:j.map(E=>t.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-gray-50/50",children:[t.jsx("div",{className:"w-6 h-6 flex items-center justify-center",children:t.jsx(rl,{size:16,className:"text-gray-300"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:E.label}),E.width&&t.jsxs("span",{className:"ml-2 text-xs text-gray-400",children:["(",E.width,")"]})]}),t.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:t.jsx(Ba,{size:16,className:"text-green-500"})})]},E.id))})]}),t.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:t.jsxs("h3",{className:"font-medium text-gray-700 flex items-center gap-2",children:[t.jsx(rl,{size:16,className:"text-gray-400"}),"Ct c th ty chnh (ko th  sp xp)"]})}),t.jsx("div",{className:"divide-y divide-gray-100",children:T.map(E=>{const C=l.findIndex(F=>F.id===E.id),S=e===C,P=a===C;return t.jsxs("div",{draggable:!E.sticky,onDragStart:()=>f(C),onDragOver:F=>p(F,C),onDragEnd:N,className:kt("flex items-center gap-3 px-4 py-3 transition-all",S&&"opacity-50 bg-purple-50",P&&"bg-purple-100 border-t-2 border-purple-400",!E.visible&&"bg-gray-50"),children:[t.jsx("div",{className:"w-6 h-6 flex items-center justify-center cursor-grab active:cursor-grabbing",children:t.jsx(rl,{size:16,className:"text-gray-400"})}),t.jsx("div",{className:"flex-1",children:t.jsx("span",{className:kt("text-sm font-medium",E.visible?"text-gray-700":"text-gray-400"),children:E.label})}),t.jsx("button",{onClick:()=>y(E.id),className:kt("w-8 h-8 flex items-center justify-center rounded-lg transition-colors",E.visible?"text-green-500 hover:bg-green-50":"text-gray-400 hover:bg-gray-100"),title:E.visible?"n ct":"Hin ct",children:E.visible?t.jsx(Ba,{size:16}):t.jsx(tg,{size:16})})]},E.id)})})]}),t.jsxs("div",{className:"mt-4 flex items-center justify-center gap-2 text-sm text-green-600",children:[t.jsx(_s,{size:16}),"Thay i c lu t ng"]})]})}const EV="tinh_luong_auth",da=Zt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});da.interceptors.request.use(e=>{const n=localStorage.getItem(EV);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const Ra={layDanhSachLoaiNghi:(e=!1)=>da.get("/nghi-phep/loai-nghi",{params:{all:e}}).then(n=>n.data),layLoaiNghi:e=>da.get(`/nghi-phep/loai-nghi/${e}`).then(n=>n.data),taoLoaiNghi:e=>da.post("/nghi-phep/loai-nghi",e).then(n=>n.data),capNhatLoaiNghi:(e,n)=>da.put(`/nghi-phep/loai-nghi/${e}`,n).then(a=>a.data),toggleLoaiNghi:e=>da.post(`/nghi-phep/loai-nghi/${e}/toggle`).then(n=>n.data),layDanhSachDon:e=>da.get("/nghi-phep/don",{params:e}).then(n=>n.data),layChiTietDon:e=>da.get(`/nghi-phep/don/${e}`).then(n=>n.data),taoDon:e=>da.post("/nghi-phep/don",e).then(n=>n.data),capNhatDon:(e,n)=>da.put(`/nghi-phep/don/${e}`,n).then(a=>a.data),guiDuyet:e=>da.post(`/nghi-phep/don/${e}/gui-duyet`).then(n=>n.data),duyetDon:(e,n)=>da.post(`/nghi-phep/don/${e}/duyet`,{ghiChu:n}).then(a=>a.data),tuChoiDon:(e,n)=>da.post(`/nghi-phep/don/${e}/tu-choi`,{lyDoTuChoi:n}).then(a=>a.data),huyDon:(e,n)=>da.post(`/nghi-phep/don/${e}/huy`,{lyDo:n}).then(a=>a.data),rebuildMapping:e=>da.post(`/nghi-phep/don/${e}/mapping/rebuild`).then(n=>n.data),layLichNghi:e=>da.get("/nghi-phep/lich",{params:e}).then(n=>n.data),layLichNghiNhanVien:(e,n,a)=>da.get(`/nghi-phep/nhan-vien/${e}/lich`,{params:{tuNgay:n,denNgay:a}}).then(r=>r.data)},K0=e=>({NHAP:"Nhp",GUI_DUYET:"Ch duyt",DA_DUYET:" duyt",TU_CHOI:"T chi",HUY:" hy"})[e]||e,Zi=e=>({NHAP:"gray",GUI_DUYET:"blue",DA_DUYET:"green",TU_CHOI:"red",HUY:"gray"})[e]||"gray",DV=e=>({CO_PHEP:"C php",KHONG_PHEP:"Khng php"})[e]||e;function AV(){const e=Mt(),[n,a]=D.useState(!1),[r,s]=D.useState(null),[l,o]=D.useState(!1),[d,u]=D.useState({maLoaiNghi:"",tenLoaiNghi:"",nhomLoai:"CO_PHEP",coTinhLuong:!0,coTinhChuyenCan:!1,thuTuHienThi:0}),{data:x,isLoading:m}=Fe({queryKey:["loai-nghi",l],queryFn:()=>Ra.layDanhSachLoaiNghi(l)}),f=Ee({mutationFn:Ra.taoLoaiNghi,onSuccess:()=>{e.invalidateQueries({queryKey:["loai-nghi"]}),ie.success("To loi ngh thnh cng!"),y()},onError:j=>{var T,_;ie.error(((_=(T=j.response)==null?void 0:T.data)==null?void 0:_.message)||"C li xy ra")}}),p=Ee({mutationFn:({id:j,data:T})=>Ra.capNhatLoaiNghi(j,T),onSuccess:()=>{e.invalidateQueries({queryKey:["loai-nghi"]}),ie.success("Cp nht thnh cng!"),y()},onError:j=>{var T,_;ie.error(((_=(T=j.response)==null?void 0:T.data)==null?void 0:_.message)||"C li xy ra")}}),N=Ee({mutationFn:Ra.toggleLoaiNghi,onSuccess:j=>{e.invalidateQueries({queryKey:["loai-nghi"]}),ie.success(j.isActive?" kch hot":" v hiu ha")},onError:j=>{var T,_;ie.error(((_=(T=j.response)==null?void 0:T.data)==null?void 0:_.message)||"C li xy ra")}}),y=()=>{a(!1),s(null),u({maLoaiNghi:"",tenLoaiNghi:"",nhomLoai:"CO_PHEP",coTinhLuong:!0,coTinhChuyenCan:!1,thuTuHienThi:0})},g=j=>{s(j),u({maLoaiNghi:j.maLoaiNghi,tenLoaiNghi:j.tenLoaiNghi,nhomLoai:j.nhomLoai,coTinhLuong:j.coTinhLuong,coTinhChuyenCan:j.coTinhChuyenCan,thuTuHienThi:j.thuTuHienThi}),a(!0)},b=()=>{if(!d.maLoaiNghi||!d.tenLoaiNghi){ie.error("Vui lng in y  thng tin bt buc");return}if(r){const{maLoaiNghi:j,...T}=d;p.mutate({id:r.id,data:T})}else f.mutate(d)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(At,{className:"w-8 h-8 text-indigo-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Danh mc loi ngh"}),t.jsx("p",{className:"text-gray-500",children:"Qun l cc loi ngh php trong h thng"})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[t.jsx("input",{type:"checkbox",checked:l,onChange:j=>o(j.target.checked),className:"rounded border-gray-300"}),"Hin th tt c"]}),t.jsxs("button",{onClick:()=>{y(),a(!0)},className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:[t.jsx(Dt,{className:"w-4 h-4"}),"Thm loi ngh"]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tn loi ngh"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nhm"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Tnh lng"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Tnh chuyn cn"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"ang ti..."})}):(x==null?void 0:x.length)===0?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"Cha c loi ngh no"})}):x==null?void 0:x.map(j=>t.jsxs("tr",{className:j.isActive?"":"bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-mono text-sm text-gray-900",children:j.maLoaiNghi}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:j.tenLoaiNghi}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${j.nhomLoai==="CO_PHEP"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:DV(j.nhomLoai)})}),t.jsx("td",{className:"px-6 py-4 text-center",children:j.coTinhLuong?t.jsx("span",{className:"text-green-600",children:""}):t.jsx("span",{className:"text-gray-400",children:""})}),t.jsx("td",{className:"px-6 py-4 text-center",children:j.coTinhChuyenCan?t.jsx("span",{className:"text-green-600",children:""}):t.jsx("span",{className:"text-gray-400",children:""})}),t.jsx("td",{className:"px-6 py-4 text-center",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${j.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:j.isActive?"Hot ng":"V hiu"})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[t.jsx("button",{onClick:()=>g(j),className:"text-indigo-600 hover:text-indigo-900 mr-3",title:"Sa",children:t.jsx(Za,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>N.mutate(j.id),className:`${j.isActive?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900"}`,title:j.isActive?"V hiu ha":"Kch hot",children:t.jsx(V_,{className:"w-4 h-4"})})]})]},j.id))})]})}),n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:r?"Sa loi ngh":"Thm loi ngh mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["M loi ngh ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:d.maLoaiNghi,onChange:j=>u({...d,maLoaiNghi:j.target.value.toUpperCase()}),disabled:!!r,className:"w-full border rounded-lg px-3 py-2 disabled:bg-gray-100",placeholder:"VD: PHEP_NAM"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn loi ngh ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:d.tenLoaiNghi,onChange:j=>u({...d,tenLoaiNghi:j.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Php nm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nhm loi ngh"}),t.jsxs("select",{value:d.nhomLoai,onChange:j=>u({...d,nhomLoai:j.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"CO_PHEP",children:"C php"}),t.jsx("option",{value:"KHONG_PHEP",children:"Khng php"})]})]}),t.jsxs("div",{className:"flex gap-6",children:[t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:d.coTinhLuong,onChange:j=>u({...d,coTinhLuong:j.target.checked}),className:"rounded border-gray-300"}),t.jsx("span",{className:"text-sm text-gray-700",children:"C tnh lng"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:d.coTinhChuyenCan,onChange:j=>u({...d,coTinhChuyenCan:j.target.checked}),className:"rounded border-gray-300"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Tnh chuyn cn"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Th t hin th"}),t.jsx("input",{type:"number",min:"0",value:d.thuTuHienThi,onChange:j=>u({...d,thuTuHienThi:parseInt(j.target.value)||0}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:y,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Hy"}),t.jsx("button",{onClick:b,disabled:f.isPending||p.isPending,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:f.isPending||p.isPending?"ang x l...":r?"Cp nht":"Thm mi"})]})]})})]})}function FV(){var O,M;const e=Mt(),{user:n}=ls(),[a,r]=D.useState(!1),[s,l]=D.useState(null),[o,d]=D.useState(null),[u,x]=D.useState(""),[m,f]=D.useState(null),[p,N]=D.useState({nhanVienId:0,loaiNghiId:0,tuNgay:"",denNgay:"",lyDo:""}),{data:y}=Fe({queryKey:["loai-nghi"],queryFn:()=>Ra.layDanhSachLoaiNghi()}),{data:g}=Fe({queryKey:["nhan-vien-don-gian"],queryFn:()=>ma.layTatCa()});D.useEffect(()=>{if(g&&n){const J=(Array.isArray(g)?g:g.data||[]).find(X=>X.email===n.email||X.id===n.nhanVienId);J&&(f(J),N(X=>({...X,nhanVienId:J.id})))}},[g,n]);const{data:b,isLoading:j}=Fe({queryKey:["don-nghi-phep",u,m==null?void 0:m.id],queryFn:()=>Ra.layDanhSachDon({nhanVienId:m==null?void 0:m.id,trangThai:u||void 0,limit:50}),enabled:!!m}),T=Ee({mutationFn:Ra.taoDon,onSuccess:()=>{e.invalidateQueries({queryKey:["don-nghi-phep"]}),ie.success("To n ngh php thnh cng!"),C()},onError:G=>{var J,X;ie.error(((X=(J=G.response)==null?void 0:J.data)==null?void 0:X.message)||"C li xy ra")}}),_=Ee({mutationFn:({id:G,data:J})=>Ra.capNhatDon(G,J),onSuccess:()=>{e.invalidateQueries({queryKey:["don-nghi-phep"]}),ie.success("Cp nht n thnh cng!"),C()},onError:G=>{var J,X;ie.error(((X=(J=G.response)==null?void 0:J.data)==null?void 0:X.message)||"C li xy ra")}}),w=Ee({mutationFn:Ra.guiDuyet,onSuccess:()=>{e.invalidateQueries({queryKey:["don-nghi-phep"]}),ie.success(" gi n  duyt!")},onError:G=>{var J,X;ie.error(((X=(J=G.response)==null?void 0:J.data)==null?void 0:X.message)||"C li xy ra")}}),E=Ee({mutationFn:G=>Ra.huyDon(G),onSuccess:()=>{e.invalidateQueries({queryKey:["don-nghi-phep"]}),ie.success(" hy n!")},onError:G=>{var J,X;ie.error(((X=(J=G.response)==null?void 0:J.data)==null?void 0:X.message)||"C li xy ra")}}),C=()=>{r(!1),l(null),N({nhanVienId:(m==null?void 0:m.id)||0,loaiNghiId:0,tuNgay:"",denNgay:"",lyDo:""})},S=G=>{l(G),N({nhanVienId:G.nhanVien.id,loaiNghiId:G.loaiNghi.id,tuNgay:G.tuNgay.split("T")[0],denNgay:G.denNgay.split("T")[0],lyDo:G.lyDo||""}),r(!0)},P=()=>{if(!p.loaiNghiId||!p.tuNgay||!p.denNgay){ie.error("Vui lng in y  thng tin bt buc");return}if(new Date(p.tuNgay)>new Date(p.denNgay)){ie.error("Ngy bt u phi nh hn hoc bng ngy kt thc");return}s?_.mutate({id:s.id,data:{loaiNghiId:p.loaiNghiId,tuNgay:p.tuNgay,denNgay:p.denNgay,lyDo:p.lyDo}}):T.mutate(p)},F=()=>{if(!p.tuNgay||!p.denNgay)return 0;const G=new Date(p.tuNgay),J=new Date(p.denNgay);let X=0;for(let fe=new Date(G);fe<=J;fe.setDate(fe.getDate()+1)){const ne=fe.getDay();ne!==0&&ne!==6&&X++}return X},B=G=>new Date(G).toLocaleDateString("vi-VN");return m?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(wn,{className:"w-8 h-8 text-indigo-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"n ngh ca ti"}),t.jsxs("p",{className:"text-gray-500",children:[m.hoTen," - ",m.maNhanVien]})]})]}),t.jsxs("button",{onClick:()=>{C(),r(!0)},className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:[t.jsx(Dt,{className:"w-4 h-4"}),"To n ngh"]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Lc theo trng thi:"}),t.jsxs("select",{value:u,onChange:G=>x(G.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"NHAP",children:"Nhp"}),t.jsx("option",{value:"GUI_DUYET",children:"Ch duyt"}),t.jsx("option",{value:"DA_DUYET",children:" duyt"}),t.jsx("option",{value:"TU_CHOI",children:"T chi"}),t.jsx("option",{value:"HUY",children:" hy"})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M n"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Loi ngh"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"T ngy"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"n ngy"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"S ngy"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"ang ti..."})}):((O=b==null?void 0:b.items)==null?void 0:O.length)===0?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"Cha c n ngh no"})}):(M=b==null?void 0:b.items)==null?void 0:M.map(G=>t.jsxs("tr",{children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-mono text-sm text-gray-900",children:G.maDon}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:G.loaiNghi.tenLoaiNghi}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:B(G.tuNgay)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:B(G.denNgay)}),t.jsx("td",{className:"px-6 py-4 text-center text-sm text-gray-900",children:G.soNgayNghi}),t.jsx("td",{className:"px-6 py-4 text-center",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full bg-${Zi(G.trangThai)}-100 text-${Zi(G.trangThai)}-800`,children:K0(G.trangThai)})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[t.jsx("button",{onClick:()=>d(G),className:"text-gray-600 hover:text-gray-900 mr-2",title:"Xem chi tit",children:t.jsx(Ba,{className:"w-4 h-4"})}),(G.trangThai==="NHAP"||G.trangThai==="TU_CHOI")&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>S(G),className:"text-indigo-600 hover:text-indigo-900 mr-2",title:"Sa",children:t.jsx(Za,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>w.mutate(G.id),className:"text-blue-600 hover:text-blue-900 mr-2",title:"Gi duyt",children:t.jsx(Nu,{className:"w-4 h-4"})})]}),G.trangThai!=="HUY"&&G.trangThai!=="DA_DUYET"&&t.jsx("button",{onClick:()=>{confirm("Bn c chc mun hy n ny?")&&E.mutate(G.id)},className:"text-red-600 hover:text-red-900",title:"Hy n",children:t.jsx(rn,{className:"w-4 h-4"})})]})]},G.id))})]})}),a&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:s?"Sa n ngh php":"To n ngh php mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Loi ngh ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("select",{value:p.loaiNghiId,onChange:G=>N({...p,loaiNghiId:parseInt(G.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn loi ngh --"}),y==null?void 0:y.map(G=>t.jsxs("option",{value:G.id,children:[G.tenLoaiNghi," (",G.coTinhLuong?"C lng":"Khng lng",")"]},G.id))]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["T ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Gt,{value:p.tuNgay,onChange:G=>N({...p,tuNgay:G}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["n ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Gt,{value:p.denNgay,onChange:G=>N({...p,denNgay:G}),className:"w-full border rounded-lg px-3 py-2"})]})]}),p.tuNgay&&p.denNgay&&t.jsx("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:t.jsxs("span",{className:"text-blue-700 font-medium",children:["S ngy ngh (khng tnh T7, CN): ",F()," ngy"]})}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"L do ngh"}),t.jsx("textarea",{value:p.lyDo,onChange:G=>N({...p,lyDo:G.target.value}),rows:3,className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp l do ngh (ty chn)"})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:C,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Hy"}),t.jsx("button",{onClick:P,disabled:T.isPending||_.isPending,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:T.isPending||_.isPending?"ang x l...":s?"Cp nht":"To n"})]})]})}),o&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h2",{className:"text-xl font-bold",children:"Chi tit n ngh"}),t.jsx("button",{onClick:()=>d(null),className:"text-gray-500 hover:text-gray-700",children:t.jsx(rn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"M n"}),t.jsx("p",{className:"font-mono font-medium",children:o.maDon})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Trng thi"}),t.jsx("p",{children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full bg-${Zi(o.trangThai)}-100 text-${Zi(o.trangThai)}-800`,children:K0(o.trangThai)})})]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Loi ngh"}),t.jsx("p",{className:"font-medium",children:o.loaiNghi.tenLoaiNghi})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"T ngy"}),t.jsx("p",{className:"font-medium",children:B(o.tuNgay)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"n ngy"}),t.jsx("p",{className:"font-medium",children:B(o.denNgay)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"S ngy"}),t.jsx("p",{className:"font-medium",children:o.soNgayNghi})]})]}),o.lyDo&&t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"L do"}),t.jsx("p",{className:"text-gray-700",children:o.lyDo})]}),o.nguoiDuyet&&t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Ngi duyt"}),t.jsx("p",{className:"font-medium",children:o.nguoiDuyet.hoTen}),o.ngayDuyet&&t.jsxs("p",{className:"text-sm text-gray-500",children:["Ngy duyt: ",B(o.ngayDuyet)]})]}),o.lyDoTuChoi&&t.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[t.jsx("span",{className:"text-sm text-red-600 font-medium",children:"L do t chi:"}),t.jsx("p",{className:"text-red-700",children:o.lyDoTuChoi})]})]}),t.jsx("div",{className:"flex justify-end mt-6",children:t.jsx("button",{onClick:()=>d(null),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"ng"})})]})})]}):t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsxs("div",{className:"text-center",children:[t.jsx(At,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),t.jsx("p",{className:"text-gray-500",children:"ang ti thng tin nhn vin..."})]})})}function LV(){var T,_;const e=Mt(),[n,a]=D.useState(null),[r,s]=D.useState(null),[l,o]=D.useState(""),[d,u]=D.useState({phongBanId:void 0,trangThai:"GUI_DUYET",tuNgay:"",denNgay:"",page:1}),{data:x}=Fe({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),{data:m,isLoading:f,refetch:p}=Fe({queryKey:["don-nghi-phep-duyet",d],queryFn:()=>Ra.layDanhSachDon({phongBanId:d.phongBanId,trangThai:d.trangThai||void 0,tuNgay:d.tuNgay||void 0,denNgay:d.denNgay||void 0,page:d.page,limit:20})}),N=Ee({mutationFn:w=>Ra.duyetDon(w),onSuccess:w=>{e.invalidateQueries({queryKey:["don-nghi-phep-duyet"]}),ie.success(` duyt n ${w.maDon}!`)},onError:w=>{var E,C;ie.error(((C=(E=w.response)==null?void 0:E.data)==null?void 0:C.message)||"C li xy ra khi duyt")}}),y=Ee({mutationFn:({id:w,lyDo:E})=>Ra.tuChoiDon(w,E),onSuccess:w=>{e.invalidateQueries({queryKey:["don-nghi-phep-duyet"]}),ie.success(` t chi n ${w.maDon}`),s(null),o("")},onError:w=>{var E,C;ie.error(((C=(E=w.response)==null?void 0:E.data)==null?void 0:C.message)||"C li xy ra")}}),g=Ee({mutationFn:Ra.rebuildMapping,onSuccess:w=>{ie.success(` rebuild mapping: ${w.soNgayTao} ngy`)},onError:w=>{var E,C;ie.error(((C=(E=w.response)==null?void 0:E.data)==null?void 0:C.message)||"C li xy ra")}}),b=w=>new Date(w).toLocaleDateString("vi-VN"),j=()=>{if(r){if(!l.trim()){ie.error("Vui lng nhp l do t chi");return}y.mutate({id:r.id,lyDo:l})}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Gn,{className:"w-8 h-8 text-green-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Duyt ngh php"}),t.jsx("p",{className:"text-gray-500",children:"Xem xt v ph duyt n ngh php ca nhn vin"})]})]}),t.jsxs("button",{onClick:()=>p(),className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-800",children:[t.jsx(yr,{className:"w-4 h-4"}),"Lm mi"]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t.jsx(ng,{className:"w-4 h-4 inline mr-1"}),"Phng ban"]}),t.jsxs("select",{value:d.phongBanId||"",onChange:w=>u({...d,phongBanId:w.target.value?parseInt(w.target.value):void 0,page:1}),className:"border rounded-lg px-3 py-2 min-w-[180px]",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),x==null?void 0:x.map(w=>t.jsx("option",{value:w.id,children:w.tenPhongBan},w.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng thi"}),t.jsxs("select",{value:d.trangThai,onChange:w=>u({...d,trangThai:w.target.value,page:1}),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"GUI_DUYET",children:"Ch duyt"}),t.jsx("option",{value:"DA_DUYET",children:" duyt"}),t.jsx("option",{value:"TU_CHOI",children:"T chi"}),t.jsx("option",{value:"NHAP",children:"Nhp"}),t.jsx("option",{value:"HUY",children:" hy"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T ngy"}),t.jsx(Gt,{value:d.tuNgay,onChange:w=>u({...d,tuNgay:w,page:1}),className:"border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n ngy"}),t.jsx(Gt,{value:d.denNgay,onChange:w=>u({...d,denNgay:w,page:1}),className:"border rounded-lg px-3 py-2"})]}),t.jsx("button",{onClick:()=>u({phongBanId:void 0,trangThai:"GUI_DUYET",tuNgay:"",denNgay:"",page:1}),className:"px-3 py-2 text-sm text-gray-600 hover:text-gray-800",children:"t li"})]})}),t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M n"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Loi ngh"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"S ngy"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-4 text-center text-gray-500",children:"ang ti..."})}):((T=m==null?void 0:m.items)==null?void 0:T.length)===0?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-4 text-center text-gray-500",children:"Khng c n ngh php no"})}):(_=m==null?void 0:m.items)==null?void 0:_.map(w=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 whitespace-nowrap font-mono text-sm text-gray-900",children:w.maDon}),t.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:w.nhanVien.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:w.nhanVien.maNhanVien})]}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:w.phongBan.tenPhongBan}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:w.loaiNghi.tenLoaiNghi}),t.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:[b(w.tuNgay)," - ",b(w.denNgay)]}),t.jsx("td",{className:"px-4 py-3 text-center text-sm font-medium text-gray-900",children:w.soNgayNghi}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full bg-${Zi(w.trangThai)}-100 text-${Zi(w.trangThai)}-800`,children:K0(w.trangThai)})}),t.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm font-medium",children:[t.jsx("button",{onClick:()=>a(w),className:"text-gray-600 hover:text-gray-900 mr-2",title:"Xem chi tit",children:t.jsx(Ba,{className:"w-4 h-4"})}),w.trangThai==="GUI_DUYET"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>N.mutate(w.id),disabled:N.isPending,className:"text-green-600 hover:text-green-900 mr-2",title:"Duyt",children:t.jsx(Br,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>s(w),className:"text-red-600 hover:text-red-900",title:"T chi",children:t.jsx(mo,{className:"w-4 h-4"})})]}),w.trangThai==="DA_DUYET"&&t.jsx("button",{onClick:()=>g.mutate(w.id),disabled:g.isPending,className:"text-blue-600 hover:text-blue-900",title:"Rebuild mapping",children:t.jsx(yr,{className:"w-4 h-4"})})]})]},w.id))})]}),(m==null?void 0:m.pagination)&&m.pagination.totalPages>1&&t.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 flex items-center justify-between",children:[t.jsxs("div",{className:"text-sm text-gray-500",children:["Trang ",m.pagination.page," / ",m.pagination.totalPages," (",m.pagination.total," n)"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>u({...d,page:d.page-1}),disabled:d.page<=1,className:"p-2 text-gray-600 hover:text-gray-900 disabled:opacity-50",children:t.jsx(Nr,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>u({...d,page:d.page+1}),disabled:d.page>=m.pagination.totalPages,className:"p-2 text-gray-600 hover:text-gray-900 disabled:opacity-50",children:t.jsx(qn,{className:"w-4 h-4"})})]})]})]}),n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h2",{className:"text-xl font-bold",children:"Chi tit n ngh"}),t.jsx("button",{onClick:()=>a(null),className:"text-gray-500 hover:text-gray-700",children:t.jsx(rn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"M n"}),t.jsx("p",{className:"font-mono font-medium",children:n.maDon})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Trng thi"}),t.jsx("p",{children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full bg-${Zi(n.trangThai)}-100 text-${Zi(n.trangThai)}-800`,children:K0(n.trangThai)})})]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Nhn vin"}),t.jsxs("p",{className:"font-medium",children:[n.nhanVien.hoTen," (",n.nhanVien.maNhanVien,")"]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Phng ban"}),t.jsx("p",{className:"font-medium",children:n.phongBan.tenPhongBan})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Loi ngh"}),t.jsx("p",{className:"font-medium",children:n.loaiNghi.tenLoaiNghi})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"T ngy"}),t.jsx("p",{className:"font-medium",children:b(n.tuNgay)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"n ngy"}),t.jsx("p",{className:"font-medium",children:b(n.denNgay)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"S ngy"}),t.jsx("p",{className:"font-medium",children:n.soNgayNghi})]})]}),n.lyDo&&t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"L do"}),t.jsx("p",{className:"text-gray-700",children:n.lyDo})]}),n.nguoiDuyet&&t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Ngi duyt"}),t.jsx("p",{className:"font-medium",children:n.nguoiDuyet.hoTen}),n.ngayDuyet&&t.jsxs("p",{className:"text-sm text-gray-500",children:["Ngy duyt: ",b(n.ngayDuyet)]})]}),n.lyDoTuChoi&&t.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[t.jsx("span",{className:"text-sm text-red-600 font-medium",children:"L do t chi:"}),t.jsx("p",{className:"text-red-700",children:n.lyDoTuChoi})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[n.trangThai==="GUI_DUYET"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>{a(null),s(n)},className:"px-4 py-2 text-red-600 hover:text-red-800",children:"T chi"}),t.jsx("button",{onClick:()=>{N.mutate(n.id),a(null)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Duyt n"})]}),t.jsx("button",{onClick:()=>a(null),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"ng"})]})]})}),r&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4 text-red-600",children:"T chi n ngh"}),t.jsxs("p",{className:"text-gray-600 mb-4",children:["T chi n ",t.jsx("strong",{children:r.maDon})," ca"," ",t.jsx("strong",{children:r.nhanVien.hoTen}),"?"]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["L do t chi ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("textarea",{value:l,onChange:w=>o(w.target.value),rows:3,className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp l do t chi..."})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:()=>{s(null),o("")},className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Hy"}),t.jsx("button",{onClick:j,disabled:y.isPending,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:y.isPending?"ang x l...":"T chi"})]})]})})]})}function PV(){const[e,n]=D.useState(()=>{const y=new Date;return`${y.getFullYear()}-${String(y.getMonth()+1).padStart(2,"0")}`}),[a,r]=D.useState(),{tuNgay:s,denNgay:l}=D.useMemo(()=>{const[y,g]=e.split("-").map(Number),b=new Date(y,g-1,1),j=new Date(y,g,0);return{tuNgay:b.toISOString().split("T")[0],denNgay:j.toISOString().split("T")[0]}},[e]),{data:o}=Fe({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),{data:d,isLoading:u}=Fe({queryKey:["lich-nghi",s,l,a],queryFn:()=>Ra.layLichNghi({phongBanId:a,tuNgay:s,denNgay:l})}),x=D.useMemo(()=>{const[y,g]=e.split("-").map(Number),b=new Date(y,g-1,1),j=new Date(y,g,0),T=[];for(let _=new Date(b);_<=j;_.setDate(_.getDate()+1))T.push(new Date(_));return T},[e]),m=D.useMemo(()=>{const y=new Map;return d==null||d.forEach(g=>{g.chiTietNgays.forEach(b=>{const j=`${g.nhanVien.id}-${b.ngay.split("T")[0]}`;y.set(j,{loaiNghi:b.loaiNghi.tenLoaiNghi,nhomLoai:b.loaiNghi.nhomLoai})})}),y},[d]),f=y=>{const[g,b]=e.split("-").map(Number),j=new Date(g,b-1+y,1);n(`${j.getFullYear()}-${String(j.getMonth()+1).padStart(2,"0")}`)},p=()=>{const[y,g]=e.split("-").map(Number);return`Thng ${g}/${y}`},N=y=>{const g=y.getDay();return g===0||g===6};return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(At,{className:"w-8 h-8 text-indigo-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Lch ngh php"}),t.jsx("p",{className:"text-gray-500",children:"Xem tng quan lch ngh php ca nhn vin"})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>f(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:t.jsx(Nr,{className:"w-5 h-5"})}),t.jsx("h2",{className:"text-lg font-semibold min-w-[140px] text-center",children:p()}),t.jsx("button",{onClick:()=>f(1),className:"p-2 hover:bg-gray-100 rounded-lg",children:t.jsx(qn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ng,{className:"w-4 h-4 text-gray-500"}),t.jsxs("select",{value:a||"",onChange:y=>r(y.target.value?parseInt(y.target.value):void 0),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),o==null?void 0:o.map(y=>t.jsx("option",{value:y.id,children:y.tenPhongBan},y.id))]})]})]})}),t.jsxs("div",{className:"flex gap-4 text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"w-4 h-4 bg-green-200 rounded"}),t.jsx("span",{children:"Ngh c php"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"w-4 h-4 bg-red-200 rounded"}),t.jsx("span",{children:"Ngh khng php"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"w-4 h-4 bg-gray-200 rounded"}),t.jsx("span",{children:"Cui tun"})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:u?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"ang ti..."}):d!=null&&d.length?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"sticky left-0 bg-gray-50 px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase min-w-[200px] border-r",children:"Nhn vin"}),x.map(y=>t.jsxs("th",{className:`px-2 py-3 text-center text-xs font-medium uppercase min-w-[36px] ${N(y)?"bg-gray-100 text-gray-400":"text-gray-500"}`,children:[t.jsx("div",{children:y.getDate()}),t.jsx("div",{className:"text-[10px] font-normal",children:["CN","T2","T3","T4","T5","T6","T7"][y.getDay()]})]},y.toISOString()))]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:d.map(y=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsxs("td",{className:"sticky left-0 bg-white px-4 py-2 border-r",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:y.nhanVien.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:y.nhanVien.maNhanVien})]}),x.map(g=>{const b=g.toISOString().split("T")[0],j=`${y.nhanVien.id}-${b}`,T=m.get(j);return t.jsx("td",{className:`px-1 py-2 text-center ${N(g)?"bg-gray-50":""}`,children:T&&t.jsx("div",{className:`w-6 h-6 mx-auto rounded-full flex items-center justify-center text-xs font-medium cursor-pointer ${T.nhomLoai==="CO_PHEP"?"bg-green-200 text-green-800":"bg-red-200 text-red-800"}`,title:T.loaiNghi,children:T.nhomLoai==="CO_PHEP"?"P":"K"})},g.toISOString())})]},y.nhanVien.id))})]})}):t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Khng c lch ngh php trong thng ny"})}),d&&d.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsxs("h3",{className:"font-medium text-gray-700 mb-3",children:["Thng k thng ",p()]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:d.length}),t.jsx("div",{className:"text-sm text-gray-500",children:"Nhn vin c ngh"})]}),t.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:d.reduce((y,g)=>y+g.chiTietNgays.filter(b=>b.loaiNghi.nhomLoai==="CO_PHEP").length,0)}),t.jsx("div",{className:"text-sm text-gray-500",children:"Ngy ngh c php"})]}),t.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-red-600",children:d.reduce((y,g)=>y+g.chiTietNgays.filter(b=>b.loaiNghi.nhomLoai==="KHONG_PHEP").length,0)}),t.jsx("div",{className:"text-sm text-gray-500",children:"Ngy ngh khng php"})]}),t.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:d.reduce((y,g)=>y+g.chiTietNgays.length,0)}),t.jsx("div",{className:"text-sm text-gray-500",children:"Tng ngy ngh"})]})]})]})]})}const ac={layDanhSach:async e=>(await he.get("/ca-lam-viec",{params:e})).data,layDanhSachActive:async e=>(await he.get("/ca-lam-viec/active",{params:{phongBanId:e}})).data,layChiTiet:async e=>(await he.get(`/ca-lam-viec/${e}`)).data,tao:async e=>(await he.post("/ca-lam-viec",e)).data,capNhat:async(e,n)=>(await he.put(`/ca-lam-viec/${e}`,n)).data,xoa:async e=>(await he.delete(`/ca-lam-viec/${e}`)).data,toggleTrangThai:async e=>(await he.patch(`/ca-lam-viec/${e}/toggle`)).data},_d=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#06B6D4","#84CC16"];function IV(){const e=Mt(),[n,a]=D.useState(!1),[r,s]=D.useState(null),[l,o]=D.useState(""),[d,u]=D.useState(),[x,m]=D.useState(),[f,p]=D.useState({maCa:"",tenCa:"",gioVao:"08:00",gioRa:"17:00",nghiGiuaCaPhut:60,graceInPhut:5,graceLatePhut:5,isCaDem:!1,phongBanId:void 0,moTa:"",mauHienThi:_d[0]}),{data:N,isLoading:y}=Fe({queryKey:["ca-lam-viec",d,x,l],queryFn:()=>ac.layDanhSach({phongBanId:d,trangThai:x,tuKhoa:l||void 0})}),{data:g}=Fe({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),b=Ee({mutationFn:ac.tao,onSuccess:()=>{e.invalidateQueries({queryKey:["ca-lam-viec"]}),ie.success("To ca lm vic thnh cng"),C()},onError:O=>{var M,G;ie.error(((G=(M=O.response)==null?void 0:M.data)==null?void 0:G.message)||"C li xy ra")}}),j=Ee({mutationFn:({id:O,data:M})=>ac.capNhat(O,M),onSuccess:()=>{e.invalidateQueries({queryKey:["ca-lam-viec"]}),ie.success("Cp nht thnh cng"),C()},onError:O=>{var M,G;ie.error(((G=(M=O.response)==null?void 0:M.data)==null?void 0:G.message)||"C li xy ra")}}),T=Ee({mutationFn:ac.xoa,onSuccess:()=>{e.invalidateQueries({queryKey:["ca-lam-viec"]}),ie.success(" xa ca lm vic")},onError:O=>{var M,G;ie.error(((G=(M=O.response)==null?void 0:M.data)==null?void 0:G.message)||"C li xy ra")}}),_=Ee({mutationFn:ac.toggleTrangThai,onSuccess:O=>{e.invalidateQueries({queryKey:["ca-lam-viec"]}),ie.success(O.trangThai?" kch hot ca":" v hiu ha ca")}}),w=()=>{s(null),p({maCa:"",tenCa:"",gioVao:"08:00",gioRa:"17:00",nghiGiuaCaPhut:60,graceInPhut:5,graceLatePhut:5,isCaDem:!1,phongBanId:void 0,moTa:"",mauHienThi:_d[Math.floor(Math.random()*_d.length)]}),a(!0)},E=O=>{s(O),p({maCa:O.maCa,tenCa:O.tenCa,gioVao:O.gioVao,gioRa:O.gioRa,nghiGiuaCaPhut:O.nghiGiuaCaPhut,graceInPhut:O.graceInPhut,graceLatePhut:O.graceLatePhut,isCaDem:O.isCaDem,phongBanId:O.phongBanId||void 0,moTa:O.moTa||"",mauHienThi:O.mauHienThi||_d[0]}),a(!0)},C=()=>{a(!1),s(null)},S=O=>{if(O.preventDefault(),!f.maCa||!f.tenCa||!f.gioVao||!f.gioRa){ie.error("Vui lng in y  thng tin bt buc");return}r?j.mutate({id:r.id,data:{tenCa:f.tenCa,gioVao:f.gioVao,gioRa:f.gioRa,nghiGiuaCaPhut:f.nghiGiuaCaPhut,graceInPhut:f.graceInPhut,graceLatePhut:f.graceLatePhut,isCaDem:f.isCaDem,phongBanId:f.phongBanId,moTa:f.moTa,mauHienThi:f.mauHienThi}}):b.mutate(f)},P=O=>{confirm(`Bn c chc mun xa ca "${O.tenCa}"?`)&&T.mutate(O.id)},F=(O,M,G,J)=>{const[X,fe]=O.split(":").map(Number),[ne,H]=M.split(":").map(Number);let W=X*60+fe,xe=ne*60+H;J&&xe<W&&(xe+=1440);const K=xe-W-G,L=Math.floor(K/60),Q=K%60;return`${L}h${Q>0?Q+"p":""}`},B=(N==null?void 0:N.data)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Danh mc Ca lm vic"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Qun l cc ca lm vic trong cng ty"})]}),t.jsxs(ft,{onClick:w,className:"flex items-center gap-2",children:[t.jsx(Dt,{className:"w-4 h-4"}),"Thm ca mi"]})]}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex flex-wrap gap-4",children:[t.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[t.jsx(Vr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Tm theo m hoc tn ca...",value:l,onChange:O=>o(O.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary-500"})]}),t.jsxs("select",{value:d||"",onChange:O=>u(O.target.value?Number(O.target.value):void 0),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),g==null?void 0:g.map(O=>t.jsx("option",{value:O.id,children:O.tenPhongBan},O.id))]}),t.jsxs("select",{value:x===void 0?"":x?"active":"inactive",onChange:O=>{O.target.value===""?m(void 0):m(O.target.value==="active")},className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:[t.jsx("option",{value:"",children:"Tt c trng thi"}),t.jsx("option",{value:"active",children:"ang hot ng"}),t.jsx("option",{value:"inactive",children:"Ngng hot ng"})]})]})}),t.jsx(st,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Mu"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"M ca"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Tn ca"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Gi lm"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Thi lng"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:y?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"ang ti..."})}):B.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"Cha c ca lm vic no"})}):B.map(O=>{var M;return t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white shadow",style:{backgroundColor:O.mauHienThi||"#3B82F6"}})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"font-mono text-sm font-medium text-gray-900 dark:text-white",children:O.maCa})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-2",children:[O.isCaDem?t.jsx(ub,{className:"w-4 h-4 text-indigo-500"}):t.jsx(pj,{className:"w-4 h-4 text-amber-500"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:O.tenCa})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[t.jsx(an,{className:"w-4 h-4 text-gray-400"}),t.jsxs("span",{className:"text-gray-900 dark:text-white",children:[O.gioVao," - ",O.gioRa]})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:F(O.gioVao,O.gioRa,O.nghiGiuaCaPhut,O.isCaDem)})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:O.phongBanId?(M=g==null?void 0:g.find(G=>G.id===O.phongBanId))==null?void 0:M.tenPhongBan:"Ton cng ty"})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("button",{onClick:()=>_.mutate(O.id),className:"inline-flex items-center gap-1",title:O.trangThai?"Click  v hiu ha":"Click  kch hot",children:O.trangThai?t.jsxs(t.Fragment,{children:[t.jsx(yj,{className:"w-6 h-6 text-green-500"}),t.jsx(_t,{variant:"success",children:"Hot ng"})]}):t.jsxs(t.Fragment,{children:[t.jsx(gj,{className:"w-6 h-6 text-gray-400"}),t.jsx(_t,{variant:"neutral",children:"Ngng"})]})})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>E(O),className:"p-2 text-gray-500 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",title:"Chnh sa",children:t.jsx(Za,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>P(O),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Xa",children:t.jsx(er,{className:"w-4 h-4"})})]})})]},O.id)})})]})})}),t.jsx(as,{isOpen:n,onClose:C,size:"lg",children:t.jsxs("form",{onSubmit:S,children:[t.jsx(Cs,{title:r?"Chnh sa ca lm vic":"Thm ca lm vic mi"}),t.jsx(Ss,{children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["M ca ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:f.maCa,onChange:O=>p({...f,maCa:O.target.value.toUpperCase()}),disabled:!!r,placeholder:"VD: CA_HANH_CHINH",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 disabled:bg-gray-100"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Tn ca ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:f.tenCa,onChange:O=>p({...f,tenCa:O.target.value}),placeholder:"VD: Ca hnh chnh",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Gi vo ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"time",value:f.gioVao,onChange:O=>p({...f,gioVao:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Gi ra ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"time",value:f.gioRa,onChange:O=>p({...f,gioRa:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ngh gia ca (pht)"}),t.jsx("input",{type:"number",min:0,max:120,value:f.nghiGiuaCaPhut,onChange:O=>p({...f,nghiGiuaCaPhut:Number(O.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Pht c php tr"}),t.jsx("input",{type:"number",min:0,max:60,value:f.graceLatePhut,onChange:O=>p({...f,graceLatePhut:Number(O.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"p dng cho phng ban"}),t.jsxs("select",{value:f.phongBanId||"",onChange:O=>p({...f,phongBanId:O.target.value?Number(O.target.value):void 0}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:[t.jsx("option",{value:"",children:"Ton cng ty"}),g==null?void 0:g.map(O=>t.jsx("option",{value:O.id,children:O.tenPhongBan},O.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Mu hin th"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"color",value:f.mauHienThi,onChange:O=>p({...f,mauHienThi:O.target.value}),className:"w-10 h-10 border-0 rounded cursor-pointer"}),t.jsx("div",{className:"flex gap-1",children:_d.map(O=>t.jsx("button",{type:"button",onClick:()=>p({...f,mauHienThi:O}),className:`w-6 h-6 rounded-full border-2 ${f.mauHienThi===O?"border-gray-800 dark:border-white":"border-transparent"}`,style:{backgroundColor:O}},O))})]})]}),t.jsx("div",{className:"md:col-span-2",children:t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:f.isCaDem,onChange:O=>p({...f,isCaDem:O.target.checked}),className:"w-4 h-4 text-primary-600 rounded"}),t.jsx(ub,{className:"w-4 h-4 text-indigo-500"}),t.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Ca m (qua ngy, VD: 22:00 - 06:00)"})]})}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"M t"}),t.jsx("textarea",{value:f.moTa,onChange:O=>p({...f,moTa:O.target.value}),rows:2,placeholder:"Ghi ch v ca lm vic...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]})]})}),t.jsxs(ni,{children:[t.jsx(ft,{variant:"secondary",onClick:C,type:"button",children:"Hy"}),t.jsx(ft,{type:"submit",disabled:b.isPending||j.isPending,children:b.isPending||j.isPending?"ang x l...":r?"Cp nht":"To mi"})]})]})})]})}const Fl={layDanhSach:async e=>(await he.get("/phan-ca",{params:e})).data,layChiTiet:async e=>(await he.get(`/phan-ca/${e}`)).data,layCalendarView:async e=>(await he.get("/phan-ca/calendar",{params:e})).data,tao:async e=>(await he.post("/phan-ca",e)).data,capNhat:async(e,n)=>(await he.put(`/phan-ca/${e}`,n)).data,assignNgay:async(e,n)=>(await he.post(`/phan-ca/${e}/assign`,n)).data,assignBatch:async(e,n)=>(await he.post(`/phan-ca/${e}/assign-batch`,n)).data,copyTuan:async(e,n)=>(await he.post(`/phan-ca/${e}/copy-week`,n)).data,publish:async e=>(await he.post(`/phan-ca/${e}/publish`)).data,unpublish:async e=>(await he.post(`/phan-ca/${e}/unpublish`)).data,xoa:async e=>(await he.delete(`/phan-ca/${e}`)).data,xoaChiTiet:async(e,n)=>(await he.post(`/phan-ca/${e}/xoa-chi-tiet`,{chiTietIds:n})).data,layLichCuaToi:async(e,n)=>(await he.get("/phan-ca/lich-cua-toi",{params:{tuNgay:e,denNgay:n}})).data},g2=["CN","T2","T3","T4","T5","T6","T7"];function OV(){var ue;const e=Mt(),[n,a]=D.useState(()=>{const V=new Date;return`${V.getFullYear()}-${String(V.getMonth()+1).padStart(2,"0")}`}),[r,s]=D.useState(),[l,o]=D.useState(null),[d,u]=D.useState(!1),[x,m]=D.useState(!1),[f,p]=D.useState(!1),[N,y]=D.useState({nhanVienIds:[],caLamViecId:0,tuNgay:"",denNgay:"",ngoaiTruThu:[]}),[g,b]=D.useState({tuanNguon:"",tuanDich:""}),{data:j}=Fe({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),{data:T}=Fe({queryKey:["ca-lam-viec-active",r],queryFn:()=>ac.layDanhSachActive(r)}),{data:_}=Fe({queryKey:["phan-ca",n,r],queryFn:()=>Fl.layDanhSach({thangNam:n,phongBanId:r})}),{data:w,isLoading:E}=Fe({queryKey:["phan-ca-calendar",n,r],queryFn:()=>Fl.layCalendarView({thangNam:n,phongBanId:r}),enabled:!!n}),{data:C}=Fe({queryKey:["nhan-vien",r],queryFn:()=>ma.layTatCa({phongBanId:r,trangThai:"DANG_LAM",soLuong:500})}),S=Ee({mutationFn:Fl.tao,onSuccess:V=>{e.invalidateQueries({queryKey:["phan-ca"]}),ie.success("To lch phn ca thnh cng"),o(V.id),u(!1)},onError:V=>{var le,q;ie.error(((q=(le=V.response)==null?void 0:le.data)==null?void 0:q.message)||"C li xy ra")}}),P=Ee({mutationFn:({lichId:V,payload:le})=>Fl.assignBatch(V,le),onSuccess:V=>{e.invalidateQueries({queryKey:["phan-ca-calendar"]}),ie.success(`${V.message} (${V.created} mi, ${V.updated} cp nht)`),m(!1)},onError:V=>{var le,q;ie.error(((q=(le=V.response)==null?void 0:le.data)==null?void 0:q.message)||"C li xy ra")}}),F=Ee({mutationFn:({lichId:V,payload:le})=>Fl.copyTuan(V,le),onSuccess:V=>{e.invalidateQueries({queryKey:["phan-ca-calendar"]}),ie.success(`${V.message}`),p(!1)},onError:V=>{var le,q;ie.error(((q=(le=V.response)==null?void 0:le.data)==null?void 0:q.message)||"C li xy ra")}}),B=Ee({mutationFn:Fl.publish,onSuccess:V=>{e.invalidateQueries({queryKey:["phan-ca"]}),e.invalidateQueries({queryKey:["phan-ca-calendar"]}),ie.success(`${V.message} (${V.mapped}  mapping)`)},onError:V=>{var le,q;ie.error(((q=(le=V.response)==null?void 0:le.data)==null?void 0:q.message)||"C li xy ra")}}),O=Ee({mutationFn:({lichId:V,payload:le})=>Fl.assignNgay(V,le),onSuccess:()=>{e.invalidateQueries({queryKey:["phan-ca-calendar"]})},onError:V=>{var le,q;ie.error(((q=(le=V.response)==null?void 0:le.data)==null?void 0:q.message)||"C li xy ra")}}),M=D.useMemo(()=>_!=null&&_.data?l?_.data.find(V=>V.id===l):_.data.find(V=>V.trangThai!=="HUY"):null,[_,l]),G=D.useMemo(()=>{const[V,le]=n.split("-").map(Number),q=new Date(V,le-1,1),Le=new Date(V,le,0),ee=[],ke=q.getDay();for(let tt=ke-1;tt>=0;tt--){const Xe=new Date(V,le-1,-tt);ee.push({date:Xe,dateStr:Xe.toISOString().split("T")[0],isCurrentMonth:!1})}for(let tt=1;tt<=Le.getDate();tt++){const Xe=new Date(V,le-1,tt);ee.push({date:Xe,dateStr:Xe.toISOString().split("T")[0],isCurrentMonth:!0})}const Ke=42-ee.length;for(let tt=1;tt<=Ke;tt++){const Xe=new Date(V,le,tt);ee.push({date:Xe,dateStr:Xe.toISOString().split("T")[0],isCurrentMonth:!1})}return ee},[n]),J=()=>{const[V,le]=n.split("-").map(Number),q=new Date(V,le-2,1);a(`${q.getFullYear()}-${String(q.getMonth()+1).padStart(2,"0")}`)},X=()=>{const[V,le]=n.split("-").map(Number),q=new Date(V,le,1);a(`${q.getFullYear()}-${String(q.getMonth()+1).padStart(2,"0")}`)},fe=()=>{S.mutate({thangNam:n,phongBanId:r,tenLich:`Lch phn ca ${n}${r?` - PB${r}`:""}`})},ne=(V,le,q)=>{if(!M||M.trangThai==="DA_CONG_BO")return;const Le=q==null?void 0:q.caLamViecId,ee=H(Le);ee&&O.mutate({lichId:M.id,payload:{nhanVienId:V,ngay:le,caLamViecId:ee.id}})},H=V=>{if(!T||T.length===0)return null;if(!V)return T[0];const q=(T.findIndex(Le=>Le.id===V)+1)%(T.length+1);return q===T.length?null:T[q]},W=()=>{if(M){if(!N.nhanVienIds.length||!N.caLamViecId||!N.tuNgay||!N.denNgay){ie.error("Vui lng in y  thng tin");return}P.mutate({lichId:M.id,payload:N})}},xe=()=>{if(M){if(!g.tuanNguon||!g.tuanDich){ie.error("Vui lng chn tun ngun v tun ch");return}F.mutate({lichId:M.id,payload:g})}},K=()=>{M&&confirm("Bn c chc mun cng b lch? Sau khi cng b s khng th chnh sa.")&&B.mutate(M.id)},[L,Q]=n.split("-").map(Number),I=`Thng ${Q}/${L}`,R=(w==null?void 0:w.nhanViens)||[],te=Array.isArray(C)?C:(C==null?void 0:C.data)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[t.jsx(At,{className:"w-6 h-6 text-primary-500"}),"Lch Phn Ca"]}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Phn ca lm vic cho nhn vin theo thng"})]}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[!M&&t.jsxs(ft,{onClick:()=>u(!0),className:"flex items-center gap-2",children:[t.jsx(Dt,{className:"w-4 h-4"}),"To lch mi"]}),M&&M.trangThai==="NHAP"&&t.jsxs(t.Fragment,{children:[t.jsxs(ft,{variant:"secondary",onClick:()=>{var V;y({nhanVienIds:[],caLamViecId:((V=T==null?void 0:T[0])==null?void 0:V.id)||0,tuNgay:`${n}-01`,denNgay:`${n}-${(w==null?void 0:w.soNgayTrongThang)||28}`,ngoaiTruThu:[0,6]}),m(!0)},className:"flex items-center gap-2",children:[t.jsx(cn,{className:"w-4 h-4"}),"Phn ca hng lot"]}),t.jsxs(ft,{variant:"secondary",onClick:()=>p(!0),className:"flex items-center gap-2",children:[t.jsx(uj,{className:"w-4 h-4"}),"Copy tun"]}),t.jsxs(ft,{onClick:K,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700",children:[t.jsx(Zr,{className:"w-4 h-4"}),"Cng b lch"]})]})]})]}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:J,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(Nr,{className:"w-5 h-5"})}),t.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white min-w-[150px] text-center",children:I}),t.jsx("button",{onClick:X,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(qn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("select",{value:r||"",onChange:V=>s(V.target.value?Number(V.target.value):void 0),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),j==null?void 0:j.map(V=>t.jsx("option",{value:V.id,children:V.tenPhongBan},V.id))]}),(_==null?void 0:_.data)&&_.data.length>0&&t.jsx("select",{value:l||(M==null?void 0:M.id)||"",onChange:V=>o(Number(V.target.value)),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:_.data.map(V=>t.jsxs("option",{value:V.id,children:[V.tenLich," (",V.trangThai,")"]},V.id))})]}),M&&t.jsxs("div",{className:"flex items-center gap-2",children:[M.trangThai==="DA_CONG_BO"?t.jsxs(_t,{variant:"success",className:"flex items-center gap-1",children:[t.jsx(Gn,{className:"w-4 h-4"})," cng b"]}):M.trangThai==="NHAP"?t.jsx(_t,{variant:"warning",className:"flex items-center gap-1",children:"ang son tho"}):t.jsx(_t,{variant:"neutral",children:" hy"}),t.jsxs("span",{className:"text-sm text-gray-500",children:[((ue=M._count)==null?void 0:ue.chiTiets)||0," phn ca"]})]})]})}),T&&T.length>0&&t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[t.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Ch thch:"}),T.map(V=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:V.mauHienThi||"#3B82F6"}}),t.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:[V.tenCa," (",V.gioVao,"-",V.gioRa,")"]})]},V.id)),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded bg-gray-200 dark:bg-gray-700"}),t.jsx("span",{className:"text-sm text-gray-500",children:"Cha phn ca"})]})]})}),t.jsx(st,{className:"overflow-hidden",children:E?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"ang ti lch..."}):R.length===0?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Cha c nhn vin no. Hy chn phng ban hoc to lch phn ca mi."}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-800",children:[t.jsx("th",{className:"sticky left-0 z-10 bg-gray-50 dark:bg-gray-800 px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 border-b border-r min-w-[180px]",children:"Nhn vin"}),G.filter(V=>V.isCurrentMonth).map(V=>{const le=V.date.getDay(),q=le===0||le===6;return t.jsxs("th",{className:`px-1 py-2 text-center text-xs font-semibold border-b min-w-[60px] ${q?"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-300"}`,children:[t.jsx("div",{children:g2[le]}),t.jsx("div",{className:"text-lg font-bold",children:V.date.getDate()})]},V.dateStr)})]})}),t.jsx("tbody",{children:R.map(V=>t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50",children:[t.jsxs("td",{className:"sticky left-0 z-10 bg-white dark:bg-gray-900 px-4 py-2 border-b border-r",children:[t.jsx("div",{className:"font-medium text-gray-900 dark:text-white text-sm",children:V.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:V.maNhanVien})]}),G.filter(le=>le.isCurrentMonth).map(le=>{const q=V.ngays[le.dateStr],Le=le.date.getDay(),ee=Le===0||Le===6,ke=M&&M.trangThai==="NHAP";return t.jsx("td",{onClick:()=>ke&&ne(V.nhanVienId,le.dateStr,q),className:`px-1 py-1 border-b text-center cursor-pointer transition-colors ${ee?"bg-red-50/50 dark:bg-red-900/10":""} ${ke?"hover:bg-primary-50 dark:hover:bg-primary-900/20":""}`,children:q?t.jsx("div",{className:"px-1 py-1 rounded text-xs font-medium text-white truncate",style:{backgroundColor:q.mauHienThi||"#3B82F6"},title:`${q.tenCa} (${q.gioVao}-${q.gioRa})`,children:q.maCa}):t.jsx("div",{className:"px-1 py-1 rounded text-xs text-gray-400",children:"-"})},le.dateStr)})]},V.nhanVienId))})]})})}),t.jsxs(as,{isOpen:d,onClose:()=>u(!1),children:[t.jsx(Cs,{title:"To lch phn ca mi"}),t.jsx(Ss,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Thng"}),t.jsx("input",{type:"month",value:n,onChange:V=>a(V.target.value),className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phng ban"}),t.jsxs("select",{value:r||"",onChange:V=>s(V.target.value?Number(V.target.value):void 0),className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Ton cng ty"}),j==null?void 0:j.map(V=>t.jsx("option",{value:V.id,children:V.tenPhongBan},V.id))]})]})]})}),t.jsxs(ni,{children:[t.jsx(ft,{variant:"secondary",onClick:()=>u(!1),children:"Hy"}),t.jsx(ft,{onClick:fe,disabled:S.isPending,children:S.isPending?"ang to...":"To lch"})]})]}),t.jsxs(as,{isOpen:x,onClose:()=>m(!1),size:"lg",children:[t.jsx(Cs,{title:"Phn ca hng lot"}),t.jsx(Ss,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Chn nhn vin ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("div",{className:"border rounded-lg p-2 max-h-48 overflow-y-auto",children:[t.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:N.nhanVienIds.length===te.length,onChange:V=>{y({...N,nhanVienIds:V.target.checked?te.map(le=>le.id):[]})},className:"w-4 h-4"}),t.jsx("span",{className:"font-medium",children:"Chn tt c"})]}),t.jsx("hr",{className:"my-2"}),te.map(V=>t.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:N.nhanVienIds.includes(V.id),onChange:le=>{const q=le.target.checked?[...N.nhanVienIds,V.id]:N.nhanVienIds.filter(Le=>Le!==V.id);y({...N,nhanVienIds:q})},className:"w-4 h-4"}),t.jsxs("span",{children:[V.hoTen," (",V.maNhanVien,")"]})]},V.id))]}),t.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[" chn: ",N.nhanVienIds.length," nhn vin"]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Ca lm vic ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("select",{value:N.caLamViecId,onChange:V=>y({...N,caLamViecId:Number(V.target.value)}),className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"-- Chn ca --"}),T==null?void 0:T.map(V=>t.jsxs("option",{value:V.id,children:[V.tenCa," (",V.gioVao," - ",V.gioRa,")"]},V.id))]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"T ngy"}),t.jsx("input",{type:"date",value:N.tuNgay,onChange:V=>y({...N,tuNgay:V.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"n ngy"}),t.jsx("input",{type:"date",value:N.denNgay,onChange:V=>y({...N,denNgay:V.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi tr cc ngy"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:g2.map((V,le)=>t.jsxs("label",{className:`px-3 py-1 rounded-full cursor-pointer border ${N.ngoaiTruThu.includes(le)?"bg-red-100 border-red-300 text-red-700":"bg-gray-100 border-gray-300"}`,children:[t.jsx("input",{type:"checkbox",className:"hidden",checked:N.ngoaiTruThu.includes(le),onChange:q=>{const Le=q.target.checked?[...N.ngoaiTruThu,le]:N.ngoaiTruThu.filter(ee=>ee!==le);y({...N,ngoaiTruThu:Le})}}),V]},le))})]})]})}),t.jsxs(ni,{children:[t.jsx(ft,{variant:"secondary",onClick:()=>m(!1),children:"Hy"}),t.jsx(ft,{onClick:W,disabled:P.isPending,children:P.isPending?"ang x l...":"Phn ca"})]})]}),t.jsxs(as,{isOpen:f,onClose:()=>p(!1),children:[t.jsx(Cs,{title:"Copy tun"}),t.jsx(Ss,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tun ngun (chn ngy bt k trong tun)"}),t.jsx("input",{type:"date",value:g.tuanNguon,onChange:V=>b({...g,tuanNguon:V.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tun ch (chn ngy bt k trong tun)"}),t.jsx("input",{type:"date",value:g.tuanDich,onChange:V=>b({...g,tuanDich:V.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]})]})}),t.jsxs(ni,{children:[t.jsx(ft,{variant:"secondary",onClick:()=>p(!1),children:"Hy"}),t.jsx(ft,{onClick:xe,disabled:F.isPending,children:F.isPending?"ang copy...":"Copy tun"})]})]})]})}const z0=e=>({NHAP:"Nhp",CHO_DUYET_1:"Ch duyt (Cp 1)",CHO_DUYET_2:"Ch duyt (Cp 2)",DA_DUYET:" duyt",TU_CHOI:"T chi",HUY:" hy"})[e]||e,$0=e=>({NHAP:"bg-gray-100 text-gray-700",CHO_DUYET_1:"bg-yellow-100 text-yellow-700",CHO_DUYET_2:"bg-orange-100 text-orange-700",DA_DUYET:"bg-green-100 text-green-700",TU_CHOI:"bg-red-100 text-red-700",HUY:"bg-gray-100 text-gray-500"})[e]||"bg-gray-100 text-gray-700",Ul=e=>({OT:"",TRE_GIO:"",VE_SOM:"",CONG_TAC:"",LAM_TU_XA:""})[e]||"",Na={layDanhSachLoai:async e=>(await he.get("/yeu-cau/loai",{params:{all:e?"true":void 0}})).data,layLoai:async e=>(await he.get(`/yeu-cau/loai/${e}`)).data,taoLoai:async e=>(await he.post("/yeu-cau/loai",e)).data,capNhatLoai:async(e,n)=>(await he.put(`/yeu-cau/loai/${e}`,n)).data,toggleLoai:async e=>(await he.post(`/yeu-cau/loai/${e}/toggle`)).data,layDanhSachDon:async e=>(await he.get("/yeu-cau/don",{params:e})).data,layDonCuaToi:async e=>(await he.get("/yeu-cau/don/cua-toi",{params:e})).data,layChiTietDon:async e=>(await he.get(`/yeu-cau/don/${e}`)).data,taoDon:async e=>(await he.post("/yeu-cau/don",e)).data,capNhatDon:async(e,n)=>(await he.put(`/yeu-cau/don/${e}`,n)).data,guiDuyet:async e=>(await he.post(`/yeu-cau/don/${e}/gui-duyet`)).data,duyetCap1:async(e,n)=>(await he.post(`/yeu-cau/don/${e}/duyet-cap-1`,{ghiChu:n})).data,duyetCap2:async(e,n)=>(await he.post(`/yeu-cau/don/${e}/duyet-cap-2`,{ghiChu:n})).data,tuChoiCap1:async(e,n)=>(await he.post(`/yeu-cau/don/${e}/tu-choi-cap-1`,{lyDoTuChoi:n})).data,tuChoiCap2:async(e,n)=>(await he.post(`/yeu-cau/don/${e}/tu-choi-cap-2`,{lyDoTuChoi:n})).data,override:async(e,n,a)=>(await he.post(`/yeu-cau/don/${e}/override`,{lyDoOverride:n,duyet:a})).data,huyDon:async e=>(await he.post(`/yeu-cau/don/${e}/huy`)).data,layInboxCap1:async e=>(await he.get("/yeu-cau/inbox/cap-1",{params:e})).data,layInboxCap2:async e=>(await he.get("/yeu-cau/inbox/cap-2",{params:e})).data,duyetBatch:async(e,n,a)=>(await he.post("/yeu-cau/inbox/duyet-batch",{ids:e,cap:n,ghiChu:a})).data,layDanhSachWorkflowConfig:async(e,n)=>(await he.get("/yeu-cau/workflow-config",{params:{loaiYeuCauId:e,phongBanId:n}})).data,taoWorkflowConfig:async e=>(await he.post("/yeu-cau/workflow-config",e)).data,capNhatWorkflowConfig:async(e,n)=>(await he.put(`/yeu-cau/workflow-config/${e}`,n)).data};function MV(){var fe,ne;const e=Mt(),{user:n}=ls(),[a,r]=D.useState(!1),[s,l]=D.useState(null),[o,d]=D.useState(null),[u,x]=D.useState(""),[m,f]=D.useState(""),[p,N]=D.useState(null),[y,g]=D.useState({nhanVienId:0,loaiYeuCauId:0,ngayYeuCau:new Date().toISOString().split("T")[0],gioBatDau:"",gioKetThuc:"",diaDiem:"",lyDo:""}),{data:b}=Fe({queryKey:["loai-yeu-cau"],queryFn:()=>Na.layDanhSachLoai()}),{data:j}=Fe({queryKey:["nhan-vien-don-gian"],queryFn:()=>ma.layTatCa()});D.useEffect(()=>{if(j&&n){const W=(Array.isArray(j)?j:j.data||[]).find(xe=>xe.email===n.email||xe.id===n.nhanVienId);W&&(N(W),g(xe=>({...xe,nhanVienId:W.id})))}},[j,n]);const{data:T,isLoading:_}=Fe({queryKey:["don-yeu-cau-cua-toi",u,m],queryFn:()=>Na.layDonCuaToi({trangThai:u||void 0,loaiYeuCauId:m||void 0,limit:50}),enabled:!0}),w=b==null?void 0:b.find(H=>H.id===y.loaiYeuCauId),E=Ee({mutationFn:Na.taoDon,onSuccess:()=>{e.invalidateQueries({queryKey:["don-yeu-cau-cua-toi"]}),ie.success("To n yu cu thnh cng!"),F()},onError:H=>{var W,xe;ie.error(((xe=(W=H.response)==null?void 0:W.data)==null?void 0:xe.message)||"C li xy ra")}}),C=Ee({mutationFn:({id:H,data:W})=>Na.capNhatDon(H,W),onSuccess:()=>{e.invalidateQueries({queryKey:["don-yeu-cau-cua-toi"]}),ie.success("Cp nht n thnh cng!"),F()},onError:H=>{var W,xe;ie.error(((xe=(W=H.response)==null?void 0:W.data)==null?void 0:xe.message)||"C li xy ra")}}),S=Ee({mutationFn:Na.guiDuyet,onSuccess:H=>{e.invalidateQueries({queryKey:["don-yeu-cau-cua-toi"]}),ie.success(` gi n ${H.maDon}  duyt!`)},onError:H=>{var W,xe;ie.error(((xe=(W=H.response)==null?void 0:W.data)==null?void 0:xe.message)||"C li xy ra")}}),P=Ee({mutationFn:Na.huyDon,onSuccess:()=>{e.invalidateQueries({queryKey:["don-yeu-cau-cua-toi"]}),ie.success(" hy n!")},onError:H=>{var W,xe;ie.error(((xe=(W=H.response)==null?void 0:W.data)==null?void 0:xe.message)||"C li xy ra")}}),F=()=>{g({nhanVienId:(p==null?void 0:p.id)||0,loaiYeuCauId:0,ngayYeuCau:new Date().toISOString().split("T")[0],gioBatDau:"",gioKetThuc:"",diaDiem:"",lyDo:""}),l(null),r(!1)},B=H=>{l(H),g({nhanVienId:H.nhanVienId,loaiYeuCauId:H.loaiYeuCauId,ngayYeuCau:H.ngayYeuCau.split("T")[0],gioBatDau:H.gioBatDau||"",gioKetThuc:H.gioKetThuc||"",diaDiem:H.diaDiem||"",lyDo:H.lyDo}),r(!0)},O=()=>{var H;if(!y.loaiYeuCauId){ie.error("Vui lng chn loi yu cu");return}if(!y.lyDo.trim()){ie.error("Vui lng nhp l do");return}if(w!=null&&w.yeuCauGioBatDau&&!y.gioBatDau){ie.error("Vui lng nhp gi bt u");return}if(w!=null&&w.yeuCauGioKetThuc&&!y.gioKetThuc){ie.error("Vui lng nhp gi kt thc");return}if(w!=null&&w.yeuCauDiaDiem&&!((H=y.diaDiem)!=null&&H.trim())){ie.error("Vui lng nhp a im");return}s?C.mutate({id:s.id,data:y}):E.mutate(y)},M=H=>{confirm(`Gi n ${H.maDon}  duyt?`)&&S.mutate(H.id)},G=H=>{confirm(`Hy n ${H.maDon}?`)&&P.mutate(H.id)},J=H=>new Date(H).toLocaleDateString("vi-VN"),X=(T==null?void 0:T.data)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"n yu cu ca ti"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"To v qun l n OT, Tr gi, V sm, Cng tc, Lm t xa"})]}),t.jsxs("button",{onClick:()=>{F(),r(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[t.jsx(Dt,{className:"w-5 h-5"}),"To n mi"]})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("select",{value:m,onChange:H=>f(H.target.value?Number(H.target.value):""),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[t.jsx("option",{value:"",children:"Tt c loi"}),b==null?void 0:b.map(H=>t.jsxs("option",{value:H.id,children:[Ul(H.maLoai)," ",H.tenLoai]},H.id))]}),t.jsxs("select",{value:u,onChange:H=>x(H.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[t.jsx("option",{value:"",children:"Tt c trng thi"}),t.jsx("option",{value:"NHAP",children:"Nhp"}),t.jsx("option",{value:"CHO_DUYET_1",children:"Ch duyt (Cp 1)"}),t.jsx("option",{value:"CHO_DUYET_2",children:"Ch duyt (Cp 2)"}),t.jsx("option",{value:"DA_DUYET",children:" duyt"}),t.jsx("option",{value:"TU_CHOI",children:"T chi"}),t.jsx("option",{value:"HUY",children:" hy"})]})]}),t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:_?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"ang ti..."}):X.length===0?t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx(wn,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Cha c n yu cu no"})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"M n"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Loi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:X.map(H=>{var W,xe;return t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:H.maDon})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{children:Ul(((W=H.loaiYeuCau)==null?void 0:W.maLoai)||"")}),t.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:(xe=H.loaiYeuCau)==null?void 0:xe.tenLoai})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300",children:J(H.ngayYeuCau)}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300",children:[H.gioBatDau&&H.gioKetThuc?`${H.gioBatDau} - ${H.gioKetThuc}`:H.gioBatDau||"-",H.soGio&&t.jsxs("span",{className:"ml-2 text-blue-600 dark:text-blue-400",children:["(",H.soGio,"h)"]})]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${$0(H.trangThai)}`,children:z0(H.trangThai)})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx("button",{onClick:()=>d(H),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Xem chi tit",children:t.jsx(Ba,{className:"w-4 h-4"})}),["NHAP","TU_CHOI"].includes(H.trangThai)&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>B(H),className:"p-2 text-gray-500 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg transition-colors",title:"Sa",children:t.jsx(Za,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>M(H),className:"p-2 text-gray-500 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Gi duyt",children:t.jsx(Nu,{className:"w-4 h-4"})})]}),["NHAP","CHO_DUYET_1","CHO_DUYET_2","TU_CHOI"].includes(H.trangThai)&&t.jsx("button",{onClick:()=>G(H),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Hy n",children:t.jsx(rn,{className:"w-4 h-4"})})]})})]},H.id)})})]})})}),a&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[t.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:t.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:s?"Sa n yu cu":"To n yu cu mi"})}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Loi yu cu ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("select",{value:y.loaiYeuCauId,onChange:H=>g({...y,loaiYeuCauId:Number(H.target.value)}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",disabled:!!s,children:[t.jsx("option",{value:0,children:"-- Chn loi yu cu --"}),b==null?void 0:b.map(H=>t.jsxs("option",{value:H.id,children:[Ul(H.maLoai)," ",H.tenLoai]},H.id))]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Gt,{value:y.ngayYeuCau,onChange:H=>g({...y,ngayYeuCau:H})})]}),((w==null?void 0:w.yeuCauGioBatDau)||y.gioBatDau)&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Gi bt u ",(w==null?void 0:w.yeuCauGioBatDau)&&t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"time",value:y.gioBatDau,onChange:H=>g({...y,gioBatDau:H.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),((w==null?void 0:w.yeuCauGioKetThuc)||y.gioKetThuc)&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Gi kt thc ",(w==null?void 0:w.yeuCauGioKetThuc)&&t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"time",value:y.gioKetThuc,onChange:H=>g({...y,gioKetThuc:H.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),((w==null?void 0:w.yeuCauDiaDiem)||y.diaDiem)&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["a im ",(w==null?void 0:w.yeuCauDiaDiem)&&t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:y.diaDiem,onChange:H=>g({...y,diaDiem:H.target.value}),placeholder:"Nhp a im...",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["L do ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("textarea",{value:y.lyDo,onChange:H=>g({...y,lyDo:H.target.value}),placeholder:"Nhp l do yu cu...",rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none"})]})]}),t.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[t.jsx("button",{onClick:F,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700",children:"Hy"}),t.jsx("button",{onClick:O,disabled:E.isPending||C.isPending,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:E.isPending||C.isPending?"ang lu...":s?"Cp nht":"To n"})]})]})}),o&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Chi tit n ",o.maDon]}),t.jsx("button",{onClick:()=>d(null),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(rn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Loi yu cu"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[Ul(((fe=o.loaiYeuCau)==null?void 0:fe.maLoai)||"")," ",(ne=o.loaiYeuCau)==null?void 0:ne.tenLoai]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Trng thi"}),t.jsx("span",{className:`inline-block px-2 py-1 text-xs font-medium rounded-full ${$0(o.trangThai)}`,children:z0(o.trangThai)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Ngy yu cu"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:J(o.ngayYeuCau)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Thi gian"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[o.gioBatDau&&o.gioKetThuc?`${o.gioBatDau} - ${o.gioKetThuc}`:o.gioBatDau||"-",o.soGio&&` (${o.soGio}h)`]})]})]}),o.diaDiem&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"a im"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:o.diaDiem})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"L do"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:o.lyDo})]}),o.nguoiDuyet1&&t.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Duyt cp 1"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[o.nguoiDuyet1.hoTen," -"," ",o.ngayDuyet1&&J(o.ngayDuyet1)]}),o.ghiChuDuyet1&&t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:o.ghiChuDuyet1})]}),o.nguoiDuyet2&&t.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Duyt cp 2"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[o.nguoiDuyet2.hoTen," -"," ",o.ngayDuyet2&&J(o.ngayDuyet2)]}),o.ghiChuDuyet2&&t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:o.ghiChuDuyet2})]}),o.lyDoTuChoi&&t.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[t.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 font-medium",children:"L do t chi"}),t.jsx("p",{className:"text-red-700 dark:text-red-300",children:o.lyDoTuChoi})]}),o.isOverride&&t.jsxs("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[t.jsxs("p",{className:"text-sm text-yellow-600 dark:text-yellow-400 font-medium flex items-center gap-1",children:[t.jsx(di,{className:"w-4 h-4"})," Override"]}),t.jsx("p",{className:"text-yellow-700 dark:text-yellow-300",children:o.lyDoOverride})]})]})]})})]})}function RV(){var L,Q,I,R,te,ue;const e=Mt(),[n,a]=D.useState("cap1"),[r,s]=D.useState(null),[l,o]=D.useState(null),[d,u]=D.useState(null),[x,m]=D.useState(""),[f,p]=D.useState(""),[N,y]=D.useState(!0),[g,b]=D.useState(new Set),[j,T]=D.useState({phongBanId:void 0,loaiYeuCauId:void 0,tuNgay:"",denNgay:"",page:1}),{data:_}=Fe({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),{data:w}=Fe({queryKey:["loai-yeu-cau"],queryFn:()=>Na.layDanhSachLoai()}),{data:E,isLoading:C,refetch:S}=Fe({queryKey:["don-yeu-cau-duyet",n,j],queryFn:()=>n==="cap1"?Na.layInboxCap1({phongBanId:j.phongBanId,loaiYeuCauId:j.loaiYeuCauId,tuNgay:j.tuNgay||void 0,denNgay:j.denNgay||void 0,page:j.page,limit:20}):n==="cap2"?Na.layInboxCap2({phongBanId:j.phongBanId,loaiYeuCauId:j.loaiYeuCauId,tuNgay:j.tuNgay||void 0,denNgay:j.denNgay||void 0,page:j.page,limit:20}):Na.layDanhSachDon({phongBanId:j.phongBanId,loaiYeuCauId:j.loaiYeuCauId,tuNgay:j.tuNgay||void 0,denNgay:j.denNgay||void 0,page:j.page,limit:20})}),P=Ee({mutationFn:V=>Na.duyetCap1(V),onSuccess:V=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),ie.success(` duyt n ${V.maDon}!`)},onError:V=>{var le,q;ie.error(((q=(le=V.response)==null?void 0:le.data)==null?void 0:q.message)||"C li xy ra")}}),F=Ee({mutationFn:V=>Na.duyetCap2(V),onSuccess:V=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),ie.success(` duyt n ${V.maDon}!`)},onError:V=>{var le,q;ie.error(((q=(le=V.response)==null?void 0:le.data)==null?void 0:q.message)||"C li xy ra")}}),B=Ee({mutationFn:({id:V,lyDo:le})=>Na.tuChoiCap1(V,le),onSuccess:V=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),ie.success(` t chi n ${V.maDon}`),o(null),m("")},onError:V=>{var le,q;ie.error(((q=(le=V.response)==null?void 0:le.data)==null?void 0:q.message)||"C li xy ra")}}),O=Ee({mutationFn:({id:V,lyDo:le})=>Na.tuChoiCap2(V,le),onSuccess:V=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),ie.success(` t chi n ${V.maDon}`),o(null),m("")},onError:V=>{var le,q;ie.error(((q=(le=V.response)==null?void 0:le.data)==null?void 0:q.message)||"C li xy ra")}}),M=Ee({mutationFn:({id:V,lyDo:le,duyet:q})=>Na.override(V,le,q),onSuccess:V=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),ie.success(` override n ${V.maDon}`),u(null),p("")},onError:V=>{var le,q;ie.error(((q=(le=V.response)==null?void 0:le.data)==null?void 0:q.message)||"C li xy ra")}}),G=Ee({mutationFn:({ids:V,cap:le})=>Na.duyetBatch(V,le),onSuccess:V=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),ie.success(` duyt ${V.success} n thnh cng!`),V.failed>0&&ie.error(`${V.failed} n tht bi`),b(new Set)},onError:V=>{var le,q;ie.error(((q=(le=V.response)==null?void 0:le.data)==null?void 0:q.message)||"C li xy ra")}}),J=V=>new Date(V).toLocaleDateString("vi-VN"),X=V=>{V.trangThai==="CHO_DUYET_1"?P.mutate(V.id):V.trangThai==="CHO_DUYET_2"&&F.mutate(V.id)},fe=()=>{if(!l||!x.trim()){ie.error("Vui lng nhp l do t chi");return}l.trangThai==="CHO_DUYET_1"?B.mutate({id:l.id,lyDo:x}):O.mutate({id:l.id,lyDo:x})},ne=()=>{if(!d||!f.trim()){ie.error("Vui lng nhp l do override");return}M.mutate({id:d.id,lyDo:f,duyet:N})},H=()=>{if(g.size===0){ie.error("Cha chn n no");return}const V=n==="cap1"?1:2;G.mutate({ids:Array.from(g),cap:V})},W=V=>{const le=new Set(g);le.has(V)?le.delete(V):le.add(V),b(le)},xe=()=>{const V=(E==null?void 0:E.data)||[];g.size===V.length?b(new Set):b(new Set(V.map(le=>le.id)))},K=(E==null?void 0:E.data)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Duyt yu cu"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Duyt n OT, Tr gi, V sm, Cng tc ca nhn vin"})]}),t.jsxs("button",{onClick:()=>S(),className:"flex items-center gap-2 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700",children:[t.jsx(yr,{className:"w-4 h-4"}),"Lm mi"]})]}),t.jsxs("div",{className:"flex gap-2 border-b border-gray-200 dark:border-gray-700",children:[t.jsx("button",{onClick:()=>{a("cap1"),b(new Set)},className:`px-4 py-2 font-medium transition-colors ${n==="cap1"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Cp 1 (Manager)"}),t.jsx("button",{onClick:()=>{a("cap2"),b(new Set)},className:`px-4 py-2 font-medium transition-colors ${n==="cap2"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Cp 2 (HR)"}),t.jsx("button",{onClick:()=>{a("tat-ca"),b(new Set)},className:`px-4 py-2 font-medium transition-colors ${n==="tat-ca"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Tt c"})]}),t.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[t.jsxs("select",{value:j.phongBanId||"",onChange:V=>T({...j,phongBanId:V.target.value?Number(V.target.value):void 0,page:1}),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),_==null?void 0:_.map(V=>t.jsx("option",{value:V.id,children:V.tenPhongBan},V.id))]}),t.jsxs("select",{value:j.loaiYeuCauId||"",onChange:V=>T({...j,loaiYeuCauId:V.target.value?Number(V.target.value):void 0,page:1}),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[t.jsx("option",{value:"",children:"Tt c loi"}),w==null?void 0:w.map(V=>t.jsxs("option",{value:V.id,children:[Ul(V.maLoai)," ",V.tenLoai]},V.id))]}),g.size>0&&(n==="cap1"||n==="cap2")&&t.jsxs("button",{onClick:H,disabled:G.isPending,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:[t.jsx(Gn,{className:"w-4 h-4"}),"Duyt ",g.size," n"]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[C?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"ang ti..."}):K.length===0?t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx(cn,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Khng c n yu cu no"})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:t.jsxs("tr",{children:[(n==="cap1"||n==="cap2")&&t.jsx("th",{className:"px-4 py-3 text-left",children:t.jsx("input",{type:"checkbox",checked:g.size===K.length&&K.length>0,onChange:xe,className:"w-4 h-4 rounded"})}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"M n"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Loi"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:K.map(V=>{var le,q,Le,ee;return t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[(n==="cap1"||n==="cap2")&&t.jsx("td",{className:"px-4 py-4",children:t.jsx("input",{type:"checkbox",checked:g.has(V.id),onChange:()=>W(V.id),className:"w-4 h-4 rounded"})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:V.maDon})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:(le=V.nhanVien)==null?void 0:le.hoTen}),t.jsx("p",{className:"text-sm text-gray-500",children:(q=V.nhanVien)==null?void 0:q.maNhanVien})]})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{children:Ul(((Le=V.loaiYeuCau)==null?void 0:Le.maLoai)||"")}),t.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:(ee=V.loaiYeuCau)==null?void 0:ee.tenLoai})]})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300",children:J(V.ngayYeuCau)}),t.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300",children:[V.gioBatDau&&V.gioKetThuc?`${V.gioBatDau} - ${V.gioKetThuc}`:V.gioBatDau||"-",V.soGio&&t.jsxs("span",{className:"ml-2 text-blue-600 dark:text-blue-400",children:["(",V.soGio,"h)"]})]}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${$0(V.trangThai)}`,children:z0(V.trangThai)})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx("button",{onClick:()=>s(V),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Xem chi tit",children:t.jsx(Ba,{className:"w-4 h-4"})}),["CHO_DUYET_1","CHO_DUYET_2"].includes(V.trangThai)&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>X(V),className:"p-2 text-gray-500 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Duyt",children:t.jsx(Gn,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>o(V),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"T chi",children:t.jsx(mo,{className:"w-4 h-4"})})]}),n==="tat-ca"&&!["HUY"].includes(V.trangThai)&&t.jsx("button",{onClick:()=>{u(V),y(V.trangThai==="TU_CHOI")},className:"p-2 text-gray-500 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg transition-colors",title:"Override",children:t.jsx(sa,{className:"w-4 h-4"})})]})})]},V.id)})})]})}),(E==null?void 0:E.pagination)&&E.pagination.totalPages>1&&t.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[t.jsxs("span",{className:"text-sm text-gray-500",children:["Trang ",E.pagination.page," / ",E.pagination.totalPages," (",E.pagination.total," n)"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>T({...j,page:j.page-1}),disabled:j.page<=1,className:"p-2 border rounded-lg disabled:opacity-50",children:t.jsx(Nr,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>T({...j,page:j.page+1}),disabled:j.page>=E.pagination.totalPages,className:"p-2 border rounded-lg disabled:opacity-50",children:t.jsx(qn,{className:"w-4 h-4"})})]})]})]}),r&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Chi tit n ",r.maDon]}),t.jsx("button",{onClick:()=>s(null),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(rn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Nhn vin"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[(L=r.nhanVien)==null?void 0:L.hoTen," (",(Q=r.nhanVien)==null?void 0:Q.maNhanVien,")"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Phng ban"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:(I=r.phongBan)==null?void 0:I.tenPhongBan})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Loi yu cu"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[Ul(((R=r.loaiYeuCau)==null?void 0:R.maLoai)||"")," ",(te=r.loaiYeuCau)==null?void 0:te.tenLoai]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Trng thi"}),t.jsx("span",{className:`inline-block px-2 py-1 text-xs font-medium rounded-full ${$0(r.trangThai)}`,children:z0(r.trangThai)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Ngy yu cu"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:J(r.ngayYeuCau)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Thi gian"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[r.gioBatDau&&r.gioKetThuc?`${r.gioBatDau} - ${r.gioKetThuc}`:r.gioBatDau||"-",r.soGio&&` (${r.soGio}h)`]})]})]}),r.diaDiem&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"a im"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:r.diaDiem})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"L do"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:r.lyDo})]}),r.lyDoTuChoi&&t.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[t.jsx("p",{className:"text-sm text-red-600 font-medium",children:"L do t chi"}),t.jsx("p",{className:"text-red-700",children:r.lyDoTuChoi})]})]}),["CHO_DUYET_1","CHO_DUYET_2"].includes(r.trangThai)&&t.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{o(r),s(null)},className:"px-4 py-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50",children:"T chi"}),t.jsx("button",{onClick:()=>{X(r),s(null)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Duyt"})]})]})}),l&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md",children:[t.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["T chi n ",l.maDon]})}),t.jsxs("div",{className:"p-6",children:[t.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:["T chi yu cu ca ",t.jsx("strong",{children:(ue=l.nhanVien)==null?void 0:ue.hoTen}),"?"]}),t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["L do t chi ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("textarea",{value:x,onChange:V=>m(V.target.value),placeholder:"Nhp l do t chi...",rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none"})]}),t.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{o(null),m("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:fe,disabled:B.isPending||O.isPending,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:"T chi"})]})]})}),d&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md",children:[t.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Override n ",d.maDon]})}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"radio",checked:N,onChange:()=>y(!0),className:"w-4 h-4"}),t.jsx("span",{className:"text-green-600 font-medium",children:"Override Duyt"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"radio",checked:!N,onChange:()=>y(!1),className:"w-4 h-4"}),t.jsx("span",{className:"text-red-600 font-medium",children:"Override T chi"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["L do override ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("textarea",{value:f,onChange:V=>p(V.target.value),placeholder:"Nhp l do override...",rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none"})]})]}),t.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{u(null),p("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:ne,disabled:M.isPending,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:opacity-50",children:"Override"})]})]})})]})}const el={layDanhSach:async e=>(await he.get("/thong-bao",{params:e})).data,demChuaDoc:async()=>(await he.get("/thong-bao/chua-doc")).data,danhDauDaDoc:async e=>(await he.put(`/thong-bao/${e}/da-doc`)).data,danhDauTatCaDaDoc:async()=>(await he.post("/thong-bao/da-doc-tat-ca")).data},MT=e=>{const n=new Date(e),r=new Date().getTime()-n.getTime(),s=Math.floor(r/6e4),l=Math.floor(r/36e5),o=Math.floor(r/864e5);return s<1?"Va xong":s<60?`${s} pht trc`:l<24?`${l} gi trc`:o<7?`${o} ngy trc`:n.toLocaleDateString("vi-VN")},RT=e=>{switch(e){case"YEU_CAU_MOI":return{icon:"",color:"text-blue-600"};case"YEU_CAU_DA_DUYET":return{icon:"",color:"text-green-600"};case"YEU_CAU_TU_CHOI":return{icon:"",color:"text-red-600"};case"NGHI_PHEP_MOI":return{icon:"",color:"text-blue-600"};case"NGHI_PHEP_DA_DUYET":return{icon:"",color:"text-green-600"};case"NGHI_PHEP_TU_CHOI":return{icon:"",color:"text-red-600"};case"LICH_PHAN_CA":return{icon:"",color:"text-purple-600"};case"PHIEU_LUONG":return{icon:"",color:"text-green-600"};case"HE_THONG":default:return{icon:"",color:"text-gray-600"}}};function BV({className:e=""}){var N;const n=br(),a=Mt(),[r,s]=D.useState(!1),l=D.useRef(null),{data:o}=Fe({queryKey:["thong-bao","chua-doc"],queryFn:()=>el.demChuaDoc(),refetchInterval:3e4}),{data:d,isLoading:u}=Fe({queryKey:["thong-bao","list",{limit:10}],queryFn:()=>el.layDanhSach({limit:10}),enabled:r}),x=Ee({mutationFn:y=>el.danhDauDaDoc(y),onSuccess:()=>{a.invalidateQueries({queryKey:["thong-bao"]})}}),m=Ee({mutationFn:()=>el.danhDauTatCaDaDoc(),onSuccess:()=>{a.invalidateQueries({queryKey:["thong-bao"]})}});D.useEffect(()=>{const y=g=>{l.current&&!l.current.contains(g.target)&&s(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]);const f=y=>{y.daDoc||x.mutate(y.id),y.link&&(n(y.link),s(!1))},p=(o==null?void 0:o.chuaDoc)||0;return t.jsxs("div",{className:`relative ${e}`,ref:l,children:[t.jsxs("button",{onClick:()=>s(!r),className:"relative p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"Thng bo",children:[t.jsx(jc,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"}),p>0&&t.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] flex items-center justify-center bg-red-500 text-white text-xs font-bold rounded-full px-1",children:p>99?"99+":p})]}),r&&t.jsxs("div",{className:"absolute right-0 top-full mt-2 w-80 max-h-[70vh] bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 overflow-hidden z-50 animate-scale-in",children:[t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Thng bo"}),t.jsxs("div",{className:"flex items-center gap-2",children:[p>0&&t.jsxs("button",{onClick:()=>m.mutate(),className:"text-xs text-blue-600 hover:text-blue-700 flex items-center gap-1",disabled:m.isPending,children:[t.jsx(cj,{className:"w-3 h-3"}),"c tt c"]}),t.jsx("button",{onClick:()=>s(!1),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:t.jsx(rn,{className:"w-4 h-4 text-gray-500"})})]})]}),t.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:u?t.jsx("div",{className:"p-4 text-center text-gray-500",children:"ang ti..."}):(N=d==null?void 0:d.data)!=null&&N.length?d.data.map(y=>{const{icon:g,color:b}=RT(y.loaiThongBao);return t.jsx("button",{onClick:()=>f(y),className:`w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors border-b border-gray-100 dark:border-gray-700 last:border-0 ${y.daDoc?"":"bg-blue-50/50 dark:bg-blue-900/20"}`,children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx("span",{className:`text-xl ${b}`,children:g}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsx("p",{className:`text-sm font-medium truncate ${y.daDoc?"text-gray-600 dark:text-gray-400":"text-gray-900 dark:text-white"}`,children:y.tieuDe}),!y.daDoc&&t.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-1.5"})]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5 line-clamp-2",children:y.noiDung}),t.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:MT(y.ngayTao)})]})]})},y.id)}):t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx(jc,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),t.jsx("p",{children:"Khng c thng bo"})]})}),d&&d.total>10&&t.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 p-2",children:t.jsxs("button",{onClick:()=>{n("/thong-bao"),s(!1)},className:"w-full text-center text-sm text-blue-600 hover:text-blue-700 py-2",children:["Xem tt c (",d.total,")"]})})]})]})}const Uf=[{id:"home",label:"Trang ch",icon:J0,path:"/portal"},{id:"schedule",label:"Lch lm",icon:At,path:"/portal/lich-lam"},{id:"attendance",label:"Chm cng",icon:an,path:"/portal/cham-cong"},{id:"requests",label:"Yu cu",icon:wn,path:"/portal/yeu-cau"},{id:"profile",label:"C nhn",icon:so,path:"/portal/ca-nhan"}];function HV(){var x,m;const e=Ds(),n=br(),{user:a,dangXuat:r}=ls(),[s,l]=D.useState(!1),o=((x=Uf.find(f=>e.pathname===f.path))==null?void 0:x.id)||"home",d=()=>{const f=Uf.find(p=>e.pathname.startsWith(p.path));return(f==null?void 0:f.label)||"Portal"},u=async()=>{await r(),n("/dang-nhap")};return t.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex flex-col",children:[t.jsx("header",{className:"sticky top-0 z-40 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-between max-w-lg mx-auto",children:[e.pathname!=="/portal"?t.jsx("button",{onClick:()=>n(-1),className:"p-2 -ml-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(Nr,{className:"w-5 h-5"})}):t.jsx("div",{className:"w-9"}),t.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:d()}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(BV,{}),t.jsx("button",{onClick:()=>l(!s),className:"p-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(O_,{className:"w-5 h-5"})})]})]})}),s&&t.jsx("div",{className:"fixed inset-0 z-50 bg-black/50",onClick:()=>l(!1),children:t.jsxs("div",{className:"absolute right-0 top-0 h-full w-64 bg-white dark:bg-gray-800 shadow-xl",onClick:f=>f.stopPropagation(),children:[t.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[t.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:"Menu"}),t.jsx("button",{onClick:()=>l(!1),className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(rn,{className:"w-5 h-5"})})]}),t.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-semibold",children:((m=a==null?void 0:a.hoTen)==null?void 0:m[0])||"U"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a==null?void 0:a.hoTen}),t.jsx("p",{className:"text-sm text-gray-500",children:a==null?void 0:a.email})]})]})}),t.jsxs("nav",{className:"p-2",children:[t.jsxs("button",{onClick:()=>n("/"),className:"w-full flex items-center gap-3 px-4 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:[t.jsx(J0,{className:"w-5 h-5"}),t.jsx("span",{children:"V trang Admin"})]}),t.jsxs("button",{onClick:u,className:"w-full flex items-center gap-3 px-4 py-3 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg",children:[t.jsx(ag,{className:"w-5 h-5"}),t.jsx("span",{children:"ng xut"})]})]})]})}),t.jsx("main",{className:"flex-1 overflow-y-auto pb-20",children:t.jsx("div",{className:"max-w-lg mx-auto px-4 py-4",children:t.jsx(Z2,{})})}),t.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-40 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 safe-area-pb",children:t.jsx("div",{className:"max-w-lg mx-auto flex items-center justify-around h-16",children:Uf.map(f=>{const p=f.icon,N=o===f.id;return t.jsxs("button",{onClick:()=>n(f.path),className:`flex flex-col items-center justify-center flex-1 h-full transition-colors ${N?"text-blue-600 dark:text-blue-400":"text-gray-500 dark:text-gray-400"}`,children:[t.jsx(p,{className:`w-5 h-5 mb-1 ${N?"stroke-[2.5]":""}`}),t.jsx("span",{className:`text-xs ${N?"font-medium":""}`,children:f.label})]},f.id)})})})]})}const Bc={getDashboard:async()=>(await he.get("/employee-portal/dashboard")).data,getLichLamViec:async e=>(await he.get("/employee-portal/lich-lam-viec",{params:e})).data,getChamCong:async e=>(await he.get("/employee-portal/cham-cong",{params:e})).data,getPhieuLuong:async e=>(await he.get("/employee-portal/phieu-luong",{params:e})).data,getChiTietPhieuLuong:async e=>(await he.get(`/employee-portal/phieu-luong/${e}`)).data,getSoDuPhep:async()=>(await he.get("/employee-portal/so-du-phep")).data,getHoSo:async()=>(await he.get("/employee-portal/ho-so")).data,checkIn:async()=>(await he.post("/employee-portal/check-in")).data,checkOut:async()=>(await he.post("/employee-portal/check-out")).data},VV=e=>["CN","T2","T3","T4","T5","T6","T7"][e]||"",UV=e=>["Ch nht","Th hai","Th ba","Th t","Th nm","Th su","Th by"][e]||"",G0=e=>{if(!e)return"--:--";const n=new Date(e);return`${String(n.getHours()).padStart(2,"0")}:${String(n.getMinutes()).padStart(2,"0")}`},Kf=e=>new Intl.NumberFormat("vi-VN").format(e)+"",KV="tinh_luong_auth",Un=Zt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});Un.interceptors.request.use(e=>{const n=localStorage.getItem(KV);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const fr={layDanhSachGeofence:e=>Un.get("/anti-fraud/geofence",{params:e}).then(n=>n.data),layGeofence:e=>Un.get(`/anti-fraud/geofence/${e}`).then(n=>n.data),taoGeofence:e=>Un.post("/anti-fraud/geofence",e).then(n=>n.data),capNhatGeofence:(e,n)=>Un.put(`/anti-fraud/geofence/${e}`,n).then(a=>a.data),xoaGeofence:e=>Un.delete(`/anti-fraud/geofence/${e}`).then(n=>n.data),layGeofenceCuaToi:()=>Un.get("/anti-fraud/my-geofence").then(e=>e.data),gpsCheckin:e=>Un.post("/anti-fraud/gps-checkin",e).then(n=>n.data),layLichSuGPS:e=>Un.get("/anti-fraud/gps-logs",{params:e}).then(n=>n.data),layLichSuGPSCuaToi:e=>Un.get("/anti-fraud/my-gps-logs",{params:e}).then(n=>n.data),thongKeGPS:(e,n,a)=>Un.get("/anti-fraud/thong-ke",{params:{tuNgay:e,denNgay:n,phongBanId:a}}).then(r=>r.data),layDanhSachThietBi:e=>Un.get("/anti-fraud/devices",{params:e}).then(n=>n.data),layThietBiNhanVien:e=>Un.get(`/anti-fraud/devices/${e}`).then(n=>n.data),layThietBiCuaToi:()=>Un.get("/anti-fraud/my-device").then(e=>e.data),kiemTraDevice:e=>Un.post("/anti-fraud/check-device",{deviceId:e}).then(n=>n.data),bindDevice:e=>Un.post("/anti-fraud/bind-device",e).then(n=>n.data),resetDevice:e=>Un.post("/anti-fraud/reset-device",e).then(n=>n.data),blockDevice:(e,n)=>Un.post(`/anti-fraud/block-device/${e}`,{lyDo:n}).then(a=>a.data),layLichSuThietBi:e=>Un.get("/anti-fraud/device-history",{params:e}).then(n=>n.data)},BT=()=>new Promise((e,n)=>{if(!navigator.geolocation){n(new Error("Trnh duyt khng h tr GPS"));return}navigator.geolocation.getCurrentPosition(a=>{e({viDo:a.coords.latitude,kinhDo:a.coords.longitude,doChinhXacMet:Math.round(a.coords.accuracy)})},a=>{switch(a.code){case a.PERMISSION_DENIED:n(new Error("Bn  t chi quyn truy cp GPS"));break;case a.POSITION_UNAVAILABLE:n(new Error("Khng th xc nh v tr"));break;case a.TIMEOUT:n(new Error("Qu thi gian ch GPS"));break;default:n(new Error("Li GPS khng xc nh"))}},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),zV=()=>{const e="tinh_luong_device_id";let n=localStorage.getItem(e);return n||(n=`WEB-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,localStorage.setItem(e,n)),n};function $V(){var b,j,T,_,w,E;const e=br(),n=Mt(),[a,r]=D.useState(null),[s,l]=D.useState("idle"),[o,d]=D.useState(null),{data:u,isLoading:x}=Fe({queryKey:["employee-portal","dashboard"],queryFn:()=>Bc.getDashboard(),refetchInterval:6e4}),{data:m}=Fe({queryKey:["my-geofences"],queryFn:()=>fr.layGeofenceCuaToi()}),f=Ee({mutationFn:async C=>{l("getting");let S={};const P=m==null?void 0:m.some(F=>F.batBuocGPS);if(P||m!=null&&m.length)try{S=await BT(),l("success")}catch(F){if(P)throw l("error"),new Error(F.message||"Khng th ly v tr GPS");l("idle")}return fr.gpsCheckin({loaiChamCong:C,viDo:S.viDo,kinhDo:S.kinhDo,doChinhXacMet:S.doChinhXacMet,deviceId:zV()})},onSuccess:C=>{var S;r(null),l("idle"),d({trongVung:C.trongVung,khoangCachMet:C.khoangCachMet,geofenceName:(S=C.geofence)==null?void 0:S.tenDiaDiem}),n.invalidateQueries({queryKey:["employee-portal","dashboard"]})},onError:C=>{var S,P;l("error"),r(((P=(S=C.response)==null?void 0:S.data)==null?void 0:P.message)||C.message||"Li khi chm cng")}}),p=f.isPending,N=()=>{var C;r(null),d(null),((C=u==null?void 0:u.chamCongHomNay)==null?void 0:C.trangThai)==="DA_VAO"?f.mutate("CHECK_OUT"):f.mutate("CHECK_IN")};if(x)return t.jsx("div",{className:"space-y-4",children:[1,2,3].map(C=>t.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"},C))});const g=(()=>{var S;const C=(S=u==null?void 0:u.chamCongHomNay)==null?void 0:S.trangThai;return C==="DA_RA"?{label:" ra",color:"text-green-600",bg:"bg-green-100 dark:bg-green-900/30"}:C==="DA_VAO"?{label:" vo",color:"text-blue-600",bg:"bg-blue-100 dark:bg-blue-900/30"}:{label:"Cha vo",color:"text-gray-500",bg:"bg-gray-100 dark:bg-gray-700"}})();return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 rounded-2xl p-5 text-white shadow-lg",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-blue-100 text-sm",children:"Xin cho,"}),t.jsx("h2",{className:"text-xl font-bold mt-1",children:u==null?void 0:u.nhanVien.hoTen}),t.jsxs("p",{className:"text-blue-200 text-sm mt-1",children:[u==null?void 0:u.nhanVien.chucVu,"  ",u==null?void 0:u.nhanVien.phongBan]})]}),t.jsx("div",{className:"w-12 h-12 rounded-full bg-white/20 flex items-center justify-center text-xl font-bold",children:((b=u==null?void 0:u.nhanVien.hoTen)==null?void 0:b[0])||"N"})]}),u!=null&&u.caHomNay?t.jsxs("div",{className:"mt-4 bg-white/10 rounded-xl p-3 flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:u.caHomNay.mauHienThi||"#3B82F6"},children:t.jsx(an,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm text-blue-100",children:"Ca hm nay"}),t.jsxs("p",{className:"font-semibold",children:[u.caHomNay.tenCa," (",u.caHomNay.gioVao," - ",u.caHomNay.gioRa,")"]})]})]}):t.jsxs("div",{className:"mt-4 bg-white/10 rounded-xl p-3 flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/20 flex items-center justify-center",children:t.jsx(At,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-blue-100",children:"Hm nay"}),t.jsx("p",{className:"font-semibold",children:"Khng c ca lm vic"})]})]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-5 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:`w-14 h-14 rounded-xl ${g.bg} flex items-center justify-center`,children:((j=u==null?void 0:u.chamCongHomNay)==null?void 0:j.trangThai)==="DA_RA"?t.jsx(Gn,{className:`w-7 h-7 ${g.color}`}):((T=u==null?void 0:u.chamCongHomNay)==null?void 0:T.trangThai)==="DA_VAO"?t.jsx(ag,{className:`w-7 h-7 ${g.color}`}):t.jsx(I_,{className:`w-7 h-7 ${g.color}`})}),t.jsxs("div",{children:[t.jsx("p",{className:`text-sm ${g.color} font-medium`,children:g.label}),((_=u==null?void 0:u.chamCongHomNay)==null?void 0:_.gioVao)&&t.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:["Vo: ",G0(u.chamCongHomNay.gioVao),u.chamCongHomNay.gioRa&&`  Ra: ${G0(u.chamCongHomNay.gioRa)}`]})]})]}),((w=u==null?void 0:u.chamCongHomNay)==null?void 0:w.trangThai)!=="DA_RA"&&t.jsx("button",{onClick:N,disabled:p,className:`px-4 py-2 rounded-xl font-medium transition-colors flex items-center gap-2 ${p?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} text-white`,children:p?t.jsxs(t.Fragment,{children:[t.jsx(An,{className:"w-4 h-4 animate-spin"}),"ang x l..."]}):((E=u==null?void 0:u.chamCongHomNay)==null?void 0:E.trangThai)==="DA_VAO"?"Check-out":"Check-in"})]}),a&&t.jsxs("p",{className:"text-sm text-red-500 mt-3 flex items-center gap-1",children:[t.jsx(sa,{className:"w-4 h-4"}),a]}),o&&t.jsxs("div",{className:`text-sm mt-3 flex items-center gap-2 ${o.trongVung?"text-green-600":"text-yellow-600"}`,children:[t.jsx(Qd,{className:"w-4 h-4"}),o.trongVung?t.jsxs("span",{children:[' Trong vng "',o.geofenceName,'"',o.khoangCachMet&&` (cch ${o.khoangCachMet}m)`]}):o.khoangCachMet?t.jsxs("span",{children:[" Ngoi vng cho php (cch ",o.khoangCachMet,"m)"]}):null]}),s==="getting"&&t.jsxs("p",{className:"text-sm text-blue-500 mt-3 flex items-center gap-2",children:[t.jsx(wc,{className:"w-4 h-4 animate-pulse"}),"ang ly v tr GPS..."]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[t.jsxs("button",{onClick:()=>e("/portal/yeu-cau"),className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700 text-center",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center mx-auto",children:t.jsx(wn,{className:"w-5 h-5 text-orange-600"})}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-2",children:(u==null?void 0:u.thongKe.soDonChoDuyet)||0}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"n ch duyt"})]}),t.jsxs("button",{onClick:()=>e("/portal/ca-nhan"),className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700 text-center",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 dark:bg-green-900/30 flex items-center justify-center mx-auto",children:t.jsx(At,{className:"w-5 h-5 text-green-600"})}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-2",children:(u==null?void 0:u.thongKe.soNgayPhepConLai)||0}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Php cn li"})]}),t.jsxs("button",{onClick:()=>e("/portal/cham-cong"),className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700 text-center",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center mx-auto",children:t.jsx(v0,{className:"w-5 h-5 text-blue-600"})}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-2",children:(u==null?void 0:u.thongKe.soNgayCongThang)||0}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Ngy cng"})]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-5 py-3 border-b border-gray-200 dark:border-gray-700",children:t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Thao tc nhanh"})}),t.jsx("div",{children:[{label:"Xem lch lm vic",icon:At,path:"/portal/lich-lam",color:"text-blue-600"},{label:"To n yu cu",icon:wn,path:"/portal/yeu-cau",color:"text-orange-600"},{label:"Xem phiu lng",icon:v0,path:"/portal/ca-nhan",color:"text-green-600"}].map(C=>t.jsxs("button",{onClick:()=>e(C.path),className:"w-full flex items-center justify-between px-5 py-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(C.icon,{className:`w-5 h-5 ${C.color}`}),t.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:C.label})]}),t.jsx(qn,{className:"w-5 h-5 text-gray-400"})]},C.path))})]})]})}function GV(){const[e,n]=D.useState(0),a=m=>{const f=new Date,p=f.getDay(),N=new Date(f);N.setDate(f.getDate()-(p===0?6:p-1)+m*7),N.setHours(0,0,0,0);const y=new Date(N);return y.setDate(N.getDate()+6),{monday:N,sunday:y}},{monday:r,sunday:s}=a(e),{data:l,isLoading:o}=Fe({queryKey:["employee-portal","lich-lam-viec",r.toISOString()],queryFn:()=>Bc.getLichLamViec({tuNgay:r.toISOString().split("T")[0],denNgay:s.toISOString().split("T")[0]})}),d=()=>{const m=f=>`${f.getDate()}/${f.getMonth()+1}`;return`${m(r)} - ${m(s)}`},u=m=>{const f=new Date().toISOString().split("T")[0];return m===f},x=m=>{const f=new Date;return f.setHours(0,0,0,0),new Date(m)<f};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("button",{onClick:()=>n(e-1),className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(Nr,{className:"w-5 h-5"})}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:d()}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e===0?"Tun ny":e>0?`+${e} tun`:`${e} tun`})]}),t.jsx("button",{onClick:()=>n(e+1),className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(qn,{className:"w-5 h-5"})})]}),e!==0&&t.jsx("button",{onClick:()=>n(0),className:"w-full mt-3 py-2 text-sm text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg font-medium",children:"V tun hin ti"})]}),o?t.jsx("div",{className:"space-y-3",children:[1,2,3,4,5,6,7].map(m=>t.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"},m))}):t.jsx("div",{className:"space-y-3",children:l==null?void 0:l.map(m=>t.jsx("div",{className:`bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border transition-all ${u(m.ngay)?"border-blue-500 ring-2 ring-blue-100 dark:ring-blue-900/50":"border-gray-200 dark:border-gray-700"} ${x(m.ngay)&&!u(m.ngay)?"opacity-60":""}`,children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsxs("div",{className:`w-14 h-14 rounded-xl flex flex-col items-center justify-center ${u(m.ngay)?"bg-blue-600 text-white":m.thuTrongTuan===0||m.thuTrongTuan===6?"bg-gray-100 dark:bg-gray-700 text-gray-500":"bg-gray-50 dark:bg-gray-700/50 text-gray-700 dark:text-gray-300"}`,children:[t.jsx("span",{className:"text-xs font-medium",children:VV(m.thuTrongTuan)}),t.jsx("span",{className:"text-lg font-bold",children:new Date(m.ngay).getDate()})]}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[UV(m.thuTrongTuan),", ",new Date(m.ngay).toLocaleDateString("vi-VN")]}),m.nghiPhep?t.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 rounded-lg bg-green-100 dark:bg-green-900/30 flex items-center justify-center",children:t.jsx(S_,{className:"w-4 h-4 text-green-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-green-600",children:m.nghiPhep.loaiNghi}),t.jsx("p",{className:"text-xs text-gray-500",children:m.nghiPhep.trangThai})]})]}):m.ca?t.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:m.ca.mauHienThi||"#3B82F6"},children:t.jsx(v0,{className:"w-4 h-4 text-white"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:m.ca.tenCa}),t.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[m.ca.gioVao," - ",m.ca.gioRa]})]})]}):t.jsxs("div",{className:"mt-2 flex items-center gap-2 text-gray-400",children:[t.jsx(At,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"Khng c ca lm vic"})]})]})]})},m.ngay))})]})}function qV(){var g,b,j,T,_,w;const e=new Date,[n,a]=D.useState(e.getMonth()+1),[r,s]=D.useState(e.getFullYear()),{data:l,isLoading:o}=Fe({queryKey:["employee-portal","cham-cong",n,r],queryFn:()=>Bc.getChamCong({thang:n,nam:r})}),d=n===e.getMonth()+1&&r===e.getFullYear(),{data:u,isLoading:x}=Fe({queryKey:["employee-portal","san-luong",n,r],queryFn:async()=>{var E;try{const C=await he.get("/san-luong/my-stats",{params:{thang:n,nam:r}});return((E=C.data)==null?void 0:E.data)||C.data}catch{return null}},enabled:d}),m=()=>{n===1?(a(12),s(r-1)):a(n-1)},f=()=>{n===12?(a(1),s(r+1)):a(n+1)},p=E=>{switch(E){case"DU_CONG":return{text:" cng",color:"text-green-600 bg-green-50 dark:bg-green-900/30"};case"DI_TRE":return{text:"i tr",color:"text-yellow-600 bg-yellow-50 dark:bg-yellow-900/30"};case"VE_SOM":return{text:"V sm",color:"text-yellow-600 bg-yellow-50 dark:bg-yellow-900/30"};case"NGHI_KHONG_PHEP":return{text:"Ngh K.Php",color:"text-red-600 bg-red-50 dark:bg-red-900/30"};case"NGHI_CO_PHEP":return{text:"Ngh php",color:"text-blue-600 bg-blue-50 dark:bg-blue-900/30"};default:return{text:E,color:"text-gray-600 bg-gray-50 dark:bg-gray-700"}}},N={duCong:(l==null?void 0:l.filter(E=>E.trangThai==="DU_CONG").length)||0,diTre:(l==null?void 0:l.filter(E=>E.trangThai==="DI_TRE").length)||0,veSom:(l==null?void 0:l.filter(E=>E.trangThai==="VE_SOM").length)||0,nghiKhongPhep:(l==null?void 0:l.filter(E=>E.trangThai==="NGHI_KHONG_PHEP").length)||0},y=E=>{const C=new Date().toISOString().split("T")[0];return E===C};return t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("button",{onClick:m,className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(Nr,{className:"w-5 h-5"})}),t.jsx("div",{className:"text-center",children:t.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:["Thng ",n,"/",r]})}),t.jsx("button",{onClick:f,className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(qn,{className:"w-5 h-5"})})]})}),t.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[t.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 rounded-xl p-3 text-center",children:[t.jsx("p",{className:"text-xl font-bold text-green-600",children:N.duCong}),t.jsx("p",{className:"text-xs text-green-600",children:" cng"})]}),t.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/30 rounded-xl p-3 text-center",children:[t.jsx("p",{className:"text-xl font-bold text-yellow-600",children:N.diTre}),t.jsx("p",{className:"text-xs text-yellow-600",children:"i tr"})]}),t.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/30 rounded-xl p-3 text-center",children:[t.jsx("p",{className:"text-xl font-bold text-orange-600",children:N.veSom}),t.jsx("p",{className:"text-xs text-orange-600",children:"V sm"})]}),t.jsxs("div",{className:"bg-red-50 dark:bg-red-900/30 rounded-xl p-3 text-center",children:[t.jsx("p",{className:"text-xl font-bold text-red-600",children:N.nghiKhongPhep}),t.jsx("p",{className:"text-xs text-red-600",children:"K.Php"})]})]}),d&&t.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-500 rounded-2xl p-4 shadow-md text-white",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(oi,{className:"w-5 h-5"}),t.jsx("h3",{className:"font-semibold",children:"Sn lng thng ny"})]}),x?t.jsx("div",{className:"h-16 bg-white/20 rounded-xl animate-pulse"}):u?t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[(((g=u.chiaHang)==null?void 0:g.tongSanPham)>0||u.chiaHang)&&t.jsxs("div",{className:"bg-white/20 rounded-xl p-3",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx(Z0,{className:"w-4 h-4"}),t.jsx("span",{className:"text-xs opacity-80",children:"Chia hng"})]}),t.jsxs("p",{className:"text-lg font-bold",children:[(((b=u.chiaHang)==null?void 0:b.tongSanPham)||0).toLocaleString("vi-VN"),t.jsx("span",{className:"text-xs font-normal ml-1",children:"SP"})]}),((j=u.chiaHang)==null?void 0:j.sanPhamLoi)>0&&t.jsxs("p",{className:"text-xs opacity-80",children:["Li: ",u.chiaHang.sanPhamLoi.toLocaleString("vi-VN")]})]}),(((T=u.giaoHang)==null?void 0:T.tongKhoiLuong)>0||u.giaoHang)&&t.jsxs("div",{className:"bg-white/20 rounded-xl p-3",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx(ex,{className:"w-4 h-4"}),t.jsx("span",{className:"text-xs opacity-80",children:"Giao hng"})]}),t.jsxs("p",{className:"text-lg font-bold",children:[(((_=u.giaoHang)==null?void 0:_.tongKhoiLuong)||0).toLocaleString("vi-VN"),t.jsx("span",{className:"text-xs font-normal ml-1",children:"kg"})]}),((w=u.giaoHang)==null?void 0:w.soLuotGiao)>0&&t.jsxs("p",{className:"text-xs opacity-80",children:[u.giaoHang.soLuotGiao," lt giao"]})]}),u.diemKPI>0&&t.jsx("div",{className:"bg-white/20 rounded-xl p-3 col-span-2",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm",children:"im KPI"}),t.jsx("span",{className:"text-xl font-bold",children:u.diemKPI.toFixed(1)})]})}),!u.chiaHang&&!u.giaoHang&&!u.diemKPI&&t.jsx("div",{className:"col-span-2 text-center py-2 text-sm opacity-80",children:"Cha c d liu sn lng"})]}):t.jsx("div",{className:"text-center py-2 text-sm opacity-80",children:"Cha c d liu sn lng"})]}),o?t.jsx("div",{className:"space-y-3",children:[1,2,3,4,5].map(E=>t.jsx("div",{className:"h-16 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"},E))}):l&&l.length>0?t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:l.map((E,C)=>{const S=p(E.trangThai);return t.jsxs("div",{className:`flex items-center gap-4 px-4 py-3 ${C<l.length-1?"border-b border-gray-100 dark:border-gray-700":""} ${y(E.ngay)?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[t.jsxs("div",{className:"w-12 text-center",children:[t.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:new Date(E.ngay).getDate()}),t.jsx("p",{className:"text-xs text-gray-500",children:["CN","T2","T3","T4","T5","T6","T7"][new Date(E.ngay).getDay()]})]}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Vo:"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:G0(E.gioVaoThucTe)}),t.jsx("span",{className:"text-gray-400",children:""}),t.jsx("span",{className:"text-gray-500",children:"Ra:"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:G0(E.gioRaThucTe)})]}),E.ca&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Ca: ",E.ca.tenCa]})]}),t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-lg ${S.color}`,children:S.text})]},E.ngay)})}):t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx(an,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Cha c d liu chm cng"})]})]})}const Ll=[{value:"NGHI_PHEP",label:"Ngh php nm",icon:"",nhom:"NGHI_PHEP"},{value:"NGHI_KHONG_LUONG",label:"Ngh khng lng",icon:"",nhom:"NGHI_PHEP"},{value:"NGHI_OM",label:"Ngh m",icon:"",nhom:"NGHI_PHEP"},{value:"NGHI_VIEC_RIENG",label:"Ngh vic ring",icon:"",nhom:"NGHI_PHEP"},{value:"OT",label:"Lm thm gi",icon:"",nhom:"THOI_GIAN"},{value:"TRE_GIO",label:"i tr",icon:"",nhom:"THOI_GIAN"},{value:"VE_SOM",label:"V sm",icon:"",nhom:"THOI_GIAN"},{value:"CONG_TAC",label:"Cng tc",icon:"",nhom:"DI_CHUYEN"},{value:"WFH",label:"Lm vic t xa",icon:"",nhom:"DI_CHUYEN"}];function WV(){var y,g;const[e,n]=D.useState(!1),[a,r]=D.useState("ALL"),s=Mt(),[l,o]=D.useState({loai:"NGHI_PHEP",ngay:new Date().toISOString().split("T")[0],soNgay:1,soGio:1,lyDo:""}),{data:d,isLoading:u}=Fe({queryKey:["employee-portal","yeu-cau",a],queryFn:async()=>{const b={};return a!=="ALL"&&(b.trangThai=a),(await he.get("/yeu-cau/my-requests",{params:b})).data.data||[]}}),x=Ee({mutationFn:async b=>(await he.post("/yeu-cau",b)).data,onSuccess:()=>{s.invalidateQueries({queryKey:["employee-portal","yeu-cau"]}),n(!1),o({loai:"NGHI_PHEP",ngay:new Date().toISOString().split("T")[0],soNgay:1,soGio:1,lyDo:""})}}),m=b=>{switch(b){case"DA_DUYET":return{text:" duyt",color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",icon:Br};case"TU_CHOI":return{text:"T chi",color:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",icon:rn};case"CHO_DUYET":default:return{text:"Ch duyt",color:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",icon:an}}},f=b=>{var j;return((j=Ll.find(T=>T.value===b))==null?void 0:j.label)||b},p=b=>{var j;return((j=Ll.find(T=>T.value===b))==null?void 0:j.icon)||""},N=b=>{if(b.preventDefault(),!l.lyDo.trim()){alert("Vui lng nhp l do");return}x.mutate(l)};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("button",{onClick:()=>n(!0),className:"w-full flex items-center justify-center gap-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 rounded-2xl font-medium shadow-md",children:[t.jsx(Dt,{className:"w-5 h-5"}),"To yu cu mi"]}),t.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:[{value:"ALL",label:"Tt c"},{value:"CHO_DUYET",label:"Ch duyt"},{value:"DA_DUYET",label:" duyt"},{value:"TU_CHOI",label:"T chi"}].map(b=>t.jsx("button",{onClick:()=>r(b.value),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors ${a===b.value?"bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300"}`,children:b.label},b.value))}),u?t.jsx("div",{className:"space-y-3",children:[1,2,3].map(b=>t.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"},b))}):d&&d.length>0?t.jsx("div",{className:"space-y-3",children:d.map(b=>{const j=m(b.trangThai),T=j.icon;return t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"text-2xl",children:p(b.loai)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:f(b.loai)}),t.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${j.color}`,children:[t.jsx(T,{className:"w-3 h-3"}),j.text]})]}),t.jsxs("p",{className:"text-sm text-gray-500 mb-1",children:[new Date(b.ngay).toLocaleDateString("vi-VN"),"  ",b.soGio," gi"]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:b.lyDo})]}),t.jsx(qn,{className:"w-5 h-5 text-gray-400"})]})},b.id)})}):t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx(di,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Cha c yu cu no"})]}),e&&t.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-end justify-center",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 w-full max-w-lg rounded-t-3xl p-6 pb-10 animate-slide-up",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"To yu cu mi"}),t.jsx("button",{onClick:()=>n(!1),className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(rn,{className:"w-5 h-5"})})]}),t.jsxs("form",{onSubmit:N,className:"space-y-4",children:[t.jsxs("div",{className:"max-h-[40vh] overflow-y-auto pr-1",children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:" Ngh php"}),t.jsx("div",{className:"grid grid-cols-2 gap-2 mb-4",children:Ll.filter(b=>b.nhom==="NGHI_PHEP").map(b=>t.jsxs("button",{type:"button",onClick:()=>o({...l,loai:b.value}),className:`flex items-center gap-2 px-3 py-2.5 rounded-xl border-2 transition-colors text-sm ${l.loai===b.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600"}`,children:[t.jsx("span",{className:"text-lg",children:b.icon}),t.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:b.label})]},b.value))}),t.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:" Thi gian"}),t.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:Ll.filter(b=>b.nhom==="THOI_GIAN").map(b=>t.jsxs("button",{type:"button",onClick:()=>o({...l,loai:b.value}),className:`flex items-center gap-1 px-3 py-2.5 rounded-xl border-2 transition-colors text-sm ${l.loai===b.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600"}`,children:[t.jsx("span",{className:"text-lg",children:b.icon}),t.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:b.label})]},b.value))}),t.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:" Di chuyn / Lm vic t xa"}),t.jsx("div",{className:"grid grid-cols-2 gap-2",children:Ll.filter(b=>b.nhom==="DI_CHUYEN").map(b=>t.jsxs("button",{type:"button",onClick:()=>o({...l,loai:b.value}),className:`flex items-center gap-2 px-3 py-2.5 rounded-xl border-2 transition-colors text-sm ${l.loai===b.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600"}`,children:[t.jsx("span",{className:"text-lg",children:b.icon}),t.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:b.label})]},b.value))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Ngy bt u"}),t.jsx("input",{type:"date",value:l.ngay,onChange:b=>o({...l,ngay:b.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),((y=Ll.find(b=>b.value===l.loai))==null?void 0:y.nhom)==="NGHI_PHEP"&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"S ngy ngh"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("input",{type:"number",min:"0.5",max:"30",step:"0.5",value:l.soNgay,onChange:b=>o({...l,soNgay:parseFloat(b.target.value)}),className:"flex-1 px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),t.jsx("span",{className:"text-sm text-gray-500",children:"ngy"})]})]}),((g=Ll.find(b=>b.value===l.loai))==null?void 0:g.nhom)==="THOI_GIAN"&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"S gi"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("input",{type:"number",min:"0.5",max:"12",step:"0.5",value:l.soGio,onChange:b=>o({...l,soGio:parseFloat(b.target.value)}),className:"flex-1 px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),t.jsx("span",{className:"text-sm text-gray-500",children:"gi"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"L do"}),t.jsx("textarea",{value:l.lyDo,onChange:b=>o({...l,lyDo:b.target.value}),rows:3,placeholder:"Nhp l do yu cu...",className:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none"})]}),t.jsx("button",{type:"submit",disabled:x.isPending,className:"w-full py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl font-medium disabled:opacity-50",children:x.isPending?"ang gi...":"Gi yu cu"})]})]})})]})}function XV(){const[e,n]=D.useState("ho-so");return t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-1 shadow-sm border border-gray-200 dark:border-gray-700",children:t.jsx("div",{className:"flex",children:[{id:"ho-so",label:"H s",icon:so},{id:"phieu-luong",label:"Phiu lng",icon:wn},{id:"so-du-phep",label:"S d php",icon:At}].map(a=>t.jsxs("button",{onClick:()=>n(a.id),className:`flex-1 flex items-center justify-center gap-1.5 py-2.5 rounded-xl text-sm font-medium transition-colors ${e===a.id?"bg-blue-500 text-white":"text-gray-600 dark:text-gray-300"}`,children:[t.jsx(a.icon,{className:"w-4 h-4"}),a.label]},a.id))})}),e==="ho-so"&&t.jsx(QV,{}),e==="phieu-luong"&&t.jsx(YV,{}),e==="so-du-phep"&&t.jsx(JV,{})]})}function QV(){var a;const{data:e,isLoading:n}=Fe({queryKey:["employee-portal","ho-so"],queryFn:()=>Bc.getHoSo()});return n?t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"}),t.jsx("div",{className:"h-48 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"})]}):e?t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl p-6 text-white",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-16 h-16 bg-white/20 backdrop-blur rounded-full flex items-center justify-center text-2xl font-bold",children:e.hoTen.charAt(0)}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold",children:e.hoTen}),t.jsx("p",{className:"text-blue-100",children:e.maNhanVien}),e.chucVu&&t.jsx("p",{className:"text-sm text-blue-200 mt-1",children:e.chucVu})]})]})}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx(Ed,{icon:N_,label:"Phng ban",value:typeof e.phongBan=="object"?(a=e.phongBan)==null?void 0:a.tenPhongBan:e.phongBan||"Cha c"}),t.jsx(Ed,{icon:rg,label:"Email",value:e.email||"Cha cp nht"}),t.jsx(Ed,{icon:H_,label:"in thoi",value:e.soDienThoai||"Cha cp nht"}),t.jsx(Ed,{icon:At,label:"Ngy vo lm",value:e.ngayVaoLam?new Date(e.ngayVaoLam).toLocaleDateString("vi-VN"):"Cha c"}),t.jsx(Ed,{icon:E_,label:"STK ngn hng",value:e.soTaiKhoan||"Cha cp nht",last:!0})]}),e.nganHang&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx(G_,{className:"w-5 h-5 text-blue-500"}),t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Thng tin ngn hng"})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("p",{className:"text-gray-500",children:"Ngn hng"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:e.nganHang.tenNganHang})]})]})]}):t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center",children:[t.jsx(so,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Khng tm thy thng tin"})]})}function Ed({icon:e,label:n,value:a,last:r=!1}){return t.jsxs("div",{className:`flex items-center gap-3 px-4 py-3 ${r?"":"border-b border-gray-100 dark:border-gray-700"}`,children:[t.jsx(e,{className:"w-5 h-5 text-gray-400"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-xs text-gray-500",children:n}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a})]})]})}function YV(){const{data:e,isLoading:n}=Fe({queryKey:["employee-portal","phieu-luong"],queryFn:()=>Bc.getPhieuLuong()});if(n)return t.jsx("div",{className:"space-y-3",children:[1,2,3].map(r=>t.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"},r))});const a=(e==null?void 0:e.data)||[];return a.length===0?t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center",children:[t.jsx(wn,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Cha c phiu lng"})]}):t.jsx("div",{className:"space-y-3",children:a.map(r=>t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h4",{className:"font-semibold text-gray-900 dark:text-white",children:["Thng ",r.thang,"/",r.nam]}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:r.kyLuong})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-lg font-bold text-green-600",children:Kf(r.thucLinh)}),t.jsx("p",{className:"text-xs text-gray-500",children:"Thc nhn"})]})]}),t.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100 dark:border-gray-700",children:t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-500",children:"Thu nhp"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:Kf(r.tongThuNhap)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-500",children:"Khu tr"}),t.jsx("p",{className:"font-medium text-red-600",children:Kf(r.tongKhauTru)})]})]})})]},r.id))})}function JV(){var d;const{data:e,isLoading:n}=Fe({queryKey:["employee-portal","so-du-phep"],queryFn:()=>Bc.getSoDuPhep()});if(n)return t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"}),t.jsx("div",{className:"h-24 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"})]});if(!e)return t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center",children:[t.jsx(At,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Khng c d liu"})]});const a=e.phepNam,r=(a==null?void 0:a.conLai)||0,s=(a==null?void 0:a.tongSo)||12,l=(a==null?void 0:a.daSuDung)||0,o=s>0?l/s*100:0;return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl p-6 text-white",children:[t.jsx("p",{className:"text-emerald-100 mb-2",children:"S ngy php cn li"}),t.jsxs("div",{className:"flex items-end gap-2",children:[t.jsx("span",{className:"text-5xl font-bold",children:r}),t.jsxs("span",{className:"text-emerald-200 mb-1",children:["/ ",s," ngy"]})]}),t.jsx("div",{className:"mt-4",children:t.jsx("div",{className:"h-2 bg-white/20 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-white rounded-full transition-all",style:{width:`${100-o}%`}})})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx("p",{className:"text-sm text-gray-500 mb-1",children:" s dng"}),t.jsx("p",{className:"text-2xl font-bold text-blue-600",children:l}),t.jsx("p",{className:"text-xs text-gray-400",children:"ngy"})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Loi ngh khc"}),t.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:((d=e.danhSachLoaiNghi)==null?void 0:d.length)||0}),t.jsx("p",{className:"text-xs text-gray-400",children:"loi"})]})]}),e.danhSachLoaiNghi&&e.danhSachLoaiNghi.length>0&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Chi tit cc loi ngh"}),t.jsx("div",{className:"space-y-2",children:e.danhSachLoaiNghi.map(u=>t.jsxs("div",{className:"flex justify-between items-center text-sm",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:u.tenLoai}),t.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[u.soNgayDaSuDung," ngy"]})]},u.maLoai))})]}),t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-2xl p-4",children:[t.jsx("h4",{className:"font-medium text-blue-800 dark:text-blue-300 mb-2",children:"Lu "}),t.jsxs("ul",{className:"text-sm text-blue-700 dark:text-blue-400 space-y-1",children:[t.jsxs("li",{children:[" S ngy php c tnh theo nm ",new Date().getFullYear()]}),t.jsx("li",{children:" Php khng s dng ht s chuyn sang nm sau (ti a 5 ngy)"}),t.jsx("li",{children:" Lin h HR  c h tr"})]})]})]})}function y2(){var j;const e=br(),n=Mt(),[a,r]=D.useState("tat-ca"),[s,l]=D.useState(1),o=20,{data:d,isLoading:u,refetch:x,isFetching:m}=Fe({queryKey:["thong-bao","list",{page:s,limit:o,filter:a}],queryFn:()=>el.layDanhSach({page:s,limit:o,daDoc:a==="chua-doc"?!1:a==="da-doc"?!0:void 0})}),{data:f}=Fe({queryKey:["thong-bao","chua-doc"],queryFn:()=>el.demChuaDoc()}),p=Ee({mutationFn:T=>el.danhDauDaDoc(T),onSuccess:()=>{n.invalidateQueries({queryKey:["thong-bao"]})}}),N=Ee({mutationFn:()=>el.danhDauTatCaDaDoc(),onSuccess:()=>{n.invalidateQueries({queryKey:["thong-bao"]})}}),y=T=>{T.daDoc||p.mutate(T.id),T.link&&e(T.link)},g=d?Math.ceil(d.total/o):1,b=(f==null?void 0:f.chuaDoc)||0;return t.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[t.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-10",children:t.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h1",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[t.jsx(jc,{className:"w-5 h-5"}),"Thng bo",b>0&&t.jsxs("span",{className:"bg-red-500 text-white text-xs px-2 py-0.5 rounded-full",children:[b," cha c"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>x(),disabled:m,className:"p-2 text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg disabled:opacity-50",title:"Lm mi",children:t.jsx(yr,{className:`w-4 h-4 ${m?"animate-spin":""}`})}),b>0&&t.jsxs("button",{onClick:()=>N.mutate(),disabled:N.isPending,className:"flex items-center gap-1 px-3 py-1.5 text-sm text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg disabled:opacity-50",children:[t.jsx(cj,{className:"w-4 h-4"}),"c tt c"]})]})]}),t.jsx("div",{className:"flex gap-1 bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[{id:"tat-ca",label:"Tt c"},{id:"chua-doc",label:"Cha c"},{id:"da-doc",label:" c"}].map(T=>t.jsxs("button",{onClick:()=>{r(T.id),l(1)},className:`flex-1 px-4 py-2 text-sm font-medium rounded-md transition-colors ${a===T.id?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:[T.label,T.id==="chua-doc"&&b>0&&t.jsxs("span",{className:"ml-1 text-xs text-red-500",children:["(",b,")"]})]},T.id))})]})}),t.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-4",children:[u?t.jsx("div",{className:"space-y-4",children:[...Array(5)].map((T,_)=>t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 animate-pulse",children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gray-200 dark:bg-gray-700 rounded-full"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"}),t.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-full"})]})]})},_))}):(j=d==null?void 0:d.data)!=null&&j.length?t.jsx("div",{className:"space-y-2",children:d.data.map(T=>{const{icon:_,color:w}=RT(T.loaiThongBao);return t.jsx("button",{onClick:()=>y(T),className:`w-full text-left bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm hover:shadow-md transition-all border border-gray-100 dark:border-gray-700 ${T.daDoc?"":"ring-2 ring-blue-500/20"}`,children:t.jsxs("div",{className:"flex gap-4",children:[t.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-xl ${T.daDoc?"bg-gray-100 dark:bg-gray-700":"bg-blue-100 dark:bg-blue-900/30"} ${w}`,children:_}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsx("h3",{className:`font-medium ${T.daDoc?"text-gray-600 dark:text-gray-400":"text-gray-900 dark:text-white"}`,children:T.tieuDe}),t.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[!T.daDoc&&t.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),t.jsx("span",{className:"text-xs text-gray-400",children:MT(T.ngayTao)})]})]}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1 line-clamp-2",children:T.noiDung}),T.link&&t.jsx("p",{className:"text-xs text-blue-500 mt-2",children:"Nhn  xem chi tit "})]})]})},T.id)})}):t.jsxs("div",{className:"text-center py-16",children:[t.jsx(jc,{className:"w-12 h-12 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:a==="chua-doc"?"Khng c thng bo cha c":a==="da-doc"?"Khng c thng bo  c":"Cha c thng bo no"})]}),d&&g>1&&t.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[t.jsx("button",{onClick:()=>l(T=>Math.max(1,T-1)),disabled:s===1,className:"px-4 py-2 text-sm bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg disabled:opacity-50 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Trc"}),t.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Trang ",s," / ",g]}),t.jsx("button",{onClick:()=>l(T=>Math.min(g,T+1)),disabled:s===g,className:"px-4 py-2 text-sm bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg disabled:opacity-50 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Sau"})]})]})]})}function ZV(){const e=Mt(),[n,a]=D.useState(!1),[r,s]=D.useState(null),[l,o]=D.useState(),[d,u]=D.useState(""),[x,m]=D.useState({tenDiaDiem:"",diaChi:"",viDo:0,kinhDo:0,banKinhMet:100,phongBanId:void 0,apDungTatCa:!1,batBuocGPS:!0,chanNgoaiVung:!1}),{data:f,isLoading:p}=Fe({queryKey:["geofences",l],queryFn:()=>fr.layDanhSachGeofence({phongBanId:l})}),{data:N}=Fe({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),y=Ee({mutationFn:fr.taoGeofence,onSuccess:()=>{e.invalidateQueries({queryKey:["geofences"]}),ie.success("To geofence thnh cng"),w()},onError:F=>{var B,O;ie.error(((O=(B=F.response)==null?void 0:B.data)==null?void 0:O.message)||"C li xy ra")}}),g=Ee({mutationFn:({id:F,data:B})=>fr.capNhatGeofence(F,B),onSuccess:()=>{e.invalidateQueries({queryKey:["geofences"]}),ie.success("Cp nht thnh cng"),w()},onError:F=>{var B,O;ie.error(((O=(B=F.response)==null?void 0:B.data)==null?void 0:O.message)||"C li xy ra")}}),b=Ee({mutationFn:fr.xoaGeofence,onSuccess:()=>{e.invalidateQueries({queryKey:["geofences"]}),ie.success("Xa thnh cng")},onError:F=>{var B,O;ie.error(((O=(B=F.response)==null?void 0:B.data)==null?void 0:O.message)||"C li xy ra")}}),j=Ee({mutationFn:({id:F,trangThai:B})=>fr.capNhatGeofence(F,{trangThai:B}),onSuccess:()=>{e.invalidateQueries({queryKey:["geofences"]}),ie.success("Cp nht trng thi thnh cng")}}),T=()=>{s(null),m({tenDiaDiem:"",diaChi:"",viDo:0,kinhDo:0,banKinhMet:100,phongBanId:void 0,apDungTatCa:!1,batBuocGPS:!0,chanNgoaiVung:!1}),a(!0)},_=F=>{s(F),m({tenDiaDiem:F.tenDiaDiem,diaChi:F.diaChi||"",viDo:F.viDo,kinhDo:F.kinhDo,banKinhMet:F.banKinhMet,phongBanId:F.phongBanId,apDungTatCa:F.apDungTatCa,batBuocGPS:F.batBuocGPS,chanNgoaiVung:F.chanNgoaiVung}),a(!0)},w=()=>{a(!1),s(null)},E=F=>{if(F.preventDefault(),!x.tenDiaDiem.trim()){ie.error("Vui lng nhp tn a im");return}if(x.viDo===0&&x.kinhDo===0){ie.error("Vui lng nhp ta  GPS");return}r?g.mutate({id:r.id,data:x}):y.mutate(x)},C=F=>{confirm(`Bn c chc mun xa geofence "${F.tenDiaDiem}"?`)&&b.mutate(F.id)},S=async()=>{try{const F=await BT();m({...x,viDo:F.viDo,kinhDo:F.kinhDo}),ie.success(" ly v tr hin ti")}catch(F){ie.error(F.message)}},P=f==null?void 0:f.filter(F=>{var B;return F.tenDiaDiem.toLowerCase().includes(d.toLowerCase())||((B=F.diaChi)==null?void 0:B.toLowerCase().includes(d.toLowerCase()))});return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-[var(--text-primary)]",children:"Cu hnh Geofence"}),t.jsx("p",{className:"text-[var(--text-muted)]",children:"Qun l vng a l cho php chm cng GPS"})]}),t.jsxs(ft,{onClick:T,children:[t.jsx(Dt,{className:"w-4 h-4 mr-2"}),"Thm a im"]})]}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[t.jsx("div",{className:"flex-1",children:t.jsxs("div",{className:"relative",children:[t.jsx(Vr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Tm kim a im...",value:d,onChange:F=>u(F.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]})}),t.jsx("div",{className:"sm:w-64",children:t.jsxs("select",{value:l||"",onChange:F=>o(F.target.value?Number(F.target.value):void 0),className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),N==null?void 0:N.map(F=>t.jsx("option",{value:F.id,children:F.tenPhongBan},F.id))]})})]})}),t.jsx(st,{children:p?t.jsx("div",{className:"p-8 text-center text-[var(--text-muted)]",children:"ang ti..."}):P!=null&&P.length?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-[var(--bg-secondary)] border-b",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"a im"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Ta "}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Bn knh"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"p dng"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Cu hnh"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y",children:P.map(F=>t.jsxs("tr",{className:"hover:bg-[var(--bg-secondary)]/50",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center",children:t.jsx(Qd,{className:"w-5 h-5 text-primary-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:F.tenDiaDiem}),F.diaChi&&t.jsx("p",{className:"text-sm text-[var(--text-muted)]",children:F.diaChi})]})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:[F.viDo.toFixed(6),", ",F.kinhDo.toFixed(6)]})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsxs("span",{className:"font-medium",children:[F.banKinhMet,"m"]})}),t.jsx("td",{className:"px-4 py-3",children:F.apDungTatCa?t.jsx(_t,{variant:"info",children:"Ton cng ty"}):t.jsxs("span",{className:"text-sm text-[var(--text-muted)]",children:["Phng ban #",F.phongBanId]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[F.batBuocGPS&&t.jsxs(_t,{variant:"warning",className:"text-xs",children:[t.jsx(wc,{className:"w-3 h-3 mr-1"}),"GPS bt buc"]}),F.chanNgoaiVung&&t.jsxs(_t,{variant:"danger",className:"text-xs",children:[t.jsx(sa,{className:"w-3 h-3 mr-1"}),"Chn ngoi vng"]})]})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("button",{onClick:()=>j.mutate({id:F.id,trangThai:!F.trangThai}),className:"inline-flex items-center gap-1",children:F.trangThai?t.jsxs(t.Fragment,{children:[t.jsx(yj,{className:"w-6 h-6 text-green-500"}),t.jsx(_t,{variant:"success",children:"Hot ng"})]}):t.jsxs(t.Fragment,{children:[t.jsx(gj,{className:"w-6 h-6 text-gray-400"}),t.jsx(_t,{variant:"neutral",children:"Tt"})]})})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>_(F),className:"p-2 text-gray-500 hover:text-primary-600 hover:bg-primary-50 rounded-lg",title:"Chnh sa",children:t.jsx(Za,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>C(F),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Xa",children:t.jsx(er,{className:"w-4 h-4"})})]})})]},F.id))})]})}):t.jsxs("div",{className:"p-8 text-center text-[var(--text-muted)]",children:[t.jsx(Qd,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Cha c geofence no c cu hnh"})]})}),t.jsx(as,{isOpen:n,onClose:w,size:"lg",children:t.jsxs("form",{onSubmit:E,children:[t.jsx(Cs,{title:r?"Chnh sa Geofence":"Thm a im mi"}),t.jsx(Ss,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Tn a im ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:x.tenDiaDiem,onChange:F=>m({...x,tenDiaDiem:F.target.value}),placeholder:"VD: Vn phng chnh, Nh my ABC...",className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"a ch"}),t.jsx("input",{type:"text",value:x.diaChi,onChange:F=>m({...x,diaChi:F.target.value}),placeholder:"a ch y ...",className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["V  (Latitude) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"number",step:"any",value:x.viDo,onChange:F=>m({...x,viDo:parseFloat(F.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Kinh  (Longitude) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"number",step:"any",value:x.kinhDo,onChange:F=>m({...x,kinhDo:parseFloat(F.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg",required:!0})]})]}),t.jsx("div",{children:t.jsxs(ft,{type:"button",variant:"outline",onClick:S,className:"w-full",children:[t.jsx(wc,{className:"w-4 h-4 mr-2"}),"Ly v tr hin ti"]})}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Bn knh cho php (mt) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"number",min:"10",max:"5000",value:x.banKinhMet,onChange:F=>m({...x,banKinhMet:parseInt(F.target.value)||100}),className:"w-full px-3 py-2 border rounded-lg",required:!0}),t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1",children:"Khong cch ti a t im check-in n tm geofence"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Phm vi p dng"}),t.jsx("div",{className:"space-y-2",children:t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:x.apDungTatCa,onChange:F=>m({...x,apDungTatCa:F.target.checked,phongBanId:F.target.checked?void 0:x.phongBanId}),className:"rounded"}),t.jsx("span",{children:"p dng cho ton cng ty"})]})}),!x.apDungTatCa&&t.jsxs("select",{value:x.phongBanId||"",onChange:F=>m({...x,phongBanId:F.target.value?Number(F.target.value):void 0}),className:"w-full px-3 py-2 border rounded-lg mt-2",children:[t.jsx("option",{value:"",children:"Chn phng ban..."}),N==null?void 0:N.map(F=>t.jsx("option",{value:F.id,children:F.tenPhongBan},F.id))]})]}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Cu hnh bo mt"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("label",{className:"flex items-center gap-3 p-3 bg-[var(--bg-secondary)] rounded-lg cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:x.batBuocGPS,onChange:F=>m({...x,batBuocGPS:F.target.checked}),className:"rounded"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:"Bt buc bt GPS"}),t.jsx("p",{className:"text-sm text-[var(--text-muted)]",children:"Nhn vin phi bt GPS khi chm cng"})]})]}),t.jsxs("label",{className:"flex items-center gap-3 p-3 bg-[var(--bg-secondary)] rounded-lg cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:x.chanNgoaiVung,onChange:F=>m({...x,chanNgoaiVung:F.target.checked}),className:"rounded"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-red-600",children:"Chn check-in ngoi vng"}),t.jsx("p",{className:"text-sm text-[var(--text-muted)]",children:"Khng cho php chm cng nu ngoi bn knh cho php"})]})]})]})]})]})}),t.jsxs(ni,{children:[t.jsx(ft,{type:"button",variant:"secondary",onClick:w,children:"Hy"}),t.jsx(ft,{type:"submit",disabled:y.isPending||g.isPending,children:y.isPending||g.isPending?"ang lu...":r?t.jsxs(t.Fragment,{children:[t.jsx(Gn,{className:"w-4 h-4 mr-2"}),"Cp nht"]}):t.jsxs(t.Fragment,{children:[t.jsx(Dt,{className:"w-4 h-4 mr-2"}),"To mi"]})})]})]})})]})}function eU(){var C;const[e,n]=D.useState(),[a,r]=D.useState(),[s,l]=D.useState(),[o,d]=D.useState(()=>new Date().toISOString().split("T")[0]),[u,x]=D.useState(()=>new Date().toISOString().split("T")[0]),[m,f]=D.useState(1),p=20,{data:N,isLoading:y}=Fe({queryKey:["gps-logs",e,s,o,u,m],queryFn:()=>fr.layLichSuGPS({nhanVienId:e,tuNgay:o,denNgay:u,trangThai:s,page:m,limit:p})}),{data:g}=Fe({queryKey:["gps-thong-ke",o,u,a],queryFn:()=>fr.thongKeGPS(o,u,a),enabled:!!o&&!!u}),{data:b}=Fe({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),{data:j}=Fe({queryKey:["nhan-vien",a],queryFn:()=>ma.layTatCa({phongBanId:a,trangThai:"DANG_LAM",soLuong:500})}),T=S=>{switch(S){case"HOP_LE":return t.jsx(Gn,{className:"w-4 h-4 text-green-500"});case"NGOAI_VUNG":return t.jsx(mo,{className:"w-4 h-4 text-red-500"});case"CANH_BAO":return t.jsx(sa,{className:"w-4 h-4 text-yellow-500"});case"KHONG_CO_GPS":return t.jsx(wc,{className:"w-4 h-4 text-gray-400"});default:return null}},_=S=>{switch(S){case"HOP_LE":return t.jsx(_t,{variant:"success",children:"Hp l"});case"NGOAI_VUNG":return t.jsx(_t,{variant:"danger",children:"Ngoi vng"});case"CANH_BAO":return t.jsx(_t,{variant:"warning",children:"Cnh bo"});case"KHONG_CO_GPS":return t.jsx(_t,{variant:"neutral",children:"Khng GPS"});default:return t.jsx(_t,{variant:"neutral",children:S})}},w=S=>new Date(S).toLocaleString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),E=Array.isArray(j)?j:(j==null?void 0:j.data)||[];return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-[var(--text-primary)]",children:"Lch s GPS Chm cng"}),t.jsx("p",{className:"text-[var(--text-muted)]",children:"Theo di v kim tra v tr chm cng ca nhn vin"})]}),t.jsxs(ft,{variant:"outline",children:[t.jsx(ws,{className:"w-4 h-4 mr-2"}),"Xut Excel"]})]}),g&&t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[t.jsxs(st,{className:"p-4 text-center",children:[t.jsx("p",{className:"text-2xl font-bold",children:g.thongKe.tongBanGhi}),t.jsx("p",{className:"text-sm text-[var(--text-muted)]",children:"Tng bn ghi"})]}),t.jsxs(st,{className:"p-4 text-center bg-green-50",children:[t.jsx("p",{className:"text-2xl font-bold text-green-600",children:g.thongKe.hopLe}),t.jsxs("p",{className:"text-sm text-green-600",children:["Hp l (",g.thongKe.tyLeHopLe,"%)"]})]}),t.jsxs(st,{className:"p-4 text-center bg-red-50",children:[t.jsx("p",{className:"text-2xl font-bold text-red-600",children:g.thongKe.ngoaiVung}),t.jsx("p",{className:"text-sm text-red-600",children:"Ngoi vng"})]}),t.jsxs(st,{className:"p-4 text-center bg-yellow-50",children:[t.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:g.thongKe.canhBao}),t.jsx("p",{className:"text-sm text-yellow-600",children:"Cnh bo"})]}),t.jsxs(st,{className:"p-4 text-center bg-gray-50",children:[t.jsx("p",{className:"text-2xl font-bold text-gray-600",children:g.thongKe.khongGPS}),t.jsx("p",{className:"text-sm text-gray-600",children:"Khng GPS"})]})]}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"T ngy"}),t.jsx("input",{type:"date",value:o,onChange:S=>{d(S.target.value),f(1)},className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"n ngy"}),t.jsx("input",{type:"date",value:u,onChange:S=>{x(S.target.value),f(1)},className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phng ban"}),t.jsxs("select",{value:a||"",onChange:S=>{r(S.target.value?Number(S.target.value):void 0),n(void 0),f(1)},className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Tt c"}),b==null?void 0:b.map(S=>t.jsx("option",{value:S.id,children:S.tenPhongBan},S.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Nhn vin"}),t.jsxs("select",{value:e||"",onChange:S=>{n(S.target.value?Number(S.target.value):void 0),f(1)},className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Tt c"}),E.map(S=>t.jsxs("option",{value:S.id,children:[S.hoTen," (",S.maNhanVien,")"]},S.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Trng thi"}),t.jsxs("select",{value:s||"",onChange:S=>{l(S.target.value||void 0),f(1)},className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"HOP_LE",children:"Hp l"}),t.jsx("option",{value:"NGOAI_VUNG",children:"Ngoi vng"}),t.jsx("option",{value:"CANH_BAO",children:"Cnh bo"}),t.jsx("option",{value:"KHONG_CO_GPS",children:"Khng GPS"})]})]})]})}),t.jsx(st,{children:y?t.jsx("div",{className:"p-8 text-center text-[var(--text-muted)]",children:"ang ti..."}):(C=N==null?void 0:N.data)!=null&&C.length?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-[var(--bg-secondary)] border-b",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Thi gian"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Loi"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Ta "}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Geofence"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Khong cch"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Trng thi"})]})}),t.jsx("tbody",{className:"divide-y",children:N.data.map(S=>t.jsxs("tr",{className:"hover:bg-[var(--bg-secondary)]/50",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(an,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{className:"text-sm",children:w(S.thoiGian)})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("span",{className:"font-medium",children:["NV #",S.nhanVienId]})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx(_t,{variant:S.loaiChamCong==="CHECK_IN"?"success":"info",children:S.loaiChamCong==="CHECK_IN"?"Vo":"Ra"})}),t.jsxs("td",{className:"px-4 py-3",children:[S.viDo&&S.kinhDo?t.jsxs("a",{href:`https://maps.google.com/?q=${S.viDo},${S.kinhDo}`,target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:underline text-sm",children:[t.jsx(Qd,{className:"w-3 h-3 inline mr-1"}),S.viDo.toFixed(5),", ",S.kinhDo.toFixed(5)]}):t.jsx("span",{className:"text-gray-400 text-sm",children:"Khng c"}),S.doChinhXacMet&&t.jsxs("span",{className:"text-xs text-gray-400 ml-2",children:["(",S.doChinhXacMet,"m)"]})]}),t.jsx("td",{className:"px-4 py-3",children:S.geofence?t.jsx("span",{className:"text-sm",children:S.geofence.tenDiaDiem}):t.jsx("span",{className:"text-gray-400 text-sm",children:""})}),t.jsx("td",{className:"px-4 py-3 text-center",children:S.khoangCachMet!==void 0&&S.khoangCachMet!==null?t.jsxs("span",{className:`font-medium ${S.trongVung?"text-green-600":"text-red-600"}`,children:[S.khoangCachMet,"m"]}):t.jsx("span",{className:"text-gray-400",children:""})}),t.jsxs("td",{className:"px-4 py-3 text-center",children:[t.jsxs("div",{className:"flex items-center justify-center gap-1",children:[T(S.trangThai),_(S.trangThai)]}),S.ghiChu&&t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:S.ghiChu})]})]},S.id))})]})}),t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t",children:[t.jsxs("p",{className:"text-sm text-[var(--text-muted)]",children:["Hin th ",(m-1)*p+1,"-",Math.min(m*p,N.total)," /"," ",N.total," bn ghi"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ft,{variant:"outline",size:"sm",onClick:()=>f(S=>Math.max(1,S-1)),disabled:m===1,children:t.jsx(Nr,{className:"w-4 h-4"})}),t.jsxs("span",{className:"px-3 py-1 bg-[var(--bg-secondary)] rounded",children:[m," / ",N.totalPages||1]}),t.jsx(ft,{variant:"outline",size:"sm",onClick:()=>f(S=>S+1),disabled:m>=(N.totalPages||1),children:t.jsx(qn,{className:"w-4 h-4"})})]})]})]}):t.jsxs("div",{className:"p-8 text-center text-[var(--text-muted)]",children:[t.jsx(wc,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Khng c d liu GPS trong khong thi gian ny"})]})})]})}const zf=e=>e?new Date(e).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-";function tU(){var E,C,S,P,F,B,O,M,G,J;const e=Mt(),[n,a]=D.useState(""),[r,s]=D.useState(""),[l,o]=D.useState(1),[d,u]=D.useState({open:!1}),[x,m]=D.useState(""),[f,p]=D.useState({open:!1}),{data:N,isLoading:y}=Fe({queryKey:["devices",{search:n,trangThai:r,page:l}],queryFn:()=>fr.layDanhSachThietBi({search:n,trangThai:r,page:l,limit:20})}),{data:g}=Fe({queryKey:["device-history",f.nhanVienId],queryFn:()=>f.nhanVienId?fr.layLichSuThietBi({nhanVienId:f.nhanVienId,limit:50}):null,enabled:f.open&&!!f.nhanVienId}),b=Ee({mutationFn:X=>fr.resetDevice(X),onSuccess:()=>{alert(" reset thit b thnh cng"),e.invalidateQueries({queryKey:["devices"]}),u({open:!1}),m("")},onError:X=>{alert(X.message||"C li xy ra")}}),j=Ee({mutationFn:({nhanVienId:X,lyDo:fe})=>fr.blockDevice(X,fe),onSuccess:()=>{alert(" kha thit b"),e.invalidateQueries({queryKey:["devices"]})},onError:X=>{alert(X.message||"C li xy ra")}}),T=()=>{if(!d.device||!x.trim()){alert("Vui lng nhp l do reset");return}b.mutate({nhanVienId:d.device.nhanVienId,lyDo:x})},_=X=>{switch(X){case"ACTIVE":return{label:"Hot ng",variant:"success",icon:dj};case"BLOCKED":return{label:" kha",variant:"danger",icon:ti};case"PENDING_RESET":return{label:"Ch reset",variant:"warning",icon:an};default:return{label:X,variant:"neutral",icon:sa}}},w=X=>{if(!X)return t.jsx(db,{className:"h-4 w-4"});const fe=X.toLowerCase();return fe.includes("ios")||fe.includes("iphone")?t.jsx(d0,{className:"h-4 w-4"}):fe.includes("android")?t.jsx(d0,{className:"h-4 w-4"}):t.jsx(db,{className:"h-4 w-4"})};return t.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold",children:"Qun l thit b"}),t.jsx("p",{className:"text-gray-500",children:"Sprint 8: Device Binding - Mi nhn vin ch c ng nhp t 1 thit b"})]})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Tng thit b"})}),t.jsx(Vt,{children:t.jsx("div",{className:"text-2xl font-bold",children:(N==null?void 0:N.total)||0})})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Hot ng"})}),t.jsx(Vt,{children:t.jsx("div",{className:"text-2xl font-bold text-green-600",children:((E=N==null?void 0:N.data)==null?void 0:E.filter(X=>X.trangThai==="ACTIVE").length)||0})})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Ch reset"})}),t.jsx(Vt,{children:t.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:((C=N==null?void 0:N.data)==null?void 0:C.filter(X=>X.trangThai==="PENDING_RESET").length)||0})})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("span",{className:"text-sm font-medium text-gray-500",children:" kha"})}),t.jsx(Vt,{children:t.jsx("div",{className:"text-2xl font-bold text-red-600",children:((S=N==null?void 0:N.data)==null?void 0:S.filter(X=>X.trangThai==="BLOCKED").length)||0})})]})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Danh sch thit b"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Qun l thit b  ng k ca nhn vin"})]})})}),t.jsxs(Vt,{children:[t.jsxs("div",{className:"flex gap-4 mb-4",children:[t.jsx("div",{className:"flex-1",children:t.jsx(xg,{placeholder:"Tm theo tn, m nhn vin...",value:n,onChange:X=>a(X.target.value)})}),t.jsxs("select",{className:"px-3 py-2 border rounded-lg bg-white",value:r,onChange:X=>s(X.target.value),children:[t.jsx("option",{value:"",children:"Tt c trng thi"}),t.jsx("option",{value:"ACTIVE",children:"Hot ng"}),t.jsx("option",{value:"PENDING_RESET",children:"Ch reset"}),t.jsx("option",{value:"BLOCKED",children:" kha"})]})]}),t.jsxs(Yj,{children:[t.jsx(Jj,{children:t.jsxs(Fd,{children:[t.jsx(Il,{children:"Nhn vin"}),t.jsx(Il,{children:"Thit b"}),t.jsx(Il,{children:"Trng thi"}),t.jsx(Il,{children:"Ngy ng k"}),t.jsx(Il,{children:"ng nhp cui"}),t.jsx(Il,{align:"right",children:"Thao tc"})]})}),t.jsx(Zj,{children:y?t.jsx(Fd,{children:t.jsx(Gs,{colSpan:6,className:"text-center py-8",children:"ang ti..."})}):((P=N==null?void 0:N.data)==null?void 0:P.length)===0?t.jsx(Fd,{children:t.jsx(Gs,{colSpan:6,className:"text-center py-8 text-gray-500",children:"Cha c thit b no c ng k"})}):(F=N==null?void 0:N.data)==null?void 0:F.map(X=>{var H,W,xe;const fe=_(X.trangThai),ne=fe.icon;return t.jsxs(Fd,{children:[t.jsx(Gs,{children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:((H=X.nhanVien)==null?void 0:H.hoTen)||"N/A"}),t.jsx("div",{className:"text-sm text-gray-500",children:(W=X.nhanVien)==null?void 0:W.maNhanVien})]})}),t.jsx(Gs,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[w(X.platform),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:X.tenThietBi||"Khng xc nh"}),t.jsxs("div",{className:"text-xs text-gray-500 truncate max-w-[200px]",children:[(xe=X.deviceId)==null?void 0:xe.substring(0,20),"..."]})]})]})}),t.jsx(Gs,{children:t.jsxs(_t,{variant:fe.variant,children:[t.jsx(ne,{className:"h-3 w-3 mr-1"}),fe.label]})}),t.jsx(Gs,{children:zf(X.ngayDangKy)}),t.jsx(Gs,{children:zf(X.lanDangNhapCuoi)}),t.jsx(Gs,{align:"right",children:t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(ft,{variant:"ghost",size:"sm",title:"Xem lch s",onClick:()=>p({open:!0,nhanVienId:X.nhanVienId}),children:t.jsx(yu,{className:"h-4 w-4"})}),X.trangThai!=="PENDING_RESET"&&t.jsx(ft,{variant:"ghost",size:"sm",title:"Reset thit b",onClick:()=>u({open:!0,device:X}),children:t.jsx(yr,{className:"h-4 w-4"})}),X.trangThai==="ACTIVE"&&t.jsx(ft,{variant:"ghost",size:"sm",title:"Kha thit b",onClick:()=>{confirm("Bn c chc mun kha thit b ny?")&&j.mutate({nhanVienId:X.nhanVienId,lyDo:"Kha th cng bi HR"})},children:t.jsx(ti,{className:"h-4 w-4"})})]})})]},X.id)})})]}),N&&N.totalPages>1&&t.jsxs("div",{className:"flex justify-center gap-2 mt-4",children:[t.jsx(ft,{variant:"outline",size:"sm",disabled:l===1,onClick:()=>o(X=>X-1),children:"Trc"}),t.jsxs("span",{className:"flex items-center px-4 text-sm",children:["Trang ",l," / ",N.totalPages]}),t.jsx(ft,{variant:"outline",size:"sm",disabled:l===N.totalPages,onClick:()=>o(X=>X+1),children:"Sau"})]})]})]}),t.jsxs(as,{isOpen:d.open,onClose:()=>u({open:!1}),children:[t.jsx(Cs,{title:"Reset thit b"}),t.jsx(Ss,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg",children:[t.jsx("div",{className:"font-medium",children:(O=(B=d.device)==null?void 0:B.nhanVien)==null?void 0:O.hoTen}),t.jsxs("div",{className:"text-sm text-gray-500",children:["Thit b hin ti: ",((M=d.device)==null?void 0:M.tenThietBi)||"Khng xc nh"]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"L do reset *"}),t.jsx(ix,{placeholder:"Nhp l do reset thit b...",value:x,onChange:X=>m(X.target.value),rows:3})]}),t.jsx("p",{className:"text-sm text-gray-500",children:"Reset s cho php nhn vin ng nhp t thit b mi"})]})}),t.jsxs(ni,{children:[t.jsx(ft,{variant:"outline",onClick:()=>u({open:!1}),children:"Hy"}),t.jsx(ft,{onClick:T,disabled:b.isPending,children:b.isPending?"ang x l...":"Xc nhn reset"})]})]}),t.jsxs(as,{isOpen:f.open,onClose:()=>p({open:!1}),size:"lg",children:[t.jsx(Cs,{title:"Lch s thit b"}),t.jsx(Ss,{className:"max-h-[60vh] overflow-y-auto",children:t.jsx("div",{className:"space-y-4",children:((G=g==null?void 0:g.data)==null?void 0:G.length)===0?t.jsx("p",{className:"text-center text-gray-500 py-8",children:"Cha c lch s"}):(J=g==null?void 0:g.data)==null?void 0:J.map(X=>t.jsxs("div",{className:"flex items-start gap-4 p-4 border rounded-lg",children:[t.jsxs("div",{className:`p-2 rounded-full ${X.hanhDong==="BIND"?"bg-green-100 text-green-600":X.hanhDong==="RESET"?"bg-yellow-100 text-yellow-600":X.hanhDong==="BLOCK"?"bg-red-100 text-red-600":"bg-gray-100"}`,children:[X.hanhDong==="BIND"&&t.jsx(d0,{className:"h-4 w-4"}),X.hanhDong==="RESET"&&t.jsx(yr,{className:"h-4 w-4"}),X.hanhDong==="BLOCK"&&t.jsx(ti,{className:"h-4 w-4"}),X.hanhDong==="LOGIN_BLOCKED"&&t.jsx(sa,{className:"h-4 w-4"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"font-medium",children:[X.hanhDong==="BIND"&&"ng k thit b mi",X.hanhDong==="RESET"&&"Reset thit b",X.hanhDong==="BLOCK"&&"Kha thit b",X.hanhDong==="LOGIN_BLOCKED"&&"Chn ng nhp t thit b l"]}),X.lyDo&&t.jsxs("div",{className:"text-sm text-gray-500",children:["L do: ",X.lyDo]}),X.nguoiThucHien&&t.jsxs("div",{className:"text-sm text-gray-500",children:["Thc hin bi: ",X.nguoiThucHien.hoTen]}),t.jsx("div",{className:"text-xs text-gray-400 mt-1",children:zf(X.ngayTao)})]})]},X.id))})})]})]})}const nU=async e=>(await he.get("/timesheet",{params:e})).data,aU=async e=>(await he.get("/timesheet/yeu-cau-sua-cong",{params:e})).data,rU=async e=>(await he.post("/timesheet/yeu-cau-sua-cong",e)).data,sU=async(e,n)=>(await he.post(`/timesheet/yeu-cau-sua-cong/${e}/duyet`,n)).data,iU=async e=>(await he.put("/timesheet/sua-cong-truc-tiep",e)).data,tl=e=>e?new Date(e).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}):"-",$f=e=>({DI_LAM:{label:"i lm",color:"success"},NGHI_PHEP:{label:"Ngh php",color:"info"},NGHI_KHONG_LUONG:{label:"Ngh KL",color:"warning"},NGHI_BENH:{label:"Ngh bnh",color:"warning"},NGHI_LE:{label:"Ngh l",color:"info"},CHUA_XAC_DINH:{label:"-",color:"neutral"},VANG_MAT:{label:"Vng",color:"danger"}})[e]||{label:e,color:"neutral"},v2=(e,n)=>e==="NGAY_LE"?"bg-red-100":n===0?"bg-red-50":n===6?"bg-yellow-50":"",lU=(e,n)=>new Date(n,e,0).getDate(),oU=e=>["CN","T2","T3","T4","T5","T6","T7"][e];function cU(){var fe,ne;const e=Mt(),n=new Date,[a,r]=D.useState(n.getMonth()+1),[s,l]=D.useState(n.getFullYear()),[o,d]=D.useState(""),[u]=D.useState(),[x,m]=D.useState(null),[f,p]=D.useState(null),[N,y]=D.useState("view"),[g,b]=D.useState({gioVaoMoi:"",gioRaMoi:"",trangThaiMoi:"",lyDo:""}),[j,T]=D.useState(!1),{data:_,isLoading:w}=Fe({queryKey:["bang-cong",{thang:a,nam:s,search:o,phongBanId:u}],queryFn:()=>nU({thang:a,nam:s,search:o,phongBanId:u})}),{data:E}=Fe({queryKey:["yeu-cau-sua-cong",{thang:a,nam:s,trangThaiDuyet:"CHO_DUYET"}],queryFn:()=>{const H=new Date(s,a-1,1).toISOString().slice(0,10),W=new Date(s,a,0).toISOString().slice(0,10);return aU({trangThaiDuyet:"CHO_DUYET",tuNgay:H,denNgay:W})}}),C=Ee({mutationFn:rU,onSuccess:()=>{alert(" to yu cu sa cng"),e.invalidateQueries({queryKey:["bang-cong"]}),e.invalidateQueries({queryKey:["yeu-cau-sua-cong"]}),G()},onError:H=>{alert(H.message||"C li xy ra")}}),S=Ee({mutationFn:iU,onSuccess:()=>{alert(" cp nht chm cng"),e.invalidateQueries({queryKey:["bang-cong"]}),G()},onError:H=>{alert(H.message||"C li xy ra")}}),P=Ee({mutationFn:({id:H,payload:W})=>sU(H,W),onSuccess:()=>{alert(" x l yu cu"),e.invalidateQueries({queryKey:["bang-cong"]}),e.invalidateQueries({queryKey:["yeu-cau-sua-cong"]})},onError:H=>{alert(H.message||"C li xy ra")}}),F=D.useMemo(()=>lU(a,s),[a,s]),B=()=>{a===1?(r(12),l(s-1)):r(a-1)},O=()=>{a===12?(r(1),l(s+1)):r(a+1)},M=(H,W,xe)=>{m(H),p(W),y(xe),b({gioVaoMoi:W.gioVao?new Date(W.gioVao).toTimeString().slice(0,5):"",gioRaMoi:W.gioRa?new Date(W.gioRa).toTimeString().slice(0,5):"",trangThaiMoi:W.trangThai,lyDo:""})},G=()=>{m(null),p(null),y("view"),b({gioVaoMoi:"",gioRaMoi:"",trangThaiMoi:"",lyDo:""})},J=()=>{if(!(!x||!f))if(N==="request"){if(!g.lyDo.trim()){alert("Vui lng nhp l do");return}C.mutate({nhanVienId:x.nhanVienId,ngayChamCong:f.ngay,gioVaoMoi:g.gioVaoMoi?`${f.ngay}T${g.gioVaoMoi}:00`:void 0,gioRaMoi:g.gioRaMoi?`${f.ngay}T${g.gioRaMoi}:00`:void 0,trangThaiMoi:g.trangThaiMoi!==f.trangThai?g.trangThaiMoi:void 0,lyDo:g.lyDo})}else S.mutate({nhanVienId:x.nhanVienId,ngayChamCong:f.ngay,gioVao:g.gioVaoMoi?`${f.ngay}T${g.gioVaoMoi}:00`:void 0,gioRa:g.gioRaMoi?`${f.ngay}T${g.gioRaMoi}:00`:void 0,trangThai:g.trangThaiMoi,ghiChu:g.lyDo})},X=_==null?void 0:_.thongKe;return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[t.jsx(At,{className:"h-6 w-6"}),"Bng Cng Thng ",a,"/",s]}),t.jsx("p",{className:"text-gray-500",children:"Theo di chm cng v sa cng nhn vin"})]}),t.jsx("div",{className:"flex gap-2",children:t.jsxs(ft,{variant:"outline",onClick:()=>T(!0),children:[t.jsx(wn,{className:"h-4 w-4 mr-2"}),"Duyt sa cng (",((fe=E==null?void 0:E.data)==null?void 0:fe.length)||0,")"]})})]}),X&&t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[t.jsx(st,{children:t.jsx(Vt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(cn,{className:"h-5 w-5 text-blue-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Nhn vin"}),t.jsx("p",{className:"text-xl font-bold",children:X.tongNhanVien})]})]})})}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Br,{className:"h-5 w-5 text-green-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Ngy cng"}),t.jsx("p",{className:"text-xl font-bold",children:X.tongNgayCong})]})]})})}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(X_,{className:"h-5 w-5 text-purple-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Gi OT"}),t.jsx("p",{className:"text-xl font-bold",children:X.tongGioOT.toFixed(1)})]})]})})}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(sa,{className:"h-5 w-5 text-orange-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"i tr"}),t.jsx("p",{className:"text-xl font-bold",children:X.tongLanDiTre})]})]})})}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(rn,{className:"h-5 w-5 text-red-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Ngh"}),t.jsx("p",{className:"text-xl font-bold",children:X.tongNgayNghi})]})]})})}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(an,{className:"h-5 w-5 text-cyan-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Ch duyt"}),t.jsx("p",{className:"text-xl font-bold",children:X.yeuCauSuaCong.choDuyet})]})]})})})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ft,{variant:"outline",size:"sm",onClick:B,children:t.jsx(Nr,{className:"h-4 w-4"})}),t.jsxs("span",{className:"font-medium text-lg min-w-[120px] text-center",children:["Thng ",a,"/",s]}),t.jsx(ft,{variant:"outline",size:"sm",onClick:O,children:t.jsx(qn,{className:"h-4 w-4"})})]}),t.jsx(xg,{placeholder:"Tm nhn vin...",value:o,onChange:H=>d(H.target.value),className:"w-64"})]})}),t.jsxs(Vt,{children:[w?t.jsx("div",{className:"text-center py-8",children:"ang ti..."}):(ne=_==null?void 0:_.data)!=null&&ne.length?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full border-collapse text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-50",children:[t.jsx("th",{className:"border px-3 py-2 text-left sticky left-0 bg-gray-50 z-10 min-w-[150px]",children:"Nhn vin"}),Array.from({length:F},(H,W)=>{const K=new Date(s,a-1,W+1).getDay();return t.jsxs("th",{className:`border px-1 py-1 text-center min-w-[50px] ${v2("",K)}`,children:[t.jsx("div",{className:"text-xs",children:oU(K)}),t.jsx("div",{children:W+1})]},W)}),t.jsx("th",{className:"border px-2 py-2 text-center min-w-[60px] bg-gray-100",children:"Cng"}),t.jsx("th",{className:"border px-2 py-2 text-center min-w-[60px] bg-gray-100",children:"OT"})]})}),t.jsx("tbody",{children:_.data.map(H=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsxs("td",{className:"border px-3 py-2 sticky left-0 bg-white z-10",children:[t.jsx("div",{className:"font-medium",children:H.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:H.maNhanVien})]}),H.chiTiet.map(W=>{const{label:xe,color:K}=$f(W.trangThai);return t.jsxs("td",{className:`border px-1 py-1 text-center cursor-pointer hover:bg-blue-50 ${v2(W.loaiNgay,W.thuTrongTuan)}`,onClick:()=>M(H,W,"view"),children:[t.jsx("div",{className:"text-xs",children:W.trangThai==="DI_LAM"?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-green-600",children:tl(W.gioVao)}),t.jsx("div",{className:"text-blue-600",children:tl(W.gioRa)})]}):t.jsx(_t,{variant:K,className:"text-[10px] px-1",children:xe})}),W.coYeuCauSuaCong&&t.jsx(lf,{className:"h-3 w-3 text-orange-500 mx-auto"})]},W.ngay)}),t.jsx("td",{className:"border px-2 py-2 text-center font-medium bg-gray-50",children:H.tongKet.soNgayDiLam}),t.jsx("td",{className:"border px-2 py-2 text-center font-medium bg-gray-50",children:H.tongKet.soGioOT.toFixed(1)})]},H.nhanVienId))})]})}):t.jsx("div",{className:"text-center py-8 text-gray-500",children:"Khng c d liu"}),t.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-sm",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"w-3 h-3 bg-red-50 border"})," Ch nht"]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"w-3 h-3 bg-yellow-50 border"})," Th 7"]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"w-3 h-3 bg-red-100 border"})," Ngy l"]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(lf,{className:"h-3 w-3 text-orange-500"})," C yu cu sa"]})]})]})]}),t.jsxs(as,{isOpen:!!f,onClose:G,children:[t.jsx(Cs,{title:N==="view"?"Chi tit chm cng":N==="edit"?"Sa cng trc tip":"Yu cu sa cng"}),t.jsx(Ss,{children:f&&x&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Nhn vin:"}),t.jsx("span",{className:"ml-2 font-medium",children:x.hoTen})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Ngy:"}),t.jsx("span",{className:"ml-2 font-medium",children:f.ngay})]})]}),N==="view"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm border rounded p-3",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Gi vo:"}),t.jsx("span",{className:"ml-2",children:tl(f.gioVao)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Gi ra:"}),t.jsx("span",{className:"ml-2",children:tl(f.gioRa)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Trng thi:"}),t.jsx(_t,{variant:$f(f.trangThai).color,className:"ml-2",children:$f(f.trangThai).label})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Gi lm:"}),t.jsxs("span",{className:"ml-2",children:[f.soGioLam.toFixed(1),"h"]})]}),f.phutDiTre&&f.phutDiTre>0&&t.jsxs("div",{className:"text-orange-600",children:["i tr: ",f.phutDiTre," pht"]}),f.phutVeSom&&f.phutVeSom>0&&t.jsxs("div",{className:"text-orange-600",children:["V sm: ",f.phutVeSom," pht"]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(ft,{variant:"outline",onClick:()=>y("edit"),children:[t.jsx(lf,{className:"h-4 w-4 mr-2"}),"Sa trc tip"]}),t.jsxs(ft,{variant:"outline",onClick:()=>y("request"),children:[t.jsx(wn,{className:"h-4 w-4 mr-2"}),"To yu cu sa"]})]})]}):t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gi vo mi"}),t.jsx("input",{type:"time",className:"w-full border rounded px-3 py-2",value:g.gioVaoMoi,onChange:H=>b({...g,gioVaoMoi:H.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gi ra mi"}),t.jsx("input",{type:"time",className:"w-full border rounded px-3 py-2",value:g.gioRaMoi,onChange:H=>b({...g,gioRaMoi:H.target.value})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Trng thi"}),t.jsxs("select",{className:"w-full border rounded px-3 py-2",value:g.trangThaiMoi,onChange:H=>b({...g,trangThaiMoi:H.target.value}),children:[t.jsx("option",{value:"DI_LAM",children:"i lm"}),t.jsx("option",{value:"NGHI_PHEP",children:"Ngh php"}),t.jsx("option",{value:"NGHI_KHONG_LUONG",children:"Ngh khng lng"}),t.jsx("option",{value:"NGHI_BENH",children:"Ngh bnh"}),t.jsx("option",{value:"VANG_MAT",children:"Vng mt"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:N==="request"?"L do sa (bt buc)":"Ghi ch"}),t.jsx(ix,{placeholder:N==="request"?"Nhp l do yu cu sa cng...":"Ghi ch...",value:g.lyDo,onChange:H=>b({...g,lyDo:H.target.value}),rows:3})]})]})]})}),t.jsxs(ni,{children:[t.jsx(ft,{variant:"outline",onClick:G,children:"ng"}),N!=="view"&&t.jsx(ft,{onClick:J,disabled:C.isPending||S.isPending,children:C.isPending||S.isPending?"ang x l...":"Lu"})]})]}),t.jsx(dU,{open:j,onClose:()=>T(!1),yeuCauList:(E==null?void 0:E.data)||[],onDuyet:(H,W,xe)=>{P.mutate({id:H,payload:{trangThaiDuyet:W?"DA_DUYET":"TU_CHOI",lyDoTuChoi:xe}})},isLoading:P.isPending})]})}function dU({open:e,onClose:n,yeuCauList:a,onDuyet:r,isLoading:s}){const[l,o]=D.useState({});return t.jsxs(as,{isOpen:e,onClose:n,size:"xl",children:[t.jsx(Cs,{title:"Duyt yu cu sa cng"}),t.jsx(Ss,{children:a.length===0?t.jsx("div",{className:"text-center py-8 text-gray-500",children:"Khng c yu cu no ang ch duyt"}):t.jsx("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto",children:a.map(d=>{var u,x,m;return t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"font-medium",children:[(u=d.nhanVien)==null?void 0:u.hoTen," - ",(x=d.nhanVien)==null?void 0:x.maNhanVien]}),t.jsxs("div",{className:"text-sm text-gray-500",children:["Ngy: ",new Date(d.ngayChamCong).toLocaleDateString("vi-VN")]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Thay i:"}),d.gioVaoMoi&&t.jsxs("span",{className:"ml-2",children:["Gi vo: ",tl(d.gioVaoCu),"  ",tl(d.gioVaoMoi)]}),d.gioRaMoi&&t.jsxs("span",{className:"ml-2",children:["Gi ra: ",tl(d.gioRaCu),"  ",tl(d.gioRaMoi)]}),d.trangThaiMoi&&t.jsxs("span",{className:"ml-2",children:["Trng thi: ",d.trangThaiCu,"  ",d.trangThaiMoi]})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"L do:"}),t.jsx("span",{className:"ml-2",children:d.lyDo})]}),t.jsxs("div",{className:"text-xs text-gray-400",children:["Ngi to: ",(m=d.nguoiTao)==null?void 0:m.hoTen," - ",new Date(d.ngayTao).toLocaleString("vi-VN")]}),t.jsx(ix,{placeholder:"L do t chi (nu t chi)",value:l[d.id]||"",onChange:f=>o({...l,[d.id]:f.target.value}),rows:2,className:"mt-2"})]}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsxs(ft,{variant:"primary",size:"sm",onClick:()=>r(d.id,!0),disabled:s,children:[t.jsx(Br,{className:"h-4 w-4 mr-1"}),"Duyt"]}),t.jsxs(ft,{variant:"danger",size:"sm",onClick:()=>r(d.id,!1,l[d.id]),disabled:s,children:[t.jsx(rn,{className:"h-4 w-4 mr-1"}),"T chi"]})]})]})},d.id)})})}),t.jsx(ni,{children:t.jsx(ft,{variant:"outline",onClick:n,children:"ng"})})]})}const uU="tinh_luong_auth",rc=Zt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});rc.interceptors.request.use(e=>{const n=localStorage.getItem(uU);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e});const Gf={sync:e=>rc.post("/payroll-sync/sync",e).then(n=>n.data),getProgress:e=>rc.get(`/payroll-sync/progress/${e}`).then(n=>n.data),getStatus:(e,n)=>rc.get("/payroll-sync/status",{params:{thang:e,nam:n}}).then(a=>a.data),getRuleTrace:e=>rc.get("/payroll-sync/rule-trace",{params:e}).then(n=>n.data),getRuleTraceByEmployee:(e,n,a)=>rc.get(`/payroll-sync/rule-trace/nhan-vien/${e}`,{params:{thang:n,nam:a}}).then(r=>r.data)},hU={CHAM_CONG:{label:"Chm cng",color:"bg-blue-100 text-blue-700",icon:an},YEU_CAU:{label:"n yu cu",color:"bg-purple-100 text-purple-700",icon:wn},NGHI_PHEP:{label:"Ngh php",color:"bg-green-100 text-green-700",icon:At},PHAN_CA:{label:"Phn ca",color:"bg-yellow-100 text-yellow-700",icon:cn},GPS:{label:"GPS",color:"bg-orange-100 text-orange-700",icon:Od},KPI:{label:"KPI",color:"bg-pink-100 text-pink-700",icon:lj},MANUAL:{label:"Th cng",color:"bg-gray-100 text-gray-700",icon:wn},RULE_ENGINE:{label:"Rule Engine",color:"bg-indigo-100 text-indigo-700",icon:Od}};function xU(){var _,w;const e=Mt(),[n,a]=D.useState(new Date().getMonth()+1),[r,s]=D.useState(new Date().getFullYear()),[l,o]=D.useState(),[d,u]=D.useState(new Set),[x,m]=D.useState(null),{data:f}=Fe({queryKey:["phong-ban"],queryFn:Jt.layTatCa}),{data:p,isLoading:N}=Fe({queryKey:["pipeline-status",n,r],queryFn:()=>Gf.getStatus(n,r)}),{data:y,isLoading:g}=Fe({queryKey:["rule-trace",n,r,l],queryFn:()=>Gf.getRuleTrace({thang:n,nam:r,phongBanId:l})}),b=Ee({mutationFn:E=>Gf.sync({bangLuongId:E}),onMutate:E=>{m(E)},onSuccess:E=>{var C;e.invalidateQueries({queryKey:["pipeline-status"]}),e.invalidateQueries({queryKey:["rule-trace"]}),e.invalidateQueries({queryKey:["bang-luong"]}),E.currentStep==="HOAN_THANH"?ie.success(`ng b hon thnh: ${((C=E.summary)==null?void 0:C.tongThayDoi)||0} thay i`):E.currentStep==="LOI"&&ie.error(`ng b tht bi: ${E.errors[0]||"C li xy ra"}`)},onError:E=>{ie.error(`Li ng b: ${E.message}`)},onSettled:()=>{m(null)}}),j=E=>{const C=new Set(d);C.has(E)?C.delete(E):C.add(E),u(C)},T=E=>{const S={CHUA_TAO:{color:"gray",label:"Cha to"},NHAP:{color:"yellow",label:"Nhp"},DA_TINH:{color:"blue",label:" tnh"},DA_KHOA:{color:"purple",label:" kha"},DA_DUYET:{color:"green",label:" duyt"}}[E]||{color:"gray",label:E};return t.jsx(_t,{variant:S.color,children:S.label})};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Pipeline ng B Lng"}),t.jsx("p",{className:"text-gray-500",children:"ng b d liu chm cng, ngh php, yu cu vo bng lng"})]})}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thng"}),t.jsx("select",{value:n,onChange:E=>a(Number(E.target.value)),className:"input",children:[...Array(12)].map((E,C)=>t.jsxs("option",{value:C+1,children:["Thng ",C+1]},C+1))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nm"}),t.jsx("select",{value:r,onChange:E=>s(Number(E.target.value)),className:"input",children:[2024,2025,2026].map(E=>t.jsx("option",{value:E,children:E},E))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:l||"",onChange:E=>o(E.target.value?Number(E.target.value):void 0),className:"input",children:[t.jsx("option",{value:"",children:"Tt c"}),f==null?void 0:f.map(E=>t.jsx("option",{value:E.id,children:E.tenPhongBan},E.id))]})]})]})}),t.jsxs(st,{children:[t.jsx("div",{className:"p-4 border-b border-gray-200",children:t.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(Od,{className:"w-5 h-5"}),"Trng thi Pipeline"]})}),N?t.jsx("div",{className:"p-8 text-center",children:t.jsx(An,{className:"w-8 h-8 animate-spin mx-auto text-blue-500"})}):t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[t.jsx("div",{className:"text-sm text-blue-600",children:"Tng nhn vin"}),t.jsx("div",{className:"text-2xl font-bold text-blue-700",children:(p==null?void 0:p.tongNhanVien)||0})]}),t.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[t.jsx("div",{className:"text-sm text-green-600",children:" sync hon thnh"}),t.jsx("div",{className:"text-2xl font-bold text-green-700",children:(p==null?void 0:p.tongDaSyncHoanThanh)||0})]}),t.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[t.jsx("div",{className:"text-sm text-yellow-600",children:"Cnh bo"}),t.jsx("div",{className:"text-2xl font-bold text-yellow-700",children:((_=p==null?void 0:p.warnings)==null?void 0:_.length)||0})]})]}),(p==null?void 0:p.warnings)&&p.warnings.length>0&&t.jsxs("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[t.jsxs("h3",{className:"font-medium text-yellow-800 flex items-center gap-2 mb-2",children:[t.jsx(di,{className:"w-4 h-4"}),"Cnh bo"]}),t.jsxs("ul",{className:"space-y-1",children:[p.warnings.slice(0,5).map((E,C)=>t.jsxs("li",{className:"text-sm text-yellow-700",children:[" ",E.moTa]},C)),p.warnings.length>5&&t.jsxs("li",{className:"text-sm text-yellow-600 italic",children:["... v ",p.warnings.length-5," cnh bo khc"]})]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Tng lng"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:(w=p==null?void 0:p.phongBans)==null?void 0:w.map(E=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 font-medium",children:E.tenPhongBan}),t.jsx("td",{className:"px-4 py-3 text-center",children:T(E.trangThai)}),t.jsx("td",{className:"px-4 py-3 text-right",children:E.tongNhanVien}),t.jsx("td",{className:"px-4 py-3 text-right",children:Ze(E.tongLuong)}),t.jsx("td",{className:"px-4 py-3 text-center",children:E.bangLuongId&&E.trangThai!=="DA_KHOA"&&E.trangThai!=="DA_DUYET"?t.jsxs(ft,{size:"sm",variant:"primary",onClick:()=>b.mutate(E.bangLuongId),disabled:x===E.bangLuongId,children:[x===E.bangLuongId?t.jsx(An,{className:"w-4 h-4 animate-spin"}):t.jsx(yr,{className:"w-4 h-4"}),t.jsx("span",{className:"ml-1",children:"Sync"})]}):E.trangThai==="CHUA_TAO"?t.jsx("span",{className:"text-sm text-gray-400",children:"Cha to BL"}):t.jsx("span",{className:"text-sm text-gray-400",children:" kha"})})]},E.phongBanId))})]})})]})]}),t.jsxs(st,{children:[t.jsxs("div",{className:"p-4 border-b border-gray-200",children:[t.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(Ba,{className:"w-5 h-5"}),"Rule Trace - Ngun D Liu"]}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Xem chi tit d liu c s dng  tnh lng t cc ngun khc nhau"})]}),g?t.jsx("div",{className:"p-8 text-center",children:t.jsx(An,{className:"w-8 h-8 animate-spin mx-auto text-blue-500"})}):y&&y.length>0?t.jsx("div",{className:"divide-y divide-gray-200",children:y.map(E=>{var C;return t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>j(E.ruleId*1e3+E.nhanVienId),children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center",children:t.jsx(Od,{className:"w-5 h-5 text-indigo-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:E.ruleName}),t.jsx("div",{className:"text-sm text-gray-500",children:E.hoTen})]})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-lg font-semibold text-green-600",children:Ze(E.ketQua)}),t.jsx("div",{className:"text-xs text-gray-400",children:new Date(E.ngayChay).toLocaleDateString("vi-VN")})]}),d.has(E.ruleId*1e3+E.nhanVienId)?t.jsx(Ol,{className:"w-5 h-5 text-gray-400"}):t.jsx(Ja,{className:"w-5 h-5 text-gray-400"})]})]}),d.has(E.ruleId*1e3+E.nhanVienId)&&t.jsxs("div",{className:"mt-4 pl-14 space-y-3",children:[t.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[t.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Chi tit tnh ton:"}),t.jsx("div",{className:"text-sm font-mono bg-white p-2 rounded border",children:E.chiTiet})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Ngun d liu:"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:(C=E.nguonDuLieu)==null?void 0:C.map((S,P)=>{const F=hU[S.type],B=F.icon;return t.jsxs("div",{className:`flex items-center gap-2 p-2 rounded-lg ${F.color}`,children:[t.jsx(B,{className:"w-4 h-4"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-sm font-medium",children:F.label}),t.jsxs("div",{className:"text-xs opacity-75",children:[S.sourceId," = ",String(S.value)]})]})]},P)})})]})]})]},`${E.ruleId}-${E.nhanVienId}`)})}):t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx(Od,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),t.jsxs("p",{children:["Cha c d liu rule trace cho thng ",n,"/",r]})]})]})]})}const Pl={getDiTreVeSom:e=>he.get("/reports/di-tre-ve-som",{params:e}),getOT:e=>he.get("/reports/ot",{params:e}),getNghiPhep:e=>he.get("/reports/nghi-phep",{params:e}),getQuyLuong:e=>he.get("/reports/quy-luong",{params:e}),getHeadcount:e=>he.get("/reports/headcount",{params:e}),getChamCong:e=>he.get("/reports/cham-cong",{params:e}),getDashboard:(e,n)=>he.get("/reports/dashboard",{params:{thang:e,nam:n}})},HT=new Date,mU=HT.getMonth()+1,fU=HT.getFullYear(),vs=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),pU=e=>new Date(e).toLocaleDateString("vi-VN");function gU(){var y,g,b,j,T,_,w;const[e,n]=D.useState("dashboard"),[a,r]=D.useState({thang:mU,nam:fU}),s=Fe({queryKey:["reports","dashboard",a.thang,a.nam],queryFn:()=>Pl.getDashboard(a.thang,a.nam),enabled:e==="dashboard"}),l=Fe({queryKey:["reports","di-tre",a],queryFn:()=>Pl.getDiTreVeSom(a),enabled:e==="di-tre"}),o=Fe({queryKey:["reports","ot",a],queryFn:()=>Pl.getOT(a),enabled:e==="ot"}),d=Fe({queryKey:["reports","nghi-phep",a],queryFn:()=>Pl.getNghiPhep(a),enabled:e==="nghi-phep"}),u=Fe({queryKey:["reports","quy-luong",a],queryFn:()=>Pl.getQuyLuong(a),enabled:e==="quy-luong"}),x=Fe({queryKey:["reports","headcount",a],queryFn:()=>Pl.getHeadcount(a),enabled:e==="headcount"}),m=Fe({queryKey:["reports","cham-cong",a],queryFn:()=>Pl.getChamCong(a),enabled:e==="cham-cong"}),f=s.isLoading||l.isLoading||o.isLoading||d.isLoading||u.isLoading||x.isLoading||m.isLoading,p=()=>{switch(e){case"dashboard":s.refetch();break;case"di-tre":l.refetch();break;case"ot":o.refetch();break;case"nghi-phep":d.refetch();break;case"quy-luong":u.refetch();break;case"headcount":x.refetch();break;case"cham-cong":m.refetch();break}},N=[{key:"dashboard",label:"Dashboard"},{key:"di-tre",label:"i tr/V sm"},{key:"ot",label:"Tng ca (OT)"},{key:"nghi-phep",label:"Ngh php"},{key:"quy-luong",label:"Qu lng"},{key:"headcount",label:"Nhn s"},{key:"cham-cong",label:"Chm cng"}];return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Bo co & Thng k"}),t.jsx("p",{className:"text-slate-500",children:"Xem tng hp v chi tit cc bo co nhn s"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(ft,{variant:"outline",onClick:p,disabled:f,children:[t.jsx(yr,{className:`h-4 w-4 mr-2 ${f?"animate-spin":""}`}),"Lm mi"]}),t.jsxs(ft,{variant:"primary",children:[t.jsx(hj,{className:"h-4 w-4 mr-2"}),"Xut Excel"]})]})]}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-6",children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Thng"}),t.jsxs("div",{className:"relative",children:[t.jsx("select",{value:a.thang,onChange:E=>r({...a,thang:Number(E.target.value)}),className:"w-32 px-3 py-2 border border-slate-200 rounded-lg appearance-none focus:ring-2 focus:ring-blue-500 bg-white",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(E=>t.jsxs("option",{value:E,children:["Thng ",E]},E))}),t.jsx(Ja,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400 pointer-events-none"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Nm"}),t.jsxs("div",{className:"relative",children:[t.jsx("select",{value:a.nam,onChange:E=>r({...a,nam:Number(E.target.value)}),className:"w-28 px-3 py-2 border border-slate-200 rounded-lg appearance-none focus:ring-2 focus:ring-blue-500 bg-white",children:[2023,2024,2025,2026].map(E=>t.jsx("option",{value:E,children:E},E))}),t.jsx(Ja,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400 pointer-events-none"})]})]})]})})}),t.jsx("div",{className:"border-b border-slate-200",children:t.jsx("div",{className:"flex flex-wrap gap-1",children:N.map(E=>t.jsx("button",{onClick:()=>n(E.key),className:`px-4 py-3 text-sm font-medium transition-colors ${e===E.key?"text-blue-600 border-b-2 border-blue-600 -mb-[1px]":"text-slate-500 hover:text-slate-900"}`,children:E.label},E.key))})}),t.jsxs("div",{className:"mt-6",children:[e==="dashboard"&&t.jsx(yU,{data:(y=s.data)==null?void 0:y.data,isLoading:s.isLoading}),e==="di-tre"&&t.jsx(vU,{data:(g=l.data)==null?void 0:g.data,isLoading:l.isLoading}),e==="ot"&&t.jsx(bU,{data:(b=o.data)==null?void 0:b.data,isLoading:o.isLoading}),e==="nghi-phep"&&t.jsx(NU,{data:(j=d.data)==null?void 0:j.data,isLoading:d.isLoading}),e==="quy-luong"&&t.jsx(jU,{data:(T=u.data)==null?void 0:T.data,isLoading:u.isLoading}),e==="headcount"&&t.jsx(wU,{data:(_=x.data)==null?void 0:_.data,isLoading:x.isLoading}),e==="cham-cong"&&t.jsx(kU,{data:(w=m.data)==null?void 0:w.data,isLoading:m.isLoading})]})]})}function yU({data:e,isLoading:n}){return n?t.jsx(jo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:e.kpis.map((a,r)=>t.jsx(st,{children:t.jsxs(Vt,{className:"pt-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-slate-500",children:a.ten}),t.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[a.donVi==="VND"?vs(a.giaTri):a.giaTri.toLocaleString(),a.donVi!=="VND"&&t.jsx("span",{className:"text-sm ml-1",children:a.donVi})]})]}),t.jsxs("div",{className:`p-3 rounded-full bg-${a.mau}-100`,children:[a.icon==="users"&&t.jsx(cn,{className:"h-6 w-6 text-blue-600"}),a.icon==="dollar"&&t.jsx(gr,{className:"h-6 w-6 text-green-600"}),a.icon==="clock"&&t.jsx(an,{className:"h-6 w-6 text-amber-600"}),a.icon==="calendar"&&t.jsx(At,{className:"h-6 w-6 text-purple-600"})]})]}),t.jsxs("div",{className:"mt-2 flex items-center text-sm",children:[a.soSanhThangTruoc>=0?t.jsx(oi,{className:"h-4 w-4 text-green-500 mr-1"}):t.jsx(mp,{className:"h-4 w-4 text-red-500 mr-1"}),t.jsxs("span",{className:a.soSanhThangTruoc>=0?"text-green-500":"text-red-500",children:[Math.abs(a.soSanhThangTruoc).toFixed(1),"%"]}),t.jsx("span",{className:"text-slate-500 ml-1",children:"so vi thng trc"})]})]})},r))}),e.alerts.length>0&&t.jsxs(st,{children:[t.jsx(zn,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(sa,{className:"h-5 w-5 text-amber-500"}),t.jsx("h3",{className:"font-semibold text-lg",children:"Cnh bo & Thng bo"})]})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-3",children:e.alerts.map((a,r)=>t.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg ${a.loai==="ERROR"?"bg-red-50 border border-red-200":a.loai==="WARNING"?"bg-amber-50 border border-amber-200":"bg-blue-50 border border-blue-200"}`,children:[a.loai==="ERROR"&&t.jsx(mo,{className:"h-5 w-5 text-red-500 mt-0.5"}),a.loai==="WARNING"&&t.jsx(sa,{className:"h-5 w-5 text-amber-500 mt-0.5"}),a.loai==="INFO"&&t.jsx(vu,{className:"h-5 w-5 text-blue-500 mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium",children:a.tieuDe}),t.jsx("p",{className:"text-sm text-slate-600",children:a.moTa})]}),t.jsx(_t,{variant:"neutral",children:a.soLuong})]},r))})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("h3",{className:"font-semibold",children:"Bin ng nhn s 6 thng"})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-4",children:e.bienDongNhanSu.map((a,r)=>{const s=Math.max(...e.bienDongNhanSu.map(l=>l.moiTuyen+l.nghiViec),1);return t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsxs("span",{children:["Thng ",a.thang]}),t.jsxs("span",{className:"text-green-600",children:["+",a.moiTuyen]}),t.jsxs("span",{className:"text-red-600",children:["-",a.nghiViec]})]}),t.jsxs("div",{className:"flex gap-1 h-2",children:[t.jsx("div",{className:"bg-green-500 rounded",style:{width:`${a.moiTuyen/s*100}%`}}),t.jsx("div",{className:"bg-red-500 rounded",style:{width:`${a.nghiViec/s*100}%`}})]})]},r)})})})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("h3",{className:"font-semibold",children:"Phn b qu lng theo phng ban"})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-3",children:e.phanBoLuongTheoPB.map((a,r)=>t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[t.jsx("span",{children:a.tenPhongBan}),t.jsxs("span",{className:"text-slate-600",children:[a.tyLe.toFixed(1),"%"]})]}),t.jsx("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full rounded-full",style:{width:`${a.tyLe}%`,backgroundColor:`hsl(${210+r*30}, 70%, 50%)`}})})]},r))})})]})]})]}):t.jsx(wo,{message:"Khng c d liu dashboard"})}function vU({data:e,isLoading:n}){return n?t.jsx(jo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsx(Wt,{title:"Nhn vin vi phm",value:e.summary.tongNhanVien,icon:t.jsx(cn,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"Lt i tr",value:e.summary.tongLuotDiTre,icon:t.jsx(an,{className:"h-5 w-5"}),color:"red"}),t.jsx(Wt,{title:"Lt v sm",value:e.summary.tongLuotVeSom,icon:t.jsx(an,{className:"h-5 w-5"}),color:"amber"}),t.jsx(Wt,{title:"Tng pht tr",value:e.summary.tongPhutTre,unit:"pht",icon:t.jsx(an,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"Tng pht v sm",value:e.summary.tongPhutVeSom,unit:"pht",icon:t.jsx(an,{className:"h-5 w-5"})})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("h3",{className:"font-semibold",children:"Top nhn vin i tr nhiu nht"})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-3",children:e.summary.topDiTre.map((a,r)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-red-100 flex items-center justify-center text-red-600 font-bold",children:r+1}),t.jsx("span",{className:"font-medium",children:a.hoTen})]}),t.jsxs(_t,{variant:"danger",children:[a.soLan," ln"]})]},a.nhanVienId))})})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsxs("h3",{className:"font-semibold",children:["Chi tit (",e.chiTiet.length," bn ghi)"]})}),t.jsx(Vt,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-slate-200",children:[t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"M NV"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"H tn"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"Phng ban"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"Ngy"}),t.jsx("th",{className:"text-center p-3 font-medium text-slate-600",children:"Gi vo"}),t.jsx("th",{className:"text-center p-3 font-medium text-slate-600",children:"Gi ra"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Pht tr"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Pht v sm"})]})}),t.jsx("tbody",{children:e.chiTiet.slice(0,50).map((a,r)=>t.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[t.jsx("td",{className:"p-3",children:a.maNhanVien}),t.jsx("td",{className:"p-3",children:a.hoTen}),t.jsx("td",{className:"p-3",children:a.phongBan}),t.jsx("td",{className:"p-3",children:pU(a.ngay)}),t.jsx("td",{className:"text-center p-3",children:a.gioVao||"-"}),t.jsx("td",{className:"text-center p-3",children:a.gioRa||"-"}),t.jsx("td",{className:"text-right p-3",children:a.soPhutTre>0&&t.jsx("span",{className:"text-red-600 font-medium",children:a.soPhutTre})}),t.jsx("td",{className:"text-right p-3",children:a.soPhutVeSom>0&&t.jsx("span",{className:"text-amber-600 font-medium",children:a.soPhutVeSom})})]},r))})]})})})]})]}):t.jsx(wo,{message:"Khng c d liu i tr/v sm"})}function bU({data:e,isLoading:n}){return n?t.jsx(jo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsx(Wt,{title:"Nhn vin OT",value:e.summary.tongNhanVien,icon:t.jsx(cn,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"Tng gi OT",value:e.summary.tongGioOT.toFixed(1),unit:"gi",icon:t.jsx(an,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Wt,{title:"Tng tin OT",value:vs(e.summary.tongTienOT),icon:t.jsx(gr,{className:"h-5 w-5"}),color:"green"}),t.jsx(Wt,{title:"TB gi OT/ngy",value:e.summary.trungBinhGioOTNgay.toFixed(2),unit:"gi",icon:t.jsx(an,{className:"h-5 w-5"})})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("h3",{className:"font-semibold",children:"Top phng ban OT nhiu nht"})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-3",children:e.summary.phongBanNhieuOTNhat.map((a,r)=>{const s=Math.max(...e.summary.phongBanNhieuOTNhat.map(l=>l.tongGio),1);return t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[t.jsx("span",{children:a.phongBan}),t.jsxs("span",{className:"font-medium",children:[a.tongGio.toFixed(1)," gi"]})]}),t.jsx("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${a.tongGio/s*100}%`}})})]},r)})})})]})]}):t.jsx(wo,{message:"Khng c d liu tng ca"})}function NU({data:e,isLoading:n}){return n?t.jsx(jo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsx(Wt,{title:"Tng n",value:e.summary.tongDon,icon:t.jsx(At,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"Tng ngy ngh",value:e.summary.tongNgayNghi,unit:"ngy",icon:t.jsx(At,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Wt,{title:" duyt",value:e.summary.daDuyet,icon:t.jsx(At,{className:"h-5 w-5"}),color:"green"}),t.jsx(Wt,{title:"Ch duyt",value:e.summary.choDuyet,icon:t.jsx(an,{className:"h-5 w-5"}),color:"amber"}),t.jsx(Wt,{title:"T chi",value:e.summary.tuChoi,icon:t.jsx(mo,{className:"h-5 w-5"}),color:"red"})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("h3",{className:"font-semibold",children:"Thng k theo loi ngh"})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-3",children:e.summary.theoLoai.map((a,r)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[t.jsx("span",{children:a.loai||"Cha phn loi"}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs(_t,{variant:"info",children:[a.soDon," n"]}),t.jsxs(_t,{variant:"warning",children:[a.soNgay," ngy"]})]})]},r))})})]})]}):t.jsx(wo,{message:"Khng c d liu ngh php"})}function jU({data:e,isLoading:n}){return n?t.jsx(jo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsx(Wt,{title:"Tng qu lng",value:vs(e.summary.tongQuyLuong),icon:t.jsx(gr,{className:"h-5 w-5"}),color:"green"}),t.jsx(Wt,{title:"Tng nhn vin",value:e.summary.tongNhanVien,icon:t.jsx(cn,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"Lng trung bnh",value:vs(e.summary.luongTrungBinh),icon:t.jsx(gr,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Wt,{title:"Tng thu TNCN",value:vs(e.summary.tongThueTNCN),icon:t.jsx(gr,{className:"h-5 w-5"}),color:"red"})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("h3",{className:"font-semibold",children:"Qu lng theo phng ban"})}),t.jsx(Vt,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-slate-200",children:[t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"Phng ban"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Nhn vin"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Lng c bn"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Ph cp"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Thng"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Khu tr"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Thc lnh"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"T l"})]})}),t.jsx("tbody",{children:e.theoPhongBan.map((a,r)=>t.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[t.jsx("td",{className:"p-3 font-medium",children:a.tenPhongBan}),t.jsx("td",{className:"text-right p-3",children:a.tongNhanVien}),t.jsx("td",{className:"text-right p-3",children:vs(a.tongLuongCoBan)}),t.jsx("td",{className:"text-right p-3",children:vs(a.tongPhuCap)}),t.jsx("td",{className:"text-right p-3",children:vs(a.tongThuong)}),t.jsx("td",{className:"text-right p-3 text-red-600",children:vs(a.tongKhauTru)}),t.jsx("td",{className:"text-right p-3 font-medium text-green-600",children:vs(a.tongThucLinh)}),t.jsxs("td",{className:"text-right p-3",children:[a.tyLeQuyLuong.toFixed(1),"%"]})]},r))})]})})})]})]}):t.jsx(wo,{message:"Khng c d liu qu lng"})}function wU({data:e,isLoading:n}){return n?t.jsx(jo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsx(Wt,{title:"Tng nhn s",value:e.summary.tongNhanVien,icon:t.jsx(cn,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"ang lm",value:e.summary.dangLam,icon:t.jsx(cn,{className:"h-5 w-5"}),color:"green"}),t.jsx(Wt,{title:"Mi tuyn",value:e.summary.moiTuyenThang,icon:t.jsx(oi,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Wt,{title:"Ngh vic",value:e.summary.nghiViecThang,icon:t.jsx(mp,{className:"h-5 w-5"}),color:"red"}),t.jsx(Wt,{title:"T l ngh vic",value:`${e.summary.tyLeNghiViec.toFixed(1)}%`,icon:t.jsx(mp,{className:"h-5 w-5"}),color:"amber"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("h3",{className:"font-semibold",children:"Phn b theo gii tnh"})}),t.jsx(Vt,{children:t.jsxs("div",{className:"flex items-center justify-center gap-8",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-20 h-20 rounded-full bg-blue-100 flex items-center justify-center mx-auto mb-2",children:t.jsx("span",{className:"text-2xl font-bold text-blue-600",children:e.summary.theoGioiTinh.nam})}),t.jsx("span",{className:"text-slate-600",children:"Nam"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-20 h-20 rounded-full bg-pink-100 flex items-center justify-center mx-auto mb-2",children:t.jsx("span",{className:"text-2xl font-bold text-pink-600",children:e.summary.theoGioiTinh.nu})}),t.jsx("span",{className:"text-slate-600",children:"N"})]})]})})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsx("h3",{className:"font-semibold",children:"Phn b theo  tui"})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-3",children:[{label:"Di 25",value:e.summary.theoDoTuoi.duoi25},{label:"25-35",value:e.summary.theoDoTuoi.tu25den35},{label:"35-45",value:e.summary.theoDoTuoi.tu35den45},{label:"Trn 45",value:e.summary.theoDoTuoi.tren45}].map((a,r)=>t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[t.jsx("span",{children:a.label}),t.jsxs("span",{className:"font-medium",children:[a.value," ngi"]})]}),t.jsx("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-purple-500 rounded-full",style:{width:`${e.summary.tongNhanVien>0?a.value/e.summary.tongNhanVien*100:0}%`}})})]},r))})})]})]})]}):t.jsx(wo,{message:"Khng c d liu nhn s"})}function kU({data:e,isLoading:n}){return n?t.jsx(jo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsx(Wt,{title:"Ngy cng chun",value:e.summary.ngayCongChuan,unit:"ngy",icon:t.jsx(At,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"Tng nhn vin",value:e.summary.tongNhanVien,icon:t.jsx(cn,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"TB ngy cng",value:e.summary.trungBinhNgayCong.toFixed(1),unit:"ngy",icon:t.jsx(At,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Wt,{title:"T l i lm",value:`${e.summary.tyLeDiLamTrungBinh.toFixed(1)}%`,icon:t.jsx(oi,{className:"h-5 w-5"}),color:"green"}),t.jsx(Wt,{title:"Tng gi OT",value:e.summary.tongGioOT.toFixed(1),unit:"gi",icon:t.jsx(an,{className:"h-5 w-5"}),color:"amber"})]}),t.jsxs(st,{children:[t.jsx(zn,{children:t.jsxs("h3",{className:"font-semibold",children:["Chi tit chm cng (",e.chiTiet.length," nhn vin)"]})}),t.jsx(Vt,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-slate-200",children:[t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"M NV"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"H tn"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"Phng ban"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Cng chun"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Cng thc"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Ngy ngh"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"i tr"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"V sm"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Gi OT"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"T l"})]})}),t.jsx("tbody",{children:e.chiTiet.slice(0,50).map((a,r)=>t.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[t.jsx("td",{className:"p-3",children:a.maNhanVien}),t.jsx("td",{className:"p-3",children:a.hoTen}),t.jsx("td",{className:"p-3",children:a.phongBan}),t.jsx("td",{className:"text-right p-3",children:a.ngayCongChuan}),t.jsx("td",{className:"text-right p-3 font-medium",children:a.ngayCongThuc}),t.jsx("td",{className:"text-right p-3",children:a.ngayNghi+a.ngayPhep}),t.jsx("td",{className:"text-right p-3",children:a.soLanDiTre>0&&t.jsx("span",{className:"text-red-600",children:a.soLanDiTre})}),t.jsx("td",{className:"text-right p-3",children:a.soLanVeSom>0&&t.jsx("span",{className:"text-amber-600",children:a.soLanVeSom})}),t.jsx("td",{className:"text-right p-3",children:a.tongGioOT>0&&t.jsx("span",{className:"text-blue-600",children:a.tongGioOT.toFixed(1)})}),t.jsx("td",{className:"text-right p-3",children:t.jsxs(_t,{variant:a.tyLeDiLam>=90?"success":a.tyLeDiLam>=80?"warning":"danger",children:[a.tyLeDiLam.toFixed(1),"%"]})})]},r))})]})})})]})]}):t.jsx(wo,{message:"Khng c d liu chm cng"})}function Wt({title:e,value:n,unit:a,icon:r,color:s="gray"}){const l={gray:"bg-slate-100",red:"bg-red-100",amber:"bg-amber-100",green:"bg-green-100",blue:"bg-blue-100"};return t.jsx(st,{children:t.jsx(Vt,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-slate-500",children:e}),t.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[n,a&&t.jsx("span",{className:"text-sm font-normal ml-1",children:a})]})]}),t.jsx("div",{className:`p-3 rounded-full ${l[s]||l.gray}`,children:r})]})})})}function jo(){return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[1,2,3,4].map(e=>t.jsx(st,{children:t.jsx(Vt,{className:"pt-6",children:t.jsx("div",{className:"h-16 bg-slate-200 animate-pulse rounded"})})},e))}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-6",children:t.jsx("div",{className:"h-64 bg-slate-200 animate-pulse rounded"})})})]})}function wo({message:e}){return t.jsx(st,{children:t.jsx(Vt,{className:"pt-6",children:t.jsxs("div",{className:"text-center py-12 text-slate-500",children:[t.jsx(At,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:e})]})})})}function TU(){return t.jsxs(m3,{children:[t.jsx(nt,{path:"/dang-nhap",element:t.jsx(OD,{})}),t.jsxs(nt,{path:"/",element:t.jsx($E,{}),children:[t.jsx(nt,{index:!0,element:t.jsx(a6,{})}),t.jsx(nt,{path:"bang-luong",element:t.jsx(r6,{})}),t.jsx(nt,{path:"bang-luong/:id",element:t.jsx(nD,{})}),t.jsx(nt,{path:"nhan-vien",element:t.jsx(sD,{})}),t.jsx(nt,{path:"nhan-vien/:id",element:t.jsx(SD,{})}),t.jsx(nt,{path:"nhom-nhan-vien",element:t.jsx(ID,{})}),t.jsx(nt,{path:"phong-ban",element:t.jsx(LD,{})}),t.jsx(nt,{path:"khoan-luong",element:t.jsx(_D,{})}),t.jsx(nt,{path:"cham-cong",element:t.jsx(AD,{})}),t.jsx(nt,{path:"import-excel",element:t.jsx(ED,{})}),t.jsx(nt,{path:"cai-dat",element:t.jsx(PD,{})}),t.jsx(nt,{path:"quy-che",element:t.jsx(Tt,{children:t.jsx(qD,{})})}),t.jsx(nt,{path:"quy-che/:id",element:t.jsx(Tt,{children:t.jsx(aA,{})})}),t.jsx(nt,{path:"su-kien",element:t.jsx(Tt,{children:t.jsx(sA,{})})}),t.jsx(nt,{path:"rule-trace",element:t.jsx(Tt,{children:t.jsx(lA,{})})}),t.jsx(nt,{path:"kpi/template",element:t.jsx(Tt,{children:t.jsx(RD,{})})}),t.jsx(nt,{path:"kpi/ky-danh-gia",element:t.jsx(Tt,{children:t.jsx(HD,{})})}),t.jsx(nt,{path:"kpi/cau-hinh-thuong",element:t.jsx(Tt,{children:t.jsx(VD,{})})}),t.jsx(nt,{path:"san-luong",element:t.jsx(Tt,{children:t.jsx(yV,{})})}),t.jsx(nt,{path:"san-luong/don-gia",element:t.jsx(Tt,{children:t.jsx(vV,{})})}),t.jsx(nt,{path:"import-chia-hang",element:t.jsx(Tt,{children:t.jsx(fV,{})})}),t.jsx(nt,{path:"import-giao-hang",element:t.jsx(Tt,{children:t.jsx(pV,{})})}),t.jsx(nt,{path:"lich-su-import",element:t.jsx(Tt,{children:t.jsx(gV,{})})}),t.jsx(nt,{path:"ung-luong",element:t.jsx(Tt,{children:t.jsx(jV,{})})}),t.jsx(nt,{path:"ung-luong/:id",element:t.jsx(Tt,{children:t.jsx(kV,{})})}),t.jsx(nt,{path:"cau-hinh/bang-luong",element:t.jsx(Tt,{children:t.jsx(SV,{})})}),t.jsx(nt,{path:"cau-hinh/ung-luong",element:t.jsx(Tt,{children:t.jsx(_V,{})})}),t.jsx(nt,{path:"so-luong/nhan-vien",element:t.jsx(Tt,{children:t.jsx(TV,{})})}),t.jsx(nt,{path:"so-luong/phong-ban",element:t.jsx(Tt,{children:t.jsx(CV,{})})}),t.jsx(nt,{path:"nghi-phep/loai-nghi",element:t.jsx(Tt,{children:t.jsx(AV,{})})}),t.jsx(nt,{path:"nghi-phep/don-cua-toi",element:t.jsx(Tt,{children:t.jsx(FV,{})})}),t.jsx(nt,{path:"nghi-phep/duyet",element:t.jsx(Tt,{children:t.jsx(LV,{})})}),t.jsx(nt,{path:"nghi-phep/lich",element:t.jsx(Tt,{children:t.jsx(PV,{})})}),t.jsx(nt,{path:"xep-ca/danh-muc-ca",element:t.jsx(Tt,{children:t.jsx(IV,{})})}),t.jsx(nt,{path:"xep-ca/lich-phan-ca",element:t.jsx(Tt,{children:t.jsx(OV,{})})}),t.jsx(nt,{path:"yeu-cau/don-cua-toi",element:t.jsx(Tt,{children:t.jsx(MV,{})})}),t.jsx(nt,{path:"yeu-cau/duyet",element:t.jsx(Tt,{children:t.jsx(RV,{})})}),t.jsx(nt,{path:"quan-tri/nguoi-dung",element:t.jsx(Tt,{children:t.jsx(UD,{})})}),t.jsx(nt,{path:"quan-tri/audit-log",element:t.jsx(Tt,{children:t.jsx(KD,{})})}),t.jsx(nt,{path:"anti-fraud/geofence",element:t.jsx(Tt,{children:t.jsx(ZV,{})})}),t.jsx(nt,{path:"anti-fraud/gps-logs",element:t.jsx(Tt,{children:t.jsx(eU,{})})}),t.jsx(nt,{path:"anti-fraud/devices",element:t.jsx(Tt,{children:t.jsx(tU,{})})}),t.jsx(nt,{path:"timesheet",element:t.jsx(Tt,{children:t.jsx(cU,{})})}),t.jsx(nt,{path:"payroll-sync",element:t.jsx(Tt,{children:t.jsx(xU,{})})}),t.jsx(nt,{path:"reports",element:t.jsx(Tt,{children:t.jsx(gU,{})})}),t.jsx(nt,{path:"*",element:t.jsx(h3,{to:"/",replace:!0})})]}),t.jsxs(nt,{path:"/portal",element:t.jsx(Tt,{children:t.jsx(HV,{})}),children:[t.jsx(nt,{index:!0,element:t.jsx($V,{})}),t.jsx(nt,{path:"lich-lam",element:t.jsx(GV,{})}),t.jsx(nt,{path:"cham-cong",element:t.jsx(qV,{})}),t.jsx(nt,{path:"yeu-cau",element:t.jsx(WV,{})}),t.jsx(nt,{path:"ca-nhan",element:t.jsx(XV,{})}),t.jsx(nt,{path:"thong-bao",element:t.jsx(y2,{})})]}),t.jsx(nt,{path:"/thong-bao",element:t.jsx(Tt,{children:t.jsx(y2,{})})})]})}const CU=new iS({defaultOptions:{queries:{staleTime:300*1e3,retry:1}}});O4.createRoot(document.getElementById("root")).render(t.jsx(D.StrictMode,{children:t.jsx(lS,{client:CU,children:t.jsx(j3,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:t.jsxs(DE,{children:[t.jsx(TU,{}),t.jsx(m_,{position:"top-right",toastOptions:{duration:3e3,style:{background:"#333",color:"#fff"}}})]})})})}));
