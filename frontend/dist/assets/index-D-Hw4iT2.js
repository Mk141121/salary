var pC=Object.defineProperty;var k1=e=>{throw TypeError(e)};var gC=(e,n,a)=>n in e?pC(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a;var Km=(e,n,a)=>gC(e,typeof n!="symbol"?n+"":n,a),zm=(e,n,a)=>n.has(e)||k1("Cannot "+a);var de=(e,n,a)=>(zm(e,n,"read from private field"),a?a.call(e):n.get(e)),tt=(e,n,a)=>n.has(e)?k1("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(e):n.set(e,a),$e=(e,n,a,r)=>(zm(e,n,"write to private field"),r?r.call(e,a):n.set(e,a),a),yt=(e,n,a)=>(zm(e,n,"access private method"),a);var Mh=(e,n,a,r)=>({set _(s){$e(e,n,s,a)},get _(){return de(e,n,r)}});function yC(e,n){for(var a=0;a<n.length;a++){const r=n[a];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const l=Object.getOwnPropertyDescriptor(r,s);l&&Object.defineProperty(e,s,l.get?l:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function a(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(s){if(s.ep)return;s.ep=!0;const l=a(s);fetch(s.href,l)}})();function Lp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var $m={exports:{}},bd={},Gm={exports:{}},Nt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T1;function vC(){if(T1)return Nt;T1=1;var e=Symbol.for("react.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),o=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),f=Symbol.iterator;function p(H){return H===null||typeof H!="object"?null:(H=f&&H[f]||H["@@iterator"],typeof H=="function"?H:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,y={};function N(H,F,I){this.props=H,this.context=F,this.refs=y,this.updater=I||b}N.prototype.isReactComponent={},N.prototype.setState=function(H,F){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,F,"setState")},N.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function C(){}C.prototype=N.prototype;function T(H,F,I){this.props=H,this.context=F,this.refs=y,this.updater=I||b}var S=T.prototype=new C;S.constructor=T,g(S,N.prototype),S.isPureReactComponent=!0;var k=Array.isArray,_=Object.prototype.hasOwnProperty,P={current:null},j={key:!0,ref:!0,__self:!0,__source:!0};function A(H,F,I){var O,V={},te=null,pe=null;if(F!=null)for(O in F.ref!==void 0&&(pe=F.ref),F.key!==void 0&&(te=""+F.key),F)_.call(F,O)&&!j.hasOwnProperty(O)&&(V[O]=F[O]);var U=arguments.length-2;if(U===1)V.children=I;else if(1<U){for(var ce=Array(U),Q=0;Q<U;Q++)ce[Q]=arguments[Q+2];V.children=ce}if(H&&H.defaultProps)for(O in U=H.defaultProps,U)V[O]===void 0&&(V[O]=U[O]);return{$$typeof:e,type:H,key:te,ref:pe,props:V,_owner:P.current}}function L(H,F){return{$$typeof:e,type:H.type,key:F,ref:H.ref,props:H.props,_owner:H._owner}}function W(H){return typeof H=="object"&&H!==null&&H.$$typeof===e}function R(H){var F={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(I){return F[I]})}var M=/\/+/g;function q(H,F){return typeof H=="object"&&H!==null&&H.key!=null?R(""+H.key):F.toString(36)}function ee(H,F,I,O,V){var te=typeof H;(te==="undefined"||te==="boolean")&&(H=null);var pe=!1;if(H===null)pe=!0;else switch(te){case"string":case"number":pe=!0;break;case"object":switch(H.$$typeof){case e:case n:pe=!0}}if(pe)return pe=H,V=V(pe),H=O===""?"."+q(pe,0):O,k(V)?(I="",H!=null&&(I=H.replace(M,"$&/")+"/"),ee(V,F,I,"",function(Q){return Q})):V!=null&&(W(V)&&(V=L(V,I+(!V.key||pe&&pe.key===V.key?"":(""+V.key).replace(M,"$&/")+"/")+H)),F.push(V)),1;if(pe=0,O=O===""?".":O+":",k(H))for(var U=0;U<H.length;U++){te=H[U];var ce=O+q(te,U);pe+=ee(te,F,I,ce,V)}else if(ce=p(H),typeof ce=="function")for(H=ce.call(H),U=0;!(te=H.next()).done;)te=te.value,ce=O+q(te,U++),pe+=ee(te,F,I,ce,V);else if(te==="object")throw F=String(H),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.");return pe}function z(H,F,I){if(H==null)return H;var O=[],V=0;return ee(H,O,"","",function(te){return F.call(I,te,V++)}),O}function fe(H){if(H._status===-1){var F=H._result;F=F(),F.then(function(I){(H._status===0||H._status===-1)&&(H._status=1,H._result=I)},function(I){(H._status===0||H._status===-1)&&(H._status=2,H._result=I)}),H._status===-1&&(H._status=0,H._result=F)}if(H._status===1)return H._result.default;throw H._result}var ae={current:null},J={transition:null},G={ReactCurrentDispatcher:ae,ReactCurrentBatchConfig:J,ReactCurrentOwner:P};function he(){throw Error("act(...) is not supported in production builds of React.")}return Nt.Children={map:z,forEach:function(H,F,I){z(H,function(){F.apply(this,arguments)},I)},count:function(H){var F=0;return z(H,function(){F++}),F},toArray:function(H){return z(H,function(F){return F})||[]},only:function(H){if(!W(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},Nt.Component=N,Nt.Fragment=a,Nt.Profiler=s,Nt.PureComponent=T,Nt.StrictMode=r,Nt.Suspense=u,Nt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=G,Nt.act=he,Nt.cloneElement=function(H,F,I){if(H==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+H+".");var O=g({},H.props),V=H.key,te=H.ref,pe=H._owner;if(F!=null){if(F.ref!==void 0&&(te=F.ref,pe=P.current),F.key!==void 0&&(V=""+F.key),H.type&&H.type.defaultProps)var U=H.type.defaultProps;for(ce in F)_.call(F,ce)&&!j.hasOwnProperty(ce)&&(O[ce]=F[ce]===void 0&&U!==void 0?U[ce]:F[ce])}var ce=arguments.length-2;if(ce===1)O.children=I;else if(1<ce){U=Array(ce);for(var Q=0;Q<ce;Q++)U[Q]=arguments[Q+2];O.children=U}return{$$typeof:e,type:H.type,key:V,ref:te,props:O,_owner:pe}},Nt.createContext=function(H){return H={$$typeof:o,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},H.Provider={$$typeof:l,_context:H},H.Consumer=H},Nt.createElement=A,Nt.createFactory=function(H){var F=A.bind(null,H);return F.type=H,F},Nt.createRef=function(){return{current:null}},Nt.forwardRef=function(H){return{$$typeof:d,render:H}},Nt.isValidElement=W,Nt.lazy=function(H){return{$$typeof:m,_payload:{_status:-1,_result:H},_init:fe}},Nt.memo=function(H,F){return{$$typeof:h,type:H,compare:F===void 0?null:F}},Nt.startTransition=function(H){var F=J.transition;J.transition={};try{H()}finally{J.transition=F}},Nt.unstable_act=he,Nt.useCallback=function(H,F){return ae.current.useCallback(H,F)},Nt.useContext=function(H){return ae.current.useContext(H)},Nt.useDebugValue=function(){},Nt.useDeferredValue=function(H){return ae.current.useDeferredValue(H)},Nt.useEffect=function(H,F){return ae.current.useEffect(H,F)},Nt.useId=function(){return ae.current.useId()},Nt.useImperativeHandle=function(H,F,I){return ae.current.useImperativeHandle(H,F,I)},Nt.useInsertionEffect=function(H,F){return ae.current.useInsertionEffect(H,F)},Nt.useLayoutEffect=function(H,F){return ae.current.useLayoutEffect(H,F)},Nt.useMemo=function(H,F){return ae.current.useMemo(H,F)},Nt.useReducer=function(H,F,I){return ae.current.useReducer(H,F,I)},Nt.useRef=function(H){return ae.current.useRef(H)},Nt.useState=function(H){return ae.current.useState(H)},Nt.useSyncExternalStore=function(H,F,I){return ae.current.useSyncExternalStore(H,F,I)},Nt.useTransition=function(){return ae.current.useTransition()},Nt.version="18.3.1",Nt}var C1;function Op(){return C1||(C1=1,Gm.exports=vC()),Gm.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S1;function bC(){if(S1)return bd;S1=1;var e=Op(),n=Symbol.for("react.element"),a=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function o(d,u,h){var m,f={},p=null,b=null;h!==void 0&&(p=""+h),u.key!==void 0&&(p=""+u.key),u.ref!==void 0&&(b=u.ref);for(m in u)r.call(u,m)&&!l.hasOwnProperty(m)&&(f[m]=u[m]);if(d&&d.defaultProps)for(m in u=d.defaultProps,u)f[m]===void 0&&(f[m]=u[m]);return{$$typeof:n,type:d,key:p,ref:b,props:f,_owner:s.current}}return bd.Fragment=a,bd.jsx=o,bd.jsxs=o,bd}var _1;function NC(){return _1||(_1=1,$m.exports=bC()),$m.exports}var t=NC(),E=Op();const k2=Lp(E),jC=yC({__proto__:null,default:k2},[E]);var Rh={},qm={exports:{}},za={},Wm={exports:{}},Xm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E1;function wC(){return E1||(E1=1,(function(e){function n(J,G){var he=J.length;J.push(G);e:for(;0<he;){var H=he-1>>>1,F=J[H];if(0<s(F,G))J[H]=G,J[he]=F,he=H;else break e}}function a(J){return J.length===0?null:J[0]}function r(J){if(J.length===0)return null;var G=J[0],he=J.pop();if(he!==G){J[0]=he;e:for(var H=0,F=J.length,I=F>>>1;H<I;){var O=2*(H+1)-1,V=J[O],te=O+1,pe=J[te];if(0>s(V,he))te<F&&0>s(pe,V)?(J[H]=pe,J[te]=he,H=te):(J[H]=V,J[O]=he,H=O);else if(te<F&&0>s(pe,he))J[H]=pe,J[te]=he,H=te;else break e}}return G}function s(J,G){var he=J.sortIndex-G.sortIndex;return he!==0?he:J.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,d=o.now();e.unstable_now=function(){return o.now()-d}}var u=[],h=[],m=1,f=null,p=3,b=!1,g=!1,y=!1,N=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(J){for(var G=a(h);G!==null;){if(G.callback===null)r(h);else if(G.startTime<=J)r(h),G.sortIndex=G.expirationTime,n(u,G);else break;G=a(h)}}function k(J){if(y=!1,S(J),!g)if(a(u)!==null)g=!0,fe(_);else{var G=a(h);G!==null&&ae(k,G.startTime-J)}}function _(J,G){g=!1,y&&(y=!1,C(A),A=-1),b=!0;var he=p;try{for(S(G),f=a(u);f!==null&&(!(f.expirationTime>G)||J&&!R());){var H=f.callback;if(typeof H=="function"){f.callback=null,p=f.priorityLevel;var F=H(f.expirationTime<=G);G=e.unstable_now(),typeof F=="function"?f.callback=F:f===a(u)&&r(u),S(G)}else r(u);f=a(u)}if(f!==null)var I=!0;else{var O=a(h);O!==null&&ae(k,O.startTime-G),I=!1}return I}finally{f=null,p=he,b=!1}}var P=!1,j=null,A=-1,L=5,W=-1;function R(){return!(e.unstable_now()-W<L)}function M(){if(j!==null){var J=e.unstable_now();W=J;var G=!0;try{G=j(!0,J)}finally{G?q():(P=!1,j=null)}}else P=!1}var q;if(typeof T=="function")q=function(){T(M)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,z=ee.port2;ee.port1.onmessage=M,q=function(){z.postMessage(null)}}else q=function(){N(M,0)};function fe(J){j=J,P||(P=!0,q())}function ae(J,G){A=N(function(){J(e.unstable_now())},G)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(J){J.callback=null},e.unstable_continueExecution=function(){g||b||(g=!0,fe(_))},e.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<J?Math.floor(1e3/J):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return a(u)},e.unstable_next=function(J){switch(p){case 1:case 2:case 3:var G=3;break;default:G=p}var he=p;p=G;try{return J()}finally{p=he}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(J,G){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var he=p;p=J;try{return G()}finally{p=he}},e.unstable_scheduleCallback=function(J,G,he){var H=e.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?H+he:H):he=H,J){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=he+F,J={id:m++,callback:G,priorityLevel:J,startTime:he,expirationTime:F,sortIndex:-1},he>H?(J.sortIndex=he,n(h,J),a(u)===null&&J===a(h)&&(y?(C(A),A=-1):y=!0,ae(k,he-H))):(J.sortIndex=F,n(u,J),g||b||(g=!0,fe(_))),J},e.unstable_shouldYield=R,e.unstable_wrapCallback=function(J){var G=p;return function(){var he=p;p=G;try{return J.apply(this,arguments)}finally{p=he}}}})(Xm)),Xm}var D1;function kC(){return D1||(D1=1,Wm.exports=wC()),Wm.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F1;function TC(){if(F1)return za;F1=1;var e=Op(),n=kC();function a(i){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+i,x=1;x<arguments.length;x++)c+="&args[]="+encodeURIComponent(arguments[x]);return"Minified React error #"+i+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function l(i,c){o(i,c),o(i+"Capture",c)}function o(i,c){for(s[i]=c,i=0;i<c.length;i++)r.add(c[i])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},f={};function p(i){return u.call(f,i)?!0:u.call(m,i)?!1:h.test(i)?f[i]=!0:(m[i]=!0,!1)}function b(i,c,x,v){if(x!==null&&x.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return v?!1:x!==null?!x.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function g(i,c,x,v){if(c===null||typeof c>"u"||b(i,c,x,v))return!0;if(v)return!1;if(x!==null)switch(x.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function y(i,c,x,v,w,D,B){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=v,this.attributeNamespace=w,this.mustUseProperty=x,this.propertyName=i,this.type=c,this.sanitizeURL=D,this.removeEmptyString=B}var N={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){N[i]=new y(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var c=i[0];N[c]=new y(c,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){N[i]=new y(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){N[i]=new y(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){N[i]=new y(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){N[i]=new y(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){N[i]=new y(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){N[i]=new y(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){N[i]=new y(i,5,!1,i.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function T(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var c=i.replace(C,T);N[c]=new y(c,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var c=i.replace(C,T);N[c]=new y(c,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var c=i.replace(C,T);N[c]=new y(c,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){N[i]=new y(i,1,!1,i.toLowerCase(),null,!1,!1)}),N.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){N[i]=new y(i,1,!1,i.toLowerCase(),null,!0,!0)});function S(i,c,x,v){var w=N.hasOwnProperty(c)?N[c]:null;(w!==null?w.type!==0:v||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(g(c,x,w,v)&&(x=null),v||w===null?p(c)&&(x===null?i.removeAttribute(c):i.setAttribute(c,""+x)):w.mustUseProperty?i[w.propertyName]=x===null?w.type===3?!1:"":x:(c=w.attributeName,v=w.attributeNamespace,x===null?i.removeAttribute(c):(w=w.type,x=w===3||w===4&&x===!0?"":""+x,v?i.setAttributeNS(v,c,x):i.setAttribute(c,x))))}var k=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),P=Symbol.for("react.portal"),j=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),W=Symbol.for("react.provider"),R=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),ee=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),fe=Symbol.for("react.lazy"),ae=Symbol.for("react.offscreen"),J=Symbol.iterator;function G(i){return i===null||typeof i!="object"?null:(i=J&&i[J]||i["@@iterator"],typeof i=="function"?i:null)}var he=Object.assign,H;function F(i){if(H===void 0)try{throw Error()}catch(x){var c=x.stack.trim().match(/\n( *(at )?)/);H=c&&c[1]||""}return`
`+H+i}var I=!1;function O(i,c){if(!i||I)return"";I=!0;var x=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(ke){var v=ke}Reflect.construct(i,[],c)}else{try{c.call()}catch(ke){v=ke}i.call(c.prototype)}else{try{throw Error()}catch(ke){v=ke}i()}}catch(ke){if(ke&&v&&typeof ke.stack=="string"){for(var w=ke.stack.split(`
`),D=v.stack.split(`
`),B=w.length-1,ie=D.length-1;1<=B&&0<=ie&&w[B]!==D[ie];)ie--;for(;1<=B&&0<=ie;B--,ie--)if(w[B]!==D[ie]){if(B!==1||ie!==1)do if(B--,ie--,0>ie||w[B]!==D[ie]){var ue=`
`+w[B].replace(" at new "," at ");return i.displayName&&ue.includes("<anonymous>")&&(ue=ue.replace("<anonymous>",i.displayName)),ue}while(1<=B&&0<=ie);break}}}finally{I=!1,Error.prepareStackTrace=x}return(i=i?i.displayName||i.name:"")?F(i):""}function V(i){switch(i.tag){case 5:return F(i.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return i=O(i.type,!1),i;case 11:return i=O(i.type.render,!1),i;case 1:return i=O(i.type,!0),i;default:return""}}function te(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case j:return"Fragment";case P:return"Portal";case L:return"Profiler";case A:return"StrictMode";case q:return"Suspense";case ee:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case R:return(i.displayName||"Context")+".Consumer";case W:return(i._context.displayName||"Context")+".Provider";case M:var c=i.render;return i=i.displayName,i||(i=c.displayName||c.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case z:return c=i.displayName||null,c!==null?c:te(i.type)||"Memo";case fe:c=i._payload,i=i._init;try{return te(i(c))}catch{}}return null}function pe(i){var c=i.type;switch(i.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=c.render,i=i.displayName||i.name||"",c.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return te(c);case 8:return c===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function U(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function ce(i){var c=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Q(i){var c=ce(i)?"checked":"value",x=Object.getOwnPropertyDescriptor(i.constructor.prototype,c),v=""+i[c];if(!i.hasOwnProperty(c)&&typeof x<"u"&&typeof x.get=="function"&&typeof x.set=="function"){var w=x.get,D=x.set;return Object.defineProperty(i,c,{configurable:!0,get:function(){return w.call(this)},set:function(B){v=""+B,D.call(this,B)}}),Object.defineProperty(i,c,{enumerable:x.enumerable}),{getValue:function(){return v},setValue:function(B){v=""+B},stopTracking:function(){i._valueTracker=null,delete i[c]}}}}function oe(i){i._valueTracker||(i._valueTracker=Q(i))}function X(i){if(!i)return!1;var c=i._valueTracker;if(!c)return!0;var x=c.getValue(),v="";return i&&(v=ce(i)?i.checked?"true":"false":i.value),i=v,i!==x?(c.setValue(i),!0):!1}function ve(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Ke(i,c){var x=c.checked;return he({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:x??i._wrapperState.initialChecked})}function at(i,c){var x=c.defaultValue==null?"":c.defaultValue,v=c.checked!=null?c.checked:c.defaultChecked;x=U(c.value!=null?c.value:x),i._wrapperState={initialChecked:v,initialValue:x,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function et(i,c){c=c.checked,c!=null&&S(i,"checked",c,!1)}function Be(i,c){et(i,c);var x=U(c.value),v=c.type;if(x!=null)v==="number"?(x===0&&i.value===""||i.value!=x)&&(i.value=""+x):i.value!==""+x&&(i.value=""+x);else if(v==="submit"||v==="reset"){i.removeAttribute("value");return}c.hasOwnProperty("value")?wn(i,c.type,x):c.hasOwnProperty("defaultValue")&&wn(i,c.type,U(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(i.defaultChecked=!!c.defaultChecked)}function Gt(i,c,x){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var v=c.type;if(!(v!=="submit"&&v!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+i._wrapperState.initialValue,x||c===i.value||(i.value=c),i.defaultValue=c}x=i.name,x!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,x!==""&&(i.name=x)}function wn(i,c,x){(c!=="number"||ve(i.ownerDocument)!==i)&&(x==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+x&&(i.defaultValue=""+x))}var kn=Array.isArray;function $n(i,c,x,v){if(i=i.options,c){c={};for(var w=0;w<x.length;w++)c["$"+x[w]]=!0;for(x=0;x<i.length;x++)w=c.hasOwnProperty("$"+i[x].value),i[x].selected!==w&&(i[x].selected=w),w&&v&&(i[x].defaultSelected=!0)}else{for(x=""+U(x),c=null,w=0;w<i.length;w++){if(i[w].value===x){i[w].selected=!0,v&&(i[w].defaultSelected=!0);return}c!==null||i[w].disabled||(c=i[w])}c!==null&&(c.selected=!0)}}function Hr(i,c){if(c.dangerouslySetInnerHTML!=null)throw Error(a(91));return he({},c,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function tr(i,c){var x=c.value;if(x==null){if(x=c.children,c=c.defaultValue,x!=null){if(c!=null)throw Error(a(92));if(kn(x)){if(1<x.length)throw Error(a(93));x=x[0]}c=x}c==null&&(c=""),x=c}i._wrapperState={initialValue:U(x)}}function He(i,c){var x=U(c.value),v=U(c.defaultValue);x!=null&&(x=""+x,x!==i.value&&(i.value=x),c.defaultValue==null&&i.defaultValue!==x&&(i.defaultValue=x)),v!=null&&(i.defaultValue=""+v)}function Ye(i){var c=i.textContent;c===i._wrapperState.initialValue&&c!==""&&c!==null&&(i.value=c)}function Ft(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qt(i,c){return i==null||i==="http://www.w3.org/1999/xhtml"?Ft(c):i==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var Ct,Mn=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,x,v,w){MSApp.execUnsafeLocalFunction(function(){return i(c,x,v,w)})}:i})(function(i,c){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=c;else{for(Ct=Ct||document.createElement("div"),Ct.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Ct.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;c.firstChild;)i.appendChild(c.firstChild)}});function ot(i,c){if(c){var x=i.firstChild;if(x&&x===i.lastChild&&x.nodeType===3){x.nodeValue=c;return}}i.textContent=c}var It={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Gn=["Webkit","ms","Moz","O"];Object.keys(It).forEach(function(i){Gn.forEach(function(c){c=c+i.charAt(0).toUpperCase()+i.substring(1),It[c]=It[i]})});function Zt(i,c,x){return c==null||typeof c=="boolean"||c===""?"":x||typeof c!="number"||c===0||It.hasOwnProperty(i)&&It[i]?(""+c).trim():c+"px"}function Ca(i,c){i=i.style;for(var x in c)if(c.hasOwnProperty(x)){var v=x.indexOf("--")===0,w=Zt(x,c[x],v);x==="float"&&(x="cssFloat"),v?i.setProperty(x,w):i[x]=w}}var ui=he({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ds(i,c){if(c){if(ui[i]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(a(137,i));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(a(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(a(61))}if(c.style!=null&&typeof c.style!="object")throw Error(a(62))}}function Fs(i,c){if(i.indexOf("-")===-1)return typeof c.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var as=null;function hi(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var jo=null,xi=null,mi=null;function xl(i){if(i=sd(i)){if(typeof jo!="function")throw Error(a(280));var c=i.stateNode;c&&(c=Ju(c),jo(i.stateNode,i.type,c))}}function Eu(i){xi?mi?mi.push(i):mi=[i]:xi=i}function Du(){if(xi){var i=xi,c=mi;if(mi=xi=null,xl(i),c)for(i=0;i<c.length;i++)xl(c[i])}}function Fu(i,c){return i(c)}function Au(){}var Rc=!1;function Pu(i,c,x){if(Rc)return i(c,x);Rc=!0;try{return Fu(i,c,x)}finally{Rc=!1,(xi!==null||mi!==null)&&(Au(),Du())}}function ml(i,c){var x=i.stateNode;if(x===null)return null;var v=Ju(x);if(v===null)return null;x=v[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(i=i.type,v=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!v;break e;default:i=!1}if(i)return null;if(x&&typeof x!="function")throw Error(a(231,c,typeof x));return x}var Bc=!1;if(d)try{var As={};Object.defineProperty(As,"passive",{get:function(){Bc=!0}}),window.addEventListener("test",As,As),window.removeEventListener("test",As,As)}catch{Bc=!1}function cx(i,c,x,v,w,D,B,ie,ue){var ke=Array.prototype.slice.call(arguments,3);try{c.apply(x,ke)}catch(Ae){this.onError(Ae)}}var fl=!1,wo=null,K=!1,ne=null,Y={onError:function(i){fl=!0,wo=i}};function Z(i,c,x,v,w,D,B,ie,ue){fl=!1,wo=null,cx.apply(Y,arguments)}function re(i,c,x,v,w,D,B,ie,ue){if(Z.apply(this,arguments),fl){if(fl){var ke=wo;fl=!1,wo=null}else throw Error(a(198));K||(K=!0,ne=ke)}}function se(i){var c=i,x=i;if(i.alternate)for(;c.return;)c=c.return;else{i=c;do c=i,(c.flags&4098)!==0&&(x=c.return),i=c.return;while(i)}return c.tag===3?x:null}function Ne(i){if(i.tag===13){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function Se(i){if(se(i)!==i)throw Error(a(188))}function be(i){var c=i.alternate;if(!c){if(c=se(i),c===null)throw Error(a(188));return c!==i?null:i}for(var x=i,v=c;;){var w=x.return;if(w===null)break;var D=w.alternate;if(D===null){if(v=w.return,v!==null){x=v;continue}break}if(w.child===D.child){for(D=w.child;D;){if(D===x)return Se(w),i;if(D===v)return Se(w),c;D=D.sibling}throw Error(a(188))}if(x.return!==v.return)x=w,v=D;else{for(var B=!1,ie=w.child;ie;){if(ie===x){B=!0,x=w,v=D;break}if(ie===v){B=!0,v=w,x=D;break}ie=ie.sibling}if(!B){for(ie=D.child;ie;){if(ie===x){B=!0,x=D,v=w;break}if(ie===v){B=!0,v=D,x=w;break}ie=ie.sibling}if(!B)throw Error(a(189))}}if(x.alternate!==v)throw Error(a(190))}if(x.tag!==3)throw Error(a(188));return x.stateNode.current===x?i:c}function je(i){return i=be(i),i!==null?we(i):null}function we(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var c=we(i);if(c!==null)return c;i=i.sibling}return null}var Pe=n.unstable_scheduleCallback,ze=n.unstable_cancelCallback,qe=n.unstable_shouldYield,Me=n.unstable_requestPaint,Oe=n.unstable_now,xt=n.unstable_getCurrentPriorityLevel,Qt=n.unstable_ImmediatePriority,en=n.unstable_UserBlockingPriority,Tn=n.unstable_NormalPriority,pl=n.unstable_LowPriority,fi=n.unstable_IdlePriority,rs=null,qn=null;function Hc(i){if(qn&&typeof qn.onCommitFiberRoot=="function")try{qn.onCommitFiberRoot(rs,i,void 0,(i.current.flags&128)===128)}catch{}}var Cn=Math.clz32?Math.clz32:LT,AT=Math.log,PT=Math.LN2;function LT(i){return i>>>=0,i===0?32:31-(AT(i)/PT|0)|0}var Lu=64,Ou=4194304;function Vc(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Iu(i,c){var x=i.pendingLanes;if(x===0)return 0;var v=0,w=i.suspendedLanes,D=i.pingedLanes,B=x&268435455;if(B!==0){var ie=B&~w;ie!==0?v=Vc(ie):(D&=B,D!==0&&(v=Vc(D)))}else B=x&~w,B!==0?v=Vc(B):D!==0&&(v=Vc(D));if(v===0)return 0;if(c!==0&&c!==v&&(c&w)===0&&(w=v&-v,D=c&-c,w>=D||w===16&&(D&4194240)!==0))return c;if((v&4)!==0&&(v|=x&16),c=i.entangledLanes,c!==0)for(i=i.entanglements,c&=v;0<c;)x=31-Cn(c),w=1<<x,v|=i[x],c&=~w;return v}function OT(i,c){switch(i){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function IT(i,c){for(var x=i.suspendedLanes,v=i.pingedLanes,w=i.expirationTimes,D=i.pendingLanes;0<D;){var B=31-Cn(D),ie=1<<B,ue=w[B];ue===-1?((ie&x)===0||(ie&v)!==0)&&(w[B]=OT(ie,c)):ue<=c&&(i.expiredLanes|=ie),D&=~ie}}function dx(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function ty(){var i=Lu;return Lu<<=1,(Lu&4194240)===0&&(Lu=64),i}function ux(i){for(var c=[],x=0;31>x;x++)c.push(i);return c}function Uc(i,c,x){i.pendingLanes|=c,c!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,c=31-Cn(c),i[c]=x}function MT(i,c){var x=i.pendingLanes&~c;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=c,i.mutableReadLanes&=c,i.entangledLanes&=c,c=i.entanglements;var v=i.eventTimes;for(i=i.expirationTimes;0<x;){var w=31-Cn(x),D=1<<w;c[w]=0,v[w]=-1,i[w]=-1,x&=~D}}function hx(i,c){var x=i.entangledLanes|=c;for(i=i.entanglements;x;){var v=31-Cn(x),w=1<<v;w&c|i[v]&c&&(i[v]|=c),x&=~w}}var Ut=0;function ny(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var ay,xx,ry,sy,iy,mx=!1,Mu=[],pi=null,gi=null,yi=null,Kc=new Map,zc=new Map,vi=[],RT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ly(i,c){switch(i){case"focusin":case"focusout":pi=null;break;case"dragenter":case"dragleave":gi=null;break;case"mouseover":case"mouseout":yi=null;break;case"pointerover":case"pointerout":Kc.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":zc.delete(c.pointerId)}}function $c(i,c,x,v,w,D){return i===null||i.nativeEvent!==D?(i={blockedOn:c,domEventName:x,eventSystemFlags:v,nativeEvent:D,targetContainers:[w]},c!==null&&(c=sd(c),c!==null&&xx(c)),i):(i.eventSystemFlags|=v,c=i.targetContainers,w!==null&&c.indexOf(w)===-1&&c.push(w),i)}function BT(i,c,x,v,w){switch(c){case"focusin":return pi=$c(pi,i,c,x,v,w),!0;case"dragenter":return gi=$c(gi,i,c,x,v,w),!0;case"mouseover":return yi=$c(yi,i,c,x,v,w),!0;case"pointerover":var D=w.pointerId;return Kc.set(D,$c(Kc.get(D)||null,i,c,x,v,w)),!0;case"gotpointercapture":return D=w.pointerId,zc.set(D,$c(zc.get(D)||null,i,c,x,v,w)),!0}return!1}function oy(i){var c=gl(i.target);if(c!==null){var x=se(c);if(x!==null){if(c=x.tag,c===13){if(c=Ne(x),c!==null){i.blockedOn=c,iy(i.priority,function(){ry(x)});return}}else if(c===3&&x.stateNode.current.memoizedState.isDehydrated){i.blockedOn=x.tag===3?x.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Ru(i){if(i.blockedOn!==null)return!1;for(var c=i.targetContainers;0<c.length;){var x=px(i.domEventName,i.eventSystemFlags,c[0],i.nativeEvent);if(x===null){x=i.nativeEvent;var v=new x.constructor(x.type,x);as=v,x.target.dispatchEvent(v),as=null}else return c=sd(x),c!==null&&xx(c),i.blockedOn=x,!1;c.shift()}return!0}function cy(i,c,x){Ru(i)&&x.delete(c)}function HT(){mx=!1,pi!==null&&Ru(pi)&&(pi=null),gi!==null&&Ru(gi)&&(gi=null),yi!==null&&Ru(yi)&&(yi=null),Kc.forEach(cy),zc.forEach(cy)}function Gc(i,c){i.blockedOn===c&&(i.blockedOn=null,mx||(mx=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,HT)))}function qc(i){function c(w){return Gc(w,i)}if(0<Mu.length){Gc(Mu[0],i);for(var x=1;x<Mu.length;x++){var v=Mu[x];v.blockedOn===i&&(v.blockedOn=null)}}for(pi!==null&&Gc(pi,i),gi!==null&&Gc(gi,i),yi!==null&&Gc(yi,i),Kc.forEach(c),zc.forEach(c),x=0;x<vi.length;x++)v=vi[x],v.blockedOn===i&&(v.blockedOn=null);for(;0<vi.length&&(x=vi[0],x.blockedOn===null);)oy(x),x.blockedOn===null&&vi.shift()}var ko=k.ReactCurrentBatchConfig,Bu=!0;function VT(i,c,x,v){var w=Ut,D=ko.transition;ko.transition=null;try{Ut=1,fx(i,c,x,v)}finally{Ut=w,ko.transition=D}}function UT(i,c,x,v){var w=Ut,D=ko.transition;ko.transition=null;try{Ut=4,fx(i,c,x,v)}finally{Ut=w,ko.transition=D}}function fx(i,c,x,v){if(Bu){var w=px(i,c,x,v);if(w===null)Px(i,c,v,Hu,x),ly(i,v);else if(BT(w,i,c,x,v))v.stopPropagation();else if(ly(i,v),c&4&&-1<RT.indexOf(i)){for(;w!==null;){var D=sd(w);if(D!==null&&ay(D),D=px(i,c,x,v),D===null&&Px(i,c,v,Hu,x),D===w)break;w=D}w!==null&&v.stopPropagation()}else Px(i,c,v,null,x)}}var Hu=null;function px(i,c,x,v){if(Hu=null,i=hi(v),i=gl(i),i!==null)if(c=se(i),c===null)i=null;else if(x=c.tag,x===13){if(i=Ne(c),i!==null)return i;i=null}else if(x===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;i=null}else c!==i&&(i=null);return Hu=i,null}function dy(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xt()){case Qt:return 1;case en:return 4;case Tn:case pl:return 16;case fi:return 536870912;default:return 16}default:return 16}}var bi=null,gx=null,Vu=null;function uy(){if(Vu)return Vu;var i,c=gx,x=c.length,v,w="value"in bi?bi.value:bi.textContent,D=w.length;for(i=0;i<x&&c[i]===w[i];i++);var B=x-i;for(v=1;v<=B&&c[x-v]===w[D-v];v++);return Vu=w.slice(i,1<v?1-v:void 0)}function Uu(i){var c=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&c===13&&(i=13)):i=c,i===10&&(i=13),32<=i||i===13?i:0}function Ku(){return!0}function hy(){return!1}function nr(i){function c(x,v,w,D,B){this._reactName=x,this._targetInst=w,this.type=v,this.nativeEvent=D,this.target=B,this.currentTarget=null;for(var ie in i)i.hasOwnProperty(ie)&&(x=i[ie],this[ie]=x?x(D):D[ie]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?Ku:hy,this.isPropagationStopped=hy,this}return he(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var x=this.nativeEvent;x&&(x.preventDefault?x.preventDefault():typeof x.returnValue!="unknown"&&(x.returnValue=!1),this.isDefaultPrevented=Ku)},stopPropagation:function(){var x=this.nativeEvent;x&&(x.stopPropagation?x.stopPropagation():typeof x.cancelBubble!="unknown"&&(x.cancelBubble=!0),this.isPropagationStopped=Ku)},persist:function(){},isPersistent:Ku}),c}var To={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yx=nr(To),Wc=he({},To,{view:0,detail:0}),KT=nr(Wc),vx,bx,Xc,zu=he({},Wc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jx,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Xc&&(Xc&&i.type==="mousemove"?(vx=i.screenX-Xc.screenX,bx=i.screenY-Xc.screenY):bx=vx=0,Xc=i),vx)},movementY:function(i){return"movementY"in i?i.movementY:bx}}),xy=nr(zu),zT=he({},zu,{dataTransfer:0}),$T=nr(zT),GT=he({},Wc,{relatedTarget:0}),Nx=nr(GT),qT=he({},To,{animationName:0,elapsedTime:0,pseudoElement:0}),WT=nr(qT),XT=he({},To,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),QT=nr(XT),YT=he({},To,{data:0}),my=nr(YT),JT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ZT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},e4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function t4(i){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(i):(i=e4[i])?!!c[i]:!1}function jx(){return t4}var n4=he({},Wc,{key:function(i){if(i.key){var c=JT[i.key]||i.key;if(c!=="Unidentified")return c}return i.type==="keypress"?(i=Uu(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?ZT[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jx,charCode:function(i){return i.type==="keypress"?Uu(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Uu(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),a4=nr(n4),r4=he({},zu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fy=nr(r4),s4=he({},Wc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jx}),i4=nr(s4),l4=he({},To,{propertyName:0,elapsedTime:0,pseudoElement:0}),o4=nr(l4),c4=he({},zu,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),d4=nr(c4),u4=[9,13,27,32],wx=d&&"CompositionEvent"in window,Qc=null;d&&"documentMode"in document&&(Qc=document.documentMode);var h4=d&&"TextEvent"in window&&!Qc,py=d&&(!wx||Qc&&8<Qc&&11>=Qc),gy=" ",yy=!1;function vy(i,c){switch(i){case"keyup":return u4.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function by(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Co=!1;function x4(i,c){switch(i){case"compositionend":return by(c);case"keypress":return c.which!==32?null:(yy=!0,gy);case"textInput":return i=c.data,i===gy&&yy?null:i;default:return null}}function m4(i,c){if(Co)return i==="compositionend"||!wx&&vy(i,c)?(i=uy(),Vu=gx=bi=null,Co=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return py&&c.locale!=="ko"?null:c.data;default:return null}}var f4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ny(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c==="input"?!!f4[i.type]:c==="textarea"}function jy(i,c,x,v){Eu(v),c=Xu(c,"onChange"),0<c.length&&(x=new yx("onChange","change",null,x,v),i.push({event:x,listeners:c}))}var Yc=null,Jc=null;function p4(i){Hy(i,0)}function $u(i){var c=Fo(i);if(X(c))return i}function g4(i,c){if(i==="change")return c}var wy=!1;if(d){var kx;if(d){var Tx="oninput"in document;if(!Tx){var ky=document.createElement("div");ky.setAttribute("oninput","return;"),Tx=typeof ky.oninput=="function"}kx=Tx}else kx=!1;wy=kx&&(!document.documentMode||9<document.documentMode)}function Ty(){Yc&&(Yc.detachEvent("onpropertychange",Cy),Jc=Yc=null)}function Cy(i){if(i.propertyName==="value"&&$u(Jc)){var c=[];jy(c,Jc,i,hi(i)),Pu(p4,c)}}function y4(i,c,x){i==="focusin"?(Ty(),Yc=c,Jc=x,Yc.attachEvent("onpropertychange",Cy)):i==="focusout"&&Ty()}function v4(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return $u(Jc)}function b4(i,c){if(i==="click")return $u(c)}function N4(i,c){if(i==="input"||i==="change")return $u(c)}function j4(i,c){return i===c&&(i!==0||1/i===1/c)||i!==i&&c!==c}var Vr=typeof Object.is=="function"?Object.is:j4;function Zc(i,c){if(Vr(i,c))return!0;if(typeof i!="object"||i===null||typeof c!="object"||c===null)return!1;var x=Object.keys(i),v=Object.keys(c);if(x.length!==v.length)return!1;for(v=0;v<x.length;v++){var w=x[v];if(!u.call(c,w)||!Vr(i[w],c[w]))return!1}return!0}function Sy(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function _y(i,c){var x=Sy(i);i=0;for(var v;x;){if(x.nodeType===3){if(v=i+x.textContent.length,i<=c&&v>=c)return{node:x,offset:c-i};i=v}e:{for(;x;){if(x.nextSibling){x=x.nextSibling;break e}x=x.parentNode}x=void 0}x=Sy(x)}}function Ey(i,c){return i&&c?i===c?!0:i&&i.nodeType===3?!1:c&&c.nodeType===3?Ey(i,c.parentNode):"contains"in i?i.contains(c):i.compareDocumentPosition?!!(i.compareDocumentPosition(c)&16):!1:!1}function Dy(){for(var i=window,c=ve();c instanceof i.HTMLIFrameElement;){try{var x=typeof c.contentWindow.location.href=="string"}catch{x=!1}if(x)i=c.contentWindow;else break;c=ve(i.document)}return c}function Cx(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c&&(c==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||c==="textarea"||i.contentEditable==="true")}function w4(i){var c=Dy(),x=i.focusedElem,v=i.selectionRange;if(c!==x&&x&&x.ownerDocument&&Ey(x.ownerDocument.documentElement,x)){if(v!==null&&Cx(x)){if(c=v.start,i=v.end,i===void 0&&(i=c),"selectionStart"in x)x.selectionStart=c,x.selectionEnd=Math.min(i,x.value.length);else if(i=(c=x.ownerDocument||document)&&c.defaultView||window,i.getSelection){i=i.getSelection();var w=x.textContent.length,D=Math.min(v.start,w);v=v.end===void 0?D:Math.min(v.end,w),!i.extend&&D>v&&(w=v,v=D,D=w),w=_y(x,D);var B=_y(x,v);w&&B&&(i.rangeCount!==1||i.anchorNode!==w.node||i.anchorOffset!==w.offset||i.focusNode!==B.node||i.focusOffset!==B.offset)&&(c=c.createRange(),c.setStart(w.node,w.offset),i.removeAllRanges(),D>v?(i.addRange(c),i.extend(B.node,B.offset)):(c.setEnd(B.node,B.offset),i.addRange(c)))}}for(c=[],i=x;i=i.parentNode;)i.nodeType===1&&c.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof x.focus=="function"&&x.focus(),x=0;x<c.length;x++)i=c[x],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var k4=d&&"documentMode"in document&&11>=document.documentMode,So=null,Sx=null,ed=null,_x=!1;function Fy(i,c,x){var v=x.window===x?x.document:x.nodeType===9?x:x.ownerDocument;_x||So==null||So!==ve(v)||(v=So,"selectionStart"in v&&Cx(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),ed&&Zc(ed,v)||(ed=v,v=Xu(Sx,"onSelect"),0<v.length&&(c=new yx("onSelect","select",null,c,x),i.push({event:c,listeners:v}),c.target=So)))}function Gu(i,c){var x={};return x[i.toLowerCase()]=c.toLowerCase(),x["Webkit"+i]="webkit"+c,x["Moz"+i]="moz"+c,x}var _o={animationend:Gu("Animation","AnimationEnd"),animationiteration:Gu("Animation","AnimationIteration"),animationstart:Gu("Animation","AnimationStart"),transitionend:Gu("Transition","TransitionEnd")},Ex={},Ay={};d&&(Ay=document.createElement("div").style,"AnimationEvent"in window||(delete _o.animationend.animation,delete _o.animationiteration.animation,delete _o.animationstart.animation),"TransitionEvent"in window||delete _o.transitionend.transition);function qu(i){if(Ex[i])return Ex[i];if(!_o[i])return i;var c=_o[i],x;for(x in c)if(c.hasOwnProperty(x)&&x in Ay)return Ex[i]=c[x];return i}var Py=qu("animationend"),Ly=qu("animationiteration"),Oy=qu("animationstart"),Iy=qu("transitionend"),My=new Map,Ry="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ni(i,c){My.set(i,c),l(c,[i])}for(var Dx=0;Dx<Ry.length;Dx++){var Fx=Ry[Dx],T4=Fx.toLowerCase(),C4=Fx[0].toUpperCase()+Fx.slice(1);Ni(T4,"on"+C4)}Ni(Py,"onAnimationEnd"),Ni(Ly,"onAnimationIteration"),Ni(Oy,"onAnimationStart"),Ni("dblclick","onDoubleClick"),Ni("focusin","onFocus"),Ni("focusout","onBlur"),Ni(Iy,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var td="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),S4=new Set("cancel close invalid load scroll toggle".split(" ").concat(td));function By(i,c,x){var v=i.type||"unknown-event";i.currentTarget=x,re(v,c,void 0,i),i.currentTarget=null}function Hy(i,c){c=(c&4)!==0;for(var x=0;x<i.length;x++){var v=i[x],w=v.event;v=v.listeners;e:{var D=void 0;if(c)for(var B=v.length-1;0<=B;B--){var ie=v[B],ue=ie.instance,ke=ie.currentTarget;if(ie=ie.listener,ue!==D&&w.isPropagationStopped())break e;By(w,ie,ke),D=ue}else for(B=0;B<v.length;B++){if(ie=v[B],ue=ie.instance,ke=ie.currentTarget,ie=ie.listener,ue!==D&&w.isPropagationStopped())break e;By(w,ie,ke),D=ue}}}if(K)throw i=ne,K=!1,ne=null,i}function an(i,c){var x=c[Bx];x===void 0&&(x=c[Bx]=new Set);var v=i+"__bubble";x.has(v)||(Vy(c,i,2,!1),x.add(v))}function Ax(i,c,x){var v=0;c&&(v|=4),Vy(x,i,v,c)}var Wu="_reactListening"+Math.random().toString(36).slice(2);function nd(i){if(!i[Wu]){i[Wu]=!0,r.forEach(function(x){x!=="selectionchange"&&(S4.has(x)||Ax(x,!1,i),Ax(x,!0,i))});var c=i.nodeType===9?i:i.ownerDocument;c===null||c[Wu]||(c[Wu]=!0,Ax("selectionchange",!1,c))}}function Vy(i,c,x,v){switch(dy(c)){case 1:var w=VT;break;case 4:w=UT;break;default:w=fx}x=w.bind(null,c,x,i),w=void 0,!Bc||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(w=!0),v?w!==void 0?i.addEventListener(c,x,{capture:!0,passive:w}):i.addEventListener(c,x,!0):w!==void 0?i.addEventListener(c,x,{passive:w}):i.addEventListener(c,x,!1)}function Px(i,c,x,v,w){var D=v;if((c&1)===0&&(c&2)===0&&v!==null)e:for(;;){if(v===null)return;var B=v.tag;if(B===3||B===4){var ie=v.stateNode.containerInfo;if(ie===w||ie.nodeType===8&&ie.parentNode===w)break;if(B===4)for(B=v.return;B!==null;){var ue=B.tag;if((ue===3||ue===4)&&(ue=B.stateNode.containerInfo,ue===w||ue.nodeType===8&&ue.parentNode===w))return;B=B.return}for(;ie!==null;){if(B=gl(ie),B===null)return;if(ue=B.tag,ue===5||ue===6){v=D=B;continue e}ie=ie.parentNode}}v=v.return}Pu(function(){var ke=D,Ae=hi(x),Le=[];e:{var Fe=My.get(i);if(Fe!==void 0){var Ge=yx,Xe=i;switch(i){case"keypress":if(Uu(x)===0)break e;case"keydown":case"keyup":Ge=a4;break;case"focusin":Xe="focus",Ge=Nx;break;case"focusout":Xe="blur",Ge=Nx;break;case"beforeblur":case"afterblur":Ge=Nx;break;case"click":if(x.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ge=xy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ge=$T;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ge=i4;break;case Py:case Ly:case Oy:Ge=WT;break;case Iy:Ge=o4;break;case"scroll":Ge=KT;break;case"wheel":Ge=d4;break;case"copy":case"cut":case"paste":Ge=QT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ge=fy}var Qe=(c&4)!==0,Sn=!Qe&&i==="scroll",ge=Qe?Fe!==null?Fe+"Capture":null:Fe;Qe=[];for(var xe=ke,ye;xe!==null;){ye=xe;var Re=ye.stateNode;if(ye.tag===5&&Re!==null&&(ye=Re,ge!==null&&(Re=ml(xe,ge),Re!=null&&Qe.push(ad(xe,Re,ye)))),Sn)break;xe=xe.return}0<Qe.length&&(Fe=new Ge(Fe,Xe,null,x,Ae),Le.push({event:Fe,listeners:Qe}))}}if((c&7)===0){e:{if(Fe=i==="mouseover"||i==="pointerover",Ge=i==="mouseout"||i==="pointerout",Fe&&x!==as&&(Xe=x.relatedTarget||x.fromElement)&&(gl(Xe)||Xe[Ps]))break e;if((Ge||Fe)&&(Fe=Ae.window===Ae?Ae:(Fe=Ae.ownerDocument)?Fe.defaultView||Fe.parentWindow:window,Ge?(Xe=x.relatedTarget||x.toElement,Ge=ke,Xe=Xe?gl(Xe):null,Xe!==null&&(Sn=se(Xe),Xe!==Sn||Xe.tag!==5&&Xe.tag!==6)&&(Xe=null)):(Ge=null,Xe=ke),Ge!==Xe)){if(Qe=xy,Re="onMouseLeave",ge="onMouseEnter",xe="mouse",(i==="pointerout"||i==="pointerover")&&(Qe=fy,Re="onPointerLeave",ge="onPointerEnter",xe="pointer"),Sn=Ge==null?Fe:Fo(Ge),ye=Xe==null?Fe:Fo(Xe),Fe=new Qe(Re,xe+"leave",Ge,x,Ae),Fe.target=Sn,Fe.relatedTarget=ye,Re=null,gl(Ae)===ke&&(Qe=new Qe(ge,xe+"enter",Xe,x,Ae),Qe.target=ye,Qe.relatedTarget=Sn,Re=Qe),Sn=Re,Ge&&Xe)t:{for(Qe=Ge,ge=Xe,xe=0,ye=Qe;ye;ye=Eo(ye))xe++;for(ye=0,Re=ge;Re;Re=Eo(Re))ye++;for(;0<xe-ye;)Qe=Eo(Qe),xe--;for(;0<ye-xe;)ge=Eo(ge),ye--;for(;xe--;){if(Qe===ge||ge!==null&&Qe===ge.alternate)break t;Qe=Eo(Qe),ge=Eo(ge)}Qe=null}else Qe=null;Ge!==null&&Uy(Le,Fe,Ge,Qe,!1),Xe!==null&&Sn!==null&&Uy(Le,Sn,Xe,Qe,!0)}}e:{if(Fe=ke?Fo(ke):window,Ge=Fe.nodeName&&Fe.nodeName.toLowerCase(),Ge==="select"||Ge==="input"&&Fe.type==="file")var Je=g4;else if(Ny(Fe))if(wy)Je=N4;else{Je=v4;var it=y4}else(Ge=Fe.nodeName)&&Ge.toLowerCase()==="input"&&(Fe.type==="checkbox"||Fe.type==="radio")&&(Je=b4);if(Je&&(Je=Je(i,ke))){jy(Le,Je,x,Ae);break e}it&&it(i,Fe,ke),i==="focusout"&&(it=Fe._wrapperState)&&it.controlled&&Fe.type==="number"&&wn(Fe,"number",Fe.value)}switch(it=ke?Fo(ke):window,i){case"focusin":(Ny(it)||it.contentEditable==="true")&&(So=it,Sx=ke,ed=null);break;case"focusout":ed=Sx=So=null;break;case"mousedown":_x=!0;break;case"contextmenu":case"mouseup":case"dragend":_x=!1,Fy(Le,x,Ae);break;case"selectionchange":if(k4)break;case"keydown":case"keyup":Fy(Le,x,Ae)}var lt;if(wx)e:{switch(i){case"compositionstart":var ht="onCompositionStart";break e;case"compositionend":ht="onCompositionEnd";break e;case"compositionupdate":ht="onCompositionUpdate";break e}ht=void 0}else Co?vy(i,x)&&(ht="onCompositionEnd"):i==="keydown"&&x.keyCode===229&&(ht="onCompositionStart");ht&&(py&&x.locale!=="ko"&&(Co||ht!=="onCompositionStart"?ht==="onCompositionEnd"&&Co&&(lt=uy()):(bi=Ae,gx="value"in bi?bi.value:bi.textContent,Co=!0)),it=Xu(ke,ht),0<it.length&&(ht=new my(ht,i,null,x,Ae),Le.push({event:ht,listeners:it}),lt?ht.data=lt:(lt=by(x),lt!==null&&(ht.data=lt)))),(lt=h4?x4(i,x):m4(i,x))&&(ke=Xu(ke,"onBeforeInput"),0<ke.length&&(Ae=new my("onBeforeInput","beforeinput",null,x,Ae),Le.push({event:Ae,listeners:ke}),Ae.data=lt))}Hy(Le,c)})}function ad(i,c,x){return{instance:i,listener:c,currentTarget:x}}function Xu(i,c){for(var x=c+"Capture",v=[];i!==null;){var w=i,D=w.stateNode;w.tag===5&&D!==null&&(w=D,D=ml(i,x),D!=null&&v.unshift(ad(i,D,w)),D=ml(i,c),D!=null&&v.push(ad(i,D,w))),i=i.return}return v}function Eo(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function Uy(i,c,x,v,w){for(var D=c._reactName,B=[];x!==null&&x!==v;){var ie=x,ue=ie.alternate,ke=ie.stateNode;if(ue!==null&&ue===v)break;ie.tag===5&&ke!==null&&(ie=ke,w?(ue=ml(x,D),ue!=null&&B.unshift(ad(x,ue,ie))):w||(ue=ml(x,D),ue!=null&&B.push(ad(x,ue,ie)))),x=x.return}B.length!==0&&i.push({event:c,listeners:B})}var _4=/\r\n?/g,E4=/\u0000|\uFFFD/g;function Ky(i){return(typeof i=="string"?i:""+i).replace(_4,`
`).replace(E4,"")}function Qu(i,c,x){if(c=Ky(c),Ky(i)!==c&&x)throw Error(a(425))}function Yu(){}var Lx=null,Ox=null;function Ix(i,c){return i==="textarea"||i==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Mx=typeof setTimeout=="function"?setTimeout:void 0,D4=typeof clearTimeout=="function"?clearTimeout:void 0,zy=typeof Promise=="function"?Promise:void 0,F4=typeof queueMicrotask=="function"?queueMicrotask:typeof zy<"u"?function(i){return zy.resolve(null).then(i).catch(A4)}:Mx;function A4(i){setTimeout(function(){throw i})}function Rx(i,c){var x=c,v=0;do{var w=x.nextSibling;if(i.removeChild(x),w&&w.nodeType===8)if(x=w.data,x==="/$"){if(v===0){i.removeChild(w),qc(c);return}v--}else x!=="$"&&x!=="$?"&&x!=="$!"||v++;x=w}while(x);qc(c)}function ji(i){for(;i!=null;i=i.nextSibling){var c=i.nodeType;if(c===1||c===3)break;if(c===8){if(c=i.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return i}function $y(i){i=i.previousSibling;for(var c=0;i;){if(i.nodeType===8){var x=i.data;if(x==="$"||x==="$!"||x==="$?"){if(c===0)return i;c--}else x==="/$"&&c++}i=i.previousSibling}return null}var Do=Math.random().toString(36).slice(2),ss="__reactFiber$"+Do,rd="__reactProps$"+Do,Ps="__reactContainer$"+Do,Bx="__reactEvents$"+Do,P4="__reactListeners$"+Do,L4="__reactHandles$"+Do;function gl(i){var c=i[ss];if(c)return c;for(var x=i.parentNode;x;){if(c=x[Ps]||x[ss]){if(x=c.alternate,c.child!==null||x!==null&&x.child!==null)for(i=$y(i);i!==null;){if(x=i[ss])return x;i=$y(i)}return c}i=x,x=i.parentNode}return null}function sd(i){return i=i[ss]||i[Ps],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Fo(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(a(33))}function Ju(i){return i[rd]||null}var Hx=[],Ao=-1;function wi(i){return{current:i}}function rn(i){0>Ao||(i.current=Hx[Ao],Hx[Ao]=null,Ao--)}function tn(i,c){Ao++,Hx[Ao]=i.current,i.current=c}var ki={},ha=wi(ki),Ba=wi(!1),yl=ki;function Po(i,c){var x=i.type.contextTypes;if(!x)return ki;var v=i.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===c)return v.__reactInternalMemoizedMaskedChildContext;var w={},D;for(D in x)w[D]=c[D];return v&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=c,i.__reactInternalMemoizedMaskedChildContext=w),w}function Ha(i){return i=i.childContextTypes,i!=null}function Zu(){rn(Ba),rn(ha)}function Gy(i,c,x){if(ha.current!==ki)throw Error(a(168));tn(ha,c),tn(Ba,x)}function qy(i,c,x){var v=i.stateNode;if(c=c.childContextTypes,typeof v.getChildContext!="function")return x;v=v.getChildContext();for(var w in v)if(!(w in c))throw Error(a(108,pe(i)||"Unknown",w));return he({},x,v)}function eh(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||ki,yl=ha.current,tn(ha,i),tn(Ba,Ba.current),!0}function Wy(i,c,x){var v=i.stateNode;if(!v)throw Error(a(169));x?(i=qy(i,c,yl),v.__reactInternalMemoizedMergedChildContext=i,rn(Ba),rn(ha),tn(ha,i)):rn(Ba),tn(Ba,x)}var Ls=null,th=!1,Vx=!1;function Xy(i){Ls===null?Ls=[i]:Ls.push(i)}function O4(i){th=!0,Xy(i)}function Ti(){if(!Vx&&Ls!==null){Vx=!0;var i=0,c=Ut;try{var x=Ls;for(Ut=1;i<x.length;i++){var v=x[i];do v=v(!0);while(v!==null)}Ls=null,th=!1}catch(w){throw Ls!==null&&(Ls=Ls.slice(i+1)),Pe(Qt,Ti),w}finally{Ut=c,Vx=!1}}return null}var Lo=[],Oo=0,nh=null,ah=0,mr=[],fr=0,vl=null,Os=1,Is="";function bl(i,c){Lo[Oo++]=ah,Lo[Oo++]=nh,nh=i,ah=c}function Qy(i,c,x){mr[fr++]=Os,mr[fr++]=Is,mr[fr++]=vl,vl=i;var v=Os;i=Is;var w=32-Cn(v)-1;v&=~(1<<w),x+=1;var D=32-Cn(c)+w;if(30<D){var B=w-w%5;D=(v&(1<<B)-1).toString(32),v>>=B,w-=B,Os=1<<32-Cn(c)+w|x<<w|v,Is=D+i}else Os=1<<D|x<<w|v,Is=i}function Ux(i){i.return!==null&&(bl(i,1),Qy(i,1,0))}function Kx(i){for(;i===nh;)nh=Lo[--Oo],Lo[Oo]=null,ah=Lo[--Oo],Lo[Oo]=null;for(;i===vl;)vl=mr[--fr],mr[fr]=null,Is=mr[--fr],mr[fr]=null,Os=mr[--fr],mr[fr]=null}var ar=null,rr=null,un=!1,Ur=null;function Yy(i,c){var x=vr(5,null,null,0);x.elementType="DELETED",x.stateNode=c,x.return=i,c=i.deletions,c===null?(i.deletions=[x],i.flags|=16):c.push(x)}function Jy(i,c){switch(i.tag){case 5:var x=i.type;return c=c.nodeType!==1||x.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(i.stateNode=c,ar=i,rr=ji(c.firstChild),!0):!1;case 6:return c=i.pendingProps===""||c.nodeType!==3?null:c,c!==null?(i.stateNode=c,ar=i,rr=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(x=vl!==null?{id:Os,overflow:Is}:null,i.memoizedState={dehydrated:c,treeContext:x,retryLane:1073741824},x=vr(18,null,null,0),x.stateNode=c,x.return=i,i.child=x,ar=i,rr=null,!0):!1;default:return!1}}function zx(i){return(i.mode&1)!==0&&(i.flags&128)===0}function $x(i){if(un){var c=rr;if(c){var x=c;if(!Jy(i,c)){if(zx(i))throw Error(a(418));c=ji(x.nextSibling);var v=ar;c&&Jy(i,c)?Yy(v,x):(i.flags=i.flags&-4097|2,un=!1,ar=i)}}else{if(zx(i))throw Error(a(418));i.flags=i.flags&-4097|2,un=!1,ar=i}}}function Zy(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;ar=i}function rh(i){if(i!==ar)return!1;if(!un)return Zy(i),un=!0,!1;var c;if((c=i.tag!==3)&&!(c=i.tag!==5)&&(c=i.type,c=c!=="head"&&c!=="body"&&!Ix(i.type,i.memoizedProps)),c&&(c=rr)){if(zx(i))throw ev(),Error(a(418));for(;c;)Yy(i,c),c=ji(c.nextSibling)}if(Zy(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));e:{for(i=i.nextSibling,c=0;i;){if(i.nodeType===8){var x=i.data;if(x==="/$"){if(c===0){rr=ji(i.nextSibling);break e}c--}else x!=="$"&&x!=="$!"&&x!=="$?"||c++}i=i.nextSibling}rr=null}}else rr=ar?ji(i.stateNode.nextSibling):null;return!0}function ev(){for(var i=rr;i;)i=ji(i.nextSibling)}function Io(){rr=ar=null,un=!1}function Gx(i){Ur===null?Ur=[i]:Ur.push(i)}var I4=k.ReactCurrentBatchConfig;function id(i,c,x){if(i=x.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(x._owner){if(x=x._owner,x){if(x.tag!==1)throw Error(a(309));var v=x.stateNode}if(!v)throw Error(a(147,i));var w=v,D=""+i;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===D?c.ref:(c=function(B){var ie=w.refs;B===null?delete ie[D]:ie[D]=B},c._stringRef=D,c)}if(typeof i!="string")throw Error(a(284));if(!x._owner)throw Error(a(290,i))}return i}function sh(i,c){throw i=Object.prototype.toString.call(c),Error(a(31,i==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":i))}function tv(i){var c=i._init;return c(i._payload)}function nv(i){function c(ge,xe){if(i){var ye=ge.deletions;ye===null?(ge.deletions=[xe],ge.flags|=16):ye.push(xe)}}function x(ge,xe){if(!i)return null;for(;xe!==null;)c(ge,xe),xe=xe.sibling;return null}function v(ge,xe){for(ge=new Map;xe!==null;)xe.key!==null?ge.set(xe.key,xe):ge.set(xe.index,xe),xe=xe.sibling;return ge}function w(ge,xe){return ge=Pi(ge,xe),ge.index=0,ge.sibling=null,ge}function D(ge,xe,ye){return ge.index=ye,i?(ye=ge.alternate,ye!==null?(ye=ye.index,ye<xe?(ge.flags|=2,xe):ye):(ge.flags|=2,xe)):(ge.flags|=1048576,xe)}function B(ge){return i&&ge.alternate===null&&(ge.flags|=2),ge}function ie(ge,xe,ye,Re){return xe===null||xe.tag!==6?(xe=Mm(ye,ge.mode,Re),xe.return=ge,xe):(xe=w(xe,ye),xe.return=ge,xe)}function ue(ge,xe,ye,Re){var Je=ye.type;return Je===j?Ae(ge,xe,ye.props.children,Re,ye.key):xe!==null&&(xe.elementType===Je||typeof Je=="object"&&Je!==null&&Je.$$typeof===fe&&tv(Je)===xe.type)?(Re=w(xe,ye.props),Re.ref=id(ge,xe,ye),Re.return=ge,Re):(Re=Eh(ye.type,ye.key,ye.props,null,ge.mode,Re),Re.ref=id(ge,xe,ye),Re.return=ge,Re)}function ke(ge,xe,ye,Re){return xe===null||xe.tag!==4||xe.stateNode.containerInfo!==ye.containerInfo||xe.stateNode.implementation!==ye.implementation?(xe=Rm(ye,ge.mode,Re),xe.return=ge,xe):(xe=w(xe,ye.children||[]),xe.return=ge,xe)}function Ae(ge,xe,ye,Re,Je){return xe===null||xe.tag!==7?(xe=_l(ye,ge.mode,Re,Je),xe.return=ge,xe):(xe=w(xe,ye),xe.return=ge,xe)}function Le(ge,xe,ye){if(typeof xe=="string"&&xe!==""||typeof xe=="number")return xe=Mm(""+xe,ge.mode,ye),xe.return=ge,xe;if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case _:return ye=Eh(xe.type,xe.key,xe.props,null,ge.mode,ye),ye.ref=id(ge,null,xe),ye.return=ge,ye;case P:return xe=Rm(xe,ge.mode,ye),xe.return=ge,xe;case fe:var Re=xe._init;return Le(ge,Re(xe._payload),ye)}if(kn(xe)||G(xe))return xe=_l(xe,ge.mode,ye,null),xe.return=ge,xe;sh(ge,xe)}return null}function Fe(ge,xe,ye,Re){var Je=xe!==null?xe.key:null;if(typeof ye=="string"&&ye!==""||typeof ye=="number")return Je!==null?null:ie(ge,xe,""+ye,Re);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case _:return ye.key===Je?ue(ge,xe,ye,Re):null;case P:return ye.key===Je?ke(ge,xe,ye,Re):null;case fe:return Je=ye._init,Fe(ge,xe,Je(ye._payload),Re)}if(kn(ye)||G(ye))return Je!==null?null:Ae(ge,xe,ye,Re,null);sh(ge,ye)}return null}function Ge(ge,xe,ye,Re,Je){if(typeof Re=="string"&&Re!==""||typeof Re=="number")return ge=ge.get(ye)||null,ie(xe,ge,""+Re,Je);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case _:return ge=ge.get(Re.key===null?ye:Re.key)||null,ue(xe,ge,Re,Je);case P:return ge=ge.get(Re.key===null?ye:Re.key)||null,ke(xe,ge,Re,Je);case fe:var it=Re._init;return Ge(ge,xe,ye,it(Re._payload),Je)}if(kn(Re)||G(Re))return ge=ge.get(ye)||null,Ae(xe,ge,Re,Je,null);sh(xe,Re)}return null}function Xe(ge,xe,ye,Re){for(var Je=null,it=null,lt=xe,ht=xe=0,Qn=null;lt!==null&&ht<ye.length;ht++){lt.index>ht?(Qn=lt,lt=null):Qn=lt.sibling;var At=Fe(ge,lt,ye[ht],Re);if(At===null){lt===null&&(lt=Qn);break}i&&lt&&At.alternate===null&&c(ge,lt),xe=D(At,xe,ht),it===null?Je=At:it.sibling=At,it=At,lt=Qn}if(ht===ye.length)return x(ge,lt),un&&bl(ge,ht),Je;if(lt===null){for(;ht<ye.length;ht++)lt=Le(ge,ye[ht],Re),lt!==null&&(xe=D(lt,xe,ht),it===null?Je=lt:it.sibling=lt,it=lt);return un&&bl(ge,ht),Je}for(lt=v(ge,lt);ht<ye.length;ht++)Qn=Ge(lt,ge,ht,ye[ht],Re),Qn!==null&&(i&&Qn.alternate!==null&&lt.delete(Qn.key===null?ht:Qn.key),xe=D(Qn,xe,ht),it===null?Je=Qn:it.sibling=Qn,it=Qn);return i&&lt.forEach(function(Li){return c(ge,Li)}),un&&bl(ge,ht),Je}function Qe(ge,xe,ye,Re){var Je=G(ye);if(typeof Je!="function")throw Error(a(150));if(ye=Je.call(ye),ye==null)throw Error(a(151));for(var it=Je=null,lt=xe,ht=xe=0,Qn=null,At=ye.next();lt!==null&&!At.done;ht++,At=ye.next()){lt.index>ht?(Qn=lt,lt=null):Qn=lt.sibling;var Li=Fe(ge,lt,At.value,Re);if(Li===null){lt===null&&(lt=Qn);break}i&&lt&&Li.alternate===null&&c(ge,lt),xe=D(Li,xe,ht),it===null?Je=Li:it.sibling=Li,it=Li,lt=Qn}if(At.done)return x(ge,lt),un&&bl(ge,ht),Je;if(lt===null){for(;!At.done;ht++,At=ye.next())At=Le(ge,At.value,Re),At!==null&&(xe=D(At,xe,ht),it===null?Je=At:it.sibling=At,it=At);return un&&bl(ge,ht),Je}for(lt=v(ge,lt);!At.done;ht++,At=ye.next())At=Ge(lt,ge,ht,At.value,Re),At!==null&&(i&&At.alternate!==null&&lt.delete(At.key===null?ht:At.key),xe=D(At,xe,ht),it===null?Je=At:it.sibling=At,it=At);return i&&lt.forEach(function(fC){return c(ge,fC)}),un&&bl(ge,ht),Je}function Sn(ge,xe,ye,Re){if(typeof ye=="object"&&ye!==null&&ye.type===j&&ye.key===null&&(ye=ye.props.children),typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case _:e:{for(var Je=ye.key,it=xe;it!==null;){if(it.key===Je){if(Je=ye.type,Je===j){if(it.tag===7){x(ge,it.sibling),xe=w(it,ye.props.children),xe.return=ge,ge=xe;break e}}else if(it.elementType===Je||typeof Je=="object"&&Je!==null&&Je.$$typeof===fe&&tv(Je)===it.type){x(ge,it.sibling),xe=w(it,ye.props),xe.ref=id(ge,it,ye),xe.return=ge,ge=xe;break e}x(ge,it);break}else c(ge,it);it=it.sibling}ye.type===j?(xe=_l(ye.props.children,ge.mode,Re,ye.key),xe.return=ge,ge=xe):(Re=Eh(ye.type,ye.key,ye.props,null,ge.mode,Re),Re.ref=id(ge,xe,ye),Re.return=ge,ge=Re)}return B(ge);case P:e:{for(it=ye.key;xe!==null;){if(xe.key===it)if(xe.tag===4&&xe.stateNode.containerInfo===ye.containerInfo&&xe.stateNode.implementation===ye.implementation){x(ge,xe.sibling),xe=w(xe,ye.children||[]),xe.return=ge,ge=xe;break e}else{x(ge,xe);break}else c(ge,xe);xe=xe.sibling}xe=Rm(ye,ge.mode,Re),xe.return=ge,ge=xe}return B(ge);case fe:return it=ye._init,Sn(ge,xe,it(ye._payload),Re)}if(kn(ye))return Xe(ge,xe,ye,Re);if(G(ye))return Qe(ge,xe,ye,Re);sh(ge,ye)}return typeof ye=="string"&&ye!==""||typeof ye=="number"?(ye=""+ye,xe!==null&&xe.tag===6?(x(ge,xe.sibling),xe=w(xe,ye),xe.return=ge,ge=xe):(x(ge,xe),xe=Mm(ye,ge.mode,Re),xe.return=ge,ge=xe),B(ge)):x(ge,xe)}return Sn}var Mo=nv(!0),av=nv(!1),ih=wi(null),lh=null,Ro=null,qx=null;function Wx(){qx=Ro=lh=null}function Xx(i){var c=ih.current;rn(ih),i._currentValue=c}function Qx(i,c,x){for(;i!==null;){var v=i.alternate;if((i.childLanes&c)!==c?(i.childLanes|=c,v!==null&&(v.childLanes|=c)):v!==null&&(v.childLanes&c)!==c&&(v.childLanes|=c),i===x)break;i=i.return}}function Bo(i,c){lh=i,qx=Ro=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&c)!==0&&(Va=!0),i.firstContext=null)}function pr(i){var c=i._currentValue;if(qx!==i)if(i={context:i,memoizedValue:c,next:null},Ro===null){if(lh===null)throw Error(a(308));Ro=i,lh.dependencies={lanes:0,firstContext:i}}else Ro=Ro.next=i;return c}var Nl=null;function Yx(i){Nl===null?Nl=[i]:Nl.push(i)}function rv(i,c,x,v){var w=c.interleaved;return w===null?(x.next=x,Yx(c)):(x.next=w.next,w.next=x),c.interleaved=x,Ms(i,v)}function Ms(i,c){i.lanes|=c;var x=i.alternate;for(x!==null&&(x.lanes|=c),x=i,i=i.return;i!==null;)i.childLanes|=c,x=i.alternate,x!==null&&(x.childLanes|=c),x=i,i=i.return;return x.tag===3?x.stateNode:null}var Ci=!1;function Jx(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sv(i,c){i=i.updateQueue,c.updateQueue===i&&(c.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Rs(i,c){return{eventTime:i,lane:c,tag:0,payload:null,callback:null,next:null}}function Si(i,c,x){var v=i.updateQueue;if(v===null)return null;if(v=v.shared,(_t&2)!==0){var w=v.pending;return w===null?c.next=c:(c.next=w.next,w.next=c),v.pending=c,Ms(i,x)}return w=v.interleaved,w===null?(c.next=c,Yx(v)):(c.next=w.next,w.next=c),v.interleaved=c,Ms(i,x)}function oh(i,c,x){if(c=c.updateQueue,c!==null&&(c=c.shared,(x&4194240)!==0)){var v=c.lanes;v&=i.pendingLanes,x|=v,c.lanes=x,hx(i,x)}}function iv(i,c){var x=i.updateQueue,v=i.alternate;if(v!==null&&(v=v.updateQueue,x===v)){var w=null,D=null;if(x=x.firstBaseUpdate,x!==null){do{var B={eventTime:x.eventTime,lane:x.lane,tag:x.tag,payload:x.payload,callback:x.callback,next:null};D===null?w=D=B:D=D.next=B,x=x.next}while(x!==null);D===null?w=D=c:D=D.next=c}else w=D=c;x={baseState:v.baseState,firstBaseUpdate:w,lastBaseUpdate:D,shared:v.shared,effects:v.effects},i.updateQueue=x;return}i=x.lastBaseUpdate,i===null?x.firstBaseUpdate=c:i.next=c,x.lastBaseUpdate=c}function ch(i,c,x,v){var w=i.updateQueue;Ci=!1;var D=w.firstBaseUpdate,B=w.lastBaseUpdate,ie=w.shared.pending;if(ie!==null){w.shared.pending=null;var ue=ie,ke=ue.next;ue.next=null,B===null?D=ke:B.next=ke,B=ue;var Ae=i.alternate;Ae!==null&&(Ae=Ae.updateQueue,ie=Ae.lastBaseUpdate,ie!==B&&(ie===null?Ae.firstBaseUpdate=ke:ie.next=ke,Ae.lastBaseUpdate=ue))}if(D!==null){var Le=w.baseState;B=0,Ae=ke=ue=null,ie=D;do{var Fe=ie.lane,Ge=ie.eventTime;if((v&Fe)===Fe){Ae!==null&&(Ae=Ae.next={eventTime:Ge,lane:0,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null});e:{var Xe=i,Qe=ie;switch(Fe=c,Ge=x,Qe.tag){case 1:if(Xe=Qe.payload,typeof Xe=="function"){Le=Xe.call(Ge,Le,Fe);break e}Le=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=Qe.payload,Fe=typeof Xe=="function"?Xe.call(Ge,Le,Fe):Xe,Fe==null)break e;Le=he({},Le,Fe);break e;case 2:Ci=!0}}ie.callback!==null&&ie.lane!==0&&(i.flags|=64,Fe=w.effects,Fe===null?w.effects=[ie]:Fe.push(ie))}else Ge={eventTime:Ge,lane:Fe,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null},Ae===null?(ke=Ae=Ge,ue=Le):Ae=Ae.next=Ge,B|=Fe;if(ie=ie.next,ie===null){if(ie=w.shared.pending,ie===null)break;Fe=ie,ie=Fe.next,Fe.next=null,w.lastBaseUpdate=Fe,w.shared.pending=null}}while(!0);if(Ae===null&&(ue=Le),w.baseState=ue,w.firstBaseUpdate=ke,w.lastBaseUpdate=Ae,c=w.shared.interleaved,c!==null){w=c;do B|=w.lane,w=w.next;while(w!==c)}else D===null&&(w.shared.lanes=0);kl|=B,i.lanes=B,i.memoizedState=Le}}function lv(i,c,x){if(i=c.effects,c.effects=null,i!==null)for(c=0;c<i.length;c++){var v=i[c],w=v.callback;if(w!==null){if(v.callback=null,v=x,typeof w!="function")throw Error(a(191,w));w.call(v)}}}var ld={},is=wi(ld),od=wi(ld),cd=wi(ld);function jl(i){if(i===ld)throw Error(a(174));return i}function Zx(i,c){switch(tn(cd,c),tn(od,i),tn(is,ld),i=c.nodeType,i){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:qt(null,"");break;default:i=i===8?c.parentNode:c,c=i.namespaceURI||null,i=i.tagName,c=qt(c,i)}rn(is),tn(is,c)}function Ho(){rn(is),rn(od),rn(cd)}function ov(i){jl(cd.current);var c=jl(is.current),x=qt(c,i.type);c!==x&&(tn(od,i),tn(is,x))}function em(i){od.current===i&&(rn(is),rn(od))}var xn=wi(0);function dh(i){for(var c=i;c!==null;){if(c.tag===13){var x=c.memoizedState;if(x!==null&&(x=x.dehydrated,x===null||x.data==="$?"||x.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var tm=[];function nm(){for(var i=0;i<tm.length;i++)tm[i]._workInProgressVersionPrimary=null;tm.length=0}var uh=k.ReactCurrentDispatcher,am=k.ReactCurrentBatchConfig,wl=0,mn=null,Rn=null,Wn=null,hh=!1,dd=!1,ud=0,M4=0;function xa(){throw Error(a(321))}function rm(i,c){if(c===null)return!1;for(var x=0;x<c.length&&x<i.length;x++)if(!Vr(i[x],c[x]))return!1;return!0}function sm(i,c,x,v,w,D){if(wl=D,mn=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,uh.current=i===null||i.memoizedState===null?V4:U4,i=x(v,w),dd){D=0;do{if(dd=!1,ud=0,25<=D)throw Error(a(301));D+=1,Wn=Rn=null,c.updateQueue=null,uh.current=K4,i=x(v,w)}while(dd)}if(uh.current=fh,c=Rn!==null&&Rn.next!==null,wl=0,Wn=Rn=mn=null,hh=!1,c)throw Error(a(300));return i}function im(){var i=ud!==0;return ud=0,i}function ls(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wn===null?mn.memoizedState=Wn=i:Wn=Wn.next=i,Wn}function gr(){if(Rn===null){var i=mn.alternate;i=i!==null?i.memoizedState:null}else i=Rn.next;var c=Wn===null?mn.memoizedState:Wn.next;if(c!==null)Wn=c,Rn=i;else{if(i===null)throw Error(a(310));Rn=i,i={memoizedState:Rn.memoizedState,baseState:Rn.baseState,baseQueue:Rn.baseQueue,queue:Rn.queue,next:null},Wn===null?mn.memoizedState=Wn=i:Wn=Wn.next=i}return Wn}function hd(i,c){return typeof c=="function"?c(i):c}function lm(i){var c=gr(),x=c.queue;if(x===null)throw Error(a(311));x.lastRenderedReducer=i;var v=Rn,w=v.baseQueue,D=x.pending;if(D!==null){if(w!==null){var B=w.next;w.next=D.next,D.next=B}v.baseQueue=w=D,x.pending=null}if(w!==null){D=w.next,v=v.baseState;var ie=B=null,ue=null,ke=D;do{var Ae=ke.lane;if((wl&Ae)===Ae)ue!==null&&(ue=ue.next={lane:0,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null}),v=ke.hasEagerState?ke.eagerState:i(v,ke.action);else{var Le={lane:Ae,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null};ue===null?(ie=ue=Le,B=v):ue=ue.next=Le,mn.lanes|=Ae,kl|=Ae}ke=ke.next}while(ke!==null&&ke!==D);ue===null?B=v:ue.next=ie,Vr(v,c.memoizedState)||(Va=!0),c.memoizedState=v,c.baseState=B,c.baseQueue=ue,x.lastRenderedState=v}if(i=x.interleaved,i!==null){w=i;do D=w.lane,mn.lanes|=D,kl|=D,w=w.next;while(w!==i)}else w===null&&(x.lanes=0);return[c.memoizedState,x.dispatch]}function om(i){var c=gr(),x=c.queue;if(x===null)throw Error(a(311));x.lastRenderedReducer=i;var v=x.dispatch,w=x.pending,D=c.memoizedState;if(w!==null){x.pending=null;var B=w=w.next;do D=i(D,B.action),B=B.next;while(B!==w);Vr(D,c.memoizedState)||(Va=!0),c.memoizedState=D,c.baseQueue===null&&(c.baseState=D),x.lastRenderedState=D}return[D,v]}function cv(){}function dv(i,c){var x=mn,v=gr(),w=c(),D=!Vr(v.memoizedState,w);if(D&&(v.memoizedState=w,Va=!0),v=v.queue,cm(xv.bind(null,x,v,i),[i]),v.getSnapshot!==c||D||Wn!==null&&Wn.memoizedState.tag&1){if(x.flags|=2048,xd(9,hv.bind(null,x,v,w,c),void 0,null),Xn===null)throw Error(a(349));(wl&30)!==0||uv(x,c,w)}return w}function uv(i,c,x){i.flags|=16384,i={getSnapshot:c,value:x},c=mn.updateQueue,c===null?(c={lastEffect:null,stores:null},mn.updateQueue=c,c.stores=[i]):(x=c.stores,x===null?c.stores=[i]:x.push(i))}function hv(i,c,x,v){c.value=x,c.getSnapshot=v,mv(c)&&fv(i)}function xv(i,c,x){return x(function(){mv(c)&&fv(i)})}function mv(i){var c=i.getSnapshot;i=i.value;try{var x=c();return!Vr(i,x)}catch{return!0}}function fv(i){var c=Ms(i,1);c!==null&&Gr(c,i,1,-1)}function pv(i){var c=ls();return typeof i=="function"&&(i=i()),c.memoizedState=c.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hd,lastRenderedState:i},c.queue=i,i=i.dispatch=H4.bind(null,mn,i),[c.memoizedState,i]}function xd(i,c,x,v){return i={tag:i,create:c,destroy:x,deps:v,next:null},c=mn.updateQueue,c===null?(c={lastEffect:null,stores:null},mn.updateQueue=c,c.lastEffect=i.next=i):(x=c.lastEffect,x===null?c.lastEffect=i.next=i:(v=x.next,x.next=i,i.next=v,c.lastEffect=i)),i}function gv(){return gr().memoizedState}function xh(i,c,x,v){var w=ls();mn.flags|=i,w.memoizedState=xd(1|c,x,void 0,v===void 0?null:v)}function mh(i,c,x,v){var w=gr();v=v===void 0?null:v;var D=void 0;if(Rn!==null){var B=Rn.memoizedState;if(D=B.destroy,v!==null&&rm(v,B.deps)){w.memoizedState=xd(c,x,D,v);return}}mn.flags|=i,w.memoizedState=xd(1|c,x,D,v)}function yv(i,c){return xh(8390656,8,i,c)}function cm(i,c){return mh(2048,8,i,c)}function vv(i,c){return mh(4,2,i,c)}function bv(i,c){return mh(4,4,i,c)}function Nv(i,c){if(typeof c=="function")return i=i(),c(i),function(){c(null)};if(c!=null)return i=i(),c.current=i,function(){c.current=null}}function jv(i,c,x){return x=x!=null?x.concat([i]):null,mh(4,4,Nv.bind(null,c,i),x)}function dm(){}function wv(i,c){var x=gr();c=c===void 0?null:c;var v=x.memoizedState;return v!==null&&c!==null&&rm(c,v[1])?v[0]:(x.memoizedState=[i,c],i)}function kv(i,c){var x=gr();c=c===void 0?null:c;var v=x.memoizedState;return v!==null&&c!==null&&rm(c,v[1])?v[0]:(i=i(),x.memoizedState=[i,c],i)}function Tv(i,c,x){return(wl&21)===0?(i.baseState&&(i.baseState=!1,Va=!0),i.memoizedState=x):(Vr(x,c)||(x=ty(),mn.lanes|=x,kl|=x,i.baseState=!0),c)}function R4(i,c){var x=Ut;Ut=x!==0&&4>x?x:4,i(!0);var v=am.transition;am.transition={};try{i(!1),c()}finally{Ut=x,am.transition=v}}function Cv(){return gr().memoizedState}function B4(i,c,x){var v=Fi(i);if(x={lane:v,action:x,hasEagerState:!1,eagerState:null,next:null},Sv(i))_v(c,x);else if(x=rv(i,c,x,v),x!==null){var w=_a();Gr(x,i,v,w),Ev(x,c,v)}}function H4(i,c,x){var v=Fi(i),w={lane:v,action:x,hasEagerState:!1,eagerState:null,next:null};if(Sv(i))_v(c,w);else{var D=i.alternate;if(i.lanes===0&&(D===null||D.lanes===0)&&(D=c.lastRenderedReducer,D!==null))try{var B=c.lastRenderedState,ie=D(B,x);if(w.hasEagerState=!0,w.eagerState=ie,Vr(ie,B)){var ue=c.interleaved;ue===null?(w.next=w,Yx(c)):(w.next=ue.next,ue.next=w),c.interleaved=w;return}}catch{}finally{}x=rv(i,c,w,v),x!==null&&(w=_a(),Gr(x,i,v,w),Ev(x,c,v))}}function Sv(i){var c=i.alternate;return i===mn||c!==null&&c===mn}function _v(i,c){dd=hh=!0;var x=i.pending;x===null?c.next=c:(c.next=x.next,x.next=c),i.pending=c}function Ev(i,c,x){if((x&4194240)!==0){var v=c.lanes;v&=i.pendingLanes,x|=v,c.lanes=x,hx(i,x)}}var fh={readContext:pr,useCallback:xa,useContext:xa,useEffect:xa,useImperativeHandle:xa,useInsertionEffect:xa,useLayoutEffect:xa,useMemo:xa,useReducer:xa,useRef:xa,useState:xa,useDebugValue:xa,useDeferredValue:xa,useTransition:xa,useMutableSource:xa,useSyncExternalStore:xa,useId:xa,unstable_isNewReconciler:!1},V4={readContext:pr,useCallback:function(i,c){return ls().memoizedState=[i,c===void 0?null:c],i},useContext:pr,useEffect:yv,useImperativeHandle:function(i,c,x){return x=x!=null?x.concat([i]):null,xh(4194308,4,Nv.bind(null,c,i),x)},useLayoutEffect:function(i,c){return xh(4194308,4,i,c)},useInsertionEffect:function(i,c){return xh(4,2,i,c)},useMemo:function(i,c){var x=ls();return c=c===void 0?null:c,i=i(),x.memoizedState=[i,c],i},useReducer:function(i,c,x){var v=ls();return c=x!==void 0?x(c):c,v.memoizedState=v.baseState=c,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:c},v.queue=i,i=i.dispatch=B4.bind(null,mn,i),[v.memoizedState,i]},useRef:function(i){var c=ls();return i={current:i},c.memoizedState=i},useState:pv,useDebugValue:dm,useDeferredValue:function(i){return ls().memoizedState=i},useTransition:function(){var i=pv(!1),c=i[0];return i=R4.bind(null,i[1]),ls().memoizedState=i,[c,i]},useMutableSource:function(){},useSyncExternalStore:function(i,c,x){var v=mn,w=ls();if(un){if(x===void 0)throw Error(a(407));x=x()}else{if(x=c(),Xn===null)throw Error(a(349));(wl&30)!==0||uv(v,c,x)}w.memoizedState=x;var D={value:x,getSnapshot:c};return w.queue=D,yv(xv.bind(null,v,D,i),[i]),v.flags|=2048,xd(9,hv.bind(null,v,D,x,c),void 0,null),x},useId:function(){var i=ls(),c=Xn.identifierPrefix;if(un){var x=Is,v=Os;x=(v&~(1<<32-Cn(v)-1)).toString(32)+x,c=":"+c+"R"+x,x=ud++,0<x&&(c+="H"+x.toString(32)),c+=":"}else x=M4++,c=":"+c+"r"+x.toString(32)+":";return i.memoizedState=c},unstable_isNewReconciler:!1},U4={readContext:pr,useCallback:wv,useContext:pr,useEffect:cm,useImperativeHandle:jv,useInsertionEffect:vv,useLayoutEffect:bv,useMemo:kv,useReducer:lm,useRef:gv,useState:function(){return lm(hd)},useDebugValue:dm,useDeferredValue:function(i){var c=gr();return Tv(c,Rn.memoizedState,i)},useTransition:function(){var i=lm(hd)[0],c=gr().memoizedState;return[i,c]},useMutableSource:cv,useSyncExternalStore:dv,useId:Cv,unstable_isNewReconciler:!1},K4={readContext:pr,useCallback:wv,useContext:pr,useEffect:cm,useImperativeHandle:jv,useInsertionEffect:vv,useLayoutEffect:bv,useMemo:kv,useReducer:om,useRef:gv,useState:function(){return om(hd)},useDebugValue:dm,useDeferredValue:function(i){var c=gr();return Rn===null?c.memoizedState=i:Tv(c,Rn.memoizedState,i)},useTransition:function(){var i=om(hd)[0],c=gr().memoizedState;return[i,c]},useMutableSource:cv,useSyncExternalStore:dv,useId:Cv,unstable_isNewReconciler:!1};function Kr(i,c){if(i&&i.defaultProps){c=he({},c),i=i.defaultProps;for(var x in i)c[x]===void 0&&(c[x]=i[x]);return c}return c}function um(i,c,x,v){c=i.memoizedState,x=x(v,c),x=x==null?c:he({},c,x),i.memoizedState=x,i.lanes===0&&(i.updateQueue.baseState=x)}var ph={isMounted:function(i){return(i=i._reactInternals)?se(i)===i:!1},enqueueSetState:function(i,c,x){i=i._reactInternals;var v=_a(),w=Fi(i),D=Rs(v,w);D.payload=c,x!=null&&(D.callback=x),c=Si(i,D,w),c!==null&&(Gr(c,i,w,v),oh(c,i,w))},enqueueReplaceState:function(i,c,x){i=i._reactInternals;var v=_a(),w=Fi(i),D=Rs(v,w);D.tag=1,D.payload=c,x!=null&&(D.callback=x),c=Si(i,D,w),c!==null&&(Gr(c,i,w,v),oh(c,i,w))},enqueueForceUpdate:function(i,c){i=i._reactInternals;var x=_a(),v=Fi(i),w=Rs(x,v);w.tag=2,c!=null&&(w.callback=c),c=Si(i,w,v),c!==null&&(Gr(c,i,v,x),oh(c,i,v))}};function Dv(i,c,x,v,w,D,B){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(v,D,B):c.prototype&&c.prototype.isPureReactComponent?!Zc(x,v)||!Zc(w,D):!0}function Fv(i,c,x){var v=!1,w=ki,D=c.contextType;return typeof D=="object"&&D!==null?D=pr(D):(w=Ha(c)?yl:ha.current,v=c.contextTypes,D=(v=v!=null)?Po(i,w):ki),c=new c(x,D),i.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=ph,i.stateNode=c,c._reactInternals=i,v&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=w,i.__reactInternalMemoizedMaskedChildContext=D),c}function Av(i,c,x,v){i=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(x,v),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(x,v),c.state!==i&&ph.enqueueReplaceState(c,c.state,null)}function hm(i,c,x,v){var w=i.stateNode;w.props=x,w.state=i.memoizedState,w.refs={},Jx(i);var D=c.contextType;typeof D=="object"&&D!==null?w.context=pr(D):(D=Ha(c)?yl:ha.current,w.context=Po(i,D)),w.state=i.memoizedState,D=c.getDerivedStateFromProps,typeof D=="function"&&(um(i,c,D,x),w.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(c=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),c!==w.state&&ph.enqueueReplaceState(w,w.state,null),ch(i,x,w,v),w.state=i.memoizedState),typeof w.componentDidMount=="function"&&(i.flags|=4194308)}function Vo(i,c){try{var x="",v=c;do x+=V(v),v=v.return;while(v);var w=x}catch(D){w=`
Error generating stack: `+D.message+`
`+D.stack}return{value:i,source:c,stack:w,digest:null}}function xm(i,c,x){return{value:i,source:null,stack:x??null,digest:c??null}}function mm(i,c){try{console.error(c.value)}catch(x){setTimeout(function(){throw x})}}var z4=typeof WeakMap=="function"?WeakMap:Map;function Pv(i,c,x){x=Rs(-1,x),x.tag=3,x.payload={element:null};var v=c.value;return x.callback=function(){wh||(wh=!0,Em=v),mm(i,c)},x}function Lv(i,c,x){x=Rs(-1,x),x.tag=3;var v=i.type.getDerivedStateFromError;if(typeof v=="function"){var w=c.value;x.payload=function(){return v(w)},x.callback=function(){mm(i,c)}}var D=i.stateNode;return D!==null&&typeof D.componentDidCatch=="function"&&(x.callback=function(){mm(i,c),typeof v!="function"&&(Ei===null?Ei=new Set([this]):Ei.add(this));var B=c.stack;this.componentDidCatch(c.value,{componentStack:B!==null?B:""})}),x}function Ov(i,c,x){var v=i.pingCache;if(v===null){v=i.pingCache=new z4;var w=new Set;v.set(c,w)}else w=v.get(c),w===void 0&&(w=new Set,v.set(c,w));w.has(x)||(w.add(x),i=rC.bind(null,i,c,x),c.then(i,i))}function Iv(i){do{var c;if((c=i.tag===13)&&(c=i.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return i;i=i.return}while(i!==null);return null}function Mv(i,c,x,v,w){return(i.mode&1)===0?(i===c?i.flags|=65536:(i.flags|=128,x.flags|=131072,x.flags&=-52805,x.tag===1&&(x.alternate===null?x.tag=17:(c=Rs(-1,1),c.tag=2,Si(x,c,1))),x.lanes|=1),i):(i.flags|=65536,i.lanes=w,i)}var $4=k.ReactCurrentOwner,Va=!1;function Sa(i,c,x,v){c.child=i===null?av(c,null,x,v):Mo(c,i.child,x,v)}function Rv(i,c,x,v,w){x=x.render;var D=c.ref;return Bo(c,w),v=sm(i,c,x,v,D,w),x=im(),i!==null&&!Va?(c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~w,Bs(i,c,w)):(un&&x&&Ux(c),c.flags|=1,Sa(i,c,v,w),c.child)}function Bv(i,c,x,v,w){if(i===null){var D=x.type;return typeof D=="function"&&!Im(D)&&D.defaultProps===void 0&&x.compare===null&&x.defaultProps===void 0?(c.tag=15,c.type=D,Hv(i,c,D,v,w)):(i=Eh(x.type,null,v,c,c.mode,w),i.ref=c.ref,i.return=c,c.child=i)}if(D=i.child,(i.lanes&w)===0){var B=D.memoizedProps;if(x=x.compare,x=x!==null?x:Zc,x(B,v)&&i.ref===c.ref)return Bs(i,c,w)}return c.flags|=1,i=Pi(D,v),i.ref=c.ref,i.return=c,c.child=i}function Hv(i,c,x,v,w){if(i!==null){var D=i.memoizedProps;if(Zc(D,v)&&i.ref===c.ref)if(Va=!1,c.pendingProps=v=D,(i.lanes&w)!==0)(i.flags&131072)!==0&&(Va=!0);else return c.lanes=i.lanes,Bs(i,c,w)}return fm(i,c,x,v,w)}function Vv(i,c,x){var v=c.pendingProps,w=v.children,D=i!==null?i.memoizedState:null;if(v.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},tn(Ko,sr),sr|=x;else{if((x&1073741824)===0)return i=D!==null?D.baseLanes|x:x,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:i,cachePool:null,transitions:null},c.updateQueue=null,tn(Ko,sr),sr|=i,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=D!==null?D.baseLanes:x,tn(Ko,sr),sr|=v}else D!==null?(v=D.baseLanes|x,c.memoizedState=null):v=x,tn(Ko,sr),sr|=v;return Sa(i,c,w,x),c.child}function Uv(i,c){var x=c.ref;(i===null&&x!==null||i!==null&&i.ref!==x)&&(c.flags|=512,c.flags|=2097152)}function fm(i,c,x,v,w){var D=Ha(x)?yl:ha.current;return D=Po(c,D),Bo(c,w),x=sm(i,c,x,v,D,w),v=im(),i!==null&&!Va?(c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~w,Bs(i,c,w)):(un&&v&&Ux(c),c.flags|=1,Sa(i,c,x,w),c.child)}function Kv(i,c,x,v,w){if(Ha(x)){var D=!0;eh(c)}else D=!1;if(Bo(c,w),c.stateNode===null)yh(i,c),Fv(c,x,v),hm(c,x,v,w),v=!0;else if(i===null){var B=c.stateNode,ie=c.memoizedProps;B.props=ie;var ue=B.context,ke=x.contextType;typeof ke=="object"&&ke!==null?ke=pr(ke):(ke=Ha(x)?yl:ha.current,ke=Po(c,ke));var Ae=x.getDerivedStateFromProps,Le=typeof Ae=="function"||typeof B.getSnapshotBeforeUpdate=="function";Le||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(ie!==v||ue!==ke)&&Av(c,B,v,ke),Ci=!1;var Fe=c.memoizedState;B.state=Fe,ch(c,v,B,w),ue=c.memoizedState,ie!==v||Fe!==ue||Ba.current||Ci?(typeof Ae=="function"&&(um(c,x,Ae,v),ue=c.memoizedState),(ie=Ci||Dv(c,x,ie,v,Fe,ue,ke))?(Le||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(c.flags|=4194308)):(typeof B.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=v,c.memoizedState=ue),B.props=v,B.state=ue,B.context=ke,v=ie):(typeof B.componentDidMount=="function"&&(c.flags|=4194308),v=!1)}else{B=c.stateNode,sv(i,c),ie=c.memoizedProps,ke=c.type===c.elementType?ie:Kr(c.type,ie),B.props=ke,Le=c.pendingProps,Fe=B.context,ue=x.contextType,typeof ue=="object"&&ue!==null?ue=pr(ue):(ue=Ha(x)?yl:ha.current,ue=Po(c,ue));var Ge=x.getDerivedStateFromProps;(Ae=typeof Ge=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(ie!==Le||Fe!==ue)&&Av(c,B,v,ue),Ci=!1,Fe=c.memoizedState,B.state=Fe,ch(c,v,B,w);var Xe=c.memoizedState;ie!==Le||Fe!==Xe||Ba.current||Ci?(typeof Ge=="function"&&(um(c,x,Ge,v),Xe=c.memoizedState),(ke=Ci||Dv(c,x,ke,v,Fe,Xe,ue)||!1)?(Ae||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(v,Xe,ue),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(v,Xe,ue)),typeof B.componentDidUpdate=="function"&&(c.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof B.componentDidUpdate!="function"||ie===i.memoizedProps&&Fe===i.memoizedState||(c.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||ie===i.memoizedProps&&Fe===i.memoizedState||(c.flags|=1024),c.memoizedProps=v,c.memoizedState=Xe),B.props=v,B.state=Xe,B.context=ue,v=ke):(typeof B.componentDidUpdate!="function"||ie===i.memoizedProps&&Fe===i.memoizedState||(c.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||ie===i.memoizedProps&&Fe===i.memoizedState||(c.flags|=1024),v=!1)}return pm(i,c,x,v,D,w)}function pm(i,c,x,v,w,D){Uv(i,c);var B=(c.flags&128)!==0;if(!v&&!B)return w&&Wy(c,x,!1),Bs(i,c,D);v=c.stateNode,$4.current=c;var ie=B&&typeof x.getDerivedStateFromError!="function"?null:v.render();return c.flags|=1,i!==null&&B?(c.child=Mo(c,i.child,null,D),c.child=Mo(c,null,ie,D)):Sa(i,c,ie,D),c.memoizedState=v.state,w&&Wy(c,x,!0),c.child}function zv(i){var c=i.stateNode;c.pendingContext?Gy(i,c.pendingContext,c.pendingContext!==c.context):c.context&&Gy(i,c.context,!1),Zx(i,c.containerInfo)}function $v(i,c,x,v,w){return Io(),Gx(w),c.flags|=256,Sa(i,c,x,v),c.child}var gm={dehydrated:null,treeContext:null,retryLane:0};function ym(i){return{baseLanes:i,cachePool:null,transitions:null}}function Gv(i,c,x){var v=c.pendingProps,w=xn.current,D=!1,B=(c.flags&128)!==0,ie;if((ie=B)||(ie=i!==null&&i.memoizedState===null?!1:(w&2)!==0),ie?(D=!0,c.flags&=-129):(i===null||i.memoizedState!==null)&&(w|=1),tn(xn,w&1),i===null)return $x(c),i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((c.mode&1)===0?c.lanes=1:i.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(B=v.children,i=v.fallback,D?(v=c.mode,D=c.child,B={mode:"hidden",children:B},(v&1)===0&&D!==null?(D.childLanes=0,D.pendingProps=B):D=Dh(B,v,0,null),i=_l(i,v,x,null),D.return=c,i.return=c,D.sibling=i,c.child=D,c.child.memoizedState=ym(x),c.memoizedState=gm,i):vm(c,B));if(w=i.memoizedState,w!==null&&(ie=w.dehydrated,ie!==null))return G4(i,c,B,v,ie,w,x);if(D){D=v.fallback,B=c.mode,w=i.child,ie=w.sibling;var ue={mode:"hidden",children:v.children};return(B&1)===0&&c.child!==w?(v=c.child,v.childLanes=0,v.pendingProps=ue,c.deletions=null):(v=Pi(w,ue),v.subtreeFlags=w.subtreeFlags&14680064),ie!==null?D=Pi(ie,D):(D=_l(D,B,x,null),D.flags|=2),D.return=c,v.return=c,v.sibling=D,c.child=v,v=D,D=c.child,B=i.child.memoizedState,B=B===null?ym(x):{baseLanes:B.baseLanes|x,cachePool:null,transitions:B.transitions},D.memoizedState=B,D.childLanes=i.childLanes&~x,c.memoizedState=gm,v}return D=i.child,i=D.sibling,v=Pi(D,{mode:"visible",children:v.children}),(c.mode&1)===0&&(v.lanes=x),v.return=c,v.sibling=null,i!==null&&(x=c.deletions,x===null?(c.deletions=[i],c.flags|=16):x.push(i)),c.child=v,c.memoizedState=null,v}function vm(i,c){return c=Dh({mode:"visible",children:c},i.mode,0,null),c.return=i,i.child=c}function gh(i,c,x,v){return v!==null&&Gx(v),Mo(c,i.child,null,x),i=vm(c,c.pendingProps.children),i.flags|=2,c.memoizedState=null,i}function G4(i,c,x,v,w,D,B){if(x)return c.flags&256?(c.flags&=-257,v=xm(Error(a(422))),gh(i,c,B,v)):c.memoizedState!==null?(c.child=i.child,c.flags|=128,null):(D=v.fallback,w=c.mode,v=Dh({mode:"visible",children:v.children},w,0,null),D=_l(D,w,B,null),D.flags|=2,v.return=c,D.return=c,v.sibling=D,c.child=v,(c.mode&1)!==0&&Mo(c,i.child,null,B),c.child.memoizedState=ym(B),c.memoizedState=gm,D);if((c.mode&1)===0)return gh(i,c,B,null);if(w.data==="$!"){if(v=w.nextSibling&&w.nextSibling.dataset,v)var ie=v.dgst;return v=ie,D=Error(a(419)),v=xm(D,v,void 0),gh(i,c,B,v)}if(ie=(B&i.childLanes)!==0,Va||ie){if(v=Xn,v!==null){switch(B&-B){case 4:w=2;break;case 16:w=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:w=32;break;case 536870912:w=268435456;break;default:w=0}w=(w&(v.suspendedLanes|B))!==0?0:w,w!==0&&w!==D.retryLane&&(D.retryLane=w,Ms(i,w),Gr(v,i,w,-1))}return Om(),v=xm(Error(a(421))),gh(i,c,B,v)}return w.data==="$?"?(c.flags|=128,c.child=i.child,c=sC.bind(null,i),w._reactRetry=c,null):(i=D.treeContext,rr=ji(w.nextSibling),ar=c,un=!0,Ur=null,i!==null&&(mr[fr++]=Os,mr[fr++]=Is,mr[fr++]=vl,Os=i.id,Is=i.overflow,vl=c),c=vm(c,v.children),c.flags|=4096,c)}function qv(i,c,x){i.lanes|=c;var v=i.alternate;v!==null&&(v.lanes|=c),Qx(i.return,c,x)}function bm(i,c,x,v,w){var D=i.memoizedState;D===null?i.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:v,tail:x,tailMode:w}:(D.isBackwards=c,D.rendering=null,D.renderingStartTime=0,D.last=v,D.tail=x,D.tailMode=w)}function Wv(i,c,x){var v=c.pendingProps,w=v.revealOrder,D=v.tail;if(Sa(i,c,v.children,x),v=xn.current,(v&2)!==0)v=v&1|2,c.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=c.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&qv(i,x,c);else if(i.tag===19)qv(i,x,c);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===c)break e;for(;i.sibling===null;){if(i.return===null||i.return===c)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}v&=1}if(tn(xn,v),(c.mode&1)===0)c.memoizedState=null;else switch(w){case"forwards":for(x=c.child,w=null;x!==null;)i=x.alternate,i!==null&&dh(i)===null&&(w=x),x=x.sibling;x=w,x===null?(w=c.child,c.child=null):(w=x.sibling,x.sibling=null),bm(c,!1,w,x,D);break;case"backwards":for(x=null,w=c.child,c.child=null;w!==null;){if(i=w.alternate,i!==null&&dh(i)===null){c.child=w;break}i=w.sibling,w.sibling=x,x=w,w=i}bm(c,!0,x,null,D);break;case"together":bm(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function yh(i,c){(c.mode&1)===0&&i!==null&&(i.alternate=null,c.alternate=null,c.flags|=2)}function Bs(i,c,x){if(i!==null&&(c.dependencies=i.dependencies),kl|=c.lanes,(x&c.childLanes)===0)return null;if(i!==null&&c.child!==i.child)throw Error(a(153));if(c.child!==null){for(i=c.child,x=Pi(i,i.pendingProps),c.child=x,x.return=c;i.sibling!==null;)i=i.sibling,x=x.sibling=Pi(i,i.pendingProps),x.return=c;x.sibling=null}return c.child}function q4(i,c,x){switch(c.tag){case 3:zv(c),Io();break;case 5:ov(c);break;case 1:Ha(c.type)&&eh(c);break;case 4:Zx(c,c.stateNode.containerInfo);break;case 10:var v=c.type._context,w=c.memoizedProps.value;tn(ih,v._currentValue),v._currentValue=w;break;case 13:if(v=c.memoizedState,v!==null)return v.dehydrated!==null?(tn(xn,xn.current&1),c.flags|=128,null):(x&c.child.childLanes)!==0?Gv(i,c,x):(tn(xn,xn.current&1),i=Bs(i,c,x),i!==null?i.sibling:null);tn(xn,xn.current&1);break;case 19:if(v=(x&c.childLanes)!==0,(i.flags&128)!==0){if(v)return Wv(i,c,x);c.flags|=128}if(w=c.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),tn(xn,xn.current),v)break;return null;case 22:case 23:return c.lanes=0,Vv(i,c,x)}return Bs(i,c,x)}var Xv,Nm,Qv,Yv;Xv=function(i,c){for(var x=c.child;x!==null;){if(x.tag===5||x.tag===6)i.appendChild(x.stateNode);else if(x.tag!==4&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===c)break;for(;x.sibling===null;){if(x.return===null||x.return===c)return;x=x.return}x.sibling.return=x.return,x=x.sibling}},Nm=function(){},Qv=function(i,c,x,v){var w=i.memoizedProps;if(w!==v){i=c.stateNode,jl(is.current);var D=null;switch(x){case"input":w=Ke(i,w),v=Ke(i,v),D=[];break;case"select":w=he({},w,{value:void 0}),v=he({},v,{value:void 0}),D=[];break;case"textarea":w=Hr(i,w),v=Hr(i,v),D=[];break;default:typeof w.onClick!="function"&&typeof v.onClick=="function"&&(i.onclick=Yu)}Ds(x,v);var B;x=null;for(ke in w)if(!v.hasOwnProperty(ke)&&w.hasOwnProperty(ke)&&w[ke]!=null)if(ke==="style"){var ie=w[ke];for(B in ie)ie.hasOwnProperty(B)&&(x||(x={}),x[B]="")}else ke!=="dangerouslySetInnerHTML"&&ke!=="children"&&ke!=="suppressContentEditableWarning"&&ke!=="suppressHydrationWarning"&&ke!=="autoFocus"&&(s.hasOwnProperty(ke)?D||(D=[]):(D=D||[]).push(ke,null));for(ke in v){var ue=v[ke];if(ie=w!=null?w[ke]:void 0,v.hasOwnProperty(ke)&&ue!==ie&&(ue!=null||ie!=null))if(ke==="style")if(ie){for(B in ie)!ie.hasOwnProperty(B)||ue&&ue.hasOwnProperty(B)||(x||(x={}),x[B]="");for(B in ue)ue.hasOwnProperty(B)&&ie[B]!==ue[B]&&(x||(x={}),x[B]=ue[B])}else x||(D||(D=[]),D.push(ke,x)),x=ue;else ke==="dangerouslySetInnerHTML"?(ue=ue?ue.__html:void 0,ie=ie?ie.__html:void 0,ue!=null&&ie!==ue&&(D=D||[]).push(ke,ue)):ke==="children"?typeof ue!="string"&&typeof ue!="number"||(D=D||[]).push(ke,""+ue):ke!=="suppressContentEditableWarning"&&ke!=="suppressHydrationWarning"&&(s.hasOwnProperty(ke)?(ue!=null&&ke==="onScroll"&&an("scroll",i),D||ie===ue||(D=[])):(D=D||[]).push(ke,ue))}x&&(D=D||[]).push("style",x);var ke=D;(c.updateQueue=ke)&&(c.flags|=4)}},Yv=function(i,c,x,v){x!==v&&(c.flags|=4)};function md(i,c){if(!un)switch(i.tailMode){case"hidden":c=i.tail;for(var x=null;c!==null;)c.alternate!==null&&(x=c),c=c.sibling;x===null?i.tail=null:x.sibling=null;break;case"collapsed":x=i.tail;for(var v=null;x!==null;)x.alternate!==null&&(v=x),x=x.sibling;v===null?c||i.tail===null?i.tail=null:i.tail.sibling=null:v.sibling=null}}function ma(i){var c=i.alternate!==null&&i.alternate.child===i.child,x=0,v=0;if(c)for(var w=i.child;w!==null;)x|=w.lanes|w.childLanes,v|=w.subtreeFlags&14680064,v|=w.flags&14680064,w.return=i,w=w.sibling;else for(w=i.child;w!==null;)x|=w.lanes|w.childLanes,v|=w.subtreeFlags,v|=w.flags,w.return=i,w=w.sibling;return i.subtreeFlags|=v,i.childLanes=x,c}function W4(i,c,x){var v=c.pendingProps;switch(Kx(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ma(c),null;case 1:return Ha(c.type)&&Zu(),ma(c),null;case 3:return v=c.stateNode,Ho(),rn(Ba),rn(ha),nm(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(i===null||i.child===null)&&(rh(c)?c.flags|=4:i===null||i.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Ur!==null&&(Am(Ur),Ur=null))),Nm(i,c),ma(c),null;case 5:em(c);var w=jl(cd.current);if(x=c.type,i!==null&&c.stateNode!=null)Qv(i,c,x,v,w),i.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!v){if(c.stateNode===null)throw Error(a(166));return ma(c),null}if(i=jl(is.current),rh(c)){v=c.stateNode,x=c.type;var D=c.memoizedProps;switch(v[ss]=c,v[rd]=D,i=(c.mode&1)!==0,x){case"dialog":an("cancel",v),an("close",v);break;case"iframe":case"object":case"embed":an("load",v);break;case"video":case"audio":for(w=0;w<td.length;w++)an(td[w],v);break;case"source":an("error",v);break;case"img":case"image":case"link":an("error",v),an("load",v);break;case"details":an("toggle",v);break;case"input":at(v,D),an("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!D.multiple},an("invalid",v);break;case"textarea":tr(v,D),an("invalid",v)}Ds(x,D),w=null;for(var B in D)if(D.hasOwnProperty(B)){var ie=D[B];B==="children"?typeof ie=="string"?v.textContent!==ie&&(D.suppressHydrationWarning!==!0&&Qu(v.textContent,ie,i),w=["children",ie]):typeof ie=="number"&&v.textContent!==""+ie&&(D.suppressHydrationWarning!==!0&&Qu(v.textContent,ie,i),w=["children",""+ie]):s.hasOwnProperty(B)&&ie!=null&&B==="onScroll"&&an("scroll",v)}switch(x){case"input":oe(v),Gt(v,D,!0);break;case"textarea":oe(v),Ye(v);break;case"select":case"option":break;default:typeof D.onClick=="function"&&(v.onclick=Yu)}v=w,c.updateQueue=v,v!==null&&(c.flags|=4)}else{B=w.nodeType===9?w:w.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=Ft(x)),i==="http://www.w3.org/1999/xhtml"?x==="script"?(i=B.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof v.is=="string"?i=B.createElement(x,{is:v.is}):(i=B.createElement(x),x==="select"&&(B=i,v.multiple?B.multiple=!0:v.size&&(B.size=v.size))):i=B.createElementNS(i,x),i[ss]=c,i[rd]=v,Xv(i,c,!1,!1),c.stateNode=i;e:{switch(B=Fs(x,v),x){case"dialog":an("cancel",i),an("close",i),w=v;break;case"iframe":case"object":case"embed":an("load",i),w=v;break;case"video":case"audio":for(w=0;w<td.length;w++)an(td[w],i);w=v;break;case"source":an("error",i),w=v;break;case"img":case"image":case"link":an("error",i),an("load",i),w=v;break;case"details":an("toggle",i),w=v;break;case"input":at(i,v),w=Ke(i,v),an("invalid",i);break;case"option":w=v;break;case"select":i._wrapperState={wasMultiple:!!v.multiple},w=he({},v,{value:void 0}),an("invalid",i);break;case"textarea":tr(i,v),w=Hr(i,v),an("invalid",i);break;default:w=v}Ds(x,w),ie=w;for(D in ie)if(ie.hasOwnProperty(D)){var ue=ie[D];D==="style"?Ca(i,ue):D==="dangerouslySetInnerHTML"?(ue=ue?ue.__html:void 0,ue!=null&&Mn(i,ue)):D==="children"?typeof ue=="string"?(x!=="textarea"||ue!=="")&&ot(i,ue):typeof ue=="number"&&ot(i,""+ue):D!=="suppressContentEditableWarning"&&D!=="suppressHydrationWarning"&&D!=="autoFocus"&&(s.hasOwnProperty(D)?ue!=null&&D==="onScroll"&&an("scroll",i):ue!=null&&S(i,D,ue,B))}switch(x){case"input":oe(i),Gt(i,v,!1);break;case"textarea":oe(i),Ye(i);break;case"option":v.value!=null&&i.setAttribute("value",""+U(v.value));break;case"select":i.multiple=!!v.multiple,D=v.value,D!=null?$n(i,!!v.multiple,D,!1):v.defaultValue!=null&&$n(i,!!v.multiple,v.defaultValue,!0);break;default:typeof w.onClick=="function"&&(i.onclick=Yu)}switch(x){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return ma(c),null;case 6:if(i&&c.stateNode!=null)Yv(i,c,i.memoizedProps,v);else{if(typeof v!="string"&&c.stateNode===null)throw Error(a(166));if(x=jl(cd.current),jl(is.current),rh(c)){if(v=c.stateNode,x=c.memoizedProps,v[ss]=c,(D=v.nodeValue!==x)&&(i=ar,i!==null))switch(i.tag){case 3:Qu(v.nodeValue,x,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Qu(v.nodeValue,x,(i.mode&1)!==0)}D&&(c.flags|=4)}else v=(x.nodeType===9?x:x.ownerDocument).createTextNode(v),v[ss]=c,c.stateNode=v}return ma(c),null;case 13:if(rn(xn),v=c.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(un&&rr!==null&&(c.mode&1)!==0&&(c.flags&128)===0)ev(),Io(),c.flags|=98560,D=!1;else if(D=rh(c),v!==null&&v.dehydrated!==null){if(i===null){if(!D)throw Error(a(318));if(D=c.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(a(317));D[ss]=c}else Io(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;ma(c),D=!1}else Ur!==null&&(Am(Ur),Ur=null),D=!0;if(!D)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=x,c):(v=v!==null,v!==(i!==null&&i.memoizedState!==null)&&v&&(c.child.flags|=8192,(c.mode&1)!==0&&(i===null||(xn.current&1)!==0?Bn===0&&(Bn=3):Om())),c.updateQueue!==null&&(c.flags|=4),ma(c),null);case 4:return Ho(),Nm(i,c),i===null&&nd(c.stateNode.containerInfo),ma(c),null;case 10:return Xx(c.type._context),ma(c),null;case 17:return Ha(c.type)&&Zu(),ma(c),null;case 19:if(rn(xn),D=c.memoizedState,D===null)return ma(c),null;if(v=(c.flags&128)!==0,B=D.rendering,B===null)if(v)md(D,!1);else{if(Bn!==0||i!==null&&(i.flags&128)!==0)for(i=c.child;i!==null;){if(B=dh(i),B!==null){for(c.flags|=128,md(D,!1),v=B.updateQueue,v!==null&&(c.updateQueue=v,c.flags|=4),c.subtreeFlags=0,v=x,x=c.child;x!==null;)D=x,i=v,D.flags&=14680066,B=D.alternate,B===null?(D.childLanes=0,D.lanes=i,D.child=null,D.subtreeFlags=0,D.memoizedProps=null,D.memoizedState=null,D.updateQueue=null,D.dependencies=null,D.stateNode=null):(D.childLanes=B.childLanes,D.lanes=B.lanes,D.child=B.child,D.subtreeFlags=0,D.deletions=null,D.memoizedProps=B.memoizedProps,D.memoizedState=B.memoizedState,D.updateQueue=B.updateQueue,D.type=B.type,i=B.dependencies,D.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),x=x.sibling;return tn(xn,xn.current&1|2),c.child}i=i.sibling}D.tail!==null&&Oe()>zo&&(c.flags|=128,v=!0,md(D,!1),c.lanes=4194304)}else{if(!v)if(i=dh(B),i!==null){if(c.flags|=128,v=!0,x=i.updateQueue,x!==null&&(c.updateQueue=x,c.flags|=4),md(D,!0),D.tail===null&&D.tailMode==="hidden"&&!B.alternate&&!un)return ma(c),null}else 2*Oe()-D.renderingStartTime>zo&&x!==1073741824&&(c.flags|=128,v=!0,md(D,!1),c.lanes=4194304);D.isBackwards?(B.sibling=c.child,c.child=B):(x=D.last,x!==null?x.sibling=B:c.child=B,D.last=B)}return D.tail!==null?(c=D.tail,D.rendering=c,D.tail=c.sibling,D.renderingStartTime=Oe(),c.sibling=null,x=xn.current,tn(xn,v?x&1|2:x&1),c):(ma(c),null);case 22:case 23:return Lm(),v=c.memoizedState!==null,i!==null&&i.memoizedState!==null!==v&&(c.flags|=8192),v&&(c.mode&1)!==0?(sr&1073741824)!==0&&(ma(c),c.subtreeFlags&6&&(c.flags|=8192)):ma(c),null;case 24:return null;case 25:return null}throw Error(a(156,c.tag))}function X4(i,c){switch(Kx(c),c.tag){case 1:return Ha(c.type)&&Zu(),i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 3:return Ho(),rn(Ba),rn(ha),nm(),i=c.flags,(i&65536)!==0&&(i&128)===0?(c.flags=i&-65537|128,c):null;case 5:return em(c),null;case 13:if(rn(xn),i=c.memoizedState,i!==null&&i.dehydrated!==null){if(c.alternate===null)throw Error(a(340));Io()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 19:return rn(xn),null;case 4:return Ho(),null;case 10:return Xx(c.type._context),null;case 22:case 23:return Lm(),null;case 24:return null;default:return null}}var vh=!1,fa=!1,Q4=typeof WeakSet=="function"?WeakSet:Set,We=null;function Uo(i,c){var x=i.ref;if(x!==null)if(typeof x=="function")try{x(null)}catch(v){yn(i,c,v)}else x.current=null}function jm(i,c,x){try{x()}catch(v){yn(i,c,v)}}var Jv=!1;function Y4(i,c){if(Lx=Bu,i=Dy(),Cx(i)){if("selectionStart"in i)var x={start:i.selectionStart,end:i.selectionEnd};else e:{x=(x=i.ownerDocument)&&x.defaultView||window;var v=x.getSelection&&x.getSelection();if(v&&v.rangeCount!==0){x=v.anchorNode;var w=v.anchorOffset,D=v.focusNode;v=v.focusOffset;try{x.nodeType,D.nodeType}catch{x=null;break e}var B=0,ie=-1,ue=-1,ke=0,Ae=0,Le=i,Fe=null;t:for(;;){for(var Ge;Le!==x||w!==0&&Le.nodeType!==3||(ie=B+w),Le!==D||v!==0&&Le.nodeType!==3||(ue=B+v),Le.nodeType===3&&(B+=Le.nodeValue.length),(Ge=Le.firstChild)!==null;)Fe=Le,Le=Ge;for(;;){if(Le===i)break t;if(Fe===x&&++ke===w&&(ie=B),Fe===D&&++Ae===v&&(ue=B),(Ge=Le.nextSibling)!==null)break;Le=Fe,Fe=Le.parentNode}Le=Ge}x=ie===-1||ue===-1?null:{start:ie,end:ue}}else x=null}x=x||{start:0,end:0}}else x=null;for(Ox={focusedElem:i,selectionRange:x},Bu=!1,We=c;We!==null;)if(c=We,i=c.child,(c.subtreeFlags&1028)!==0&&i!==null)i.return=c,We=i;else for(;We!==null;){c=We;try{var Xe=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Xe!==null){var Qe=Xe.memoizedProps,Sn=Xe.memoizedState,ge=c.stateNode,xe=ge.getSnapshotBeforeUpdate(c.elementType===c.type?Qe:Kr(c.type,Qe),Sn);ge.__reactInternalSnapshotBeforeUpdate=xe}break;case 3:var ye=c.stateNode.containerInfo;ye.nodeType===1?ye.textContent="":ye.nodeType===9&&ye.documentElement&&ye.removeChild(ye.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(a(163))}}catch(Re){yn(c,c.return,Re)}if(i=c.sibling,i!==null){i.return=c.return,We=i;break}We=c.return}return Xe=Jv,Jv=!1,Xe}function fd(i,c,x){var v=c.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var w=v=v.next;do{if((w.tag&i)===i){var D=w.destroy;w.destroy=void 0,D!==void 0&&jm(c,x,D)}w=w.next}while(w!==v)}}function bh(i,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var x=c=c.next;do{if((x.tag&i)===i){var v=x.create;x.destroy=v()}x=x.next}while(x!==c)}}function wm(i){var c=i.ref;if(c!==null){var x=i.stateNode;switch(i.tag){case 5:i=x;break;default:i=x}typeof c=="function"?c(i):c.current=i}}function Zv(i){var c=i.alternate;c!==null&&(i.alternate=null,Zv(c)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(c=i.stateNode,c!==null&&(delete c[ss],delete c[rd],delete c[Bx],delete c[P4],delete c[L4])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function e1(i){return i.tag===5||i.tag===3||i.tag===4}function t1(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||e1(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function km(i,c,x){var v=i.tag;if(v===5||v===6)i=i.stateNode,c?x.nodeType===8?x.parentNode.insertBefore(i,c):x.insertBefore(i,c):(x.nodeType===8?(c=x.parentNode,c.insertBefore(i,x)):(c=x,c.appendChild(i)),x=x._reactRootContainer,x!=null||c.onclick!==null||(c.onclick=Yu));else if(v!==4&&(i=i.child,i!==null))for(km(i,c,x),i=i.sibling;i!==null;)km(i,c,x),i=i.sibling}function Tm(i,c,x){var v=i.tag;if(v===5||v===6)i=i.stateNode,c?x.insertBefore(i,c):x.appendChild(i);else if(v!==4&&(i=i.child,i!==null))for(Tm(i,c,x),i=i.sibling;i!==null;)Tm(i,c,x),i=i.sibling}var ra=null,zr=!1;function _i(i,c,x){for(x=x.child;x!==null;)n1(i,c,x),x=x.sibling}function n1(i,c,x){if(qn&&typeof qn.onCommitFiberUnmount=="function")try{qn.onCommitFiberUnmount(rs,x)}catch{}switch(x.tag){case 5:fa||Uo(x,c);case 6:var v=ra,w=zr;ra=null,_i(i,c,x),ra=v,zr=w,ra!==null&&(zr?(i=ra,x=x.stateNode,i.nodeType===8?i.parentNode.removeChild(x):i.removeChild(x)):ra.removeChild(x.stateNode));break;case 18:ra!==null&&(zr?(i=ra,x=x.stateNode,i.nodeType===8?Rx(i.parentNode,x):i.nodeType===1&&Rx(i,x),qc(i)):Rx(ra,x.stateNode));break;case 4:v=ra,w=zr,ra=x.stateNode.containerInfo,zr=!0,_i(i,c,x),ra=v,zr=w;break;case 0:case 11:case 14:case 15:if(!fa&&(v=x.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){w=v=v.next;do{var D=w,B=D.destroy;D=D.tag,B!==void 0&&((D&2)!==0||(D&4)!==0)&&jm(x,c,B),w=w.next}while(w!==v)}_i(i,c,x);break;case 1:if(!fa&&(Uo(x,c),v=x.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=x.memoizedProps,v.state=x.memoizedState,v.componentWillUnmount()}catch(ie){yn(x,c,ie)}_i(i,c,x);break;case 21:_i(i,c,x);break;case 22:x.mode&1?(fa=(v=fa)||x.memoizedState!==null,_i(i,c,x),fa=v):_i(i,c,x);break;default:_i(i,c,x)}}function a1(i){var c=i.updateQueue;if(c!==null){i.updateQueue=null;var x=i.stateNode;x===null&&(x=i.stateNode=new Q4),c.forEach(function(v){var w=iC.bind(null,i,v);x.has(v)||(x.add(v),v.then(w,w))})}}function $r(i,c){var x=c.deletions;if(x!==null)for(var v=0;v<x.length;v++){var w=x[v];try{var D=i,B=c,ie=B;e:for(;ie!==null;){switch(ie.tag){case 5:ra=ie.stateNode,zr=!1;break e;case 3:ra=ie.stateNode.containerInfo,zr=!0;break e;case 4:ra=ie.stateNode.containerInfo,zr=!0;break e}ie=ie.return}if(ra===null)throw Error(a(160));n1(D,B,w),ra=null,zr=!1;var ue=w.alternate;ue!==null&&(ue.return=null),w.return=null}catch(ke){yn(w,c,ke)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)r1(c,i),c=c.sibling}function r1(i,c){var x=i.alternate,v=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if($r(c,i),os(i),v&4){try{fd(3,i,i.return),bh(3,i)}catch(Qe){yn(i,i.return,Qe)}try{fd(5,i,i.return)}catch(Qe){yn(i,i.return,Qe)}}break;case 1:$r(c,i),os(i),v&512&&x!==null&&Uo(x,x.return);break;case 5:if($r(c,i),os(i),v&512&&x!==null&&Uo(x,x.return),i.flags&32){var w=i.stateNode;try{ot(w,"")}catch(Qe){yn(i,i.return,Qe)}}if(v&4&&(w=i.stateNode,w!=null)){var D=i.memoizedProps,B=x!==null?x.memoizedProps:D,ie=i.type,ue=i.updateQueue;if(i.updateQueue=null,ue!==null)try{ie==="input"&&D.type==="radio"&&D.name!=null&&et(w,D),Fs(ie,B);var ke=Fs(ie,D);for(B=0;B<ue.length;B+=2){var Ae=ue[B],Le=ue[B+1];Ae==="style"?Ca(w,Le):Ae==="dangerouslySetInnerHTML"?Mn(w,Le):Ae==="children"?ot(w,Le):S(w,Ae,Le,ke)}switch(ie){case"input":Be(w,D);break;case"textarea":He(w,D);break;case"select":var Fe=w._wrapperState.wasMultiple;w._wrapperState.wasMultiple=!!D.multiple;var Ge=D.value;Ge!=null?$n(w,!!D.multiple,Ge,!1):Fe!==!!D.multiple&&(D.defaultValue!=null?$n(w,!!D.multiple,D.defaultValue,!0):$n(w,!!D.multiple,D.multiple?[]:"",!1))}w[rd]=D}catch(Qe){yn(i,i.return,Qe)}}break;case 6:if($r(c,i),os(i),v&4){if(i.stateNode===null)throw Error(a(162));w=i.stateNode,D=i.memoizedProps;try{w.nodeValue=D}catch(Qe){yn(i,i.return,Qe)}}break;case 3:if($r(c,i),os(i),v&4&&x!==null&&x.memoizedState.isDehydrated)try{qc(c.containerInfo)}catch(Qe){yn(i,i.return,Qe)}break;case 4:$r(c,i),os(i);break;case 13:$r(c,i),os(i),w=i.child,w.flags&8192&&(D=w.memoizedState!==null,w.stateNode.isHidden=D,!D||w.alternate!==null&&w.alternate.memoizedState!==null||(_m=Oe())),v&4&&a1(i);break;case 22:if(Ae=x!==null&&x.memoizedState!==null,i.mode&1?(fa=(ke=fa)||Ae,$r(c,i),fa=ke):$r(c,i),os(i),v&8192){if(ke=i.memoizedState!==null,(i.stateNode.isHidden=ke)&&!Ae&&(i.mode&1)!==0)for(We=i,Ae=i.child;Ae!==null;){for(Le=We=Ae;We!==null;){switch(Fe=We,Ge=Fe.child,Fe.tag){case 0:case 11:case 14:case 15:fd(4,Fe,Fe.return);break;case 1:Uo(Fe,Fe.return);var Xe=Fe.stateNode;if(typeof Xe.componentWillUnmount=="function"){v=Fe,x=Fe.return;try{c=v,Xe.props=c.memoizedProps,Xe.state=c.memoizedState,Xe.componentWillUnmount()}catch(Qe){yn(v,x,Qe)}}break;case 5:Uo(Fe,Fe.return);break;case 22:if(Fe.memoizedState!==null){l1(Le);continue}}Ge!==null?(Ge.return=Fe,We=Ge):l1(Le)}Ae=Ae.sibling}e:for(Ae=null,Le=i;;){if(Le.tag===5){if(Ae===null){Ae=Le;try{w=Le.stateNode,ke?(D=w.style,typeof D.setProperty=="function"?D.setProperty("display","none","important"):D.display="none"):(ie=Le.stateNode,ue=Le.memoizedProps.style,B=ue!=null&&ue.hasOwnProperty("display")?ue.display:null,ie.style.display=Zt("display",B))}catch(Qe){yn(i,i.return,Qe)}}}else if(Le.tag===6){if(Ae===null)try{Le.stateNode.nodeValue=ke?"":Le.memoizedProps}catch(Qe){yn(i,i.return,Qe)}}else if((Le.tag!==22&&Le.tag!==23||Le.memoizedState===null||Le===i)&&Le.child!==null){Le.child.return=Le,Le=Le.child;continue}if(Le===i)break e;for(;Le.sibling===null;){if(Le.return===null||Le.return===i)break e;Ae===Le&&(Ae=null),Le=Le.return}Ae===Le&&(Ae=null),Le.sibling.return=Le.return,Le=Le.sibling}}break;case 19:$r(c,i),os(i),v&4&&a1(i);break;case 21:break;default:$r(c,i),os(i)}}function os(i){var c=i.flags;if(c&2){try{e:{for(var x=i.return;x!==null;){if(e1(x)){var v=x;break e}x=x.return}throw Error(a(160))}switch(v.tag){case 5:var w=v.stateNode;v.flags&32&&(ot(w,""),v.flags&=-33);var D=t1(i);Tm(i,D,w);break;case 3:case 4:var B=v.stateNode.containerInfo,ie=t1(i);km(i,ie,B);break;default:throw Error(a(161))}}catch(ue){yn(i,i.return,ue)}i.flags&=-3}c&4096&&(i.flags&=-4097)}function J4(i,c,x){We=i,s1(i)}function s1(i,c,x){for(var v=(i.mode&1)!==0;We!==null;){var w=We,D=w.child;if(w.tag===22&&v){var B=w.memoizedState!==null||vh;if(!B){var ie=w.alternate,ue=ie!==null&&ie.memoizedState!==null||fa;ie=vh;var ke=fa;if(vh=B,(fa=ue)&&!ke)for(We=w;We!==null;)B=We,ue=B.child,B.tag===22&&B.memoizedState!==null?o1(w):ue!==null?(ue.return=B,We=ue):o1(w);for(;D!==null;)We=D,s1(D),D=D.sibling;We=w,vh=ie,fa=ke}i1(i)}else(w.subtreeFlags&8772)!==0&&D!==null?(D.return=w,We=D):i1(i)}}function i1(i){for(;We!==null;){var c=We;if((c.flags&8772)!==0){var x=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:fa||bh(5,c);break;case 1:var v=c.stateNode;if(c.flags&4&&!fa)if(x===null)v.componentDidMount();else{var w=c.elementType===c.type?x.memoizedProps:Kr(c.type,x.memoizedProps);v.componentDidUpdate(w,x.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var D=c.updateQueue;D!==null&&lv(c,D,v);break;case 3:var B=c.updateQueue;if(B!==null){if(x=null,c.child!==null)switch(c.child.tag){case 5:x=c.child.stateNode;break;case 1:x=c.child.stateNode}lv(c,B,x)}break;case 5:var ie=c.stateNode;if(x===null&&c.flags&4){x=ie;var ue=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":ue.autoFocus&&x.focus();break;case"img":ue.src&&(x.src=ue.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var ke=c.alternate;if(ke!==null){var Ae=ke.memoizedState;if(Ae!==null){var Le=Ae.dehydrated;Le!==null&&qc(Le)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(a(163))}fa||c.flags&512&&wm(c)}catch(Fe){yn(c,c.return,Fe)}}if(c===i){We=null;break}if(x=c.sibling,x!==null){x.return=c.return,We=x;break}We=c.return}}function l1(i){for(;We!==null;){var c=We;if(c===i){We=null;break}var x=c.sibling;if(x!==null){x.return=c.return,We=x;break}We=c.return}}function o1(i){for(;We!==null;){var c=We;try{switch(c.tag){case 0:case 11:case 15:var x=c.return;try{bh(4,c)}catch(ue){yn(c,x,ue)}break;case 1:var v=c.stateNode;if(typeof v.componentDidMount=="function"){var w=c.return;try{v.componentDidMount()}catch(ue){yn(c,w,ue)}}var D=c.return;try{wm(c)}catch(ue){yn(c,D,ue)}break;case 5:var B=c.return;try{wm(c)}catch(ue){yn(c,B,ue)}}}catch(ue){yn(c,c.return,ue)}if(c===i){We=null;break}var ie=c.sibling;if(ie!==null){ie.return=c.return,We=ie;break}We=c.return}}var Z4=Math.ceil,Nh=k.ReactCurrentDispatcher,Cm=k.ReactCurrentOwner,yr=k.ReactCurrentBatchConfig,_t=0,Xn=null,An=null,sa=0,sr=0,Ko=wi(0),Bn=0,pd=null,kl=0,jh=0,Sm=0,gd=null,Ua=null,_m=0,zo=1/0,Hs=null,wh=!1,Em=null,Ei=null,kh=!1,Di=null,Th=0,yd=0,Dm=null,Ch=-1,Sh=0;function _a(){return(_t&6)!==0?Oe():Ch!==-1?Ch:Ch=Oe()}function Fi(i){return(i.mode&1)===0?1:(_t&2)!==0&&sa!==0?sa&-sa:I4.transition!==null?(Sh===0&&(Sh=ty()),Sh):(i=Ut,i!==0||(i=window.event,i=i===void 0?16:dy(i.type)),i)}function Gr(i,c,x,v){if(50<yd)throw yd=0,Dm=null,Error(a(185));Uc(i,x,v),((_t&2)===0||i!==Xn)&&(i===Xn&&((_t&2)===0&&(jh|=x),Bn===4&&Ai(i,sa)),Ka(i,v),x===1&&_t===0&&(c.mode&1)===0&&(zo=Oe()+500,th&&Ti()))}function Ka(i,c){var x=i.callbackNode;IT(i,c);var v=Iu(i,i===Xn?sa:0);if(v===0)x!==null&&ze(x),i.callbackNode=null,i.callbackPriority=0;else if(c=v&-v,i.callbackPriority!==c){if(x!=null&&ze(x),c===1)i.tag===0?O4(d1.bind(null,i)):Xy(d1.bind(null,i)),F4(function(){(_t&6)===0&&Ti()}),x=null;else{switch(ny(v)){case 1:x=Qt;break;case 4:x=en;break;case 16:x=Tn;break;case 536870912:x=fi;break;default:x=Tn}x=y1(x,c1.bind(null,i))}i.callbackPriority=c,i.callbackNode=x}}function c1(i,c){if(Ch=-1,Sh=0,(_t&6)!==0)throw Error(a(327));var x=i.callbackNode;if($o()&&i.callbackNode!==x)return null;var v=Iu(i,i===Xn?sa:0);if(v===0)return null;if((v&30)!==0||(v&i.expiredLanes)!==0||c)c=_h(i,v);else{c=v;var w=_t;_t|=2;var D=h1();(Xn!==i||sa!==c)&&(Hs=null,zo=Oe()+500,Cl(i,c));do try{nC();break}catch(ie){u1(i,ie)}while(!0);Wx(),Nh.current=D,_t=w,An!==null?c=0:(Xn=null,sa=0,c=Bn)}if(c!==0){if(c===2&&(w=dx(i),w!==0&&(v=w,c=Fm(i,w))),c===1)throw x=pd,Cl(i,0),Ai(i,v),Ka(i,Oe()),x;if(c===6)Ai(i,v);else{if(w=i.current.alternate,(v&30)===0&&!eC(w)&&(c=_h(i,v),c===2&&(D=dx(i),D!==0&&(v=D,c=Fm(i,D))),c===1))throw x=pd,Cl(i,0),Ai(i,v),Ka(i,Oe()),x;switch(i.finishedWork=w,i.finishedLanes=v,c){case 0:case 1:throw Error(a(345));case 2:Sl(i,Ua,Hs);break;case 3:if(Ai(i,v),(v&130023424)===v&&(c=_m+500-Oe(),10<c)){if(Iu(i,0)!==0)break;if(w=i.suspendedLanes,(w&v)!==v){_a(),i.pingedLanes|=i.suspendedLanes&w;break}i.timeoutHandle=Mx(Sl.bind(null,i,Ua,Hs),c);break}Sl(i,Ua,Hs);break;case 4:if(Ai(i,v),(v&4194240)===v)break;for(c=i.eventTimes,w=-1;0<v;){var B=31-Cn(v);D=1<<B,B=c[B],B>w&&(w=B),v&=~D}if(v=w,v=Oe()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*Z4(v/1960))-v,10<v){i.timeoutHandle=Mx(Sl.bind(null,i,Ua,Hs),v);break}Sl(i,Ua,Hs);break;case 5:Sl(i,Ua,Hs);break;default:throw Error(a(329))}}}return Ka(i,Oe()),i.callbackNode===x?c1.bind(null,i):null}function Fm(i,c){var x=gd;return i.current.memoizedState.isDehydrated&&(Cl(i,c).flags|=256),i=_h(i,c),i!==2&&(c=Ua,Ua=x,c!==null&&Am(c)),i}function Am(i){Ua===null?Ua=i:Ua.push.apply(Ua,i)}function eC(i){for(var c=i;;){if(c.flags&16384){var x=c.updateQueue;if(x!==null&&(x=x.stores,x!==null))for(var v=0;v<x.length;v++){var w=x[v],D=w.getSnapshot;w=w.value;try{if(!Vr(D(),w))return!1}catch{return!1}}}if(x=c.child,c.subtreeFlags&16384&&x!==null)x.return=c,c=x;else{if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Ai(i,c){for(c&=~Sm,c&=~jh,i.suspendedLanes|=c,i.pingedLanes&=~c,i=i.expirationTimes;0<c;){var x=31-Cn(c),v=1<<x;i[x]=-1,c&=~v}}function d1(i){if((_t&6)!==0)throw Error(a(327));$o();var c=Iu(i,0);if((c&1)===0)return Ka(i,Oe()),null;var x=_h(i,c);if(i.tag!==0&&x===2){var v=dx(i);v!==0&&(c=v,x=Fm(i,v))}if(x===1)throw x=pd,Cl(i,0),Ai(i,c),Ka(i,Oe()),x;if(x===6)throw Error(a(345));return i.finishedWork=i.current.alternate,i.finishedLanes=c,Sl(i,Ua,Hs),Ka(i,Oe()),null}function Pm(i,c){var x=_t;_t|=1;try{return i(c)}finally{_t=x,_t===0&&(zo=Oe()+500,th&&Ti())}}function Tl(i){Di!==null&&Di.tag===0&&(_t&6)===0&&$o();var c=_t;_t|=1;var x=yr.transition,v=Ut;try{if(yr.transition=null,Ut=1,i)return i()}finally{Ut=v,yr.transition=x,_t=c,(_t&6)===0&&Ti()}}function Lm(){sr=Ko.current,rn(Ko)}function Cl(i,c){i.finishedWork=null,i.finishedLanes=0;var x=i.timeoutHandle;if(x!==-1&&(i.timeoutHandle=-1,D4(x)),An!==null)for(x=An.return;x!==null;){var v=x;switch(Kx(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&Zu();break;case 3:Ho(),rn(Ba),rn(ha),nm();break;case 5:em(v);break;case 4:Ho();break;case 13:rn(xn);break;case 19:rn(xn);break;case 10:Xx(v.type._context);break;case 22:case 23:Lm()}x=x.return}if(Xn=i,An=i=Pi(i.current,null),sa=sr=c,Bn=0,pd=null,Sm=jh=kl=0,Ua=gd=null,Nl!==null){for(c=0;c<Nl.length;c++)if(x=Nl[c],v=x.interleaved,v!==null){x.interleaved=null;var w=v.next,D=x.pending;if(D!==null){var B=D.next;D.next=w,v.next=B}x.pending=v}Nl=null}return i}function u1(i,c){do{var x=An;try{if(Wx(),uh.current=fh,hh){for(var v=mn.memoizedState;v!==null;){var w=v.queue;w!==null&&(w.pending=null),v=v.next}hh=!1}if(wl=0,Wn=Rn=mn=null,dd=!1,ud=0,Cm.current=null,x===null||x.return===null){Bn=1,pd=c,An=null;break}e:{var D=i,B=x.return,ie=x,ue=c;if(c=sa,ie.flags|=32768,ue!==null&&typeof ue=="object"&&typeof ue.then=="function"){var ke=ue,Ae=ie,Le=Ae.tag;if((Ae.mode&1)===0&&(Le===0||Le===11||Le===15)){var Fe=Ae.alternate;Fe?(Ae.updateQueue=Fe.updateQueue,Ae.memoizedState=Fe.memoizedState,Ae.lanes=Fe.lanes):(Ae.updateQueue=null,Ae.memoizedState=null)}var Ge=Iv(B);if(Ge!==null){Ge.flags&=-257,Mv(Ge,B,ie,D,c),Ge.mode&1&&Ov(D,ke,c),c=Ge,ue=ke;var Xe=c.updateQueue;if(Xe===null){var Qe=new Set;Qe.add(ue),c.updateQueue=Qe}else Xe.add(ue);break e}else{if((c&1)===0){Ov(D,ke,c),Om();break e}ue=Error(a(426))}}else if(un&&ie.mode&1){var Sn=Iv(B);if(Sn!==null){(Sn.flags&65536)===0&&(Sn.flags|=256),Mv(Sn,B,ie,D,c),Gx(Vo(ue,ie));break e}}D=ue=Vo(ue,ie),Bn!==4&&(Bn=2),gd===null?gd=[D]:gd.push(D),D=B;do{switch(D.tag){case 3:D.flags|=65536,c&=-c,D.lanes|=c;var ge=Pv(D,ue,c);iv(D,ge);break e;case 1:ie=ue;var xe=D.type,ye=D.stateNode;if((D.flags&128)===0&&(typeof xe.getDerivedStateFromError=="function"||ye!==null&&typeof ye.componentDidCatch=="function"&&(Ei===null||!Ei.has(ye)))){D.flags|=65536,c&=-c,D.lanes|=c;var Re=Lv(D,ie,c);iv(D,Re);break e}}D=D.return}while(D!==null)}m1(x)}catch(Je){c=Je,An===x&&x!==null&&(An=x=x.return);continue}break}while(!0)}function h1(){var i=Nh.current;return Nh.current=fh,i===null?fh:i}function Om(){(Bn===0||Bn===3||Bn===2)&&(Bn=4),Xn===null||(kl&268435455)===0&&(jh&268435455)===0||Ai(Xn,sa)}function _h(i,c){var x=_t;_t|=2;var v=h1();(Xn!==i||sa!==c)&&(Hs=null,Cl(i,c));do try{tC();break}catch(w){u1(i,w)}while(!0);if(Wx(),_t=x,Nh.current=v,An!==null)throw Error(a(261));return Xn=null,sa=0,Bn}function tC(){for(;An!==null;)x1(An)}function nC(){for(;An!==null&&!qe();)x1(An)}function x1(i){var c=g1(i.alternate,i,sr);i.memoizedProps=i.pendingProps,c===null?m1(i):An=c,Cm.current=null}function m1(i){var c=i;do{var x=c.alternate;if(i=c.return,(c.flags&32768)===0){if(x=W4(x,c,sr),x!==null){An=x;return}}else{if(x=X4(x,c),x!==null){x.flags&=32767,An=x;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Bn=6,An=null;return}}if(c=c.sibling,c!==null){An=c;return}An=c=i}while(c!==null);Bn===0&&(Bn=5)}function Sl(i,c,x){var v=Ut,w=yr.transition;try{yr.transition=null,Ut=1,aC(i,c,x,v)}finally{yr.transition=w,Ut=v}return null}function aC(i,c,x,v){do $o();while(Di!==null);if((_t&6)!==0)throw Error(a(327));x=i.finishedWork;var w=i.finishedLanes;if(x===null)return null;if(i.finishedWork=null,i.finishedLanes=0,x===i.current)throw Error(a(177));i.callbackNode=null,i.callbackPriority=0;var D=x.lanes|x.childLanes;if(MT(i,D),i===Xn&&(An=Xn=null,sa=0),(x.subtreeFlags&2064)===0&&(x.flags&2064)===0||kh||(kh=!0,y1(Tn,function(){return $o(),null})),D=(x.flags&15990)!==0,(x.subtreeFlags&15990)!==0||D){D=yr.transition,yr.transition=null;var B=Ut;Ut=1;var ie=_t;_t|=4,Cm.current=null,Y4(i,x),r1(x,i),w4(Ox),Bu=!!Lx,Ox=Lx=null,i.current=x,J4(x),Me(),_t=ie,Ut=B,yr.transition=D}else i.current=x;if(kh&&(kh=!1,Di=i,Th=w),D=i.pendingLanes,D===0&&(Ei=null),Hc(x.stateNode),Ka(i,Oe()),c!==null)for(v=i.onRecoverableError,x=0;x<c.length;x++)w=c[x],v(w.value,{componentStack:w.stack,digest:w.digest});if(wh)throw wh=!1,i=Em,Em=null,i;return(Th&1)!==0&&i.tag!==0&&$o(),D=i.pendingLanes,(D&1)!==0?i===Dm?yd++:(yd=0,Dm=i):yd=0,Ti(),null}function $o(){if(Di!==null){var i=ny(Th),c=yr.transition,x=Ut;try{if(yr.transition=null,Ut=16>i?16:i,Di===null)var v=!1;else{if(i=Di,Di=null,Th=0,(_t&6)!==0)throw Error(a(331));var w=_t;for(_t|=4,We=i.current;We!==null;){var D=We,B=D.child;if((We.flags&16)!==0){var ie=D.deletions;if(ie!==null){for(var ue=0;ue<ie.length;ue++){var ke=ie[ue];for(We=ke;We!==null;){var Ae=We;switch(Ae.tag){case 0:case 11:case 15:fd(8,Ae,D)}var Le=Ae.child;if(Le!==null)Le.return=Ae,We=Le;else for(;We!==null;){Ae=We;var Fe=Ae.sibling,Ge=Ae.return;if(Zv(Ae),Ae===ke){We=null;break}if(Fe!==null){Fe.return=Ge,We=Fe;break}We=Ge}}}var Xe=D.alternate;if(Xe!==null){var Qe=Xe.child;if(Qe!==null){Xe.child=null;do{var Sn=Qe.sibling;Qe.sibling=null,Qe=Sn}while(Qe!==null)}}We=D}}if((D.subtreeFlags&2064)!==0&&B!==null)B.return=D,We=B;else e:for(;We!==null;){if(D=We,(D.flags&2048)!==0)switch(D.tag){case 0:case 11:case 15:fd(9,D,D.return)}var ge=D.sibling;if(ge!==null){ge.return=D.return,We=ge;break e}We=D.return}}var xe=i.current;for(We=xe;We!==null;){B=We;var ye=B.child;if((B.subtreeFlags&2064)!==0&&ye!==null)ye.return=B,We=ye;else e:for(B=xe;We!==null;){if(ie=We,(ie.flags&2048)!==0)try{switch(ie.tag){case 0:case 11:case 15:bh(9,ie)}}catch(Je){yn(ie,ie.return,Je)}if(ie===B){We=null;break e}var Re=ie.sibling;if(Re!==null){Re.return=ie.return,We=Re;break e}We=ie.return}}if(_t=w,Ti(),qn&&typeof qn.onPostCommitFiberRoot=="function")try{qn.onPostCommitFiberRoot(rs,i)}catch{}v=!0}return v}finally{Ut=x,yr.transition=c}}return!1}function f1(i,c,x){c=Vo(x,c),c=Pv(i,c,1),i=Si(i,c,1),c=_a(),i!==null&&(Uc(i,1,c),Ka(i,c))}function yn(i,c,x){if(i.tag===3)f1(i,i,x);else for(;c!==null;){if(c.tag===3){f1(c,i,x);break}else if(c.tag===1){var v=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(Ei===null||!Ei.has(v))){i=Vo(x,i),i=Lv(c,i,1),c=Si(c,i,1),i=_a(),c!==null&&(Uc(c,1,i),Ka(c,i));break}}c=c.return}}function rC(i,c,x){var v=i.pingCache;v!==null&&v.delete(c),c=_a(),i.pingedLanes|=i.suspendedLanes&x,Xn===i&&(sa&x)===x&&(Bn===4||Bn===3&&(sa&130023424)===sa&&500>Oe()-_m?Cl(i,0):Sm|=x),Ka(i,c)}function p1(i,c){c===0&&((i.mode&1)===0?c=1:(c=Ou,Ou<<=1,(Ou&130023424)===0&&(Ou=4194304)));var x=_a();i=Ms(i,c),i!==null&&(Uc(i,c,x),Ka(i,x))}function sC(i){var c=i.memoizedState,x=0;c!==null&&(x=c.retryLane),p1(i,x)}function iC(i,c){var x=0;switch(i.tag){case 13:var v=i.stateNode,w=i.memoizedState;w!==null&&(x=w.retryLane);break;case 19:v=i.stateNode;break;default:throw Error(a(314))}v!==null&&v.delete(c),p1(i,x)}var g1;g1=function(i,c,x){if(i!==null)if(i.memoizedProps!==c.pendingProps||Ba.current)Va=!0;else{if((i.lanes&x)===0&&(c.flags&128)===0)return Va=!1,q4(i,c,x);Va=(i.flags&131072)!==0}else Va=!1,un&&(c.flags&1048576)!==0&&Qy(c,ah,c.index);switch(c.lanes=0,c.tag){case 2:var v=c.type;yh(i,c),i=c.pendingProps;var w=Po(c,ha.current);Bo(c,x),w=sm(null,c,v,i,w,x);var D=im();return c.flags|=1,typeof w=="object"&&w!==null&&typeof w.render=="function"&&w.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Ha(v)?(D=!0,eh(c)):D=!1,c.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,Jx(c),w.updater=ph,c.stateNode=w,w._reactInternals=c,hm(c,v,i,x),c=pm(null,c,v,!0,D,x)):(c.tag=0,un&&D&&Ux(c),Sa(null,c,w,x),c=c.child),c;case 16:v=c.elementType;e:{switch(yh(i,c),i=c.pendingProps,w=v._init,v=w(v._payload),c.type=v,w=c.tag=oC(v),i=Kr(v,i),w){case 0:c=fm(null,c,v,i,x);break e;case 1:c=Kv(null,c,v,i,x);break e;case 11:c=Rv(null,c,v,i,x);break e;case 14:c=Bv(null,c,v,Kr(v.type,i),x);break e}throw Error(a(306,v,""))}return c;case 0:return v=c.type,w=c.pendingProps,w=c.elementType===v?w:Kr(v,w),fm(i,c,v,w,x);case 1:return v=c.type,w=c.pendingProps,w=c.elementType===v?w:Kr(v,w),Kv(i,c,v,w,x);case 3:e:{if(zv(c),i===null)throw Error(a(387));v=c.pendingProps,D=c.memoizedState,w=D.element,sv(i,c),ch(c,v,null,x);var B=c.memoizedState;if(v=B.element,D.isDehydrated)if(D={element:v,isDehydrated:!1,cache:B.cache,pendingSuspenseBoundaries:B.pendingSuspenseBoundaries,transitions:B.transitions},c.updateQueue.baseState=D,c.memoizedState=D,c.flags&256){w=Vo(Error(a(423)),c),c=$v(i,c,v,x,w);break e}else if(v!==w){w=Vo(Error(a(424)),c),c=$v(i,c,v,x,w);break e}else for(rr=ji(c.stateNode.containerInfo.firstChild),ar=c,un=!0,Ur=null,x=av(c,null,v,x),c.child=x;x;)x.flags=x.flags&-3|4096,x=x.sibling;else{if(Io(),v===w){c=Bs(i,c,x);break e}Sa(i,c,v,x)}c=c.child}return c;case 5:return ov(c),i===null&&$x(c),v=c.type,w=c.pendingProps,D=i!==null?i.memoizedProps:null,B=w.children,Ix(v,w)?B=null:D!==null&&Ix(v,D)&&(c.flags|=32),Uv(i,c),Sa(i,c,B,x),c.child;case 6:return i===null&&$x(c),null;case 13:return Gv(i,c,x);case 4:return Zx(c,c.stateNode.containerInfo),v=c.pendingProps,i===null?c.child=Mo(c,null,v,x):Sa(i,c,v,x),c.child;case 11:return v=c.type,w=c.pendingProps,w=c.elementType===v?w:Kr(v,w),Rv(i,c,v,w,x);case 7:return Sa(i,c,c.pendingProps,x),c.child;case 8:return Sa(i,c,c.pendingProps.children,x),c.child;case 12:return Sa(i,c,c.pendingProps.children,x),c.child;case 10:e:{if(v=c.type._context,w=c.pendingProps,D=c.memoizedProps,B=w.value,tn(ih,v._currentValue),v._currentValue=B,D!==null)if(Vr(D.value,B)){if(D.children===w.children&&!Ba.current){c=Bs(i,c,x);break e}}else for(D=c.child,D!==null&&(D.return=c);D!==null;){var ie=D.dependencies;if(ie!==null){B=D.child;for(var ue=ie.firstContext;ue!==null;){if(ue.context===v){if(D.tag===1){ue=Rs(-1,x&-x),ue.tag=2;var ke=D.updateQueue;if(ke!==null){ke=ke.shared;var Ae=ke.pending;Ae===null?ue.next=ue:(ue.next=Ae.next,Ae.next=ue),ke.pending=ue}}D.lanes|=x,ue=D.alternate,ue!==null&&(ue.lanes|=x),Qx(D.return,x,c),ie.lanes|=x;break}ue=ue.next}}else if(D.tag===10)B=D.type===c.type?null:D.child;else if(D.tag===18){if(B=D.return,B===null)throw Error(a(341));B.lanes|=x,ie=B.alternate,ie!==null&&(ie.lanes|=x),Qx(B,x,c),B=D.sibling}else B=D.child;if(B!==null)B.return=D;else for(B=D;B!==null;){if(B===c){B=null;break}if(D=B.sibling,D!==null){D.return=B.return,B=D;break}B=B.return}D=B}Sa(i,c,w.children,x),c=c.child}return c;case 9:return w=c.type,v=c.pendingProps.children,Bo(c,x),w=pr(w),v=v(w),c.flags|=1,Sa(i,c,v,x),c.child;case 14:return v=c.type,w=Kr(v,c.pendingProps),w=Kr(v.type,w),Bv(i,c,v,w,x);case 15:return Hv(i,c,c.type,c.pendingProps,x);case 17:return v=c.type,w=c.pendingProps,w=c.elementType===v?w:Kr(v,w),yh(i,c),c.tag=1,Ha(v)?(i=!0,eh(c)):i=!1,Bo(c,x),Fv(c,v,w),hm(c,v,w,x),pm(null,c,v,!0,i,x);case 19:return Wv(i,c,x);case 22:return Vv(i,c,x)}throw Error(a(156,c.tag))};function y1(i,c){return Pe(i,c)}function lC(i,c,x,v){this.tag=i,this.key=x,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vr(i,c,x,v){return new lC(i,c,x,v)}function Im(i){return i=i.prototype,!(!i||!i.isReactComponent)}function oC(i){if(typeof i=="function")return Im(i)?1:0;if(i!=null){if(i=i.$$typeof,i===M)return 11;if(i===z)return 14}return 2}function Pi(i,c){var x=i.alternate;return x===null?(x=vr(i.tag,c,i.key,i.mode),x.elementType=i.elementType,x.type=i.type,x.stateNode=i.stateNode,x.alternate=i,i.alternate=x):(x.pendingProps=c,x.type=i.type,x.flags=0,x.subtreeFlags=0,x.deletions=null),x.flags=i.flags&14680064,x.childLanes=i.childLanes,x.lanes=i.lanes,x.child=i.child,x.memoizedProps=i.memoizedProps,x.memoizedState=i.memoizedState,x.updateQueue=i.updateQueue,c=i.dependencies,x.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},x.sibling=i.sibling,x.index=i.index,x.ref=i.ref,x}function Eh(i,c,x,v,w,D){var B=2;if(v=i,typeof i=="function")Im(i)&&(B=1);else if(typeof i=="string")B=5;else e:switch(i){case j:return _l(x.children,w,D,c);case A:B=8,w|=8;break;case L:return i=vr(12,x,c,w|2),i.elementType=L,i.lanes=D,i;case q:return i=vr(13,x,c,w),i.elementType=q,i.lanes=D,i;case ee:return i=vr(19,x,c,w),i.elementType=ee,i.lanes=D,i;case ae:return Dh(x,w,D,c);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case W:B=10;break e;case R:B=9;break e;case M:B=11;break e;case z:B=14;break e;case fe:B=16,v=null;break e}throw Error(a(130,i==null?i:typeof i,""))}return c=vr(B,x,c,w),c.elementType=i,c.type=v,c.lanes=D,c}function _l(i,c,x,v){return i=vr(7,i,v,c),i.lanes=x,i}function Dh(i,c,x,v){return i=vr(22,i,v,c),i.elementType=ae,i.lanes=x,i.stateNode={isHidden:!1},i}function Mm(i,c,x){return i=vr(6,i,null,c),i.lanes=x,i}function Rm(i,c,x){return c=vr(4,i.children!==null?i.children:[],i.key,c),c.lanes=x,c.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},c}function cC(i,c,x,v,w){this.tag=c,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ux(0),this.expirationTimes=ux(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ux(0),this.identifierPrefix=v,this.onRecoverableError=w,this.mutableSourceEagerHydrationData=null}function Bm(i,c,x,v,w,D,B,ie,ue){return i=new cC(i,c,x,ie,ue),c===1?(c=1,D===!0&&(c|=8)):c=0,D=vr(3,null,null,c),i.current=D,D.stateNode=i,D.memoizedState={element:v,isDehydrated:x,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jx(D),i}function dC(i,c,x){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:P,key:v==null?null:""+v,children:i,containerInfo:c,implementation:x}}function v1(i){if(!i)return ki;i=i._reactInternals;e:{if(se(i)!==i||i.tag!==1)throw Error(a(170));var c=i;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Ha(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(a(171))}if(i.tag===1){var x=i.type;if(Ha(x))return qy(i,x,c)}return c}function b1(i,c,x,v,w,D,B,ie,ue){return i=Bm(x,v,!0,i,w,D,B,ie,ue),i.context=v1(null),x=i.current,v=_a(),w=Fi(x),D=Rs(v,w),D.callback=c??null,Si(x,D,w),i.current.lanes=w,Uc(i,w,v),Ka(i,v),i}function Fh(i,c,x,v){var w=c.current,D=_a(),B=Fi(w);return x=v1(x),c.context===null?c.context=x:c.pendingContext=x,c=Rs(D,B),c.payload={element:i},v=v===void 0?null:v,v!==null&&(c.callback=v),i=Si(w,c,B),i!==null&&(Gr(i,w,B,D),oh(i,w,B)),B}function Ah(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function N1(i,c){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var x=i.retryLane;i.retryLane=x!==0&&x<c?x:c}}function Hm(i,c){N1(i,c),(i=i.alternate)&&N1(i,c)}function uC(){return null}var j1=typeof reportError=="function"?reportError:function(i){console.error(i)};function Vm(i){this._internalRoot=i}Ph.prototype.render=Vm.prototype.render=function(i){var c=this._internalRoot;if(c===null)throw Error(a(409));Fh(i,c,null,null)},Ph.prototype.unmount=Vm.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var c=i.containerInfo;Tl(function(){Fh(null,i,null,null)}),c[Ps]=null}};function Ph(i){this._internalRoot=i}Ph.prototype.unstable_scheduleHydration=function(i){if(i){var c=sy();i={blockedOn:null,target:i,priority:c};for(var x=0;x<vi.length&&c!==0&&c<vi[x].priority;x++);vi.splice(x,0,i),x===0&&oy(i)}};function Um(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Lh(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function w1(){}function hC(i,c,x,v,w){if(w){if(typeof v=="function"){var D=v;v=function(){var ke=Ah(B);D.call(ke)}}var B=b1(c,v,i,0,null,!1,!1,"",w1);return i._reactRootContainer=B,i[Ps]=B.current,nd(i.nodeType===8?i.parentNode:i),Tl(),B}for(;w=i.lastChild;)i.removeChild(w);if(typeof v=="function"){var ie=v;v=function(){var ke=Ah(ue);ie.call(ke)}}var ue=Bm(i,0,!1,null,null,!1,!1,"",w1);return i._reactRootContainer=ue,i[Ps]=ue.current,nd(i.nodeType===8?i.parentNode:i),Tl(function(){Fh(c,ue,x,v)}),ue}function Oh(i,c,x,v,w){var D=x._reactRootContainer;if(D){var B=D;if(typeof w=="function"){var ie=w;w=function(){var ue=Ah(B);ie.call(ue)}}Fh(c,B,i,w)}else B=hC(x,c,i,w,v);return Ah(B)}ay=function(i){switch(i.tag){case 3:var c=i.stateNode;if(c.current.memoizedState.isDehydrated){var x=Vc(c.pendingLanes);x!==0&&(hx(c,x|1),Ka(c,Oe()),(_t&6)===0&&(zo=Oe()+500,Ti()))}break;case 13:Tl(function(){var v=Ms(i,1);if(v!==null){var w=_a();Gr(v,i,1,w)}}),Hm(i,1)}},xx=function(i){if(i.tag===13){var c=Ms(i,134217728);if(c!==null){var x=_a();Gr(c,i,134217728,x)}Hm(i,134217728)}},ry=function(i){if(i.tag===13){var c=Fi(i),x=Ms(i,c);if(x!==null){var v=_a();Gr(x,i,c,v)}Hm(i,c)}},sy=function(){return Ut},iy=function(i,c){var x=Ut;try{return Ut=i,c()}finally{Ut=x}},jo=function(i,c,x){switch(c){case"input":if(Be(i,x),c=x.name,x.type==="radio"&&c!=null){for(x=i;x.parentNode;)x=x.parentNode;for(x=x.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<x.length;c++){var v=x[c];if(v!==i&&v.form===i.form){var w=Ju(v);if(!w)throw Error(a(90));X(v),Be(v,w)}}}break;case"textarea":He(i,x);break;case"select":c=x.value,c!=null&&$n(i,!!x.multiple,c,!1)}},Fu=Pm,Au=Tl;var xC={usingClientEntryPoint:!1,Events:[sd,Fo,Ju,Eu,Du,Pm]},vd={findFiberByHostInstance:gl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mC={bundleType:vd.bundleType,version:vd.version,rendererPackageName:vd.rendererPackageName,rendererConfig:vd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=je(i),i===null?null:i.stateNode},findFiberByHostInstance:vd.findFiberByHostInstance||uC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ih=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ih.isDisabled&&Ih.supportsFiber)try{rs=Ih.inject(mC),qn=Ih}catch{}}return za.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xC,za.createPortal=function(i,c){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Um(c))throw Error(a(200));return dC(i,c,null,x)},za.createRoot=function(i,c){if(!Um(i))throw Error(a(299));var x=!1,v="",w=j1;return c!=null&&(c.unstable_strictMode===!0&&(x=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onRecoverableError!==void 0&&(w=c.onRecoverableError)),c=Bm(i,1,!1,null,null,x,!1,v,w),i[Ps]=c.current,nd(i.nodeType===8?i.parentNode:i),new Vm(c)},za.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var c=i._reactInternals;if(c===void 0)throw typeof i.render=="function"?Error(a(188)):(i=Object.keys(i).join(","),Error(a(268,i)));return i=je(c),i=i===null?null:i.stateNode,i},za.flushSync=function(i){return Tl(i)},za.hydrate=function(i,c,x){if(!Lh(c))throw Error(a(200));return Oh(null,i,c,!0,x)},za.hydrateRoot=function(i,c,x){if(!Um(i))throw Error(a(405));var v=x!=null&&x.hydratedSources||null,w=!1,D="",B=j1;if(x!=null&&(x.unstable_strictMode===!0&&(w=!0),x.identifierPrefix!==void 0&&(D=x.identifierPrefix),x.onRecoverableError!==void 0&&(B=x.onRecoverableError)),c=b1(c,null,i,1,x??null,w,!1,D,B),i[Ps]=c.current,nd(i),v)for(i=0;i<v.length;i++)x=v[i],w=x._getVersion,w=w(x._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[x,w]:c.mutableSourceEagerHydrationData.push(x,w);return new Ph(c)},za.render=function(i,c,x){if(!Lh(c))throw Error(a(200));return Oh(null,i,c,!1,x)},za.unmountComponentAtNode=function(i){if(!Lh(i))throw Error(a(40));return i._reactRootContainer?(Tl(function(){Oh(null,null,i,!1,function(){i._reactRootContainer=null,i[Ps]=null})}),!0):!1},za.unstable_batchedUpdates=Pm,za.unstable_renderSubtreeIntoContainer=function(i,c,x,v){if(!Lh(x))throw Error(a(200));if(i==null||i._reactInternals===void 0)throw Error(a(38));return Oh(i,c,x,!1,v)},za.version="18.3.1-next-f1338f8080-20240426",za}var A1;function T2(){if(A1)return qm.exports;A1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),qm.exports=TC(),qm.exports}var P1;function CC(){if(P1)return Rh;P1=1;var e=T2();return Rh.createRoot=e.createRoot,Rh.hydrateRoot=e.hydrateRoot,Rh}var SC=CC(),_c=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},_C={setTimeout:(e,n)=>setTimeout(e,n),clearTimeout:e=>clearTimeout(e),setInterval:(e,n)=>setInterval(e,n),clearInterval:e=>clearInterval(e)},Ri,Pp,x2,EC=(x2=class{constructor(){tt(this,Ri,_C);tt(this,Pp,!1)}setTimeoutProvider(e){$e(this,Ri,e)}setTimeout(e,n){return de(this,Ri).setTimeout(e,n)}clearTimeout(e){de(this,Ri).clearTimeout(e)}setInterval(e,n){return de(this,Ri).setInterval(e,n)}clearInterval(e){de(this,Ri).clearInterval(e)}},Ri=new WeakMap,Pp=new WeakMap,x2),Il=new EC;function DC(e){setTimeout(e,0)}var eo=typeof window>"u"||"Deno"in globalThis;function Fa(){}function FC(e,n){return typeof e=="function"?e(n):e}function Bf(e){return typeof e=="number"&&e>=0&&e!==1/0}function C2(e,n){return Math.max(e+(n||0)-Date.now(),0)}function Zi(e,n){return typeof e=="function"?e(n):e}function Sr(e,n){return typeof e=="function"?e(n):e}function L1(e,n){const{type:a="all",exact:r,fetchStatus:s,predicate:l,queryKey:o,stale:d}=e;if(o){if(r){if(n.queryHash!==Ip(o,n.options))return!1}else if(!zd(n.queryKey,o))return!1}if(a!=="all"){const u=n.isActive();if(a==="active"&&!u||a==="inactive"&&u)return!1}return!(typeof d=="boolean"&&n.isStale()!==d||s&&s!==n.state.fetchStatus||l&&!l(n))}function O1(e,n){const{exact:a,status:r,predicate:s,mutationKey:l}=e;if(l){if(!n.options.mutationKey)return!1;if(a){if(to(n.options.mutationKey)!==to(l))return!1}else if(!zd(n.options.mutationKey,l))return!1}return!(r&&n.state.status!==r||s&&!s(n))}function Ip(e,n){return((n==null?void 0:n.queryKeyHashFn)||to)(e)}function to(e){return JSON.stringify(e,(n,a)=>Hf(a)?Object.keys(a).sort().reduce((r,s)=>(r[s]=a[s],r),{}):a)}function zd(e,n){return e===n?!0:typeof e!=typeof n?!1:e&&n&&typeof e=="object"&&typeof n=="object"?Object.keys(n).every(a=>zd(e[a],n[a])):!1}var AC=Object.prototype.hasOwnProperty;function S2(e,n){if(e===n)return e;const a=I1(e)&&I1(n);if(!a&&!(Hf(e)&&Hf(n)))return n;const s=(a?e:Object.keys(e)).length,l=a?n:Object.keys(n),o=l.length,d=a?new Array(o):{};let u=0;for(let h=0;h<o;h++){const m=a?h:l[h],f=e[m],p=n[m];if(f===p){d[m]=f,(a?h<s:AC.call(e,m))&&u++;continue}if(f===null||p===null||typeof f!="object"||typeof p!="object"){d[m]=p;continue}const b=S2(f,p);d[m]=b,b===f&&u++}return s===o&&u===s?e:d}function d0(e,n){if(!n||Object.keys(e).length!==Object.keys(n).length)return!1;for(const a in e)if(e[a]!==n[a])return!1;return!0}function I1(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Hf(e){if(!M1(e))return!1;const n=e.constructor;if(n===void 0)return!0;const a=n.prototype;return!(!M1(a)||!a.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function M1(e){return Object.prototype.toString.call(e)==="[object Object]"}function PC(e){return new Promise(n=>{Il.setTimeout(n,e)})}function Vf(e,n,a){return typeof a.structuralSharing=="function"?a.structuralSharing(e,n):a.structuralSharing!==!1?S2(e,n):n}function LC(e,n,a=0){const r=[...e,n];return a&&r.length>a?r.slice(1):r}function OC(e,n,a=0){const r=[n,...e];return a&&r.length>a?r.slice(0,-1):r}var Mp=Symbol();function _2(e,n){return!e.queryFn&&(n!=null&&n.initialPromise)?()=>n.initialPromise:!e.queryFn||e.queryFn===Mp?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function Rp(e,n){return typeof e=="function"?e(...n):!!e}function IC(e,n,a){let r=!1,s;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(s??(s=n()),r||(r=!0,s.aborted?a():s.addEventListener("abort",a,{once:!0})),s)}),e}var Hl,Bi,oc,m2,MC=(m2=class extends _c{constructor(){super();tt(this,Hl);tt(this,Bi);tt(this,oc);$e(this,oc,n=>{if(!eo&&window.addEventListener){const a=()=>n();return window.addEventListener("visibilitychange",a,!1),()=>{window.removeEventListener("visibilitychange",a)}}})}onSubscribe(){de(this,Bi)||this.setEventListener(de(this,oc))}onUnsubscribe(){var n;this.hasListeners()||((n=de(this,Bi))==null||n.call(this),$e(this,Bi,void 0))}setEventListener(n){var a;$e(this,oc,n),(a=de(this,Bi))==null||a.call(this),$e(this,Bi,n(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(n){de(this,Hl)!==n&&($e(this,Hl,n),this.onFocus())}onFocus(){const n=this.isFocused();this.listeners.forEach(a=>{a(n)})}isFocused(){var n;return typeof de(this,Hl)=="boolean"?de(this,Hl):((n=globalThis.document)==null?void 0:n.visibilityState)!=="hidden"}},Hl=new WeakMap,Bi=new WeakMap,oc=new WeakMap,m2),Bp=new MC;function Uf(){let e,n;const a=new Promise((s,l)=>{e=s,n=l});a.status="pending",a.catch(()=>{});function r(s){Object.assign(a,s),delete a.resolve,delete a.reject}return a.resolve=s=>{r({status:"fulfilled",value:s}),e(s)},a.reject=s=>{r({status:"rejected",reason:s}),n(s)},a}var RC=DC;function BC(){let e=[],n=0,a=d=>{d()},r=d=>{d()},s=RC;const l=d=>{n?e.push(d):s(()=>{a(d)})},o=()=>{const d=e;e=[],d.length&&s(()=>{r(()=>{d.forEach(u=>{a(u)})})})};return{batch:d=>{let u;n++;try{u=d()}finally{n--,n||o()}return u},batchCalls:d=>(...u)=>{l(()=>{d(...u)})},schedule:l,setNotifyFunction:d=>{a=d},setBatchNotifyFunction:d=>{r=d},setScheduler:d=>{s=d}}}var Vn=BC(),cc,Hi,dc,f2,HC=(f2=class extends _c{constructor(){super();tt(this,cc,!0);tt(this,Hi);tt(this,dc);$e(this,dc,n=>{if(!eo&&window.addEventListener){const a=()=>n(!0),r=()=>n(!1);return window.addEventListener("online",a,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",a),window.removeEventListener("offline",r)}}})}onSubscribe(){de(this,Hi)||this.setEventListener(de(this,dc))}onUnsubscribe(){var n;this.hasListeners()||((n=de(this,Hi))==null||n.call(this),$e(this,Hi,void 0))}setEventListener(n){var a;$e(this,dc,n),(a=de(this,Hi))==null||a.call(this),$e(this,Hi,n(this.setOnline.bind(this)))}setOnline(n){de(this,cc)!==n&&($e(this,cc,n),this.listeners.forEach(r=>{r(n)}))}isOnline(){return de(this,cc)}},cc=new WeakMap,Hi=new WeakMap,dc=new WeakMap,f2),u0=new HC;function VC(e){return Math.min(1e3*2**e,3e4)}function E2(e){return(e??"online")==="online"?u0.isOnline():!0}var Kf=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function D2(e){let n=!1,a=0,r;const s=Uf(),l=()=>s.status!=="pending",o=y=>{var N;if(!l()){const C=new Kf(y);p(C),(N=e.onCancel)==null||N.call(e,C)}},d=()=>{n=!0},u=()=>{n=!1},h=()=>Bp.isFocused()&&(e.networkMode==="always"||u0.isOnline())&&e.canRun(),m=()=>E2(e.networkMode)&&e.canRun(),f=y=>{l()||(r==null||r(),s.resolve(y))},p=y=>{l()||(r==null||r(),s.reject(y))},b=()=>new Promise(y=>{var N;r=C=>{(l()||h())&&y(C)},(N=e.onPause)==null||N.call(e)}).then(()=>{var y;r=void 0,l()||(y=e.onContinue)==null||y.call(e)}),g=()=>{if(l())return;let y;const N=a===0?e.initialPromise:void 0;try{y=N??e.fn()}catch(C){y=Promise.reject(C)}Promise.resolve(y).then(f).catch(C=>{var P;if(l())return;const T=e.retry??(eo?0:3),S=e.retryDelay??VC,k=typeof S=="function"?S(a,C):S,_=T===!0||typeof T=="number"&&a<T||typeof T=="function"&&T(a,C);if(n||!_){p(C);return}a++,(P=e.onFail)==null||P.call(e,a,C),PC(k).then(()=>h()?void 0:b()).then(()=>{n?p(C):g()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r==null||r(),s),cancelRetry:d,continueRetry:u,canStart:m,start:()=>(m()?g():b().then(g),s)}}var Vl,p2,F2=(p2=class{constructor(){tt(this,Vl)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Bf(this.gcTime)&&$e(this,Vl,Il.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(eo?1/0:300*1e3))}clearGcTimeout(){de(this,Vl)&&(Il.clearTimeout(de(this,Vl)),$e(this,Vl,void 0))}},Vl=new WeakMap,p2),Ul,uc,Tr,Kl,Yn,cu,zl,Wr,Us,g2,UC=(g2=class extends F2{constructor(n){super();tt(this,Wr);tt(this,Ul);tt(this,uc);tt(this,Tr);tt(this,Kl);tt(this,Yn);tt(this,cu);tt(this,zl);$e(this,zl,!1),$e(this,cu,n.defaultOptions),this.setOptions(n.options),this.observers=[],$e(this,Kl,n.client),$e(this,Tr,de(this,Kl).getQueryCache()),this.queryKey=n.queryKey,this.queryHash=n.queryHash,$e(this,Ul,B1(this.options)),this.state=n.state??de(this,Ul),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var n;return(n=de(this,Yn))==null?void 0:n.promise}setOptions(n){if(this.options={...de(this,cu),...n},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const a=B1(this.options);a.data!==void 0&&(this.setState(R1(a.data,a.dataUpdatedAt)),$e(this,Ul,a))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&de(this,Tr).remove(this)}setData(n,a){const r=Vf(this.state.data,n,this.options);return yt(this,Wr,Us).call(this,{data:r,type:"success",dataUpdatedAt:a==null?void 0:a.updatedAt,manual:a==null?void 0:a.manual}),r}setState(n,a){yt(this,Wr,Us).call(this,{type:"setState",state:n,setStateOptions:a})}cancel(n){var r,s;const a=(r=de(this,Yn))==null?void 0:r.promise;return(s=de(this,Yn))==null||s.cancel(n),a?a.then(Fa).catch(Fa):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(de(this,Ul))}isActive(){return this.observers.some(n=>Sr(n.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Mp||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(n=>Zi(n.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(n=>n.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(n=0){return this.state.data===void 0?!0:n==="static"?!1:this.state.isInvalidated?!0:!C2(this.state.dataUpdatedAt,n)}onFocus(){var a;const n=this.observers.find(r=>r.shouldFetchOnWindowFocus());n==null||n.refetch({cancelRefetch:!1}),(a=de(this,Yn))==null||a.continue()}onOnline(){var a;const n=this.observers.find(r=>r.shouldFetchOnReconnect());n==null||n.refetch({cancelRefetch:!1}),(a=de(this,Yn))==null||a.continue()}addObserver(n){this.observers.includes(n)||(this.observers.push(n),this.clearGcTimeout(),de(this,Tr).notify({type:"observerAdded",query:this,observer:n}))}removeObserver(n){this.observers.includes(n)&&(this.observers=this.observers.filter(a=>a!==n),this.observers.length||(de(this,Yn)&&(de(this,zl)?de(this,Yn).cancel({revert:!0}):de(this,Yn).cancelRetry()),this.scheduleGc()),de(this,Tr).notify({type:"observerRemoved",query:this,observer:n}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||yt(this,Wr,Us).call(this,{type:"invalidate"})}async fetch(n,a){var u,h,m,f,p,b,g,y,N,C,T,S;if(this.state.fetchStatus!=="idle"&&((u=de(this,Yn))==null?void 0:u.status())!=="rejected"){if(this.state.data!==void 0&&(a!=null&&a.cancelRefetch))this.cancel({silent:!0});else if(de(this,Yn))return de(this,Yn).continueRetry(),de(this,Yn).promise}if(n&&this.setOptions(n),!this.options.queryFn){const k=this.observers.find(_=>_.options.queryFn);k&&this.setOptions(k.options)}const r=new AbortController,s=k=>{Object.defineProperty(k,"signal",{enumerable:!0,get:()=>($e(this,zl,!0),r.signal)})},l=()=>{const k=_2(this.options,a),P=(()=>{const j={client:de(this,Kl),queryKey:this.queryKey,meta:this.meta};return s(j),j})();return $e(this,zl,!1),this.options.persister?this.options.persister(k,P,this):k(P)},d=(()=>{const k={fetchOptions:a,options:this.options,queryKey:this.queryKey,client:de(this,Kl),state:this.state,fetchFn:l};return s(k),k})();(h=this.options.behavior)==null||h.onFetch(d,this),$e(this,uc,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((m=d.fetchOptions)==null?void 0:m.meta))&&yt(this,Wr,Us).call(this,{type:"fetch",meta:(f=d.fetchOptions)==null?void 0:f.meta}),$e(this,Yn,D2({initialPromise:a==null?void 0:a.initialPromise,fn:d.fetchFn,onCancel:k=>{k instanceof Kf&&k.revert&&this.setState({...de(this,uc),fetchStatus:"idle"}),r.abort()},onFail:(k,_)=>{yt(this,Wr,Us).call(this,{type:"failed",failureCount:k,error:_})},onPause:()=>{yt(this,Wr,Us).call(this,{type:"pause"})},onContinue:()=>{yt(this,Wr,Us).call(this,{type:"continue"})},retry:d.options.retry,retryDelay:d.options.retryDelay,networkMode:d.options.networkMode,canRun:()=>!0}));try{const k=await de(this,Yn).start();if(k===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(k),(b=(p=de(this,Tr).config).onSuccess)==null||b.call(p,k,this),(y=(g=de(this,Tr).config).onSettled)==null||y.call(g,k,this.state.error,this),k}catch(k){if(k instanceof Kf){if(k.silent)return de(this,Yn).promise;if(k.revert){if(this.state.data===void 0)throw k;return this.state.data}}throw yt(this,Wr,Us).call(this,{type:"error",error:k}),(C=(N=de(this,Tr).config).onError)==null||C.call(N,k,this),(S=(T=de(this,Tr).config).onSettled)==null||S.call(T,this.state.data,k,this),k}finally{this.scheduleGc()}}},Ul=new WeakMap,uc=new WeakMap,Tr=new WeakMap,Kl=new WeakMap,Yn=new WeakMap,cu=new WeakMap,zl=new WeakMap,Wr=new WeakSet,Us=function(n){const a=r=>{switch(n.type){case"failed":return{...r,fetchFailureCount:n.failureCount,fetchFailureReason:n.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...A2(r.data,this.options),fetchMeta:n.meta??null};case"success":const s={...r,...R1(n.data,n.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!n.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return $e(this,uc,n.manual?s:void 0),s;case"error":const l=n.error;return{...r,error:l,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...n.state}}};this.state=a(this.state),Vn.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),de(this,Tr).notify({query:this,type:"updated",action:n})})},g2);function A2(e,n){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:E2(n.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function R1(e,n){return{data:e,dataUpdatedAt:n??Date.now(),error:null,isInvalidated:!1,status:"success"}}function B1(e){const n=typeof e.initialData=="function"?e.initialData():e.initialData,a=n!==void 0,r=a?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:n,dataUpdateCount:0,dataUpdatedAt:a?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:a?"success":"pending",fetchStatus:"idle"}}var $a,wt,du,Ea,$l,hc,$s,Vi,uu,xc,mc,Gl,ql,Ui,fc,Vt,_d,zf,$f,Gf,qf,Wf,Xf,Qf,P2,y2,KC=(y2=class extends _c{constructor(n,a){super();tt(this,Vt);tt(this,$a);tt(this,wt);tt(this,du);tt(this,Ea);tt(this,$l);tt(this,hc);tt(this,$s);tt(this,Vi);tt(this,uu);tt(this,xc);tt(this,mc);tt(this,Gl);tt(this,ql);tt(this,Ui);tt(this,fc,new Set);this.options=a,$e(this,$a,n),$e(this,Vi,null),$e(this,$s,Uf()),this.bindMethods(),this.setOptions(a)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(de(this,wt).addObserver(this),H1(de(this,wt),this.options)?yt(this,Vt,_d).call(this):this.updateResult(),yt(this,Vt,qf).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Yf(de(this,wt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Yf(de(this,wt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,yt(this,Vt,Wf).call(this),yt(this,Vt,Xf).call(this),de(this,wt).removeObserver(this)}setOptions(n){const a=this.options,r=de(this,wt);if(this.options=de(this,$a).defaultQueryOptions(n),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Sr(this.options.enabled,de(this,wt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");yt(this,Vt,Qf).call(this),de(this,wt).setOptions(this.options),a._defaulted&&!d0(this.options,a)&&de(this,$a).getQueryCache().notify({type:"observerOptionsUpdated",query:de(this,wt),observer:this});const s=this.hasListeners();s&&V1(de(this,wt),r,this.options,a)&&yt(this,Vt,_d).call(this),this.updateResult(),s&&(de(this,wt)!==r||Sr(this.options.enabled,de(this,wt))!==Sr(a.enabled,de(this,wt))||Zi(this.options.staleTime,de(this,wt))!==Zi(a.staleTime,de(this,wt)))&&yt(this,Vt,zf).call(this);const l=yt(this,Vt,$f).call(this);s&&(de(this,wt)!==r||Sr(this.options.enabled,de(this,wt))!==Sr(a.enabled,de(this,wt))||l!==de(this,Ui))&&yt(this,Vt,Gf).call(this,l)}getOptimisticResult(n){const a=de(this,$a).getQueryCache().build(de(this,$a),n),r=this.createResult(a,n);return $C(this,r)&&($e(this,Ea,r),$e(this,hc,this.options),$e(this,$l,de(this,wt).state)),r}getCurrentResult(){return de(this,Ea)}trackResult(n,a){return new Proxy(n,{get:(r,s)=>(this.trackProp(s),a==null||a(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&de(this,$s).status==="pending"&&de(this,$s).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,s))})}trackProp(n){de(this,fc).add(n)}getCurrentQuery(){return de(this,wt)}refetch({...n}={}){return this.fetch({...n})}fetchOptimistic(n){const a=de(this,$a).defaultQueryOptions(n),r=de(this,$a).getQueryCache().build(de(this,$a),a);return r.fetch().then(()=>this.createResult(r,a))}fetch(n){return yt(this,Vt,_d).call(this,{...n,cancelRefetch:n.cancelRefetch??!0}).then(()=>(this.updateResult(),de(this,Ea)))}createResult(n,a){var L;const r=de(this,wt),s=this.options,l=de(this,Ea),o=de(this,$l),d=de(this,hc),h=n!==r?n.state:de(this,du),{state:m}=n;let f={...m},p=!1,b;if(a._optimisticResults){const W=this.hasListeners(),R=!W&&H1(n,a),M=W&&V1(n,r,a,s);(R||M)&&(f={...f,...A2(m.data,n.options)}),a._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:g,errorUpdatedAt:y,status:N}=f;b=f.data;let C=!1;if(a.placeholderData!==void 0&&b===void 0&&N==="pending"){let W;l!=null&&l.isPlaceholderData&&a.placeholderData===(d==null?void 0:d.placeholderData)?(W=l.data,C=!0):W=typeof a.placeholderData=="function"?a.placeholderData((L=de(this,mc))==null?void 0:L.state.data,de(this,mc)):a.placeholderData,W!==void 0&&(N="success",b=Vf(l==null?void 0:l.data,W,a),p=!0)}if(a.select&&b!==void 0&&!C)if(l&&b===(o==null?void 0:o.data)&&a.select===de(this,uu))b=de(this,xc);else try{$e(this,uu,a.select),b=a.select(b),b=Vf(l==null?void 0:l.data,b,a),$e(this,xc,b),$e(this,Vi,null)}catch(W){$e(this,Vi,W)}de(this,Vi)&&(g=de(this,Vi),b=de(this,xc),y=Date.now(),N="error");const T=f.fetchStatus==="fetching",S=N==="pending",k=N==="error",_=S&&T,P=b!==void 0,A={status:N,fetchStatus:f.fetchStatus,isPending:S,isSuccess:N==="success",isError:k,isInitialLoading:_,isLoading:_,data:b,dataUpdatedAt:f.dataUpdatedAt,error:g,errorUpdatedAt:y,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>h.dataUpdateCount||f.errorUpdateCount>h.errorUpdateCount,isFetching:T,isRefetching:T&&!S,isLoadingError:k&&!P,isPaused:f.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:k&&P,isStale:Hp(n,a),refetch:this.refetch,promise:de(this,$s),isEnabled:Sr(a.enabled,n)!==!1};if(this.options.experimental_prefetchInRender){const W=q=>{A.status==="error"?q.reject(A.error):A.data!==void 0&&q.resolve(A.data)},R=()=>{const q=$e(this,$s,A.promise=Uf());W(q)},M=de(this,$s);switch(M.status){case"pending":n.queryHash===r.queryHash&&W(M);break;case"fulfilled":(A.status==="error"||A.data!==M.value)&&R();break;case"rejected":(A.status!=="error"||A.error!==M.reason)&&R();break}}return A}updateResult(){const n=de(this,Ea),a=this.createResult(de(this,wt),this.options);if($e(this,$l,de(this,wt).state),$e(this,hc,this.options),de(this,$l).data!==void 0&&$e(this,mc,de(this,wt)),d0(a,n))return;$e(this,Ea,a);const r=()=>{if(!n)return!0;const{notifyOnChangeProps:s}=this.options,l=typeof s=="function"?s():s;if(l==="all"||!l&&!de(this,fc).size)return!0;const o=new Set(l??de(this,fc));return this.options.throwOnError&&o.add("error"),Object.keys(de(this,Ea)).some(d=>{const u=d;return de(this,Ea)[u]!==n[u]&&o.has(u)})};yt(this,Vt,P2).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&yt(this,Vt,qf).call(this)}},$a=new WeakMap,wt=new WeakMap,du=new WeakMap,Ea=new WeakMap,$l=new WeakMap,hc=new WeakMap,$s=new WeakMap,Vi=new WeakMap,uu=new WeakMap,xc=new WeakMap,mc=new WeakMap,Gl=new WeakMap,ql=new WeakMap,Ui=new WeakMap,fc=new WeakMap,Vt=new WeakSet,_d=function(n){yt(this,Vt,Qf).call(this);let a=de(this,wt).fetch(this.options,n);return n!=null&&n.throwOnError||(a=a.catch(Fa)),a},zf=function(){yt(this,Vt,Wf).call(this);const n=Zi(this.options.staleTime,de(this,wt));if(eo||de(this,Ea).isStale||!Bf(n))return;const r=C2(de(this,Ea).dataUpdatedAt,n)+1;$e(this,Gl,Il.setTimeout(()=>{de(this,Ea).isStale||this.updateResult()},r))},$f=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(de(this,wt)):this.options.refetchInterval)??!1},Gf=function(n){yt(this,Vt,Xf).call(this),$e(this,Ui,n),!(eo||Sr(this.options.enabled,de(this,wt))===!1||!Bf(de(this,Ui))||de(this,Ui)===0)&&$e(this,ql,Il.setInterval(()=>{(this.options.refetchIntervalInBackground||Bp.isFocused())&&yt(this,Vt,_d).call(this)},de(this,Ui)))},qf=function(){yt(this,Vt,zf).call(this),yt(this,Vt,Gf).call(this,yt(this,Vt,$f).call(this))},Wf=function(){de(this,Gl)&&(Il.clearTimeout(de(this,Gl)),$e(this,Gl,void 0))},Xf=function(){de(this,ql)&&(Il.clearInterval(de(this,ql)),$e(this,ql,void 0))},Qf=function(){const n=de(this,$a).getQueryCache().build(de(this,$a),this.options);if(n===de(this,wt))return;const a=de(this,wt);$e(this,wt,n),$e(this,du,n.state),this.hasListeners()&&(a==null||a.removeObserver(this),n.addObserver(this))},P2=function(n){Vn.batch(()=>{n.listeners&&this.listeners.forEach(a=>{a(de(this,Ea))}),de(this,$a).getQueryCache().notify({query:de(this,wt),type:"observerResultsUpdated"})})},y2);function zC(e,n){return Sr(n.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&n.retryOnMount===!1)}function H1(e,n){return zC(e,n)||e.state.data!==void 0&&Yf(e,n,n.refetchOnMount)}function Yf(e,n,a){if(Sr(n.enabled,e)!==!1&&Zi(n.staleTime,e)!=="static"){const r=typeof a=="function"?a(e):a;return r==="always"||r!==!1&&Hp(e,n)}return!1}function V1(e,n,a,r){return(e!==n||Sr(r.enabled,e)===!1)&&(!a.suspense||e.state.status!=="error")&&Hp(e,a)}function Hp(e,n){return Sr(n.enabled,e)!==!1&&e.isStaleByTime(Zi(n.staleTime,e))}function $C(e,n){return!d0(e.getCurrentResult(),n)}function U1(e){return{onFetch:(n,a)=>{var m,f,p,b,g;const r=n.options,s=(p=(f=(m=n.fetchOptions)==null?void 0:m.meta)==null?void 0:f.fetchMore)==null?void 0:p.direction,l=((b=n.state.data)==null?void 0:b.pages)||[],o=((g=n.state.data)==null?void 0:g.pageParams)||[];let d={pages:[],pageParams:[]},u=0;const h=async()=>{let y=!1;const N=S=>{IC(S,()=>n.signal,()=>y=!0)},C=_2(n.options,n.fetchOptions),T=async(S,k,_)=>{if(y)return Promise.reject();if(k==null&&S.pages.length)return Promise.resolve(S);const j=(()=>{const R={client:n.client,queryKey:n.queryKey,pageParam:k,direction:_?"backward":"forward",meta:n.options.meta};return N(R),R})(),A=await C(j),{maxPages:L}=n.options,W=_?OC:LC;return{pages:W(S.pages,A,L),pageParams:W(S.pageParams,k,L)}};if(s&&l.length){const S=s==="backward",k=S?GC:K1,_={pages:l,pageParams:o},P=k(r,_);d=await T(_,P,S)}else{const S=e??l.length;do{const k=u===0?o[0]??r.initialPageParam:K1(r,d);if(u>0&&k==null)break;d=await T(d,k),u++}while(u<S)}return d};n.options.persister?n.fetchFn=()=>{var y,N;return(N=(y=n.options).persister)==null?void 0:N.call(y,h,{client:n.client,queryKey:n.queryKey,meta:n.options.meta,signal:n.signal},a)}:n.fetchFn=h}}}function K1(e,{pages:n,pageParams:a}){const r=n.length-1;return n.length>0?e.getNextPageParam(n[r],n,a[r],a):void 0}function GC(e,{pages:n,pageParams:a}){var r;return n.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,n[0],n,a[0],a):void 0}var hu,fs,Da,Wl,ps,Ii,v2,qC=(v2=class extends F2{constructor(n){super();tt(this,ps);tt(this,hu);tt(this,fs);tt(this,Da);tt(this,Wl);$e(this,hu,n.client),this.mutationId=n.mutationId,$e(this,Da,n.mutationCache),$e(this,fs,[]),this.state=n.state||L2(),this.setOptions(n.options),this.scheduleGc()}setOptions(n){this.options=n,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(n){de(this,fs).includes(n)||(de(this,fs).push(n),this.clearGcTimeout(),de(this,Da).notify({type:"observerAdded",mutation:this,observer:n}))}removeObserver(n){$e(this,fs,de(this,fs).filter(a=>a!==n)),this.scheduleGc(),de(this,Da).notify({type:"observerRemoved",mutation:this,observer:n})}optionalRemove(){de(this,fs).length||(this.state.status==="pending"?this.scheduleGc():de(this,Da).remove(this))}continue(){var n;return((n=de(this,Wl))==null?void 0:n.continue())??this.execute(this.state.variables)}async execute(n){var o,d,u,h,m,f,p,b,g,y,N,C,T,S,k,_,P,j,A,L;const a=()=>{yt(this,ps,Ii).call(this,{type:"continue"})},r={client:de(this,hu),meta:this.options.meta,mutationKey:this.options.mutationKey};$e(this,Wl,D2({fn:()=>this.options.mutationFn?this.options.mutationFn(n,r):Promise.reject(new Error("No mutationFn found")),onFail:(W,R)=>{yt(this,ps,Ii).call(this,{type:"failed",failureCount:W,error:R})},onPause:()=>{yt(this,ps,Ii).call(this,{type:"pause"})},onContinue:a,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>de(this,Da).canRun(this)}));const s=this.state.status==="pending",l=!de(this,Wl).canStart();try{if(s)a();else{yt(this,ps,Ii).call(this,{type:"pending",variables:n,isPaused:l}),await((d=(o=de(this,Da).config).onMutate)==null?void 0:d.call(o,n,this,r));const R=await((h=(u=this.options).onMutate)==null?void 0:h.call(u,n,r));R!==this.state.context&&yt(this,ps,Ii).call(this,{type:"pending",context:R,variables:n,isPaused:l})}const W=await de(this,Wl).start();return await((f=(m=de(this,Da).config).onSuccess)==null?void 0:f.call(m,W,n,this.state.context,this,r)),await((b=(p=this.options).onSuccess)==null?void 0:b.call(p,W,n,this.state.context,r)),await((y=(g=de(this,Da).config).onSettled)==null?void 0:y.call(g,W,null,this.state.variables,this.state.context,this,r)),await((C=(N=this.options).onSettled)==null?void 0:C.call(N,W,null,n,this.state.context,r)),yt(this,ps,Ii).call(this,{type:"success",data:W}),W}catch(W){try{await((S=(T=de(this,Da).config).onError)==null?void 0:S.call(T,W,n,this.state.context,this,r))}catch(R){Promise.reject(R)}try{await((_=(k=this.options).onError)==null?void 0:_.call(k,W,n,this.state.context,r))}catch(R){Promise.reject(R)}try{await((j=(P=de(this,Da).config).onSettled)==null?void 0:j.call(P,void 0,W,this.state.variables,this.state.context,this,r))}catch(R){Promise.reject(R)}try{await((L=(A=this.options).onSettled)==null?void 0:L.call(A,void 0,W,n,this.state.context,r))}catch(R){Promise.reject(R)}throw yt(this,ps,Ii).call(this,{type:"error",error:W}),W}finally{de(this,Da).runNext(this)}}},hu=new WeakMap,fs=new WeakMap,Da=new WeakMap,Wl=new WeakMap,ps=new WeakSet,Ii=function(n){const a=r=>{switch(n.type){case"failed":return{...r,failureCount:n.failureCount,failureReason:n.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:n.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:n.isPaused,status:"pending",variables:n.variables,submittedAt:Date.now()};case"success":return{...r,data:n.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:n.error,failureCount:r.failureCount+1,failureReason:n.error,isPaused:!1,status:"error"}}};this.state=a(this.state),Vn.batch(()=>{de(this,fs).forEach(r=>{r.onMutationUpdate(n)}),de(this,Da).notify({mutation:this,type:"updated",action:n})})},v2);function L2(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Gs,Xr,xu,b2,WC=(b2=class extends _c{constructor(n={}){super();tt(this,Gs);tt(this,Xr);tt(this,xu);this.config=n,$e(this,Gs,new Set),$e(this,Xr,new Map),$e(this,xu,0)}build(n,a,r){const s=new qC({client:n,mutationCache:this,mutationId:++Mh(this,xu)._,options:n.defaultMutationOptions(a),state:r});return this.add(s),s}add(n){de(this,Gs).add(n);const a=Bh(n);if(typeof a=="string"){const r=de(this,Xr).get(a);r?r.push(n):de(this,Xr).set(a,[n])}this.notify({type:"added",mutation:n})}remove(n){if(de(this,Gs).delete(n)){const a=Bh(n);if(typeof a=="string"){const r=de(this,Xr).get(a);if(r)if(r.length>1){const s=r.indexOf(n);s!==-1&&r.splice(s,1)}else r[0]===n&&de(this,Xr).delete(a)}}this.notify({type:"removed",mutation:n})}canRun(n){const a=Bh(n);if(typeof a=="string"){const r=de(this,Xr).get(a),s=r==null?void 0:r.find(l=>l.state.status==="pending");return!s||s===n}else return!0}runNext(n){var r;const a=Bh(n);if(typeof a=="string"){const s=(r=de(this,Xr).get(a))==null?void 0:r.find(l=>l!==n&&l.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Vn.batch(()=>{de(this,Gs).forEach(n=>{this.notify({type:"removed",mutation:n})}),de(this,Gs).clear(),de(this,Xr).clear()})}getAll(){return Array.from(de(this,Gs))}find(n){const a={exact:!0,...n};return this.getAll().find(r=>O1(a,r))}findAll(n={}){return this.getAll().filter(a=>O1(n,a))}notify(n){Vn.batch(()=>{this.listeners.forEach(a=>{a(n)})})}resumePausedMutations(){const n=this.getAll().filter(a=>a.state.isPaused);return Vn.batch(()=>Promise.all(n.map(a=>a.continue().catch(Fa))))}},Gs=new WeakMap,Xr=new WeakMap,xu=new WeakMap,b2);function Bh(e){var n;return(n=e.options.scope)==null?void 0:n.id}var qs,Ki,Ga,Ws,ri,a0,Jf,N2,XC=(N2=class extends _c{constructor(a,r){super();tt(this,ri);tt(this,qs);tt(this,Ki);tt(this,Ga);tt(this,Ws);$e(this,qs,a),this.setOptions(r),this.bindMethods(),yt(this,ri,a0).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(a){var s;const r=this.options;this.options=de(this,qs).defaultMutationOptions(a),d0(this.options,r)||de(this,qs).getMutationCache().notify({type:"observerOptionsUpdated",mutation:de(this,Ga),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&to(r.mutationKey)!==to(this.options.mutationKey)?this.reset():((s=de(this,Ga))==null?void 0:s.state.status)==="pending"&&de(this,Ga).setOptions(this.options)}onUnsubscribe(){var a;this.hasListeners()||(a=de(this,Ga))==null||a.removeObserver(this)}onMutationUpdate(a){yt(this,ri,a0).call(this),yt(this,ri,Jf).call(this,a)}getCurrentResult(){return de(this,Ki)}reset(){var a;(a=de(this,Ga))==null||a.removeObserver(this),$e(this,Ga,void 0),yt(this,ri,a0).call(this),yt(this,ri,Jf).call(this)}mutate(a,r){var s;return $e(this,Ws,r),(s=de(this,Ga))==null||s.removeObserver(this),$e(this,Ga,de(this,qs).getMutationCache().build(de(this,qs),this.options)),de(this,Ga).addObserver(this),de(this,Ga).execute(a)}},qs=new WeakMap,Ki=new WeakMap,Ga=new WeakMap,Ws=new WeakMap,ri=new WeakSet,a0=function(){var r;const a=((r=de(this,Ga))==null?void 0:r.state)??L2();$e(this,Ki,{...a,isPending:a.status==="pending",isSuccess:a.status==="success",isError:a.status==="error",isIdle:a.status==="idle",mutate:this.mutate,reset:this.reset})},Jf=function(a){Vn.batch(()=>{var r,s,l,o,d,u,h,m;if(de(this,Ws)&&this.hasListeners()){const f=de(this,Ki).variables,p=de(this,Ki).context,b={client:de(this,qs),meta:this.options.meta,mutationKey:this.options.mutationKey};if((a==null?void 0:a.type)==="success"){try{(s=(r=de(this,Ws)).onSuccess)==null||s.call(r,a.data,f,p,b)}catch(g){Promise.reject(g)}try{(o=(l=de(this,Ws)).onSettled)==null||o.call(l,a.data,null,f,p,b)}catch(g){Promise.reject(g)}}else if((a==null?void 0:a.type)==="error"){try{(u=(d=de(this,Ws)).onError)==null||u.call(d,a.error,f,p,b)}catch(g){Promise.reject(g)}try{(m=(h=de(this,Ws)).onSettled)==null||m.call(h,void 0,a.error,f,p,b)}catch(g){Promise.reject(g)}}}this.listeners.forEach(f=>{f(de(this,Ki))})})},N2),gs,j2,QC=(j2=class extends _c{constructor(n={}){super();tt(this,gs);this.config=n,$e(this,gs,new Map)}build(n,a,r){const s=a.queryKey,l=a.queryHash??Ip(s,a);let o=this.get(l);return o||(o=new UC({client:n,queryKey:s,queryHash:l,options:n.defaultQueryOptions(a),state:r,defaultOptions:n.getQueryDefaults(s)}),this.add(o)),o}add(n){de(this,gs).has(n.queryHash)||(de(this,gs).set(n.queryHash,n),this.notify({type:"added",query:n}))}remove(n){const a=de(this,gs).get(n.queryHash);a&&(n.destroy(),a===n&&de(this,gs).delete(n.queryHash),this.notify({type:"removed",query:n}))}clear(){Vn.batch(()=>{this.getAll().forEach(n=>{this.remove(n)})})}get(n){return de(this,gs).get(n)}getAll(){return[...de(this,gs).values()]}find(n){const a={exact:!0,...n};return this.getAll().find(r=>L1(a,r))}findAll(n={}){const a=this.getAll();return Object.keys(n).length>0?a.filter(r=>L1(n,r)):a}notify(n){Vn.batch(()=>{this.listeners.forEach(a=>{a(n)})})}onFocus(){Vn.batch(()=>{this.getAll().forEach(n=>{n.onFocus()})})}onOnline(){Vn.batch(()=>{this.getAll().forEach(n=>{n.onOnline()})})}},gs=new WeakMap,j2),vn,zi,$i,pc,gc,Gi,yc,vc,w2,YC=(w2=class{constructor(e={}){tt(this,vn);tt(this,zi);tt(this,$i);tt(this,pc);tt(this,gc);tt(this,Gi);tt(this,yc);tt(this,vc);$e(this,vn,e.queryCache||new QC),$e(this,zi,e.mutationCache||new WC),$e(this,$i,e.defaultOptions||{}),$e(this,pc,new Map),$e(this,gc,new Map),$e(this,Gi,0)}mount(){Mh(this,Gi)._++,de(this,Gi)===1&&($e(this,yc,Bp.subscribe(async e=>{e&&(await this.resumePausedMutations(),de(this,vn).onFocus())})),$e(this,vc,u0.subscribe(async e=>{e&&(await this.resumePausedMutations(),de(this,vn).onOnline())})))}unmount(){var e,n;Mh(this,Gi)._--,de(this,Gi)===0&&((e=de(this,yc))==null||e.call(this),$e(this,yc,void 0),(n=de(this,vc))==null||n.call(this),$e(this,vc,void 0))}isFetching(e){return de(this,vn).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return de(this,zi).findAll({...e,status:"pending"}).length}getQueryData(e){var a;const n=this.defaultQueryOptions({queryKey:e});return(a=de(this,vn).get(n.queryHash))==null?void 0:a.state.data}ensureQueryData(e){const n=this.defaultQueryOptions(e),a=de(this,vn).build(this,n),r=a.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&a.isStaleByTime(Zi(n.staleTime,a))&&this.prefetchQuery(n),Promise.resolve(r))}getQueriesData(e){return de(this,vn).findAll(e).map(({queryKey:n,state:a})=>{const r=a.data;return[n,r]})}setQueryData(e,n,a){const r=this.defaultQueryOptions({queryKey:e}),s=de(this,vn).get(r.queryHash),l=s==null?void 0:s.state.data,o=FC(n,l);if(o!==void 0)return de(this,vn).build(this,r).setData(o,{...a,manual:!0})}setQueriesData(e,n,a){return Vn.batch(()=>de(this,vn).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,n,a)]))}getQueryState(e){var a;const n=this.defaultQueryOptions({queryKey:e});return(a=de(this,vn).get(n.queryHash))==null?void 0:a.state}removeQueries(e){const n=de(this,vn);Vn.batch(()=>{n.findAll(e).forEach(a=>{n.remove(a)})})}resetQueries(e,n){const a=de(this,vn);return Vn.batch(()=>(a.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},n)))}cancelQueries(e,n={}){const a={revert:!0,...n},r=Vn.batch(()=>de(this,vn).findAll(e).map(s=>s.cancel(a)));return Promise.all(r).then(Fa).catch(Fa)}invalidateQueries(e,n={}){return Vn.batch(()=>(de(this,vn).findAll(e).forEach(a=>{a.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},n)))}refetchQueries(e,n={}){const a={...n,cancelRefetch:n.cancelRefetch??!0},r=Vn.batch(()=>de(this,vn).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let l=s.fetch(void 0,a);return a.throwOnError||(l=l.catch(Fa)),s.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(r).then(Fa)}fetchQuery(e){const n=this.defaultQueryOptions(e);n.retry===void 0&&(n.retry=!1);const a=de(this,vn).build(this,n);return a.isStaleByTime(Zi(n.staleTime,a))?a.fetch(n):Promise.resolve(a.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Fa).catch(Fa)}fetchInfiniteQuery(e){return e.behavior=U1(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Fa).catch(Fa)}ensureInfiniteQueryData(e){return e.behavior=U1(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return u0.isOnline()?de(this,zi).resumePausedMutations():Promise.resolve()}getQueryCache(){return de(this,vn)}getMutationCache(){return de(this,zi)}getDefaultOptions(){return de(this,$i)}setDefaultOptions(e){$e(this,$i,e)}setQueryDefaults(e,n){de(this,pc).set(to(e),{queryKey:e,defaultOptions:n})}getQueryDefaults(e){const n=[...de(this,pc).values()],a={};return n.forEach(r=>{zd(e,r.queryKey)&&Object.assign(a,r.defaultOptions)}),a}setMutationDefaults(e,n){de(this,gc).set(to(e),{mutationKey:e,defaultOptions:n})}getMutationDefaults(e){const n=[...de(this,gc).values()],a={};return n.forEach(r=>{zd(e,r.mutationKey)&&Object.assign(a,r.defaultOptions)}),a}defaultQueryOptions(e){if(e._defaulted)return e;const n={...de(this,$i).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return n.queryHash||(n.queryHash=Ip(n.queryKey,n)),n.refetchOnReconnect===void 0&&(n.refetchOnReconnect=n.networkMode!=="always"),n.throwOnError===void 0&&(n.throwOnError=!!n.suspense),!n.networkMode&&n.persister&&(n.networkMode="offlineFirst"),n.queryFn===Mp&&(n.enabled=!1),n}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...de(this,$i).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){de(this,vn).clear(),de(this,zi).clear()}},vn=new WeakMap,zi=new WeakMap,$i=new WeakMap,pc=new WeakMap,gc=new WeakMap,Gi=new WeakMap,yc=new WeakMap,vc=new WeakMap,w2),O2=E.createContext(void 0),Rt=e=>{const n=E.useContext(O2);if(!n)throw new Error("No QueryClient set, use QueryClientProvider to set one");return n},JC=({client:e,children:n})=>(E.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),t.jsx(O2.Provider,{value:e,children:n})),I2=E.createContext(!1),ZC=()=>E.useContext(I2);I2.Provider;function eS(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var tS=E.createContext(eS()),nS=()=>E.useContext(tS),aS=(e,n,a)=>{const r=a!=null&&a.state.error&&typeof e.throwOnError=="function"?Rp(e.throwOnError,[a.state.error,a]):e.throwOnError;(e.suspense||e.experimental_prefetchInRender||r)&&(n.isReset()||(e.retryOnMount=!1))},rS=e=>{E.useEffect(()=>{e.clearReset()},[e])},sS=({result:e,errorResetBoundary:n,throwOnError:a,query:r,suspense:s})=>e.isError&&!n.isReset()&&!e.isFetching&&r&&(s&&e.data===void 0||Rp(a,[e.error,r])),iS=e=>{if(e.suspense){const a=s=>s==="static"?s:Math.max(s??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...s)=>a(r(...s)):a(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},lS=(e,n)=>e.isLoading&&e.isFetching&&!n,oS=(e,n)=>(e==null?void 0:e.suspense)&&n.isPending,z1=(e,n,a)=>n.fetchOptimistic(e).catch(()=>{a.clearReset()});function cS(e,n,a){var p,b,g,y;const r=ZC(),s=nS(),l=Rt(),o=l.defaultQueryOptions(e);(b=(p=l.getDefaultOptions().queries)==null?void 0:p._experimental_beforeQuery)==null||b.call(p,o);const d=l.getQueryCache().get(o.queryHash);o._optimisticResults=r?"isRestoring":"optimistic",iS(o),aS(o,s,d),rS(s);const u=!l.getQueryCache().get(o.queryHash),[h]=E.useState(()=>new n(l,o)),m=h.getOptimisticResult(o),f=!r&&e.subscribed!==!1;if(E.useSyncExternalStore(E.useCallback(N=>{const C=f?h.subscribe(Vn.batchCalls(N)):Fa;return h.updateResult(),C},[h,f]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),E.useEffect(()=>{h.setOptions(o)},[o,h]),oS(o,m))throw z1(o,h,s);if(sS({result:m,errorResetBoundary:s,throwOnError:o.throwOnError,query:d,suspense:o.suspense}))throw m.error;if((y=(g=l.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||y.call(g,o,m),o.experimental_prefetchInRender&&!eo&&lS(m,r)){const N=u?z1(o,h,s):d==null?void 0:d.promise;N==null||N.catch(Fa).finally(()=>{h.updateResult()})}return o.notifyOnChangeProps?m:h.trackResult(m)}function Ie(e,n){return cS(e,KC)}function De(e,n){const a=Rt(),[r]=E.useState(()=>new XC(a,e));E.useEffect(()=>{r.setOptions(e)},[r,e]);const s=E.useSyncExternalStore(E.useCallback(o=>r.subscribe(Vn.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),l=E.useCallback((o,d)=>{r.mutate(o,d).catch(Fa)},[r]);if(s.error&&Rp(r.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:l,mutateAsync:s.mutate}}var dS=T2();/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $d(){return $d=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},$d.apply(this,arguments)}var qi;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(qi||(qi={}));const $1="popstate";function uS(e){e===void 0&&(e={});function n(r,s){let{pathname:l,search:o,hash:d}=r.location;return Zf("",{pathname:l,search:o,hash:d},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function a(r,s){return typeof s=="string"?s:h0(s)}return xS(n,a,null,e)}function En(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function Vp(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function hS(){return Math.random().toString(36).substr(2,8)}function G1(e,n){return{usr:e.state,key:e.key,idx:n}}function Zf(e,n,a,r){return a===void 0&&(a=null),$d({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof n=="string"?Ec(n):n,{state:a,key:n&&n.key||r||hS()})}function h0(e){let{pathname:n="/",search:a="",hash:r=""}=e;return a&&a!=="?"&&(n+=a.charAt(0)==="?"?a:"?"+a),r&&r!=="#"&&(n+=r.charAt(0)==="#"?r:"#"+r),n}function Ec(e){let n={};if(e){let a=e.indexOf("#");a>=0&&(n.hash=e.substr(a),e=e.substr(0,a));let r=e.indexOf("?");r>=0&&(n.search=e.substr(r),e=e.substr(0,r)),e&&(n.pathname=e)}return n}function xS(e,n,a,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:l=!1}=r,o=s.history,d=qi.Pop,u=null,h=m();h==null&&(h=0,o.replaceState($d({},o.state,{idx:h}),""));function m(){return(o.state||{idx:null}).idx}function f(){d=qi.Pop;let N=m(),C=N==null?null:N-h;h=N,u&&u({action:d,location:y.location,delta:C})}function p(N,C){d=qi.Push;let T=Zf(y.location,N,C);h=m()+1;let S=G1(T,h),k=y.createHref(T);try{o.pushState(S,"",k)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;s.location.assign(k)}l&&u&&u({action:d,location:y.location,delta:1})}function b(N,C){d=qi.Replace;let T=Zf(y.location,N,C);h=m();let S=G1(T,h),k=y.createHref(T);o.replaceState(S,"",k),l&&u&&u({action:d,location:y.location,delta:0})}function g(N){let C=s.location.origin!=="null"?s.location.origin:s.location.href,T=typeof N=="string"?N:h0(N);return T=T.replace(/ $/,"%20"),En(C,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,C)}let y={get action(){return d},get location(){return e(s,o)},listen(N){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener($1,f),u=N,()=>{s.removeEventListener($1,f),u=null}},createHref(N){return n(s,N)},createURL:g,encodeLocation(N){let C=g(N);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:p,replace:b,go(N){return o.go(N)}};return y}var q1;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(q1||(q1={}));function mS(e,n,a){return a===void 0&&(a="/"),fS(e,n,a)}function fS(e,n,a,r){let s=typeof n=="string"?Ec(n):n,l=Up(s.pathname||"/",a);if(l==null)return null;let o=M2(e);pS(o);let d=null;for(let u=0;d==null&&u<o.length;++u){let h=_S(l);d=TS(o[u],h)}return d}function M2(e,n,a,r){n===void 0&&(n=[]),a===void 0&&(a=[]),r===void 0&&(r="");let s=(l,o,d)=>{let u={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};u.relativePath.startsWith("/")&&(En(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let h=el([r,u.relativePath]),m=a.concat(u);l.children&&l.children.length>0&&(En(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),M2(l.children,n,m,h)),!(l.path==null&&!l.index)&&n.push({path:h,score:wS(h,l.index),routesMeta:m})};return e.forEach((l,o)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))s(l,o);else for(let u of R2(l.path))s(l,o,u)}),n}function R2(e){let n=e.split("/");if(n.length===0)return[];let[a,...r]=n,s=a.endsWith("?"),l=a.replace(/\?$/,"");if(r.length===0)return s?[l,""]:[l];let o=R2(r.join("/")),d=[];return d.push(...o.map(u=>u===""?l:[l,u].join("/"))),s&&d.push(...o),d.map(u=>e.startsWith("/")&&u===""?"/":u)}function pS(e){e.sort((n,a)=>n.score!==a.score?a.score-n.score:kS(n.routesMeta.map(r=>r.childrenIndex),a.routesMeta.map(r=>r.childrenIndex)))}const gS=/^:[\w-]+$/,yS=3,vS=2,bS=1,NS=10,jS=-2,W1=e=>e==="*";function wS(e,n){let a=e.split("/"),r=a.length;return a.some(W1)&&(r+=jS),n&&(r+=vS),a.filter(s=>!W1(s)).reduce((s,l)=>s+(gS.test(l)?yS:l===""?bS:NS),r)}function kS(e,n){return e.length===n.length&&e.slice(0,-1).every((r,s)=>r===n[s])?e[e.length-1]-n[n.length-1]:0}function TS(e,n,a){let{routesMeta:r}=e,s={},l="/",o=[];for(let d=0;d<r.length;++d){let u=r[d],h=d===r.length-1,m=l==="/"?n:n.slice(l.length)||"/",f=CS({path:u.relativePath,caseSensitive:u.caseSensitive,end:h},m),p=u.route;if(!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:el([l,f.pathname]),pathnameBase:PS(el([l,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(l=el([l,f.pathnameBase]))}return o}function CS(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[a,r]=SS(e.path,e.caseSensitive,e.end),s=n.match(a);if(!s)return null;let l=s[0],o=l.replace(/(.)\/+$/,"$1"),d=s.slice(1);return{params:r.reduce((h,m,f)=>{let{paramName:p,isOptional:b}=m;if(p==="*"){let y=d[f]||"";o=l.slice(0,l.length-y.length).replace(/(.)\/+$/,"$1")}const g=d[f];return b&&!g?h[p]=void 0:h[p]=(g||"").replace(/%2F/g,"/"),h},{}),pathname:l,pathnameBase:o,pattern:e}}function SS(e,n,a){n===void 0&&(n=!1),a===void 0&&(a=!0),Vp(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,d,u)=>(r.push({paramName:d,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,n?void 0:"i"),r]}function _S(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return Vp(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+n+").")),e}}function Up(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let a=n.endsWith("/")?n.length-1:n.length,r=e.charAt(a);return r&&r!=="/"?null:e.slice(a)||"/"}const ES=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,DS=e=>ES.test(e);function FS(e,n){n===void 0&&(n="/");let{pathname:a,search:r="",hash:s=""}=typeof e=="string"?Ec(e):e,l;if(a)if(DS(a))l=a;else{if(a.includes("//")){let o=a;a=a.replace(/\/\/+/g,"/"),Vp(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+a))}a.startsWith("/")?l=X1(a.substring(1),"/"):l=X1(a,n)}else l=n;return{pathname:l,search:LS(r),hash:OS(s)}}function X1(e,n){let a=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?a.length>1&&a.pop():s!=="."&&a.push(s)}),a.length>1?a.join("/"):"/"}function Qm(e,n,a,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+n+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function AS(e){return e.filter((n,a)=>a===0||n.route.path&&n.route.path.length>0)}function Kp(e,n){let a=AS(e);return n?a.map((r,s)=>s===a.length-1?r.pathname:r.pathnameBase):a.map(r=>r.pathnameBase)}function zp(e,n,a,r){r===void 0&&(r=!1);let s;typeof e=="string"?s=Ec(e):(s=$d({},e),En(!s.pathname||!s.pathname.includes("?"),Qm("?","pathname","search",s)),En(!s.pathname||!s.pathname.includes("#"),Qm("#","pathname","hash",s)),En(!s.search||!s.search.includes("#"),Qm("#","search","hash",s)));let l=e===""||s.pathname==="",o=l?"/":s.pathname,d;if(o==null)d=a;else{let f=n.length-1;if(!r&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;s.pathname=p.join("/")}d=f>=0?n[f]:"/"}let u=FS(s,d),h=o&&o!=="/"&&o.endsWith("/"),m=(l||o===".")&&a.endsWith("/");return!u.pathname.endsWith("/")&&(h||m)&&(u.pathname+="/"),u}const el=e=>e.join("/").replace(/\/\/+/g,"/"),PS=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),LS=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,OS=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function IS(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const B2=["post","put","patch","delete"];new Set(B2);const MS=["get",...B2];new Set(MS);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gd(){return Gd=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},Gd.apply(this,arguments)}const $p=E.createContext(null),RS=E.createContext(null),ol=E.createContext(null),V0=E.createContext(null),Ts=E.createContext({outlet:null,matches:[],isDataRoute:!1}),H2=E.createContext(null);function BS(e,n){let{relative:a}=n===void 0?{}:n;Dc()||En(!1);let{basename:r,navigator:s}=E.useContext(ol),{hash:l,pathname:o,search:d}=U2(e,{relative:a}),u=o;return r!=="/"&&(u=o==="/"?r:el([r,o])),s.createHref({pathname:u,search:d,hash:l})}function Dc(){return E.useContext(V0)!=null}function Cs(){return Dc()||En(!1),E.useContext(V0).location}function V2(e){E.useContext(ol).static||E.useLayoutEffect(e)}function xr(){let{isDataRoute:e}=E.useContext(Ts);return e?e3():HS()}function HS(){Dc()||En(!1);let e=E.useContext($p),{basename:n,future:a,navigator:r}=E.useContext(ol),{matches:s}=E.useContext(Ts),{pathname:l}=Cs(),o=JSON.stringify(Kp(s,a.v7_relativeSplatPath)),d=E.useRef(!1);return V2(()=>{d.current=!0}),E.useCallback(function(h,m){if(m===void 0&&(m={}),!d.current)return;if(typeof h=="number"){r.go(h);return}let f=zp(h,JSON.parse(o),l,m.relative==="path");e==null&&n!=="/"&&(f.pathname=f.pathname==="/"?n:el([n,f.pathname])),(m.replace?r.replace:r.push)(f,m.state,m)},[n,r,o,l,e])}const VS=E.createContext(null);function US(e){let n=E.useContext(Ts).outlet;return n&&E.createElement(VS.Provider,{value:e},n)}function U0(){let{matches:e}=E.useContext(Ts),n=e[e.length-1];return n?n.params:{}}function U2(e,n){let{relative:a}=n===void 0?{}:n,{future:r}=E.useContext(ol),{matches:s}=E.useContext(Ts),{pathname:l}=Cs(),o=JSON.stringify(Kp(s,r.v7_relativeSplatPath));return E.useMemo(()=>zp(e,JSON.parse(o),l,a==="path"),[e,o,l,a])}function KS(e,n){return zS(e,n)}function zS(e,n,a,r){Dc()||En(!1);let{navigator:s}=E.useContext(ol),{matches:l}=E.useContext(Ts),o=l[l.length-1],d=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let h=Cs(),m;if(n){var f;let N=typeof n=="string"?Ec(n):n;u==="/"||(f=N.pathname)!=null&&f.startsWith(u)||En(!1),m=N}else m=h;let p=m.pathname||"/",b=p;if(u!=="/"){let N=u.replace(/^\//,"").split("/");b="/"+p.replace(/^\//,"").split("/").slice(N.length).join("/")}let g=mS(e,{pathname:b}),y=XS(g&&g.map(N=>Object.assign({},N,{params:Object.assign({},d,N.params),pathname:el([u,s.encodeLocation?s.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?u:el([u,s.encodeLocation?s.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),l,a,r);return n&&y?E.createElement(V0.Provider,{value:{location:Gd({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:qi.Pop}},y):y}function $S(){let e=ZS(),n=IS(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},n),a?E.createElement("pre",{style:s},a):null,null)}const GS=E.createElement($S,null);class qS extends E.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,a){return a.location!==n.location||a.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:a.error,location:a.location,revalidation:n.revalidation||a.revalidation}}componentDidCatch(n,a){console.error("React Router caught the following error during render",n,a)}render(){return this.state.error!==void 0?E.createElement(Ts.Provider,{value:this.props.routeContext},E.createElement(H2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function WS(e){let{routeContext:n,match:a,children:r}=e,s=E.useContext($p);return s&&s.static&&s.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=a.route.id),E.createElement(Ts.Provider,{value:n},r)}function XS(e,n,a,r){var s;if(n===void 0&&(n=[]),a===void 0&&(a=null),r===void 0&&(r=null),e==null){var l;if(!a)return null;if(a.errors)e=a.matches;else if((l=r)!=null&&l.v7_partialHydration&&n.length===0&&!a.initialized&&a.matches.length>0)e=a.matches;else return null}let o=e,d=(s=a)==null?void 0:s.errors;if(d!=null){let m=o.findIndex(f=>f.route.id&&(d==null?void 0:d[f.route.id])!==void 0);m>=0||En(!1),o=o.slice(0,Math.min(o.length,m+1))}let u=!1,h=-1;if(a&&r&&r.v7_partialHydration)for(let m=0;m<o.length;m++){let f=o[m];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(h=m),f.route.id){let{loaderData:p,errors:b}=a,g=f.route.loader&&p[f.route.id]===void 0&&(!b||b[f.route.id]===void 0);if(f.route.lazy||g){u=!0,h>=0?o=o.slice(0,h+1):o=[o[0]];break}}}return o.reduceRight((m,f,p)=>{let b,g=!1,y=null,N=null;a&&(b=d&&f.route.id?d[f.route.id]:void 0,y=f.route.errorElement||GS,u&&(h<0&&p===0?(t3("route-fallback"),g=!0,N=null):h===p&&(g=!0,N=f.route.hydrateFallbackElement||null)));let C=n.concat(o.slice(0,p+1)),T=()=>{let S;return b?S=y:g?S=N:f.route.Component?S=E.createElement(f.route.Component,null):f.route.element?S=f.route.element:S=m,E.createElement(WS,{match:f,routeContext:{outlet:m,matches:C,isDataRoute:a!=null},children:S})};return a&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?E.createElement(qS,{location:a.location,revalidation:a.revalidation,component:y,error:b,children:T(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):T()},null)}var K2=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(K2||{}),z2=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(z2||{});function QS(e){let n=E.useContext($p);return n||En(!1),n}function YS(e){let n=E.useContext(RS);return n||En(!1),n}function JS(e){let n=E.useContext(Ts);return n||En(!1),n}function $2(e){let n=JS(),a=n.matches[n.matches.length-1];return a.route.id||En(!1),a.route.id}function ZS(){var e;let n=E.useContext(H2),a=YS(),r=$2();return n!==void 0?n:(e=a.errors)==null?void 0:e[r]}function e3(){let{router:e}=QS(K2.UseNavigateStable),n=$2(z2.UseNavigateStable),a=E.useRef(!1);return V2(()=>{a.current=!0}),E.useCallback(function(s,l){l===void 0&&(l={}),a.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Gd({fromRouteId:n},l)))},[e,n])}const Q1={};function t3(e,n,a){Q1[e]||(Q1[e]=!0)}function n3(e,n){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function a3(e){let{to:n,replace:a,state:r,relative:s}=e;Dc()||En(!1);let{future:l,static:o}=E.useContext(ol),{matches:d}=E.useContext(Ts),{pathname:u}=Cs(),h=xr(),m=zp(n,Kp(d,l.v7_relativeSplatPath),u,s==="path"),f=JSON.stringify(m);return E.useEffect(()=>h(JSON.parse(f),{replace:a,state:r,relative:s}),[h,f,s,a,r]),null}function G2(e){return US(e.context)}function rt(e){En(!1)}function r3(e){let{basename:n="/",children:a=null,location:r,navigationType:s=qi.Pop,navigator:l,static:o=!1,future:d}=e;Dc()&&En(!1);let u=n.replace(/^\/*/,"/"),h=E.useMemo(()=>({basename:u,navigator:l,static:o,future:Gd({v7_relativeSplatPath:!1},d)}),[u,d,l,o]);typeof r=="string"&&(r=Ec(r));let{pathname:m="/",search:f="",hash:p="",state:b=null,key:g="default"}=r,y=E.useMemo(()=>{let N=Up(m,u);return N==null?null:{location:{pathname:N,search:f,hash:p,state:b,key:g},navigationType:s}},[u,m,f,p,b,g,s]);return y==null?null:E.createElement(ol.Provider,{value:h},E.createElement(V0.Provider,{children:a,value:y}))}function s3(e){let{children:n,location:a}=e;return KS(ep(n),a)}new Promise(()=>{});function ep(e,n){n===void 0&&(n=[]);let a=[];return E.Children.forEach(e,(r,s)=>{if(!E.isValidElement(r))return;let l=[...n,s];if(r.type===E.Fragment){a.push.apply(a,ep(r.props.children,l));return}r.type!==rt&&En(!1),!r.props.index||!r.props.children||En(!1);let o={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=ep(r.props.children,l)),a.push(o)}),a}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tp(){return tp=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},tp.apply(this,arguments)}function i3(e,n){if(e==null)return{};var a={},r=Object.keys(e),s,l;for(l=0;l<r.length;l++)s=r[l],!(n.indexOf(s)>=0)&&(a[s]=e[s]);return a}function l3(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function o3(e,n){return e.button===0&&(!n||n==="_self")&&!l3(e)}function np(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((n,a)=>{let r=e[a];return n.concat(Array.isArray(r)?r.map(s=>[a,s]):[[a,r]])},[]))}function c3(e,n){let a=np(e);return n&&n.forEach((r,s)=>{a.has(s)||n.getAll(s).forEach(l=>{a.append(s,l)})}),a}const d3=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],u3="6";try{window.__reactRouterVersion=u3}catch{}const h3="startTransition",Y1=jC[h3];function x3(e){let{basename:n,children:a,future:r,window:s}=e,l=E.useRef();l.current==null&&(l.current=uS({window:s,v5Compat:!0}));let o=l.current,[d,u]=E.useState({action:o.action,location:o.location}),{v7_startTransition:h}=r||{},m=E.useCallback(f=>{h&&Y1?Y1(()=>u(f)):u(f)},[u,h]);return E.useLayoutEffect(()=>o.listen(m),[o,m]),E.useEffect(()=>n3(r),[r]),E.createElement(r3,{basename:n,children:a,location:d.location,navigationType:d.action,navigator:o,future:r})}const m3=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",f3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ca=E.forwardRef(function(n,a){let{onClick:r,relative:s,reloadDocument:l,replace:o,state:d,target:u,to:h,preventScrollReset:m,viewTransition:f}=n,p=i3(n,d3),{basename:b}=E.useContext(ol),g,y=!1;if(typeof h=="string"&&f3.test(h)&&(g=h,m3))try{let S=new URL(window.location.href),k=h.startsWith("//")?new URL(S.protocol+h):new URL(h),_=Up(k.pathname,b);k.origin===S.origin&&_!=null?h=_+k.search+k.hash:y=!0}catch{}let N=BS(h,{relative:s}),C=p3(h,{replace:o,state:d,target:u,preventScrollReset:m,relative:s,viewTransition:f});function T(S){r&&r(S),S.defaultPrevented||C(S)}return E.createElement("a",tp({},p,{href:g||N,onClick:y||l?r:T,ref:a,target:u}))});var J1;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(J1||(J1={}));var Z1;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Z1||(Z1={}));function p3(e,n){let{target:a,replace:r,state:s,preventScrollReset:l,relative:o,viewTransition:d}=n===void 0?{}:n,u=xr(),h=Cs(),m=U2(e,{relative:o});return E.useCallback(f=>{if(o3(f,a)){f.preventDefault();let p=r!==void 0?r:h0(h)===h0(m);u(e,{replace:p,state:s,preventScrollReset:l,relative:o,viewTransition:d})}},[h,u,m,r,s,a,e,l,o,d])}function g3(e){let n=E.useRef(np(e)),a=E.useRef(!1),r=Cs(),s=E.useMemo(()=>c3(r.search,a.current?null:n.current),[r.search]),l=xr(),o=E.useCallback((d,u)=>{const h=np(typeof d=="function"?d(s):d);a.current=!0,l("?"+h,u)},[l,s]);return[s,o]}let y3={data:""},v3=e=>{if(typeof window=="object"){let n=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return n.nonce=window.__nonce__,n.parentNode||(e||document.head).appendChild(n),n.firstChild}return e||y3},b3=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,N3=/\/\*[^]*?\*\/|  +/g,eb=/\n+/g,Mi=(e,n)=>{let a="",r="",s="";for(let l in e){let o=e[l];l[0]=="@"?l[1]=="i"?a=l+" "+o+";":r+=l[1]=="f"?Mi(o,l):l+"{"+Mi(o,l[1]=="k"?"":n)+"}":typeof o=="object"?r+=Mi(o,n?n.replace(/([^,])+/g,d=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,d):d?d+" "+u:u)):l):o!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=Mi.p?Mi.p(l,o):l+":"+o+";")}return a+(n&&s?n+"{"+s+"}":s)+r},Vs={},q2=e=>{if(typeof e=="object"){let n="";for(let a in e)n+=a+q2(e[a]);return n}return e},j3=(e,n,a,r,s)=>{let l=q2(e),o=Vs[l]||(Vs[l]=(u=>{let h=0,m=11;for(;h<u.length;)m=101*m+u.charCodeAt(h++)>>>0;return"go"+m})(l));if(!Vs[o]){let u=l!==e?e:(h=>{let m,f,p=[{}];for(;m=b3.exec(h.replace(N3,""));)m[4]?p.shift():m[3]?(f=m[3].replace(eb," ").trim(),p.unshift(p[0][f]=p[0][f]||{})):p[0][m[1]]=m[2].replace(eb," ").trim();return p[0]})(e);Vs[o]=Mi(s?{["@keyframes "+o]:u}:u,a?"":"."+o)}let d=a&&Vs.g?Vs.g:null;return a&&(Vs.g=Vs[o]),((u,h,m,f)=>{f?h.data=h.data.replace(f,u):h.data.indexOf(u)===-1&&(h.data=m?u+h.data:h.data+u)})(Vs[o],n,r,d),o},w3=(e,n,a)=>e.reduce((r,s,l)=>{let o=n[l];if(o&&o.call){let d=o(a),u=d&&d.props&&d.props.className||/^go/.test(d)&&d;o=u?"."+u:d&&typeof d=="object"?d.props?"":Mi(d,""):d===!1?"":d}return r+s+(o??"")},"");function K0(e){let n=this||{},a=e.call?e(n.p):e;return j3(a.unshift?a.raw?w3(a,[].slice.call(arguments,1),n.p):a.reduce((r,s)=>Object.assign(r,s&&s.call?s(n.p):s),{}):a,v3(n.target),n.g,n.o,n.k)}let W2,ap,rp;K0.bind({g:1});let si=K0.bind({k:1});function k3(e,n,a,r){Mi.p=n,W2=e,ap=a,rp=r}function cl(e,n){let a=this||{};return function(){let r=arguments;function s(l,o){let d=Object.assign({},l),u=d.className||s.className;a.p=Object.assign({theme:ap&&ap()},d),a.o=/ *go\d+/.test(u),d.className=K0.apply(a,r)+(u?" "+u:"");let h=e;return e[0]&&(h=d.as||e,delete d.as),rp&&h[0]&&rp(d),W2(h,d)}return s}}var T3=e=>typeof e=="function",x0=(e,n)=>T3(e)?e(n):e,C3=(()=>{let e=0;return()=>(++e).toString()})(),X2=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let n=matchMedia("(prefers-reduced-motion: reduce)");e=!n||n.matches}return e}})(),S3=20,Gp="default",Q2=(e,n)=>{let{toastLimit:a}=e.settings;switch(n.type){case 0:return{...e,toasts:[n.toast,...e.toasts].slice(0,a)};case 1:return{...e,toasts:e.toasts.map(o=>o.id===n.toast.id?{...o,...n.toast}:o)};case 2:let{toast:r}=n;return Q2(e,{type:e.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=n;return{...e,toasts:e.toasts.map(o=>o.id===s||s===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return n.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==n.toastId)};case 5:return{...e,pausedAt:n.time};case 6:let l=n.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+l}))}}},r0=[],Y2={toasts:[],pausedAt:void 0,settings:{toastLimit:S3}},vs={},J2=(e,n=Gp)=>{vs[n]=Q2(vs[n]||Y2,e),r0.forEach(([a,r])=>{a===n&&r(vs[n])})},Z2=e=>Object.keys(vs).forEach(n=>J2(e,n)),_3=e=>Object.keys(vs).find(n=>vs[n].toasts.some(a=>a.id===e)),z0=(e=Gp)=>n=>{J2(n,e)},E3={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},D3=(e={},n=Gp)=>{let[a,r]=E.useState(vs[n]||Y2),s=E.useRef(vs[n]);E.useEffect(()=>(s.current!==vs[n]&&r(vs[n]),r0.push([n,r]),()=>{let o=r0.findIndex(([d])=>d===n);o>-1&&r0.splice(o,1)}),[n]);let l=a.toasts.map(o=>{var d,u,h;return{...e,...e[o.type],...o,removeDelay:o.removeDelay||((d=e[o.type])==null?void 0:d.removeDelay)||(e==null?void 0:e.removeDelay),duration:o.duration||((u=e[o.type])==null?void 0:u.duration)||(e==null?void 0:e.duration)||E3[o.type],style:{...e.style,...(h=e[o.type])==null?void 0:h.style,...o.style}}});return{...a,toasts:l}},F3=(e,n="blank",a)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:n,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...a,id:(a==null?void 0:a.id)||C3()}),mu=e=>(n,a)=>{let r=F3(n,e,a);return z0(r.toasterId||_3(r.id))({type:2,toast:r}),r.id},vt=(e,n)=>mu("blank")(e,n);vt.error=mu("error");vt.success=mu("success");vt.loading=mu("loading");vt.custom=mu("custom");vt.dismiss=(e,n)=>{let a={type:3,toastId:e};n?z0(n)(a):Z2(a)};vt.dismissAll=e=>vt.dismiss(void 0,e);vt.remove=(e,n)=>{let a={type:4,toastId:e};n?z0(n)(a):Z2(a)};vt.removeAll=e=>vt.remove(void 0,e);vt.promise=(e,n,a)=>{let r=vt.loading(n.loading,{...a,...a==null?void 0:a.loading});return typeof e=="function"&&(e=e()),e.then(s=>{let l=n.success?x0(n.success,s):void 0;return l?vt.success(l,{id:r,...a,...a==null?void 0:a.success}):vt.dismiss(r),s}).catch(s=>{let l=n.error?x0(n.error,s):void 0;l?vt.error(l,{id:r,...a,...a==null?void 0:a.error}):vt.dismiss(r)}),e};var A3=1e3,P3=(e,n="default")=>{let{toasts:a,pausedAt:r}=D3(e,n),s=E.useRef(new Map).current,l=E.useCallback((f,p=A3)=>{if(s.has(f))return;let b=setTimeout(()=>{s.delete(f),o({type:4,toastId:f})},p);s.set(f,b)},[]);E.useEffect(()=>{if(r)return;let f=Date.now(),p=a.map(b=>{if(b.duration===1/0)return;let g=(b.duration||0)+b.pauseDuration-(f-b.createdAt);if(g<0){b.visible&&vt.dismiss(b.id);return}return setTimeout(()=>vt.dismiss(b.id,n),g)});return()=>{p.forEach(b=>b&&clearTimeout(b))}},[a,r,n]);let o=E.useCallback(z0(n),[n]),d=E.useCallback(()=>{o({type:5,time:Date.now()})},[o]),u=E.useCallback((f,p)=>{o({type:1,toast:{id:f,height:p}})},[o]),h=E.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),m=E.useCallback((f,p)=>{let{reverseOrder:b=!1,gutter:g=8,defaultPosition:y}=p||{},N=a.filter(S=>(S.position||y)===(f.position||y)&&S.height),C=N.findIndex(S=>S.id===f.id),T=N.filter((S,k)=>k<C&&S.visible).length;return N.filter(S=>S.visible).slice(...b?[T+1]:[0,T]).reduce((S,k)=>S+(k.height||0)+g,0)},[a]);return E.useEffect(()=>{a.forEach(f=>{if(f.dismissed)l(f.id,f.removeDelay);else{let p=s.get(f.id);p&&(clearTimeout(p),s.delete(f.id))}})},[a,l]),{toasts:a,handlers:{updateHeight:u,startPause:d,endPause:h,calculateOffset:m}}},L3=si`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,O3=si`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,I3=si`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,M3=cl("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${L3} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${O3} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${I3} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,R3=si`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,B3=cl("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${R3} 1s linear infinite;
`,H3=si`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,V3=si`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,U3=cl("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${H3} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${V3} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,K3=cl("div")`
  position: absolute;
`,z3=cl("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,$3=si`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,G3=cl("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${$3} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,q3=({toast:e})=>{let{icon:n,type:a,iconTheme:r}=e;return n!==void 0?typeof n=="string"?E.createElement(G3,null,n):n:a==="blank"?null:E.createElement(z3,null,E.createElement(B3,{...r}),a!=="loading"&&E.createElement(K3,null,a==="error"?E.createElement(M3,{...r}):E.createElement(U3,{...r})))},W3=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,X3=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,Q3="0%{opacity:0;} 100%{opacity:1;}",Y3="0%{opacity:1;} 100%{opacity:0;}",J3=cl("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Z3=cl("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,e_=(e,n)=>{let a=e.includes("top")?1:-1,[r,s]=X2()?[Q3,Y3]:[W3(a),X3(a)];return{animation:n?`${si(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${si(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},t_=E.memo(({toast:e,position:n,style:a,children:r})=>{let s=e.height?e_(e.position||n||"top-center",e.visible):{opacity:0},l=E.createElement(q3,{toast:e}),o=E.createElement(Z3,{...e.ariaProps},x0(e.message,e));return E.createElement(J3,{className:e.className,style:{...s,...a,...e.style}},typeof r=="function"?r({icon:l,message:o}):E.createElement(E.Fragment,null,l,o))});k3(E.createElement);var n_=({id:e,className:n,style:a,onHeightUpdate:r,children:s})=>{let l=E.useCallback(o=>{if(o){let d=()=>{let u=o.getBoundingClientRect().height;r(e,u)};d(),new MutationObserver(d).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return E.createElement("div",{ref:l,className:n,style:a},s)},a_=(e,n)=>{let a=e.includes("top"),r=a?{top:0}:{bottom:0},s=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:X2()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${n*(a?1:-1)}px)`,...r,...s}},r_=K0`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Hh=16,s_=({reverseOrder:e,position:n="top-center",toastOptions:a,gutter:r,children:s,toasterId:l,containerStyle:o,containerClassName:d})=>{let{toasts:u,handlers:h}=P3(a,l);return E.createElement("div",{"data-rht-toaster":l||"",style:{position:"fixed",zIndex:9999,top:Hh,left:Hh,right:Hh,bottom:Hh,pointerEvents:"none",...o},className:d,onMouseEnter:h.startPause,onMouseLeave:h.endPause},u.map(m=>{let f=m.position||n,p=h.calculateOffset(m,{reverseOrder:e,gutter:r,defaultPosition:n}),b=a_(f,p);return E.createElement(n_,{id:m.id,key:m.id,onHeightUpdate:h.updateHeight,className:m.visible?r_:"",style:b},m.type==="custom"?x0(m.message,m):s?s(m):E.createElement(t_,{toast:m,position:f}))}))},le=vt;/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var i_={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l_=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),_e=(e,n)=>{const a=E.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:o,className:d="",children:u,...h},m)=>E.createElement("svg",{ref:m,...i_,width:s,height:s,stroke:r,strokeWidth:o?Number(l)*24/Number(s):l,className:["lucide",`lucide-${l_(e)}`,d].join(" "),...h},[...n.map(([f,p])=>E.createElement(f,p)),...Array.isArray(u)?u:[u]]));return a.displayName=`${e}`,a};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=_e("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=_e("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $0=_e("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o_=_e("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c_=_e("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ej=_e("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tj=_e("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bc=_e("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d_=_e("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u_=_e("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h_=_e("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m0=_e("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=_e("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x_=_e("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tb=_e("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m_=_e("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nb=_e("CalendarRange",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=_e("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f_=_e("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nj=_e("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aj=_e("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=_e("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=_e("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=_e("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=_e("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=_e("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pl=_e("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p_=_e("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g_=_e("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y_=_e("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nn=_e("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v_=_e("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b_=_e("Command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rj=_e("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N_=_e("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pd=_e("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=_e("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=_e("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j_=_e("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ii=_e("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qp=_e("FileDown",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=_e("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=_e("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wp=_e("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sj=_e("FolderTree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w_=_e("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k_=_e("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ab=_e("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T_=_e("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fu=_e("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G0=_e("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C_=_e("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ij=_e("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f0=_e("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S_=_e("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __=_e("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const In=_e("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=_e("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E_=_e("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xp=_e("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qp=_e("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qd=_e("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D_=_e("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rb=_e("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sb=_e("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nc=_e("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F_=_e("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A_=_e("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lj=_e("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ym=_e("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=_e("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P_=_e("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L_=_e("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O_=_e("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sp=_e("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=_e("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I_=_e("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M_=_e("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R_=_e("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=_e("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yp=_e("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nl=_e("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B_=_e("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H_=_e("ScrollText",[["path",{d:"M8 21h12a2 2 0 0 0 2-2v-2H10v2a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v3h4",key:"13a6an"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M15 12h-5",key:"r7krc0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=_e("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pu=_e("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=_e("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V_=_e("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s0=_e("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U_=_e("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p0=_e("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oj=_e("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K_=_e("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z_=_e("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cj=_e("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dj=_e("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=_e("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ip=_e("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const al=_e("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $_=_e("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jp=_e("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=_e("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G_=_e("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q_=_e("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=_e("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=_e("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zp=_e("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ho=_e("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=_e("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eg=_e("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function uj(e,n){return function(){return e.apply(n,arguments)}}const{toString:W_}=Object.prototype,{getPrototypeOf:tg}=Object,{iterator:q0,toStringTag:hj}=Symbol,W0=(e=>n=>{const a=W_.call(n);return e[a]||(e[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),ts=e=>(e=e.toLowerCase(),n=>W0(n)===e),X0=e=>n=>typeof n===e,{isArray:Fc}=Array,jc=X0("undefined");function gu(e){return e!==null&&!jc(e)&&e.constructor!==null&&!jc(e.constructor)&&Qa(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const xj=ts("ArrayBuffer");function X_(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&xj(e.buffer),n}const Q_=X0("string"),Qa=X0("function"),mj=X0("number"),yu=e=>e!==null&&typeof e=="object",Y_=e=>e===!0||e===!1,i0=e=>{if(W0(e)!=="object")return!1;const n=tg(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(hj in e)&&!(q0 in e)},J_=e=>{if(!yu(e)||gu(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Z_=ts("Date"),eE=ts("File"),tE=ts("Blob"),nE=ts("FileList"),aE=e=>yu(e)&&Qa(e.pipe),rE=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||Qa(e.append)&&((n=W0(e))==="formdata"||n==="object"&&Qa(e.toString)&&e.toString()==="[object FormData]"))},sE=ts("URLSearchParams"),[iE,lE,oE,cE]=["ReadableStream","Request","Response","Headers"].map(ts),dE=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function vu(e,n,{allOwnKeys:a=!1}={}){if(e===null||typeof e>"u")return;let r,s;if(typeof e!="object"&&(e=[e]),Fc(e))for(r=0,s=e.length;r<s;r++)n.call(null,e[r],r,e);else{if(gu(e))return;const l=a?Object.getOwnPropertyNames(e):Object.keys(e),o=l.length;let d;for(r=0;r<o;r++)d=l[r],n.call(null,e[d],d,e)}}function fj(e,n){if(gu(e))return null;n=n.toLowerCase();const a=Object.keys(e);let r=a.length,s;for(;r-- >0;)if(s=a[r],n===s.toLowerCase())return s;return null}const Ml=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,pj=e=>!jc(e)&&e!==Ml;function lp(){const{caseless:e,skipUndefined:n}=pj(this)&&this||{},a={},r=(s,l)=>{const o=e&&fj(a,l)||l;i0(a[o])&&i0(s)?a[o]=lp(a[o],s):i0(s)?a[o]=lp({},s):Fc(s)?a[o]=s.slice():(!n||!jc(s))&&(a[o]=s)};for(let s=0,l=arguments.length;s<l;s++)arguments[s]&&vu(arguments[s],r);return a}const uE=(e,n,a,{allOwnKeys:r}={})=>(vu(n,(s,l)=>{a&&Qa(s)?e[l]=uj(s,a):e[l]=s},{allOwnKeys:r}),e),hE=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),xE=(e,n,a,r)=>{e.prototype=Object.create(n.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),a&&Object.assign(e.prototype,a)},mE=(e,n,a,r)=>{let s,l,o;const d={};if(n=n||{},e==null)return n;do{for(s=Object.getOwnPropertyNames(e),l=s.length;l-- >0;)o=s[l],(!r||r(o,e,n))&&!d[o]&&(n[o]=e[o],d[o]=!0);e=a!==!1&&tg(e)}while(e&&(!a||a(e,n))&&e!==Object.prototype);return n},fE=(e,n,a)=>{e=String(e),(a===void 0||a>e.length)&&(a=e.length),a-=n.length;const r=e.indexOf(n,a);return r!==-1&&r===a},pE=e=>{if(!e)return null;if(Fc(e))return e;let n=e.length;if(!mj(n))return null;const a=new Array(n);for(;n-- >0;)a[n]=e[n];return a},gE=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&tg(Uint8Array)),yE=(e,n)=>{const r=(e&&e[q0]).call(e);let s;for(;(s=r.next())&&!s.done;){const l=s.value;n.call(e,l[0],l[1])}},vE=(e,n)=>{let a;const r=[];for(;(a=e.exec(n))!==null;)r.push(a);return r},bE=ts("HTMLFormElement"),NE=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,r,s){return r.toUpperCase()+s}),ib=(({hasOwnProperty:e})=>(n,a)=>e.call(n,a))(Object.prototype),jE=ts("RegExp"),gj=(e,n)=>{const a=Object.getOwnPropertyDescriptors(e),r={};vu(a,(s,l)=>{let o;(o=n(s,l,e))!==!1&&(r[l]=o||s)}),Object.defineProperties(e,r)},wE=e=>{gj(e,(n,a)=>{if(Qa(e)&&["arguments","caller","callee"].indexOf(a)!==-1)return!1;const r=e[a];if(Qa(r)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")})}})},kE=(e,n)=>{const a={},r=s=>{s.forEach(l=>{a[l]=!0})};return Fc(e)?r(e):r(String(e).split(n)),a},TE=()=>{},CE=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function SE(e){return!!(e&&Qa(e.append)&&e[hj]==="FormData"&&e[q0])}const _E=e=>{const n=new Array(10),a=(r,s)=>{if(yu(r)){if(n.indexOf(r)>=0)return;if(gu(r))return r;if(!("toJSON"in r)){n[s]=r;const l=Fc(r)?[]:{};return vu(r,(o,d)=>{const u=a(o,s+1);!jc(u)&&(l[d]=u)}),n[s]=void 0,l}}return r};return a(e,0)},EE=ts("AsyncFunction"),DE=e=>e&&(yu(e)||Qa(e))&&Qa(e.then)&&Qa(e.catch),yj=((e,n)=>e?setImmediate:n?((a,r)=>(Ml.addEventListener("message",({source:s,data:l})=>{s===Ml&&l===a&&r.length&&r.shift()()},!1),s=>{r.push(s),Ml.postMessage(a,"*")}))(`axios@${Math.random()}`,[]):a=>setTimeout(a))(typeof setImmediate=="function",Qa(Ml.postMessage)),FE=typeof queueMicrotask<"u"?queueMicrotask.bind(Ml):typeof process<"u"&&process.nextTick||yj,AE=e=>e!=null&&Qa(e[q0]),Te={isArray:Fc,isArrayBuffer:xj,isBuffer:gu,isFormData:rE,isArrayBufferView:X_,isString:Q_,isNumber:mj,isBoolean:Y_,isObject:yu,isPlainObject:i0,isEmptyObject:J_,isReadableStream:iE,isRequest:lE,isResponse:oE,isHeaders:cE,isUndefined:jc,isDate:Z_,isFile:eE,isBlob:tE,isRegExp:jE,isFunction:Qa,isStream:aE,isURLSearchParams:sE,isTypedArray:gE,isFileList:nE,forEach:vu,merge:lp,extend:uE,trim:dE,stripBOM:hE,inherits:xE,toFlatObject:mE,kindOf:W0,kindOfTest:ts,endsWith:fE,toArray:pE,forEachEntry:yE,matchAll:vE,isHTMLForm:bE,hasOwnProperty:ib,hasOwnProp:ib,reduceDescriptors:gj,freezeMethods:wE,toObjectSet:kE,toCamelCase:NE,noop:TE,toFiniteNumber:CE,findKey:fj,global:Ml,isContextDefined:pj,isSpecCompliantForm:SE,toJSONObject:_E,isAsyncFn:EE,isThenable:DE,setImmediate:yj,asap:FE,isIterable:AE};function ft(e,n,a,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),a&&(this.config=a),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}Te.inherits(ft,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Te.toJSONObject(this.config),code:this.code,status:this.status}}});const vj=ft.prototype,bj={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{bj[e]={value:e}});Object.defineProperties(ft,bj);Object.defineProperty(vj,"isAxiosError",{value:!0});ft.from=(e,n,a,r,s,l)=>{const o=Object.create(vj);Te.toFlatObject(e,o,function(m){return m!==Error.prototype},h=>h!=="isAxiosError");const d=e&&e.message?e.message:"Error",u=n==null&&e?e.code:n;return ft.call(o,d,u,a,r,s),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",l&&Object.assign(o,l),o};const PE=null;function op(e){return Te.isPlainObject(e)||Te.isArray(e)}function Nj(e){return Te.endsWith(e,"[]")?e.slice(0,-2):e}function lb(e,n,a){return e?e.concat(n).map(function(s,l){return s=Nj(s),!a&&l?"["+s+"]":s}).join(a?".":""):n}function LE(e){return Te.isArray(e)&&!e.some(op)}const OE=Te.toFlatObject(Te,{},null,function(n){return/^is[A-Z]/.test(n)});function Q0(e,n,a){if(!Te.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,a=Te.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,N){return!Te.isUndefined(N[y])});const r=a.metaTokens,s=a.visitor||m,l=a.dots,o=a.indexes,u=(a.Blob||typeof Blob<"u"&&Blob)&&Te.isSpecCompliantForm(n);if(!Te.isFunction(s))throw new TypeError("visitor must be a function");function h(g){if(g===null)return"";if(Te.isDate(g))return g.toISOString();if(Te.isBoolean(g))return g.toString();if(!u&&Te.isBlob(g))throw new ft("Blob is not supported. Use a Buffer instead.");return Te.isArrayBuffer(g)||Te.isTypedArray(g)?u&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function m(g,y,N){let C=g;if(g&&!N&&typeof g=="object"){if(Te.endsWith(y,"{}"))y=r?y:y.slice(0,-2),g=JSON.stringify(g);else if(Te.isArray(g)&&LE(g)||(Te.isFileList(g)||Te.endsWith(y,"[]"))&&(C=Te.toArray(g)))return y=Nj(y),C.forEach(function(S,k){!(Te.isUndefined(S)||S===null)&&n.append(o===!0?lb([y],k,l):o===null?y:y+"[]",h(S))}),!1}return op(g)?!0:(n.append(lb(N,y,l),h(g)),!1)}const f=[],p=Object.assign(OE,{defaultVisitor:m,convertValue:h,isVisitable:op});function b(g,y){if(!Te.isUndefined(g)){if(f.indexOf(g)!==-1)throw Error("Circular reference detected in "+y.join("."));f.push(g),Te.forEach(g,function(C,T){(!(Te.isUndefined(C)||C===null)&&s.call(n,C,Te.isString(T)?T.trim():T,y,p))===!0&&b(C,y?y.concat(T):[T])}),f.pop()}}if(!Te.isObject(e))throw new TypeError("data must be an object");return b(e),n}function ob(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return n[r]})}function ng(e,n){this._pairs=[],e&&Q0(e,this,n)}const jj=ng.prototype;jj.append=function(n,a){this._pairs.push([n,a])};jj.toString=function(n){const a=n?function(r){return n.call(this,r,ob)}:ob;return this._pairs.map(function(s){return a(s[0])+"="+a(s[1])},"").join("&")};function IE(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function wj(e,n,a){if(!n)return e;const r=a&&a.encode||IE;Te.isFunction(a)&&(a={serialize:a});const s=a&&a.serialize;let l;if(s?l=s(n,a):l=Te.isURLSearchParams(n)?n.toString():new ng(n,a).toString(r),l){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+l}return e}class cb{constructor(){this.handlers=[]}use(n,a,r){return this.handlers.push({fulfilled:n,rejected:a,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){Te.forEach(this.handlers,function(r){r!==null&&n(r)})}}const kj={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ME=typeof URLSearchParams<"u"?URLSearchParams:ng,RE=typeof FormData<"u"?FormData:null,BE=typeof Blob<"u"?Blob:null,HE={isBrowser:!0,classes:{URLSearchParams:ME,FormData:RE,Blob:BE},protocols:["http","https","file","blob","url","data"]},ag=typeof window<"u"&&typeof document<"u",cp=typeof navigator=="object"&&navigator||void 0,VE=ag&&(!cp||["ReactNative","NativeScript","NS"].indexOf(cp.product)<0),UE=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",KE=ag&&window.location.href||"http://localhost",zE=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ag,hasStandardBrowserEnv:VE,hasStandardBrowserWebWorkerEnv:UE,navigator:cp,origin:KE},Symbol.toStringTag,{value:"Module"})),Na={...zE,...HE};function $E(e,n){return Q0(e,new Na.classes.URLSearchParams,{visitor:function(a,r,s,l){return Na.isNode&&Te.isBuffer(a)?(this.append(r,a.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...n})}function GE(e){return Te.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function qE(e){const n={},a=Object.keys(e);let r;const s=a.length;let l;for(r=0;r<s;r++)l=a[r],n[l]=e[l];return n}function Tj(e){function n(a,r,s,l){let o=a[l++];if(o==="__proto__")return!0;const d=Number.isFinite(+o),u=l>=a.length;return o=!o&&Te.isArray(s)?s.length:o,u?(Te.hasOwnProp(s,o)?s[o]=[s[o],r]:s[o]=r,!d):((!s[o]||!Te.isObject(s[o]))&&(s[o]=[]),n(a,r,s[o],l)&&Te.isArray(s[o])&&(s[o]=qE(s[o])),!d)}if(Te.isFormData(e)&&Te.isFunction(e.entries)){const a={};return Te.forEachEntry(e,(r,s)=>{n(GE(r),s,a,0)}),a}return null}function WE(e,n,a){if(Te.isString(e))try{return(n||JSON.parse)(e),Te.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(a||JSON.stringify)(e)}const bu={transitional:kj,adapter:["xhr","http","fetch"],transformRequest:[function(n,a){const r=a.getContentType()||"",s=r.indexOf("application/json")>-1,l=Te.isObject(n);if(l&&Te.isHTMLForm(n)&&(n=new FormData(n)),Te.isFormData(n))return s?JSON.stringify(Tj(n)):n;if(Te.isArrayBuffer(n)||Te.isBuffer(n)||Te.isStream(n)||Te.isFile(n)||Te.isBlob(n)||Te.isReadableStream(n))return n;if(Te.isArrayBufferView(n))return n.buffer;if(Te.isURLSearchParams(n))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let d;if(l){if(r.indexOf("application/x-www-form-urlencoded")>-1)return $E(n,this.formSerializer).toString();if((d=Te.isFileList(n))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Q0(d?{"files[]":n}:n,u&&new u,this.formSerializer)}}return l||s?(a.setContentType("application/json",!1),WE(n)):n}],transformResponse:[function(n){const a=this.transitional||bu.transitional,r=a&&a.forcedJSONParsing,s=this.responseType==="json";if(Te.isResponse(n)||Te.isReadableStream(n))return n;if(n&&Te.isString(n)&&(r&&!this.responseType||s)){const o=!(a&&a.silentJSONParsing)&&s;try{return JSON.parse(n,this.parseReviver)}catch(d){if(o)throw d.name==="SyntaxError"?ft.from(d,ft.ERR_BAD_RESPONSE,this,null,this.response):d}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Na.classes.FormData,Blob:Na.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Te.forEach(["delete","get","head","post","put","patch"],e=>{bu.headers[e]={}});const XE=Te.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),QE=e=>{const n={};let a,r,s;return e&&e.split(`
`).forEach(function(o){s=o.indexOf(":"),a=o.substring(0,s).trim().toLowerCase(),r=o.substring(s+1).trim(),!(!a||n[a]&&XE[a])&&(a==="set-cookie"?n[a]?n[a].push(r):n[a]=[r]:n[a]=n[a]?n[a]+", "+r:r)}),n},db=Symbol("internals");function Nd(e){return e&&String(e).trim().toLowerCase()}function l0(e){return e===!1||e==null?e:Te.isArray(e)?e.map(l0):String(e)}function YE(e){const n=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=a.exec(e);)n[r[1]]=r[2];return n}const JE=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Jm(e,n,a,r,s){if(Te.isFunction(r))return r.call(this,n,a);if(s&&(n=a),!!Te.isString(n)){if(Te.isString(r))return n.indexOf(r)!==-1;if(Te.isRegExp(r))return r.test(n)}}function ZE(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,a,r)=>a.toUpperCase()+r)}function e5(e,n){const a=Te.toCamelCase(" "+n);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+a,{value:function(s,l,o){return this[r].call(this,n,s,l,o)},configurable:!0})})}let Ya=class{constructor(n){n&&this.set(n)}set(n,a,r){const s=this;function l(d,u,h){const m=Nd(u);if(!m)throw new Error("header name must be a non-empty string");const f=Te.findKey(s,m);(!f||s[f]===void 0||h===!0||h===void 0&&s[f]!==!1)&&(s[f||u]=l0(d))}const o=(d,u)=>Te.forEach(d,(h,m)=>l(h,m,u));if(Te.isPlainObject(n)||n instanceof this.constructor)o(n,a);else if(Te.isString(n)&&(n=n.trim())&&!JE(n))o(QE(n),a);else if(Te.isObject(n)&&Te.isIterable(n)){let d={},u,h;for(const m of n){if(!Te.isArray(m))throw TypeError("Object iterator must return a key-value pair");d[h=m[0]]=(u=d[h])?Te.isArray(u)?[...u,m[1]]:[u,m[1]]:m[1]}o(d,a)}else n!=null&&l(a,n,r);return this}get(n,a){if(n=Nd(n),n){const r=Te.findKey(this,n);if(r){const s=this[r];if(!a)return s;if(a===!0)return YE(s);if(Te.isFunction(a))return a.call(this,s,r);if(Te.isRegExp(a))return a.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,a){if(n=Nd(n),n){const r=Te.findKey(this,n);return!!(r&&this[r]!==void 0&&(!a||Jm(this,this[r],r,a)))}return!1}delete(n,a){const r=this;let s=!1;function l(o){if(o=Nd(o),o){const d=Te.findKey(r,o);d&&(!a||Jm(r,r[d],d,a))&&(delete r[d],s=!0)}}return Te.isArray(n)?n.forEach(l):l(n),s}clear(n){const a=Object.keys(this);let r=a.length,s=!1;for(;r--;){const l=a[r];(!n||Jm(this,this[l],l,n,!0))&&(delete this[l],s=!0)}return s}normalize(n){const a=this,r={};return Te.forEach(this,(s,l)=>{const o=Te.findKey(r,l);if(o){a[o]=l0(s),delete a[l];return}const d=n?ZE(l):String(l).trim();d!==l&&delete a[l],a[d]=l0(s),r[d]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const a=Object.create(null);return Te.forEach(this,(r,s)=>{r!=null&&r!==!1&&(a[s]=n&&Te.isArray(r)?r.join(", "):r)}),a}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,a])=>n+": "+a).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...a){const r=new this(n);return a.forEach(s=>r.set(s)),r}static accessor(n){const r=(this[db]=this[db]={accessors:{}}).accessors,s=this.prototype;function l(o){const d=Nd(o);r[d]||(e5(s,o),r[d]=!0)}return Te.isArray(n)?n.forEach(l):l(n),this}};Ya.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Te.reduceDescriptors(Ya.prototype,({value:e},n)=>{let a=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(r){this[a]=r}}});Te.freezeMethods(Ya);function Zm(e,n){const a=this||bu,r=n||a,s=Ya.from(r.headers);let l=r.data;return Te.forEach(e,function(d){l=d.call(a,l,s.normalize(),n?n.status:void 0)}),s.normalize(),l}function Cj(e){return!!(e&&e.__CANCEL__)}function Ac(e,n,a){ft.call(this,e??"canceled",ft.ERR_CANCELED,n,a),this.name="CanceledError"}Te.inherits(Ac,ft,{__CANCEL__:!0});function Sj(e,n,a){const r=a.config.validateStatus;!a.status||!r||r(a.status)?e(a):n(new ft("Request failed with status code "+a.status,[ft.ERR_BAD_REQUEST,ft.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}function t5(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function n5(e,n){e=e||10;const a=new Array(e),r=new Array(e);let s=0,l=0,o;return n=n!==void 0?n:1e3,function(u){const h=Date.now(),m=r[l];o||(o=h),a[s]=u,r[s]=h;let f=l,p=0;for(;f!==s;)p+=a[f++],f=f%e;if(s=(s+1)%e,s===l&&(l=(l+1)%e),h-o<n)return;const b=m&&h-m;return b?Math.round(p*1e3/b):void 0}}function a5(e,n){let a=0,r=1e3/n,s,l;const o=(h,m=Date.now())=>{a=m,s=null,l&&(clearTimeout(l),l=null),e(...h)};return[(...h)=>{const m=Date.now(),f=m-a;f>=r?o(h,m):(s=h,l||(l=setTimeout(()=>{l=null,o(s)},r-f)))},()=>s&&o(s)]}const g0=(e,n,a=3)=>{let r=0;const s=n5(50,250);return a5(l=>{const o=l.loaded,d=l.lengthComputable?l.total:void 0,u=o-r,h=s(u),m=o<=d;r=o;const f={loaded:o,total:d,progress:d?o/d:void 0,bytes:u,rate:h||void 0,estimated:h&&d&&m?(d-o)/h:void 0,event:l,lengthComputable:d!=null,[n?"download":"upload"]:!0};e(f)},a)},ub=(e,n)=>{const a=e!=null;return[r=>n[0]({lengthComputable:a,total:e,loaded:r}),n[1]]},hb=e=>(...n)=>Te.asap(()=>e(...n)),r5=Na.hasStandardBrowserEnv?((e,n)=>a=>(a=new URL(a,Na.origin),e.protocol===a.protocol&&e.host===a.host&&(n||e.port===a.port)))(new URL(Na.origin),Na.navigator&&/(msie|trident)/i.test(Na.navigator.userAgent)):()=>!0,s5=Na.hasStandardBrowserEnv?{write(e,n,a,r,s,l,o){if(typeof document>"u")return;const d=[`${e}=${encodeURIComponent(n)}`];Te.isNumber(a)&&d.push(`expires=${new Date(a).toUTCString()}`),Te.isString(r)&&d.push(`path=${r}`),Te.isString(s)&&d.push(`domain=${s}`),l===!0&&d.push("secure"),Te.isString(o)&&d.push(`SameSite=${o}`),document.cookie=d.join("; ")},read(e){if(typeof document>"u")return null;const n=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return n?decodeURIComponent(n[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function i5(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function l5(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function _j(e,n,a){let r=!i5(n);return e&&(r||a==!1)?l5(e,n):n}const xb=e=>e instanceof Ya?{...e}:e;function ao(e,n){n=n||{};const a={};function r(h,m,f,p){return Te.isPlainObject(h)&&Te.isPlainObject(m)?Te.merge.call({caseless:p},h,m):Te.isPlainObject(m)?Te.merge({},m):Te.isArray(m)?m.slice():m}function s(h,m,f,p){if(Te.isUndefined(m)){if(!Te.isUndefined(h))return r(void 0,h,f,p)}else return r(h,m,f,p)}function l(h,m){if(!Te.isUndefined(m))return r(void 0,m)}function o(h,m){if(Te.isUndefined(m)){if(!Te.isUndefined(h))return r(void 0,h)}else return r(void 0,m)}function d(h,m,f){if(f in n)return r(h,m);if(f in e)return r(void 0,h)}const u={url:l,method:l,data:l,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:d,headers:(h,m,f)=>s(xb(h),xb(m),f,!0)};return Te.forEach(Object.keys({...e,...n}),function(m){const f=u[m]||s,p=f(e[m],n[m],m);Te.isUndefined(p)&&f!==d||(a[m]=p)}),a}const Ej=e=>{const n=ao({},e);let{data:a,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:l,headers:o,auth:d}=n;if(n.headers=o=Ya.from(o),n.url=wj(_j(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),d&&o.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):""))),Te.isFormData(a)){if(Na.hasStandardBrowserEnv||Na.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(Te.isFunction(a.getHeaders)){const u=a.getHeaders(),h=["content-type","content-length"];Object.entries(u).forEach(([m,f])=>{h.includes(m.toLowerCase())&&o.set(m,f)})}}if(Na.hasStandardBrowserEnv&&(r&&Te.isFunction(r)&&(r=r(n)),r||r!==!1&&r5(n.url))){const u=s&&l&&s5.read(l);u&&o.set(s,u)}return n},o5=typeof XMLHttpRequest<"u",c5=o5&&function(e){return new Promise(function(a,r){const s=Ej(e);let l=s.data;const o=Ya.from(s.headers).normalize();let{responseType:d,onUploadProgress:u,onDownloadProgress:h}=s,m,f,p,b,g;function y(){b&&b(),g&&g(),s.cancelToken&&s.cancelToken.unsubscribe(m),s.signal&&s.signal.removeEventListener("abort",m)}let N=new XMLHttpRequest;N.open(s.method.toUpperCase(),s.url,!0),N.timeout=s.timeout;function C(){if(!N)return;const S=Ya.from("getAllResponseHeaders"in N&&N.getAllResponseHeaders()),_={data:!d||d==="text"||d==="json"?N.responseText:N.response,status:N.status,statusText:N.statusText,headers:S,config:e,request:N};Sj(function(j){a(j),y()},function(j){r(j),y()},_),N=null}"onloadend"in N?N.onloadend=C:N.onreadystatechange=function(){!N||N.readyState!==4||N.status===0&&!(N.responseURL&&N.responseURL.indexOf("file:")===0)||setTimeout(C)},N.onabort=function(){N&&(r(new ft("Request aborted",ft.ECONNABORTED,e,N)),N=null)},N.onerror=function(k){const _=k&&k.message?k.message:"Network Error",P=new ft(_,ft.ERR_NETWORK,e,N);P.event=k||null,r(P),N=null},N.ontimeout=function(){let k=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const _=s.transitional||kj;s.timeoutErrorMessage&&(k=s.timeoutErrorMessage),r(new ft(k,_.clarifyTimeoutError?ft.ETIMEDOUT:ft.ECONNABORTED,e,N)),N=null},l===void 0&&o.setContentType(null),"setRequestHeader"in N&&Te.forEach(o.toJSON(),function(k,_){N.setRequestHeader(_,k)}),Te.isUndefined(s.withCredentials)||(N.withCredentials=!!s.withCredentials),d&&d!=="json"&&(N.responseType=s.responseType),h&&([p,g]=g0(h,!0),N.addEventListener("progress",p)),u&&N.upload&&([f,b]=g0(u),N.upload.addEventListener("progress",f),N.upload.addEventListener("loadend",b)),(s.cancelToken||s.signal)&&(m=S=>{N&&(r(!S||S.type?new Ac(null,e,N):S),N.abort(),N=null)},s.cancelToken&&s.cancelToken.subscribe(m),s.signal&&(s.signal.aborted?m():s.signal.addEventListener("abort",m)));const T=t5(s.url);if(T&&Na.protocols.indexOf(T)===-1){r(new ft("Unsupported protocol "+T+":",ft.ERR_BAD_REQUEST,e));return}N.send(l||null)})},d5=(e,n)=>{const{length:a}=e=e?e.filter(Boolean):[];if(n||a){let r=new AbortController,s;const l=function(h){if(!s){s=!0,d();const m=h instanceof Error?h:this.reason;r.abort(m instanceof ft?m:new Ac(m instanceof Error?m.message:m))}};let o=n&&setTimeout(()=>{o=null,l(new ft(`timeout ${n} of ms exceeded`,ft.ETIMEDOUT))},n);const d=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(h=>{h.unsubscribe?h.unsubscribe(l):h.removeEventListener("abort",l)}),e=null)};e.forEach(h=>h.addEventListener("abort",l));const{signal:u}=r;return u.unsubscribe=()=>Te.asap(d),u}},u5=function*(e,n){let a=e.byteLength;if(a<n){yield e;return}let r=0,s;for(;r<a;)s=r+n,yield e.slice(r,s),r=s},h5=async function*(e,n){for await(const a of x5(e))yield*u5(a,n)},x5=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:a,value:r}=await n.read();if(a)break;yield r}}finally{await n.cancel()}},mb=(e,n,a,r)=>{const s=h5(e,n);let l=0,o,d=u=>{o||(o=!0,r&&r(u))};return new ReadableStream({async pull(u){try{const{done:h,value:m}=await s.next();if(h){d(),u.close();return}let f=m.byteLength;if(a){let p=l+=f;a(p)}u.enqueue(new Uint8Array(m))}catch(h){throw d(h),h}},cancel(u){return d(u),s.return()}},{highWaterMark:2})},fb=64*1024,{isFunction:Vh}=Te,m5=(({Request:e,Response:n})=>({Request:e,Response:n}))(Te.global),{ReadableStream:pb,TextEncoder:gb}=Te.global,yb=(e,...n)=>{try{return!!e(...n)}catch{return!1}},f5=e=>{e=Te.merge.call({skipUndefined:!0},m5,e);const{fetch:n,Request:a,Response:r}=e,s=n?Vh(n):typeof fetch=="function",l=Vh(a),o=Vh(r);if(!s)return!1;const d=s&&Vh(pb),u=s&&(typeof gb=="function"?(g=>y=>g.encode(y))(new gb):async g=>new Uint8Array(await new a(g).arrayBuffer())),h=l&&d&&yb(()=>{let g=!1;const y=new a(Na.origin,{body:new pb,method:"POST",get duplex(){return g=!0,"half"}}).headers.has("Content-Type");return g&&!y}),m=o&&d&&yb(()=>Te.isReadableStream(new r("").body)),f={stream:m&&(g=>g.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(g=>{!f[g]&&(f[g]=(y,N)=>{let C=y&&y[g];if(C)return C.call(y);throw new ft(`Response type '${g}' is not supported`,ft.ERR_NOT_SUPPORT,N)})});const p=async g=>{if(g==null)return 0;if(Te.isBlob(g))return g.size;if(Te.isSpecCompliantForm(g))return(await new a(Na.origin,{method:"POST",body:g}).arrayBuffer()).byteLength;if(Te.isArrayBufferView(g)||Te.isArrayBuffer(g))return g.byteLength;if(Te.isURLSearchParams(g)&&(g=g+""),Te.isString(g))return(await u(g)).byteLength},b=async(g,y)=>{const N=Te.toFiniteNumber(g.getContentLength());return N??p(y)};return async g=>{let{url:y,method:N,data:C,signal:T,cancelToken:S,timeout:k,onDownloadProgress:_,onUploadProgress:P,responseType:j,headers:A,withCredentials:L="same-origin",fetchOptions:W}=Ej(g),R=n||fetch;j=j?(j+"").toLowerCase():"text";let M=d5([T,S&&S.toAbortSignal()],k),q=null;const ee=M&&M.unsubscribe&&(()=>{M.unsubscribe()});let z;try{if(P&&h&&N!=="get"&&N!=="head"&&(z=await b(A,C))!==0){let H=new a(y,{method:"POST",body:C,duplex:"half"}),F;if(Te.isFormData(C)&&(F=H.headers.get("content-type"))&&A.setContentType(F),H.body){const[I,O]=ub(z,g0(hb(P)));C=mb(H.body,fb,I,O)}}Te.isString(L)||(L=L?"include":"omit");const fe=l&&"credentials"in a.prototype,ae={...W,signal:M,method:N.toUpperCase(),headers:A.normalize().toJSON(),body:C,duplex:"half",credentials:fe?L:void 0};q=l&&new a(y,ae);let J=await(l?R(q,W):R(y,ae));const G=m&&(j==="stream"||j==="response");if(m&&(_||G&&ee)){const H={};["status","statusText","headers"].forEach(V=>{H[V]=J[V]});const F=Te.toFiniteNumber(J.headers.get("content-length")),[I,O]=_&&ub(F,g0(hb(_),!0))||[];J=new r(mb(J.body,fb,I,()=>{O&&O(),ee&&ee()}),H)}j=j||"text";let he=await f[Te.findKey(f,j)||"text"](J,g);return!G&&ee&&ee(),await new Promise((H,F)=>{Sj(H,F,{data:he,headers:Ya.from(J.headers),status:J.status,statusText:J.statusText,config:g,request:q})})}catch(fe){throw ee&&ee(),fe&&fe.name==="TypeError"&&/Load failed|fetch/i.test(fe.message)?Object.assign(new ft("Network Error",ft.ERR_NETWORK,g,q),{cause:fe.cause||fe}):ft.from(fe,fe&&fe.code,g,q)}}},p5=new Map,Dj=e=>{let n=e&&e.env||{};const{fetch:a,Request:r,Response:s}=n,l=[r,s,a];let o=l.length,d=o,u,h,m=p5;for(;d--;)u=l[d],h=m.get(u),h===void 0&&m.set(u,h=d?new Map:f5(n)),m=h;return h};Dj();const rg={http:PE,xhr:c5,fetch:{get:Dj}};Te.forEach(rg,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const vb=e=>`- ${e}`,g5=e=>Te.isFunction(e)||e===null||e===!1;function y5(e,n){e=Te.isArray(e)?e:[e];const{length:a}=e;let r,s;const l={};for(let o=0;o<a;o++){r=e[o];let d;if(s=r,!g5(r)&&(s=rg[(d=String(r)).toLowerCase()],s===void 0))throw new ft(`Unknown adapter '${d}'`);if(s&&(Te.isFunction(s)||(s=s.get(n))))break;l[d||"#"+o]=s}if(!s){const o=Object.entries(l).map(([u,h])=>`adapter ${u} `+(h===!1?"is not supported by the environment":"is not available in the build"));let d=a?o.length>1?`since :
`+o.map(vb).join(`
`):" "+vb(o[0]):"as no adapter specified";throw new ft("There is no suitable adapter to dispatch the request "+d,"ERR_NOT_SUPPORT")}return s}const Fj={getAdapter:y5,adapters:rg};function ef(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ac(null,e)}function bb(e){return ef(e),e.headers=Ya.from(e.headers),e.data=Zm.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Fj.getAdapter(e.adapter||bu.adapter,e)(e).then(function(r){return ef(e),r.data=Zm.call(e,e.transformResponse,r),r.headers=Ya.from(r.headers),r},function(r){return Cj(r)||(ef(e),r&&r.response&&(r.response.data=Zm.call(e,e.transformResponse,r.response),r.response.headers=Ya.from(r.response.headers))),Promise.reject(r)})}const Aj="1.13.2",Y0={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{Y0[e]=function(r){return typeof r===e||"a"+(n<1?"n ":" ")+e}});const Nb={};Y0.transitional=function(n,a,r){function s(l,o){return"[Axios v"+Aj+"] Transitional option '"+l+"'"+o+(r?". "+r:"")}return(l,o,d)=>{if(n===!1)throw new ft(s(o," has been removed"+(a?" in "+a:"")),ft.ERR_DEPRECATED);return a&&!Nb[o]&&(Nb[o]=!0,console.warn(s(o," has been deprecated since v"+a+" and will be removed in the near future"))),n?n(l,o,d):!0}};Y0.spelling=function(n){return(a,r)=>(console.warn(`${r} is likely a misspelling of ${n}`),!0)};function v5(e,n,a){if(typeof e!="object")throw new ft("options must be an object",ft.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let s=r.length;for(;s-- >0;){const l=r[s],o=n[l];if(o){const d=e[l],u=d===void 0||o(d,l,e);if(u!==!0)throw new ft("option "+l+" must be "+u,ft.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new ft("Unknown option "+l,ft.ERR_BAD_OPTION)}}const o0={assertOptions:v5,validators:Y0},cs=o0.validators;let Xl=class{constructor(n){this.defaults=n||{},this.interceptors={request:new cb,response:new cb}}async request(n,a){try{return await this._request(n,a)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const l=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?l&&!String(r.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+l):r.stack=l}catch{}}throw r}}_request(n,a){typeof n=="string"?(a=a||{},a.url=n):a=n||{},a=ao(this.defaults,a);const{transitional:r,paramsSerializer:s,headers:l}=a;r!==void 0&&o0.assertOptions(r,{silentJSONParsing:cs.transitional(cs.boolean),forcedJSONParsing:cs.transitional(cs.boolean),clarifyTimeoutError:cs.transitional(cs.boolean)},!1),s!=null&&(Te.isFunction(s)?a.paramsSerializer={serialize:s}:o0.assertOptions(s,{encode:cs.function,serialize:cs.function},!0)),a.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?a.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:a.allowAbsoluteUrls=!0),o0.assertOptions(a,{baseUrl:cs.spelling("baseURL"),withXsrfToken:cs.spelling("withXSRFToken")},!0),a.method=(a.method||this.defaults.method||"get").toLowerCase();let o=l&&Te.merge(l.common,l[a.method]);l&&Te.forEach(["delete","get","head","post","put","patch","common"],g=>{delete l[g]}),a.headers=Ya.concat(o,l);const d=[];let u=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(a)===!1||(u=u&&y.synchronous,d.unshift(y.fulfilled,y.rejected))});const h=[];this.interceptors.response.forEach(function(y){h.push(y.fulfilled,y.rejected)});let m,f=0,p;if(!u){const g=[bb.bind(this),void 0];for(g.unshift(...d),g.push(...h),p=g.length,m=Promise.resolve(a);f<p;)m=m.then(g[f++],g[f++]);return m}p=d.length;let b=a;for(;f<p;){const g=d[f++],y=d[f++];try{b=g(b)}catch(N){y.call(this,N);break}}try{m=bb.call(this,b)}catch(g){return Promise.reject(g)}for(f=0,p=h.length;f<p;)m=m.then(h[f++],h[f++]);return m}getUri(n){n=ao(this.defaults,n);const a=_j(n.baseURL,n.url,n.allowAbsoluteUrls);return wj(a,n.params,n.paramsSerializer)}};Te.forEach(["delete","get","head","options"],function(n){Xl.prototype[n]=function(a,r){return this.request(ao(r||{},{method:n,url:a,data:(r||{}).data}))}});Te.forEach(["post","put","patch"],function(n){function a(r){return function(l,o,d){return this.request(ao(d||{},{method:n,headers:r?{"Content-Type":"multipart/form-data"}:{},url:l,data:o}))}}Xl.prototype[n]=a(),Xl.prototype[n+"Form"]=a(!0)});let b5=class Pj{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(l){a=l});const r=this;this.promise.then(s=>{if(!r._listeners)return;let l=r._listeners.length;for(;l-- >0;)r._listeners[l](s);r._listeners=null}),this.promise.then=s=>{let l;const o=new Promise(d=>{r.subscribe(d),l=d}).then(s);return o.cancel=function(){r.unsubscribe(l)},o},n(function(l,o,d){r.reason||(r.reason=new Ac(l,o,d),a(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const a=this._listeners.indexOf(n);a!==-1&&this._listeners.splice(a,1)}toAbortSignal(){const n=new AbortController,a=r=>{n.abort(r)};return this.subscribe(a),n.signal.unsubscribe=()=>this.unsubscribe(a),n.signal}static source(){let n;return{token:new Pj(function(s){n=s}),cancel:n}}};function N5(e){return function(a){return e.apply(null,a)}}function j5(e){return Te.isObject(e)&&e.isAxiosError===!0}const dp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(dp).forEach(([e,n])=>{dp[n]=e});function Lj(e){const n=new Xl(e),a=uj(Xl.prototype.request,n);return Te.extend(a,Xl.prototype,n,{allOwnKeys:!0}),Te.extend(a,n,null,{allOwnKeys:!0}),a.create=function(s){return Lj(ao(e,s))},a}const Jt=Lj(bu);Jt.Axios=Xl;Jt.CanceledError=Ac;Jt.CancelToken=b5;Jt.isCancel=Cj;Jt.VERSION=Aj;Jt.toFormData=Q0;Jt.AxiosError=ft;Jt.Cancel=Jt.CanceledError;Jt.all=function(n){return Promise.all(n)};Jt.spread=N5;Jt.isAxiosError=j5;Jt.mergeConfig=ao;Jt.AxiosHeaders=Ya;Jt.formToJSON=e=>Tj(Te.isHTMLForm(e)?new FormData(e):e);Jt.getAdapter=Fj.getAdapter;Jt.HttpStatusCode=dp;Jt.default=Jt;const{Axios:yU,AxiosError:vU,CanceledError:bU,isCancel:NU,CancelToken:jU,VERSION:wU,all:kU,Cancel:TU,isAxiosError:CU,spread:SU,toFormData:_U,AxiosHeaders:EU,HttpStatusCode:DU,formToJSON:FU,getAdapter:AU,mergeConfig:PU}=Jt,w5="tinh_luong_auth",Zn=Jt.create({baseURL:"/api/rbac",headers:{"Content-Type":"application/json"}});Zn.interceptors.request.use(e=>{const n=localStorage.getItem(w5);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const tf={dangNhap:(e,n)=>Zn.post("/dang-nhap",{tenDangNhap:e,matKhau:n}).then(a=>a.data),dangXuat:e=>Zn.post("/dang-xuat",null,{headers:{Authorization:`Bearer ${e}`}}).then(n=>n.data),kiemTraToken:e=>Zn.get("/kiem-tra-token",{headers:{Authorization:`Bearer ${e}`}}).then(n=>n.data)},nf={layTatCa:()=>Zn.get("/nguoi-dung").then(e=>e.data),layTheoId:e=>Zn.get(`/nguoi-dung/${e}`).then(n=>n.data),taoMoi:e=>Zn.post("/nguoi-dung",e).then(n=>n.data),capNhat:(e,n)=>Zn.put(`/nguoi-dung/${e}`,n).then(a=>a.data),doiMatKhau:(e,n,a)=>Zn.put(`/nguoi-dung/${e}/doi-mat-khau`,{matKhauCu:n,matKhauMoi:a}).then(r=>r.data)},jb={layTatCa:()=>Zn.get("/vai-tro").then(e=>e.data),layTheoId:e=>Zn.get(`/vai-tro/${e}`).then(n=>n.data),taoMoi:e=>Zn.post("/vai-tro",e).then(n=>n.data),capNhat:(e,n)=>Zn.put(`/vai-tro/${e}`,n).then(a=>a.data),ganVaiTro:(e,n)=>Zn.post("/vai-tro/gan",{nguoiDungId:e,vaiTroId:n}).then(a=>a.data),goVaiTro:(e,n)=>Zn.delete("/vai-tro/go",{data:{nguoiDungId:e,vaiTroId:n}}).then(a=>a.data)},k5={layDanhSach:e=>Zn.get("/audit-log",{params:e}).then(n=>n.data),layTheoNguoiDung:e=>Zn.get(`/audit-log/nguoi-dung/${e}`).then(n=>n.data),layTheoBanGhi:(e,n)=>Zn.get(`/audit-log/ban-ghi/${e}/${n}`).then(a=>a.data)},Oj=E.createContext(void 0),Go="tinh_luong_auth",T5=6e4;function C5({children:e}){const[n,a]=E.useState(null),[r,s]=E.useState(null),[l,o]=E.useState([]),[d,u]=E.useState([]),[h,m]=E.useState(!0),f=E.useCallback(()=>{localStorage.removeItem(Go),s(null),a(null),o([]),u([])},[]),p=E.useCallback(()=>{const T=localStorage.getItem(Go);if(T)try{const S=JSON.parse(T),k=new Date(S.hetHan),_=new Date;if(k<=_)return f(),window.location.href="/dang-nhap?expired=1",!1;const P=k.getTime()-_.getTime();return P<600*1e3&&P>0&&console.warn("Token sp ht hn trong",Math.floor(P/6e4),"pht"),!0}catch{return f(),!1}return!1},[f]);E.useEffect(()=>{const T=localStorage.getItem(Go);if(T)try{const S=JSON.parse(T);new Date(S.hetHan)>new Date?(s(S.token),a(S.user),o(S.vaiTros),u(S.quyens)):localStorage.removeItem(Go)}catch{localStorage.removeItem(Go)}m(!1)},[]),E.useEffect(()=>{if(r){const T=setInterval(p,T5);return()=>clearInterval(T)}},[r,p]);const b=async(T,S)=>{const k=await tf.dangNhap(T,S),_={token:k.token,user:k.nguoiDung,vaiTros:k.vaiTros,quyens:k.quyens,hetHan:k.hetHan};localStorage.setItem(Go,JSON.stringify(_)),s(k.token),a(k.nguoiDung),o(k.vaiTros),u(k.quyens)},g=async()=>{if(r)try{await tf.dangXuat(r)}catch{}f()},y=async()=>{if(r)try{(await tf.kiemTraToken(r)).hieu_luc||(f(),window.location.href="/dang-nhap?expired=1")}catch{f()}},N=T=>d.includes(T)||l.includes("ADMIN"),C=T=>l.includes(T);return t.jsx(Oj.Provider,{value:{user:n,token:r,vaiTros:l,quyens:d,isAuthenticated:!!n,isLoading:h,dangNhap:b,dangXuat:g,coQuyen:N,coVaiTro:C,refreshToken:y},children:e})}function ns(){const e=E.useContext(Oj);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}function Pt({children:e,quyen:n}){const{isAuthenticated:a,isLoading:r,coQuyen:s}=ns();return r?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):a?n&&!s(n)?t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[t.jsx("h3",{className:"text-lg font-medium text-red-800",children:"Khng c quyn truy cp"}),t.jsx("p",{className:"text-red-600 mt-2",children:"Bn khng c quyn truy cp trang ny."})]}):t.jsx(t.Fragment,{children:e}):(window.location.href="/dang-nhap",null)}const af=8,S5="payroll_favorites_";function Ij(){const{user:e,coQuyen:n,coVaiTro:a}=ns(),[r,s]=E.useState([]),l=e?`${S5}${e.id}`:null;E.useEffect(()=>{if(l){const f=localStorage.getItem(l);if(f)try{const p=JSON.parse(f);Array.isArray(p)&&s(p)}catch{}}},[l]);const o=E.useCallback(f=>{l&&localStorage.setItem(l,JSON.stringify(f))},[l]),d=E.useCallback(f=>{s(p=>{let b;if(p.includes(f))b=p.filter(g=>g!==f);else{if(p.length>=af)return p;b=[...p,f]}return o(b),b})},[o]),u=E.useCallback(f=>r.includes(f),[r]),h=r.length>=af,m=E.useCallback(f=>!f||f.length===0||a("ADMIN")?!0:f.some(p=>n(p)||a(p)),[n,a]);return{favorites:r,toggleFavorite:d,isFavorite:u,isFull:h,maxFavorites:af,filterByPermission:m}}const up=[{id:"tong-quan",title:"Tng quan",collapsible:!1,items:[{id:"trang-chu",label:"Trang ch",icon:G0,path:"/",tags:["dashboard","home","tng quan"]},{id:"cong-nhan-vien",label:"Cng nhn vin",icon:s0,path:"/portal",tags:["portal","employee","self-service","mobile","pwa"],badge:"Mi"}]},{id:"ky-luong",title:"K lng",collapsible:!0,color:"blue",items:[{id:"bang-luong",label:"Bng lng",icon:Ys,path:"/bang-luong",requiredPermissions:["BANG_LUONG_VIEW"],tags:["payroll","salary sheet","bng tnh"]}]},{id:"ung-luong",title:"ng lng",collapsible:!0,color:"purple",items:[{id:"bang-ung-luong",label:"Bng ng lng",icon:Zp,path:"/ung-luong",requiredPermissions:["UNG_LUONG_VIEW"],tags:["advance","tm ng"]}]},{id:"bao-cao",title:"Bo co & S lng",collapsible:!0,color:"green",items:[{id:"so-luong-nhan-vien",label:"S lng nhn vin",icon:d_,path:"/so-luong/nhan-vien",requiredPermissions:["SO_LUONG_VIEW"],tags:["employee salary book","s lng"]},{id:"so-luong-phong-ban",label:"S lng phng ban",icon:tj,path:"/so-luong/phong-ban",requiredPermissions:["SO_LUONG_VIEW"],tags:["department salary","bo co phng ban"]}]},{id:"tinh-luong",title:"Tnh lng",collapsible:!0,color:"orange",items:[{id:"khoan-luong",label:"Khon lng",icon:M_,path:"/khoan-luong",requiredPermissions:["KHOAN_LUONG_VIEW"],tags:["salary component","thnh phn lng"]},{id:"quy-che",label:"Quy ch lng",icon:B_,path:"/quy-che",requiredPermissions:["QUY_CHE_VIEW"],tags:["rule","engine","cng thc","quy tc"]},{id:"su-kien",label:"S kin thng/pht",icon:eg,path:"/su-kien",requiredPermissions:["SU_KIEN_VIEW"],tags:["bonus","penalty","thng","pht"]}]},{id:"du-lieu-dau-vao",title:"D liu u vo",collapsible:!0,color:"slate",items:[{id:"nhan-vien",label:"Nhn vin",icon:q_,path:"/nhan-vien",requiredPermissions:["NHAN_VIEN_VIEW"],tags:["employee","staff","nhn s"]},{id:"phong-ban",label:"Phng ban",icon:sj,path:"/phong-ban",requiredPermissions:["PHONG_BAN_VIEW"],tags:["department","t chc"]},{id:"nhom-nhan-vien",label:"Nhm nhn vin",icon:m0,path:"/nhom-nhan-vien",requiredPermissions:["NHOM_NV_VIEW"],tags:["group","team"]},{id:"cham-cong",label:"Chm cng",icon:nn,path:"/cham-cong",requiredPermissions:["CHAM_CONG_VIEW"],tags:["attendance","timesheet","gi lm"]},{id:"xep-ca",label:"Xp ca",icon:Ot,requiredPermissions:["PHAN_CA_VIEW"],tags:["scheduling","shift","ca lm vic"],badge:"Mi",children:[{id:"danh-muc-ca",label:"Danh mc ca",icon:oj,path:"/xep-ca/danh-muc-ca",tags:["shift","ca"]},{id:"lich-phan-ca",label:"Lch phn ca",icon:nb,path:"/xep-ca/lich-phan-ca",tags:["schedule","calendar","lch"]}]},{id:"nghi-phep",label:"Ngh php",icon:m_,requiredPermissions:["NGHI_PHEP_VIEW"],tags:["leave","off","ngh"],children:[{id:"don-cua-toi",label:"n ngh ca ti",icon:ua,path:"/nghi-phep/don-cua-toi",tags:["my leave","n ca ti"]},{id:"duyet-nghi-phep",label:"Duyt ngh php",icon:Ma,path:"/nghi-phep/duyet",requiredPermissions:["NGHI_PHEP_DUYET"],tags:["approve","duyt"]},{id:"lich-nghi",label:"Lch ngh php",icon:nb,path:"/nghi-phep/lich",tags:["calendar","lch"]},{id:"loai-nghi",label:"Danh mc loi ngh",icon:__,path:"/nghi-phep/loai-nghi",requiredPermissions:["ADMIN"],tags:["category","loi"]}]},{id:"yeu-cau",label:"Yu cu",icon:g_,requiredPermissions:["YEU_CAU_VIEW"],tags:["request","OT","tr gi","v sm","cng tc"],badge:"Mi",children:[{id:"don-yeu-cau-cua-toi",label:"n ca ti",icon:pu,path:"/yeu-cau/don-cua-toi",tags:["my request","n ca ti"]},{id:"duyet-yeu-cau",label:"Duyt yu cu",icon:Ma,path:"/yeu-cau/duyet",requiredPermissions:["YEU_CAU_DUYET_CAP_1","YEU_CAU_DUYET_CAP_2"],tags:["approve","duyt"]}]},{id:"kpi",label:"KPI",icon:K_,requiredPermissions:["KPI_VIEW"],tags:["performance","nh gi","hiu sut"],children:[{id:"kpi-template",label:"Template KPI",icon:y_,path:"/kpi/template",tags:["template","mu"]},{id:"kpi-ky-danh-gia",label:"K nh gi",icon:ej,path:"/kpi/ky-danh-gia",tags:["period","k"]},{id:"kpi-cau-hinh-thuong",label:"Cu hnh thng",icon:Ar,path:"/kpi/cau-hinh-thuong",tags:["bonus","thng"]}]},{id:"san-luong",label:"Sn lng",icon:h_,requiredPermissions:["SAN_LUONG_VIEW"],tags:["output","production"],children:[{id:"import-chia-hang",label:"Chia hng",icon:F_,path:"/import-chia-hang",tags:["sorting","phn loi"]},{id:"import-giao-hang",label:"Giao hng",icon:$_,path:"/import-giao-hang",tags:["delivery","vn chuyn"]},{id:"lich-su-import",label:"Lch s Import",icon:fu,path:"/lich-su-import",tags:["history","lch s"]}]},{id:"import-excel",label:"Import Excel",icon:qp,path:"/import-excel",requiredPermissions:["IMPORT_EXCEL"],tags:["import","upload","excel"]}]},{id:"thiet-lap",title:"Thit lp h thng",collapsible:!0,color:"cyan",items:[{id:"cai-dat",label:"Ci t h thng",icon:Zs,path:"/cai-dat",requiredPermissions:["ADMIN"],tags:["settings","configuration","cu hnh"]}]},{id:"quan-tri",title:"Qun tr",collapsible:!0,color:"red",items:[{id:"nguoi-dung",label:"Ngi dng",icon:G_,path:"/quan-tri/nguoi-dung",requiredPermissions:["ADMIN"],tags:["user","account","ti khon"]},{id:"audit-log",label:"Nht k h thng",icon:H_,path:"/quan-tri/audit-log",requiredPermissions:["ADMIN"],tags:["log","history","nht k"]}]}];function Mj(e){const n=[];for(const a of e)for(const r of a.items)n.push(r),r.children&&n.push(...r.children);return n}function _5({isOpen:e,isCollapsed:n,onToggleCollapse:a}){var q;const r=Cs(),{coQuyen:s,coVaiTro:l,user:o,dangXuat:d}=ns(),{favorites:u,toggleFavorite:h,isFavorite:m,isFull:f}=Ij(),[p,b]=E.useState(["trang-chu","ky-luong","ung-luong"]),[g,y]=E.useState([]),[N,C]=E.useState(""),T=E.useCallback(ee=>!ee||ee.length===0||l("ADMIN")?!0:ee.some(z=>s(z)||l(z)),[s,l]),S=E.useCallback(ee=>ee.filter(z=>T(z.requiredPermissions)).map(z=>({...z,children:z.children?S(z.children):void 0})).filter(z=>!z.children||z.children.length>0),[T]),k=E.useCallback((ee,z)=>{var J;const fe=z.toLowerCase(),ae=[];for(const G of ee){const he=G.label.toLowerCase().includes(fe),H=(J=G.tags)==null?void 0:J.some(I=>I.toLowerCase().includes(fe)),F=G.children?k(G.children,z):[];(he||H||F.length>0)&&ae.push({...G,children:F.length>0?F:G.children})}return ae},[]),_=E.useMemo(()=>{let ee=up.map(z=>({...z,items:S(z.items)})).filter(z=>z.items.length>0);return N&&(ee=ee.map(z=>({...z,items:k(z.items,N)})).filter(z=>z.items.length>0)),ee},[S,k,N]),P=E.useMemo(()=>{if(u.length===0)return null;const ee=Mj(up),z=u.map(fe=>ee.find(ae=>ae.id===fe)).filter(fe=>!!fe&&T(fe.requiredPermissions));return z.length===0?null:{id:"favorites",title:"Yu thch",items:z}},[u,T]),j=ee=>{b(z=>z.includes(ee)?z.filter(fe=>fe!==ee):[...z,ee])},A=ee=>{y(z=>z.includes(ee)?z.filter(fe=>fe!==ee):[...z,ee])},L=(ee,z)=>{ee.preventDefault(),ee.stopPropagation(),m(z.id)?(h(z.id),le.success(` b "${z.label}" khi yu thch`)):f?le.error("Ch c th ghim ti a 8 mc yu thch"):(h(z.id),le.success(` thm "${z.label}" vo yu thch`))},W=ee=>ee.path==="/"?r.pathname==="/":ee.path&&r.pathname.startsWith(ee.path),R=(ee,z=0)=>{var I;const fe=ee.icon,ae=ee.children&&ee.children.length>0,J=g.includes(ee.id),G=W(ee),he=m(ee.id),H=t.jsxs(t.Fragment,{children:[t.jsx("div",{className:`
          flex items-center justify-center w-9 h-9 rounded-xl transition-all
          ${G?"bg-accent/20":"bg-transparent"}
        `,children:t.jsx(fe,{size:z>0?16:18,className:G?"text-accent":"text-sidebar-muted",strokeWidth:G?2.5:2})}),!n&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:`
              flex-1 truncate text-sm transition-colors
              ${G?"text-white font-medium":"text-sidebar-muted"}
            `,children:ee.label}),ee.path&&t.jsx("button",{onClick:O=>L(O,ee),className:`
                  p-1.5 rounded-lg opacity-0 group-hover:opacity-100 transition-all
                  ${he?"opacity-100 text-yellow-400":"text-sidebar-muted hover:text-yellow-400"}
                  hover:bg-white/5
                `,title:he?"B yu thch":"Thm vo yu thch",children:t.jsx(p0,{size:14,fill:he?"currentColor":"none"})}),ae&&t.jsx(Er,{size:16,className:`text-sidebar-muted transition-transform ${J?"rotate-180":""}`})]})]}),F=`
      group flex items-center gap-3 px-2 py-1.5 mx-2 rounded-xl transition-all duration-200
      ${G?"bg-white/5 border border-accent/50 text-white":"hover:bg-white/5 border border-transparent"}
      ${z>0?"ml-4":""}
    `;return ae?t.jsxs("div",{children:[t.jsx("button",{onClick:()=>A(ee.id),className:F,style:{width:"calc(100% - 16px)"},title:n?ee.label:void 0,children:H}),J&&!n&&t.jsx("div",{className:"mt-1 space-y-0.5 ml-4 border-l border-white/10 pl-2",children:(I=ee.children)==null?void 0:I.map(O=>R(O,z+1))})]},ee.id):t.jsx(ca,{to:ee.path||"#",className:F,title:n?ee.label:void 0,children:H},ee.id)},M=(ee,z)=>{const fe=p.includes(ee.id);return t.jsxs("div",{className:"mb-2",children:[!n&&t.jsxs("button",{onClick:()=>j(ee.id),className:`
              w-full flex items-center justify-between px-4 py-2 
              text-[11px] font-semibold uppercase tracking-wider text-sidebar-muted
              hover:text-white/80 transition-colors
            `,children:[t.jsxs("span",{className:"flex items-center gap-2",children:[z&&t.jsx(p0,{size:12,className:"text-yellow-400",fill:"currentColor"}),ee.title]}),t.jsx(aa,{size:12,className:`transition-transform ${fe?"rotate-90":""}`})]}),(fe||n)&&t.jsx("div",{className:"space-y-0.5",children:ee.items.map(ae=>R(ae,0))})]},ee.id)};return e?t.jsxs("aside",{className:`
        fixed left-0 top-0 bottom-0 z-50
        flex flex-col
        transition-all duration-300 ease-out
        ${n?"w-[72px]":"w-[260px]"}
      `,style:{background:"linear-gradient(180deg, #0B1220 0%, #0F1B2E 100%)",borderRadius:"0 32px 32px 0",margin:"12px 0 12px 12px",height:"calc(100vh - 24px)",boxShadow:"0 0 40px rgba(0, 0, 0, 0.3)"},children:[t.jsxs("div",{className:`
        flex items-center gap-3 px-5 py-6 border-b border-white/5
        ${n?"justify-center":""}
      `,children:[t.jsx("div",{className:`
          w-10 h-10 rounded-xl bg-gradient-to-br from-accent to-accent2 
          flex items-center justify-center shadow-glow-accent
        `,children:t.jsx(eg,{size:22,className:"text-sidebar-solid",strokeWidth:2.5})}),!n&&t.jsxs("div",{children:[t.jsx("h1",{className:"text-white font-bold text-lg tracking-tight",children:"Payroll"}),t.jsx("p",{className:"text-sidebar-muted text-xs",children:"H thng lng"})]})]}),!n&&t.jsx("div",{className:"px-4 py-3",children:t.jsxs("div",{className:"relative",children:[t.jsx(Ss,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-sidebar-muted"}),t.jsx("input",{type:"text",value:N,onChange:ee=>C(ee.target.value),placeholder:"Tm nhanh (Ctrl+K)",className:`
                w-full pl-9 pr-8 py-2.5 text-sm rounded-xl
                bg-white/5 border border-white/10
                text-white placeholder:text-sidebar-muted
                focus:outline-none focus:ring-2 focus:ring-accent/50 focus:border-accent/50
                transition-all
              `}),N&&t.jsx("button",{onClick:()=>C(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-sidebar-muted hover:text-white",children:t.jsx(hn,{size:16})})]})}),t.jsxs("nav",{className:"flex-1 py-2 overflow-y-auto overflow-x-hidden scrollbar-thin",children:[P&&!N&&M(P,!0),P&&!N&&t.jsx("div",{className:"my-3 mx-4 border-t border-white/5"}),_.map(ee=>M(ee)),N&&_.length===0&&t.jsxs("div",{className:"px-4 py-8 text-center text-sidebar-muted text-sm",children:['Khng tm thy "',N,'"']})]}),t.jsxs("div",{className:"border-t border-white/5 p-3",children:[t.jsxs("div",{className:`flex items-center gap-2 ${n?"flex-col":""}`,children:[t.jsxs(ca,{to:"/ho-so",className:`
              flex items-center gap-3 flex-1 p-2 rounded-xl
              hover:bg-white/5 transition-all group
            `,title:n?(o==null?void 0:o.hoTen)||"H s":void 0,children:[t.jsx("div",{className:`
              w-9 h-9 rounded-xl bg-gradient-to-br from-purple-500 to-pink-500
              flex items-center justify-center text-white font-semibold text-sm
            `,children:((q=o==null?void 0:o.hoTen)==null?void 0:q.charAt(0))||"U"}),!n&&t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-white text-sm font-medium truncate",children:(o==null?void 0:o.hoTen)||"Ngi dng"}),t.jsx("p",{className:"text-sidebar-muted text-xs truncate",children:(o==null?void 0:o.email)||(o==null?void 0:o.tenDangNhap)})]})]}),t.jsxs("div",{className:`flex gap-1 ${n?"flex-col":""}`,children:[t.jsx(ca,{to:"/cai-dat",className:`
                p-2.5 rounded-xl text-sidebar-muted hover:text-white hover:bg-white/5
                transition-all
              `,title:"Ci t",children:t.jsx(Zs,{size:18})}),t.jsx("button",{onClick:d,className:`
                p-2.5 rounded-xl text-sidebar-muted hover:text-red-400 hover:bg-red-500/10
                transition-all
              `,title:"ng xut",children:t.jsx(Xp,{size:18})})]})]}),t.jsx("button",{onClick:a,className:`
            w-full mt-3 flex items-center justify-center gap-2 py-2.5 rounded-xl
            text-sidebar-muted hover:text-white hover:bg-white/5
            transition-all text-sm
          `,children:n?t.jsx(aa,{size:18}):t.jsxs(t.Fragment,{children:[t.jsx(Rr,{size:18}),t.jsx("span",{children:"Thu gn"})]})})]})]}):null}const hp=[{path:"/",label:"Trang ch",group:"Tng quan",quickActions:[{id:"tao-ky-luong",label:"To k lng",icon:St,type:"route",to:"/bang-luong?action=create",requiredPermissions:["BANG_LUONG_CREATE"]},{id:"import-excel",label:"Import Excel",icon:bs,type:"route",to:"/import-excel",requiredPermissions:["IMPORT_EXCEL"]}]},{path:"/nhan-vien",label:"Nhn vin",group:"D liu u vo",quickActions:[{id:"them-nhan-vien",label:"Thm nhn vin",icon:St,type:"callback",callbackKey:"OPEN_ADD_NHAN_VIEN_MODAL",requiredPermissions:["NHAN_VIEN_CREATE"]},{id:"xuat-excel-nv",label:"Xut Excel",icon:Xs,type:"callback",callbackKey:"EXPORT_NHAN_VIEN_EXCEL"}]},{path:"/nhan-vien/:id",label:"Chi tit nhn vin",parent:"/nhan-vien",dynamicLabel:e=>`Nhn vin #${e.id}`},{path:"/phong-ban",label:"Phng ban",group:"D liu u vo",quickActions:[{id:"them-phong-ban",label:"Thm phng ban",icon:St,type:"callback",callbackKey:"OPEN_ADD_PHONG_BAN_MODAL",requiredPermissions:["PHONG_BAN_CREATE"]}]},{path:"/nhom-nhan-vien",label:"Nhm nhn vin",group:"D liu u vo"},{path:"/cham-cong",label:"Chm cng",group:"D liu u vo",quickActions:[{id:"import-cham-cong",label:"Import chm cng",icon:bs,type:"callback",callbackKey:"IMPORT_CHAM_CONG",requiredPermissions:["CHAM_CONG_IMPORT"]},{id:"tong-hop-ngay-cong",label:"Tng hp ngy cng",icon:tb,type:"callback",callbackKey:"TONG_HOP_NGAY_CONG"}]},{path:"/nghi-phep/don-cua-toi",label:"n ngh ca ti",group:"Ngh php",quickActions:[{id:"tao-don-nghi",label:"To n ngh",icon:St,type:"callback",callbackKey:"OPEN_TAO_DON_NGHI_MODAL"}]},{path:"/nghi-phep/duyet",label:"Duyt ngh php",group:"Ngh php",requiredPermissions:["NGHI_PHEP_DUYET"]},{path:"/nghi-phep/lich",label:"Lch ngh php",group:"Ngh php"},{path:"/nghi-phep/loai-nghi",label:"Danh mc loi ngh",group:"Ngh php",requiredPermissions:["ADMIN"],quickActions:[{id:"them-loai-nghi",label:"Thm loi ngh",icon:St,type:"callback",callbackKey:"OPEN_ADD_LOAI_NGHI_MODAL",requiredPermissions:["ADMIN"]}]},{path:"/kpi/template",label:"Template KPI",group:"KPI"},{path:"/kpi/ky-danh-gia",label:"K nh gi",group:"KPI"},{path:"/kpi/cau-hinh-thuong",label:"Cu hnh thng",group:"KPI"},{path:"/import-chia-hang",label:"Chia hng",group:"Sn lng",quickActions:[{id:"import-chia-hang",label:"Import file",icon:bs,type:"callback",callbackKey:"IMPORT_CHIA_HANG"}]},{path:"/import-giao-hang",label:"Giao hng",group:"Sn lng",quickActions:[{id:"import-giao-hang",label:"Import file",icon:bs,type:"callback",callbackKey:"IMPORT_GIAO_HANG"}]},{path:"/lich-su-import",label:"Lch s Import",group:"Sn lng"},{path:"/import-excel",label:"Import Excel",group:"D liu u vo"},{path:"/quy-che",label:"Quy ch lng",group:"Tnh lng",quickActions:[{id:"tao-rule",label:"To rule mi",icon:St,type:"callback",callbackKey:"OPEN_TAO_RULE_MODAL",requiredPermissions:["QUY_CHE_CREATE"]},{id:"preview-rule",label:"Preview",icon:sp,type:"route",to:"/rule-trace"}]},{path:"/quy-che/:id",label:"Chi tit quy ch",parent:"/quy-che",dynamicLabel:e=>`Quy ch #${e.id}`},{path:"/khoan-luong",label:"Khon lng",group:"Tnh lng",quickActions:[{id:"them-khoan-luong",label:"Thm khon lng",icon:St,type:"callback",callbackKey:"OPEN_ADD_KHOAN_LUONG_MODAL",requiredPermissions:["KHOAN_LUONG_CREATE"]}]},{path:"/su-kien",label:"S kin thng/pht",group:"Tnh lng"},{path:"/bang-luong",label:"Bng lng",group:"K lng",quickActions:[{id:"tao-bang-luong",label:"To bng lng",icon:St,type:"callback",callbackKey:"OPEN_TAO_BANG_LUONG_MODAL",requiredPermissions:["BANG_LUONG_CREATE"]}]},{path:"/bang-luong/:id",label:"Chi tit bng lng",parent:"/bang-luong",dynamicLabel:e=>`Bng lng #${e.id}`,quickActions:[{id:"snapshot",label:"Snapshot",icon:f_,type:"callback",callbackKey:"SNAPSHOT_BANG_LUONG"},{id:"chay-rule",label:"Chy Rule",icon:sp,type:"callback",callbackKey:"RUN_RULE_ENGINE",requiredPermissions:["BANG_LUONG_TINH"]},{id:"tinh-lai",label:"Tnh li",icon:Ra,type:"callback",callbackKey:"TINH_LAI_LUONG"},{id:"chot-ky",label:"Cht k",icon:Ma,type:"callback",callbackKey:"CHOT_KY_LUONG",requiredPermissions:["BANG_LUONG_CHOT"]},{id:"khoa-ky",label:"Kho k",icon:Js,type:"callback",callbackKey:"KHOA_KY_LUONG",danger:!0,confirmMessage:"Kho vnh vin k lng ny? Sau khi kho s khng th m li.",confirmKeyword:"KHOA",requiredPermissions:["BANG_LUONG_KHOA"]},{id:"mo-khoa",label:"M kho",icon:Jp,type:"callback",callbackKey:"MO_KHOA_BANG_LUONG",requiredPermissions:["BANG_LUONG_KHOA"]},{id:"xuat-excel",label:"Xut Excel",icon:Xs,type:"callback",callbackKey:"EXPORT_BANG_LUONG_EXCEL"},{id:"gui-phieu-luong",label:"Gi phiu lng",icon:pu,type:"callback",callbackKey:"GUI_PHIEU_LUONG_TAT_CA"}]},{path:"/ung-luong",label:"Bng ng lng",group:"ng lng",quickActions:[{id:"tao-bang-ung",label:"To bng ng",icon:St,type:"callback",callbackKey:"OPEN_TAO_BANG_UNG_MODAL",requiredPermissions:["UNG_LUONG_CREATE"]}]},{path:"/ung-luong/:id",label:"Chi tit bng ng lng",parent:"/ung-luong",dynamicLabel:e=>`Bng ng #${e.id}`,quickActions:[{id:"tinh-eligibility",label:"Tnh eligibility",icon:tb,type:"callback",callbackKey:"TINH_ELIGIBILITY_UNG_LUONG"},{id:"chot-bang-ung",label:"Cht",icon:Ma,type:"callback",callbackKey:"CHOT_BANG_UNG_LUONG",requiredPermissions:["UNG_LUONG_CHOT"]},{id:"xuat-excel-ung",label:"Xut Excel",icon:Xs,type:"callback",callbackKey:"EXPORT_UNG_LUONG_EXCEL"}]},{path:"/so-luong/nhan-vien",label:"S lng nhn vin",group:"Bo co",quickActions:[{id:"xuat-so-luong-nv",label:"Xut Excel",icon:Xs,type:"callback",callbackKey:"EXPORT_SO_LUONG_NV"}]},{path:"/so-luong/phong-ban",label:"S lng phng ban",group:"Bo co",quickActions:[{id:"xuat-so-luong-pb",label:"Xut Excel",icon:Xs,type:"callback",callbackKey:"EXPORT_SO_LUONG_PB"}]},{path:"/cai-dat",label:"Ci t h thng",group:"Thit lp",requiredPermissions:["ADMIN"]},{path:"/quan-tri/nguoi-dung",label:"Ngi dng",group:"Qun tr",requiredPermissions:["ADMIN"],quickActions:[{id:"them-nguoi-dung",label:"Thm ngi dng",icon:St,type:"callback",callbackKey:"OPEN_ADD_NGUOI_DUNG_MODAL",requiredPermissions:["ADMIN"]}]},{path:"/quan-tri/audit-log",label:"Audit Log",group:"Qun tr",requiredPermissions:["ADMIN"]},{path:"/rule-trace",label:"Rule Trace",group:"Tnh lng"}];function xp(e){const n=hp.find(a=>a.path===e);if(n)return n;for(const a of hp)if(a.path.includes(":")){const r=a.path.replace(/:[^/]+/g,"[^/]+");if(new RegExp(`^${r}$`).test(e))return a}}function E5(e,n){const a={},r=n.split("/"),s=e.split("/");for(let l=0;l<r.length;l++)if(r[l].startsWith(":")){const o=r[l].slice(1);a[o]=s[l]}return a}function D5(){const e=Cs(),n=E.useMemo(()=>{const a=[];e.pathname!=="/"&&a.push({label:"Trang ch",path:"/"});const r=xp(e.pathname);if(!r)return a;if(r.group&&r.group!=="Tng quan"&&a.push({label:r.group}),r.parent){const l=xp(r.parent);l&&a.push({label:l.label,path:l.path})}let s=r.label;if(r.dynamicLabel&&r.path.includes(":")){const l=E5(e.pathname,r.path);s=r.dynamicLabel(l)}return a.push({label:s}),a},[e.pathname]);return n.length<=1&&e.pathname==="/"?null:t.jsx("nav",{className:"flex items-center gap-1",children:n.map((a,r)=>{const s=r===n.length-1,l=r===0;return t.jsxs("div",{className:"flex items-center",children:[r>0&&t.jsx(aa,{size:14,className:"mx-1.5 text-text-muted"}),a.path&&!s?t.jsxs(ca,{to:a.path,className:`
                  flex items-center gap-1.5 px-2 py-1 rounded-lg
                  text-text-secondary text-sm
                  hover:text-text hover:bg-panel
                  transition-all
                `,children:[l&&t.jsx(G0,{size:14}),t.jsx("span",{children:a.label})]}):t.jsx("span",{className:`
                  px-2 py-1 rounded-lg text-sm
                  ${s?"text-text font-medium bg-panel border border-border":"text-text-muted"}
                  max-w-[200px] truncate
                `,title:a.label,children:a.label})]},r)})})}const F5=[{id:1,type:"success",title:"Bng lng  tnh xong",message:"Bng lng thng 01/2026  c tnh ton thnh cng",time:"5 pht trc",read:!1},{id:2,type:"warning",title:"Cn duyt ng lng",message:"C 3 yu cu ng lng ch duyt",time:"1 gi trc",read:!1},{id:3,type:"info",title:"Import sn lng",message:"File chia hng thng 01  c import",time:"2 gi trc",read:!0}];function A5({sidebarCollapsed:e}){const[n,a]=E.useState(!1),[r,s]=E.useState(F5),l=E.useRef(null),o=r.filter(p=>!p.read).length;E.useEffect(()=>{const p=b=>{l.current&&!l.current.contains(b.target)&&a(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]);const d=p=>{s(b=>b.map(g=>g.id===p?{...g,read:!0}:g))},u=()=>{s(p=>p.map(b=>({...b,read:!0})))},h=()=>{s([])},m=p=>{switch(p){case"success":return t.jsx(aj,{size:16,className:"text-green-500"});case"warning":return t.jsx(na,{size:16,className:"text-amber-500"});default:return t.jsx(ij,{size:16,className:"text-blue-500"})}},f=()=>{window.dispatchEvent(new CustomEvent("open-command-palette"))};return t.jsxs("header",{className:`
        fixed top-0 right-0 z-40
        h-16 flex items-center justify-between gap-4
        px-6 transition-all duration-300
        bg-bg-main/80 backdrop-blur-md
      `,style:{left:e?"96px":"284px"},children:[t.jsx("div",{className:"flex items-center gap-4",children:t.jsx(D5,{})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:f,className:`
            flex items-center gap-2 px-3 py-2 rounded-xl
            bg-panel border border-border
            text-text-secondary text-sm
            hover:bg-panel-hover hover:border-border-hover
            transition-all
            backdrop-blur-xl
          `,title:"Tm kim nhanh (Ctrl+K)",children:[t.jsx(Ss,{size:16}),t.jsx("span",{className:"hidden md:inline",children:"Tm kim..."}),t.jsxs("kbd",{className:`
            hidden md:inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded
            bg-bg-2 text-text-muted text-xs font-mono
          `,children:[t.jsx(b_,{size:10}),"K"]})]}),t.jsxs("div",{className:"relative",ref:l,children:[t.jsxs("button",{onClick:()=>a(!n),className:`
              relative p-2.5 rounded-xl
              bg-panel border border-border
              text-text-secondary
              hover:bg-panel-hover hover:text-text
              transition-all
              backdrop-blur-xl
            `,title:"Thng bo",children:[t.jsx(bc,{size:18}),o>0&&t.jsx("span",{className:`
                absolute -top-1 -right-1 min-w-[18px] h-[18px] 
                flex items-center justify-center
                bg-accent text-white text-xs font-medium
                rounded-full px-1
              `,children:o>9?"9+":o})]}),n&&t.jsxs("div",{className:`
              absolute top-full right-0 mt-2 w-80
              bg-panel border border-border rounded-xl
              shadow-xl overflow-hidden
              animate-in fade-in slide-in-from-top-2 duration-200
            `,children:[t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[t.jsx("h3",{className:"font-semibold text-text",children:"Thng bo"}),t.jsxs("div",{className:"flex items-center gap-2",children:[o>0&&t.jsx("button",{onClick:u,className:"text-xs text-accent hover:text-accent/80 transition-colors",title:"nh du tt c  c",children:t.jsx(Lr,{size:14})}),r.length>0&&t.jsx("button",{onClick:h,className:"text-xs text-text-muted hover:text-text transition-colors",title:"Xa tt c",children:t.jsx(hn,{size:14})})]})]}),t.jsx("div",{className:"max-h-80 overflow-y-auto",children:r.length===0?t.jsxs("div",{className:"px-4 py-8 text-center text-text-muted",children:[t.jsx(bc,{size:32,className:"mx-auto mb-2 opacity-50"}),t.jsx("p",{children:"Khng c thng bo"})]}):r.map(p=>t.jsx("div",{onClick:()=>d(p.id),className:`
                        px-4 py-3 border-b border-border/50 last:border-0
                        hover:bg-panel-hover cursor-pointer transition-colors
                        ${p.read?"":"bg-accent/5"}
                      `,children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{className:"mt-0.5",children:m(p.type)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsx("p",{className:`text-sm font-medium ${p.read?"text-text-secondary":"text-text"}`,children:p.title}),!p.read&&t.jsx("span",{className:"w-2 h-2 bg-accent rounded-full flex-shrink-0 mt-1.5"})]}),t.jsx("p",{className:"text-xs text-text-muted mt-0.5 line-clamp-2",children:p.message}),t.jsx("p",{className:"text-xs text-text-muted/70 mt-1",children:p.time})]})]})},p.id))}),r.length>0&&t.jsx("div",{className:"px-4 py-2 border-t border-border bg-bg-2/50",children:t.jsx("button",{className:"w-full text-center text-xs text-accent hover:text-accent/80 py-1",children:"Xem tt c thng bo"})})]})]})]})]})}const P5=10,L5="payroll_recent_";function Rj(){const{user:e}=ns(),n=Cs(),[a,r]=E.useState([]),s=e?`${L5}${e.id}`:null;E.useEffect(()=>{if(s){const u=localStorage.getItem(s);if(u)try{const h=JSON.parse(u);Array.isArray(h)&&r(h)}catch{}}},[s]);const l=E.useCallback(u=>{s&&localStorage.setItem(s,JSON.stringify(u))},[s]);E.useEffect(()=>{if(!s)return;const u=xp(n.pathname);if(!u||n.pathname==="/dang-nhap")return;const h={path:n.pathname,title:u.label,time:Date.now()};r(m=>{const f=m.filter(b=>b.path!==h.path),p=[h,...f].slice(0,P5);return l(p),p})},[n.pathname,s,l]);const o=E.useCallback(u=>{r(h=>{const m=h.filter(f=>f.path!==u);return l(m),m})},[l]),d=E.useCallback(()=>{r([]),s&&localStorage.removeItem(s)},[s]);return{recentPages:a,removeRecent:o,clearRecent:d}}class O5{constructor(){Km(this,"handlers",new Map);Km(this,"listeners",new Set)}register(n,a){return this.handlers.set(n,a),this.notifyListeners(),()=>this.unregister(n)}unregister(n){this.handlers.delete(n),this.notifyListeners()}has(n){return this.handlers.has(n)}async execute(n){const a=this.handlers.get(n);return a?(await a(),!0):(console.warn(`Quick action "${n}" khng c handler ng k`),!1)}getRegisteredKeys(){return Array.from(this.handlers.keys())}subscribe(n){return this.listeners.add(n),()=>this.listeners.delete(n)}notifyListeners(){this.listeners.forEach(n=>n())}}const Uh=new O5;function I5(){const[,e]=E.useState(0);return E.useEffect(()=>{const n=Uh.subscribe(()=>{e(a=>a+1)});return()=>{n()}},[]),{has:n=>Uh.has(n),execute:n=>Uh.execute(n),keys:Uh.getRegisteredKeys()}}function M5({isOpen:e,onClose:n}){const a=xr(),{coQuyen:r,coVaiTro:s}=ns(),{favorites:l}=Ij(),{recentPages:o}=Rj(),d=I5(),[u,h]=E.useState(""),[m,f]=E.useState(0),[p,b]=E.useState(null),[g,y]=E.useState(""),N=E.useRef(null),C=E.useRef(null);E.useEffect(()=>{e&&(h(""),f(0),b(null),setTimeout(()=>{var L;return(L=N.current)==null?void 0:L.focus()},50))},[e]);const T=E.useCallback(L=>!L||L.length===0||s("ADMIN")?!0:L.some(W=>r(W)||s(W)),[r,s]),S=E.useMemo(()=>{const L=[],W=Mj(up),R=u.toLowerCase();if(!u&&l.length>0){const ee=l.map(z=>W.find(fe=>fe.id===z)).filter(z=>!!z&&T(z.requiredPermissions)).map(z=>({id:`fav-${z.id}`,type:"favorite",label:z.label,icon:t.jsx(z.icon,{size:16}),path:z.path}));ee.length>0&&L.push({id:"favorites",title:"Yu thch",icon:t.jsx(p0,{size:14}),items:ee})}if(!u&&o.length>0){const ee=o.slice(0,5).map(z=>({id:`recent-${z.path}`,type:"recent",label:z.title,description:z.path,icon:t.jsx(nn,{size:16}),path:z.path}));ee.length>0&&L.push({id:"recent",title:"Gn y",icon:t.jsx(nn,{size:14}),items:ee})}const M=W.filter(ee=>{var z;return!ee.path||!T(ee.requiredPermissions)?!1:u?ee.label.toLowerCase().includes(R)||((z=ee.tags)==null?void 0:z.some(fe=>fe.toLowerCase().includes(R))):!0}).map(ee=>({id:`route-${ee.id}`,type:"route",label:ee.label,icon:t.jsx(ee.icon,{size:16}),path:ee.path}));M.length>0&&L.push({id:"routes",title:"i ti",icon:t.jsx(Nc,{size:14}),items:u?M.slice(0,8):M.slice(0,5)});const q=[];for(const ee of hp)if(ee.quickActions)for(const z of ee.quickActions){if(!T(z.requiredPermissions))continue;(!u||z.label.toLowerCase().includes(R)||ee.label.toLowerCase().includes(R))&&q.push({id:`action-${ee.path}-${z.id}`,type:"action",label:z.label,description:`trong ${ee.label}`,icon:t.jsx(z.icon,{size:16}),action:z,danger:z.danger})}return q.length>0&&L.push({id:"actions",title:"Thao tc nhanh",icon:t.jsx(eg,{size:14}),items:u?q.slice(0,8):q.slice(0,5)}),s("ADMIN")&&!u&&L.push({id:"admin",title:"Qun tr",icon:t.jsx(Zs,{size:14}),items:[{id:"admin-users",type:"route",label:"Qun l ngi dng",icon:t.jsx(Zs,{size:16}),path:"/quan-tri/nguoi-dung"},{id:"admin-audit",type:"route",label:"Audit Log",icon:t.jsx(Zs,{size:16}),path:"/quan-tri/audit-log"}]}),L},[u,l,o,T,s]),k=E.useMemo(()=>S.flatMap(L=>L.items),[S]);E.useEffect(()=>{const L=document.querySelector(`[data-index="${m}"]`);L==null||L.scrollIntoView({block:"nearest"})},[m]);const _=L=>{if(p){L.key==="Escape"?(b(null),y("")):L.key==="Enter"&&(!p.confirmKeyword||g.toUpperCase()===p.confirmKeyword.toUpperCase())&&(P(p),b(null),y(""));return}switch(L.key){case"ArrowDown":L.preventDefault(),f(W=>Math.min(W+1,k.length-1));break;case"ArrowUp":L.preventDefault(),f(W=>Math.max(W-1,0));break;case"Enter":L.preventDefault(),k[m]&&j(k[m]);break;case"Escape":n();break}},P=async L=>{n(),L.type==="route"&&L.to?a(L.to):L.type==="callback"&&L.callbackKey&&await d.execute(L.callbackKey)},j=L=>{if(L.type==="action"&&L.action){if(L.danger&&L.action.confirmKeyword){b(L.action);return}P(L.action)}else L.path&&(n(),a(L.path))},A=L=>u?L.split(new RegExp(`(${u})`,"gi")).map((R,M)=>R.toLowerCase()===u.toLowerCase()?t.jsx("mark",{className:"bg-[#53F39A]/30 text-[#53F39A] px-0.5 rounded",children:R},M):R):L;return e?t.jsxs("div",{className:"fixed inset-0 z-[100] flex items-start justify-center pt-[12vh]",children:[t.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-md",onClick:n}),t.jsx("div",{className:`
          relative w-full max-w-2xl overflow-hidden
          rounded-2xl border border-white/10
          bg-[#0B1220]/95 backdrop-blur-xl
          shadow-2xl shadow-black/40
          animate-fade-in
        `,onKeyDown:_,children:p?t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center gap-3 text-[#FF4D6D] mb-4",children:[t.jsx(na,{size:24}),t.jsx("h3",{className:"text-lg font-semibold",children:"Xc nhn thao tc"})]}),t.jsx("p",{className:"text-slate-300 mb-4",children:p.confirmMessage||`Bn c chc mun "${p.label}"?`}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("label",{className:"block text-sm text-slate-400 mb-2",children:["G ",t.jsx("span",{className:"font-mono font-bold text-[#FF4D6D]",children:p.confirmKeyword}),"  xc nhn:"]}),t.jsx("input",{type:"text",value:g,onChange:L=>y(L.target.value),className:`
                  w-full px-4 py-3 rounded-xl
                  bg-white/5 border border-white/10
                  text-white placeholder-slate-500
                  focus:outline-none focus:ring-2 focus:ring-[#FF4D6D]/50 focus:border-[#FF4D6D]/50
                `,placeholder:`G ${p.confirmKeyword}...`,autoFocus:!0})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{b(null),y("")},className:"px-4 py-2 text-slate-400 hover:text-white hover:bg-white/10 rounded-xl transition-colors",children:"Hu"}),t.jsx("button",{onClick:()=>{(!p.confirmKeyword||g.toUpperCase()===p.confirmKeyword.toUpperCase())&&(P(p),b(null),y(""))},disabled:!!(p.confirmKeyword&&g.toUpperCase()!==p.confirmKeyword.toUpperCase()),className:"px-4 py-2 bg-[#FF4D6D] text-white rounded-xl hover:bg-[#FF4D6D]/80 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Xc nhn"})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-3 px-5 py-4 border-b border-white/10",children:[t.jsx(Ss,{size:20,className:"text-slate-500"}),t.jsx("input",{ref:N,type:"text",value:u,onChange:L=>{h(L.target.value),f(0)},placeholder:"Tm trang, thao tc...",className:`
                  flex-1 text-lg bg-transparent text-white
                  outline-none placeholder:text-slate-500
                `}),t.jsx("kbd",{className:"hidden sm:inline-flex items-center px-2 py-1 text-xs text-slate-500 bg-white/5 border border-white/10 rounded-lg",children:"ESC"}),t.jsx("button",{onClick:n,className:"p-1 text-slate-500 hover:text-white sm:hidden transition-colors",children:t.jsx(hn,{size:20})})]}),t.jsx("div",{ref:C,className:"max-h-[55vh] overflow-y-auto",children:S.length===0?t.jsxs("div",{className:"px-5 py-10 text-center text-slate-500",children:['Khng tm thy kt qu cho "',u,'"']}):S.map((L,W)=>{const R=S.slice(0,W).reduce((M,q)=>M+q.items.length,0);return t.jsxs("div",{className:"py-2",children:[t.jsxs("div",{className:"flex items-center gap-2 px-5 py-2 text-xs font-semibold text-slate-500 uppercase tracking-wider",children:[L.icon,L.title]}),L.items.map((M,q)=>{const ee=R+q,z=ee===m;return t.jsxs("button",{"data-index":ee,onClick:()=>j(M),onMouseEnter:()=>f(ee),className:`
                              w-full flex items-center gap-3 px-5 py-3 text-left transition-all duration-150
                              ${z?"bg-[#53F39A]/10 border-l-2 border-l-[#53F39A]":"border-l-2 border-l-transparent hover:bg-white/5"}
                              ${M.danger?"text-[#FF4D6D]":"text-slate-300"}
                            `,children:[t.jsx("span",{className:`
                              flex-shrink-0 w-8 h-8 rounded-lg flex items-center justify-center
                              ${z?"bg-[#53F39A]/20 text-[#53F39A]":M.danger?"bg-[#FF4D6D]/10 text-[#FF4D6D]":"bg-white/5 text-slate-400"}
                            `,children:M.icon}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:`font-medium ${z?"text-white":""}`,children:A(M.label)}),M.description&&t.jsx("div",{className:"text-xs text-slate-500 truncate",children:M.description})]}),M.type==="favorite"&&t.jsx(p0,{size:14,className:"text-amber-400",fill:"currentColor"})]},M.id)})]},L.id)})}),t.jsxs("div",{className:"flex items-center justify-between px-5 py-3 border-t border-white/10 bg-white/[0.02] text-xs text-slate-500",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("kbd",{className:"px-1.5 py-0.5 bg-white/5 border border-white/10 rounded",children:""}),t.jsx("span",{className:"hidden sm:inline",children:"di chuyn"})]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("kbd",{className:"px-1.5 py-0.5 bg-white/5 border border-white/10 rounded",children:""}),t.jsx("span",{className:"hidden sm:inline",children:"chn"})]})]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("kbd",{className:"px-1.5 py-0.5 bg-white/5 border border-white/10 rounded",children:"esc"}),t.jsx("span",{className:"hidden sm:inline",children:"ng"})]})]})]})})]}):null}function R5(){const[e,n]=E.useState(!1),a=E.useCallback(()=>n(!0),[]),r=E.useCallback(()=>n(!1),[]),s=E.useCallback(()=>n(l=>!l),[]);return E.useEffect(()=>{const l=o=>{(o.ctrlKey||o.metaKey)&&o.key==="k"&&(o.preventDefault(),s())};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[s]),{isOpen:e,open:a,close:r,toggle:s}}function B5(){document.documentElement.setAttribute("data-theme","light");const e=document.querySelector('meta[name="theme-color"]');e&&e.setAttribute("content","#f8fafc")}function H5(){B5()}function V5(){const[e,n]=E.useState(!0),[a,r]=E.useState(!1),s=R5();Rj(),E.useEffect(()=>{H5()},[]),E.useEffect(()=>{const u=()=>{window.innerWidth<768?n(!1):window.innerWidth<1024?(n(!0),r(!0)):(n(!0),r(!1))};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),E.useEffect(()=>{const u=()=>s.open();return window.addEventListener("open-command-palette",u),()=>window.removeEventListener("open-command-palette",u)},[s]);const l=()=>{r(!a)},d=(a?72:260)+36;return t.jsxs("div",{className:"min-h-screen",style:{background:"var(--bg-app)"},children:[t.jsx(_5,{isOpen:e,isCollapsed:a,onToggleCollapse:l}),t.jsxs("div",{className:"min-h-screen transition-all duration-300",style:{marginLeft:e?`${d}px`:"24px",paddingRight:"24px"},children:[t.jsx(A5,{onToggleSidebar:l,sidebarCollapsed:a}),t.jsx("main",{className:"pt-20 pb-8",children:t.jsx("div",{className:"animate-fade-in",children:t.jsx(G2,{})})})]}),t.jsx(M5,{isOpen:s.isOpen,onClose:s.close}),e&&t.jsx("div",{className:"fixed inset-0 bg-black/30 z-40 lg:hidden backdrop-blur-sm",onClick:()=>n(!1)})]})}const Bj="tinh_luong_auth",me=Jt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});me.interceptors.request.use(e=>{const n=localStorage.getItem(Bj);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));me.interceptors.response.use(e=>e,e=>{var n;return((n=e.response)==null?void 0:n.status)===401&&(localStorage.removeItem(Bj),window.location.pathname!=="/dang-nhap"&&(window.location.href="/dang-nhap?expired=1")),Promise.reject(e)});const ln={layTatCa:()=>me.get("/phong-ban").then(e=>e.data),layCayPhongBan:()=>me.get("/phong-ban/cay").then(e=>e.data),layTheoId:e=>me.get(`/phong-ban/${e}`).then(n=>n.data),taoMoi:e=>me.post("/phong-ban",e).then(n=>n.data),capNhat:(e,n)=>me.put(`/phong-ban/${e}`,n).then(a=>a.data),doiPhongBanCha:(e,n)=>me.put(`/phong-ban/${e}/doi-phong-ban-cha`,{phongBanChaId:n}).then(a=>a.data),ngungHoatDong:e=>me.post(`/phong-ban/${e}/ngung-hoat-dong`).then(n=>n.data),kichHoat:e=>me.post(`/phong-ban/${e}/kich-hoat`).then(n=>n.data),xoa:e=>me.delete(`/phong-ban/${e}`).then(n=>n.data),layDonViCon:e=>me.get(`/phong-ban/${e}/don-vi-con`).then(n=>n.data),taoDonViCon:(e,n)=>me.post(`/phong-ban/${e}/don-vi-con`,n).then(a=>a.data),capNhatDonViCon:(e,n)=>me.put(`/don-vi-con/${e}`,n).then(a=>a.data),ngungDonViCon:e=>me.post(`/don-vi-con/${e}/ngung-hoat-dong`).then(n=>n.data)},Oa={layTatCa:e=>me.get("/nhan-vien",{params:e}).then(n=>n.data),layTheoId:e=>me.get(`/nhan-vien/${e}`).then(n=>n.data),layMaTuDong:()=>me.get("/nhan-vien/ma-tu-dong").then(e=>e.data),taoMoi:e=>me.post("/nhan-vien",e).then(n=>n.data),capNhat:(e,n)=>me.put(`/nhan-vien/${e}`,n).then(a=>a.data),xoa:e=>me.delete(`/nhan-vien/${e}`).then(n=>n.data),layLichSuPhongBan:e=>me.get(`/nhan-vien/${e}/lich-su-phong-ban`).then(n=>n.data),chuyenPhongBan:(e,n)=>me.post(`/nhan-vien/${e}/chuyen-phong-ban`,n).then(a=>a.data)},Dr={layTatCa:e=>me.get("/khoan-luong",{params:{loai:e}}).then(n=>n.data),layTheoId:e=>me.get(`/khoan-luong/${e}`).then(n=>n.data),taoMoi:e=>me.post("/khoan-luong",e).then(n=>n.data),capNhat:(e,n)=>me.put(`/khoan-luong/${e}`,n).then(a=>a.data),xoa:e=>me.delete(`/khoan-luong/${e}`).then(n=>n.data)},_r={layDanhSach:e=>me.get("/bang-luong",{params:e}).then(n=>n.data),layTheoId:e=>me.get(`/bang-luong/${e}`).then(n=>n.data),taoMoi:e=>me.post("/bang-luong",e).then(n=>n.data),capNhatChiTiet:e=>me.put("/bang-luong/chi-tiet/cap-nhat",e).then(n=>n.data),capNhatNhieuChiTiet:e=>me.put("/bang-luong/chi-tiet/cap-nhat-nhieu",{danhSach:e}).then(n=>n.data),chotBangLuong:(e,n)=>me.post(`/bang-luong/${e}/chot`,n).then(a=>a.data),moKhoa:e=>me.post(`/bang-luong/${e}/mo-khoa`).then(n=>n.data),khoa:e=>me.post(`/bang-luong/${e}/khoa`).then(n=>n.data),xoa:(e,n=!1)=>me.delete(`/bang-luong/${e}`,{params:{force:n?"true":void 0}}).then(a=>a.data),layLichSu:e=>me.get(`/bang-luong/${e}/lich-su`).then(n=>n.data),soSanhExcel:(e,n)=>me.post(`/bang-luong/${e}/so-sanh-excel`,{tongExcel:n}).then(a=>a.data),tinhLaiLuong:e=>me.post(`/bang-luong/${e}/tinh-lai-luong`).then(n=>n.data)},mp={layPhieuLuong:(e,n)=>me.get(`/bang-luong/${e}/phieu-luong/${n}`).then(a=>a.data),layPhieuLuongHtml:(e,n)=>me.get(`/bang-luong/${e}/phieu-luong/${n}/html`).then(a=>a.data),guiPhieuLuong:(e,n)=>me.post(`/bang-luong/${e}/gui-phieu-luong/${n}`).then(a=>a.data),guiTatCa:e=>me.post(`/bang-luong/${e}/gui-tat-ca`).then(n=>n.data)},c0={docHeader:e=>{const n=new FormData;return n.append("file",e),me.post("/import-excel/doc-header",n,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>a.data)},goiYMapping:e=>{const n=new FormData;return n.append("file",e),me.post("/import-excel/goi-y-mapping",n,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>a.data)},import:(e,n,a,r,s)=>{const l=new FormData;return l.append("file",e),l.append("thang",String(n)),l.append("nam",String(a)),l.append("phongBanId",String(r)),l.append("mappings",JSON.stringify(s)),me.post("/import-excel/import",l,{headers:{"Content-Type":"multipart/form-data"}}).then(o=>o.data)},export:e=>me.get(`/import-excel/export/${e}`,{responseType:"blob"})},qo={layTheoNhanVien:e=>me.get(`/phu-cap-nhan-vien/nhan-vien/${e}`).then(n=>n.data),layHieuLuc:e=>me.get(`/phu-cap-nhan-vien/nhan-vien/${e}/hieu-luc`).then(n=>n.data),layTheoThang:(e,n,a)=>me.get(`/phu-cap-nhan-vien/nhan-vien/${e}/theo-thang`,{params:{thang:n,nam:a}}).then(r=>r.data),layLichSu:(e,n)=>me.get(`/phu-cap-nhan-vien/nhan-vien/${e}/lich-su`,{params:{khoanLuongId:n}}).then(a=>a.data),taoPhuCap:e=>me.post("/phu-cap-nhan-vien",e).then(n=>n.data),ketThuc:(e,n,a)=>me.put(`/phu-cap-nhan-vien/${e}/ket-thuc`,{denNgay:n,nguoiCapNhat:a}).then(r=>r.data),tang:(e,n)=>me.post(`/phu-cap-nhan-vien/${e}/tang`,n).then(a=>a.data),tamDung:e=>me.put(`/phu-cap-nhan-vien/${e}/tam-dung`).then(n=>n.data),kichHoat:e=>me.put(`/phu-cap-nhan-vien/${e}/kich-hoat`).then(n=>n.data),thongKePhongBan:e=>me.get(`/phu-cap-nhan-vien/thong-ke/phong-ban/${e}`).then(n=>n.data)},wb={layTatCa:e=>me.get(`/bang-luong/${e}/ngay-cong`).then(n=>n.data),layTheoNhanVien:(e,n)=>me.get(`/bang-luong/${e}/ngay-cong/${n}`).then(a=>a.data),khoiTao:e=>me.post(`/bang-luong/${e}/ngay-cong/khoi-tao`).then(n=>n.data),dieuChinh:(e,n,a)=>me.put(`/bang-luong/${e}/ngay-cong/${n}/dieu-chinh`,a).then(r=>r.data),xoaDieuChinh:(e,n)=>me.delete(`/bang-luong/${e}/ngay-cong/${n}/dieu-chinh`).then(a=>a.data)},kb={lay:()=>me.get("/thong-tin-cong-ty").then(e=>e.data),capNhat:e=>me.put("/thong-tin-cong-ty",e).then(n=>n.data)},jd={layTatCa:e=>me.get("/thong-tin-cong-ty/don-gia",{params:{phongBanId:e}}).then(n=>n.data),layTheoId:e=>me.get(`/thong-tin-cong-ty/don-gia/${e}`).then(n=>n.data),taoMoi:e=>me.post("/thong-tin-cong-ty/don-gia",e).then(n=>n.data),capNhat:(e,n)=>me.put(`/thong-tin-cong-ty/don-gia/${e}`,n).then(a=>a.data),xoa:e=>me.delete(`/thong-tin-cong-ty/don-gia/${e}`).then(n=>n.data),khoiTaoMau:()=>me.post("/thong-tin-cong-ty/don-gia/khoi-tao-mau").then(e=>e.data)},qa={layDanhSach:e=>me.get("/ung-luong/bang",{params:e}).then(n=>n.data),layTheoId:e=>me.get(`/ung-luong/bang/${e}`).then(n=>n.data),taoMoi:e=>me.post("/ung-luong/bang",e).then(n=>n.data),capNhat:(e,n)=>me.put(`/ung-luong/bang/${e}`,n).then(a=>a.data),xoa:(e,n=!1)=>me.delete(`/ung-luong/bang/${e}`,{params:{force:n?"true":void 0}}).then(a=>a.data),sinhDanhSach:(e,n)=>me.post(`/ung-luong/bang/${e}/generate-danh-sach`,n||{}).then(a=>a.data),capNhatBulk:(e,n)=>me.put(`/ung-luong/bang/${e}/rows/bulk`,n).then(a=>a.data),setTheoTiLe:(e,n)=>me.post(`/ung-luong/bang/${e}/set-ti-le`,n).then(a=>a.data),setSoTienCoDinh:(e,n)=>me.post(`/ung-luong/bang/${e}/set-so-tien`,n).then(a=>a.data),chot:e=>me.post(`/ung-luong/bang/${e}/chot`).then(n=>n.data),khoa:e=>me.post(`/ung-luong/bang/${e}/khoa`).then(n=>n.data),moKhoa:(e,n)=>me.post(`/ung-luong/bang/${e}/mo-khoa`,n).then(a=>a.data),ghiNhanKhauTru:(e,n)=>me.post(`/ung-luong/bang/${e}/ghi-nhan-khau-tru`,n).then(a=>a.data)},Hj={layNhanVien:(e,n)=>{const a=`${n.tuNam}-${String(n.tuThang).padStart(2,"0")}-01`,r=new Date(n.denNam,n.denThang,0).toISOString().split("T")[0];return me.get(`/so-luong/nhan-vien/${e}`,{params:{tuNgay:a,denNgay:r}}).then(s=>s.data)},layPhongBan:(e,n)=>{const a=`${n.tuNam}-${String(n.tuThang).padStart(2,"0")}-01`,r=new Date(n.denNam,n.denThang,0).toISOString().split("T")[0];return me.get(`/so-luong/phong-ban/${e}`,{params:{tuNgay:a,denNgay:r}}).then(s=>s.data)},timKiem:e=>me.get("/so-luong/tim-kiem",{params:e}).then(n=>n.data)};function Ze(e){if(e==null)return"0";const n=typeof e=="string"?parseFloat(e):e;return isNaN(n)?"0":new Intl.NumberFormat("vi-VN").format(n)}function U5(e){if(!e)return 0;const n=e.replace(/[^\d]/g,"");return parseInt(n,10)||0}function ys(e){return e?new Date(e).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):""}function K5(e){switch(e){case"NHAP":return"ang nhp";case"DA_CHOT":return" cht";case"KHOA":return" kha";default:return e}}function z5(e,n){const a=window.URL.createObjectURL(e),r=document.createElement("a");r.href=a,r.setAttribute("download",n),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(a)}function Mt(...e){const n=[];for(const a of e)if(a){if(typeof a=="string")n.push(a);else if(typeof a=="number")n.push(String(a));else if(Array.isArray(a)){const r=Mt(...a);r&&n.push(r)}}return n.join(" ").replace(/\s+/g," ").trim()}const st=E.forwardRef(({className:e,variant:n="default",padding:a="md",hover:r=!1,clickable:s=!1,children:l,...o},d)=>{const u="rounded-2xl transition-all duration-200",h={default:"bg-[var(--panel)] border border-[var(--border)]",glass:`
        bg-[var(--panel)]/80 backdrop-blur-xl 
        border border-white/10 
        shadow-lg shadow-black/5
      `,elevated:`
        bg-[var(--panel)] 
        border border-[var(--border)]
        shadow-xl shadow-black/10
      `,bordered:"bg-transparent border-2 border-[var(--border)]",gradient:`
        bg-gradient-to-br from-[var(--panel)] to-[var(--bg-2)]
        border border-[var(--border)]
      `},m={none:"",sm:"p-3",md:"p-5",lg:"p-6",xl:"p-8"},f=r?"hover:shadow-xl hover:border-[var(--accent)]/30 hover:-translate-y-0.5":"",p=s?"cursor-pointer active:scale-[0.99]":"";return t.jsx("div",{ref:d,className:Mt(u,h[n],m[a],f,p,e),...o,children:l})});st.displayName="Card";const Un=E.forwardRef(({className:e,title:n,subtitle:a,action:r,icon:s,children:l,...o},d)=>t.jsxs("div",{ref:d,className:Mt("flex items-start justify-between gap-4 mb-4",e),...o,children:[t.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[s&&t.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-xl bg-[var(--accent)]/10 flex items-center justify-center text-[var(--accent)]",children:s}),t.jsxs("div",{className:"flex-1 min-w-0",children:[n&&t.jsx("h3",{className:"text-lg font-semibold text-[var(--text-primary)] truncate",children:n}),a&&t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-0.5",children:a}),l]})]}),r&&t.jsx("div",{className:"flex-shrink-0",children:r})]}));Un.displayName="CardHeader";const Bt=E.forwardRef(({className:e,...n},a)=>t.jsx("div",{ref:a,className:Mt("",e),...n}));Bt.displayName="CardContent";const $5=E.forwardRef(({className:e,separator:n=!0,...a},r)=>t.jsx("div",{ref:r,className:Mt("flex items-center justify-between gap-4 mt-4 pt-4",n&&"border-t border-[var(--border)]",e),...a}));$5.displayName="CardFooter";const Vj=E.forwardRef(({className:e,title:n,value:a,subtitle:r,icon:s,trend:l,accentColor:o="green",...d},u)=>{const m={green:{bg:"bg-[#53F39A]/10",text:"text-[#53F39A]",glow:"shadow-[#53F39A]/20"},cyan:{bg:"bg-[#4FC3FF]/10",text:"text-[#4FC3FF]",glow:"shadow-[#4FC3FF]/20"},yellow:{bg:"bg-amber-500/10",text:"text-amber-400",glow:"shadow-amber-500/20"},red:{bg:"bg-[#FF4D6D]/10",text:"text-[#FF4D6D]",glow:"shadow-[#FF4D6D]/20"},purple:{bg:"bg-purple-500/10",text:"text-purple-400",glow:"shadow-purple-500/20"}}[o],f={up:"text-[#53F39A]",down:"text-[#FF4D6D]",neutral:"text-[var(--text-muted)]"},p={up:"",down:"",neutral:""};return t.jsxs(st,{ref:u,variant:"glass",className:Mt("group hover:shadow-lg",m.glow,e),hover:!0,...d,children:[t.jsxs("div",{className:"flex items-start justify-between",children:[s&&t.jsx("div",{className:Mt("w-12 h-12 rounded-xl flex items-center justify-center transition-transform group-hover:scale-110",m.bg,m.text),children:s}),l&&t.jsxs("div",{className:Mt("flex items-center gap-1 text-sm font-medium",f[l.direction]),children:[t.jsx("span",{children:p[l.direction]}),t.jsxs("span",{children:[Math.abs(l.value),"%"]})]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("p",{className:"text-3xl font-bold text-[var(--text-primary)] tabular-nums",children:typeof a=="number"?a.toLocaleString("vi-VN"):a}),t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1",children:n}),r&&t.jsx("p",{className:"text-xs text-[var(--text-disabled)] mt-0.5",children:r})]})]})});Vj.displayName="StatCard";const mt=E.forwardRef(({className:e,variant:n="primary",size:a="md",rounded:r="xl",loading:s=!1,icon:l,iconPosition:o="left",fullWidth:d=!1,disabled:u,children:h,...m},f)=>{const p=u||s,b=`
      inline-flex items-center justify-center gap-2
      font-medium transition-all duration-200
      focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[var(--accent)]
      disabled:opacity-50 disabled:cursor-not-allowed
      active:scale-[0.98]
    `,g={primary:`
        bg-[var(--accent)] text-[#0B1220]
        hover:bg-[var(--accent)]/90
        shadow-lg shadow-[var(--accent)]/25
      `,secondary:`
        bg-[var(--bg-2)] text-[var(--text-primary)]
        border border-[var(--border)]
        hover:bg-[var(--bg-3)] hover:border-[var(--accent)]/30
      `,outline:`
        bg-transparent text-[var(--text-primary)]
        border-2 border-[var(--border)]
        hover:bg-[var(--bg-2)] hover:border-[var(--accent)]/50
      `,ghost:`
        bg-transparent text-[var(--text-secondary)]
        hover:bg-[var(--bg-2)] hover:text-[var(--text-primary)]
      `,danger:`
        bg-[#FF4D6D] text-white
        hover:bg-[#FF4D6D]/90
        shadow-lg shadow-[#FF4D6D]/25
      `,success:`
        bg-[#53F39A] text-[#0B1220]
        hover:bg-[#53F39A]/90
        shadow-lg shadow-[#53F39A]/25
      `},y={xs:"text-xs px-2.5 py-1.5 h-7",sm:"text-sm px-3 py-2 h-8",md:"text-sm px-4 py-2.5 h-10",lg:"text-base px-5 py-3 h-11",xl:"text-base px-6 py-3.5 h-12"},N={md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl",full:"rounded-full"};return t.jsxs("button",{ref:f,className:Mt(b,g[n],y[a],N[r],d&&"w-full",e),disabled:p,...m,children:[s&&t.jsx(In,{className:"w-4 h-4 animate-spin"}),!s&&l&&o==="left"&&t.jsx("span",{className:"flex-shrink-0",children:l}),h&&t.jsx("span",{children:h}),!s&&l&&o==="right"&&t.jsx("span",{className:"flex-shrink-0",children:l})]})});mt.displayName="Button";const Uj=E.forwardRef(({className:e,variant:n="ghost",size:a="md",loading:r=!1,tooltip:s,disabled:l,children:o,...d},u)=>{const h=l||r,m=`
      inline-flex items-center justify-center
      rounded-xl transition-all duration-200
      focus:outline-none focus-visible:ring-2 focus-visible:ring-[var(--accent)]
      disabled:opacity-50 disabled:cursor-not-allowed
      active:scale-95
    `,f={primary:`
        bg-[var(--accent)] text-[#0B1220]
        hover:bg-[var(--accent)]/80
      `,secondary:`
        bg-[var(--bg-2)] text-[var(--text-secondary)]
        hover:bg-[var(--bg-3)] hover:text-[var(--text-primary)]
      `,ghost:`
        text-[var(--text-muted)]
        hover:bg-[var(--bg-2)] hover:text-[var(--text-primary)]
      `,danger:`
        text-[#FF4D6D]
        hover:bg-[#FF4D6D]/10
      `},p={xs:"w-6 h-6",sm:"w-8 h-8",md:"w-10 h-10",lg:"w-12 h-12"};return t.jsx("button",{ref:u,className:Mt(m,f[n],p[a],e),disabled:h,title:s,...d,children:r?t.jsx(In,{className:"w-4 h-4 animate-spin"}):o})});Uj.displayName="IconButton";const Tt=E.forwardRef(({className:e,variant:n="default",size:a="sm",dot:r=!1,icon:s,removable:l=!1,onRemove:o,children:d,...u},h)=>{const m=`
      inline-flex items-center gap-1.5
      font-medium rounded-full
      transition-colors duration-150
    `,f={default:"bg-[var(--accent)]/15 text-[var(--accent)]",success:"bg-[#53F39A]/15 text-[#53F39A]",warning:"bg-amber-500/15 text-amber-400",danger:"bg-[#FF4D6D]/15 text-[#FF4D6D]",info:"bg-[#4FC3FF]/15 text-[#4FC3FF]",neutral:"bg-[var(--bg-3)] text-[var(--text-muted)]"},p={xs:"text-[10px] px-1.5 py-0.5",sm:"text-xs px-2 py-0.5",md:"text-sm px-2.5 py-1"},b={default:"bg-[var(--accent)]",success:"bg-[#53F39A]",warning:"bg-amber-400",danger:"bg-[#FF4D6D]",info:"bg-[#4FC3FF]",neutral:"bg-[var(--text-muted)]"};return t.jsxs("span",{ref:h,className:Mt(m,f[n],p[a],e),...u,children:[r&&t.jsx("span",{className:Mt("w-1.5 h-1.5 rounded-full animate-pulse",b[n])}),s&&t.jsx("span",{className:"flex-shrink-0 w-3 h-3",children:s}),d,l&&t.jsx("button",{type:"button",onClick:g=>{g.stopPropagation(),o==null||o()},className:"ml-0.5 -mr-0.5 p-0.5 rounded-full hover:bg-white/20 transition-colors",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-3 h-3",children:t.jsx("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})})})]})});Tt.displayName="Badge";const G5={active:{label:"Hot ng",variant:"success"},inactive:{label:"Ngng",variant:"neutral"},pending:{label:"Ch duyt",variant:"warning"},approved:{label:" duyt",variant:"success"},rejected:{label:"T chi",variant:"danger"},draft:{label:"Nhp",variant:"neutral"},completed:{label:"Hon thnh",variant:"info"}},q5=E.forwardRef(({status:e,className:n,...a},r)=>{const s=G5[e];return t.jsx(Tt,{ref:r,variant:s.variant,dot:!0,className:n,...a,children:s.label})});q5.displayName="StatusBadge";const W5=E.forwardRef(({count:e,max:n=99,variant:a="danger",className:r,...s},l)=>{const o=e>n?`${n}+`:e,d=`
      inline-flex items-center justify-center
      min-w-[18px] h-[18px] px-1.5
      text-[10px] font-bold rounded-full
    `,u={default:"bg-[var(--accent)] text-[#0B1220]",danger:"bg-[#FF4D6D] text-white"};return e<=0?null:t.jsx("span",{ref:l,className:Mt(d,u[a],r),...s,children:o})});W5.displayName="CounterBadge";const sg=E.forwardRef(({className:e,type:n="text",size:a="md",variant:r="default",error:s=!1,success:l=!1,icon:o,iconPosition:d="left",clearable:u=!1,onClear:h,value:m,...f},p)=>{const b=`
      w-full transition-all duration-200
      placeholder:text-[var(--text-disabled)]
      focus:outline-none
      disabled:opacity-50 disabled:cursor-not-allowed
    `,g={default:`
        bg-[var(--bg-1)] 
        border border-[var(--border)]
        focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
      `,filled:`
        bg-[var(--bg-2)] 
        border border-transparent
        focus:bg-[var(--bg-1)] focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
      `,ghost:`
        bg-transparent 
        border border-transparent
        hover:bg-[var(--bg-2)]
        focus:bg-[var(--bg-2)] focus:border-[var(--border)]
      `},y={sm:"h-8 px-3 text-sm rounded-lg",md:"h-10 px-4 text-sm rounded-xl",lg:"h-12 px-4 text-base rounded-xl"},N=s?"border-[#FF4D6D] focus:border-[#FF4D6D] focus:ring-[#FF4D6D]/20":l?"border-[#53F39A] focus:border-[#53F39A] focus:ring-[#53F39A]/20":"",C=!!o,T=u&&m,S=C&&d==="left"?"pl-10":"",k=C&&d==="right"||T?"pr-10":"";return t.jsxs("div",{className:"relative",children:[o&&d==="left"&&t.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)]",children:o}),t.jsx("input",{ref:p,type:n,value:m,className:Mt(b,g[r],y[a],N,S,k,"text-[var(--text-primary)]",e),...f}),o&&d==="right"&&!T&&t.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)]",children:o}),T&&t.jsx("button",{type:"button",onClick:h,className:"absolute right-3 top-1/2 -translate-y-1/2 p-0.5 rounded-full text-[var(--text-muted)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-3)] transition-colors",children:t.jsx(hn,{size:14})})]})});sg.displayName="Input";const ig=E.forwardRef(({className:e,onSearch:n,...a},r)=>t.jsx(sg,{ref:r,type:"search",icon:t.jsx(Ss,{size:18}),iconPosition:"left",clearable:!0,placeholder:"Tm kim...",className:e,...a}));ig.displayName="SearchInput";const X5=E.forwardRef(({className:e,...n},a)=>{const[r,s]=E.useState(!1);return t.jsxs("div",{className:"relative",children:[t.jsx(sg,{ref:a,type:r?"text":"password",className:Mt("pr-10",e),...n}),t.jsx("button",{type:"button",onClick:()=>s(!r),className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 rounded-lg text-[var(--text-muted)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-3)] transition-colors",children:r?t.jsx(j_,{size:18}):t.jsx(ii,{size:18})})]})});X5.displayName="PasswordInput";const J0=E.forwardRef(({className:e,variant:n="default",error:a,success:r,...s},l)=>{const o=`
      w-full min-h-[100px] px-4 py-3
      text-sm text-[var(--text-primary)]
      rounded-xl resize-y
      transition-all duration-200
      placeholder:text-[var(--text-disabled)]
      focus:outline-none
      disabled:opacity-50 disabled:cursor-not-allowed
    `,d={default:`
        bg-[var(--bg-1)] 
        border border-[var(--border)]
        focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
      `,filled:`
        bg-[var(--bg-2)] 
        border border-transparent
        focus:bg-[var(--bg-1)] focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
      `},u=a?"border-[#FF4D6D] focus:border-[#FF4D6D] focus:ring-[#FF4D6D]/20":r?"border-[#53F39A] focus:border-[#53F39A] focus:ring-[#53F39A]/20":"";return t.jsx("textarea",{ref:l,className:Mt(o,d[n],u,e),...s})});J0.displayName="Textarea";const Q5=E.forwardRef(({className:e,loading:n,empty:a,emptyMessage:r="Khng c d liu",emptyIcon:s,children:l,...o},d)=>t.jsxs("div",{ref:d,className:Mt("relative overflow-hidden rounded-2xl","bg-[var(--panel)] border border-[var(--border)]",e),...o,children:[n&&t.jsx("div",{className:"absolute inset-0 bg-[var(--panel)]/80 backdrop-blur-sm z-10 flex items-center justify-center",children:t.jsxs("div",{className:"flex flex-col items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 border-2 border-[var(--accent)] border-t-transparent rounded-full animate-spin"}),t.jsx("span",{className:"text-sm text-[var(--text-muted)]",children:"ang ti..."})]})}),a?t.jsxs("div",{className:"py-16 flex flex-col items-center justify-center text-center",children:[s&&t.jsx("div",{className:"w-16 h-16 rounded-2xl bg-[var(--bg-2)] flex items-center justify-center text-[var(--text-muted)] mb-4",children:s}),t.jsx("p",{className:"text-[var(--text-muted)]",children:r})]}):t.jsx("div",{className:"overflow-x-auto",children:l})]}));Q5.displayName="TableContainer";const Kj=E.forwardRef(({className:e,compact:n,striped:a,hoverable:r=!0,...s},l)=>t.jsx("table",{ref:l,className:Mt("w-full text-sm",n?"table-compact":"",a?"table-striped":"",r?"table-hoverable":"",e),...s}));Kj.displayName="Table";const zj=E.forwardRef(({className:e,...n},a)=>t.jsx("thead",{ref:a,className:Mt("bg-[var(--bg-2)] border-b border-[var(--border)]",e),...n}));zj.displayName="TableHead";const $j=E.forwardRef(({className:e,...n},a)=>t.jsx("tbody",{ref:a,className:Mt("divide-y divide-[var(--border)]",e),...n}));$j.displayName="TableBody";const Ed=E.forwardRef(({className:e,selected:n,clickable:a,...r},s)=>t.jsx("tr",{ref:s,className:Mt("transition-colors","hover:bg-[var(--bg-2)]",n&&"bg-[var(--accent)]/5",a&&"cursor-pointer",e),...r}));Ed.displayName="TableRow";const Al=E.forwardRef(({className:e,children:n,sortable:a,sortDirection:r,onSort:s,align:l="left",...o},d)=>{const u={left:"text-left",center:"text-center",right:"text-right"};return t.jsx("th",{ref:d,className:Mt("px-4 py-3 font-semibold text-xs uppercase tracking-wider","text-[var(--text-muted)]",u[l],a&&"cursor-pointer select-none hover:text-[var(--text-primary)] group",e),onClick:a?s:void 0,...o,children:t.jsxs("div",{className:Mt("inline-flex items-center gap-1.5",l==="right"&&"flex-row-reverse",l==="center"&&"justify-center"),children:[n,a&&t.jsx("span",{className:Mt("transition-colors",r?"text-[var(--accent)]":"text-[var(--text-disabled)] group-hover:text-[var(--text-muted)]"),children:r==="asc"?t.jsx(Pl,{size:14}):r==="desc"?t.jsx(Er,{size:14}):t.jsx(p_,{size:14})})]})})});Al.displayName="TableHeadCell";const Ks=E.forwardRef(({className:e,align:n="left",numeric:a,truncate:r,maxWidth:s,style:l,...o},d)=>{const u={left:"text-left",center:"text-center",right:"text-right"};return t.jsx("td",{ref:d,className:Mt("px-4 py-3","text-[var(--text-primary)]",u[n],a&&"tabular-nums font-medium",r&&"truncate",e),style:{maxWidth:s?`${s}px`:void 0,...l},...o})});Ks.displayName="TableCell";const Y5=E.forwardRef(({className:e,...n},a)=>t.jsx("tfoot",{ref:a,className:Mt("bg-[var(--bg-2)] border-t border-[var(--border)]",e),...n}));Y5.displayName="TableFooter";const js=({isOpen:e,onClose:n,children:a,size:r="md",closable:s=!0,closeOnOverlay:l=!0,closeOnEscape:o=!0,className:d})=>{if(E.useEffect(()=>{if(!e||!o)return;const m=f=>{f.key==="Escape"&&n()};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[e,o,n]),E.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),!e)return null;const u={sm:"max-w-sm",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-[90vw]"},h=t.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4",children:[t.jsx("div",{className:Mt("absolute inset-0 bg-black/60 backdrop-blur-md","animate-in fade-in duration-200"),onClick:l?n:void 0}),t.jsxs("div",{className:Mt("relative w-full",u[r],"bg-[var(--panel)]/95 backdrop-blur-xl","border border-[var(--border)]","rounded-2xl shadow-2xl shadow-black/40","animate-in fade-in zoom-in-95 duration-200",d),onClick:m=>m.stopPropagation(),children:[s&&t.jsx(Uj,{variant:"ghost",size:"sm",onClick:n,className:"absolute top-4 right-4 z-10",children:t.jsx(hn,{size:18})}),a]})]});return dS.createPortal(h,document.body)},ws=({title:e,subtitle:n,icon:a,className:r})=>t.jsx("div",{className:Mt("px-6 pt-6 pb-4",r),children:t.jsxs("div",{className:"flex items-start gap-4",children:[a&&t.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-xl bg-[var(--accent)]/10 flex items-center justify-center text-[var(--accent)]",children:a}),t.jsxs("div",{className:"flex-1 min-w-0 pr-8",children:[t.jsx("h2",{className:"text-xl font-semibold text-[var(--text-primary)]",children:e}),n&&t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1",children:n})]})]})}),ks=({children:e,className:n,padding:a=!0})=>t.jsx("div",{className:Mt("max-h-[60vh] overflow-y-auto modal-scroll",a&&"px-6 py-4",n),children:e}),ei=({children:e,className:n})=>t.jsx("div",{className:Mt("flex items-center justify-end gap-3","px-6 py-4","border-t border-[var(--border)]","bg-[var(--bg-2)]/50",n),children:e});function J5(){const{data:e}=Ie({queryKey:["phong-ban"],queryFn:ln.layTatCa}),{data:n}=Ie({queryKey:["nhan-vien"],queryFn:()=>Oa.layTatCa()}),{data:a}=Ie({queryKey:["khoan-luong"],queryFn:()=>Dr.layTatCa()}),{data:r}=Ie({queryKey:["bang-luong"],queryFn:()=>_r.layDanhSach()}),s=(Array.isArray(n)?n:(n==null?void 0:n.data)||[]).filter(h=>h&&h.id),l=(Array.isArray(r)?r:(r==null?void 0:r.data)||[]).filter(h=>h&&h.id),o=l.reduce((h,m)=>h+((m==null?void 0:m.thucLinh)||0),0)||0,d=[{label:"Phng ban",value:(e==null?void 0:e.length)||0,icon:Fr,color:"cyan",link:"/nhan-vien"},{label:"Nhn vin",value:(s==null?void 0:s.length)||0,icon:on,color:"green",link:"/nhan-vien"},{label:"Khon lng",value:(a==null?void 0:a.length)||0,icon:Ar,color:"purple",link:"/khoan-luong"},{label:"Bng lng",value:(l==null?void 0:l.length)||0,icon:Ys,color:"yellow",link:"/bang-luong"}],u=h=>{switch(h){case"NHAP":return t.jsx(Tt,{variant:"neutral",dot:!0,children:"ang nhp"});case"DA_CHOT":return t.jsx(Tt,{variant:"success",dot:!0,children:" cht"});case"KHOA":return t.jsx(Tt,{variant:"info",dot:!0,children:" kha"});default:return t.jsx(Tt,{variant:"neutral",children:h})}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-[var(--text-primary)] flex items-center gap-2",children:[t.jsx(U_,{size:24,className:"text-[var(--accent)]"}),"Tng quan H thng"]}),t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1",children:"Cho mng tr li! y l tng quan hot ng ca bn."})]}),t.jsxs(ca,{to:"/bang-luong",className:`
            inline-flex items-center gap-2 px-4 py-2.5 
            bg-[var(--accent)] text-[#0B1220] font-medium
            rounded-xl hover:bg-[var(--accent)]/90 
            shadow-lg shadow-[var(--accent)]/25
            transition-all duration-200
          `,children:[t.jsx(Ys,{size:18}),"To bng lng",t.jsx(c_,{size:16})]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:d.map(h=>{const m=h.icon;return t.jsx(ca,{to:h.link,children:t.jsx(Vj,{title:h.label,value:h.value,icon:t.jsx(m,{size:24}),accentColor:h.color})},h.label)})}),t.jsxs(st,{variant:"glass",className:`
          relative overflow-hidden
          bg-gradient-to-br from-[#53F39A]/5 via-[var(--panel)] to-[#4FC3FF]/5
          border border-[var(--accent)]/20
        `,children:[t.jsx("div",{className:"absolute -top-20 -right-20 w-60 h-60 bg-[var(--accent)]/10 rounded-full blur-3xl"}),t.jsx("div",{className:"absolute -bottom-20 -left-20 w-40 h-40 bg-[#4FC3FF]/10 rounded-full blur-3xl"}),t.jsxs("div",{className:"relative flex items-center gap-6",children:[t.jsx("div",{className:`
            p-5 rounded-2xl
            bg-gradient-to-br from-[#53F39A] to-[#4FC3FF]
            shadow-lg shadow-[#53F39A]/30
          `,children:t.jsx(al,{size:32,className:"text-[#0B1220]"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-[var(--text-muted)] uppercase tracking-wider font-medium",children:"Tng qu lng"}),t.jsxs("p",{className:"text-4xl font-bold text-[var(--text-primary)] mt-1 tabular-nums",children:[Ze(o),t.jsx("span",{className:"text-lg text-[var(--text-muted)] ml-2 font-normal",children:"VN"})]})]})]})]}),t.jsxs(st,{variant:"glass",padding:"none",children:[t.jsx(Un,{title:t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(Ot,{size:20,className:"text-[var(--accent)]"}),"Bng lng gn y"]}),action:t.jsxs(ca,{to:"/bang-luong",className:`
                flex items-center gap-1 text-sm text-[var(--text-muted)]
                hover:text-[var(--accent)] transition-colors
              `,children:["Xem tt c",t.jsx(aa,{size:16})]}),className:"px-5 pt-5"}),l&&l.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-[var(--border)]",children:[t.jsx("th",{className:"text-left py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Thng/Nm"}),t.jsx("th",{className:"text-left py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Phng ban"}),t.jsx("th",{className:"text-right py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"S NV"}),t.jsx("th",{className:"text-right py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Thc lnh"}),t.jsx("th",{className:"text-center py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Trng thi"})]})}),t.jsx("tbody",{className:"divide-y divide-[var(--border)]",children:l.slice(0,5).map(h=>{var m;return t.jsxs("tr",{className:"hover:bg-[var(--bg-2)] transition-colors group",children:[t.jsx("td",{className:"py-4 px-5",children:t.jsxs(ca,{to:`/bang-luong/${h.id}`,className:`
                          font-medium text-[var(--text-primary)]
                          group-hover:text-[var(--accent)] transition-colors
                        `,children:["Thng ",h.thang,"/",h.nam]})}),t.jsx("td",{className:"py-4 px-5 text-[var(--text-secondary)]",children:((m=h.phongBan)==null?void 0:m.tenPhongBan)||"Tt c phng ban"}),t.jsx("td",{className:"py-4 px-5 text-right text-[var(--text-secondary)] tabular-nums",children:h.soNhanVien||0}),t.jsx("td",{className:"py-4 px-5 text-right font-semibold text-[var(--accent)] tabular-nums",children:Ze(h.thucLinh)}),t.jsx("td",{className:"py-4 px-5 text-center",children:u(h.trangThai)})]},h.id)})})]})}):t.jsxs("div",{className:"text-center py-12 px-5",children:[t.jsx("div",{className:`
              w-16 h-16 mx-auto mb-4 rounded-2xl
              bg-[var(--bg-2)] flex items-center justify-center
              text-[var(--text-muted)]
            `,children:t.jsx(Ys,{size:28})}),t.jsxs("p",{className:"text-[var(--text-muted)]",children:["Cha c bng lng no."," ",t.jsx(ca,{to:"/bang-luong",className:"text-[var(--accent)] hover:underline",children:"To bng lng mi"})]})]})]})]})}function Z5(){const{coVaiTro:e}=ns(),n=e("ADMIN"),a=Rt(),[r,s]=E.useState(!1),[l,o]=E.useState(new Date().getFullYear()),[d,u]=E.useState(),[h,m]=E.useState({thang:new Date().getMonth()+1,nam:new Date().getFullYear(),phongBanIds:[],tenBangLuong:""}),{data:f,isLoading:p}=Ie({queryKey:["bang-luong",l,d],queryFn:()=>_r.layDanhSach({nam:l,phongBanId:d})}),b=(Array.isArray(f)?f:(f==null?void 0:f.data)||[]).filter(k=>k&&k.id),{data:g}=Ie({queryKey:["phong-ban"],queryFn:ln.layTatCa}),y=De({mutationFn:async k=>{const _=await Promise.allSettled(k.phongBanIds.map(A=>_r.taoMoi({thang:k.thang,nam:k.nam,phongBanId:A,tenBangLuong:k.phongBanIds.length>1?"":k.tenBangLuong}))),P=_.filter(A=>A.status==="fulfilled"),j=_.filter(A=>A.status==="rejected");return{successful:P,failed:j,total:_.length}},onSuccess:({successful:k,failed:_,total:P})=>{var j,A,L;if(a.invalidateQueries({queryKey:["bang-luong"]}),k.length>0&&_.length===0)le.success(`To ${k.length} bng lng thnh cng!`);else if(k.length>0&&_.length>0)le.success(`To ${k.length}/${P} bng lng thnh cng!`),le.error(`${_.length} bng lng to tht bi`);else if(_.length>0){const R=((L=(A=(j=_[0].reason)==null?void 0:j.response)==null?void 0:A.data)==null?void 0:L.message)||"C li xy ra";le.error(R)}k.length>0&&(s(!1),m({thang:new Date().getMonth()+1,nam:new Date().getFullYear(),phongBanIds:[],tenBangLuong:""}))},onError:k=>{var _,P;le.error(((P=(_=k.response)==null?void 0:_.data)==null?void 0:P.message)||"C li xy ra")}}),N=De({mutationFn:({id:k,force:_})=>_r.xoa(k,_),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-luong"]}),le.success("Xa bng lng thnh cng!")},onError:k=>{var _,P;le.error(((P=(_=k.response)==null?void 0:_.data)==null?void 0:P.message)||"C li xy ra")}}),C=()=>{if(h.phongBanIds.length===0){le.error("Vui lng chn t nht mt phng ban");return}y.mutate(h)},T=(k,_,P=!1)=>{if(!P&&_!=="NHAP"){le.error("Ch c th xa bng lng ang  trng thi Nhp. ADMIN c th xa bng  kha.");return}confirm(P?" BN ANG XA BNG LNG  KHA! Hnh ng ny khng th hon tc. Bn c chc chn?":"Bn c chc mun xa bng lng ny?")&&N.mutate({id:k,force:P})},S=k=>{switch(k){case"NHAP":return t.jsx(Tt,{variant:"neutral",dot:!0,children:"ang nhp"});case"DA_CHOT":return t.jsx(Tt,{variant:"success",dot:!0,children:" cht"});case"KHOA":return t.jsx(Tt,{variant:"info",dot:!0,children:" kha"});default:return t.jsx(Tt,{variant:"neutral",children:K5(k)})}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-[var(--text-primary)] flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--accent)]/10 flex items-center justify-center",children:t.jsx(Ys,{size:22,className:"text-[var(--accent)]"})}),"Qun l Bng lng"]}),t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1 ml-13",children:"To v qun l bng lng hng thng"})]}),t.jsx(mt,{onClick:()=>s(!0),icon:t.jsx(St,{size:18}),children:"To bng lng mi"})]}),t.jsx(st,{variant:"glass",padding:"md",children:t.jsxs("div",{className:"flex gap-4 items-end flex-wrap",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-[var(--text-muted)] mb-1.5 uppercase tracking-wider",children:"Nm"}),t.jsx("select",{value:l,onChange:k=>o(Number(k.target.value)),className:`
                h-10 px-4 rounded-xl
                bg-[var(--bg-1)] border border-[var(--border)]
                text-[var(--text-primary)]
                focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                transition-all
              `,children:[2024,2025,2026,2027].map(k=>t.jsx("option",{value:k,children:k},k))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-[var(--text-muted)] mb-1.5 uppercase tracking-wider",children:"Phng ban"}),t.jsxs("select",{value:d||"",onChange:k=>u(k.target.value?Number(k.target.value):void 0),className:`
                h-10 px-4 rounded-xl min-w-[200px]
                bg-[var(--bg-1)] border border-[var(--border)]
                text-[var(--text-primary)]
                focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                transition-all
              `,children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),g==null?void 0:g.map(k=>t.jsx("option",{value:k.id,children:k.tenPhongBan},k.id))]})]})]})}),t.jsx(st,{variant:"glass",padding:"none",children:p?t.jsx("div",{className:"flex items-center justify-center py-16",children:t.jsx("div",{className:"w-8 h-8 border-2 border-[var(--accent)] border-t-transparent rounded-full animate-spin"})}):b&&b.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-[var(--border)] bg-[var(--bg-2)]",children:[t.jsx("th",{className:"text-left py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Tn bng lng"}),t.jsx("th",{className:"text-center py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"K lng"}),t.jsx("th",{className:"text-left py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Phng ban"}),t.jsx("th",{className:"text-right py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"S NV"}),t.jsx("th",{className:"text-right py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Tng thu nhp"}),t.jsx("th",{className:"text-right py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Thc lnh"}),t.jsx("th",{className:"text-center py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Trng thi"}),t.jsx("th",{className:"text-center py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-[var(--border)]",children:b.map(k=>{var _;return t.jsxs("tr",{className:"hover:bg-[var(--bg-2)] transition-colors group",children:[t.jsx("td",{className:"py-4 px-5",children:t.jsx(ca,{to:`/bang-luong/${k.id}`,className:"font-medium text-[var(--text-primary)] group-hover:text-[var(--accent)] transition-colors",children:k.tenBangLuong||`Bng lng T${k.thang}/${k.nam}`})}),t.jsx("td",{className:"py-4 px-5 text-center",children:t.jsxs("span",{className:"inline-flex items-center gap-1.5 text-[var(--text-secondary)]",children:[t.jsx(Ot,{size:14,className:"text-[var(--text-muted)]"}),"T",k.thang,"/",k.nam]})}),t.jsx("td",{className:"py-4 px-5 text-[var(--text-secondary)]",children:((_=k.phongBan)==null?void 0:_.tenPhongBan)||""}),t.jsx("td",{className:"py-4 px-5 text-right text-[var(--text-secondary)] tabular-nums",children:k.soNhanVien||0}),t.jsx("td",{className:"py-4 px-5 text-right text-[var(--text-secondary)] tabular-nums",children:Ze(k.tongThuNhap)}),t.jsx("td",{className:"py-4 px-5 text-right font-semibold text-[var(--accent)] tabular-nums",children:Ze(k.thucLinh)}),t.jsx("td",{className:"py-4 px-5 text-center",children:S(k.trangThai)}),t.jsx("td",{className:"py-4 px-5",children:t.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t.jsx(ca,{to:`/bang-luong/${k.id}`,className:"p-2 text-[var(--text-muted)] hover:text-[var(--accent)] hover:bg-[var(--accent)]/10 rounded-lg transition-colors",title:"Xem chi tit",children:t.jsx(ii,{size:18})}),k.trangThai==="NHAP"&&t.jsx("button",{onClick:()=>T(k.id,k.trangThai),className:"p-2 text-[var(--text-muted)] hover:text-[#FF4D6D] hover:bg-[#FF4D6D]/10 rounded-lg transition-colors",title:"Xa",children:t.jsx(Ir,{size:18})}),k.trangThai==="DA_CHOT"&&t.jsx("span",{className:"p-2 text-[var(--text-disabled)]",title:" cht",children:t.jsx(Js,{size:18})}),k.trangThai==="KHOA"&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"p-2 text-[var(--text-disabled)]",title:" kha",children:t.jsx(Js,{size:18})}),n&&t.jsx("button",{onClick:()=>T(k.id,k.trangThai,!0),className:"p-2 text-[#FF4D6D] hover:text-white hover:bg-[#FF4D6D] rounded-lg transition-colors",title:"ADMIN: Xa bng  kha",children:t.jsx(na,{size:18})})]})]})})]},k.id)})})]})}):t.jsxs("div",{className:"text-center py-16",children:[t.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl bg-[var(--bg-2)] flex items-center justify-center text-[var(--text-muted)]",children:t.jsx(Ys,{size:28})}),t.jsx("p",{className:"text-[var(--text-muted)]",children:"Cha c bng lng no"}),t.jsxs(mt,{onClick:()=>s(!0),variant:"secondary",size:"sm",className:"mt-4",children:[t.jsx(St,{size:16}),"To bng lng u tin"]})]})}),t.jsxs(js,{isOpen:r,onClose:()=>s(!1),size:"md",children:[t.jsx(ws,{title:"To bng lng mi",subtitle:"Chn k lng v phng ban  to bng lng",icon:t.jsx(Ys,{size:24})}),t.jsx(ks,{children:t.jsxs("div",{className:"space-y-5",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-1.5",children:"Thng"}),t.jsx("select",{value:h.thang,onChange:k=>m({...h,thang:Number(k.target.value)}),className:`
                    w-full h-10 px-4 rounded-xl
                    bg-[var(--bg-1)] border border-[var(--border)]
                    text-[var(--text-primary)]
                    focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                  `,children:Array.from({length:12},(k,_)=>_+1).map(k=>t.jsxs("option",{value:k,children:["Thng ",k]},k))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-1.5",children:"Nm"}),t.jsx("select",{value:h.nam,onChange:k=>m({...h,nam:Number(k.target.value)}),className:`
                    w-full h-10 px-4 rounded-xl
                    bg-[var(--bg-1)] border border-[var(--border)]
                    text-[var(--text-primary)]
                    focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                  `,children:[2024,2025,2026,2027].map(k=>t.jsx("option",{value:k,children:k},k))})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-1.5",children:["Phng ban ",t.jsx("span",{className:"text-[#FF4D6D]",children:"*"}),t.jsx("span",{className:"text-[var(--text-muted)] font-normal ml-1",children:"(chn nhiu)"})]}),t.jsxs("div",{className:"border border-[var(--border)] rounded-xl max-h-48 overflow-y-auto bg-[var(--bg-1)] modal-scroll",children:[t.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-[var(--accent-light)] cursor-pointer border-b border-[var(--border)] transition-colors",children:[t.jsx("input",{type:"checkbox",checked:g&&h.phongBanIds.length===g.length,onChange:k=>{k.target.checked?m({...h,phongBanIds:(g==null?void 0:g.map(_=>_.id))||[]}):m({...h,phongBanIds:[]})},className:"flex-shrink-0"}),t.jsxs("span",{className:"font-medium text-[var(--accent)]",children:["Chn tt c (",(g==null?void 0:g.length)||0," phng ban)"]})]}),g==null?void 0:g.map(k=>t.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-[var(--accent-light)] cursor-pointer transition-colors",children:[t.jsx("input",{type:"checkbox",checked:h.phongBanIds.includes(k.id),onChange:_=>{_.target.checked?m({...h,phongBanIds:[...h.phongBanIds,k.id]}):m({...h,phongBanIds:h.phongBanIds.filter(P=>P!==k.id)})},className:"flex-shrink-0"}),t.jsx("span",{className:"text-[var(--text-primary)] flex-1",children:k.tenPhongBan}),h.phongBanIds.includes(k.id)&&t.jsx(Lr,{className:"w-4 h-4 text-[var(--accent)] flex-shrink-0"})]},k.id))]}),h.phongBanIds.length>0&&t.jsxs("p",{className:"text-xs text-[var(--accent)] mt-1.5 font-medium",children:["  chn: ",h.phongBanIds.length," phng ban"]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-1.5",children:["Tn bng lng",t.jsx("span",{className:"text-[var(--text-muted)] font-normal ml-1",children:"(tu chn)"})]}),t.jsx("input",{type:"text",value:h.tenBangLuong,onChange:k=>m({...h,tenBangLuong:k.target.value}),className:`
                  w-full h-10 px-4 rounded-xl
                  bg-[var(--bg-1)] border border-[var(--border)]
                  text-[var(--text-primary)] placeholder:text-[var(--text-disabled)]
                  focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                `,placeholder:"T ng to nu  trng"})]})]})}),t.jsxs(ei,{children:[t.jsx(mt,{variant:"secondary",onClick:()=>s(!1),children:"Hu"}),t.jsx(mt,{onClick:C,loading:y.isPending,icon:t.jsx(St,{size:16}),children:"To bng lng"})]})]})]})}function e6(e,n){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const a=document.implementation.createHTMLDocument(),r=a.createElement("base"),s=a.createElement("a");return a.head.appendChild(r),a.body.appendChild(s),n&&(r.href=n),s.href=e,s.href}const t6=(()=>{let e=0;const n=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${n()}${e}`)})();function tl(e){const n=[];for(let a=0,r=e.length;a<r;a++)n.push(e[a]);return n}let Wo=null;function Gj(e={}){return Wo||(e.includeStyleProperties?(Wo=e.includeStyleProperties,Wo):(Wo=tl(window.getComputedStyle(document.documentElement)),Wo))}function y0(e,n){const r=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(n);return r?parseFloat(r.replace("px","")):0}function n6(e){const n=y0(e,"border-left-width"),a=y0(e,"border-right-width");return e.clientWidth+n+a}function a6(e){const n=y0(e,"border-top-width"),a=y0(e,"border-bottom-width");return e.clientHeight+n+a}function qj(e,n={}){const a=n.width||n6(e),r=n.height||a6(e);return{width:a,height:r}}function r6(){let e,n;try{n=process}catch{}const a=n&&n.env?n.env.devicePixelRatio:null;return a&&(e=parseInt(a,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const ir=16384;function s6(e){(e.width>ir||e.height>ir)&&(e.width>ir&&e.height>ir?e.width>e.height?(e.height*=ir/e.width,e.width=ir):(e.width*=ir/e.height,e.height=ir):e.width>ir?(e.height*=ir/e.width,e.width=ir):(e.width*=ir/e.height,e.height=ir))}function v0(e){return new Promise((n,a)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>n(r))})},r.onerror=a,r.crossOrigin="anonymous",r.decoding="async",r.src=e})}async function i6(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(n=>`data:image/svg+xml;charset=utf-8,${n}`)}async function l6(e,n,a){const r="http://www.w3.org/2000/svg",s=document.createElementNS(r,"svg"),l=document.createElementNS(r,"foreignObject");return s.setAttribute("width",`${n}`),s.setAttribute("height",`${a}`),s.setAttribute("viewBox",`0 0 ${n} ${a}`),l.setAttribute("width","100%"),l.setAttribute("height","100%"),l.setAttribute("x","0"),l.setAttribute("y","0"),l.setAttribute("externalResourcesRequired","true"),s.appendChild(l),l.appendChild(e),i6(s)}const Ja=(e,n)=>{if(e instanceof n)return!0;const a=Object.getPrototypeOf(e);return a===null?!1:a.constructor.name===n.name||Ja(a,n)};function o6(e){const n=e.getPropertyValue("content");return`${e.cssText} content: '${n.replace(/'|"/g,"")}';`}function c6(e,n){return Gj(n).map(a=>{const r=e.getPropertyValue(a),s=e.getPropertyPriority(a);return`${a}: ${r}${s?" !important":""};`}).join(" ")}function d6(e,n,a,r){const s=`.${e}:${n}`,l=a.cssText?o6(a):c6(a,r);return document.createTextNode(`${s}{${l}}`)}function Tb(e,n,a,r){const s=window.getComputedStyle(e,a),l=s.getPropertyValue("content");if(l===""||l==="none")return;const o=t6();try{n.className=`${n.className} ${o}`}catch{return}const d=document.createElement("style");d.appendChild(d6(o,a,s,r)),n.appendChild(d)}function u6(e,n,a){Tb(e,n,":before",a),Tb(e,n,":after",a)}const Cb="application/font-woff",Sb="image/jpeg",h6={woff:Cb,woff2:Cb,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Sb,jpeg:Sb,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function x6(e){const n=/\.([^./]*?)$/g.exec(e);return n?n[1]:""}function lg(e){const n=x6(e).toLowerCase();return h6[n]||""}function m6(e){return e.split(/,/)[1]}function fp(e){return e.search(/^(data:)/)!==-1}function f6(e,n){return`data:${n};base64,${e}`}async function Wj(e,n,a){const r=await fetch(e,n);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const s=await r.blob();return new Promise((l,o)=>{const d=new FileReader;d.onerror=o,d.onloadend=()=>{try{l(a({res:r,result:d.result}))}catch(u){o(u)}},d.readAsDataURL(s)})}const rf={};function p6(e,n,a){let r=e.replace(/\?.*/,"");return a&&(r=e),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),n?`[${n}]${r}`:r}async function og(e,n,a){const r=p6(e,n,a.includeQueryParams);if(rf[r]!=null)return rf[r];a.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let s;try{const l=await Wj(e,a.fetchRequestInit,({res:o,result:d})=>(n||(n=o.headers.get("Content-Type")||""),m6(d)));s=f6(l,n)}catch(l){s=a.imagePlaceholder||"";let o=`Failed to fetch resource: ${e}`;l&&(o=typeof l=="string"?l:l.message),o&&console.warn(o)}return rf[r]=s,s}async function g6(e){const n=e.toDataURL();return n==="data:,"?e.cloneNode(!1):v0(n)}async function y6(e,n){if(e.currentSrc){const l=document.createElement("canvas"),o=l.getContext("2d");l.width=e.clientWidth,l.height=e.clientHeight,o==null||o.drawImage(e,0,0,l.width,l.height);const d=l.toDataURL();return v0(d)}const a=e.poster,r=lg(a),s=await og(a,r,n);return v0(s)}async function v6(e,n){var a;try{if(!((a=e==null?void 0:e.contentDocument)===null||a===void 0)&&a.body)return await Z0(e.contentDocument.body,n,!0)}catch{}return e.cloneNode(!1)}async function b6(e,n){return Ja(e,HTMLCanvasElement)?g6(e):Ja(e,HTMLVideoElement)?y6(e,n):Ja(e,HTMLIFrameElement)?v6(e,n):e.cloneNode(Xj(e))}const N6=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",Xj=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function j6(e,n,a){var r,s;if(Xj(n))return n;let l=[];return N6(e)&&e.assignedNodes?l=tl(e.assignedNodes()):Ja(e,HTMLIFrameElement)&&(!((r=e.contentDocument)===null||r===void 0)&&r.body)?l=tl(e.contentDocument.body.childNodes):l=tl(((s=e.shadowRoot)!==null&&s!==void 0?s:e).childNodes),l.length===0||Ja(e,HTMLVideoElement)||await l.reduce((o,d)=>o.then(()=>Z0(d,a)).then(u=>{u&&n.appendChild(u)}),Promise.resolve()),n}function w6(e,n,a){const r=n.style;if(!r)return;const s=window.getComputedStyle(e);s.cssText?(r.cssText=s.cssText,r.transformOrigin=s.transformOrigin):Gj(a).forEach(l=>{let o=s.getPropertyValue(l);l==="font-size"&&o.endsWith("px")&&(o=`${Math.floor(parseFloat(o.substring(0,o.length-2)))-.1}px`),Ja(e,HTMLIFrameElement)&&l==="display"&&o==="inline"&&(o="block"),l==="d"&&n.getAttribute("d")&&(o=`path(${n.getAttribute("d")})`),r.setProperty(l,o,s.getPropertyPriority(l))})}function k6(e,n){Ja(e,HTMLTextAreaElement)&&(n.innerHTML=e.value),Ja(e,HTMLInputElement)&&n.setAttribute("value",e.value)}function T6(e,n){if(Ja(e,HTMLSelectElement)){const r=Array.from(n.children).find(s=>e.value===s.getAttribute("value"));r&&r.setAttribute("selected","")}}function C6(e,n,a){return Ja(n,Element)&&(w6(e,n,a),u6(e,n,a),k6(e,n),T6(e,n)),n}async function S6(e,n){const a=e.querySelectorAll?e.querySelectorAll("use"):[];if(a.length===0)return e;const r={};for(let l=0;l<a.length;l++){const d=a[l].getAttribute("xlink:href");if(d){const u=e.querySelector(d),h=document.querySelector(d);!u&&h&&!r[d]&&(r[d]=await Z0(h,n,!0))}}const s=Object.values(r);if(s.length){const l="http://www.w3.org/1999/xhtml",o=document.createElementNS(l,"svg");o.setAttribute("xmlns",l),o.style.position="absolute",o.style.width="0",o.style.height="0",o.style.overflow="hidden",o.style.display="none";const d=document.createElementNS(l,"defs");o.appendChild(d);for(let u=0;u<s.length;u++)d.appendChild(s[u]);e.appendChild(o)}return e}async function Z0(e,n,a){return!a&&n.filter&&!n.filter(e)?null:Promise.resolve(e).then(r=>b6(r,n)).then(r=>j6(e,r,n)).then(r=>C6(e,r,n)).then(r=>S6(r,n))}const Qj=/url\((['"]?)([^'"]+?)\1\)/g,_6=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,E6=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function D6(e){const n=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${n})(['"]?\\))`,"g")}function F6(e){const n=[];return e.replace(Qj,(a,r,s)=>(n.push(s),a)),n.filter(a=>!fp(a))}async function A6(e,n,a,r,s){try{const l=a?e6(n,a):n,o=lg(n);let d;return s||(d=await og(l,o,r)),e.replace(D6(n),`$1${d}$3`)}catch{}return e}function P6(e,{preferredFontFormat:n}){return n?e.replace(E6,a=>{for(;;){const[r,,s]=_6.exec(a)||[];if(!s)return"";if(s===n)return`src: ${r};`}}):e}function Yj(e){return e.search(Qj)!==-1}async function Jj(e,n,a){if(!Yj(e))return e;const r=P6(e,a);return F6(r).reduce((l,o)=>l.then(d=>A6(d,o,n,a)),Promise.resolve(r))}async function Xo(e,n,a){var r;const s=(r=n.style)===null||r===void 0?void 0:r.getPropertyValue(e);if(s){const l=await Jj(s,null,a);return n.style.setProperty(e,l,n.style.getPropertyPriority(e)),!0}return!1}async function L6(e,n){await Xo("background",e,n)||await Xo("background-image",e,n),await Xo("mask",e,n)||await Xo("-webkit-mask",e,n)||await Xo("mask-image",e,n)||await Xo("-webkit-mask-image",e,n)}async function O6(e,n){const a=Ja(e,HTMLImageElement);if(!(a&&!fp(e.src))&&!(Ja(e,SVGImageElement)&&!fp(e.href.baseVal)))return;const r=a?e.src:e.href.baseVal,s=await og(r,lg(r),n);await new Promise((l,o)=>{e.onload=l,e.onerror=n.onImageErrorHandler?(...u)=>{try{l(n.onImageErrorHandler(...u))}catch(h){o(h)}}:o;const d=e;d.decode&&(d.decode=l),d.loading==="lazy"&&(d.loading="eager"),a?(e.srcset="",e.src=s):e.href.baseVal=s})}async function I6(e,n){const r=tl(e.childNodes).map(s=>Zj(s,n));await Promise.all(r).then(()=>e)}async function Zj(e,n){Ja(e,Element)&&(await L6(e,n),await O6(e,n),await I6(e,n))}function M6(e,n){const{style:a}=e;n.backgroundColor&&(a.backgroundColor=n.backgroundColor),n.width&&(a.width=`${n.width}px`),n.height&&(a.height=`${n.height}px`);const r=n.style;return r!=null&&Object.keys(r).forEach(s=>{a[s]=r[s]}),e}const _b={};async function Eb(e){let n=_b[e];if(n!=null)return n;const r=await(await fetch(e)).text();return n={url:e,cssText:r},_b[e]=n,n}async function Db(e,n){let a=e.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,l=(a.match(/url\([^)]+\)/g)||[]).map(async o=>{let d=o.replace(r,"$1");return d.startsWith("https://")||(d=new URL(d,e.url).href),Wj(d,n.fetchRequestInit,({result:u})=>(a=a.replace(o,`url(${u})`),[o,u]))});return Promise.all(l).then(()=>a)}function Fb(e){if(e==null)return[];const n=[],a=/(\/\*[\s\S]*?\*\/)/gi;let r=e.replace(a,"");const s=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const u=s.exec(r);if(u===null)break;n.push(u[0])}r=r.replace(s,"");const l=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,o="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",d=new RegExp(o,"gi");for(;;){let u=l.exec(r);if(u===null){if(u=d.exec(r),u===null)break;l.lastIndex=d.lastIndex}else d.lastIndex=l.lastIndex;n.push(u[0])}return n}async function R6(e,n){const a=[],r=[];return e.forEach(s=>{if("cssRules"in s)try{tl(s.cssRules||[]).forEach((l,o)=>{if(l.type===CSSRule.IMPORT_RULE){let d=o+1;const u=l.href,h=Eb(u).then(m=>Db(m,n)).then(m=>Fb(m).forEach(f=>{try{s.insertRule(f,f.startsWith("@import")?d+=1:s.cssRules.length)}catch(p){console.error("Error inserting rule from remote css",{rule:f,error:p})}})).catch(m=>{console.error("Error loading remote css",m.toString())});r.push(h)}})}catch(l){const o=e.find(d=>d.href==null)||document.styleSheets[0];s.href!=null&&r.push(Eb(s.href).then(d=>Db(d,n)).then(d=>Fb(d).forEach(u=>{o.insertRule(u,o.cssRules.length)})).catch(d=>{console.error("Error loading remote stylesheet",d)})),console.error("Error inlining remote css file",l)}}),Promise.all(r).then(()=>(e.forEach(s=>{if("cssRules"in s)try{tl(s.cssRules||[]).forEach(l=>{a.push(l)})}catch(l){console.error(`Error while reading CSS rules from ${s.href}`,l)}}),a))}function B6(e){return e.filter(n=>n.type===CSSRule.FONT_FACE_RULE).filter(n=>Yj(n.style.getPropertyValue("src")))}async function H6(e,n){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const a=tl(e.ownerDocument.styleSheets),r=await R6(a,n);return B6(r)}function ew(e){return e.trim().replace(/["']/g,"")}function V6(e){const n=new Set;function a(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(l=>{n.add(ew(l))}),Array.from(r.children).forEach(l=>{l instanceof HTMLElement&&a(l)})}return a(e),n}async function U6(e,n){const a=await H6(e,n),r=V6(e);return(await Promise.all(a.filter(l=>r.has(ew(l.style.fontFamily))).map(l=>{const o=l.parentStyleSheet?l.parentStyleSheet.href:null;return Jj(l.cssText,o,n)}))).join(`
`)}async function K6(e,n){const a=n.fontEmbedCSS!=null?n.fontEmbedCSS:n.skipFonts?null:await U6(e,n);if(a){const r=document.createElement("style"),s=document.createTextNode(a);r.appendChild(s),e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)}}async function z6(e,n={}){const{width:a,height:r}=qj(e,n),s=await Z0(e,n,!0);return await K6(s,n),await Zj(s,n),M6(s,n),await l6(s,a,r)}async function $6(e,n={}){const{width:a,height:r}=qj(e,n),s=await z6(e,n),l=await v0(s),o=document.createElement("canvas"),d=o.getContext("2d"),u=n.pixelRatio||r6(),h=n.canvasWidth||a,m=n.canvasHeight||r;return o.width=h*u,o.height=m*u,n.skipAutoScale||s6(o),o.style.width=`${h}`,o.style.height=`${m}`,n.backgroundColor&&(d.fillStyle=n.backgroundColor,d.fillRect(0,0,o.width,o.height)),d.drawImage(l,0,0,o.width,o.height),o}async function G6(e,n={}){return(await $6(e,n)).toDataURL()}const wd=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),tw=E.forwardRef(({data:e},n)=>{const a=e.cacKhoanLuong.filter(s=>s.loai==="THU_NHAP"),r=e.cacKhoanLuong.filter(s=>s.loai==="KHAU_TRU");return t.jsxs("div",{ref:n,className:"bg-white rounded-xl shadow-lg overflow-hidden max-w-2xl mx-auto",style:{width:"700px",fontFamily:"system-ui, -apple-system, sans-serif"},children:[t.jsxs("div",{className:"text-white text-center py-8 px-6",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[t.jsx("h1",{className:"text-3xl font-bold mb-1",children:"PHIU LNG"}),t.jsxs("p",{className:"text-lg opacity-90",children:["Thng ",e.thang," / ",e.nam]})]}),t.jsxs("div",{className:"text-center py-4 px-6 border-b-2 border-dashed border-gray-200 bg-gray-50",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"CNG TY TNHH ABC"}),t.jsx("p",{className:"text-sm text-gray-600",children:"123 ng ABC, Qun 1, TP.HCM"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 p-6 bg-gray-50 border-b border-gray-200",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500",children:"H v tn"}),t.jsx("p",{className:"font-semibold text-gray-800",children:e.hoTen})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500",children:"M nhn vin"}),t.jsx("p",{className:"font-semibold text-gray-800",children:e.maNhanVien})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500",children:"Phng ban"}),t.jsx("p",{className:"font-semibold text-gray-800",children:e.phongBan})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500",children:"Chc v"}),t.jsx("p",{className:"font-semibold text-gray-800",children:e.chucVu||"Nhn vin"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("span",{className:"text-xs text-gray-500",children:"Ngy cng thc t"}),t.jsxs("p",{className:"font-semibold text-gray-800",children:[t.jsx("span",{className:"text-blue-600",children:e.ngayCongThucTe})," / ",e.ngayCongLyThuyet," ngy"]})]})]}),t.jsxs("div",{className:"p-6 border-b border-gray-100",children:[t.jsx("h3",{className:"text-base font-bold text-gray-800 mb-4 pb-2 border-b-2 border-green-500 inline-block",children:"THU NHP"}),t.jsx("div",{className:"space-y-3",children:a.map((s,l)=>t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-600",children:s.tenKhoan}),t.jsx("span",{className:"font-medium text-green-600",children:wd(s.soTien)})]},l))})]}),t.jsxs("div",{className:"p-6 border-b border-gray-100",children:[t.jsx("h3",{className:"text-base font-bold text-gray-800 mb-4 pb-2 border-b-2 border-red-500 inline-block",children:"KHU TR"}),t.jsx("div",{className:"space-y-3",children:r.length>0?r.map((s,l)=>t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-600",children:s.tenKhoan}),t.jsxs("span",{className:"font-medium text-red-600",children:["-",wd(s.soTien)]})]},l)):t.jsx("p",{className:"text-gray-400 italic",children:"Khng c khon khu tr"})})]}),t.jsxs("div",{className:"p-6 text-white",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[t.jsxs("div",{className:"flex justify-between items-center py-2",children:[t.jsx("span",{className:"opacity-90",children:"Tng thu nhp:"}),t.jsx("span",{className:"font-semibold",children:wd(e.tongThuNhap)})]}),t.jsxs("div",{className:"flex justify-between items-center py-2",children:[t.jsx("span",{className:"opacity-90",children:"Tng khu tr:"}),t.jsxs("span",{className:"font-semibold",children:["-",wd(e.tongKhauTru)]})]}),t.jsxs("div",{className:"flex justify-between items-center pt-4 mt-4 border-t border-white/30",children:[t.jsx("span",{className:"text-xl font-bold",children:"THC LNH:"}),t.jsx("span",{className:"text-2xl font-bold",children:wd(e.thucLinh)})]})]}),t.jsxs("div",{className:"text-center py-4 px-6 text-sm text-gray-500 border-t border-gray-100",children:[t.jsx("p",{children:"Phiu lng c to t ng bi h thng tnh lng."}),t.jsx("p",{children:"Nu c thc mc, vui lng lin h phng Nhn s."})]})]})});tw.displayName="PhieuLuong";function q6({isOpen:e,onClose:n,bangLuongId:a,nhanVienId:r,hoTen:s}){const l=E.useRef(null),[o,d]=E.useState(!1),{data:u,isLoading:h,error:m}=Ie({queryKey:["phieu-luong",a,r],queryFn:()=>mp.layPhieuLuong(a,r),enabled:e}),f=De({mutationFn:()=>mp.guiPhieuLuong(a,r),onSuccess:g=>{g.success?le.success(g.message):le.error(g.message)},onError:()=>{le.error("C li khi gi email")}}),p=E.useCallback(async()=>{if(!(!l.current||!u)){d(!0);try{const g=await G6(l.current,{cacheBust:!0,pixelRatio:2,backgroundColor:"#ffffff"}),y=document.createElement("a");y.download=`phieu-luong-${u.maNhanVien}-thang-${u.thang}-${u.nam}.png`,y.href=g,y.click(),le.success(" xut phiu lng thnh cng!")}catch(g){console.error("Export error:",g),le.error("C li khi xut nh")}finally{d(!1)}}},[u]),b=E.useCallback(()=>{if(!(u!=null&&u.email)){le.error("Nhn vin khng c email");return}f.mutate()},[u==null?void 0:u.email,f]);return e?t.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[t.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:n}),t.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col mx-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gray-50",children:[t.jsxs("h2",{className:"text-lg font-bold text-gray-800",children:["Phiu lng - ",s]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:p,disabled:o||h,className:"btn btn-secondary flex items-center gap-2",children:[o?t.jsx(In,{size:18,className:"animate-spin"}):t.jsx(C_,{size:18}),"Xut nh"]}),t.jsxs("button",{onClick:b,disabled:f.isPending||h||!(u!=null&&u.email),className:"btn btn-primary flex items-center gap-2",title:u!=null&&u.email?"Gi phiu lng qua email":"Nhn vin khng c email",children:[f.isPending?t.jsx(In,{size:18,className:"animate-spin"}):t.jsx(Qp,{size:18}),"Gi email"]}),t.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-200 rounded-lg",children:t.jsx(hn,{size:20})})]})]}),t.jsx("div",{className:"flex-1 overflow-auto p-6 bg-gray-100",children:h?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx(In,{size:40,className:"animate-spin text-blue-500"})}):m?t.jsx("div",{className:"text-center py-8",children:t.jsx("p",{className:"text-red-500",children:"C li khi ti phiu lng"})}):u?t.jsx(tw,{ref:l,data:u}):null}),u&&t.jsxs("div",{className:"p-3 bg-gray-50 border-t text-sm text-gray-600 flex items-center justify-between",children:[t.jsxs("span",{children:["Email: ",u.email||t.jsx("span",{className:"italic text-gray-400",children:"Cha c"})]}),t.jsxs("span",{children:["Thc lnh: ",t.jsx("strong",{className:"text-green-600",children:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(u.thucLinh)})]})]})]})]}):null}function W6({ngayCong:e,onClose:n,onSave:a,isLoading:r}){var m,f,p;const[s,l]=E.useState(((m=e==null?void 0:e.ngayCongDieuChinh)==null?void 0:m.toString())||""),[o,d]=E.useState((e==null?void 0:e.ghiChu)||"");if(!e)return null;const u=e.ngayCongDieuChinh?Number(e.ngayCongDieuChinh):Number(e.soCongThucTe)+Number(e.soNgayNghiPhep),h=async b=>{if(b.preventDefault(),!s)return;const g=parseFloat(s);if(isNaN(g)||g<0){alert("S ngy cng khng hp l");return}await a(g,o||void 0)};return t.jsx("div",{className:"modal-overlay",onClick:n,children:t.jsxs("div",{className:"modal-content max-w-lg",onClick:b=>b.stopPropagation(),children:[t.jsxs("div",{className:"modal-header",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ot,{className:"w-5 h-5"}),t.jsx("h3",{className:"text-lg font-semibold",children:"iu chnh ngy cng"})]}),t.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:t.jsx(hn,{className:"w-5 h-5"})})]}),t.jsxs("form",{onSubmit:h,children:[t.jsxs("div",{className:"modal-body space-y-4",children:[t.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-sm text-gray-600",children:"Nhn vin"}),t.jsx("div",{className:"font-semibold text-gray-900",children:((f=e.nhanVien)==null?void 0:f.hoTen)||"N/A"}),t.jsx("div",{className:"text-sm text-gray-500",children:((p=e.nhanVien)==null?void 0:p.maNhanVien)||"N/A"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Ngy cng l thuyt"}),t.jsx("div",{className:"text-xl font-bold text-blue-700",children:Number(e.ngayCongLyThuyet).toFixed(1)})]}),t.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"S cng thc t"}),t.jsx("div",{className:"text-xl font-bold text-green-700",children:Number(e.soCongThucTe).toFixed(1)})]}),t.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Ngh c php"}),t.jsx("div",{className:"text-xl font-bold text-yellow-700",children:Number(e.soNgayNghiPhep).toFixed(1)})]}),t.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Ngh khng php"}),t.jsx("div",{className:"text-xl font-bold text-red-700",children:Number(e.soNgayNghiKhongPhep).toFixed(1)})]})]}),t.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border-2 border-purple-200",children:[t.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Ngy cng hin ti (dng  tnh lng)"}),t.jsxs("div",{className:"text-2xl font-bold text-purple-700",children:[u.toFixed(1)," ngy"]}),e.ngayCongDieuChinh&&t.jsx("div",{className:"text-xs text-purple-600 mt-1",children:"  iu chnh th cng"})]}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsx("label",{className:"label",children:t.jsx("span",{className:"label-text font-semibold",children:"iu chnh ngy cng mi"})}),t.jsx("input",{type:"number",step:"0.5",min:"0",max:Number(e.ngayCongLyThuyet),className:"input input-bordered w-full",value:s,onChange:b=>l(b.target.value),placeholder:"Nhp s ngy cng",required:!0}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Nhp s ngy cng mi  iu chnh th cng"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"label",children:t.jsx("span",{className:"label-text font-semibold",children:"Ghi ch"})}),t.jsx("textarea",{className:"textarea textarea-bordered w-full",rows:3,value:o,onChange:b=>d(b.target.value),placeholder:"L do iu chnh..."})]}),t.jsxs("div",{className:"flex items-start gap-2 bg-yellow-50 p-3 rounded-lg border border-yellow-200",children:[t.jsx(uo,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"text-sm text-yellow-800",children:[t.jsx("div",{className:"font-semibold mb-1",children:"Lu :"}),t.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[t.jsx("li",{children:"iu chnh ngy cng s nh hng n lng c bn"}),t.jsx("li",{children:"Nn c l do r rng trong phn ghi ch"}),t.jsx("li",{children:"C th xa iu chnh  tr v tnh t ng"})]})]})]})]}),t.jsxs("div",{className:"modal-footer",children:[t.jsx("button",{type:"button",onClick:n,className:"btn btn-ghost",children:"Hy"}),t.jsx("button",{type:"submit",className:"btn btn-primary",disabled:r||!s,children:r?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"loading loading-spinner loading-sm"}),"ang lu..."]}):t.jsxs(t.Fragment,{children:[t.jsx(nl,{className:"w-4 h-4"}),"Lu iu chnh"]})})]})]})]})})}function X6(){const{id:e}=U0(),n=xr(),a=Rt(),[r,s]=E.useState(null),[l,o]=E.useState(new Map),[d,u]=E.useState(!1),[h,m]=E.useState(!1),[f,p]=E.useState(""),[b,g]=E.useState(null),[y,N]=E.useState(null),{data:C,isLoading:T}=Ie({queryKey:["bang-luong",e],queryFn:()=>_r.layTheoId(Number(e)),enabled:!!e}),{data:S}=Ie({queryKey:["ngay-cong",e],queryFn:()=>wb.layTatCa(Number(e)),enabled:!!e}),{data:k}=Ie({queryKey:["bang-luong-lich-su",e],queryFn:()=>_r.layLichSu(Number(e)),enabled:!!e&&d}),_=De({mutationFn:_r.capNhatNhieuChiTiet,onSuccess:()=>{a.invalidateQueries({queryKey:["bang-luong",e]}),o(new Map),le.success("Lu thay i thnh cng!")},onError:()=>{le.error("C li khi lu")}}),P=De({mutationFn:({nguoiChot:I})=>_r.chotBangLuong(Number(e),{nguoiChot:I}),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-luong",e]}),le.success("Cht bng lng thnh cng!"),m(!1)},onError:()=>{le.error("C li khi cht")}}),j=De({mutationFn:()=>_r.moKhoa(Number(e)),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-luong",e]}),le.success("M kha thnh cng!")}}),A=De({mutationFn:()=>mp.guiTatCa(Number(e)),onSuccess:I=>{I.success>0&&le.success(` gi ${I.success} phiu lng thnh cng!`),I.failed>0&&le.error(`${I.failed} phiu lng gi tht bi`)},onError:()=>{le.error("C li khi gi phiu lng")}}),L=De({mutationFn:({nhanVienId:I,ngayCongMoi:O,ghiChu:V})=>wb.dieuChinh(Number(e),I,{ngayCongMoi:O,ghiChu:V}),onSuccess:()=>{a.invalidateQueries({queryKey:["ngay-cong",e]}),a.invalidateQueries({queryKey:["bang-luong",e]}),le.success("Cp nht ngy cng thnh cng!"),N(null)},onError:()=>{le.error("C li khi cp nht ngy cng")}}),W=De({mutationFn:()=>_r.tinhLaiLuong(Number(e)),onSuccess:I=>{a.invalidateQueries({queryKey:["bang-luong",e]}),le.success(I.message)},onError:()=>{le.error("C li khi tnh li lng")}}),R=I=>{const O=S==null?void 0:S.find(V=>V.nhanVienId===I);if(O)N(O);else{const V=C==null?void 0:C.danhSachNhanVien.find(te=>te.nhanVienId===I);if(V&&C){const te={id:0,bangLuongId:C.id,nhanVienId:I,ngayCongLyThuyet:C.ngayCongLyThuyet,soCongThucTe:V.ngayCongThucTe,soNgayNghiPhep:0,soNgayNghiKhongPhep:0,ngayCongDieuChinh:null,ghiChu:null,nhanVien:{id:I,maNhanVien:V.maNhanVien,hoTen:V.hoTen}};N(te)}else le.error("Khng tm thy thng tin nhn vin")}},M=async(I,O)=>{y&&await L.mutateAsync({nhanVienId:y.nhanVienId,ngayCongMoi:I,ghiChu:O})},q=(I,O,V)=>{(C==null?void 0:C.trangThai)==="NHAP"&&s({nhanVienId:I,khoanLuongId:O,value:V.toString()})},ee=I=>{r&&s({...r,value:I})},z=()=>{var pe;if(!r||!C)return;const I=U5(r.value),O=`${r.nhanVienId}-${r.khoanLuongId}`,V=C.danhSachNhanVien.find(U=>U.nhanVienId===r.nhanVienId),te=((pe=V==null?void 0:V.cacKhoanLuong.find(U=>U.khoanLuongId===r.khoanLuongId))==null?void 0:pe.soTien)||0;if(I!==te){const U=new Map(l);U.set(O,{nhanVienId:r.nhanVienId,khoanLuongId:r.khoanLuongId,soTien:I}),o(U)}s(null)},fe=I=>{I.key==="Enter"?z():I.key==="Escape"&&s(null)},ae=()=>{if(l.size===0){le("Khng c thay i  lu");return}const I=Array.from(l.values()).map(O=>({bangLuongId:Number(e),...O}));_.mutate(I)},J=async()=>{try{const I=await c0.export(Number(e));z5(I.data,`bang-luong-${e}.xlsx`),le.success("Xut file thnh cng!")}catch{le.error("C li khi xut file")}},G=E.useCallback((I,O,V)=>{const te=`${I}-${O}`,pe=l.get(te);return pe?pe.soTien:V},[l]),he=E.useCallback(I=>{let O=0,V=0;for(const te of I.cacKhoanLuong){const pe=G(I.nhanVienId,te.khoanLuongId,te.soTien);te.loai==="THU_NHAP"?O+=pe:V+=pe}return l.forEach(te=>{if(te.nhanVienId===I.nhanVienId&&!I.cacKhoanLuong.find(U=>U.khoanLuongId===te.khoanLuongId)){const U=C==null?void 0:C.danhSachKhoanLuong.find(ce=>ce.id===te.khoanLuongId);(U==null?void 0:U.loai)==="THU_NHAP"?O+=te.soTien:V+=te.soTien}}),{tongThuNhap:O,tongKhauTru:V,thucLinh:O-V}},[G,l,C==null?void 0:C.danhSachKhoanLuong]),H=l.size>0;if(E.useEffect(()=>{const I=O=>{if(H)return O.preventDefault(),O.returnValue="Bn c thay i cha lu. Bn c chc mun ri i?",O.returnValue};return window.addEventListener("beforeunload",I),()=>window.removeEventListener("beforeunload",I)},[H]),T)return t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"text-gray-500",children:"ang ti..."})});if(!C)return t.jsxs("div",{className:"text-center py-8",children:[t.jsx("p",{className:"text-gray-500",children:"Khng tm thy bng lng"}),t.jsx("button",{onClick:()=>n("/bang-luong"),className:"btn btn-primary mt-4",children:"Quay li"})]});const F=C.trangThai==="NHAP";return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>n("/bang-luong"),className:"p-2 hover:bg-gray-200 rounded-lg",children:t.jsx($0,{size:20})}),t.jsxs("div",{children:[t.jsxs("h1",{className:"text-xl font-bold text-gray-800",children:["Bng lng ",C.phongBan.tenPhongBan]}),t.jsxs("p",{className:"text-sm text-gray-500",children:["Thng ",C.thang,"/",C.nam]})]}),t.jsxs("span",{className:`badge ${C.trangThai==="NHAP"?"badge-nhap":C.trangThai==="DA_CHOT"?"badge-da-chot":"badge-khoa"}`,children:[C.trangThai==="NHAP"&&"ang nhp",C.trangThai==="DA_CHOT"&&" cht",C.trangThai==="KHOA"&&" kha"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[l.size>0&&t.jsxs("span",{className:"text-sm text-orange-600 mr-2",children:[l.size," thay i cha lu"]}),F&&l.size>0&&t.jsxs("button",{onClick:ae,disabled:_.isPending,className:"btn btn-success",children:[t.jsx(nl,{size:18}),"Lu (",l.size,")"]}),t.jsxs("button",{onClick:J,className:"btn btn-secondary",children:[t.jsx(Xs,{size:18}),"Xut Excel"]}),t.jsxs("button",{onClick:()=>u(!d),className:"btn btn-secondary",children:[t.jsx(fu,{size:18}),"Lch s"]}),t.jsxs("button",{onClick:()=>A.mutate(),disabled:A.isPending,className:"btn btn-secondary",title:"Gi phiu lng cho tt c nhn vin qua email",children:[A.isPending?t.jsx(In,{size:18,className:"animate-spin"}):t.jsx(Qp,{size:18}),"Gi tt c"]}),F&&t.jsxs("button",{onClick:()=>W.mutate(),disabled:W.isPending,className:"btn btn-secondary",title:"Tnh li lng theo ngy cng",children:[W.isPending?t.jsx(In,{size:18,className:"animate-spin"}):t.jsx(Ra,{size:18}),"Tnh li lng"]}),F&&t.jsxs("button",{onClick:()=>m(!0),className:"btn btn-primary",children:[t.jsx(Js,{size:18}),"Cht"]}),C.trangThai==="DA_CHOT"&&t.jsxs("button",{onClick:()=>j.mutate(),className:"btn btn-secondary",children:[t.jsx(Jp,{size:18}),"M kha"]})]})]}),t.jsx("div",{className:"card overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"excel-table w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{className:"sticky left-0 z-20 bg-gray-200",children:"STT"}),t.jsx("th",{className:"sticky left-10 z-20 bg-gray-200 min-w-[80px]",children:"M NV"}),t.jsx("th",{className:"sticky left-[120px] z-20 bg-gray-200 min-w-[180px]",children:"H tn"}),t.jsx("th",{className:"min-w-[120px]",children:"Chc v"}),t.jsx("th",{className:"min-w-[80px] text-center bg-orange-100",children:"Ngy cng"}),t.jsx("th",{className:"min-w-[100px] text-center bg-orange-100",children:"NC iu chnh"}),C.danhSachKhoanLuong.map(I=>t.jsx("th",{className:"min-w-[120px] text-right",children:I.tenKhoan},I.id)),t.jsx("th",{className:"min-w-[130px] text-right bg-blue-100",children:"Tng thu nhp"}),t.jsx("th",{className:"min-w-[100px] text-right bg-red-100",children:"Khu tr"}),t.jsx("th",{className:"min-w-[130px] text-right bg-green-100",children:"Thc lnh"}),t.jsx("th",{className:"min-w-[80px] text-center bg-purple-100",children:"Phiu lng"})]})}),t.jsx("tbody",{children:C.danhSachNhanVien.map((I,O)=>{const V=he(I),te=S==null?void 0:S.find(U=>U.nhanVienId===I.nhanVienId),pe=te!=null&&te.ngayCongDieuChinh?Number(te.ngayCongDieuChinh):te?Number(te.soCongThucTe)+Number(te.soNgayNghiPhep):I.ngayCongThucTe;return t.jsxs("tr",{children:[t.jsx("td",{className:"sticky left-0 bg-white",children:O+1}),t.jsx("td",{className:"sticky left-10 bg-white font-medium",children:I.maNhanVien}),t.jsx("td",{className:"sticky left-[120px] bg-white",children:I.hoTen}),t.jsx("td",{children:I.chucVu||"-"}),t.jsxs("td",{className:"text-center bg-orange-50 relative group",children:[t.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t.jsxs("span",{className:`font-medium ${te!=null&&te.ngayCongDieuChinh?"text-orange-600":""}`,children:[pe.toFixed(1),"/",C.ngayCongLyThuyet]}),F&&t.jsx("button",{onClick:()=>R(I.nhanVienId),className:"opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-orange-200 rounded",title:"Chi tit v iu chnh",children:t.jsx(lj,{className:"w-3 h-3 text-orange-600"})}),(te==null?void 0:te.ngayCongDieuChinh)&&t.jsx("span",{className:"text-xs text-orange-600",title:" iu chnh th cng",children:""})]}),te&&t.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[t.jsxs("span",{className:"text-green-600",children:[Number(te.soNgayNghiPhep).toFixed(1),"P"]}),Number(te.soNgayNghiKhongPhep)>0&&t.jsxs("span",{className:"text-red-600 ml-1",children:[Number(te.soNgayNghiKhongPhep).toFixed(1),"KP"]})]})]}),t.jsx("td",{className:`text-center bg-orange-50 ${F?"cursor-pointer hover:bg-orange-100":""}`,onClick:()=>F&&R(I.nhanVienId),title:F?"Click  iu chnh ngy cng":"",children:te!=null&&te.ngayCongDieuChinh?t.jsx("span",{className:"font-medium text-orange-600",children:Number(te.ngayCongDieuChinh).toFixed(1)}):t.jsx("span",{className:F?"text-blue-500 hover:underline":"text-gray-400",children:F?"Nhp":"-"})}),C.danhSachKhoanLuong.map(U=>{const ce=I.cacKhoanLuong.find(Ke=>Ke.khoanLuongId===U.id),Q=(ce==null?void 0:ce.soTien)||0,oe=G(I.nhanVienId,U.id,Q),X=(r==null?void 0:r.nhanVienId)===I.nhanVienId&&(r==null?void 0:r.khoanLuongId)===U.id,ve=l.has(`${I.nhanVienId}-${U.id}`);return t.jsx("td",{className:`number ${F?"editable":""} ${ve?"bg-yellow-100":""}`,onClick:()=>q(I.nhanVienId,U.id,oe),children:X?t.jsx("input",{type:"text",value:r.value,onChange:Ke=>ee(Ke.target.value),onBlur:z,onKeyDown:fe,className:"cell-input",autoFocus:!0}):Ze(oe)},U.id)}),t.jsx("td",{className:"number font-semibold bg-blue-50",children:Ze(V.tongThuNhap)}),t.jsx("td",{className:"number text-red-600 bg-red-50",children:Ze(V.tongKhauTru)}),t.jsx("td",{className:"number font-bold text-green-600 bg-green-50",children:Ze(V.thucLinh)}),t.jsx("td",{className:"text-center bg-purple-50",children:t.jsx("button",{onClick:()=>g({id:I.nhanVienId,hoTen:I.hoTen}),className:"p-1.5 hover:bg-purple-200 rounded-lg text-purple-600 transition-colors",title:"Xem phiu lng",children:t.jsx(ua,{size:18})})})]},I.nhanVienId)})}),t.jsx("tfoot",{children:t.jsxs("tr",{className:"total-row",children:[t.jsx("td",{colSpan:4,className:"text-right font-bold",children:"TNG CNG"}),t.jsx("td",{className:"bg-orange-100"}),t.jsx("td",{className:"bg-orange-100"}),C.danhSachKhoanLuong.map(I=>{const O=C.danhSachNhanVien.reduce((V,te)=>{const pe=te.cacKhoanLuong.find(U=>U.khoanLuongId===I.id);return V+G(te.nhanVienId,I.id,(pe==null?void 0:pe.soTien)||0)},0);return t.jsx("td",{className:"number font-bold",children:Ze(O)},I.id)}),t.jsx("td",{className:"number font-bold bg-blue-100",children:Ze(C.danhSachNhanVien.reduce((I,O)=>I+he(O).tongThuNhap,0))}),t.jsx("td",{className:"number font-bold text-red-600 bg-red-100",children:Ze(C.danhSachNhanVien.reduce((I,O)=>I+he(O).tongKhauTru,0))}),t.jsx("td",{className:"number font-bold text-green-600 bg-green-100",children:Ze(C.danhSachNhanVien.reduce((I,O)=>I+he(O).thucLinh,0))}),t.jsx("td",{className:"bg-purple-100"})]})})]})})}),d&&t.jsxs("div",{className:"card mt-4",children:[t.jsx("h3",{className:"font-semibold mb-3",children:"Lch s chnh sa"}),k&&k.length>0?t.jsx("div",{className:"max-h-64 overflow-y-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b",children:[t.jsx("th",{className:"text-left py-2",children:"Thi gian"}),t.jsx("th",{className:"text-left py-2",children:"Nhn vin"}),t.jsx("th",{className:"text-left py-2",children:"Khon"}),t.jsx("th",{className:"text-right py-2",children:"C"}),t.jsx("th",{className:"text-right py-2",children:"Mi"}),t.jsx("th",{className:"text-left py-2",children:"Ngi sa"})]})}),t.jsx("tbody",{children:k.map(I=>{var O,V;return t.jsxs("tr",{className:"border-b",children:[t.jsx("td",{className:"py-2",children:new Date(I.ngayThayDoi).toLocaleString("vi-VN")}),t.jsx("td",{className:"py-2",children:(O=I.nhanVien)==null?void 0:O.hoTen}),t.jsx("td",{className:"py-2",children:(V=I.khoanLuong)==null?void 0:V.tenKhoan}),t.jsx("td",{className:"py-2 text-right",children:Ze(I.giaTriCu)}),t.jsx("td",{className:"py-2 text-right font-medium",children:Ze(I.giaTriMoi)}),t.jsx("td",{className:"py-2",children:I.nguoiThayDoi})]},I.id)})})]})}):t.jsx("p",{className:"text-gray-500",children:"Cha c lch s chnh sa"})]}),h&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Cht bng lng"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"Sau khi cht, bng lng s khng th chnh sa. Bn c chc chn?"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngi cht *"}),t.jsx("input",{type:"text",value:f,onChange:I=>p(I.target.value),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp tn ngi cht"})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsxs("button",{onClick:()=>m(!1),className:"btn btn-secondary",children:[t.jsx(hn,{size:18}),"Hy"]}),t.jsxs("button",{onClick:()=>P.mutate({nguoiChot:f}),disabled:!f||P.isPending,className:"btn btn-primary",children:[t.jsx(Lr,{size:18}),"Xc nhn cht"]})]})]})}),b&&t.jsx(q6,{isOpen:!!b,onClose:()=>g(null),bangLuongId:Number(e),nhanVienId:b.id,hoTen:b.hoTen}),y&&t.jsx(W6,{ngayCong:y,onClose:()=>N(null),onSave:M,isLoading:L.isPending})]})}const nw=["Thng 1","Thng 2","Thng 3","Thng 4","Thng 5","Thng 6","Thng 7","Thng 8","Thng 9","Thng 10","Thng 11","Thng 12"],Q6=["Th1","Th2","Th3","Th4","Th5","Th6","Th7","Th8","Th9","Th10","Th11","Th12"],Y6=["CN","T2","T3","T4","T5","T6","T7"];function Ht({value:e,onChange:n,className:a="",placeholder:r="Chn ngy",min:s,max:l,disabled:o=!1}){const[d,u]=E.useState(!1),[h,m]=E.useState(()=>e?new Date(e):new Date),f=E.useRef(null);E.useEffect(()=>{const j=A=>{f.current&&!f.current.contains(A.target)&&u(!1)};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[]);const p=e?new Date(e):null,b=j=>{if(!j)return"";const A=new Date(j);return`${A.getDate().toString().padStart(2,"0")}/${(A.getMonth()+1).toString().padStart(2,"0")}/${A.getFullYear()}`},g=(j,A)=>new Date(j,A+1,0).getDate(),y=(j,A)=>new Date(j,A,1).getDay(),N=()=>{m(j=>new Date(j.getFullYear(),j.getMonth()-1,1))},C=()=>{m(j=>new Date(j.getFullYear(),j.getMonth()+1,1))},T=j=>{const A=new Date(h.getFullYear(),h.getMonth(),j),L=`${A.getFullYear()}-${(A.getMonth()+1).toString().padStart(2,"0")}-${j.toString().padStart(2,"0")}`;n(L),u(!1)},S=j=>{const A=new Date(h.getFullYear(),h.getMonth(),j);return!!(s&&A<new Date(s)||l&&A>new Date(l))},k=j=>{const A=new Date;return h.getFullYear()===A.getFullYear()&&h.getMonth()===A.getMonth()&&j===A.getDate()},_=j=>p?h.getFullYear()===p.getFullYear()&&h.getMonth()===p.getMonth()&&j===p.getDate():!1,P=()=>{const j=h.getFullYear(),A=h.getMonth(),L=g(j,A),W=y(j,A),R=[];for(let M=0;M<W;M++)R.push(null);for(let M=1;M<=L;M++)R.push(M);return t.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[Y6.map(M=>t.jsx("div",{className:"text-center text-xs font-medium text-gray-500 py-1",children:M},M)),R.map((M,q)=>t.jsx("div",{className:"aspect-square",children:M!==null&&t.jsx("button",{type:"button",disabled:S(M),onClick:()=>T(M),className:`
                  w-full h-full rounded-lg text-sm transition-colors
                  ${_(M)?"bg-primary-600 text-white":k(M)?"bg-primary-100 text-primary-700":"hover:bg-gray-100"}
                  ${S(M)?"opacity-50 cursor-not-allowed":""}
                `,children:M})},q))]})};return t.jsxs("div",{ref:f,className:"relative",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",value:b(e),readOnly:!0,onClick:()=>!o&&u(!d),placeholder:r,disabled:o,className:`
            w-full px-3 py-2 pr-10 border rounded-lg cursor-pointer
            focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent
            ${o?"bg-gray-100 cursor-not-allowed":"bg-white"}
            ${a}
          `}),t.jsx(Ot,{size:18,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"})]}),d&&t.jsxs("div",{className:"absolute z-50 mt-1 p-3 bg-white rounded-xl shadow-lg border min-w-[280px]",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("button",{type:"button",onClick:N,className:"p-1 hover:bg-gray-100 rounded-lg",children:t.jsx(Rr,{size:20})}),t.jsxs("span",{className:"font-medium",children:[nw[h.getMonth()]," ",h.getFullYear()]}),t.jsx("button",{type:"button",onClick:C,className:"p-1 hover:bg-gray-100 rounded-lg",children:t.jsx(aa,{size:20})})]}),P(),t.jsxs("div",{className:"flex justify-between mt-3 pt-3 border-t",children:[t.jsx("button",{type:"button",onClick:()=>{n(""),u(!1)},className:"text-sm text-gray-500 hover:text-gray-700",children:"Xa"}),t.jsx("button",{type:"button",onClick:()=>{const j=new Date,A=`${j.getFullYear()}-${(j.getMonth()+1).toString().padStart(2,"0")}-${j.getDate().toString().padStart(2,"0")}`;n(A),u(!1)},className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Hm nay"})]})]})]})}function wc({value:e,onChange:n,className:a="",placeholder:r="Chn thng",disabled:s=!1}){const[l,o]=E.useState(!1),[d,u]=E.useState(()=>e?parseInt(e.split("-")[0]):new Date().getFullYear()),h=E.useRef(null);E.useEffect(()=>{const g=y=>{h.current&&!h.current.contains(y.target)&&o(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]);const m=g=>{if(!g)return"";const[y,N]=g.split("-");return`${nw[parseInt(N)-1]} ${y}`},f=g=>{const y=`${d}-${(g+1).toString().padStart(2,"0")}`;n(y),o(!1)},p=g=>{if(!e)return!1;const[y,N]=e.split("-");return parseInt(y)===d&&parseInt(N)===g+1},b=g=>{const y=new Date;return d===y.getFullYear()&&g===y.getMonth()};return t.jsxs("div",{ref:h,className:"relative",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",value:m(e),readOnly:!0,onClick:()=>!s&&o(!l),placeholder:r,disabled:s,className:`
            w-full px-3 py-2 pr-10 border rounded-lg cursor-pointer
            focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent
            ${s?"bg-gray-100 cursor-not-allowed":"bg-white"}
            ${a}
          `}),t.jsx(Ot,{size:18,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"})]}),l&&t.jsxs("div",{className:"absolute z-50 mt-1 p-3 bg-white rounded-xl shadow-lg border min-w-[280px]",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("button",{type:"button",onClick:()=>u(g=>g-1),className:"p-1 hover:bg-gray-100 rounded-lg",children:t.jsx(Rr,{size:20})}),t.jsx("span",{className:"font-medium text-lg",children:d}),t.jsx("button",{type:"button",onClick:()=>u(g=>g+1),className:"p-1 hover:bg-gray-100 rounded-lg",children:t.jsx(aa,{size:20})})]}),t.jsx("div",{className:"grid grid-cols-4 gap-2",children:Q6.map((g,y)=>t.jsx("button",{type:"button",onClick:()=>f(y),className:`
                  py-2 px-1 rounded-lg text-sm transition-colors
                  ${p(y)?"bg-primary-600 text-white":b(y)?"bg-primary-100 text-primary-700":"hover:bg-gray-100"}
                `,children:g},g))}),t.jsxs("div",{className:"flex justify-between mt-3 pt-3 border-t",children:[t.jsx("button",{type:"button",onClick:()=>{n(""),o(!1)},className:"text-sm text-gray-500 hover:text-gray-700",children:"Xa"}),t.jsx("button",{type:"button",onClick:()=>{const g=new Date,y=`${g.getFullYear()}-${(g.getMonth()+1).toString().padStart(2,"0")}`;n(y),o(!1)},className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Thng ny"})]})]})]})}const Ab={DANG_LAM:{label:"ang lm",color:"bg-green-100 text-green-700"},NGHI_VIEC:{label:" ngh",color:"bg-red-100 text-red-700"},TAM_NGHI:{label:"Tm ngh",color:"bg-yellow-100 text-yellow-700"}};function J6(){const e=Rt(),[n,a]=E.useState(!1),[r,s]=E.useState(),[l,o]=E.useState(""),[d,u]=E.useState(""),[h,m]=E.useState({maNhanVien:"",hoTen:"",email:"",soDienThoai:"",phongBanId:0,chucVu:"",ngayVaoLam:"",gioiTinh:"",ngaySinh:"",diaChi:"",trangThai:"DANG_LAM"}),{data:f,isLoading:p}=Ie({queryKey:["nhan-vien",r,l,d],queryFn:()=>Oa.layTatCa({phongBanId:r,tuKhoa:d,trangThai:l||void 0})}),b=Array.isArray(f)?f:(f==null?void 0:f.data)||[],{data:g}=Ie({queryKey:["phong-ban"],queryFn:ln.layTatCa}),y=De({mutationFn:Oa.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["nhan-vien"]}),le.success("To nhn vin thnh cng!"),T()},onError:j=>{var A,L;le.error(((L=(A=j.response)==null?void 0:A.data)==null?void 0:L.message)||"C li xy ra")}}),N=De({mutationFn:({id:j,data:A})=>Oa.capNhat(j,A),onSuccess:()=>{e.invalidateQueries({queryKey:["nhan-vien"]}),le.success("Cp nht thnh cng!"),T()},onError:j=>{var A,L;le.error(((L=(A=j.response)==null?void 0:A.data)==null?void 0:L.message)||"C li xy ra")}}),C=De({mutationFn:Oa.xoa,onSuccess:()=>{e.invalidateQueries({queryKey:["nhan-vien"]}),le.success("Xa nhn vin thnh cng!")},onError:j=>{var A,L;le.error(((L=(A=j.response)==null?void 0:A.data)==null?void 0:L.message)||"C li xy ra")}}),T=()=>{a(!1),m({maNhanVien:"",hoTen:"",email:"",soDienThoai:"",phongBanId:0,chucVu:"",ngayVaoLam:"",gioiTinh:"",ngaySinh:"",diaChi:"",trangThai:"DANG_LAM"})},S=async()=>{try{const{maNhanVien:j}=await Oa.layMaTuDong();m(A=>({...A,maNhanVien:j})),a(!0)}catch{a(!0)}},k=j=>{confirm(`Khi phc nhn vin "${j.hoTen}" v trng thi ang lm?`)&&N.mutate({id:j.id,data:{trangThai:"DANG_LAM"}})},_=()=>{if(!h.maNhanVien||!h.hoTen||!h.phongBanId){le.error("Vui lng in y  thng tin bt buc");return}y.mutate(h)},P=j=>{confirm(`Bn c chc mun xa nhn vin "${j.hoTen}"?`)&&C.mutate(j.id)};return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[t.jsx(on,{size:28}),"Qun l Nhn vin"]}),t.jsxs("button",{onClick:S,className:"btn btn-primary",children:[t.jsx(St,{size:20}),"Thm nhn vin"]})]}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx("div",{className:"flex-1",children:t.jsxs("div",{className:"relative",children:[t.jsx(Ss,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),t.jsx("input",{type:"text",value:d,onChange:j=>u(j.target.value),placeholder:"Tm kim theo tn, m NV, email...",className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]})}),t.jsx("div",{children:t.jsxs("select",{value:r||"",onChange:j=>s(j.target.value?Number(j.target.value):void 0),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),g==null?void 0:g.map(j=>t.jsx("option",{value:j.id,children:j.tenPhongBan},j.id))]})}),t.jsx("div",{children:t.jsxs("select",{value:l,onChange:j=>o(j.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c trng thi"}),t.jsx("option",{value:"DANG_LAM",children:"ang lm"}),t.jsx("option",{value:"NGHI_VIEC",children:" ngh"}),t.jsx("option",{value:"TAM_NGHI",children:"Tm ngh"})]})})]})}),t.jsx("div",{className:"card",children:p?t.jsx("p",{className:"text-center py-8 text-gray-500",children:"ang ti..."}):b&&b.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"M NV"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"H tn"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Phng ban"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Chc v"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Email"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Ngy vo lm"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Trng thi"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Thao tc"})]})}),t.jsx("tbody",{children:b.map(j=>{var A,L,W;return t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4 font-medium",children:j.maNhanVien}),t.jsx("td",{className:"py-3 px-4",children:j.hoTen}),t.jsx("td",{className:"py-3 px-4",children:(A=j.phongBan)==null?void 0:A.tenPhongBan}),t.jsx("td",{className:"py-3 px-4",children:j.chucVu||"-"}),t.jsx("td",{className:"py-3 px-4",children:j.email||"-"}),t.jsx("td",{className:"py-3 px-4 text-center",children:j.ngayVaoLam?new Date(j.ngayVaoLam).toLocaleDateString("vi-VN"):"-"}),t.jsx("td",{className:"py-3 px-4 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${((L=Ab[j.trangThai])==null?void 0:L.color)||"bg-gray-100"}`,children:((W=Ab[j.trangThai])==null?void 0:W.label)||j.trangThai})}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsxs(ca,{to:`/nhan-vien/${j.id}`,className:"px-3 py-1.5 text-xs bg-blue-100 text-blue-700 hover:bg-blue-200 rounded flex items-center gap-1 font-medium",title:"Xem & chnh sa thng tin nhn vin",children:[t.jsx(Or,{size:14}),"Chi tit"]}),j.trangThai==="NGHI_VIEC"?t.jsx("button",{onClick:()=>k(j),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg",title:"Khi phc",children:t.jsx(Yp,{size:18})}):t.jsx("button",{onClick:()=>P(j),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Cho ngh vic",children:t.jsx(Ir,{size:18})})]})})]},j.id)})})]})}):t.jsx("p",{className:"text-center py-8 text-gray-500",children:"Cha c nhn vin no"})}),n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-lg",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Thm nhn vin mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M nhn vin *"}),t.jsx("input",{type:"text",value:h.maNhanVien,onChange:j=>m({...h,maNhanVien:j.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"H tn *"}),t.jsx("input",{type:"text",value:h.hoTen,onChange:j=>m({...h,hoTen:j.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phng ban *"}),t.jsxs("select",{value:h.phongBanId,onChange:j=>m({...h,phongBanId:Number(j.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn phng ban --"}),g==null?void 0:g.map(j=>t.jsx("option",{value:j.id,children:j.tenPhongBan},j.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chc v"}),t.jsx("input",{type:"text",value:h.chucVu,onChange:j=>m({...h,chucVu:j.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gii tnh"}),t.jsxs("select",{value:h.gioiTinh,onChange:j=>m({...h,gioiTinh:j.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn --"}),t.jsx("option",{value:"NAM",children:"Nam"}),t.jsx("option",{value:"NU",children:"N"}),t.jsx("option",{value:"KHAC",children:"Khc"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy sinh"}),t.jsx(Ht,{value:h.ngaySinh,onChange:j=>m({...h,ngaySinh:j}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),t.jsx("input",{type:"email",value:h.email,onChange:j=>m({...h,email:j.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S in thoi"}),t.jsx("input",{type:"text",value:h.soDienThoai,onChange:j=>m({...h,soDienThoai:j.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"a ch"}),t.jsx("input",{type:"text",value:h.diaChi,onChange:j=>m({...h,diaChi:j.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp a ch..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy vo lm"}),t.jsx(Ht,{value:h.ngayVaoLam,onChange:j=>m({...h,ngayVaoLam:j}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:T,className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:_,disabled:y.isPending||N.isPending,className:"btn btn-primary",children:y.isPending||N.isPending?"ang lu...":"Lu"})]})]})})]})}const Z6=async e=>(await me.get(`/nhan-vien/${e}/hop-dong`)).data,eD=async(e,n)=>(await me.post(`/nhan-vien/${e}/hop-dong`,n)).data,tD=async(e,n)=>(await me.put(`/nhan-vien/hop-dong/${e}`,n)).data,nD=async(e,n)=>(await me.post(`/nhan-vien/hop-dong/${e}/ngung`,n)).data,aD=async e=>{await me.delete(`/nhan-vien/hop-dong/${e}`)},rD=async e=>(await me.get(`/nhan-vien/${e}/ngan-hang`)).data,sD=async(e,n)=>(await me.post(`/nhan-vien/${e}/ngan-hang`,n)).data,iD=async(e,n)=>(await me.put(`/nhan-vien/ngan-hang/${e}`,n)).data,lD=async e=>(await me.post(`/nhan-vien/ngan-hang/${e}/dat-mac-dinh`)).data,oD=async e=>{await me.delete(`/nhan-vien/ngan-hang/${e}`)},aw=async()=>(await me.get("/nhom-nhan-vien")).data,cD=async e=>(await me.post("/nhom-nhan-vien",e)).data,dD=async(e,n)=>(await me.put(`/nhom-nhan-vien/${e}`,n)).data,uD=async e=>{await me.delete(`/nhom-nhan-vien/${e}`)},Pb={THU_VIEC:"Th vic",MOT_NAM:"1 nm",BA_NAM:"3 nm",VO_THOI_HAN:"V thi hn"},hD={HIEU_LUC:"Hiu lc",HET_HAN:"Ht hn",HUY_BO:"Hy b"},xD=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e);function mD({nhanVienId:e}){const n=Rt(),[a,r]=E.useState(!1),[s,l]=E.useState(null),[o,d]=E.useState(null),[u,h]=E.useState({loaiHopDong:"VO_THOI_HAN",tuNgay:new Date().toISOString().split("T")[0],denNgay:"",luongCoBan:0,luongDongBH:0,heSoLuong:1,ghiChu:""}),[m,f]=E.useState({ngayKetThuc:new Date().toISOString().split("T")[0],lyDo:""}),{data:p,isLoading:b}=Ie({queryKey:["hop-dong",e],queryFn:()=>Z6(e)}),g=De({mutationFn:P=>eD(e,{...P,denNgay:P.denNgay||void 0}),onSuccess:()=>{le.success("To hp ng thnh cng"),n.invalidateQueries({queryKey:["hop-dong",e]}),r(!1),T()},onError:P=>{var j,A;le.error(((A=(j=P.response)==null?void 0:j.data)==null?void 0:A.message)||"Li to hp ng")}}),y=De({mutationFn:({id:P,data:j})=>tD(P,j),onSuccess:()=>{le.success("Cp nht hp ng thnh cng"),n.invalidateQueries({queryKey:["hop-dong",e]}),l(null),T()},onError:P=>{var j,A;le.error(((A=(j=P.response)==null?void 0:j.data)==null?void 0:A.message)||"Li cp nht")}}),N=De({mutationFn:({id:P,data:j})=>nD(P,j),onSuccess:()=>{le.success(" ngng hp ng"),n.invalidateQueries({queryKey:["hop-dong",e]}),d(null)},onError:P=>{var j,A;le.error(((A=(j=P.response)==null?void 0:j.data)==null?void 0:A.message)||"Li ngng hp ng")}}),C=De({mutationFn:aD,onSuccess:()=>{le.success(" xa hp ng"),n.invalidateQueries({queryKey:["hop-dong",e]})},onError:P=>{var j,A;le.error(((A=(j=P.response)==null?void 0:j.data)==null?void 0:A.message)||"Li xa")}}),T=()=>{h({loaiHopDong:"VO_THOI_HAN",tuNgay:new Date().toISOString().split("T")[0],denNgay:"",luongCoBan:0,luongDongBH:0,heSoLuong:1,ghiChu:""})},S=P=>{var j;h({loaiHopDong:P.loaiHopDong,tuNgay:P.tuNgay.split("T")[0],denNgay:((j=P.denNgay)==null?void 0:j.split("T")[0])||"",luongCoBan:Number(P.luongCoBan),luongDongBH:Number(P.luongDongBH||0),heSoLuong:Number(P.heSoLuong||1),ghiChu:P.ghiChu||""}),l(P.id),r(!0)},k=P=>{P.preventDefault(),s?y.mutate({id:s,data:u}):g.mutate(u)},_=P=>{P.preventDefault(),o&&N.mutate({id:o,data:m})};return b?t.jsx("div",{className:"p-4 text-center",children:"ang ti..."}):t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Lch s Hp ng / Lng"}),t.jsxs("button",{onClick:()=>{r(!0),l(null),T()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[t.jsx("span",{children:"+"})," Thm hp ng"]})]}),a&&t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[t.jsx("h4",{className:"font-medium mb-3",children:s?"Sa hp ng":"To hp ng mi"}),t.jsxs("form",{onSubmit:k,className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi hp ng"}),t.jsx("select",{value:u.loaiHopDong,onChange:P=>h({...u,loaiHopDong:P.target.value}),className:"w-full border rounded-lg px-3 py-2",children:Object.entries(Pb).map(([P,j])=>t.jsx("option",{value:P,children:j},P))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lng c bn"}),t.jsx("input",{type:"number",value:u.luongCoBan,onChange:P=>h({...u,luongCoBan:Number(P.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0,required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"T ngy"}),t.jsx(Ht,{value:u.tuNgay,onChange:P=>h({...u,tuNgay:P}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"n ngy ( trng nu v thi hn)"}),t.jsx(Ht,{value:u.denNgay,onChange:P=>h({...u,denNgay:P}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lng ng BH"}),t.jsx("input",{type:"number",value:u.luongDongBH,onChange:P=>h({...u,luongDongBH:Number(P.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"H s lng"}),t.jsx("input",{type:"number",step:"0.01",value:u.heSoLuong,onChange:P=>h({...u,heSoLuong:Number(P.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ghi ch"}),t.jsx("textarea",{value:u.ghiChu,onChange:P=>h({...u,ghiChu:P.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),t.jsxs("div",{className:"col-span-2 flex gap-2",children:[t.jsx("button",{type:"submit",disabled:g.isPending||y.isPending,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:s?"Cp nht":"To mi"}),t.jsx("button",{type:"button",onClick:()=>{r(!1),l(null)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Hy"})]})]})]}),o&&t.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[t.jsx("h4",{className:"font-medium mb-3 text-yellow-800",children:"Ngng hp ng sm"}),t.jsxs("form",{onSubmit:_,className:"flex gap-4 items-end",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy kt thc"}),t.jsx(Ht,{value:m.ngayKetThuc,onChange:P=>f({...m,ngayKetThuc:P}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"L do"}),t.jsx("input",{type:"text",value:m.lyDo,onChange:P=>f({...m,lyDo:P.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp l do..."})]}),t.jsx("button",{type:"submit",disabled:N.isPending,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:opacity-50",children:"Xc nhn"}),t.jsx("button",{type:"button",onClick:()=>d(null),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Hy"})]})]}),t.jsx("div",{className:"relative",children:(p==null?void 0:p.length)===0?t.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:"Cha c hp ng no"}):t.jsx("div",{className:"space-y-4",children:p==null?void 0:p.map((P,j)=>t.jsxs("div",{className:`relative pl-8 pb-4 ${j<((p==null?void 0:p.length)||0)-1?"border-l-2 border-gray-200":""}`,children:[t.jsx("div",{className:`absolute left-[-5px] w-3 h-3 rounded-full ${P.trangThai==="HIEU_LUC"?"bg-green-500":"bg-gray-400"}`}),t.jsxs("div",{className:`bg-white rounded-lg shadow p-4 ${P.trangThai==="HIEU_LUC"?"border-l-4 border-green-500":""}`,children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-semibold",children:Pb[P.loaiHopDong]}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${P.trangThai==="HIEU_LUC"?"bg-green-100 text-green-800":P.trangThai==="HET_HAN"?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"}`,children:hD[P.trangThai]})]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[new Date(P.tuNgay).toLocaleDateString("vi-VN"),"  ",P.denNgay?new Date(P.denNgay).toLocaleDateString("vi-VN"):"V thi hn"]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-lg font-bold text-blue-600",children:xD(Number(P.luongCoBan))}),P.heSoLuong&&t.jsxs("div",{className:"text-xs text-gray-500",children:["H s: ",P.heSoLuong]})]})]}),P.ghiChu&&t.jsx("div",{className:"text-sm text-gray-500 mt-2 italic",children:P.ghiChu}),t.jsxs("div",{className:"flex gap-2 mt-3",children:[t.jsx("button",{onClick:()=>S(P),className:"text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100",children:"Sa"}),P.trangThai==="HIEU_LUC"&&t.jsx("button",{onClick:()=>d(P.id),className:"text-xs px-2 py-1 bg-yellow-50 text-yellow-600 rounded hover:bg-yellow-100",children:"Ngng sm"}),t.jsx("button",{onClick:()=>{confirm("Xc nhn xa hp ng ny?")&&C.mutate(P.id)},className:"text-xs px-2 py-1 bg-red-50 text-red-600 rounded hover:bg-red-100",children:"Xa"})]})]})]},P.id))})})]})}const Lb=[{code:"VCB",name:"Vietcombank"},{code:"TCB",name:"Techcombank"},{code:"BIDV",name:"BIDV"},{code:"VTB",name:"Vietinbank"},{code:"ACB",name:"ACB"},{code:"MBB",name:"MB Bank"},{code:"VPB",name:"VPBank"},{code:"TPB",name:"TPBank"},{code:"STB",name:"Sacombank"},{code:"SHB",name:"SHB"},{code:"MSB",name:"MSB"},{code:"OCB",name:"OCB"},{code:"HDB",name:"HDBank"},{code:"SCB",name:"SCB"},{code:"EIB",name:"Eximbank"},{code:"AGRI",name:"Agribank"},{code:"KHAC",name:"Khc"}];function fD({nhanVienId:e}){const n=Rt(),[a,r]=E.useState(!1),[s,l]=E.useState(null),[o,d]=E.useState({tenNganHang:"VCB",chiNhanh:"",soTaiKhoan:"",chuTaiKhoan:"",laMacDinh:!1,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""}),{data:u,isLoading:h}=Ie({queryKey:["ngan-hang",e],queryFn:()=>rD(e)}),m=De({mutationFn:T=>sD(e,{...T,denNgay:T.denNgay||void 0}),onSuccess:()=>{le.success("Thm ti khon ngn hng thnh cng"),n.invalidateQueries({queryKey:["ngan-hang",e]}),r(!1),g()},onError:T=>{var S,k;le.error(((k=(S=T.response)==null?void 0:S.data)==null?void 0:k.message)||"Li thm ti khon")}}),f=De({mutationFn:({id:T,data:S})=>iD(T,S),onSuccess:()=>{le.success("Cp nht ti khon thnh cng"),n.invalidateQueries({queryKey:["ngan-hang",e]}),l(null),r(!1),g()},onError:T=>{var S,k;le.error(((k=(S=T.response)==null?void 0:S.data)==null?void 0:k.message)||"Li cp nht")}}),p=De({mutationFn:oD,onSuccess:()=>{le.success(" xa ti khon"),n.invalidateQueries({queryKey:["ngan-hang",e]})},onError:T=>{var S,k;le.error(((k=(S=T.response)==null?void 0:S.data)==null?void 0:k.message)||"Li xa")}}),b=De({mutationFn:lD,onSuccess:()=>{le.success(" t lm mc nh"),n.invalidateQueries({queryKey:["ngan-hang",e]})},onError:T=>{var S,k;le.error(((k=(S=T.response)==null?void 0:S.data)==null?void 0:k.message)||"Li")}}),g=()=>{d({tenNganHang:"VCB",chiNhanh:"",soTaiKhoan:"",chuTaiKhoan:"",laMacDinh:!1,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""})},y=T=>{var S,k;d({tenNganHang:T.tenNganHang,chiNhanh:T.chiNhanh||"",soTaiKhoan:T.soTaiKhoan,chuTaiKhoan:T.chuTaiKhoan,laMacDinh:T.laMacDinh,tuNgay:((S=T.tuNgay)==null?void 0:S.split("T")[0])||"",denNgay:((k=T.denNgay)==null?void 0:k.split("T")[0])||"",ghiChu:T.ghiChu||""}),l(T.id),r(!0)},N=T=>{T.preventDefault(),s?f.mutate({id:s,data:o}):m.mutate(o)},C=T=>{const S=Lb.find(k=>k.code===T);return S?S.name:T};return h?t.jsx("div",{className:"p-4 text-center",children:"ang ti..."}):t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Ti khon Ngn hng"}),t.jsxs("button",{onClick:()=>{r(!0),l(null),g()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[t.jsx("span",{children:"+"})," Thm ti khon"]})]}),a&&t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[t.jsx("h4",{className:"font-medium mb-3",children:s?"Sa ti khon":"Thm ti khon mi"}),t.jsxs("form",{onSubmit:N,className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngn hng"}),t.jsx("select",{value:o.tenNganHang,onChange:T=>d({...o,tenNganHang:T.target.value}),className:"w-full border rounded-lg px-3 py-2",children:Lb.map(T=>t.jsx("option",{value:T.code,children:T.name},T.code))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chi nhnh"}),t.jsx("input",{type:"text",value:o.chiNhanh,onChange:T=>d({...o,chiNhanh:T.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: H Ni, TP.HCM..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S ti khon *"}),t.jsx("input",{type:"text",value:o.soTaiKhoan,onChange:T=>d({...o,soTaiKhoan:T.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp s ti khon",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ch ti khon *"}),t.jsx("input",{type:"text",value:o.chuTaiKhoan,onChange:T=>d({...o,chuTaiKhoan:T.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"NGUYEN VAN A",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hiu lc t"}),t.jsx(Ht,{value:o.tuNgay,onChange:T=>d({...o,tuNgay:T}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hiu lc n"}),t.jsx(Ht,{value:o.denNgay,onChange:T=>d({...o,denNgay:T}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ghi ch"}),t.jsx("input",{type:"text",value:o.ghiChu,onChange:T=>d({...o,ghiChu:T.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ti khon nhn lng, ti khon ph..."})]}),t.jsx("div",{className:"col-span-2",children:t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:o.laMacDinh,onChange:T=>d({...o,laMacDinh:T.target.checked}),className:"w-4 h-4 rounded"}),t.jsx("span",{className:"text-sm",children:"t lm ti khon mc nh"})]})}),t.jsxs("div",{className:"col-span-2 flex gap-2",children:[t.jsx("button",{type:"submit",disabled:m.isPending||f.isPending,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:s?"Cp nht":"Thm"}),t.jsx("button",{type:"button",onClick:()=>{r(!1),l(null)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Hy"})]})]})]}),t.jsx("div",{className:"grid gap-4",children:(u==null?void 0:u.length)===0?t.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:"Cha c ti khon ngn hng no"}):u==null?void 0:u.map(T=>t.jsxs("div",{className:`bg-white rounded-lg shadow p-4 ${T.laMacDinh?"border-l-4 border-green-500":""}`,children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 font-bold text-sm",children:T.tenNganHang.slice(0,3)}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-semibold",children:C(T.tenNganHang)}),T.chiNhanh&&t.jsxs("span",{className:"text-sm text-gray-500",children:["- ",T.chiNhanh]}),T.laMacDinh&&t.jsx("span",{className:"text-xs px-2 py-0.5 bg-green-100 text-green-800 rounded-full",children:"Mc nh"})]}),t.jsx("div",{className:"text-lg font-mono text-gray-800",children:T.soTaiKhoan}),t.jsx("div",{className:"text-sm text-gray-500",children:T.chuTaiKhoan})]})]}),t.jsxs("div",{className:"flex flex-col items-end gap-2",children:[T.tuNgay&&t.jsxs("div",{className:"text-xs text-gray-400",children:[new Date(T.tuNgay).toLocaleDateString("vi-VN"),T.denNgay&&`  ${new Date(T.denNgay).toLocaleDateString("vi-VN")}`]}),t.jsxs("div",{className:"flex gap-2",children:[!T.laMacDinh&&t.jsx("button",{onClick:()=>b.mutate(T.id),className:"text-xs px-2 py-1 bg-green-50 text-green-600 rounded hover:bg-green-100",children:"t mc nh"}),t.jsx("button",{onClick:()=>y(T),className:"text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100",children:"Sa"}),t.jsx("button",{onClick:()=>{confirm("Xc nhn xa ti khon ny?")&&p.mutate(T.id)},className:"text-xs px-2 py-1 bg-red-50 text-red-600 rounded hover:bg-red-100",children:"Xa"})]})]})]}),T.ghiChu&&t.jsx("div",{className:"text-sm text-gray-500 mt-2 italic",children:T.ghiChu})]},T.id))})]})}function pD({nhanVienId:e}){const n=Rt(),[a,r]=E.useState(null),{data:s,isLoading:l}=Ie({queryKey:["nhan-vien-nhom",e],queryFn:async()=>(await me.get(`/nhan-vien/${e}/nhom`)).data}),{data:o}=Ie({queryKey:["nhom-nhan-vien"],queryFn:()=>aw()}),d=o==null?void 0:o.filter(p=>!(s!=null&&s.some(b=>b.nhom.id===p.id))),u=De({mutationFn:async p=>me.post(`/nhan-vien/${e}/them-vao-nhom`,{nhomId:p,tuNgay:new Date().toISOString().split("T")[0]}),onSuccess:()=>{le.success(" thm vo nhm"),n.invalidateQueries({queryKey:["nhan-vien-nhom",e]}),r(null)},onError:p=>{var b,g;le.error(((g=(b=p.response)==null?void 0:b.data)==null?void 0:g.message)||"Li thm vo nhm")}}),h=De({mutationFn:async p=>me.post(`/nhan-vien/${e}/go-khoi-nhom`,{nhomId:p,denNgay:new Date().toISOString().split("T")[0]}),onSuccess:()=>{le.success(" g khi nhm"),n.invalidateQueries({queryKey:["nhan-vien-nhom",e]})},onError:p=>{var b,g;le.error(((g=(b=p.response)==null?void 0:b.data)==null?void 0:g.message)||"Li g khi nhm")}}),m=()=>{a&&u.mutate(a)},f=p=>{confirm("Xc nhn g khi nhm?")&&h.mutate(p)};return l?t.jsx("div",{className:"p-4 text-center",children:"ang ti..."}):t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"flex justify-between items-center",children:t.jsx("h3",{className:"text-lg font-semibold",children:"Nhm Nhn vin"})}),d&&d.length>0&&t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[t.jsx("h4",{className:"font-medium mb-3",children:"Thm vo nhm"}),t.jsxs("div",{className:"flex gap-2 items-center",children:[t.jsxs("select",{value:a||"",onChange:p=>r(Number(p.target.value)),className:"flex-1 border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn nhm --"}),d.map(p=>t.jsxs("option",{value:p.id,children:[p.tenNhom," ",p.moTa&&`(${p.moTa})`]},p.id))]}),t.jsx("button",{onClick:m,disabled:!a,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:"Thm"})]})]}),t.jsx("div",{className:"grid gap-3",children:(s==null?void 0:s.length)===0?t.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:"Nhn vin cha thuc nhm no"}):s==null?void 0:s.map(p=>t.jsxs("div",{className:"bg-white rounded-lg shadow p-4 flex justify-between items-center",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-white font-bold",style:{backgroundColor:p.nhom.mauSac||"#6B7280"},children:p.nhom.tenNhom.charAt(0).toUpperCase()}),t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold",children:p.nhom.tenNhom}),p.nhom.moTa&&t.jsx("div",{className:"text-sm text-gray-500",children:p.nhom.moTa}),t.jsxs("div",{className:"text-xs text-gray-400",children:["T ",new Date(p.tuNgay).toLocaleDateString("vi-VN"),p.denNgay&&` n ${new Date(p.denNgay).toLocaleDateString("vi-VN")}`]})]})]}),t.jsx("button",{onClick:()=>f(p.nhom.id),className:"text-xs px-3 py-1 bg-red-50 text-red-600 rounded hover:bg-red-100",children:"G khi nhm"})]},p.id))}),t.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-sm text-gray-600",children:[t.jsx("strong",{children:"Lu :"})," Nhm nhn vin c s dng trong Rule Engine  p dng cc quy tc tnh lng cho tng nhm ring bit (VD: nhm Qun l, nhm K thut, nhm Sales...)."]})]})}const gD=({nhanVienId:e})=>{const[n,a]=E.useState(null),[r,s]=E.useState(!0),[l,o]=E.useState(!1),[d,u]=E.useState(!1),[h,m]=E.useState({mstCaNhan:"",soCmndCccd:"",ngayCap:"",noiCap:"",soNguoiPhuThuoc:0,ghiChu:""}),f=async()=>{try{s(!0);const N=(await me.get(`/nhan-vien/${e}/thue-bh`)).data;a(N),N&&m({mstCaNhan:N.mstCaNhan||"",soCmndCccd:N.soCmndCccd||"",ngayCap:N.ngayCap?N.ngayCap.split("T")[0]:"",noiCap:N.noiCap||"",soNguoiPhuThuoc:N.soNguoiPhuThuoc||0,ghiChu:N.ghiChu||""})}catch(y){console.error("Li khi ti thng tin thu/BHXH:",y)}finally{s(!1)}};E.useEffect(()=>{f()},[e]);const p=y=>{const{name:N,value:C}=y.target;m(T=>({...T,[N]:N==="soNguoiPhuThuoc"?parseInt(C)||0:C}))},b=async()=>{try{o(!0),await me.post(`/nhan-vien/${e}/thue-bh`,h),await f(),u(!1)}catch(y){console.error("Li khi lu thng tin thu/BHXH:",y),alert("C li xy ra khi lu thng tin")}finally{o(!1)}},g=()=>{m(n?{mstCaNhan:n.mstCaNhan||"",soCmndCccd:n.soCmndCccd||"",ngayCap:n.ngayCap?n.ngayCap.split("T")[0]:"",noiCap:n.noiCap||"",soNguoiPhuThuoc:n.soNguoiPhuThuoc||0,ghiChu:n.ghiChu||""}:{mstCaNhan:"",soCmndCccd:"",ngayCap:"",noiCap:"",soNguoiPhuThuoc:0,ghiChu:""}),u(!1)};return r?t.jsx("div",{className:"flex justify-center items-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Thng tin Thu & BHXH"}),d?t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:g,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:b,disabled:l,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:l?"ang lu...":"Lu"})]}):t.jsx("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:n?"Chnh sa":"Thm thng tin"})]}),t.jsxs("div",{className:"bg-white border rounded-lg p-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S CMND/CCCD"}),d?t.jsx("input",{type:"text",name:"soCmndCccd",value:h.soCmndCccd,onChange:p,placeholder:"Nhp s CMND/CCCD",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:(n==null?void 0:n.soCmndCccd)||""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy cp"}),d?t.jsx(Ht,{value:h.ngayCap,onChange:y=>m(N=>({...N,ngayCap:y})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:n!=null&&n.ngayCap?new Date(n.ngayCap).toLocaleDateString("vi-VN"):""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ni cp"}),d?t.jsx("input",{type:"text",name:"noiCap",value:h.noiCap,onChange:p,placeholder:"Nhp ni cp",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:(n==null?void 0:n.noiCap)||""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M s thu c nhn"}),d?t.jsx("input",{type:"text",name:"mstCaNhan",value:h.mstCaNhan,onChange:p,placeholder:"Nhp m s thu",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:(n==null?void 0:n.mstCaNhan)||""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S ngi ph thuc"}),d?t.jsx("input",{type:"number",name:"soNguoiPhuThuoc",min:"0",value:h.soNguoiPhuThuoc,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsxs("p",{className:"text-gray-900",children:[(n==null?void 0:n.soNguoiPhuThuoc)??0," ngi"]})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),d?t.jsx("textarea",{name:"ghiChu",value:h.ghiChu,onChange:p,rows:3,placeholder:"Nhp ghi ch (nu c)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:(n==null?void 0:n.ghiChu)||""})]})]}),t.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[t.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:" Thng tin gim tr thu TNCN"}),t.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[t.jsx("p",{children:" Gim tr bn thn: 11.000.000 /thng"}),t.jsx("p",{children:" Gim tr ngi ph thuc: 4.400.000 /ngi/thng"}),t.jsx("p",{children:t.jsxs("strong",{children:["Tng gim tr: ",(11e6+(h.soNguoiPhuThuoc||0)*44e5).toLocaleString("vi-VN")," /thng"]})})]})]})]}),n&&t.jsxs("div",{className:"text-sm text-gray-500",children:["Cp nht ln cui: ",new Date().toLocaleDateString("vi-VN")]})]})};function yD({nhanVienId:e}){var l;const{data:n,isLoading:a}=Ie({queryKey:["lich-su-phong-ban",e],queryFn:()=>Oa.layLichSuPhongBan(e)});if(a)return t.jsxs("div",{className:"card animate-pulse",children:[t.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-4"}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"h-16 bg-gray-200 rounded"}),t.jsx("div",{className:"h-16 bg-gray-200 rounded"})]})]});const r=n==null?void 0:n.find(o=>!o.denNgay),s=(n==null?void 0:n.filter(o=>o.denNgay))||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"card border-l-4 border-l-green-500",children:[t.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2 text-lg",children:[t.jsx(Fr,{className:"text-green-600",size:20}),"Phng ban hin ti"]}),r?t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:t.jsx(Fr,{className:"text-green-600",size:24})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium text-gray-900 text-lg",children:((l=r.phongBan)==null?void 0:l.tenPhongBan)||"N/A"}),r.donViCon&&t.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1 mt-1",children:[t.jsx(on,{size:14}),r.donViCon.loaiDonVi,": ",r.donViCon.tenDonVi]}),t.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1 mt-2",children:[t.jsx(Ot,{size:14}),"T: ",ys(r.tuNgay)]}),r.ghiChu&&t.jsx("div",{className:"text-sm text-gray-500 mt-2 italic",children:r.ghiChu})]}),t.jsx("div",{className:"px-3 py-1 rounded-full bg-green-100 text-green-700 text-sm font-medium",children:"ang lm vic"})]}):t.jsxs("div",{className:"text-center text-gray-500 py-4",children:[t.jsx(qd,{size:40,className:"mx-auto text-gray-300 mb-2"}),t.jsx("p",{children:"Cha c thng tin phng ban"})]})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2 text-lg",children:[t.jsx(nn,{className:"text-gray-600",size:20}),"Lch s chuyn phng ban",s.length>0&&t.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:[s.length," ln"]})]}),s.length>0?t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute left-6 top-0 bottom-0 w-0.5 bg-gray-200"}),t.jsx("div",{className:"space-y-4",children:s.map(o=>{var d;return t.jsxs("div",{className:"relative flex items-start gap-4 pl-2",children:[t.jsx("div",{className:"absolute left-4 w-4 h-4 bg-gray-300 rounded-full border-2 border-white z-10"}),t.jsxs("div",{className:"ml-10 flex-1 bg-gray-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:((d=o.phongBan)==null?void 0:d.tenPhongBan)||"N/A"}),o.donViCon&&t.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1 mt-1",children:[t.jsx(on,{size:12}),o.donViCon.loaiDonVi,": ",o.donViCon.tenDonVi]})]}),t.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[t.jsx("div",{children:ys(o.tuNgay)}),t.jsxs("div",{children:[" ",ys(o.denNgay)]})]})]}),o.ghiChu&&t.jsx("div",{className:"text-sm text-gray-500 mt-2 italic",children:o.ghiChu})]})]},o.id)})})]}):t.jsxs("div",{className:"text-center text-gray-500 py-8",children:[t.jsx(nn,{size:40,className:"mx-auto text-gray-300 mb-2"}),t.jsx("p",{children:"Cha c lch s chuyn phng ban"}),t.jsx("p",{className:"text-sm",children:"Nhn vin cha tng chuyn phng ban"})]})]})]})}function vD(){var ce;const{id:e}=U0(),n=parseInt(e),a=Rt(),[r,s]=E.useState("thong-tin"),[l,o]=E.useState(!1),[d,u]=E.useState(null),[h,m]=E.useState(null),[f,p]=E.useState(!1),[b,g]=E.useState({hoTen:"",email:"",soDienThoai:"",phongBanId:0,chucVu:"",gioiTinh:"",ngaySinh:"",diaChi:"",ngayVaoLam:"",luongCoBan:0}),[y,N]=E.useState({khoanLuongId:0,soTien:0,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""}),[C,T]=E.useState({soTienMoi:0,tuNgay:new Date().toISOString().split("T")[0],ghiChu:""}),[S,k]=E.useState({denNgay:new Date().toISOString().split("T")[0]}),{data:_,isLoading:P}=Ie({queryKey:["nhan-vien",n],queryFn:()=>Oa.layTheoId(n)}),{data:j}=Ie({queryKey:["phong-ban"],queryFn:()=>ln.layTatCa()}),{data:A,isLoading:L}=Ie({queryKey:["phu-cap",n],queryFn:()=>qo.layTheoNhanVien(n)}),{data:W}=Ie({queryKey:["khoan-luong","THU_NHAP"],queryFn:()=>Dr.layTatCa("THU_NHAP")}),R=De({mutationFn:Q=>qo.taoPhuCap(Q),onSuccess:()=>{le.success("Thm ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]}),o(!1),ae()},onError:Q=>{var oe,X;le.error(((X=(oe=Q.response)==null?void 0:oe.data)==null?void 0:X.message)||"C li xy ra")}}),M=De({mutationFn:({id:Q,data:oe})=>qo.tang(Q,oe),onSuccess:()=>{le.success("iu chnh ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]}),u(null)},onError:Q=>{var oe,X;le.error(((X=(oe=Q.response)==null?void 0:oe.data)==null?void 0:X.message)||"C li xy ra")}}),q=De({mutationFn:({id:Q,denNgay:oe})=>qo.ketThuc(Q,oe,"Admin"),onSuccess:()=>{le.success("Kt thc ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]}),m(null)},onError:Q=>{var oe,X;le.error(((X=(oe=Q.response)==null?void 0:oe.data)==null?void 0:X.message)||"C li xy ra")}}),ee=De({mutationFn:Q=>qo.tamDung(Q),onSuccess:()=>{le.success("Tm dng ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]})}}),z=De({mutationFn:Q=>qo.kichHoat(Q),onSuccess:()=>{le.success("Kch hot ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]})}}),fe=De({mutationFn:Q=>Oa.capNhat(n,Q),onSuccess:()=>{le.success("Cp nht thng tin nhn vin thnh cng"),a.invalidateQueries({queryKey:["nhan-vien",n]}),p(!1)},onError:Q=>{var oe,X;le.error(((X=(oe=Q.response)==null?void 0:oe.data)==null?void 0:X.message)||"C li xy ra khi cp nht")}});E.useEffect(()=>{_&&g({hoTen:_.hoTen||"",email:_.email||"",soDienThoai:_.soDienThoai||"",phongBanId:_.phongBanId||0,chucVu:_.chucVu||"",gioiTinh:_.gioiTinh||"",ngaySinh:_.ngaySinh?new Date(_.ngaySinh).toISOString().split("T")[0]:"",diaChi:_.diaChi||"",ngayVaoLam:_.ngayVaoLam?new Date(_.ngayVaoLam).toISOString().split("T")[0]:"",luongCoBan:_.luongCoBan||0})},[_]);const ae=()=>{N({khoanLuongId:0,soTien:0,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""})},J=()=>{if(!y.khoanLuongId){le.error("Vui lng chn khon ph cp");return}if(y.soTien<=0){le.error("S tin phi > 0");return}R.mutate({nhanVienId:n,khoanLuongId:y.khoanLuongId,soTien:y.soTien,tuNgay:y.tuNgay,denNgay:y.denNgay||void 0,ghiChu:y.ghiChu||void 0,nguoiTao:"Admin"})},G=()=>{if(d){if(C.soTienMoi<=0){le.error("S tin mi phi > 0");return}M.mutate({id:d.id,data:{soTienMoi:C.soTienMoi,tuNgay:C.tuNgay,ghiChu:C.ghiChu||void 0,nguoiTao:"Admin"}})}},he=()=>{h&&q.mutate({id:h.id,denNgay:S.denNgay})},H=()=>{var Q,oe,X,ve;if(!b.hoTen.trim()){le.error("Vui lng nhp h tn");return}if(!b.phongBanId){le.error("Vui lng chn phng ban");return}fe.mutate({hoTen:b.hoTen.trim(),email:((Q=b.email)==null?void 0:Q.trim())||null,soDienThoai:((oe=b.soDienThoai)==null?void 0:oe.trim())||null,phongBanId:b.phongBanId,chucVu:((X=b.chucVu)==null?void 0:X.trim())||null,gioiTinh:b.gioiTinh||null,ngaySinh:b.ngaySinh||null,diaChi:((ve=b.diaChi)==null?void 0:ve.trim())||null,ngayVaoLam:b.ngayVaoLam||null,luongCoBan:b.luongCoBan||0})},F=()=>{_&&g({hoTen:_.hoTen||"",email:_.email||"",soDienThoai:_.soDienThoai||"",phongBanId:_.phongBanId||0,chucVu:_.chucVu||"",gioiTinh:_.gioiTinh||"",ngaySinh:_.ngaySinh?new Date(_.ngaySinh).toISOString().split("T")[0]:"",diaChi:_.diaChi||"",ngayVaoLam:_.ngayVaoLam?new Date(_.ngayVaoLam).toISOString().split("T")[0]:"",luongCoBan:_.luongCoBan||0}),p(!1)},I=(A==null?void 0:A.filter(Q=>Q.trangThai==="HIEU_LUC"))||[],O=(A==null?void 0:A.filter(Q=>Q.trangThai==="TAM_DUNG"))||[],V=(A==null?void 0:A.filter(Q=>Q.trangThai==="KET_THUC"))||[],te=I.reduce((Q,oe)=>Q+Number(oe.soTien||0),0);if(P)return t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});if(!_)return t.jsx("div",{className:"text-center py-12 text-gray-500",children:"Khng tm thy nhn vin"});const pe=Q=>{switch(Q){case"HIEU_LUC":return"bg-green-100 text-green-800";case"TAM_DUNG":return"bg-yellow-100 text-yellow-800";case"KET_THUC":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},U=Q=>{switch(Q){case"HIEU_LUC":return"Hiu lc";case"TAM_DUNG":return"Tm dng";case"KET_THUC":return"Kt thc";default:return Q}};return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[t.jsx(ca,{to:"/nhan-vien",className:"p-2 hover:bg-gray-100 rounded-lg",children:t.jsx($0,{size:24})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:_.hoTen}),t.jsxs("p",{className:"text-gray-500",children:[_.maNhanVien," - ",_.chucVu||"Nhn vin"]})]})]}),t.jsxs("div",{className:"flex gap-2 mb-6 border-b overflow-x-auto",children:[t.jsxs("button",{onClick:()=>s("thong-tin"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="thong-tin"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(no,{size:18,className:"inline-block mr-2"}),"Thng tin"]}),t.jsxs("button",{onClick:()=>s("hop-dong"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="hop-dong"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(ua,{size:18,className:"inline-block mr-2"}),"Hp ng / Lng"]}),t.jsxs("button",{onClick:()=>s("phu-cap"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="phu-cap"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(Zp,{size:18,className:"inline-block mr-2"}),"Ph cp",I.length>0&&t.jsx("span",{className:"ml-2 bg-primary-100 text-primary-700 px-2 py-0.5 rounded-full text-xs",children:I.length})]}),t.jsxs("button",{onClick:()=>s("lich-su"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="lich-su"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(fu,{size:18,className:"inline-block mr-2"}),"Lch s ph cp"]}),t.jsxs("button",{onClick:()=>s("lich-su-phong-ban"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="lich-su-phong-ban"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(Fr,{size:18,className:"inline-block mr-2"}),"Lch s phng ban"]})]}),r==="thong-tin"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:[t.jsx(no,{size:20}),"Thng tin c bn"]}),f?t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:F,className:"btn btn-secondary flex items-center gap-2",disabled:fe.isPending,children:[t.jsx(hn,{size:16}),"Hy"]}),t.jsxs("button",{onClick:H,className:"btn btn-primary flex items-center gap-2",disabled:fe.isPending,children:[t.jsx(nl,{size:16}),fe.isPending?"ang lu...":"Lu"]})]}):t.jsxs("button",{onClick:()=>p(!0),className:"btn btn-secondary flex items-center gap-2",children:[t.jsx(P_,{size:16}),"Chnh sa"]})]}),f?t.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"M nhn vin"}),t.jsx("p",{className:"font-medium text-gray-400",children:_.maNhanVien}),t.jsx("span",{className:"text-xs text-gray-400",children:"(Khng th sa)"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"H tn *"}),t.jsx("input",{type:"text",value:b.hoTen,onChange:Q=>g({...b,hoTen:Q.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp h tn"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phng ban *"}),t.jsxs("select",{value:b.phongBanId,onChange:Q=>g({...b,phongBanId:parseInt(Q.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn phng ban --"}),j==null?void 0:j.map(Q=>t.jsx("option",{value:Q.id,children:Q.tenPhongBan},Q.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chc v"}),t.jsx("input",{type:"text",value:b.chucVu,onChange:Q=>g({...b,chucVu:Q.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp chc v"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gii tnh"}),t.jsxs("select",{value:b.gioiTinh,onChange:Q=>g({...b,gioiTinh:Q.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn gii tnh --"}),t.jsx("option",{value:"NAM",children:"Nam"}),t.jsx("option",{value:"NU",children:"N"}),t.jsx("option",{value:"KHAC",children:"Khc"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy sinh"}),t.jsx(Ht,{value:b.ngaySinh,onChange:Q=>g({...b,ngaySinh:Q}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),t.jsx("input",{type:"email",value:b.email,onChange:Q=>g({...b,email:Q.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp email"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S in thoi"}),t.jsx("input",{type:"tel",value:b.soDienThoai,onChange:Q=>g({...b,soDienThoai:Q.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp s in thoi"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"a ch"}),t.jsx("input",{type:"text",value:b.diaChi,onChange:Q=>g({...b,diaChi:Q.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp a ch"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy vo lm"}),t.jsx(Ht,{value:b.ngayVaoLam,onChange:Q=>g({...b,ngayVaoLam:Q}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lng c bn"}),t.jsx("input",{type:"number",value:b.luongCoBan,onChange:Q=>g({...b,luongCoBan:parseFloat(Q.target.value)||0}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp lng c bn",min:0,step:1e5})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Tng ph cp hin ti"}),t.jsx("p",{className:"font-medium text-green-600",children:Ze(te)}),t.jsx("span",{className:"text-xs text-gray-400",children:"(T ng tnh t cc khon ph cp)"})]})]}):t.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"M nhn vin"}),t.jsx("p",{className:"font-medium",children:_.maNhanVien})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"H tn"}),t.jsx("p",{className:"font-medium",children:_.hoTen})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Phng ban"}),t.jsx("p",{className:"font-medium",children:(ce=_.phongBan)==null?void 0:ce.tenPhongBan})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Chc v"}),t.jsx("p",{className:"font-medium",children:_.chucVu||"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Gii tnh"}),t.jsx("p",{className:"font-medium",children:_.gioiTinh==="NAM"?"Nam":_.gioiTinh==="NU"?"N":_.gioiTinh==="KHAC"?"Khc":"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Ngy sinh"}),t.jsx("p",{className:"font-medium",children:_.ngaySinh?ys(_.ngaySinh):"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Email"}),t.jsx("p",{className:"font-medium",children:_.email||"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"S in thoi"}),t.jsx("p",{className:"font-medium",children:_.soDienThoai||"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"a ch"}),t.jsx("p",{className:"font-medium",children:_.diaChi||"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Ngy vo lm"}),t.jsx("p",{className:"font-medium",children:_.ngayVaoLam?ys(_.ngayVaoLam):"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Lng c bn"}),t.jsx("p",{className:"font-medium text-primary-600",children:Ze(_.luongCoBan)})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Tng ph cp hin ti"}),t.jsx("p",{className:"font-medium text-green-600",children:Ze(te)})]})]})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[t.jsx(Fr,{size:20}),"Ti khon ngn hng"]}),t.jsx(fD,{nhanVienId:n})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[t.jsx(ua,{size:20}),"Thng tin Thu & BHXH"]}),t.jsx(gD,{nhanVienId:n})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[t.jsx(on,{size:20}),"Nhm nhn vin"]}),t.jsx(pD,{nhanVienId:n})]})]}),r==="hop-dong"&&t.jsx("div",{className:"card",children:t.jsx(mD,{nhanVienId:n})}),r==="phu-cap"&&t.jsxs("div",{children:[t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"card bg-green-50",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Ph cp hiu lc"}),t.jsx("p",{className:"text-2xl font-bold text-green-600",children:I.length}),t.jsxs("p",{className:"text-sm text-green-600",children:[Ze(te),"/thng"]})]}),t.jsxs("div",{className:"card bg-yellow-50",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Tm dng"}),t.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:O.length})]}),t.jsxs("div",{className:"card bg-gray-50",children:[t.jsx("p",{className:"text-sm text-gray-600",children:" kt thc"}),t.jsx("p",{className:"text-2xl font-bold text-gray-600",children:V.length})]})]}),t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h3",{className:"font-semibold text-lg",children:"Danh sch ph cp"}),t.jsxs("button",{onClick:()=>o(!0),className:"btn btn-primary",children:[t.jsx(St,{size:20}),"Thm ph cp"]})]}),I.length>0&&t.jsxs("div",{className:"card mb-4",children:[t.jsxs("h4",{className:"font-medium text-green-700 mb-3 flex items-center gap-2",children:[t.jsx("span",{className:"w-3 h-3 bg-green-500 rounded-full"}),"ang hiu lc (",I.length,")"]}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Khon ph cp"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"T ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"n ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Ghi ch"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Thao tc"})]})}),t.jsx("tbody",{children:I.map(Q=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3 font-medium",children:Q.khoanLuong.tenKhoan}),t.jsx("td",{className:"py-2 px-3 text-right font-semibold text-primary-600",children:Ze(Q.soTien)}),t.jsx("td",{className:"py-2 px-3",children:ys(Q.tuNgay)}),t.jsx("td",{className:"py-2 px-3",children:Q.denNgay?ys(Q.denNgay):"Khng xc nh"}),t.jsx("td",{className:"py-2 px-3 text-gray-500 text-sm",children:Q.ghiChu||"-"}),t.jsx("td",{className:"py-2 px-3",children:t.jsxs("div",{className:"flex justify-center gap-1",children:[t.jsx("button",{onClick:()=>{u(Q),T({soTienMoi:Q.soTien,tuNgay:new Date().toISOString().split("T")[0],ghiChu:""})},className:"p-1 hover:bg-blue-100 rounded text-blue-600",title:"iu chnh",children:t.jsx(al,{size:18})}),t.jsx("button",{onClick:()=>ee.mutate(Q.id),className:"p-1 hover:bg-yellow-100 rounded text-yellow-600",title:"Tm dng",children:t.jsx(A_,{size:18})}),t.jsx("button",{onClick:()=>{m(Q),k({denNgay:new Date().toISOString().split("T")[0]})},className:"p-1 hover:bg-red-100 rounded text-red-600",title:"Kt thc",children:t.jsx(Ot,{size:18})})]})})]},Q.id))})]})]}),O.length>0&&t.jsxs("div",{className:"card mb-4",children:[t.jsxs("h4",{className:"font-medium text-yellow-700 mb-3 flex items-center gap-2",children:[t.jsx("span",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),"Tm dng (",O.length,")"]}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Khon ph cp"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Trng thi"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Thao tc"})]})}),t.jsx("tbody",{children:O.map(Q=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3",children:Q.khoanLuong.tenKhoan}),t.jsx("td",{className:"py-2 px-3 text-right",children:Ze(Q.soTien)}),t.jsx("td",{className:"py-2 px-3",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${pe(Q.trangThai)}`,children:U(Q.trangThai)})}),t.jsx("td",{className:"py-2 px-3 text-center",children:t.jsx("button",{onClick:()=>z.mutate(Q.id),className:"p-1 hover:bg-green-100 rounded text-green-600",title:"Kch hot li",children:t.jsx(sp,{size:18})})})]},Q.id))})]})]}),L?t.jsx("div",{className:"text-center py-8",children:"ang ti..."}):(A==null?void 0:A.length)===0?t.jsxs("div",{className:"card text-center py-8 text-gray-500",children:[t.jsx(uo,{size:48,className:"mx-auto mb-4 text-gray-300"}),t.jsx("p",{children:"Nhn vin cha c ph cp no"}),t.jsxs("button",{onClick:()=>o(!0),className:"btn btn-primary mt-4",children:[t.jsx(St,{size:20}),"Thm ph cp u tin"]})]}):null]}),r==="lich-su"&&t.jsxs("div",{className:"card",children:[t.jsx("h3",{className:"font-semibold mb-4",children:"Lch s thay i ph cp"}),A&&A.length>0?t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Khon ph cp"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"T ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"n ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Trng thi"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Ghi ch"})]})}),t.jsx("tbody",{children:A.map(Q=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3",children:Q.khoanLuong.tenKhoan}),t.jsx("td",{className:"py-2 px-3 text-right font-medium",children:Ze(Q.soTien)}),t.jsx("td",{className:"py-2 px-3",children:ys(Q.tuNgay)}),t.jsx("td",{className:"py-2 px-3",children:Q.denNgay?ys(Q.denNgay):"-"}),t.jsx("td",{className:"py-2 px-3",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${pe(Q.trangThai)}`,children:U(Q.trangThai)})}),t.jsx("td",{className:"py-2 px-3 text-gray-500 text-sm",children:Q.ghiChu||"-"})]},Q.id))})]}):t.jsx("p",{className:"text-gray-500 text-center py-8",children:"Cha c d liu lch s"})]}),r==="lich-su-phong-ban"&&t.jsx(yD,{nhanVienId:n}),l&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm ph cp mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Khon ph cp *"}),t.jsxs("select",{value:y.khoanLuongId,onChange:Q=>N({...y,khoanLuongId:Number(Q.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn khon ph cp --"}),W==null?void 0:W.map(Q=>t.jsx("option",{value:Q.id,children:Q.tenKhoan},Q.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S tin *"}),t.jsx("input",{type:"number",value:y.soTien,onChange:Q=>N({...y,soTien:Number(Q.target.value)}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: 500000"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy bt u *"}),t.jsx(Ht,{value:y.tuNgay,onChange:Q=>N({...y,tuNgay:Q}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy kt thc (ty chn)"}),t.jsx(Ht,{value:y.denNgay,onChange:Q=>N({...y,denNgay:Q}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ghi ch"}),t.jsx("textarea",{value:y.ghiChu,onChange:Q=>N({...y,ghiChu:Q.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[t.jsx("button",{onClick:()=>o(!1),className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:J,disabled:R.isPending,className:"btn btn-primary",children:R.isPending?"ang lu...":"Thm ph cp"})]})]})}),d&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"iu chnh ph cp"}),t.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg mb-4",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Khon ph cp"}),t.jsx("p",{className:"font-medium",children:d.khoanLuong.tenKhoan}),t.jsxs("p",{className:"text-sm text-gray-500",children:["Hin ti: ",Ze(d.soTien)]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S tin mi *"}),t.jsx("input",{type:"number",value:C.soTienMoi,onChange:Q=>T({...C,soTienMoi:Number(Q.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy hiu lc mi *"}),t.jsx(Ht,{value:C.tuNgay,onChange:Q=>T({...C,tuNgay:Q}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"L do iu chnh"}),t.jsx("textarea",{value:C.ghiChu,onChange:Q=>T({...C,ghiChu:Q.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[t.jsx("button",{onClick:()=>u(null),className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:G,disabled:M.isPending,className:"btn btn-primary",children:M.isPending?"ang lu...":"iu chnh"})]})]})}),h&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Kt thc ph cp"}),t.jsxs("div",{className:"bg-red-50 p-3 rounded-lg mb-4",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Khon ph cp"}),t.jsx("p",{className:"font-medium",children:h.khoanLuong.tenKhoan}),t.jsxs("p",{className:"text-sm text-red-600",children:["S tin: ",Ze(h.soTien)]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy kt thc *"}),t.jsx(Ht,{value:S.denNgay,onChange:Q=>k({denNgay:Q}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[t.jsx("button",{onClick:()=>m(null),className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:he,disabled:q.isPending,className:"btn btn-danger",children:q.isPending?"ang lu...":"Kt thc"})]})]})})]})}function bD(){const e=Rt(),[n,a]=E.useState(!1),[r,s]=E.useState(null),[l,o]=E.useState({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",chiuThue:!1,moTa:""}),{data:d,isLoading:u}=Ie({queryKey:["khoan-luong"],queryFn:()=>Dr.layTatCa()}),h=De({mutationFn:Dr.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["khoan-luong"]}),le.success("To khon lng thnh cng!"),p()},onError:T=>{var S,k;le.error(((k=(S=T.response)==null?void 0:S.data)==null?void 0:k.message)||"C li xy ra")}}),m=De({mutationFn:({id:T,data:S})=>Dr.capNhat(T,S),onSuccess:()=>{e.invalidateQueries({queryKey:["khoan-luong"]}),le.success("Cp nht thnh cng!"),p()},onError:T=>{var S,k;le.error(((k=(S=T.response)==null?void 0:S.data)==null?void 0:k.message)||"C li xy ra")}}),f=De({mutationFn:Dr.xoa,onSuccess:()=>{e.invalidateQueries({queryKey:["khoan-luong"]}),le.success("Xa khon lng thnh cng!")},onError:T=>{var S,k;le.error(((k=(S=T.response)==null?void 0:S.data)==null?void 0:k.message)||"C li xy ra")}}),p=()=>{a(!1),s(null),o({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",chiuThue:!1,moTa:""})},b=T=>{s(T),o({maKhoan:T.maKhoan,tenKhoan:T.tenKhoan,loai:T.loai,chiuThue:T.chiuThue,moTa:T.moTa||""}),a(!0)},g=()=>{if(!l.maKhoan||!l.tenKhoan){le.error("Vui lng in y  thng tin bt buc");return}r?m.mutate({id:r.id,data:l}):h.mutate(l)},y=T=>{confirm(`Bn c chc mun xa khon lng "${T.tenKhoan}"?`)&&f.mutate(T.id)},N=(d==null?void 0:d.filter(T=>T.loai==="THU_NHAP"))||[],C=(d==null?void 0:d.filter(T=>T.loai==="KHAU_TRU"))||[];return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[t.jsx(Ar,{size:28}),"Qun l Khon lng"]}),t.jsxs("button",{onClick:()=>a(!0),className:"btn btn-primary",children:[t.jsx(St,{size:20}),"Thm khon lng"]})]}),u?t.jsx("p",{className:"text-center py-8 text-gray-500",children:"ang ti..."}):t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"card",children:[t.jsxs("h2",{className:"text-lg font-semibold text-green-700 mb-4 flex items-center gap-2",children:[t.jsx("span",{className:"w-3 h-3 bg-green-500 rounded-full"}),"Cc khon Thu nhp (",N.length,")"]}),t.jsxs("div",{className:"space-y-2",children:[N.map(T=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(ab,{size:16,className:"text-gray-400 cursor-grab"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:T.tenKhoan}),t.jsxs("p",{className:"text-xs text-gray-500",children:[T.maKhoan,T.chiuThue&&t.jsx("span",{className:"ml-2 px-1.5 py-0.5 bg-orange-100 text-orange-700 rounded",children:"Chu thu"})]})]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:()=>b(T),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-lg",children:t.jsx(Or,{size:16})}),t.jsx("button",{onClick:()=>y(T),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg",children:t.jsx(Ir,{size:16})})]})]},T.id)),N.length===0&&t.jsx("p",{className:"text-gray-500 text-center py-4",children:"Cha c khon thu nhp"})]})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h2",{className:"text-lg font-semibold text-red-700 mb-4 flex items-center gap-2",children:[t.jsx("span",{className:"w-3 h-3 bg-red-500 rounded-full"}),"Cc khon Khu tr (",C.length,")"]}),t.jsxs("div",{className:"space-y-2",children:[C.map(T=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(ab,{size:16,className:"text-gray-400 cursor-grab"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:T.tenKhoan}),t.jsx("p",{className:"text-xs text-gray-500",children:T.maKhoan})]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:()=>b(T),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-lg",children:t.jsx(Or,{size:16})}),t.jsx("button",{onClick:()=>y(T),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg",children:t.jsx(Ir,{size:16})})]})]},T.id)),C.length===0&&t.jsx("p",{className:"text-gray-500 text-center py-4",children:"Cha c khon khu tr (BHXH, thu s thm  y)"})]})]})]}),n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:r?"Sa khon lng":"Thm khon lng mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M khon *"}),t.jsx("input",{type:"text",value:l.maKhoan,onChange:T=>o({...l,maKhoan:T.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: PHU_CAP_XE",disabled:!!r})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tn khon *"}),t.jsx("input",{type:"text",value:l.tenKhoan,onChange:T=>o({...l,tenKhoan:T.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ph cp xe"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi"}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"radio",name:"loai",checked:l.loai==="THU_NHAP",onChange:()=>o({...l,loai:"THU_NHAP"})}),t.jsx("span",{className:"text-green-700",children:"Thu nhp (+)"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"radio",name:"loai",checked:l.loai==="KHAU_TRU",onChange:()=>o({...l,loai:"KHAU_TRU"})}),t.jsx("span",{className:"text-red-700",children:"Khu tr (-)"})]})]})]}),t.jsx("div",{children:t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:l.chiuThue,onChange:T=>o({...l,chiuThue:T.target.checked})}),t.jsx("span",{className:"text-sm",children:"Khon ny chu thu TNCN"})]})}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M t"}),t.jsx("textarea",{value:l.moTa,onChange:T=>o({...l,moTa:T.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:p,className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:g,disabled:h.isPending||m.isPending,className:"btn btn-primary",children:h.isPending||m.isPending?"ang lu...":"Lu"})]})]})})]})}function ND(){const e=Rt(),n=E.useRef(null),[a,r]=E.useState("upload"),[s,l]=E.useState(null),[o,d]=E.useState([]),[u,h]=E.useState([]),[m,f]=E.useState([]),[p,b]=E.useState(new Date().getMonth()+1),[g,y]=E.useState(new Date().getFullYear()),[N,C]=E.useState(0),[T,S]=E.useState(null),{data:k}=Ie({queryKey:["phong-ban"],queryFn:ln.layTatCa}),{data:_}=Ie({queryKey:["khoan-luong"],queryFn:()=>Dr.layTatCa()}),P=De({mutationFn:q=>c0.docHeader(q),onSuccess:q=>{d(q.headers),h(q.duLieuMau),j.mutate(s)},onError:()=>{le.error("Khng th c file Excel")}}),j=De({mutationFn:q=>c0.goiYMapping(q),onSuccess:q=>{f(q),r("mapping")}}),A=De({mutationFn:()=>c0.import(s,p,g,N,m),onSuccess:q=>{S(q),r("result"),e.invalidateQueries({queryKey:["bang-luong"]}),q.thanhCong?le.success("Import thnh cng!"):le.error(`Import c ${q.dongLoi} dng li`)},onError:q=>{var ee,z;le.error(((z=(ee=q.response)==null?void 0:ee.data)==null?void 0:z.message)||"C li khi import")}}),L=q=>{var z;const ee=(z=q.target.files)==null?void 0:z[0];if(ee){if(!ee.name.endsWith(".xlsx")&&!ee.name.endsWith(".xls")){le.error("Vui lng chn file Excel (.xlsx hoc .xls)");return}l(ee),P.mutate(ee)}},W=(q,ee,z)=>{const fe=[...m];fe[q]={...fe[q],[ee]:z},f(fe)},R=()=>{if(!N){le.error("Vui lng chn phng ban");return}if(!m.some(ee=>ee.loaiMapping==="thong_tin"&&ee.truongHeThong==="ma_nhan_vien")){le.error("Cn mapping ct M nhn vin");return}A.mutate()},M=()=>{r("upload"),l(null),d([]),h([]),f([]),S(null),n.current&&(n.current.value="")};return t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2 mb-6",children:[t.jsx(bs,{size:28}),"Import t Excel"]}),t.jsx("div",{className:"flex items-center gap-4 mb-8",children:["Upload file","Mapping ct","Kt qu"].map((q,ee)=>{const z=["upload","mapping","result"],fe=a===z[ee],ae=z.indexOf(a)>ee;return t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:`
                  w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold
                  ${fe?"bg-primary-600 text-white":""}
                  ${ae?"bg-green-500 text-white":""}
                  ${!fe&&!ae?"bg-gray-200 text-gray-500":""}
                `,children:ae?"":ee+1}),t.jsx("span",{className:fe?"font-semibold":"text-gray-500",children:q}),ee<2&&t.jsx(o_,{size:16,className:"text-gray-400 ml-2"})]},q)})}),a==="upload"&&t.jsx("div",{className:"card",children:t.jsxs("div",{className:"text-center py-12",children:[t.jsx(Ys,{size:64,className:"mx-auto text-gray-400 mb-4"}),t.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Chn file Excel  import"}),t.jsx("p",{className:"text-gray-500 mb-6",children:"H tr nh dng .xlsx v .xls"}),t.jsx("input",{ref:n,type:"file",accept:".xlsx,.xls",onChange:L,className:"hidden"}),t.jsxs("button",{onClick:()=>{var q;return(q=n.current)==null?void 0:q.click()},disabled:P.isPending,className:"btn btn-primary",children:[t.jsx(bs,{size:20}),P.isPending?"ang c file...":"Chn file Excel"]})]})}),a==="mapping"&&t.jsxs("div",{children:[t.jsxs("div",{className:"card mb-6",children:[t.jsx("h3",{className:"font-semibold mb-4",children:"Thng tin import"}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"File"}),t.jsx("p",{className:"font-medium",children:s==null?void 0:s.name})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Thng"}),t.jsx("select",{value:p,onChange:q=>b(Number(q.target.value)),className:"w-full border rounded-lg px-3 py-2",children:Array.from({length:12},(q,ee)=>ee+1).map(q=>t.jsxs("option",{value:q,children:["Thng ",q]},q))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Nm"}),t.jsx("select",{value:g,onChange:q=>y(Number(q.target.value)),className:"w-full border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(q=>t.jsx("option",{value:q,children:q},q))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban *"}),t.jsxs("select",{value:N,onChange:q=>C(Number(q.target.value)),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn --"}),k==null?void 0:k.map(q=>t.jsx("option",{value:q.id,children:q.tenPhongBan},q.id))]})]})]})]}),t.jsxs("div",{className:"card mb-6",children:[t.jsx("h3",{className:"font-semibold mb-4",children:"Mapping ct Excel  Khon lng"}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Ct"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Tn ct Excel"}),t.jsx("th",{className:"text-left py-2 px-3",children:"D liu mu"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Loi"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Mapping"})]})}),t.jsx("tbody",{children:m.map((q,ee)=>{var z;return t.jsxs("tr",{className:"border-b",children:[t.jsx("td",{className:"py-2 px-3",children:q.soCot}),t.jsx("td",{className:"py-2 px-3 font-medium",children:q.tenCot}),t.jsx("td",{className:"py-2 px-3 text-gray-500",children:((z=u[0])==null?void 0:z[ee])||"-"}),t.jsx("td",{className:"py-2 px-3",children:t.jsxs("select",{value:q.loaiMapping,onChange:fe=>W(ee,"loaiMapping",fe.target.value),className:"border rounded px-2 py-1 text-sm",children:[t.jsx("option",{value:"thong_tin",children:"Thng tin"}),t.jsx("option",{value:"khoan_luong",children:"Khon lng"})]})}),t.jsx("td",{className:"py-2 px-3",children:q.loaiMapping==="thong_tin"?t.jsxs("select",{value:q.truongHeThong||"",onChange:fe=>W(ee,"truongHeThong",fe.target.value),className:"border rounded px-2 py-1 text-sm w-full",children:[t.jsx("option",{value:"",children:"-- B qua --"}),t.jsx("option",{value:"ma_nhan_vien",children:"M nhn vin"}),t.jsx("option",{value:"ho_ten",children:"H tn"}),t.jsx("option",{value:"phong_ban",children:"Phng ban"}),t.jsx("option",{value:"tong_luong_bo_qua",children:"Tng (b qua)"})]}):t.jsxs("select",{value:q.khoanLuongId||"",onChange:fe=>W(ee,"khoanLuongId",Number(fe.target.value)||void 0),className:"border rounded px-2 py-1 text-sm w-full",children:[t.jsx("option",{value:"",children:"-- B qua --"}),_==null?void 0:_.map(fe=>t.jsx("option",{value:fe.id,children:fe.tenKhoan},fe.id))]})})]},ee)})})]})})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("button",{onClick:M,className:"btn btn-secondary",children:"Quay li"}),t.jsx("button",{onClick:R,disabled:A.isPending,className:"btn btn-primary",children:A.isPending?"ang import...":"Bt u Import"})]})]}),a==="result"&&T&&t.jsxs("div",{children:[t.jsx("div",{className:`card mb-6 ${T.thanhCong?"bg-green-50":"bg-yellow-50"}`,children:t.jsxs("div",{className:"flex items-center gap-4",children:[T.thanhCong?t.jsx(Ma,{size:48,className:"text-green-500"}):t.jsx(uo,{size:48,className:"text-yellow-500"}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold",children:T.thanhCong?"Import thnh cng!":"Import hon tt (c li)"}),t.jsxs("p",{className:"text-gray-600",children:[" import ",T.dongThanhCong,"/",T.tongDong," dng"]})]})]})}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"card text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-green-600",children:T.dongThanhCong}),t.jsx("p",{className:"text-gray-500",children:"Dng thnh cng"})]}),t.jsxs("div",{className:"card text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-red-600",children:T.dongLoi}),t.jsx("p",{className:"text-gray-500",children:"Dng li"})]}),t.jsxs("div",{className:"card text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-primary-600",children:Ze(T.tongTienImport)}),t.jsx("p",{className:"text-gray-500",children:"Tng tin import"})]})]}),T.chiTietLoi.length>0&&t.jsxs("div",{className:"card mb-6",children:[t.jsx("h3",{className:"font-semibold text-red-600 mb-3",children:"Chi tit li"}),t.jsx("div",{className:"max-h-48 overflow-y-auto",children:T.chiTietLoi.map((q,ee)=>t.jsxs("div",{className:"flex items-center gap-2 py-2 border-b",children:[t.jsx(ho,{size:16,className:"text-red-500"}),t.jsxs("span",{className:"font-medium",children:["Dng ",q.dong,":"]}),t.jsx("span",{className:"text-gray-600",children:q.lyDo})]},ee))})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx("button",{onClick:M,className:"btn btn-secondary",children:"Import file khc"}),t.jsx("a",{href:`/bang-luong/${T.bangLuongId}`,className:"btn btn-primary",children:"Xem bng lng"})]})]})]})}const sf={layDanhSach:(e,n,a)=>{const r=new URLSearchParams({thang:String(e),nam:String(n)});return a&&r.append("phongBanId",String(a)),me.get(`/cham-cong?${r}`)},layChamCongNhanVien:(e,n,a)=>me.get(`/cham-cong/nhan-vien/${e}?thang=${n}&nam=${a}`),luu:e=>me.post("/cham-cong",e),khoiTao:(e,n,a=26)=>me.post("/cham-cong/khoi-tao",{thang:e,nam:n,soCongChuan:a}),import:(e,n,a)=>me.post("/cham-cong/import",{thang:e,nam:n,duLieu:a})},lf={lay:e=>me.get(`/cham-cong/cau-hinh-phat/${e}`),capNhat:(e,n)=>me.put(`/cham-cong/cau-hinh-phat/${e}`,n),tinhPhat:(e,n,a)=>me.get(`/cham-cong/tinh-phat/${e}?thang=${n}&nam=${a}`)},jD={dongBoCSV:e=>me.post("/cham-cong/dong-bo-csv",{csvContent:e})};function wD(){const[e,n]=E.useState("cham-cong"),[a,r]=E.useState(new Date().getMonth()+1),[s,l]=E.useState(new Date().getFullYear()),[o,d]=E.useState(),[u,h]=E.useState([]),[m,f]=E.useState([]),[p,b]=E.useState(null),[g,y]=E.useState({}),[N,C]=E.useState(!1),[T,S]=E.useState(null),[k,_]=E.useState({}),[P,j]=E.useState(null),[A,L]=E.useState(null),[W,R]=E.useState(!1),M=E.useRef(null);E.useEffect(()=>{me.get("/phong-ban").then(F=>h(F.data))},[]),E.useEffect(()=>{q()},[a,s,o]),E.useEffect(()=>{e==="cau-hinh"&&ee()},[e,s]);const q=async()=>{C(!0);try{const F=await sf.layDanhSach(a,s,o);f(F.data);const I={};for(const O of F.data)if(O.soLanDiMuon>0||O.soLanVeSom>0||Number(O.soNgayNghiKhongLuong)>0)try{const V=await lf.tinhPhat(O.nhanVienId,a,s);I[O.nhanVienId]=V.data}catch{}y(I)}catch{le.error("Li ti d liu chm cng")}C(!1)},ee=async()=>{try{const F=await lf.lay(s);b(F.data)}catch{le.error("Li ti cu hnh pht")}},z=async()=>{if(confirm(`Khi to chm cng thng ${a}/${s} cho tt c nhn vin?`))try{const F=await sf.khoiTao(a,s,26);le.success(`${F.data.message} -  to: ${F.data.created}, B qua: ${F.data.skipped}`),q()}catch{le.error("Li khi to chm cng")}},fe=F=>{S(F.id),_({nhanVienId:F.nhanVienId,thang:F.thang,nam:F.nam,soCongChuan:Number(F.soCongChuan),soCongThucTe:Number(F.soCongThucTe),soNgayNghiPhep:Number(F.soNgayNghiPhep),soNgayNghiKhongLuong:Number(F.soNgayNghiKhongLuong),soGioOT:Number(F.soGioOT),soLanDiMuon:F.soLanDiMuon,soLanVeSom:F.soLanVeSom})},ae=async()=>{if(k.nhanVienId)try{await sf.luu(k),le.success(" lu chm cng"),S(null),_({}),q()}catch{le.error("Li lu chm cng")}},J=async()=>{if(p)try{await lf.capNhat(s,p),le.success(" lu cu hnh pht")}catch{le.error("Li lu cu hnh")}},G=F=>new Intl.NumberFormat("vi-VN").format(F)+" ",he=F=>{var O;const I=(O=F.target.files)==null?void 0:O[0];I&&(j(I),L(null))},H=async()=>{var F,I;if(!P){le.error("Vui lng chn file CSV");return}R(!0);try{const O=await P.text(),V=await jD.dongBoCSV(O);L(V.data),le.success(` ng b ${V.data.luuThanhCong} nhn vin thnh cng`),q()}catch(O){le.error(((I=(F=O==null?void 0:O.response)==null?void 0:F.data)==null?void 0:I.message)||"Li ng b file")}R(!1)};return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex justify-between items-center",children:t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[t.jsx(nn,{className:"text-primary-600"}),"Qun l Chm cng"]}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Theo di chm cng, i mun, ngh khng php"})]})}),t.jsx("div",{className:"border-b border-gray-200",children:t.jsxs("nav",{className:"flex gap-4",children:[t.jsxs("button",{onClick:()=>n("cham-cong"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${e==="cham-cong"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(on,{size:18,className:"inline mr-2"}),"Chm cng thng"]}),t.jsxs("button",{onClick:()=>n("dong-bo"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${e==="dong-bo"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(bs,{size:18,className:"inline mr-2"}),"ng b my chm cng"]}),t.jsxs("button",{onClick:()=>n("cau-hinh"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${e==="cau-hinh"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(Zs,{size:18,className:"inline mr-2"}),"Cu hnh pht"]})]})}),e==="cham-cong"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Thng"}),t.jsx("select",{value:a,onChange:F=>r(Number(F.target.value)),className:"border rounded-lg px-3 py-2",children:[...Array(12)].map((F,I)=>t.jsxs("option",{value:I+1,children:["Thng ",I+1]},I+1))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Nm"}),t.jsx("select",{value:s,onChange:F=>l(Number(F.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(F=>t.jsx("option",{value:F,children:F},F))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban"}),t.jsxs("select",{value:o||"",onChange:F=>d(F.target.value?Number(F.target.value):void 0),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),u.map(F=>t.jsx("option",{value:F.id,children:F.tenPhongBan},F.id))]})]}),t.jsxs("button",{onClick:q,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg",children:[t.jsx(Ra,{size:18}),"Lm mi"]}),t.jsxs("button",{onClick:z,className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white hover:bg-primary-700 rounded-lg",children:[t.jsx(Ot,{size:18}),"Khi to thng"]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Cng chun"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Cng thc"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Ngh php"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Ngh KL"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"i mun"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"V sm"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"OT (gi)"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Tin pht"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:N?t.jsx("tr",{children:t.jsx("td",{colSpan:11,className:"px-4 py-8 text-center text-gray-500",children:"ang ti..."})}):m.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:11,className:"px-4 py-8 text-center text-gray-500",children:'Cha c d liu chm cng. Nhn "Khi to thng"  bt u.'})}):m.map(F=>{var te,pe,U,ce;const I=T===F.id,O=g[F.nhanVienId],V=F.soLanDiMuon>0||F.soLanVeSom>0||Number(F.soNgayNghiKhongLuong)>0;return t.jsxs("tr",{className:V?"bg-red-50":"",children:[t.jsxs("td",{className:"px-4 py-3",children:[t.jsx("div",{className:"font-medium text-gray-900",children:(te=F.nhanVien)==null?void 0:te.hoTen}),t.jsx("div",{className:"text-sm text-gray-500",children:(pe=F.nhanVien)==null?void 0:pe.maNhanVien})]}),t.jsx("td",{className:"px-4 py-3 text-gray-600",children:(ce=(U=F.nhanVien)==null?void 0:U.phongBan)==null?void 0:ce.tenPhongBan}),t.jsx("td",{className:"px-4 py-3 text-center",children:I?t.jsx("input",{type:"number",value:k.soCongChuan||0,onChange:Q=>_({...k,soCongChuan:Number(Q.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(F.soCongChuan)}),t.jsx("td",{className:"px-4 py-3 text-center",children:I?t.jsx("input",{type:"number",value:k.soCongThucTe||0,onChange:Q=>_({...k,soCongThucTe:Number(Q.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(F.soCongThucTe)}),t.jsx("td",{className:"px-4 py-3 text-center",children:I?t.jsx("input",{type:"number",value:k.soNgayNghiPhep||0,onChange:Q=>_({...k,soNgayNghiPhep:Number(Q.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(F.soNgayNghiPhep)}),t.jsx("td",{className:"px-4 py-3 text-center",children:I?t.jsx("input",{type:"number",value:k.soNgayNghiKhongLuong||0,onChange:Q=>_({...k,soNgayNghiKhongLuong:Number(Q.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):t.jsx("span",{className:Number(F.soNgayNghiKhongLuong)>0?"text-red-600 font-semibold":"",children:Number(F.soNgayNghiKhongLuong)})}),t.jsx("td",{className:"px-4 py-3 text-center",children:I?t.jsx("input",{type:"number",value:k.soLanDiMuon||0,onChange:Q=>_({...k,soLanDiMuon:Number(Q.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):t.jsx("span",{className:F.soLanDiMuon>0?"text-orange-600 font-semibold":"",children:F.soLanDiMuon})}),t.jsx("td",{className:"px-4 py-3 text-center",children:I?t.jsx("input",{type:"number",value:k.soLanVeSom||0,onChange:Q=>_({...k,soLanVeSom:Number(Q.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):t.jsx("span",{className:F.soLanVeSom>0?"text-orange-600 font-semibold":"",children:F.soLanVeSom})}),t.jsx("td",{className:"px-4 py-3 text-center text-blue-600",children:I?t.jsx("input",{type:"number",value:k.soGioOT||0,onChange:Q=>_({...k,soGioOT:Number(Q.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(F.soGioOT)}),t.jsx("td",{className:"px-4 py-3 text-right",children:O&&O.tongPhat>0&&t.jsx("div",{className:"text-red-600 font-semibold",title:`Pht i mun: ${G(O.tienPhatDiMuon)}
Pht v sm: ${G(O.tienPhatVeSom)}
Pht ngh KP: ${G(O.tienPhatNghiKhongPhep)}
Tr lng: ${G(O.truLuongNgayCong)}`,children:G(O.tongPhat)})}),t.jsx("td",{className:"px-4 py-3 text-center",children:I?t.jsxs("div",{className:"flex gap-2 justify-center",children:[t.jsx("button",{onClick:ae,className:"p-1 text-green-600 hover:bg-green-50 rounded",children:t.jsx(nl,{size:18})}),t.jsx("button",{onClick:()=>{S(null),_({})},className:"p-1 text-gray-600 hover:bg-gray-100 rounded",children:""})]}):t.jsx("button",{onClick:()=>fe(F),className:"p-1 text-primary-600 hover:bg-primary-50 rounded",children:"Sa"})})]},F.id)})})]})})}),m.length>0&&t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng nhn vin"}),t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:m.length})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"i mun"}),t.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[m.filter(F=>F.soLanDiMuon>0).length," NV"]})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Ngh khng php"}),t.jsxs("div",{className:"text-2xl font-bold text-red-600",children:[m.filter(F=>Number(F.soNgayNghiKhongLuong)>0).length," NV"]})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng tin pht"}),t.jsx("div",{className:"text-2xl font-bold text-red-600",children:G(Object.values(g).reduce((F,I)=>F+I.tongPhat,0))})]})]})]}),e==="dong-bo"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(bs,{className:"text-primary-600",size:20}),"Upload file CSV t my chm cng"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{onClick:()=>{var F;return(F=M.current)==null?void 0:F.click()},className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-primary-400 transition-colors",children:[t.jsx(ua,{className:"mx-auto text-gray-400 mb-3",size:48}),P?t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-800",children:P.name}),t.jsxs("p",{className:"text-sm text-gray-500",children:[(P.size/1024).toFixed(1)," KB"]})]}):t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-600",children:"Nhp  chn file CSV"}),t.jsx("p",{className:"text-sm text-gray-400",children:"H tr file t my chm cng (Access Controller)"})]}),t.jsx("input",{ref:M,type:"file",accept:".csv",onChange:he,className:"hidden"})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsxs("button",{onClick:H,disabled:!P||W,className:"flex items-center gap-2 px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[W?t.jsx(Ra,{size:18,className:"animate-spin"}):t.jsx(bs,{size:18}),W?"ang x l...":"ng b d liu"]}),P&&t.jsx("button",{onClick:()=>{j(null),L(null),M.current&&(M.current.value="")},className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"Xa file"})]})]})]}),A&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng bn ghi"}),t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:A.tongBanGhi})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"S ngy cng"}),t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:A.tongNgay})]}),t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Lu thnh cng"}),t.jsxs("div",{className:"text-2xl font-bold text-green-600 flex items-center gap-2",children:[t.jsx(Ma,{size:24})," ",A.luuThanhCong]})]}),t.jsxs("div",{className:"bg-red-50 p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Li"}),t.jsxs("div",{className:"text-2xl font-bold text-red-600 flex items-center gap-2",children:[t.jsx(ho,{size:24})," ",A.luuThatBai]})]})]}),A.thongKe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b",children:t.jsx("h4",{className:"font-semibold",children:"Thng k theo nhn vin"})}),t.jsx("div",{className:"overflow-x-auto max-h-64",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Thng/Nm"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"S cng"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"i mun"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"V sm"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:A.thongKe.map((F,I)=>t.jsxs("tr",{className:F.soLanDiMuon>0||F.soLanVeSom>0?"bg-orange-50":"",children:[t.jsx("td",{className:"px-4 py-2 font-medium",children:F.maNhanVien}),t.jsxs("td",{className:"px-4 py-2 text-center",children:[F.thang,"/",F.nam]}),t.jsx("td",{className:"px-4 py-2 text-center text-blue-600 font-semibold",children:F.soCongThucTe}),t.jsx("td",{className:"px-4 py-2 text-center",children:t.jsx("span",{className:F.soLanDiMuon>0?"text-orange-600 font-semibold":"",children:F.soLanDiMuon})}),t.jsx("td",{className:"px-4 py-2 text-center",children:t.jsx("span",{className:F.soLanVeSom>0?"text-orange-600 font-semibold":"",children:F.soLanVeSom})})]},I))})]})})]}),A.chiTiet.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b",children:t.jsxs("h4",{className:"font-semibold",children:["Chi tit chm cng (",A.chiTiet.length," ngy)"]})}),t.jsxs("div",{className:"overflow-x-auto max-h-96",children:[t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Gi vo"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Gi ra"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:A.chiTiet.slice(0,100).map((F,I)=>t.jsxs("tr",{className:F.diMuon||F.veSom?"bg-orange-50":"",children:[t.jsx("td",{className:"px-4 py-2 font-medium",children:F.maNhanVien}),t.jsx("td",{className:"px-4 py-2",children:F.ngay}),t.jsxs("td",{className:"px-4 py-2 text-center",children:[t.jsx("span",{className:F.diMuon?"text-orange-600 font-semibold":"",children:F.gioVao||"-"}),F.diMuon&&t.jsxs("span",{className:"text-xs text-orange-500 ml-1",children:["(+",F.phutMuon,"p)"]})]}),t.jsxs("td",{className:"px-4 py-2 text-center",children:[t.jsx("span",{className:F.veSom?"text-orange-600 font-semibold":"",children:F.gioRa||"-"}),F.veSom&&t.jsxs("span",{className:"text-xs text-orange-500 ml-1",children:["(-",F.phutSom,"p)"]})]}),t.jsxs("td",{className:"px-4 py-2 text-center",children:[F.diMuon&&t.jsx("span",{className:"px-2 py-0.5 bg-orange-100 text-orange-700 text-xs rounded mr-1",children:"Mun"}),F.veSom&&t.jsx("span",{className:"px-2 py-0.5 bg-orange-100 text-orange-700 text-xs rounded",children:"Sm"}),!F.diMuon&&!F.veSom&&t.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded",children:"OK"})]})]},I))})]}),A.chiTiet.length>100&&t.jsxs("div",{className:"px-4 py-2 bg-gray-50 text-center text-sm text-gray-500",children:["Hin th 100/",A.chiTiet.length," bn ghi"]})]})]}),A.loi.length>0&&t.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[t.jsxs("h4",{className:"font-semibold text-red-800 mb-2",children:[" Li (",A.loi.length,")"]}),t.jsx("ul",{className:"text-sm text-red-700 space-y-1 list-disc ml-5",children:A.loi.map((F,I)=>t.jsx("li",{children:F},I))})]})]}),t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:" Hng dn:"}),t.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc ml-5",children:[t.jsx("li",{children:"Upload file CSV xut t my chm cng (Access Controller)"}),t.jsxs("li",{children:["Format: Tn ring, H, ",t.jsx("strong",{children:"ID (m NV)"}),", B phn, ",t.jsx("strong",{children:"Ngy"}),", ",t.jsx("strong",{children:"Thi gian"}),", ..."]}),t.jsx("li",{children:"H thng t ng nhn din gi vo (qut u bui sng) v gi ra (qut cui bui chiu)"}),t.jsx("li",{children:"So snh vi gi chun (cu hnh trong tab Cu hnh pht)  xc nh i mun/v sm"}),t.jsx("li",{children:"D liu s c tng hp theo thng v lu vo h thng"})]})]})]}),e==="cau-hinh"&&p&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx("label",{className:"font-medium",children:"Nm p dng:"}),t.jsx("select",{value:s,onChange:F=>l(Number(F.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(F=>t.jsx("option",{value:F,children:F},F))})]}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(na,{className:"text-orange-500",size:20}),"Pht i mun (theo thng)"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"i mun 1-3 ln"}),t.jsx("input",{type:"number",value:Number(p.phatDiMuon1_3Lan),onChange:F=>b({...p,phatDiMuon1_3Lan:Number(F.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"i mun 4-6 ln"}),t.jsx("input",{type:"number",value:Number(p.phatDiMuon4_6Lan),onChange:F=>b({...p,phatDiMuon4_6Lan:Number(F.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"i mun trn 6 ln"}),t.jsx("input",{type:"number",value:Number(p.phatDiMuonTren6Lan),onChange:F=>b({...p,phatDiMuonTren6Lan:Number(F.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]})]}),t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(na,{className:"text-orange-500",size:20}),"Pht v sm (theo thng)"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"V sm 1-3 ln"}),t.jsx("input",{type:"number",value:Number(p.phatVeSom1_3Lan),onChange:F=>b({...p,phatVeSom1_3Lan:Number(F.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"V sm 4-6 ln"}),t.jsx("input",{type:"number",value:Number(p.phatVeSom4_6Lan),onChange:F=>b({...p,phatVeSom4_6Lan:Number(F.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"V sm trn 6 ln"}),t.jsx("input",{type:"number",value:Number(p.phatVeSomTren6Lan),onChange:F=>b({...p,phatVeSomTren6Lan:Number(F.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]})]}),t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(na,{className:"text-red-500",size:20}),"Ngh khng php"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Tin pht mi ngy (VN)"}),t.jsx("input",{type:"number",value:Number(p.phatNghiKhongPhep),onChange:F=>b({...p,phatNghiKhongPhep:Number(F.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",id:"truLuong",checked:p.truLuongNghiKhongPhep,onChange:F=>b({...p,truLuongNghiKhongPhep:F.target.checked}),className:"rounded"}),t.jsx("label",{htmlFor:"truLuong",className:"text-sm text-gray-700",children:"Tr thm lng theo ngy cng (Lng / Cng chun  S ngy ngh)"})]})]})]}),t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(nn,{className:"text-blue-500",size:20}),"Gi lm vic chun"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Gi vo"}),t.jsx("input",{type:"time",value:p.gioVaoChuan,onChange:F=>b({...p,gioVaoChuan:F.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Gi ra"}),t.jsx("input",{type:"time",value:p.gioRaChuan,onChange:F=>b({...p,gioRaChuan:F.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"S pht c php tr"}),t.jsx("input",{type:"number",value:p.phutChoPhepTre,onChange:F=>b({...p,phutChoPhepTre:Number(F.target.value)}),className:"w-full border rounded-lg px-3 py-2"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Nhn vin n tr trong khong thi gian ny khng b tnh i mun"})]})]})]})]}),t.jsx("div",{className:"flex justify-end",children:t.jsxs("button",{onClick:J,className:"flex items-center gap-2 px-6 py-2 bg-primary-600 text-white hover:bg-primary-700 rounded-lg",children:[t.jsx(nl,{size:18}),"Lu cu hnh"]})}),t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:" Cch tnh tin pht:"}),t.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc ml-5",children:[t.jsx("li",{children:"Pht i mun: Tnh theo s ln i mun trong thng (1-3, 4-6, hoc >6 ln)"}),t.jsx("li",{children:"Pht v sm: Tnh theo s ln v sm trong thng"}),t.jsx("li",{children:"Pht ngh khng php: Tin pht  S ngy ngh"}),t.jsx("li",{children:"Tr lng: (Lng c bn  Cng chun)  S ngy ngh khng php"}),t.jsx("li",{children:"Tng pht = Pht i mun + Pht v sm + Pht ngh KP + Tr lng"})]})]})]})]})}const rw=[{value:"VAN_HANH",label:"Vn hnh"},{value:"KINH_DOANH",label:"Kinh doanh"},{value:"VAN_PHONG",label:"Vn phng"},{value:"SAN_XUAT",label:"Sn xut"}],Ob=[{value:"TO",label:"T"},{value:"NHOM",label:"Nhm"},{value:"CA",label:"Ca"}];function sw({node:e,level:n=0,onEdit:a,onDelete:r,onAddChild:s,onManageDonViCon:l,expandedNodes:o,toggleExpand:d}){var m,f,p,b;const u=e.children&&e.children.length>0,h=o.has(e.id);return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 py-2 px-3 hover:bg-gray-50 rounded-lg group",style:{marginLeft:n*24},children:[t.jsx("button",{onClick:()=>d(e.id),className:`w-6 h-6 flex items-center justify-center rounded hover:bg-gray-200 ${u?"":"invisible"}`,children:h?t.jsx(Er,{size:16}):t.jsx(aa,{size:16})}),t.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${n===0?"bg-primary-100 text-primary-600":n===1?"bg-blue-100 text-blue-600":n===2?"bg-green-100 text-green-600":"bg-orange-100 text-orange-600"}`,children:n===0?t.jsx(Fr,{size:16}):t.jsx(sj,{size:16})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-medium text-gray-900",children:e.tenPhongBan}),t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-600",children:e.maPhongBan}),e.loaiPhongBan&&t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-indigo-100 text-indigo-600",children:((m=rw.find(g=>g.value===e.loaiPhongBan))==null?void 0:m.label)||e.loaiPhongBan})]}),e.moTa&&t.jsx("div",{className:"text-xs text-gray-500 truncate",children:e.moTa})]}),t.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[t.jsxs("div",{className:"flex items-center gap-1 text-gray-500",title:"Nhn vin",children:[t.jsx(on,{size:14}),t.jsx("span",{children:((f=e._count)==null?void 0:f.nhanViens)||0})]}),(((p=e._count)==null?void 0:p.donViCons)||0)>0&&t.jsxs("div",{className:"flex items-center gap-1 text-gray-500",title:"n v con",children:[t.jsx(f0,{size:14}),t.jsx("span",{children:(b=e._count)==null?void 0:b.donViCons})]})]}),t.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[t.jsx("button",{onClick:()=>s(e.id),className:"p-1.5 text-green-600 hover:bg-green-50 rounded",title:"Thm phng ban con",children:t.jsx(St,{size:16})}),t.jsx("button",{onClick:()=>l(e),className:"p-1.5 text-purple-600 hover:bg-purple-50 rounded",title:"Qun l T/Ca",children:t.jsx(f0,{size:16})}),t.jsx("button",{onClick:()=>a(e),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:"Sa",children:t.jsx(Or,{size:16})}),t.jsx("button",{onClick:()=>r(e),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Ngng hot ng",children:t.jsx(Ir,{size:16})})]})]}),u&&h&&t.jsx("div",{children:e.children.map(g=>t.jsx(sw,{node:g,level:n+1,onEdit:a,onDelete:r,onAddChild:s,onManageDonViCon:l,expandedNodes:o,toggleExpand:d},g.id))})]})}function kD(){const e=Rt(),[n,a]=E.useState(""),[r,s]=E.useState(new Set),[l,o]=E.useState(!1),[d,u]=E.useState(!1),[h,m]=E.useState(null),[f,p]=E.useState(null),[b,g]=E.useState(null),[y,N]=E.useState({maPhongBan:"",tenPhongBan:"",moTa:"",loaiPhongBan:"",gioVaoChuan:"08:00",gioRaChuan:"17:00",phutChoPhepTre:5}),[C,T]=E.useState({maDonVi:"",tenDonVi:"",loaiDonVi:"TO"}),{data:S,isLoading:k}=Ie({queryKey:["phong-ban-cay"],queryFn:ln.layCayPhongBan}),{data:_}=Ie({queryKey:["phong-ban"],queryFn:ln.layTatCa}),{data:P,refetch:j}=Ie({queryKey:["don-vi-con",b==null?void 0:b.id],queryFn:()=>b?ln.layDonViCon(b.id):Promise.resolve([]),enabled:!!b}),A=De({mutationFn:ln.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["phong-ban-cay"]}),e.invalidateQueries({queryKey:["phong-ban"]}),ae()},onError:O=>{var V,te;alert(((te=(V=O.response)==null?void 0:V.data)==null?void 0:te.message)||"C li xy ra")}}),L=De({mutationFn:({id:O,data:V})=>ln.capNhat(O,V),onSuccess:()=>{e.invalidateQueries({queryKey:["phong-ban-cay"]}),e.invalidateQueries({queryKey:["phong-ban"]}),ae()},onError:O=>{var V,te;alert(((te=(V=O.response)==null?void 0:V.data)==null?void 0:te.message)||"C li xy ra")}}),W=De({mutationFn:ln.ngungHoatDong,onSuccess:()=>{e.invalidateQueries({queryKey:["phong-ban-cay"]}),e.invalidateQueries({queryKey:["phong-ban"]})},onError:O=>{var V,te;alert(((te=(V=O.response)==null?void 0:V.data)==null?void 0:te.message)||"Khng th ngng hot ng phng ban")}}),R=De({mutationFn:({phongBanId:O,data:V})=>ln.taoDonViCon(O,V),onSuccess:()=>{j(),T({maDonVi:"",tenDonVi:"",loaiDonVi:"TO"})},onError:O=>{var V,te;alert(((te=(V=O.response)==null?void 0:V.data)==null?void 0:te.message)||"C li xy ra")}}),M=O=>{s(V=>{const te=new Set(V);return te.has(O)?te.delete(O):te.add(O),te})},q=()=>{const O=new Set,V=te=>{te.forEach(pe=>{O.add(pe.id),pe.children&&V(pe.children)})};S&&V(S),s(O)},ee=()=>{s(new Set)},z=O=>{m(null),p(O||null),N({maPhongBan:"",tenPhongBan:"",moTa:"",loaiPhongBan:"",gioVaoChuan:"08:00",gioRaChuan:"17:00",phutChoPhepTre:5}),o(!0)},fe=O=>{m(O),p(O.phongBanChaId||null),N({maPhongBan:O.maPhongBan,tenPhongBan:O.tenPhongBan,moTa:O.moTa||"",loaiPhongBan:O.loaiPhongBan||"",gioVaoChuan:O.gioVaoChuan||"08:00",gioRaChuan:O.gioRaChuan||"17:00",phutChoPhepTre:O.phutChoPhepTre??5}),o(!0)},ae=()=>{o(!1),m(null),p(null)},J=O=>{if(O.preventDefault(),!y.maPhongBan.trim()||!y.tenPhongBan.trim()){alert("Vui lng nhp m v tn phng ban");return}const V={...y,phongBanChaId:f||void 0,loaiPhongBan:y.loaiPhongBan||void 0};h?L.mutate({id:h.id,data:V}):A.mutate(V)},G=O=>{confirm(`Bn c chc mun ngng hot ng phng ban "${O.tenPhongBan}"?`)&&W.mutate(O.id)},he=O=>{g(O),u(!0)},H=O=>{if(O.preventDefault(),!!b){if(!C.maDonVi.trim()||!C.tenDonVi.trim()){alert("Vui lng nhp m v tn n v");return}R.mutate({phongBanId:b.id,data:C})}},F=O=>O.reduce((V,te)=>V+1+(te.children?F(te.children):0),0),I=S?F(S):0;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Fr,{className:"w-8 h-8 text-primary-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Phng ban"}),t.jsx("p",{className:"text-gray-500",children:"Cu trc t chc cng ty dng cy phn cp"})]})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("button",{onClick:()=>z(),className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[t.jsx(St,{size:20}),"Thm phng ban"]})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary-100 flex items-center justify-center",children:t.jsx(Fr,{className:"w-6 h-6 text-primary-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng phng ban"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:I})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-green-100 flex items-center justify-center",children:t.jsx(on,{className:"w-6 h-6 text-green-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng nhn vin"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:(_==null?void 0:_.reduce((O,V)=>{var te;return O+(((te=V._count)==null?void 0:te.nhanViens)||0)},0))||0})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-purple-100 flex items-center justify-center",children:t.jsx(f0,{className:"w-6 h-6 text-purple-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng T/Ca"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:(_==null?void 0:_.reduce((O,V)=>{var te;return O+(((te=V._count)==null?void 0:te.donViCons)||0)},0))||0})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-100 flex items-center justify-center",children:t.jsx(k_,{className:"w-6 h-6 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Cp su nht"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Math.max(...(_==null?void 0:_.map(O=>O.capDo))||[0],0)})]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:q,className:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50",children:"M tt c"}),t.jsx("button",{onClick:ee,className:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50",children:"Thu gn"})]}),t.jsxs("div",{className:"relative max-w-xs",children:[t.jsx(Ss,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),t.jsx("input",{type:"text",placeholder:"Tm kim...",className:"w-full pl-9 pr-4 py-1.5 text-sm border rounded-lg focus:ring-2 focus:ring-primary-500",value:n,onChange:O=>a(O.target.value)})]})]}),t.jsx("div",{className:"p-4",children:k?t.jsx("div",{className:"text-center py-8 text-gray-500",children:"ang ti..."}):!S||S.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(Fr,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Cha c phng ban no"}),t.jsx("button",{onClick:()=>z(),className:"mt-3 text-primary-600 hover:text-primary-700 text-sm font-medium",children:"+ Thm phng ban u tin"})]}):t.jsx("div",{className:"space-y-1",children:S.map(O=>t.jsx(sw,{node:O,onEdit:fe,onDelete:G,onAddChild:z,onManageDonViCon:he,expandedNodes:r,toggleExpand:M},O.id))})})]}),l&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:h?"Cp nht phng ban":"Thm phng ban mi"}),t.jsxs("form",{onSubmit:J,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban cha"}),t.jsxs("select",{value:f||"",onChange:O=>p(O.target.value?Number(O.target.value):null),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",children:[t.jsx("option",{value:"",children:"-- Khng c (phng ban gc) --"}),_==null?void 0:_.filter(O=>!h||O.id!==h.id).map(O=>t.jsxs("option",{value:O.id,children:["".repeat(O.capDo-1)," ",O.tenPhongBan]},O.id))]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["M phng ban ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:y.maPhongBan,onChange:O=>N({...y,maPhongBan:O.target.value.toUpperCase()}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"VD: HR, IT..."})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn phng ban ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:y.tenPhongBan,onChange:O=>N({...y,tenPhongBan:O.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"VD: Phng Nhn s..."})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi phng ban"}),t.jsxs("select",{value:y.loaiPhongBan,onChange:O=>N({...y,loaiPhongBan:O.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",children:[t.jsx("option",{value:"",children:"-- Chn loi --"}),rw.map(O=>t.jsx("option",{value:O.value,children:O.label},O.value))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("input",{type:"text",value:y.moTa,onChange:O=>N({...y,moTa:O.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"M t ngn..."})]})]}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(nn,{className:"w-5 h-5 text-indigo-600"}),t.jsx("h3",{className:"font-medium text-gray-900",children:"Gi lm vic"})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi vo"}),t.jsx("input",{type:"time",value:y.gioVaoChuan,onChange:O=>N({...y,gioVaoChuan:O.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi ra"}),t.jsx("input",{type:"time",value:y.gioRaChuan,onChange:O=>N({...y,gioRaChuan:O.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cho php tr"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"number",min:"0",max:"60",value:y.phutChoPhepTre,onChange:O=>N({...y,phutChoPhepTre:Number(O.target.value)}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 pr-12"}),t.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm",children:"pht"})]})]})]})]}),t.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[t.jsx("button",{type:"button",onClick:ae,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",disabled:A.isPending||L.isPending,className:"flex-1 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:A.isPending||L.isPending?"ang lu...":h?"Cp nht":"Thm mi"})]})]})]})}),d&&b&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["T/Ca/Nhm - ",b.tenPhongBan]}),t.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),t.jsxs("form",{onSubmit:H,className:"flex items-end gap-3 mb-4 p-4 bg-gray-50 rounded-lg",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M"}),t.jsx("input",{type:"text",value:C.maDonVi,onChange:O=>T({...C,maDonVi:O.target.value.toUpperCase()}),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"TO_A"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn"}),t.jsx("input",{type:"text",value:C.tenDonVi,onChange:O=>T({...C,tenDonVi:O.target.value}),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"T A"})]}),t.jsxs("div",{className:"w-32",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi"}),t.jsx("select",{value:C.loaiDonVi,onChange:O=>T({...C,loaiDonVi:O.target.value}),className:"w-full px-3 py-2 border rounded-lg text-sm",children:Ob.map(O=>t.jsx("option",{value:O.value,children:O.label},O.value))})]}),t.jsx("button",{type:"submit",disabled:R.isPending,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:t.jsx(St,{size:18})})]}),P&&P.length>0?t.jsx("div",{className:"divide-y",children:P.map(O=>{var V;return t.jsxs("div",{className:"flex items-center justify-between py-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${O.loaiDonVi==="TO"?"bg-blue-100 text-blue-600":O.loaiDonVi==="NHOM"?"bg-green-100 text-green-600":"bg-orange-100 text-orange-600"}`,children:t.jsx(f0,{size:16})}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:O.tenDonVi}),t.jsxs("div",{className:"text-xs text-gray-500",children:[O.maDonVi,"  ",(V=Ob.find(te=>te.value===O.loaiDonVi))==null?void 0:V.label]})]})]}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${O.trangThai==="HOAT_DONG"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:O.trangThai==="HOAT_DONG"?"Hot ng":"Ngng"})]},O.id)})}):t.jsx("div",{className:"text-center py-8 text-gray-500",children:"Cha c n v con no"})]})})]})}const Kh={LUONG_THANG_CO_DINH:{label:"C nh theo thng",desc:"Nhn  s tin mi thng, khng ph thuc ngy cng"},THEO_NGAY_CONG:{label:"Theo ngy cng",desc:"Tnh theo cng thc: S tin  (Ngy cng thc t / Ngy cng l thuyt)"},CHUYEN_CAN_DIEU_KIEN:{label:"Chuyn cn c iu kin",desc:"Nhn  nu ngh khng php  2 ngy, mt ht nu > 2 ngy"}};function TD(){var Q;const[e,n]=E.useState("phucap"),a=Rt(),[r,s]=E.useState(!1),[l,o]=E.useState(null),[d,u]=E.useState(""),[h,m]=E.useState({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",cachTinh:"LUONG_THANG_CO_DINH",chiuThue:!1,moTa:"",thuTu:0}),{data:f,isLoading:p}=Ie({queryKey:["khoan-luong"],queryFn:()=>Dr.layTatCa()}),b=(f==null?void 0:f.filter(oe=>d===""||oe.loai===d))||[],g=De({mutationFn:Dr.taoMoi,onSuccess:()=>{a.invalidateQueries({queryKey:["khoan-luong"]}),le.success("To ph cp thnh cng!"),C()},onError:oe=>{var X,ve;le.error(((ve=(X=oe.response)==null?void 0:X.data)==null?void 0:ve.message)||"C li xy ra")}}),y=De({mutationFn:({id:oe,data:X})=>Dr.capNhat(oe,X),onSuccess:()=>{a.invalidateQueries({queryKey:["khoan-luong"]}),le.success("Cp nht ph cp thnh cng!"),C()},onError:oe=>{var X,ve;le.error(((ve=(X=oe.response)==null?void 0:X.data)==null?void 0:ve.message)||"C li xy ra")}}),N=De({mutationFn:Dr.xoa,onSuccess:()=>{a.invalidateQueries({queryKey:["khoan-luong"]}),le.success("Xa ph cp thnh cng!")},onError:oe=>{var X,ve;le.error(((ve=(X=oe.response)==null?void 0:X.data)==null?void 0:ve.message)||"C li xy ra")}}),C=()=>{s(!1),o(null),m({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",cachTinh:"LUONG_THANG_CO_DINH",chiuThue:!1,moTa:"",thuTu:0})},T=oe=>{o(oe),m({maKhoan:oe.maKhoan,tenKhoan:oe.tenKhoan,loai:oe.loai,cachTinh:oe.cachTinh||"LUONG_THANG_CO_DINH",chiuThue:oe.chiuThue,moTa:oe.moTa||"",thuTu:oe.thuTu}),s(!0)},S=()=>{if(!h.maKhoan||!h.tenKhoan){le.error("Vui lng in m v tn ph cp");return}l?y.mutate({id:l.id,data:h}):g.mutate(h)},k=oe=>{confirm(`Bn c chc mun xa ph cp "${oe.tenKhoan}"?`)&&N.mutate(oe.id)},[_,P]=E.useState({nam:new Date().getFullYear(),tyLeBHXH_NV:8,tyLeBHYT_NV:1.5,tyLeBHTN_NV:1,tyLeBHXH_DN:17.5,tyLeBHYT_DN:3,tyLeBHTN_DN:1,tyLeBHXH_KPCCD_NV:.5,tyLeBHXH_KPCCD_DN:1,mucLuongCoSo:18e5,mucLuongToiThieu:496e4}),[j,A]=E.useState(!1),[L,W]=E.useState(null),[R,M]=E.useState({maBien:"",tenBien:"",moTa:"",giaTri:0,donVi:"VND"}),{data:q,isLoading:ee}=Ie({queryKey:["cau-hinh-don-gia"],queryFn:()=>jd.layTatCa()}),z=De({mutationFn:jd.taoMoi,onSuccess:()=>{a.invalidateQueries({queryKey:["cau-hinh-don-gia"]}),le.success("To n gi thnh cng!"),G()},onError:oe=>{var X,ve;le.error(((ve=(X=oe.response)==null?void 0:X.data)==null?void 0:ve.message)||"C li xy ra")}}),fe=De({mutationFn:({id:oe,data:X})=>jd.capNhat(oe,X),onSuccess:()=>{a.invalidateQueries({queryKey:["cau-hinh-don-gia"]}),le.success("Cp nht n gi thnh cng!"),G()},onError:oe=>{var X,ve;le.error(((ve=(X=oe.response)==null?void 0:X.data)==null?void 0:ve.message)||"C li xy ra")}}),ae=De({mutationFn:jd.xoa,onSuccess:()=>{a.invalidateQueries({queryKey:["cau-hinh-don-gia"]}),le.success("Xa n gi thnh cng!")},onError:oe=>{var X,ve;le.error(((ve=(X=oe.response)==null?void 0:X.data)==null?void 0:ve.message)||"C li xy ra")}}),J=De({mutationFn:jd.khoiTaoMau,onSuccess:oe=>{a.invalidateQueries({queryKey:["cau-hinh-don-gia"]}),le.success(oe.message||"Khi to n gi mu thnh cng!")},onError:oe=>{var X,ve;le.error(((ve=(X=oe.response)==null?void 0:X.data)==null?void 0:ve.message)||"C li xy ra")}}),G=()=>{A(!1),W(null),M({maBien:"",tenBien:"",moTa:"",giaTri:0,donVi:"VND"})},he=oe=>{W(oe),M({maBien:oe.maBien,tenBien:oe.tenBien,moTa:oe.moTa||"",giaTri:Number(oe.giaTri),donVi:oe.donVi||"VND"}),A(!0)},H=()=>{if(!R.maBien||!R.tenBien){le.error("Vui lng in m v tn n gi");return}L?fe.mutate({id:L.id,data:{tenBien:R.tenBien,moTa:R.moTa,giaTri:R.giaTri,donVi:R.donVi}}):z.mutate(R)},F=oe=>{confirm(`Bn c chc mun xa n gi "${oe.tenBien}"?`)&&ae.mutate(oe.id)},{data:I,isLoading:O}=Ie({queryKey:["thong-tin-cong-ty"],queryFn:kb.lay}),[V,te]=E.useState({tenCongTy:"",maSoThue:"",diaChi:"",dienThoai:"",email:"",website:"",nguoiDaiDien:"",chucVuDaiDien:""});E.useEffect(()=>{I&&te(I)},[I]);const pe=De({mutationFn:kb.capNhat,onSuccess:()=>{a.invalidateQueries({queryKey:["thong-tin-cong-ty"]}),le.success("Cp nht thng tin cng ty thnh cng!")},onError:()=>{le.error("C li khi cp nht thng tin cng ty")}}),U=async oe=>{oe.preventDefault(),le.success("Lu cu hnh BHXH/Thu thnh cng!")},ce=async oe=>{oe.preventDefault(),await pe.mutateAsync(V)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Zs,{className:"w-8 h-8 text-blue-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Ci t h thng"}),t.jsx("p",{className:"text-gray-600",children:"Qun l cu hnh BHXH, thu v thng tin cng ty"})]})]}),t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"border-b",children:t.jsxs("div",{className:"flex gap-4",children:[t.jsx("button",{onClick:()=>n("phucap"),className:`px-4 py-3 font-medium border-b-2 transition-colors ${e==="phucap"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(w_,{className:"w-4 h-4"}),"Ph cp & Khon lng"]})}),t.jsx("button",{onClick:()=>n("bhxh"),className:`px-4 py-3 font-medium border-b-2 transition-colors ${e==="bhxh"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ua,{className:"w-4 h-4"}),"BHXH / Thu"]})}),t.jsx("button",{onClick:()=>n("congty"),className:`px-4 py-3 font-medium border-b-2 transition-colors ${e==="congty"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Fr,{className:"w-4 h-4"}),"Thng tin cng ty"]})}),t.jsx("button",{onClick:()=>n("dongia"),className:`px-4 py-3 font-medium border-b-2 transition-colors ${e==="dongia"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ar,{className:"w-4 h-4"}),"n gi sn lng"]})})]})}),t.jsxs("div",{className:"p-6",children:[e==="phucap"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Danh sch Ph cp & Khon lng"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Cu hnh cc khon ph cp, thu nhp, khu tr p dng cho nhn vin"})]}),t.jsxs("button",{onClick:()=>s(!0),className:"btn btn-primary",children:[t.jsx(St,{size:18}),"Thm mi"]})]}),t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsxs("select",{value:d,onChange:oe=>u(oe.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c loi"}),t.jsx("option",{value:"THU_NHAP",children:"Thu nhp"}),t.jsx("option",{value:"KHAU_TRU",children:"Khu tr"})]}),t.jsxs("span",{className:"text-sm text-gray-500",children:["Tng: ",b.length," khon"]})]}),p?t.jsx("div",{className:"text-center py-8",children:t.jsx(In,{className:"w-8 h-8 animate-spin mx-auto text-blue-600"})}):t.jsx("div",{className:"overflow-x-auto border rounded-lg",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"M"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Tn khon"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Loi"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Cch tnh"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Chu thu"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Th t"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Thao tc"})]})}),t.jsx("tbody",{children:b.map(oe=>{var X;return t.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4 font-mono text-sm",children:oe.maKhoan}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:oe.tenKhoan}),oe.moTa&&t.jsx("div",{className:"text-xs text-gray-500",children:oe.moTa})]})}),t.jsx("td",{className:"py-3 px-4",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${oe.loai==="THU_NHAP"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:oe.loai==="THU_NHAP"?"Thu nhp":"Khu tr"})}),t.jsx("td",{className:"py-3 px-4",children:t.jsx("span",{className:"text-sm",children:((X=Kh[oe.cachTinh])==null?void 0:X.label)||oe.cachTinh})}),t.jsx("td",{className:"py-3 px-4 text-center",children:oe.chiuThue?t.jsx("span",{className:"text-green-600",children:""}):t.jsx("span",{className:"text-gray-400",children:"-"})}),t.jsx("td",{className:"py-3 px-4 text-center text-gray-500",children:oe.thuTu}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>T(oe),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Sa",children:t.jsx(Or,{size:16})}),t.jsx("button",{onClick:()=>k(oe),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Xa",children:t.jsx(Ir,{size:16})})]})})]},oe.id)})})]})}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Hng dn cch tnh lng"}),t.jsx("div",{className:"space-y-2 text-sm text-blue-800",children:Object.entries(Kh).map(([oe,X])=>t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("span",{className:"font-medium min-w-[180px]",children:[X.label,":"]}),t.jsx("span",{children:X.desc})]},oe))})]})]}),e==="bhxh"&&t.jsxs("form",{onSubmit:U,className:"space-y-6 max-w-3xl",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Cu hnh BHXH/BHYT/BHTN"}),t.jsx("div",{className:"grid grid-cols-2 gap-4 mb-6",children:t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Nm p dng"})}),t.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.nam,onChange:oe=>P({..._,nam:Number(oe.target.value)})})]})}),t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:[t.jsx("h4",{className:"font-semibold text-blue-900 mb-3",children:"T l ng Nhn vin (%)"}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHXH"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.tyLeBHXH_NV,onChange:oe=>P({..._,tyLeBHXH_NV:Number(oe.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHYT"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.tyLeBHYT_NV,onChange:oe=>P({..._,tyLeBHYT_NV:Number(oe.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHTN"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.tyLeBHTN_NV,onChange:oe=>P({..._,tyLeBHTN_NV:Number(oe.target.value)})})]})]})]}),t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg mb-4",children:[t.jsx("h4",{className:"font-semibold text-green-900 mb-3",children:"T l ng Doanh nghip (%)"}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHXH"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.tyLeBHXH_DN,onChange:oe=>P({..._,tyLeBHXH_DN:Number(oe.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHYT"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.tyLeBHYT_DN,onChange:oe=>P({..._,tyLeBHYT_DN:Number(oe.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHTN"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.tyLeBHTN_DN,onChange:oe=>P({..._,tyLeBHTN_DN:Number(oe.target.value)})})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Mc lng c s (VN)"})}),t.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.mucLuongCoSo,onChange:oe=>P({..._,mucLuongCoSo:Number(oe.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Mc lng ti thiu vng (VN)"})}),t.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.mucLuongToiThieu,onChange:oe=>P({..._,mucLuongToiThieu:Number(oe.target.value)})})]})]}),t.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 p-4 rounded-lg text-sm text-yellow-800",children:[t.jsx("strong",{children:"Lu :"})," Cc t l ny s c p dng cho tt c nhn vin khi tnh lng. Vui lng kim tra k trc khi lu."]})]}),t.jsx("div",{className:"flex justify-end gap-2",children:t.jsxs("button",{type:"submit",className:"btn btn-primary",children:[t.jsx(nl,{className:"w-4 h-4"}),"Lu cu hnh"]})})]}),e==="congty"&&t.jsx("form",{onSubmit:ce,className:"space-y-6 max-w-3xl",children:O?t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx(In,{className:"w-8 h-8 animate-spin text-blue-600"})}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thng tin cng ty"}),t.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Tn cng ty *"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:V.tenCongTy||"",onChange:oe=>te({...V,tenCongTy:oe.target.value}),required:!0})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"M s thu"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:V.maSoThue||"",onChange:oe=>te({...V,maSoThue:oe.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"in thoi"})}),t.jsx("input",{type:"tel",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:V.dienThoai||"",onChange:oe=>te({...V,dienThoai:oe.target.value})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"a ch"})}),t.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",rows:2,value:V.diaChi||"",onChange:oe=>te({...V,diaChi:oe.target.value})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Email"})}),t.jsx("input",{type:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:V.email||"",onChange:oe=>te({...V,email:oe.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Website"})}),t.jsx("input",{type:"url",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:V.website||"",onChange:oe=>te({...V,website:oe.target.value})})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Ngi i din"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:V.nguoiDaiDien||"",onChange:oe=>te({...V,nguoiDaiDien:oe.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Chc v ngi i din"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:V.chucVuDaiDien||"",onChange:oe=>te({...V,chucVuDaiDien:oe.target.value})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Logo (URL)"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:V.logo||"",onChange:oe=>te({...V,logo:oe.target.value}),placeholder:"https://example.com/logo.png"}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Nhp URL ca logo cng ty (hin th trn phiu lng)"})]})]}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg text-sm text-blue-800 mt-4",children:[t.jsx("strong",{children:"Lu :"})," Thng tin ny s c hin th trn cc phiu lng khi xut."]})]}),t.jsx("div",{className:"flex justify-end gap-2",children:t.jsx("button",{type:"submit",className:"btn btn-primary",disabled:pe.isPending,children:pe.isPending?t.jsxs(t.Fragment,{children:[t.jsx(In,{className:"w-4 h-4 animate-spin"}),"ang lu..."]}):t.jsxs(t.Fragment,{children:[t.jsx(nl,{className:"w-4 h-4"}),"Lu thng tin"]})})})]})}),e==="dongia"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Cu hnh n gi sn lng"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Thit lp n gi  tnh thng/pht da trn sn lng, giao hng"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:()=>J.mutate(),disabled:J.isPending,className:"btn btn-secondary",children:[t.jsx(Ra,{size:18,className:J.isPending?"animate-spin":""}),"Khi to mu"]}),t.jsxs("button",{onClick:()=>A(!0),className:"btn btn-primary",children:[t.jsx(St,{size:18}),"Thm n gi"]})]})]}),ee?t.jsx("div",{className:"text-center py-8",children:t.jsx(In,{className:"w-8 h-8 animate-spin mx-auto text-blue-600"})}):q&&q.length>0?t.jsx("div",{className:"overflow-x-auto border rounded-lg",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"M bin"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Tn n gi"}),t.jsx("th",{className:"text-right py-3 px-4 text-sm font-semibold text-gray-600",children:"Gi tr"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"n v"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"M t"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Thao tc"})]})}),t.jsx("tbody",{children:q.map(oe=>t.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4 font-mono text-sm text-blue-600",children:oe.maBien}),t.jsx("td",{className:"py-3 px-4 font-medium",children:oe.tenBien}),t.jsx("td",{className:"py-3 px-4 text-right font-semibold text-green-600",children:Number(oe.giaTri).toLocaleString("vi-VN")}),t.jsx("td",{className:"py-3 px-4 text-center",children:t.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded text-sm",children:oe.donVi||"VND"})}),t.jsx("td",{className:"py-3 px-4 text-sm text-gray-500 max-w-xs truncate",children:oe.moTa}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>he(oe),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Sa",children:t.jsx(Or,{size:16})}),t.jsx("button",{onClick:()=>F(oe),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Xa",children:t.jsx(Ir,{size:16})})]})})]},oe.id))})]})}):t.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-dashed",children:[t.jsx(Ar,{className:"w-12 h-12 mx-auto text-gray-400 mb-3"}),t.jsx("p",{className:"text-gray-600 mb-2",children:"Cha c n gi no c cu hnh"}),t.jsx("p",{className:"text-sm text-gray-500 mb-4",children:'Nhn "Khi to mu"  to cc n gi mc nh'}),t.jsxs("button",{onClick:()=>J.mutate(),disabled:J.isPending,className:"btn btn-primary",children:[t.jsx(Ra,{size:18,className:J.isPending?"animate-spin":""}),"Khi to n gi mu"]})]}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Hng dn s dng"}),t.jsxs("div",{className:"space-y-2 text-sm text-blue-800",children:[t.jsxs("p",{children:[" ",t.jsx("strong",{children:"DON_GIA_SP"}),": n gi thng cho mi sn phm t"]}),t.jsxs("p",{children:[" ",t.jsx("strong",{children:"DON_GIA_KHOI_LUONG"}),": n gi thng cho mi n v khi lng giao hng"]}),t.jsxs("p",{children:[" ",t.jsx("strong",{children:"DON_GIA_PHAT_TRE"}),": S tin pht cho mi ln tr gi"]}),t.jsxs("p",{children:[" ",t.jsx("strong",{children:"HE_SO_LOI_SP"}),": H s nhn khi tnh pht sn phm li"]}),t.jsx("p",{className:"mt-2 pt-2 border-t border-blue-200",children:"Cc bin ny s c s dng trong cng thc tnh lng khi c d liu sn lng."})]})]})]})]})]}),r&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:l?"Sa khon ph cp":"Thm khon ph cp mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M khon *"}),t.jsx("input",{type:"text",value:h.maKhoan,onChange:oe=>m({...h,maKhoan:oe.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: PHU_CAP_AN_TRUA",disabled:!!l})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Th t hin th"}),t.jsx("input",{type:"number",value:h.thuTu,onChange:oe=>m({...h,thuTu:Number(oe.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tn khon *"}),t.jsx("input",{type:"text",value:h.tenKhoan,onChange:oe=>m({...h,tenKhoan:oe.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ph cp n tra"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi khon"}),t.jsxs("select",{value:h.loai,onChange:oe=>m({...h,loai:oe.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"THU_NHAP",children:"Thu nhp (cng vo lng)"}),t.jsx("option",{value:"KHAU_TRU",children:"Khu tr (tr khi lng)"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chu thu TNCN"}),t.jsxs("select",{value:h.chiuThue?"true":"false",onChange:oe=>m({...h,chiuThue:oe.target.value==="true"}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"false",children:"Khng chu thu"}),t.jsx("option",{value:"true",children:"C chu thu"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Cch tnh lng"}),t.jsx("select",{value:h.cachTinh,onChange:oe=>m({...h,cachTinh:oe.target.value}),className:"w-full border rounded-lg px-3 py-2",children:Object.entries(Kh).map(([oe,X])=>t.jsx("option",{value:oe,children:X.label},oe))}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:(Q=Kh[h.cachTinh])==null?void 0:Q.desc})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M t"}),t.jsx("textarea",{value:h.moTa,onChange:oe=>m({...h,moTa:oe.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2,placeholder:"Ghi ch v khon ph cp ny..."})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:C,className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:S,disabled:g.isPending||y.isPending,className:"btn btn-primary",children:g.isPending||y.isPending?"ang lu...":"Lu"})]})]})}),j&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:L?"Chnh sa n gi":"Thm n gi mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M bin *"}),t.jsx("input",{type:"text",value:R.maBien,onChange:oe=>M({...R,maBien:oe.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: DON_GIA_SP",disabled:!!L})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"n v"}),t.jsxs("select",{value:R.donVi,onChange:oe=>M({...R,donVi:oe.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"VND",children:"VND (ng)"}),t.jsx("option",{value:"%",children:"% (phn trm)"}),t.jsx("option",{value:"ln",children:"Ln (h s)"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tn n gi *"}),t.jsx("input",{type:"text",value:R.tenBien,onChange:oe=>M({...R,tenBien:oe.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: n gi sn phm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gi tr *"}),t.jsx("input",{type:"number",value:R.giaTri,onChange:oe=>M({...R,giaTri:Number(oe.target.value)}),className:"w-full border rounded-lg px-3 py-2",step:"0.01"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M t"}),t.jsx("textarea",{value:R.moTa,onChange:oe=>M({...R,moTa:oe.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2,placeholder:"Ghi ch v n gi ny..."})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:G,className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:H,disabled:z.isPending||fe.isPending,className:"btn btn-primary",children:z.isPending||fe.isPending?"ang lu...":"Lu"})]})]})})]})}function CD(){const e=Rt(),[n,a]=E.useState(!1),[r,s]=E.useState(null),[l,o]=E.useState({maNhom:"",tenNhom:"",moTa:"",mauSac:"#3B82F6",trangThai:!0}),{data:d,isLoading:u}=Ie({queryKey:["nhom-nhan-vien"],queryFn:aw}),h=De({mutationFn:cD,onSuccess:()=>{le.success("To nhm thnh cng"),e.invalidateQueries({queryKey:["nhom-nhan-vien"]}),a(!1),p()},onError:y=>{var N,C;le.error(((C=(N=y.response)==null?void 0:N.data)==null?void 0:C.message)||"Li to nhm")}}),m=De({mutationFn:({id:y,data:N})=>dD(y,N),onSuccess:()=>{le.success("Cp nht nhm thnh cng"),e.invalidateQueries({queryKey:["nhom-nhan-vien"]}),s(null),a(!1),p()},onError:y=>{var N,C;le.error(((C=(N=y.response)==null?void 0:N.data)==null?void 0:C.message)||"Li cp nht")}}),f=De({mutationFn:uD,onSuccess:()=>{le.success(" xa nhm"),e.invalidateQueries({queryKey:["nhom-nhan-vien"]})},onError:y=>{var N,C;le.error(((C=(N=y.response)==null?void 0:N.data)==null?void 0:C.message)||"Li xa nhm")}}),p=()=>{o({maNhom:"",tenNhom:"",moTa:"",mauSac:"#3B82F6",trangThai:!0})},b=y=>{o({maNhom:y.maNhom,tenNhom:y.tenNhom,moTa:y.moTa||"",mauSac:y.mauSac||"#3B82F6",trangThai:y.trangThai}),s(y.id),a(!0)},g=y=>{y.preventDefault(),r?m.mutate({id:r,data:l}):h.mutate(l)};return u?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Qun l Nhm Nhn vin"}),t.jsxs("button",{onClick:()=>{a(!0),s(null),p()},className:"btn btn-primary flex items-center gap-2",children:[t.jsx(St,{size:20}),"Thm nhm"]})]}),n&&t.jsxs("div",{className:"card mb-6 bg-blue-50 border border-blue-200",children:[t.jsx("h3",{className:"font-semibold mb-4",children:r?"Sa nhm":"To nhm mi"}),t.jsxs("form",{onSubmit:g,className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M nhm *"}),t.jsx("input",{type:"text",value:l.maNhom,onChange:y=>o({...l,maNhom:y.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: NHOM_KT, NHOM_HR...",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tn nhm *"}),t.jsx("input",{type:"text",value:l.tenNhom,onChange:y=>o({...l,tenNhom:y.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Nhm K ton, Nhm HR...",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M t"}),t.jsx("input",{type:"text",value:l.moTa,onChange:y=>o({...l,moTa:y.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"M t ngn v nhm..."})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Mu sc"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"color",value:l.mauSac,onChange:y=>o({...l,mauSac:y.target.value}),className:"w-10 h-10 rounded cursor-pointer"}),t.jsx("span",{className:"text-sm text-gray-500",children:l.mauSac})]})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Trng thi"}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:l.trangThai,onChange:y=>o({...l,trangThai:y.target.checked}),className:"w-4 h-4 rounded"}),t.jsx("span",{className:"text-sm",children:"ang hot ng"})]})]})]}),t.jsxs("div",{className:"col-span-2 flex gap-2",children:[t.jsx("button",{type:"submit",disabled:h.isPending||m.isPending,className:"btn btn-primary",children:r?"Cp nht":"To mi"}),t.jsx("button",{type:"button",onClick:()=>{a(!1),s(null)},className:"btn btn-secondary",children:"Hy"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[d==null?void 0:d.map(y=>{var N;return t.jsxs("div",{className:`card ${y.trangThai?"":"opacity-60"}`,style:{borderLeftWidth:"4px",borderLeftColor:y.mauSac||"#6B7280"},children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center text-white font-bold text-lg",style:{backgroundColor:y.mauSac||"#6B7280"},children:y.tenNhom.charAt(0).toUpperCase()}),t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold",children:y.tenNhom}),t.jsx("div",{className:"text-xs text-gray-500",children:y.maNhom})]})]}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{onClick:()=>b(y),className:"p-1.5 hover:bg-blue-100 rounded text-blue-600",title:"Sa",children:t.jsx(Or,{size:16})}),t.jsx("button",{onClick:()=>{confirm(`Xc nhn xa nhm "${y.tenNhom}"?`)&&f.mutate(y.id)},className:"p-1.5 hover:bg-red-100 rounded text-red-600",title:"Xa",children:t.jsx(Ir,{size:16})})]})]}),y.moTa&&t.jsx("div",{className:"text-sm text-gray-600 mt-2",children:y.moTa}),t.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t",children:[t.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[t.jsx(on,{size:16}),t.jsxs("span",{children:[((N=y._count)==null?void 0:N.thanhViens)||0," thnh vin"]})]}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${y.trangThai?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:y.trangThai?"Hot ng":"Tm dng"})]})]},y.id)}),(d==null?void 0:d.length)===0&&t.jsxs("div",{className:"col-span-3 text-center py-12 text-gray-500 bg-gray-50 rounded-lg",children:[t.jsx(on,{size:48,className:"mx-auto mb-4 text-gray-300"}),t.jsx("p",{children:"Cha c nhm no"}),t.jsxs("button",{onClick:()=>{a(!0),s(null),p()},className:"btn btn-primary mt-4",children:[t.jsx(St,{size:20}),"To nhm u tin"]})]})]}),t.jsxs("div",{className:"mt-6 bg-blue-50 p-4 rounded-lg text-sm text-blue-800",children:[t.jsx("strong",{children:" Hng dn:"})," Nhm nhn vin c s dng trong Rule Engine  p dng cc quy tc tnh lng khc nhau cho tng nhm. V d: nhm Qun l c ph cp chc v, nhm K thut c ph cp c hi..."]})]})}function SD(){const e=xr(),{dangNhap:n,isAuthenticated:a}=ns(),[r,s]=E.useState(""),[l,o]=E.useState(""),[d,u]=E.useState(!1),[h,m]=E.useState("");if(a)return e("/",{replace:!0}),null;const f=async p=>{var b,g;if(p.preventDefault(),m(""),!r||!l){m("Vui lng nhp tn ng nhp v mt khu");return}u(!0);try{await n(r,l),e("/",{replace:!0})}catch(y){m(((g=(b=y.response)==null?void 0:b.data)==null?void 0:g.message)||"ng nhp tht bi")}finally{u(!1)}};return t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:t.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg p-8",children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-blue-100 mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"H thng Tnh Lng"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"ng nhp  tip tc"})]}),h&&t.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:h}),t.jsxs("form",{onSubmit:f,className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"tenDangNhap",className:"block text-sm font-medium text-gray-700 mb-2",children:"Tn ng nhp"}),t.jsx("input",{type:"text",id:"tenDangNhap",value:r,onChange:p=>s(p.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition",placeholder:"Nhp tn ng nhp",autoComplete:"username"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"matKhau",className:"block text-sm font-medium text-gray-700 mb-2",children:"Mt khu"}),t.jsx("input",{type:"password",id:"matKhau",value:l,onChange:p=>o(p.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition",placeholder:"Nhp mt khu",autoComplete:"current-password"})]}),t.jsx("button",{type:"submit",disabled:d,className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium rounded-lg transition flex items-center justify-center",children:d?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"ang ng nhp..."]}):"ng nhp"})]}),t.jsx("div",{className:"mt-6 text-center",children:t.jsxs("p",{className:"text-sm text-gray-500",children:["Ti khon mc nh: ",t.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:"admin"})," / ",t.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:"admin123"})]})})]})})}const _D="tinh_luong_auth",Xa=Jt.create({baseURL:"/api/kpi",headers:{"Content-Type":"application/json"}});Xa.interceptors.request.use(e=>{const n=localStorage.getItem(_D);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const Qo={layTatCa:e=>Xa.get("/template",{params:e}).then(n=>n.data),layTheoId:e=>Xa.get(`/template/${e}`).then(n=>n.data),taoMoi:e=>Xa.post("/template",e).then(n=>n.data),capNhat:(e,n)=>Xa.put(`/template/${e}`,n).then(a=>a.data),themChiTieu:(e,n)=>Xa.post(`/template/${e}/chi-tieu`,n).then(a=>a.data),xoaChiTieu:e=>Xa.delete(`/chi-tieu/${e}`).then(n=>n.data)},of={layTatCa:e=>Xa.get("/ky-danh-gia",{params:e}).then(n=>n.data),layTheoId:e=>Xa.get(`/ky-danh-gia/${e}`).then(n=>n.data),taoMoi:e=>Xa.post("/ky-danh-gia",e).then(n=>n.data),capNhatTrangThai:(e,n)=>Xa.put(`/ky-danh-gia/${e}/trang-thai`,{trangThai:n}).then(a=>a.data)},cf={layTheoNam:e=>Xa.get(`/cau-hinh-thuong/${e}`).then(n=>n.data),taoMoi:e=>Xa.post("/cau-hinh-thuong",e).then(n=>n.data),khoiTaoMacDinh:e=>Xa.post(`/cau-hinh-thuong/khoi-tao/${e}`).then(n=>n.data)};function ED(){var _,P;const[e,n]=E.useState([]),[a,r]=E.useState([]),[s,l]=E.useState(null),[o,d]=E.useState(!0),[u,h]=E.useState(!1),[m,f]=E.useState(!1),[p,b]=E.useState({maTemplate:"",tenTemplate:"",phongBanId:"",moTa:""}),[g,y]=E.useState({maChiTieu:"",tenChiTieu:"",donViTinh:"",trongSo:0,loaiChiTieu:"SO",chiTieuToiThieu:0,chiTieuMucTieu:0,chiTieuVuotMuc:0});E.useEffect(()=>{N()},[]);const N=async()=>{try{const[j,A]=await Promise.all([Qo.layTatCa(),ln.layTatCa()]);n(j),r(A)}catch(j){console.error("Li ti d liu:",j)}finally{d(!1)}},C=async j=>{j.preventDefault();try{await Qo.taoMoi({maTemplate:p.maTemplate,tenTemplate:p.tenTemplate,phongBanId:p.phongBanId?parseInt(p.phongBanId):void 0,moTa:p.moTa||void 0}),h(!1),b({maTemplate:"",tenTemplate:"",phongBanId:"",moTa:""}),N()}catch(A){console.error("Li to template:",A)}},T=async j=>{var A;if(j.preventDefault(),!!s)try{await Qo.themChiTieu(s.id,{...g,thuTu:(((A=s.chiTieuKPIs)==null?void 0:A.length)||0)+1}),f(!1),y({maChiTieu:"",tenChiTieu:"",donViTinh:"",trongSo:0,loaiChiTieu:"SO",chiTieuToiThieu:0,chiTieuMucTieu:0,chiTieuVuotMuc:0}),N();const L=await Qo.layTheoId(s.id);l(L)}catch(L){console.error("Li thm ch tiu:",L)}},S=async j=>{if(confirm("Xc nhn xa ch tiu ny?"))try{if(await Qo.xoaChiTieu(j),N(),s){const A=await Qo.layTheoId(s.id);l(A)}}catch(A){console.error("Li xa ch tiu:",A)}},k=j=>(j==null?void 0:j.reduce((A,L)=>A+Number(L.trongSo),0))||0;return o?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Template KPI"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Thit lp cc ch tiu nh gi KPI"})]}),t.jsxs("button",{onClick:()=>h(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm Template"]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow",children:[t.jsx("div",{className:"p-4 border-b",children:t.jsx("h2",{className:"font-semibold text-gray-800",children:"Danh sch Template"})}),t.jsx("div",{className:"divide-y max-h-[600px] overflow-y-auto",children:e.length===0?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Cha c template no"}):e.map(j=>{var A;return t.jsx("div",{onClick:()=>l(j),className:`p-4 cursor-pointer hover:bg-gray-50 ${(s==null?void 0:s.id)===j.id?"bg-blue-50 border-l-4 border-blue-500":""}`,children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-900",children:j.tenTemplate}),t.jsx("p",{className:"text-sm text-gray-500",children:j.maTemplate}),j.phongBan&&t.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded",children:j.phongBan.tenPhongBan})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("span",{className:"text-sm text-gray-600",children:[((A=j.chiTieuKPIs)==null?void 0:A.length)||0," ch tiu"]}),t.jsxs("div",{className:`text-xs mt-1 ${k(j.chiTieuKPIs)===100?"text-green-600":"text-amber-600"}`,children:["Tng: ",k(j.chiTieuKPIs),"%"]})]})]})},j.id)})})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow",children:[t.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[t.jsx("h2",{className:"font-semibold text-gray-800",children:s?s.tenTemplate:"Chi tit Template"}),s&&t.jsxs("button",{onClick:()=>f(!0),className:"text-blue-600 hover:text-blue-700 text-sm flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm ch tiu"]})]}),s?t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[t.jsxs("p",{className:"text-sm",children:[t.jsx("span",{className:"font-medium",children:"M:"})," ",s.maTemplate]}),s.moTa&&t.jsxs("p",{className:"text-sm mt-1",children:[t.jsx("span",{className:"font-medium",children:"M t:"})," ",s.moTa]}),t.jsxs("p",{className:`text-sm mt-1 ${k(s.chiTieuKPIs)===100?"text-green-600":"text-amber-600"}`,children:[t.jsx("span",{className:"font-medium",children:"Tng trng s:"})," ",k(s.chiTieuKPIs),"%",k(s.chiTieuKPIs)!==100&&" (cn = 100%)"]})]}),t.jsx("div",{className:"space-y-3",children:((_=s.chiTieuKPIs)==null?void 0:_.length)===0?t.jsx("p",{className:"text-gray-500 text-center py-4",children:"Cha c ch tiu"}):(P=s.chiTieuKPIs)==null?void 0:P.map(j=>t.jsxs("div",{className:"border rounded-lg p-3",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900",children:j.tenChiTieu}),t.jsx("p",{className:"text-sm text-gray-500",children:j.maChiTieu})]}),t.jsx("button",{onClick:()=>S(j.id),className:"text-red-500 hover:text-red-700",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),t.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Trng s:"})," ",j.trongSo,"%"]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"n v:"})," ",j.donViTinh]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Loi:"})," ",j.loaiChiTieu]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Mc tiu:"})," ",Number(j.chiTieuMucTieu).toLocaleString()]})]})]},j.id))})]}):t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Chn mt template  xem chi tit"})]})]}),u&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm Template KPI"}),t.jsxs("form",{onSubmit:C,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M template *"}),t.jsx("input",{type:"text",value:p.maTemplate,onChange:j=>b({...p,maTemplate:j.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn template *"}),t.jsx("input",{type:"text",value:p.tenTemplate,onChange:j=>b({...p,tenTemplate:j.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:p.phongBanId,onChange:j=>b({...p,phongBanId:j.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- p dng chung --"}),a.map(j=>t.jsx("option",{value:j.id,children:j.tenPhongBan},j.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:p.moTa,onChange:j=>b({...p,moTa:j.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>h(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To"})]})]})]})}),m&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm Ch tiu KPI"}),t.jsxs("form",{onSubmit:T,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M ch tiu *"}),t.jsx("input",{type:"text",value:g.maChiTieu,onChange:j=>y({...g,maChiTieu:j.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn ch tiu *"}),t.jsx("input",{type:"text",value:g.tenChiTieu,onChange:j=>y({...g,tenChiTieu:j.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n v *"}),t.jsx("input",{type:"text",value:g.donViTinh,onChange:j=>y({...g,donViTinh:j.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VN, %, S...",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng s (%) *"}),t.jsx("input",{type:"number",value:g.trongSo,onChange:j=>y({...g,trongSo:Number(j.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0,max:100,required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi *"}),t.jsxs("select",{value:g.loaiChiTieu,onChange:j=>y({...g,loaiChiTieu:j.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[t.jsx("option",{value:"SO",children:"S lng"}),t.jsx("option",{value:"PHAN_TRAM",children:"Phn trm"}),t.jsx("option",{value:"TIEN",children:"Tin"}),t.jsx("option",{value:"DANH_GIA",children:"nh gi (1-5)"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ti thiu"}),t.jsx("input",{type:"number",value:g.chiTieuToiThieu,onChange:j=>y({...g,chiTieuToiThieu:Number(j.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mc tiu"}),t.jsx("input",{type:"number",value:g.chiTieuMucTieu,onChange:j=>y({...g,chiTieuMucTieu:Number(j.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vt mc"}),t.jsx("input",{type:"number",value:g.chiTieuVuotMuc,onChange:j=>y({...g,chiTieuVuotMuc:Number(j.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Thm"})]})]})]})})]})}const DD={THANG:"Thng",QUY:"Qu",NAM:"Nm"},Ib={CHUA_BAT_DAU:{label:"Cha bt u",color:"bg-gray-100 text-gray-600"},DANG_DIEN_RA:{label:"ang din ra",color:"bg-green-100 text-green-700"},DA_KET_THUC:{label:" kt thc",color:"bg-blue-100 text-blue-700"},DA_DONG:{label:" ng",color:"bg-red-100 text-red-700"}};function FD(){const[e,n]=E.useState([]),[a,r]=E.useState(!0),[s,l]=E.useState(!1),[o,d]=E.useState(new Date().getFullYear()),[u,h]=E.useState({maKy:"",tenKy:"",loaiKy:"THANG",tuNgay:"",denNgay:"",moTa:""});E.useEffect(()=>{m()},[o]);const m=async()=>{r(!0);try{const g=await of.layTatCa({nam:o});n(g)}catch(g){console.error("Li ti d liu:",g)}finally{r(!1)}},f=async g=>{g.preventDefault();try{await of.taoMoi({...u,moTa:u.moTa||void 0}),l(!1),h({maKy:"",tenKy:"",loaiKy:"THANG",tuNgay:"",denNgay:"",moTa:""}),m()}catch(y){console.error("Li to k nh gi:",y)}},p=async(g,y)=>{try{await of.capNhatTrangThai(g,y),m()}catch(N){console.error("Li cp nht trng thi:",N)}},b=g=>new Date(g).toLocaleDateString("vi-VN");return a?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"K nh Gi KPI"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Qun l cc k nh gi hiu sut"})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx("select",{value:o,onChange:g=>d(Number(g.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(g=>t.jsxs("option",{value:g,children:["Nm ",g]},g))}),t.jsxs("button",{onClick:()=>l(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm K nh Gi"]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M k"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tn k"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Loi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"S nh gi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.length===0?t.jsx("tr",{children:t.jsxs("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:["Cha c k nh gi no trong nm ",o]})}):e.map(g=>{var y;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"font-mono text-sm text-gray-900",children:g.maKy})}),t.jsxs("td",{className:"px-6 py-4",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:g.tenKy}),g.moTa&&t.jsx("div",{className:"text-xs text-gray-500",children:g.moTa})]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded",children:DD[g.loaiKy]})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:[b(g.tuNgay)," - ",b(g.denNgay)]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 py-1 text-xs rounded ${Ib[g.trangThai].color}`,children:Ib[g.trangThai].label})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:((y=g._count)==null?void 0:y.danhGias)||0}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:t.jsxs("div",{className:"flex gap-2",children:[g.trangThai==="CHUA_BAT_DAU"&&t.jsx("button",{onClick:()=>p(g.id,"DANG_DIEN_RA"),className:"text-green-600 hover:text-green-800",children:"Bt u"}),g.trangThai==="DANG_DIEN_RA"&&t.jsx("button",{onClick:()=>p(g.id,"DA_KET_THUC"),className:"text-blue-600 hover:text-blue-800",children:"Kt thc"}),g.trangThai==="DA_KET_THUC"&&t.jsx("button",{onClick:()=>p(g.id,"DA_DONG"),className:"text-red-600 hover:text-red-800",children:"ng"}),t.jsx("a",{href:`/kpi/ky-danh-gia/${g.id}`,className:"text-indigo-600 hover:text-indigo-800",children:"Chi tit"})]})})]},g.id)})})]})}),s&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm K nh Gi"}),t.jsxs("form",{onSubmit:f,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M k *"}),t.jsx("input",{type:"text",value:u.maKy,onChange:g=>h({...u,maKy:g.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: KPI-2026-Q1",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi k *"}),t.jsxs("select",{value:u.loaiKy,onChange:g=>h({...u,loaiKy:g.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[t.jsx("option",{value:"THANG",children:"Thng"}),t.jsx("option",{value:"QUY",children:"Qu"}),t.jsx("option",{value:"NAM",children:"Nm"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn k *"}),t.jsx("input",{type:"text",value:u.tenKy,onChange:g=>h({...u,tenKy:g.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: nh gi KPI Qu 1/2026",required:!0})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T ngy *"}),t.jsx(Ht,{value:u.tuNgay,onChange:g=>h({...u,tuNgay:g}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n ngy *"}),t.jsx(Ht,{value:u.denNgay,onChange:g=>h({...u,denNgay:g}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:u.moTa,onChange:g=>h({...u,moTa:g.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To"})]})]})]})})]})}const df={XUAT_SAC:{label:"Xut sc",color:"bg-purple-100 text-purple-700"},TOT:{label:"Tt",color:"bg-green-100 text-green-700"},KHA:{label:"Kh",color:"bg-blue-100 text-blue-700"},TRUNG_BINH:{label:"Trung bnh",color:"bg-yellow-100 text-yellow-700"},YEU:{label:"Yu",color:"bg-red-100 text-red-700"}};function AD(){const[e,n]=E.useState([]),[a,r]=E.useState(!0),[s,l]=E.useState(new Date().getFullYear()),[o,d]=E.useState(!1),[u,h]=E.useState({xepLoai:"TOT",diemToiThieu:0,diemToiDa:100,heSoThuong:1,moTa:""});E.useEffect(()=>{m()},[s]);const m=async()=>{r(!0);try{const b=await cf.layTheoNam(s);n(b)}catch(b){console.error("Li ti d liu:",b)}finally{r(!1)}},f=async()=>{if(confirm(`Khi to cu hnh thng mc nh cho nm ${s}?`))try{await cf.khoiTaoMacDinh(s),m()}catch(b){console.error("Li khi to:",b)}},p=async b=>{b.preventDefault();try{await cf.taoMoi({nam:s,...u,moTa:u.moTa||void 0}),d(!1),m()}catch(g){console.error("Li to cu hnh:",g)}};return a?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Cu hnh Thng KPI"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Thit lp h s thng theo mc xp loi"})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx("select",{value:s,onChange:b=>l(Number(b.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(b=>t.jsxs("option",{value:b,children:["Nm ",b]},b))}),t.jsx("button",{onClick:f,className:"border border-blue-600 text-blue-600 hover:bg-blue-50 px-4 py-2 rounded-lg",children:"Khi to mc nh"}),t.jsxs("button",{onClick:()=>d(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm Cu hnh"]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Xp loi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"im ti thiu"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"im ti a"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"H s thng"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M t"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Trng thi"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.length===0?t.jsx("tr",{children:t.jsxs("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:[t.jsxs("p",{children:["Cha c cu hnh thng cho nm ",s]}),t.jsx("button",{onClick:f,className:"mt-4 text-blue-600 hover:text-blue-700 underline",children:"Khi to cu hnh mc nh"})]})}):e.map(b=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-3 py-1 text-sm rounded-full font-medium ${df[b.xepLoai].color}`,children:df[b.xepLoai].label})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("span",{className:"text-gray-900 font-mono",children:[Number(b.diemToiThieu).toFixed(1),"%"]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("span",{className:"text-gray-900 font-mono",children:[Number(b.diemToiDa).toFixed(2),"%"]})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[t.jsxs("span",{className:"text-lg font-semibold text-indigo-600",children:[Number(b.heSoThuong),"x"]}),t.jsx("span",{className:"text-gray-500 text-sm ml-1",children:"lng c bn"})]}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("span",{className:"text-gray-600 text-sm",children:b.moTa||"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 py-1 text-xs rounded ${b.trangThai?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:b.trangThai?"Hot ng":"Ngng"})})]},b.id))})]})}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[t.jsx("h3",{className:"font-semibold text-blue-800 mb-3",children:" Cng thc tnh thng KPI"}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-blue-700",children:[t.jsxs("div",{children:[t.jsx("p",{children:t.jsx("strong",{children:"Tin thng = Lng c bn  H s thng"})}),t.jsx("p",{className:"mt-2",children:'V d: Nhn vin lng 15,000,000, xp loi "Tt" (h s 1.5x)'}),t.jsxs("p",{children:[" Thng = 15,000,000  1.5 = ",t.jsx("strong",{children:"22,500,000"})]})]}),t.jsxs("div",{children:[t.jsx("p",{children:t.jsx("strong",{children:"im KPI c tnh t:"})}),t.jsxs("ul",{className:"list-disc ml-4 mt-2",children:[t.jsx("li",{children:"Tng im =  (im ch tiu  Trng s)"}),t.jsx("li",{children:"im ch tiu = (Kt qu / Mc tiu)  100"}),t.jsx("li",{children:"Ti a 150% nu vt mc"})]})]})]})]}),o&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm Cu hnh Thng"}),t.jsxs("form",{onSubmit:p,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Xp loi *"}),t.jsx("select",{value:u.xepLoai,onChange:b=>h({...u,xepLoai:b.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:Object.entries(df).map(([b,{label:g}])=>t.jsx("option",{value:b,children:g},b))})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"im ti thiu *"}),t.jsx("input",{type:"number",step:"0.01",value:u.diemToiThieu,onChange:b=>h({...u,diemToiThieu:Number(b.target.value)}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"im ti a *"}),t.jsx("input",{type:"number",step:"0.01",value:u.diemToiDa,onChange:b=>h({...u,diemToiDa:Number(b.target.value)}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"H s thng *"}),t.jsx("input",{type:"number",step:"0.1",value:u.heSoThuong,onChange:b=>h({...u,heSoThuong:Number(b.target.value)}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("input",{type:"text",value:u.moTa,onChange:b=>h({...u,moTa:b.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To"})]})]})]})})]})}const Mb={HOAT_DONG:{label:"Hot ng",color:"bg-green-100 text-green-700"},TAM_KHOA:{label:"Tm kha",color:"bg-yellow-100 text-yellow-700"},NGUNG_HOAT_DONG:{label:"Ngng",color:"bg-red-100 text-red-700"}};function PD(){const[e,n]=E.useState([]),[a,r]=E.useState([]),[s,l]=E.useState(!0),[o,d]=E.useState(!1),[u,h]=E.useState("nguoi-dung"),[m,f]=E.useState({tenDangNhap:"",matKhau:"",hoTen:"",email:"",soDienThoai:"",vaiTroIds:[]}),[p,b]=E.useState({maVaiTro:"",tenVaiTro:"",moTa:"",capDo:50});E.useEffect(()=>{g()},[]);const g=async()=>{try{const[k,_]=await Promise.all([nf.layTatCa(),jb.layTatCa()]);n(k),r(_)}catch(k){console.error("Li ti d liu:",k)}finally{l(!1)}},y=async k=>{k.preventDefault();try{await nf.taoMoi({tenDangNhap:m.tenDangNhap,matKhau:m.matKhau,hoTen:m.hoTen,email:m.email,soDienThoai:m.soDienThoai||void 0,vaiTroIds:m.vaiTroIds}),d(!1),f({tenDangNhap:"",matKhau:"",hoTen:"",email:"",soDienThoai:"",vaiTroIds:[]}),g()}catch(_){console.error("Li to ngi dng:",_)}},N=async k=>{k.preventDefault();try{await jb.taoMoi({maVaiTro:p.maVaiTro,tenVaiTro:p.tenVaiTro,moTa:p.moTa||void 0,capDo:p.capDo}),d(!1),b({maVaiTro:"",tenVaiTro:"",moTa:"",capDo:50}),g()}catch(_){console.error("Li to vai tr:",_)}},C=async(k,_)=>{try{await nf.capNhat(k,{trangThai:_}),g()}catch(P){console.error("Li cp nht:",P)}},T=k=>{f(_=>({..._,vaiTroIds:_.vaiTroIds.includes(k)?_.vaiTroIds.filter(P=>P!==k):[..._.vaiTroIds,k]}))},S=k=>k?new Date(k).toLocaleString("vi-VN"):"-";return s?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Ngi dng & Vai tr"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Phn quyn truy cp h thng"})]}),t.jsxs("button",{onClick:()=>d(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),u==="nguoi-dung"?"Thm Ngi dng":"Thm Vai tr"]})]}),t.jsx("div",{className:"border-b border-gray-200",children:t.jsxs("nav",{className:"-mb-px flex gap-6",children:[t.jsxs("button",{onClick:()=>h("nguoi-dung"),className:`py-3 px-1 border-b-2 font-medium text-sm ${u==="nguoi-dung"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Ngi dng (",e.length,")"]}),t.jsxs("button",{onClick:()=>h("vai-tro"),className:`py-3 px-1 border-b-2 font-medium text-sm ${u==="vai-tro"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Vai tr (",a.length,")"]})]})}),u==="nguoi-dung"?t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngi dng"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Vai tr"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ng nhp cui"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(k=>{var _,P,j;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:t.jsx("span",{className:"text-blue-600 font-medium",children:k.hoTen.charAt(0).toUpperCase()})}),t.jsxs("div",{className:"ml-3",children:[t.jsx("div",{className:"font-medium text-gray-900",children:k.hoTen}),t.jsxs("div",{className:"text-sm text-gray-500",children:["@",k.tenDangNhap]})]})]})}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:k.email}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("div",{className:"flex flex-wrap gap-1",children:((_=k.vaiTros)==null?void 0:_.map(A=>t.jsx("span",{className:"px-2 py-0.5 bg-indigo-100 text-indigo-700 text-xs rounded",children:A.vaiTro.tenVaiTro},A.id)))||t.jsx("span",{className:"text-gray-400 text-sm",children:"Cha gn"})})}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:S(k.lanDangNhapCuoi)}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("span",{className:`px-2 py-1 text-xs rounded ${((P=Mb[k.trangThai])==null?void 0:P.color)||"bg-gray-100"}`,children:((j=Mb[k.trangThai])==null?void 0:j.label)||k.trangThai})}),t.jsx("td",{className:"px-6 py-4 text-sm",children:t.jsxs("div",{className:"flex gap-2",children:[k.trangThai==="HOAT_DONG"&&t.jsx("button",{onClick:()=>C(k.id,"TAM_KHOA"),className:"text-yellow-600 hover:text-yellow-800",children:"Kha"}),k.trangThai==="TAM_KHOA"&&t.jsx("button",{onClick:()=>C(k.id,"HOAT_DONG"),className:"text-green-600 hover:text-green-800",children:"M kha"})]})})]},k.id)})})]})}):t.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map(k=>{var _,P,j,A,L;return t.jsxs("div",{className:"bg-white rounded-lg shadow p-5",children:[t.jsxs("div",{className:"flex justify-between items-start mb-3",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:k.tenVaiTro}),t.jsx("p",{className:"text-sm text-gray-500 font-mono",children:k.maVaiTro})]}),t.jsx("span",{className:`px-2 py-1 text-xs rounded ${k.trangThai?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:k.trangThai?"Hot ng":"Ngng"})]}),k.moTa&&t.jsx("p",{className:"text-sm text-gray-600 mb-3",children:k.moTa}),t.jsxs("div",{className:"flex justify-between items-center text-sm",children:[t.jsxs("span",{className:"text-gray-500",children:["Cp : ",k.capDo]}),t.jsxs("span",{className:"text-indigo-600",children:[((_=k._count)==null?void 0:_.nguoiDungs)||0," ngi dng"]})]}),t.jsxs("div",{className:"mt-3 pt-3 border-t",children:[t.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:["Quyn (",((P=k.quyens)==null?void 0:P.length)||0,"):"]}),t.jsxs("div",{className:"flex flex-wrap gap-1 max-h-20 overflow-y-auto",children:[(j=k.quyens)==null?void 0:j.slice(0,8).map(W=>t.jsx("span",{className:"px-1.5 py-0.5 bg-gray-100 text-gray-600 text-xs rounded",children:W.quyen.tenQuyen},W.id)),(((A=k.quyens)==null?void 0:A.length)||0)>8&&t.jsxs("span",{className:"px-1.5 py-0.5 bg-gray-200 text-gray-700 text-xs rounded",children:["+",(((L=k.quyens)==null?void 0:L.length)||0)-8," quyn"]})]})]})]},k.id)})}),o&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:u==="nguoi-dung"?"Thm Ngi dng":"Thm Vai tr"}),u==="nguoi-dung"?t.jsxs("form",{onSubmit:y,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn ng nhp *"}),t.jsx("input",{type:"text",value:m.tenDangNhap,onChange:k=>f({...m,tenDangNhap:k.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mt khu *"}),t.jsx("input",{type:"password",value:m.matKhau,onChange:k=>f({...m,matKhau:k.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"H tn *"}),t.jsx("input",{type:"text",value:m.hoTen,onChange:k=>f({...m,hoTen:k.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),t.jsx("input",{type:"email",value:m.email,onChange:k=>f({...m,email:k.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vai tr"}),t.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:a.map(k=>t.jsxs("label",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"checkbox",checked:m.vaiTroIds.includes(k.id),onChange:()=>T(k.id),className:"rounded"}),t.jsx("span",{className:"text-sm",children:k.tenVaiTro})]},k.id))})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border rounded-lg",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:"To"})]})]}):t.jsxs("form",{onSubmit:N,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M vai tr *"}),t.jsx("input",{type:"text",value:p.maVaiTro,onChange:k=>b({...p,maVaiTro:k.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: SUPERVISOR",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn vai tr *"}),t.jsx("input",{type:"text",value:p.tenVaiTro,onChange:k=>b({...p,tenVaiTro:k.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cp "}),t.jsx("input",{type:"number",value:p.capDo,onChange:k=>b({...p,capDo:Number(k.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:1,max:100})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:p.moTa,onChange:k=>b({...p,moTa:k.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border rounded-lg",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:"To"})]})]})]})})]})}const uf={TAO:{label:"To mi",color:"bg-green-100 text-green-700",icon:""},SUA:{label:"Cp nht",color:"bg-blue-100 text-blue-700",icon:""},XOA:{label:"Xa",color:"bg-red-100 text-red-700",icon:""},XEM:{label:"Xem",color:"bg-gray-100 text-gray-700",icon:""},DANG_NHAP:{label:"ng nhp",color:"bg-indigo-100 text-indigo-700",icon:""},DANG_XUAT:{label:"ng xut",color:"bg-purple-100 text-purple-700",icon:""},CHOT:{label:"Cht",color:"bg-yellow-100 text-yellow-700",icon:""},MO_KHOA:{label:"M kha",color:"bg-cyan-100 text-cyan-700",icon:""},DUYET:{label:"Duyt",color:"bg-emerald-100 text-emerald-700",icon:""},TU_CHOI:{label:"T chi",color:"bg-orange-100 text-orange-700",icon:""}};function LD(){var C,T;const[e,n]=E.useState([]),[a,r]=E.useState(!0),[s,l]=E.useState(null),[o,d]=E.useState(""),[u,h]=E.useState(""),[m,f]=E.useState(""),[p,b]=E.useState("");E.useEffect(()=>{g()},[o,u,m,p]);const g=async()=>{r(!0);try{const S=await k5.layDanhSach({hanhDong:o||void 0,bangDuLieu:u||void 0,tuNgay:m||void 0,denNgay:p||void 0}),k=Array.isArray(S)?S:(S==null?void 0:S.items)||[];n(k)}catch(S){console.error("Li ti d liu:",S)}finally{r(!1)}},y=S=>new Date(S).toLocaleString("vi-VN"),N=S=>S?JSON.stringify(S,null,2):null;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Audit Log"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Lch s thao tc trn h thng"})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hnh ng"}),t.jsxs("select",{value:o,onChange:S=>d(S.target.value),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),Object.entries(uf).map(([S,{label:k}])=>t.jsx("option",{value:S,children:k},S))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bng d liu"}),t.jsxs("select",{value:u,onChange:S=>h(S.target.value),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"NhanVien",children:"Nhn vin"}),t.jsx("option",{value:"BangLuong",children:"Bng lng"}),t.jsx("option",{value:"KhoanLuong",children:"Khon lng"}),t.jsx("option",{value:"PhongBan",children:"Phng ban"}),t.jsx("option",{value:"NguoiDung",children:"Ngi dng"}),t.jsx("option",{value:"DanhGiaKPI",children:"nh gi KPI"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T ngy"}),t.jsx(Ht,{value:m,onChange:f,className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n ngy"}),t.jsx(Ht,{value:p,onChange:b,className:"w-full border rounded-lg px-3 py-2"})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:a?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):e.length===0?t.jsx("div",{className:"p-12 text-center text-gray-500",children:"Khng c d liu audit log"}):t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngi dng"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Hnh ng"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Bng d liu"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ID bn ghi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Chi tit"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(S=>{const k=uf[S.hanhDong]||{label:S.hanhDong,color:"bg-gray-100",icon:""};return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:y(S.ngayTao)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:S.nguoiDung?t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:t.jsx("span",{className:"text-blue-600 text-xs font-medium",children:S.nguoiDung.hoTen.charAt(0)})}),t.jsx("span",{className:"ml-2 text-sm text-gray-900",children:S.nguoiDung.hoTen})]}):t.jsx("span",{className:"text-gray-400 text-sm",children:"H thng"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("span",{className:`px-2 py-1 text-xs rounded ${k.color}`,children:[k.icon," ",k.label]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:S.bangDuLieu||"-"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 font-mono",children:S.banGhiId||"-"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(S.duLieuCu||S.duLieuMoi)&&t.jsx("button",{onClick:()=>l(S),className:"text-blue-600 hover:text-blue-800 text-sm",children:"Xem chi tit"})})]},S.id)})})]})}),s&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-3xl max-h-[80vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex justify-between items-start mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Chi tit thay i"}),t.jsx("button",{onClick:()=>l(null),className:"text-gray-400 hover:text-gray-600",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Thi gian:"})," ",y(s.ngayTao)]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Ngi dng:"})," ",((C=s.nguoiDung)==null?void 0:C.hoTen)||"H thng"]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Hnh ng:"})," ",(T=uf[s.hanhDong])==null?void 0:T.label]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Bng:"})," ",s.bangDuLieu," #",s.banGhiId]}),s.ipAddress&&t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"IP:"})," ",s.ipAddress]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.duLieuCu&&t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-red-600 mb-2",children:"D liu c"}),t.jsx("pre",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-xs overflow-x-auto",children:N(s.duLieuCu)})]}),s.duLieuMoi&&t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-green-600 mb-2",children:"D liu mi"}),t.jsx("pre",{className:"bg-green-50 border border-green-200 rounded-lg p-3 text-xs overflow-x-auto",children:N(s.duLieuMoi)})]})]})]})})]})}const OD="tinh_luong_auth",kt=Jt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});kt.interceptors.request.use(e=>{const n=localStorage.getItem(OD);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const zs={layDanhSach:e=>kt.get("/quy-che-luong",{params:e}).then(n=>n.data),layChiTiet:e=>kt.get(`/quy-che-luong/${e}`).then(n=>n.data),tao:e=>kt.post("/quy-che-luong",e).then(n=>n.data),capNhat:(e,n)=>kt.put(`/quy-che-luong/${e}`,n).then(a=>a.data),nhanBan:(e,n)=>kt.post(`/quy-che-luong/${e}/nhan-ban`,n).then(a=>a.data),kichHoat:e=>kt.post(`/quy-che-luong/${e}/kich-hoat`).then(n=>n.data),ngung:e=>kt.post(`/quy-che-luong/${e}/ngung`).then(n=>n.data),xoa:e=>kt.delete(`/quy-che-luong/${e}`).then(n=>n.data),layRules:e=>kt.get(`/quy-che-luong/${e}/rules`).then(n=>n.data),taoRule:(e,n)=>kt.post(`/quy-che-luong/${e}/rule`,n).then(a=>a.data),sapXepRules:(e,n)=>kt.put(`/quy-che-luong/${e}/sap-xep-rule`,{danhSachRuleId:n}).then(a=>a.data)},Ld={layChiTiet:e=>kt.get(`/quy-che-rule/${e}`).then(n=>n.data),capNhat:(e,n)=>kt.put(`/quy-che-rule/${e}`,n).then(a=>a.data),xoa:e=>kt.delete(`/quy-che-rule/${e}`).then(n=>n.data),validate:e=>kt.post("/quy-che-rule/validate",e).then(n=>n.data),preview:e=>kt.post("/quy-che-rule/preview",e).then(n=>n.data)},El={layDanhSach:e=>kt.get("/su-kien-thuong-phat",{params:e}).then(n=>n.data),layChiTiet:e=>kt.get(`/su-kien-thuong-phat/${e}`).then(n=>n.data),tao:e=>kt.post("/su-kien-thuong-phat",e).then(n=>n.data),capNhat:(e,n)=>kt.put(`/su-kien-thuong-phat/${e}`,n).then(a=>a.data),duyet:(e,n)=>kt.post(`/su-kien-thuong-phat/${e}/duyet`,{duyetBoi:n.duyetBoi||"admin",ghiChu:n.lyDo}).then(a=>a.data),duyetNhieu:e=>kt.post("/su-kien-thuong-phat/duyet-nhieu",{ids:e.danhSachId,duyetBoi:e.duyetBoi||"admin"}).then(n=>n.data),huy:e=>kt.post(`/su-kien-thuong-phat/${e}/huy`).then(n=>n.data),thongKe:(e,n,a)=>kt.get(`/su-kien-thuong-phat/thong-ke/${e}`,{params:{thang:n,nam:a}}).then(r=>r.data),layDanhMucSuKien:e=>kt.get("/su-kien-thuong-phat/danh-muc",{params:{loai:e}}).then(n=>n.data),taoDanhMucSuKien:e=>kt.post("/su-kien-thuong-phat/danh-muc",e).then(n=>n.data),khoiTaoDanhMucMau:()=>kt.post("/su-kien-thuong-phat/khoi-tao-danh-muc-mau").then(e=>e.data)},ID={chay:(e,n)=>kt.post(`/bang-luong/${e}/chay-rule-engine`,{nguoiThucHien:n}).then(a=>a.data),xemTrace:(e,n)=>kt.get(`/bang-luong/${e}/rule-trace`,{params:n?{nhanVienId:n}:void 0}).then(a=>a.data)},Od={goiYRule:(e,n,a)=>kt.post("/tro-ly-ai/goi-y-rule",{phongBanId:e,quyCheId:n,noiDungTiengViet:a}).then(r=>r.data),layContext:(e,n)=>kt.get(`/tro-ly-ai/context/${e}/${n}`).then(a=>a.data),apDungRule:(e,n,a)=>kt.post(`/tro-ly-ai/ap-dung/${e}`,{auditId:n,ruleDeXuat:a}).then(r=>r.data),huyDeXuat:e=>kt.post(`/tro-ly-ai/huy/${e}`).then(n=>n.data),lichSuDeXuat:e=>kt.get(`/tro-ly-ai/lich-su/${e}`).then(n=>n.data)},MD=({trangThai:e})=>{const a={NHAP:{bg:"bg-gray-100",text:"text-gray-800",label:"Nhp"},HIEU_LUC:{bg:"bg-green-100",text:"text-green-800",label:"Hiu lc"},TAM_DUNG:{bg:"bg-yellow-100",text:"text-yellow-800",label:"Tm dng"},NGUNG:{bg:"bg-red-100",text:"text-red-800",label:"Ngng"}}[e];return t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${a.bg} ${a.text}`,children:a.label})};function RD(){const e=xr(),[n,a]=E.useState([]),[r,s]=E.useState([]),[l,o]=E.useState(!1),[d,u]=E.useState(""),[h,m]=E.useState(!1),[f,p]=E.useState({phongBanId:0,tenQuyChe:"",moTa:"",tuNgay:new Date().toISOString().split("T")[0]});E.useEffect(()=>{b(),g()},[d]);const b=async()=>{try{const _=await ln.layTatCa();s(_)}catch(_){console.error("Li load phng ban:",_)}},g=async()=>{o(!0);try{const _=d?{phongBanId:d}:{},P=await zs.layDanhSach(_);a(P)}catch(_){console.error("Li load quy ch:",_)}finally{o(!1)}},y=async()=>{if(!f.phongBanId||!f.tenQuyChe||!f.tuNgay){alert("Vui lng nhp y  thng tin");return}try{await zs.tao({phongBanId:f.phongBanId,tenQuyChe:f.tenQuyChe,moTa:f.moTa,tuNgay:new Date(f.tuNgay)}),m(!1),p({phongBanId:0,tenQuyChe:"",moTa:"",tuNgay:new Date().toISOString().split("T")[0]}),g()}catch(_){console.error("Li to quy ch:",_),alert("Li to quy ch")}},N=async _=>{if(confirm("Kch hot quy ch ny? Cc quy ch khc cng phng ban s b ngng."))try{await zs.kichHoat(_),g()}catch(P){console.error("Li kch hot:",P),alert("Li kch hot quy ch")}},C=async _=>{if(confirm("Ngng quy ch ny?"))try{await zs.ngung(_),g()}catch(P){console.error("Li ngng:",P),alert("Li ngng quy ch")}},T=async(_,P)=>{const j=prompt("Tn quy ch mi:",`${P} (v2)`);if(j)try{const A=await zs.nhanBan(_,{tenQuyChe:j,tuNgay:new Date});e(`/quy-che/${A.id}`)}catch(A){console.error("Li nhn bn:",A),alert("Li nhn bn quy ch")}},S=async _=>{if(confirm("Xa quy ch ny? Ch c th xa quy ch ang  trng thi Nhp."))try{await zs.xoa(_),g()}catch(P){console.error("Li xa:",P),alert("Khng th xa quy ch ny")}},k=n.reduce((_,P)=>{var A;const j=((A=P.phongBan)==null?void 0:A.tenPhongBan)||"Khc";return _[j]||(_[j]=[]),_[j].push(P),_},{});return t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Quy ch lng"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Cu hnh quy ch lng theo phng ban vi cc rule t ng"})]}),t.jsxs("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"To quy ch mi"]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:t.jsx("div",{className:"flex items-center gap-4",children:t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:d,onChange:_=>u(_.target.value?Number(_.target.value):""),className:"border rounded-lg px-3 py-2 min-w-[200px]",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),r.map(_=>t.jsx("option",{value:_.id,children:_.tenPhongBan},_.id))]})]})})}),l&&t.jsx("div",{className:"text-center py-10",children:t.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}),!l&&t.jsxs("div",{className:"space-y-6",children:[Object.entries(k).map(([_,P])=>t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b",children:t.jsx("h2",{className:"font-semibold text-gray-900",children:_})}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tn quy ch"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Phin bn"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"S rule"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"T ngy"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:P.map(j=>{var A;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsxs("td",{className:"px-4 py-3",children:[t.jsx("button",{onClick:()=>e(`/quy-che/${j.id}`),className:"text-blue-600 hover:text-blue-800 font-medium",children:j.tenQuyChe}),j.moTa&&t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:j.moTa})]}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-sm",children:["v",j.phienBan]})}),t.jsx("td",{className:"px-4 py-3 text-center",children:((A=j._count)==null?void 0:A.rules)||0}),t.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-600",children:new Date(j.tuNgay).toLocaleDateString("vi-VN")}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx(MD,{trangThai:j.trangThai})}),t.jsx("td",{className:"px-4 py-3 text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx("button",{onClick:()=>e(`/quy-che/${j.id}`),className:"p-1 text-gray-400 hover:text-blue-600",title:"Cu hnh",children:t.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),j.trangThai==="NHAP"&&t.jsx("button",{onClick:()=>N(j.id),className:"p-1 text-gray-400 hover:text-green-600",title:"Kch hot",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),j.trangThai==="HIEU_LUC"&&t.jsx("button",{onClick:()=>C(j.id),className:"p-1 text-gray-400 hover:text-yellow-600",title:"Ngng",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("button",{onClick:()=>T(j.id,j.tenQuyChe),className:"p-1 text-gray-400 hover:text-purple-600",title:"Nhn bn",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),j.trangThai==="NHAP"&&t.jsx("button",{onClick:()=>S(j.id),className:"p-1 text-gray-400 hover:text-red-600",title:"Xa",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},j.id)})})]})]},_)),Object.keys(k).length===0&&t.jsx("div",{className:"bg-white rounded-lg shadow p-10 text-center text-gray-500",children:'Cha c quy ch no. Bm "To quy ch mi"  bt u.'})]}),h&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[t.jsx("div",{className:"px-6 py-4 border-b",children:t.jsx("h3",{className:"text-lg font-semibold",children:"To quy ch mi"})}),t.jsxs("div",{className:"px-6 py-4 space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Phng ban ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("select",{value:f.phongBanId,onChange:_=>p({...f,phongBanId:Number(_.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn phng ban --"}),r.map(_=>t.jsx("option",{value:_.id,children:_.tenPhongBan},_.id))]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn quy ch ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:f.tenQuyChe,onChange:_=>p({...f,tenQuyChe:_.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Quy ch lng phng Kho 2026"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:f.moTa,onChange:_=>p({...f,moTa:_.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:3,placeholder:"M t quy ch..."})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["p dng t ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ht,{value:f.tuNgay,onChange:_=>p({...f,tuNgay:_}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"px-6 py-4 border-t flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:y,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To quy ch"})]})]})})]})}const BD=["Pht i tr: 1-2 ln 50k/ln, t ln 3 tr ln 100k/ln","Trch nhim kho: cp 1 500k, cp 2 1tr, cp 3 1.5tr","Tin trch nhim = lng c bn * 0.15","Thng chuyn cn: 200k/thng nu khng ngh","Ph cp trch nhim c nh 500k/thng"],hf={CO_DINH:"C nh",THEO_HE_SO:"Theo h s",BAC_THANG:"Bc thang",THEO_SU_KIEN:"Theo s kin",CONG_THUC:"Cng thc"},Rb={CONG_DON:"Cng dn",GHI_DE:"Ghi "};function HD({isOpen:e,onClose:n,phongBanId:a,quyCheId:r,onRuleApplied:s}){const l=E.useRef(null),o=E.useRef(null),[d,u]=E.useState(""),[h,m]=E.useState(!1),[f,p]=E.useState(null),[b,g]=E.useState(null),[y,N]=E.useState(!1),[C,T]=E.useState(!1),[S,k]=E.useState(null),[_,P]=E.useState(!1),[j,A]=E.useState(null),[L,W]=E.useState(!1),[R,M]=E.useState(null),[q,ee]=E.useState("goi-y"),[z,fe]=E.useState(!1),[ae,J]=E.useState(!1),[G,he]=E.useState(!1),[H,F]=E.useState({luongCoBan:1e7,capTrachNhiem:2,heSoTrachNhiem:1.2,soLanDiTre:3,soLanNghiKhongPhep:0});E.useEffect(()=>{e&&a&&r&&(Od.layContext(a,r).then(g).catch(console.error),setTimeout(()=>{var ve;return(ve=l.current)==null?void 0:ve.focus()},100))},[e,a,r]),E.useEffect(()=>{e||(u(""),p(null),k(null),A(null),M(null),W(!1),fe(!1),J(!1),he(!1))},[e]);const I=E.useCallback(ve=>{e&&(ve.key==="Escape"&&n(),(ve.ctrlKey||ve.metaKey)&&ve.key==="Enter"&&d.trim()&&!h&&ve.preventDefault())},[e,d,h,n]);E.useEffect(()=>(document.addEventListener("keydown",I),()=>document.removeEventListener("keydown",I)),[I]);const O=async()=>{if(d.trim()){m(!0),p(null),k(null),A(null);try{const ve=await Od.goiYRule(a,r,d);p(ve),ve.ruleDeXuat&&M({...ve.ruleDeXuat})}catch(ve){console.error("Li gi  rule:",ve),p({hopLeSoBo:!1,canLamRo:["C li xy ra khi x l yu cu. Vui lng th li."]})}finally{m(!1)}}},V=async()=>{if(!R)return;const ve=ce();if(ve.length>0){k({hopLe:!1,loi:["[Client] "+ve.join(", [Client] ")]});return}T(!0);try{const Ke=await Ld.validate({loaiRule:R.loaiRule,dieuKienJson:R.dieuKienJson,congThucJson:R.congThucJson});k({hopLe:Ke.hopLe,loi:Ke.danhSachLoi||[]})}catch(Ke){console.error("Li validate:",Ke),k({hopLe:!1,loi:["C li xy ra khi validate server"]})}finally{T(!1)}},te=async()=>{if(R){P(!0);try{const ve=await Ld.preview({quyCheId:r,duLieuGiaLap:H});A({soTien:ve.tongTien,trace:ve.trace.map(Ke=>`${Ke.ruleName}: ${Ke.message}  ${Ke.output.toLocaleString("vi-VN")}`).join(`
`)})}catch(ve){console.error("Li preview:",ve)}finally{P(!1)}}},pe=async()=>{if(R)try{await navigator.clipboard.writeText(JSON.stringify(R,null,2)),he(!0),setTimeout(()=>he(!1),2e3)}catch(ve){console.error("Li copy:",ve)}},U=()=>{f!=null&&f.ruleDeXuat&&M({...f.ruleDeXuat})},ce=()=>{const ve=[];if(!R)return["Khng c rule  validate"];(!R.tenRule||R.tenRule.trim().length<3)&&ve.push("Tn rule phi c t nht 3 k t"),R.khoanLuongMa||ve.push("Cha chn khon lng");const Ke=R.congThucJson;switch(R.loaiRule){case"CO_DINH":(!Ke.soTien||Ke.soTien<=0)&&ve.push("S tin c nh phi ln hn 0");break;case"THEO_HE_SO":Ke.base||ve.push("Cha chn ngun tnh (base)"),(!Ke.heSo||Ke.heSo<=0)&&ve.push("H s phi ln hn 0");break;case"BAC_THANG":{const at=Ke.bac;!at||at.length===0?ve.push("Phi c t nht 1 bc thang"):at.forEach((et,Be)=>{(et.from===void 0||et.to===void 0)&&ve.push(`Bc ${Be+1}: Cha nh ngha khong from-to`),!et.soTien&&!et.soTienMoiLan&&ve.push(`Bc ${Be+1}: Cha nh ngha s tin`)})}break;case"CONG_THUC":(!Ke.bieuThuc||Ke.bieuThuc.trim().length===0)&&ve.push("Cha nhp biu thc cng thc");break;case"THEO_SU_KIEN":Ke.maSuKien||ve.push("Cha chn m s kin");break}return ve},Q=async()=>{if(!(f!=null&&f.auditId)||!R)return;const ve=ce();if(ve.length>0){k({hopLe:!1,loi:ve}),alert(`Vui lng sa cc li trc khi p dng:

`+ve.join(`
`));return}if(confirm(`Xc nhn p dng rule "${R.tenRule}"?

Loi: ${hf[R.loaiRule]}
Khon lng: ${R.khoanLuongMa}`)){N(!0);try{await Od.apDungRule(r,f.auditId,R),alert("  p dng rule thnh cng!"),s(),n()}catch(at){console.error("Li p dng rule:",at);const et=at instanceof Error?at.message:"Li khng xc nh";alert(` C li khi p dng rule: ${et}`)}finally{N(!1)}}},oe=ve=>{u(ve)},X=ve=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(ve);return e?t.jsxs("div",{className:"fixed inset-0 z-50 flex overflow-hidden",children:[t.jsx("div",{className:"flex-1 bg-black/50 backdrop-blur-sm animate-fadeIn",onClick:n}),t.jsxs("div",{ref:o,className:"w-[600px] max-w-full bg-white shadow-2xl flex flex-col h-full animate-slideInRight",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 text-white shadow-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:t.jsx(u_,{className:"h-6 w-6"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"font-semibold text-lg",children:"Tr l AI gi  Rule"}),t.jsx("p",{className:"text-sm text-white/80",children:"Nhp ting Vit  To rule t ng"})]})]}),t.jsx("button",{onClick:n,className:"p-2 hover:bg-white/20 rounded-lg transition-all hover:rotate-90",title:"ng (Escape)",children:t.jsx(hn,{className:"h-5 w-5"})})]}),t.jsxs("div",{className:"flex border-b bg-gray-50",children:[t.jsxs("button",{onClick:()=>ee("goi-y"),className:`flex-1 py-3 text-sm font-medium transition-all ${q==="goi-y"?"border-b-2 border-blue-600 text-blue-600 bg-white":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[t.jsx(S_,{className:"h-4 w-4 inline mr-2"}),"Gi  Rule"]}),t.jsxs("button",{onClick:()=>ee("lich-su"),className:`flex-1 py-3 text-sm font-medium transition-all ${q==="lich-su"?"border-b-2 border-blue-600 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[t.jsx(fu,{className:"h-4 w-4 inline mr-2"}),"Lch s"]})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[q==="goi-y"&&t.jsxs(t.Fragment,{children:[b&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-sm",children:[t.jsx("div",{className:"font-medium text-gray-700 mb-2",children:"Ng cnh hin ti:"}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-gray-600",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Phng ban:"})," ",t.jsx("span",{className:"font-medium",children:b.phongBan.tenPhongBan})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Quy ch:"})," ",t.jsxs("span",{className:"font-medium",children:["v",b.quyChe.phienBan]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Khon lng:"})," ",t.jsxs("span",{className:"font-medium",children:[b.khoanLuongs.length," khon"]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"S kin:"})," ",t.jsxs("span",{className:"font-medium",children:[b.danhMucSuKien.length," mc"]})]})]})]}),t.jsxs("div",{className:"animate-slideInUp",children:[t.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:" Mu gi :"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:BD.map((ve,Ke)=>t.jsx("button",{onClick:()=>oe(ve),className:"text-xs px-3 py-1.5 bg-blue-50 text-blue-700 rounded-full hover:bg-blue-100 hover:scale-105 transition-all",children:ve.length>40?ve.substring(0,37)+"...":ve},Ke))})]}),t.jsxs("div",{className:"animate-slideInUp",style:{animationDelay:"0.1s"},children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" M t bng ting Vit:"}),t.jsx("textarea",{ref:l,value:d,onChange:ve=>u(ve.target.value),onKeyDown:ve=>{(ve.ctrlKey||ve.metaKey)&&ve.key==="Enter"&&(ve.preventDefault(),d.trim()&&!h&&O())},placeholder:"V d: Pht i tr 1-2 ln 50k/ln, t ln 3 tr ln 100k/ln",className:"w-full h-28 px-3 py-2 border rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",disabled:h}),t.jsxs("div",{className:"flex items-center justify-between mt-1",children:[t.jsx("span",{className:"text-xs text-gray-400",children:"/Ctrl + Enter  gi"}),t.jsxs("span",{className:"text-xs text-gray-400",children:[d.length," k t"]})]}),t.jsx("button",{onClick:O,disabled:!d.trim()||h,className:"mt-2 w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-md hover:shadow-lg",children:h?t.jsxs(t.Fragment,{children:[t.jsx(In,{className:"h-4 w-4 animate-spin"}),"ang x l..."]}):t.jsxs(t.Fragment,{children:[t.jsx(pu,{className:"h-4 w-4"}),"To  xut"]})})]}),f&&t.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[t.jsxs("div",{className:`p-3 flex items-center gap-2 ${f.hopLeSoBo?"bg-green-50":"bg-yellow-50"}`,children:[f.hopLeSoBo?t.jsx(Ma,{className:"h-5 w-5 text-green-600"}):t.jsx(T_,{className:"h-5 w-5 text-yellow-600"}),t.jsx("span",{className:`font-medium ${f.hopLeSoBo?"text-green-700":"text-yellow-700"}`,children:f.hopLeSoBo?" to  xut thnh cng":"Cn lm r thm"})]}),f.canLamRo.length>0&&t.jsxs("div",{className:"p-3 bg-yellow-50 border-t",children:[t.jsx("div",{className:"text-sm font-medium text-yellow-800 mb-2",children:"Cu hi:"}),t.jsx("ul",{className:"space-y-1",children:f.canLamRo.map((ve,Ke)=>t.jsxs("li",{className:"text-sm text-yellow-700 flex items-start gap-2",children:[t.jsx("span",{children:""}),t.jsx("span",{children:ve})]},Ke))})]}),f.ruleDeXuat&&R&&t.jsxs("div",{className:"p-3 space-y-3",children:[f.tomTatRule&&t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Tm tt:"})," ",t.jsx("span",{className:"font-medium",children:f.tomTatRule})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2 text-sm",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Loi rule:"})," ",t.jsx("span",{className:"font-medium text-blue-600",children:hf[R.loaiRule]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Ch  gp:"})," ",t.jsx("span",{className:"font-medium",children:Rb[R.cheDoGop]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Khon lng:"})," ",t.jsx("span",{className:"font-medium",children:R.khoanLuongMa})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"u tin:"})," ",t.jsx("span",{className:"font-medium",children:R.thuTuUuTien})]})]}),t.jsxs("div",{className:"pt-2 border-t flex items-center gap-2 flex-wrap",children:[t.jsxs("button",{onClick:()=>W(!L),className:"text-blue-600 hover:text-blue-800 text-sm flex items-center gap-1",children:[L?t.jsx(ii,{className:"h-4 w-4"}):t.jsx(lj,{className:"h-4 w-4"}),L?"n JSON":"Xem JSON"]}),t.jsxs("button",{onClick:pe,className:"text-gray-600 hover:text-gray-800 text-sm flex items-center gap-1",children:[t.jsx(rj,{className:"h-4 w-4"}),G?" copy!":"Copy JSON"]}),t.jsxs("button",{onClick:()=>fe(!z),className:"text-purple-600 hover:text-purple-800 text-sm flex items-center gap-1",children:[t.jsx(Zs,{className:"h-4 w-4"}),z?"n form":"Chnh sa"]}),t.jsxs("button",{onClick:U,className:"text-orange-600 hover:text-orange-800 text-sm flex items-center gap-1",children:[t.jsx(Yp,{className:"h-4 w-4"}),"Reset"]})]}),L&&t.jsx("pre",{className:"mt-2 p-2 bg-gray-800 text-green-400 rounded text-xs overflow-x-auto max-h-48",children:JSON.stringify(R,null,2)}),z&&t.jsxs("div",{className:"mt-2 p-3 bg-white border rounded-lg space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Tn rule"}),t.jsx("input",{type:"text",value:R.tenRule,onChange:ve=>M({...R,tenRule:ve.target.value}),className:"w-full px-2 py-1.5 border rounded text-sm"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Loi rule"}),t.jsx("select",{value:R.loaiRule,onChange:ve=>M({...R,loaiRule:ve.target.value}),className:"w-full px-2 py-1.5 border rounded text-sm",children:Object.entries(hf).map(([ve,Ke])=>t.jsx("option",{value:ve,children:Ke},ve))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Ch  gp"}),t.jsx("select",{value:R.cheDoGop,onChange:ve=>M({...R,cheDoGop:ve.target.value}),className:"w-full px-2 py-1.5 border rounded text-sm",children:Object.entries(Rb).map(([ve,Ke])=>t.jsx("option",{value:ve,children:Ke},ve))})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Th t u tin"}),t.jsx("input",{type:"number",value:R.thuTuUuTien,onChange:ve=>M({...R,thuTuUuTien:Number(ve.target.value)}),className:"w-24 px-2 py-1.5 border rounded text-sm"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",id:"choPhepChinhTay",checked:R.choPhepChinhTay,onChange:ve=>M({...R,choPhepChinhTay:ve.target.checked})}),t.jsx("label",{htmlFor:"choPhepChinhTay",className:"text-sm text-gray-700",children:"Cho php chnh tay"})]})]})]}),f.giaiThich&&f.giaiThich.length>0&&t.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[t.jsx("div",{className:"text-sm font-medium text-blue-800 mb-1",children:"Gii thch:"}),t.jsx("ul",{className:"space-y-1",children:f.giaiThich.map((ve,Ke)=>t.jsxs("li",{className:"text-sm text-blue-700 flex items-start gap-2",children:[t.jsx("span",{children:""}),t.jsx("span",{children:ve})]},Ke))})]}),f.canhBao&&f.canhBao.length>0&&t.jsxs("div",{className:"bg-orange-50 rounded-lg p-3",children:[t.jsxs("div",{className:"text-sm font-medium text-orange-800 mb-1 flex items-center gap-1",children:[t.jsx(na,{className:"h-4 w-4"}),"Cnh bo:"]}),t.jsx("ul",{className:"space-y-1",children:f.canhBao.map((ve,Ke)=>t.jsxs("li",{className:"text-sm text-orange-700 flex items-start gap-2",children:[t.jsx("span",{children:""}),t.jsx("span",{children:ve})]},Ke))})]}),S&&t.jsxs("div",{className:`rounded-lg p-3 ${S.hopLe?"bg-green-50":"bg-red-50"}`,children:[t.jsxs("div",{className:`text-sm font-medium mb-1 flex items-center gap-1 ${S.hopLe?"text-green-800":"text-red-800"}`,children:[S.hopLe?t.jsx(Ma,{className:"h-4 w-4"}):t.jsx(na,{className:"h-4 w-4"}),S.hopLe?"Validate thnh cng":"Validate tht bi"]}),S.loi.length>0&&t.jsx("ul",{className:"space-y-1",children:S.loi.map((ve,Ke)=>t.jsxs("li",{className:"text-sm text-red-700 flex items-start gap-2",children:[t.jsx("span",{children:""}),t.jsx("span",{children:ve})]},Ke))})]}),j&&t.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[t.jsx("div",{className:"text-sm font-medium text-purple-800 mb-1",children:"Preview (d liu gi lp):"}),t.jsx("div",{className:"text-lg font-bold text-purple-600",children:X(j.soTien)}),t.jsx("div",{className:"text-xs text-purple-600 mt-1",children:j.trace})]}),t.jsxs("div",{className:"border rounded-lg",children:[t.jsxs("button",{onClick:()=>J(!ae),className:"w-full px-3 py-2 flex items-center justify-between text-sm text-gray-600 hover:bg-gray-50",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(Zs,{className:"h-4 w-4"}),"Ci t d liu gi lp"]}),t.jsx("span",{children:ae?"":""})]}),ae&&t.jsx("div",{className:"p-3 border-t space-y-2",children:t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Lng c bn"}),t.jsx("input",{type:"number",value:H.luongCoBan,onChange:ve=>F({...H,luongCoBan:Number(ve.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"H s trch nhim"}),t.jsx("input",{type:"number",step:"0.1",value:H.heSoTrachNhiem,onChange:ve=>F({...H,heSoTrachNhiem:Number(ve.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Cp trch nhim"}),t.jsx("input",{type:"number",value:H.capTrachNhiem,onChange:ve=>F({...H,capTrachNhiem:Number(ve.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"S ln i tr"}),t.jsx("input",{type:"number",value:H.soLanDiTre,onChange:ve=>F({...H,soLanDiTre:Number(ve.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]})]})})]}),t.jsxs("div",{className:"flex gap-2 pt-2",children:[t.jsxs("button",{onClick:V,disabled:C,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 disabled:opacity-50 transition",children:[C?t.jsx(In,{className:"h-4 w-4 animate-spin"}):t.jsx(Ra,{className:"h-4 w-4"}),"Validate"]}),t.jsxs("button",{onClick:te,disabled:_,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 border border-purple-600 text-purple-600 rounded-lg hover:bg-purple-50 disabled:opacity-50 transition",children:[_?t.jsx(In,{className:"h-4 w-4 animate-spin"}):t.jsx(ii,{className:"h-4 w-4"}),"Preview"]}),t.jsxs("button",{onClick:Q,disabled:y,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition",children:[y?t.jsx(In,{className:"h-4 w-4 animate-spin"}):t.jsx(Lr,{className:"h-4 w-4"}),"p dng"]})]})]})]})]}),q==="lich-su"&&t.jsx(VD,{quyCheId:r,onTaiSuDung:ve=>{u(ve),ee("goi-y")}})]})]})]}):null}function VD({quyCheId:e,onTaiSuDung:n}){const[a,r]=E.useState([]),[s,l]=E.useState(!0);E.useEffect(()=>{Od.lichSuDeXuat(e).then(r).catch(console.error).finally(()=>l(!1))},[e]);const o=async u=>{if(confirm("Hy  xut ny?"))try{await Od.huyDeXuat(u),r(h=>h.map(m=>m.id===u?{...m,trangThai:"HUY"}:m))}catch(h){console.error("Li hy:",h)}};if(s)return t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx(In,{className:"h-6 w-6 animate-spin text-gray-400"})});if(a.length===0)return t.jsx("div",{className:"text-center py-8 text-gray-500",children:"Cha c lch s  xut no"});const d={DE_XUAT:{text:" xut",color:"bg-yellow-100 text-yellow-800"},DA_AP_DUNG:{text:" p dng",color:"bg-green-100 text-green-800"},HUY:{text:" hy",color:"bg-gray-100 text-gray-800"}};return t.jsx("div",{className:"space-y-3",children:a.map(u=>{var h,m;return t.jsxs("div",{className:"border rounded-lg p-3 hover:border-gray-300 transition",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("div",{className:"text-sm text-gray-500",children:[new Date(u.taoLuc).toLocaleString("vi-VN"),u.nguoiTao&&`  ${u.nguoiTao.hoTen}`]}),t.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${((h=d[u.trangThai])==null?void 0:h.color)||"bg-gray-100"}`,children:((m=d[u.trangThai])==null?void 0:m.text)||u.trangThai})]}),t.jsx("div",{className:"text-sm text-gray-700 line-clamp-2",children:u.promptGoc}),u.rule&&t.jsxs("div",{className:"mt-2 text-xs text-blue-600",children:[" Rule: ",u.rule.tenRule]}),t.jsxs("div",{className:"mt-2 flex gap-2",children:[t.jsxs("button",{onClick:()=>n==null?void 0:n(u.promptGoc),className:"text-xs text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[t.jsx(Yp,{className:"h-3 w-3"}),"Ti s dng"]}),u.trangThai==="DE_XUAT"&&t.jsxs("button",{onClick:()=>o(u.id),className:"text-xs text-red-600 hover:text-red-800 flex items-center gap-1",children:[t.jsx(Ir,{className:"h-3 w-3"}),"Hy"]})]})]},u.id)})})}const cg={CO_DINH:"C nh",THEO_HE_SO:"Theo h s",BAC_THANG:"Bc thang",THEO_SU_KIEN:"Theo s kin",CONG_THUC:"Cng thc"},UD={CO_DINH:"bg-blue-100 text-blue-800",THEO_HE_SO:"bg-green-100 text-green-800",BAC_THANG:"bg-purple-100 text-purple-800",THEO_SU_KIEN:"bg-orange-100 text-orange-800",CONG_THUC:"bg-pink-100 text-pink-800"},KD=({rule:e,index:n,isSelected:a,onSelect:r,onDragStart:s,onDragOver:l,onDrop:o,isDragging:d})=>{var u;return t.jsx("div",{draggable:!0,onDragStart:s,onDragOver:l,onDrop:o,onClick:r,className:`
        p-3 rounded-lg border-2 cursor-pointer transition-all
        ${a?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}
        ${d?"opacity-50":""}
      `,children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"cursor-grab text-gray-400 hover:text-gray-600 mt-1",children:t.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{d:"M7 2a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 2zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 8zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 14zm6-8a2 2 0 1 0-.001-4.001A2 2 0 0 0 13 6zm0 2a2 2 0 1 0 .001 4.001A2 2 0 0 0 13 8zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 13 14z"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsxs("span",{className:"text-xs font-medium text-gray-500",children:["#",n+1]}),t.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${UD[e.loaiRule]}`,children:cg[e.loaiRule]})]}),t.jsx("h4",{className:"font-medium text-gray-900 truncate",children:e.tenRule}),t.jsx("p",{className:"text-sm text-gray-500 truncate mt-1",children:(u=e.khoanLuong)==null?void 0:u.tenKhoan})]}),t.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${e.trangThai?"bg-green-500":"bg-gray-300"}`})]})})},zD=({value:e,onChange:n})=>t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S tin c nh"}),t.jsx("input",{type:"number",value:e.soTien||"",onChange:a=>n({soTien:Number(a.target.value)}),className:"w-full border rounded-lg px-3 py-2",placeholder:"1000000"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.soTien?new Intl.NumberFormat("vi-VN").format(e.soTien)+"":""})]}),$D=({value:e,onChange:n})=>t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Base (ngun tnh)"}),t.jsxs("select",{value:e.base||"",onChange:a=>n({...e,base:a.target.value,heSo:e.heSo||1}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn --"}),t.jsx("option",{value:"LUONG_CO_BAN",children:"Lng c bn"}),t.jsx("option",{value:"HE_SO_TRACH_NHIEM",children:"H s trch nhim"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"H s"}),t.jsx("input",{type:"number",step:"0.01",value:e.heSo||"",onChange:a=>n({...e,base:e.base||"LUONG_CO_BAN",heSo:Number(a.target.value)}),className:"w-full border rounded-lg px-3 py-2",placeholder:"0.2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cng thm (ty chn)"}),t.jsx("input",{type:"number",value:e.congThem||"",onChange:a=>n({...e,base:e.base||"LUONG_CO_BAN",heSo:e.heSo||1,congThem:Number(a.target.value)||void 0}),className:"w-full border rounded-lg px-3 py-2",placeholder:"200000"})]})]}),GD=({value:e,onChange:n})=>{const a=e.bac||[{from:1,to:1,soTien:0}],r=()=>{const o=a[a.length-1];n({field:e.field||"cap_trach_nhiem",bac:[...a,{from:((o==null?void 0:o.to)||0)+1,to:((o==null?void 0:o.to)||0)+1,soTien:0}]})},s=o=>{a.length<=1||n({field:e.field||"cap_trach_nhiem",bac:a.filter((d,u)=>u!==o)})},l=(o,d)=>{n({field:e.field||"cap_trach_nhiem",bac:a.map((u,h)=>h===o?{...u,...d}:u)})};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng d liu"}),t.jsxs("select",{value:e.field||"",onChange:o=>n({...e,field:o.target.value,bac:a}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn --"}),t.jsx("option",{value:"cap_trach_nhiem",children:"Cp trch nhim"}),t.jsx("option",{value:"he_so_trach_nhiem",children:"H s trch nhim"})]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Bc thang"}),t.jsx("button",{type:"button",onClick:r,className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Thm bc"})]}),t.jsx("div",{className:"space-y-2",children:a.map((o,d)=>t.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded",children:[t.jsxs("span",{className:"text-sm text-gray-500 w-16",children:["Bc ",d+1]}),t.jsx("input",{type:"number",value:o.from,onChange:u=>l(d,{from:Number(u.target.value)}),className:"w-20 border rounded px-2 py-1 text-sm",placeholder:"T"}),t.jsx("span",{className:"text-gray-400",children:""}),t.jsx("input",{type:"number",value:o.to,onChange:u=>l(d,{to:Number(u.target.value)}),className:"w-20 border rounded px-2 py-1 text-sm",placeholder:"n"}),t.jsx("input",{type:"number",value:o.soTien||"",onChange:u=>l(d,{soTien:Number(u.target.value)}),className:"flex-1 border rounded px-2 py-1 text-sm",placeholder:"S tin"}),a.length>1&&t.jsx("button",{type:"button",onClick:()=>s(d),className:"text-red-500 hover:text-red-700",children:""})]},d))})]})]})},qD=({value:e,onChange:n})=>t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Biu thc cng thc"}),t.jsx("textarea",{value:e.bieuThuc||"",onChange:a=>n({bieuThuc:a.target.value}),className:"w-full border rounded-lg px-3 py-2 font-mono text-sm",rows:3,placeholder:"LUONG_CO_BAN * HE_SO_TRACH_NHIEM + 200000"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Bin cho php: LUONG_CO_BAN, HE_SO_TRACH_NHIEM, CAP_TRACH_NHIEM, CONG_CHUAN, CONG_THUC_TE, ..."})]});function WD(){var G,he,H,F,I;const{id:e}=U0(),n=xr(),[a,r]=E.useState(null),[s,l]=E.useState([]),[o,d]=E.useState([]),[u,h]=E.useState(null),[m,f]=E.useState(!0),[p,b]=E.useState(!1),[g,y]=E.useState(null),[N,C]=E.useState(!1),[T,S]=E.useState(!1),[k,_]=E.useState(null),[P,j]=E.useState("thongtin"),[A,L]=E.useState({tenRule:"",moTa:"",khoanLuongId:0,loaiRule:"CO_DINH",congThucJson:{soTien:0},dieuKienJson:{},cheDoGop:"GHI_DE",choPhepChinhTay:!0});E.useEffect(()=>{e&&W()},[e]);const W=async()=>{f(!0);try{const[O,V]=await Promise.all([zs.layChiTiet(Number(e)),Dr.layTatCa()]);r(O),l(O.rules||[]),d(V),O.rules&&O.rules.length>0&&R(O.rules[0])}catch(O){console.error("Li load d liu:",O)}finally{f(!1)}},R=O=>{h(O),L({tenRule:O.tenRule,moTa:O.moTa||"",khoanLuongId:O.khoanLuongId,loaiRule:O.loaiRule,congThucJson:JSON.parse(O.congThucJson),dieuKienJson:O.dieuKienJson?JSON.parse(O.dieuKienJson):{},cheDoGop:O.cheDoGop,choPhepChinhTay:O.choPhepChinhTay}),j("thongtin"),_(null)},M=O=>{y(O)},q=O=>{O.preventDefault()},ee=async O=>{if(g===null||g===O){y(null);return}const V=[...s],[te]=V.splice(g,1);V.splice(O,0,te),l(V),y(null);try{await zs.sapXepRules(Number(e),V.map(pe=>pe.id))}catch(pe){console.error("Li sp xp:",pe),W()}},z=async()=>{var O,V,te;if(u){b(!0);try{await Ld.capNhat(u.id,{tenRule:A.tenRule,moTa:A.moTa,loaiRule:A.loaiRule,congThucJson:A.congThucJson,dieuKienJson:A.dieuKienJson,cheDoGop:A.cheDoGop,choPhepChinhTay:A.choPhepChinhTay}),W()}catch(pe){console.error("Li lu rule:",pe),alert(((te=(V=(O=pe.response)==null?void 0:O.data)==null?void 0:V.loi)==null?void 0:te.join(`
`))||"Li lu rule")}finally{b(!1)}}},fe=async()=>{if(u&&confirm("Xa rule ny?"))try{await Ld.xoa(u.id),h(null),W()}catch(O){console.error("Li xa:",O),alert("Khng th xa rule ny")}},ae=async()=>{if(e)try{const O=await Ld.preview({quyCheId:Number(e),duLieuGiaLap:{LUONG_CO_BAN:1e7,CAP_TRACH_NHIEM:2,HE_SO_TRACH_NHIEM:1.2}});_(O),j("preview")}catch(O){console.error("Li preview:",O),alert("Li chy th")}},J=async O=>{try{let V={soTien:0};O.loaiRule==="THEO_HE_SO"?V={base:"LUONG_CO_BAN",heSo:.1}:O.loaiRule==="BAC_THANG"?V={field:"cap_trach_nhiem",bac:[{from:1,to:1,soTien:5e5}]}:O.loaiRule==="CONG_THUC"&&(V={bieuThuc:"LUONG_CO_BAN * 0.1"}),await zs.taoRule(Number(e),{khoanLuongId:O.khoanLuongId,tenRule:O.tenRule,loaiRule:O.loaiRule,congThucJson:V}),C(!1),W()}catch(V){console.error("Li thm rule:",V),alert("Li thm rule")}};return m?t.jsx("div",{className:"flex items-center justify-center h-96",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}):a?t.jsxs("div",{className:"h-screen flex flex-col",children:[t.jsx("div",{className:"bg-white border-b px-6 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>n("/quy-che"),className:"p-2 hover:bg-gray-100 rounded",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl font-bold",children:a.tenQuyChe}),t.jsxs("p",{className:"text-sm text-gray-500",children:[(G=a.phongBan)==null?void 0:G.tenPhongBan,"  Phin bn ",a.phienBan]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[!a.coDuocSua&&t.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded text-sm",children:" Quy ch  kho"}),t.jsx("button",{onClick:ae,className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Chy th"}),t.jsxs("button",{onClick:()=>S(!0),disabled:!a.coDuocSua,className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 disabled:opacity-50 flex items-center gap-2",children:[t.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t.jsx("path",{d:"M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73A2 2 0 0 1 12 2z"}),t.jsx("path",{d:"M9 14a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"}),t.jsx("path",{d:"M15 14a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"})]}),"Tr l AI"]}),t.jsx("button",{onClick:()=>C(!0),disabled:!a.coDuocSua,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"+ Thm rule"})]})]})}),t.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[t.jsxs("div",{className:"w-80 border-r bg-gray-50 flex flex-col",children:[t.jsxs("div",{className:"p-4 border-b bg-white",children:[t.jsxs("h3",{className:"font-semibold text-gray-900",children:["Danh sch Rule (",s.length,")"]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ko th  sp xp th t u tin"})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[s.map((O,V)=>t.jsx(KD,{rule:O,index:V,isSelected:(u==null?void 0:u.id)===O.id,onSelect:()=>R(O),onDragStart:()=>M(V),onDragOver:q,onDrop:()=>ee(V),isDragging:g===V},O.id)),s.length===0&&t.jsxs("div",{className:"text-center text-gray-500 py-10",children:["Cha c rule no.",t.jsx("br",{}),t.jsx("button",{onClick:()=>C(!0),className:"text-blue-600 hover:underline mt-2",children:"Thm rule u tin"})]})]})]}),t.jsx("div",{className:"flex-1 flex flex-col bg-white overflow-hidden",children:u?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"border-b",children:t.jsx("nav",{className:"flex px-6",children:["thongtin","dieukien","congthuc","preview"].map(O=>t.jsx("button",{onClick:()=>j(O),className:`px-4 py-3 text-sm font-medium border-b-2 -mb-px ${P===O?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:{thongtin:"Thng tin",dieukien:"iu kin",congthuc:"Cch tnh",preview:"Xem th"}[O]},O))})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[P==="thongtin"&&t.jsxs("div",{className:"space-y-4 max-w-lg",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn rule"}),t.jsx("input",{type:"text",value:A.tenRule,onChange:O=>L({...A,tenRule:O.target.value}),className:"w-full border rounded-lg px-3 py-2",disabled:!a.coDuocSua})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Khon lng"}),t.jsx("select",{value:A.khoanLuongId,onChange:O=>L({...A,khoanLuongId:Number(O.target.value)}),className:"w-full border rounded-lg px-3 py-2",disabled:!a.coDuocSua,children:o.map(O=>t.jsxs("option",{value:O.id,children:[O.tenKhoan," (",O.loai==="THU_NHAP"?"+":"-",")"]},O.id))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi rule"}),t.jsx("select",{value:A.loaiRule,onChange:O=>L({...A,loaiRule:O.target.value}),className:"w-full border rounded-lg px-3 py-2",disabled:!a.coDuocSua,children:Object.entries(cg).map(([O,V])=>t.jsx("option",{value:O,children:V},O))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:A.moTa,onChange:O=>L({...A,moTa:O.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:3,disabled:!a.coDuocSua})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:A.choPhepChinhTay,onChange:O=>L({...A,choPhepChinhTay:O.target.checked}),disabled:!a.coDuocSua}),t.jsx("span",{className:"text-sm",children:"Cho php chnh tay"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm",children:"Ch  gp:"}),t.jsxs("select",{value:A.cheDoGop,onChange:O=>L({...A,cheDoGop:O.target.value}),className:"border rounded px-2 py-1 text-sm",disabled:!a.coDuocSua,children:[t.jsx("option",{value:"GHI_DE",children:"Ghi "}),t.jsx("option",{value:"CONG_DON",children:"Cng dn"})]})]})]})]}),P==="dieukien"&&t.jsxs("div",{className:"max-w-lg space-y-4",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"iu kin p dng rule.  trng = p dng cho tt c nhn vin."}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vai tr"}),t.jsx("input",{type:"text",value:(((H=(he=A.dieuKienJson)==null?void 0:he.apDungCho)==null?void 0:H.vaiTro)||[]).join(", "),onChange:O=>{var V;return L({...A,dieuKienJson:{apDungCho:{...(V=A.dieuKienJson)==null?void 0:V.apDungCho,vaiTro:O.target.value?O.target.value.split(",").map(te=>te.trim()):void 0}}})},className:"w-full border rounded-lg px-3 py-2",placeholder:"TO_TRUONG, QUAN_LY",disabled:!a.coDuocSua}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Phn cch bng du phy"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cp trch nhim"}),t.jsx("input",{type:"text",value:(((I=(F=A.dieuKienJson)==null?void 0:F.apDungCho)==null?void 0:I.capTrachNhiem)||[]).join(", "),onChange:O=>{var V;return L({...A,dieuKienJson:{apDungCho:{...(V=A.dieuKienJson)==null?void 0:V.apDungCho,capTrachNhiem:O.target.value?O.target.value.split(",").map(te=>Number(te.trim())).filter(te=>!isNaN(te)):void 0}}})},className:"w-full border rounded-lg px-3 py-2",placeholder:"1, 2, 3",disabled:!a.coDuocSua})]})]}),P==="congthuc"&&t.jsxs("div",{className:"max-w-lg",children:[A.loaiRule==="CO_DINH"&&t.jsx(zD,{value:A.congThucJson,onChange:O=>L({...A,congThucJson:O})}),A.loaiRule==="THEO_HE_SO"&&t.jsx($D,{value:A.congThucJson,onChange:O=>L({...A,congThucJson:O})}),A.loaiRule==="BAC_THANG"&&t.jsx(GD,{value:A.congThucJson,onChange:O=>L({...A,congThucJson:O})}),A.loaiRule==="CONG_THUC"&&t.jsx(qD,{value:A.congThucJson,onChange:O=>L({...A,congThucJson:O})}),A.loaiRule==="THEO_SU_KIEN"&&t.jsx("div",{className:"text-gray-500",children:"Form s kin s c thm sau..."})]}),P==="preview"&&k&&t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"p-4 bg-blue-50 rounded-lg",children:t.jsxs("h4",{className:"font-semibold text-blue-900",children:["Tng tin: ",new Intl.NumberFormat("vi-VN").format(k.tongTien),""]})}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-2",children:"Chi tit"}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Khon lng"}),t.jsx("th",{className:"px-4 py-2 text-right text-sm",children:"S tin"}),t.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Gii thch"})]})}),t.jsx("tbody",{children:k.chiTiet.map((O,V)=>t.jsxs("tr",{className:"border-t",children:[t.jsx("td",{className:"px-4 py-2",children:O.khoanLuong}),t.jsx("td",{className:"px-4 py-2 text-right font-mono",children:new Intl.NumberFormat("vi-VN").format(O.soTien)}),t.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:O.giaiThich})]},V))})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-2",children:"Trace"}),t.jsx("div",{className:"space-y-2",children:k.trace.map((O,V)=>t.jsxs("div",{className:"p-3 bg-gray-50 rounded text-sm",children:[t.jsx("div",{className:"font-medium",children:O.ruleName}),t.jsx("div",{className:"text-gray-600",children:O.message}),t.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Output: ",new Intl.NumberFormat("vi-VN").format(O.output),""]})]},V))})]})]})]}),a.coDuocSua&&t.jsxs("div",{className:"border-t px-6 py-4 flex justify-between",children:[t.jsx("button",{onClick:fe,className:"px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg",children:"Xa rule"}),t.jsx("button",{onClick:z,disabled:p,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:p?"ang lu...":"Lu thay i"})]})]}):t.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:"Chn mt rule  xem chi tit"})})]}),N&&t.jsx(XD,{khoanLuongs:o,onClose:()=>C(!1),onAdd:J}),t.jsx(HD,{isOpen:T,onClose:()=>S(!1),phongBanId:a.phongBanId,quyCheId:a.id,onRuleApplied:W})]}):t.jsx("div",{className:"p-6 text-center text-gray-500",children:"Khng tm thy quy ch"})}function XD({khoanLuongs:e,onClose:n,onAdd:a}){var l;const[r,s]=E.useState({khoanLuongId:((l=e[0])==null?void 0:l.id)||0,tenRule:"",loaiRule:"CO_DINH"});return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[t.jsx("div",{className:"px-6 py-4 border-b",children:t.jsx("h3",{className:"text-lg font-semibold",children:"Thm Rule mi"})}),t.jsxs("div",{className:"px-6 py-4 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn rule"}),t.jsx("input",{type:"text",value:r.tenRule,onChange:o=>s({...r,tenRule:o.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ph cp trch nhim t trng"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Khon lng"}),t.jsx("select",{value:r.khoanLuongId,onChange:o=>s({...r,khoanLuongId:Number(o.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:e.map(o=>t.jsxs("option",{value:o.id,children:[o.tenKhoan," (",o.loai==="THU_NHAP"?"+":"-",")"]},o.id))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi rule"}),t.jsx("select",{value:r.loaiRule,onChange:o=>s({...r,loaiRule:o.target.value}),className:"w-full border rounded-lg px-3 py-2",children:Object.entries(cg).map(([o,d])=>t.jsx("option",{value:o,children:d},o))})]})]}),t.jsxs("div",{className:"px-6 py-4 border-t flex justify-end gap-3",children:[t.jsx("button",{onClick:n,className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:()=>a(r),disabled:!r.tenRule||!r.khoanLuongId,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Thm rule"})]})]})})}const xf={NHAP:{label:"Nhp",color:"bg-gray-100 text-gray-800"},DA_DUYET:{label:" duyt",color:"bg-green-100 text-green-800"},TU_CHOI:{label:"T chi",color:"bg-red-100 text-red-800"},HUY:{label:"Hu",color:"bg-gray-400 text-white"}},kd={THUONG:{label:"Thng",color:"bg-green-100 text-green-800",icon:""},PHAT:{label:"Pht",color:"bg-red-100 text-red-800",icon:""}};function QD(){const[e,n]=E.useState([]),[a,r]=E.useState([]),[s,l]=E.useState([]),[o,d]=E.useState([]),[u,h]=E.useState(!0),[m,f]=E.useState(!1),[p,b]=E.useState(!1),[g,y]=E.useState([]),[N,C]=E.useState({}),[T,S]=E.useState({nhanVienId:0,phongBanId:0,ngay:new Date().toISOString().split("T")[0],loaiSuKien:"THUONG",maSuKien:"",giaTri:1,soTien:0,ghiChu:""}),[k,_]=E.useState({maSuKien:"",tenSuKien:"",loai:"THUONG",moTa:"",soTienMacDinh:0});E.useEffect(()=>{P()},[]);const P=async()=>{h(!0);try{const ae={...N,tuNgay:N.tuNgay?new Date(N.tuNgay):void 0,denNgay:N.denNgay?new Date(N.denNgay):void 0},[J,G,he,H]=await Promise.all([El.layDanhSach(ae),El.layDanhMucSuKien(),ln.layTatCa(),Oa.layTatCa()]);n(Array.isArray(J)?J:[]),r(G),l(he);const F="data"in H?H.data:H;d(Array.isArray(F)?F:[])}catch(ae){console.error("Li load d liu:",ae)}finally{h(!1)}},j=()=>{P()},A=async()=>{try{await El.tao({...T,ngay:new Date(T.ngay)}),f(!1),P(),q()}catch(ae){console.error("Li to s kin:",ae),alert("Li to s kin")}},L=async ae=>{try{await El.duyet(ae,{trangThai:"DA_DUYET"}),P()}catch(J){console.error("Li duyt:",J),alert("Li duyt s kin")}},W=async ae=>{const J=prompt("L do t chi:");if(J)try{await El.duyet(ae,{trangThai:"TU_CHOI",lyDo:J}),P()}catch(G){console.error("Li t chi:",G)}},R=async()=>{if(g.length!==0&&confirm(`Duyt ${g.length} s kin?`))try{await El.duyetNhieu({danhSachId:g,trangThai:"DA_DUYET"}),y([]),P()}catch(ae){console.error("Li duyt nhiu:",ae)}},M=async()=>{try{await El.taoDanhMucSuKien(k),b(!1),P(),_({maSuKien:"",tenSuKien:"",loai:"THUONG",moTa:"",soTienMacDinh:0})}catch(ae){console.error("Li to danh mc:",ae),alert("Li to danh mc")}},q=()=>{S({nhanVienId:0,phongBanId:0,ngay:new Date().toISOString().split("T")[0],loaiSuKien:"THUONG",maSuKien:"",giaTri:1,soTien:0,ghiChu:""})},ee=ae=>{y(J=>J.includes(ae)?J.filter(G=>G!==ae):[...J,ae])},z=()=>{const ae=e.filter(J=>J.trangThai==="NHAP").map(J=>J.id);g.length===ae.length?y([]):y(ae)},fe=ae=>{const J=a.find(G=>G.maSuKien===ae);S({...T,maSuKien:ae,loaiSuKien:(J==null?void 0:J.loai)||"THUONG",soTien:(J==null?void 0:J.soTienMacDinh)||0})};return u?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}):t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"S kin Thng/Pht"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Qun l cc s kin thng, pht cho nhn vin"})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>b(!0),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Danh mc s kin"}),t.jsxs("button",{onClick:()=>f(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[t.jsx(St,{size:18}),"Thm s kin"]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban"}),t.jsxs("select",{value:N.phongBanId||"",onChange:ae=>C({...N,phongBanId:Number(ae.target.value)||void 0}),className:"border rounded-lg px-3 py-2 w-48",children:[t.jsx("option",{value:"",children:"Tt c"}),s.map(ae=>t.jsx("option",{value:ae.id,children:ae.tenPhongBan},ae.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Loi"}),t.jsxs("select",{value:N.loaiSuKien||"",onChange:ae=>C({...N,loaiSuKien:ae.target.value||void 0}),className:"border rounded-lg px-3 py-2 w-32",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"THUONG",children:"Thng"}),t.jsx("option",{value:"PHAT",children:"Pht"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Trng thi"}),t.jsxs("select",{value:N.trangThai||"",onChange:ae=>C({...N,trangThai:ae.target.value||void 0}),className:"border rounded-lg px-3 py-2 w-32",children:[t.jsx("option",{value:"",children:"Tt c"}),Object.entries(xf).map(([ae,{label:J}])=>t.jsx("option",{value:ae,children:J},ae))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"T ngy"}),t.jsx(Ht,{value:N.tuNgay||"",onChange:ae=>C({...N,tuNgay:ae}),className:"border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"n ngy"}),t.jsx(Ht,{value:N.denNgay||"",onChange:ae=>C({...N,denNgay:ae}),className:"border rounded-lg px-3 py-2"})]}),t.jsxs("button",{onClick:j,className:"px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 flex items-center gap-2",children:[t.jsx(Wp,{size:16}),"Lc"]})]})}),g.length>0&&t.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 mb-4 flex items-center justify-between",children:[t.jsxs("span",{className:"text-blue-800",children:[" chn ",g.length," s kin"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:R,className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 text-sm",children:"Duyt tt c"}),t.jsx("button",{onClick:()=>y([]),className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 text-sm",children:"B chn"})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left w-10",children:t.jsx("input",{type:"checkbox",checked:e.filter(ae=>ae.trangThai==="NHAP").length>0&&g.length===e.filter(ae=>ae.trangThai==="NHAP").length,onChange:z})}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Ngy"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Loi"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M s kin"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"Gi tr"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"S tin"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Thao tc"})]})}),t.jsxs("tbody",{children:[e.map(ae=>{var J,G,he;return t.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3",children:ae.trangThai==="NHAP"&&t.jsx("input",{type:"checkbox",checked:g.includes(ae.id),onChange:()=>ee(ae.id)})}),t.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(ae.ngay).toLocaleDateString("vi-VN")}),t.jsxs("td",{className:"px-4 py-3",children:[t.jsx("div",{className:"text-sm font-medium",children:(J=ae.nhanVien)==null?void 0:J.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:(G=ae.nhanVien)==null?void 0:G.maNhanVien})]}),t.jsx("td",{className:"px-4 py-3 text-sm",children:(he=ae.phongBan)==null?void 0:he.tenPhongBan}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("span",{className:`px-2 py-1 rounded text-xs ${kd[ae.loaiSuKien].color}`,children:[kd[ae.loaiSuKien].icon," ",kd[ae.loaiSuKien].label]})}),t.jsx("td",{className:"px-4 py-3 text-sm font-mono",children:ae.maSuKien}),t.jsx("td",{className:"px-4 py-3 text-sm text-right",children:ae.giaTri}),t.jsxs("td",{className:"px-4 py-3 text-sm text-right font-mono",children:[new Intl.NumberFormat("vi-VN").format(ae.soTien),""]}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded text-xs ${xf[ae.trangThai].color}`,children:xf[ae.trangThai].label})}),t.jsx("td",{className:"px-4 py-3 text-center",children:ae.trangThai==="NHAP"&&t.jsxs("div",{className:"flex justify-center gap-1",children:[t.jsx("button",{onClick:()=>L(ae.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Duyt",children:t.jsx(Lr,{size:16})}),t.jsx("button",{onClick:()=>W(ae.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"T chi",children:t.jsx(hn,{size:16})})]})})]},ae.id)}),e.length===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:10,className:"px-4 py-10 text-center text-gray-500",children:"Khng c s kin no"})})]})]})}),m&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg",children:[t.jsx("div",{className:"px-6 py-4 border-b",children:t.jsx("h3",{className:"text-lg font-semibold",children:"Thm s kin Thng/Pht"})}),t.jsxs("div",{className:"px-6 py-4 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nhn vin"}),t.jsxs("select",{value:T.nhanVienId,onChange:ae=>{const J=o.find(G=>G.id===Number(ae.target.value));S({...T,nhanVienId:Number(ae.target.value),phongBanId:(J==null?void 0:J.phongBanId)||T.phongBanId})},className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn --"}),o.map(ae=>t.jsxs("option",{value:ae.id,children:[ae.hoTen," (",ae.maNhanVien,")"]},ae.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy"}),t.jsx(Ht,{value:T.ngay,onChange:ae=>S({...T,ngay:ae}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi s kin"}),t.jsxs("select",{value:T.maSuKien,onChange:ae=>fe(ae.target.value),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn s kin --"}),t.jsx("optgroup",{label:"Thng",children:a.filter(ae=>ae.loai==="THUONG").map(ae=>t.jsxs("option",{value:ae.maSuKien,children:[ae.tenSuKien," (",ae.maSuKien,")"]},ae.maSuKien))}),t.jsx("optgroup",{label:"Pht",children:a.filter(ae=>ae.loai==="PHAT").map(ae=>t.jsxs("option",{value:ae.maSuKien,children:[ae.tenSuKien," (",ae.maSuKien,")"]},ae.maSuKien))})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi tr (ln/ngy/...)"}),t.jsx("input",{type:"number",value:T.giaTri,onChange:ae=>S({...T,giaTri:Number(ae.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:1})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S tin"}),t.jsx("input",{type:"number",value:T.soTien,onChange:ae=>S({...T,soTien:Number(ae.target.value)}),className:"w-full border rounded-lg px-3 py-2"}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[new Intl.NumberFormat("vi-VN").format(T.soTien),""]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),t.jsx("textarea",{value:T.ghiChu,onChange:ae=>S({...T,ghiChu:ae.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"px-6 py-4 border-t flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{f(!1),q()},className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:A,disabled:!T.nhanVienId||!T.maSuKien,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Thm s kin"})]})]})}),p&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[80vh] flex flex-col",children:[t.jsxs("div",{className:"px-6 py-4 border-b flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Danh mc S kin"}),t.jsx("button",{onClick:()=>b(!1),className:"p-2 hover:bg-gray-100 rounded",children:t.jsx(hn,{size:20})})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[t.jsx("h4",{className:"font-medium mb-3",children:"Thm danh mc mi"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsx("input",{type:"text",placeholder:"M s kin",value:k.maSuKien,onChange:ae=>_({...k,maSuKien:ae.target.value}),className:"border rounded px-3 py-2"}),t.jsx("input",{type:"text",placeholder:"Tn s kin",value:k.tenSuKien,onChange:ae=>_({...k,tenSuKien:ae.target.value}),className:"border rounded px-3 py-2"}),t.jsxs("select",{value:k.loai,onChange:ae=>_({...k,loai:ae.target.value}),className:"border rounded px-3 py-2",children:[t.jsx("option",{value:"THUONG",children:"Thng"}),t.jsx("option",{value:"PHAT",children:"Pht"})]}),t.jsx("input",{type:"number",placeholder:"S tin mc nh",value:k.soTienMacDinh||"",onChange:ae=>_({...k,soTienMacDinh:Number(ae.target.value)}),className:"border rounded px-3 py-2"})]}),t.jsx("div",{className:"mt-3 flex justify-end",children:t.jsx("button",{onClick:M,disabled:!k.maSuKien||!k.tenSuKien,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:"Thm"})})]}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-100",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-3 py-2 text-left text-sm",children:"M"}),t.jsx("th",{className:"px-3 py-2 text-left text-sm",children:"Tn"}),t.jsx("th",{className:"px-3 py-2 text-left text-sm",children:"Loi"}),t.jsx("th",{className:"px-3 py-2 text-right text-sm",children:"S tin mc nh"})]})}),t.jsx("tbody",{children:a.map(ae=>t.jsxs("tr",{className:"border-t",children:[t.jsx("td",{className:"px-3 py-2 font-mono text-sm",children:ae.maSuKien}),t.jsx("td",{className:"px-3 py-2",children:ae.tenSuKien}),t.jsx("td",{className:"px-3 py-2",children:t.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${kd[ae.loai].color}`,children:kd[ae.loai].label})}),t.jsx("td",{className:"px-3 py-2 text-right font-mono",children:ae.soTienMacDinh?new Intl.NumberFormat("vi-VN").format(ae.soTienMacDinh)+"":"-"})]},ae.id))})]})]})]})})]})}const YD={CO_DINH:"C nh",THEO_HE_SO:"Theo h s",BAC_THANG:"Bc thang",THEO_SU_KIEN:"Theo s kin",CONG_THUC:"Cng thc"};function JD(){const[e]=g3(),n=Number(e.get("bangLuongId"))||0,[a,r]=E.useState(null),[s,l]=E.useState([]),[o,d]=E.useState(!0),[u,h]=E.useState(""),[m,f]=E.useState([]);E.useEffect(()=>{n&&p()},[n]);const p=async()=>{d(!0);try{const[C,T]=await Promise.all([_r.layTheoId(n),ID.xemTrace(n)]);r(C),l(T)}catch(C){console.error("Li load d liu:",C)}finally{d(!1)}},b=s.reduce((C,T)=>{const S=T.nhanVienId;return C[S]||(C[S]={nhanVien:T.nhanVien,traces:[]}),C[S].traces.push(T),C},{}),g=Object.entries(b).filter(([C,T])=>{var k,_;if(!u)return!0;const S=u.toLowerCase();return((k=T.nhanVien)==null?void 0:k.hoTen.toLowerCase().includes(S))||((_=T.nhanVien)==null?void 0:_.maNhanVien.toLowerCase().includes(S))}),y=C=>{f(T=>T.includes(C)?T.filter(S=>S!==C):[...T,C])},N=C=>new Intl.NumberFormat("vi-VN").format(C);return o?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}):t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[t.jsx(ca,{to:`/bang-luong/${n}`,className:"p-2 hover:bg-gray-100 rounded",children:t.jsx($0,{size:20})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Rule Trace - Gii trnh tnh lng"}),a&&t.jsxs("p",{className:"text-gray-500 mt-1",children:[a.phongBan.tenPhongBan," - Thng ",a.thang,"/",a.nam]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:t.jsxs("div",{className:"relative",children:[t.jsx(Ss,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),t.jsx("input",{type:"text",placeholder:"Tm theo tn hoc m nhn vin...",value:u,onChange:C=>h(C.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]})}),t.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 mb-6 flex items-center justify-between",children:[t.jsx("div",{children:t.jsxs("span",{className:"text-blue-800",children:["Tng: ",Object.keys(b).length," nhn vin, ",s.length," dng trace"]})}),t.jsx("button",{onClick:()=>{m.length===Object.keys(b).length?f([]):f(Object.keys(b).map(Number))},className:"text-sm text-blue-600 hover:underline",children:m.length===Object.keys(b).length?"Thu gn tt c":"M rng tt c"})]}),t.jsxs("div",{className:"space-y-4",children:[g.map(([C,T])=>{var P,j;const S=Number(C),k=m.includes(S),_=T.traces.reduce((A,L)=>A+L.outputSoTien,0);return t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsxs("button",{onClick:()=>y(S),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-gray-50",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[k?t.jsx(Er,{size:18,className:"text-gray-400"}):t.jsx(aa,{size:18,className:"text-gray-400"}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"font-medium",children:(P=T.nhanVien)==null?void 0:P.hoTen}),t.jsx("div",{className:"text-sm text-gray-500",children:(j=T.nhanVien)==null?void 0:j.maNhanVien})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"font-medium text-blue-600",children:[N(_),""]}),t.jsxs("div",{className:"text-sm text-gray-500",children:[T.traces.length," rules"]})]})]}),k&&t.jsx("div",{className:"border-t",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Quy ch"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Rule"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Khon lng"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500",children:"S tin"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Gii thch"})]})}),t.jsx("tbody",{children:T.traces.map(A=>{var L,W,R,M,q,ee;return t.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[t.jsxs("td",{className:"px-4 py-2",children:[t.jsx("div",{className:"text-sm",children:(L=A.quyChe)==null?void 0:L.tenQuyChe}),t.jsxs("div",{className:"text-xs text-gray-500",children:["v",(W=A.quyChe)==null?void 0:W.phienBan]})]}),t.jsx("td",{className:"px-4 py-2",children:A.quyCheRule?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-sm",children:A.quyCheRule.tenRule}),t.jsx("div",{className:"text-xs text-gray-500",children:YD[A.quyCheRule.loaiRule]})]}):t.jsx("span",{className:"text-gray-400 text-sm",children:"-"})}),t.jsxs("td",{className:"px-4 py-2",children:[t.jsx("div",{className:"text-sm",children:(R=A.khoanLuong)==null?void 0:R.tenKhoan}),t.jsx("div",{className:"text-xs text-gray-500",children:(M=A.khoanLuong)==null?void 0:M.maKhoan})]}),t.jsx("td",{className:"px-4 py-2 text-right",children:t.jsxs("span",{className:`font-mono text-sm ${((q=A.khoanLuong)==null?void 0:q.loai)==="KHAU_TRU"?"text-red-600":"text-green-600"}`,children:[((ee=A.khoanLuong)==null?void 0:ee.loai)==="KHAU_TRU"?"-":"+",N(A.outputSoTien),""]})}),t.jsxs("td",{className:"px-4 py-2",children:[t.jsx("div",{className:"text-sm text-gray-600",children:A.messageGiaiThich}),A.inputJson&&t.jsxs("details",{className:"mt-1",children:[t.jsx("summary",{className:"text-xs text-blue-600 cursor-pointer",children:"Xem input"}),t.jsx("pre",{className:"mt-1 text-xs bg-gray-100 p-2 rounded overflow-x-auto",children:JSON.stringify(JSON.parse(A.inputJson),null,2)})]})]})]},A.id)})})]})})]},S)}),g.length===0&&t.jsx("div",{className:"text-center text-gray-500 py-10",children:"Khng c d liu trace"})]})]})}var mf={exports:{}},ff,Bb;function ZD(){if(Bb)return ff;Bb=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ff=e,ff}var pf,Hb;function eF(){if(Hb)return pf;Hb=1;var e=ZD();function n(){}function a(){}return a.resetWarningCache=n,pf=function(){function r(o,d,u,h,m,f){if(f!==e){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}r.isRequired=r;function s(){return r}var l={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:s,element:r,elementType:r,instanceOf:s,node:r,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:a,resetWarningCache:n};return l.PropTypes=l,l},pf}var Vb;function tF(){return Vb||(Vb=1,mf.exports=eF()()),mf.exports}var nF=tF();const Yt=Lp(nF);function xo(e,n,a,r){function s(l){return l instanceof a?l:new a(function(o){o(l)})}return new(a||(a=Promise))(function(l,o){function d(m){try{h(r.next(m))}catch(f){o(f)}}function u(m){try{h(r.throw(m))}catch(f){o(f)}}function h(m){m.done?l(m.value):s(m.value).then(d,u)}h((r=r.apply(e,n||[])).next())})}const aF=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function kc(e,n,a){const r=rF(e),{webkitRelativePath:s}=e,l=typeof n=="string"?n:typeof s=="string"&&s.length>0?s:`./${e.name}`;return typeof r.path!="string"&&Ub(r,"path",l),Ub(r,"relativePath",l),r}function rF(e){const{name:n}=e;if(n&&n.lastIndexOf(".")!==-1&&!e.type){const r=n.split(".").pop().toLowerCase(),s=aF.get(r);s&&Object.defineProperty(e,"type",{value:s,writable:!1,configurable:!1,enumerable:!0})}return e}function Ub(e,n,a){Object.defineProperty(e,n,{value:a,writable:!1,configurable:!1,enumerable:!0})}const sF=[".DS_Store","Thumbs.db"];function iF(e){return xo(this,void 0,void 0,function*(){return b0(e)&&lF(e.dataTransfer)?uF(e.dataTransfer,e.type):oF(e)?cF(e):Array.isArray(e)&&e.every(n=>"getFile"in n&&typeof n.getFile=="function")?dF(e):[]})}function lF(e){return b0(e)}function oF(e){return b0(e)&&b0(e.target)}function b0(e){return typeof e=="object"&&e!==null}function cF(e){return pp(e.target.files).map(n=>kc(n))}function dF(e){return xo(this,void 0,void 0,function*(){return(yield Promise.all(e.map(a=>a.getFile()))).map(a=>kc(a))})}function uF(e,n){return xo(this,void 0,void 0,function*(){if(e.items){const a=pp(e.items).filter(s=>s.kind==="file");if(n!=="drop")return a;const r=yield Promise.all(a.map(hF));return Kb(iw(r))}return Kb(pp(e.files).map(a=>kc(a)))})}function Kb(e){return e.filter(n=>sF.indexOf(n.name)===-1)}function pp(e){if(e===null)return[];const n=[];for(let a=0;a<e.length;a++){const r=e[a];n.push(r)}return n}function hF(e){if(typeof e.webkitGetAsEntry!="function")return zb(e);const n=e.webkitGetAsEntry();return n&&n.isDirectory?lw(n):zb(e,n)}function iw(e){return e.reduce((n,a)=>[...n,...Array.isArray(a)?iw(a):[a]],[])}function zb(e,n){return xo(this,void 0,void 0,function*(){var a;if(globalThis.isSecureContext&&typeof e.getAsFileSystemHandle=="function"){const l=yield e.getAsFileSystemHandle();if(l===null)throw new Error(`${e} is not a File`);if(l!==void 0){const o=yield l.getFile();return o.handle=l,kc(o)}}const r=e.getAsFile();if(!r)throw new Error(`${e} is not a File`);return kc(r,(a=n==null?void 0:n.fullPath)!==null&&a!==void 0?a:void 0)})}function xF(e){return xo(this,void 0,void 0,function*(){return e.isDirectory?lw(e):mF(e)})}function lw(e){const n=e.createReader();return new Promise((a,r)=>{const s=[];function l(){n.readEntries(o=>xo(this,void 0,void 0,function*(){if(o.length){const d=Promise.all(o.map(xF));s.push(d),l()}else try{const d=yield Promise.all(s);a(d)}catch(d){r(d)}}),o=>{r(o)})}l()})}function mF(e){return xo(this,void 0,void 0,function*(){return new Promise((n,a)=>{e.file(r=>{const s=kc(r,e.fullPath);n(s)},r=>{a(r)})})})}var zh={},$b;function fF(){return $b||($b=1,zh.__esModule=!0,zh.default=function(e,n){if(e&&n){var a=Array.isArray(n)?n:n.split(",");if(a.length===0)return!0;var r=e.name||"",s=(e.type||"").toLowerCase(),l=s.replace(/\/.*$/,"");return a.some(function(o){var d=o.trim().toLowerCase();return d.charAt(0)==="."?r.toLowerCase().endsWith(d):d.endsWith("/*")?l===d.replace(/\/.*$/,""):s===d})}return!0}),zh}var pF=fF();const gf=Lp(pF);function Gb(e){return vF(e)||yF(e)||cw(e)||gF()}function gF(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yF(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function vF(e){if(Array.isArray(e))return gp(e)}function qb(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),a.push.apply(a,r)}return a}function Wb(e){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?qb(Object(a),!0).forEach(function(r){ow(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):qb(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function ow(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function Wd(e,n){return jF(e)||NF(e,n)||cw(e,n)||bF()}function bF(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cw(e,n){if(e){if(typeof e=="string")return gp(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return gp(e,n)}}function gp(e,n){(n==null||n>e.length)&&(n=e.length);for(var a=0,r=new Array(n);a<n;a++)r[a]=e[a];return r}function NF(e,n){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var r=[],s=!0,l=!1,o,d;try{for(a=a.call(e);!(s=(o=a.next()).done)&&(r.push(o.value),!(n&&r.length===n));s=!0);}catch(u){l=!0,d=u}finally{try{!s&&a.return!=null&&a.return()}finally{if(l)throw d}}return r}}function jF(e){if(Array.isArray(e))return e}var wF=typeof gf=="function"?gf:gf.default,kF="file-invalid-type",TF="file-too-large",CF="file-too-small",SF="too-many-files",_F=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=n.split(","),r=a.length>1?"one of ".concat(a.join(", ")):a[0];return{code:kF,message:"File type must be ".concat(r)}},Xb=function(n){return{code:TF,message:"File is larger than ".concat(n," ").concat(n===1?"byte":"bytes")}},Qb=function(n){return{code:CF,message:"File is smaller than ".concat(n," ").concat(n===1?"byte":"bytes")}},EF={code:SF,message:"Too many files"};function dw(e,n){var a=e.type==="application/x-moz-file"||wF(e,n);return[a,a?null:_F(n)]}function uw(e,n,a){if(Ll(e.size))if(Ll(n)&&Ll(a)){if(e.size>a)return[!1,Xb(a)];if(e.size<n)return[!1,Qb(n)]}else{if(Ll(n)&&e.size<n)return[!1,Qb(n)];if(Ll(a)&&e.size>a)return[!1,Xb(a)]}return[!0,null]}function Ll(e){return e!=null}function DF(e){var n=e.files,a=e.accept,r=e.minSize,s=e.maxSize,l=e.multiple,o=e.maxFiles,d=e.validator;return!l&&n.length>1||l&&o>=1&&n.length>o?!1:n.every(function(u){var h=dw(u,a),m=Wd(h,1),f=m[0],p=uw(u,r,s),b=Wd(p,1),g=b[0],y=d?d(u):null;return f&&g&&!y})}function N0(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function $h(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(n){return n==="Files"||n==="application/x-moz-file"}):!!e.target&&!!e.target.files}function Yb(e){e.preventDefault()}function FF(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function AF(e){return e.indexOf("Edge/")!==-1}function PF(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return FF(e)||AF(e)}function ds(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return function(r){for(var s=arguments.length,l=new Array(s>1?s-1:0),o=1;o<s;o++)l[o-1]=arguments[o];return n.some(function(d){return!N0(r)&&d&&d.apply(void 0,[r].concat(l)),N0(r)})}}function LF(){return"showOpenFilePicker"in window}function OF(e){if(Ll(e)){var n=Object.entries(e).filter(function(a){var r=Wd(a,2),s=r[0],l=r[1],o=!0;return hw(s)||(console.warn('Skipped "'.concat(s,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),o=!1),(!Array.isArray(l)||!l.every(xw))&&(console.warn('Skipped "'.concat(s,'" because an invalid file extension was provided.')),o=!1),o}).reduce(function(a,r){var s=Wd(r,2),l=s[0],o=s[1];return Wb(Wb({},a),{},ow({},l,o))},{});return[{description:"Files",accept:n}]}return e}function IF(e){if(Ll(e))return Object.entries(e).reduce(function(n,a){var r=Wd(a,2),s=r[0],l=r[1];return[].concat(Gb(n),[s],Gb(l))},[]).filter(function(n){return hw(n)||xw(n)}).join(",")}function MF(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function RF(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function hw(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||e==="application/*"||/\w+\/[-+.\w]+/g.test(e)}function xw(e){return/^.*\.[\w]+$/.test(e)}var BF=["children"],HF=["open"],VF=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],UF=["refKey","onChange","onClick"];function KF(e){return GF(e)||$F(e)||mw(e)||zF()}function zF(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $F(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function GF(e){if(Array.isArray(e))return yp(e)}function yf(e,n){return XF(e)||WF(e,n)||mw(e,n)||qF()}function qF(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mw(e,n){if(e){if(typeof e=="string")return yp(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return yp(e,n)}}function yp(e,n){(n==null||n>e.length)&&(n=e.length);for(var a=0,r=new Array(n);a<n;a++)r[a]=e[a];return r}function WF(e,n){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var r=[],s=!0,l=!1,o,d;try{for(a=a.call(e);!(s=(o=a.next()).done)&&(r.push(o.value),!(n&&r.length===n));s=!0);}catch(u){l=!0,d=u}finally{try{!s&&a.return!=null&&a.return()}finally{if(l)throw d}}return r}}function XF(e){if(Array.isArray(e))return e}function Jb(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),a.push.apply(a,r)}return a}function fn(e){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?Jb(Object(a),!0).forEach(function(r){vp(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Jb(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function vp(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function j0(e,n){if(e==null)return{};var a=QF(e,n),r,s;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(s=0;s<l.length;s++)r=l[s],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function QF(e,n){if(e==null)return{};var a={},r=Object.keys(e),s,l;for(l=0;l<r.length;l++)s=r[l],!(n.indexOf(s)>=0)&&(a[s]=e[s]);return a}var dg=E.forwardRef(function(e,n){var a=e.children,r=j0(e,BF),s=ug(r),l=s.open,o=j0(s,HF);return E.useImperativeHandle(n,function(){return{open:l}},[l]),k2.createElement(E.Fragment,null,a(fn(fn({},o),{},{open:l})))});dg.displayName="Dropzone";var fw={disabled:!1,getFilesFromEvent:iF,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};dg.defaultProps=fw;dg.propTypes={children:Yt.func,accept:Yt.objectOf(Yt.arrayOf(Yt.string)),multiple:Yt.bool,preventDropOnDocument:Yt.bool,noClick:Yt.bool,noKeyboard:Yt.bool,noDrag:Yt.bool,noDragEventsBubbling:Yt.bool,minSize:Yt.number,maxSize:Yt.number,maxFiles:Yt.number,disabled:Yt.bool,getFilesFromEvent:Yt.func,onFileDialogCancel:Yt.func,onFileDialogOpen:Yt.func,useFsAccessApi:Yt.bool,autoFocus:Yt.bool,onDragEnter:Yt.func,onDragLeave:Yt.func,onDragOver:Yt.func,onDrop:Yt.func,onDropAccepted:Yt.func,onDropRejected:Yt.func,onError:Yt.func,validator:Yt.func};var bp={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function ug(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=fn(fn({},fw),e),a=n.accept,r=n.disabled,s=n.getFilesFromEvent,l=n.maxSize,o=n.minSize,d=n.multiple,u=n.maxFiles,h=n.onDragEnter,m=n.onDragLeave,f=n.onDragOver,p=n.onDrop,b=n.onDropAccepted,g=n.onDropRejected,y=n.onFileDialogCancel,N=n.onFileDialogOpen,C=n.useFsAccessApi,T=n.autoFocus,S=n.preventDropOnDocument,k=n.noClick,_=n.noKeyboard,P=n.noDrag,j=n.noDragEventsBubbling,A=n.onError,L=n.validator,W=E.useMemo(function(){return IF(a)},[a]),R=E.useMemo(function(){return OF(a)},[a]),M=E.useMemo(function(){return typeof N=="function"?N:Zb},[N]),q=E.useMemo(function(){return typeof y=="function"?y:Zb},[y]),ee=E.useRef(null),z=E.useRef(null),fe=E.useReducer(YF,bp),ae=yf(fe,2),J=ae[0],G=ae[1],he=J.isFocused,H=J.isFileDialogActive,F=E.useRef(typeof window<"u"&&window.isSecureContext&&C&&LF()),I=function(){!F.current&&H&&setTimeout(function(){if(z.current){var Ye=z.current.files;Ye.length||(G({type:"closeDialog"}),q())}},300)};E.useEffect(function(){return window.addEventListener("focus",I,!1),function(){window.removeEventListener("focus",I,!1)}},[z,H,q,F]);var O=E.useRef([]),V=function(Ye){ee.current&&ee.current.contains(Ye.target)||(Ye.preventDefault(),O.current=[])};E.useEffect(function(){return S&&(document.addEventListener("dragover",Yb,!1),document.addEventListener("drop",V,!1)),function(){S&&(document.removeEventListener("dragover",Yb),document.removeEventListener("drop",V))}},[ee,S]),E.useEffect(function(){return!r&&T&&ee.current&&ee.current.focus(),function(){}},[ee,T,r]);var te=E.useCallback(function(He){A?A(He):console.error(He)},[A]),pe=E.useCallback(function(He){He.preventDefault(),He.persist(),kn(He),O.current=[].concat(KF(O.current),[He.target]),$h(He)&&Promise.resolve(s(He)).then(function(Ye){if(!(N0(He)&&!j)){var Ft=Ye.length,qt=Ft>0&&DF({files:Ye,accept:W,minSize:o,maxSize:l,multiple:d,maxFiles:u,validator:L}),Ct=Ft>0&&!qt;G({isDragAccept:qt,isDragReject:Ct,isDragActive:!0,type:"setDraggedFiles"}),h&&h(He)}}).catch(function(Ye){return te(Ye)})},[s,h,te,j,W,o,l,d,u,L]),U=E.useCallback(function(He){He.preventDefault(),He.persist(),kn(He);var Ye=$h(He);if(Ye&&He.dataTransfer)try{He.dataTransfer.dropEffect="copy"}catch{}return Ye&&f&&f(He),!1},[f,j]),ce=E.useCallback(function(He){He.preventDefault(),He.persist(),kn(He);var Ye=O.current.filter(function(qt){return ee.current&&ee.current.contains(qt)}),Ft=Ye.indexOf(He.target);Ft!==-1&&Ye.splice(Ft,1),O.current=Ye,!(Ye.length>0)&&(G({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),$h(He)&&m&&m(He))},[ee,m,j]),Q=E.useCallback(function(He,Ye){var Ft=[],qt=[];He.forEach(function(Ct){var Mn=dw(Ct,W),ot=yf(Mn,2),It=ot[0],Gn=ot[1],Zt=uw(Ct,o,l),Ca=yf(Zt,2),ui=Ca[0],Ds=Ca[1],Fs=L?L(Ct):null;if(It&&ui&&!Fs)Ft.push(Ct);else{var as=[Gn,Ds];Fs&&(as=as.concat(Fs)),qt.push({file:Ct,errors:as.filter(function(hi){return hi})})}}),(!d&&Ft.length>1||d&&u>=1&&Ft.length>u)&&(Ft.forEach(function(Ct){qt.push({file:Ct,errors:[EF]})}),Ft.splice(0)),G({acceptedFiles:Ft,fileRejections:qt,isDragReject:qt.length>0,type:"setFiles"}),p&&p(Ft,qt,Ye),qt.length>0&&g&&g(qt,Ye),Ft.length>0&&b&&b(Ft,Ye)},[G,d,W,o,l,u,p,b,g,L]),oe=E.useCallback(function(He){He.preventDefault(),He.persist(),kn(He),O.current=[],$h(He)&&Promise.resolve(s(He)).then(function(Ye){N0(He)&&!j||Q(Ye,He)}).catch(function(Ye){return te(Ye)}),G({type:"reset"})},[s,Q,te,j]),X=E.useCallback(function(){if(F.current){G({type:"openDialog"}),M();var He={multiple:d,types:R};window.showOpenFilePicker(He).then(function(Ye){return s(Ye)}).then(function(Ye){Q(Ye,null),G({type:"closeDialog"})}).catch(function(Ye){MF(Ye)?(q(Ye),G({type:"closeDialog"})):RF(Ye)?(F.current=!1,z.current?(z.current.value=null,z.current.click()):te(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):te(Ye)});return}z.current&&(G({type:"openDialog"}),M(),z.current.value=null,z.current.click())},[G,M,q,C,Q,te,R,d]),ve=E.useCallback(function(He){!ee.current||!ee.current.isEqualNode(He.target)||(He.key===" "||He.key==="Enter"||He.keyCode===32||He.keyCode===13)&&(He.preventDefault(),X())},[ee,X]),Ke=E.useCallback(function(){G({type:"focus"})},[]),at=E.useCallback(function(){G({type:"blur"})},[]),et=E.useCallback(function(){k||(PF()?setTimeout(X,0):X())},[k,X]),Be=function(Ye){return r?null:Ye},Gt=function(Ye){return _?null:Be(Ye)},wn=function(Ye){return P?null:Be(Ye)},kn=function(Ye){j&&Ye.stopPropagation()},$n=E.useMemo(function(){return function(){var He=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ye=He.refKey,Ft=Ye===void 0?"ref":Ye,qt=He.role,Ct=He.onKeyDown,Mn=He.onFocus,ot=He.onBlur,It=He.onClick,Gn=He.onDragEnter,Zt=He.onDragOver,Ca=He.onDragLeave,ui=He.onDrop,Ds=j0(He,VF);return fn(fn(vp({onKeyDown:Gt(ds(Ct,ve)),onFocus:Gt(ds(Mn,Ke)),onBlur:Gt(ds(ot,at)),onClick:Be(ds(It,et)),onDragEnter:wn(ds(Gn,pe)),onDragOver:wn(ds(Zt,U)),onDragLeave:wn(ds(Ca,ce)),onDrop:wn(ds(ui,oe)),role:typeof qt=="string"&&qt!==""?qt:"presentation"},Ft,ee),!r&&!_?{tabIndex:0}:{}),Ds)}},[ee,ve,Ke,at,et,pe,U,ce,oe,_,P,r]),Hr=E.useCallback(function(He){He.stopPropagation()},[]),tr=E.useMemo(function(){return function(){var He=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ye=He.refKey,Ft=Ye===void 0?"ref":Ye,qt=He.onChange,Ct=He.onClick,Mn=j0(He,UF),ot=vp({accept:W,multiple:d,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:Be(ds(qt,oe)),onClick:Be(ds(Ct,Hr)),tabIndex:-1},Ft,z);return fn(fn({},ot),Mn)}},[z,a,d,oe,r]);return fn(fn({},J),{},{isFocused:he&&!r,getRootProps:$n,getInputProps:tr,rootRef:ee,inputRef:z,open:Be(X)})}function YF(e,n){switch(n.type){case"focus":return fn(fn({},e),{},{isFocused:!0});case"blur":return fn(fn({},e),{},{isFocused:!1});case"openDialog":return fn(fn({},bp),{},{isFileDialogActive:!0});case"closeDialog":return fn(fn({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return fn(fn({},e),{},{isDragActive:n.isDragActive,isDragAccept:n.isDragAccept,isDragReject:n.isDragReject});case"setFiles":return fn(fn({},e),{},{acceptedFiles:n.acceptedFiles,fileRejections:n.fileRejections,isDragReject:n.isDragReject});case"reset":return fn({},bp);default:return e}}function Zb(){}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var w0={};w0.version="0.18.5";var pw=1252,JF=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],hg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},xg=function(e){JF.indexOf(e)!=-1&&(pw=hg[0]=e)};function ZF(){xg(1252)}var Yr=function(e){xg(e)};function mg(){Yr(1200),ZF()}function eN(e){for(var n=[],a=0,r=e.length;a<r;++a)n[a]=e.charCodeAt(a);return n}function eA(e){for(var n=[],a=0;a<e.length>>1;++a)n[a]=String.fromCharCode(e.charCodeAt(2*a)+(e.charCodeAt(2*a+1)<<8));return n.join("")}function gw(e){for(var n=[],a=0;a<e.length>>1;++a)n[a]=String.fromCharCode(e.charCodeAt(2*a+1)+(e.charCodeAt(2*a)<<8));return n.join("")}var Dd=function(e){var n=e.charCodeAt(0),a=e.charCodeAt(1);return n==255&&a==254?eA(e.slice(2)):n==254&&a==255?gw(e.slice(2)):n==65279?e.slice(1):e},Gh=function(n){return String.fromCharCode(n)},tN=function(n){return String.fromCharCode(n)},Xd,Wi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Qd(e){for(var n="",a=0,r=0,s=0,l=0,o=0,d=0,u=0,h=0;h<e.length;)a=e.charCodeAt(h++),l=a>>2,r=e.charCodeAt(h++),o=(a&3)<<4|r>>4,s=e.charCodeAt(h++),d=(r&15)<<2|s>>6,u=s&63,isNaN(r)?d=u=64:isNaN(s)&&(u=64),n+=Wi.charAt(l)+Wi.charAt(o)+Wi.charAt(d)+Wi.charAt(u);return n}function hr(e){var n="",a=0,r=0,s=0,l=0,o=0,d=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)l=Wi.indexOf(e.charAt(h++)),o=Wi.indexOf(e.charAt(h++)),a=l<<2|o>>4,n+=String.fromCharCode(a),d=Wi.indexOf(e.charAt(h++)),r=(o&15)<<4|d>>2,d!==64&&(n+=String.fromCharCode(r)),u=Wi.indexOf(e.charAt(h++)),s=(d&3)<<6|u,u!==64&&(n+=String.fromCharCode(s));return n}var bt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),oi=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(n,a){return a?new Buffer(n,a):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}})();function rl(e){return bt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function nN(e){return bt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var cr=function(n){return bt?oi(n,"binary"):n.split("").map(function(a){return a.charCodeAt(0)&255})};function ex(e){if(typeof ArrayBuffer>"u")return cr(e);for(var n=new ArrayBuffer(e.length),a=new Uint8Array(n),r=0;r!=e.length;++r)a[r]=e.charCodeAt(r)&255;return n}function dl(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var n=[],a=0;a<e.length;++a)n[a]=String.fromCharCode(e[a]);return n.join("")}function tA(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function fg(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return fg(new Uint8Array(e));for(var n=new Array(e.length),a=0;a<e.length;++a)n[a]=e[a];return n}var ea=bt?function(e){return Buffer.concat(e.map(function(n){return Buffer.isBuffer(n)?n:oi(n)}))}:function(e){if(typeof Uint8Array<"u"){var n=0,a=0;for(n=0;n<e.length;++n)a+=e[n].length;var r=new Uint8Array(a),s=0;for(n=0,a=0;n<e.length;a+=s,++n)if(s=e[n].length,e[n]instanceof Uint8Array)r.set(e[n],a);else{if(typeof e[n]=="string")throw"wtf";r.set(new Uint8Array(e[n]),a)}return r}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function nA(e){for(var n=[],a=0,r=e.length+250,s=rl(e.length+255),l=0;l<e.length;++l){var o=e.charCodeAt(l);if(o<128)s[a++]=o;else if(o<2048)s[a++]=192|o>>6&31,s[a++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var d=e.charCodeAt(++l)&1023;s[a++]=240|o>>8&7,s[a++]=128|o>>2&63,s[a++]=128|d>>6&15|(o&3)<<4,s[a++]=128|d&63}else s[a++]=224|o>>12&15,s[a++]=128|o>>6&63,s[a++]=128|o&63;a>r&&(n.push(s.slice(0,a)),a=0,s=rl(65535),r=65530)}return n.push(s.slice(0,a)),ea(n)}var Ia=/\u0000/g,Fd=/[\u0001-\u0006]/g;function rc(e){for(var n="",a=e.length-1;a>=0;)n+=e.charAt(a--);return n}function Jr(e,n){var a=""+e;return a.length>=n?a:bn("0",n-a.length)+a}function pg(e,n){var a=""+e;return a.length>=n?a:bn(" ",n-a.length)+a}function k0(e,n){var a=""+e;return a.length>=n?a:a+bn(" ",n-a.length)}function aA(e,n){var a=""+Math.round(e);return a.length>=n?a:bn("0",n-a.length)+a}function rA(e,n){var a=""+e;return a.length>=n?a:bn("0",n-a.length)+a}var aN=Math.pow(2,32);function Yo(e,n){if(e>aN||e<-aN)return aA(e,n);var a=Math.round(e);return rA(a,n)}function T0(e,n){return n=n||0,e.length>=7+n&&(e.charCodeAt(n)|32)===103&&(e.charCodeAt(n+1)|32)===101&&(e.charCodeAt(n+2)|32)===110&&(e.charCodeAt(n+3)|32)===101&&(e.charCodeAt(n+4)|32)===114&&(e.charCodeAt(n+5)|32)===97&&(e.charCodeAt(n+6)|32)===108}var rN=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],vf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function sA(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ct={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},sN={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},iA={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function C0(e,n,a){for(var r=e<0?-1:1,s=e*r,l=0,o=1,d=0,u=1,h=0,m=0,f=Math.floor(s);h<n&&(f=Math.floor(s),d=f*o+l,m=f*h+u,!(s-f<5e-8));)s=1/(s-f),l=o,o=d,u=h,h=m;if(m>n&&(h>n?(m=u,d=l):(m=h,d=o)),!a)return[0,r*d,m];var p=Math.floor(r*d/m);return[p,r*d-p*m,m]}function Rl(e,n,a){if(e>2958465||e<0)return null;var r=e|0,s=Math.floor(86400*(e-r)),l=0,o=[],d={D:r,T:s,u:86400*(e-r)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),n&&n.date1904&&(r+=1462),d.u>.9999&&(d.u=0,++s==86400&&(d.T=s=0,++r,++d.D)),r===60)o=a?[1317,10,29]:[1900,2,29],l=3;else if(r===0)o=a?[1317,8,29]:[1900,1,0],l=6;else{r>60&&--r;var u=new Date(1900,0,1);u.setDate(u.getDate()+r-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],l=u.getDay(),r<60&&(l=(l+6)%7),a&&(l=hA(u,o))}return d.y=o[0],d.m=o[1],d.d=o[2],d.S=s%60,s=Math.floor(s/60),d.M=s%60,s=Math.floor(s/60),d.H=s,d.q=l,d}var yw=new Date(1899,11,31,0,0,0),lA=yw.getTime(),oA=new Date(1900,2,1,0,0,0);function vw(e,n){var a=e.getTime();return n?a-=1461*24*60*60*1e3:e>=oA&&(a+=1440*60*1e3),(a-(lA+(e.getTimezoneOffset()-yw.getTimezoneOffset())*6e4))/(1440*60*1e3)}function gg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function cA(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function dA(e){var n=e<0?12:11,a=gg(e.toFixed(12));return a.length<=n||(a=e.toPrecision(10),a.length<=n)?a:e.toExponential(5)}function uA(e){var n=gg(e.toFixed(11));return n.length>(e<0?12:11)||n==="0"||n==="-0"?e.toPrecision(6):n}function Yd(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),a;return n>=-4&&n<=-1?a=e.toPrecision(10+n):Math.abs(n)<=9?a=dA(e):n===10?a=e.toFixed(10).substr(0,12):a=uA(e),gg(cA(a.toUpperCase()))}function ro(e,n){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Yd(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Mr(14,vw(e,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+e)}function hA(e,n){n[0]-=581;var a=e.getDay();return e<60&&(a=(a+6)%7),a}function xA(e,n,a,r){var s="",l=0,o=0,d=a.y,u,h=0;switch(e){case 98:d=a.y+543;case 121:switch(n.length){case 1:case 2:u=d%100,h=2;break;default:u=d%1e4,h=4;break}break;case 109:switch(n.length){case 1:case 2:u=a.m,h=n.length;break;case 3:return vf[a.m-1][1];case 5:return vf[a.m-1][0];default:return vf[a.m-1][2]}break;case 100:switch(n.length){case 1:case 2:u=a.d,h=n.length;break;case 3:return rN[a.q][0];default:return rN[a.q][1]}break;case 104:switch(n.length){case 1:case 2:u=1+(a.H+11)%12,h=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:u=a.H,h=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:u=a.M,h=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return a.u===0&&(n=="s"||n=="ss")?Jr(a.S,n.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,l=Math.round(o*(a.S+a.u)),l>=60*o&&(l=0),n==="s"?l===0?"0":""+l/o:(s=Jr(l,2+r),n==="ss"?s.substr(0,2):"."+s.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":u=a.D*24+a.H;break;case"[m]":case"[mm]":u=(a.D*24+a.H)*60+a.M;break;case"[s]":case"[ss]":u=((a.D*24+a.H)*60+a.M)*60+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+n}h=n.length===3?1:2;break;case 101:u=d,h=1;break}var m=h>0?Jr(u,h):"";return m}function Xi(e){var n=3;if(e.length<=n)return e;for(var a=e.length%n,r=e.substr(0,a);a!=e.length;a+=n)r+=(r.length>0?",":"")+e.substr(a,n);return r}var bw=/%/g;function mA(e,n,a){var r=n.replace(bw,""),s=n.length-r.length;return ti(e,r,a*Math.pow(10,2*s))+bn("%",s)}function fA(e,n,a){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return ti(e,n.substr(0,r),a/Math.pow(10,3*(n.length-r)))}function Nw(e,n){var a,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Nw(e,-n);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(n)*Math.LOG10E)%s;if(l<0&&(l+=s),a=(n/Math.pow(10,l)).toPrecision(r+1+(s+l)%s),a.indexOf("e")===-1){var o=Math.floor(Math.log(n)*Math.LOG10E);for(a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(o-a.length+l):a+="E+"+(o-l);a.substr(0,2)==="0.";)a=a.charAt(0)+a.substr(2,s)+"."+a.substr(2+s),a=a.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,u,h,m){return u+h+m.substr(0,(s+l)%s)+"."+m.substr(l)+"E"})}else a=n.toExponential(r);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var jw=/# (\?+)( ?)\/( ?)(\d+)/;function pA(e,n,a){var r=parseInt(e[4],10),s=Math.round(n*r),l=Math.floor(s/r),o=s-l*r,d=r;return a+(l===0?"":""+l)+" "+(o===0?bn(" ",e[1].length+1+e[4].length):pg(o,e[1].length)+e[2]+"/"+e[3]+Jr(d,e[4].length))}function gA(e,n,a){return a+(n===0?"":""+n)+bn(" ",e[1].length+2+e[4].length)}var ww=/^#*0*\.([0#]+)/,kw=/\).*[0#]/,Tw=/\(###\) ###\\?-####/;function Aa(e){for(var n="",a,r=0;r!=e.length;++r)switch(a=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(a)}return n}function iN(e,n){var a=Math.pow(10,n);return""+Math.round(e*a)/a}function lN(e,n){var a=e-Math.floor(e),r=Math.pow(10,n);return n<(""+Math.round(a*r)).length?0:Math.round(a*r)}function yA(e,n){return n<(""+Math.round((e-Math.floor(e))*Math.pow(10,n))).length?1:0}function vA(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Nr(e,n,a){if(e.charCodeAt(0)===40&&!n.match(kw)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?Nr("n",r,a):"("+Nr("n",r,-a)+")"}if(n.charCodeAt(n.length-1)===44)return fA(e,n,a);if(n.indexOf("%")!==-1)return mA(e,n,a);if(n.indexOf("E")!==-1)return Nw(n,a);if(n.charCodeAt(0)===36)return"$"+Nr(e,n.substr(n.charAt(1)==" "?2:1),a);var s,l,o,d,u=Math.abs(a),h=a<0?"-":"";if(n.match(/^00+$/))return h+Yo(u,n.length);if(n.match(/^[#?]+$/))return s=Yo(a,0),s==="0"&&(s=""),s.length>n.length?s:Aa(n.substr(0,n.length-s.length))+s;if(l=n.match(jw))return pA(l,u,h);if(n.match(/^#+0+$/))return h+Yo(u,n.length-n.indexOf("0"));if(l=n.match(ww))return s=iN(a,l[1].length).replace(/^([^\.]+)$/,"$1."+Aa(l[1])).replace(/\.$/,"."+Aa(l[1])).replace(/\.(\d*)$/,function(g,y){return"."+y+bn("0",Aa(l[1]).length-y.length)}),n.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),l=n.match(/^(0*)\.(#*)$/))return h+iN(u,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=n.match(/^#{1,3},##0(\.?)$/))return h+Xi(Yo(u,0));if(l=n.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+Nr(e,n,-a):Xi(""+(Math.floor(a)+yA(a,l[1].length)))+"."+Jr(lN(a,l[1].length),l[1].length);if(l=n.match(/^#,#*,#0/))return Nr(e,n.replace(/^#,#*,/,""),a);if(l=n.match(/^([0#]+)(\\?-([0#]+))+$/))return s=rc(Nr(e,n.replace(/[\\-]/g,""),a)),o=0,rc(rc(n.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<s.length?s.charAt(o++):g==="0"?"0":""}));if(n.match(Tw))return s=Nr(e,"##########",a),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var m="";if(l=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),d=C0(u,Math.pow(10,o)-1,!1),s=""+h,m=ti("n",l[1],d[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),s+=m+l[2]+"/"+l[3],m=k0(d[2],o),m.length<l[4].length&&(m=Aa(l[4].substr(l[4].length-m.length))+m),s+=m,s;if(l=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),d=C0(u,Math.pow(10,o)-1,!0),h+(d[0]||(d[1]?"":"0"))+" "+(d[1]?pg(d[1],o)+l[2]+"/"+l[3]+k0(d[2],o):bn(" ",2*o+1+l[2].length+l[3].length));if(l=n.match(/^[#0?]+$/))return s=Yo(a,0),n.length<=s.length?s:Aa(n.substr(0,n.length-s.length))+s;if(l=n.match(/^([#0?]+)\.([#0]+)$/)){s=""+a.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=n.indexOf(".")-o,p=n.length-s.length-f;return Aa(n.substr(0,f)+s+n.substr(n.length-p))}if(l=n.match(/^00,000\.([#0]*0)$/))return o=lN(a,l[1].length),a<0?"-"+Nr(e,n,-a):Xi(vA(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Jr(0,3-g.length):"")+g})+"."+Jr(o,l[1].length);switch(n){case"###,##0.00":return Nr(e,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var b=Xi(Yo(u,0));return b!=="0"?h+b:"";case"###,###.00":return Nr(e,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return Nr(e,"#,##0.00",a).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function bA(e,n,a){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return ti(e,n.substr(0,r),a/Math.pow(10,3*(n.length-r)))}function NA(e,n,a){var r=n.replace(bw,""),s=n.length-r.length;return ti(e,r,a*Math.pow(10,2*s))+bn("%",s)}function Cw(e,n){var a,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Cw(e,-n);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(n)*Math.LOG10E)%s;if(l<0&&(l+=s),a=(n/Math.pow(10,l)).toPrecision(r+1+(s+l)%s),!a.match(/[Ee]/)){var o=Math.floor(Math.log(n)*Math.LOG10E);a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(o-a.length+l):a+="E+"+(o-l),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,u,h,m){return u+h+m.substr(0,(s+l)%s)+"."+m.substr(l)+"E"})}else a=n.toExponential(r);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function hs(e,n,a){if(e.charCodeAt(0)===40&&!n.match(kw)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?hs("n",r,a):"("+hs("n",r,-a)+")"}if(n.charCodeAt(n.length-1)===44)return bA(e,n,a);if(n.indexOf("%")!==-1)return NA(e,n,a);if(n.indexOf("E")!==-1)return Cw(n,a);if(n.charCodeAt(0)===36)return"$"+hs(e,n.substr(n.charAt(1)==" "?2:1),a);var s,l,o,d,u=Math.abs(a),h=a<0?"-":"";if(n.match(/^00+$/))return h+Jr(u,n.length);if(n.match(/^[#?]+$/))return s=""+a,a===0&&(s=""),s.length>n.length?s:Aa(n.substr(0,n.length-s.length))+s;if(l=n.match(jw))return gA(l,u,h);if(n.match(/^#+0+$/))return h+Jr(u,n.length-n.indexOf("0"));if(l=n.match(ww))return s=(""+a).replace(/^([^\.]+)$/,"$1."+Aa(l[1])).replace(/\.$/,"."+Aa(l[1])),s=s.replace(/\.(\d*)$/,function(g,y){return"."+y+bn("0",Aa(l[1]).length-y.length)}),n.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),l=n.match(/^(0*)\.(#*)$/))return h+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=n.match(/^#{1,3},##0(\.?)$/))return h+Xi(""+u);if(l=n.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+hs(e,n,-a):Xi(""+a)+"."+bn("0",l[1].length);if(l=n.match(/^#,#*,#0/))return hs(e,n.replace(/^#,#*,/,""),a);if(l=n.match(/^([0#]+)(\\?-([0#]+))+$/))return s=rc(hs(e,n.replace(/[\\-]/g,""),a)),o=0,rc(rc(n.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<s.length?s.charAt(o++):g==="0"?"0":""}));if(n.match(Tw))return s=hs(e,"##########",a),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var m="";if(l=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),d=C0(u,Math.pow(10,o)-1,!1),s=""+h,m=ti("n",l[1],d[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),s+=m+l[2]+"/"+l[3],m=k0(d[2],o),m.length<l[4].length&&(m=Aa(l[4].substr(l[4].length-m.length))+m),s+=m,s;if(l=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),d=C0(u,Math.pow(10,o)-1,!0),h+(d[0]||(d[1]?"":"0"))+" "+(d[1]?pg(d[1],o)+l[2]+"/"+l[3]+k0(d[2],o):bn(" ",2*o+1+l[2].length+l[3].length));if(l=n.match(/^[#0?]+$/))return s=""+a,n.length<=s.length?s:Aa(n.substr(0,n.length-s.length))+s;if(l=n.match(/^([#0]+)\.([#0]+)$/)){s=""+a.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=n.indexOf(".")-o,p=n.length-s.length-f;return Aa(n.substr(0,f)+s+n.substr(n.length-p))}if(l=n.match(/^00,000\.([#0]*0)$/))return a<0?"-"+hs(e,n,-a):Xi(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Jr(0,3-g.length):"")+g})+"."+Jr(0,l[1].length);switch(n){case"###,###":case"##,###":case"#,###":var b=Xi(""+u);return b!=="0"?h+b:"";default:if(n.match(/\.[0#?]*$/))return hs(e,n.slice(0,n.lastIndexOf(".")),a)+Aa(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function ti(e,n,a){return(a|0)===a?hs(e,n,a):Nr(e,n,a)}function jA(e){for(var n=[],a=!1,r=0,s=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:a=!a;break;case 95:case 42:case 92:++r;break;case 59:n[n.length]=e.substr(s,r-s),s=r+1}if(n[n.length]=e.substr(s),a===!0)throw new Error("Format |"+e+"| unterminated string ");return n}var Sw=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Pc(e){for(var n=0,a="",r="";n<e.length;)switch(a=e.charAt(n)){case"G":T0(e,n)&&(n+=6),n++;break;case'"':for(;e.charCodeAt(++n)!==34&&n<e.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(e.charAt(n+1)==="1"||e.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(n,3).toUpperCase()==="A/P"||e.substr(n,5).toUpperCase()==="AM/PM"||e.substr(n,5).toUpperCase()==="/")return!0;++n;break;case"[":for(r=a;e.charAt(n++)!=="]"&&n<e.length;)r+=e.charAt(n);if(r.match(Sw))return!0;break;case".":case"0":case"#":for(;n<e.length&&("0#?.,E+-%".indexOf(a=e.charAt(++n))>-1||a=="\\"&&e.charAt(n+1)=="-"&&"0#".indexOf(e.charAt(n+2))>-1););break;case"?":for(;e.charAt(++n)===a;);break;case"*":++n,(e.charAt(n)==" "||e.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<e.length&&"0123456789".indexOf(e.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function wA(e,n,a,r){for(var s=[],l="",o=0,d="",u="t",h,m,f,p="H";o<e.length;)switch(d=e.charAt(o)){case"G":if(!T0(e,o))throw new Error("unrecognized character "+d+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(l="";(f=e.charCodeAt(++o))!==34&&o<e.length;)l+=String.fromCharCode(f);s[s.length]={t:"t",v:l},++o;break;case"\\":var b=e.charAt(++o),g=b==="("||b===")"?b:"t";s[s.length]={t:g,v:b},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:n},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(h==null&&(h=Rl(n,a,e.charAt(o+1)==="2"),h==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},u=d,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||h==null&&(h=Rl(n,a),h==null))return"";for(l=d;++o<e.length&&e.charAt(o).toLowerCase()===d;)l+=d;d==="m"&&u.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=p),s[s.length]={t:d,v:l},u=d;break;case"A":case"a":case"":var y={t:d,v:d};if(h==null&&(h=Rl(n,a)),e.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(y.v=h.H>=12?"P":"A"),y.t="T",p="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(y.v=h.H>=12?"PM":"AM"),y.t="T",o+=5,p="h"):e.substr(o,5).toUpperCase()==="/"?(h!=null&&(y.v=h.H>=12?"":""),y.t="T",o+=5,p="h"):(y.t="t",++o),h==null&&y.t==="T")return"";s[s.length]=y,u=d;break;case"[":for(l=d;e.charAt(o++)!=="]"&&o<e.length;)l+=e.charAt(o);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(Sw)){if(h==null&&(h=Rl(n,a),h==null))return"";s[s.length]={t:"Z",v:l.toLowerCase()},u=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Pc(e)||(s[s.length]={t:"t",v:l}));break;case".":if(h!=null){for(l=d;++o<e.length&&(d=e.charAt(o))==="0";)l+=d;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=d;++o<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(o))>-1;)l+=d;s[s.length]={t:"n",v:l};break;case"?":for(l=d;e.charAt(++o)===d;)l+=d;s[s.length]={t:d,v:l},u=d;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:r===1?"t":d,v:d},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=d;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)l+=e.charAt(o);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:d,v:d},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+e);s[s.length]={t:"t",v:d},++o;break}var N=0,C=0,T;for(o=s.length-1,u="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=p,u="h",N<1&&(N=1);break;case"s":(T=s[o].v.match(/\.0+$/))&&(C=Math.max(C,T[0].length-1)),N<3&&(N=3);case"d":case"y":case"M":case"e":u=s[o].t;break;case"m":u==="s"&&(s[o].t="M",N<2&&(N=2));break;case"X":break;case"Z":N<1&&s[o].v.match(/[Hh]/)&&(N=1),N<2&&s[o].v.match(/[Mm]/)&&(N=2),N<3&&s[o].v.match(/[Ss]/)&&(N=3)}switch(N){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var S="",k;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=xA(s[o].t.charCodeAt(0),s[o].v,h,C),s[o].t="t";break;case"n":case"?":for(k=o+1;s[k]!=null&&((d=s[k].t)==="?"||d==="D"||(d===" "||d==="t")&&s[k+1]!=null&&(s[k+1].t==="?"||s[k+1].t==="t"&&s[k+1].v==="/")||s[o].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(s[k].v==="/"||s[k].v===" "&&s[k+1]!=null&&s[k+1].t=="?"));)s[o].v+=s[k].v,s[k]={v:"",t:";"},++k;S+=s[o].v,o=k-1;break;case"G":s[o].t="t",s[o].v=ro(n,a);break}var _="",P,j;if(S.length>0){S.charCodeAt(0)==40?(P=n<0&&S.charCodeAt(0)===45?-n:n,j=ti("n",S,P)):(P=n<0&&r>1?-n:n,j=ti("n",S,P),P<0&&s[0]&&s[0].t=="t"&&(j=j.substr(1),s[0].v="-"+s[0].v)),k=j.length-1;var A=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){A=o;break}var L=s.length;if(A===s.length&&j.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(k>=s[o].v.length-1?(k-=s[o].v.length,s[o].v=j.substr(k+1,s[o].v.length)):k<0?s[o].v="":(s[o].v=j.substr(0,k+1),k=-1),s[o].t="t",L=o);k>=0&&L<s.length&&(s[L].v=j.substr(0,k+1)+s[L].v)}else if(A!==s.length&&j.indexOf("E")===-1){for(k=j.indexOf(".")-1,o=A;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(m=s[o].v.indexOf(".")>-1&&o===A?s[o].v.indexOf(".")-1:s[o].v.length-1,_=s[o].v.substr(m+1);m>=0;--m)k>=0&&(s[o].v.charAt(m)==="0"||s[o].v.charAt(m)==="#")&&(_=j.charAt(k--)+_);s[o].v=_,s[o].t="t",L=o}for(k>=0&&L<s.length&&(s[L].v=j.substr(0,k+1)+s[L].v),k=j.indexOf(".")+1,o=A;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==A)){for(m=s[o].v.indexOf(".")>-1&&o===A?s[o].v.indexOf(".")+1:0,_=s[o].v.substr(0,m);m<s[o].v.length;++m)k<j.length&&(_+=j.charAt(k++));s[o].v=_,s[o].t="t",L=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(P=r>1&&n<0&&o>0&&s[o-1].v==="-"?-n:n,s[o].v=ti(s[o].t,s[o].v,P),s[o].t="t");var W="";for(o=0;o!==s.length;++o)s[o]!=null&&(W+=s[o].v);return W}var oN=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function cN(e,n){if(n==null)return!1;var a=parseFloat(n[2]);switch(n[1]){case"=":if(e==a)return!0;break;case">":if(e>a)return!0;break;case"<":if(e<a)return!0;break;case"<>":if(e!=a)return!0;break;case">=":if(e>=a)return!0;break;case"<=":if(e<=a)return!0;break}return!1}function kA(e,n){var a=jA(e),r=a.length,s=a[r-1].indexOf("@");if(r<4&&s>-1&&--r,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if(typeof n!="number")return[4,a.length===4||s>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=s>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=s>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=s>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"];break}var l=n>0?a[0]:n<0?a[1]:a[2];if(a[0].indexOf("[")===-1&&a[1].indexOf("[")===-1)return[r,l];if(a[0].match(/\[[=<>]/)!=null||a[1].match(/\[[=<>]/)!=null){var o=a[0].match(oN),d=a[1].match(oN);return cN(n,o)?[r,a[0]]:cN(n,d)?[r,a[1]]:[r,a[o!=null&&d!=null?2:1]]}return[r,l]}function Mr(e,n,a){a==null&&(a={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&a.dateNF?r=a.dateNF:r=e;break;case"number":e==14&&a.dateNF?r=a.dateNF:r=(a.table!=null?a.table:ct)[e],r==null&&(r=a.table&&a.table[sN[e]]||ct[sN[e]]),r==null&&(r=iA[e]||"General");break}if(T0(r,0))return ro(n,a);n instanceof Date&&(n=vw(n,a.date1904));var s=kA(r,n);if(T0(s[1]))return ro(n,a);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return wA(s[1],n,a,s[0])}function ni(e,n){if(typeof n!="number"){n=+n||-1;for(var a=0;a<392;++a){if(ct[a]==null){n<0&&(n=a);continue}if(ct[a]==e){n=a;break}}n<0&&(n=391)}return ct[n]=e,n}function tx(e){for(var n=0;n!=392;++n)e[n]!==void 0&&ni(e[n],n)}function Lc(){ct=sA()}var TA={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},_w=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function CA(e){var n=typeof e=="number"?ct[e]:e;return n=n.replace(_w,"(\\d+)"),new RegExp("^"+n+"$")}function SA(e,n,a){var r=-1,s=-1,l=-1,o=-1,d=-1,u=-1;(n.match(_w)||[]).forEach(function(f,p){var b=parseInt(a[p+1],10);switch(f.toLowerCase().charAt(0)){case"y":r=b;break;case"d":l=b;break;case"h":o=b;break;case"s":u=b;break;case"m":o>=0?d=b:s=b;break}}),u>=0&&d==-1&&s>=0&&(d=s,s=-1);var h=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var m=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&d==-1&&u==-1?h:r==-1&&s==-1&&l==-1?m:h+"T"+m}var _A=(function(){var e={};e.version="1.2.0";function n(){for(var j=0,A=new Array(256),L=0;L!=256;++L)j=L,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,A[L]=j;return typeof Int32Array<"u"?new Int32Array(A):A}var a=n();function r(j){var A=0,L=0,W=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)R[W]=j[W];for(W=0;W!=256;++W)for(L=j[W],A=256+W;A<4096;A+=256)L=R[A]=L>>>8^j[L&255];var M=[];for(W=1;W!=16;++W)M[W-1]=typeof Int32Array<"u"?R.subarray(W*256,W*256+256):R.slice(W*256,W*256+256);return M}var s=r(a),l=s[0],o=s[1],d=s[2],u=s[3],h=s[4],m=s[5],f=s[6],p=s[7],b=s[8],g=s[9],y=s[10],N=s[11],C=s[12],T=s[13],S=s[14];function k(j,A){for(var L=A^-1,W=0,R=j.length;W<R;)L=L>>>8^a[(L^j.charCodeAt(W++))&255];return~L}function _(j,A){for(var L=A^-1,W=j.length-15,R=0;R<W;)L=S[j[R++]^L&255]^T[j[R++]^L>>8&255]^C[j[R++]^L>>16&255]^N[j[R++]^L>>>24]^y[j[R++]]^g[j[R++]]^b[j[R++]]^p[j[R++]]^f[j[R++]]^m[j[R++]]^h[j[R++]]^u[j[R++]]^d[j[R++]]^o[j[R++]]^l[j[R++]]^a[j[R++]];for(W+=15;R<W;)L=L>>>8^a[(L^j[R++])&255];return~L}function P(j,A){for(var L=A^-1,W=0,R=j.length,M=0,q=0;W<R;)M=j.charCodeAt(W++),M<128?L=L>>>8^a[(L^M)&255]:M<2048?(L=L>>>8^a[(L^(192|M>>6&31))&255],L=L>>>8^a[(L^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,q=j.charCodeAt(W++)&1023,L=L>>>8^a[(L^(240|M>>8&7))&255],L=L>>>8^a[(L^(128|M>>2&63))&255],L=L>>>8^a[(L^(128|q>>6&15|(M&3)<<4))&255],L=L>>>8^a[(L^(128|q&63))&255]):(L=L>>>8^a[(L^(224|M>>12&15))&255],L=L>>>8^a[(L^(128|M>>6&63))&255],L=L>>>8^a[(L^(128|M&63))&255]);return~L}return e.table=a,e.bstr=k,e.buf=_,e.str=P,e})(),nt=(function(){var n={};n.version="1.2.1";function a(K,ne){for(var Y=K.split("/"),Z=ne.split("/"),re=0,se=0,Ne=Math.min(Y.length,Z.length);re<Ne;++re){if(se=Y[re].length-Z[re].length)return se;if(Y[re]!=Z[re])return Y[re]<Z[re]?-1:1}return Y.length-Z.length}function r(K){if(K.charAt(K.length-1)=="/")return K.slice(0,-1).indexOf("/")===-1?K:r(K.slice(0,-1));var ne=K.lastIndexOf("/");return ne===-1?K:K.slice(0,ne+1)}function s(K){if(K.charAt(K.length-1)=="/")return s(K.slice(0,-1));var ne=K.lastIndexOf("/");return ne===-1?K:K.slice(ne+1)}function l(K,ne){typeof ne=="string"&&(ne=new Date(ne));var Y=ne.getHours();Y=Y<<6|ne.getMinutes(),Y=Y<<5|ne.getSeconds()>>>1,K.write_shift(2,Y);var Z=ne.getFullYear()-1980;Z=Z<<4|ne.getMonth()+1,Z=Z<<5|ne.getDate(),K.write_shift(2,Z)}function o(K){var ne=K.read_shift(2)&65535,Y=K.read_shift(2)&65535,Z=new Date,re=Y&31;Y>>>=5;var se=Y&15;Y>>>=4,Z.setMilliseconds(0),Z.setFullYear(Y+1980),Z.setMonth(se-1),Z.setDate(re);var Ne=ne&31;ne>>>=5;var Se=ne&63;return ne>>>=6,Z.setHours(ne),Z.setMinutes(Se),Z.setSeconds(Ne<<1),Z}function d(K){oa(K,0);for(var ne={},Y=0;K.l<=K.length-4;){var Z=K.read_shift(2),re=K.read_shift(2),se=K.l+re,Ne={};switch(Z){case 21589:Y=K.read_shift(1),Y&1&&(Ne.mtime=K.read_shift(4)),re>5&&(Y&2&&(Ne.atime=K.read_shift(4)),Y&4&&(Ne.ctime=K.read_shift(4))),Ne.mtime&&(Ne.mt=new Date(Ne.mtime*1e3));break}K.l=se,ne[Z]=Ne}return ne}var u;function h(){return u||(u={})}function m(K,ne){if(K[0]==80&&K[1]==75)return jo(K,ne);if((K[0]|32)==109&&(K[1]|32)==105)return Pu(K,ne);if(K.length<512)throw new Error("CFB file size "+K.length+" < 512");var Y=3,Z=512,re=0,se=0,Ne=0,Se=0,be=0,je=[],we=K.slice(0,512);oa(we,0);var Pe=f(we);switch(Y=Pe[0],Y){case 3:Z=512;break;case 4:Z=4096;break;case 0:if(Pe[1]==0)return jo(K,ne);default:throw new Error("Major Version: Expected 3 or 4 saw "+Y)}Z!==512&&(we=K.slice(0,Z),oa(we,28));var ze=K.slice(0,Z);p(we,Y);var qe=we.read_shift(4,"i");if(Y===3&&qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qe);we.l+=4,Ne=we.read_shift(4,"i"),we.l+=4,we.chk("00100000","Mini Stream Cutoff Size: "),Se=we.read_shift(4,"i"),re=we.read_shift(4,"i"),be=we.read_shift(4,"i"),se=we.read_shift(4,"i");for(var Me=-1,Oe=0;Oe<109&&(Me=we.read_shift(4,"i"),!(Me<0));++Oe)je[Oe]=Me;var xt=b(K,Z);N(be,se,xt,Z,je);var Qt=T(xt,Ne,je,Z);Qt[Ne].name="!Directory",re>0&&Se!==q&&(Qt[Se].name="!MiniFAT"),Qt[je[0]].name="!FAT",Qt.fat_addrs=je,Qt.ssz=Z;var en={},Tn=[],pl=[],fi=[];S(Ne,Qt,xt,Tn,re,en,pl,Se),g(pl,fi,Tn),Tn.shift();var rs={FileIndex:pl,FullPaths:fi};return ne&&ne.raw&&(rs.raw={header:ze,sectors:xt}),rs}function f(K){if(K[K.l]==80&&K[K.l+1]==75)return[0,0];K.chk(ee,"Header Signature: "),K.l+=16;var ne=K.read_shift(2,"u");return[K.read_shift(2,"u"),ne]}function p(K,ne){var Y=9;switch(K.l+=2,Y=K.read_shift(2)){case 9:if(ne!=3)throw new Error("Sector Shift: Expected 9 saw "+Y);break;case 12:if(ne!=4)throw new Error("Sector Shift: Expected 12 saw "+Y);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Y)}K.chk("0600","Mini Sector Shift: "),K.chk("000000000000","Reserved: ")}function b(K,ne){for(var Y=Math.ceil(K.length/ne)-1,Z=[],re=1;re<Y;++re)Z[re-1]=K.slice(re*ne,(re+1)*ne);return Z[Y-1]=K.slice(Y*ne),Z}function g(K,ne,Y){for(var Z=0,re=0,se=0,Ne=0,Se=0,be=Y.length,je=[],we=[];Z<be;++Z)je[Z]=we[Z]=Z,ne[Z]=Y[Z];for(;Se<we.length;++Se)Z=we[Se],re=K[Z].L,se=K[Z].R,Ne=K[Z].C,je[Z]===Z&&(re!==-1&&je[re]!==re&&(je[Z]=je[re]),se!==-1&&je[se]!==se&&(je[Z]=je[se])),Ne!==-1&&(je[Ne]=Z),re!==-1&&Z!=je[Z]&&(je[re]=je[Z],we.lastIndexOf(re)<Se&&we.push(re)),se!==-1&&Z!=je[Z]&&(je[se]=je[Z],we.lastIndexOf(se)<Se&&we.push(se));for(Z=1;Z<be;++Z)je[Z]===Z&&(se!==-1&&je[se]!==se?je[Z]=je[se]:re!==-1&&je[re]!==re&&(je[Z]=je[re]));for(Z=1;Z<be;++Z)if(K[Z].type!==0){if(Se=Z,Se!=je[Se])do Se=je[Se],ne[Z]=ne[Se]+"/"+ne[Z];while(Se!==0&&je[Se]!==-1&&Se!=je[Se]);je[Z]=-1}for(ne[0]+="/",Z=1;Z<be;++Z)K[Z].type!==2&&(ne[Z]+="/")}function y(K,ne,Y){for(var Z=K.start,re=K.size,se=[],Ne=Z;Y&&re>0&&Ne>=0;)se.push(ne.slice(Ne*M,Ne*M+M)),re-=M,Ne=Ol(Y,Ne*4);return se.length===0?Ce(0):ea(se).slice(0,K.size)}function N(K,ne,Y,Z,re){var se=q;if(K===q){if(ne!==0)throw new Error("DIFAT chain shorter than expected")}else if(K!==-1){var Ne=Y[K],Se=(Z>>>2)-1;if(!Ne)return;for(var be=0;be<Se&&(se=Ol(Ne,be*4))!==q;++be)re.push(se);N(Ol(Ne,Z-4),ne-1,Y,Z,re)}}function C(K,ne,Y,Z,re){var se=[],Ne=[];re||(re=[]);var Se=Z-1,be=0,je=0;for(be=ne;be>=0;){re[be]=!0,se[se.length]=be,Ne.push(K[be]);var we=Y[Math.floor(be*4/Z)];if(je=be*4&Se,Z<4+je)throw new Error("FAT boundary crossed: "+be+" 4 "+Z);if(!K[we])break;be=Ol(K[we],je)}return{nodes:se,data:NN([Ne])}}function T(K,ne,Y,Z){var re=K.length,se=[],Ne=[],Se=[],be=[],je=Z-1,we=0,Pe=0,ze=0,qe=0;for(we=0;we<re;++we)if(Se=[],ze=we+ne,ze>=re&&(ze-=re),!Ne[ze]){be=[];var Me=[];for(Pe=ze;Pe>=0;){Me[Pe]=!0,Ne[Pe]=!0,Se[Se.length]=Pe,be.push(K[Pe]);var Oe=Y[Math.floor(Pe*4/Z)];if(qe=Pe*4&je,Z<4+qe)throw new Error("FAT boundary crossed: "+Pe+" 4 "+Z);if(!K[Oe]||(Pe=Ol(K[Oe],qe),Me[Pe]))break}se[ze]={nodes:Se,data:NN([be])}}return se}function S(K,ne,Y,Z,re,se,Ne,Se){for(var be=0,je=Z.length?2:0,we=ne[K].data,Pe=0,ze=0,qe;Pe<we.length;Pe+=128){var Me=we.slice(Pe,Pe+128);oa(Me,64),ze=Me.read_shift(2),qe=kg(Me,0,ze-je),Z.push(qe);var Oe={name:qe,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},xt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);xt!==0&&(Oe.ct=k(Me,Me.l-8));var Qt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);Qt!==0&&(Oe.mt=k(Me,Me.l-8)),Oe.start=Me.read_shift(4,"i"),Oe.size=Me.read_shift(4,"i"),Oe.size<0&&Oe.start<0&&(Oe.size=Oe.type=0,Oe.start=q,Oe.name=""),Oe.type===5?(be=Oe.start,re>0&&be!==q&&(ne[be].name="!StreamData")):Oe.size>=4096?(Oe.storage="fat",ne[Oe.start]===void 0&&(ne[Oe.start]=C(Y,Oe.start,ne.fat_addrs,ne.ssz)),ne[Oe.start].name=Oe.name,Oe.content=ne[Oe.start].data.slice(0,Oe.size)):(Oe.storage="minifat",Oe.size<0?Oe.size=0:be!==q&&Oe.start!==q&&ne[be]&&(Oe.content=y(Oe,ne[be].data,(ne[Se]||{}).data))),Oe.content&&oa(Oe.content,0),se[qe]=Oe,Ne.push(Oe)}}function k(K,ne){return new Date((or(K,ne+4)/1e7*Math.pow(2,32)+or(K,ne)/1e7-11644473600)*1e3)}function _(K,ne){return h(),m(u.readFileSync(K),ne)}function P(K,ne){var Y=ne&&ne.type;switch(Y||bt&&Buffer.isBuffer(K)&&(Y="buffer"),Y||"base64"){case"file":return _(K,ne);case"base64":return m(cr(hr(K)),ne);case"binary":return m(cr(K),ne)}return m(K,ne)}function j(K,ne){var Y=ne||{},Z=Y.root||"Root Entry";if(K.FullPaths||(K.FullPaths=[]),K.FileIndex||(K.FileIndex=[]),K.FullPaths.length!==K.FileIndex.length)throw new Error("inconsistent CFB structure");K.FullPaths.length===0&&(K.FullPaths[0]=Z+"/",K.FileIndex[0]={name:Z,type:5}),Y.CLSID&&(K.FileIndex[0].clsid=Y.CLSID),A(K)}function A(K){var ne="Sh33tJ5";if(!nt.find(K,"/"+ne)){var Y=Ce(4);Y[0]=55,Y[1]=Y[3]=50,Y[2]=54,K.FileIndex.push({name:ne,type:2,content:Y,size:4,L:69,R:69,C:69}),K.FullPaths.push(K.FullPaths[0]+ne),L(K)}}function L(K,ne){j(K);for(var Y=!1,Z=!1,re=K.FullPaths.length-1;re>=0;--re){var se=K.FileIndex[re];switch(se.type){case 0:Z?Y=!0:(K.FileIndex.pop(),K.FullPaths.pop());break;case 1:case 2:case 5:Z=!0,isNaN(se.R*se.L*se.C)&&(Y=!0),se.R>-1&&se.L>-1&&se.R==se.L&&(Y=!0);break;default:Y=!0;break}}if(!(!Y&&!ne)){var Ne=new Date(1987,1,19),Se=0,be=Object.create?Object.create(null):{},je=[];for(re=0;re<K.FullPaths.length;++re)be[K.FullPaths[re]]=!0,K.FileIndex[re].type!==0&&je.push([K.FullPaths[re],K.FileIndex[re]]);for(re=0;re<je.length;++re){var we=r(je[re][0]);Z=be[we],Z||(je.push([we,{name:s(we).replace("/",""),type:1,clsid:fe,ct:Ne,mt:Ne,content:null}]),be[we]=!0)}for(je.sort(function(qe,Me){return a(qe[0],Me[0])}),K.FullPaths=[],K.FileIndex=[],re=0;re<je.length;++re)K.FullPaths[re]=je[re][0],K.FileIndex[re]=je[re][1];for(re=0;re<je.length;++re){var Pe=K.FileIndex[re],ze=K.FullPaths[re];if(Pe.name=s(ze).replace("/",""),Pe.L=Pe.R=Pe.C=-(Pe.color=1),Pe.size=Pe.content?Pe.content.length:0,Pe.start=0,Pe.clsid=Pe.clsid||fe,re===0)Pe.C=je.length>1?1:-1,Pe.size=0,Pe.type=5;else if(ze.slice(-1)=="/"){for(Se=re+1;Se<je.length&&r(K.FullPaths[Se])!=ze;++Se);for(Pe.C=Se>=je.length?-1:Se,Se=re+1;Se<je.length&&r(K.FullPaths[Se])!=r(ze);++Se);Pe.R=Se>=je.length?-1:Se,Pe.type=1}else r(K.FullPaths[re+1]||"")==r(ze)&&(Pe.R=re+1),Pe.type=2}}}function W(K,ne){var Y=ne||{};if(Y.fileType=="mad")return ml(K,Y);switch(L(K),Y.fileType){case"zip":return mi(K,Y)}var Z=(function(qe){for(var Me=0,Oe=0,xt=0;xt<qe.FileIndex.length;++xt){var Qt=qe.FileIndex[xt];if(Qt.content){var en=Qt.content.length;en>0&&(en<4096?Me+=en+63>>6:Oe+=en+511>>9)}}for(var Tn=qe.FullPaths.length+3>>2,pl=Me+7>>3,fi=Me+127>>7,rs=pl+Oe+Tn+fi,qn=rs+127>>7,Hc=qn<=109?0:Math.ceil((qn-109)/127);rs+qn+Hc+127>>7>qn;)Hc=++qn<=109?0:Math.ceil((qn-109)/127);var Cn=[1,Hc,qn,fi,Tn,Oe,Me,0];return qe.FileIndex[0].size=Me<<6,Cn[7]=(qe.FileIndex[0].start=Cn[0]+Cn[1]+Cn[2]+Cn[3]+Cn[4]+Cn[5])+(Cn[6]+7>>3),Cn})(K),re=Ce(Z[7]<<9),se=0,Ne=0;{for(se=0;se<8;++se)re.write_shift(1,z[se]);for(se=0;se<8;++se)re.write_shift(2,0);for(re.write_shift(2,62),re.write_shift(2,3),re.write_shift(2,65534),re.write_shift(2,9),re.write_shift(2,6),se=0;se<3;++se)re.write_shift(2,0);for(re.write_shift(4,0),re.write_shift(4,Z[2]),re.write_shift(4,Z[0]+Z[1]+Z[2]+Z[3]-1),re.write_shift(4,0),re.write_shift(4,4096),re.write_shift(4,Z[3]?Z[0]+Z[1]+Z[2]-1:q),re.write_shift(4,Z[3]),re.write_shift(-4,Z[1]?Z[0]-1:q),re.write_shift(4,Z[1]),se=0;se<109;++se)re.write_shift(-4,se<Z[2]?Z[1]+se:-1)}if(Z[1])for(Ne=0;Ne<Z[1];++Ne){for(;se<236+Ne*127;++se)re.write_shift(-4,se<Z[2]?Z[1]+se:-1);re.write_shift(-4,Ne===Z[1]-1?q:Ne+1)}var Se=function(qe){for(Ne+=qe;se<Ne-1;++se)re.write_shift(-4,se+1);qe&&(++se,re.write_shift(-4,q))};for(Ne=se=0,Ne+=Z[1];se<Ne;++se)re.write_shift(-4,ae.DIFSECT);for(Ne+=Z[2];se<Ne;++se)re.write_shift(-4,ae.FATSECT);Se(Z[3]),Se(Z[4]);for(var be=0,je=0,we=K.FileIndex[0];be<K.FileIndex.length;++be)we=K.FileIndex[be],we.content&&(je=we.content.length,!(je<4096)&&(we.start=Ne,Se(je+511>>9)));for(Se(Z[6]+7>>3);re.l&511;)re.write_shift(-4,ae.ENDOFCHAIN);for(Ne=se=0,be=0;be<K.FileIndex.length;++be)we=K.FileIndex[be],we.content&&(je=we.content.length,!(!je||je>=4096)&&(we.start=Ne,Se(je+63>>6)));for(;re.l&511;)re.write_shift(-4,ae.ENDOFCHAIN);for(se=0;se<Z[4]<<2;++se){var Pe=K.FullPaths[se];if(!Pe||Pe.length===0){for(be=0;be<17;++be)re.write_shift(4,0);for(be=0;be<3;++be)re.write_shift(4,-1);for(be=0;be<12;++be)re.write_shift(4,0);continue}we=K.FileIndex[se],se===0&&(we.start=we.size?we.start-1:q);var ze=se===0&&Y.root||we.name;if(je=2*(ze.length+1),re.write_shift(64,ze,"utf16le"),re.write_shift(2,je),re.write_shift(1,we.type),re.write_shift(1,we.color),re.write_shift(-4,we.L),re.write_shift(-4,we.R),re.write_shift(-4,we.C),we.clsid)re.write_shift(16,we.clsid,"hex");else for(be=0;be<4;++be)re.write_shift(4,0);re.write_shift(4,we.state||0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,we.start),re.write_shift(4,we.size),re.write_shift(4,0)}for(se=1;se<K.FileIndex.length;++se)if(we=K.FileIndex[se],we.size>=4096)if(re.l=we.start+1<<9,bt&&Buffer.isBuffer(we.content))we.content.copy(re,re.l,0,we.size),re.l+=we.size+511&-512;else{for(be=0;be<we.size;++be)re.write_shift(1,we.content[be]);for(;be&511;++be)re.write_shift(1,0)}for(se=1;se<K.FileIndex.length;++se)if(we=K.FileIndex[se],we.size>0&&we.size<4096)if(bt&&Buffer.isBuffer(we.content))we.content.copy(re,re.l,0,we.size),re.l+=we.size+63&-64;else{for(be=0;be<we.size;++be)re.write_shift(1,we.content[be]);for(;be&63;++be)re.write_shift(1,0)}if(bt)re.l=re.length;else for(;re.l<re.length;)re.write_shift(1,0);return re}function R(K,ne){var Y=K.FullPaths.map(function(be){return be.toUpperCase()}),Z=Y.map(function(be){var je=be.split("/");return je[je.length-(be.slice(-1)=="/"?2:1)]}),re=!1;ne.charCodeAt(0)===47?(re=!0,ne=Y[0].slice(0,-1)+ne):re=ne.indexOf("/")!==-1;var se=ne.toUpperCase(),Ne=re===!0?Y.indexOf(se):Z.indexOf(se);if(Ne!==-1)return K.FileIndex[Ne];var Se=!se.match(Fd);for(se=se.replace(Ia,""),Se&&(se=se.replace(Fd,"!")),Ne=0;Ne<Y.length;++Ne)if((Se?Y[Ne].replace(Fd,"!"):Y[Ne]).replace(Ia,"")==se||(Se?Z[Ne].replace(Fd,"!"):Z[Ne]).replace(Ia,"")==se)return K.FileIndex[Ne];return null}var M=64,q=-2,ee="d0cf11e0a1b11ae1",z=[208,207,17,224,161,177,26,225],fe="00000000000000000000000000000000",ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:ee,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function J(K,ne,Y){h();var Z=W(K,Y);u.writeFileSync(ne,Z)}function G(K){for(var ne=new Array(K.length),Y=0;Y<K.length;++Y)ne[Y]=String.fromCharCode(K[Y]);return ne.join("")}function he(K,ne){var Y=W(K,ne);switch(ne&&ne.type||"buffer"){case"file":return h(),u.writeFileSync(ne.filename,Y),Y;case"binary":return typeof Y=="string"?Y:G(Y);case"base64":return Qd(typeof Y=="string"?Y:G(Y));case"buffer":if(bt)return Buffer.isBuffer(Y)?Y:oi(Y);case"array":return typeof Y=="string"?cr(Y):Y}return Y}var H;function F(K){try{var ne=K.InflateRaw,Y=new ne;if(Y._processChunk(new Uint8Array([3,0]),Y._finishFlushFlag),Y.bytesRead)H=K;else throw new Error("zlib does not expose bytesRead")}catch(Z){console.error("cannot use native zlib: "+(Z.message||Z))}}function I(K,ne){if(!H)return as(K,ne);var Y=H.InflateRaw,Z=new Y,re=Z._processChunk(K.slice(K.l),Z._finishFlushFlag);return K.l+=Z.bytesRead,re}function O(K){return H?H.deflateRawSync(K):ot(K)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],pe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function U(K){var ne=(K<<1|K<<11)&139536|(K<<5|K<<15)&558144;return(ne>>16|ne>>8|ne)&255}for(var ce=typeof Uint8Array<"u",Q=ce?new Uint8Array(256):[],oe=0;oe<256;++oe)Q[oe]=U(oe);function X(K,ne){var Y=Q[K&255];return ne<=8?Y>>>8-ne:(Y=Y<<8|Q[K>>8&255],ne<=16?Y>>>16-ne:(Y=Y<<8|Q[K>>16&255],Y>>>24-ne))}function ve(K,ne){var Y=ne&7,Z=ne>>>3;return(K[Z]|(Y<=6?0:K[Z+1]<<8))>>>Y&3}function Ke(K,ne){var Y=ne&7,Z=ne>>>3;return(K[Z]|(Y<=5?0:K[Z+1]<<8))>>>Y&7}function at(K,ne){var Y=ne&7,Z=ne>>>3;return(K[Z]|(Y<=4?0:K[Z+1]<<8))>>>Y&15}function et(K,ne){var Y=ne&7,Z=ne>>>3;return(K[Z]|(Y<=3?0:K[Z+1]<<8))>>>Y&31}function Be(K,ne){var Y=ne&7,Z=ne>>>3;return(K[Z]|(Y<=1?0:K[Z+1]<<8))>>>Y&127}function Gt(K,ne,Y){var Z=ne&7,re=ne>>>3,se=(1<<Y)-1,Ne=K[re]>>>Z;return Y<8-Z||(Ne|=K[re+1]<<8-Z,Y<16-Z)||(Ne|=K[re+2]<<16-Z,Y<24-Z)||(Ne|=K[re+3]<<24-Z),Ne&se}function wn(K,ne,Y){var Z=ne&7,re=ne>>>3;return Z<=5?K[re]|=(Y&7)<<Z:(K[re]|=Y<<Z&255,K[re+1]=(Y&7)>>8-Z),ne+3}function kn(K,ne,Y){var Z=ne&7,re=ne>>>3;return Y=(Y&1)<<Z,K[re]|=Y,ne+1}function $n(K,ne,Y){var Z=ne&7,re=ne>>>3;return Y<<=Z,K[re]|=Y&255,Y>>>=8,K[re+1]=Y,ne+8}function Hr(K,ne,Y){var Z=ne&7,re=ne>>>3;return Y<<=Z,K[re]|=Y&255,Y>>>=8,K[re+1]=Y&255,K[re+2]=Y>>>8,ne+16}function tr(K,ne){var Y=K.length,Z=2*Y>ne?2*Y:ne+5,re=0;if(Y>=ne)return K;if(bt){var se=nN(Z);if(K.copy)K.copy(se);else for(;re<K.length;++re)se[re]=K[re];return se}else if(ce){var Ne=new Uint8Array(Z);if(Ne.set)Ne.set(K);else for(;re<Y;++re)Ne[re]=K[re];return Ne}return K.length=Z,K}function He(K){for(var ne=new Array(K),Y=0;Y<K;++Y)ne[Y]=0;return ne}function Ye(K,ne,Y){var Z=1,re=0,se=0,Ne=0,Se=0,be=K.length,je=ce?new Uint16Array(32):He(32);for(se=0;se<32;++se)je[se]=0;for(se=be;se<Y;++se)K[se]=0;be=K.length;var we=ce?new Uint16Array(be):He(be);for(se=0;se<be;++se)je[re=K[se]]++,Z<re&&(Z=re),we[se]=0;for(je[0]=0,se=1;se<=Z;++se)je[se+16]=Se=Se+je[se-1]<<1;for(se=0;se<be;++se)Se=K[se],Se!=0&&(we[se]=je[Se+16]++);var Pe=0;for(se=0;se<be;++se)if(Pe=K[se],Pe!=0)for(Se=X(we[se],Z)>>Z-Pe,Ne=(1<<Z+4-Pe)-1;Ne>=0;--Ne)ne[Se|Ne<<Pe]=Pe&15|se<<4;return Z}var Ft=ce?new Uint16Array(512):He(512),qt=ce?new Uint16Array(32):He(32);if(!ce){for(var Ct=0;Ct<512;++Ct)Ft[Ct]=0;for(Ct=0;Ct<32;++Ct)qt[Ct]=0}(function(){for(var K=[],ne=0;ne<32;ne++)K.push(5);Ye(K,qt,32);var Y=[];for(ne=0;ne<=143;ne++)Y.push(8);for(;ne<=255;ne++)Y.push(9);for(;ne<=279;ne++)Y.push(7);for(;ne<=287;ne++)Y.push(8);Ye(Y,Ft,288)})();var Mn=(function(){for(var ne=ce?new Uint8Array(32768):[],Y=0,Z=0;Y<pe.length-1;++Y)for(;Z<pe[Y+1];++Z)ne[Z]=Y;for(;Z<32768;++Z)ne[Z]=29;var re=ce?new Uint8Array(259):[];for(Y=0,Z=0;Y<te.length-1;++Y)for(;Z<te[Y+1];++Z)re[Z]=Y;function se(Se,be){for(var je=0;je<Se.length;){var we=Math.min(65535,Se.length-je),Pe=je+we==Se.length;for(be.write_shift(1,+Pe),be.write_shift(2,we),be.write_shift(2,~we&65535);we-- >0;)be[be.l++]=Se[je++]}return be.l}function Ne(Se,be){for(var je=0,we=0,Pe=ce?new Uint16Array(32768):[];we<Se.length;){var ze=Math.min(65535,Se.length-we);if(ze<10){for(je=wn(be,je,+(we+ze==Se.length)),je&7&&(je+=8-(je&7)),be.l=je/8|0,be.write_shift(2,ze),be.write_shift(2,~ze&65535);ze-- >0;)be[be.l++]=Se[we++];je=be.l*8;continue}je=wn(be,je,+(we+ze==Se.length)+2);for(var qe=0;ze-- >0;){var Me=Se[we];qe=(qe<<5^Me)&32767;var Oe=-1,xt=0;if((Oe=Pe[qe])&&(Oe|=we&-32768,Oe>we&&(Oe-=32768),Oe<we))for(;Se[Oe+xt]==Se[we+xt]&&xt<250;)++xt;if(xt>2){Me=re[xt],Me<=22?je=$n(be,je,Q[Me+1]>>1)-1:($n(be,je,3),je+=5,$n(be,je,Q[Me-23]>>5),je+=3);var Qt=Me<8?0:Me-4>>2;Qt>0&&(Hr(be,je,xt-te[Me]),je+=Qt),Me=ne[we-Oe],je=$n(be,je,Q[Me]>>3),je-=3;var en=Me<4?0:Me-2>>1;en>0&&(Hr(be,je,we-Oe-pe[Me]),je+=en);for(var Tn=0;Tn<xt;++Tn)Pe[qe]=we&32767,qe=(qe<<5^Se[we])&32767,++we;ze-=xt-1}else Me<=143?Me=Me+48:je=kn(be,je,1),je=$n(be,je,Q[Me]),Pe[qe]=we&32767,++we}je=$n(be,je,0)-1}return be.l=(je+7)/8|0,be.l}return function(be,je){return be.length<8?se(be,je):Ne(be,je)}})();function ot(K){var ne=Ce(50+Math.floor(K.length*1.1)),Y=Mn(K,ne);return ne.slice(0,Y)}var It=ce?new Uint16Array(32768):He(32768),Gn=ce?new Uint16Array(32768):He(32768),Zt=ce?new Uint16Array(128):He(128),Ca=1,ui=1;function Ds(K,ne){var Y=et(K,ne)+257;ne+=5;var Z=et(K,ne)+1;ne+=5;var re=at(K,ne)+4;ne+=4;for(var se=0,Ne=ce?new Uint8Array(19):He(19),Se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],be=1,je=ce?new Uint8Array(8):He(8),we=ce?new Uint8Array(8):He(8),Pe=Ne.length,ze=0;ze<re;++ze)Ne[V[ze]]=se=Ke(K,ne),be<se&&(be=se),je[se]++,ne+=3;var qe=0;for(je[0]=0,ze=1;ze<=be;++ze)we[ze]=qe=qe+je[ze-1]<<1;for(ze=0;ze<Pe;++ze)(qe=Ne[ze])!=0&&(Se[ze]=we[qe]++);var Me=0;for(ze=0;ze<Pe;++ze)if(Me=Ne[ze],Me!=0){qe=Q[Se[ze]]>>8-Me;for(var Oe=(1<<7-Me)-1;Oe>=0;--Oe)Zt[qe|Oe<<Me]=Me&7|ze<<3}var xt=[];for(be=1;xt.length<Y+Z;)switch(qe=Zt[Be(K,ne)],ne+=qe&7,qe>>>=3){case 16:for(se=3+ve(K,ne),ne+=2,qe=xt[xt.length-1];se-- >0;)xt.push(qe);break;case 17:for(se=3+Ke(K,ne),ne+=3;se-- >0;)xt.push(0);break;case 18:for(se=11+Be(K,ne),ne+=7;se-- >0;)xt.push(0);break;default:xt.push(qe),be<qe&&(be=qe);break}var Qt=xt.slice(0,Y),en=xt.slice(Y);for(ze=Y;ze<286;++ze)Qt[ze]=0;for(ze=Z;ze<30;++ze)en[ze]=0;return Ca=Ye(Qt,It,286),ui=Ye(en,Gn,30),ne}function Fs(K,ne){if(K[0]==3&&!(K[1]&3))return[rl(ne),2];for(var Y=0,Z=0,re=nN(ne||1<<18),se=0,Ne=re.length>>>0,Se=0,be=0;(Z&1)==0;){if(Z=Ke(K,Y),Y+=3,Z>>>1)Z>>1==1?(Se=9,be=5):(Y=Ds(K,Y),Se=Ca,be=ui);else{Y&7&&(Y+=8-(Y&7));var je=K[Y>>>3]|K[(Y>>>3)+1]<<8;if(Y+=32,je>0)for(!ne&&Ne<se+je&&(re=tr(re,se+je),Ne=re.length);je-- >0;)re[se++]=K[Y>>>3],Y+=8;continue}for(;;){!ne&&Ne<se+32767&&(re=tr(re,se+32767),Ne=re.length);var we=Gt(K,Y,Se),Pe=Z>>>1==1?Ft[we]:It[we];if(Y+=Pe&15,Pe>>>=4,(Pe>>>8&255)===0)re[se++]=Pe;else{if(Pe==256)break;Pe-=257;var ze=Pe<8?0:Pe-4>>2;ze>5&&(ze=0);var qe=se+te[Pe];ze>0&&(qe+=Gt(K,Y,ze),Y+=ze),we=Gt(K,Y,be),Pe=Z>>>1==1?qt[we]:Gn[we],Y+=Pe&15,Pe>>>=4;var Me=Pe<4?0:Pe-2>>1,Oe=pe[Pe];for(Me>0&&(Oe+=Gt(K,Y,Me),Y+=Me),!ne&&Ne<qe&&(re=tr(re,qe+100),Ne=re.length);se<qe;)re[se]=re[se-Oe],++se}}}return ne?[re,Y+7>>>3]:[re.slice(0,se),Y+7>>>3]}function as(K,ne){var Y=K.slice(K.l||0),Z=Fs(Y,ne);return K.l+=Z[1],Z[0]}function hi(K,ne){if(K)typeof console<"u"&&console.error(ne);else throw new Error(ne)}function jo(K,ne){var Y=K;oa(Y,0);var Z=[],re=[],se={FileIndex:Z,FullPaths:re};j(se,{root:ne.root});for(var Ne=Y.length-4;(Y[Ne]!=80||Y[Ne+1]!=75||Y[Ne+2]!=5||Y[Ne+3]!=6)&&Ne>=0;)--Ne;Y.l=Ne+4,Y.l+=4;var Se=Y.read_shift(2);Y.l+=6;var be=Y.read_shift(4);for(Y.l=be,Ne=0;Ne<Se;++Ne){Y.l+=20;var je=Y.read_shift(4),we=Y.read_shift(4),Pe=Y.read_shift(2),ze=Y.read_shift(2),qe=Y.read_shift(2);Y.l+=8;var Me=Y.read_shift(4),Oe=d(Y.slice(Y.l+Pe,Y.l+Pe+ze));Y.l+=Pe+ze+qe;var xt=Y.l;Y.l=Me+4,xi(Y,je,we,se,Oe),Y.l=xt}return se}function xi(K,ne,Y,Z,re){K.l+=2;var se=K.read_shift(2),Ne=K.read_shift(2),Se=o(K);if(se&8257)throw new Error("Unsupported ZIP encryption");for(var be=K.read_shift(4),je=K.read_shift(4),we=K.read_shift(4),Pe=K.read_shift(2),ze=K.read_shift(2),qe="",Me=0;Me<Pe;++Me)qe+=String.fromCharCode(K[K.l++]);if(ze){var Oe=d(K.slice(K.l,K.l+ze));(Oe[21589]||{}).mt&&(Se=Oe[21589].mt),((re||{})[21589]||{}).mt&&(Se=re[21589].mt)}K.l+=ze;var xt=K.slice(K.l,K.l+je);switch(Ne){case 8:xt=I(K,we);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ne)}var Qt=!1;se&8&&(be=K.read_shift(4),be==134695760&&(be=K.read_shift(4),Qt=!0),je=K.read_shift(4),we=K.read_shift(4)),je!=ne&&hi(Qt,"Bad compressed size: "+ne+" != "+je),we!=Y&&hi(Qt,"Bad uncompressed size: "+Y+" != "+we),As(Z,qe,xt,{unsafe:!0,mt:Se})}function mi(K,ne){var Y=ne||{},Z=[],re=[],se=Ce(1),Ne=Y.compression?8:0,Se=0,be=0,je=0,we=0,Pe=0,ze=K.FullPaths[0],qe=ze,Me=K.FileIndex[0],Oe=[],xt=0;for(be=1;be<K.FullPaths.length;++be)if(qe=K.FullPaths[be].slice(ze.length),Me=K.FileIndex[be],!(!Me.size||!Me.content||qe=="Sh33tJ5")){var Qt=we,en=Ce(qe.length);for(je=0;je<qe.length;++je)en.write_shift(1,qe.charCodeAt(je)&127);en=en.slice(0,en.l),Oe[Pe]=_A.buf(Me.content,0);var Tn=Me.content;Ne==8&&(Tn=O(Tn)),se=Ce(30),se.write_shift(4,67324752),se.write_shift(2,20),se.write_shift(2,Se),se.write_shift(2,Ne),Me.mt?l(se,Me.mt):se.write_shift(4,0),se.write_shift(-4,Oe[Pe]),se.write_shift(4,Tn.length),se.write_shift(4,Me.content.length),se.write_shift(2,en.length),se.write_shift(2,0),we+=se.length,Z.push(se),we+=en.length,Z.push(en),we+=Tn.length,Z.push(Tn),se=Ce(46),se.write_shift(4,33639248),se.write_shift(2,0),se.write_shift(2,20),se.write_shift(2,Se),se.write_shift(2,Ne),se.write_shift(4,0),se.write_shift(-4,Oe[Pe]),se.write_shift(4,Tn.length),se.write_shift(4,Me.content.length),se.write_shift(2,en.length),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(4,0),se.write_shift(4,Qt),xt+=se.l,re.push(se),xt+=en.length,re.push(en),++Pe}return se=Ce(22),se.write_shift(4,101010256),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,Pe),se.write_shift(2,Pe),se.write_shift(4,xt),se.write_shift(4,we),se.write_shift(2,0),ea([ea(Z),ea(re),se])}var xl={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Eu(K,ne){if(K.ctype)return K.ctype;var Y=K.name||"",Z=Y.match(/\.([^\.]+)$/);return Z&&xl[Z[1]]||ne&&(Z=(Y=ne).match(/[\.\\]([^\.\\])+$/),Z&&xl[Z[1]])?xl[Z[1]]:"application/octet-stream"}function Du(K){for(var ne=Qd(K),Y=[],Z=0;Z<ne.length;Z+=76)Y.push(ne.slice(Z,Z+76));return Y.join(`\r
`)+`\r
`}function Fu(K){var ne=K.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(je){var we=je.charCodeAt(0).toString(16).toUpperCase();return"="+(we.length==1?"0"+we:we)});ne=ne.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ne.charAt(0)==`
`&&(ne="=0D"+ne.slice(1)),ne=ne.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Y=[],Z=ne.split(`\r
`),re=0;re<Z.length;++re){var se=Z[re];if(se.length==0){Y.push("");continue}for(var Ne=0;Ne<se.length;){var Se=76,be=se.slice(Ne,Ne+Se);be.charAt(Se-1)=="="?Se--:be.charAt(Se-2)=="="?Se-=2:be.charAt(Se-3)=="="&&(Se-=3),be=se.slice(Ne,Ne+Se),Ne+=Se,Ne<se.length&&(be+="="),Y.push(be)}}return Y.join(`\r
`)}function Au(K){for(var ne=[],Y=0;Y<K.length;++Y){for(var Z=K[Y];Y<=K.length&&Z.charAt(Z.length-1)=="=";)Z=Z.slice(0,Z.length-1)+K[++Y];ne.push(Z)}for(var re=0;re<ne.length;++re)ne[re]=ne[re].replace(/[=][0-9A-Fa-f]{2}/g,function(se){return String.fromCharCode(parseInt(se.slice(1),16))});return cr(ne.join(`\r
`))}function Rc(K,ne,Y){for(var Z="",re="",se="",Ne,Se=0;Se<10;++Se){var be=ne[Se];if(!be||be.match(/^\s*$/))break;var je=be.match(/^(.*?):\s*([^\s].*)$/);if(je)switch(je[1].toLowerCase()){case"content-location":Z=je[2].trim();break;case"content-type":se=je[2].trim();break;case"content-transfer-encoding":re=je[2].trim();break}}switch(++Se,re.toLowerCase()){case"base64":Ne=cr(hr(ne.slice(Se).join("")));break;case"quoted-printable":Ne=Au(ne.slice(Se));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+re)}var we=As(K,Z.slice(Y.length),Ne,{unsafe:!0});se&&(we.ctype=se)}function Pu(K,ne){if(G(K.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Y=ne&&ne.root||"",Z=(bt&&Buffer.isBuffer(K)?K.toString("binary"):G(K)).split(`\r
`),re=0,se="";for(re=0;re<Z.length;++re)if(se=Z[re],!!/^Content-Location:/i.test(se)&&(se=se.slice(se.indexOf("file")),Y||(Y=se.slice(0,se.lastIndexOf("/")+1)),se.slice(0,Y.length)!=Y))for(;Y.length>0&&(Y=Y.slice(0,Y.length-1),Y=Y.slice(0,Y.lastIndexOf("/")+1),se.slice(0,Y.length)!=Y););var Ne=(Z[1]||"").match(/boundary="(.*?)"/);if(!Ne)throw new Error("MAD cannot find boundary");var Se="--"+(Ne[1]||""),be=[],je=[],we={FileIndex:be,FullPaths:je};j(we);var Pe,ze=0;for(re=0;re<Z.length;++re){var qe=Z[re];qe!==Se&&qe!==Se+"--"||(ze++&&Rc(we,Z.slice(Pe,re),Y),Pe=re)}return we}function ml(K,ne){var Y=ne||{},Z=Y.boundary||"SheetJS";Z="------="+Z;for(var re=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Z.slice(2)+'"',"","",""],se=K.FullPaths[0],Ne=se,Se=K.FileIndex[0],be=1;be<K.FullPaths.length;++be)if(Ne=K.FullPaths[be].slice(se.length),Se=K.FileIndex[be],!(!Se.size||!Se.content||Ne=="Sh33tJ5")){Ne=Ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(xt){return"_x"+xt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(xt){return"_u"+xt.charCodeAt(0).toString(16)+"_"});for(var je=Se.content,we=bt&&Buffer.isBuffer(je)?je.toString("binary"):G(je),Pe=0,ze=Math.min(1024,we.length),qe=0,Me=0;Me<=ze;++Me)(qe=we.charCodeAt(Me))>=32&&qe<128&&++Pe;var Oe=Pe>=ze*4/5;re.push(Z),re.push("Content-Location: "+(Y.root||"file:///C:/SheetJS/")+Ne),re.push("Content-Transfer-Encoding: "+(Oe?"quoted-printable":"base64")),re.push("Content-Type: "+Eu(Se,Ne)),re.push(""),re.push(Oe?Fu(we):Du(we))}return re.push(Z+`--\r
`),re.join(`\r
`)}function Bc(K){var ne={};return j(ne,K),ne}function As(K,ne,Y,Z){var re=Z&&Z.unsafe;re||j(K);var se=!re&&nt.find(K,ne);if(!se){var Ne=K.FullPaths[0];ne.slice(0,Ne.length)==Ne?Ne=ne:(Ne.slice(-1)!="/"&&(Ne+="/"),Ne=(Ne+ne).replace("//","/")),se={name:s(ne),type:2},K.FileIndex.push(se),K.FullPaths.push(Ne),re||nt.utils.cfb_gc(K)}return se.content=Y,se.size=Y?Y.length:0,Z&&(Z.CLSID&&(se.clsid=Z.CLSID),Z.mt&&(se.mt=Z.mt),Z.ct&&(se.ct=Z.ct)),se}function cx(K,ne){j(K);var Y=nt.find(K,ne);if(Y){for(var Z=0;Z<K.FileIndex.length;++Z)if(K.FileIndex[Z]==Y)return K.FileIndex.splice(Z,1),K.FullPaths.splice(Z,1),!0}return!1}function fl(K,ne,Y){j(K);var Z=nt.find(K,ne);if(Z){for(var re=0;re<K.FileIndex.length;++re)if(K.FileIndex[re]==Z)return K.FileIndex[re].name=s(Y),K.FullPaths[re]=Y,!0}return!1}function wo(K){L(K,!0)}return n.find=R,n.read=P,n.parse=m,n.write=he,n.writeFile=J,n.utils={cfb_new:Bc,cfb_add:As,cfb_del:cx,cfb_mov:fl,cfb_gc:wo,ReadShift:Id,CheckField:Qw,prep_blob:oa,bconcat:ea,use_zlib:F,_deflateRaw:ot,_inflateRaw:as,consts:ae},n})();function EA(e){return typeof e=="string"?ex(e):Array.isArray(e)?tA(e):e}function Nu(e,n,a){if(typeof Deno<"u"){if(a&&typeof n=="string")switch(a){case"utf8":n=new TextEncoder(a).encode(n);break;case"binary":n=ex(n);break;default:throw new Error("Unsupported encoding "+a)}return Deno.writeFileSync(e,n)}var r=a=="utf8"?Ns(n):n;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,e);if(typeof Blob<"u"){var s=new Blob([EA(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=l,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var d=File(e);return d.open("w"),d.encoding="binary",Array.isArray(n)&&(n=dl(n)),d.write(n),d.close(),n}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+e)}function DA(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(e);n.open("r"),n.encoding="binary";var a=n.read();return n.close(),a}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function jn(e){for(var n=Object.keys(e),a=[],r=0;r<n.length;++r)Object.prototype.hasOwnProperty.call(e,n[r])&&a.push(n[r]);return a}function dN(e,n){for(var a=[],r=jn(e),s=0;s!==r.length;++s)a[e[r[s]][n]]==null&&(a[e[r[s]][n]]=r[s]);return a}function nx(e){for(var n=[],a=jn(e),r=0;r!==a.length;++r)n[e[a[r]]]=a[r];return n}function ax(e){for(var n=[],a=jn(e),r=0;r!==a.length;++r)n[e[a[r]]]=parseInt(a[r],10);return n}function FA(e){for(var n=[],a=jn(e),r=0;r!==a.length;++r)n[e[a[r]]]==null&&(n[e[a[r]]]=[]),n[e[a[r]]].push(a[r]);return n}var S0=new Date(1899,11,30,0,0,0);function zn(e,n){var a=e.getTime(),r=S0.getTime()+(e.getTimezoneOffset()-S0.getTimezoneOffset())*6e4;return(a-r)/(1440*60*1e3)}var Ew=new Date,AA=S0.getTime()+(Ew.getTimezoneOffset()-S0.getTimezoneOffset())*6e4,uN=Ew.getTimezoneOffset();function rx(e){var n=new Date;return n.setTime(e*24*60*60*1e3+AA),n.getTimezoneOffset()!==uN&&n.setTime(n.getTime()+(n.getTimezoneOffset()-uN)*6e4),n}function PA(e){var n=0,a=0,r=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=s.length;++l)if(s[l]){switch(a=1,l>3&&(r=!0),s[l].slice(s[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[l].slice(s[l].length-1));case"D":a*=24;case"H":a*=60;case"M":if(r)a*=60;else throw new Error("Unsupported ISO Duration Field: M")}n+=a*parseInt(s[l],10)}return n}var hN=new Date("2017-02-19T19:06:09.000Z"),Dw=isNaN(hN.getFullYear())?new Date("2/19/17"):hN,LA=Dw.getFullYear()==2017;function cn(e,n){var a=new Date(e);if(LA)return n>0?a.setTime(a.getTime()+a.getTimezoneOffset()*60*1e3):n<0&&a.setTime(a.getTime()-a.getTimezoneOffset()*60*1e3),a;if(e instanceof Date)return e;if(Dw.getFullYear()==1917&&!isNaN(a.getFullYear())){var r=a.getFullYear();return e.indexOf(""+r)>-1||a.setFullYear(a.getFullYear()+100),a}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function so(e,n){if(bt&&Buffer.isBuffer(e)){if(n){if(e[0]==255&&e[1]==254)return Ns(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ns(gw(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(e[0]==255&&e[1]==254)return Ns(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ns(new TextDecoder("utf-16be").decode(e.slice(2)))}var a={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return a[l]||l})}catch{}for(var r=[],s=0;s!=e.length;++s)r.push(String.fromCharCode(e[s]));return r.join("")}function dn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=dn(e[a]));return n}function bn(e,n){for(var a="";a.length<n;)a+=e;return a}function Zr(e){var n=Number(e);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(e))return n;var a=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return a*=100,""});return!isNaN(n=Number(r))||(r=r.replace(/[(](.*)[)]/,function(s,l){return a=-a,l}),!isNaN(n=Number(r)))?n/a:n}var OA=["january","february","march","april","may","june","july","august","september","october","november","december"];function Tc(e){var n=new Date(e),a=new Date(NaN),r=n.getYear(),s=n.getMonth(),l=n.getDate();if(isNaN(l))return a;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&OA.indexOf(o)==-1)return a}else if(o.match(/[a-z]/))return a;return r<0||r>8099?a:(s>0||l>1)&&r!=101?n:e.match(/[^-0-9:,\/\\]/)?a:n}var IA=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(a,r,s){if(e||typeof r=="string")return a.split(r);for(var l=a.split(r),o=[l[0]],d=1;d<l.length;++d)o.push(s),o.push(l[d]);return o}})();function Fw(e){return e?e.content&&e.type?so(e.content,!0):e.data?Dd(e.data):e.asNodeBuffer&&bt?Dd(e.asNodeBuffer().toString("binary")):e.asBinary?Dd(e.asBinary()):e._data&&e._data.getContent?Dd(so(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Aw(e){if(!e)return null;if(e.data)return eN(e.data);if(e.asNodeBuffer&&bt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var n=e._data.getContent();return typeof n=="string"?eN(n):Array.prototype.slice.call(n)}return e.content&&e.type?e.content:null}function MA(e){return e&&e.name.slice(-4)===".bin"?Aw(e):Fw(e)}function kr(e,n){for(var a=e.FullPaths||jn(e.files),r=n.toLowerCase().replace(/[\/]/g,"\\"),s=r.replace(/\\/g,"/"),l=0;l<a.length;++l){var o=a[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==o||s==o)return e.files?e.files[a[l]]:e.FileIndex[l]}return null}function yg(e,n){var a=kr(e,n);if(a==null)throw new Error("Cannot find file "+n+" in zip");return a}function Ln(e,n,a){if(!a)return MA(yg(e,n));if(!n)return null;try{return Ln(e,n)}catch{return null}}function dr(e,n,a){if(!a)return Fw(yg(e,n));if(!n)return null;try{return dr(e,n)}catch{return null}}function RA(e,n,a){return Aw(yg(e,n))}function xN(e){for(var n=e.FullPaths||jn(e.files),a=[],r=0;r<n.length;++r)n[r].slice(-1)!="/"&&a.push(n[r].replace(/^Root Entry[\/]/,""));return a.sort()}function gt(e,n,a){if(e.FullPaths){if(typeof a=="string"){var r;return bt?r=oi(a):r=nA(a),nt.utils.cfb_add(e,n,r)}nt.utils.cfb_add(e,n,a)}else e.file(n,a)}function vg(){return nt.utils.cfb_new()}function Pw(e,n){switch(n.type){case"base64":return nt.read(e,{type:"base64"});case"binary":return nt.read(e,{type:"binary"});case"buffer":case"array":return nt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function Ad(e,n){if(e.charAt(0)=="/")return e.slice(1);var a=n.split("/");n.slice(-1)!="/"&&a.pop();for(var r=e.split("/");r.length!==0;){var s=r.shift();s===".."?a.pop():s!=="."&&a.push(s)}return a.join("/")}var Fn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,BA=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,mN=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,HA=/<[^>]*>/g,Ta=Fn.match(mN)?mN:HA,VA=/<\w*:/,UA=/<(\/?)\w+:/;function ut(e,n,a){for(var r={},s=0,l=0;s!==e.length&&!((l=e.charCodeAt(s))===32||l===10||l===13);++s);if(n||(r[0]=e.slice(0,s)),s===e.length)return r;var o=e.match(BA),d=0,u="",h=0,m="",f="",p=1;if(o)for(h=0;h!=o.length;++h){for(f=o[h],l=0;l!=f.length&&f.charCodeAt(l)!==61;++l);for(m=f.slice(0,l).trim();f.charCodeAt(l+1)==32;)++l;for(p=(s=f.charCodeAt(l+1))==34||s==39?1:0,u=f.slice(l+1+p,f.length-p),d=0;d!=m.length&&m.charCodeAt(d)!==58;++d);if(d===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),r[m]=u,r[m.toLowerCase()]=u;else{var b=(d===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(d+1);if(r[b]&&m.slice(d-3,d)=="ext")continue;r[b]=u,r[b.toLowerCase()]=u}}return r}function _s(e){return e.replace(UA,"<$1")}var Lw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},bg=nx(Lw),Et=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function a(r){var s=r+"",l=s.indexOf("<![CDATA[");if(l==-1)return s.replace(e,function(d,u){return Lw[d]||String.fromCharCode(parseInt(u,d.indexOf("x")>-1?16:10))||d}).replace(n,function(d,u){return String.fromCharCode(parseInt(u,16))});var o=s.indexOf("]]>");return a(s.slice(0,l))+s.slice(l+9,o)+a(s.slice(o+3))}})(),Ng=/[&<>'"]/g,KA=/[\u0000-\u0008\u000b-\u001f]/g;function $t(e){var n=e+"";return n.replace(Ng,function(a){return bg[a]}).replace(KA,function(a){return"_x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+"_"})}function fN(e){return $t(e).replace(/ /g,"_x0020_")}var Ow=/[\u0000-\u001f]/g;function jg(e){var n=e+"";return n.replace(Ng,function(a){return bg[a]}).replace(/\n/g,"<br/>").replace(Ow,function(a){return"&#x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+";"})}function zA(e){var n=e+"";return n.replace(Ng,function(a){return bg[a]}).replace(Ow,function(a){return"&#x"+a.charCodeAt(0).toString(16).toUpperCase()+";"})}var pN=(function(){var e=/&#(\d+);/g;function n(a,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,n)}})();function $A(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function sn(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function bf(e){for(var n="",a=0,r=0,s=0,l=0,o=0,d=0;a<e.length;){if(r=e.charCodeAt(a++),r<128){n+=String.fromCharCode(r);continue}if(s=e.charCodeAt(a++),r>191&&r<224){o=(r&31)<<6,o|=s&63,n+=String.fromCharCode(o);continue}if(l=e.charCodeAt(a++),r<240){n+=String.fromCharCode((r&15)<<12|(s&63)<<6|l&63);continue}o=e.charCodeAt(a++),d=((r&7)<<18|(s&63)<<12|(l&63)<<6|o&63)-65536,n+=String.fromCharCode(55296+(d>>>10&1023)),n+=String.fromCharCode(56320+(d&1023))}return n}function gN(e){var n=rl(2*e.length),a,r,s=1,l=0,o=0,d;for(r=0;r<e.length;r+=s)s=1,(d=e.charCodeAt(r))<128?a=d:d<224?(a=(d&31)*64+(e.charCodeAt(r+1)&63),s=2):d<240?(a=(d&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),s=3):(s=4,a=(d&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),a-=65536,o=55296+(a>>>10&1023),a=56320+(a&1023)),o!==0&&(n[l++]=o&255,n[l++]=o>>>8,o=0),n[l++]=a%256,n[l++]=a>>>8;return n.slice(0,l).toString("ucs2")}function yN(e){return oi(e,"binary").toString("utf8")}var qh="foo bar baz",Xt=bt&&(yN(qh)==bf(qh)&&yN||gN(qh)==bf(qh)&&gN)||bf,Ns=bt?function(e){return oi(e,"utf8").toString("binary")}:function(e){for(var n=[],a=0,r=0,s=0;a<e.length;)switch(r=e.charCodeAt(a++),!0){case r<128:n.push(String.fromCharCode(r));break;case r<2048:n.push(String.fromCharCode(192+(r>>6))),n.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,s=e.charCodeAt(a++)-56320+(r<<10),n.push(String.fromCharCode(240+(s>>18&7))),n.push(String.fromCharCode(144+(s>>12&63))),n.push(String.fromCharCode(128+(s>>6&63))),n.push(String.fromCharCode(128+(s&63)));break;default:n.push(String.fromCharCode(224+(r>>12))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(r&63)))}return n.join("")},Jd=(function(){var e={};return function(a,r){var s=a+"|"+(r||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+a+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+a+">",r||"")}})(),Iw=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(a){for(var r=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)r=r.replace(e[s][0],e[s][1]);return r}})(),GA=(function(){var e={};return function(a){return e[a]!==void 0?e[a]:e[a]=new RegExp("<(?:vt:)?"+a+">([\\s\\S]*?)</(?:vt:)?"+a+">","g")}})(),qA=/<\/?(?:vt:)?variant>/g,WA=/<(?:vt:)([^>]*)>([\s\S]*)</;function vN(e,n){var a=ut(e),r=e.match(GA(a.baseType))||[],s=[];if(r.length!=a.size){if(n.WTF)throw new Error("unexpected vector length "+r.length+" != "+a.size);return s}return r.forEach(function(l){var o=l.replace(qA,"").match(WA);o&&s.push({v:Xt(o[2]),t:o[1]})}),s}var Mw=/(^\s|\s$|\n)/;function da(e,n){return"<"+e+(n.match(Mw)?' xml:space="preserve"':"")+">"+n+"</"+e+">"}function Zd(e){return jn(e).map(function(n){return" "+n+'="'+e[n]+'"'}).join("")}function Ve(e,n,a){return"<"+e+(a!=null?Zd(a):"")+(n!=null?(n.match(Mw)?' xml:space="preserve"':"")+">"+n+"</"+e:"/")+">"}function Np(e,n){try{return e.toISOString().replace(/\.\d*/,"")}catch(a){if(n)throw a}return""}function XA(e,n){switch(typeof e){case"string":var a=Ve("vt:lpwstr",$t(e));return a=a.replace(/&quot;/g,"_x0022_"),a;case"number":return Ve((e|0)==e?"vt:i4":"vt:r8",$t(String(e)));case"boolean":return Ve("vt:bool",e?"true":"false")}if(e instanceof Date)return Ve("vt:filetime",Np(e));throw new Error("Unable to serialize "+e)}function wg(e){if(bt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Xt(dl(fg(e)));throw new Error("Bad input format: expected Buffer or string")}var eu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Kn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},mo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],lr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function QA(e,n){for(var a=1-2*(e[n+7]>>>7),r=((e[n+7]&127)<<4)+(e[n+6]>>>4&15),s=e[n+6]&15,l=5;l>=0;--l)s=s*256+e[n+l];return r==2047?s==0?a*(1/0):NaN:(r==0?r=-1022:(r-=1023,s+=Math.pow(2,52)),a*Math.pow(2,r-52)*s)}function YA(e,n,a){var r=(n<0||1/n==-1/0?1:0)<<7,s=0,l=0,o=r?-n:n;isFinite(o)?o==0?s=l=0:(s=Math.floor(Math.log(o)/Math.LN2),l=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?s=-1022:(l-=Math.pow(2,52),s+=1023)):(s=2047,l=isNaN(n)?26985:0);for(var d=0;d<=5;++d,l/=256)e[a+d]=l&255;e[a+6]=(s&15)<<4|l&15,e[a+7]=s>>4|r}var bN=function(e){for(var n=[],a=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var s=0,l=e[0][r].length;s<l;s+=a)n.push.apply(n,e[0][r].slice(s,s+a));return n},NN=bt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(n){return Buffer.isBuffer(n)?n:oi(n)})):bN(e)}:bN,jN=function(e,n,a){for(var r=[],s=n;s<a;s+=2)r.push(String.fromCharCode(Qs(e,s)));return r.join("").replace(Ia,"")},kg=bt?function(e,n,a){return Buffer.isBuffer(e)?e.toString("utf16le",n,a).replace(Ia,""):jN(e,n,a)}:jN,wN=function(e,n,a){for(var r=[],s=n;s<n+a;++s)r.push(("0"+e[s].toString(16)).slice(-2));return r.join("")},Rw=bt?function(e,n,a){return Buffer.isBuffer(e)?e.toString("hex",n,n+a):wN(e,n,a)}:wN,kN=function(e,n,a){for(var r=[],s=n;s<a;s++)r.push(String.fromCharCode(ec(e,s)));return r.join("")},ju=bt?function(n,a,r){return Buffer.isBuffer(n)?n.toString("utf8",a,r):kN(n,a,r)}:kN,Bw=function(e,n){var a=or(e,n);return a>0?ju(e,n+4,n+4+a-1):""},Hw=Bw,Vw=function(e,n){var a=or(e,n);return a>0?ju(e,n+4,n+4+a-1):""},Uw=Vw,Kw=function(e,n){var a=2*or(e,n);return a>0?ju(e,n+4,n+4+a-1):""},zw=Kw,$w=function(n,a){var r=or(n,a);return r>0?kg(n,a+4,a+4+r):""},Gw=$w,qw=function(e,n){var a=or(e,n);return a>0?ju(e,n+4,n+4+a):""},Ww=qw,Xw=function(e,n){return QA(e,n)},_0=Xw,Tg=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};bt&&(Hw=function(n,a){if(!Buffer.isBuffer(n))return Bw(n,a);var r=n.readUInt32LE(a);return r>0?n.toString("utf8",a+4,a+4+r-1):""},Uw=function(n,a){if(!Buffer.isBuffer(n))return Vw(n,a);var r=n.readUInt32LE(a);return r>0?n.toString("utf8",a+4,a+4+r-1):""},zw=function(n,a){if(!Buffer.isBuffer(n))return Kw(n,a);var r=2*n.readUInt32LE(a);return n.toString("utf16le",a+4,a+4+r-1)},Gw=function(n,a){if(!Buffer.isBuffer(n))return $w(n,a);var r=n.readUInt32LE(a);return n.toString("utf16le",a+4,a+4+r)},Ww=function(n,a){if(!Buffer.isBuffer(n))return qw(n,a);var r=n.readUInt32LE(a);return n.toString("utf8",a+4,a+4+r)},_0=function(n,a){return Buffer.isBuffer(n)?n.readDoubleLE(a):Xw(n,a)},Tg=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var ec=function(e,n){return e[n]},Qs=function(e,n){return e[n+1]*256+e[n]},JA=function(e,n){var a=e[n+1]*256+e[n];return a<32768?a:(65535-a+1)*-1},or=function(e,n){return e[n+3]*(1<<24)+(e[n+2]<<16)+(e[n+1]<<8)+e[n]},Ol=function(e,n){return e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]},ZA=function(e,n){return e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]};function Id(e,n){var a="",r,s,l=[],o,d,u,h;switch(n){case"dbcs":if(h=this.l,bt&&Buffer.isBuffer(this))a=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)a+=String.fromCharCode(Qs(this,h)),h+=2;e*=2;break;case"utf8":a=ju(this,this.l,this.l+e);break;case"utf16le":e*=2,a=kg(this,this.l,this.l+e);break;case"wstr":return Id.call(this,e,"dbcs");case"lpstr-ansi":a=Hw(this,this.l),e=4+or(this,this.l);break;case"lpstr-cp":a=Uw(this,this.l),e=4+or(this,this.l);break;case"lpwstr":a=zw(this,this.l),e=4+2*or(this,this.l);break;case"lpp4":e=4+or(this,this.l),a=Gw(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+or(this,this.l),a=Ww(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,a="";(o=ec(this,this.l+e++))!==0;)l.push(Gh(o));a=l.join("");break;case"_wstr":for(e=0,a="";(o=Qs(this,this.l+e))!==0;)l.push(Gh(o)),e+=2;e+=2,a=l.join("");break;case"dbcs-cont":for(a="",h=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=ec(this,h),this.l=h+1,d=Id.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),l.join("")+d;l.push(Gh(Qs(this,h))),h+=2}a=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(a="",h=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=ec(this,h),this.l=h+1,d=Id.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),l.join("")+d;l.push(Gh(ec(this,h))),h+=1}a=l.join("");break;default:switch(e){case 1:return r=ec(this,this.l),this.l++,r;case 2:return r=(n==="i"?JA:Qs)(this,this.l),this.l+=2,r;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(r=(e>0?Ol:ZA)(this,this.l),this.l+=4,r):(s=or(this,this.l),this.l+=4,s);case 8:case-8:if(n==="f")return e==8?s=_0(this,this.l):s=_0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:a=Rw(this,this.l,e);break}}return this.l+=e,a}var e8=function(e,n,a){e[a]=n&255,e[a+1]=n>>>8&255,e[a+2]=n>>>16&255,e[a+3]=n>>>24&255},t8=function(e,n,a){e[a]=n&255,e[a+1]=n>>8&255,e[a+2]=n>>16&255,e[a+3]=n>>24&255},n8=function(e,n,a){e[a]=n&255,e[a+1]=n>>>8&255};function a8(e,n,a){var r=0,s=0;if(a==="dbcs"){for(s=0;s!=n.length;++s)n8(this,n.charCodeAt(s),this.l+2*s);r=2*n.length}else if(a==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=n.length;++s)this[this.l+s]=n.charCodeAt(s)&255;r=n.length}else if(a==="hex"){for(;s<e;++s)this[this.l++]=parseInt(n.slice(2*s,2*s+2),16)||0;return this}else if(a==="utf16le"){var l=Math.min(this.l+e,this.length);for(s=0;s<Math.min(n.length,e);++s){var o=n.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=n&255;break;case 2:r=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:r=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:r=4,e8(this,n,this.l);break;case 8:if(r=8,a==="f"){YA(this,n,this.l);break}case 16:break;case-4:r=4,t8(this,n,this.l);break}return this.l+=r,this}function Qw(e,n){var a=Rw(this,this.l,e.length>>1);if(a!==e)throw new Error(n+"Expected "+e+" saw "+a);this.l+=e.length>>1}function oa(e,n){e.l=n,e.read_shift=Id,e.chk=Qw,e.write_shift=a8}function ka(e,n){e.l+=n}function Ce(e){var n=rl(e);return oa(n,0),n}function ci(e,n,a){if(e){var r,s,l;oa(e,e.l||0);for(var o=e.length,d=0,u=0;e.l<o;){d=e.read_shift(1),d&128&&(d=(d&127)+((e.read_shift(1)&127)<<7));var h=iu[d]||iu[65535];for(r=e.read_shift(1),l=r&127,s=1;s<4&&r&128;++s)l+=((r=e.read_shift(1))&127)<<7*s;u=e.l+l;var m=h.f&&h.f(e,l,a);if(e.l=u,n(m,h,d))return}}}function Za(){var e=[],n=bt?256:2048,a=function(h){var m=Ce(h);return oa(m,0),m},r=a(n),s=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},l=function(h){return r&&h<r.length-r.l?r:(s(),r=a(Math.max(h+1,n)))},o=function(){return s(),ea(e)},d=function(h){s(),r=h,r.l==null&&(r.l=r.length),l(n)};return{next:l,push:d,end:o,_bufs:e}}function Ee(e,n,a,r){var s=+n,l;if(!isNaN(s)){r||(r=iu[s].p||(a||[]).length||0),l=1+(s>=128?1:0)+1,r>=128&&++l,r>=16384&&++l,r>=2097152&&++l;var o=e.next(l);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var d=0;d!=4;++d)if(r>=128)o.write_shift(1,(r&127)+128),r>>=7;else{o.write_shift(1,r);break}r>0&&Tg(a)&&e.push(a)}}function Md(e,n,a){var r=dn(e);if(n.s?(r.cRel&&(r.c+=n.s.c),r.rRel&&(r.r+=n.s.r)):(r.cRel&&(r.c+=n.c),r.rRel&&(r.r+=n.r)),!a||a.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function TN(e,n,a){var r=dn(e);return r.s=Md(r.s,n.s,a),r.e=Md(r.e,n.s,a),r}function Rd(e,n){if(e.cRel&&e.c<0)for(e=dn(e);e.c<0;)e.c+=n>8?16384:256;if(e.rRel&&e.r<0)for(e=dn(e);e.r<0;)e.r+=n>8?1048576:n>5?65536:16384;var a=dt(e);return!e.cRel&&e.cRel!=null&&(a=i8(a)),!e.rRel&&e.rRel!=null&&(a=r8(a)),a}function Nf(e,n){return e.s.r==0&&!e.s.rRel&&e.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+pn(e.s.c)+":"+(e.e.cRel?"":"$")+pn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(n.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Dn(e.s.r)+":"+(e.e.rRel?"":"$")+Dn(e.e.r):Rd(e.s,n.biff)+":"+Rd(e.e,n.biff)}function Cg(e){return parseInt(s8(e),10)-1}function Dn(e){return""+(e+1)}function r8(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function s8(e){return e.replace(/\$(\d+)$/,"$1")}function Sg(e){for(var n=l8(e),a=0,r=0;r!==n.length;++r)a=26*a+n.charCodeAt(r)-64;return a-1}function pn(e){if(e<0)throw new Error("invalid column "+e);var n="";for(++e;e;e=Math.floor((e-1)/26))n=String.fromCharCode((e-1)%26+65)+n;return n}function i8(e){return e.replace(/^([A-Z])/,"$$$1")}function l8(e){return e.replace(/^\$([A-Z])/,"$1")}function o8(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function gn(e){for(var n=0,a=0,r=0;r<e.length;++r){var s=e.charCodeAt(r);s>=48&&s<=57?n=10*n+(s-48):s>=65&&s<=90&&(a=26*a+(s-64))}return{c:a-1,r:n-1}}function dt(e){for(var n=e.c+1,a="";n;n=(n-1)/26|0)a=String.fromCharCode((n-1)%26+65)+a;return a+(e.r+1)}function er(e){var n=e.indexOf(":");return n==-1?{s:gn(e),e:gn(e)}:{s:gn(e.slice(0,n)),e:gn(e.slice(n+1))}}function pt(e,n){return typeof n>"u"||typeof n=="number"?pt(e.s,e.e):(typeof e!="string"&&(e=dt(e)),typeof n!="string"&&(n=dt(n)),e==n?e:e+":"+n)}function Dt(e){var n={s:{c:0,r:0},e:{c:0,r:0}},a=0,r=0,s=0,l=e.length;for(a=0;r<l&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)a=26*a+s;for(n.s.c=--a,a=0;r<l&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)a=10*a+s;if(n.s.r=--a,r===l||s!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++r,a=0;r!=l&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)a=26*a+s;for(n.e.c=--a,a=0;r!=l&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)a=10*a+s;return n.e.r=--a,n}function CN(e,n){var a=e.t=="d"&&n instanceof Date;if(e.z!=null)try{return e.w=Mr(e.z,a?zn(n):n)}catch{}try{return e.w=Mr((e.XF||{}).numFmtId||(a?14:0),a?zn(n):n)}catch{return""+n}}function li(e,n,a){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&a&&a.dateNF&&(e.z=a.dateNF),e.t=="e"?di[e.v]||e.v:n==null?CN(e,e.v):CN(e,n))}function ul(e,n){var a=n&&n.sheet?n.sheet:"Sheet1",r={};return r[a]=e,{SheetNames:[a],Sheets:r}}function Yw(e,n,a){var r=a||{},s=e?Array.isArray(e):r.dense,l=e||(s?[]:{}),o=0,d=0;if(l&&r.origin!=null){if(typeof r.origin=="number")o=r.origin;else{var u=typeof r.origin=="string"?gn(r.origin):r.origin;o=u.r,d=u.c}l["!ref"]||(l["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var m=Dt(l["!ref"]);h.s.c=m.s.c,h.s.r=m.s.r,h.e.c=Math.max(h.e.c,m.e.c),h.e.r=Math.max(h.e.r,m.e.r),o==-1&&(h.e.r=o=m.e.r+1)}for(var f=0;f!=n.length;++f)if(n[f]){if(!Array.isArray(n[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=n[f].length;++p)if(!(typeof n[f][p]>"u")){var b={v:n[f][p]},g=o+f,y=d+p;if(h.s.r>g&&(h.s.r=g),h.s.c>y&&(h.s.c=y),h.e.r<g&&(h.e.r=g),h.e.c<y&&(h.e.c=y),n[f][p]&&typeof n[f][p]=="object"&&!Array.isArray(n[f][p])&&!(n[f][p]instanceof Date))b=n[f][p];else if(Array.isArray(b.v)&&(b.f=n[f][p][1],b.v=b.v[0]),b.v===null)if(b.f)b.t="n";else if(r.nullError)b.t="e",b.v=0;else if(r.sheetStubs)b.t="z";else continue;else typeof b.v=="number"?b.t="n":typeof b.v=="boolean"?b.t="b":b.v instanceof Date?(b.z=r.dateNF||ct[14],r.cellDates?(b.t="d",b.w=Mr(b.z,zn(b.v))):(b.t="n",b.v=zn(b.v),b.w=Mr(b.z,b.v))):b.t="s";if(s)l[g]||(l[g]=[]),l[g][y]&&l[g][y].z&&(b.z=l[g][y].z),l[g][y]=b;else{var N=dt({c:y,r:g});l[N]&&l[N].z&&(b.z=l[N].z),l[N]=b}}}return h.s.c<1e7&&(l["!ref"]=pt(h)),l}function Oc(e,n){return Yw(null,e,n)}function c8(e){return e.read_shift(4,"i")}function es(e,n){return n||(n=Ce(4)),n.write_shift(4,e),n}function wa(e){var n=e.read_shift(4);return n===0?"":e.read_shift(n,"dbcs")}function ta(e,n){var a=!1;return n==null&&(a=!0,n=Ce(4+2*e.length)),n.write_shift(4,e.length),e.length>0&&n.write_shift(0,e,"dbcs"),a?n.slice(0,n.l):n}function d8(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function u8(e,n){return n||(n=Ce(4)),n.write_shift(2,0),n.write_shift(2,0),n}function _g(e,n){var a=e.l,r=e.read_shift(1),s=wa(e),l=[],o={t:s,h:s};if((r&1)!==0){for(var d=e.read_shift(4),u=0;u!=d;++u)l.push(d8(e));o.r=l}else o.r=[{ich:0,ifnt:0}];return e.l=a+n,o}function h8(e,n){var a=!1;return n==null&&(a=!0,n=Ce(15+4*e.t.length)),n.write_shift(1,0),ta(e.t,n),a?n.slice(0,n.l):n}var x8=_g;function m8(e,n){var a=!1;return n==null&&(a=!0,n=Ce(23+4*e.t.length)),n.write_shift(1,1),ta(e.t,n),n.write_shift(4,1),u8({},n),a?n.slice(0,n.l):n}function Br(e){var n=e.read_shift(4),a=e.read_shift(2);return a+=e.read_shift(1)<<16,e.l++,{c:n,iStyleRef:a}}function fo(e,n){return n==null&&(n=Ce(8)),n.write_shift(-4,e.c),n.write_shift(3,e.iStyleRef||e.s),n.write_shift(1,0),n}function po(e){var n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:n}}function go(e,n){return n==null&&(n=Ce(4)),n.write_shift(3,e.iStyleRef||e.s),n.write_shift(1,0),n}var f8=wa,Jw=ta;function Eg(e){var n=e.read_shift(4);return n===0||n===4294967295?"":e.read_shift(n,"dbcs")}function E0(e,n){var a=!1;return n==null&&(a=!0,n=Ce(127)),n.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&n.write_shift(0,e,"dbcs"),a?n.slice(0,n.l):n}var p8=wa,jp=Eg,Dg=E0;function Fg(e){var n=e.slice(e.l,e.l+4),a=n[0]&1,r=n[0]&2;e.l+=4;var s=r===0?_0([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):Ol(n,0)>>2;return a?s/100:s}function Zw(e,n){n==null&&(n=Ce(4));var a=0,r=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?r=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(r=1,a=1),r)n.write_shift(-4,((a?s:e)<<2)+(a+2));else throw new Error("unsupported RkNumber "+e)}function ek(e){var n={s:{},e:{}};return n.s.r=e.read_shift(4),n.e.r=e.read_shift(4),n.s.c=e.read_shift(4),n.e.c=e.read_shift(4),n}function g8(e,n){return n||(n=Ce(16)),n.write_shift(4,e.s.r),n.write_shift(4,e.e.r),n.write_shift(4,e.s.c),n.write_shift(4,e.e.c),n}var yo=ek,Ic=g8;function ja(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function io(e,n){return(n||Ce(8)).write_shift(8,e,"f")}function y8(e){var n={},a=e.read_shift(1),r=a>>>1,s=e.read_shift(1),l=e.read_shift(2,"i"),o=e.read_shift(1),d=e.read_shift(1),u=e.read_shift(1);switch(e.l++,r){case 0:n.auto=1;break;case 1:n.index=s;var h=Ql[s];h&&(n.rgb=nu(h));break;case 2:n.rgb=nu([o,d,u]);break;case 3:n.theme=s;break}return l!=0&&(n.tint=l>0?l/32767:l/32768),n}function D0(e,n){if(n||(n=Ce(8)),!e||e.auto)return n.write_shift(4,0),n.write_shift(4,0),n;e.index!=null?(n.write_shift(1,2),n.write_shift(1,e.index)):e.theme!=null?(n.write_shift(1,6),n.write_shift(1,e.theme)):(n.write_shift(1,5),n.write_shift(1,0));var a=e.tint||0;if(a>0?a*=32767:a<0&&(a*=32768),n.write_shift(2,a),!e.rgb||e.theme!=null)n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);else{var r=e.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),n.write_shift(1,parseInt(r.slice(0,2),16)),n.write_shift(1,parseInt(r.slice(2,4),16)),n.write_shift(1,parseInt(r.slice(4,6),16)),n.write_shift(1,255)}return n}function v8(e){var n=e.read_shift(1);e.l++;var a={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return a}function b8(e,n){n||(n=Ce(2));var a=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return n.write_shift(1,a),n.write_shift(1,0),n}function tk(e,n){var a={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return a[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,n==1?"lpstr":"lpwstr")}function N8(e){return tk(e,1)}function j8(e){return tk(e,2)}var Ag=2,Wa=3,Wh=11,SN=12,F0=19,Xh=64,w8=65,k8=71,T8=4108,C8=4126,Jn=80,nk=81,S8=[Jn,nk],wp={1:{n:"CodePage",t:Ag},2:{n:"Category",t:Jn},3:{n:"PresentationFormat",t:Jn},4:{n:"ByteCount",t:Wa},5:{n:"LineCount",t:Wa},6:{n:"ParagraphCount",t:Wa},7:{n:"SlideCount",t:Wa},8:{n:"NoteCount",t:Wa},9:{n:"HiddenCount",t:Wa},10:{n:"MultimediaClipCount",t:Wa},11:{n:"ScaleCrop",t:Wh},12:{n:"HeadingPairs",t:T8},13:{n:"TitlesOfParts",t:C8},14:{n:"Manager",t:Jn},15:{n:"Company",t:Jn},16:{n:"LinksUpToDate",t:Wh},17:{n:"CharacterCount",t:Wa},19:{n:"SharedDoc",t:Wh},22:{n:"HyperlinksChanged",t:Wh},23:{n:"AppVersion",t:Wa,p:"version"},24:{n:"DigSig",t:w8},26:{n:"ContentType",t:Jn},27:{n:"ContentStatus",t:Jn},28:{n:"Language",t:Jn},29:{n:"Version",t:Jn},255:{},2147483648:{n:"Locale",t:F0},2147483651:{n:"Behavior",t:F0},1919054434:{}},kp={1:{n:"CodePage",t:Ag},2:{n:"Title",t:Jn},3:{n:"Subject",t:Jn},4:{n:"Author",t:Jn},5:{n:"Keywords",t:Jn},6:{n:"Comments",t:Jn},7:{n:"Template",t:Jn},8:{n:"LastAuthor",t:Jn},9:{n:"RevNumber",t:Jn},10:{n:"EditTime",t:Xh},11:{n:"LastPrinted",t:Xh},12:{n:"CreatedDate",t:Xh},13:{n:"ModifiedDate",t:Xh},14:{n:"PageCount",t:Wa},15:{n:"WordCount",t:Wa},16:{n:"CharCount",t:Wa},17:{n:"Thumbnail",t:k8},18:{n:"Application",t:Jn},19:{n:"DocSecurity",t:Wa},255:{},2147483648:{n:"Locale",t:F0},2147483651:{n:"Behavior",t:F0},1919054434:{}},_N={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},_8=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function E8(e){return e.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var D8=E8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ql=dn(D8),di={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ak={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Tp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Qh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Pg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function F8(e){var n=Pg();if(!e||!e.match)return n;var a={};if((e.match(Ta)||[]).forEach(function(r){var s=ut(r);switch(s[0].replace(VA,"<")){case"<?xml":break;case"<Types":n.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":a[s.Extension]=s.ContentType;break;case"<Override":n[Tp[s.ContentType]]!==void 0&&n[Tp[s.ContentType]].push(s.PartName);break}}),n.xmlns!==Kn.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=a,delete n.calcchains,n}function rk(e,n){var a=FA(Tp),r=[],s;r[r.length]=Fn,r[r.length]=Ve("Types",null,{xmlns:Kn.CT,"xmlns:xsd":Kn.xsd,"xmlns:xsi":Kn.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return Ve("Default",null,{Extension:u[0],ContentType:u[1]})}));var l=function(u){e[u]&&e[u].length>0&&(s=e[u][0],r[r.length]=Ve("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Qh[u][n.bookType]||Qh[u].xlsx}))},o=function(u){(e[u]||[]).forEach(function(h){r[r.length]=Ve("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:Qh[u][n.bookType]||Qh[u].xlsx})})},d=function(u){(e[u]||[]).forEach(function(h){r[r.length]=Ve("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:a[u][0]})})};return l("workbooks"),o("sheets"),o("charts"),d("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(d),d("vba"),d("comments"),d("threadedcomments"),d("drawings"),o("metadata"),d("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var jt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function tu(e){var n=e.lastIndexOf("/");return e.slice(0,n+1)+"_rels/"+e.slice(n+1)+".rels"}function Bd(e,n){var a={"!id":{}};if(!e)return a;n.charAt(0)!=="/"&&(n="/"+n);var r={};return(e.match(Ta)||[]).forEach(function(s){var l=ut(s);if(l[0]==="<Relationship"){var o={};o.Type=l.Type,o.Target=l.Target,o.Id=l.Id,l.TargetMode&&(o.TargetMode=l.TargetMode);var d=l.TargetMode==="External"?l.Target:Ad(l.Target,n);a[d]=o,r[l.Id]=o}}),a["!id"]=r,a}function sc(e){var n=[Fn,Ve("Relationships",null,{xmlns:Kn.RELS})];return jn(e["!id"]).forEach(function(a){n[n.length]=Ve("Relationship",null,e["!id"][a])}),n.length>2&&(n[n.length]="</Relationships>",n[1]=n[1].replace("/>",">")),n.join("")}function zt(e,n,a,r,s,l){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),n<0)for(n=e["!idx"];e["!id"]["rId"+n];++n);if(e["!idx"]=n+1,s.Id="rId"+n,s.Type=r,s.Target=a,[jt.HLINK,jt.XPATH,jt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+n);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,n}var A8="application/vnd.oasis.opendocument.spreadsheet";function P8(e,n){for(var a=wg(e),r,s;r=eu.exec(a);)switch(r[3]){case"manifest":break;case"file-entry":if(s=ut(r[0],!1),s.path=="/"&&s.type!==A8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw r}}function L8(e){var n=[Fn];n.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),n.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var a=0;a<e.length;++a)n.push('  <manifest:file-entry manifest:full-path="'+e[a][0]+'" manifest:media-type="'+e[a][1]+`"/>
`);return n.push("</manifest:manifest>"),n.join("")}function EN(e,n,a){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(a||"odf")+"#"+n+`"/>
`,`  </rdf:Description>
`].join("")}function O8(e,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+n+`"/>
`,`  </rdf:Description>
`].join("")}function I8(e){var n=[Fn];n.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var a=0;a!=e.length;++a)n.push(EN(e[a][0],e[a][1])),n.push(O8("",e[a][0]));return n.push(EN("","Document","pkg")),n.push("</rdf:RDF>"),n.join("")}function sk(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+w0.version+"</meta:generator></office:meta></office:document-meta>"}var Pr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],M8=(function(){for(var e=new Array(Pr.length),n=0;n<Pr.length;++n){var a=Pr[n],r="(?:"+a[0].slice(0,a[0].indexOf(":"))+":)"+a[0].slice(a[0].indexOf(":")+1);e[n]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e})();function ik(e){var n={};e=Xt(e);for(var a=0;a<Pr.length;++a){var r=Pr[a],s=e.match(M8[a]);s!=null&&s.length>0&&(n[r[1]]=Et(s[1])),r[2]==="date"&&n[r[1]]&&(n[r[1]]=cn(n[r[1]]))}return n}function jf(e,n,a,r,s){s[e]!=null||n==null||n===""||(s[e]=n,n=$t(n),r[r.length]=a?Ve(e,n,a):da(e,n))}function lk(e,n){var a=n||{},r=[Fn,Ve("cp:coreProperties",null,{"xmlns:cp":Kn.CORE_PROPS,"xmlns:dc":Kn.dc,"xmlns:dcterms":Kn.dcterms,"xmlns:dcmitype":Kn.dcmitype,"xmlns:xsi":Kn.xsi})],s={};if(!e&&!a.Props)return r.join("");e&&(e.CreatedDate!=null&&jf("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Np(e.CreatedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},r,s),e.ModifiedDate!=null&&jf("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Np(e.ModifiedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},r,s));for(var l=0;l!=Pr.length;++l){var o=Pr[l],d=a.Props&&a.Props[o[1]]!=null?a.Props[o[1]]:e?e[o[1]]:null;d===!0?d="1":d===!1?d="0":typeof d=="number"&&(d=String(d)),d!=null&&jf(o[0],d,null,r,s)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Yl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],ok=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ck(e,n,a,r){var s=[];if(typeof e=="string")s=vN(e,r);else for(var l=0;l<e.length;++l)s=s.concat(e[l].map(function(m){return{v:m}}));var o=typeof n=="string"?vN(n,r).map(function(m){return m.v}):n,d=0,u=0;if(o.length>0)for(var h=0;h!==s.length;h+=2){switch(u=+s[h+1].v,s[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":a.Worksheets=u,a.SheetNames=o.slice(d,d+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":a.NamedRanges=u,a.DefinedNames=o.slice(d,d+u);break;case"Charts":case"Diagramme":a.Chartsheets=u,a.ChartNames=o.slice(d,d+u);break}d+=u}}function R8(e,n,a){var r={};return n||(n={}),e=Xt(e),Yl.forEach(function(s){var l=(e.match(Jd(s[0]))||[])[1];switch(s[2]){case"string":l&&(n[s[1]]=Et(l));break;case"bool":n[s[1]]=l==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(r[s[1]]=o[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&ck(r.HeadingPairs,r.TitlesOfParts,n,a),n}function dk(e){var n=[],a=Ve;return e||(e={}),e.Application="SheetJS",n[n.length]=Fn,n[n.length]=Ve("Properties",null,{xmlns:Kn.EXT_PROPS,"xmlns:vt":Kn.vt}),Yl.forEach(function(r){if(e[r[1]]!==void 0){var s;switch(r[2]){case"string":s=$t(String(e[r[1]]));break;case"bool":s=e[r[1]]?"true":"false";break}s!==void 0&&(n[n.length]=a(r[0],s))}}),n[n.length]=a("HeadingPairs",a("vt:vector",a("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+a("vt:variant",a("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),n[n.length]=a("TitlesOfParts",a("vt:vector",e.SheetNames.map(function(r){return"<vt:lpstr>"+$t(r)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var B8=/<[^>]+>[^<]*/g;function H8(e,n){var a={},r="",s=e.match(B8);if(s)for(var l=0;l!=s.length;++l){var o=s[l],d=ut(o);switch(d[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Et(d.name);break;case"</property>":r=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),h=u[0].slice(4),m=u[1];switch(h){case"lpstr":case"bstr":case"lpwstr":a[r]=Et(m);break;case"bool":a[r]=sn(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":a[r]=parseInt(m,10);break;case"r4":case"r8":case"decimal":a[r]=parseFloat(m);break;case"filetime":case"date":a[r]=cn(m);break;case"cy":case"error":a[r]=Et(m);break;default:if(h.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",o,h,u)}}else if(o.slice(0,2)!=="</"){if(n.WTF)throw new Error(o)}}}return a}function uk(e){var n=[Fn,Ve("Properties",null,{xmlns:Kn.CUST_PROPS,"xmlns:vt":Kn.vt})];if(!e)return n.join("");var a=1;return jn(e).forEach(function(s){++a,n[n.length]=Ve("property",XA(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:a,name:$t(s)})}),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var Cp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},wf;function V8(e,n,a){wf||(wf=nx(Cp)),n=wf[n]||n,e[n]=a}function U8(e,n){var a=[];return jn(Cp).map(function(r){for(var s=0;s<Pr.length;++s)if(Pr[s][1]==r)return Pr[s];for(s=0;s<Yl.length;++s)if(Yl[s][1]==r)return Yl[s];throw r}).forEach(function(r){if(e[r[1]]!=null){var s=n&&n.Props&&n.Props[r[1]]!=null?n.Props[r[1]]:e[r[1]];switch(r[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),a.push(da(Cp[r[1]]||r[1],s))}}),Ve("DocumentProperties",a.join(""),{xmlns:lr.o})}function K8(e,n){var a=["Worksheets","SheetNames"],r="CustomDocumentProperties",s=[];return e&&jn(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)){for(var o=0;o<Pr.length;++o)if(l==Pr[o][1])return;for(o=0;o<Yl.length;++o)if(l==Yl[o][1])return;for(o=0;o<a.length;++o)if(l==a[o])return;var d=e[l],u="string";typeof d=="number"?(u="float",d=String(d)):d===!0||d===!1?(u="boolean",d=d?"1":"0"):d=String(d),s.push(Ve(fN(l),d,{"dt:dt":u}))}}),n&&jn(n).forEach(function(l){if(Object.prototype.hasOwnProperty.call(n,l)&&!(e&&Object.prototype.hasOwnProperty.call(e,l))){var o=n[l],d="string";typeof o=="number"?(d="float",o=String(o)):o===!0||o===!1?(d="boolean",o=o?"1":"0"):o instanceof Date?(d="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Ve(fN(l),o,{"dt:dt":d}))}}),"<"+r+' xmlns="'+lr.o+'">'+s.join("")+"</"+r+">"}function Lg(e){var n=e.read_shift(4),a=e.read_shift(4);return new Date((a/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function z8(e){var n=typeof e=="string"?new Date(Date.parse(e)):e,a=n.getTime()/1e3+11644473600,r=a%Math.pow(2,32),s=(a-r)/Math.pow(2,32);r*=1e7,s*=1e7;var l=r/Math.pow(2,32)|0;l>0&&(r=r%Math.pow(2,32),s+=l);var o=Ce(8);return o.write_shift(4,r),o.write_shift(4,s),o}function hk(e,n,a){var r=e.l,s=e.read_shift(0,"lpstr-cp");if(a)for(;e.l-r&3;)++e.l;return s}function xk(e,n,a){var r=e.read_shift(0,"lpwstr");return r}function mk(e,n,a){return n===31?xk(e):hk(e,n,a)}function Sp(e,n,a){return mk(e,n,a===!1?0:4)}function $8(e,n){if(!n)throw new Error("VtUnalignedString must have positive length");return mk(e,n,0)}function G8(e){for(var n=e.read_shift(4),a=[],r=0;r!=n;++r){var s=e.l;a[r]=e.read_shift(0,"lpwstr").replace(Ia,""),e.l-s&2&&(e.l+=2)}return a}function q8(e){for(var n=e.read_shift(4),a=[],r=0;r!=n;++r)a[r]=e.read_shift(0,"lpstr-cp").replace(Ia,"");return a}function W8(e){var n=e.l,a=A0(e,nk);e[e.l]==0&&e[e.l+1]==0&&e.l-n&2&&(e.l+=2);var r=A0(e,Wa);return[a,r]}function X8(e){for(var n=e.read_shift(4),a=[],r=0;r<n/2;++r)a.push(W8(e));return a}function DN(e,n){for(var a=e.read_shift(4),r={},s=0;s!=a;++s){var l=e.read_shift(4),o=e.read_shift(4);r[l]=e.read_shift(o,n===1200?"utf16le":"utf8").replace(Ia,"").replace(Fd,"!"),n===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function fk(e){var n=e.read_shift(4),a=e.slice(e.l,e.l+n);return e.l+=n,(n&3)>0&&(e.l+=4-(n&3)&3),a}function Q8(e){var n={};return n.Size=e.read_shift(4),e.l+=n.Size+3-(n.Size-1)%4,n}function A0(e,n,a){var r=e.read_shift(2),s,l=a||{};if(e.l+=2,n!==SN&&r!==n&&S8.indexOf(n)===-1&&!((n&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+n+" saw "+r);switch(n===SN?r:n){case 2:return s=e.read_shift(2,"i"),l.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return hk(e,r,4).replace(Ia,"");case 31:return xk(e);case 64:return Lg(e);case 65:return fk(e);case 71:return Q8(e);case 80:return Sp(e,r,!l.raw).replace(Ia,"");case 81:return $8(e,r).replace(Ia,"");case 4108:return X8(e);case 4126:case 4127:return r==4127?G8(e):q8(e);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+r)}}function FN(e,n){var a=Ce(4),r=Ce(4);switch(a.write_shift(4,e==80?31:e),e){case 3:r.write_shift(-4,n);break;case 5:r=Ce(8),r.write_shift(8,n,"f");break;case 11:r.write_shift(4,n?1:0);break;case 64:r=z8(n);break;case 31:case 80:for(r=Ce(4+2*(n.length+1)+(n.length%2?0:2)),r.write_shift(4,n.length+1),r.write_shift(0,n,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}return ea([a,r])}function AN(e,n){var a=e.l,r=e.read_shift(4),s=e.read_shift(4),l=[],o=0,d=0,u=-1,h={};for(o=0;o!=s;++o){var m=e.read_shift(4),f=e.read_shift(4);l[o]=[m,f+a]}l.sort(function(T,S){return T[1]-S[1]});var p={};for(o=0;o!=s;++o){if(e.l!==l[o][1]){var b=!0;if(o>0&&n)switch(n[l[o-1][0]].t){case 2:e.l+2===l[o][1]&&(e.l+=2,b=!1);break;case 80:e.l<=l[o][1]&&(e.l=l[o][1],b=!1);break;case 4108:e.l<=l[o][1]&&(e.l=l[o][1],b=!1);break}if((!n||o==0)&&e.l<=l[o][1]&&(b=!1,e.l=l[o][1]),b)throw new Error("Read Error: Expected address "+l[o][1]+" at "+e.l+" :"+o)}if(n){var g=n[l[o][0]];if(p[g.n]=A0(e,g.t,{raw:!0}),g.p==="version"&&(p[g.n]=String(p[g.n]>>16)+"."+("0000"+String(p[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(p[g.n]){case 0:p[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Yr(d=p[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[g.n])}}else if(l[o][0]===1){if(d=p.CodePage=A0(e,Ag),Yr(d),u!==-1){var y=e.l;e.l=l[u][1],h=DN(e,d),e.l=y}}else if(l[o][0]===0){if(d===0){u=o,e.l=l[o+1][1];continue}h=DN(e,d)}else{var N=h[l[o][0]],C;switch(e[e.l]){case 65:e.l+=4,C=fk(e);break;case 30:e.l+=4,C=Sp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,C=Sp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,C=e.read_shift(4,"i");break;case 19:e.l+=4,C=e.read_shift(4);break;case 5:e.l+=4,C=e.read_shift(8,"f");break;case 11:e.l+=4,C=_n(e,4);break;case 64:e.l+=4,C=cn(Lg(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[N]=C}}return e.l=a+r,p}var pk=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Y8(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function PN(e,n,a){var r=Ce(8),s=[],l=[],o=8,d=0,u=Ce(8),h=Ce(8);if(u.write_shift(4,2),u.write_shift(4,1200),h.write_shift(4,1),l.push(u),s.push(h),o+=8+u.length,!n){h=Ce(8),h.write_shift(4,0),s.unshift(h);var m=[Ce(4)];for(m[0].write_shift(4,e.length),d=0;d<e.length;++d){var f=e[d][0];for(u=Ce(8+2*(f.length+1)+(f.length%2?0:2)),u.write_shift(4,d+2),u.write_shift(4,f.length+1),u.write_shift(0,f,"dbcs");u.l!=u.length;)u.write_shift(1,0);m.push(u)}u=ea(m),l.unshift(u),o+=8+u.length}for(d=0;d<e.length;++d)if(!(n&&!n[e[d][0]])&&!(pk.indexOf(e[d][0])>-1||ok.indexOf(e[d][0])>-1)&&e[d][1]!=null){var p=e[d][1],b=0;if(n){b=+n[e[d][0]];var g=a[b];if(g.p=="version"&&typeof p=="string"){var y=p.split(".");p=(+y[0]<<16)+(+y[1]||0)}u=FN(g.t,p)}else{var N=Y8(p);N==-1&&(N=31,p=String(p)),u=FN(N,p)}l.push(u),h=Ce(8),h.write_shift(4,n?b:2+d),s.push(h),o+=8+u.length}var C=8*(l.length+1);for(d=0;d<l.length;++d)s[d].write_shift(4,C),C+=l[d].length;return r.write_shift(4,o),r.write_shift(4,l.length),ea([r].concat(s).concat(l))}function LN(e,n,a){var r=e.content;if(!r)return{};oa(r,0);var s,l,o,d,u=0;r.chk("feff","Byte Order: "),r.read_shift(2);var h=r.read_shift(4),m=r.read_shift(16);if(m!==nt.utils.consts.HEADER_CLSID&&m!==a)throw new Error("Bad PropertySet CLSID "+m);if(s=r.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(l=r.read_shift(16),d=r.read_shift(4),s===1&&d!==r.l)throw new Error("Length mismatch: "+d+" !== "+r.l);s===2&&(o=r.read_shift(16),u=r.read_shift(4));var f=AN(r,n),p={SystemIdentifier:h};for(var b in f)p[b]=f[b];if(p.FMTID=l,s===1)return p;if(u-r.l==2&&(r.l+=2),r.l!==u)throw new Error("Length mismatch 2: "+r.l+" !== "+u);var g;try{g=AN(r,null)}catch{}for(b in g)p[b]=g[b];return p.FMTID=[l,o],p}function ON(e,n,a,r,s,l){var o=Ce(s?68:48),d=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,nt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,n,"hex"),o.write_shift(4,s?68:48);var u=PN(e,a,r);if(d.push(u),s){var h=PN(s,null,null);o.write_shift(16,l,"hex"),o.write_shift(4,68+u.length),d.push(h)}return ea(d)}function Oi(e,n){return e.read_shift(n),null}function J8(e,n){n||(n=Ce(e));for(var a=0;a<e;++a)n.write_shift(1,0);return n}function Z8(e,n,a){for(var r=[],s=e.l+n;e.l<s;)r.push(a(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return r}function _n(e,n){return e.read_shift(n)===1}function Pa(e,n){return n||(n=Ce(2)),n.write_shift(2,+!!e),n}function On(e){return e.read_shift(2,"u")}function Cr(e,n){return n||(n=Ce(2)),n.write_shift(2,e),n}function gk(e,n){return Z8(e,n,On)}function eP(e){var n=e.read_shift(1),a=e.read_shift(1);return a===1?n:n===1}function yk(e,n,a){return a||(a=Ce(2)),a.write_shift(1,n=="e"?+e:+!!e),a.write_shift(1,n=="e"?1:0),a}function wu(e,n,a){var r=e.read_shift(a&&a.biff>=12?2:1),s="sbcs-cont";if(a&&a.biff>=8,!a||a.biff==8){var l=e.read_shift(1);l&&(s="dbcs-cont")}else a.biff==12&&(s="wstr");a.biff>=2&&a.biff<=5&&(s="cpstr");var o=r?e.read_shift(r,s):"";return o}function tP(e){var n=e.read_shift(2),a=e.read_shift(1),r=a&4,s=a&8,l=1+(a&1),o=0,d,u={};s&&(o=e.read_shift(2)),r&&(d=e.read_shift(4));var h=l==2?"dbcs-cont":"sbcs-cont",m=n===0?"":e.read_shift(n,h);return s&&(e.l+=4*o),r&&(e.l+=d),u.t=m,s||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function nP(e){var n=e.t||"",a=Ce(3);a.write_shift(2,n.length),a.write_shift(1,1);var r=Ce(2*n.length);r.write_shift(2*n.length,n,"utf16le");var s=[a,r];return ea(s)}function lo(e,n,a){var r;if(a){if(a.biff>=2&&a.biff<=5)return e.read_shift(n,"cpstr");if(a.biff>=12)return e.read_shift(n,"dbcs-cont")}var s=e.read_shift(1);return s===0?r=e.read_shift(n,"sbcs-cont"):r=e.read_shift(n,"dbcs-cont"),r}function ku(e,n,a){var r=e.read_shift(a&&a.biff==2?1:2);return r===0?(e.l++,""):lo(e,r,a)}function vo(e,n,a){if(a.biff>5)return ku(e,n,a);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,a.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function vk(e,n,a){return a||(a=Ce(3+2*e.length)),a.write_shift(2,e.length),a.write_shift(1,1),a.write_shift(31,e,"utf16le"),a}function aP(e){var n=e.read_shift(1);e.l++;var a=e.read_shift(2);return e.l+=2,[n,a]}function rP(e){var n=e.read_shift(4),a=e.l,r=!1;n>24&&(e.l+=n-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=a);var s=e.read_shift((r?n-24:n)>>1,"utf16le").replace(Ia,"");return r&&(e.l+=24),s}function sP(e){for(var n=e.read_shift(2),a="";n-- >0;)a+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return a+r.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(l>>1,"utf16le").replace(Ia,"");return a+o}function iP(e,n){var a=e.read_shift(16);switch(a){case"e0c9ea79f9bace118c8200aa004ba90b":return rP(e);case"0303000000000000c000000000000046":return sP(e);default:throw new Error("Unsupported Moniker "+a)}}function Yh(e){var n=e.read_shift(4),a=n>0?e.read_shift(n,"utf16le").replace(Ia,""):"";return a}function IN(e,n){n||(n=Ce(6+e.length*2)),n.write_shift(4,1+e.length);for(var a=0;a<e.length;++a)n.write_shift(2,e.charCodeAt(a));return n.write_shift(2,0),n}function lP(e,n){var a=e.l+n,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var s=e.read_shift(2);e.l+=2;var l,o,d,u,h="",m,f;s&16&&(l=Yh(e,a-e.l)),s&128&&(o=Yh(e,a-e.l)),(s&257)===257&&(d=Yh(e,a-e.l)),(s&257)===1&&(u=iP(e,a-e.l)),s&8&&(h=Yh(e,a-e.l)),s&32&&(m=e.read_shift(16)),s&64&&(f=Lg(e)),e.l=a;var p=o||d||u||"";p&&h&&(p+="#"+h),p||(p="#"+h),s&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var b={Target:p};return m&&(b.guid=m),f&&(b.time=f),l&&(b.Tooltip=l),b}function oP(e){var n=Ce(512),a=0,r=e.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var s=r.indexOf("#"),l=s>-1?31:23;switch(r.charAt(0)){case"#":l=28;break;case".":l&=-3;break}n.write_shift(4,2),n.write_shift(4,l);var o=[8,6815827,6619237,4849780,83];for(a=0;a<o.length;++a)n.write_shift(4,o[a]);if(l==28)r=r.slice(1),IN(r,n);else if(l&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<o.length;++a)n.write_shift(1,parseInt(o[a],16));var d=s>-1?r.slice(0,s):r;for(n.write_shift(4,2*(d.length+1)),a=0;a<d.length;++a)n.write_shift(2,d.charCodeAt(a));n.write_shift(2,0),l&8&&IN(s>-1?r.slice(s+1):"",n)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),a=0;a<o.length;++a)n.write_shift(1,parseInt(o[a],16));for(var u=0;r.slice(u*3,u*3+3)=="../"||r.slice(u*3,u*3+3)=="..\\";)++u;for(n.write_shift(2,u),n.write_shift(4,r.length-3*u+1),a=0;a<r.length-3*u;++a)n.write_shift(1,r.charCodeAt(a+3*u)&255);for(n.write_shift(1,0),n.write_shift(2,65535),n.write_shift(2,57005),a=0;a<6;++a)n.write_shift(4,0)}return n.slice(0,n.l)}function bk(e){var n=e.read_shift(1),a=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1);return[n,a,r,s]}function Nk(e,n){var a=bk(e);return a[3]=0,a}function Es(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2);return{r:n,c:a,ixfe:r}}function oo(e,n,a,r){return r||(r=Ce(6)),r.write_shift(2,e),r.write_shift(2,n),r.write_shift(2,a||0),r}function cP(e){var n=e.read_shift(2),a=e.read_shift(2);return e.l+=8,{type:n,flags:a}}function dP(e,n,a){return n===0?"":vo(e,n,a)}function uP(e,n,a){var r=a.biff>8?4:2,s=e.read_shift(r),l=e.read_shift(r,"i"),o=e.read_shift(r,"i");return[s,l,o]}function jk(e){var n=e.read_shift(2),a=Fg(e);return[n,a]}function hP(e,n,a){e.l+=4,n-=4;var r=e.l+n,s=wu(e,n,a),l=e.read_shift(2);if(r-=e.l,l!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+l);return e.l+=l,s}function sx(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{s:{c:r,r:n},e:{c:s,r:a}}}function wk(e,n){return n||(n=Ce(8)),n.write_shift(2,e.s.r),n.write_shift(2,e.e.r),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c),n}function kk(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(1),s=e.read_shift(1);return{s:{c:r,r:n},e:{c:s,r:a}}}var xP=kk;function Tk(e){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[a,n,r]}function mP(e){var n={};return e.l+=4,e.l+=16,n.fSharedNote=e.read_shift(2),e.l+=4,n}function fP(e){var n={};return e.l+=4,e.cf=e.read_shift(2),n}function pa(e){e.l+=2,e.l+=e.read_shift(2)}var pP={0:pa,4:pa,5:pa,6:pa,7:fP,8:pa,9:pa,10:pa,11:pa,12:pa,13:mP,14:pa,15:pa,16:pa,17:pa,18:pa,19:pa,20:pa,21:Tk};function gP(e,n){for(var a=e.l+n,r=[];e.l<a;){var s=e.read_shift(2);e.l-=2;try{r.push(pP[s](e,a-e.l))}catch{return e.l=a,r}}return e.l!=a&&(e.l=a),r}function Jh(e,n){var a={BIFFVer:0,dt:0};switch(a.BIFFVer=e.read_shift(2),n-=2,n>=2&&(a.dt=e.read_shift(2),e.l-=2),a.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+a.BIFFVer)}return e.read_shift(n),a}function Og(e,n,a){var r=1536,s=16;switch(a.bookType){case"biff8":break;case"biff5":r=1280,s=8;break;case"biff4":r=4,s=6;break;case"biff3":r=3,s=6;break;case"biff2":r=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=Ce(s);return l.write_shift(2,r),l.write_shift(2,n),s>4&&l.write_shift(2,29282),s>6&&l.write_shift(2,1997),s>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function yP(e,n){return n===0||e.read_shift(2),1200}function vP(e,n,a){if(a.enc)return e.l+=n,"";var r=e.l,s=vo(e,0,a);return e.read_shift(n+r-e.l),s}function bP(e,n){var a=!n||n.biff==8,r=Ce(a?112:54);for(r.write_shift(n.biff==8?2:1,7),a&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(a?0:536870912));r.l<r.length;)r.write_shift(1,a?0:32);return r}function NP(e,n,a){var r=a&&a.biff==8||n==2?e.read_shift(2):(e.l+=n,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function jP(e,n,a){var r=e.read_shift(4),s=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var o=wu(e,0,a);return o.length===0&&(o="Sheet1"),{pos:r,hs:s,dt:l,name:o}}function wP(e,n){var a=!n||n.biff>=8?2:1,r=Ce(8+a*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),n.biff>=8&&r.write_shift(1,1),r.write_shift(a*e.name.length,e.name,n.biff<8?"sbcs":"utf16le");var s=r.slice(0,r.l);return s.l=r.l,s}function kP(e,n){for(var a=e.l+n,r=e.read_shift(4),s=e.read_shift(4),l=[],o=0;o!=s&&e.l<a;++o)l.push(tP(e));return l.Count=r,l.Unique=s,l}function TP(e,n){var a=Ce(8);a.write_shift(4,e.Count),a.write_shift(4,e.Unique);for(var r=[],s=0;s<e.length;++s)r[s]=nP(e[s]);var l=ea([a].concat(r));return l.parts=[a.length].concat(r.map(function(o){return o.length})),l}function CP(e,n){var a={};return a.dsst=e.read_shift(2),e.l+=n-2,a}function SP(e){var n={};n.r=e.read_shift(2),n.c=e.read_shift(2),n.cnt=e.read_shift(2)-n.c;var a=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(n.level=r&7),r&32&&(n.hidden=!0),r&64&&(n.hpt=a/20),n}function _P(e){var n=cP(e);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var a=e.read_shift(4);return a!==0}function EP(e){return e.read_shift(2),e.read_shift(4)}function MN(e,n,a){var r=0;a&&a.biff==2||(r=e.read_shift(2));var s=e.read_shift(2);a&&a.biff==2&&(r=1-(s>>15),s&=32767);var l={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[l,s]}function DP(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),d=e.read_shift(2),u=e.read_shift(2),h=e.read_shift(2);return{Pos:[n,a],Dim:[r,s],Flags:l,CurTab:o,FirstTab:d,Selected:u,TabRatio:h}}function FP(){var e=Ce(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function AP(e,n,a){if(a&&a.biff>=2&&a.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function PP(e){var n=Ce(18),a=1718;return e&&e.RTL&&(a|=64),n.write_shift(2,a),n.write_shift(4,0),n.write_shift(4,64),n.write_shift(4,0),n.write_shift(4,0),n}function LP(){}function OP(e,n,a){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(a&&a.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=wu(e,0,a),r}function IP(e,n){var a=e.name||"Arial",r=n&&n.biff==5,s=r?15+a.length:16+2*a.length,l=Ce(s);return l.write_shift(2,e.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,a.length),r||l.write_shift(1,1),l.write_shift((r?1:2)*a.length,a,r?"sbcs":"utf16le"),l}function MP(e){var n=Es(e);return n.isst=e.read_shift(4),n}function RP(e,n,a,r){var s=Ce(10);return oo(e,n,r,s),s.write_shift(4,a),s}function BP(e,n,a){a.biffguess&&a.biff==2&&(a.biff=5);var r=e.l+n,s=Es(e);a.biff==2&&e.l++;var l=ku(e,r-e.l,a);return s.val=l,s}function HP(e,n,a,r,s){var l=!s||s.biff==8,o=Ce(8+ +l+(1+l)*a.length);return oo(e,n,r,o),o.write_shift(2,a.length),l&&o.write_shift(1,1),o.write_shift((1+l)*a.length,a,l?"utf16le":"sbcs"),o}function VP(e,n,a){var r=e.read_shift(2),s=vo(e,0,a);return[r,s]}function UP(e,n,a,r){var s=a&&a.biff==5;r||(r=Ce(s?3+n.length:5+2*n.length)),r.write_shift(2,e),r.write_shift(s?1:2,n.length),s||r.write_shift(1,1),r.write_shift((s?1:2)*n.length,n,s?"sbcs":"utf16le");var l=r.length>r.l?r.slice(0,r.l):r;return l.l==null&&(l.l=l.length),l}var KP=vo;function RN(e,n,a){var r=e.l+n,s=a.biff==8||!a.biff?4:2,l=e.read_shift(s),o=e.read_shift(s),d=e.read_shift(2),u=e.read_shift(2);return e.l=r,{s:{r:l,c:d},e:{r:o,c:u}}}function zP(e,n){var a=n.biff==8||!n.biff?4:2,r=Ce(2*a+6);return r.write_shift(a,e.s.r),r.write_shift(a,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}function $P(e){var n=e.read_shift(2),a=e.read_shift(2),r=jk(e);return{r:n,c:a,ixfe:r[0],rknum:r[1]}}function GP(e,n){for(var a=e.l+n-2,r=e.read_shift(2),s=e.read_shift(2),l=[];e.l<a;)l.push(jk(e));if(e.l!==a)throw new Error("MulRK read error");var o=e.read_shift(2);if(l.length!=o-s+1)throw new Error("MulRK length mismatch");return{r,c:s,C:o,rkrec:l}}function qP(e,n){for(var a=e.l+n-2,r=e.read_shift(2),s=e.read_shift(2),l=[];e.l<a;)l.push(e.read_shift(2));if(e.l!==a)throw new Error("MulBlank read error");var o=e.read_shift(2);if(l.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r,c:s,C:o,ixfe:l}}function WP(e,n,a,r){var s={},l=e.read_shift(4),o=e.read_shift(4),d=e.read_shift(4),u=e.read_shift(2);return s.patternType=_8[d>>26],r.cellStyles&&(s.alc=l&7,s.fWrap=l>>3&1,s.alcV=l>>4&7,s.fJustLast=l>>7&1,s.trot=l>>8&255,s.cIndent=l>>16&15,s.fShrinkToFit=l>>20&1,s.iReadOrder=l>>22&2,s.fAtrNum=l>>26&1,s.fAtrFnt=l>>27&1,s.fAtrAlc=l>>28&1,s.fAtrBdr=l>>29&1,s.fAtrPat=l>>30&1,s.fAtrProt=l>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=d&127,s.icvBottom=d>>7&127,s.icvDiag=d>>14&127,s.dgDiag=d>>21&15,s.icvFore=u&127,s.icvBack=u>>7&127,s.fsxButton=u>>14&1),s}function XP(e,n,a){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,n-=6,r.data=WP(e,n,r.fStyle,a),r}function BN(e,n,a,r){var s=a&&a.biff==5;r||(r=Ce(s?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,n<<4));var l=0;return e.numFmtId>0&&s&&(l|=1024),r.write_shift(4,l),r.write_shift(4,0),s||r.write_shift(4,0),r.write_shift(2,0),r}function QP(e){e.l+=4;var n=[e.read_shift(2),e.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function YP(e){var n=Ce(8);return n.write_shift(4,0),n.write_shift(2,0),n.write_shift(2,0),n}function HN(e,n,a){var r=Es(e);(a.biff==2||n==9)&&++e.l;var s=eP(e);return r.val=s,r.t=s===!0||s===!1?"b":"e",r}function JP(e,n,a,r,s,l){var o=Ce(8);return oo(e,n,r,o),yk(a,l,o),o}function ZP(e,n,a){a.biffguess&&a.biff==2&&(a.biff=5);var r=Es(e),s=ja(e);return r.val=s,r}function eL(e,n,a,r){var s=Ce(14);return oo(e,n,r,s),io(a,s),s}var VN=dP;function tL(e,n,a){var r=e.l+n,s=e.read_shift(2),l=e.read_shift(2);if(a.sbcch=l,l==1025||l==14849)return[l,s];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var o=lo(e,l),d=[];r>e.l;)d.push(ku(e));return[l,s,o,d]}function UN(e,n,a){var r=e.read_shift(2),s,l={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return a.sbcch===14849&&(s=hP(e,n-2,a)),l.body=s||e.read_shift(n-2),typeof s=="string"&&(l.Name=s),l}var nL=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function KN(e,n,a){var r=e.l+n,s=e.read_shift(2),l=e.read_shift(1),o=e.read_shift(1),d=e.read_shift(a&&a.biff==2?1:2),u=0;(!a||a.biff>=5)&&(a.biff!=5&&(e.l+=2),u=e.read_shift(2),a.biff==5&&(e.l+=2),e.l+=4);var h=lo(e,o,a);s&32&&(h=nL[h.charCodeAt(0)]);var m=r-e.l;a&&a.biff==2&&--m;var f=r==e.l||d===0||!(m>0)?[]:g7(e,m,a,d);return{chKey:l,Name:h,itab:u,rgce:f}}function Ck(e,n,a){if(a.biff<8)return aL(e,n,a);for(var r=[],s=e.l+n,l=e.read_shift(a.biff>8?4:2);l--!==0;)r.push(uP(e,a.biff>8?12:6,a));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return r}function aL(e,n,a){e[e.l+1]==3&&e[e.l]++;var r=wu(e,n,a);return r.charCodeAt(0)==3?r.slice(1):r}function rL(e,n,a){if(a.biff<8){e.l+=n;return}var r=e.read_shift(2),s=e.read_shift(2),l=lo(e,r,a),o=lo(e,s,a);return[l,o]}function sL(e,n,a){var r=kk(e);e.l++;var s=e.read_shift(1);return n-=8,[y7(e,n,a),s,r]}function zN(e,n,a){var r=xP(e);switch(a.biff){case 2:e.l++,n-=7;break;case 3:case 4:e.l+=2,n-=8;break;default:e.l+=6,n-=12}return[r,f7(e,n,a)]}function iL(e){var n=e.read_shift(4)!==0,a=e.read_shift(4)!==0,r=e.read_shift(4);return[n,a,r]}function lL(e,n,a){if(!(a.biff<8)){var r=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),d=vo(e,0,a);return a.biff<8&&e.read_shift(1),[{r,c:s},d,o,l]}}function oL(e,n,a){return lL(e,n,a)}function cL(e,n){for(var a=[],r=e.read_shift(2);r--;)a.push(sx(e));return a}function dL(e){var n=Ce(2+e.length*8);n.write_shift(2,e.length);for(var a=0;a<e.length;++a)wk(e[a],n);return n}function uL(e,n,a){if(a&&a.biff<8)return xL(e,n,a);var r=Tk(e),s=gP(e,n-22,r[1]);return{cmo:r,ft:s}}var hL={8:function(e,n){var a=e.l+n;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=a,{fmt:r}}};function xL(e,n,a){e.l+=4;var r=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,n-=36;var o=[];return o.push((hL[r]||ka)(e,n,a)),{cmo:[s,r,l],ft:o}}function mL(e,n,a){var r=e.l,s="";try{e.l+=4;var l=(a.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:o=aP(e,6,a);var d=e.read_shift(2);e.read_shift(2),On(e,2);var u=e.read_shift(2);e.l+=u;for(var h=1;h<e.lens.length-1;++h){if(e.l-r!=e.lens[h])throw new Error("TxO: bad continue record");var m=e[e.l],f=lo(e,e.lens[h+1]-e.lens[h]-1);if(s+=f,s.length>=(m?d:2*d))break}if(s.length!==d&&s.length!==d*2)throw new Error("cchText: "+d+" != "+s.length);return e.l=r+n,{t:s}}catch{return e.l=r+n,{t:s}}}function fL(e,n){var a=sx(e);e.l+=16;var r=lP(e,n-24);return[a,r]}function pL(e){var n=Ce(24),a=gn(e[0]);n.write_shift(2,a.r),n.write_shift(2,a.r),n.write_shift(2,a.c),n.write_shift(2,a.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)n.write_shift(1,parseInt(r[s],16));return ea([n,oP(e[1])])}function gL(e,n){e.read_shift(2);var a=sx(e),r=e.read_shift((n-10)/2,"dbcs-cont");return r=r.replace(Ia,""),[a,r]}function yL(e){var n=e[1].Tooltip,a=Ce(10+2*(n.length+1));a.write_shift(2,2048);var r=gn(e[0]);a.write_shift(2,r.r),a.write_shift(2,r.r),a.write_shift(2,r.c),a.write_shift(2,r.c);for(var s=0;s<n.length;++s)a.write_shift(2,n.charCodeAt(s));return a.write_shift(2,0),a}function vL(e){var n=[0,0],a;return a=e.read_shift(2),n[0]=_N[a]||a,a=e.read_shift(2),n[1]=_N[a]||a,n}function bL(e){return e||(e=Ce(4)),e.write_shift(2,1),e.write_shift(2,1),e}function NL(e){for(var n=e.read_shift(2),a=[];n-- >0;)a.push(Nk(e));return a}function jL(e){for(var n=e.read_shift(2),a=[];n-- >0;)a.push(Nk(e));return a}function wL(e){e.l+=2;var n={cxfs:0,crc:0};return n.cxfs=e.read_shift(2),n.crc=e.read_shift(4),n}function Sk(e,n,a){if(!a.cellStyles)return ka(e,n);var r=a&&a.biff>=12?4:2,s=e.read_shift(r),l=e.read_shift(r),o=e.read_shift(r),d=e.read_shift(r),u=e.read_shift(2);r==2&&(e.l+=2);var h={s,e:l,w:o,ixfe:d,flags:u};return(a.biff>=5||!a.biff)&&(h.level=u>>8&7),h}function kL(e,n){var a=Ce(12);a.write_shift(2,n),a.write_shift(2,n),a.write_shift(2,e.width*256),a.write_shift(2,0);var r=0;return e.hidden&&(r|=1),a.write_shift(1,r),r=e.level||0,a.write_shift(1,r),a.write_shift(2,0),a}function TL(e,n){var a={};return n<32||(e.l+=16,a.header=ja(e),a.footer=ja(e),e.l+=2),a}function CL(e,n,a){var r={area:!1};if(a.biff!=5)return e.l+=n,r;var s=e.read_shift(1);return e.l+=3,s&16&&(r.area=!0),r}function SL(e){for(var n=Ce(2*e),a=0;a<e;++a)n.write_shift(2,a+1);return n}var _L=Es,EL=gk,DL=ku;function FL(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(4),s={fmt:n,env:a,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,s}function AL(e,n,a){a.biffguess&&a.biff==5&&(a.biff=2);var r=Es(e);++e.l;var s=vo(e,n-7,a);return r.t="str",r.val=s,r}function PL(e){var n=Es(e);++e.l;var a=ja(e);return n.t="n",n.val=a,n}function LL(e,n,a){var r=Ce(15);return _u(r,e,n),r.write_shift(8,a,"f"),r}function OL(e){var n=Es(e);++e.l;var a=e.read_shift(2);return n.t="n",n.val=a,n}function IL(e,n,a){var r=Ce(9);return _u(r,e,n),r.write_shift(2,a),r}function ML(e){var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,"sbcs-cont")}function RL(e,n){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=n-13}function BL(e,n,a){var r=e.l+n,s=Es(e),l=e.read_shift(2),o=lo(e,l,a);return e.l=r,s.t="str",s.val=o,s}var HL=[2,3,48,49,131,139,140,245],_p=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=nx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function a(d,u){var h=[],m=rl(1);switch(u.type){case"base64":m=cr(hr(d));break;case"binary":m=cr(d);break;case"buffer":case"array":m=d;break}oa(m,0);var f=m.read_shift(1),p=!!(f&136),b=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:b=!0,p=!0;break;case 49:b=!0,p=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var y=0,N=521;f==2&&(y=m.read_shift(2)),m.l+=3,f!=2&&(y=m.read_shift(4)),y>1048576&&(y=1e6),f!=2&&(N=m.read_shift(2));var C=m.read_shift(2),T=u.codepage||1252;f!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(T=e[m[m.l]]),m.l+=1,m.l+=2),g&&(m.l+=36);for(var S=[],k={},_=Math.min(m.length,f==2?521:N-10-(b?264:0)),P=g?32:11;m.l<_&&m[m.l]!=13;)switch(k={},k.name=Xd.utils.decode(T,m.slice(m.l,m.l+P)).replace(/[\u0000\r\n].*$/g,""),m.l+=P,k.type=String.fromCharCode(m.read_shift(1)),f!=2&&!g&&(k.offset=m.read_shift(4)),k.len=m.read_shift(1),f==2&&(k.offset=m.read_shift(2)),k.dec=m.read_shift(1),k.name.length&&S.push(k),f!=2&&(m.l+=g?13:14),k.type){case"B":(!b||k.len!=8)&&u.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(m[m.l]!==13&&(m.l=N-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=N;var j=0,A=0;for(h[0]=[],A=0;A!=S.length;++A)h[0][A]=S[A].name;for(;y-- >0;){if(m[m.l]===42){m.l+=C;continue}for(++m.l,h[++j]=[],A=0,A=0;A!=S.length;++A){var L=m.slice(m.l,m.l+S[A].len);m.l+=S[A].len,oa(L,0);var W=Xd.utils.decode(T,L);switch(S[A].type){case"C":W.trim().length&&(h[j][A]=W.replace(/\s+$/,""));break;case"D":W.length===8?h[j][A]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):h[j][A]=W;break;case"F":h[j][A]=parseFloat(W.trim());break;case"+":case"I":h[j][A]=g?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":h[j][A]=!0;break;case"N":case"F":h[j][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));h[j][A]="##MEMO##"+(g?parseInt(W.trim(),10):L.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(h[j][A]=+W||0);break;case"@":h[j][A]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":h[j][A]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":h[j][A]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[j][A]=-L.read_shift(-8,"f");break;case"B":if(b&&S[A].len==8){h[j][A]=L.read_shift(8,"f");break}case"G":case"P":L.l+=S[A].len;break;case"0":if(S[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[A].type)}}}if(f!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return u&&u.sheetRows&&(h=h.slice(0,u.sheetRows)),u.DBF=S,h}function r(d,u){var h=u||{};h.dateNF||(h.dateNF="yyyymmdd");var m=Oc(a(d,h),h);return m["!cols"]=h.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete h.DBF,m}function s(d,u){try{return ul(r(d,u),u)}catch(h){if(u&&u.WTF)throw h}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function o(d,u){var h=u||{};if(+h.codepage>=0&&Yr(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var m=Za(),f=I0(d,{header:1,raw:!0,cellDates:!0}),p=f[0],b=f.slice(1),g=d["!cols"]||[],y=0,N=0,C=0,T=1;for(y=0;y<p.length;++y){if(((g[y]||{}).DBF||{}).name){p[y]=g[y].DBF.name,++C;continue}if(p[y]!=null){if(++C,typeof p[y]=="number"&&(p[y]=p[y].toString(10)),typeof p[y]!="string")throw new Error("DBF Invalid column name "+p[y]+" |"+typeof p[y]+"|");if(p.indexOf(p[y])!==y){for(N=0;N<1024;++N)if(p.indexOf(p[y]+"_"+N)==-1){p[y]+="_"+N;break}}}}var S=Dt(d["!ref"]),k=[],_=[],P=[];for(y=0;y<=S.e.c-S.s.c;++y){var j="",A="",L=0,W=[];for(N=0;N<b.length;++N)b[N][y]!=null&&W.push(b[N][y]);if(W.length==0||p[y]==null){k[y]="?";continue}for(N=0;N<W.length;++N){switch(typeof W[N]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=W[N]instanceof Date?"D":"C";break;default:A="C"}L=Math.max(L,String(W[N]).length),j=j&&j!=A?"C":A}L>250&&(L=250),A=((g[y]||{}).DBF||{}).type,A=="C"&&g[y].DBF.len>L&&(L=g[y].DBF.len),j=="B"&&A=="N"&&(j="N",P[y]=g[y].DBF.dec,L=g[y].DBF.len),_[y]=j=="C"||A=="N"?L:l[j]||0,T+=_[y],k[y]=j}var R=m.next(32);for(R.write_shift(4,318902576),R.write_shift(4,b.length),R.write_shift(2,296+32*C),R.write_shift(2,T),y=0;y<4;++y)R.write_shift(4,0);for(R.write_shift(4,0|(+n[pw]||3)<<8),y=0,N=0;y<p.length;++y)if(p[y]!=null){var M=m.next(32),q=(p[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,q,"sbcs"),M.write_shift(1,k[y]=="?"?"C":k[y],"sbcs"),M.write_shift(4,N),M.write_shift(1,_[y]||l[k[y]]||0),M.write_shift(1,P[y]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),N+=_[y]||l[k[y]]||0}var ee=m.next(264);for(ee.write_shift(4,13),y=0;y<65;++y)ee.write_shift(4,0);for(y=0;y<b.length;++y){var z=m.next(T);for(z.write_shift(1,0),N=0;N<p.length;++N)if(p[N]!=null)switch(k[N]){case"L":z.write_shift(1,b[y][N]==null?63:b[y][N]?84:70);break;case"B":z.write_shift(8,b[y][N]||0,"f");break;case"N":var fe="0";for(typeof b[y][N]=="number"&&(fe=b[y][N].toFixed(P[N]||0)),C=0;C<_[N]-fe.length;++C)z.write_shift(1,32);z.write_shift(1,fe,"sbcs");break;case"D":b[y][N]?(z.write_shift(4,("0000"+b[y][N].getFullYear()).slice(-4),"sbcs"),z.write_shift(2,("00"+(b[y][N].getMonth()+1)).slice(-2),"sbcs"),z.write_shift(2,("00"+b[y][N].getDate()).slice(-2),"sbcs")):z.write_shift(8,"00000000","sbcs");break;case"C":var ae=String(b[y][N]!=null?b[y][N]:"").slice(0,_[N]);for(z.write_shift(1,ae,"sbcs"),C=0;C<_[N]-ae.length;++C)z.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:s,to_sheet:r,from_sheet:o}})(),_k=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+jn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(p,b){var g=e[b];return typeof g=="number"?tN(g):g},r=function(p,b,g){var y=b.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return y==59?p:tN(y)};e["|"]=254;function s(p,b){switch(b.type){case"base64":return l(hr(p),b);case"binary":return l(p,b);case"buffer":return l(bt&&Buffer.isBuffer(p)?p.toString("binary"):dl(p),b);case"array":return l(so(p),b)}throw new Error("Unrecognized type "+b.type)}function l(p,b){var g=p.split(/[\n\r]+/),y=-1,N=-1,C=0,T=0,S=[],k=[],_=null,P={},j=[],A=[],L=[],W=0,R;for(+b.codepage>=0&&Yr(+b.codepage);C!==g.length;++C){W=0;var M=g[C].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(n,a),q=M.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),ee=q[0],z;if(M.length>0)switch(ee){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&k.push(M.slice(3).replace(/;;/g,";"));break;case"C":var fe=!1,ae=!1,J=!1,G=!1,he=-1,H=-1;for(T=1;T<q.length;++T)switch(q[T].charAt(0)){case"A":break;case"X":N=parseInt(q[T].slice(1))-1,ae=!0;break;case"Y":for(y=parseInt(q[T].slice(1))-1,ae||(N=0),R=S.length;R<=y;++R)S[R]=[];break;case"K":z=q[T].slice(1),z.charAt(0)==='"'?z=z.slice(1,z.length-1):z==="TRUE"?z=!0:z==="FALSE"?z=!1:isNaN(Zr(z))?isNaN(Tc(z).getDate())||(z=cn(z)):(z=Zr(z),_!==null&&Pc(_)&&(z=rx(z))),fe=!0;break;case"E":G=!0;var F=ic(q[T].slice(1),{r:y,c:N});S[y][N]=[S[y][N],F];break;case"S":J=!0,S[y][N]=[S[y][N],"S5S"];break;case"G":break;case"R":he=parseInt(q[T].slice(1))-1;break;case"C":H=parseInt(q[T].slice(1))-1;break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+M)}if(fe&&(S[y][N]&&S[y][N].length==2?S[y][N][0]=z:S[y][N]=z,_=null),J){if(G)throw new Error("SYLK shared formula cannot have own formula");var I=he>-1&&S[he][H];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");S[y][N][1]=Gk(I[1],{r:y-he,c:N-H})}break;case"F":var O=0;for(T=1;T<q.length;++T)switch(q[T].charAt(0)){case"X":N=parseInt(q[T].slice(1))-1,++O;break;case"Y":for(y=parseInt(q[T].slice(1))-1,R=S.length;R<=y;++R)S[R]=[];break;case"M":W=parseInt(q[T].slice(1))/20;break;case"F":break;case"G":break;case"P":_=k[parseInt(q[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=q[T].slice(1).split(" "),R=parseInt(L[0],10);R<=parseInt(L[1],10);++R)W=parseInt(L[2],10),A[R-1]=W===0?{hidden:!0}:{wch:W},sl(A[R-1]);break;case"C":N=parseInt(q[T].slice(1))-1,A[N]||(A[N]={});break;case"R":y=parseInt(q[T].slice(1))-1,j[y]||(j[y]={}),W>0?(j[y].hpt=W,j[y].hpx=Sc(W)):W===0&&(j[y].hidden=!0);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+M)}O<1&&(_=null);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+M)}}return j.length>0&&(P["!rows"]=j),A.length>0&&(P["!cols"]=A),b&&b.sheetRows&&(S=S.slice(0,b.sheetRows)),[S,P]}function o(p,b){var g=s(p,b),y=g[0],N=g[1],C=Oc(y,b);return jn(N).forEach(function(T){C[T]=N[T]}),C}function d(p,b){return ul(o(p,b),b)}function u(p,b,g,y){var N="C;Y"+(g+1)+";X"+(y+1)+";K";switch(p.t){case"n":N+=p.v||0,p.f&&!p.F&&(N+=";E"+Vg(p.f,{r:g,c:y}));break;case"b":N+=p.v?"TRUE":"FALSE";break;case"e":N+=p.w||p.v;break;case"d":N+='"'+(p.w||p.v)+'"';break;case"s":N+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return N}function h(p,b){b.forEach(function(g,y){var N="F;W"+(y+1)+" "+(y+1)+" ";g.hidden?N+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=au(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=ru(g.wpx)),typeof g.wch=="number"&&(N+=Math.round(g.wch))),N.charAt(N.length-1)!=" "&&p.push(N)})}function m(p,b){b.forEach(function(g,y){var N="F;";g.hidden?N+="M0;":g.hpt?N+="M"+20*g.hpt+";":g.hpx&&(N+="M"+20*su(g.hpx)+";"),N.length>2&&p.push(N+"R"+(y+1))})}function f(p,b){var g=["ID;PWXL;N;E"],y=[],N=Dt(p["!ref"]),C,T=Array.isArray(p),S=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),p["!cols"]&&h(g,p["!cols"]),p["!rows"]&&m(g,p["!rows"]),g.push("B;Y"+(N.e.r-N.s.r+1)+";X"+(N.e.c-N.s.c+1)+";D"+[N.s.c,N.s.r,N.e.c,N.e.r].join(" "));for(var k=N.s.r;k<=N.e.r;++k)for(var _=N.s.c;_<=N.e.c;++_){var P=dt({r:k,c:_});C=T?(p[k]||[])[_]:p[P],!(!C||C.v==null&&(!C.f||C.F))&&y.push(u(C,p,k,_))}return g.join(S)+S+y.join(S)+S+"E"+S}return{to_workbook:d,to_sheet:o,from_sheet:f}})(),Ek=(function(){function e(l,o){switch(o.type){case"base64":return n(hr(l),o);case"binary":return n(l,o);case"buffer":return n(bt&&Buffer.isBuffer(l)?l.toString("binary"):dl(l),o);case"array":return n(so(l),o)}throw new Error("Unrecognized type "+o.type)}function n(l,o){for(var d=l.split(`
`),u=-1,h=-1,m=0,f=[];m!==d.length;++m){if(d[m].trim()==="BOT"){f[++u]=[],h=0;continue}if(!(u<0)){var p=d[m].trim().split(","),b=p[0],g=p[1];++m;for(var y=d[m]||"";(y.match(/["]/g)||[]).length&1&&m<d.length-1;)y+=`
`+d[++m];switch(y=y.trim(),+b){case-1:if(y==="BOT"){f[++u]=[],h=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?f[u][h]=!0:y==="FALSE"?f[u][h]=!1:isNaN(Zr(g))?isNaN(Tc(g).getDate())?f[u][h]=g:f[u][h]=cn(g):f[u][h]=Zr(g),++h;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),f[u][h++]=y!==""?y:null;break}if(y==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function a(l,o){return Oc(e(l,o),o)}function r(l,o){return ul(a(l,o),o)}var s=(function(){var l=function(u,h,m,f,p){u.push(h),u.push(m+","+f),u.push('"'+p.replace(/"/g,'""')+'"')},o=function(u,h,m,f){u.push(h+","+m),u.push(h==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(u){var h=[],m=Dt(u["!ref"]),f,p=Array.isArray(u);l(h,"TABLE",0,1,"sheetjs"),l(h,"VECTORS",0,m.e.r-m.s.r+1,""),l(h,"TUPLES",0,m.e.c-m.s.c+1,""),l(h,"DATA",0,0,"");for(var b=m.s.r;b<=m.e.r;++b){o(h,-1,0,"BOT");for(var g=m.s.c;g<=m.e.c;++g){var y=dt({r:b,c:g});if(f=p?(u[b]||[])[g]:u[y],!f){o(h,1,0,"");continue}switch(f.t){case"n":var N=f.w;!N&&f.v!=null&&(N=f.v),N==null?f.f&&!f.F?o(h,1,0,"="+f.f):o(h,1,0,""):o(h,0,N,"V");break;case"b":o(h,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(h,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Mr(f.z||ct[14],zn(cn(f.v)))),o(h,0,f.w,"V");break;default:o(h,1,0,"")}}}o(h,-1,0,"EOD");var C=`\r
`,T=h.join(C);return T}})();return{to_workbook:r,to_sheet:a,from_sheet:s}})(),Dk=(function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function a(f,p){for(var b=f.split(`
`),g=-1,y=-1,N=0,C=[];N!==b.length;++N){var T=b[N].trim().split(":");if(T[0]==="cell"){var S=gn(T[1]);if(C.length<=S.r)for(g=C.length;g<=S.r;++g)C[g]||(C[g]=[]);switch(g=S.r,y=S.c,T[2]){case"t":C[g][y]=e(T[3]);break;case"v":C[g][y]=+T[3];break;case"vtf":var k=T[T.length-1];case"vtc":switch(T[3]){case"nl":C[g][y]=!!+T[4];break;default:C[g][y]=+T[4];break}T[2]=="vtf"&&(C[g][y]=[C[g][y],k])}}}return p&&p.sheetRows&&(C=C.slice(0,p.sheetRows)),C}function r(f,p){return Oc(a(f,p),p)}function s(f,p){return ul(r(f,p),p)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,d=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function h(f){if(!f||!f["!ref"])return"";for(var p=[],b=[],g,y="",N=er(f["!ref"]),C=Array.isArray(f),T=N.s.r;T<=N.e.r;++T)for(var S=N.s.c;S<=N.e.c;++S)if(y=dt({r:T,c:S}),g=C?(f[T]||[])[S]:f[y],!(!g||g.v==null||g.t==="z")){switch(b=["cell",y,"t"],g.t){case"s":case"str":b.push(n(g.v));break;case"n":g.f?(b[2]="vtf",b[3]="n",b[4]=g.v,b[5]=n(g.f)):(b[2]="v",b[3]=g.v);break;case"b":b[2]="vt"+(g.f?"f":"c"),b[3]="nl",b[4]=g.v?"1":"0",b[5]=n(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var k=zn(cn(g.v));b[2]="vtc",b[3]="nd",b[4]=""+k,b[5]=g.w||Mr(g.z||ct[14],k);break;case"e":continue}p.push(b.join(":"))}return p.push("sheet:c:"+(N.e.c-N.s.c+1)+":r:"+(N.e.r-N.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function m(f){return[l,o,d,o,h(f),u].join(`
`)}return{to_workbook:s,to_sheet:r,from_sheet:m}})(),Cc=(function(){function e(m,f,p,b,g){g.raw?f[p][b]=m:m===""||(m==="TRUE"?f[p][b]=!0:m==="FALSE"?f[p][b]=!1:isNaN(Zr(m))?isNaN(Tc(m).getDate())?f[p][b]=m:f[p][b]=cn(m):f[p][b]=Zr(m))}function n(m,f){var p=f||{},b=[];if(!m||m.length===0)return b;for(var g=m.split(/[\r\n]/),y=g.length-1;y>=0&&g[y].length===0;)--y;for(var N=10,C=0,T=0;T<=y;++T)C=g[T].indexOf(" "),C==-1?C=g[T].length:C++,N=Math.max(N,C);for(T=0;T<=y;++T){b[T]=[];var S=0;for(e(g[T].slice(0,N).trim(),b,T,S,p),S=1;S<=(g[T].length-N)/10+1;++S)e(g[T].slice(N+(S-1)*10,N+S*10).trim(),b,T,S,p)}return p.sheetRows&&(b=b.slice(0,p.sheetRows)),b}var a={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function s(m){for(var f={},p=!1,b=0,g=0;b<m.length;++b)(g=m.charCodeAt(b))==34?p=!p:!p&&g in a&&(f[g]=(f[g]||0)+1);g=[];for(b in f)Object.prototype.hasOwnProperty.call(f,b)&&g.push([f[b],b]);if(!g.length){f=r;for(b in f)Object.prototype.hasOwnProperty.call(f,b)&&g.push([f[b],b])}return g.sort(function(y,N){return y[0]-N[0]||r[y[1]]-r[N[1]]}),a[g.pop()[1]]||44}function l(m,f){var p=f||{},b="",g=p.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(b=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(b=m.charAt(4),m=m.slice(6)):b=s(m.slice(0,1024)):p&&p.FS?b=p.FS:b=s(m.slice(0,1024));var N=0,C=0,T=0,S=0,k=0,_=b.charCodeAt(0),P=!1,j=0,A=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var L=p.dateNF!=null?CA(p.dateNF):null;function W(){var R=m.slice(S,k),M={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)M.t="z";else if(p.raw)M.t="s",M.v=R;else if(R.trim().length===0)M.t="s",M.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(M.t="s",M.v=R.slice(2,-1).replace(/""/g,'"')):tM(R)?(M.t="n",M.f=R.slice(1)):(M.t="s",M.v=R);else if(R=="TRUE")M.t="b",M.v=!0;else if(R=="FALSE")M.t="b",M.v=!1;else if(!isNaN(T=Zr(R)))M.t="n",p.cellText!==!1&&(M.w=R),M.v=T;else if(!isNaN(Tc(R).getDate())||L&&R.match(L)){M.z=p.dateNF||ct[14];var q=0;L&&R.match(L)&&(R=SA(R,p.dateNF,R.match(L)||[]),q=1),p.cellDates?(M.t="d",M.v=cn(R,q)):(M.t="n",M.v=zn(cn(R,q))),p.cellText!==!1&&(M.w=Mr(M.z,M.v instanceof Date?zn(M.v):M.v)),p.cellNF||delete M.z}else M.t="s",M.v=R;if(M.t=="z"||(p.dense?(g[N]||(g[N]=[]),g[N][C]=M):g[dt({c:C,r:N})]=M),S=k+1,A=m.charCodeAt(S),y.e.c<C&&(y.e.c=C),y.e.r<N&&(y.e.r=N),j==_)++C;else if(C=0,++N,p.sheetRows&&p.sheetRows<=N)return!0}e:for(;k<m.length;++k)switch(j=m.charCodeAt(k)){case 34:A===34&&(P=!P);break;case _:case 10:case 13:if(!P&&W())break e;break}return k-S>0&&W(),g["!ref"]=pt(y),g}function o(m,f){return!(f&&f.PRN)||f.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?l(m,f):Oc(n(m,f),f)}function d(m,f){var p="",b=f.type=="string"?[0,0,0,0]:Qg(m,f);switch(f.type){case"base64":p=hr(m);break;case"binary":p=m;break;case"buffer":f.codepage==65001?p=m.toString("utf8"):f.codepage&&typeof Xd<"u"||(p=bt&&Buffer.isBuffer(m)?m.toString("binary"):dl(m));break;case"array":p=so(m);break;case"string":p=m;break;default:throw new Error("Unrecognized type "+f.type)}return b[0]==239&&b[1]==187&&b[2]==191?p=Xt(p.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?p=Xt(p):f.type=="binary"&&typeof Xd<"u",p.slice(0,19)=="socialcalc:version:"?Dk.to_sheet(f.type=="string"?p:Xt(p),f):o(p,f)}function u(m,f){return ul(d(m,f),f)}function h(m){for(var f=[],p=Dt(m["!ref"]),b,g=Array.isArray(m),y=p.s.r;y<=p.e.r;++y){for(var N=[],C=p.s.c;C<=p.e.c;++C){var T=dt({r:y,c:C});if(b=g?(m[y]||[])[C]:m[T],!b||b.v==null){N.push("          ");continue}for(var S=(b.w||(li(b),b.w)||"").slice(0,10);S.length<10;)S+=" ";N.push(S+(C===0?" ":""))}f.push(N.join(""))}return f.join(`
`)}return{to_workbook:u,to_sheet:d,from_sheet:h}})();function VL(e,n){var a=n||{},r=!!a.WTF;a.WTF=!0;try{var s=_k.to_workbook(e,a);return a.WTF=r,s}catch(l){if(a.WTF=r,!l.message.match(/SYLK bad record ID/)&&r)throw l;return Cc.to_workbook(e,n)}}var Jl=(function(){function e(F,I,O){if(F){oa(F,F.l||0);for(var V=O.Enum||he;F.l<F.length;){var te=F.read_shift(2),pe=V[te]||V[65535],U=F.read_shift(2),ce=F.l+U,Q=pe.f&&pe.f(F,U,O);if(F.l=ce,I(Q,pe,te))return}}}function n(F,I){switch(I.type){case"base64":return a(cr(hr(F)),I);case"binary":return a(cr(F),I);case"buffer":case"array":return a(F,I)}throw"Unsupported type "+I.type}function a(F,I){if(!F)return F;var O=I||{},V=O.dense?[]:{},te="Sheet1",pe="",U=0,ce={},Q=[],oe=[],X={s:{r:0,c:0},e:{r:0,c:0}},ve=O.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)O.Enum=he,e(F,function(Be,Gt,wn){switch(wn){case 0:O.vers=Be,Be>=4096&&(O.qpro=!0);break;case 6:X=Be;break;case 204:Be&&(pe=Be);break;case 222:pe=Be;break;case 15:case 51:O.qpro||(Be[1].v=Be[1].v.slice(1));case 13:case 14:case 16:wn==14&&(Be[2]&112)==112&&(Be[2]&15)>1&&(Be[2]&15)<15&&(Be[1].z=O.dateNF||ct[14],O.cellDates&&(Be[1].t="d",Be[1].v=rx(Be[1].v))),O.qpro&&Be[3]>U&&(V["!ref"]=pt(X),ce[te]=V,Q.push(te),V=O.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},U=Be[3],te=pe||"Sheet"+(U+1),pe="");var kn=O.dense?(V[Be[0].r]||[])[Be[0].c]:V[dt(Be[0])];if(kn){kn.t=Be[1].t,kn.v=Be[1].v,Be[1].z!=null&&(kn.z=Be[1].z),Be[1].f!=null&&(kn.f=Be[1].f);break}O.dense?(V[Be[0].r]||(V[Be[0].r]=[]),V[Be[0].r][Be[0].c]=Be[1]):V[dt(Be[0])]=Be[1];break}},O);else if(F[2]==26||F[2]==14)O.Enum=H,F[2]==14&&(O.qpro=!0,F.l=0),e(F,function(Be,Gt,wn){switch(wn){case 204:te=Be;break;case 22:Be[1].v=Be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Be[3]>U&&(V["!ref"]=pt(X),ce[te]=V,Q.push(te),V=O.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},U=Be[3],te="Sheet"+(U+1)),ve>0&&Be[0].r>=ve)break;O.dense?(V[Be[0].r]||(V[Be[0].r]=[]),V[Be[0].r][Be[0].c]=Be[1]):V[dt(Be[0])]=Be[1],X.e.c<Be[0].c&&(X.e.c=Be[0].c),X.e.r<Be[0].r&&(X.e.r=Be[0].r);break;case 27:Be[14e3]&&(oe[Be[14e3][0]]=Be[14e3][1]);break;case 1537:oe[Be[0]]=Be[1],Be[0]==U&&(te=Be[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(V["!ref"]=pt(X),ce[pe||te]=V,Q.push(pe||te),!oe.length)return{SheetNames:Q,Sheets:ce};for(var Ke={},at=[],et=0;et<oe.length;++et)ce[Q[et]]?(at.push(oe[et]||Q[et]),Ke[oe[et]]=ce[oe[et]]||ce[Q[et]]):(at.push(oe[et]),Ke[oe[et]]={"!ref":"A1"});return{SheetNames:at,Sheets:Ke}}function r(F,I){var O=I||{};if(+O.codepage>=0&&Yr(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var V=Za(),te=Dt(F["!ref"]),pe=Array.isArray(F),U=[];Ue(V,0,l(1030)),Ue(V,6,u(te));for(var ce=Math.min(te.e.r,8191),Q=te.s.r;Q<=ce;++Q)for(var oe=Dn(Q),X=te.s.c;X<=te.e.c;++X){Q===te.s.r&&(U[X]=pn(X));var ve=U[X]+oe,Ke=pe?(F[Q]||[])[X]:F[ve];if(!(!Ke||Ke.t=="z"))if(Ke.t=="n")(Ke.v|0)==Ke.v&&Ke.v>=-32768&&Ke.v<=32767?Ue(V,13,b(Q,X,Ke.v)):Ue(V,14,y(Q,X,Ke.v));else{var at=li(Ke);Ue(V,15,f(Q,X,at.slice(0,239)))}}return Ue(V,1),V.end()}function s(F,I){var O=I||{};if(+O.codepage>=0&&Yr(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var V=Za();Ue(V,0,o(F));for(var te=0,pe=0;te<F.SheetNames.length;++te)(F.Sheets[F.SheetNames[te]]||{})["!ref"]&&Ue(V,27,G(F.SheetNames[te],pe++));var U=0;for(te=0;te<F.SheetNames.length;++te){var ce=F.Sheets[F.SheetNames[te]];if(!(!ce||!ce["!ref"])){for(var Q=Dt(ce["!ref"]),oe=Array.isArray(ce),X=[],ve=Math.min(Q.e.r,8191),Ke=Q.s.r;Ke<=ve;++Ke)for(var at=Dn(Ke),et=Q.s.c;et<=Q.e.c;++et){Ke===Q.s.r&&(X[et]=pn(et));var Be=X[et]+at,Gt=oe?(ce[Ke]||[])[et]:ce[Be];if(!(!Gt||Gt.t=="z"))if(Gt.t=="n")Ue(V,23,W(Ke,et,U,Gt.v));else{var wn=li(Gt);Ue(V,22,j(Ke,et,U,wn.slice(0,239)))}}++U}}return Ue(V,1),V.end()}function l(F){var I=Ce(2);return I.write_shift(2,F),I}function o(F){var I=Ce(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var O=0,V=0,te=0,pe=0;pe<F.SheetNames.length;++pe){var U=F.SheetNames[pe],ce=F.Sheets[U];if(!(!ce||!ce["!ref"])){++te;var Q=er(ce["!ref"]);O<Q.e.r&&(O=Q.e.r),V<Q.e.c&&(V=Q.e.c)}}return O>8191&&(O=8191),I.write_shift(2,O),I.write_shift(1,te),I.write_shift(1,V),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function d(F,I,O){var V={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&O.qpro?(V.s.c=F.read_shift(1),F.l++,V.s.r=F.read_shift(2),V.e.c=F.read_shift(1),F.l++,V.e.r=F.read_shift(2),V):(V.s.c=F.read_shift(2),V.s.r=F.read_shift(2),I==12&&O.qpro&&(F.l+=2),V.e.c=F.read_shift(2),V.e.r=F.read_shift(2),I==12&&O.qpro&&(F.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function u(F){var I=Ce(8);return I.write_shift(2,F.s.c),I.write_shift(2,F.s.r),I.write_shift(2,F.e.c),I.write_shift(2,F.e.r),I}function h(F,I,O){var V=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(V[0].c=F.read_shift(1),V[3]=F.read_shift(1),V[0].r=F.read_shift(2),F.l+=2):(V[2]=F.read_shift(1),V[0].c=F.read_shift(2),V[0].r=F.read_shift(2)),V}function m(F,I,O){var V=F.l+I,te=h(F,I,O);if(te[1].t="s",O.vers==20768){F.l++;var pe=F.read_shift(1);return te[1].v=F.read_shift(pe,"utf8"),te}return O.qpro&&F.l++,te[1].v=F.read_shift(V-F.l,"cstr"),te}function f(F,I,O){var V=Ce(7+O.length);V.write_shift(1,255),V.write_shift(2,I),V.write_shift(2,F),V.write_shift(1,39);for(var te=0;te<V.length;++te){var pe=O.charCodeAt(te);V.write_shift(1,pe>=128?95:pe)}return V.write_shift(1,0),V}function p(F,I,O){var V=h(F,I,O);return V[1].v=F.read_shift(2,"i"),V}function b(F,I,O){var V=Ce(7);return V.write_shift(1,255),V.write_shift(2,I),V.write_shift(2,F),V.write_shift(2,O,"i"),V}function g(F,I,O){var V=h(F,I,O);return V[1].v=F.read_shift(8,"f"),V}function y(F,I,O){var V=Ce(13);return V.write_shift(1,255),V.write_shift(2,I),V.write_shift(2,F),V.write_shift(8,O,"f"),V}function N(F,I,O){var V=F.l+I,te=h(F,I,O);if(te[1].v=F.read_shift(8,"f"),O.qpro)F.l=V;else{var pe=F.read_shift(2);k(F.slice(F.l,F.l+pe),te),F.l+=pe}return te}function C(F,I,O){var V=I&32768;return I&=-32769,I=(V?F:0)+(I>=8192?I-16384:I),(V?"":"$")+(O?pn(I):Dn(I))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(F,I){oa(F,0);for(var O=[],V=0,te="",pe="",U="",ce="";F.l<F.length;){var Q=F[F.l++];switch(Q){case 0:O.push(F.read_shift(8,"f"));break;case 1:pe=C(I[0].c,F.read_shift(2),!0),te=C(I[0].r,F.read_shift(2),!1),O.push(pe+te);break;case 2:{var oe=C(I[0].c,F.read_shift(2),!0),X=C(I[0].r,F.read_shift(2),!1);pe=C(I[0].c,F.read_shift(2),!0),te=C(I[0].r,F.read_shift(2),!1),O.push(oe+X+":"+pe+te)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(F.read_shift(2));break;case 6:{for(var ve="";Q=F[F.l++];)ve+=String.fromCharCode(Q);O.push('"'+ve.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:ce=O.pop(),U=O.pop(),O.push(["AND","OR"][Q-20]+"("+U+","+ce+")");break;default:if(Q<32&&S[Q])ce=O.pop(),U=O.pop(),O.push(U+S[Q]+ce);else if(T[Q]){if(V=T[Q][1],V==69&&(V=F[F.l++]),V>O.length){console.error("WK1 bad formula parse 0x"+Q.toString(16)+":|"+O.join("|")+"|");return}var Ke=O.slice(-V);O.length-=V,O.push(T[Q][0]+"("+Ke.join(",")+")")}else return Q<=7?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=24?console.error("WK1 unsupported op "+Q.toString(16)):Q<=30?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=115?console.error("WK1 unsupported function opcode "+Q.toString(16)):console.error("WK1 unrecognized opcode "+Q.toString(16))}}O.length==1?I[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function _(F){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=F.read_shift(2),I[3]=F[F.l++],I[0].c=F[F.l++],I}function P(F,I){var O=_(F);return O[1].t="s",O[1].v=F.read_shift(I-4,"cstr"),O}function j(F,I,O,V){var te=Ce(6+V.length);te.write_shift(2,F),te.write_shift(1,O),te.write_shift(1,I),te.write_shift(1,39);for(var pe=0;pe<V.length;++pe){var U=V.charCodeAt(pe);te.write_shift(1,U>=128?95:U)}return te.write_shift(1,0),te}function A(F,I){var O=_(F);O[1].v=F.read_shift(2);var V=O[1].v>>1;if(O[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return O[1].v=V,O}function L(F,I){var O=_(F),V=F.read_shift(4),te=F.read_shift(4),pe=F.read_shift(2);if(pe==65535)return V===0&&te===3221225472?(O[1].t="e",O[1].v=15):V===0&&te===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var U=pe&32768;return pe=(pe&32767)-16446,O[1].v=(1-U*2)*(te*Math.pow(2,pe+32)+V*Math.pow(2,pe)),O}function W(F,I,O,V){var te=Ce(14);if(te.write_shift(2,F),te.write_shift(1,O),te.write_shift(1,I),V==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var pe=0,U=0,ce=0,Q=0;return V<0&&(pe=1,V=-V),U=Math.log2(V)|0,V/=Math.pow(2,U-31),Q=V>>>0,(Q&2147483648)==0&&(V/=2,++U,Q=V>>>0),V-=Q,Q|=2147483648,Q>>>=0,V*=Math.pow(2,32),ce=V>>>0,te.write_shift(4,ce),te.write_shift(4,Q),U+=16383+(pe?32768:0),te.write_shift(2,U),te}function R(F,I){var O=L(F);return F.l+=I-14,O}function M(F,I){var O=_(F),V=F.read_shift(4);return O[1].v=V>>6,O}function q(F,I){var O=_(F),V=F.read_shift(8,"f");return O[1].v=V,O}function ee(F,I){var O=q(F);return F.l+=I-10,O}function z(F,I){return F[F.l+I-1]==0?F.read_shift(I,"cstr"):""}function fe(F,I){var O=F[F.l++];O>I-1&&(O=I-1);for(var V="";V.length<O;)V+=String.fromCharCode(F[F.l++]);return V}function ae(F,I,O){if(!(!O.qpro||I<21)){var V=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var te=F.read_shift(I-21,"cstr");return[V,te]}}function J(F,I){for(var O={},V=F.l+I;F.l<V;){var te=F.read_shift(2);if(te==14e3){for(O[te]=[0,""],O[te][0]=F.read_shift(2);F[F.l];)O[te][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return O}function G(F,I){var O=Ce(5+F.length);O.write_shift(2,14e3),O.write_shift(2,I);for(var V=0;V<F.length;++V){var te=F.charCodeAt(V);O[O.l++]=te>127?95:te}return O[O.l++]=0,O}var he={0:{n:"BOF",f:On},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:N},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:z},222:{n:"SHEETNAMELP",f:fe},65535:{n:""}},H={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:J},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:s,to_workbook:n}})();function UL(e){var n={},a=e.match(Ta),r=0,s=!1;if(a)for(;r!=a.length;++r){var l=ut(a[r]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;n.cp=hg[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=l.val;break;case"<sz":n.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":l.rgb&&(n.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(l[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+l[0])}}return n}var KL=(function(){var e=Jd("t"),n=Jd("rPr");function a(l){var o=l.match(e);if(!o)return{t:"s",v:""};var d={t:"s",v:Et(o[1])},u=l.match(n);return u&&(d.s=UL(u[1])),d}var r=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(r,"").split(s).map(a).filter(function(d){return d.v})}})(),zL=(function(){var n=/(\r\n|\n)/g;function a(s,l,o){var d=[];s.u&&d.push("text-decoration: underline;"),s.uval&&d.push("text-underline-style:"+s.uval+";"),s.sz&&d.push("font-size:"+s.sz+"pt;"),s.outline&&d.push("text-effect: outline;"),s.shadow&&d.push("text-shadow: auto;"),l.push('<span style="'+d.join("")+'">'),s.b&&(l.push("<b>"),o.push("</b>")),s.i&&(l.push("<i>"),o.push("</i>")),s.strike&&(l.push("<s>"),o.push("</s>"));var u=s.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(l.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),s}function r(s){var l=[[],s.v,[]];return s.v?(s.s&&a(s.s,l[0],l[2]),l[0].join("")+l[1].replace(n,"<br/>")+l[2].join("")):""}return function(l){return l.map(r).join("")}})(),$L=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,GL=/<(?:\w+:)?r>/,qL=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Ig(e,n){var a=n?n.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Et(Xt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Xt(e),a&&(r.h=jg(r.t))):e.match(GL)&&(r.r=Xt(e),r.t=Et(Xt((e.replace(qL,"").match($L)||[]).join("").replace(Ta,""))),a&&(r.h=zL(KL(r.r)))),r):{t:""}}var WL=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,XL=/<(?:\w+:)?(?:si|sstItem)>/g,QL=/<\/(?:\w+:)?(?:si|sstItem)>/;function YL(e,n){var a=[],r="";if(!e)return a;var s=e.match(WL);if(s){r=s[2].replace(XL,"").split(QL);for(var l=0;l!=r.length;++l){var o=Ig(r[l].trim(),n);o!=null&&(a[a.length]=o)}s=ut(s[1]),a.Count=s.count,a.Unique=s.uniqueCount}return a}var JL=/^\s|\s$|[\t\n\r]/;function Fk(e,n){if(!n.bookSST)return"";var a=[Fn];a[a.length]=Ve("sst",null,{xmlns:mo[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(e[r]!=null){var s=e[r],l="<si>";s.r?l+=s.r:(l+="<t",s.t||(s.t=""),s.t.match(JL)&&(l+=' xml:space="preserve"'),l+=">"+$t(s.t)+"</t>"),l+="</si>",a[a.length]=l}return a.length>2&&(a[a.length]="</sst>",a[1]=a[1].replace("/>",">")),a.join("")}function ZL(e){return[e.read_shift(4),e.read_shift(4)]}function eO(e,n){var a=[],r=!1;return ci(e,function(l,o,d){switch(d){case 159:a.Count=l[0],a.Unique=l[1];break;case 19:a.push(l);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(o.T,!r||n.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}function tO(e,n){return n||(n=Ce(8)),n.write_shift(4,e.Count),n.write_shift(4,e.Unique),n}var nO=h8;function aO(e){var n=Za();Ee(n,159,tO(e));for(var a=0;a<e.length;++a)Ee(n,19,nO(e[a]));return Ee(n,160),n.end()}function Ak(e){for(var n=[],a=e.split(""),r=0;r<a.length;++r)n[r]=a[r].charCodeAt(0);return n}function ai(e,n){var a={};return a.Major=e.read_shift(2),a.Minor=e.read_shift(2),n>=4&&(e.l+=n-4),a}function rO(e){var n={};return n.id=e.read_shift(0,"lpp4"),n.R=ai(e,4),n.U=ai(e,4),n.W=ai(e,4),n}function sO(e){for(var n=e.read_shift(4),a=e.l+n-4,r={},s=e.read_shift(4),l=[];s-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=l,e.l!=a)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+a);return r}function iO(e){var n=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)n.push(sO(e));return n}function lO(e){var n=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)n.push(e.read_shift(0,"lpp4"));return n}function oO(e){var n={};return e.read_shift(4),e.l+=4,n.id=e.read_shift(0,"lpp4"),n.name=e.read_shift(0,"lpp4"),n.R=ai(e,4),n.U=ai(e,4),n.W=ai(e,4),n}function cO(e){var n=oO(e);if(n.ename=e.read_shift(0,"8lpp4"),n.blksz=e.read_shift(4),n.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function Pk(e,n){var a=e.l+n,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var s=!1;switch(r.AlgID){case 26126:case 26127:case 26128:s=r.Flags==36;break;case 26625:s=r.Flags==4;break;case 0:s=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(a-e.l>>1,"utf16le"),e.l=a,r}function Lk(e,n){var a={},r=e.l+n;return e.l+=4,a.Salt=e.slice(e.l,e.l+16),e.l+=16,a.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),a.VerifierHash=e.slice(e.l,r),e.l=r,a}function dO(e){var n=ai(e);switch(n.Minor){case 2:return[n.Minor,uO(e)];case 3:return[n.Minor,hO()];case 4:return[n.Minor,xO(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function uO(e){var n=e.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var a=e.read_shift(4),r=Pk(e,a),s=Lk(e,e.length-e.l);return{t:"Std",h:r,v:s}}function hO(){throw new Error("File is password-protected: ECMA-376 Extensible")}function xO(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var a=e.read_shift(e.length-e.l,"utf8"),r={};return a.replace(Ta,function(l){var o=ut(l);switch(_s(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(d){r[d]=o[d]});break;case"<dataIntegrity":r.encryptedHmacKey=o.encryptedHmacKey,r.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(o);break;default:throw o[0]}}),r}function mO(e,n){var a={},r=a.EncryptionVersionInfo=ai(e,4);if(n-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);a.Flags=e.read_shift(4),n-=4;var s=e.read_shift(4);return n-=4,a.EncryptionHeader=Pk(e,s),n-=s,a.EncryptionVerifier=Lk(e,n),a}function fO(e){var n={},a=n.EncryptionVersionInfo=ai(e,4);if(a.Major!=1||a.Minor!=1)throw"unrecognized version code "+a.Major+" : "+a.Minor;return n.Salt=e.read_shift(16),n.EncryptedVerifier=e.read_shift(16),n.EncryptedVerifierHash=e.read_shift(16),n}function Mg(e){var n=0,a,r=Ak(e),s=r.length+1,l,o,d,u,h;for(a=rl(s),a[0]=r.length,l=1;l!=s;++l)a[l]=r[l-1];for(l=s-1;l>=0;--l)o=a[l],d=(n&16384)===0?0:1,u=n<<1&32767,h=d|u,n=h^o;return n^52811}var Ok=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],a=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(o){return(o/2|o*128)&255},s=function(o,d){return r(o^d)},l=function(o){for(var d=n[o.length-1],u=104,h=o.length-1;h>=0;--h)for(var m=o[h],f=0;f!=7;++f)m&64&&(d^=a[u]),m*=2,--u;return d};return function(o){for(var d=Ak(o),u=l(d),h=d.length,m=rl(16),f=0;f!=16;++f)m[f]=0;var p,b,g;for((h&1)===1&&(p=u>>8,m[h]=s(e[0],p),--h,p=u&255,b=d[d.length-1],m[h]=s(b,p));h>0;)--h,p=u>>8,m[h]=s(d[h],p),--h,p=u&255,m[h]=s(d[h],p);for(h=15,g=15-d.length;g>0;)p=u>>8,m[h]=s(e[g],p),--h,--g,p=u&255,m[h]=s(d[h],p),--h,--g;return m}})(),pO=function(e,n,a,r,s){s||(s=n),r||(r=Ok(e));var l,o;for(l=0;l!=n.length;++l)o=n[l],o^=r[a],o=(o>>5|o<<3)&255,s[l]=o,++a;return[s,a,r]},gO=function(e){var n=0,a=Ok(e);return function(r){var s=pO("",r,n,a);return n=s[1],s[0]}};function yO(e,n,a,r){var s={key:On(e),verificationBytes:On(e)};return a.password&&(s.verifier=Mg(a.password)),r.valid=s.verificationBytes===s.verifier,r.valid&&(r.insitu=gO(a.password)),s}function vO(e,n,a){var r=a||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=fO(e):r.Data=mO(e,n),r}function bO(e,n,a){var r={Type:a.biff>=8?e.read_shift(2):0};return r.Type?vO(e,n-2,r):yO(e,a.biff>=8?n:n-2,a,r),r}var Ik=(function(){function e(s,l){switch(l.type){case"base64":return n(hr(s),l);case"binary":return n(s,l);case"buffer":return n(bt&&Buffer.isBuffer(s)?s.toString("binary"):dl(s),l);case"array":return n(so(s),l)}throw new Error("Unrecognized type "+l.type)}function n(s,l){var o=l||{},d=o.dense?[]:{},u=s.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(m,f){Array.isArray(d)&&(d[f]=[]);for(var p=/\\\w+\b/g,b=0,g,y=-1;g=p.exec(m);){switch(g[0]){case"\\cell":var N=m.slice(b,p.lastIndex-g[0].length);if(N[0]==" "&&(N=N.slice(1)),++y,N.length){var C={v:N,t:"s"};Array.isArray(d)?d[f][y]=C:d[dt({r:f,c:y})]=C}break}b=p.lastIndex}y>h.e.c&&(h.e.c=y)}),d["!ref"]=pt(h),d}function a(s,l){return ul(e(s,l),l)}function r(s){for(var l=["{\\rtf1\\ansi"],o=Dt(s["!ref"]),d,u=Array.isArray(s),h=o.s.r;h<=o.e.r;++h){l.push("\\trowd\\trautofit1");for(var m=o.s.c;m<=o.e.c;++m)l.push("\\cellx"+(m+1));for(l.push("\\pard\\intbl"),m=o.s.c;m<=o.e.c;++m){var f=dt({r:h,c:m});d=u?(s[h]||[])[m]:s[f],!(!d||d.v==null&&(!d.f||d.F))&&(l.push(" "+(d.w||(li(d),d.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:a,to_sheet:e,from_sheet:r}})();function NO(e){var n=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function nu(e){for(var n=0,a=1;n!=3;++n)a=a*256+(e[n]>255?255:e[n]<0?0:e[n]);return a.toString(16).toUpperCase().slice(1)}function jO(e){var n=e[0]/255,a=e[1]/255,r=e[2]/255,s=Math.max(n,a,r),l=Math.min(n,a,r),o=s-l;if(o===0)return[0,0,n];var d=0,u=0,h=s+l;switch(u=o/(h>1?2-h:h),s){case n:d=((a-r)/o+6)%6;break;case a:d=(r-n)/o+2;break;case r:d=(n-a)/o+4;break}return[d/6,u,h/2]}function wO(e){var n=e[0],a=e[1],r=e[2],s=a*2*(r<.5?r:1-r),l=r-s/2,o=[l,l,l],d=6*n,u;if(a!==0)switch(d|0){case 0:case 6:u=s*d,o[0]+=s,o[1]+=u;break;case 1:u=s*(2-d),o[0]+=u,o[1]+=s;break;case 2:u=s*(d-2),o[1]+=s,o[2]+=u;break;case 3:u=s*(4-d),o[1]+=u,o[2]+=s;break;case 4:u=s*(d-4),o[2]+=s,o[0]+=u;break;case 5:u=s*(6-d),o[2]+=u,o[0]+=s;break}for(var h=0;h!=3;++h)o[h]=Math.round(o[h]*255);return o}function P0(e,n){if(n===0)return e;var a=jO(NO(e));return n<0?a[2]=a[2]*(1+n):a[2]=1-(1-a[2])*(1-n),nu(wO(a))}var Mk=6,kO=15,TO=1,ba=Mk;function au(e){return Math.floor((e+Math.round(128/ba)/256)*ba)}function ru(e){return Math.floor((e-5)/ba*100+.5)/100}function L0(e){return Math.round((e*ba+5)/ba*256)/256}function kf(e){return L0(ru(au(e)))}function Rg(e){var n=Math.abs(e-kf(e)),a=ba;if(n>.005)for(ba=TO;ba<kO;++ba)Math.abs(e-kf(e))<=n&&(n=Math.abs(e-kf(e)),a=ba);ba=a}function sl(e){e.width?(e.wpx=au(e.width),e.wch=ru(e.wpx),e.MDW=ba):e.wpx?(e.wch=ru(e.wpx),e.width=L0(e.wch),e.MDW=ba):typeof e.wch=="number"&&(e.width=L0(e.wch),e.wpx=au(e.width),e.MDW=ba),e.customWidth&&delete e.customWidth}var CO=96,Rk=CO;function su(e){return e*96/Rk}function Sc(e){return e*Rk/96}var SO={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function _O(e,n,a,r){n.Borders=[];var s={},l=!1;(e[0].match(Ta)||[]).forEach(function(o){var d=ut(o);switch(_s(d[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},d.diagonalUp&&(s.diagonalUp=sn(d.diagonalUp)),d.diagonalDown&&(s.diagonalDown=sn(d.diagonalDown)),n.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+d[0]+" in borders")}})}function EO(e,n,a,r){n.Fills=[];var s={},l=!1;(e[0].match(Ta)||[]).forEach(function(o){var d=ut(o);switch(_s(d[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},n.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":d.patternType&&(s.patternType=d.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),d.indexed&&(s.bgColor.indexed=parseInt(d.indexed,10)),d.theme&&(s.bgColor.theme=parseInt(d.theme,10)),d.tint&&(s.bgColor.tint=parseFloat(d.tint)),d.rgb&&(s.bgColor.rgb=d.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),d.theme&&(s.fgColor.theme=parseInt(d.theme,10)),d.tint&&(s.fgColor.tint=parseFloat(d.tint)),d.rgb!=null&&(s.fgColor.rgb=d.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+d[0]+" in fills")}})}function DO(e,n,a,r){n.Fonts=[];var s={},l=!1;(e[0].match(Ta)||[]).forEach(function(o){var d=ut(o);switch(_s(d[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(s),s={};break;case"<name":d.val&&(s.name=Xt(d.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=d.val?sn(d.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=d.val?sn(d.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(d.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=d.val?sn(d.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=d.val?sn(d.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=d.val?sn(d.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=d.val?sn(d.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=d.val?sn(d.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":d.val&&(s.sz=+d.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":d.val&&(s.vertAlign=d.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":d.val&&(s.family=parseInt(d.val,10));break;case"<family/>":case"</family>":break;case"<scheme":d.val&&(s.scheme=d.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(d.val=="1")break;d.codepage=hg[parseInt(d.val,10)];break;case"<color":if(s.color||(s.color={}),d.auto&&(s.color.auto=sn(d.auto)),d.rgb)s.color.rgb=d.rgb.slice(-6);else if(d.indexed){s.color.index=parseInt(d.indexed,10);var u=Ql[s.color.index];s.color.index==81&&(u=Ql[1]),u||(u=Ql[1]),s.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else d.theme&&(s.color.theme=parseInt(d.theme,10),d.tint&&(s.color.tint=parseFloat(d.tint)),d.theme&&a.themeElements&&a.themeElements.clrScheme&&(s.color.rgb=P0(a.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+d[0]+" in fonts")}})}function FO(e,n,a){n.NumberFmt=[];for(var r=jn(ct),s=0;s<r.length;++s)n.NumberFmt[r[s]]=ct[r[s]];var l=e[0].match(Ta);if(l)for(s=0;s<l.length;++s){var o=ut(l[s]);switch(_s(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var d=Et(Xt(o.formatCode)),u=parseInt(o.numFmtId,10);if(n.NumberFmt[u]=d,u>0){if(u>392){for(u=392;u>60&&n.NumberFmt[u]!=null;--u);n.NumberFmt[u]=d}ni(d,u)}}break;case"</numFmt>":break;default:if(a.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function AO(e){var n=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var r=a[0];r<=a[1];++r)e[r]!=null&&(n[n.length]=Ve("numFmt",null,{numFmtId:r,formatCode:$t(e[r])}))}),n.length===1?"":(n[n.length]="</numFmts>",n[0]=Ve("numFmts",null,{count:n.length-2}).replace("/>",">"),n.join(""))}var Zh=["numFmtId","fillId","fontId","borderId","xfId"],e0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function PO(e,n,a){n.CellXf=[];var r,s=!1;(e[0].match(Ta)||[]).forEach(function(l){var o=ut(l),d=0;switch(_s(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=o,delete r[0],d=0;d<Zh.length;++d)r[Zh[d]]&&(r[Zh[d]]=parseInt(r[Zh[d]],10));for(d=0;d<e0.length;++d)r[e0[d]]&&(r[e0[d]]=sn(r[e0[d]]));if(n.NumberFmt&&r.numFmtId>392){for(d=392;d>60;--d)if(n.NumberFmt[r.numFmtId]==n.NumberFmt[d]){r.numFmtId=d;break}}n.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=sn(o.wrapText)),r.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function LO(e){var n=[];return n[n.length]=Ve("cellXfs",null),e.forEach(function(a){n[n.length]=Ve("xf",null,a)}),n[n.length]="</cellXfs>",n.length===2?"":(n[0]=Ve("cellXfs",null,{count:n.length-2}).replace("/>",">"),n.join(""))}var OO=(function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,a=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(d,u,h){var m={};if(!d)return m;d=d.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=d.match(n))&&FO(f,m,h),(f=d.match(s))&&DO(f,m,u,h),(f=d.match(r))&&EO(f,m,u,h),(f=d.match(l))&&_O(f,m,u,h),(f=d.match(a))&&PO(f,m,h),m}})();function Bk(e,n){var a=[Fn,Ve("styleSheet",null,{xmlns:mo[0],"xmlns:vt":Kn.vt})],r;return e.SSF&&(r=AO(e.SSF))!=null&&(a[a.length]=r),a[a.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',a[a.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',a[a.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',a[a.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=LO(n.cellXfs))&&(a[a.length]=r),a[a.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',a[a.length]='<dxfs count="0"/>',a[a.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',a.length>2&&(a[a.length]="</styleSheet>",a[1]=a[1].replace("/>",">")),a.join("")}function IO(e,n){var a=e.read_shift(2),r=wa(e);return[a,r]}function MO(e,n,a){a||(a=Ce(6+4*n.length)),a.write_shift(2,e),ta(n,a);var r=a.length>a.l?a.slice(0,a.l):a;return a.l==null&&(a.l=a.length),r}function RO(e,n,a){var r={};r.sz=e.read_shift(2)/20;var s=v8(e);s.fItalic&&(r.italic=1),s.fCondense&&(r.condense=1),s.fExtend&&(r.extend=1),s.fShadow&&(r.shadow=1),s.fOutline&&(r.outline=1),s.fStrikeout&&(r.strike=1);var l=e.read_shift(2);switch(l===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(r.underline=o);var d=e.read_shift(1);d>0&&(r.family=d);var u=e.read_shift(1);switch(u>0&&(r.charset=u),e.l++,r.color=y8(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=wa(e),r}function BO(e,n){n||(n=Ce(153)),n.write_shift(2,e.sz*20),b8(e,n),n.write_shift(2,e.bold?700:400);var a=0;e.vertAlign=="superscript"?a=1:e.vertAlign=="subscript"&&(a=2),n.write_shift(2,a),n.write_shift(1,e.underline||0),n.write_shift(1,e.family||0),n.write_shift(1,e.charset||0),n.write_shift(1,0),D0(e.color,n);var r=0;return r=2,n.write_shift(1,r),ta(e.name,n),n.length>n.l?n.slice(0,n.l):n}var HO=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Tf,VO=ka;function $N(e,n){n||(n=Ce(84)),Tf||(Tf=nx(HO));var a=Tf[e.patternType];a==null&&(a=40),n.write_shift(4,a);var r=0;if(a!=40)for(D0({auto:1},n),D0({auto:1},n);r<12;++r)n.write_shift(4,0);else{for(;r<4;++r)n.write_shift(4,0);for(;r<12;++r)n.write_shift(4,0)}return n.length>n.l?n.slice(0,n.l):n}function UO(e,n){var a=e.l+n,r=e.read_shift(2),s=e.read_shift(2);return e.l=a,{ixfe:r,numFmtId:s}}function Hk(e,n,a){a||(a=Ce(16)),a.write_shift(2,n||0),a.write_shift(2,e.numFmtId||0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(1,0),a.write_shift(1,0);var r=0;return a.write_shift(1,r),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(1,0),a}function Td(e,n){return n||(n=Ce(10)),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(4,0),n}var KO=ka;function zO(e,n){return n||(n=Ce(51)),n.write_shift(1,0),Td(null,n),Td(null,n),Td(null,n),Td(null,n),Td(null,n),n.length>n.l?n.slice(0,n.l):n}function $O(e,n){return n||(n=Ce(52)),n.write_shift(4,e.xfId),n.write_shift(2,1),n.write_shift(1,0),n.write_shift(1,0),E0(e.name||"",n),n.length>n.l?n.slice(0,n.l):n}function GO(e,n,a){var r=Ce(2052);return r.write_shift(4,e),E0(n,r),E0(a,r),r.length>r.l?r.slice(0,r.l):r}function qO(e,n,a){var r={};r.NumberFmt=[];for(var s in ct)r.NumberFmt[s]=ct[s];r.CellXf=[],r.Fonts=[];var l=[],o=!1;return ci(e,function(u,h,m){switch(m){case 44:r.NumberFmt[u[0]]=u[1],ni(u[1],u[0]);break;case 43:r.Fonts.push(u),u.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(u.color.rgb=P0(n.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&r.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:l.push(m),o=!0;break;case 38:l.pop(),o=!1;break;default:if(h.T>0)l.push(m);else if(h.T<0)l.pop();else if(!o||a.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),r}function WO(e,n){if(n){var a=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)n[s]!=null&&++a}),a!=0&&(Ee(e,615,es(a)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)n[s]!=null&&Ee(e,44,MO(s,n[s]))}),Ee(e,616))}}function XO(e){var n=1;Ee(e,611,es(n)),Ee(e,43,BO({sz:12,color:{theme:1},name:"Calibri",family:2})),Ee(e,612)}function QO(e){var n=2;Ee(e,603,es(n)),Ee(e,45,$N({patternType:"none"})),Ee(e,45,$N({patternType:"gray125"})),Ee(e,604)}function YO(e){var n=1;Ee(e,613,es(n)),Ee(e,46,zO()),Ee(e,614)}function JO(e){var n=1;Ee(e,626,es(n)),Ee(e,47,Hk({numFmtId:0},65535)),Ee(e,627)}function ZO(e,n){Ee(e,617,es(n.length)),n.forEach(function(a){Ee(e,47,Hk(a,0))}),Ee(e,618)}function eI(e){var n=1;Ee(e,619,es(n)),Ee(e,48,$O({xfId:0,name:"Normal"})),Ee(e,620)}function tI(e){var n=0;Ee(e,505,es(n)),Ee(e,506)}function nI(e){var n=0;Ee(e,508,GO(n,"TableStyleMedium9","PivotStyleMedium4")),Ee(e,509)}function aI(e,n){var a=Za();return Ee(a,278),WO(a,e.SSF),XO(a),QO(a),YO(a),JO(a),ZO(a,n.cellXfs),eI(a),tI(a),nI(a),Ee(a,279),a.end()}var rI=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function sI(e,n,a){n.themeElements.clrScheme=[];var r={};(e[0].match(Ta)||[]).forEach(function(s){var l=ut(s);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=l.val;break;case"<a:sysClr":r.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(n.themeElements.clrScheme[rI.indexOf(l[0])]=r,r={}):r.name=l[0].slice(3,l[0].length-1);break;default:if(a&&a.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function iI(){}function lI(){}var oI=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,cI=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,dI=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function uI(e,n,a){n.themeElements={};var r;[["clrScheme",oI,sI],["fontScheme",cI,iI],["fmtScheme",dI,lI]].forEach(function(s){if(!(r=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](r,n,a)})}var hI=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Vk(e,n){(!e||e.length===0)&&(e=Bg());var a,r={};if(!(a=e.match(hI)))throw new Error("themeElements not found in theme");return uI(a[0],r,n),r.raw=e,r}function Bg(e,n){if(n&&n.themeXLSX)return n.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var a=[Fn];return a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join("")}function xI(e,n,a){var r=e.l+n,s=e.read_shift(4);if(s!==124226){if(!a.cellStyles){e.l=r;return}var l=e.slice(e.l);e.l=r;var o;try{o=Pw(l,{type:"array"})}catch{return}var d=dr(o,"theme/theme/theme1.xml",!0);if(d)return Vk(d,a)}}function mI(e){return e.read_shift(4)}function fI(e){var n={};switch(n.xclrType=e.read_shift(2),n.nTintShade=e.read_shift(2),n.xclrType){case 0:e.l+=4;break;case 1:n.xclrValue=pI(e,4);break;case 2:n.xclrValue=bk(e);break;case 3:n.xclrValue=mI(e);break;case 4:e.l+=4;break}return e.l+=8,n}function pI(e,n){return ka(e,n)}function gI(e,n){return ka(e,n)}function yI(e){var n=e.read_shift(2),a=e.read_shift(2)-4,r=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=fI(e);break;case 6:r[1]=gI(e,a);break;case 14:case 15:r[1]=e.read_shift(a===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+a)}return r}function vI(e,n){var a=e.l+n;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),l=[];s-- >0;)l.push(yI(e,a-e.l));return{ixfe:r,ext:l}}function bI(e,n){n.forEach(function(a){a[0]})}function NI(e,n){return{flags:e.read_shift(4),version:e.read_shift(4),name:wa(e)}}function jI(e){var n=Ce(12+2*e.name.length);return n.write_shift(4,e.flags),n.write_shift(4,e.version),ta(e.name,n),n.slice(0,n.l)}function wI(e){for(var n=[],a=e.read_shift(4);a-- >0;)n.push([e.read_shift(4),e.read_shift(4)]);return n}function kI(e){var n=Ce(4+8*e.length);n.write_shift(4,e.length);for(var a=0;a<e.length;++a)n.write_shift(4,e[a][0]),n.write_shift(4,e[a][1]);return n}function TI(e,n){var a=Ce(8+2*n.length);return a.write_shift(4,e),ta(n,a),a.slice(0,a.l)}function CI(e){return e.l+=4,e.read_shift(4)!=0}function SI(e,n){var a=Ce(8);return a.write_shift(4,e),a.write_shift(4,1),a}function _I(e,n,a){var r={Types:[],Cell:[],Value:[]},s=a||{},l=[],o=!1,d=2;return ci(e,function(u,h,m){switch(m){case 335:r.Types.push({name:u.name});break;case 51:u.forEach(function(f){d==1?r.Cell.push({type:r.Types[f[0]-1].name,index:f[1]}):d==0&&r.Value.push({type:r.Types[f[0]-1].name,index:f[1]})});break;case 337:d=u?1:0;break;case 338:d=2;break;case 35:l.push(m),o=!0;break;case 36:l.pop(),o=!1;break;default:if(!h.T){if(!o||s.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),r}function EI(){var e=Za();return Ee(e,332),Ee(e,334,es(1)),Ee(e,335,jI({name:"XLDAPR",version:12e4,flags:3496657072})),Ee(e,336),Ee(e,339,TI(1,"XLDAPR")),Ee(e,52),Ee(e,35,es(514)),Ee(e,4096,es(0)),Ee(e,4097,Cr(1)),Ee(e,36),Ee(e,53),Ee(e,340),Ee(e,337,SI(1)),Ee(e,51,kI([[1,0]])),Ee(e,338),Ee(e,333),e.end()}function DI(e,n,a){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var s=!1,l=2,o;return e.replace(Ta,function(d){var u=ut(d);switch(_s(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<r.Types.length;++h)r.Types[h].name==u.name&&(o=r.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?r.Cell.push({type:r.Types[u.t-1].name,index:+u.v}):l==0&&r.Value.push({type:r.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!s&&a.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return d}),r}function Uk(){var e=[Fn];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function FI(e){var n=[];if(!e)return n;var a=1;return(e.match(Ta)||[]).forEach(function(r){var s=ut(r);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?a=s.i:s.i=a,n.push(s);break}}),n}function AI(e){var n={};n.i=e.read_shift(4);var a={};a.r=e.read_shift(4),a.c=e.read_shift(4),n.r=dt(a);var r=e.read_shift(1);return r&2&&(n.l="1"),r&8&&(n.a="1"),n}function PI(e,n,a){var r=[];return ci(e,function(l,o,d){switch(d){case 63:r.push(l);break;default:if(!o.T)throw new Error("Unexpected record 0x"+d.toString(16))}}),r}function LI(e,n,a,r){if(!e)return e;var s=r||{},l=!1;ci(e,function(d,u,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!u.T){if(!l||s.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},s)}function OI(e,n){if(!e)return"??";var a=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][a].Target}var ac=1024;function Kk(e,n){for(var a=[21600,21600],r=["m0,0l0",a[1],a[0],a[1],a[0],"0xe"].join(","),s=[Ve("xml",null,{"xmlns:v":lr.v,"xmlns:o":lr.o,"xmlns:x":lr.x,"xmlns:mv":lr.mv}).replace(/\/>/,">"),Ve("o:shapelayout",Ve("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ve("v:shapetype",[Ve("v:stroke",null,{joinstyle:"miter"}),Ve("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:a.join(","),path:r})];ac<e*1e3;)ac+=1e3;return n.forEach(function(l){var o=gn(l[0]),d={color2:"#BEFF82",type:"gradient"};d.type=="gradient"&&(d.angle="-180");var u=d.type=="gradient"?Ve("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Ve("v:fill",u,d),m={on:"t",obscured:"t"};++ac,s=s.concat(["<v:shape"+Zd({id:"_x0000_s"+ac,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Ve("v:shadow",null,m),Ve("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",da("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),da("x:AutoFill","False"),da("x:Row",String(o.r)),da("x:Column",String(o.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function GN(e,n,a,r){var s=Array.isArray(e),l;n.forEach(function(o){var d=gn(o.ref);if(s?(e[d.r]||(e[d.r]=[]),l=e[d.r][d.c]):l=e[o.ref],!l){l={t:"z"},s?e[d.r][d.c]=l:e[o.ref]=l;var u=Dt(e["!ref"]||"BDWGO1000001:A1");u.s.r>d.r&&(u.s.r=d.r),u.e.r<d.r&&(u.e.r=d.r),u.s.c>d.c&&(u.s.c=d.c),u.e.c<d.c&&(u.e.c=d.c);var h=pt(u);h!==e["!ref"]&&(e["!ref"]=h)}l.c||(l.c=[]);var m={a:o.author,t:o.t,r:o.r,T:a};o.h&&(m.h=o.h);for(var f=l.c.length-1;f>=0;--f){if(!a&&l.c[f].T)return;a&&!l.c[f].T&&l.c.splice(f,1)}if(a&&r){for(f=0;f<r.length;++f)if(m.a==r[f].id){m.a=r[f].name||m.a;break}}l.c.push(m)})}function II(e,n){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var a=[],r=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var d=o.match(/<(?:\w+:)?author[^>]*>(.*)/);d&&a.push(d[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var d=o.match(/<(?:\w+:)?comment[^>]*>/);if(d){var u=ut(d[0]),h={author:u.authorId&&a[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},m=gn(u.ref);if(!(n.sheetRows&&n.sheetRows<=m.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!f&&!!f[1]&&Ig(f[1])||{r:"",t:"",h:""};h.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),h.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(h.h=p.h),r.push(h)}}}}),r}function zk(e){var n=[Fn,Ve("comments",null,{xmlns:mo[0]})],a=[];return n.push("<authors>"),e.forEach(function(r){r[1].forEach(function(s){var l=$t(s.a);a.indexOf(l)==-1&&(a.push(l),n.push("<author>"+l+"</author>")),s.T&&s.ID&&a.indexOf("tc="+s.ID)==-1&&(a.push("tc="+s.ID),n.push("<author>tc="+s.ID+"</author>"))})}),a.length==0&&(a.push("SheetJ5"),n.push("<author>SheetJ5</author>")),n.push("</authors>"),n.push("<commentList>"),e.forEach(function(r){var s=0,l=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?s=a.indexOf("tc="+r[1][0].ID):r[1].forEach(function(u){u.a&&(s=a.indexOf($t(u.a))),l.push(u.t||"")}),n.push('<comment ref="'+r[0]+'" authorId="'+s+'"><text>'),l.length<=1)n.push(da("t",$t(l[0]||"")));else{for(var o=`Comment:
    `+l[0]+`
`,d=1;d<l.length;++d)o+=`Reply:
    `+l[d]+`
`;n.push(da("t",$t(o)))}n.push("</text></comment>")}),n.push("</commentList>"),n.length>2&&(n[n.length]="</comments>",n[1]=n[1].replace("/>",">")),n.join("")}function MI(e,n){var a=[],r=!1,s={},l=0;return e.replace(Ta,function(d,u){var h=ut(d);switch(_s(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":s.t!=null&&a.push(s);break;case"<text>":case"<text":l=u+d.length;break;case"</text>":s.t=e.slice(l,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return d}),a}function RI(e,n,a){var r=[Fn,Ve("ThreadedComments",null,{xmlns:Kn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var l="";(s[1]||[]).forEach(function(o,d){if(!o.T){delete o.ID;return}o.a&&n.indexOf(o.a)==-1&&n.push(o.a);var u={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+a.tcid++).slice(-12)+"}"};d==0?l=u.id:u.parentId=l,o.ID=u.id,o.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+n.indexOf(o.a)).slice(-12)+"}"),r.push(Ve("threadedComment",da("text",o.t||""),u))})}),r.push("</ThreadedComments>"),r.join("")}function BI(e,n){var a=[],r=!1;return e.replace(Ta,function(l){var o=ut(l);switch(_s(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":a.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return l}),a}function HI(e){var n=[Fn,Ve("personList",null,{xmlns:Kn.TCMNT,"xmlns:x":mo[0]}).replace(/[\/]>/,">")];return e.forEach(function(a,r){n.push(Ve("person",null,{displayName:a,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:a,providerId:"None"}))}),n.push("</personList>"),n.join("")}function VI(e){var n={};n.iauthor=e.read_shift(4);var a=yo(e);return n.rfx=a.s,n.ref=dt(a.s),e.l+=16,n}function UI(e,n){return n==null&&(n=Ce(36)),n.write_shift(4,e[1].iauthor),Ic(e[0],n),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n}var KI=wa;function zI(e){return ta(e.slice(0,54))}function $I(e,n){var a=[],r=[],s={},l=!1;return ci(e,function(d,u,h){switch(h){case 632:r.push(d);break;case 635:s=d;break;case 637:s.t=d.t,s.h=d.h,s.r=d.r;break;case 636:if(s.author=r[s.iauthor],delete s.iauthor,n.sheetRows&&s.rfx&&n.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,a.push(s);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!l||n.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),a}function GI(e){var n=Za(),a=[];return Ee(n,628),Ee(n,630),e.forEach(function(r){r[1].forEach(function(s){a.indexOf(s.a)>-1||(a.push(s.a.slice(0,54)),Ee(n,632,zI(s.a)))})}),Ee(n,631),Ee(n,633),e.forEach(function(r){r[1].forEach(function(s){s.iauthor=a.indexOf(s.a);var l={s:gn(r[0]),e:gn(r[0])};Ee(n,635,UI([l,s])),s.t&&s.t.length>0&&Ee(n,637,m8(s)),Ee(n,636),delete s.iauthor})}),Ee(n,634),Ee(n,629),n.end()}var qI="application/vnd.ms-office.vbaProject";function WI(e){var n=nt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(a,r){if(!(a.slice(-1)==="/"||!a.match(/_VBA_PROJECT_CUR/))){var s=a.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");nt.utils.cfb_add(n,s,e.FileIndex[r].content)}}),nt.write(n)}function XI(e,n){n.FullPaths.forEach(function(a,r){if(r!=0){var s=a.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&nt.utils.cfb_add(e,s,n.FileIndex[r].content)}})}var $k=["xlsb","xlsm","xlam","biff8","xla"];function QI(){return{"!type":"dialog"}}function YI(){return{"!type":"dialog"}}function JI(){return{"!type":"macro"}}function ZI(){return{"!type":"macro"}}var ic=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function a(r,s,l,o){var d=!1,u=!1;l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1)),o.length==0?d=!0:o.charAt(0)=="["&&(d=!0,o=o.slice(1,-1));var h=l.length>0?parseInt(l,10)|0:0,m=o.length>0?parseInt(o,10)|0:0;return d?m+=n.c:--m,u?h+=n.r:--h,s+(d?"":"$")+pn(m)+(u?"":"$")+Dn(h)}return function(s,l){return n=l,s.replace(e,a)}})(),Hg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Vg=(function(){return function(n,a){return n.replace(Hg,function(r,s,l,o,d,u){var h=Sg(o)-(l?0:a.c),m=Cg(u)-(d?0:a.r),f=m==0?"":d?m+1:"["+m+"]",p=h==0?"":l?h+1:"["+h+"]";return s+"R"+f+"C"+p})}})();function Gk(e,n){return e.replace(Hg,function(a,r,s,l,o,d){return r+(s=="$"?s+l:pn(Sg(l)+n.c))+(o=="$"?o+d:Dn(Cg(d)+n.r))})}function eM(e,n,a){var r=er(n),s=r.s,l=gn(a),o={r:l.r-s.r,c:l.c-s.c};return Gk(e,o)}function tM(e){return e.length!=1}function qN(e){return e.replace(/_xlfn\./g,"")}function Pn(e){e.l+=1}function il(e,n){var a=e.read_shift(2);return[a&16383,a>>14&1,a>>15&1]}function qk(e,n,a){var r=2;if(a){if(a.biff>=2&&a.biff<=5)return Wk(e);a.biff==12&&(r=4)}var s=e.read_shift(r),l=e.read_shift(r),o=il(e),d=il(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:l,c:d[0],cRel:d[1],rRel:d[2]}}}function Wk(e){var n=il(e),a=il(e),r=e.read_shift(1),s=e.read_shift(1);return{s:{r:n[0],c:r,cRel:n[1],rRel:n[2]},e:{r:a[0],c:s,cRel:a[1],rRel:a[2]}}}function nM(e,n,a){if(a.biff<8)return Wk(e);var r=e.read_shift(a.biff==12?4:2),s=e.read_shift(a.biff==12?4:2),l=il(e),o=il(e);return{s:{r,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Xk(e,n,a){if(a&&a.biff>=2&&a.biff<=5)return aM(e);var r=e.read_shift(a&&a.biff==12?4:2),s=il(e);return{r,c:s[0],cRel:s[1],rRel:s[2]}}function aM(e){var n=il(e),a=e.read_shift(1);return{r:n[0],c:a,cRel:n[1],rRel:n[2]}}function rM(e){var n=e.read_shift(2),a=e.read_shift(2);return{r:n,c:a&255,fQuoted:!!(a&16384),cRel:a>>15,rRel:a>>15}}function sM(e,n,a){var r=a&&a.biff?a.biff:8;if(r>=2&&r<=5)return iM(e);var s=e.read_shift(r>=12?4:2),l=e.read_shift(2),o=(l&16384)>>14,d=(l&32768)>>15;if(l&=16383,d==1)for(;s>524287;)s-=1048576;if(o==1)for(;l>8191;)l=l-16384;return{r:s,c:l,cRel:o,rRel:d}}function iM(e){var n=e.read_shift(2),a=e.read_shift(1),r=(n&32768)>>15,s=(n&16384)>>14;return n&=16383,r==1&&n>=8192&&(n=n-16384),s==1&&a>=128&&(a=a-256),{r:n,c:a,cRel:s,rRel:r}}function lM(e,n,a){var r=(e[e.l++]&96)>>5,s=qk(e,a.biff>=2&&a.biff<=5?6:8,a);return[r,s]}function oM(e,n,a){var r=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),l=8;if(a)switch(a.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var o=qk(e,l,a);return[r,s,o]}function cM(e,n,a){var r=(e[e.l++]&96)>>5;return e.l+=a&&a.biff>8?12:a.biff<8?6:8,[r]}function dM(e,n,a){var r=(e[e.l++]&96)>>5,s=e.read_shift(2),l=8;if(a)switch(a.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[r,s]}function uM(e,n,a){var r=(e[e.l++]&96)>>5,s=nM(e,n-1,a);return[r,s]}function hM(e,n,a){var r=(e[e.l++]&96)>>5;return e.l+=a.biff==2?6:a.biff==12?14:7,[r]}function WN(e){var n=e[e.l+1]&1,a=1;return e.l+=4,[n,a]}function xM(e,n,a){e.l+=2;for(var r=e.read_shift(a&&a.biff==2?1:2),s=[],l=0;l<=r;++l)s.push(e.read_shift(a&&a.biff==2?1:2));return s}function mM(e,n,a){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(a&&a.biff==2?1:2)]}function fM(e,n,a){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(a&&a.biff==2?1:2)]}function pM(e){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(2)]}function gM(e,n,a){var r=e[e.l+1]&255?1:0;return e.l+=a&&a.biff==2?3:4,[r]}function Qk(e){var n=e.read_shift(1),a=e.read_shift(1);return[n,a]}function yM(e){return e.read_shift(2),Qk(e)}function vM(e){return e.read_shift(2),Qk(e)}function bM(e,n,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=Xk(e,0,a);return[r,s]}function NM(e,n,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=sM(e,0,a);return[r,s]}function jM(e,n,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);a&&a.biff==5&&(e.l+=12);var l=Xk(e,0,a);return[r,s,l]}function wM(e,n,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(a&&a.biff<=3?1:2);return[C7[s],Zk[s],r]}function kM(e,n,a){var r=e[e.l++],s=e.read_shift(1),l=a&&a.biff<=3?[r==88?-1:0,e.read_shift(1)]:TM(e);return[s,(l[0]===0?Zk:T7)[l[1]]]}function TM(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function CM(e,n,a){e.l+=a&&a.biff==2?3:4}function SM(e,n,a){if(e.l++,a&&a.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),s=e.read_shift(a&&a.biff==2?1:2);return[r,s]}function _M(e){return e.l++,di[e.read_shift(1)]}function EM(e){return e.l++,e.read_shift(2)}function DM(e){return e.l++,e.read_shift(1)!==0}function FM(e){return e.l++,ja(e)}function AM(e,n,a){return e.l++,wu(e,n-1,a)}function PM(e,n){var a=[e.read_shift(1)];if(n==12)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2;break}switch(a[0]){case 4:a[1]=_n(e,1)?"TRUE":"FALSE",n!=12&&(e.l+=7);break;case 37:case 16:a[1]=di[e[e.l]],e.l+=n==12?4:8;break;case 0:e.l+=8;break;case 1:a[1]=ja(e);break;case 2:a[1]=vo(e,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function LM(e,n,a){for(var r=e.read_shift(a.biff==12?4:2),s=[],l=0;l!=r;++l)s.push((a.biff==12?yo:sx)(e));return s}function OM(e,n,a){var r=0,s=0;a.biff==12?(r=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),r=1+e.read_shift(2)),a.biff>=2&&a.biff<8&&(--r,--s==0&&(s=256));for(var l=0,o=[];l!=r&&(o[l]=[]);++l)for(var d=0;d!=s;++d)o[l][d]=PM(e,a.biff);return o}function IM(e,n,a){var r=e.read_shift(1)>>>5&3,s=!a||a.biff>=8?4:2,l=e.read_shift(s);switch(a.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,l]}function MM(e,n,a){if(a.biff==5)return RM(e);var r=e.read_shift(1)>>>5&3,s=e.read_shift(2),l=e.read_shift(4);return[r,s,l]}function RM(e){var n=e.read_shift(1)>>>5&3,a=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[n,a,r]}function BM(e,n,a){var r=e.read_shift(1)>>>5&3;e.l+=a&&a.biff==2?3:4;var s=e.read_shift(a&&a.biff==2?1:2);return[r,s]}function HM(e,n,a){var r=e.read_shift(1)>>>5&3,s=e.read_shift(a&&a.biff==2?1:2);return[r,s]}function VM(e,n,a){var r=e.read_shift(1)>>>5&3;return e.l+=4,a.biff<8&&e.l--,a.biff==12&&(e.l+=2),[r]}function UM(e,n,a){var r=(e[e.l++]&96)>>5,s=e.read_shift(2),l=4;if(a)switch(a.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[r,s]}var KM=ka,zM=ka,$M=ka;function Tu(e,n,a){return e.l+=2,[rM(e)]}function Ug(e){return e.l+=6,[]}var GM=Tu,qM=Ug,WM=Ug,XM=Tu;function Yk(e){return e.l+=2,[On(e),e.read_shift(2)&1]}var QM=Tu,YM=Yk,JM=Ug,ZM=Tu,e7=Tu,t7=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function n7(e){e.l+=2;var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(4),s=e.read_shift(2),l=e.read_shift(2),o=t7[a>>2&31];return{ixti:n,coltype:a&3,rt:o,idx:r,c:s,C:l}}function a7(e){return e.l+=2,[e.read_shift(4)]}function r7(e,n,a){return e.l+=5,e.l+=2,e.l+=a.biff==2?1:4,["PTGSHEET"]}function s7(e,n,a){return e.l+=a.biff==2?4:5,["PTGENDSHEET"]}function i7(e){var n=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[n,a]}function l7(e){var n=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[n,a]}function o7(e){return e.l+=4,[0,0]}var XN={1:{n:"PtgExp",f:SM},2:{n:"PtgTbl",f:$M},3:{n:"PtgAdd",f:Pn},4:{n:"PtgSub",f:Pn},5:{n:"PtgMul",f:Pn},6:{n:"PtgDiv",f:Pn},7:{n:"PtgPower",f:Pn},8:{n:"PtgConcat",f:Pn},9:{n:"PtgLt",f:Pn},10:{n:"PtgLe",f:Pn},11:{n:"PtgEq",f:Pn},12:{n:"PtgGe",f:Pn},13:{n:"PtgGt",f:Pn},14:{n:"PtgNe",f:Pn},15:{n:"PtgIsect",f:Pn},16:{n:"PtgUnion",f:Pn},17:{n:"PtgRange",f:Pn},18:{n:"PtgUplus",f:Pn},19:{n:"PtgUminus",f:Pn},20:{n:"PtgPercent",f:Pn},21:{n:"PtgParen",f:Pn},22:{n:"PtgMissArg",f:Pn},23:{n:"PtgStr",f:AM},26:{n:"PtgSheet",f:r7},27:{n:"PtgEndSheet",f:s7},28:{n:"PtgErr",f:_M},29:{n:"PtgBool",f:DM},30:{n:"PtgInt",f:EM},31:{n:"PtgNum",f:FM},32:{n:"PtgArray",f:hM},33:{n:"PtgFunc",f:wM},34:{n:"PtgFuncVar",f:kM},35:{n:"PtgName",f:IM},36:{n:"PtgRef",f:bM},37:{n:"PtgArea",f:lM},38:{n:"PtgMemArea",f:BM},39:{n:"PtgMemErr",f:KM},40:{n:"PtgMemNoMem",f:zM},41:{n:"PtgMemFunc",f:HM},42:{n:"PtgRefErr",f:VM},43:{n:"PtgAreaErr",f:cM},44:{n:"PtgRefN",f:NM},45:{n:"PtgAreaN",f:uM},46:{n:"PtgMemAreaN",f:i7},47:{n:"PtgMemNoMemN",f:l7},57:{n:"PtgNameX",f:MM},58:{n:"PtgRef3d",f:jM},59:{n:"PtgArea3d",f:oM},60:{n:"PtgRefErr3d",f:UM},61:{n:"PtgAreaErr3d",f:dM},255:{}},c7={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},d7={1:{n:"PtgElfLel",f:Yk},2:{n:"PtgElfRw",f:ZM},3:{n:"PtgElfCol",f:GM},6:{n:"PtgElfRwV",f:e7},7:{n:"PtgElfColV",f:XM},10:{n:"PtgElfRadical",f:QM},11:{n:"PtgElfRadicalS",f:JM},13:{n:"PtgElfColS",f:qM},15:{n:"PtgElfColSV",f:WM},16:{n:"PtgElfRadicalLel",f:YM},25:{n:"PtgList",f:n7},29:{n:"PtgSxName",f:a7},255:{}},u7={0:{n:"PtgAttrNoop",f:o7},1:{n:"PtgAttrSemi",f:gM},2:{n:"PtgAttrIf",f:fM},4:{n:"PtgAttrChoose",f:xM},8:{n:"PtgAttrGoto",f:mM},16:{n:"PtgAttrSum",f:CM},32:{n:"PtgAttrBaxcel",f:WN},33:{n:"PtgAttrBaxcel",f:WN},64:{n:"PtgAttrSpace",f:yM},65:{n:"PtgAttrSpaceSemi",f:vM},128:{n:"PtgAttrIfError",f:pM},255:{}};function Cu(e,n,a,r){if(r.biff<8)return ka(e,n);for(var s=e.l+n,l=[],o=0;o!==a.length;++o)switch(a[o][0]){case"PtgArray":a[o][1]=OM(e,0,r),l.push(a[o][1]);break;case"PtgMemArea":a[o][2]=LM(e,a[o][1],r),l.push(a[o][2]);break;case"PtgExp":r&&r.biff==12&&(a[o][1][1]=e.read_shift(4),l.push(a[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[o][0]}return n=s-e.l,n!==0&&l.push(ka(e,n)),l}function Su(e,n,a){for(var r=e.l+n,s,l,o=[];r!=e.l;)n=r-e.l,l=e[e.l],s=XN[l]||XN[c7[l]],(l===24||l===25)&&(s=(l===24?d7:u7)[e[e.l+1]]),!s||!s.f?ka(e,n):o.push([s.n,s.f(e,n,a)]);return o}function h7(e){for(var n=[],a=0;a<e.length;++a){for(var r=e[a],s=[],l=0;l<r.length;++l){var o=r[l];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}n.push(s.join(","))}return n.join(";")}var x7={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function m7(e,n){if(!e&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Jk(e,n,a){if(!e)return"SH33TJSERR0";if(a.biff>8&&(!e.XTI||!e.XTI[n]))return e.SheetNames[n];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[n];if(a.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":e.XTI[n-1];if(!r)return"SH33TJSERR1";var s="";if(a.biff>8)switch(e[r[0]][0]){case 357:return s=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 358:return a.SID!=null?e.SheetNames[a.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return s=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[r[0]][0][3]?(s=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?s:s+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function QN(e,n,a){var r=Jk(e,n,a);return r=="#REF"?r:m7(r,a)}function va(e,n,a,r,s){var l=s&&s.biff||8,o={s:{c:0,r:0}},d=[],u,h,m,f=0,p=0,b,g="";if(!e[0]||!e[0][0])return"";for(var y=-1,N="",C=0,T=e[0].length;C<T;++C){var S=e[0][C];switch(S[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=d.pop(),h=d.pop(),y>=0){switch(e[0][y][1][0]){case 0:N=bn(" ",e[0][y][1][1]);break;case 1:N=bn("\r",e[0][y][1][1]);break;default:if(N="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}h=h+N,y=-1}d.push(h+x7[S[0]]+u);break;case"PtgIsect":u=d.pop(),h=d.pop(),d.push(h+" "+u);break;case"PtgUnion":u=d.pop(),h=d.pop(),d.push(h+","+u);break;case"PtgRange":u=d.pop(),h=d.pop(),d.push(h+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=Md(S[1][1],o,s),d.push(Rd(m,l));break;case"PtgRefN":m=a?Md(S[1][1],a,s):S[1][1],d.push(Rd(m,l));break;case"PtgRef3d":f=S[1][1],m=Md(S[1][2],o,s),g=QN(r,f,s),d.push(g+"!"+Rd(m,l));break;case"PtgFunc":case"PtgFuncVar":var k=S[1][0],_=S[1][1];k||(k=0),k&=127;var P=k==0?[]:d.slice(-k);d.length-=k,_==="User"&&(_=P.shift()),d.push(_+"("+P.join(",")+")");break;case"PtgBool":d.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":d.push(S[1]);break;case"PtgNum":d.push(String(S[1]));break;case"PtgStr":d.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":d.push(S[1]);break;case"PtgAreaN":b=TN(S[1][1],a?{s:a}:o,s),d.push(Nf(b,s));break;case"PtgArea":b=TN(S[1][1],o,s),d.push(Nf(b,s));break;case"PtgArea3d":f=S[1][1],b=S[1][2],g=QN(r,f,s),d.push(g+"!"+Nf(b,s));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=S[1][2];var j=(r.names||[])[p-1]||(r[0]||[])[p],A=j?j.Name:"SH33TJSNAME"+String(p);A&&A.slice(0,6)=="_xlfn."&&!s.xlfn&&(A=A.slice(6)),d.push(A);break;case"PtgNameX":var L=S[1][1];p=S[1][2];var W;if(s.biff<=5)L<0&&(L=-L),r[L]&&(W=r[L][p]);else{var R="";if(((r[L]||[])[0]||[])[0]==14849||(((r[L]||[])[0]||[])[0]==1025?r[L][p]&&r[L][p].itab>0&&(R=r.SheetNames[r[L][p].itab-1]+"!"):R=r.SheetNames[p-1]+"!"),r[L]&&r[L][p])R+=r[L][p].Name;else if(r[0]&&r[0][p])R+=r[0][p].Name;else{var M=(Jk(r,L,s)||"").split(";;");M[p-1]?R=M[p-1]:R+="SH33TJSERRX"}d.push(R);break}W||(W={Name:"SH33TJSERRY"}),d.push(W.Name);break;case"PtgParen":var q="(",ee=")";if(y>=0){switch(N="",e[0][y][1][0]){case 2:q=bn(" ",e[0][y][1][1])+q;break;case 3:q=bn("\r",e[0][y][1][1])+q;break;case 4:ee=bn(" ",e[0][y][1][1])+ee;break;case 5:ee=bn("\r",e[0][y][1][1])+ee;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}d.push(q+d.pop()+ee);break;case"PtgRefErr":d.push("#REF!");break;case"PtgRefErr3d":d.push("#REF!");break;case"PtgExp":m={c:S[1][1],r:S[1][0]};var z={c:a.c,r:a.r};if(r.sharedf[dt(m)]){var fe=r.sharedf[dt(m)];d.push(va(fe,o,z,r,s))}else{var ae=!1;for(u=0;u!=r.arrayf.length;++u)if(h=r.arrayf[u],!(m.c<h[0].s.c||m.c>h[0].e.c)&&!(m.r<h[0].s.r||m.r>h[0].e.r)){d.push(va(h[1],o,z,r,s)),ae=!0;break}ae||d.push(S[1])}break;case"PtgArray":d.push("{"+h7(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=C;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":d.push("");break;case"PtgAreaErr":d.push("#REF!");break;case"PtgAreaErr3d":d.push("#REF!");break;case"PtgList":d.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var J=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&y>=0&&J.indexOf(e[0][C][0])==-1){S=e[0][y];var G=!0;switch(S[1][0]){case 4:G=!1;case 0:N=bn(" ",S[1][1]);break;case 5:G=!1;case 1:N=bn("\r",S[1][1]);break;default:if(N="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}d.push((G?N:"")+d.pop()+(G?"":N)),y=-1}}if(d.length>1&&s.WTF)throw new Error("bad formula stack");return d[0]}function f7(e,n,a){var r=e.l+n,s=a.biff==2?1:2,l,o=e.read_shift(s);if(o==65535)return[[],ka(e,n-2)];var d=Su(e,o,a);return n!==o+s&&(l=Cu(e,n-o-s,d,a)),e.l=r,[d,l]}function p7(e,n,a){var r=e.l+n,s=a.biff==2?1:2,l,o=e.read_shift(s);if(o==65535)return[[],ka(e,n-2)];var d=Su(e,o,a);return n!==o+s&&(l=Cu(e,n-o-s,d,a)),e.l=r,[d,l]}function g7(e,n,a,r){var s=e.l+n,l=Su(e,r,a),o;return s!==e.l&&(o=Cu(e,s-e.l,l,a)),[l,o]}function y7(e,n,a){var r=e.l+n,s,l=e.read_shift(2),o=Su(e,l,a);return l==65535?[[],ka(e,n-2)]:(n!==l+2&&(s=Cu(e,r-l-2,o,a)),[o,s])}function v7(e){var n;if(Qs(e,e.l+6)!==65535)return[ja(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return n=e[e.l+2]===1,e.l+=8,[n,"b"];case 2:return n=e[e.l+2],e.l+=8,[n,"e"];case 3:return e.l+=8,["","s"]}return[]}function b7(e){if(e==null){var n=Ce(8);return n.write_shift(1,3),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,65535),n}else if(typeof e=="number")return io(e);return io(0)}function Cf(e,n,a){var r=e.l+n,s=Es(e);a.biff==2&&++e.l;var l=v7(e),o=e.read_shift(1);a.biff!=2&&(e.read_shift(1),a.biff>=5&&e.read_shift(4));var d=p7(e,r-e.l,a);return{cell:s,val:l[0],formula:d,shared:o>>3&1,tt:l[1]}}function N7(e,n,a,r,s){var l=oo(n,a,s),o=b7(e.v),d=Ce(6),u=33;d.write_shift(2,u),d.write_shift(4,0);for(var h=Ce(e.bf.length),m=0;m<e.bf.length;++m)h[m]=e.bf[m];var f=ea([l,o,d,h]);return f}function ix(e,n,a){var r=e.read_shift(4),s=Su(e,r,a),l=e.read_shift(4),o=l>0?Cu(e,l,s,a):null;return[s,o]}var j7=ix,lx=ix,w7=ix,k7=ix,T7={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Zk={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},C7={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function YN(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,a){return a.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function S7(e){var n="of:="+e.replace(Hg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return n.replace(/;/g,"|").replace(/,/g,";")}function Sf(e){var n=e.split(":"),a=n[0].split(".")[0];return[a,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}function _7(e){return e.replace(/\./,"!")}var Hd={},lc={},Vd=typeof Map<"u";function Kg(e,n,a){var r=0,s=e.length;if(a){if(Vd?a.has(n):Object.prototype.hasOwnProperty.call(a,n)){for(var l=Vd?a.get(n):a[n];r<l.length;++r)if(e[l[r]].t===n)return e.Count++,l[r]}}else for(;r<s;++r)if(e[r].t===n)return e.Count++,r;return e[s]={t:n},e.Count++,e.Unique++,a&&(Vd?(a.has(n)||a.set(n,[]),a.get(n).push(s)):(Object.prototype.hasOwnProperty.call(a,n)||(a[n]=[]),a[n].push(s))),s}function ox(e,n){var a={min:e+1,max:e+1},r=-1;return n.MDW&&(ba=n.MDW),n.width!=null?a.customWidth=1:n.wpx!=null?r=ru(n.wpx):n.wch!=null&&(r=n.wch),r>-1?(a.width=L0(r),a.customWidth=1):n.width!=null&&(a.width=n.width),n.hidden&&(a.hidden=!0),n.level!=null&&(a.outlineLevel=a.level=n.level),a}function Zl(e,n){if(e){var a=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(a=[1,1,1,1,.5,.5]),e.left==null&&(e.left=a[0]),e.right==null&&(e.right=a[1]),e.top==null&&(e.top=a[2]),e.bottom==null&&(e.bottom=a[3]),e.header==null&&(e.header=a[4]),e.footer==null&&(e.footer=a[5])}}function hl(e,n,a){var r=a.revssf[n.z!=null?n.z:"General"],s=60,l=e.length;if(r==null&&a.ssf){for(;s<392;++s)if(a.ssf[s]==null){ni(n.z,s),a.ssf[s]=n.z,a.revssf[n.z]=r=s;break}}for(s=0;s!=l;++s)if(e[s].numFmtId===r)return s;return e[l]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function eT(e,n,a,r,s,l){try{r.cellNF&&(e.z=ct[n])}catch(d){if(r.WTF)throw d}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=cn(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(ct[n]==null&&ni(TA[n]||"General",n),e.t==="e")e.w=e.w||di[e.v];else if(n===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yd(e.v);else if(e.t==="d"){var o=zn(e.v);(o|0)===o?e.w=o.toString(10):e.w=Yd(o)}else{if(e.v===void 0)return"";e.w=ro(e.v,lc)}else e.t==="d"?e.w=Mr(n,zn(e.v),lc):e.w=Mr(n,e.v,lc)}catch(d){if(r.WTF)throw d}if(r.cellStyles&&a!=null)try{e.s=l.Fills[a],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=P0(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=P0(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(d){if(r.WTF&&l.Fills)throw d}}}function E7(e,n,a){if(e&&e["!ref"]){var r=Dt(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+a+"): "+e["!ref"])}}function D7(e,n){var a=Dt(n);a.s.r<=a.e.r&&a.s.c<=a.e.c&&a.s.r>=0&&a.s.c>=0&&(e["!ref"]=pt(a))}var F7=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,A7=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,P7=/<(?:\w:)?hyperlink [^>]*>/mg,L7=/"(\w*:\w*)"/,O7=/<(?:\w:)?col\b[^>]*[\/]?>/g,I7=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,M7=/<(?:\w:)?pageMargins[^>]*\/>/g,tT=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,R7=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,B7=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function H7(e,n,a,r,s,l,o){if(!e)return e;r||(r={"!id":{}});var d=n.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",m="",f=e.match(A7);f?(h=e.slice(0,f.index),m=e.slice(f.index+f[0].length)):h=m=e;var p=h.match(tT);p?zg(p[0],d,s,a):(p=h.match(R7))&&U7(p[0],p[1]||"",d,s,a);var b=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(b>0){var g=h.slice(b,b+50).match(L7);g&&D7(d,g[1])}var y=h.match(B7);y&&y[1]&&tR(y[1],s);var N=[];if(n.cellStyles){var C=h.match(O7);C&&Q7(N,C)}f&&rR(f[1],d,n,u,l,o);var T=m.match(I7);T&&(d["!autofilter"]=J7(T[0]));var S=[],k=m.match(F7);if(k)for(b=0;b!=k.length;++b)S[b]=Dt(k[b].slice(k[b].indexOf('"')+1));var _=m.match(P7);_&&q7(d,_,r);var P=m.match(M7);if(P&&(d["!margins"]=W7(ut(P[0]))),!d["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(d["!ref"]=pt(u)),n.sheetRows>0&&d["!ref"]){var j=Dt(d["!ref"]);n.sheetRows<=+j.e.r&&(j.e.r=n.sheetRows-1,j.e.r>u.e.r&&(j.e.r=u.e.r),j.e.r<j.s.r&&(j.s.r=j.e.r),j.e.c>u.e.c&&(j.e.c=u.e.c),j.e.c<j.s.c&&(j.s.c=j.e.c),d["!fullref"]=d["!ref"],d["!ref"]=pt(j))}return N.length>0&&(d["!cols"]=N),S.length>0&&(d["!merges"]=S),d}function V7(e){if(e.length===0)return"";for(var n='<mergeCells count="'+e.length+'">',a=0;a!=e.length;++a)n+='<mergeCell ref="'+pt(e[a])+'"/>';return n+"</mergeCells>"}function zg(e,n,a,r){var s=ut(e);a.Sheets[r]||(a.Sheets[r]={}),s.codeName&&(a.Sheets[r].CodeName=Et(Xt(s.codeName)))}function U7(e,n,a,r,s){zg(e.slice(0,e.indexOf(">")),a,r,s)}function K7(e,n,a,r,s){var l=!1,o={},d=null;if(r.bookType!=="xlsx"&&n.vbaraw){var u=n.SheetNames[a];try{n.Workbook&&(u=n.Workbook.Sheets[a].CodeName||u)}catch{}l=!0,o.codeName=Ns($t(u))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),d=(d||"")+Ve("outlinePr",null,h)}!l&&!d||(s[s.length]=Ve("sheetPr",d,o))}var z7=["objects","scenarios","selectLockedCells","selectUnlockedCells"],$7=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function G7(e){var n={sheet:1};return z7.forEach(function(a){e[a]!=null&&e[a]&&(n[a]="1")}),$7.forEach(function(a){e[a]!=null&&!e[a]&&(n[a]="0")}),e.password&&(n.password=Mg(e.password).toString(16).toUpperCase()),Ve("sheetProtection",null,n)}function q7(e,n,a){for(var r=Array.isArray(e),s=0;s!=n.length;++s){var l=ut(Xt(n[s]),!0);if(!l.ref)return;var o=((a||{})["!id"]||[])[l.id];o?(l.Target=o.Target,l.location&&(l.Target+="#"+Et(l.location))):(l.Target="#"+Et(l.location),o={Target:l.Target,TargetMode:"Internal"}),l.Rel=o,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var d=Dt(l.ref),u=d.s.r;u<=d.e.r;++u)for(var h=d.s.c;h<=d.e.c;++h){var m=dt({c:h,r:u});r?(e[u]||(e[u]=[]),e[u][h]||(e[u][h]={t:"z",v:void 0}),e[u][h].l=l):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=l)}}}function W7(e){var n={};return["left","right","top","bottom","header","footer"].forEach(function(a){e[a]&&(n[a]=parseFloat(e[a]))}),n}function X7(e){return Zl(e),Ve("pageMargins",null,e)}function Q7(e,n){for(var a=!1,r=0;r!=n.length;++r){var s=ut(n[r],!0);s.hidden&&(s.hidden=sn(s.hidden));var l=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!a&&s.width&&(a=!0,Rg(s.width)),sl(s);l<=o;)e[l++]=dn(s)}}function Y7(e,n){for(var a=["<cols>"],r,s=0;s!=n.length;++s)(r=n[s])&&(a[a.length]=Ve("col",null,ox(s,r)));return a[a.length]="</cols>",a.join("")}function J7(e){var n={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return n}function Z7(e,n,a,r){var s=typeof e.ref=="string"?e.ref:pt(e.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var l=a.Workbook.Names,o=er(s);o.s.r==o.e.r&&(o.e.r=er(n["!ref"]).e.r,s=pt(o));for(var d=0;d<l.length;++d){var u=l[d];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r){u.Ref="'"+a.SheetNames[r]+"'!"+s;break}}return d==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+a.SheetNames[r]+"'!"+s}),Ve("autoFilter",null,{ref:s})}var eR=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function tR(e,n){n.Views||(n.Views=[{}]),(e.match(eR)||[]).forEach(function(a,r){var s=ut(a);n.Views[r]||(n.Views[r]={}),+s.zoomScale&&(n.Views[r].zoom=+s.zoomScale),sn(s.rightToLeft)&&(n.Views[r].RTL=!0)})}function nR(e,n,a,r){var s={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Ve("sheetViews",Ve("sheetView",null,s),{})}function aR(e,n,a,r){if(e.c&&a["!comments"].push([n,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",l=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=di[e.v];break;case"d":r&&r.cellDates?s=cn(e.v,-1).toISOString():(e=dn(e),e.t="n",s=""+(e.v=zn(cn(e.v)))),typeof e.z>"u"&&(e.z=ct[14]);break;default:s=e.v;break}var d=da("v",$t(s)),u={r:n},h=hl(r.cellXfs,e,r);switch(h!==0&&(u.s=h),e.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){d=da("v",""+Kg(r.Strings,e.v,r.revStrings)),u.t="s";break}u.t="str";break}if(e.t!=l&&(e.t=l,e.v=o),typeof e.f=="string"&&e.f){var m=e.F&&e.F.slice(0,n.length)==n?{t:"array",ref:e.F}:null;d=Ve("f",$t(e.f),m)+(e.v!=null?d:"")}return e.l&&a["!links"].push([n,e.l]),e.D&&(u.cm=1),Ve("c",d,u)}var rR=(function(){var e=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,a=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,l=Jd("v"),o=Jd("f");return function(u,h,m,f,p,b){for(var g=0,y="",N=[],C=[],T=0,S=0,k=0,_="",P,j,A=0,L=0,W,R,M=0,q=0,ee=Array.isArray(b.CellXf),z,fe=[],ae=[],J=Array.isArray(h),G=[],he={},H=!1,F=!!m.sheetStubs,I=u.split(n),O=0,V=I.length;O!=V;++O){y=I[O].trim();var te=y.length;if(te!==0){var pe=0;e:for(g=0;g<te;++g)switch(y[g]){case">":if(y[g-1]!="/"){++g;break e}if(m&&m.cellStyles){if(j=ut(y.slice(pe,g),!0),A=j.r!=null?parseInt(j.r,10):A+1,L=-1,m.sheetRows&&m.sheetRows<A)continue;he={},H=!1,j.ht&&(H=!0,he.hpt=parseFloat(j.ht),he.hpx=Sc(he.hpt)),j.hidden=="1"&&(H=!0,he.hidden=!0),j.outlineLevel!=null&&(H=!0,he.level=+j.outlineLevel),H&&(G[A-1]=he)}break;case"<":pe=g;break}if(pe>=g)break;if(j=ut(y.slice(pe,g),!0),A=j.r!=null?parseInt(j.r,10):A+1,L=-1,!(m.sheetRows&&m.sheetRows<A)){f.s.r>A-1&&(f.s.r=A-1),f.e.r<A-1&&(f.e.r=A-1),m&&m.cellStyles&&(he={},H=!1,j.ht&&(H=!0,he.hpt=parseFloat(j.ht),he.hpx=Sc(he.hpt)),j.hidden=="1"&&(H=!0,he.hidden=!0),j.outlineLevel!=null&&(H=!0,he.level=+j.outlineLevel),H&&(G[A-1]=he)),N=y.slice(g).split(e);for(var U=0;U!=N.length&&N[U].trim().charAt(0)=="<";++U);for(N=N.slice(U),g=0;g!=N.length;++g)if(y=N[g].trim(),y.length!==0){if(C=y.match(a),T=g,S=0,k=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,C!=null&&C.length===2){for(T=0,_=C[1],S=0;S!=_.length&&!((k=_.charCodeAt(S)-64)<1||k>26);++S)T=26*T+k;--T,L=T}else++L;for(S=0;S!=y.length&&y.charCodeAt(S)!==62;++S);if(++S,j=ut(y.slice(0,S),!0),j.r||(j.r=dt({r:A-1,c:L})),_=y.slice(S),P={t:""},(C=_.match(l))!=null&&C[1]!==""&&(P.v=Et(C[1])),m.cellFormula){if((C=_.match(o))!=null&&C[1]!==""){if(P.f=Et(Xt(C[1])).replace(/\r\n/g,`
`),m.xlfn||(P.f=qN(P.f)),C[0].indexOf('t="array"')>-1)P.F=(_.match(s)||[])[1],P.F.indexOf(":")>-1&&fe.push([Dt(P.F),P.F]);else if(C[0].indexOf('t="shared"')>-1){R=ut(C[0]);var ce=Et(Xt(C[1]));m.xlfn||(ce=qN(ce)),ae[parseInt(R.si,10)]=[R,ce,j.r]}}else(C=_.match(/<f[^>]*\/>/))&&(R=ut(C[0]),ae[R.si]&&(P.f=eM(ae[R.si][1],ae[R.si][2],j.r)));var Q=gn(j.r);for(S=0;S<fe.length;++S)Q.r>=fe[S][0].s.r&&Q.r<=fe[S][0].e.r&&Q.c>=fe[S][0].s.c&&Q.c<=fe[S][0].e.c&&(P.F=fe[S][1])}if(j.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(F)P.t="z";else continue;else P.t=j.t||"n";switch(f.s.c>L&&(f.s.c=L),f.e.c<L&&(f.e.c=L),P.t){case"n":if(P.v==""||P.v==null){if(!F)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!F)continue;P.t="z"}else W=Hd[parseInt(P.v,10)],P.v=W.t,P.r=W.r,m.cellHTML&&(P.h=W.h);break;case"str":P.t="s",P.v=P.v!=null?Xt(P.v):"",m.cellHTML&&(P.h=jg(P.v));break;case"inlineStr":C=_.match(r),P.t="s",C!=null&&(W=Ig(C[1]))?(P.v=W.t,m.cellHTML&&(P.h=W.h)):P.v="";break;case"b":P.v=sn(P.v);break;case"d":m.cellDates?P.v=cn(P.v,1):(P.v=zn(cn(P.v,1)),P.t="n");break;case"e":(!m||m.cellText!==!1)&&(P.w=P.v),P.v=ak[P.v];break}if(M=q=0,z=null,ee&&j.s!==void 0&&(z=b.CellXf[j.s],z!=null&&(z.numFmtId!=null&&(M=z.numFmtId),m.cellStyles&&z.fillId!=null&&(q=z.fillId))),eT(P,M,q,m,p,b),m.cellDates&&ee&&P.t=="n"&&Pc(ct[M])&&(P.t="d",P.v=rx(P.v)),j.cm&&m.xlmeta){var oe=(m.xlmeta.Cell||[])[+j.cm-1];oe&&oe.type=="XLDAPR"&&(P.D=!0)}if(J){var X=gn(j.r);h[X.r]||(h[X.r]=[]),h[X.r][X.c]=P}else h[j.r]=P}}}}G.length>0&&(h["!rows"]=G)}})();function sR(e,n,a,r){var s=[],l=[],o=Dt(e["!ref"]),d="",u,h="",m=[],f=0,p=0,b=e["!rows"],g=Array.isArray(e),y={r:h},N,C=-1;for(p=o.s.c;p<=o.e.c;++p)m[p]=pn(p);for(f=o.s.r;f<=o.e.r;++f){for(l=[],h=Dn(f),p=o.s.c;p<=o.e.c;++p){u=m[p]+h;var T=g?(e[f]||[])[p]:e[u];T!==void 0&&(d=aR(T,u,e,n))!=null&&l.push(d)}(l.length>0||b&&b[f])&&(y={r:h},b&&b[f]&&(N=b[f],N.hidden&&(y.hidden=1),C=-1,N.hpx?C=su(N.hpx):N.hpt&&(C=N.hpt),C>-1&&(y.ht=C,y.customHeight=1),N.level&&(y.outlineLevel=N.level)),s[s.length]=Ve("row",l.join(""),y))}if(b)for(;f<b.length;++f)b&&b[f]&&(y={r:f+1},N=b[f],N.hidden&&(y.hidden=1),C=-1,N.hpx?C=su(N.hpx):N.hpt&&(C=N.hpt),C>-1&&(y.ht=C,y.customHeight=1),N.level&&(y.outlineLevel=N.level),s[s.length]=Ve("row","",y));return s.join("")}function nT(e,n,a,r){var s=[Fn,Ve("worksheet",null,{xmlns:mo[0],"xmlns:r":Kn.r})],l=a.SheetNames[e],o=0,d="",u=a.Sheets[l];u==null&&(u={});var h=u["!ref"]||"A1",m=Dt(h);if(m.e.c>16383||m.e.r>1048575){if(n.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),h=pt(m)}r||(r={}),u["!comments"]=[];var f=[];K7(u,a,e,n,s),s[s.length]=Ve("dimension",null,{ref:h}),s[s.length]=nR(u,n,e,a),n.sheetFormat&&(s[s.length]=Ve("sheetFormatPr",null,{defaultRowHeight:n.sheetFormat.defaultRowHeight||"16",baseColWidth:n.sheetFormat.baseColWidth||"10",outlineLevelRow:n.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(s[s.length]=Y7(u,u["!cols"])),s[o=s.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(d=sR(u,n),d.length>0&&(s[s.length]=d)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),u["!protect"]&&(s[s.length]=G7(u["!protect"])),u["!autofilter"]!=null&&(s[s.length]=Z7(u["!autofilter"],u,a,e)),u["!merges"]!=null&&u["!merges"].length>0&&(s[s.length]=V7(u["!merges"]));var p=-1,b,g=-1;return u["!links"].length>0&&(s[s.length]="<hyperlinks>",u["!links"].forEach(function(y){y[1].Target&&(b={ref:y[0]},y[1].Target.charAt(0)!="#"&&(g=zt(r,-1,$t(y[1].Target).replace(/#.*$/,""),jt.HLINK),b["r:id"]="rId"+g),(p=y[1].Target.indexOf("#"))>-1&&(b.location=$t(y[1].Target.slice(p+1))),y[1].Tooltip&&(b.tooltip=$t(y[1].Tooltip)),s[s.length]=Ve("hyperlink",null,b))}),s[s.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(s[s.length]=X7(u["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&(s[s.length]=da("ignoredErrors",Ve("ignoredError",null,{numberStoredAsText:1,sqref:h}))),f.length>0&&(g=zt(r,-1,"../drawings/drawing"+(e+1)+".xml",jt.DRAW),s[s.length]=Ve("drawing",null,{"r:id":"rId"+g}),u["!drawing"]=f),u["!comments"].length>0&&(g=zt(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",jt.VML),s[s.length]=Ve("legacyDrawing",null,{"r:id":"rId"+g}),u["!legacy"]=g),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function iR(e,n){var a={},r=e.l+n;a.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=r,l&7&&(a.level=l&7),l&16&&(a.hidden=!0),l&32&&(a.hpt=s/20),a}function lR(e,n,a){var r=Ce(145),s=(a["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var l=320;s.hpx?l=su(s.hpx)*20:s.hpt&&(l=s.hpt*20),r.write_shift(2,l),r.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var d=0,u=r.l;r.l+=4;for(var h={r:e,c:0},m=0;m<16;++m)if(!(n.s.c>m+1<<10||n.e.c<m<<10)){for(var f=-1,p=-1,b=m<<10;b<m+1<<10;++b){h.c=b;var g=Array.isArray(a)?(a[h.r]||[])[h.c]:a[dt(h)];g&&(f<0&&(f=b),p=b)}f<0||(++d,r.write_shift(4,f),r.write_shift(4,p))}var y=r.l;return r.l=u,r.write_shift(4,d),r.l=y,r.length>r.l?r.slice(0,r.l):r}function oR(e,n,a,r){var s=lR(r,a,n);(s.length>17||(n["!rows"]||[])[r])&&Ee(e,0,s)}var cR=yo,dR=Ic;function uR(){}function hR(e,n){var a={},r=e[e.l];return++e.l,a.above=!(r&64),a.left=!(r&128),e.l+=18,a.name=f8(e),a}function xR(e,n,a){a==null&&(a=Ce(84+4*e.length));var r=192;n&&(n.above&&(r&=-65),n.left&&(r&=-129)),a.write_shift(1,r);for(var s=1;s<3;++s)a.write_shift(1,0);return D0({auto:1},a),a.write_shift(-4,-1),a.write_shift(-4,-1),Jw(e,a),a.slice(0,a.l)}function mR(e){var n=Br(e);return[n]}function fR(e,n,a){return a==null&&(a=Ce(8)),fo(n,a)}function pR(e){var n=po(e);return[n]}function gR(e,n,a){return a==null&&(a=Ce(4)),go(n,a)}function yR(e){var n=Br(e),a=e.read_shift(1);return[n,a,"b"]}function vR(e,n,a){return a==null&&(a=Ce(9)),fo(n,a),a.write_shift(1,e.v?1:0),a}function bR(e){var n=po(e),a=e.read_shift(1);return[n,a,"b"]}function NR(e,n,a){return a==null&&(a=Ce(5)),go(n,a),a.write_shift(1,e.v?1:0),a}function jR(e){var n=Br(e),a=e.read_shift(1);return[n,a,"e"]}function wR(e,n,a){return a==null&&(a=Ce(9)),fo(n,a),a.write_shift(1,e.v),a}function kR(e){var n=po(e),a=e.read_shift(1);return[n,a,"e"]}function TR(e,n,a){return a==null&&(a=Ce(8)),go(n,a),a.write_shift(1,e.v),a.write_shift(2,0),a.write_shift(1,0),a}function CR(e){var n=Br(e),a=e.read_shift(4);return[n,a,"s"]}function SR(e,n,a){return a==null&&(a=Ce(12)),fo(n,a),a.write_shift(4,n.v),a}function _R(e){var n=po(e),a=e.read_shift(4);return[n,a,"s"]}function ER(e,n,a){return a==null&&(a=Ce(8)),go(n,a),a.write_shift(4,n.v),a}function DR(e){var n=Br(e),a=ja(e);return[n,a,"n"]}function FR(e,n,a){return a==null&&(a=Ce(16)),fo(n,a),io(e.v,a),a}function aT(e){var n=po(e),a=ja(e);return[n,a,"n"]}function AR(e,n,a){return a==null&&(a=Ce(12)),go(n,a),io(e.v,a),a}function PR(e){var n=Br(e),a=Fg(e);return[n,a,"n"]}function LR(e,n,a){return a==null&&(a=Ce(12)),fo(n,a),Zw(e.v,a),a}function OR(e){var n=po(e),a=Fg(e);return[n,a,"n"]}function IR(e,n,a){return a==null&&(a=Ce(8)),go(n,a),Zw(e.v,a),a}function MR(e){var n=Br(e),a=_g(e);return[n,a,"is"]}function RR(e){var n=Br(e),a=wa(e);return[n,a,"str"]}function BR(e,n,a){return a==null&&(a=Ce(12+4*e.v.length)),fo(n,a),ta(e.v,a),a.length>a.l?a.slice(0,a.l):a}function HR(e){var n=po(e),a=wa(e);return[n,a,"str"]}function VR(e,n,a){return a==null&&(a=Ce(8+4*e.v.length)),go(n,a),ta(e.v,a),a.length>a.l?a.slice(0,a.l):a}function UR(e,n,a){var r=e.l+n,s=Br(e);s.r=a["!row"];var l=e.read_shift(1),o=[s,l,"b"];if(a.cellFormula){e.l+=2;var d=lx(e,r-e.l,a);o[3]=va(d,null,s,a.supbooks,a)}else e.l=r;return o}function KR(e,n,a){var r=e.l+n,s=Br(e);s.r=a["!row"];var l=e.read_shift(1),o=[s,l,"e"];if(a.cellFormula){e.l+=2;var d=lx(e,r-e.l,a);o[3]=va(d,null,s,a.supbooks,a)}else e.l=r;return o}function zR(e,n,a){var r=e.l+n,s=Br(e);s.r=a["!row"];var l=ja(e),o=[s,l,"n"];if(a.cellFormula){e.l+=2;var d=lx(e,r-e.l,a);o[3]=va(d,null,s,a.supbooks,a)}else e.l=r;return o}function $R(e,n,a){var r=e.l+n,s=Br(e);s.r=a["!row"];var l=wa(e),o=[s,l,"str"];if(a.cellFormula){e.l+=2;var d=lx(e,r-e.l,a);o[3]=va(d,null,s,a.supbooks,a)}else e.l=r;return o}var GR=yo,qR=Ic;function WR(e,n){return n==null&&(n=Ce(4)),n.write_shift(4,e),n}function XR(e,n){var a=e.l+n,r=yo(e),s=Eg(e),l=wa(e),o=wa(e),d=wa(e);e.l=a;var u={rfx:r,relId:s,loc:l,display:d};return o&&(u.Tooltip=o),u}function QR(e,n){var a=Ce(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ic({s:gn(e[0]),e:gn(e[0])},a),Dg("rId"+n,a);var r=e[1].Target.indexOf("#"),s=r==-1?"":e[1].Target.slice(r+1);return ta(s||"",a),ta(e[1].Tooltip||"",a),ta("",a),a.slice(0,a.l)}function YR(){}function JR(e,n,a){var r=e.l+n,s=ek(e),l=e.read_shift(1),o=[s];if(o[2]=l,a.cellFormula){var d=j7(e,r-e.l,a);o[1]=d}else e.l=r;return o}function ZR(e,n,a){var r=e.l+n,s=yo(e),l=[s];if(a.cellFormula){var o=k7(e,r-e.l,a);l[1]=o,e.l=r}else e.l=r;return l}function eB(e,n,a){a==null&&(a=Ce(18));var r=ox(e,n);a.write_shift(-4,e),a.write_shift(-4,e),a.write_shift(4,(r.width||10)*256),a.write_shift(4,0);var s=0;return n.hidden&&(s|=1),typeof r.width=="number"&&(s|=2),n.level&&(s|=n.level<<8),a.write_shift(2,s),a}var rT=["left","right","top","bottom","header","footer"];function tB(e){var n={};return rT.forEach(function(a){n[a]=ja(e)}),n}function nB(e,n){return n==null&&(n=Ce(48)),Zl(e),rT.forEach(function(a){io(e[a],n)}),n}function aB(e){var n=e.read_shift(2);return e.l+=28,{RTL:n&32}}function rB(e,n,a){a==null&&(a=Ce(30));var r=924;return(((n||{}).Views||[])[0]||{}).RTL&&(r|=32),a.write_shift(2,r),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(2,0),a.write_shift(2,100),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(4,0),a}function sB(e){var n=Ce(24);return n.write_shift(4,4),n.write_shift(4,1),Ic(e,n),n}function iB(e,n){return n==null&&(n=Ce(66)),n.write_shift(2,e.password?Mg(e.password):0),n.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(a){a[1]?n.write_shift(4,e[a[0]]!=null&&!e[a[0]]?1:0):n.write_shift(4,e[a[0]]!=null&&e[a[0]]?0:1)}),n}function lB(){}function oB(){}function cB(e,n,a,r,s,l,o){if(!e)return e;var d=n||{};r||(r={"!id":{}});var u=d.dense?[]:{},h,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,p=!1,b,g,y,N,C,T,S,k,_,P=[];d.biff=12,d["!row"]=0;var j=0,A=!1,L=[],W={},R=d.supbooks||s.supbooks||[[]];if(R.sharedf=W,R.arrayf=L,R.SheetNames=s.SheetNames||s.Sheets.map(function(J){return J.name}),!d.supbooks&&(d.supbooks=R,s.Names))for(var M=0;M<s.Names.length;++M)R[0][M+1]=s.Names[M];var q=[],ee=[],z=!1;iu[16]={n:"BrtShortReal",f:aT};var fe;if(ci(e,function(G,he,H){if(!p)switch(H){case 148:h=G;break;case 0:b=G,d.sheetRows&&d.sheetRows<=b.r&&(p=!0),k=Dn(N=b.r),d["!row"]=b.r,(G.hidden||G.hpt||G.level!=null)&&(G.hpt&&(G.hpx=Sc(G.hpt)),ee[G.r]=G);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:G[2]},G[2]){case"n":g.v=G[1];break;case"s":S=Hd[G[1]],g.v=S.t,g.r=S.r;break;case"b":g.v=!!G[1];break;case"e":g.v=G[1],d.cellText!==!1&&(g.w=di[g.v]);break;case"str":g.t="s",g.v=G[1];break;case"is":g.t="s",g.v=G[1].t;break}if((y=o.CellXf[G[0].iStyleRef])&&eT(g,y.numFmtId,null,d,l,o),C=G[0].c==-1?C+1:G[0].c,d.dense?(u[N]||(u[N]=[]),u[N][C]=g):u[pn(C)+k]=g,d.cellFormula){for(A=!1,j=0;j<L.length;++j){var F=L[j];b.r>=F[0].s.r&&b.r<=F[0].e.r&&C>=F[0].s.c&&C<=F[0].e.c&&(g.F=pt(F[0]),A=!0)}!A&&G.length>3&&(g.f=G[3])}if(m.s.r>b.r&&(m.s.r=b.r),m.s.c>C&&(m.s.c=C),m.e.r<b.r&&(m.e.r=b.r),m.e.c<C&&(m.e.c=C),d.cellDates&&y&&g.t=="n"&&Pc(ct[y.numFmtId])){var I=Rl(g.v);I&&(g.t="d",g.v=new Date(I.y,I.m-1,I.d,I.H,I.M,I.S,I.u))}fe&&(fe.type=="XLDAPR"&&(g.D=!0),fe=void 0);break;case 1:case 12:if(!d.sheetStubs||f)break;g={t:"z",v:void 0},C=G[0].c==-1?C+1:G[0].c,d.dense?(u[N]||(u[N]=[]),u[N][C]=g):u[pn(C)+k]=g,m.s.r>b.r&&(m.s.r=b.r),m.s.c>C&&(m.s.c=C),m.e.r<b.r&&(m.e.r=b.r),m.e.c<C&&(m.e.c=C),fe&&(fe.type=="XLDAPR"&&(g.D=!0),fe=void 0);break;case 176:P.push(G);break;case 49:fe=((d.xlmeta||{}).Cell||[])[G-1];break;case 494:var O=r["!id"][G.relId];for(O?(G.Target=O.Target,G.loc&&(G.Target+="#"+G.loc),G.Rel=O):G.relId==""&&(G.Target="#"+G.loc),N=G.rfx.s.r;N<=G.rfx.e.r;++N)for(C=G.rfx.s.c;C<=G.rfx.e.c;++C)d.dense?(u[N]||(u[N]=[]),u[N][C]||(u[N][C]={t:"z",v:void 0}),u[N][C].l=G):(T=dt({c:C,r:N}),u[T]||(u[T]={t:"z",v:void 0}),u[T].l=G);break;case 426:if(!d.cellFormula)break;L.push(G),_=d.dense?u[N][C]:u[pn(C)+k],_.f=va(G[1],m,{r:b.r,c:C},R,d),_.F=pt(G[0]);break;case 427:if(!d.cellFormula)break;W[dt(G[0].s)]=G[1],_=d.dense?u[N][C]:u[pn(C)+k],_.f=va(G[1],m,{r:b.r,c:C},R,d);break;case 60:if(!d.cellStyles)break;for(;G.e>=G.s;)q[G.e--]={width:G.w/256,hidden:!!(G.flags&1),level:G.level},z||(z=!0,Rg(G.w/256)),sl(q[G.e+1]);break;case 161:u["!autofilter"]={ref:pt(G)};break;case 476:u["!margins"]=G;break;case 147:s.Sheets[a]||(s.Sheets[a]={}),G.name&&(s.Sheets[a].CodeName=G.name),(G.above||G.left)&&(u["!outline"]={above:G.above,left:G.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),G.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!he.T){if(!f||d.WTF)throw new Error("Unexpected record 0x"+H.toString(16))}}},d),delete d.supbooks,delete d["!row"],!u["!ref"]&&(m.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(u["!ref"]=pt(h||m)),d.sheetRows&&u["!ref"]){var ae=Dt(u["!ref"]);d.sheetRows<=+ae.e.r&&(ae.e.r=d.sheetRows-1,ae.e.r>m.e.r&&(ae.e.r=m.e.r),ae.e.r<ae.s.r&&(ae.s.r=ae.e.r),ae.e.c>m.e.c&&(ae.e.c=m.e.c),ae.e.c<ae.s.c&&(ae.s.c=ae.e.c),u["!fullref"]=u["!ref"],u["!ref"]=pt(ae))}return P.length>0&&(u["!merges"]=P),q.length>0&&(u["!cols"]=q),ee.length>0&&(u["!rows"]=ee),u}function dB(e,n,a,r,s,l,o){if(n.v===void 0)return!1;var d="";switch(n.t){case"b":d=n.v?"1":"0";break;case"d":n=dn(n),n.z=n.z||ct[14],n.v=zn(cn(n.v)),n.t="n";break;case"n":case"e":d=""+n.v;break;default:d=n.v;break}var u={r:a,c:r};switch(u.s=hl(s.cellXfs,n,s),n.l&&l["!links"].push([dt(u),n.l]),n.c&&l["!comments"].push([dt(u),n.c]),n.t){case"s":case"str":return s.bookSST?(d=Kg(s.Strings,n.v,s.revStrings),u.t="s",u.v=d,o?Ee(e,18,ER(n,u)):Ee(e,7,SR(n,u))):(u.t="str",o?Ee(e,17,VR(n,u)):Ee(e,6,BR(n,u))),!0;case"n":return n.v==(n.v|0)&&n.v>-1e3&&n.v<1e3?o?Ee(e,13,IR(n,u)):Ee(e,2,LR(n,u)):o?Ee(e,16,AR(n,u)):Ee(e,5,FR(n,u)),!0;case"b":return u.t="b",o?Ee(e,15,NR(n,u)):Ee(e,4,vR(n,u)),!0;case"e":return u.t="e",o?Ee(e,14,TR(n,u)):Ee(e,3,wR(n,u)),!0}return o?Ee(e,12,gR(n,u)):Ee(e,1,fR(n,u)),!0}function uB(e,n,a,r){var s=Dt(n["!ref"]||"A1"),l,o="",d=[];Ee(e,145);var u=Array.isArray(n),h=s.e.r;n["!rows"]&&(h=Math.max(s.e.r,n["!rows"].length-1));for(var m=s.s.r;m<=h;++m){o=Dn(m),oR(e,n,s,m);var f=!1;if(m<=s.e.r)for(var p=s.s.c;p<=s.e.c;++p){m===s.s.r&&(d[p]=pn(p)),l=d[p]+o;var b=u?(n[m]||[])[p]:n[l];if(!b){f=!1;continue}f=dB(e,b,m,p,r,n,f)}}Ee(e,146)}function hB(e,n){!n||!n["!merges"]||(Ee(e,177,WR(n["!merges"].length)),n["!merges"].forEach(function(a){Ee(e,176,qR(a))}),Ee(e,178))}function xB(e,n){!n||!n["!cols"]||(Ee(e,390),n["!cols"].forEach(function(a,r){a&&Ee(e,60,eB(r,a))}),Ee(e,391))}function mB(e,n){!n||!n["!ref"]||(Ee(e,648),Ee(e,649,sB(Dt(n["!ref"]))),Ee(e,650))}function fB(e,n,a){n["!links"].forEach(function(r){if(r[1].Target){var s=zt(a,-1,r[1].Target.replace(/#.*$/,""),jt.HLINK);Ee(e,494,QR(r,s))}}),delete n["!links"]}function pB(e,n,a,r){if(n["!comments"].length>0){var s=zt(r,-1,"../drawings/vmlDrawing"+(a+1)+".vml",jt.VML);Ee(e,551,Dg("rId"+s)),n["!legacy"]=s}}function gB(e,n,a,r){if(n["!autofilter"]){var s=n["!autofilter"],l=typeof s.ref=="string"?s.ref:pt(s.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var o=a.Workbook.Names,d=er(l);d.s.r==d.e.r&&(d.e.r=er(n["!ref"]).e.r,l=pt(d));for(var u=0;u<o.length;++u){var h=o[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==r){h.Ref="'"+a.SheetNames[r]+"'!"+l;break}}u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+a.SheetNames[r]+"'!"+l}),Ee(e,161,Ic(Dt(l))),Ee(e,162)}}function yB(e,n,a){Ee(e,133),Ee(e,137,rB(n,a)),Ee(e,138),Ee(e,134)}function vB(e,n){n["!protect"]&&Ee(e,535,iB(n["!protect"]))}function bB(e,n,a,r){var s=Za(),l=a.SheetNames[e],o=a.Sheets[l]||{},d=l;try{a&&a.Workbook&&(d=a.Workbook.Sheets[e].CodeName||d)}catch{}var u=Dt(o["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(n.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Ee(s,129),(a.vbaraw||o["!outline"])&&Ee(s,147,xR(d,o["!outline"])),Ee(s,148,dR(u)),yB(s,o,a.Workbook),xB(s,o),uB(s,o,e,n),vB(s,o),gB(s,o,a,e),hB(s,o),fB(s,o,r),o["!margins"]&&Ee(s,476,nB(o["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&mB(s,o),pB(s,o,e,r),Ee(s,130),s.end()}function NB(e){var n=[],a=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var o=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(n[+o[1]]=a?+o[2]:o[2])});var s=Et((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){r=l.replace(/<.*?>/g,"")}),[n,s,r]}function jB(e,n,a,r,s,l){var o=l||{"!type":"chart"};if(!e)return l;var d=0,u=0,h="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var p=NB(f);m.s.r=m.s.c=0,m.e.c=d,h=pn(d),p[0].forEach(function(b,g){o[h+Dn(g)]={t:"n",v:b,z:p[1]},u=g}),m.e.r<u&&(m.e.r=u),++d}),d>0&&(o["!ref"]=pt(m)),o}function wB(e,n,a,r,s){if(!e)return e;r||(r={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o,d=e.match(tT);return d&&zg(d[0],l,s,a),(o=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=o[1]),r["!id"][l["!rel"]]&&(l["!drawel"]=r["!id"][l["!rel"]]),l}function kB(e,n){e.l+=10;var a=wa(e);return{name:a}}function TB(e,n,a,r,s){if(!e)return e;r||(r={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o=!1;return ci(e,function(u,h,m){switch(m){case 550:l["!rel"]=u;break;case 651:s.Sheets[a]||(s.Sheets[a]={}),u.name&&(s.Sheets[a].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!o||n.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},n),r["!id"][l["!rel"]]&&(l["!drawel"]=r["!id"][l["!rel"]]),l}var $g=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],CB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],SB=[],_B=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function JN(e,n){for(var a=0;a!=e.length;++a)for(var r=e[a],s=0;s!=n.length;++s){var l=n[s];if(r[l[0]]==null)r[l[0]]=l[1];else switch(l[2]){case"bool":typeof r[l[0]]=="string"&&(r[l[0]]=sn(r[l[0]]));break;case"int":typeof r[l[0]]=="string"&&(r[l[0]]=parseInt(r[l[0]],10));break}}}function ZN(e,n){for(var a=0;a!=n.length;++a){var r=n[a];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=sn(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function sT(e){ZN(e.WBProps,$g),ZN(e.CalcPr,_B),JN(e.WBView,CB),JN(e.Sheets,SB),lc.date1904=sn(e.WBProps.date1904)}function EB(e){return!e.Workbook||!e.Workbook.WBProps?"false":sn(e.Workbook.WBProps.date1904)?"true":"false"}var DB="][*?/\\".split("");function iT(e,n){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var a=!0;return DB.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),a}function FB(e,n,a){e.forEach(function(r,s){iT(r);for(var l=0;l<s;++l)if(r==e[l])throw new Error("Duplicate Sheet Name: "+r);if(a){var o=n&&n[s]&&n[s].CodeName||r;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function AB(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var n=e.Workbook&&e.Workbook.Sheets||[];FB(e.SheetNames,n,!!e.vbaraw);for(var a=0;a<e.SheetNames.length;++a)E7(e.Sheets[e.SheetNames[a]],e.SheetNames[a],a)}var PB=/<\w+:workbook/;function LB(e,n){if(!e)throw new Error("Could not find file");var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,s="xmlns",l={},o=0;if(e.replace(Ta,function(u,h){var m=ut(u);switch(_s(m[0])){case"<?xml":break;case"<workbook":u.match(PB)&&(s="xmlns"+u.match(/<(\w+):/)[1]),a.xmlns=m[s];break;case"</workbook>":break;case"<fileVersion":delete m[0],a.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":$g.forEach(function(f){if(m[f[0]]!=null)switch(f[2]){case"bool":a.WBProps[f[0]]=sn(m[f[0]]);break;case"int":a.WBProps[f[0]]=parseInt(m[f[0]],10);break;default:a.WBProps[f[0]]=m[f[0]]}}),m.codeName&&(a.WBProps.CodeName=Xt(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],a.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=Et(Xt(m.name)),delete m[0],a.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":l={},l.Name=Xt(m.name),m.comment&&(l.Comment=m.comment),m.localSheetId&&(l.Sheet=+m.localSheetId),sn(m.hidden||"0")&&(l.Hidden=!0),o=h+u.length;break;case"</definedName>":l.Ref=Et(Xt(e.slice(o,h))),a.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete m[0],a.CalcPr=m;break;case"<calcPr/>":delete m[0],a.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&n.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return u}),mo.indexOf(a.xmlns)===-1)throw new Error("Unknown Namespace: "+a.xmlns);return sT(a),a}function lT(e){var n=[Fn];n[n.length]=Ve("workbook",null,{xmlns:mo[0],"xmlns:r":Kn.r});var a=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&($g.forEach(function(d){e.Workbook.WBProps[d[0]]!=null&&e.Workbook.WBProps[d[0]]!=d[1]&&(r[d[0]]=e.Workbook.WBProps[d[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),n[n.length]=Ve("workbookPr",null,r);var s=e.Workbook&&e.Workbook.Sheets||[],l=0;if(s&&s[0]&&s[0].Hidden){for(n[n.length]="<bookViews>",l=0;l!=e.SheetNames.length&&!(!s[l]||!s[l].Hidden);++l);l==e.SheetNames.length&&(l=0),n[n.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',n[n.length]="</bookViews>"}for(n[n.length]="<sheets>",l=0;l!=e.SheetNames.length;++l){var o={name:$t(e.SheetNames[l].slice(0,31))};if(o.sheetId=""+(l+1),o["r:id"]="rId"+(l+1),s[l])switch(s[l].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}n[n.length]=Ve("sheet",null,o)}return n[n.length]="</sheets>",a&&(n[n.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(d){var u={name:d.Name};d.Comment&&(u.comment=d.Comment),d.Sheet!=null&&(u.localSheetId=""+d.Sheet),d.Hidden&&(u.hidden="1"),d.Ref&&(n[n.length]=Ve("definedName",$t(d.Ref),u))}),n[n.length]="</definedNames>"),n.length>2&&(n[n.length]="</workbook>",n[1]=n[1].replace("/>",">")),n.join("")}function OB(e,n){var a={};return a.Hidden=e.read_shift(4),a.iTabID=e.read_shift(4),a.strRelID=jp(e),a.name=wa(e),a}function IB(e,n){return n||(n=Ce(127)),n.write_shift(4,e.Hidden),n.write_shift(4,e.iTabID),Dg(e.strRelID,n),ta(e.name.slice(0,31),n),n.length>n.l?n.slice(0,n.l):n}function MB(e,n){var a={},r=e.read_shift(4);a.defaultThemeVersion=e.read_shift(4);var s=n>8?wa(e):"";return s.length>0&&(a.CodeName=s),a.autoCompressPictures=!!(r&65536),a.backupFile=!!(r&64),a.checkCompatibility=!!(r&4096),a.date1904=!!(r&1),a.filterPrivacy=!!(r&8),a.hidePivotFieldList=!!(r&1024),a.promptedSolutions=!!(r&16),a.publishItems=!!(r&2048),a.refreshAllConnections=!!(r&262144),a.saveExternalLinkValues=!!(r&128),a.showBorderUnselectedTables=!!(r&4),a.showInkAnnotation=!!(r&32),a.showObjects=["all","placeholders","none"][r>>13&3],a.showPivotChartFilter=!!(r&32768),a.updateLinks=["userSet","never","always"][r>>8&3],a}function RB(e,n){n||(n=Ce(72));var a=0;return e&&e.filterPrivacy&&(a|=8),n.write_shift(4,a),n.write_shift(4,0),Jw(e&&e.CodeName||"ThisWorkbook",n),n.slice(0,n.l)}function BB(e,n){var a={};return e.read_shift(4),a.ArchID=e.read_shift(4),e.l+=n-8,a}function HB(e,n,a){var r=e.l+n;e.l+=4,e.l+=1;var s=e.read_shift(4),l=p8(e),o=w7(e,0,a),d=Eg(e);e.l=r;var u={Name:l,Ptg:o};return s<268435455&&(u.Sheet=s),d&&(u.Comment=d),u}function VB(e,n){var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],s=!1;n||(n={}),n.biff=12;var l=[],o=[[]];return o.SheetNames=[],o.XTI=[],iu[16]={n:"BrtFRTArchID$",f:BB},ci(e,function(u,h,m){switch(m){case 156:o.SheetNames.push(u.name),a.Sheets.push(u);break;case 153:a.WBProps=u;break;case 39:u.Sheet!=null&&(n.SID=u.Sheet),u.Ref=va(u.Ptg,null,null,o,n),delete n.SID,delete u.Ptg,l.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([m,u]):o[0]=[m,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(m),s=!0;break;case 36:r.pop(),s=!1;break;case 37:r.push(m),s=!0;break;case 38:r.pop(),s=!1;break;case 16:break;default:if(!h.T){if(!s||n.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},n),sT(a),a.Names=l,a.supbooks=o,a}function UB(e,n){Ee(e,143);for(var a=0;a!=n.SheetNames.length;++a){var r=n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[a]&&n.Workbook.Sheets[a].Hidden||0,s={Hidden:r,iTabID:a+1,strRelID:"rId"+(a+1),name:n.SheetNames[a]};Ee(e,156,IB(s))}Ee(e,144)}function KB(e,n){n||(n=Ce(127));for(var a=0;a!=4;++a)n.write_shift(4,0);return ta("SheetJS",n),ta(w0.version,n),ta(w0.version,n),ta("7262",n),n.length>n.l?n.slice(0,n.l):n}function zB(e,n){n||(n=Ce(29)),n.write_shift(-4,0),n.write_shift(-4,460),n.write_shift(4,28800),n.write_shift(4,17600),n.write_shift(4,500),n.write_shift(4,e),n.write_shift(4,e);var a=120;return n.write_shift(1,a),n.length>n.l?n.slice(0,n.l):n}function $B(e,n){if(!(!n.Workbook||!n.Workbook.Sheets)){for(var a=n.Workbook.Sheets,r=0,s=-1,l=-1;r<a.length;++r)!a[r]||!a[r].Hidden&&s==-1?s=r:a[r].Hidden==1&&l==-1&&(l=r);l>s||(Ee(e,135),Ee(e,158,zB(s)),Ee(e,136))}}function GB(e,n){var a=Za();return Ee(a,131),Ee(a,128,KB()),Ee(a,153,RB(e.Workbook&&e.Workbook.WBProps||null)),$B(a,e),UB(a,e),Ee(a,132),a.end()}function qB(e,n,a){return n.slice(-4)===".bin"?VB(e,a):LB(e,a)}function WB(e,n,a,r,s,l,o,d){return n.slice(-4)===".bin"?cB(e,r,a,s,l,o,d):H7(e,r,a,s,l,o,d)}function XB(e,n,a,r,s,l,o,d){return n.slice(-4)===".bin"?TB(e,r,a,s,l):wB(e,r,a,s,l)}function QB(e,n,a,r,s,l,o,d){return n.slice(-4)===".bin"?JI():ZI()}function YB(e,n,a,r,s,l,o,d){return n.slice(-4)===".bin"?QI():YI()}function JB(e,n,a,r){return n.slice(-4)===".bin"?qO(e,a,r):OO(e,a,r)}function ZB(e,n,a){return Vk(e,a)}function e9(e,n,a){return n.slice(-4)===".bin"?eO(e,a):YL(e,a)}function t9(e,n,a){return n.slice(-4)===".bin"?$I(e,a):II(e,a)}function n9(e,n,a){return n.slice(-4)===".bin"?PI(e):FI(e)}function a9(e,n,a,r){return a.slice(-4)===".bin"?LI(e,n,a,r):void 0}function r9(e,n,a){return n.slice(-4)===".bin"?_I(e,n,a):DI(e,n,a)}function s9(e,n,a){return(n.slice(-4)===".bin"?GB:lT)(e)}function i9(e,n,a,r,s){return(n.slice(-4)===".bin"?bB:nT)(e,a,r,s)}function l9(e,n,a){return(n.slice(-4)===".bin"?aI:Bk)(e,a)}function o9(e,n,a){return(n.slice(-4)===".bin"?aO:Fk)(e,a)}function c9(e,n,a){return(n.slice(-4)===".bin"?GI:zk)(e)}function d9(e){return(e.slice(-4)===".bin"?EI:Uk)()}var oT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,cT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function qr(e,n){var a=e.split(/\s+/),r=[];if(r[0]=a[0],a.length===1)return r;var s=e.match(oT),l,o,d,u;if(s)for(u=0;u!=s.length;++u)l=s[u].match(cT),(o=l[1].indexOf(":"))===-1?r[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?d="xmlns"+l[1].slice(6):d=l[1].slice(o+1),r[d]=l[2].slice(1,l[2].length-1));return r}function u9(e){var n=e.split(/\s+/),a={};if(n.length===1)return a;var r=e.match(oT),s,l,o,d;if(r)for(d=0;d!=r.length;++d)s=r[d].match(cT),(l=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(l+1),a[o]=s[2].slice(1,s[2].length-1));return a}var Ud;function h9(e,n){var a=Ud[e]||Et(e);return a==="General"?ro(n):Mr(a,n)}function x9(e,n,a,r){var s=r;switch((a[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=sn(r);break;case"i2":case"int":s=parseInt(r,10);break;case"r4":case"float":s=parseFloat(r);break;case"date":case"dateTime.tz":s=cn(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+a[0])}e[Et(n)]=s}function m9(e,n,a){if(e.t!=="z"){if(!a||a.cellText!==!1)try{e.t==="e"?e.w=e.w||di[e.v]:n==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yd(e.v):e.w=ro(e.v):e.w=h9(n||"General",e.v)}catch(l){if(a.WTF)throw l}try{var r=Ud[n]||n||"General";if(a.cellNF&&(e.z=r),a.cellDates&&e.t=="n"&&Pc(r)){var s=Rl(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(l){if(a.WTF)throw l}}}function f9(e,n,a){if(a.cellStyles&&n.Interior){var r=n.Interior;r.Pattern&&(r.patternType=SO[r.Pattern]||r.Pattern)}e[n.ID]=n}function p9(e,n,a,r,s,l,o,d,u,h){var m="General",f=r.StyleID,p={};h=h||{};var b=[],g=0;for(f===void 0&&d&&(f=d.StyleID),f===void 0&&o&&(f=o.StyleID);l[f]!==void 0&&(l[f].nf&&(m=l[f].nf),l[f].Interior&&b.push(l[f].Interior),!!l[f].Parent);)f=l[f].Parent;switch(a.Type){case"Boolean":r.t="b",r.v=sn(e);break;case"String":r.t="s",r.r=pN(Et(e)),r.v=e.indexOf("<")>-1?Et(n||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(cn(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),r.v!==r.v?r.v=Et(e):r.v<60&&(r.v=r.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=ak[e],h.cellText!==!1&&(r.w=e);break;default:e==""&&n==""?r.t="z":(r.t="s",r.v=pN(n||e));break}if(m9(r,m,h),h.cellFormula!==!1)if(r.Formula){var y=Et(r.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),r.f=ic(y,s),delete r.Formula,r.ArrayRange=="RC"?r.F=ic("RC:RC",s):r.ArrayRange&&(r.F=ic(r.ArrayRange,s),u.push([Dt(r.F),r.F]))}else for(g=0;g<u.length;++g)s.r>=u[g][0].s.r&&s.r<=u[g][0].e.r&&s.c>=u[g][0].s.c&&s.c<=u[g][0].e.c&&(r.F=u[g][1]);h.cellStyles&&(b.forEach(function(N){!p.patternType&&N.patternType&&(p.patternType=N.patternType)}),r.s=p),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function g9(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function _f(e,n){var a=n||{};Lc();var r=Dd(wg(e));(a.type=="binary"||a.type=="array"||a.type=="base64")&&(r=Xt(r));var s=r.slice(0,1024).toLowerCase(),l=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=dn(a);return o.type="string",Cc.to_workbook(r,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Gt){s.indexOf("<"+Gt)>=0&&(l=!0)}),l)return nH(r,a);Ud={"General Number":"General","General Date":ct[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ct[15],"Short Date":ct[14],"Long Time":ct[19],"Medium Time":ct[18],"Short Time":ct[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ct[2],Standard:ct[4],Percent:ct[10],Scientific:ct[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var d,u=[],h,m={},f=[],p=a.dense?[]:{},b="",g={},y={},N=qr('<Data ss:Type="String">'),C=0,T=0,S=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},_={},P={},j="",A=0,L=[],W={},R={},M=0,q=[],ee=[],z={},fe=[],ae,J=!1,G=[],he=[],H={},F=0,I=0,O={Sheets:[],WBProps:{date1904:!1}},V={};eu.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";d=eu.exec(r);)switch(d[3]=(te=d[3]).toLowerCase()){case"data":if(te=="data"){if(d[1]==="/"){if((h=u.pop())[0]!==d[3])throw new Error("Bad state: "+h.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&u.push([d[3],!0]);break}if(u[u.length-1][1])break;d[1]==="/"?p9(r.slice(C,d.index),j,N,u[u.length-1][0]=="comment"?z:g,{c:T,r:S},_,fe[T],y,G,a):(j="",N=qr(d[0]),C=d.index+d[0].length);break;case"cell":if(d[1]==="/")if(ee.length>0&&(g.c=ee),(!a.sheetRows||a.sheetRows>S)&&g.v!==void 0&&(a.dense?(p[S]||(p[S]=[]),p[S][T]=g):p[pn(T)+Dn(S)]=g),g.HRef&&(g.l={Target:Et(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(F=T+(parseInt(g.MergeAcross,10)|0),I=S+(parseInt(g.MergeDown,10)|0),L.push({s:{c:T,r:S},e:{c:F,r:I}})),!a.sheetStubs)g.MergeAcross?T=F+1:++T;else if(g.MergeAcross||g.MergeDown){for(var pe=T;pe<=F;++pe)for(var U=S;U<=I;++U)(pe>T||U>S)&&(a.dense?(p[U]||(p[U]=[]),p[U][pe]={t:"z"}):p[pn(pe)+Dn(U)]={t:"z"});T=F+1}else++T;else g=u9(d[0]),g.Index&&(T=+g.Index-1),T<k.s.c&&(k.s.c=T),T>k.e.c&&(k.e.c=T),d[0].slice(-2)==="/>"&&++T,ee=[];break;case"row":d[1]==="/"||d[0].slice(-2)==="/>"?(S<k.s.r&&(k.s.r=S),S>k.e.r&&(k.e.r=S),d[0].slice(-2)==="/>"&&(y=qr(d[0]),y.Index&&(S=+y.Index-1)),T=0,++S):(y=qr(d[0]),y.Index&&(S=+y.Index-1),H={},(y.AutoFitHeight=="0"||y.Height)&&(H.hpx=parseInt(y.Height,10),H.hpt=su(H.hpx),he[S]=H),y.Hidden=="1"&&(H.hidden=!0,he[S]=H));break;case"worksheet":if(d[1]==="/"){if((h=u.pop())[0]!==d[3])throw new Error("Bad state: "+h.join("|"));f.push(b),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(p["!ref"]=pt(k),a.sheetRows&&a.sheetRows<=k.e.r&&(p["!fullref"]=p["!ref"],k.e.r=a.sheetRows-1,p["!ref"]=pt(k))),L.length&&(p["!merges"]=L),fe.length>0&&(p["!cols"]=fe),he.length>0&&(p["!rows"]=he),m[b]=p}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=T=0,u.push([d[3],!1]),h=qr(d[0]),b=Et(h.Name),p=a.dense?[]:{},L=[],G=[],he=[],V={name:b,Hidden:0},O.Sheets.push(V);break;case"table":if(d[1]==="/"){if((h=u.pop())[0]!==d[3])throw new Error("Bad state: "+h.join("|"))}else{if(d[0].slice(-2)=="/>")break;u.push([d[3],!1]),fe=[],J=!1}break;case"style":d[1]==="/"?f9(_,P,a):P=qr(d[0]);break;case"numberformat":P.nf=Et(qr(d[0]).Format||"General"),Ud[P.nf]&&(P.nf=Ud[P.nf]);for(var ce=0;ce!=392&&ct[ce]!=P.nf;++ce);if(ce==392){for(ce=57;ce!=392;++ce)if(ct[ce]==null){ni(P.nf,ce);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(ae=qr(d[0]),ae.Hidden&&(ae.hidden=!0,delete ae.Hidden),ae.Width&&(ae.wpx=parseInt(ae.Width,10)),!J&&ae.wpx>10){J=!0,ba=Mk;for(var Q=0;Q<fe.length;++Q)fe[Q]&&sl(fe[Q])}J&&sl(ae),fe[ae.Index-1||fe.length]=ae;for(var oe=0;oe<+ae.Span;++oe)fe[fe.length]=dn(ae);break;case"namedrange":if(d[1]==="/")break;O.Names||(O.Names=[]);var X=ut(d[0]),ve={Name:X.Name,Ref:ic(X.RefersTo.slice(1),{r:0,c:0})};O.Sheets.length>0&&(ve.Sheet=O.Sheets.length-1),O.Names.push(ve);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(d[0].slice(-2)==="/>")break;d[1]==="/"?j+=r.slice(A,d.index):A=d.index+d[0].length;break;case"interior":if(!a.cellStyles)break;P.Interior=qr(d[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(d[0].slice(-2)==="/>")break;d[1]==="/"?V8(W,te,r.slice(M,d.index)):M=d.index+d[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(d[1]==="/"){if((h=u.pop())[0]!==d[3])throw new Error("Bad state: "+h.join("|"))}else u.push([d[3],!1]);break;case"comment":if(d[1]==="/"){if((h=u.pop())[0]!==d[3])throw new Error("Bad state: "+h.join("|"));g9(z),ee.push(z)}else u.push([d[3],!1]),h=qr(d[0]),z={a:h.Author};break;case"autofilter":if(d[1]==="/"){if((h=u.pop())[0]!==d[3])throw new Error("Bad state: "+h.join("|"))}else if(d[0].charAt(d[0].length-2)!=="/"){var Ke=qr(d[0]);p["!autofilter"]={ref:ic(Ke.Range).replace(/\$/g,"")},u.push([d[3],!0])}break;case"name":break;case"datavalidation":if(d[1]==="/"){if((h=u.pop())[0]!==d[3])throw new Error("Bad state: "+h.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&u.push([d[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(d[1]==="/"){if((h=u.pop())[0]!==d[3])throw new Error("Bad state: "+h.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&u.push([d[3],!0]);break;case"null":break;default:if(u.length==0&&d[3]=="document"||u.length==0&&d[3]=="uof")return r2(r,a);var at=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(d[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:at=!1}break;case"componentoptions":switch(d[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:at=!1}break;case"excelworkbook":switch(d[3]){case"date1904":O.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:at=!1}break;case"workbookoptions":switch(d[3]){case"owcversion":break;case"height":break;case"width":break;default:at=!1}break;case"worksheetoptions":switch(d[3]){case"visible":if(d[0].slice(-2)!=="/>")if(d[1]==="/")switch(r.slice(M,d.index)){case"SheetHidden":V.Hidden=1;break;case"SheetVeryHidden":V.Hidden=2;break}else M=d.index+d[0].length;break;case"header":p["!margins"]||Zl(p["!margins"]={},"xlml"),isNaN(+ut(d[0]).Margin)||(p["!margins"].header=+ut(d[0]).Margin);break;case"footer":p["!margins"]||Zl(p["!margins"]={},"xlml"),isNaN(+ut(d[0]).Margin)||(p["!margins"].footer=+ut(d[0]).Margin);break;case"pagemargins":var et=ut(d[0]);p["!margins"]||Zl(p["!margins"]={},"xlml"),isNaN(+et.Top)||(p["!margins"].top=+et.Top),isNaN(+et.Left)||(p["!margins"].left=+et.Left),isNaN(+et.Right)||(p["!margins"].right=+et.Right),isNaN(+et.Bottom)||(p["!margins"].bottom=+et.Bottom);break;case"displayrighttoleft":O.Views||(O.Views=[]),O.Views[0]||(O.Views[0]={}),O.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:at=!1}break;case"pivottable":case"pivotcache":switch(d[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:at=!1}break;case"pagebreaks":switch(d[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:at=!1}break;case"autofilter":switch(d[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:at=!1}break;case"querytable":switch(d[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:at=!1}break;case"datavalidation":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:at=!1}break;case"sorting":case"conditionalformatting":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:at=!1}break;case"mapinfo":case"schema":case"data":switch(d[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:at=!1}break;case"smarttags":break;default:at=!1;break}if(at||d[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+d[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(d[0].slice(-2)==="/>")break;d[1]==="/"?x9(R,te,q,r.slice(M,d.index)):(q=d,M=d.index+d[0].length);break}if(a.WTF)throw"Unrecognized tag: "+d[3]+"|"+u.join("|")}var Be={};return!a.bookSheets&&!a.bookProps&&(Be.Sheets=m),Be.SheetNames=f,Be.Workbook=O,Be.SSF=dn(ct),Be.Props=W,Be.Custprops=R,Be}function Ep(e,n){switch(Wg(n=n||{}),n.type||"base64"){case"base64":return _f(hr(e),n);case"binary":case"buffer":case"file":return _f(e,n);case"array":return _f(dl(e),n)}}function y9(e,n){var a=[];return e.Props&&a.push(U8(e.Props,n)),e.Custprops&&a.push(K8(e.Props,e.Custprops)),a.join("")}function v9(){return""}function b9(e,n){var a=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return n.cellXfs.forEach(function(r,s){var l=[];l.push(Ve("NumberFormat",null,{"ss:Format":$t(ct[r.numFmtId])}));var o={"ss:ID":"s"+(21+s)};a.push(Ve("Style",l.join(""),o))}),Ve("Styles",a.join(""))}function dT(e){return Ve("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Vg(e.Ref,{r:0,c:0})})}function N9(e){if(!((e||{}).Workbook||{}).Names)return"";for(var n=e.Workbook.Names,a=[],r=0;r<n.length;++r){var s=n[r];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||a.push(dT(s)))}return Ve("Names",a.join(""))}function j9(e,n,a,r){if(!e||!((r||{}).Workbook||{}).Names)return"";for(var s=r.Workbook.Names,l=[],o=0;o<s.length;++o){var d=s[o];d.Sheet==a&&(d.Name.match(/^_xlfn\./)||l.push(dT(d)))}return l.join("")}function w9(e,n,a,r){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Ve("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Ve("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Ve("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[a])if(r.Workbook.Sheets[a].Hidden)s.push(Ve("Visible",r.Workbook.Sheets[a].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<a&&!(r.Workbook.Sheets[l]&&!r.Workbook.Sheets[l].Hidden);++l);l==a&&s.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(da("ProtectContents","True")),e["!protect"].objects&&s.push(da("ProtectObjects","True")),e["!protect"].scenarios&&s.push(da("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(da("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(da("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Ve("WorksheetOptions",s.join(""),{xmlns:lr.x})}function k9(e){return e.map(function(n){var a=$A(n.t||""),r=Ve("ss:Data",a,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ve("Comment",r,{"ss:Author":n.a})}).join("")}function T9(e,n,a,r,s,l,o){if(!e||e.v==null&&e.f==null)return"";var d={};if(e.f&&(d["ss:Formula"]="="+$t(Vg(e.f,o))),e.F&&e.F.slice(0,n.length)==n){var u=gn(e.F.slice(n.length+1));d["ss:ArrayRange"]="RC:R"+(u.r==o.r?"":"["+(u.r-o.r)+"]")+"C"+(u.c==o.c?"":"["+(u.c-o.c)+"]")}if(e.l&&e.l.Target&&(d["ss:HRef"]=$t(e.l.Target),e.l.Tooltip&&(d["x:HRefScreenTip"]=$t(e.l.Tooltip))),a["!merges"])for(var h=a["!merges"],m=0;m!=h.length;++m)h[m].s.c!=o.c||h[m].s.r!=o.r||(h[m].e.c>h[m].s.c&&(d["ss:MergeAcross"]=h[m].e.c-h[m].s.c),h[m].e.r>h[m].s.r&&(d["ss:MergeDown"]=h[m].e.r-h[m].s.r));var f="",p="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":f="Number",p=String(e.v);break;case"b":f="Boolean",p=e.v?"1":"0";break;case"e":f="Error",p=di[e.v];break;case"d":f="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ct[14]);break;case"s":f="String",p=zA(e.v||"");break}var b=hl(r.cellXfs,e,r);d["ss:StyleID"]="s"+(21+b),d["ss:Index"]=o.c+1;var g=e.v!=null?p:"",y=e.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(e.c||[]).length>0&&(y+=k9(e.c)),Ve("Cell",y,d)}function C9(e,n){var a='<Row ss:Index="'+(e+1)+'"';return n&&(n.hpt&&!n.hpx&&(n.hpx=Sc(n.hpt)),n.hpx&&(a+=' ss:AutoFitHeight="0" ss:Height="'+n.hpx+'"'),n.hidden&&(a+=' ss:Hidden="1"')),a+">"}function S9(e,n,a,r){if(!e["!ref"])return"";var s=Dt(e["!ref"]),l=e["!merges"]||[],o=0,d=[];e["!cols"]&&e["!cols"].forEach(function(N,C){sl(N);var T=!!N.width,S=ox(C,N),k={"ss:Index":C+1};T&&(k["ss:Width"]=au(S.width)),N.hidden&&(k["ss:Hidden"]="1"),d.push(Ve("Column",null,k))});for(var u=Array.isArray(e),h=s.s.r;h<=s.e.r;++h){for(var m=[C9(h,(e["!rows"]||[])[h])],f=s.s.c;f<=s.e.c;++f){var p=!1;for(o=0;o!=l.length;++o)if(!(l[o].s.c>f)&&!(l[o].s.r>h)&&!(l[o].e.c<f)&&!(l[o].e.r<h)){(l[o].s.c!=f||l[o].s.r!=h)&&(p=!0);break}if(!p){var b={r:h,c:f},g=dt(b),y=u?(e[h]||[])[f]:e[g];m.push(T9(y,g,e,n,a,r,b))}}m.push("</Row>"),m.length>2&&d.push(m.join(""))}return d.join("")}function _9(e,n,a){var r=[],s=a.SheetNames[e],l=a.Sheets[s],o=l?j9(l,n,e,a):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=l?S9(l,n,e,a):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(w9(l,n,e,a)),r.join("")}function E9(e,n){n||(n={}),e.SSF||(e.SSF=dn(ct)),e.SSF&&(Lc(),tx(e.SSF),n.revssf=ax(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF,n.cellXfs=[],hl(n.cellXfs,{},{revssf:{General:0}}));var a=[];a.push(y9(e,n)),a.push(v9()),a.push(""),a.push("");for(var r=0;r<e.SheetNames.length;++r)a.push(Ve("Worksheet",_9(r,n,e),{"ss:Name":$t(e.SheetNames[r])}));return a[2]=b9(e,n),a[3]=N9(e),Fn+Ve("Workbook",a.join(""),{xmlns:lr.ss,"xmlns:o":lr.o,"xmlns:x":lr.x,"xmlns:ss":lr.ss,"xmlns:dt":lr.dt,"xmlns:html":lr.html})}function D9(e){var n={},a=e.content;if(a.l=28,n.AnsiUserType=a.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=N8(a),a.length-a.l<=4)return n;var r=a.read_shift(4);if(r==0||r>40||(a.l-=4,n.Reserved1=a.read_shift(0,"lpstr-ansi"),a.length-a.l<=4)||(r=a.read_shift(4),r!==1907505652)||(n.UnicodeClipboardFormat=j8(a),r=a.read_shift(4),r==0||r>40))return n;a.l-=4,n.Reserved2=a.read_shift(0,"lpwstr")}var F9=[60,1084,2066,2165,2175];function A9(e,n,a,r,s){var l=r,o=[],d=a.slice(a.l,a.l+l);if(s&&s.enc&&s.enc.insitu&&d.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(d)}o.push(d),a.l+=l;for(var u=Qs(a,a.l),h=Dp[u],m=0;h!=null&&F9.indexOf(u)>-1;)l=Qs(a,a.l+2),m=a.l+4,u==2066?m+=4:(u==2165||u==2175)&&(m+=12),d=a.slice(m,a.l+4+l),o.push(d),a.l+=4+l,h=Dp[u=Qs(a,a.l)];var f=ea(o);oa(f,0);var p=0;f.lens=[];for(var b=0;b<o.length;++b)f.lens.push(p),p+=o[b].length;if(f.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+r;return n.f(f,f.length,s)}function us(e,n,a){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,n.cellNF&&(e.z=ct[r])}catch(l){if(n.WTF)throw l}if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||di[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yd(e.v):e.w=ro(e.v):e.w=Mr(r,e.v,{date1904:!!a,dateNF:n&&n.dateNF})}catch(l){if(n.WTF)throw l}if(n.cellDates&&r&&e.t=="n"&&Pc(ct[r]||String(r))){var s=Rl(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function t0(e,n,a){return{v:e,ixfe:n,t:a}}function P9(e,n){var a={opts:{}},r={},s=n.dense?[]:{},l={},o={},d=null,u=[],h="",m={},f,p="",b,g,y,N,C={},T=[],S,k,_=[],P=[],j={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},L=function(ot){return ot<8?Ql[ot]:ot<64&&P[ot-8]||Ql[ot]},W=function(ot,It,Gn){var Zt=It.XF.data;if(!(!Zt||!Zt.patternType||!Gn||!Gn.cellStyles)){It.s={},It.s.patternType=Zt.patternType;var Ca;(Ca=nu(L(Zt.icvFore)))&&(It.s.fgColor={rgb:Ca}),(Ca=nu(L(Zt.icvBack)))&&(It.s.bgColor={rgb:Ca})}},R=function(ot,It,Gn){if(!(H>1)&&!(Gn.sheetRows&&ot.r>=Gn.sheetRows)){if(Gn.cellStyles&&It.XF&&It.XF.data&&W(ot,It,Gn),delete It.ixfe,delete It.XF,f=ot,p=dt(ot),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ot.r<o.s.r&&(o.s.r=ot.r),ot.c<o.s.c&&(o.s.c=ot.c),ot.r+1>o.e.r&&(o.e.r=ot.r+1),ot.c+1>o.e.c&&(o.e.c=ot.c+1),Gn.cellFormula&&It.f){for(var Zt=0;Zt<T.length;++Zt)if(!(T[Zt][0].s.c>ot.c||T[Zt][0].s.r>ot.r)&&!(T[Zt][0].e.c<ot.c||T[Zt][0].e.r<ot.r)){It.F=pt(T[Zt][0]),(T[Zt][0].s.c!=ot.c||T[Zt][0].s.r!=ot.r)&&delete It.f,It.f&&(It.f=""+va(T[Zt][1],o,ot,G,M));break}}Gn.dense?(s[ot.r]||(s[ot.r]=[]),s[ot.r][ot.c]=It):s[p]=It}},M={enc:!1,sbcch:0,snames:[],sharedf:C,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(M.password=n.password);var q,ee=[],z=[],fe=[],ae=[],J=!1,G=[];G.SheetNames=M.snames,G.sharedf=M.sharedf,G.arrayf=M.arrayf,G.names=[],G.XTI=[];var he=0,H=0,F=0,I=[],O=[],V;M.codepage=1200,Yr(1200);for(var te=!1;e.l<e.length-1;){var pe=e.l,U=e.read_shift(2);if(U===0&&he===10)break;var ce=e.l===e.length?0:e.read_shift(2),Q=Dp[U];if(Q&&Q.f){if(n.bookSheets&&he===133&&U!==133)break;if(he=U,Q.r===2||Q.r==12){var oe=e.read_shift(2);if(ce-=2,!M.enc&&oe!==U&&((oe&255)<<8|oe>>8)!==U)throw new Error("rt mismatch: "+oe+"!="+U);Q.r==12&&(e.l+=10,ce-=10)}var X={};if(U===10?X=Q.f(e,ce,M):X=A9(U,Q,e,ce,M),H==0&&[9,521,1033,2057].indexOf(he)===-1)continue;switch(U){case 34:a.opts.Date1904=j.WBProps.date1904=X;break;case 134:a.opts.WriteProtect=!0;break;case 47:if(M.enc||(e.l=0),M.enc=X,!n.password)throw new Error("File is password-protected");if(X.valid==null)throw new Error("Encryption scheme unsupported");if(!X.valid)throw new Error("Password is incorrect");break;case 92:M.lastuser=X;break;case 66:var ve=Number(X);switch(ve){case 21010:ve=1200;break;case 32768:ve=1e4;break;case 32769:ve=1252;break}Yr(M.codepage=ve),te=!0;break;case 317:M.rrtabid=X;break;case 25:M.winlocked=X;break;case 439:a.opts.RefreshAll=X;break;case 12:a.opts.CalcCount=X;break;case 16:a.opts.CalcDelta=X;break;case 17:a.opts.CalcIter=X;break;case 13:a.opts.CalcMode=X;break;case 14:a.opts.CalcPrecision=X;break;case 95:a.opts.CalcSaveRecalc=X;break;case 15:M.CalcRefMode=X;break;case 2211:a.opts.FullCalc=X;break;case 129:X.fDialog&&(s["!type"]="dialog"),X.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),X.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:_.push(X);break;case 430:G.push([X]),G[G.length-1].XTI=[];break;case 35:case 547:G[G.length-1].push(X);break;case 24:case 536:V={Name:X.Name,Ref:va(X.rgce,o,null,G,M)},X.itab>0&&(V.Sheet=X.itab-1),G.names.push(V),G[0]||(G[0]=[],G[0].XTI=[]),G[G.length-1].push(X),X.Name=="_xlnm._FilterDatabase"&&X.itab>0&&X.rgce&&X.rgce[0]&&X.rgce[0][0]&&X.rgce[0][0][0]=="PtgArea3d"&&(O[X.itab-1]={ref:pt(X.rgce[0][0][1][2])});break;case 22:M.ExternCount=X;break;case 23:G.length==0&&(G[0]=[],G[0].XTI=[]),G[G.length-1].XTI=G[G.length-1].XTI.concat(X),G.XTI=G.XTI.concat(X);break;case 2196:if(M.biff<8)break;V!=null&&(V.Comment=X[1]);break;case 18:s["!protect"]=X;break;case 19:X!==0&&M.WTF&&console.error("Password verifier: "+X);break;case 133:l[X.pos]=X,M.snames.push(X.name);break;case 10:{if(--H)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=pt(o),n.sheetRows&&n.sheetRows<=o.e.r){var Ke=o.e.r;o.e.r=n.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=pt(o),o.e.r=Ke}o.e.r++,o.e.c++}ee.length>0&&(s["!merges"]=ee),z.length>0&&(s["!objects"]=z),fe.length>0&&(s["!cols"]=fe),ae.length>0&&(s["!rows"]=ae),j.Sheets.push(A)}h===""?m=s:r[h]=s,s=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(M.biff===8&&(M.biff={9:2,521:3,1033:4}[U]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[X.BIFFVer]||8),M.biffguess=X.BIFFVer==0,X.BIFFVer==0&&X.dt==4096&&(M.biff=5,te=!0,Yr(M.codepage=28591)),M.biff==8&&X.BIFFVer==0&&X.dt==16&&(M.biff=2),H++)break;if(s=n.dense?[]:{},M.biff<8&&!te&&(te=!0,Yr(M.codepage=n.codepage||1252)),M.biff<5||X.BIFFVer==0&&X.dt==4096){h===""&&(h="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var at={pos:e.l-ce,name:h};l[at.pos]=at,M.snames.push(h)}else h=(l[pe]||{name:""}).name;X.dt==32&&(s["!type"]="chart"),X.dt==64&&(s["!type"]="macro"),ee=[],z=[],M.arrayf=T=[],fe=[],ae=[],J=!1,A={Hidden:(l[pe]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(n.dense?(s[X.r]||[])[X.c]:s[dt({c:X.c,r:X.r})])&&++X.c,S={ixfe:X.ixfe,XF:_[X.ixfe]||{},v:X.val,t:"n"},F>0&&(S.z=I[S.ixfe>>8&63]),us(S,n,a.opts.Date1904),R({c:X.c,r:X.r},S,n);break;case 5:case 517:S={ixfe:X.ixfe,XF:_[X.ixfe],v:X.val,t:X.t},F>0&&(S.z=I[S.ixfe>>8&63]),us(S,n,a.opts.Date1904),R({c:X.c,r:X.r},S,n);break;case 638:S={ixfe:X.ixfe,XF:_[X.ixfe],v:X.rknum,t:"n"},F>0&&(S.z=I[S.ixfe>>8&63]),us(S,n,a.opts.Date1904),R({c:X.c,r:X.r},S,n);break;case 189:for(var et=X.c;et<=X.C;++et){var Be=X.rkrec[et-X.c][0];S={ixfe:Be,XF:_[Be],v:X.rkrec[et-X.c][1],t:"n"},F>0&&(S.z=I[S.ixfe>>8&63]),us(S,n,a.opts.Date1904),R({c:et,r:X.r},S,n)}break;case 6:case 518:case 1030:{if(X.val=="String"){d=X;break}if(S=t0(X.val,X.cell.ixfe,X.tt),S.XF=_[S.ixfe],n.cellFormula){var Gt=X.formula;if(Gt&&Gt[0]&&Gt[0][0]&&Gt[0][0][0]=="PtgExp"){var wn=Gt[0][0][1][0],kn=Gt[0][0][1][1],$n=dt({r:wn,c:kn});C[$n]?S.f=""+va(X.formula,o,X.cell,G,M):S.F=((n.dense?(s[wn]||[])[kn]:s[$n])||{}).F}else S.f=""+va(X.formula,o,X.cell,G,M)}F>0&&(S.z=I[S.ixfe>>8&63]),us(S,n,a.opts.Date1904),R(X.cell,S,n),d=X}break;case 7:case 519:if(d)d.val=X,S=t0(X,d.cell.ixfe,"s"),S.XF=_[S.ixfe],n.cellFormula&&(S.f=""+va(d.formula,o,d.cell,G,M)),F>0&&(S.z=I[S.ixfe>>8&63]),us(S,n,a.opts.Date1904),R(d.cell,S,n),d=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(X);var Hr=dt(X[0].s);if(b=n.dense?(s[X[0].s.r]||[])[X[0].s.c]:s[Hr],n.cellFormula&&b){if(!d||!Hr||!b)break;b.f=""+va(X[1],o,X[0],G,M),b.F=pt(X[0])}}break;case 1212:{if(!n.cellFormula)break;if(p){if(!d)break;C[dt(d.cell)]=X[0],b=n.dense?(s[d.cell.r]||[])[d.cell.c]:s[dt(d.cell)],(b||{}).f=""+va(X[0],o,f,G,M)}}break;case 253:S=t0(u[X.isst].t,X.ixfe,"s"),u[X.isst].h&&(S.h=u[X.isst].h),S.XF=_[S.ixfe],F>0&&(S.z=I[S.ixfe>>8&63]),us(S,n,a.opts.Date1904),R({c:X.c,r:X.r},S,n);break;case 513:n.sheetStubs&&(S={ixfe:X.ixfe,XF:_[X.ixfe],t:"z"},F>0&&(S.z=I[S.ixfe>>8&63]),us(S,n,a.opts.Date1904),R({c:X.c,r:X.r},S,n));break;case 190:if(n.sheetStubs)for(var tr=X.c;tr<=X.C;++tr){var He=X.ixfe[tr-X.c];S={ixfe:He,XF:_[He],t:"z"},F>0&&(S.z=I[S.ixfe>>8&63]),us(S,n,a.opts.Date1904),R({c:tr,r:X.r},S,n)}break;case 214:case 516:case 4:S=t0(X.val,X.ixfe,"s"),S.XF=_[S.ixfe],F>0&&(S.z=I[S.ixfe>>8&63]),us(S,n,a.opts.Date1904),R({c:X.c,r:X.r},S,n);break;case 0:case 512:H===1&&(o=X);break;case 252:u=X;break;case 1054:if(M.biff==4){I[F++]=X[1];for(var Ye=0;Ye<F+163&&ct[Ye]!=X[1];++Ye);Ye>=163&&ni(X[1],F+163)}else ni(X[1],X[0]);break;case 30:{I[F++]=X;for(var Ft=0;Ft<F+163&&ct[Ft]!=X;++Ft);Ft>=163&&ni(X,F+163)}break;case 229:ee=ee.concat(X);break;case 93:z[X.cmo[0]]=M.lastobj=X;break;case 438:M.lastobj.TxO=X;break;case 127:M.lastobj.ImData=X;break;case 440:for(N=X[0].s.r;N<=X[0].e.r;++N)for(y=X[0].s.c;y<=X[0].e.c;++y)b=n.dense?(s[N]||[])[y]:s[dt({c:y,r:N})],b&&(b.l=X[1]);break;case 2048:for(N=X[0].s.r;N<=X[0].e.r;++N)for(y=X[0].s.c;y<=X[0].e.c;++y)b=n.dense?(s[N]||[])[y]:s[dt({c:y,r:N})],b&&b.l&&(b.l.Tooltip=X[1]);break;case 28:{if(M.biff<=5&&M.biff>=2)break;b=n.dense?(s[X[0].r]||[])[X[0].c]:s[dt(X[0])];var qt=z[X[2]];b||(n.dense?(s[X[0].r]||(s[X[0].r]=[]),b=s[X[0].r][X[0].c]={t:"z"}):b=s[dt(X[0])]={t:"z"},o.e.r=Math.max(o.e.r,X[0].r),o.s.r=Math.min(o.s.r,X[0].r),o.e.c=Math.max(o.e.c,X[0].c),o.s.c=Math.min(o.s.c,X[0].c)),b.c||(b.c=[]),g={a:X[1],t:qt.TxO.t},b.c.push(g)}break;case 2173:bI(_[X.ixfe],X.ext);break;case 125:{if(!M.cellStyles)break;for(;X.e>=X.s;)fe[X.e--]={width:X.w/256,level:X.level||0,hidden:!!(X.flags&1)},J||(J=!0,Rg(X.w/256)),sl(fe[X.e+1])}break;case 520:{var Ct={};X.level!=null&&(ae[X.r]=Ct,Ct.level=X.level),X.hidden&&(ae[X.r]=Ct,Ct.hidden=!0),X.hpt&&(ae[X.r]=Ct,Ct.hpt=X.hpt,Ct.hpx=Sc(X.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Zl(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[U]]=X;break;case 161:s["!margins"]||Zl(s["!margins"]={}),s["!margins"].header=X.header,s["!margins"].footer=X.footer;break;case 574:X.RTL&&(j.Views[0].RTL=!0);break;case 146:P=X;break;case 2198:q=X;break;case 140:k=X;break;case 442:h?A.CodeName=X||A.name:j.WBProps.CodeName=X||"ThisWorkbook";break}}else Q||console.error("Missing Info for XLS Record 0x"+U.toString(16)),e.l+=ce}return a.SheetNames=jn(l).sort(function(Mn,ot){return Number(Mn)-Number(ot)}).map(function(Mn){return l[Mn].name}),n.bookSheets||(a.Sheets=r),!a.SheetNames.length&&m["!ref"]?(a.SheetNames.push("Sheet1"),a.Sheets&&(a.Sheets.Sheet1=m)):a.Preamble=m,a.Sheets&&O.forEach(function(Mn,ot){a.Sheets[a.SheetNames[ot]]["!autofilter"]=Mn}),a.Strings=u,a.SSF=dn(ct),M.enc&&(a.Encryption=M.enc),q&&(a.Themes=q),a.Metadata={},k!==void 0&&(a.Metadata.Country=k),G.names.length>0&&(j.Names=G.names),a.Workbook=j,a}var Kd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function L9(e,n,a){var r=nt.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var s=LN(r,wp,Kd.DSI);for(var l in s)n[l]=s[l]}catch(h){if(a.WTF)throw h}var o=nt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var d=LN(o,kp,Kd.SI);for(var u in d)n[u]==null&&(n[u]=d[u])}catch(h){if(a.WTF)throw h}n.HeadingPairs&&n.TitlesOfParts&&(ck(n.HeadingPairs,n.TitlesOfParts,n,a),delete n.HeadingPairs,delete n.TitlesOfParts)}function O9(e,n){var a=[],r=[],s=[],l=0,o,d=dN(wp,"n"),u=dN(kp,"n");if(e.Props)for(o=jn(e.Props),l=0;l<o.length;++l)(Object.prototype.hasOwnProperty.call(d,o[l])?a:Object.prototype.hasOwnProperty.call(u,o[l])?r:s).push([o[l],e.Props[o[l]]]);if(e.Custprops)for(o=jn(e.Custprops),l=0;l<o.length;++l)Object.prototype.hasOwnProperty.call(e.Props||{},o[l])||(Object.prototype.hasOwnProperty.call(d,o[l])?a:Object.prototype.hasOwnProperty.call(u,o[l])?r:s).push([o[l],e.Custprops[o[l]]]);var h=[];for(l=0;l<s.length;++l)pk.indexOf(s[l][0])>-1||ok.indexOf(s[l][0])>-1||s[l][1]!=null&&h.push(s[l]);r.length&&nt.utils.cfb_add(n,"/SummaryInformation",ON(r,Kd.SI,u,kp)),(a.length||h.length)&&nt.utils.cfb_add(n,"/DocumentSummaryInformation",ON(a,Kd.DSI,d,wp,h.length?h:null,Kd.UDI))}function Gg(e,n){n||(n={}),Wg(n),mg(),n.codepage&&xg(n.codepage);var a,r;if(e.FullPaths){if(nt.find(e,"/encryption"))throw new Error("File is password-protected");a=nt.find(e,"!CompObj"),r=nt.find(e,"/Workbook")||nt.find(e,"/Book")}else{switch(n.type){case"base64":e=cr(hr(e));break;case"binary":e=cr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}oa(e,0),r={content:e}}var s,l;if(a&&D9(a),n.bookProps&&!n.bookSheets)s={};else{var o=bt?"buffer":"array";if(r&&r.content)s=P9(r.content,n);else if((l=nt.find(e,"PerfectOffice_MAIN"))&&l.content)s=Jl.to_workbook(l.content,(n.type=o,n));else if((l=nt.find(e,"NativeContent_MAIN"))&&l.content)s=Jl.to_workbook(l.content,(n.type=o,n));else throw(l=nt.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&e.FullPaths&&nt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=WI(e))}var d={};return e.FullPaths&&L9(e,d,n),s.Props=s.Custprops=d,n.bookFiles&&(s.cfb=e),s}function I9(e,n){var a=n||{},r=nt.utils.cfb_new({root:"R"}),s="/Workbook";switch(a.bookType||"xls"){case"xls":a.bookType="biff8";case"xla":a.bookType||(a.bookType="xla");case"biff8":s="/Workbook",a.biff=8;break;case"biff5":s="/Book",a.biff=5;break;default:throw new Error("invalid type "+a.bookType+" for XLS CFB")}return nt.utils.cfb_add(r,s,uT(e,a)),a.biff==8&&(e.Props||e.Custprops)&&O9(e,r),a.biff==8&&e.vbaraw&&XI(r,nt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),r}var iu={0:{f:iR},1:{f:mR},2:{f:PR},3:{f:jR},4:{f:yR},5:{f:DR},6:{f:RR},7:{f:CR},8:{f:$R},9:{f:zR},10:{f:UR},11:{f:KR},12:{f:pR},13:{f:OR},14:{f:kR},15:{f:bR},16:{f:aT},17:{f:HR},18:{f:_R},19:{f:_g},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:HB},40:{},42:{},43:{f:RO},44:{f:IO},45:{f:VO},46:{f:KO},47:{f:UO},48:{},49:{f:c8},50:{},51:{f:wI},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Sk},62:{f:MR},63:{f:AI},64:{f:lB},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ka,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:aB},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:hR},148:{f:cR,p:16},151:{f:YR},152:{},153:{f:MB},154:{},155:{},156:{f:OB},157:{},158:{},159:{T:1,f:ZL},160:{T:-1},161:{T:1,f:yo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:GR},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:NI},336:{T:-1},337:{f:CI,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:jp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ck},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:JR},427:{f:ZR},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:tB},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:uR},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:XR},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:jp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:KI},633:{T:1},634:{T:-1},635:{T:1,f:VI},636:{T:-1},637:{f:x8},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:kB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:oB},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Dp={6:{f:Cf},10:{f:Oi},12:{f:On},13:{f:On},14:{f:_n},15:{f:_n},16:{f:ja},17:{f:_n},18:{f:_n},19:{f:On},20:{f:VN},21:{f:VN},23:{f:Ck},24:{f:KN},25:{f:_n},26:{},27:{},28:{f:oL},29:{},34:{f:_n},35:{f:UN},38:{f:ja},39:{f:ja},40:{f:ja},41:{f:ja},42:{f:_n},43:{f:_n},47:{f:bO},49:{f:OP},51:{f:On},60:{},61:{f:DP},64:{f:_n},65:{f:LP},66:{f:On},77:{},80:{},81:{},82:{},85:{f:On},89:{},90:{},91:{},92:{f:vP},93:{f:uL},94:{},95:{f:_n},96:{},97:{},99:{f:_n},125:{f:Sk},128:{f:QP},129:{f:NP},130:{f:On},131:{f:_n},132:{f:_n},133:{f:jP},134:{},140:{f:vL},141:{f:On},144:{},146:{f:jL},151:{},152:{},153:{},154:{},155:{},156:{f:On},157:{},158:{},160:{f:EL},161:{f:TL},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:GP},190:{f:qP},193:{f:Oi},197:{},198:{},199:{},200:{},201:{},202:{f:_n},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:On},220:{},221:{f:_n},222:{},224:{f:XP},225:{f:yP},226:{f:Oi},227:{},229:{f:cL},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:kP},253:{f:MP},255:{f:CP},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:gk},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:_n},353:{f:Oi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:tL},431:{f:_n},432:{},433:{},434:{},437:{},438:{f:mL},439:{f:_n},440:{f:fL},441:{},442:{f:ku},443:{},444:{f:On},445:{},446:{},448:{f:Oi},449:{f:EP,r:2},450:{f:Oi},512:{f:RN},513:{f:_L},515:{f:ZP},516:{f:BP},517:{f:HN},519:{f:DL},520:{f:SP},523:{},545:{f:zN},549:{f:MN},566:{},574:{f:AP},638:{f:$P},659:{},1048:{},1054:{f:VP},1084:{},1212:{f:sL},2048:{f:gL},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Jh},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Oi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:wL,r:12},2173:{f:vI,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:_n,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:rL,r:12},2197:{},2198:{f:xI,r:12},2199:{},2200:{},2201:{},2202:{f:iL,r:12},2203:{f:Oi},2204:{},2205:{},2206:{},2207:{},2211:{f:_P},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:On},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:CL},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:NL},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:RN},1:{},2:{f:OL},3:{f:PL},4:{f:AL},5:{f:HN},7:{f:ML},8:{},9:{f:Jh},11:{},22:{f:On},30:{f:KP},31:{},32:{},33:{f:zN},36:{},37:{f:MN},50:{f:RL},62:{},52:{},67:{},68:{f:On},69:{},86:{},126:{},127:{f:FL},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:BL},223:{},234:{},354:{},421:{},518:{f:Cf},521:{f:Jh},536:{f:KN},547:{f:UN},561:{},579:{},1030:{f:Cf},1033:{f:Jh},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ue(e,n,a,r){var s=n;if(!isNaN(s)){var l=r||(a||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,l),l>0&&Tg(a)&&e.push(a)}}function M9(e,n,a,r){var s=(a||[]).length||0;if(s<=8224)return Ue(e,n,a,s);var l=n;if(!isNaN(l)){for(var o=a.parts||[],d=0,u=0,h=0;h+(o[d]||8224)<=8224;)h+=o[d]||8224,d++;var m=e.next(4);for(m.write_shift(2,l),m.write_shift(2,h),e.push(a.slice(u,u+h)),u+=h;u<s;){for(m=e.next(4),m.write_shift(2,60),h=0;h+(o[d]||8224)<=8224;)h+=o[d]||8224,d++;m.write_shift(2,h),e.push(a.slice(u,u+h)),u+=h}}}function _u(e,n,a){return e||(e=Ce(7)),e.write_shift(2,n),e.write_shift(2,a),e.write_shift(2,0),e.write_shift(1,0),e}function R9(e,n,a,r){var s=Ce(9);return _u(s,e,n),yk(a,r||"b",s),s}function B9(e,n,a){var r=Ce(8+2*a.length);return _u(r,e,n),r.write_shift(1,a.length),r.write_shift(a.length,a,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function H9(e,n,a,r){if(n.v!=null)switch(n.t){case"d":case"n":var s=n.t=="d"?zn(cn(n.v)):n.v;s==(s|0)&&s>=0&&s<65536?Ue(e,2,IL(a,r,s)):Ue(e,3,LL(a,r,s));return;case"b":case"e":Ue(e,5,R9(a,r,n.v,n.t));return;case"s":case"str":Ue(e,4,B9(a,r,(n.v||"").slice(0,255)));return}Ue(e,1,_u(null,a,r))}function V9(e,n,a,r){var s=Array.isArray(n),l=Dt(n["!ref"]||"A1"),o,d="",u=[];if(l.e.c>255||l.e.r>16383){if(r.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),o=pt(l)}for(var h=l.s.r;h<=l.e.r;++h){d=Dn(h);for(var m=l.s.c;m<=l.e.c;++m){h===l.s.r&&(u[m]=pn(m)),o=u[m]+d;var f=s?(n[h]||[])[m]:n[o];f&&H9(e,f,h,m)}}}function U9(e,n){for(var a=n||{},r=Za(),s=0,l=0;l<e.SheetNames.length;++l)e.SheetNames[l]==a.sheet&&(s=l);if(s==0&&a.sheet&&e.SheetNames[0]!=a.sheet)throw new Error("Sheet not found: "+a.sheet);return Ue(r,a.biff==4?1033:a.biff==3?521:9,Og(e,16,a)),V9(r,e.Sheets[e.SheetNames[s]],s,a),Ue(r,10),r.end()}function K9(e,n,a){Ue(e,49,IP({sz:12,name:"Arial"},a))}function z9(e,n,a){n&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)n[s]!=null&&Ue(e,1054,UP(s,n[s],a))})}function $9(e,n){var a=Ce(19);a.write_shift(4,2151),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,1),a.write_shift(4,0),Ue(e,2151,a),a=Ce(39),a.write_shift(4,2152),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,0),a.write_shift(4,0),a.write_shift(2,1),a.write_shift(4,4),a.write_shift(2,0),wk(Dt(n["!ref"]||"A1"),a),a.write_shift(4,4),Ue(e,2152,a)}function G9(e,n){for(var a=0;a<16;++a)Ue(e,224,BN({numFmtId:0,style:!0},0,n));n.cellXfs.forEach(function(r){Ue(e,224,BN(r,0,n))})}function q9(e,n){for(var a=0;a<n["!links"].length;++a){var r=n["!links"][a];Ue(e,440,pL(r)),r[1].Tooltip&&Ue(e,2048,yL(r))}delete n["!links"]}function W9(e,n){if(n){var a=0;n.forEach(function(r,s){++a<=256&&r&&Ue(e,125,kL(ox(s,r),s))})}}function X9(e,n,a,r,s){var l=16+hl(s.cellXfs,n,s);if(n.v==null&&!n.bf){Ue(e,513,oo(a,r,l));return}if(n.bf)Ue(e,6,N7(n,a,r,s,l));else switch(n.t){case"d":case"n":var o=n.t=="d"?zn(cn(n.v)):n.v;Ue(e,515,eL(a,r,o,l));break;case"b":case"e":Ue(e,517,JP(a,r,n.v,l,s,n.t));break;case"s":case"str":if(s.bookSST){var d=Kg(s.Strings,n.v,s.revStrings);Ue(e,253,RP(a,r,d,l))}else Ue(e,516,HP(a,r,(n.v||"").slice(0,255),l,s));break;default:Ue(e,513,oo(a,r,l))}}function Q9(e,n,a){var r=Za(),s=a.SheetNames[e],l=a.Sheets[s]||{},o=(a||{}).Workbook||{},d=(o.Sheets||[])[e]||{},u=Array.isArray(l),h=n.biff==8,m,f="",p=[],b=Dt(l["!ref"]||"A1"),g=h?65536:16384;if(b.e.c>255||b.e.r>=g){if(n.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");b.e.c=Math.min(b.e.c,255),b.e.r=Math.min(b.e.c,g-1)}Ue(r,2057,Og(a,16,n)),Ue(r,13,Cr(1)),Ue(r,12,Cr(100)),Ue(r,15,Pa(!0)),Ue(r,17,Pa(!1)),Ue(r,16,io(.001)),Ue(r,95,Pa(!0)),Ue(r,42,Pa(!1)),Ue(r,43,Pa(!1)),Ue(r,130,Cr(1)),Ue(r,128,YP()),Ue(r,131,Pa(!1)),Ue(r,132,Pa(!1)),h&&W9(r,l["!cols"]),Ue(r,512,zP(b,n)),h&&(l["!links"]=[]);for(var y=b.s.r;y<=b.e.r;++y){f=Dn(y);for(var N=b.s.c;N<=b.e.c;++N){y===b.s.r&&(p[N]=pn(N)),m=p[N]+f;var C=u?(l[y]||[])[N]:l[m];C&&(X9(r,C,y,N,n),h&&C.l&&l["!links"].push([m,C.l]))}}var T=d.CodeName||d.name||s;return h&&Ue(r,574,PP((o.Views||[])[0])),h&&(l["!merges"]||[]).length&&Ue(r,229,dL(l["!merges"])),h&&q9(r,l),Ue(r,442,vk(T)),h&&$9(r,l),Ue(r,10),r.end()}function Y9(e,n,a){var r=Za(),s=(e||{}).Workbook||{},l=s.Sheets||[],o=s.WBProps||{},d=a.biff==8,u=a.biff==5;if(Ue(r,2057,Og(e,5,a)),a.bookType=="xla"&&Ue(r,135),Ue(r,225,d?Cr(1200):null),Ue(r,193,J8(2)),u&&Ue(r,191),u&&Ue(r,192),Ue(r,226),Ue(r,92,bP("SheetJS",a)),Ue(r,66,Cr(d?1200:1252)),d&&Ue(r,353,Cr(0)),d&&Ue(r,448),Ue(r,317,SL(e.SheetNames.length)),d&&e.vbaraw&&Ue(r,211),d&&e.vbaraw){var h=o.CodeName||"ThisWorkbook";Ue(r,442,vk(h))}Ue(r,156,Cr(17)),Ue(r,25,Pa(!1)),Ue(r,18,Pa(!1)),Ue(r,19,Cr(0)),d&&Ue(r,431,Pa(!1)),d&&Ue(r,444,Cr(0)),Ue(r,61,FP()),Ue(r,64,Pa(!1)),Ue(r,141,Cr(0)),Ue(r,34,Pa(EB(e)=="true")),Ue(r,14,Pa(!0)),d&&Ue(r,439,Pa(!1)),Ue(r,218,Cr(0)),K9(r,e,a),z9(r,e.SSF,a),G9(r,a),d&&Ue(r,352,Pa(!1));var m=r.end(),f=Za();d&&Ue(f,140,bL()),d&&a.Strings&&M9(f,252,TP(a.Strings)),Ue(f,10);var p=f.end(),b=Za(),g=0,y=0;for(y=0;y<e.SheetNames.length;++y)g+=(d?12:11)+(d?2:1)*e.SheetNames[y].length;var N=m.length+g+p.length;for(y=0;y<e.SheetNames.length;++y){var C=l[y]||{};Ue(b,133,wP({pos:N,hs:C.Hidden||0,dt:0,name:e.SheetNames[y]},a)),N+=n[y].length}var T=b.end();if(g!=T.length)throw new Error("BS8 "+g+" != "+T.length);var S=[];return m.length&&S.push(m),T.length&&S.push(T),p.length&&S.push(p),ea(S)}function J9(e,n){var a=n||{},r=[];e&&!e.SSF&&(e.SSF=dn(ct)),e&&e.SSF&&(Lc(),tx(e.SSF),a.revssf=ax(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF),a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,Xg(a),a.cellXfs=[],hl(a.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)r[r.length]=Q9(s,a,e);return r.unshift(Y9(e,r,a)),ea(r)}function uT(e,n){for(var a=0;a<=e.SheetNames.length;++a){var r=e.Sheets[e.SheetNames[a]];if(!(!r||!r["!ref"])){var s=er(r["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[a]+"' extends beyond column IV (255).  Data may be lost.")}}var l=n||{};switch(l.biff||2){case 8:case 5:return J9(e,n);case 4:case 3:case 2:return U9(e,n)}throw new Error("invalid type "+l.bookType+" for BIFF")}function e2(e,n){var a=n||{},r=a.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),o=s.index,d=l&&l.index||e.length,u=IA(e.slice(o,d),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,m=0,f=0,p=0,b={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(o=0;o<u.length;++o){var y=u[o].trim(),N=y.slice(0,3).toLowerCase();if(N=="<tr"){if(++h,a.sheetRows&&a.sheetRows<=h){--h;break}m=0;continue}if(!(N!="<td"&&N!="<th")){var C=y.split(/<\/t[dh]>/i);for(d=0;d<C.length;++d){var T=C[d].trim();if(T.match(/<t[dh]/i)){for(var S=T,k=0;S.charAt(0)=="<"&&(k=S.indexOf(">"))>-1;)S=S.slice(k+1);for(var _=0;_<g.length;++_){var P=g[_];P.s.c==m&&P.s.r<h&&h<=P.e.r&&(m=P.e.c+1,_=-1)}var j=ut(T.slice(0,T.indexOf(">")));p=j.colspan?+j.colspan:1,((f=+j.rowspan)>1||p>1)&&g.push({s:{r:h,c:m},e:{r:h+(f||1)-1,c:m+p-1}});var A=j.t||j["data-t"]||"";if(!S.length){m+=p;continue}if(S=Iw(S),b.s.r>h&&(b.s.r=h),b.e.r<h&&(b.e.r=h),b.s.c>m&&(b.s.c=m),b.e.c<m&&(b.e.c=m),!S.length){m+=p;continue}var L={t:"s",v:S};a.raw||!S.trim().length||A=="s"||(S==="TRUE"?L={t:"b",v:!0}:S==="FALSE"?L={t:"b",v:!1}:isNaN(Zr(S))?isNaN(Tc(S).getDate())||(L={t:"d",v:cn(S)},a.cellDates||(L={t:"n",v:zn(L.v)}),L.z=a.dateNF||ct[14]):L={t:"n",v:Zr(S)}),a.dense?(r[h]||(r[h]=[]),r[h][m]=L):r[dt({r:h,c:m})]=L,m+=p}}}}return r["!ref"]=pt(b),g.length&&(r["!merges"]=g),r}function Z9(e,n,a,r){for(var s=e["!merges"]||[],l=[],o=n.s.c;o<=n.e.c;++o){for(var d=0,u=0,h=0;h<s.length;++h)if(!(s[h].s.r>a||s[h].s.c>o)&&!(s[h].e.r<a||s[h].e.c<o)){if(s[h].s.r<a||s[h].s.c<o){d=-1;break}d=s[h].e.r-s[h].s.r+1,u=s[h].e.c-s[h].s.c+1;break}if(!(d<0)){var m=dt({r:a,c:o}),f=r.dense?(e[a]||[])[o]:e[m],p=f&&f.v!=null&&(f.h||jg(f.w||(li(f),f.w)||""))||"",b={};d>1&&(b.rowspan=d),u>1&&(b.colspan=u),r.editable?p='<span contenteditable="true">'+p+"</span>":f&&(b["data-t"]=f&&f.t||"z",f.v!=null&&(b["data-v"]=f.v),f.z!=null&&(b["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+f.l.Target+'">'+p+"</a>")),b.id=(r.id||"sjs")+"-"+m,l.push(Ve("td",p,b))}}var g="<tr>";return g+l.join("")+"</tr>"}var eH='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',tH="</body></html>";function nH(e,n){var a=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!a||a.length==0)throw new Error("Invalid HTML: could not find <table>");if(a.length==1)return ul(e2(a[0],n),n);var r=Zg();return a.forEach(function(s,l){ey(r,e2(s,n),"Sheet"+(l+1))}),r}function aH(e,n,a){var r=[];return r.join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}function hT(e,n){var a=n||{},r=a.header!=null?a.header:eH,s=a.footer!=null?a.footer:tH,l=[r],o=er(e["!ref"]);a.dense=Array.isArray(e),l.push(aH(e,o,a));for(var d=o.s.r;d<=o.e.r;++d)l.push(Z9(e,o,d,a));return l.push("</table>"+s),l.join("")}function xT(e,n,a){var r=a||{},s=0,l=0;if(r.origin!=null)if(typeof r.origin=="number")s=r.origin;else{var o=typeof r.origin=="string"?gn(r.origin):r.origin;s=o.r,l=o.c}var d=n.getElementsByTagName("tr"),u=Math.min(r.sheetRows||1e7,d.length),h={s:{r:0,c:0},e:{r:s,c:l}};if(e["!ref"]){var m=er(e["!ref"]);h.s.r=Math.min(h.s.r,m.s.r),h.s.c=Math.min(h.s.c,m.s.c),h.e.r=Math.max(h.e.r,m.e.r),h.e.c=Math.max(h.e.c,m.e.c),s==-1&&(h.e.r=s=m.e.r+1)}var f=[],p=0,b=e["!rows"]||(e["!rows"]=[]),g=0,y=0,N=0,C=0,T=0,S=0;for(e["!cols"]||(e["!cols"]=[]);g<d.length&&y<u;++g){var k=d[g];if(t2(k)){if(r.display)continue;b[y]={hidden:!0}}var _=k.children;for(N=C=0;N<_.length;++N){var P=_[N];if(!(r.display&&t2(P))){var j=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):Iw(P.innerHTML),A=P.getAttribute("data-z")||P.getAttribute("z");for(p=0;p<f.length;++p){var L=f[p];L.s.c==C+l&&L.s.r<y+s&&y+s<=L.e.r&&(C=L.e.c+1-l,p=-1)}S=+P.getAttribute("colspan")||1,((T=+P.getAttribute("rowspan")||1)>1||S>1)&&f.push({s:{r:y+s,c:C+l},e:{r:y+s+(T||1)-1,c:C+l+(S||1)-1}});var W={t:"s",v:j},R=P.getAttribute("data-t")||P.getAttribute("t")||"";j!=null&&(j.length==0?W.t=R||"z":r.raw||j.trim().length==0||R=="s"||(j==="TRUE"?W={t:"b",v:!0}:j==="FALSE"?W={t:"b",v:!1}:isNaN(Zr(j))?isNaN(Tc(j).getDate())||(W={t:"d",v:cn(j)},r.cellDates||(W={t:"n",v:zn(W.v)}),W.z=r.dateNF||ct[14]):W={t:"n",v:Zr(j)})),W.z===void 0&&A!=null&&(W.z=A);var M="",q=P.getElementsByTagName("A");if(q&&q.length)for(var ee=0;ee<q.length&&!(q[ee].hasAttribute("href")&&(M=q[ee].getAttribute("href"),M.charAt(0)!="#"));++ee);M&&M.charAt(0)!="#"&&(W.l={Target:M}),r.dense?(e[y+s]||(e[y+s]=[]),e[y+s][C+l]=W):e[dt({c:C+l,r:y+s})]=W,h.e.c<C+l&&(h.e.c=C+l),C+=S}}++y}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),h.e.r=Math.max(h.e.r,y-1+s),e["!ref"]=pt(h),y>=u&&(e["!fullref"]=pt((h.e.r=d.length-g+y-1+s,h))),e}function mT(e,n){var a=n||{},r=a.dense?[]:{};return xT(r,e,n)}function rH(e,n){return ul(mT(e,n),n)}function t2(e){var n="",a=sH(e);return a&&(n=a(e).getPropertyValue("display")),n||(n=e.style&&e.style.display),n==="none"}function sH(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function iH(e){var n=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),a=Et(n.replace(/<[^>]*>/g,""));return[a]}var n2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function fT(e,n){var a=n||{},r=wg(e),s=[],l,o,d={name:""},u="",h=0,m,f,p={},b=[],g=a.dense?[]:{},y,N,C={value:""},T="",S=0,k=[],_=-1,P=-1,j={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,L={},W=[],R={},M=0,q=0,ee=[],z=1,fe=1,ae=[],J={Names:[]},G={},he=["",""],H=[],F={},I="",O=0,V=!1,te=!1,pe=0;for(eu.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=eu.exec(r);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(j.e.c>=j.s.c&&j.e.r>=j.s.r?g["!ref"]=pt(j):g["!ref"]="A1:A1",a.sheetRows>0&&a.sheetRows<=j.e.r&&(g["!fullref"]=g["!ref"],j.e.r=a.sheetRows-1,g["!ref"]=pt(j)),W.length&&(g["!merges"]=W),ee.length&&(g["!rows"]=ee),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),b.push(m.name),p[m.name]=g,te=!1):y[0].charAt(y[0].length-2)!=="/"&&(m=ut(y[0],!1),_=P=-1,j.s.r=j.s.c=1e7,j.e.r=j.e.c=0,g=a.dense?[]:{},W=[],ee=[],te=!0);break;case"table-row-group":y[1]==="/"?--A:++A;break;case"table-row":case"":if(y[1]==="/"){_+=z,z=1;break}if(f=ut(y[0],!1),f.?_=f.-1:_==-1&&(_=0),z=+f["number-rows-repeated"]||1,z<10)for(pe=0;pe<z;++pe)A>0&&(ee[_+pe]={level:A});P=-1;break;case"covered-table-cell":y[1]!=="/"&&++P,a.sheetStubs&&(a.dense?(g[_]||(g[_]=[]),g[_][P]={t:"z"}):g[dt({r:_,c:P})]={t:"z"}),T="",k=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++P,C=ut(y[0],!1),fe=parseInt(C["number-columns-repeated"]||"1",10),N={t:"z",v:null},C.formula&&a.cellFormula!=!1&&(N.f=YN(Et(C.formula))),(C.||C["value-type"])=="string"&&(N.t="s",N.v=Et(C["string-value"]||""),a.dense?(g[_]||(g[_]=[]),g[_][P]=N):g[dt({r:_,c:P})]=N),P+=fe-1;else if(y[1]!=="/"){++P,T="",S=0,k=[],fe=1;var U=z?_+z-1:_;if(P>j.e.c&&(j.e.c=P),P<j.s.c&&(j.s.c=P),_<j.s.r&&(j.s.r=_),U>j.e.r&&(j.e.r=U),C=ut(y[0],!1),H=[],F={},N={t:C.||C["value-type"],v:null},a.cellFormula)if(C.formula&&(C.formula=Et(C.formula)),C["number-matrix-columns-spanned"]&&C["number-matrix-rows-spanned"]&&(M=parseInt(C["number-matrix-rows-spanned"],10)||0,q=parseInt(C["number-matrix-columns-spanned"],10)||0,R={s:{r:_,c:P},e:{r:_+M-1,c:P+q-1}},N.F=pt(R),ae.push([R,N.F])),C.formula)N.f=YN(C.formula);else for(pe=0;pe<ae.length;++pe)_>=ae[pe][0].s.r&&_<=ae[pe][0].e.r&&P>=ae[pe][0].s.c&&P<=ae[pe][0].e.c&&(N.F=ae[pe][1]);switch((C["number-columns-spanned"]||C["number-rows-spanned"])&&(M=parseInt(C["number-rows-spanned"],10)||0,q=parseInt(C["number-columns-spanned"],10)||0,R={s:{r:_,c:P},e:{r:_+M-1,c:P+q-1}},W.push(R)),C["number-columns-repeated"]&&(fe=parseInt(C["number-columns-repeated"],10)),N.t){case"boolean":N.t="b",N.v=sn(C["boolean-value"]);break;case"float":N.t="n",N.v=parseFloat(C.value);break;case"percentage":N.t="n",N.v=parseFloat(C.value);break;case"currency":N.t="n",N.v=parseFloat(C.value);break;case"date":N.t="d",N.v=cn(C["date-value"]),a.cellDates||(N.t="n",N.v=zn(N.v)),N.z="m/d/yy";break;case"time":N.t="n",N.v=PA(C["time-value"])/86400,a.cellDates&&(N.t="d",N.v=rx(N.v)),N.z="HH:MM:SS";break;case"number":N.t="n",N.v=parseFloat(C.);break;default:if(N.t==="string"||N.t==="text"||!N.t)N.t="s",C["string-value"]!=null&&(T=Et(C["string-value"]),k=[]);else throw new Error("Unsupported value type "+N.t)}}else{if(V=!1,N.t==="s"&&(N.v=T||"",k.length&&(N.R=k),V=S==0),G.Target&&(N.l=G),H.length>0&&(N.c=H,H=[]),T&&a.cellText!==!1&&(N.w=T),V&&(N.t="z",delete N.v),(!V||a.sheetStubs)&&!(a.sheetRows&&a.sheetRows<=_))for(var ce=0;ce<z;++ce){if(fe=parseInt(C["number-columns-repeated"]||"1",10),a.dense)for(g[_+ce]||(g[_+ce]=[]),g[_+ce][P]=ce==0?N:dn(N);--fe>0;)g[_+ce][P+fe]=dn(N);else for(g[dt({r:_+ce,c:P})]=N;--fe>0;)g[dt({r:_+ce,c:P+fe})]=dn(N);j.e.c<=P&&(j.e.c=P)}fe=parseInt(C["number-columns-repeated"]||"1",10),P+=fe-1,fe=0,N={},T="",k=[]}G={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((l=s.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((l=s.pop())[0]!==y[3])throw"Bad state: "+l;F.t=T,k.length&&(F.R=k),F.a=I,H.push(F)}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);I="",O=0,T="",S=0,k=[];break;case"creator":y[1]==="/"?I=r.slice(O,y.index):O=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((l=s.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);T="",S=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(L[d.name]=u,(l=s.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&(u="",d=ut(y[0],!1),s.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=ut(y[0],!1),u+=n2[y[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=ut(y[0],!1),u+=n2[y[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":u+=r.slice(h,y.index);break}else h=y.index+y[0].length;break;case"named-range":o=ut(y[0],!1),he=Sf(o["cell-range-address"]);var Q={Name:o.name,Ref:he[0]+"!"+he[1]};te&&(Q.Sheet=b.length),J.Names.push(Q);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(y[1]==="/"&&(!C||!C["string-value"])){var oe=iH(r.slice(S,y.index));T=(T.length>0?T+`
`:"")+oe[0]}else ut(y[0],!1),S=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{he=Sf(ut(y[0])["target-range-address"]),p[he[0]]["!autofilter"]={ref:he[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(G=ut(y[0],!1),!G.href)break;G.Target=Et(G.href),delete G.href,G.Target.charAt(0)=="#"&&G.Target.indexOf(".")>-1?(he=Sf(G.Target.slice(1)),G.Target="#"+he[0]+"!"+he[1]):G.Target.match(/^\.\.[\\\/]/)&&(G.Target=G.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(a.WTF)throw new Error(y)}}var X={Sheets:p,SheetNames:b,Workbook:J};return a.bookSheets&&delete X.Sheets,X}function a2(e,n){n=n||{},kr(e,"META-INF/manifest.xml")&&P8(Ln(e,"META-INF/manifest.xml"),n);var a=dr(e,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var r=fT(Xt(a),n);return kr(e,"meta.xml")&&(r.Props=ik(Ln(e,"meta.xml"))),r}function r2(e,n){return fT(e,n)}var lH=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),n="<office:document-styles "+Zd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Fn+n}})(),s2=(function(){var e=function(l){return $t(l).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},n=`          <table:table-cell />
`,a=`          <table:covered-table-cell/>
`,r=function(l,o,d){var u=[];u.push('      <table:table table:name="'+$t(o.SheetNames[d])+`" table:style-name="ta1">
`);var h=0,m=0,f=er(l["!ref"]||"A1"),p=l["!merges"]||[],b=0,g=Array.isArray(l);if(l["!cols"])for(m=0;m<=f.e.c;++m)u.push("        <table:table-column"+(l["!cols"][m]?' table:style-name="co'+l["!cols"][m].ods+'"':"")+`></table:table-column>
`);var y="",N=l["!rows"]||[];for(h=0;h<f.s.r;++h)y=N[h]?' table:style-name="ro'+N[h].ods+'"':"",u.push("        <table:table-row"+y+`></table:table-row>
`);for(;h<=f.e.r;++h){for(y=N[h]?' table:style-name="ro'+N[h].ods+'"':"",u.push("        <table:table-row"+y+`>
`),m=0;m<f.s.c;++m)u.push(n);for(;m<=f.e.c;++m){var C=!1,T={},S="";for(b=0;b!=p.length;++b)if(!(p[b].s.c>m)&&!(p[b].s.r>h)&&!(p[b].e.c<m)&&!(p[b].e.r<h)){(p[b].s.c!=m||p[b].s.r!=h)&&(C=!0),T["table:number-columns-spanned"]=p[b].e.c-p[b].s.c+1,T["table:number-rows-spanned"]=p[b].e.r-p[b].s.r+1;break}if(C){u.push(a);continue}var k=dt({r:h,c:m}),_=g?(l[h]||[])[m]:l[k];if(_&&_.f&&(T["table:formula"]=$t(S7(_.f)),_.F&&_.F.slice(0,k.length)==k)){var P=er(_.F);T["table:number-matrix-columns-spanned"]=P.e.c-P.s.c+1,T["table:number-matrix-rows-spanned"]=P.e.r-P.s.r+1}if(!_){u.push(n);continue}switch(_.t){case"b":S=_.v?"TRUE":"FALSE",T["office:value-type"]="boolean",T["office:boolean-value"]=_.v?"true":"false";break;case"n":S=_.w||String(_.v||0),T["office:value-type"]="float",T["office:value"]=_.v||0;break;case"s":case"str":S=_.v==null?"":_.v,T["office:value-type"]="string";break;case"d":S=_.w||cn(_.v).toISOString(),T["office:value-type"]="date",T["office:date-value"]=cn(_.v).toISOString(),T["table:style-name"]="ce1";break;default:u.push(n);continue}var j=e(S);if(_.l&&_.l.Target){var A=_.l.Target;A=A.charAt(0)=="#"?"#"+_7(A.slice(1)):A,A.charAt(0)!="#"&&!A.match(/^\w+:/)&&(A="../"+A),j=Ve("text:a",j,{"xlink:href":A.replace(/&/g,"&amp;")})}u.push("          "+Ve("table:table-cell",Ve("text:p",j,{}),T)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},s=function(l,o){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var d=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var m=0;m<h["!cols"].length;++m)if(h["!cols"][m]){var f=h["!cols"][m];if(f.width==null&&f.wpx==null&&f.wch==null)continue;sl(f),f.ods=d;var p=h["!cols"][m].wpx+"px";l.push('  <style:style style:name="co'+d+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),l.push(`  </style:style>
`),++d}}});var u=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var m=0;m<h["!rows"].length;++m)if(h["!rows"][m]){h["!rows"][m].ods=u;var f=h["!rows"][m].hpx+"px";l.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),l.push(`  </style:style>
`),++u}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(o,d){var u=[Fn],h=Zd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=Zd({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});d.bookType=="fods"?(u.push("<office:document"+h+m+`>
`),u.push(sk().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+h+`>
`),s(u,o),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)u.push(r(o.Sheets[o.SheetNames[f]],o,f));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),d.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}})();function pT(e,n){if(n.bookType=="fods")return s2(e,n);var a=vg(),r="",s=[],l=[];return r="mimetype",gt(a,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",gt(a,r,s2(e,n)),s.push([r,"text/xml"]),l.push([r,"ContentFile"]),r="styles.xml",gt(a,r,lH(e,n)),s.push([r,"text/xml"]),l.push([r,"StylesFile"]),r="meta.xml",gt(a,r,Fn+sk()),s.push([r,"text/xml"]),l.push([r,"MetadataFile"]),r="manifest.rdf",gt(a,r,I8(l)),s.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",gt(a,r,L8(s)),a}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function co(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Fp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Xt(dl(e))}function oH(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):cr(Ns(e))}function cH(e,n){e:for(var a=0;a<=e.length-n.length;++a){for(var r=0;r<n.length;++r)if(e[a+r]!=n[r])continue e;return!0}return!1}function ll(e){var n=e.reduce(function(s,l){return s+l.length},0),a=new Uint8Array(n),r=0;return e.forEach(function(s){a.set(s,r),r+=s.length}),a}function i2(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function dH(e,n){for(var a=(e[n+15]&127)<<7|e[n+14]>>1,r=e[n+14]&1,s=n+13;s>=n;--s)r=r*256+e[s];return(e[n+15]&128?-r:r)*Math.pow(10,a-6176)}function uH(e,n,a){var r=Math.floor(a==0?0:Math.LOG10E*Math.log(Math.abs(a)))+6176-20,s=a/Math.pow(10,r-6176);e[n+15]|=r>>7,e[n+14]|=(r&127)<<1;for(var l=0;s>=1;++l,s/=256)e[n+l]=s&255;e[n+15]|=a>=0?0:128}function lu(e,n){var a=n?n[0]:0,r=e[a]&127;e:if(e[a++]>=128&&(r|=(e[a]&127)<<7,e[a++]<128||(r|=(e[a]&127)<<14,e[a++]<128)||(r|=(e[a]&127)<<21,e[a++]<128)||(r+=(e[a]&127)*Math.pow(2,28),++a,e[a++]<128)||(r+=(e[a]&127)*Math.pow(2,35),++a,e[a++]<128)||(r+=(e[a]&127)*Math.pow(2,42),++a,e[a++]<128)))break e;return n&&(n[0]=a),r}function Kt(e){var n=new Uint8Array(7);n[0]=e&127;var a=1;e:if(e>127){if(n[a-1]|=128,n[a]=e>>7&127,++a,e<=16383||(n[a-1]|=128,n[a]=e>>14&127,++a,e<=2097151)||(n[a-1]|=128,n[a]=e>>21&127,++a,e<=268435455)||(n[a-1]|=128,n[a]=e/256>>>21&127,++a,e<=34359738367)||(n[a-1]|=128,n[a]=e/65536>>>21&127,++a,e<=4398046511103))break e;n[a-1]|=128,n[a]=e/16777216>>>21&127,++a}return n.slice(0,a)}function Nn(e){var n=0,a=e[n]&127;e:if(e[n++]>=128){if(a|=(e[n]&127)<<7,e[n++]<128||(a|=(e[n]&127)<<14,e[n++]<128)||(a|=(e[n]&127)<<21,e[n++]<128))break e;a|=(e[n]&127)<<28}return a}function Lt(e){for(var n=[],a=[0];a[0]<e.length;){var r=a[0],s=lu(e,a),l=s&7;s=Math.floor(s/8);var o=0,d;if(s==0)break;switch(l){case 0:{for(var u=a[0];e[a[0]++]>=128;);d=e.slice(u,a[0])}break;case 5:o=4,d=e.slice(a[0],a[0]+o),a[0]+=o;break;case 1:o=8,d=e.slice(a[0],a[0]+o),a[0]+=o;break;case 2:o=lu(e,a),d=e.slice(a[0],a[0]+o),a[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(s," at offset ").concat(r))}var h={data:d,type:l};n[s]==null?n[s]=[h]:n[s].push(h)}return n}function la(e){var n=[];return e.forEach(function(a,r){a.forEach(function(s){s.data&&(n.push(Kt(r*8+s.type)),s.type==2&&n.push(Kt(s.data.length)),n.push(s.data))})}),ll(n)}function qg(e,n){return(e==null?void 0:e.map(function(a){return n(a.data)}))||[]}function jr(e){for(var n,a=[],r=[0];r[0]<e.length;){var s=lu(e,r),l=Lt(e.slice(r[0],r[0]+s));r[0]+=s;var o={id:Nn(l[1][0].data),messages:[]};l[2].forEach(function(d){var u=Lt(d.data),h=Nn(u[3][0].data);o.messages.push({meta:u,data:e.slice(r[0],r[0]+h)}),r[0]+=h}),(n=l[3])!=null&&n[0]&&(o.merge=Nn(l[3][0].data)>>>0>0),a.push(o)}return a}function Jo(e){var n=[];return e.forEach(function(a){var r=[];r[1]=[{data:Kt(a.id),type:0}],r[2]=[],a.merge!=null&&(r[3]=[{data:Kt(+!!a.merge),type:0}]);var s=[];a.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:Kt(o.data.length)}],r[2].push({data:la(o.meta),type:2})});var l=la(r);n.push(Kt(l.length)),n.push(l),s.forEach(function(o){return n.push(o)})}),ll(n)}function hH(e,n){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var a=[0],r=lu(n,a),s=[];a[0]<n.length;){var l=n[a[0]]&3;if(l==0){var o=n[a[0]++]>>2;if(o<60)++o;else{var d=o-59;o=n[a[0]],d>1&&(o|=n[a[0]+1]<<8),d>2&&(o|=n[a[0]+2]<<16),d>3&&(o|=n[a[0]+3]<<24),o>>>=0,o++,a[0]+=d}s.push(n.slice(a[0],a[0]+o)),a[0]+=o;continue}else{var u=0,h=0;if(l==1?(h=(n[a[0]]>>2&7)+4,u=(n[a[0]++]&224)<<3,u|=n[a[0]++]):(h=(n[a[0]++]>>2)+1,l==2?(u=n[a[0]]|n[a[0]+1]<<8,a[0]+=2):(u=(n[a[0]]|n[a[0]+1]<<8|n[a[0]+2]<<16|n[a[0]+3]<<24)>>>0,a[0]+=4)),s=[ll(s)],u==0)throw new Error("Invalid offset 0");if(u>s[0].length)throw new Error("Invalid offset beyond length");if(h>=u)for(s.push(s[0].slice(-u)),h-=u;h>=s[s.length-1].length;)s.push(s[s.length-1]),h-=s[s.length-1].length;s.push(s[0].slice(-u,-u+h))}}var m=ll(s);if(m.length!=r)throw new Error("Unexpected length: ".concat(m.length," != ").concat(r));return m}function wr(e){for(var n=[],a=0;a<e.length;){var r=e[a++],s=e[a]|e[a+1]<<8|e[a+2]<<16;a+=3,n.push(hH(r,e.slice(a,a+s))),a+=s}if(a!==e.length)throw new Error("data is not a valid framed stream!");return ll(n)}function Zo(e){for(var n=[],a=0;a<e.length;){var r=Math.min(e.length-a,268435455),s=new Uint8Array(4);n.push(s);var l=Kt(r),o=l.length;n.push(l),r<=60?(o++,n.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,n.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,n.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,n.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,n.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),n.push(e.slice(a,a+r)),o+=r,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,a+=r}return ll(n)}function xH(e,n,a,r){var s=co(e),l=s.getUint32(4,!0),o=(r>1?12:8)+i2(l&(r>1?3470:398))*4,d=-1,u=-1,h=NaN,m=new Date(2001,0,1);l&512&&(d=s.getUint32(o,!0),o+=4),o+=i2(l&(r>1?12288:4096))*4,l&16&&(u=s.getUint32(o,!0),o+=4),l&32&&(h=s.getFloat64(o,!0),o+=8),l&64&&(m.setTime(m.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:h};break;case 3:f={t:"s",v:n[u]};break;case 5:f={t:"d",v:m};break;case 6:f={t:"b",v:h>0};break;case 7:f={t:"n",v:h/86400};break;case 8:f={t:"e",v:0};break;case 9:if(d>-1)f={t:"s",v:a[d]};else if(u>-1)f={t:"s",v:n[u]};else if(!isNaN(h))f={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function mH(e,n,a){var r=co(e),s=r.getUint32(8,!0),l=12,o=-1,d=-1,u=NaN,h=NaN,m=new Date(2001,0,1);s&1&&(u=dH(e,l),l+=16),s&2&&(h=r.getFloat64(l,!0),l+=8),s&4&&(m.setTime(m.getTime()+r.getFloat64(l,!0)*1e3),l+=8),s&8&&(d=r.getUint32(l,!0),l+=4),s&16&&(o=r.getUint32(l,!0),l+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:n[d]};break;case 5:f={t:"d",v:m};break;case 6:f={t:"b",v:h>0};break;case 7:f={t:"n",v:h/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:a[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function Ef(e,n){var a=new Uint8Array(32),r=co(a),s=12,l=0;switch(a[0]=5,e.t){case"n":a[1]=2,uH(a,s,e.v),l|=1,s+=16;break;case"b":a[1]=6,r.setFloat64(s,e.v?1:0,!0),l|=2,s+=8;break;case"s":if(n.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));a[1]=3,r.setUint32(s,n.indexOf(e.v),!0),l|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,l,!0),a.slice(0,s)}function Df(e,n){var a=new Uint8Array(32),r=co(a),s=12,l=0;switch(a[0]=3,e.t){case"n":a[2]=2,r.setFloat64(s,e.v,!0),l|=32,s+=8;break;case"b":a[2]=6,r.setFloat64(s,e.v?1:0,!0),l|=32,s+=8;break;case"s":if(n.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));a[2]=3,r.setUint32(s,n.indexOf(e.v),!0),l|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,l,!0),a.slice(0,s)}function fH(e,n,a){switch(e[0]){case 0:case 1:case 2:case 3:return xH(e,n,a,e[0]);case 5:return mH(e,n,a);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ya(e){var n=Lt(e);return lu(n[1][0].data)}function l2(e,n){var a=Lt(n.data),r=Nn(a[1][0].data),s=a[3],l=[];return(s||[]).forEach(function(o){var d=Lt(o.data),u=Nn(d[1][0].data)>>>0;switch(r){case 1:l[u]=Fp(d[3][0].data);break;case 8:{var h=e[ya(d[9][0].data)][0],m=Lt(h.data),f=e[ya(m[1][0].data)][0],p=Nn(f.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var b=Lt(f.data);l[u]=b[3].map(function(g){return Fp(g.data)}).join("")}break}}),l}function pH(e,n){var a,r,s,l,o,d,u,h,m,f,p,b,g,y,N=Lt(e),C=Nn(N[1][0].data)>>>0,T=Nn(N[2][0].data)>>>0,S=((r=(a=N[8])==null?void 0:a[0])==null?void 0:r.data)&&Nn(N[8][0].data)>0||!1,k,_;if((l=(s=N[7])==null?void 0:s[0])!=null&&l.data&&n!=0)k=(d=(o=N[7])==null?void 0:o[0])==null?void 0:d.data,_=(h=(u=N[6])==null?void 0:u[0])==null?void 0:h.data;else if((f=(m=N[4])==null?void 0:m[0])!=null&&f.data&&n!=1)k=(b=(p=N[4])==null?void 0:p[0])==null?void 0:b.data,_=(y=(g=N[3])==null?void 0:g[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var P=S?4:1,j=co(k),A=[],L=0;L<k.length/2;++L){var W=j.getUint16(L*2,!0);W<65535&&A.push([L,W])}if(A.length!=T)throw"Expected ".concat(T," cells, found ").concat(A.length);var R=[];for(L=0;L<A.length-1;++L)R[A[L][0]]=_.subarray(A[L][1]*P,A[L+1][1]*P);return A.length>=1&&(R[A[A.length-1][0]]=_.subarray(A[A.length-1][1]*P)),{R:C,cells:R}}function gH(e,n){var a,r=Lt(n.data),s=(a=r==null?void 0:r[7])!=null&&a[0]?Nn(r[7][0].data)>>>0>0?1:0:-1,l=qg(r[5],function(o){return pH(o,s)});return{nrows:Nn(r[4][0].data)>>>0,data:l.reduce(function(o,d){return o[d.R]||(o[d.R]=[]),d.cells.forEach(function(u,h){if(o[d.R][h])throw new Error("Duplicate cell r=".concat(d.R," c=").concat(h));o[d.R][h]=u}),o},[])}}function yH(e,n,a){var r,s=Lt(n.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(Nn(s[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(l.e.c=(Nn(s[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));a["!ref"]=pt(l);var o=Lt(s[4][0].data),d=l2(e,e[ya(o[4][0].data)][0]),u=(r=o[17])!=null&&r[0]?l2(e,e[ya(o[17][0].data)][0]):[],h=Lt(o[3][0].data),m=0;h[1].forEach(function(f){var p=Lt(f.data),b=e[ya(p[2][0].data)][0],g=Nn(b.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var y=gH(e,b);y.data.forEach(function(N,C){N.forEach(function(T,S){var k=dt({r:m+C,c:S}),_=fH(T,d,u);_&&(a[k]=_)})}),m+=y.nrows})}function vH(e,n){var a=Lt(n.data),r={"!ref":"A1"},s=e[ya(a[2][0].data)],l=Nn(s[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return yH(e,s[0],r),r}function bH(e,n){var a,r=Lt(n.data),s={name:(a=r[1])!=null&&a[0]?Fp(r[1][0].data):"",sheets:[]},l=qg(r[2],ya);return l.forEach(function(o){e[o].forEach(function(d){var u=Nn(d.meta[1][0].data);u==6e3&&s.sheets.push(vH(e,d))})}),s}function NH(e,n){var a=Zg(),r=Lt(n.data),s=qg(r[1],ya);if(s.forEach(function(l){e[l].forEach(function(o){var d=Nn(o.meta[1][0].data);if(d==2){var u=bH(e,o);u.sheets.forEach(function(h,m){ey(a,h,m==0?u.name:u.name+"_"+m,!0)})}})}),a.SheetNames.length==0)throw new Error("Empty NUMBERS file");return a}function Ff(e){var n,a,r,s,l={},o=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var h;try{h=wr(u.content)}catch(f){return console.log("?? "+u.content.length+" "+(f.message||f))}var m;try{m=jr(h)}catch(f){return console.log("## "+(f.message||f))}m.forEach(function(f){l[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var d=((s=(r=(a=(n=l==null?void 0:l[1])==null?void 0:n[0])==null?void 0:a.meta)==null?void 0:r[1])==null?void 0:s[0].data)&&Nn(l[1][0].meta[1][0].data)==1&&l[1][0];if(d||o.forEach(function(u){l[u].forEach(function(h){var m=Nn(h.meta[1][0].data)>>>0;if(m==1)if(!d)d=h;else throw new Error("Document has multiple roots")})}),!d)throw new Error("Cannot find Document root");return NH(l,d)}function jH(e,n,a){var r,s,l,o;if(!((r=e[6])!=null&&r[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var d=((o=(l=e[8])==null?void 0:l[0])==null?void 0:o.data)&&Nn(e[8][0].data)>0||!1;if(d)throw"Math only works with normal offsets";for(var u=0,h=co(e[7][0].data),m=0,f=[],p=co(e[4][0].data),b=0,g=[],y=0;y<n.length;++y){if(n[y]==null){h.setUint16(y*2,65535,!0),p.setUint16(y*2,65535);continue}h.setUint16(y*2,m,!0),p.setUint16(y*2,b,!0);var N,C;switch(typeof n[y]){case"string":N=Ef({t:"s",v:n[y]},a),C=Df({t:"s",v:n[y]},a);break;case"number":N=Ef({t:"n",v:n[y]},a),C=Df({t:"n",v:n[y]},a);break;case"boolean":N=Ef({t:"b",v:n[y]},a),C=Df({t:"b",v:n[y]},a);break;default:throw new Error("Unsupported value "+n[y])}f.push(N),m+=N.length,g.push(C),b+=C.length,++u}for(e[2][0].data=Kt(u);y<e[7][0].data.length/2;++y)h.setUint16(y*2,65535,!0),p.setUint16(y*2,65535,!0);return e[6][0].data=ll(f),e[3][0].data=ll(g),u}function wH(e,n){if(!n||!n.numbers)throw new Error("Must pass a `numbers` option -- check the README");var a=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=er(a["!ref"]);r.s.r=r.s.c=0;var s=!1;r.e.c>9&&(s=!0,r.e.c=9),r.e.r>49&&(s=!0,r.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(pt(r)));var l=I0(a,{range:r,header:1}),o=["~Sh33tJ5~"];l.forEach(function(I){return I.forEach(function(O){typeof O=="string"&&o.push(O)})});var d={},u=[],h=nt.read(n.numbers,{type:"base64"});h.FileIndex.map(function(I,O){return[I,h.FullPaths[O]]}).forEach(function(I){var O=I[0],V=I[1];if(O.type==2&&O.name.match(/\.iwa/)){var te=O.content,pe=wr(te),U=jr(pe);U.forEach(function(ce){u.push(ce.id),d[ce.id]={deps:[],location:V,type:Nn(ce.messages[0].meta[1][0].data)}})}}),u.sort(function(I,O){return I-O});var m=u.filter(function(I){return I>1}).map(function(I){return[I,Kt(I)]});h.FileIndex.map(function(I,O){return[I,h.FullPaths[O]]}).forEach(function(I){var O=I[0];if(I[1],!!O.name.match(/\.iwa/)){var V=jr(wr(O.content));V.forEach(function(te){te.messages.forEach(function(pe){m.forEach(function(U){te.messages.some(function(ce){return Nn(ce.meta[1][0].data)!=11006&&cH(ce.data,U[1])})&&d[U[0]].deps.push(te.id)})})})}});for(var f=nt.find(h,d[1].location),p=jr(wr(f.content)),b,g=0;g<p.length;++g){var y=p[g];y.id==1&&(b=y)}var N=ya(Lt(b.messages[0].data)[1][0].data);for(f=nt.find(h,d[N].location),p=jr(wr(f.content)),g=0;g<p.length;++g)y=p[g],y.id==N&&(b=y);for(N=ya(Lt(b.messages[0].data)[2][0].data),f=nt.find(h,d[N].location),p=jr(wr(f.content)),g=0;g<p.length;++g)y=p[g],y.id==N&&(b=y);for(N=ya(Lt(b.messages[0].data)[2][0].data),f=nt.find(h,d[N].location),p=jr(wr(f.content)),g=0;g<p.length;++g)y=p[g],y.id==N&&(b=y);var C=Lt(b.messages[0].data);{C[6][0].data=Kt(r.e.r+1),C[7][0].data=Kt(r.e.c+1);var T=ya(C[46][0].data),S=nt.find(h,d[T].location),k=jr(wr(S.content));{for(var _=0;_<k.length&&k[_].id!=T;++_);if(k[_].id!=T)throw"Bad ColumnRowUIDMapArchive";var P=Lt(k[_].messages[0].data);P[1]=[],P[2]=[],P[3]=[];for(var j=0;j<=r.e.c;++j){var A=[];A[1]=A[2]=[{type:0,data:Kt(j+420690)}],P[1].push({type:2,data:la(A)}),P[2].push({type:0,data:Kt(j)}),P[3].push({type:0,data:Kt(j)})}P[4]=[],P[5]=[],P[6]=[];for(var L=0;L<=r.e.r;++L)A=[],A[1]=A[2]=[{type:0,data:Kt(L+726270)}],P[4].push({type:2,data:la(A)}),P[5].push({type:0,data:Kt(L)}),P[6].push({type:0,data:Kt(L)});k[_].messages[0].data=la(P)}S.content=Zo(Jo(k)),S.size=S.content.length,delete C[46];var W=Lt(C[4][0].data);{W[7][0].data=Kt(r.e.r+1);var R=Lt(W[1][0].data),M=ya(R[2][0].data);S=nt.find(h,d[M].location),k=jr(wr(S.content));{if(k[0].id!=M)throw"Bad HeaderStorageBucket";var q=Lt(k[0].messages[0].data);for(L=0;L<l.length;++L){var ee=Lt(q[2][0].data);ee[1][0].data=Kt(L),ee[4][0].data=Kt(l[L].length),q[2][L]={type:q[2][0].type,data:la(ee)}}k[0].messages[0].data=la(q)}S.content=Zo(Jo(k)),S.size=S.content.length;var z=ya(W[2][0].data);S=nt.find(h,d[z].location),k=jr(wr(S.content));{if(k[0].id!=z)throw"Bad HeaderStorageBucket";for(q=Lt(k[0].messages[0].data),j=0;j<=r.e.c;++j)ee=Lt(q[2][0].data),ee[1][0].data=Kt(j),ee[4][0].data=Kt(r.e.r+1),q[2][j]={type:q[2][0].type,data:la(ee)};k[0].messages[0].data=la(q)}S.content=Zo(Jo(k)),S.size=S.content.length;var fe=ya(W[4][0].data);(function(){for(var I=nt.find(h,d[fe].location),O=jr(wr(I.content)),V,te=0;te<O.length;++te){var pe=O[te];pe.id==fe&&(V=pe)}var U=Lt(V.messages[0].data);{U[3]=[];var ce=[];o.forEach(function(X,ve){ce[1]=[{type:0,data:Kt(ve)}],ce[2]=[{type:0,data:Kt(1)}],ce[3]=[{type:2,data:oH(X)}],U[3].push({type:2,data:la(ce)})})}V.messages[0].data=la(U);var Q=Jo(O),oe=Zo(Q);I.content=oe,I.size=I.content.length})();var ae=Lt(W[3][0].data);{var J=ae[1][0];delete ae[2];var G=Lt(J.data);{var he=ya(G[2][0].data);(function(){for(var I=nt.find(h,d[he].location),O=jr(wr(I.content)),V,te=0;te<O.length;++te){var pe=O[te];pe.id==he&&(V=pe)}var U=Lt(V.messages[0].data);{delete U[6],delete ae[7];var ce=new Uint8Array(U[5][0].data);U[5]=[];for(var Q=0,oe=0;oe<=r.e.r;++oe){var X=Lt(ce);Q+=jH(X,l[oe],o),X[1][0].data=Kt(oe),U[5].push({data:la(X),type:2})}U[1]=[{type:0,data:Kt(r.e.c+1)}],U[2]=[{type:0,data:Kt(r.e.r+1)}],U[3]=[{type:0,data:Kt(Q)}],U[4]=[{type:0,data:Kt(r.e.r+1)}]}V.messages[0].data=la(U);var ve=Jo(O),Ke=Zo(ve);I.content=Ke,I.size=I.content.length})()}J.data=la(G)}W[3][0].data=la(ae)}C[4][0].data=la(W)}b.messages[0].data=la(C);var H=Jo(p),F=Zo(H);return f.content=F,f.size=f.content.length,h}function gT(e){return function(a){for(var r=0;r!=e.length;++r){var s=e[r];a[s[0]]===void 0&&(a[s[0]]=s[1]),s[2]==="n"&&(a[s[0]]=Number(a[s[0]]))}}}function Wg(e){gT([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Xg(e){gT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function kH(e){return jt.WS.indexOf(e)>-1?"sheet":e==jt.CS?"chart":e==jt.DS?"dialog":e==jt.MS?"macro":e&&e.length?e:"sheet"}function TH(e,n){if(!e)return 0;try{e=n.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,kH(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function CH(e,n,a,r,s,l,o,d,u,h,m,f){try{l[r]=Bd(dr(e,a,!0),n);var p=Ln(e,n),b;switch(d){case"sheet":b=WB(p,n,s,u,l[r],h,m,f);break;case"chart":if(b=XB(p,n,s,u,l[r],h,m,f),!b||!b["!drawel"])break;var g=Ad(b["!drawel"].Target,n),y=tu(g),N=OI(dr(e,g,!0),Bd(dr(e,y,!0),g)),C=Ad(N,g),T=tu(C);b=jB(dr(e,C,!0),C,u,Bd(dr(e,T,!0),C),h,b);break;case"macro":b=QB(p,n,s,u,l[r],h,m,f);break;case"dialog":b=YB(p,n,s,u,l[r],h,m,f);break;default:throw new Error("Unrecognized sheet type "+d)}o[r]=b;var S=[];l&&l[r]&&jn(l[r]).forEach(function(k){var _="";if(l[r][k].Type==jt.CMNT){_=Ad(l[r][k].Target,n);var P=t9(Ln(e,_,!0),_,u);if(!P||!P.length)return;GN(b,P,!1)}l[r][k].Type==jt.TCMNT&&(_=Ad(l[r][k].Target,n),S=S.concat(MI(Ln(e,_,!0),u)))}),S&&S.length&&GN(b,S,!0,u.people||[])}catch(k){if(u.WTF)throw k}}function br(e){return e.charAt(0)=="/"?e.slice(1):e}function yT(e,n){if(Lc(),n=n||{},Wg(n),kr(e,"META-INF/manifest.xml")||kr(e,"objectdata.xml"))return a2(e,n);if(kr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ff<"u"){if(e.FileIndex)return Ff(e);var a=nt.utils.cfb_new();return xN(e).forEach(function(ee){gt(a,ee,RA(e,ee))}),Ff(a)}throw new Error("Unsupported NUMBERS file")}if(!kr(e,"[Content_Types].xml"))throw kr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):kr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=xN(e),s=F8(dr(e,"[Content_Types].xml")),l=!1,o,d;if(s.workbooks.length===0&&(d="xl/workbook.xml",Ln(e,d,!0)&&s.workbooks.push(d)),s.workbooks.length===0){if(d="xl/workbook.bin",!Ln(e,d,!0))throw new Error("Could not find workbook");s.workbooks.push(d),l=!0}s.workbooks[0].slice(-3)=="bin"&&(l=!0);var u={},h={};if(!n.bookSheets&&!n.bookProps){if(Hd=[],s.sst)try{Hd=e9(Ln(e,br(s.sst)),s.sst,n)}catch(ee){if(n.WTF)throw ee}n.cellStyles&&s.themes.length&&(u=ZB(dr(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],n)),s.style&&(h=JB(Ln(e,br(s.style)),s.style,u,n))}s.links.map(function(ee){try{var z=Bd(dr(e,tu(br(ee))),ee);return a9(Ln(e,br(ee)),z,ee,n)}catch{}});var m=qB(Ln(e,br(s.workbooks[0])),s.workbooks[0],n),f={},p="";s.coreprops.length&&(p=Ln(e,br(s.coreprops[0]),!0),p&&(f=ik(p)),s.extprops.length!==0&&(p=Ln(e,br(s.extprops[0]),!0),p&&R8(p,f,n)));var b={};(!n.bookSheets||n.bookProps)&&s.custprops.length!==0&&(p=dr(e,br(s.custprops[0]),!0),p&&(b=H8(p,n)));var g={};if((n.bookSheets||n.bookProps)&&(m.Sheets?o=m.Sheets.map(function(z){return z.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),n.bookProps&&(g.Props=f,g.Custprops=b),n.bookSheets&&typeof o<"u"&&(g.SheetNames=o),n.bookSheets?g.SheetNames:n.bookProps))return g;o={};var y={};n.bookDeps&&s.calcchain&&(y=n9(Ln(e,br(s.calcchain)),s.calcchain));var N=0,C={},T,S;{var k=m.Sheets;f.Worksheets=k.length,f.SheetNames=[];for(var _=0;_!=k.length;++_)f.SheetNames[_]=k[_].name}var P=l?"bin":"xml",j=s.workbooks[0].lastIndexOf("/"),A=(s.workbooks[0].slice(0,j+1)+"_rels/"+s.workbooks[0].slice(j+1)+".rels").replace(/^\//,"");kr(e,A)||(A="xl/_rels/workbook."+P+".rels");var L=Bd(dr(e,A,!0),A.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(n.xlmeta=r9(Ln(e,br(s.metadata[0])),s.metadata[0],n)),(s.people||[]).length>=1&&(n.people=BI(Ln(e,br(s.people[0])),n)),L&&(L=TH(L,m.Sheets));var W=Ln(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(N=0;N!=f.Worksheets;++N){var R="sheet";if(L&&L[N]?(T="xl/"+L[N][1].replace(/[\/]?xl\//,""),kr(e,T)||(T=L[N][1]),kr(e,T)||(T=A.replace(/_rels\/.*$/,"")+L[N][1]),R=L[N][2]):(T="xl/worksheets/sheet"+(N+1-W)+"."+P,T=T.replace(/sheet0\./,"sheet.")),S=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(N!=n.sheets)continue e;break;case"string":if(f.SheetNames[N].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var M=!1,q=0;q!=n.sheets.length;++q)typeof n.sheets[q]=="number"&&n.sheets[q]==N&&(M=1),typeof n.sheets[q]=="string"&&n.sheets[q].toLowerCase()==f.SheetNames[N].toLowerCase()&&(M=1);if(!M)continue e}}CH(e,T,S,f.SheetNames[N],N,C,o,R,n,m,u,h)}return g={Directory:s,Workbook:m,Props:f,Custprops:b,Deps:y,Sheets:o,SheetNames:f.SheetNames,Strings:Hd,Styles:h,Themes:u,SSF:dn(ct)},n&&n.bookFiles&&(e.files?(g.keys=r,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(ee,z){ee=ee.replace(/^Root Entry[\/]/,""),g.keys.push(ee),g.files[ee]=e.FileIndex[z]}))),n&&n.bookVBA&&(s.vba.length>0?g.vbaraw=Ln(e,br(s.vba[0]),!0):s.defaults&&s.defaults.bin===qI&&(g.vbaraw=Ln(e,"xl/vbaProject.bin",!0))),g}function SH(e,n){var a=n||{},r="Workbook",s=nt.find(e,r);try{if(r="/!DataSpaces/Version",s=nt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(rO(s.content),r="/!DataSpaces/DataSpaceMap",s=nt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=iO(s.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=nt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=lO(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=nt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);cO(s.content)}catch{}if(r="/EncryptionInfo",s=nt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var d=dO(s.content);if(r="/EncryptedPackage",s=nt.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(d[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(d[1],s.content,a.password||"",a);if(d[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(d[1],s.content,a.password||"",a);throw new Error("File is password-protected")}function _H(e,n){return n.bookType=="ods"?pT(e,n):n.bookType=="numbers"?wH(e,n):n.bookType=="xlsb"?EH(e,n):DH(e,n)}function EH(e,n){ac=1024,e&&!e.SSF&&(e.SSF=dn(ct)),e&&e.SSF&&(Lc(),tx(e.SSF),n.revssf=ax(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Vd?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var a=n.bookType=="xlsb"?"bin":"xml",r=$k.indexOf(n.bookType)>-1,s=Pg();Xg(n=n||{});var l=vg(),o="",d=0;if(n.cellXfs=[],hl(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",gt(l,o,lk(e.Props,n)),s.coreprops.push(o),zt(n.rels,2,o,jt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&u.push(e.SheetNames[h]);e.Props.SheetNames=u}for(e.Props.Worksheets=e.Props.SheetNames.length,gt(l,o,dk(e.Props)),s.extprops.push(o),zt(n.rels,3,o,jt.EXT_PROPS),e.Custprops!==e.Props&&jn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",gt(l,o,uk(e.Custprops)),s.custprops.push(o),zt(n.rels,4,o,jt.CUST_PROPS)),d=1;d<=e.SheetNames.length;++d){var m={"!id":{}},f=e.Sheets[e.SheetNames[d-1]],p=(f||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+d+"."+a,gt(l,o,i9(d-1,o,n,e,m)),s.sheets.push(o),zt(n.wbrels,-1,"worksheets/sheet"+d+"."+a,jt.WS[0])}if(f){var b=f["!comments"],g=!1,y="";b&&b.length>0&&(y="xl/comments"+d+"."+a,gt(l,y,c9(b,y)),s.comments.push(y),zt(m,-1,"../comments"+d+"."+a,jt.CMNT),g=!0),f["!legacy"]&&g&&gt(l,"xl/drawings/vmlDrawing"+d+".vml",Kk(d,f["!comments"])),delete f["!comments"],delete f["!legacy"]}m["!id"].rId1&&gt(l,tu(o),sc(m))}return n.Strings!=null&&n.Strings.length>0&&(o="xl/sharedStrings."+a,gt(l,o,o9(n.Strings,o,n)),s.strs.push(o),zt(n.wbrels,-1,"sharedStrings."+a,jt.SST)),o="xl/workbook."+a,gt(l,o,s9(e,o)),s.workbooks.push(o),zt(n.rels,1,o,jt.WB),o="xl/theme/theme1.xml",gt(l,o,Bg(e.Themes,n)),s.themes.push(o),zt(n.wbrels,-1,"theme/theme1.xml",jt.THEME),o="xl/styles."+a,gt(l,o,l9(e,o,n)),s.styles.push(o),zt(n.wbrels,-1,"styles."+a,jt.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",gt(l,o,e.vbaraw),s.vba.push(o),zt(n.wbrels,-1,"vbaProject.bin",jt.VBA)),o="xl/metadata."+a,gt(l,o,d9(o)),s.metadata.push(o),zt(n.wbrels,-1,"metadata."+a,jt.XLMETA),gt(l,"[Content_Types].xml",rk(s,n)),gt(l,"_rels/.rels",sc(n.rels)),gt(l,"xl/_rels/workbook."+a+".rels",sc(n.wbrels)),delete n.revssf,delete n.ssf,l}function DH(e,n){ac=1024,e&&!e.SSF&&(e.SSF=dn(ct)),e&&e.SSF&&(Lc(),tx(e.SSF),n.revssf=ax(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Vd?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var a="xml",r=$k.indexOf(n.bookType)>-1,s=Pg();Xg(n=n||{});var l=vg(),o="",d=0;if(n.cellXfs=[],hl(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",gt(l,o,lk(e.Props,n)),s.coreprops.push(o),zt(n.rels,2,o,jt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&u.push(e.SheetNames[h]);e.Props.SheetNames=u}e.Props.Worksheets=e.Props.SheetNames.length,gt(l,o,dk(e.Props)),s.extprops.push(o),zt(n.rels,3,o,jt.EXT_PROPS),e.Custprops!==e.Props&&jn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",gt(l,o,uk(e.Custprops)),s.custprops.push(o),zt(n.rels,4,o,jt.CUST_PROPS));var m=["SheetJ5"];for(n.tcid=0,d=1;d<=e.SheetNames.length;++d){var f={"!id":{}},p=e.Sheets[e.SheetNames[d-1]],b=(p||{})["!type"]||"sheet";switch(b){case"chart":default:o="xl/worksheets/sheet"+d+"."+a,gt(l,o,nT(d-1,n,e,f)),s.sheets.push(o),zt(n.wbrels,-1,"worksheets/sheet"+d+"."+a,jt.WS[0])}if(p){var g=p["!comments"],y=!1,N="";if(g&&g.length>0){var C=!1;g.forEach(function(T){T[1].forEach(function(S){S.T==!0&&(C=!0)})}),C&&(N="xl/threadedComments/threadedComment"+d+"."+a,gt(l,N,RI(g,m,n)),s.threadedcomments.push(N),zt(f,-1,"../threadedComments/threadedComment"+d+"."+a,jt.TCMNT)),N="xl/comments"+d+"."+a,gt(l,N,zk(g)),s.comments.push(N),zt(f,-1,"../comments"+d+"."+a,jt.CMNT),y=!0}p["!legacy"]&&y&&gt(l,"xl/drawings/vmlDrawing"+d+".vml",Kk(d,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&gt(l,tu(o),sc(f))}return n.Strings!=null&&n.Strings.length>0&&(o="xl/sharedStrings."+a,gt(l,o,Fk(n.Strings,n)),s.strs.push(o),zt(n.wbrels,-1,"sharedStrings."+a,jt.SST)),o="xl/workbook."+a,gt(l,o,lT(e)),s.workbooks.push(o),zt(n.rels,1,o,jt.WB),o="xl/theme/theme1.xml",gt(l,o,Bg(e.Themes,n)),s.themes.push(o),zt(n.wbrels,-1,"theme/theme1.xml",jt.THEME),o="xl/styles."+a,gt(l,o,Bk(e,n)),s.styles.push(o),zt(n.wbrels,-1,"styles."+a,jt.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",gt(l,o,e.vbaraw),s.vba.push(o),zt(n.wbrels,-1,"vbaProject.bin",jt.VBA)),o="xl/metadata."+a,gt(l,o,Uk()),s.metadata.push(o),zt(n.wbrels,-1,"metadata."+a,jt.XLMETA),m.length>1&&(o="xl/persons/person.xml",gt(l,o,HI(m)),s.people.push(o),zt(n.wbrels,-1,"persons/person.xml",jt.PEOPLE)),gt(l,"[Content_Types].xml",rk(s,n)),gt(l,"_rels/.rels",sc(n.rels)),gt(l,"xl/_rels/workbook."+a+".rels",sc(n.wbrels)),delete n.revssf,delete n.ssf,l}function Qg(e,n){var a="";switch((n||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":a=hr(e.slice(0,12));break;case"binary":a=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3),a.charCodeAt(4),a.charCodeAt(5),a.charCodeAt(6),a.charCodeAt(7)]}function FH(e,n){return nt.find(e,"EncryptedPackage")?SH(e,n):Gg(e,n)}function AH(e,n){var a,r=e,s=n||{};return s.type||(s.type=bt&&Buffer.isBuffer(e)?"buffer":"base64"),a=Pw(r,s),yT(a,s)}function vT(e,n){var a=0;e:for(;a<e.length;)switch(e.charCodeAt(a)){case 10:case 13:case 32:++a;break;case 60:return Ep(e.slice(a),n);default:break e}return Cc.to_workbook(e,n)}function PH(e,n){var a="",r=Qg(e,n);switch(n.type){case"base64":a=hr(e);break;case"binary":a=e;break;case"buffer":a=e.toString("binary");break;case"array":a=so(e);break;default:throw new Error("Unrecognized type "+n.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(a=Xt(a)),n.type="binary",vT(a,n)}function LH(e,n){var a=e;return n.type=="base64"&&(a=hr(a)),a=Xd.utils.decode(1200,a.slice(2),"str"),n.type="binary",vT(a,n)}function OH(e){return e.match(/[^\x00-\x7F]/)?Ns(e):e}function Af(e,n,a,r){return r?(a.type="string",Cc.to_workbook(e,a)):Cc.to_workbook(n,a)}function Ap(e,n){mg();var a=n||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Ap(new Uint8Array(e),(a=dn(a),a.type="array",a));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!a.type&&(a.type=typeof Deno<"u"?"buffer":"array");var r=e,s=[0,0,0,0],l=!1;if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),lc={},a.dateNF&&(lc.dateNF=a.dateNF),a.type||(a.type=bt&&Buffer.isBuffer(e)?"buffer":"base64"),a.type=="file"&&(a.type=bt?"buffer":"binary",r=DA(e),typeof Uint8Array<"u"&&!bt&&(a.type="array")),a.type=="string"&&(l=!0,a.type="binary",a.codepage=65001,r=OH(e)),a.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),d=new Uint8Array(o);if(d.foo="bar",!d.foo)return a=dn(a),a.type="array",Ap(fg(r),a)}switch((s=Qg(r,a))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return FH(nt.read(r,a),a);break;case 9:if(s[1]<=8)return Gg(r,a);break;case 60:return Ep(r,a);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return VL(r,a);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return Ek.to_workbook(r,a);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?AH(r,a):Af(e,r,a,l);case 239:return s[3]===60?Ep(r,a):Af(e,r,a,l);case 255:if(s[1]===254)return LH(r,a);if(s[1]===0&&s[2]===2&&s[3]===0)return Jl.to_workbook(r,a);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Jl.to_workbook(r,a);break;case 3:case 131:case 139:case 140:return _p.to_workbook(r,a);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return Ik.to_workbook(r,a);break;case 10:case 13:case 32:return PH(r,a);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return HL.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?_p.to_workbook(r,a):Af(e,r,a,l)}function bT(e,n){switch(n.type){case"base64":case"binary":break;case"buffer":case"array":n.type="";break;case"file":return Nu(n.file,nt.write(e,{type:bt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");default:throw new Error("Unrecognized type "+n.type)}return nt.write(e,n)}function IH(e,n){var a=dn(n||{}),r=_H(e,a);return MH(r,a)}function MH(e,n){var a={},r=bt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(n.compression&&(a.compression="DEFLATE"),n.password)a.type=r;else switch(n.type){case"base64":a.type="base64";break;case"binary":a.type="string";break;case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");case"buffer":case"file":a.type=r;break;default:throw new Error("Unrecognized type "+n.type)}var s=e.FullPaths?nt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[a.type]||a.type,compression:!!n.compression}):e.generate(a);if(typeof Deno<"u"&&typeof s=="string"){if(n.type=="binary"||n.type=="base64")return s;s=new Uint8Array(ex(s))}return n.password&&typeof encrypt_agile<"u"?bT(encrypt_agile(s,n.password),n):n.type==="file"?Nu(n.file,s):n.type=="string"?Xt(s):s}function RH(e,n){var a=n||{},r=I9(e,a);return bT(r,a)}function xs(e,n,a){a||(a="");var r=a+e;switch(n.type){case"base64":return Qd(Ns(r));case"binary":return Ns(r);case"string":return e;case"file":return Nu(n.file,r,"utf8");case"buffer":return bt?oi(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):xs(r,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function BH(e,n){switch(n.type){case"base64":return Qd(e);case"binary":return e;case"string":return e;case"file":return Nu(n.file,e,"binary");case"buffer":return bt?oi(e,"binary"):e.split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function n0(e,n){switch(n.type){case"string":case"base64":case"binary":for(var a="",r=0;r<e.length;++r)a+=String.fromCharCode(e[r]);return n.type=="base64"?Qd(a):n.type=="string"?Xt(a):a;case"file":return Nu(n.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+n.type)}}function Yg(e,n){mg(),AB(e);var a=dn(n||{});if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),a.type=="array"){a.type="binary";var r=Yg(e,a);return a.type="array",ex(r)}var s=0;if(a.sheet&&(typeof a.sheet=="number"?s=a.sheet:s=e.SheetNames.indexOf(a.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+a.sheet+" : "+typeof a.sheet);switch(a.bookType||"xlsb"){case"xml":case"xlml":return xs(E9(e,a),a);case"slk":case"sylk":return xs(_k.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"htm":case"html":return xs(hT(e.Sheets[e.SheetNames[s]],a),a);case"txt":return BH(NT(e.Sheets[e.SheetNames[s]],a),a);case"csv":return xs(Jg(e.Sheets[e.SheetNames[s]],a),a,"\uFEFF");case"dif":return xs(Ek.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"dbf":return n0(_p.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"prn":return xs(Cc.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"rtf":return xs(Ik.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"eth":return xs(Dk.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"fods":return xs(pT(e,a),a);case"wk1":return n0(Jl.sheet_to_wk1(e.Sheets[e.SheetNames[s]],a),a);case"wk3":return n0(Jl.book_to_wk3(e,a),a);case"biff2":a.biff||(a.biff=2);case"biff3":a.biff||(a.biff=3);case"biff4":return a.biff||(a.biff=4),n0(uT(e,a),a);case"biff5":a.biff||(a.biff=5);case"biff8":case"xla":case"xls":return a.biff||(a.biff=8),RH(e,a);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return IH(e,a);default:throw new Error("Unrecognized bookType |"+a.bookType+"|")}}function HH(e){if(!e.bookType){var n={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},a=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();a.match(/^\.[a-z]+$/)&&(e.bookType=a.slice(1)),e.bookType=n[e.bookType]||e.bookType}}function O0(e,n,a){var r={};return r.type="file",r.file=n,HH(r),Yg(e,r)}function VH(e,n,a,r,s,l,o,d){var u=Dn(a),h=d.defval,m=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),f=!0,p=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:a,enumerable:!1})}catch{p.__rowNum__=a}else p.__rowNum__=a;if(!o||e[a])for(var b=n.s.c;b<=n.e.c;++b){var g=o?e[a][b]:e[r[b]+u];if(g===void 0||g.t===void 0){if(h===void 0)continue;l[b]!=null&&(p[l[b]]=h);continue}var y=g.v;switch(g.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(l[b]!=null){if(y==null)if(g.t=="e"&&y===null)p[l[b]]=null;else if(h!==void 0)p[l[b]]=h;else if(m&&y===null)p[l[b]]=null;else continue;else p[l[b]]=m&&(g.t!=="n"||g.t==="n"&&d.rawNumbers!==!1)?y:li(g,y,d);y!=null&&(f=!1)}}return{row:p,isempty:f}}function I0(e,n){if(e==null||e["!ref"]==null)return[];var a={t:"n",v:0},r=0,s=1,l=[],o=0,d="",u={s:{r:0,c:0},e:{r:0,c:0}},h=n||{},m=h.range!=null?h.range:e["!ref"];switch(h.header===1?r=1:h.header==="A"?r=2:Array.isArray(h.header)?r=3:h.header==null&&(r=0),typeof m){case"string":u=Dt(m);break;case"number":u=Dt(e["!ref"]),u.s.r=m;break;default:u=m}r>0&&(s=0);var f=Dn(u.s.r),p=[],b=[],g=0,y=0,N=Array.isArray(e),C=u.s.r,T=0,S={};N&&!e[C]&&(e[C]=[]);var k=h.skipHidden&&e["!cols"]||[],_=h.skipHidden&&e["!rows"]||[];for(T=u.s.c;T<=u.e.c;++T)if(!(k[T]||{}).hidden)switch(p[T]=pn(T),a=N?e[C][T]:e[p[T]+f],r){case 1:l[T]=T-u.s.c;break;case 2:l[T]=p[T];break;case 3:l[T]=h.header[T-u.s.c];break;default:if(a==null&&(a={w:"__EMPTY",t:"s"}),d=o=li(a,null,h),y=S[o]||0,!y)S[o]=1;else{do d=o+"_"+y++;while(S[d]);S[o]=y,S[d]=1}l[T]=d}for(C=u.s.r+s;C<=u.e.r;++C)if(!(_[C]||{}).hidden){var P=VH(e,u,C,p,r,l,N,h);(P.isempty===!1||(r===1?h.blankrows!==!1:h.blankrows))&&(b[g++]=P.row)}return b.length=g,b}var o2=/"/g;function UH(e,n,a,r,s,l,o,d){for(var u=!0,h=[],m="",f=Dn(a),p=n.s.c;p<=n.e.c;++p)if(r[p]){var b=d.dense?(e[a]||[])[p]:e[r[p]+f];if(b==null)m="";else if(b.v!=null){u=!1,m=""+(d.rawNumbers&&b.t=="n"?b.v:li(b,null,d));for(var g=0,y=0;g!==m.length;++g)if((y=m.charCodeAt(g))===s||y===l||y===34||d.forceQuotes){m='"'+m.replace(o2,'""')+'"';break}m=="ID"&&(m='"ID"')}else b.f!=null&&!b.F?(u=!1,m="="+b.f,m.indexOf(",")>=0&&(m='"'+m.replace(o2,'""')+'"')):m="";h.push(m)}return d.blankrows===!1&&u?null:h.join(o)}function Jg(e,n){var a=[],r=n??{};if(e==null||e["!ref"]==null)return"";var s=Dt(e["!ref"]),l=r.FS!==void 0?r.FS:",",o=l.charCodeAt(0),d=r.RS!==void 0?r.RS:`
`,u=d.charCodeAt(0),h=new RegExp((l=="|"?"\\|":l)+"+$"),m="",f=[];r.dense=Array.isArray(e);for(var p=r.skipHidden&&e["!cols"]||[],b=r.skipHidden&&e["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(p[g]||{}).hidden||(f[g]=pn(g));for(var y=0,N=s.s.r;N<=s.e.r;++N)(b[N]||{}).hidden||(m=UH(e,s,N,f,o,u,l,r),m!=null&&(r.strip&&(m=m.replace(h,"")),(m||r.blankrows!==!1)&&a.push((y++?d:"")+m)));return delete r.dense,a.join("")}function NT(e,n){n||(n={}),n.FS="	",n.RS=`
`;var a=Jg(e,n);return a}function KH(e){var n="",a,r="";if(e==null||e["!ref"]==null)return[];var s=Dt(e["!ref"]),l="",o=[],d,u=[],h=Array.isArray(e);for(d=s.s.c;d<=s.e.c;++d)o[d]=pn(d);for(var m=s.s.r;m<=s.e.r;++m)for(l=Dn(m),d=s.s.c;d<=s.e.c;++d)if(n=o[d]+l,a=h?(e[m]||[])[d]:e[n],r="",a!==void 0){if(a.F!=null){if(n=a.F,!a.f)continue;r=a.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(a.f!=null)r=a.f;else{if(a.t=="z")continue;if(a.t=="n"&&a.v!=null)r=""+a.v;else if(a.t=="b")r=a.v?"TRUE":"FALSE";else if(a.w!==void 0)r="'"+a.w;else{if(a.v===void 0)continue;a.t=="s"?r="'"+a.v:r=""+a.v}}u[u.length]=n+"="+r}return u}function jT(e,n,a){var r=a||{},s=+!r.skipHeader,l=e||{},o=0,d=0;if(l&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var u=typeof r.origin=="string"?gn(r.origin):r.origin;o=u.r,d=u.c}var h,m={s:{c:0,r:0},e:{c:d,r:o+n.length-1+s}};if(l["!ref"]){var f=Dt(l["!ref"]);m.e.c=Math.max(m.e.c,f.e.c),m.e.r=Math.max(m.e.r,f.e.r),o==-1&&(o=f.e.r+1,m.e.r=o+n.length-1+s)}else o==-1&&(o=0,m.e.r=n.length-1+s);var p=r.header||[],b=0;n.forEach(function(y,N){jn(y).forEach(function(C){(b=p.indexOf(C))==-1&&(p[b=p.length]=C);var T=y[C],S="z",k="",_=dt({c:d+b,r:o+N+s});h=ou(l,_),T&&typeof T=="object"&&!(T instanceof Date)?l[_]=T:(typeof T=="number"?S="n":typeof T=="boolean"?S="b":typeof T=="string"?S="s":T instanceof Date?(S="d",r.cellDates||(S="n",T=zn(T)),k=r.dateNF||ct[14]):T===null&&r.nullError&&(S="e",T=0),h?(h.t=S,h.v=T,delete h.w,delete h.R,k&&(h.z=k)):l[_]=h={t:S,v:T},k&&(h.z=k))})}),m.e.c=Math.max(m.e.c,d+p.length-1);var g=Dn(o);if(s)for(b=0;b<p.length;++b)l[pn(b+d)+g]={t:"s",v:p[b]};return l["!ref"]=pt(m),l}function zH(e,n){return jT(null,e,n)}function ou(e,n,a){if(typeof n=="string"){if(Array.isArray(e)){var r=gn(n);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[n]||(e[n]={t:"z"})}return typeof n!="number"?ou(e,dt(n)):ou(e,dt({r:n,c:a||0}))}function $H(e,n){if(typeof n=="number"){if(n>=0&&e.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var a=e.SheetNames.indexOf(n);if(a>-1)return a;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function Zg(){return{SheetNames:[],Sheets:{}}}function ey(e,n,a,r){var s=1;if(!a)for(;s<=65535&&e.SheetNames.indexOf(a="Sheet"+s)!=-1;++s,a=void 0);if(!a||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(a)>=0){var l=a.match(/(^.*?)(\d+)$/);s=l&&+l[2]||0;var o=l&&l[1]||a;for(++s;s<=65535&&e.SheetNames.indexOf(a=o+s)!=-1;++s);}if(iT(a),e.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");return e.SheetNames.push(a),e.Sheets[a]=n,a}function GH(e,n,a){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=$H(e,n);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}e.Workbook.Sheets[r].Hidden=a}function qH(e,n){return e.z=n,e}function wT(e,n,a){return n?(e.l={Target:n},a&&(e.l.Tooltip=a)):delete e.l,e}function WH(e,n,a){return wT(e,"#"+n,a)}function XH(e,n,a){e.c||(e.c=[]),e.c.push({t:n,a:a||"SheetJS"})}function QH(e,n,a,r){for(var s=typeof n!="string"?n:Dt(n),l=typeof n=="string"?n:pt(n),o=s.s.r;o<=s.e.r;++o)for(var d=s.s.c;d<=s.e.c;++d){var u=ou(e,o,d);u.t="n",u.F=l,delete u.v,o==s.s.r&&d==s.s.c&&(u.f=a,r&&(u.D=!0))}return e}var Qr={encode_col:pn,encode_row:Dn,encode_cell:dt,encode_range:pt,decode_col:Sg,decode_row:Cg,split_cell:o8,decode_cell:gn,decode_range:er,format_cell:li,sheet_add_aoa:Yw,sheet_add_json:jT,sheet_add_dom:xT,aoa_to_sheet:Oc,json_to_sheet:zH,table_to_sheet:mT,table_to_book:rH,sheet_to_csv:Jg,sheet_to_txt:NT,sheet_to_json:I0,sheet_to_html:hT,sheet_to_formulae:KH,sheet_to_row_object_array:I0,sheet_get_cell:ou,book_new:Zg,book_append_sheet:ey,book_set_sheet_visibility:GH,cell_set_number_format:qH,cell_set_hyperlink:wT,cell_set_internal_link:WH,cell_add_comment:XH,sheet_set_array_formula:QH,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const kT=Object.freeze(Object.defineProperty({__proto__:null,CFB:nt,parse_xlscfb:Gg,parse_zip:yT,read:Ap,utils:Qr,write:Yg,writeFile:O0,writeFileSync:O0},Symbol.toStringTag,{value:"Module"})),YH="modulepreload",JH=function(e){return"/"+e},c2={},TT=function(n,a,r){let s=Promise.resolve();if(a&&a.length>0){let o=function(h){return Promise.all(h.map(m=>Promise.resolve(m).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),u=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));s=o(a.map(h=>{if(h=JH(h),h in c2)return;c2[h]=!0;const m=h.endsWith(".css"),f=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${f}`))return;const p=document.createElement("link");if(p.rel=m?"stylesheet":YH,m||(p.as="script"),p.crossOrigin="",p.href=h,u&&p.setAttribute("nonce",u),document.head.appendChild(p),m)return new Promise((b,g)=>{p.addEventListener("load",b),p.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${h}`)))})}))}function l(o){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=o,window.dispatchEvent(d),!d.defaultPrevented)throw o}return s.then(o=>{for(const d of o||[])d.status==="rejected"&&l(d.reason);return n().catch(l)})},ZH=async(e,n,a)=>(await me.post("/san-luong/chia-hang/preview",{rows:e,thang:n,nam:a})).data,eV=async(e,n,a)=>(await me.post("/san-luong/chia-hang/confirm",{rows:e,tenFile:n,fileHash:a})).data,tV=async(e,n,a)=>(await me.post("/san-luong/giao-hang/preview",{rows:e,thang:n,nam:a})).data,nV=async(e,n,a)=>(await me.post("/san-luong/giao-hang/confirm",{rows:e,tenFile:n,fileHash:a})).data,aV=async e=>{const n=await me.get("/san-luong/lich-su-import",{params:{loaiImport:e.loaiImport,tuNgay:e.tuNgay,denNgay:e.denNgay}}),a=Array.isArray(n.data)?n.data:[];let r=a;e.trangThai&&(r=a.filter(u=>u.trangThai===e.trangThai));const s=e.page||1,l=e.limit||20,o=(s-1)*l,d=o+l;return{items:r.slice(o,d),total:r.length}},rV=async e=>{const{read:n,utils:a}=await TT(async()=>{const{read:d,utils:u}=await Promise.resolve().then(()=>kT);return{read:d,utils:u}},void 0),r=await e.arrayBuffer(),s=n(r,{type:"array"}),l=s.Sheets[s.SheetNames[0]];return a.sheet_to_json(l).map(d=>({maNhanVien:String(d["M NV"]||d.MaNhanVien||d.maNhanVien||""),ngay:CT(d.Ngy||d.ngay),sanPhamDat:Number(d["SP t"]||d.sanPhamDat||0),sanPhamLoi:Number(d["SP Li"]||d.sanPhamLoi||0),tongSanPham:Number(d["Tng SP"]||d.tongSanPham||0)}))},sV=async e=>{const{read:n,utils:a}=await TT(async()=>{const{read:d,utils:u}=await Promise.resolve().then(()=>kT);return{read:d,utils:u}},void 0),r=await e.arrayBuffer(),s=n(r,{type:"array"}),l=s.Sheets[s.SheetNames[0]];return a.sheet_to_json(l).map(d=>({maNhanVien:String(d["M NV"]||d.MaNhanVien||d.maNhanVien||""),ngay:CT(d.Ngy||d.ngay),khoiLuong:Number(d["Khi lng"]||d.khoiLuong||0),donGia:Number(d["n gi"]||d.donGia||0),phatTre:Number(d["Pht tr"]||d.phatTre||0),phatKhongLayPhieu:Number(d["Pht KL phiu"]||d.phatKhongLayPhieu||0)}))};function CT(e){if(!e)return"";if(typeof e=="number")return new Date((e-25569)*86400*1e3).toISOString().split("T")[0];if(typeof e=="string"){const n=e.split("/");if(n.length===3){const[a,r,s]=n;return`${s}-${r.padStart(2,"0")}-${a.padStart(2,"0")}`}if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e}return String(e)}const ST=async e=>{const n=await e.arrayBuffer(),a=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(a)).map(s=>s.toString(16).padStart(2,"0")).join("")},iV=()=>{const[e,n]=E.useState(null),[a,r]=E.useState([]),[s,l]=E.useState(null),[o,d]=E.useState(!1),[u,h]=E.useState(!1),[m,f]=E.useState(new Date().getMonth()+1),[p,b]=E.useState(new Date().getFullYear()),g=()=>{const P=[{"M NV":"NV001",Ngy:"01/01/2026","SP t":100,"SP Li":2,"Tng SP":102},{"M NV":"NV001",Ngy:"02/01/2026","SP t":95,"SP Li":1,"Tng SP":96},{"M NV":"NV002",Ngy:"01/01/2026","SP t":120,"SP Li":3,"Tng SP":123},{"M NV":"NV002",Ngy:"02/01/2026","SP t":110,"SP Li":0,"Tng SP":110}],j=Qr.json_to_sheet(P);j["!cols"]=[{wch:10},{wch:12},{wch:10},{wch:10},{wch:10}];const A=Qr.book_new();Qr.book_append_sheet(A,j,"Chia Hng");const L=[{Ct:"M NV","M t":"M nhn vin (bt buc)","V d":"NV001"},{Ct:"Ngy","M t":"Ngy lm vic (dd/MM/yyyy)","V d":"01/01/2026"},{Ct:"SP t","M t":"S sn phm t chun","V d":"100"},{Ct:"SP Li","M t":"S sn phm li","V d":"2"},{Ct:"Tng SP","M t":"Tng sn phm","V d":"102"},{Ct:"","M t":"","V d":""},{Ct:"Cng thc","M t":"Quy i SP = SP t - (SP Li  5)","V d":""},{Ct:"","M t":"Tin sn lng = Quy i SP  320","V d":""}],W=Qr.json_to_sheet(L);W["!cols"]=[{wch:12},{wch:40},{wch:15}],Qr.book_append_sheet(A,W,"Hng dn"),O0(A,`Template_ChiaHang_${m}_${p}.xlsx`),vt.success(" ti template mu")},y=E.useCallback(async P=>{const j=P[0];if(j){n(j),d(!0),l(null);try{const A=await rV(j);r(A),vt.success(` c ${A.length} dng t file`)}catch(A){vt.error("Li c file Excel"),console.error(A)}finally{d(!1)}}},[]),{getRootProps:N,getInputProps:C,isDragActive:T}=ug({onDrop:y,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"]},multiple:!1}),S=async()=>{var P,j;if(a.length===0){vt.error("Cha c d liu  preview");return}d(!0);try{const A=await ZH(a,m,p);l(A),A.tongKhongHopLe>0?vt.error(`C ${A.tongKhongHopLe} dng khng hp l`):vt.success(`${A.tongHopLe} dng hp l, sn sng import`)}catch(A){const L=A;vt.error(((j=(P=L.response)==null?void 0:P.data)==null?void 0:j.message)||"Li preview")}finally{d(!1)}},k=async()=>{var P,j;if(!(!s||!e)){if(s.hopLe.length===0){vt.error("Khng c d liu hp l  import");return}h(!0);try{const A=await ST(e),L=await eV(s.hopLe,e.name,A);vt.success(`Import thnh cng! Thm mi: ${L.inserted}, Cp nht: ${L.updated}`),n(null),r([]),l(null)}catch(A){const L=A;vt.error(((j=(P=L.response)==null?void 0:P.data)==null?void 0:j.message)||"Li import")}finally{h(!1)}}},_=()=>{n(null),r([]),l(null)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Import Sn Lng Chia Hng"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:g,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Ti Template Mu"]}),(e||a.length>0)&&t.jsx("button",{onClick:_,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Reset"})]})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow flex gap-4 items-center",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thng"}),t.jsx("select",{value:m,onChange:P=>f(Number(P.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:12},(P,j)=>t.jsxs("option",{value:j+1,children:["Thng ",j+1]},j+1))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nm"}),t.jsx("select",{value:p,onChange:P=>b(Number(P.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:5},(P,j)=>new Date().getFullYear()-2+j).map(P=>t.jsx("option",{value:P,children:P},P))})]})]}),t.jsxs("div",{...N(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${T?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,children:[t.jsx("input",{...C()}),t.jsxs("div",{className:"text-gray-600",children:[t.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),T?t.jsx("p",{className:"text-blue-600",children:"Th file vo y..."}):t.jsxs(t.Fragment,{children:[t.jsx("p",{children:"Ko th file Excel vo y, hoc click  chn file"}),t.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"H tr: .xlsx, .xls"})]})]})]}),e&&t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsxs("p",{className:"text-blue-800",children:[t.jsx("strong",{children:"File:"})," ",e.name," (",(e.size/1024).toFixed(1)," KB)"]}),t.jsxs("p",{className:"text-blue-600 text-sm mt-1",children:[" c ",a.length," dng d liu"]})]}),a.length>0&&!s&&t.jsx("button",{onClick:S,disabled:o,className:"w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2",children:o?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang x l..."]}):"Preview d liu"}),s&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[t.jsx("p",{className:"text-green-800 font-semibold text-lg",children:s.tongHopLe}),t.jsx("p",{className:"text-green-600 text-sm",children:"Dng hp l"})]}),t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[t.jsx("p",{className:"text-red-800 font-semibold text-lg",children:s.tongKhongHopLe}),t.jsx("p",{className:"text-red-600 text-sm",children:"Dng khng hp l"})]})]}),s.hopLe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-green-50 border-b border-green-200",children:t.jsxs("h3",{className:"font-semibold text-green-800",children:["D liu hp l (",s.hopLe.length,")"]})}),t.jsxs("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:[t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"SP t"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"SP Li"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Tng SP"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:s.hopLe.slice(0,100).map((P,j)=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-2 text-sm",children:P.maNhanVien}),t.jsx("td",{className:"px-4 py-2 text-sm",children:P.ngay}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:P.sanPhamDat}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:P.sanPhamLoi}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:P.tongSanPham})]},j))})]}),s.hopLe.length>100&&t.jsxs("p",{className:"text-center text-gray-500 py-2",children:["... v ",s.hopLe.length-100," dng na"]})]})]}),s.khongHopLe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-red-50 border-b border-red-200",children:t.jsxs("h3",{className:"font-semibold text-red-800",children:["D liu khng hp l (",s.khongHopLe.length,")"]})}),t.jsx("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"L do"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:s.khongHopLe.map((P,j)=>t.jsxs("tr",{className:"bg-red-50",children:[t.jsx("td",{className:"px-4 py-2 text-sm",children:P.row.maNhanVien}),t.jsx("td",{className:"px-4 py-2 text-sm",children:P.row.ngay}),t.jsx("td",{className:"px-4 py-2 text-sm text-red-600",children:P.lyDo})]},j))})]})})]}),s.hopLe.length>0&&t.jsxs("div",{className:"flex gap-4",children:[t.jsx("button",{onClick:S,disabled:o,className:"flex-1 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 disabled:opacity-50",children:"Preview li"}),t.jsx("button",{onClick:k,disabled:u,className:"flex-1 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center justify-center gap-2",children:u?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang import..."]}):`Import ${s.hopLe.length} dng`})]})]}),t.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[t.jsx("h3",{className:"font-semibold text-yellow-800 mb-2",children:"Hng dn"}),t.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1 list-disc list-inside",children:[t.jsx("li",{children:"File Excel cn c cc ct: M NV, Ngy, SP t, SP Li, Tng SP"}),t.jsx("li",{children:"Ngy c th  nh dng dd/MM/yyyy hoc yyyy-MM-dd"}),t.jsx("li",{children:"Nu d liu  tn ti (cng m NV + ngy) s c cp nht"}),t.jsxs("li",{children:["Cng thc: ",t.jsx("strong",{children:"Quy i SP = SP t - (SP Li  5)"}),", ",t.jsx("strong",{children:"Tin = Quy i  320"})]})]})]})]})},lV=()=>{const[e,n]=E.useState(null),[a,r]=E.useState([]),[s,l]=E.useState(null),[o,d]=E.useState(!1),[u,h]=E.useState(!1),[m,f]=E.useState(new Date().getMonth()+1),[p,b]=E.useState(new Date().getFullYear()),g=()=>{const j=[{"M NV":"NV001",Ngy:"01/01/2026","Khi lng":50,"n gi":5e3,"Pht tr":0,"Pht KL phiu":0},{"M NV":"NV001",Ngy:"02/01/2026","Khi lng":45,"n gi":5e3,"Pht tr":1e4,"Pht KL phiu":0},{"M NV":"NV002",Ngy:"01/01/2026","Khi lng":60,"n gi":5500,"Pht tr":0,"Pht KL phiu":5e3},{"M NV":"NV002",Ngy:"02/01/2026","Khi lng":55,"n gi":5500,"Pht tr":0,"Pht KL phiu":0}],A=Qr.json_to_sheet(j);A["!cols"]=[{wch:10},{wch:12},{wch:12},{wch:12},{wch:12},{wch:15}];const L=Qr.book_new();Qr.book_append_sheet(L,A,"Giao Hng");const W=[{Ct:"M NV","M t":"M nhn vin (bt buc)","V d":"NV001"},{Ct:"Ngy","M t":"Ngy lm vic (dd/MM/yyyy)","V d":"01/01/2026"},{Ct:"Khi lng","M t":"Khi lng giao hng (kg)","V d":"50"},{Ct:"n gi","M t":"n gi theo kg (VN)","V d":"5000"},{Ct:"Pht tr","M t":"Tin pht giao tr (VN)","V d":"10000"},{Ct:"Pht KL phiu","M t":"Pht khng ly phiu (VN)","V d":"5000"},{Ct:"","M t":"","V d":""},{Ct:"Cng thc","M t":"Tin = Khi lng  n gi - Pht tr - Pht KL phiu","V d":""}],R=Qr.json_to_sheet(W);R["!cols"]=[{wch:15},{wch:50},{wch:15}],Qr.book_append_sheet(L,R,"Hng dn"),O0(L,`Template_GiaoHang_${m}_${p}.xlsx`),vt.success(" ti template mu")},y=E.useCallback(async j=>{const A=j[0];if(A){n(A),d(!0),l(null);try{const L=await sV(A);r(L),vt.success(` c ${L.length} dng t file`)}catch(L){vt.error("Li c file Excel"),console.error(L)}finally{d(!1)}}},[]),{getRootProps:N,getInputProps:C,isDragActive:T}=ug({onDrop:y,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"]},multiple:!1}),S=async()=>{var j,A;if(a.length===0){vt.error("Cha c d liu  preview");return}d(!0);try{const L=await tV(a,m,p);l(L),L.tongKhongHopLe>0?vt.error(`C ${L.tongKhongHopLe} dng khng hp l`):vt.success(`${L.tongHopLe} dng hp l, sn sng import`)}catch(L){const W=L;vt.error(((A=(j=W.response)==null?void 0:j.data)==null?void 0:A.message)||"Li preview")}finally{d(!1)}},k=async()=>{var j,A;if(!(!s||!e)){if(s.hopLe.length===0){vt.error("Khng c d liu hp l  import");return}h(!0);try{const L=await ST(e),W=await nV(s.hopLe,e.name,L);vt.success(`Import thnh cng! Thm mi: ${W.inserted}, Cp nht: ${W.updated}`),n(null),r([]),l(null)}catch(L){const W=L;vt.error(((A=(j=W.response)==null?void 0:j.data)==null?void 0:A.message)||"Li import")}finally{h(!1)}}},_=()=>{n(null),r([]),l(null)},P=j=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(j);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Import Sn Lng Giao Hng"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:g,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Ti Template Mu"]}),(e||a.length>0)&&t.jsx("button",{onClick:_,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Reset"})]})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow flex gap-4 items-center",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thng"}),t.jsx("select",{value:m,onChange:j=>f(Number(j.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:12},(j,A)=>t.jsxs("option",{value:A+1,children:["Thng ",A+1]},A+1))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nm"}),t.jsx("select",{value:p,onChange:j=>b(Number(j.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:5},(j,A)=>new Date().getFullYear()-2+A).map(j=>t.jsx("option",{value:j,children:j},j))})]})]}),t.jsxs("div",{...N(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${T?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,children:[t.jsx("input",{...C()}),t.jsxs("div",{className:"text-gray-600",children:[t.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),T?t.jsx("p",{className:"text-blue-600",children:"Th file vo y..."}):t.jsxs(t.Fragment,{children:[t.jsx("p",{children:"Ko th file Excel vo y, hoc click  chn file"}),t.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"H tr: .xlsx, .xls"})]})]})]}),e&&t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsxs("p",{className:"text-blue-800",children:[t.jsx("strong",{children:"File:"})," ",e.name," (",(e.size/1024).toFixed(1)," KB)"]}),t.jsxs("p",{className:"text-blue-600 text-sm mt-1",children:[" c ",a.length," dng d liu"]})]}),a.length>0&&!s&&t.jsx("button",{onClick:S,disabled:o,className:"w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2",children:o?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang x l..."]}):"Preview d liu"}),s&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[t.jsx("p",{className:"text-green-800 font-semibold text-lg",children:s.tongHopLe}),t.jsx("p",{className:"text-green-600 text-sm",children:"Dng hp l"})]}),t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[t.jsx("p",{className:"text-red-800 font-semibold text-lg",children:s.tongKhongHopLe}),t.jsx("p",{className:"text-red-600 text-sm",children:"Dng khng hp l"})]})]}),s.hopLe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-green-50 border-b border-green-200",children:t.jsxs("h3",{className:"font-semibold text-green-800",children:["D liu hp l (",s.hopLe.length,")"]})}),t.jsxs("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:[t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Khi lng"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"n gi"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Pht tr"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Pht KLP"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:s.hopLe.slice(0,100).map((j,A)=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-2 text-sm",children:j.maNhanVien}),t.jsx("td",{className:"px-4 py-2 text-sm",children:j.ngay}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:j.khoiLuong}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:P(j.donGia)}),t.jsx("td",{className:"px-4 py-2 text-sm text-right text-red-600",children:P(j.phatTre)}),t.jsx("td",{className:"px-4 py-2 text-sm text-right text-red-600",children:P(j.phatKhongLayPhieu)})]},A))})]}),s.hopLe.length>100&&t.jsxs("p",{className:"text-center text-gray-500 py-2",children:["... v ",s.hopLe.length-100," dng na"]})]})]}),s.khongHopLe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-red-50 border-b border-red-200",children:t.jsxs("h3",{className:"font-semibold text-red-800",children:["D liu khng hp l (",s.khongHopLe.length,")"]})}),t.jsx("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"L do"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:s.khongHopLe.map((j,A)=>t.jsxs("tr",{className:"bg-red-50",children:[t.jsx("td",{className:"px-4 py-2 text-sm",children:j.row.maNhanVien}),t.jsx("td",{className:"px-4 py-2 text-sm",children:j.row.ngay}),t.jsx("td",{className:"px-4 py-2 text-sm text-red-600",children:j.lyDo})]},A))})]})})]}),s.hopLe.length>0&&t.jsxs("div",{className:"flex gap-4",children:[t.jsx("button",{onClick:S,disabled:o,className:"flex-1 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 disabled:opacity-50",children:"Preview li"}),t.jsx("button",{onClick:k,disabled:u,className:"flex-1 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center justify-center gap-2",children:u?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang import..."]}):`Import ${s.hopLe.length} dng`})]})]}),t.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[t.jsx("h3",{className:"font-semibold text-yellow-800 mb-2",children:"Hng dn"}),t.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1 list-disc list-inside",children:[t.jsx("li",{children:"File Excel cn c cc ct: M NV, Ngy, Khi lng, n gi, Pht tr, Pht KL phiu"}),t.jsx("li",{children:"Ngy c th  nh dng dd/MM/yyyy hoc yyyy-MM-dd"}),t.jsx("li",{children:"Nu d liu  tn ti (cng m NV + ngy) s c cp nht"}),t.jsxs("li",{children:["Cng thc: ",t.jsx("strong",{children:"Tin = Khi lng  n gi - Pht tr - Pht khng ly phiu"})]})]})]})]})},oV=()=>{const[e,n]=E.useState([]),[a,r]=E.useState(0),[s,l]=E.useState(!0),[o,d]=E.useState({loaiImport:void 0,trangThai:void 0,page:1,limit:20});E.useEffect(()=>{u()},[o]);const u=async()=>{var g,y;l(!0);try{const N=await aV(o);n(N.items),r(N.total)}catch(N){const C=N;vt.error(((y=(g=C.response)==null?void 0:g.data)==null?void 0:y.message)||"Li ti d liu")}finally{l(!1)}},h=g=>new Date(g).toLocaleString("vi-VN"),m=g=>{d(y=>({...y,loaiImport:g===""?void 0:g,page:1}))},f=g=>{d(y=>({...y,trangThai:g===""?void 0:g,page:1}))},p=g=>{d(y=>({...y,page:g}))},b=Math.ceil(a/(o.limit||20));return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Lch S Import Sn Lng"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(ca,{to:"/import-chia-hang",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Import Chia Hng"}),t.jsx(ca,{to:"/import-giao-hang",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Import Giao Hng"})]})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow flex gap-4 items-center flex-wrap",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi"}),t.jsxs("select",{value:o.loaiImport||"",onChange:g=>m(g.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"CHIA_HANG",children:"Chia hng"}),t.jsx("option",{value:"GIAO_HANG",children:"Giao hng"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng thi"}),t.jsxs("select",{value:o.trangThai||"",onChange:g=>f(g.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"THANH_CONG",children:"Thnh cng"}),t.jsx("option",{value:"THAT_BAI",children:"Tht bi"})]})]}),t.jsx("div",{className:"ml-auto",children:t.jsx("button",{onClick:u,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Lm mi"})})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[s?t.jsxs("div",{className:"p-8 text-center",children:[t.jsxs("svg",{className:"animate-spin h-8 w-8 mx-auto text-blue-600",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),t.jsx("p",{className:"text-gray-500 mt-2",children:"ang ti..."})]}):e.length===0?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Khng c d liu"}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Loi"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tn file"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thi gian"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ngi import"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"S dng"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thnh cng"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tht bi"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trng thi"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(g=>{var y;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:g.id}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:t.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g.loaiImport==="CHIA_HANG"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:g.loaiImport==="CHIA_HANG"?"Chia hng":"Giao hng"})}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",title:g.tenFile,children:g.tenFile}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:h(g.importLuc)}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:((y=g.nguoiImport)==null?void 0:y.hoTen)||"N/A"}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-center",children:g.soDong}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-green-600 text-center font-medium",children:g.soDongHopLe}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-red-600 text-center font-medium",children:g.soDongLoi}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:t.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g.trangThai==="THANH_CONG"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.trangThai==="THANH_CONG"?"Thnh cng":"Tht bi"})})]},g.id)})})]})}),b>1&&t.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 flex items-center justify-between",children:[t.jsxs("div",{className:"text-sm text-gray-700",children:["Hin th ",t.jsx("span",{className:"font-medium",children:(o.page-1)*o.limit+1})," n"," ",t.jsx("span",{className:"font-medium",children:Math.min(o.page*o.limit,a)})," trong"," ",t.jsx("span",{className:"font-medium",children:a})," kt qu"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>p(o.page-1),disabled:o.page===1,className:"px-3 py-1 border rounded-md text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Trc"}),Array.from({length:Math.min(5,b)},(g,y)=>{let N;return b<=5||o.page<=3?N=y+1:o.page>=b-2?N=b-4+y:N=o.page-2+y,t.jsx("button",{onClick:()=>p(N),className:`px-3 py-1 border rounded-md text-sm ${N===o.page?"bg-blue-600 text-white border-blue-600":"hover:bg-gray-50"}`,children:N},N)}),t.jsx("button",{onClick:()=>p(o.page+1),disabled:o.page===b,className:"px-3 py-1 border rounded-md text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Sau"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Tng s ln import"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:a})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Import chia hng"}),t.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:e.filter(g=>g.loaiImport==="CHIA_HANG").length})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Import giao hng"}),t.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:e.filter(g=>g.loaiImport==="GIAO_HANG").length})]})]})]})},cV=e=>{switch(e){case"NHAP":return"bg-yellow-100 text-yellow-800";case"DA_CHOT":return"bg-blue-100 text-blue-800";case"DA_KHOA":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},dV=e=>{switch(e){case"NHAP":return"Nhp";case"DA_CHOT":return" cht";case"DA_KHOA":return" kha";default:return e}};function uV(){const e=Rt(),{coVaiTro:n}=ns(),a=n("ADMIN"),[r,s]=E.useState(!1),[l,o]=E.useState(()=>{const A=new Date;return`${A.getFullYear()}-${String(A.getMonth()+1).padStart(2,"0")}`}),[d,u]=E.useState(),[h,m]=E.useState({thangNam:l,tuNgay:"",denNgay:"",ngayChiTra:"",phongBanId:void 0,ghiChu:""}),f=A=>{const L=`${A}-01`,W=`${A}-15`;m({...h,thangNam:A,tuNgay:L,denNgay:W})},{data:p,isLoading:b}=Ie({queryKey:["bang-ung-luong",l,d],queryFn:()=>qa.layDanhSach({thangNam:l,phongBanId:d})}),g=(p==null?void 0:p.data)||[],{data:y}=Ie({queryKey:["phong-ban"],queryFn:ln.layTatCa}),N=De({mutationFn:qa.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["bang-ung-luong"]}),le.success("To bng ng lng thnh cng!"),s(!1),m({thangNam:l,tuNgay:"",denNgay:"",ngayChiTra:"",phongBanId:void 0,ghiChu:""})},onError:A=>{var L,W;le.error(((W=(L=A.response)==null?void 0:L.data)==null?void 0:W.message)||"C li xy ra")}}),C=De({mutationFn:({id:A,force:L})=>qa.xoa(A,L),onSuccess:()=>{e.invalidateQueries({queryKey:["bang-ung-luong"]}),le.success("Xa bng ng lng thnh cng!")},onError:A=>{var L,W;le.error(((W=(L=A.response)==null?void 0:L.data)==null?void 0:W.message)||"C li xy ra")}}),T=De({mutationFn:qa.chot,onSuccess:()=>{e.invalidateQueries({queryKey:["bang-ung-luong"]}),le.success("Cht bng ng lng thnh cng!")},onError:A=>{var L,W;le.error(((W=(L=A.response)==null?void 0:L.data)==null?void 0:W.message)||"C li xy ra")}}),S=De({mutationFn:qa.khoa,onSuccess:()=>{e.invalidateQueries({queryKey:["bang-ung-luong"]}),le.success("Kha bng ng lng thnh cng!")},onError:A=>{var L,W;le.error(((W=(L=A.response)==null?void 0:L.data)==null?void 0:W.message)||"C li xy ra")}}),k=()=>{if(!h.tuNgay||!h.denNgay){le.error("Vui lng nhp y  thng tin");return}N.mutate(h)},_=(A,L,W=!1)=>{if(L!=="NHAP"&&!W){le.error("Ch c th xa bng ng lng ang  trng thi Nhp");return}confirm(W?" CNH BO: Bn ang xa cng ch bng ng lng  kha. Thao tc ny s c ghi li. Tip tc?":"Bn c chc mun xa bng ng lng ny?")&&C.mutate({id:A,force:W})},P=(A,L)=>{if(L!=="NHAP"){le.error("Ch c th cht bng ng lng ang  trng thi Nhp");return}confirm("Bn c chc mun cht bng ng lng ny?")&&T.mutate(A)},j=(A,L)=>{if(L!=="DA_CHOT"){le.error("Ch c th kha bng ng lng  cht");return}confirm("Bn c chc mun kha bng ng lng ny?")&&S.mutate(A)};return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[t.jsx(Zp,{size:28}),"Qun l Bng ng lng"]}),t.jsxs("button",{onClick:()=>{f(l),s(!0)},className:"btn btn-primary",children:[t.jsx(St,{size:20}),"To bng ng lng"]})]}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Thng/Nm"}),t.jsx(wc,{value:l,onChange:o,className:"border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban"}),t.jsxs("select",{value:d||"",onChange:A=>u(A.target.value?Number(A.target.value):void 0),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),y==null?void 0:y.map(A=>t.jsx("option",{value:A.id,children:A.tenPhongBan},A.id))]})]})]})}),t.jsx("div",{className:"card",children:b?t.jsx("p",{className:"text-center py-8 text-gray-500",children:"ang ti..."}):g&&g.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b",children:[t.jsx("th",{className:"text-left py-3 px-4",children:"Phng ban"}),t.jsx("th",{className:"text-left py-3 px-4",children:"Thng/Nm"}),t.jsx("th",{className:"text-left py-3 px-4",children:"Ngy chi tr"}),t.jsx("th",{className:"text-right py-3 px-4",children:"S NV"}),t.jsx("th",{className:"text-right py-3 px-4",children:"Tng tin ng"}),t.jsx("th",{className:"text-center py-3 px-4",children:"Trng thi"}),t.jsx("th",{className:"text-center py-3 px-4",children:"Thao tc"})]})}),t.jsx("tbody",{children:g.map(A=>{var L,W;return t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4 font-medium",children:t.jsx(ca,{to:`/ung-luong/${A.id}`,className:"text-primary-600 hover:underline",children:((L=A.phongBan)==null?void 0:L.tenPhongBan)||"Tt c phng ban"})}),t.jsx("td",{className:"py-3 px-4",children:A.thangNam}),t.jsx("td",{className:"py-3 px-4",children:A.ngayChiTra?ys(A.ngayChiTra):"-"}),t.jsxs("td",{className:"py-3 px-4 text-right",children:[A.soNhanVienUng,"/",((W=A._count)==null?void 0:W.chiTiets)||0]}),t.jsx("td",{className:"py-3 px-4 text-right font-medium text-blue-600",children:Ze(A.tongSoTienUng)}),t.jsx("td",{className:"py-3 px-4 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded text-sm ${cV(A.trangThai)}`,children:dV(A.trangThai)})}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex justify-center gap-2",children:[A.trangThai==="NHAP"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>P(A.id,A.trangThai),className:"p-2 text-green-600 hover:bg-green-50 rounded",title:"Cht",children:t.jsx(Lr,{size:18})}),t.jsx("button",{onClick:()=>_(A.id,A.trangThai),className:"p-2 text-red-600 hover:bg-red-50 rounded",title:"Xa",children:t.jsx(Ir,{size:18})})]}),A.trangThai==="DA_CHOT"&&t.jsx("button",{onClick:()=>j(A.id,A.trangThai),className:"p-2 text-orange-600 hover:bg-orange-50 rounded",title:"Kha",children:t.jsx(Js,{size:18})}),A.trangThai==="DA_KHOA"&&a&&t.jsx("button",{onClick:()=>_(A.id,A.trangThai,!0),className:"p-2 text-red-600 hover:bg-red-50 rounded",title:"[Admin] Xa cng ch",children:t.jsx(na,{size:18})})]})})]},A.id)})})]})}):t.jsx("p",{className:"text-center py-8 text-gray-500",children:'Cha c bng ng lng no. Nhn "To bng ng lng"  bt u.'})}),r&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"To bng ng lng mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Thng/Nm ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(wc,{value:h.thangNam,onChange:f,className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["T ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ht,{value:h.tuNgay,onChange:A=>m({...h,tuNgay:A}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["n ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ht,{value:h.denNgay,onChange:A=>m({...h,denNgay:A}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy chi tr"}),t.jsx(Ht,{value:h.ngayChiTra,onChange:A=>m({...h,ngayChiTra:A}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:h.phongBanId||"",onChange:A=>m({...h,phongBanId:A.target.value?Number(A.target.value):void 0}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),y==null?void 0:y.map(A=>t.jsx("option",{value:A.id,children:A.tenPhongBan},A.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),t.jsx("textarea",{value:h.ghiChu,onChange:A=>m({...h,ghiChu:A.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:k,disabled:N.isPending,className:"btn btn-primary",children:N.isPending?"ang to...":"To bng ng lng"})]})]})})]})}const hV=e=>{switch(e){case"NGHI_QUA_NHIEU":return"Ngh qu nhiu ngy";case"NGHI_KHONG_PHEP":return"Ngh khng php";case"KHONG_HOAT_DONG":return"Khng hot ng";default:return e||""}};function xV(){const{id:e}=U0(),n=xr(),a=Rt(),r=Number(e),[s,l]=E.useState(new Map),[o,d]=E.useState(!1),[u,h]=E.useState(!1),[m,f]=E.useState(!1),[p,b]=E.useState(70),[g,y]=E.useState(0),[N,C]=E.useState(null),{data:T,isLoading:S,refetch:k}=Ie({queryKey:["bang-ung-luong",r],queryFn:()=>qa.layTheoId(r),enabled:!!r}),{data:_}=Ie({queryKey:["bang-luong-list"],queryFn:()=>_r.layDanhSach({})}),P=(T==null?void 0:T.trangThai)==="NHAP",j=De({mutationFn:H=>qa.sinhDanhSach(r,H),onSuccess:H=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),le.success(` sinh ${H.soNhanVien} nhn vin (${H.soDuocUng}  iu kin)`)},onError:H=>{var F,I;le.error(((I=(F=H.response)==null?void 0:F.data)==null?void 0:I.message)||"C li xy ra")}}),A=De({mutationFn:H=>qa.capNhatBulk(r,H),onSuccess:H=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),l(new Map),H.errors&&H.errors.length>0?le.error(`Cp nht ${H.soCapNhat} dng. Li: ${H.errors.length}`):le.success(`Cp nht ${H.soCapNhat} dng thnh cng`)},onError:H=>{var F,I;le.error(((I=(F=H.response)==null?void 0:F.data)==null?void 0:I.message)||"C li xy ra")}}),L=De({mutationFn:H=>qa.setTheoTiLe(r,H),onSuccess:H=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),d(!1),le.success(H.message)},onError:H=>{var F,I;le.error(((I=(F=H.response)==null?void 0:F.data)==null?void 0:I.message)||"C li xy ra")}}),W=De({mutationFn:H=>qa.setSoTienCoDinh(r,H),onSuccess:H=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),h(!1),le.success(H.message)},onError:H=>{var F,I;le.error(((I=(F=H.response)==null?void 0:F.data)==null?void 0:I.message)||"C li xy ra")}}),R=De({mutationFn:()=>qa.chot(r),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),le.success("Cht bng ng lng thnh cng!")},onError:H=>{var F,I;le.error(((I=(F=H.response)==null?void 0:F.data)==null?void 0:I.message)||"C li xy ra")}}),M=De({mutationFn:()=>qa.khoa(r),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),le.success("Kha bng ng lng thnh cng!")},onError:H=>{var F,I;le.error(((I=(F=H.response)==null?void 0:F.data)==null?void 0:I.message)||"C li xy ra")}}),q=De({mutationFn:H=>qa.moKhoa(r,{lyDo:H}),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),le.success("M kha bng ng lng thnh cng!")},onError:H=>{var F,I;le.error(((I=(F=H.response)==null?void 0:F.data)==null?void 0:I.message)||"C li xy ra")}}),ee=De({mutationFn:H=>qa.ghiNhanKhauTru(r,H),onSuccess:H=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),f(!1),le.success(H.message)},onError:H=>{var F,I;le.error(((I=(F=H.response)==null?void 0:F.data)==null?void 0:I.message)||"C li xy ra")}}),z=E.useCallback((H,F,I)=>{l(O=>{const V=new Map(O),te=V.get(H)||{};return V.set(H,{...te,[F]:I}),V})},[]),fe=E.useCallback((H,F)=>{const I=s.get(H.id);return I&&F in I?I[F]:H[F]},[s]),ae=E.useCallback((H,F)=>!(!H.duocPhepUng&&F>0||F>Number(H.mucToiDaDuocUng)),[]),J=()=>{if(s.size===0){le("Khng c thay i  lu",{icon:""});return}const H=Array.from(s.entries()).map(([F,I])=>({id:F,soTienUngDeXuat:I.soTienUngDeXuat,soTienUngDuyet:I.soTienUngDuyet,ghiChu:I.ghiChu??void 0}));A.mutate({chiTiets:H})},G=E.useMemo(()=>{if(!(T!=null&&T.chiTiets))return{tongNV:0,tongDuocUng:0,tongTien:0};const H=T.chiTiets;return{tongNV:H.length,tongDuocUng:H.filter(F=>F.duocPhepUng).length,tongTien:H.reduce((F,I)=>{const O=s.get(I.id),V=(O==null?void 0:O.soTienUngDuyet)??I.soTienUngDuyet;return F+Number(V)},0)}},[T==null?void 0:T.chiTiets,s]);if(S)return t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});if(!T)return t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-500",children:"Khng tm thy bng ng lng"})});const he=T.chiTiets||[];return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>n("/ung-luong"),className:"p-2 hover:bg-gray-100 rounded-full",children:t.jsx($0,{size:24})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:T.maBangUngLuong}),t.jsxs("p",{className:"text-gray-500",children:["K ",T.thangNam," | ",new Date(T.tuNgay).toLocaleDateString("vi-VN")," -"," ",new Date(T.denNgay).toLocaleDateString("vi-VN")]})]})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("span",{className:`px-3 py-1 rounded-full text-sm ${T.trangThai==="NHAP"?"bg-yellow-100 text-yellow-800":T.trangThai==="DA_CHOT"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:T.trangThai==="NHAP"?"Nhp":T.trangThai==="DA_CHOT"?" cht":" kha"})})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[t.jsxs("div",{className:"card",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng nhn vin"}),t.jsx("p",{className:"text-2xl font-bold text-gray-800",children:G.tongNV})]}),t.jsxs("div",{className:"card",children:[t.jsx("p",{className:"text-sm text-gray-500",children:" iu kin ng"}),t.jsx("p",{className:"text-2xl font-bold text-green-600",children:G.tongDuocUng})]}),t.jsxs("div",{className:"card",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Khng  iu kin"}),t.jsx("p",{className:"text-2xl font-bold text-red-600",children:G.tongNV-G.tongDuocUng})]}),t.jsxs("div",{className:"card",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng tin ng"}),t.jsx("p",{className:"text-2xl font-bold text-blue-600",children:Ze(G.tongTien)})]})]}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"flex flex-wrap gap-2",children:[P&&t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>j.mutate({}),disabled:j.isPending,className:"btn btn-secondary",children:[t.jsx(on,{size:18}),"Sinh danh sch NV"]}),t.jsxs("button",{onClick:()=>d(!0),className:"btn btn-secondary",children:[t.jsx(L_,{size:18}),"Set theo % mc ti a"]}),t.jsxs("button",{onClick:()=>h(!0),className:"btn btn-secondary",children:[t.jsx(Ar,{size:18}),"Set s tin c nh"]}),t.jsxs("button",{onClick:J,disabled:s.size===0||A.isPending,className:"btn btn-primary",children:[t.jsx(nl,{size:18}),"Lu thay i (",s.size,")"]}),t.jsxs("button",{onClick:()=>{confirm("Bn c chc mun cht bng ng lng ny?")&&R.mutate()},disabled:he.length===0,className:"btn bg-green-600 text-white hover:bg-green-700",children:[t.jsx(Lr,{size:18}),"Cht"]})]}),T.trangThai==="DA_CHOT"&&t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>{confirm("Bn c chc mun kha bng ng lng ny?")&&M.mutate()},className:"btn bg-orange-600 text-white hover:bg-orange-700",children:[t.jsx(Js,{size:18}),"Kha"]}),t.jsxs("button",{onClick:()=>f(!0),disabled:T.daGhiNhanKhauTru,className:"btn btn-primary",children:[t.jsx(qp,{size:18}),T.daGhiNhanKhauTru?" ghi nhn khu tr":"Ghi nhn khu tr"]})]}),T.trangThai==="DA_KHOA"&&t.jsxs("button",{onClick:()=>{const H=prompt("Nhp l do m kha:");H&&q.mutate(H)},className:"btn bg-gray-600 text-white hover:bg-gray-700",children:[t.jsx(Jp,{size:18}),"M kha"]}),t.jsx("button",{onClick:()=>k(),className:"btn btn-secondary ml-auto",children:t.jsx(R_,{size:18})})]})}),t.jsx("div",{className:"card overflow-x-auto",children:he.length>0?t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-3 px-4 font-medium sticky left-0 bg-gray-50",children:"M NV"}),t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"H tn"}),t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Phng ban"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Ngy cng"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Ngh"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Ngh KP"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Tin cng ly k"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Mc ti a"}),t.jsx("th",{className:"text-center py-3 px-4 font-medium",children:"Eligible"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium bg-blue-50",children:"S tin  xut"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium bg-green-50",children:"S tin duyt"}),t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Ghi ch"})]})}),t.jsx("tbody",{children:he.map(H=>{var V,te,pe;const F=fe(H,"soTienUngDuyet"),I=ae(H,Number(F)),O=s.has(H.id);return t.jsxs("tr",{className:`border-b hover:bg-gray-50 ${H.duocPhepUng?"":"bg-red-50"} ${O?"bg-yellow-50":""}`,children:[t.jsx("td",{className:"py-2 px-4 font-medium sticky left-0 bg-white",children:(V=H.nhanVien)==null?void 0:V.maNhanVien}),t.jsx("td",{className:"py-2 px-4",children:(te=H.nhanVien)==null?void 0:te.hoTen}),t.jsx("td",{className:"py-2 px-4",children:(pe=H.phongBan)==null?void 0:pe.tenPhongBan}),t.jsxs("td",{className:"py-2 px-4 text-right",children:[Number(H.soNgayCong).toFixed(1),H.laTamTinh&&t.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs bg-yellow-100 text-yellow-700 rounded",title:"Tm tnh theo lch (cha c chm cng thc t)",children:"~"})]}),t.jsx("td",{className:"py-2 px-4 text-right",children:Number(H.soNgayNghi).toFixed(1)}),t.jsxs("td",{className:"py-2 px-4 text-right",children:[Number(H.soNgayNghiKhongPhep)>0&&t.jsx("span",{className:"text-red-600 font-medium",children:Number(H.soNgayNghiKhongPhep).toFixed(1)}),Number(H.soNgayNghiKhongPhep)===0&&"0"]}),t.jsx("td",{className:"py-2 px-4 text-right",children:Ze(H.tienCongLuyKe)}),t.jsx("td",{className:"py-2 px-4 text-right font-medium text-blue-600",children:Ze(H.mucToiDaDuocUng)}),t.jsx("td",{className:"py-2 px-4 text-center",children:H.duocPhepUng?t.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-green-100 text-green-600 rounded-full",children:t.jsx(Lr,{size:14})}):t.jsx("span",{className:"inline-flex items-center gap-1 text-red-600",title:hV(H.lyDoKhongDat),children:t.jsx(uo,{size:14})})}),t.jsx("td",{className:"py-2 px-4 bg-blue-50",children:t.jsx("input",{type:"number",min:"0",max:H.mucToiDaDuocUng,value:fe(H,"soTienUngDeXuat"),onChange:U=>z(H.id,"soTienUngDeXuat",Number(U.target.value)),disabled:!P||!H.duocPhepUng,className:`w-full px-2 py-1 border rounded text-right ${!P||!H.duocPhepUng?"bg-gray-100 cursor-not-allowed":"bg-white"}`})}),t.jsxs("td",{className:"py-2 px-4 bg-green-50",children:[t.jsx("input",{type:"number",min:"0",max:H.mucToiDaDuocUng,value:F,onChange:U=>z(H.id,"soTienUngDuyet",Number(U.target.value)),disabled:!P||!H.duocPhepUng,className:`w-full px-2 py-1 border rounded text-right ${!P||!H.duocPhepUng?"bg-gray-100 cursor-not-allowed":I?"bg-white":"border-red-500 bg-red-50"}`}),!I&&t.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Vt mc ti a"})]}),t.jsx("td",{className:"py-2 px-4",children:t.jsx("input",{type:"text",value:fe(H,"ghiChu")||"",onChange:U=>z(H.id,"ghiChu",U.target.value),disabled:!P,className:`w-full px-2 py-1 border rounded ${P?"bg-white":"bg-gray-100 cursor-not-allowed"}`,placeholder:"Ghi ch..."})})]},H.id)})})]}):t.jsxs("div",{className:"text-center py-12",children:[t.jsx(on,{size:48,className:"mx-auto text-gray-400 mb-4"}),t.jsx("p",{className:"text-gray-500 mb-4",children:"Cha c nhn vin no trong bng ng lng"}),P&&t.jsxs("button",{onClick:()=>j.mutate({}),disabled:j.isPending,className:"btn btn-primary",children:[t.jsx(on,{size:18}),"Sinh danh sch nhn vin"]})]})}),o&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Set theo % mc ti a"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T l (%)"}),t.jsx("input",{type:"number",min:"0",max:"100",value:p,onChange:H=>b(Number(H.target.value)),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"p dng cho tt c nhn vin  iu kin ng lng"}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:()=>L.mutate({tiLe:p,lamTron:1e4}),disabled:L.isPending,className:"btn btn-primary",children:L.isPending?"ang x l...":"p dng"})]})]})}),u&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Set s tin c nh"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S tin (VN)"}),t.jsx("input",{type:"number",min:"0",step:"100000",value:g,onChange:H=>y(Number(H.target.value)),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Ch p dng cho nhn vin c mc ti a >= s tin ny"}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:()=>W.mutate({soTien:g}),disabled:W.isPending,className:"btn btn-primary",children:W.isPending?"ang x l...":"p dng"})]})]})}),m&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Ghi nhn khu tr vo bng lng"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Chn bng lng p dng"}),t.jsxs("select",{value:N||"",onChange:H=>C(H.target.value?Number(H.target.value):null),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn bng lng --"}),(Array.isArray(_)?_:(_==null?void 0:_.data)||[]).map(H=>{var F;return t.jsxs("option",{value:H.id,children:["Thng ",H.thang,"/",H.nam," - ",((F=H.phongBan)==null?void 0:F.tenPhongBan)||"Tt c"]},H.id)})]})]}),t.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"H thng s to phiu iu chnh t ng  khu tr s tin ng t bng lng c chn."}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:()=>{if(!N){le.error("Vui lng chn bng lng");return}ee.mutate({bangLuongApDungId:N})},disabled:ee.isPending||!N,className:"btn btn-primary",children:ee.isPending?"ang x l...":"Ghi nhn"})]})]})})]})}function mV(){var y,N,C,T,S,k,_,P,j,A,L,W,R;const[e,n]=E.useState(""),[a,r]=E.useState(null),[s,l]=E.useState(()=>{const M=new Date;return M.setMonth(M.getMonth()-11),`${M.getFullYear()}-${String(M.getMonth()+1).padStart(2,"0")}`}),[o,d]=E.useState(()=>{const M=new Date;return`${M.getFullYear()}-${String(M.getMonth()+1).padStart(2,"0")}`}),[u,h]=E.useState("bangLuongs"),{data:m}=Ie({queryKey:["nhan-vien-search",e],queryFn:()=>Oa.layTatCa({tuKhoa:e,soLuong:20}),enabled:e.length>=2}),f=m?{data:Array.isArray(m)?m:m.data}:void 0,{data:p,isLoading:b}=Ie({queryKey:["so-luong-nv",a,s,o],queryFn:()=>Hj.layNhanVien(a,{tuThang:Number(s.split("-")[1]),tuNam:Number(s.split("-")[0]),denThang:Number(o.split("-")[1]),denNam:Number(o.split("-")[0])}),enabled:!!a}),g=M=>{h(u===M?null:M)};return t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"S lng nhn vin"}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tm nhn vin"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",value:e,onChange:M=>n(M.target.value),placeholder:"Nhp m hoc tn nhn vin...",className:"w-full border rounded-lg px-3 py-2 pl-10"}),t.jsx(Ss,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(f==null?void 0:f.data)&&f.data.length>0&&e.length>=2&&t.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-60 overflow-y-auto",children:f.data.map(M=>{var q;return t.jsxs("button",{onClick:()=>{r(M.id),n(`${M.maNhanVien} - ${M.hoTen}`)},className:"w-full text-left px-4 py-2 hover:bg-gray-50",children:[t.jsx("span",{className:"font-medium",children:M.maNhanVien})," - ",M.hoTen,t.jsx("span",{className:"text-gray-500 text-sm block",children:(q=M.phongBan)==null?void 0:q.tenPhongBan})]},M.id)})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T thng"}),t.jsx(wc,{value:s,onChange:l,className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n thng"}),t.jsx(wc,{value:o,onChange:d,className:"w-full border rounded-lg px-3 py-2"})]})]})}),p&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"card mb-6",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[t.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center",children:t.jsx(no,{size:32,className:"text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold",children:p.nhanVien.hoTen}),t.jsxs("p",{className:"text-gray-500",children:[p.nhanVien.maNhanVien," | ",(y=p.nhanVien.phongBan)==null?void 0:y.tenPhongBan]})]}),t.jsxs("button",{className:"btn btn-secondary ml-auto",children:[t.jsx(Xs,{size:18}),"Xut Excel"]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng lng"}),t.jsx("p",{className:"text-lg font-bold text-gray-800",children:Ze(((N=p.tongKet)==null?void 0:N.tongLuong)??0)})]}),t.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng thng"}),t.jsx("p",{className:"text-lg font-bold text-green-600",children:Ze(((C=p.tongKet)==null?void 0:C.tongThuong)??0)})]}),t.jsxs("div",{className:"bg-red-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng pht"}),t.jsx("p",{className:"text-lg font-bold text-red-600",children:Ze(((T=p.tongKet)==null?void 0:T.tongPhat)??0)})]}),t.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng khu tr"}),t.jsx("p",{className:"text-lg font-bold text-orange-600",children:Ze(((S=p.tongKet)==null?void 0:S.tongKhauTru)??0)})]}),t.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng ng"}),t.jsx("p",{className:"text-lg font-bold text-purple-600",children:Ze(((k=p.tongKet)==null?void 0:k.tongUng)??0)})]}),t.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Thc nhn"}),t.jsx("p",{className:"text-lg font-bold text-blue-600",children:Ze(((_=p.tongKet)==null?void 0:_.tongThucNhan)??0)})]})]})]}),t.jsxs("div",{className:"card mb-4",children:[t.jsxs("button",{onClick:()=>g("bangLuongs"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(Ys,{size:20}),"Lch s bng lng (",((P=p.bangLuongs)==null?void 0:P.length)??0,")"]}),u==="bangLuongs"?t.jsx(Pl,{}):t.jsx(Er,{})]}),u==="bangLuongs"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Thng"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Ngy cng"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Lng c bn"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Ph cp"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Thng"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Khu tr"}),t.jsx("th",{className:"text-right py-2 px-3",children:"BHXH"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Thu TNCN"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Thc lnh"})]})}),t.jsx("tbody",{children:(j=p.bangLuongs)==null?void 0:j.map(M=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3 font-medium",children:M.thangNam}),t.jsx("td",{className:"py-2 px-3 text-right",children:M.ngayCong}),t.jsx("td",{className:"py-2 px-3 text-right",children:Ze(M.luongCoBan)}),t.jsx("td",{className:"py-2 px-3 text-right",children:Ze(M.phuCapTong)}),t.jsx("td",{className:"py-2 px-3 text-right text-green-600",children:Ze(M.thuongKPI+M.thuongThuNhap)}),t.jsx("td",{className:"py-2 px-3 text-right text-red-600",children:Ze(M.khauTruTong+M.ungLuong)}),t.jsx("td",{className:"py-2 px-3 text-right",children:Ze(M.bhxh+M.bhyt+M.bhtn)}),t.jsx("td",{className:"py-2 px-3 text-right",children:Ze(M.thueTNCN)}),t.jsx("td",{className:"py-2 px-3 text-right font-bold text-blue-600",children:Ze(M.thucLanh)})]},M.bangLuongId))})]})})]}),t.jsxs("div",{className:"card mb-4",children:[t.jsxs("button",{onClick:()=>g("dieuChinhs"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(Ot,{size:20}),"Phiu iu chnh (",((A=p.dieuChinhs)==null?void 0:A.length)??0,")"]}),u==="dieuChinhs"?t.jsx(Pl,{}):t.jsx(Er,{})]}),u==="dieuChinhs"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Loi phiu"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Khon"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Loi khon"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Ghi ch"})]})}),t.jsx("tbody",{children:(L=p.dieuChinhs)==null?void 0:L.map((M,q)=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3",children:new Date(M.ngayTao).toLocaleDateString("vi-VN")}),t.jsx("td",{className:"py-2 px-3",children:M.loaiPhieu}),t.jsx("td",{className:"py-2 px-3",children:M.tenKhoanLuong}),t.jsx("td",{className:"py-2 px-3",children:t.jsx("span",{className:M.loaiKhoan==="CONG_THEM"?"text-green-600":"text-red-600",children:M.loaiKhoan==="CONG_THEM"?"Cng thm":"Tr bt"})}),t.jsxs("td",{className:`py-2 px-3 text-right ${M.loaiKhoan==="CONG_THEM"?"text-green-600":"text-red-600"}`,children:[M.loaiKhoan==="CONG_THEM"?"+":"-",Ze(M.soTien)]}),t.jsx("td",{className:"py-2 px-3 text-gray-500",children:M.ghiChu})]},q))})]})})]}),t.jsxs("div",{className:"card mb-4",children:[t.jsxs("button",{onClick:()=>g("ungLuongs"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(al,{size:20}),"ng lng (",((W=p.ungLuongs)==null?void 0:W.length)??0,")"]}),u==="ungLuongs"?t.jsx(Pl,{}):t.jsx(Er,{})]}),u==="ungLuongs"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"M bng"}),t.jsx("th",{className:"text-left py-2 px-3",children:"K"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin duyt"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Trng thi"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Ngy cht"})]})}),t.jsx("tbody",{children:(R=p.ungLuongs)==null?void 0:R.map(M=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3 font-medium",children:M.maBang}),t.jsx("td",{className:"py-2 px-3",children:M.thangNam}),t.jsx("td",{className:"py-2 px-3 text-right font-bold text-purple-600",children:Ze(M.soTienDuyet)}),t.jsx("td",{className:"py-2 px-3 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${M.trangThai==="DA_KHOA"?"bg-green-100 text-green-800":M.trangThai==="DA_CHOT"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:M.trangThai==="DA_KHOA"?" kha":M.trangThai==="DA_CHOT"?" cht":"Nhp"})}),t.jsx("td",{className:"py-2 px-3",children:M.ngayChot?new Date(M.ngayChot).toLocaleDateString("vi-VN"):"-"})]},M.bangUngLuongId))})]})})]}),p.kpis&&p.kpis.length>0&&t.jsxs("div",{className:"card mb-4",children:[t.jsxs("button",{onClick:()=>g("kpis"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(al,{size:20}),"nh gi KPI (",p.kpis.length,")"]}),u==="kpis"?t.jsx(Pl,{}):t.jsx(Er,{})]}),u==="kpis"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Thng"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Tng im"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Xp loi"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Tin thng"})]})}),t.jsx("tbody",{children:p.kpis.map(M=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsxs("td",{className:"py-2 px-3",children:[M.thang,"/",M.nam]}),t.jsx("td",{className:"py-2 px-3 text-right",children:M.tongDiem}),t.jsx("td",{className:"py-2 px-3 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${M.xepLoai==="A"?"bg-green-100 text-green-800":M.xepLoai==="B"?"bg-blue-100 text-blue-800":M.xepLoai==="C"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:M.xepLoai})}),t.jsx("td",{className:"py-2 px-3 text-right text-green-600",children:Ze(M.tienThuong)})]},M.kyDanhGiaId))})]})})]}),p.thuongPhats&&p.thuongPhats.length>0&&t.jsxs("div",{className:"card",children:[t.jsxs("button",{onClick:()=>g("thuongPhats"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(Ot,{size:20}),"Thng/Pht (",p.thuongPhats.length,")"]}),u==="thuongPhats"?t.jsx(Pl,{}):t.jsx(Er,{})]}),u==="thuongPhats"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Ngy"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Loi"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Tn"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"L do"})]})}),t.jsx("tbody",{children:p.thuongPhats.map(M=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3",children:new Date(M.ngay).toLocaleDateString("vi-VN")}),t.jsx("td",{className:"py-2 px-3 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${M.loai==="THUONG"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:M.loai==="THUONG"?"Thng":"Pht"})}),t.jsx("td",{className:"py-2 px-3",children:M.ten}),t.jsxs("td",{className:`py-2 px-3 text-right ${M.loai==="THUONG"?"text-green-600":"text-red-600"}`,children:[M.loai==="THUONG"?"+":"-",Ze(M.soTien)]}),t.jsx("td",{className:"py-2 px-3 text-gray-500",children:M.lyDo})]},M.suKienId))})]})})]})]}),!a&&t.jsxs("div",{className:"card text-center py-12",children:[t.jsx(no,{size:48,className:"mx-auto text-gray-400 mb-4"}),t.jsx("p",{className:"text-gray-500",children:"Vui lng chn nhn vin  xem s lng"})]}),b&&t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})]})}function fV(){var m,f,p,b,g,y,N,C,T,S,k,_,P;const[e,n]=E.useState(null),[a,r]=E.useState(()=>{const j=new Date;return j.setMonth(j.getMonth()-11),`${j.getFullYear()}-${String(j.getMonth()+1).padStart(2,"0")}`}),[s,l]=E.useState(()=>{const j=new Date;return`${j.getFullYear()}-${String(j.getMonth()+1).padStart(2,"0")}`}),{data:o}=Ie({queryKey:["phong-ban-list"],queryFn:ln.layTatCa}),d=Array.isArray(o)?o:[],{data:u,isLoading:h}=Ie({queryKey:["so-luong-pb",e,a,s],queryFn:()=>Hj.layPhongBan(e,{tuThang:Number(a.split("-")[1]),tuNam:Number(a.split("-")[0]),denThang:Number(s.split("-")[1]),denNam:Number(s.split("-")[0])}),enabled:!!e});return t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"S lng phng ban"}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:e||"",onChange:j=>n(j.target.value?Number(j.target.value):null),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn phng ban --"}),d.map(j=>t.jsx("option",{value:j.id,children:j.tenPhongBan},j.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T thng"}),t.jsx(wc,{value:a,onChange:r,className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n thng"}),t.jsx(wc,{value:s,onChange:l,className:"w-full border rounded-lg px-3 py-2"})]})]})}),h&&t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),u&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"card mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-14 h-14 bg-blue-100 rounded-full flex items-center justify-center",children:t.jsx(Fr,{size:28,className:"text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold",children:(m=u.phongBan)==null?void 0:m.tenPhongBan}),t.jsxs("p",{className:"text-gray-500",children:["M: ",(f=u.phongBan)==null?void 0:f.maPhongBan]})]})]}),t.jsx("div",{className:"flex items-center gap-4",children:t.jsxs("button",{className:"btn btn-secondary",children:[t.jsx(Xs,{size:18}),"Xut Excel"]})})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[t.jsx(on,{size:18}),t.jsx("span",{className:"text-sm",children:"S nhn vin"})]}),t.jsx("p",{className:"text-2xl font-bold text-gray-800",children:((p=u.theoNhanVien)==null?void 0:p.length)??0})]}),t.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[t.jsx(Ar,{size:18}),t.jsx("span",{className:"text-sm",children:"Tng thu nhp"})]}),t.jsx("p",{className:"text-xl font-bold text-blue-600",children:Ze(((b=u.tongHop)==null?void 0:b.tongThuNhap)??0)})]}),t.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[t.jsx(al,{size:18}),t.jsx("span",{className:"text-sm",children:"Tng thng"})]}),t.jsx("p",{className:"text-xl font-bold text-green-600",children:Ze(((g=u.tongHop)==null?void 0:g.tongThuong)??0)})]}),t.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[t.jsx(tj,{size:18}),t.jsx("span",{className:"text-sm",children:"Thc lnh"})]}),t.jsx("p",{className:"text-xl font-bold text-purple-600",children:Ze(((y=u.tongHop)==null?void 0:y.thucLinh)??0)})]})]})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["Chi tit theo nhn vin (",((N=u.theoNhanVien)==null?void 0:N.length)??0,")"]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"M NV"}),t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"H tn"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Thu nhp"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Khu tr"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Thng"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Pht"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Thc lnh"})]})}),t.jsx("tbody",{children:(C=u.theoNhanVien)==null?void 0:C.map(j=>{var A,L,W,R,M,q,ee,z;return t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4 font-medium",children:(A=j.nhanVien)==null?void 0:A.maNhanVien}),t.jsx("td",{className:"py-3 px-4",children:(L=j.nhanVien)==null?void 0:L.hoTen}),t.jsx("td",{className:"py-3 px-4 text-right",children:Ze(((W=j.tongHop)==null?void 0:W.tongThuNhap)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-red-600",children:Ze(((R=j.tongHop)==null?void 0:R.tongKhauTru)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-green-600",children:Ze(((M=j.tongHop)==null?void 0:M.tongThuong)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-orange-600",children:Ze(((q=j.tongHop)==null?void 0:q.tongPhat)??0)}),t.jsx("td",{className:"py-3 px-4 text-right font-bold text-blue-600",children:Ze(((ee=j.tongHop)==null?void 0:ee.thucLinh)??0)})]},(z=j.nhanVien)==null?void 0:z.id)})}),t.jsx("tfoot",{className:"bg-gray-100 font-semibold",children:t.jsxs("tr",{children:[t.jsx("td",{colSpan:2,className:"py-3 px-4",children:"Tng cng"}),t.jsx("td",{className:"py-3 px-4 text-right",children:Ze(((T=u.tongHop)==null?void 0:T.tongThuNhap)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-red-600",children:Ze(((S=u.tongHop)==null?void 0:S.tongKhauTru)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-green-600",children:Ze(((k=u.tongHop)==null?void 0:k.tongThuong)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-orange-600",children:Ze(((_=u.tongHop)==null?void 0:_.tongPhat)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-blue-600",children:Ze(((P=u.tongHop)==null?void 0:P.thucLinh)??0)})]})})]})})]})]}),!e&&t.jsxs("div",{className:"card text-center py-12",children:[t.jsx(Fr,{size:48,className:"mx-auto text-gray-400 mb-4"}),t.jsx("p",{className:"text-gray-500",children:"Vui lng chn phng ban  xem s lng"})]})]})}const pV="tinh_luong_auth",ia=Jt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});ia.interceptors.request.use(e=>{const n=localStorage.getItem(pV);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const La={layDanhSachLoaiNghi:(e=!1)=>ia.get("/nghi-phep/loai-nghi",{params:{all:e}}).then(n=>n.data),layLoaiNghi:e=>ia.get(`/nghi-phep/loai-nghi/${e}`).then(n=>n.data),taoLoaiNghi:e=>ia.post("/nghi-phep/loai-nghi",e).then(n=>n.data),capNhatLoaiNghi:(e,n)=>ia.put(`/nghi-phep/loai-nghi/${e}`,n).then(a=>a.data),toggleLoaiNghi:e=>ia.post(`/nghi-phep/loai-nghi/${e}/toggle`).then(n=>n.data),layDanhSachDon:e=>ia.get("/nghi-phep/don",{params:e}).then(n=>n.data),layChiTietDon:e=>ia.get(`/nghi-phep/don/${e}`).then(n=>n.data),taoDon:e=>ia.post("/nghi-phep/don",e).then(n=>n.data),capNhatDon:(e,n)=>ia.put(`/nghi-phep/don/${e}`,n).then(a=>a.data),guiDuyet:e=>ia.post(`/nghi-phep/don/${e}/gui-duyet`).then(n=>n.data),duyetDon:(e,n)=>ia.post(`/nghi-phep/don/${e}/duyet`,{ghiChu:n}).then(a=>a.data),tuChoiDon:(e,n)=>ia.post(`/nghi-phep/don/${e}/tu-choi`,{lyDoTuChoi:n}).then(a=>a.data),huyDon:(e,n)=>ia.post(`/nghi-phep/don/${e}/huy`,{lyDo:n}).then(a=>a.data),rebuildMapping:e=>ia.post(`/nghi-phep/don/${e}/mapping/rebuild`).then(n=>n.data),layLichNghi:e=>ia.get("/nghi-phep/lich",{params:e}).then(n=>n.data),layLichNghiNhanVien:(e,n,a)=>ia.get(`/nghi-phep/nhan-vien/${e}/lich`,{params:{tuNgay:n,denNgay:a}}).then(r=>r.data)},M0=e=>({NHAP:"Nhp",GUI_DUYET:"Ch duyt",DA_DUYET:" duyt",TU_CHOI:"T chi",HUY:" hy"})[e]||e,Qi=e=>({NHAP:"gray",GUI_DUYET:"blue",DA_DUYET:"green",TU_CHOI:"red",HUY:"gray"})[e]||"gray",gV=e=>({CO_PHEP:"C php",KHONG_PHEP:"Khng php"})[e]||e;function yV(){const e=Rt(),[n,a]=E.useState(!1),[r,s]=E.useState(null),[l,o]=E.useState(!1),[d,u]=E.useState({maLoaiNghi:"",tenLoaiNghi:"",nhomLoai:"CO_PHEP",coTinhLuong:!0,coTinhChuyenCan:!1,thuTuHienThi:0}),{data:h,isLoading:m}=Ie({queryKey:["loai-nghi",l],queryFn:()=>La.layDanhSachLoaiNghi(l)}),f=De({mutationFn:La.taoLoaiNghi,onSuccess:()=>{e.invalidateQueries({queryKey:["loai-nghi"]}),le.success("To loi ngh thnh cng!"),g()},onError:C=>{var T,S;le.error(((S=(T=C.response)==null?void 0:T.data)==null?void 0:S.message)||"C li xy ra")}}),p=De({mutationFn:({id:C,data:T})=>La.capNhatLoaiNghi(C,T),onSuccess:()=>{e.invalidateQueries({queryKey:["loai-nghi"]}),le.success("Cp nht thnh cng!"),g()},onError:C=>{var T,S;le.error(((S=(T=C.response)==null?void 0:T.data)==null?void 0:S.message)||"C li xy ra")}}),b=De({mutationFn:La.toggleLoaiNghi,onSuccess:C=>{e.invalidateQueries({queryKey:["loai-nghi"]}),le.success(C.isActive?" kch hot":" v hiu ha")},onError:C=>{var T,S;le.error(((S=(T=C.response)==null?void 0:T.data)==null?void 0:S.message)||"C li xy ra")}}),g=()=>{a(!1),s(null),u({maLoaiNghi:"",tenLoaiNghi:"",nhomLoai:"CO_PHEP",coTinhLuong:!0,coTinhChuyenCan:!1,thuTuHienThi:0})},y=C=>{s(C),u({maLoaiNghi:C.maLoaiNghi,tenLoaiNghi:C.tenLoaiNghi,nhomLoai:C.nhomLoai,coTinhLuong:C.coTinhLuong,coTinhChuyenCan:C.coTinhChuyenCan,thuTuHienThi:C.thuTuHienThi}),a(!0)},N=()=>{if(!d.maLoaiNghi||!d.tenLoaiNghi){le.error("Vui lng in y  thng tin bt buc");return}if(r){const{maLoaiNghi:C,...T}=d;p.mutate({id:r.id,data:T})}else f.mutate(d)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ot,{className:"w-8 h-8 text-indigo-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Danh mc loi ngh"}),t.jsx("p",{className:"text-gray-500",children:"Qun l cc loi ngh php trong h thng"})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[t.jsx("input",{type:"checkbox",checked:l,onChange:C=>o(C.target.checked),className:"rounded border-gray-300"}),"Hin th tt c"]}),t.jsxs("button",{onClick:()=>{g(),a(!0)},className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:[t.jsx(St,{className:"w-4 h-4"}),"Thm loi ngh"]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tn loi ngh"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nhm"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Tnh lng"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Tnh chuyn cn"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"ang ti..."})}):(h==null?void 0:h.length)===0?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"Cha c loi ngh no"})}):h==null?void 0:h.map(C=>t.jsxs("tr",{className:C.isActive?"":"bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-mono text-sm text-gray-900",children:C.maLoaiNghi}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:C.tenLoaiNghi}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${C.nhomLoai==="CO_PHEP"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:gV(C.nhomLoai)})}),t.jsx("td",{className:"px-6 py-4 text-center",children:C.coTinhLuong?t.jsx("span",{className:"text-green-600",children:""}):t.jsx("span",{className:"text-gray-400",children:""})}),t.jsx("td",{className:"px-6 py-4 text-center",children:C.coTinhChuyenCan?t.jsx("span",{className:"text-green-600",children:""}):t.jsx("span",{className:"text-gray-400",children:""})}),t.jsx("td",{className:"px-6 py-4 text-center",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${C.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:C.isActive?"Hot ng":"V hiu"})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[t.jsx("button",{onClick:()=>y(C),className:"text-indigo-600 hover:text-indigo-900 mr-3",title:"Sa",children:t.jsx(Or,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>b.mutate(C.id),className:`${C.isActive?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900"}`,title:C.isActive?"V hiu ha":"Kch hot",children:t.jsx(I_,{className:"w-4 h-4"})})]})]},C.id))})]})}),n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:r?"Sa loi ngh":"Thm loi ngh mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["M loi ngh ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:d.maLoaiNghi,onChange:C=>u({...d,maLoaiNghi:C.target.value.toUpperCase()}),disabled:!!r,className:"w-full border rounded-lg px-3 py-2 disabled:bg-gray-100",placeholder:"VD: PHEP_NAM"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn loi ngh ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:d.tenLoaiNghi,onChange:C=>u({...d,tenLoaiNghi:C.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Php nm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nhm loi ngh"}),t.jsxs("select",{value:d.nhomLoai,onChange:C=>u({...d,nhomLoai:C.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"CO_PHEP",children:"C php"}),t.jsx("option",{value:"KHONG_PHEP",children:"Khng php"})]})]}),t.jsxs("div",{className:"flex gap-6",children:[t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:d.coTinhLuong,onChange:C=>u({...d,coTinhLuong:C.target.checked}),className:"rounded border-gray-300"}),t.jsx("span",{className:"text-sm text-gray-700",children:"C tnh lng"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:d.coTinhChuyenCan,onChange:C=>u({...d,coTinhChuyenCan:C.target.checked}),className:"rounded border-gray-300"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Tnh chuyn cn"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Th t hin th"}),t.jsx("input",{type:"number",min:"0",value:d.thuTuHienThi,onChange:C=>u({...d,thuTuHienThi:parseInt(C.target.value)||0}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:g,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Hy"}),t.jsx("button",{onClick:N,disabled:f.isPending||p.isPending,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:f.isPending||p.isPending?"ang x l...":r?"Cp nht":"Thm mi"})]})]})})]})}function vV(){var R,M;const e=Rt(),{user:n}=ns(),[a,r]=E.useState(!1),[s,l]=E.useState(null),[o,d]=E.useState(null),[u,h]=E.useState(""),[m,f]=E.useState(null),[p,b]=E.useState({nhanVienId:0,loaiNghiId:0,tuNgay:"",denNgay:"",lyDo:""}),{data:g}=Ie({queryKey:["loai-nghi"],queryFn:()=>La.layDanhSachLoaiNghi()}),{data:y}=Ie({queryKey:["nhan-vien-don-gian"],queryFn:()=>Oa.layTatCa()});E.useEffect(()=>{if(y&&n){const ee=(Array.isArray(y)?y:y.data||[]).find(z=>z.email===n.email||z.id===n.nhanVienId);ee&&(f(ee),b(z=>({...z,nhanVienId:ee.id})))}},[y,n]);const{data:N,isLoading:C}=Ie({queryKey:["don-nghi-phep",u,m==null?void 0:m.id],queryFn:()=>La.layDanhSachDon({nhanVienId:m==null?void 0:m.id,trangThai:u||void 0,limit:50}),enabled:!!m}),T=De({mutationFn:La.taoDon,onSuccess:()=>{e.invalidateQueries({queryKey:["don-nghi-phep"]}),le.success("To n ngh php thnh cng!"),P()},onError:q=>{var ee,z;le.error(((z=(ee=q.response)==null?void 0:ee.data)==null?void 0:z.message)||"C li xy ra")}}),S=De({mutationFn:({id:q,data:ee})=>La.capNhatDon(q,ee),onSuccess:()=>{e.invalidateQueries({queryKey:["don-nghi-phep"]}),le.success("Cp nht n thnh cng!"),P()},onError:q=>{var ee,z;le.error(((z=(ee=q.response)==null?void 0:ee.data)==null?void 0:z.message)||"C li xy ra")}}),k=De({mutationFn:La.guiDuyet,onSuccess:()=>{e.invalidateQueries({queryKey:["don-nghi-phep"]}),le.success(" gi n  duyt!")},onError:q=>{var ee,z;le.error(((z=(ee=q.response)==null?void 0:ee.data)==null?void 0:z.message)||"C li xy ra")}}),_=De({mutationFn:q=>La.huyDon(q),onSuccess:()=>{e.invalidateQueries({queryKey:["don-nghi-phep"]}),le.success(" hy n!")},onError:q=>{var ee,z;le.error(((z=(ee=q.response)==null?void 0:ee.data)==null?void 0:z.message)||"C li xy ra")}}),P=()=>{r(!1),l(null),b({nhanVienId:(m==null?void 0:m.id)||0,loaiNghiId:0,tuNgay:"",denNgay:"",lyDo:""})},j=q=>{l(q),b({nhanVienId:q.nhanVien.id,loaiNghiId:q.loaiNghi.id,tuNgay:q.tuNgay.split("T")[0],denNgay:q.denNgay.split("T")[0],lyDo:q.lyDo||""}),r(!0)},A=()=>{if(!p.loaiNghiId||!p.tuNgay||!p.denNgay){le.error("Vui lng in y  thng tin bt buc");return}if(new Date(p.tuNgay)>new Date(p.denNgay)){le.error("Ngy bt u phi nh hn hoc bng ngy kt thc");return}s?S.mutate({id:s.id,data:{loaiNghiId:p.loaiNghiId,tuNgay:p.tuNgay,denNgay:p.denNgay,lyDo:p.lyDo}}):T.mutate(p)},L=()=>{if(!p.tuNgay||!p.denNgay)return 0;const q=new Date(p.tuNgay),ee=new Date(p.denNgay);let z=0;for(let fe=new Date(q);fe<=ee;fe.setDate(fe.getDate()+1)){const ae=fe.getDay();ae!==0&&ae!==6&&z++}return z},W=q=>new Date(q).toLocaleDateString("vi-VN");return m?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(ua,{className:"w-8 h-8 text-indigo-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"n ngh ca ti"}),t.jsxs("p",{className:"text-gray-500",children:[m.hoTen," - ",m.maNhanVien]})]})]}),t.jsxs("button",{onClick:()=>{P(),r(!0)},className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:[t.jsx(St,{className:"w-4 h-4"}),"To n ngh"]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Lc theo trng thi:"}),t.jsxs("select",{value:u,onChange:q=>h(q.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"NHAP",children:"Nhp"}),t.jsx("option",{value:"GUI_DUYET",children:"Ch duyt"}),t.jsx("option",{value:"DA_DUYET",children:" duyt"}),t.jsx("option",{value:"TU_CHOI",children:"T chi"}),t.jsx("option",{value:"HUY",children:" hy"})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M n"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Loi ngh"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"T ngy"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"n ngy"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"S ngy"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"ang ti..."})}):((R=N==null?void 0:N.items)==null?void 0:R.length)===0?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"Cha c n ngh no"})}):(M=N==null?void 0:N.items)==null?void 0:M.map(q=>t.jsxs("tr",{children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-mono text-sm text-gray-900",children:q.maDon}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:q.loaiNghi.tenLoaiNghi}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:W(q.tuNgay)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:W(q.denNgay)}),t.jsx("td",{className:"px-6 py-4 text-center text-sm text-gray-900",children:q.soNgayNghi}),t.jsx("td",{className:"px-6 py-4 text-center",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full bg-${Qi(q.trangThai)}-100 text-${Qi(q.trangThai)}-800`,children:M0(q.trangThai)})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[t.jsx("button",{onClick:()=>d(q),className:"text-gray-600 hover:text-gray-900 mr-2",title:"Xem chi tit",children:t.jsx(ii,{className:"w-4 h-4"})}),(q.trangThai==="NHAP"||q.trangThai==="TU_CHOI")&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>j(q),className:"text-indigo-600 hover:text-indigo-900 mr-2",title:"Sa",children:t.jsx(Or,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>k.mutate(q.id),className:"text-blue-600 hover:text-blue-900 mr-2",title:"Gi duyt",children:t.jsx(pu,{className:"w-4 h-4"})})]}),q.trangThai!=="HUY"&&q.trangThai!=="DA_DUYET"&&t.jsx("button",{onClick:()=>{confirm("Bn c chc mun hy n ny?")&&_.mutate(q.id)},className:"text-red-600 hover:text-red-900",title:"Hy n",children:t.jsx(hn,{className:"w-4 h-4"})})]})]},q.id))})]})}),a&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:s?"Sa n ngh php":"To n ngh php mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Loi ngh ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("select",{value:p.loaiNghiId,onChange:q=>b({...p,loaiNghiId:parseInt(q.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn loi ngh --"}),g==null?void 0:g.map(q=>t.jsxs("option",{value:q.id,children:[q.tenLoaiNghi," (",q.coTinhLuong?"C lng":"Khng lng",")"]},q.id))]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["T ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ht,{value:p.tuNgay,onChange:q=>b({...p,tuNgay:q}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["n ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ht,{value:p.denNgay,onChange:q=>b({...p,denNgay:q}),className:"w-full border rounded-lg px-3 py-2"})]})]}),p.tuNgay&&p.denNgay&&t.jsx("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:t.jsxs("span",{className:"text-blue-700 font-medium",children:["S ngy ngh (khng tnh T7, CN): ",L()," ngy"]})}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"L do ngh"}),t.jsx("textarea",{value:p.lyDo,onChange:q=>b({...p,lyDo:q.target.value}),rows:3,className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp l do ngh (ty chn)"})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:P,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Hy"}),t.jsx("button",{onClick:A,disabled:T.isPending||S.isPending,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:T.isPending||S.isPending?"ang x l...":s?"Cp nht":"To n"})]})]})}),o&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h2",{className:"text-xl font-bold",children:"Chi tit n ngh"}),t.jsx("button",{onClick:()=>d(null),className:"text-gray-500 hover:text-gray-700",children:t.jsx(hn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"M n"}),t.jsx("p",{className:"font-mono font-medium",children:o.maDon})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Trng thi"}),t.jsx("p",{children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full bg-${Qi(o.trangThai)}-100 text-${Qi(o.trangThai)}-800`,children:M0(o.trangThai)})})]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Loi ngh"}),t.jsx("p",{className:"font-medium",children:o.loaiNghi.tenLoaiNghi})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"T ngy"}),t.jsx("p",{className:"font-medium",children:W(o.tuNgay)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"n ngy"}),t.jsx("p",{className:"font-medium",children:W(o.denNgay)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"S ngy"}),t.jsx("p",{className:"font-medium",children:o.soNgayNghi})]})]}),o.lyDo&&t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"L do"}),t.jsx("p",{className:"text-gray-700",children:o.lyDo})]}),o.nguoiDuyet&&t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Ngi duyt"}),t.jsx("p",{className:"font-medium",children:o.nguoiDuyet.hoTen}),o.ngayDuyet&&t.jsxs("p",{className:"text-sm text-gray-500",children:["Ngy duyt: ",W(o.ngayDuyet)]})]}),o.lyDoTuChoi&&t.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[t.jsx("span",{className:"text-sm text-red-600 font-medium",children:"L do t chi:"}),t.jsx("p",{className:"text-red-700",children:o.lyDoTuChoi})]})]}),t.jsx("div",{className:"flex justify-end mt-6",children:t.jsx("button",{onClick:()=>d(null),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"ng"})})]})})]}):t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Ot,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),t.jsx("p",{className:"text-gray-500",children:"ang ti thng tin nhn vin..."})]})})}function bV(){var T,S;const e=Rt(),[n,a]=E.useState(null),[r,s]=E.useState(null),[l,o]=E.useState(""),[d,u]=E.useState({phongBanId:void 0,trangThai:"GUI_DUYET",tuNgay:"",denNgay:"",page:1}),{data:h}=Ie({queryKey:["phong-ban"],queryFn:ln.layTatCa}),{data:m,isLoading:f,refetch:p}=Ie({queryKey:["don-nghi-phep-duyet",d],queryFn:()=>La.layDanhSachDon({phongBanId:d.phongBanId,trangThai:d.trangThai||void 0,tuNgay:d.tuNgay||void 0,denNgay:d.denNgay||void 0,page:d.page,limit:20})}),b=De({mutationFn:k=>La.duyetDon(k),onSuccess:k=>{e.invalidateQueries({queryKey:["don-nghi-phep-duyet"]}),le.success(` duyt n ${k.maDon}!`)},onError:k=>{var _,P;le.error(((P=(_=k.response)==null?void 0:_.data)==null?void 0:P.message)||"C li xy ra khi duyt")}}),g=De({mutationFn:({id:k,lyDo:_})=>La.tuChoiDon(k,_),onSuccess:k=>{e.invalidateQueries({queryKey:["don-nghi-phep-duyet"]}),le.success(` t chi n ${k.maDon}`),s(null),o("")},onError:k=>{var _,P;le.error(((P=(_=k.response)==null?void 0:_.data)==null?void 0:P.message)||"C li xy ra")}}),y=De({mutationFn:La.rebuildMapping,onSuccess:k=>{le.success(` rebuild mapping: ${k.soNgayTao} ngy`)},onError:k=>{var _,P;le.error(((P=(_=k.response)==null?void 0:_.data)==null?void 0:P.message)||"C li xy ra")}}),N=k=>new Date(k).toLocaleDateString("vi-VN"),C=()=>{if(r){if(!l.trim()){le.error("Vui lng nhp l do t chi");return}g.mutate({id:r.id,lyDo:l})}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ma,{className:"w-8 h-8 text-green-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Duyt ngh php"}),t.jsx("p",{className:"text-gray-500",children:"Xem xt v ph duyt n ngh php ca nhn vin"})]})]}),t.jsxs("button",{onClick:()=>p(),className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-800",children:[t.jsx(Ra,{className:"w-4 h-4"}),"Lm mi"]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t.jsx(Wp,{className:"w-4 h-4 inline mr-1"}),"Phng ban"]}),t.jsxs("select",{value:d.phongBanId||"",onChange:k=>u({...d,phongBanId:k.target.value?parseInt(k.target.value):void 0,page:1}),className:"border rounded-lg px-3 py-2 min-w-[180px]",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),h==null?void 0:h.map(k=>t.jsx("option",{value:k.id,children:k.tenPhongBan},k.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng thi"}),t.jsxs("select",{value:d.trangThai,onChange:k=>u({...d,trangThai:k.target.value,page:1}),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"GUI_DUYET",children:"Ch duyt"}),t.jsx("option",{value:"DA_DUYET",children:" duyt"}),t.jsx("option",{value:"TU_CHOI",children:"T chi"}),t.jsx("option",{value:"NHAP",children:"Nhp"}),t.jsx("option",{value:"HUY",children:" hy"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T ngy"}),t.jsx(Ht,{value:d.tuNgay,onChange:k=>u({...d,tuNgay:k,page:1}),className:"border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n ngy"}),t.jsx(Ht,{value:d.denNgay,onChange:k=>u({...d,denNgay:k,page:1}),className:"border rounded-lg px-3 py-2"})]}),t.jsx("button",{onClick:()=>u({phongBanId:void 0,trangThai:"GUI_DUYET",tuNgay:"",denNgay:"",page:1}),className:"px-3 py-2 text-sm text-gray-600 hover:text-gray-800",children:"t li"})]})}),t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M n"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Loi ngh"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"S ngy"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-4 text-center text-gray-500",children:"ang ti..."})}):((T=m==null?void 0:m.items)==null?void 0:T.length)===0?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-4 text-center text-gray-500",children:"Khng c n ngh php no"})}):(S=m==null?void 0:m.items)==null?void 0:S.map(k=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 whitespace-nowrap font-mono text-sm text-gray-900",children:k.maDon}),t.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:k.nhanVien.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:k.nhanVien.maNhanVien})]}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:k.phongBan.tenPhongBan}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:k.loaiNghi.tenLoaiNghi}),t.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:[N(k.tuNgay)," - ",N(k.denNgay)]}),t.jsx("td",{className:"px-4 py-3 text-center text-sm font-medium text-gray-900",children:k.soNgayNghi}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full bg-${Qi(k.trangThai)}-100 text-${Qi(k.trangThai)}-800`,children:M0(k.trangThai)})}),t.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm font-medium",children:[t.jsx("button",{onClick:()=>a(k),className:"text-gray-600 hover:text-gray-900 mr-2",title:"Xem chi tit",children:t.jsx(ii,{className:"w-4 h-4"})}),k.trangThai==="GUI_DUYET"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>b.mutate(k.id),disabled:b.isPending,className:"text-green-600 hover:text-green-900 mr-2",title:"Duyt",children:t.jsx(Lr,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>s(k),className:"text-red-600 hover:text-red-900",title:"T chi",children:t.jsx(ho,{className:"w-4 h-4"})})]}),k.trangThai==="DA_DUYET"&&t.jsx("button",{onClick:()=>y.mutate(k.id),disabled:y.isPending,className:"text-blue-600 hover:text-blue-900",title:"Rebuild mapping",children:t.jsx(Ra,{className:"w-4 h-4"})})]})]},k.id))})]}),(m==null?void 0:m.pagination)&&m.pagination.totalPages>1&&t.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 flex items-center justify-between",children:[t.jsxs("div",{className:"text-sm text-gray-500",children:["Trang ",m.pagination.page," / ",m.pagination.totalPages," (",m.pagination.total," n)"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>u({...d,page:d.page-1}),disabled:d.page<=1,className:"p-2 text-gray-600 hover:text-gray-900 disabled:opacity-50",children:t.jsx(Rr,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>u({...d,page:d.page+1}),disabled:d.page>=m.pagination.totalPages,className:"p-2 text-gray-600 hover:text-gray-900 disabled:opacity-50",children:t.jsx(aa,{className:"w-4 h-4"})})]})]})]}),n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h2",{className:"text-xl font-bold",children:"Chi tit n ngh"}),t.jsx("button",{onClick:()=>a(null),className:"text-gray-500 hover:text-gray-700",children:t.jsx(hn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"M n"}),t.jsx("p",{className:"font-mono font-medium",children:n.maDon})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Trng thi"}),t.jsx("p",{children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full bg-${Qi(n.trangThai)}-100 text-${Qi(n.trangThai)}-800`,children:M0(n.trangThai)})})]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Nhn vin"}),t.jsxs("p",{className:"font-medium",children:[n.nhanVien.hoTen," (",n.nhanVien.maNhanVien,")"]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Phng ban"}),t.jsx("p",{className:"font-medium",children:n.phongBan.tenPhongBan})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Loi ngh"}),t.jsx("p",{className:"font-medium",children:n.loaiNghi.tenLoaiNghi})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"T ngy"}),t.jsx("p",{className:"font-medium",children:N(n.tuNgay)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"n ngy"}),t.jsx("p",{className:"font-medium",children:N(n.denNgay)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"S ngy"}),t.jsx("p",{className:"font-medium",children:n.soNgayNghi})]})]}),n.lyDo&&t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"L do"}),t.jsx("p",{className:"text-gray-700",children:n.lyDo})]}),n.nguoiDuyet&&t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Ngi duyt"}),t.jsx("p",{className:"font-medium",children:n.nguoiDuyet.hoTen}),n.ngayDuyet&&t.jsxs("p",{className:"text-sm text-gray-500",children:["Ngy duyt: ",N(n.ngayDuyet)]})]}),n.lyDoTuChoi&&t.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[t.jsx("span",{className:"text-sm text-red-600 font-medium",children:"L do t chi:"}),t.jsx("p",{className:"text-red-700",children:n.lyDoTuChoi})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[n.trangThai==="GUI_DUYET"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>{a(null),s(n)},className:"px-4 py-2 text-red-600 hover:text-red-800",children:"T chi"}),t.jsx("button",{onClick:()=>{b.mutate(n.id),a(null)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Duyt n"})]}),t.jsx("button",{onClick:()=>a(null),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"ng"})]})]})}),r&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4 text-red-600",children:"T chi n ngh"}),t.jsxs("p",{className:"text-gray-600 mb-4",children:["T chi n ",t.jsx("strong",{children:r.maDon})," ca"," ",t.jsx("strong",{children:r.nhanVien.hoTen}),"?"]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["L do t chi ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("textarea",{value:l,onChange:k=>o(k.target.value),rows:3,className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp l do t chi..."})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:()=>{s(null),o("")},className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Hy"}),t.jsx("button",{onClick:C,disabled:g.isPending,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:g.isPending?"ang x l...":"T chi"})]})]})})]})}function NV(){const[e,n]=E.useState(()=>{const g=new Date;return`${g.getFullYear()}-${String(g.getMonth()+1).padStart(2,"0")}`}),[a,r]=E.useState(),{tuNgay:s,denNgay:l}=E.useMemo(()=>{const[g,y]=e.split("-").map(Number),N=new Date(g,y-1,1),C=new Date(g,y,0);return{tuNgay:N.toISOString().split("T")[0],denNgay:C.toISOString().split("T")[0]}},[e]),{data:o}=Ie({queryKey:["phong-ban"],queryFn:ln.layTatCa}),{data:d,isLoading:u}=Ie({queryKey:["lich-nghi",s,l,a],queryFn:()=>La.layLichNghi({phongBanId:a,tuNgay:s,denNgay:l})}),h=E.useMemo(()=>{const[g,y]=e.split("-").map(Number),N=new Date(g,y-1,1),C=new Date(g,y,0),T=[];for(let S=new Date(N);S<=C;S.setDate(S.getDate()+1))T.push(new Date(S));return T},[e]),m=E.useMemo(()=>{const g=new Map;return d==null||d.forEach(y=>{y.chiTietNgays.forEach(N=>{const C=`${y.nhanVien.id}-${N.ngay.split("T")[0]}`;g.set(C,{loaiNghi:N.loaiNghi.tenLoaiNghi,nhomLoai:N.loaiNghi.nhomLoai})})}),g},[d]),f=g=>{const[y,N]=e.split("-").map(Number),C=new Date(y,N-1+g,1);n(`${C.getFullYear()}-${String(C.getMonth()+1).padStart(2,"0")}`)},p=()=>{const[g,y]=e.split("-").map(Number);return`Thng ${y}/${g}`},b=g=>{const y=g.getDay();return y===0||y===6};return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ot,{className:"w-8 h-8 text-indigo-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Lch ngh php"}),t.jsx("p",{className:"text-gray-500",children:"Xem tng quan lch ngh php ca nhn vin"})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>f(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:t.jsx(Rr,{className:"w-5 h-5"})}),t.jsx("h2",{className:"text-lg font-semibold min-w-[140px] text-center",children:p()}),t.jsx("button",{onClick:()=>f(1),className:"p-2 hover:bg-gray-100 rounded-lg",children:t.jsx(aa,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Wp,{className:"w-4 h-4 text-gray-500"}),t.jsxs("select",{value:a||"",onChange:g=>r(g.target.value?parseInt(g.target.value):void 0),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),o==null?void 0:o.map(g=>t.jsx("option",{value:g.id,children:g.tenPhongBan},g.id))]})]})]})}),t.jsxs("div",{className:"flex gap-4 text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"w-4 h-4 bg-green-200 rounded"}),t.jsx("span",{children:"Ngh c php"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"w-4 h-4 bg-red-200 rounded"}),t.jsx("span",{children:"Ngh khng php"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"w-4 h-4 bg-gray-200 rounded"}),t.jsx("span",{children:"Cui tun"})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:u?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"ang ti..."}):d!=null&&d.length?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"sticky left-0 bg-gray-50 px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase min-w-[200px] border-r",children:"Nhn vin"}),h.map(g=>t.jsxs("th",{className:`px-2 py-3 text-center text-xs font-medium uppercase min-w-[36px] ${b(g)?"bg-gray-100 text-gray-400":"text-gray-500"}`,children:[t.jsx("div",{children:g.getDate()}),t.jsx("div",{className:"text-[10px] font-normal",children:["CN","T2","T3","T4","T5","T6","T7"][g.getDay()]})]},g.toISOString()))]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:d.map(g=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsxs("td",{className:"sticky left-0 bg-white px-4 py-2 border-r",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:g.nhanVien.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:g.nhanVien.maNhanVien})]}),h.map(y=>{const N=y.toISOString().split("T")[0],C=`${g.nhanVien.id}-${N}`,T=m.get(C);return t.jsx("td",{className:`px-1 py-2 text-center ${b(y)?"bg-gray-50":""}`,children:T&&t.jsx("div",{className:`w-6 h-6 mx-auto rounded-full flex items-center justify-center text-xs font-medium cursor-pointer ${T.nhomLoai==="CO_PHEP"?"bg-green-200 text-green-800":"bg-red-200 text-red-800"}`,title:T.loaiNghi,children:T.nhomLoai==="CO_PHEP"?"P":"K"})},y.toISOString())})]},g.nhanVien.id))})]})}):t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Khng c lch ngh php trong thng ny"})}),d&&d.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsxs("h3",{className:"font-medium text-gray-700 mb-3",children:["Thng k thng ",p()]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:d.length}),t.jsx("div",{className:"text-sm text-gray-500",children:"Nhn vin c ngh"})]}),t.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:d.reduce((g,y)=>g+y.chiTietNgays.filter(N=>N.loaiNghi.nhomLoai==="CO_PHEP").length,0)}),t.jsx("div",{className:"text-sm text-gray-500",children:"Ngy ngh c php"})]}),t.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-red-600",children:d.reduce((g,y)=>g+y.chiTietNgays.filter(N=>N.loaiNghi.nhomLoai==="KHONG_PHEP").length,0)}),t.jsx("div",{className:"text-sm text-gray-500",children:"Ngy ngh khng php"})]}),t.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:d.reduce((g,y)=>g+y.chiTietNgays.length,0)}),t.jsx("div",{className:"text-sm text-gray-500",children:"Tng ngy ngh"})]})]})]})]})}const tc={layDanhSach:async e=>(await me.get("/ca-lam-viec",{params:e})).data,layDanhSachActive:async e=>(await me.get("/ca-lam-viec/active",{params:{phongBanId:e}})).data,layChiTiet:async e=>(await me.get(`/ca-lam-viec/${e}`)).data,tao:async e=>(await me.post("/ca-lam-viec",e)).data,capNhat:async(e,n)=>(await me.put(`/ca-lam-viec/${e}`,n)).data,xoa:async e=>(await me.delete(`/ca-lam-viec/${e}`)).data,toggleTrangThai:async e=>(await me.patch(`/ca-lam-viec/${e}/toggle`)).data},Cd=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#06B6D4","#84CC16"];function jV(){const e=Rt(),[n,a]=E.useState(!1),[r,s]=E.useState(null),[l,o]=E.useState(""),[d,u]=E.useState(),[h,m]=E.useState(),[f,p]=E.useState({maCa:"",tenCa:"",gioVao:"08:00",gioRa:"17:00",nghiGiuaCaPhut:60,graceInPhut:5,graceLatePhut:5,isCaDem:!1,phongBanId:void 0,moTa:"",mauHienThi:Cd[0]}),{data:b,isLoading:g}=Ie({queryKey:["ca-lam-viec",d,h,l],queryFn:()=>tc.layDanhSach({phongBanId:d,trangThai:h,tuKhoa:l||void 0})}),{data:y}=Ie({queryKey:["phong-ban"],queryFn:ln.layTatCa}),N=De({mutationFn:tc.tao,onSuccess:()=>{e.invalidateQueries({queryKey:["ca-lam-viec"]}),le.success("To ca lm vic thnh cng"),P()},onError:R=>{var M,q;le.error(((q=(M=R.response)==null?void 0:M.data)==null?void 0:q.message)||"C li xy ra")}}),C=De({mutationFn:({id:R,data:M})=>tc.capNhat(R,M),onSuccess:()=>{e.invalidateQueries({queryKey:["ca-lam-viec"]}),le.success("Cp nht thnh cng"),P()},onError:R=>{var M,q;le.error(((q=(M=R.response)==null?void 0:M.data)==null?void 0:q.message)||"C li xy ra")}}),T=De({mutationFn:tc.xoa,onSuccess:()=>{e.invalidateQueries({queryKey:["ca-lam-viec"]}),le.success(" xa ca lm vic")},onError:R=>{var M,q;le.error(((q=(M=R.response)==null?void 0:M.data)==null?void 0:q.message)||"C li xy ra")}}),S=De({mutationFn:tc.toggleTrangThai,onSuccess:R=>{e.invalidateQueries({queryKey:["ca-lam-viec"]}),le.success(R.trangThai?" kch hot ca":" v hiu ha ca")}}),k=()=>{s(null),p({maCa:"",tenCa:"",gioVao:"08:00",gioRa:"17:00",nghiGiuaCaPhut:60,graceInPhut:5,graceLatePhut:5,isCaDem:!1,phongBanId:void 0,moTa:"",mauHienThi:Cd[Math.floor(Math.random()*Cd.length)]}),a(!0)},_=R=>{s(R),p({maCa:R.maCa,tenCa:R.tenCa,gioVao:R.gioVao,gioRa:R.gioRa,nghiGiuaCaPhut:R.nghiGiuaCaPhut,graceInPhut:R.graceInPhut,graceLatePhut:R.graceLatePhut,isCaDem:R.isCaDem,phongBanId:R.phongBanId||void 0,moTa:R.moTa||"",mauHienThi:R.mauHienThi||Cd[0]}),a(!0)},P=()=>{a(!1),s(null)},j=R=>{if(R.preventDefault(),!f.maCa||!f.tenCa||!f.gioVao||!f.gioRa){le.error("Vui lng in y  thng tin bt buc");return}r?C.mutate({id:r.id,data:{tenCa:f.tenCa,gioVao:f.gioVao,gioRa:f.gioRa,nghiGiuaCaPhut:f.nghiGiuaCaPhut,graceInPhut:f.graceInPhut,graceLatePhut:f.graceLatePhut,isCaDem:f.isCaDem,phongBanId:f.phongBanId,moTa:f.moTa,mauHienThi:f.mauHienThi}}):N.mutate(f)},A=R=>{confirm(`Bn c chc mun xa ca "${R.tenCa}"?`)&&T.mutate(R.id)},L=(R,M,q,ee)=>{const[z,fe]=R.split(":").map(Number),[ae,J]=M.split(":").map(Number);let G=z*60+fe,he=ae*60+J;ee&&he<G&&(he+=1440);const H=he-G-q,F=Math.floor(H/60),I=H%60;return`${F}h${I>0?I+"p":""}`},W=(b==null?void 0:b.data)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Danh mc Ca lm vic"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Qun l cc ca lm vic trong cng ty"})]}),t.jsxs(mt,{onClick:k,className:"flex items-center gap-2",children:[t.jsx(St,{className:"w-4 h-4"}),"Thm ca mi"]})]}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex flex-wrap gap-4",children:[t.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[t.jsx(Ss,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Tm theo m hoc tn ca...",value:l,onChange:R=>o(R.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary-500"})]}),t.jsxs("select",{value:d||"",onChange:R=>u(R.target.value?Number(R.target.value):void 0),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),y==null?void 0:y.map(R=>t.jsx("option",{value:R.id,children:R.tenPhongBan},R.id))]}),t.jsxs("select",{value:h===void 0?"":h?"active":"inactive",onChange:R=>{R.target.value===""?m(void 0):m(R.target.value==="active")},className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:[t.jsx("option",{value:"",children:"Tt c trng thi"}),t.jsx("option",{value:"active",children:"ang hot ng"}),t.jsx("option",{value:"inactive",children:"Ngng hot ng"})]})]})}),t.jsx(st,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Mu"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"M ca"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Tn ca"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Gi lm"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Thi lng"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:g?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"ang ti..."})}):W.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"Cha c ca lm vic no"})}):W.map(R=>{var M;return t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white shadow",style:{backgroundColor:R.mauHienThi||"#3B82F6"}})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"font-mono text-sm font-medium text-gray-900 dark:text-white",children:R.maCa})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-2",children:[R.isCaDem?t.jsx(sb,{className:"w-4 h-4 text-indigo-500"}):t.jsx(oj,{className:"w-4 h-4 text-amber-500"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:R.tenCa})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[t.jsx(nn,{className:"w-4 h-4 text-gray-400"}),t.jsxs("span",{className:"text-gray-900 dark:text-white",children:[R.gioVao," - ",R.gioRa]})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:L(R.gioVao,R.gioRa,R.nghiGiuaCaPhut,R.isCaDem)})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:R.phongBanId?(M=y==null?void 0:y.find(q=>q.id===R.phongBanId))==null?void 0:M.tenPhongBan:"Ton cng ty"})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("button",{onClick:()=>S.mutate(R.id),className:"inline-flex items-center gap-1",title:R.trangThai?"Click  v hiu ha":"Click  kch hot",children:R.trangThai?t.jsxs(t.Fragment,{children:[t.jsx(dj,{className:"w-6 h-6 text-green-500"}),t.jsx(Tt,{variant:"success",children:"Hot ng"})]}):t.jsxs(t.Fragment,{children:[t.jsx(cj,{className:"w-6 h-6 text-gray-400"}),t.jsx(Tt,{variant:"neutral",children:"Ngng"})]})})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>_(R),className:"p-2 text-gray-500 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",title:"Chnh sa",children:t.jsx(Or,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>A(R),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Xa",children:t.jsx(Ir,{className:"w-4 h-4"})})]})})]},R.id)})})]})})}),t.jsx(js,{isOpen:n,onClose:P,size:"lg",children:t.jsxs("form",{onSubmit:j,children:[t.jsx(ws,{title:r?"Chnh sa ca lm vic":"Thm ca lm vic mi"}),t.jsx(ks,{children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["M ca ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:f.maCa,onChange:R=>p({...f,maCa:R.target.value.toUpperCase()}),disabled:!!r,placeholder:"VD: CA_HANH_CHINH",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 disabled:bg-gray-100"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Tn ca ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:f.tenCa,onChange:R=>p({...f,tenCa:R.target.value}),placeholder:"VD: Ca hnh chnh",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Gi vo ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"time",value:f.gioVao,onChange:R=>p({...f,gioVao:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Gi ra ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"time",value:f.gioRa,onChange:R=>p({...f,gioRa:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ngh gia ca (pht)"}),t.jsx("input",{type:"number",min:0,max:120,value:f.nghiGiuaCaPhut,onChange:R=>p({...f,nghiGiuaCaPhut:Number(R.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Pht c php tr"}),t.jsx("input",{type:"number",min:0,max:60,value:f.graceLatePhut,onChange:R=>p({...f,graceLatePhut:Number(R.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"p dng cho phng ban"}),t.jsxs("select",{value:f.phongBanId||"",onChange:R=>p({...f,phongBanId:R.target.value?Number(R.target.value):void 0}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:[t.jsx("option",{value:"",children:"Ton cng ty"}),y==null?void 0:y.map(R=>t.jsx("option",{value:R.id,children:R.tenPhongBan},R.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Mu hin th"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"color",value:f.mauHienThi,onChange:R=>p({...f,mauHienThi:R.target.value}),className:"w-10 h-10 border-0 rounded cursor-pointer"}),t.jsx("div",{className:"flex gap-1",children:Cd.map(R=>t.jsx("button",{type:"button",onClick:()=>p({...f,mauHienThi:R}),className:`w-6 h-6 rounded-full border-2 ${f.mauHienThi===R?"border-gray-800 dark:border-white":"border-transparent"}`,style:{backgroundColor:R}},R))})]})]}),t.jsx("div",{className:"md:col-span-2",children:t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:f.isCaDem,onChange:R=>p({...f,isCaDem:R.target.checked}),className:"w-4 h-4 text-primary-600 rounded"}),t.jsx(sb,{className:"w-4 h-4 text-indigo-500"}),t.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Ca m (qua ngy, VD: 22:00 - 06:00)"})]})}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"M t"}),t.jsx("textarea",{value:f.moTa,onChange:R=>p({...f,moTa:R.target.value}),rows:2,placeholder:"Ghi ch v ca lm vic...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]})]})}),t.jsxs(ei,{children:[t.jsx(mt,{variant:"secondary",onClick:P,type:"button",children:"Hy"}),t.jsx(mt,{type:"submit",disabled:N.isPending||C.isPending,children:N.isPending||C.isPending?"ang x l...":r?"Cp nht":"To mi"})]})]})})]})}const Dl={layDanhSach:async e=>(await me.get("/phan-ca",{params:e})).data,layChiTiet:async e=>(await me.get(`/phan-ca/${e}`)).data,layCalendarView:async e=>(await me.get("/phan-ca/calendar",{params:e})).data,tao:async e=>(await me.post("/phan-ca",e)).data,capNhat:async(e,n)=>(await me.put(`/phan-ca/${e}`,n)).data,assignNgay:async(e,n)=>(await me.post(`/phan-ca/${e}/assign`,n)).data,assignBatch:async(e,n)=>(await me.post(`/phan-ca/${e}/assign-batch`,n)).data,copyTuan:async(e,n)=>(await me.post(`/phan-ca/${e}/copy-week`,n)).data,publish:async e=>(await me.post(`/phan-ca/${e}/publish`)).data,unpublish:async e=>(await me.post(`/phan-ca/${e}/unpublish`)).data,xoa:async e=>(await me.delete(`/phan-ca/${e}`)).data,xoaChiTiet:async(e,n)=>(await me.post(`/phan-ca/${e}/xoa-chi-tiet`,{chiTietIds:n})).data,layLichCuaToi:async(e,n)=>(await me.get("/phan-ca/lich-cua-toi",{params:{tuNgay:e,denNgay:n}})).data},d2=["CN","T2","T3","T4","T5","T6","T7"];function wV(){var pe;const e=Rt(),[n,a]=E.useState(()=>{const U=new Date;return`${U.getFullYear()}-${String(U.getMonth()+1).padStart(2,"0")}`}),[r,s]=E.useState(),[l,o]=E.useState(null),[d,u]=E.useState(!1),[h,m]=E.useState(!1),[f,p]=E.useState(!1),[b,g]=E.useState({nhanVienIds:[],caLamViecId:0,tuNgay:"",denNgay:"",ngoaiTruThu:[]}),[y,N]=E.useState({tuanNguon:"",tuanDich:""}),{data:C}=Ie({queryKey:["phong-ban"],queryFn:ln.layTatCa}),{data:T}=Ie({queryKey:["ca-lam-viec-active",r],queryFn:()=>tc.layDanhSachActive(r)}),{data:S}=Ie({queryKey:["phan-ca",n,r],queryFn:()=>Dl.layDanhSach({thangNam:n,phongBanId:r})}),{data:k,isLoading:_}=Ie({queryKey:["phan-ca-calendar",n,r],queryFn:()=>Dl.layCalendarView({thangNam:n,phongBanId:r}),enabled:!!n}),{data:P}=Ie({queryKey:["nhan-vien",r],queryFn:()=>Oa.layTatCa({phongBanId:r,trangThai:"DANG_LAM",soLuong:500})}),j=De({mutationFn:Dl.tao,onSuccess:U=>{e.invalidateQueries({queryKey:["phan-ca"]}),le.success("To lch phn ca thnh cng"),o(U.id),u(!1)},onError:U=>{var ce,Q;le.error(((Q=(ce=U.response)==null?void 0:ce.data)==null?void 0:Q.message)||"C li xy ra")}}),A=De({mutationFn:({lichId:U,payload:ce})=>Dl.assignBatch(U,ce),onSuccess:U=>{e.invalidateQueries({queryKey:["phan-ca-calendar"]}),le.success(`${U.message} (${U.created} mi, ${U.updated} cp nht)`),m(!1)},onError:U=>{var ce,Q;le.error(((Q=(ce=U.response)==null?void 0:ce.data)==null?void 0:Q.message)||"C li xy ra")}}),L=De({mutationFn:({lichId:U,payload:ce})=>Dl.copyTuan(U,ce),onSuccess:U=>{e.invalidateQueries({queryKey:["phan-ca-calendar"]}),le.success(`${U.message}`),p(!1)},onError:U=>{var ce,Q;le.error(((Q=(ce=U.response)==null?void 0:ce.data)==null?void 0:Q.message)||"C li xy ra")}}),W=De({mutationFn:Dl.publish,onSuccess:U=>{e.invalidateQueries({queryKey:["phan-ca"]}),e.invalidateQueries({queryKey:["phan-ca-calendar"]}),le.success(`${U.message} (${U.mapped}  mapping)`)},onError:U=>{var ce,Q;le.error(((Q=(ce=U.response)==null?void 0:ce.data)==null?void 0:Q.message)||"C li xy ra")}}),R=De({mutationFn:({lichId:U,payload:ce})=>Dl.assignNgay(U,ce),onSuccess:()=>{e.invalidateQueries({queryKey:["phan-ca-calendar"]})},onError:U=>{var ce,Q;le.error(((Q=(ce=U.response)==null?void 0:ce.data)==null?void 0:Q.message)||"C li xy ra")}}),M=E.useMemo(()=>S!=null&&S.data?l?S.data.find(U=>U.id===l):S.data.find(U=>U.trangThai!=="HUY"):null,[S,l]),q=E.useMemo(()=>{const[U,ce]=n.split("-").map(Number),Q=new Date(U,ce-1,1),oe=new Date(U,ce,0),X=[],ve=Q.getDay();for(let at=ve-1;at>=0;at--){const et=new Date(U,ce-1,-at);X.push({date:et,dateStr:et.toISOString().split("T")[0],isCurrentMonth:!1})}for(let at=1;at<=oe.getDate();at++){const et=new Date(U,ce-1,at);X.push({date:et,dateStr:et.toISOString().split("T")[0],isCurrentMonth:!0})}const Ke=42-X.length;for(let at=1;at<=Ke;at++){const et=new Date(U,ce,at);X.push({date:et,dateStr:et.toISOString().split("T")[0],isCurrentMonth:!1})}return X},[n]),ee=()=>{const[U,ce]=n.split("-").map(Number),Q=new Date(U,ce-2,1);a(`${Q.getFullYear()}-${String(Q.getMonth()+1).padStart(2,"0")}`)},z=()=>{const[U,ce]=n.split("-").map(Number),Q=new Date(U,ce,1);a(`${Q.getFullYear()}-${String(Q.getMonth()+1).padStart(2,"0")}`)},fe=()=>{j.mutate({thangNam:n,phongBanId:r,tenLich:`Lch phn ca ${n}${r?` - PB${r}`:""}`})},ae=(U,ce,Q)=>{if(!M||M.trangThai==="DA_CONG_BO")return;const oe=Q==null?void 0:Q.caLamViecId,X=J(oe);X&&R.mutate({lichId:M.id,payload:{nhanVienId:U,ngay:ce,caLamViecId:X.id}})},J=U=>{if(!T||T.length===0)return null;if(!U)return T[0];const Q=(T.findIndex(oe=>oe.id===U)+1)%(T.length+1);return Q===T.length?null:T[Q]},G=()=>{if(M){if(!b.nhanVienIds.length||!b.caLamViecId||!b.tuNgay||!b.denNgay){le.error("Vui lng in y  thng tin");return}A.mutate({lichId:M.id,payload:b})}},he=()=>{if(M){if(!y.tuanNguon||!y.tuanDich){le.error("Vui lng chn tun ngun v tun ch");return}L.mutate({lichId:M.id,payload:y})}},H=()=>{M&&confirm("Bn c chc mun cng b lch? Sau khi cng b s khng th chnh sa.")&&W.mutate(M.id)},[F,I]=n.split("-").map(Number),O=`Thng ${I}/${F}`,V=(k==null?void 0:k.nhanViens)||[],te=Array.isArray(P)?P:(P==null?void 0:P.data)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[t.jsx(Ot,{className:"w-6 h-6 text-primary-500"}),"Lch Phn Ca"]}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Phn ca lm vic cho nhn vin theo thng"})]}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[!M&&t.jsxs(mt,{onClick:()=>u(!0),className:"flex items-center gap-2",children:[t.jsx(St,{className:"w-4 h-4"}),"To lch mi"]}),M&&M.trangThai==="NHAP"&&t.jsxs(t.Fragment,{children:[t.jsxs(mt,{variant:"secondary",onClick:()=>{var U;g({nhanVienIds:[],caLamViecId:((U=T==null?void 0:T[0])==null?void 0:U.id)||0,tuNgay:`${n}-01`,denNgay:`${n}-${(k==null?void 0:k.soNgayTrongThang)||28}`,ngoaiTruThu:[0,6]}),m(!0)},className:"flex items-center gap-2",children:[t.jsx(on,{className:"w-4 h-4"}),"Phn ca hng lot"]}),t.jsxs(mt,{variant:"secondary",onClick:()=>p(!0),className:"flex items-center gap-2",children:[t.jsx(rj,{className:"w-4 h-4"}),"Copy tun"]}),t.jsxs(mt,{onClick:H,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700",children:[t.jsx(bs,{className:"w-4 h-4"}),"Cng b lch"]})]})]})]}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:ee,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(Rr,{className:"w-5 h-5"})}),t.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white min-w-[150px] text-center",children:O}),t.jsx("button",{onClick:z,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(aa,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("select",{value:r||"",onChange:U=>s(U.target.value?Number(U.target.value):void 0),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),C==null?void 0:C.map(U=>t.jsx("option",{value:U.id,children:U.tenPhongBan},U.id))]}),(S==null?void 0:S.data)&&S.data.length>0&&t.jsx("select",{value:l||(M==null?void 0:M.id)||"",onChange:U=>o(Number(U.target.value)),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:S.data.map(U=>t.jsxs("option",{value:U.id,children:[U.tenLich," (",U.trangThai,")"]},U.id))})]}),M&&t.jsxs("div",{className:"flex items-center gap-2",children:[M.trangThai==="DA_CONG_BO"?t.jsxs(Tt,{variant:"success",className:"flex items-center gap-1",children:[t.jsx(Ma,{className:"w-4 h-4"})," cng b"]}):M.trangThai==="NHAP"?t.jsx(Tt,{variant:"warning",className:"flex items-center gap-1",children:"ang son tho"}):t.jsx(Tt,{variant:"neutral",children:" hy"}),t.jsxs("span",{className:"text-sm text-gray-500",children:[((pe=M._count)==null?void 0:pe.chiTiets)||0," phn ca"]})]})]})}),T&&T.length>0&&t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[t.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Ch thch:"}),T.map(U=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:U.mauHienThi||"#3B82F6"}}),t.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:[U.tenCa," (",U.gioVao,"-",U.gioRa,")"]})]},U.id)),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded bg-gray-200 dark:bg-gray-700"}),t.jsx("span",{className:"text-sm text-gray-500",children:"Cha phn ca"})]})]})}),t.jsx(st,{className:"overflow-hidden",children:_?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"ang ti lch..."}):V.length===0?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Cha c nhn vin no. Hy chn phng ban hoc to lch phn ca mi."}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-800",children:[t.jsx("th",{className:"sticky left-0 z-10 bg-gray-50 dark:bg-gray-800 px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 border-b border-r min-w-[180px]",children:"Nhn vin"}),q.filter(U=>U.isCurrentMonth).map(U=>{const ce=U.date.getDay(),Q=ce===0||ce===6;return t.jsxs("th",{className:`px-1 py-2 text-center text-xs font-semibold border-b min-w-[60px] ${Q?"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-300"}`,children:[t.jsx("div",{children:d2[ce]}),t.jsx("div",{className:"text-lg font-bold",children:U.date.getDate()})]},U.dateStr)})]})}),t.jsx("tbody",{children:V.map(U=>t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50",children:[t.jsxs("td",{className:"sticky left-0 z-10 bg-white dark:bg-gray-900 px-4 py-2 border-b border-r",children:[t.jsx("div",{className:"font-medium text-gray-900 dark:text-white text-sm",children:U.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:U.maNhanVien})]}),q.filter(ce=>ce.isCurrentMonth).map(ce=>{const Q=U.ngays[ce.dateStr],oe=ce.date.getDay(),X=oe===0||oe===6,ve=M&&M.trangThai==="NHAP";return t.jsx("td",{onClick:()=>ve&&ae(U.nhanVienId,ce.dateStr,Q),className:`px-1 py-1 border-b text-center cursor-pointer transition-colors ${X?"bg-red-50/50 dark:bg-red-900/10":""} ${ve?"hover:bg-primary-50 dark:hover:bg-primary-900/20":""}`,children:Q?t.jsx("div",{className:"px-1 py-1 rounded text-xs font-medium text-white truncate",style:{backgroundColor:Q.mauHienThi||"#3B82F6"},title:`${Q.tenCa} (${Q.gioVao}-${Q.gioRa})`,children:Q.maCa}):t.jsx("div",{className:"px-1 py-1 rounded text-xs text-gray-400",children:"-"})},ce.dateStr)})]},U.nhanVienId))})]})})}),t.jsxs(js,{isOpen:d,onClose:()=>u(!1),children:[t.jsx(ws,{title:"To lch phn ca mi"}),t.jsx(ks,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Thng"}),t.jsx("input",{type:"month",value:n,onChange:U=>a(U.target.value),className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phng ban"}),t.jsxs("select",{value:r||"",onChange:U=>s(U.target.value?Number(U.target.value):void 0),className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Ton cng ty"}),C==null?void 0:C.map(U=>t.jsx("option",{value:U.id,children:U.tenPhongBan},U.id))]})]})]})}),t.jsxs(ei,{children:[t.jsx(mt,{variant:"secondary",onClick:()=>u(!1),children:"Hy"}),t.jsx(mt,{onClick:fe,disabled:j.isPending,children:j.isPending?"ang to...":"To lch"})]})]}),t.jsxs(js,{isOpen:h,onClose:()=>m(!1),size:"lg",children:[t.jsx(ws,{title:"Phn ca hng lot"}),t.jsx(ks,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Chn nhn vin ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("div",{className:"border rounded-lg p-2 max-h-48 overflow-y-auto",children:[t.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:b.nhanVienIds.length===te.length,onChange:U=>{g({...b,nhanVienIds:U.target.checked?te.map(ce=>ce.id):[]})},className:"w-4 h-4"}),t.jsx("span",{className:"font-medium",children:"Chn tt c"})]}),t.jsx("hr",{className:"my-2"}),te.map(U=>t.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:b.nhanVienIds.includes(U.id),onChange:ce=>{const Q=ce.target.checked?[...b.nhanVienIds,U.id]:b.nhanVienIds.filter(oe=>oe!==U.id);g({...b,nhanVienIds:Q})},className:"w-4 h-4"}),t.jsxs("span",{children:[U.hoTen," (",U.maNhanVien,")"]})]},U.id))]}),t.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[" chn: ",b.nhanVienIds.length," nhn vin"]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Ca lm vic ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("select",{value:b.caLamViecId,onChange:U=>g({...b,caLamViecId:Number(U.target.value)}),className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"-- Chn ca --"}),T==null?void 0:T.map(U=>t.jsxs("option",{value:U.id,children:[U.tenCa," (",U.gioVao," - ",U.gioRa,")"]},U.id))]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"T ngy"}),t.jsx("input",{type:"date",value:b.tuNgay,onChange:U=>g({...b,tuNgay:U.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"n ngy"}),t.jsx("input",{type:"date",value:b.denNgay,onChange:U=>g({...b,denNgay:U.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi tr cc ngy"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:d2.map((U,ce)=>t.jsxs("label",{className:`px-3 py-1 rounded-full cursor-pointer border ${b.ngoaiTruThu.includes(ce)?"bg-red-100 border-red-300 text-red-700":"bg-gray-100 border-gray-300"}`,children:[t.jsx("input",{type:"checkbox",className:"hidden",checked:b.ngoaiTruThu.includes(ce),onChange:Q=>{const oe=Q.target.checked?[...b.ngoaiTruThu,ce]:b.ngoaiTruThu.filter(X=>X!==ce);g({...b,ngoaiTruThu:oe})}}),U]},ce))})]})]})}),t.jsxs(ei,{children:[t.jsx(mt,{variant:"secondary",onClick:()=>m(!1),children:"Hy"}),t.jsx(mt,{onClick:G,disabled:A.isPending,children:A.isPending?"ang x l...":"Phn ca"})]})]}),t.jsxs(js,{isOpen:f,onClose:()=>p(!1),children:[t.jsx(ws,{title:"Copy tun"}),t.jsx(ks,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tun ngun (chn ngy bt k trong tun)"}),t.jsx("input",{type:"date",value:y.tuanNguon,onChange:U=>N({...y,tuanNguon:U.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tun ch (chn ngy bt k trong tun)"}),t.jsx("input",{type:"date",value:y.tuanDich,onChange:U=>N({...y,tuanDich:U.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]})]})}),t.jsxs(ei,{children:[t.jsx(mt,{variant:"secondary",onClick:()=>p(!1),children:"Hy"}),t.jsx(mt,{onClick:he,disabled:L.isPending,children:L.isPending?"ang copy...":"Copy tun"})]})]})]})}const R0=e=>({NHAP:"Nhp",CHO_DUYET_1:"Ch duyt (Cp 1)",CHO_DUYET_2:"Ch duyt (Cp 2)",DA_DUYET:" duyt",TU_CHOI:"T chi",HUY:" hy"})[e]||e,B0=e=>({NHAP:"bg-gray-100 text-gray-700",CHO_DUYET_1:"bg-yellow-100 text-yellow-700",CHO_DUYET_2:"bg-orange-100 text-orange-700",DA_DUYET:"bg-green-100 text-green-700",TU_CHOI:"bg-red-100 text-red-700",HUY:"bg-gray-100 text-gray-500"})[e]||"bg-gray-100 text-gray-700",Bl=e=>({OT:"",TRE_GIO:"",VE_SOM:"",CONG_TAC:"",LAM_TU_XA:""})[e]||"",ga={layDanhSachLoai:async e=>(await me.get("/yeu-cau/loai",{params:{all:e?"true":void 0}})).data,layLoai:async e=>(await me.get(`/yeu-cau/loai/${e}`)).data,taoLoai:async e=>(await me.post("/yeu-cau/loai",e)).data,capNhatLoai:async(e,n)=>(await me.put(`/yeu-cau/loai/${e}`,n)).data,toggleLoai:async e=>(await me.post(`/yeu-cau/loai/${e}/toggle`)).data,layDanhSachDon:async e=>(await me.get("/yeu-cau/don",{params:e})).data,layDonCuaToi:async e=>(await me.get("/yeu-cau/don/cua-toi",{params:e})).data,layChiTietDon:async e=>(await me.get(`/yeu-cau/don/${e}`)).data,taoDon:async e=>(await me.post("/yeu-cau/don",e)).data,capNhatDon:async(e,n)=>(await me.put(`/yeu-cau/don/${e}`,n)).data,guiDuyet:async e=>(await me.post(`/yeu-cau/don/${e}/gui-duyet`)).data,duyetCap1:async(e,n)=>(await me.post(`/yeu-cau/don/${e}/duyet-cap-1`,{ghiChu:n})).data,duyetCap2:async(e,n)=>(await me.post(`/yeu-cau/don/${e}/duyet-cap-2`,{ghiChu:n})).data,tuChoiCap1:async(e,n)=>(await me.post(`/yeu-cau/don/${e}/tu-choi-cap-1`,{lyDoTuChoi:n})).data,tuChoiCap2:async(e,n)=>(await me.post(`/yeu-cau/don/${e}/tu-choi-cap-2`,{lyDoTuChoi:n})).data,override:async(e,n,a)=>(await me.post(`/yeu-cau/don/${e}/override`,{lyDoOverride:n,duyet:a})).data,huyDon:async e=>(await me.post(`/yeu-cau/don/${e}/huy`)).data,layInboxCap1:async e=>(await me.get("/yeu-cau/inbox/cap-1",{params:e})).data,layInboxCap2:async e=>(await me.get("/yeu-cau/inbox/cap-2",{params:e})).data,duyetBatch:async(e,n,a)=>(await me.post("/yeu-cau/inbox/duyet-batch",{ids:e,cap:n,ghiChu:a})).data,layDanhSachWorkflowConfig:async(e,n)=>(await me.get("/yeu-cau/workflow-config",{params:{loaiYeuCauId:e,phongBanId:n}})).data,taoWorkflowConfig:async e=>(await me.post("/yeu-cau/workflow-config",e)).data,capNhatWorkflowConfig:async(e,n)=>(await me.put(`/yeu-cau/workflow-config/${e}`,n)).data};function kV(){var fe,ae;const e=Rt(),{user:n}=ns(),[a,r]=E.useState(!1),[s,l]=E.useState(null),[o,d]=E.useState(null),[u,h]=E.useState(""),[m,f]=E.useState(""),[p,b]=E.useState(null),[g,y]=E.useState({nhanVienId:0,loaiYeuCauId:0,ngayYeuCau:new Date().toISOString().split("T")[0],gioBatDau:"",gioKetThuc:"",diaDiem:"",lyDo:""}),{data:N}=Ie({queryKey:["loai-yeu-cau"],queryFn:()=>ga.layDanhSachLoai()}),{data:C}=Ie({queryKey:["nhan-vien-don-gian"],queryFn:()=>Oa.layTatCa()});E.useEffect(()=>{if(C&&n){const G=(Array.isArray(C)?C:C.data||[]).find(he=>he.email===n.email||he.id===n.nhanVienId);G&&(b(G),y(he=>({...he,nhanVienId:G.id})))}},[C,n]);const{data:T,isLoading:S}=Ie({queryKey:["don-yeu-cau-cua-toi",u,m],queryFn:()=>ga.layDonCuaToi({trangThai:u||void 0,loaiYeuCauId:m||void 0,limit:50}),enabled:!0}),k=N==null?void 0:N.find(J=>J.id===g.loaiYeuCauId),_=De({mutationFn:ga.taoDon,onSuccess:()=>{e.invalidateQueries({queryKey:["don-yeu-cau-cua-toi"]}),le.success("To n yu cu thnh cng!"),L()},onError:J=>{var G,he;le.error(((he=(G=J.response)==null?void 0:G.data)==null?void 0:he.message)||"C li xy ra")}}),P=De({mutationFn:({id:J,data:G})=>ga.capNhatDon(J,G),onSuccess:()=>{e.invalidateQueries({queryKey:["don-yeu-cau-cua-toi"]}),le.success("Cp nht n thnh cng!"),L()},onError:J=>{var G,he;le.error(((he=(G=J.response)==null?void 0:G.data)==null?void 0:he.message)||"C li xy ra")}}),j=De({mutationFn:ga.guiDuyet,onSuccess:J=>{e.invalidateQueries({queryKey:["don-yeu-cau-cua-toi"]}),le.success(` gi n ${J.maDon}  duyt!`)},onError:J=>{var G,he;le.error(((he=(G=J.response)==null?void 0:G.data)==null?void 0:he.message)||"C li xy ra")}}),A=De({mutationFn:ga.huyDon,onSuccess:()=>{e.invalidateQueries({queryKey:["don-yeu-cau-cua-toi"]}),le.success(" hy n!")},onError:J=>{var G,he;le.error(((he=(G=J.response)==null?void 0:G.data)==null?void 0:he.message)||"C li xy ra")}}),L=()=>{y({nhanVienId:(p==null?void 0:p.id)||0,loaiYeuCauId:0,ngayYeuCau:new Date().toISOString().split("T")[0],gioBatDau:"",gioKetThuc:"",diaDiem:"",lyDo:""}),l(null),r(!1)},W=J=>{l(J),y({nhanVienId:J.nhanVienId,loaiYeuCauId:J.loaiYeuCauId,ngayYeuCau:J.ngayYeuCau.split("T")[0],gioBatDau:J.gioBatDau||"",gioKetThuc:J.gioKetThuc||"",diaDiem:J.diaDiem||"",lyDo:J.lyDo}),r(!0)},R=()=>{var J;if(!g.loaiYeuCauId){le.error("Vui lng chn loi yu cu");return}if(!g.lyDo.trim()){le.error("Vui lng nhp l do");return}if(k!=null&&k.yeuCauGioBatDau&&!g.gioBatDau){le.error("Vui lng nhp gi bt u");return}if(k!=null&&k.yeuCauGioKetThuc&&!g.gioKetThuc){le.error("Vui lng nhp gi kt thc");return}if(k!=null&&k.yeuCauDiaDiem&&!((J=g.diaDiem)!=null&&J.trim())){le.error("Vui lng nhp a im");return}s?P.mutate({id:s.id,data:g}):_.mutate(g)},M=J=>{confirm(`Gi n ${J.maDon}  duyt?`)&&j.mutate(J.id)},q=J=>{confirm(`Hy n ${J.maDon}?`)&&A.mutate(J.id)},ee=J=>new Date(J).toLocaleDateString("vi-VN"),z=(T==null?void 0:T.data)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"n yu cu ca ti"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"To v qun l n OT, Tr gi, V sm, Cng tc, Lm t xa"})]}),t.jsxs("button",{onClick:()=>{L(),r(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[t.jsx(St,{className:"w-5 h-5"}),"To n mi"]})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("select",{value:m,onChange:J=>f(J.target.value?Number(J.target.value):""),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[t.jsx("option",{value:"",children:"Tt c loi"}),N==null?void 0:N.map(J=>t.jsxs("option",{value:J.id,children:[Bl(J.maLoai)," ",J.tenLoai]},J.id))]}),t.jsxs("select",{value:u,onChange:J=>h(J.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[t.jsx("option",{value:"",children:"Tt c trng thi"}),t.jsx("option",{value:"NHAP",children:"Nhp"}),t.jsx("option",{value:"CHO_DUYET_1",children:"Ch duyt (Cp 1)"}),t.jsx("option",{value:"CHO_DUYET_2",children:"Ch duyt (Cp 2)"}),t.jsx("option",{value:"DA_DUYET",children:" duyt"}),t.jsx("option",{value:"TU_CHOI",children:"T chi"}),t.jsx("option",{value:"HUY",children:" hy"})]})]}),t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:S?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"ang ti..."}):z.length===0?t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx(ua,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Cha c n yu cu no"})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"M n"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Loi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:z.map(J=>{var G,he;return t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:J.maDon})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{children:Bl(((G=J.loaiYeuCau)==null?void 0:G.maLoai)||"")}),t.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:(he=J.loaiYeuCau)==null?void 0:he.tenLoai})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300",children:ee(J.ngayYeuCau)}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300",children:[J.gioBatDau&&J.gioKetThuc?`${J.gioBatDau} - ${J.gioKetThuc}`:J.gioBatDau||"-",J.soGio&&t.jsxs("span",{className:"ml-2 text-blue-600 dark:text-blue-400",children:["(",J.soGio,"h)"]})]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${B0(J.trangThai)}`,children:R0(J.trangThai)})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx("button",{onClick:()=>d(J),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Xem chi tit",children:t.jsx(ii,{className:"w-4 h-4"})}),["NHAP","TU_CHOI"].includes(J.trangThai)&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>W(J),className:"p-2 text-gray-500 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg transition-colors",title:"Sa",children:t.jsx(Or,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>M(J),className:"p-2 text-gray-500 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Gi duyt",children:t.jsx(pu,{className:"w-4 h-4"})})]}),["NHAP","CHO_DUYET_1","CHO_DUYET_2","TU_CHOI"].includes(J.trangThai)&&t.jsx("button",{onClick:()=>q(J),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Hy n",children:t.jsx(hn,{className:"w-4 h-4"})})]})})]},J.id)})})]})})}),a&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[t.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:t.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:s?"Sa n yu cu":"To n yu cu mi"})}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Loi yu cu ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("select",{value:g.loaiYeuCauId,onChange:J=>y({...g,loaiYeuCauId:Number(J.target.value)}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",disabled:!!s,children:[t.jsx("option",{value:0,children:"-- Chn loi yu cu --"}),N==null?void 0:N.map(J=>t.jsxs("option",{value:J.id,children:[Bl(J.maLoai)," ",J.tenLoai]},J.id))]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ht,{value:g.ngayYeuCau,onChange:J=>y({...g,ngayYeuCau:J})})]}),((k==null?void 0:k.yeuCauGioBatDau)||g.gioBatDau)&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Gi bt u ",(k==null?void 0:k.yeuCauGioBatDau)&&t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"time",value:g.gioBatDau,onChange:J=>y({...g,gioBatDau:J.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),((k==null?void 0:k.yeuCauGioKetThuc)||g.gioKetThuc)&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Gi kt thc ",(k==null?void 0:k.yeuCauGioKetThuc)&&t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"time",value:g.gioKetThuc,onChange:J=>y({...g,gioKetThuc:J.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),((k==null?void 0:k.yeuCauDiaDiem)||g.diaDiem)&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["a im ",(k==null?void 0:k.yeuCauDiaDiem)&&t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:g.diaDiem,onChange:J=>y({...g,diaDiem:J.target.value}),placeholder:"Nhp a im...",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["L do ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("textarea",{value:g.lyDo,onChange:J=>y({...g,lyDo:J.target.value}),placeholder:"Nhp l do yu cu...",rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none"})]})]}),t.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[t.jsx("button",{onClick:L,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700",children:"Hy"}),t.jsx("button",{onClick:R,disabled:_.isPending||P.isPending,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:_.isPending||P.isPending?"ang lu...":s?"Cp nht":"To n"})]})]})}),o&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Chi tit n ",o.maDon]}),t.jsx("button",{onClick:()=>d(null),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(hn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Loi yu cu"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[Bl(((fe=o.loaiYeuCau)==null?void 0:fe.maLoai)||"")," ",(ae=o.loaiYeuCau)==null?void 0:ae.tenLoai]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Trng thi"}),t.jsx("span",{className:`inline-block px-2 py-1 text-xs font-medium rounded-full ${B0(o.trangThai)}`,children:R0(o.trangThai)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Ngy yu cu"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:ee(o.ngayYeuCau)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Thi gian"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[o.gioBatDau&&o.gioKetThuc?`${o.gioBatDau} - ${o.gioKetThuc}`:o.gioBatDau||"-",o.soGio&&` (${o.soGio}h)`]})]})]}),o.diaDiem&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"a im"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:o.diaDiem})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"L do"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:o.lyDo})]}),o.nguoiDuyet1&&t.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Duyt cp 1"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[o.nguoiDuyet1.hoTen," -"," ",o.ngayDuyet1&&ee(o.ngayDuyet1)]}),o.ghiChuDuyet1&&t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:o.ghiChuDuyet1})]}),o.nguoiDuyet2&&t.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Duyt cp 2"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[o.nguoiDuyet2.hoTen," -"," ",o.ngayDuyet2&&ee(o.ngayDuyet2)]}),o.ghiChuDuyet2&&t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:o.ghiChuDuyet2})]}),o.lyDoTuChoi&&t.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[t.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 font-medium",children:"L do t chi"}),t.jsx("p",{className:"text-red-700 dark:text-red-300",children:o.lyDoTuChoi})]}),o.isOverride&&t.jsxs("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[t.jsxs("p",{className:"text-sm text-yellow-600 dark:text-yellow-400 font-medium flex items-center gap-1",children:[t.jsx(uo,{className:"w-4 h-4"})," Override"]}),t.jsx("p",{className:"text-yellow-700 dark:text-yellow-300",children:o.lyDoOverride})]})]})]})})]})}function TV(){var F,I,O,V,te,pe;const e=Rt(),[n,a]=E.useState("cap1"),[r,s]=E.useState(null),[l,o]=E.useState(null),[d,u]=E.useState(null),[h,m]=E.useState(""),[f,p]=E.useState(""),[b,g]=E.useState(!0),[y,N]=E.useState(new Set),[C,T]=E.useState({phongBanId:void 0,loaiYeuCauId:void 0,tuNgay:"",denNgay:"",page:1}),{data:S}=Ie({queryKey:["phong-ban"],queryFn:ln.layTatCa}),{data:k}=Ie({queryKey:["loai-yeu-cau"],queryFn:()=>ga.layDanhSachLoai()}),{data:_,isLoading:P,refetch:j}=Ie({queryKey:["don-yeu-cau-duyet",n,C],queryFn:()=>n==="cap1"?ga.layInboxCap1({phongBanId:C.phongBanId,loaiYeuCauId:C.loaiYeuCauId,tuNgay:C.tuNgay||void 0,denNgay:C.denNgay||void 0,page:C.page,limit:20}):n==="cap2"?ga.layInboxCap2({phongBanId:C.phongBanId,loaiYeuCauId:C.loaiYeuCauId,tuNgay:C.tuNgay||void 0,denNgay:C.denNgay||void 0,page:C.page,limit:20}):ga.layDanhSachDon({phongBanId:C.phongBanId,loaiYeuCauId:C.loaiYeuCauId,tuNgay:C.tuNgay||void 0,denNgay:C.denNgay||void 0,page:C.page,limit:20})}),A=De({mutationFn:U=>ga.duyetCap1(U),onSuccess:U=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),le.success(` duyt n ${U.maDon}!`)},onError:U=>{var ce,Q;le.error(((Q=(ce=U.response)==null?void 0:ce.data)==null?void 0:Q.message)||"C li xy ra")}}),L=De({mutationFn:U=>ga.duyetCap2(U),onSuccess:U=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),le.success(` duyt n ${U.maDon}!`)},onError:U=>{var ce,Q;le.error(((Q=(ce=U.response)==null?void 0:ce.data)==null?void 0:Q.message)||"C li xy ra")}}),W=De({mutationFn:({id:U,lyDo:ce})=>ga.tuChoiCap1(U,ce),onSuccess:U=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),le.success(` t chi n ${U.maDon}`),o(null),m("")},onError:U=>{var ce,Q;le.error(((Q=(ce=U.response)==null?void 0:ce.data)==null?void 0:Q.message)||"C li xy ra")}}),R=De({mutationFn:({id:U,lyDo:ce})=>ga.tuChoiCap2(U,ce),onSuccess:U=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),le.success(` t chi n ${U.maDon}`),o(null),m("")},onError:U=>{var ce,Q;le.error(((Q=(ce=U.response)==null?void 0:ce.data)==null?void 0:Q.message)||"C li xy ra")}}),M=De({mutationFn:({id:U,lyDo:ce,duyet:Q})=>ga.override(U,ce,Q),onSuccess:U=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),le.success(` override n ${U.maDon}`),u(null),p("")},onError:U=>{var ce,Q;le.error(((Q=(ce=U.response)==null?void 0:ce.data)==null?void 0:Q.message)||"C li xy ra")}}),q=De({mutationFn:({ids:U,cap:ce})=>ga.duyetBatch(U,ce),onSuccess:U=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),le.success(` duyt ${U.success} n thnh cng!`),U.failed>0&&le.error(`${U.failed} n tht bi`),N(new Set)},onError:U=>{var ce,Q;le.error(((Q=(ce=U.response)==null?void 0:ce.data)==null?void 0:Q.message)||"C li xy ra")}}),ee=U=>new Date(U).toLocaleDateString("vi-VN"),z=U=>{U.trangThai==="CHO_DUYET_1"?A.mutate(U.id):U.trangThai==="CHO_DUYET_2"&&L.mutate(U.id)},fe=()=>{if(!l||!h.trim()){le.error("Vui lng nhp l do t chi");return}l.trangThai==="CHO_DUYET_1"?W.mutate({id:l.id,lyDo:h}):R.mutate({id:l.id,lyDo:h})},ae=()=>{if(!d||!f.trim()){le.error("Vui lng nhp l do override");return}M.mutate({id:d.id,lyDo:f,duyet:b})},J=()=>{if(y.size===0){le.error("Cha chn n no");return}const U=n==="cap1"?1:2;q.mutate({ids:Array.from(y),cap:U})},G=U=>{const ce=new Set(y);ce.has(U)?ce.delete(U):ce.add(U),N(ce)},he=()=>{const U=(_==null?void 0:_.data)||[];y.size===U.length?N(new Set):N(new Set(U.map(ce=>ce.id)))},H=(_==null?void 0:_.data)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Duyt yu cu"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Duyt n OT, Tr gi, V sm, Cng tc ca nhn vin"})]}),t.jsxs("button",{onClick:()=>j(),className:"flex items-center gap-2 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700",children:[t.jsx(Ra,{className:"w-4 h-4"}),"Lm mi"]})]}),t.jsxs("div",{className:"flex gap-2 border-b border-gray-200 dark:border-gray-700",children:[t.jsx("button",{onClick:()=>{a("cap1"),N(new Set)},className:`px-4 py-2 font-medium transition-colors ${n==="cap1"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Cp 1 (Manager)"}),t.jsx("button",{onClick:()=>{a("cap2"),N(new Set)},className:`px-4 py-2 font-medium transition-colors ${n==="cap2"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Cp 2 (HR)"}),t.jsx("button",{onClick:()=>{a("tat-ca"),N(new Set)},className:`px-4 py-2 font-medium transition-colors ${n==="tat-ca"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Tt c"})]}),t.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[t.jsxs("select",{value:C.phongBanId||"",onChange:U=>T({...C,phongBanId:U.target.value?Number(U.target.value):void 0,page:1}),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),S==null?void 0:S.map(U=>t.jsx("option",{value:U.id,children:U.tenPhongBan},U.id))]}),t.jsxs("select",{value:C.loaiYeuCauId||"",onChange:U=>T({...C,loaiYeuCauId:U.target.value?Number(U.target.value):void 0,page:1}),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[t.jsx("option",{value:"",children:"Tt c loi"}),k==null?void 0:k.map(U=>t.jsxs("option",{value:U.id,children:[Bl(U.maLoai)," ",U.tenLoai]},U.id))]}),y.size>0&&(n==="cap1"||n==="cap2")&&t.jsxs("button",{onClick:J,disabled:q.isPending,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:[t.jsx(Ma,{className:"w-4 h-4"}),"Duyt ",y.size," n"]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[P?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"ang ti..."}):H.length===0?t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx(on,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Khng c n yu cu no"})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:t.jsxs("tr",{children:[(n==="cap1"||n==="cap2")&&t.jsx("th",{className:"px-4 py-3 text-left",children:t.jsx("input",{type:"checkbox",checked:y.size===H.length&&H.length>0,onChange:he,className:"w-4 h-4 rounded"})}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"M n"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Loi"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:H.map(U=>{var ce,Q,oe,X;return t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[(n==="cap1"||n==="cap2")&&t.jsx("td",{className:"px-4 py-4",children:t.jsx("input",{type:"checkbox",checked:y.has(U.id),onChange:()=>G(U.id),className:"w-4 h-4 rounded"})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:U.maDon})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:(ce=U.nhanVien)==null?void 0:ce.hoTen}),t.jsx("p",{className:"text-sm text-gray-500",children:(Q=U.nhanVien)==null?void 0:Q.maNhanVien})]})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{children:Bl(((oe=U.loaiYeuCau)==null?void 0:oe.maLoai)||"")}),t.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:(X=U.loaiYeuCau)==null?void 0:X.tenLoai})]})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300",children:ee(U.ngayYeuCau)}),t.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300",children:[U.gioBatDau&&U.gioKetThuc?`${U.gioBatDau} - ${U.gioKetThuc}`:U.gioBatDau||"-",U.soGio&&t.jsxs("span",{className:"ml-2 text-blue-600 dark:text-blue-400",children:["(",U.soGio,"h)"]})]}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${B0(U.trangThai)}`,children:R0(U.trangThai)})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx("button",{onClick:()=>s(U),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Xem chi tit",children:t.jsx(ii,{className:"w-4 h-4"})}),["CHO_DUYET_1","CHO_DUYET_2"].includes(U.trangThai)&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>z(U),className:"p-2 text-gray-500 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Duyt",children:t.jsx(Ma,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>o(U),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"T chi",children:t.jsx(ho,{className:"w-4 h-4"})})]}),n==="tat-ca"&&!["HUY"].includes(U.trangThai)&&t.jsx("button",{onClick:()=>{u(U),g(U.trangThai==="TU_CHOI")},className:"p-2 text-gray-500 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg transition-colors",title:"Override",children:t.jsx(na,{className:"w-4 h-4"})})]})})]},U.id)})})]})}),(_==null?void 0:_.pagination)&&_.pagination.totalPages>1&&t.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[t.jsxs("span",{className:"text-sm text-gray-500",children:["Trang ",_.pagination.page," / ",_.pagination.totalPages," (",_.pagination.total," n)"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>T({...C,page:C.page-1}),disabled:C.page<=1,className:"p-2 border rounded-lg disabled:opacity-50",children:t.jsx(Rr,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>T({...C,page:C.page+1}),disabled:C.page>=_.pagination.totalPages,className:"p-2 border rounded-lg disabled:opacity-50",children:t.jsx(aa,{className:"w-4 h-4"})})]})]})]}),r&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Chi tit n ",r.maDon]}),t.jsx("button",{onClick:()=>s(null),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(hn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Nhn vin"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[(F=r.nhanVien)==null?void 0:F.hoTen," (",(I=r.nhanVien)==null?void 0:I.maNhanVien,")"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Phng ban"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:(O=r.phongBan)==null?void 0:O.tenPhongBan})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Loi yu cu"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[Bl(((V=r.loaiYeuCau)==null?void 0:V.maLoai)||"")," ",(te=r.loaiYeuCau)==null?void 0:te.tenLoai]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Trng thi"}),t.jsx("span",{className:`inline-block px-2 py-1 text-xs font-medium rounded-full ${B0(r.trangThai)}`,children:R0(r.trangThai)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Ngy yu cu"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:ee(r.ngayYeuCau)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Thi gian"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[r.gioBatDau&&r.gioKetThuc?`${r.gioBatDau} - ${r.gioKetThuc}`:r.gioBatDau||"-",r.soGio&&` (${r.soGio}h)`]})]})]}),r.diaDiem&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"a im"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:r.diaDiem})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"L do"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:r.lyDo})]}),r.lyDoTuChoi&&t.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[t.jsx("p",{className:"text-sm text-red-600 font-medium",children:"L do t chi"}),t.jsx("p",{className:"text-red-700",children:r.lyDoTuChoi})]})]}),["CHO_DUYET_1","CHO_DUYET_2"].includes(r.trangThai)&&t.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{o(r),s(null)},className:"px-4 py-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50",children:"T chi"}),t.jsx("button",{onClick:()=>{z(r),s(null)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Duyt"})]})]})}),l&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md",children:[t.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["T chi n ",l.maDon]})}),t.jsxs("div",{className:"p-6",children:[t.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:["T chi yu cu ca ",t.jsx("strong",{children:(pe=l.nhanVien)==null?void 0:pe.hoTen}),"?"]}),t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["L do t chi ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("textarea",{value:h,onChange:U=>m(U.target.value),placeholder:"Nhp l do t chi...",rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none"})]}),t.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{o(null),m("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:fe,disabled:W.isPending||R.isPending,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:"T chi"})]})]})}),d&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md",children:[t.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Override n ",d.maDon]})}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"radio",checked:b,onChange:()=>g(!0),className:"w-4 h-4"}),t.jsx("span",{className:"text-green-600 font-medium",children:"Override Duyt"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"radio",checked:!b,onChange:()=>g(!1),className:"w-4 h-4"}),t.jsx("span",{className:"text-red-600 font-medium",children:"Override T chi"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["L do override ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("textarea",{value:f,onChange:U=>p(U.target.value),placeholder:"Nhp l do override...",rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none"})]})]}),t.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{u(null),p("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:ae,disabled:M.isPending,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:opacity-50",children:"Override"})]})]})})]})}const Yi={layDanhSach:async e=>(await me.get("/thong-bao",{params:e})).data,demChuaDoc:async()=>(await me.get("/thong-bao/chua-doc")).data,danhDauDaDoc:async e=>(await me.put(`/thong-bao/${e}/da-doc`)).data,danhDauTatCaDaDoc:async()=>(await me.post("/thong-bao/da-doc-tat-ca")).data},_T=e=>{const n=new Date(e),r=new Date().getTime()-n.getTime(),s=Math.floor(r/6e4),l=Math.floor(r/36e5),o=Math.floor(r/864e5);return s<1?"Va xong":s<60?`${s} pht trc`:l<24?`${l} gi trc`:o<7?`${o} ngy trc`:n.toLocaleDateString("vi-VN")},ET=e=>{switch(e){case"YEU_CAU_MOI":return{icon:"",color:"text-blue-600"};case"YEU_CAU_DA_DUYET":return{icon:"",color:"text-green-600"};case"YEU_CAU_TU_CHOI":return{icon:"",color:"text-red-600"};case"NGHI_PHEP_MOI":return{icon:"",color:"text-blue-600"};case"NGHI_PHEP_DA_DUYET":return{icon:"",color:"text-green-600"};case"NGHI_PHEP_TU_CHOI":return{icon:"",color:"text-red-600"};case"LICH_PHAN_CA":return{icon:"",color:"text-purple-600"};case"PHIEU_LUONG":return{icon:"",color:"text-green-600"};case"HE_THONG":default:return{icon:"",color:"text-gray-600"}}};function CV({className:e=""}){var b;const n=xr(),a=Rt(),[r,s]=E.useState(!1),l=E.useRef(null),{data:o}=Ie({queryKey:["thong-bao","chua-doc"],queryFn:()=>Yi.demChuaDoc(),refetchInterval:3e4}),{data:d,isLoading:u}=Ie({queryKey:["thong-bao","list",{limit:10}],queryFn:()=>Yi.layDanhSach({limit:10}),enabled:r}),h=De({mutationFn:g=>Yi.danhDauDaDoc(g),onSuccess:()=>{a.invalidateQueries({queryKey:["thong-bao"]})}}),m=De({mutationFn:()=>Yi.danhDauTatCaDaDoc(),onSuccess:()=>{a.invalidateQueries({queryKey:["thong-bao"]})}});E.useEffect(()=>{const g=y=>{l.current&&!l.current.contains(y.target)&&s(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]);const f=g=>{g.daDoc||h.mutate(g.id),g.link&&(n(g.link),s(!1))},p=(o==null?void 0:o.chuaDoc)||0;return t.jsxs("div",{className:`relative ${e}`,ref:l,children:[t.jsxs("button",{onClick:()=>s(!r),className:"relative p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"Thng bo",children:[t.jsx(bc,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"}),p>0&&t.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] flex items-center justify-center bg-red-500 text-white text-xs font-bold rounded-full px-1",children:p>99?"99+":p})]}),r&&t.jsxs("div",{className:"absolute right-0 top-full mt-2 w-80 max-h-[70vh] bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 overflow-hidden z-50 animate-scale-in",children:[t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Thng bo"}),t.jsxs("div",{className:"flex items-center gap-2",children:[p>0&&t.jsxs("button",{onClick:()=>m.mutate(),className:"text-xs text-blue-600 hover:text-blue-700 flex items-center gap-1",disabled:m.isPending,children:[t.jsx(nj,{className:"w-3 h-3"}),"c tt c"]}),t.jsx("button",{onClick:()=>s(!1),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:t.jsx(hn,{className:"w-4 h-4 text-gray-500"})})]})]}),t.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:u?t.jsx("div",{className:"p-4 text-center text-gray-500",children:"ang ti..."}):(b=d==null?void 0:d.data)!=null&&b.length?d.data.map(g=>{const{icon:y,color:N}=ET(g.loaiThongBao);return t.jsx("button",{onClick:()=>f(g),className:`w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors border-b border-gray-100 dark:border-gray-700 last:border-0 ${g.daDoc?"":"bg-blue-50/50 dark:bg-blue-900/20"}`,children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx("span",{className:`text-xl ${N}`,children:y}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsx("p",{className:`text-sm font-medium truncate ${g.daDoc?"text-gray-600 dark:text-gray-400":"text-gray-900 dark:text-white"}`,children:g.tieuDe}),!g.daDoc&&t.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-1.5"})]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5 line-clamp-2",children:g.noiDung}),t.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:_T(g.ngayTao)})]})]})},g.id)}):t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx(bc,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),t.jsx("p",{children:"Khng c thng bo"})]})}),d&&d.total>10&&t.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 p-2",children:t.jsxs("button",{onClick:()=>{n("/thong-bao"),s(!1)},className:"w-full text-center text-sm text-blue-600 hover:text-blue-700 py-2",children:["Xem tt c (",d.total,")"]})})]})]})}const Pf=[{id:"home",label:"Trang ch",icon:G0,path:"/portal"},{id:"schedule",label:"Lch lm",icon:Ot,path:"/portal/lich-lam"},{id:"attendance",label:"Chm cng",icon:nn,path:"/portal/cham-cong"},{id:"requests",label:"Yu cu",icon:ua,path:"/portal/yeu-cau"},{id:"profile",label:"C nhn",icon:no,path:"/portal/ca-nhan"}];function SV(){var h,m;const e=Cs(),n=xr(),{user:a,dangXuat:r}=ns(),[s,l]=E.useState(!1),o=((h=Pf.find(f=>e.pathname===f.path))==null?void 0:h.id)||"home",d=()=>{const f=Pf.find(p=>e.pathname.startsWith(p.path));return(f==null?void 0:f.label)||"Portal"},u=async()=>{await r(),n("/dang-nhap")};return t.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex flex-col",children:[t.jsx("header",{className:"sticky top-0 z-40 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-between max-w-lg mx-auto",children:[e.pathname!=="/portal"?t.jsx("button",{onClick:()=>n(-1),className:"p-2 -ml-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(Rr,{className:"w-5 h-5"})}):t.jsx("div",{className:"w-9"}),t.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:d()}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(CV,{}),t.jsx("button",{onClick:()=>l(!s),className:"p-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(D_,{className:"w-5 h-5"})})]})]})}),s&&t.jsx("div",{className:"fixed inset-0 z-50 bg-black/50",onClick:()=>l(!1),children:t.jsxs("div",{className:"absolute right-0 top-0 h-full w-64 bg-white dark:bg-gray-800 shadow-xl",onClick:f=>f.stopPropagation(),children:[t.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[t.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:"Menu"}),t.jsx("button",{onClick:()=>l(!1),className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(hn,{className:"w-5 h-5"})})]}),t.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-semibold",children:((m=a==null?void 0:a.hoTen)==null?void 0:m[0])||"U"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a==null?void 0:a.hoTen}),t.jsx("p",{className:"text-sm text-gray-500",children:a==null?void 0:a.email})]})]})}),t.jsxs("nav",{className:"p-2",children:[t.jsxs("button",{onClick:()=>n("/"),className:"w-full flex items-center gap-3 px-4 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:[t.jsx(G0,{className:"w-5 h-5"}),t.jsx("span",{children:"V trang Admin"})]}),t.jsxs("button",{onClick:u,className:"w-full flex items-center gap-3 px-4 py-3 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg",children:[t.jsx(Xp,{className:"w-5 h-5"}),t.jsx("span",{children:"ng xut"})]})]})]})}),t.jsx("main",{className:"flex-1 overflow-y-auto pb-20",children:t.jsx("div",{className:"max-w-lg mx-auto px-4 py-4",children:t.jsx(G2,{})})}),t.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-40 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 safe-area-pb",children:t.jsx("div",{className:"max-w-lg mx-auto flex items-center justify-around h-16",children:Pf.map(f=>{const p=f.icon,b=o===f.id;return t.jsxs("button",{onClick:()=>n(f.path),className:`flex flex-col items-center justify-center flex-1 h-full transition-colors ${b?"text-blue-600 dark:text-blue-400":"text-gray-500 dark:text-gray-400"}`,children:[t.jsx(p,{className:`w-5 h-5 mb-1 ${b?"stroke-[2.5]":""}`}),t.jsx("span",{className:`text-xs ${b?"font-medium":""}`,children:f.label})]},f.id)})})})]})}const Mc={getDashboard:async()=>(await me.get("/employee-portal/dashboard")).data,getLichLamViec:async e=>(await me.get("/employee-portal/lich-lam-viec",{params:e})).data,getChamCong:async e=>(await me.get("/employee-portal/cham-cong",{params:e})).data,getPhieuLuong:async e=>(await me.get("/employee-portal/phieu-luong",{params:e})).data,getChiTietPhieuLuong:async e=>(await me.get(`/employee-portal/phieu-luong/${e}`)).data,getSoDuPhep:async()=>(await me.get("/employee-portal/so-du-phep")).data,getHoSo:async()=>(await me.get("/employee-portal/ho-so")).data,checkIn:async()=>(await me.post("/employee-portal/check-in")).data,checkOut:async()=>(await me.post("/employee-portal/check-out")).data},_V=e=>["CN","T2","T3","T4","T5","T6","T7"][e]||"",EV=e=>["Ch nht","Th hai","Th ba","Th t","Th nm","Th su","Th by"][e]||"",H0=e=>{if(!e)return"--:--";const n=new Date(e);return`${String(n.getHours()).padStart(2,"0")}:${String(n.getMinutes()).padStart(2,"0")}`},Lf=e=>new Intl.NumberFormat("vi-VN").format(e)+"",DV="tinh_luong_auth",Hn=Jt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});Hn.interceptors.request.use(e=>{const n=localStorage.getItem(DV);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const ur={layDanhSachGeofence:e=>Hn.get("/anti-fraud/geofence",{params:e}).then(n=>n.data),layGeofence:e=>Hn.get(`/anti-fraud/geofence/${e}`).then(n=>n.data),taoGeofence:e=>Hn.post("/anti-fraud/geofence",e).then(n=>n.data),capNhatGeofence:(e,n)=>Hn.put(`/anti-fraud/geofence/${e}`,n).then(a=>a.data),xoaGeofence:e=>Hn.delete(`/anti-fraud/geofence/${e}`).then(n=>n.data),layGeofenceCuaToi:()=>Hn.get("/anti-fraud/my-geofence").then(e=>e.data),gpsCheckin:e=>Hn.post("/anti-fraud/gps-checkin",e).then(n=>n.data),layLichSuGPS:e=>Hn.get("/anti-fraud/gps-logs",{params:e}).then(n=>n.data),layLichSuGPSCuaToi:e=>Hn.get("/anti-fraud/my-gps-logs",{params:e}).then(n=>n.data),thongKeGPS:(e,n,a)=>Hn.get("/anti-fraud/thong-ke",{params:{tuNgay:e,denNgay:n,phongBanId:a}}).then(r=>r.data),layDanhSachThietBi:e=>Hn.get("/anti-fraud/devices",{params:e}).then(n=>n.data),layThietBiNhanVien:e=>Hn.get(`/anti-fraud/devices/${e}`).then(n=>n.data),layThietBiCuaToi:()=>Hn.get("/anti-fraud/my-device").then(e=>e.data),kiemTraDevice:e=>Hn.post("/anti-fraud/check-device",{deviceId:e}).then(n=>n.data),bindDevice:e=>Hn.post("/anti-fraud/bind-device",e).then(n=>n.data),resetDevice:e=>Hn.post("/anti-fraud/reset-device",e).then(n=>n.data),blockDevice:(e,n)=>Hn.post(`/anti-fraud/block-device/${e}`,{lyDo:n}).then(a=>a.data),layLichSuThietBi:e=>Hn.get("/anti-fraud/device-history",{params:e}).then(n=>n.data)},DT=()=>new Promise((e,n)=>{if(!navigator.geolocation){n(new Error("Trnh duyt khng h tr GPS"));return}navigator.geolocation.getCurrentPosition(a=>{e({viDo:a.coords.latitude,kinhDo:a.coords.longitude,doChinhXacMet:Math.round(a.coords.accuracy)})},a=>{switch(a.code){case a.PERMISSION_DENIED:n(new Error("Bn  t chi quyn truy cp GPS"));break;case a.POSITION_UNAVAILABLE:n(new Error("Khng th xc nh v tr"));break;case a.TIMEOUT:n(new Error("Qu thi gian ch GPS"));break;default:n(new Error("Li GPS khng xc nh"))}},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),FV=()=>{const e="tinh_luong_device_id";let n=localStorage.getItem(e);return n||(n=`WEB-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,localStorage.setItem(e,n)),n};function AV(){var N,C,T,S,k,_;const e=xr(),n=Rt(),[a,r]=E.useState(null),[s,l]=E.useState("idle"),[o,d]=E.useState(null),{data:u,isLoading:h}=Ie({queryKey:["employee-portal","dashboard"],queryFn:()=>Mc.getDashboard(),refetchInterval:6e4}),{data:m}=Ie({queryKey:["my-geofences"],queryFn:()=>ur.layGeofenceCuaToi()}),f=De({mutationFn:async P=>{l("getting");let j={};const A=m==null?void 0:m.some(L=>L.batBuocGPS);if(A||m!=null&&m.length)try{j=await DT(),l("success")}catch(L){if(A)throw l("error"),new Error(L.message||"Khng th ly v tr GPS");l("idle")}return ur.gpsCheckin({loaiChamCong:P,viDo:j.viDo,kinhDo:j.kinhDo,doChinhXacMet:j.doChinhXacMet,deviceId:FV()})},onSuccess:P=>{var j;r(null),l("idle"),d({trongVung:P.trongVung,khoangCachMet:P.khoangCachMet,geofenceName:(j=P.geofence)==null?void 0:j.tenDiaDiem}),n.invalidateQueries({queryKey:["employee-portal","dashboard"]})},onError:P=>{var j,A;l("error"),r(((A=(j=P.response)==null?void 0:j.data)==null?void 0:A.message)||P.message||"Li khi chm cng")}}),p=f.isPending,b=()=>{var P;r(null),d(null),((P=u==null?void 0:u.chamCongHomNay)==null?void 0:P.trangThai)==="DA_VAO"?f.mutate("CHECK_OUT"):f.mutate("CHECK_IN")};if(h)return t.jsx("div",{className:"space-y-4",children:[1,2,3].map(P=>t.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"},P))});const y=(()=>{var j;const P=(j=u==null?void 0:u.chamCongHomNay)==null?void 0:j.trangThai;return P==="DA_RA"?{label:" ra",color:"text-green-600",bg:"bg-green-100 dark:bg-green-900/30"}:P==="DA_VAO"?{label:" vo",color:"text-blue-600",bg:"bg-blue-100 dark:bg-blue-900/30"}:{label:"Cha vo",color:"text-gray-500",bg:"bg-gray-100 dark:bg-gray-700"}})();return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 rounded-2xl p-5 text-white shadow-lg",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-blue-100 text-sm",children:"Xin cho,"}),t.jsx("h2",{className:"text-xl font-bold mt-1",children:u==null?void 0:u.nhanVien.hoTen}),t.jsxs("p",{className:"text-blue-200 text-sm mt-1",children:[u==null?void 0:u.nhanVien.chucVu,"  ",u==null?void 0:u.nhanVien.phongBan]})]}),t.jsx("div",{className:"w-12 h-12 rounded-full bg-white/20 flex items-center justify-center text-xl font-bold",children:((N=u==null?void 0:u.nhanVien.hoTen)==null?void 0:N[0])||"N"})]}),u!=null&&u.caHomNay?t.jsxs("div",{className:"mt-4 bg-white/10 rounded-xl p-3 flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:u.caHomNay.mauHienThi||"#3B82F6"},children:t.jsx(nn,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm text-blue-100",children:"Ca hm nay"}),t.jsxs("p",{className:"font-semibold",children:[u.caHomNay.tenCa," (",u.caHomNay.gioVao," - ",u.caHomNay.gioRa,")"]})]})]}):t.jsxs("div",{className:"mt-4 bg-white/10 rounded-xl p-3 flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/20 flex items-center justify-center",children:t.jsx(Ot,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-blue-100",children:"Hm nay"}),t.jsx("p",{className:"font-semibold",children:"Khng c ca lm vic"})]})]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-5 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:`w-14 h-14 rounded-xl ${y.bg} flex items-center justify-center`,children:((C=u==null?void 0:u.chamCongHomNay)==null?void 0:C.trangThai)==="DA_RA"?t.jsx(Ma,{className:`w-7 h-7 ${y.color}`}):((T=u==null?void 0:u.chamCongHomNay)==null?void 0:T.trangThai)==="DA_VAO"?t.jsx(Xp,{className:`w-7 h-7 ${y.color}`}):t.jsx(E_,{className:`w-7 h-7 ${y.color}`})}),t.jsxs("div",{children:[t.jsx("p",{className:`text-sm ${y.color} font-medium`,children:y.label}),((S=u==null?void 0:u.chamCongHomNay)==null?void 0:S.gioVao)&&t.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:["Vo: ",H0(u.chamCongHomNay.gioVao),u.chamCongHomNay.gioRa&&`  Ra: ${H0(u.chamCongHomNay.gioRa)}`]})]})]}),((k=u==null?void 0:u.chamCongHomNay)==null?void 0:k.trangThai)!=="DA_RA"&&t.jsx("button",{onClick:b,disabled:p,className:`px-4 py-2 rounded-xl font-medium transition-colors flex items-center gap-2 ${p?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} text-white`,children:p?t.jsxs(t.Fragment,{children:[t.jsx(In,{className:"w-4 h-4 animate-spin"}),"ang x l..."]}):((_=u==null?void 0:u.chamCongHomNay)==null?void 0:_.trangThai)==="DA_VAO"?"Check-out":"Check-in"})]}),a&&t.jsxs("p",{className:"text-sm text-red-500 mt-3 flex items-center gap-1",children:[t.jsx(na,{className:"w-4 h-4"}),a]}),o&&t.jsxs("div",{className:`text-sm mt-3 flex items-center gap-2 ${o.trongVung?"text-green-600":"text-yellow-600"}`,children:[t.jsx(qd,{className:"w-4 h-4"}),o.trongVung?t.jsxs("span",{children:[' Trong vng "',o.geofenceName,'"',o.khoangCachMet&&` (cch ${o.khoangCachMet}m)`]}):o.khoangCachMet?t.jsxs("span",{children:[" Ngoi vng cho php (cch ",o.khoangCachMet,"m)"]}):null]}),s==="getting"&&t.jsxs("p",{className:"text-sm text-blue-500 mt-3 flex items-center gap-2",children:[t.jsx(Nc,{className:"w-4 h-4 animate-pulse"}),"ang ly v tr GPS..."]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[t.jsxs("button",{onClick:()=>e("/portal/yeu-cau"),className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700 text-center",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center mx-auto",children:t.jsx(ua,{className:"w-5 h-5 text-orange-600"})}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-2",children:(u==null?void 0:u.thongKe.soDonChoDuyet)||0}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"n ch duyt"})]}),t.jsxs("button",{onClick:()=>e("/portal/ca-nhan"),className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700 text-center",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 dark:bg-green-900/30 flex items-center justify-center mx-auto",children:t.jsx(Ot,{className:"w-5 h-5 text-green-600"})}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-2",children:(u==null?void 0:u.thongKe.soNgayPhepConLai)||0}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Php cn li"})]}),t.jsxs("button",{onClick:()=>e("/portal/cham-cong"),className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700 text-center",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center mx-auto",children:t.jsx(m0,{className:"w-5 h-5 text-blue-600"})}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-2",children:(u==null?void 0:u.thongKe.soNgayCongThang)||0}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Ngy cng"})]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-5 py-3 border-b border-gray-200 dark:border-gray-700",children:t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Thao tc nhanh"})}),t.jsx("div",{children:[{label:"Xem lch lm vic",icon:Ot,path:"/portal/lich-lam",color:"text-blue-600"},{label:"To n yu cu",icon:ua,path:"/portal/yeu-cau",color:"text-orange-600"},{label:"Xem phiu lng",icon:m0,path:"/portal/ca-nhan",color:"text-green-600"}].map(P=>t.jsxs("button",{onClick:()=>e(P.path),className:"w-full flex items-center justify-between px-5 py-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(P.icon,{className:`w-5 h-5 ${P.color}`}),t.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:P.label})]}),t.jsx(aa,{className:"w-5 h-5 text-gray-400"})]},P.path))})]})]})}function PV(){const[e,n]=E.useState(0),a=m=>{const f=new Date,p=f.getDay(),b=new Date(f);b.setDate(f.getDate()-(p===0?6:p-1)+m*7),b.setHours(0,0,0,0);const g=new Date(b);return g.setDate(b.getDate()+6),{monday:b,sunday:g}},{monday:r,sunday:s}=a(e),{data:l,isLoading:o}=Ie({queryKey:["employee-portal","lich-lam-viec",r.toISOString()],queryFn:()=>Mc.getLichLamViec({tuNgay:r.toISOString().split("T")[0],denNgay:s.toISOString().split("T")[0]})}),d=()=>{const m=f=>`${f.getDate()}/${f.getMonth()+1}`;return`${m(r)} - ${m(s)}`},u=m=>{const f=new Date().toISOString().split("T")[0];return m===f},h=m=>{const f=new Date;return f.setHours(0,0,0,0),new Date(m)<f};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("button",{onClick:()=>n(e-1),className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(Rr,{className:"w-5 h-5"})}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:d()}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e===0?"Tun ny":e>0?`+${e} tun`:`${e} tun`})]}),t.jsx("button",{onClick:()=>n(e+1),className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(aa,{className:"w-5 h-5"})})]}),e!==0&&t.jsx("button",{onClick:()=>n(0),className:"w-full mt-3 py-2 text-sm text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg font-medium",children:"V tun hin ti"})]}),o?t.jsx("div",{className:"space-y-3",children:[1,2,3,4,5,6,7].map(m=>t.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"},m))}):t.jsx("div",{className:"space-y-3",children:l==null?void 0:l.map(m=>t.jsx("div",{className:`bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border transition-all ${u(m.ngay)?"border-blue-500 ring-2 ring-blue-100 dark:ring-blue-900/50":"border-gray-200 dark:border-gray-700"} ${h(m.ngay)&&!u(m.ngay)?"opacity-60":""}`,children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsxs("div",{className:`w-14 h-14 rounded-xl flex flex-col items-center justify-center ${u(m.ngay)?"bg-blue-600 text-white":m.thuTrongTuan===0||m.thuTrongTuan===6?"bg-gray-100 dark:bg-gray-700 text-gray-500":"bg-gray-50 dark:bg-gray-700/50 text-gray-700 dark:text-gray-300"}`,children:[t.jsx("span",{className:"text-xs font-medium",children:_V(m.thuTrongTuan)}),t.jsx("span",{className:"text-lg font-bold",children:new Date(m.ngay).getDate()})]}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[EV(m.thuTrongTuan),", ",new Date(m.ngay).toLocaleDateString("vi-VN")]}),m.nghiPhep?t.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 rounded-lg bg-green-100 dark:bg-green-900/30 flex items-center justify-center",children:t.jsx(v_,{className:"w-4 h-4 text-green-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-green-600",children:m.nghiPhep.loaiNghi}),t.jsx("p",{className:"text-xs text-gray-500",children:m.nghiPhep.trangThai})]})]}):m.ca?t.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:m.ca.mauHienThi||"#3B82F6"},children:t.jsx(m0,{className:"w-4 h-4 text-white"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:m.ca.tenCa}),t.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[m.ca.gioVao," - ",m.ca.gioRa]})]})]}):t.jsxs("div",{className:"mt-2 flex items-center gap-2 text-gray-400",children:[t.jsx(Ot,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"Khng c ca lm vic"})]})]})]})},m.ngay))})]})}function LV(){const e=new Date,[n,a]=E.useState(e.getMonth()+1),[r,s]=E.useState(e.getFullYear()),{data:l,isLoading:o}=Ie({queryKey:["employee-portal","cham-cong",n,r],queryFn:()=>Mc.getChamCong({thang:n,nam:r})}),d=()=>{n===1?(a(12),s(r-1)):a(n-1)},u=()=>{n===12?(a(1),s(r+1)):a(n+1)},h=p=>{switch(p){case"DU_CONG":return{text:" cng",color:"text-green-600 bg-green-50 dark:bg-green-900/30"};case"DI_TRE":return{text:"i tr",color:"text-yellow-600 bg-yellow-50 dark:bg-yellow-900/30"};case"VE_SOM":return{text:"V sm",color:"text-yellow-600 bg-yellow-50 dark:bg-yellow-900/30"};case"NGHI_KHONG_PHEP":return{text:"Ngh K.Php",color:"text-red-600 bg-red-50 dark:bg-red-900/30"};case"NGHI_CO_PHEP":return{text:"Ngh php",color:"text-blue-600 bg-blue-50 dark:bg-blue-900/30"};default:return{text:p,color:"text-gray-600 bg-gray-50 dark:bg-gray-700"}}},m={duCong:(l==null?void 0:l.filter(p=>p.trangThai==="DU_CONG").length)||0,diTre:(l==null?void 0:l.filter(p=>p.trangThai==="DI_TRE").length)||0,veSom:(l==null?void 0:l.filter(p=>p.trangThai==="VE_SOM").length)||0,nghiKhongPhep:(l==null?void 0:l.filter(p=>p.trangThai==="NGHI_KHONG_PHEP").length)||0},f=p=>{const b=new Date().toISOString().split("T")[0];return p===b};return t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("button",{onClick:d,className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(Rr,{className:"w-5 h-5"})}),t.jsx("div",{className:"text-center",children:t.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:["Thng ",n,"/",r]})}),t.jsx("button",{onClick:u,className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(aa,{className:"w-5 h-5"})})]})}),t.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[t.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 rounded-xl p-3 text-center",children:[t.jsx("p",{className:"text-xl font-bold text-green-600",children:m.duCong}),t.jsx("p",{className:"text-xs text-green-600",children:" cng"})]}),t.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/30 rounded-xl p-3 text-center",children:[t.jsx("p",{className:"text-xl font-bold text-yellow-600",children:m.diTre}),t.jsx("p",{className:"text-xs text-yellow-600",children:"i tr"})]}),t.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/30 rounded-xl p-3 text-center",children:[t.jsx("p",{className:"text-xl font-bold text-orange-600",children:m.veSom}),t.jsx("p",{className:"text-xs text-orange-600",children:"V sm"})]}),t.jsxs("div",{className:"bg-red-50 dark:bg-red-900/30 rounded-xl p-3 text-center",children:[t.jsx("p",{className:"text-xl font-bold text-red-600",children:m.nghiKhongPhep}),t.jsx("p",{className:"text-xs text-red-600",children:"K.Php"})]})]}),o?t.jsx("div",{className:"space-y-3",children:[1,2,3,4,5].map(p=>t.jsx("div",{className:"h-16 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"},p))}):l&&l.length>0?t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:l.map((p,b)=>{const g=h(p.trangThai);return t.jsxs("div",{className:`flex items-center gap-4 px-4 py-3 ${b<l.length-1?"border-b border-gray-100 dark:border-gray-700":""} ${f(p.ngay)?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[t.jsxs("div",{className:"w-12 text-center",children:[t.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:new Date(p.ngay).getDate()}),t.jsx("p",{className:"text-xs text-gray-500",children:["CN","T2","T3","T4","T5","T6","T7"][new Date(p.ngay).getDay()]})]}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Vo:"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:H0(p.gioVaoThucTe)}),t.jsx("span",{className:"text-gray-400",children:""}),t.jsx("span",{className:"text-gray-500",children:"Ra:"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:H0(p.gioRaThucTe)})]}),p.ca&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Ca: ",p.ca.tenCa]})]}),t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-lg ${g.color}`,children:g.text})]},p.ngay)})}):t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx(nn,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Cha c d liu chm cng"})]})]})}const Of=[{value:"OT",label:"Lm thm gi (OT)",icon:""},{value:"DI_TRE",label:"i tr",icon:""},{value:"VE_SOM",label:"V sm",icon:""},{value:"CONG_TAC",label:"Cng tc",icon:""}];function OV(){const[e,n]=E.useState(!1),[a,r]=E.useState("ALL"),s=Rt(),[l,o]=E.useState({loai:"OT",ngay:new Date().toISOString().split("T")[0],soGio:1,lyDo:""}),{data:d,isLoading:u}=Ie({queryKey:["employee-portal","yeu-cau",a],queryFn:async()=>{const g={};return a!=="ALL"&&(g.trangThai=a),(await me.get("/yeu-cau/my-requests",{params:g})).data.data||[]}}),h=De({mutationFn:async g=>(await me.post("/yeu-cau",g)).data,onSuccess:()=>{s.invalidateQueries({queryKey:["employee-portal","yeu-cau"]}),n(!1),o({loai:"OT",ngay:new Date().toISOString().split("T")[0],soGio:1,lyDo:""})}}),m=g=>{switch(g){case"DA_DUYET":return{text:" duyt",color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",icon:Lr};case"TU_CHOI":return{text:"T chi",color:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",icon:hn};case"CHO_DUYET":default:return{text:"Ch duyt",color:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",icon:nn}}},f=g=>{var y;return((y=Of.find(N=>N.value===g))==null?void 0:y.label)||g},p=g=>{var y;return((y=Of.find(N=>N.value===g))==null?void 0:y.icon)||""},b=g=>{if(g.preventDefault(),!l.lyDo.trim()){alert("Vui lng nhp l do");return}h.mutate(l)};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("button",{onClick:()=>n(!0),className:"w-full flex items-center justify-center gap-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 rounded-2xl font-medium shadow-md",children:[t.jsx(St,{className:"w-5 h-5"}),"To yu cu mi"]}),t.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:[{value:"ALL",label:"Tt c"},{value:"CHO_DUYET",label:"Ch duyt"},{value:"DA_DUYET",label:" duyt"},{value:"TU_CHOI",label:"T chi"}].map(g=>t.jsx("button",{onClick:()=>r(g.value),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors ${a===g.value?"bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300"}`,children:g.label},g.value))}),u?t.jsx("div",{className:"space-y-3",children:[1,2,3].map(g=>t.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"},g))}):d&&d.length>0?t.jsx("div",{className:"space-y-3",children:d.map(g=>{const y=m(g.trangThai),N=y.icon;return t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"text-2xl",children:p(g.loai)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:f(g.loai)}),t.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${y.color}`,children:[t.jsx(N,{className:"w-3 h-3"}),y.text]})]}),t.jsxs("p",{className:"text-sm text-gray-500 mb-1",children:[new Date(g.ngay).toLocaleDateString("vi-VN"),"  ",g.soGio," gi"]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:g.lyDo})]}),t.jsx(aa,{className:"w-5 h-5 text-gray-400"})]})},g.id)})}):t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx(uo,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Cha c yu cu no"})]}),e&&t.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-end justify-center",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 w-full max-w-lg rounded-t-3xl p-6 pb-10 animate-slide-up",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"To yu cu mi"}),t.jsx("button",{onClick:()=>n(!1),className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(hn,{className:"w-5 h-5"})})]}),t.jsxs("form",{onSubmit:b,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Loi yu cu"}),t.jsx("div",{className:"grid grid-cols-2 gap-2",children:Of.map(g=>t.jsxs("button",{type:"button",onClick:()=>o({...l,loai:g.value}),className:`flex items-center gap-2 px-4 py-3 rounded-xl border-2 transition-colors ${l.loai===g.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600"}`,children:[t.jsx("span",{className:"text-xl",children:g.icon}),t.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:g.label.replace(" (OT)","")})]},g.value))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Ngy"}),t.jsx("input",{type:"date",value:l.ngay,onChange:g=>o({...l,ngay:g.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"S gi"}),t.jsx("input",{type:"number",min:"0.5",max:"12",step:"0.5",value:l.soGio,onChange:g=>o({...l,soGio:parseFloat(g.target.value)}),className:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"L do"}),t.jsx("textarea",{value:l.lyDo,onChange:g=>o({...l,lyDo:g.target.value}),rows:3,placeholder:"Nhp l do yu cu...",className:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none"})]}),t.jsx("button",{type:"submit",disabled:h.isPending,className:"w-full py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl font-medium disabled:opacity-50",children:h.isPending?"ang gi...":"Gi yu cu"})]})]})})]})}function IV(){const[e,n]=E.useState("ho-so");return t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-1 shadow-sm border border-gray-200 dark:border-gray-700",children:t.jsx("div",{className:"flex",children:[{id:"ho-so",label:"H s",icon:no},{id:"phieu-luong",label:"Phiu lng",icon:ua},{id:"so-du-phep",label:"S d php",icon:Ot}].map(a=>t.jsxs("button",{onClick:()=>n(a.id),className:`flex-1 flex items-center justify-center gap-1.5 py-2.5 rounded-xl text-sm font-medium transition-colors ${e===a.id?"bg-blue-500 text-white":"text-gray-600 dark:text-gray-300"}`,children:[t.jsx(a.icon,{className:"w-4 h-4"}),a.label]},a.id))})}),e==="ho-so"&&t.jsx(MV,{}),e==="phieu-luong"&&t.jsx(RV,{}),e==="so-du-phep"&&t.jsx(BV,{})]})}function MV(){var a;const{data:e,isLoading:n}=Ie({queryKey:["employee-portal","ho-so"],queryFn:()=>Mc.getHoSo()});return n?t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"}),t.jsx("div",{className:"h-48 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"})]}):e?t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl p-6 text-white",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-16 h-16 bg-white/20 backdrop-blur rounded-full flex items-center justify-center text-2xl font-bold",children:e.hoTen.charAt(0)}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold",children:e.hoTen}),t.jsx("p",{className:"text-blue-100",children:e.maNhanVien}),e.chucVu&&t.jsx("p",{className:"text-sm text-blue-200 mt-1",children:e.chucVu})]})]})}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx(Sd,{icon:x_,label:"Phng ban",value:typeof e.phongBan=="object"?(a=e.phongBan)==null?void 0:a.tenPhongBan:e.phongBan||"Cha c"}),t.jsx(Sd,{icon:Qp,label:"Email",value:e.email||"Cha cp nht"}),t.jsx(Sd,{icon:O_,label:"in thoi",value:e.soDienThoai||"Cha cp nht"}),t.jsx(Sd,{icon:Ot,label:"Ngy vo lm",value:e.ngayVaoLam?new Date(e.ngayVaoLam).toLocaleDateString("vi-VN"):"Cha c"}),t.jsx(Sd,{icon:N_,label:"STK ngn hng",value:e.soTaiKhoan||"Cha cp nht",last:!0})]}),e.nganHang&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx(V_,{className:"w-5 h-5 text-blue-500"}),t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Thng tin ngn hng"})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("p",{className:"text-gray-500",children:"Ngn hng"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:e.nganHang.tenNganHang})]})]})]}):t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center",children:[t.jsx(no,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Khng tm thy thng tin"})]})}function Sd({icon:e,label:n,value:a,last:r=!1}){return t.jsxs("div",{className:`flex items-center gap-3 px-4 py-3 ${r?"":"border-b border-gray-100 dark:border-gray-700"}`,children:[t.jsx(e,{className:"w-5 h-5 text-gray-400"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-xs text-gray-500",children:n}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a})]})]})}function RV(){const{data:e,isLoading:n}=Ie({queryKey:["employee-portal","phieu-luong"],queryFn:()=>Mc.getPhieuLuong()});if(n)return t.jsx("div",{className:"space-y-3",children:[1,2,3].map(r=>t.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"},r))});const a=(e==null?void 0:e.data)||[];return a.length===0?t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center",children:[t.jsx(ua,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Cha c phiu lng"})]}):t.jsx("div",{className:"space-y-3",children:a.map(r=>t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h4",{className:"font-semibold text-gray-900 dark:text-white",children:["Thng ",r.thang,"/",r.nam]}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:r.kyLuong})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-lg font-bold text-green-600",children:Lf(r.thucLinh)}),t.jsx("p",{className:"text-xs text-gray-500",children:"Thc nhn"})]})]}),t.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100 dark:border-gray-700",children:t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-500",children:"Thu nhp"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:Lf(r.tongThuNhap)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-500",children:"Khu tr"}),t.jsx("p",{className:"font-medium text-red-600",children:Lf(r.tongKhauTru)})]})]})})]},r.id))})}function BV(){var d;const{data:e,isLoading:n}=Ie({queryKey:["employee-portal","so-du-phep"],queryFn:()=>Mc.getSoDuPhep()});if(n)return t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"}),t.jsx("div",{className:"h-24 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"})]});if(!e)return t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center",children:[t.jsx(Ot,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Khng c d liu"})]});const a=e.phepNam,r=(a==null?void 0:a.conLai)||0,s=(a==null?void 0:a.tongSo)||12,l=(a==null?void 0:a.daSuDung)||0,o=s>0?l/s*100:0;return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl p-6 text-white",children:[t.jsx("p",{className:"text-emerald-100 mb-2",children:"S ngy php cn li"}),t.jsxs("div",{className:"flex items-end gap-2",children:[t.jsx("span",{className:"text-5xl font-bold",children:r}),t.jsxs("span",{className:"text-emerald-200 mb-1",children:["/ ",s," ngy"]})]}),t.jsx("div",{className:"mt-4",children:t.jsx("div",{className:"h-2 bg-white/20 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-white rounded-full transition-all",style:{width:`${100-o}%`}})})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx("p",{className:"text-sm text-gray-500 mb-1",children:" s dng"}),t.jsx("p",{className:"text-2xl font-bold text-blue-600",children:l}),t.jsx("p",{className:"text-xs text-gray-400",children:"ngy"})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Loi ngh khc"}),t.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:((d=e.danhSachLoaiNghi)==null?void 0:d.length)||0}),t.jsx("p",{className:"text-xs text-gray-400",children:"loi"})]})]}),e.danhSachLoaiNghi&&e.danhSachLoaiNghi.length>0&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Chi tit cc loi ngh"}),t.jsx("div",{className:"space-y-2",children:e.danhSachLoaiNghi.map(u=>t.jsxs("div",{className:"flex justify-between items-center text-sm",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:u.tenLoai}),t.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[u.soNgayDaSuDung," ngy"]})]},u.maLoai))})]}),t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-2xl p-4",children:[t.jsx("h4",{className:"font-medium text-blue-800 dark:text-blue-300 mb-2",children:"Lu "}),t.jsxs("ul",{className:"text-sm text-blue-700 dark:text-blue-400 space-y-1",children:[t.jsxs("li",{children:[" S ngy php c tnh theo nm ",new Date().getFullYear()]}),t.jsx("li",{children:" Php khng s dng ht s chuyn sang nm sau (ti a 5 ngy)"}),t.jsx("li",{children:" Lin h HR  c h tr"})]})]})]})}function u2(){var C;const e=xr(),n=Rt(),[a,r]=E.useState("tat-ca"),[s,l]=E.useState(1),o=20,{data:d,isLoading:u,refetch:h,isFetching:m}=Ie({queryKey:["thong-bao","list",{page:s,limit:o,filter:a}],queryFn:()=>Yi.layDanhSach({page:s,limit:o,daDoc:a==="chua-doc"?!1:a==="da-doc"?!0:void 0})}),{data:f}=Ie({queryKey:["thong-bao","chua-doc"],queryFn:()=>Yi.demChuaDoc()}),p=De({mutationFn:T=>Yi.danhDauDaDoc(T),onSuccess:()=>{n.invalidateQueries({queryKey:["thong-bao"]})}}),b=De({mutationFn:()=>Yi.danhDauTatCaDaDoc(),onSuccess:()=>{n.invalidateQueries({queryKey:["thong-bao"]})}}),g=T=>{T.daDoc||p.mutate(T.id),T.link&&e(T.link)},y=d?Math.ceil(d.total/o):1,N=(f==null?void 0:f.chuaDoc)||0;return t.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[t.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-10",children:t.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h1",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[t.jsx(bc,{className:"w-5 h-5"}),"Thng bo",N>0&&t.jsxs("span",{className:"bg-red-500 text-white text-xs px-2 py-0.5 rounded-full",children:[N," cha c"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>h(),disabled:m,className:"p-2 text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg disabled:opacity-50",title:"Lm mi",children:t.jsx(Ra,{className:`w-4 h-4 ${m?"animate-spin":""}`})}),N>0&&t.jsxs("button",{onClick:()=>b.mutate(),disabled:b.isPending,className:"flex items-center gap-1 px-3 py-1.5 text-sm text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg disabled:opacity-50",children:[t.jsx(nj,{className:"w-4 h-4"}),"c tt c"]})]})]}),t.jsx("div",{className:"flex gap-1 bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[{id:"tat-ca",label:"Tt c"},{id:"chua-doc",label:"Cha c"},{id:"da-doc",label:" c"}].map(T=>t.jsxs("button",{onClick:()=>{r(T.id),l(1)},className:`flex-1 px-4 py-2 text-sm font-medium rounded-md transition-colors ${a===T.id?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:[T.label,T.id==="chua-doc"&&N>0&&t.jsxs("span",{className:"ml-1 text-xs text-red-500",children:["(",N,")"]})]},T.id))})]})}),t.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-4",children:[u?t.jsx("div",{className:"space-y-4",children:[...Array(5)].map((T,S)=>t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 animate-pulse",children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gray-200 dark:bg-gray-700 rounded-full"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"}),t.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-full"})]})]})},S))}):(C=d==null?void 0:d.data)!=null&&C.length?t.jsx("div",{className:"space-y-2",children:d.data.map(T=>{const{icon:S,color:k}=ET(T.loaiThongBao);return t.jsx("button",{onClick:()=>g(T),className:`w-full text-left bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm hover:shadow-md transition-all border border-gray-100 dark:border-gray-700 ${T.daDoc?"":"ring-2 ring-blue-500/20"}`,children:t.jsxs("div",{className:"flex gap-4",children:[t.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-xl ${T.daDoc?"bg-gray-100 dark:bg-gray-700":"bg-blue-100 dark:bg-blue-900/30"} ${k}`,children:S}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsx("h3",{className:`font-medium ${T.daDoc?"text-gray-600 dark:text-gray-400":"text-gray-900 dark:text-white"}`,children:T.tieuDe}),t.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[!T.daDoc&&t.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),t.jsx("span",{className:"text-xs text-gray-400",children:_T(T.ngayTao)})]})]}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1 line-clamp-2",children:T.noiDung}),T.link&&t.jsx("p",{className:"text-xs text-blue-500 mt-2",children:"Nhn  xem chi tit "})]})]})},T.id)})}):t.jsxs("div",{className:"text-center py-16",children:[t.jsx(bc,{className:"w-12 h-12 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:a==="chua-doc"?"Khng c thng bo cha c":a==="da-doc"?"Khng c thng bo  c":"Cha c thng bo no"})]}),d&&y>1&&t.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[t.jsx("button",{onClick:()=>l(T=>Math.max(1,T-1)),disabled:s===1,className:"px-4 py-2 text-sm bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg disabled:opacity-50 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Trc"}),t.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Trang ",s," / ",y]}),t.jsx("button",{onClick:()=>l(T=>Math.min(y,T+1)),disabled:s===y,className:"px-4 py-2 text-sm bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg disabled:opacity-50 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Sau"})]})]})]})}function HV(){const e=Rt(),[n,a]=E.useState(!1),[r,s]=E.useState(null),[l,o]=E.useState(),[d,u]=E.useState(""),[h,m]=E.useState({tenDiaDiem:"",diaChi:"",viDo:0,kinhDo:0,banKinhMet:100,phongBanId:void 0,apDungTatCa:!1,batBuocGPS:!0,chanNgoaiVung:!1}),{data:f,isLoading:p}=Ie({queryKey:["geofences",l],queryFn:()=>ur.layDanhSachGeofence({phongBanId:l})}),{data:b}=Ie({queryKey:["phong-ban"],queryFn:ln.layTatCa}),g=De({mutationFn:ur.taoGeofence,onSuccess:()=>{e.invalidateQueries({queryKey:["geofences"]}),le.success("To geofence thnh cng"),k()},onError:L=>{var W,R;le.error(((R=(W=L.response)==null?void 0:W.data)==null?void 0:R.message)||"C li xy ra")}}),y=De({mutationFn:({id:L,data:W})=>ur.capNhatGeofence(L,W),onSuccess:()=>{e.invalidateQueries({queryKey:["geofences"]}),le.success("Cp nht thnh cng"),k()},onError:L=>{var W,R;le.error(((R=(W=L.response)==null?void 0:W.data)==null?void 0:R.message)||"C li xy ra")}}),N=De({mutationFn:ur.xoaGeofence,onSuccess:()=>{e.invalidateQueries({queryKey:["geofences"]}),le.success("Xa thnh cng")},onError:L=>{var W,R;le.error(((R=(W=L.response)==null?void 0:W.data)==null?void 0:R.message)||"C li xy ra")}}),C=De({mutationFn:({id:L,trangThai:W})=>ur.capNhatGeofence(L,{trangThai:W}),onSuccess:()=>{e.invalidateQueries({queryKey:["geofences"]}),le.success("Cp nht trng thi thnh cng")}}),T=()=>{s(null),m({tenDiaDiem:"",diaChi:"",viDo:0,kinhDo:0,banKinhMet:100,phongBanId:void 0,apDungTatCa:!1,batBuocGPS:!0,chanNgoaiVung:!1}),a(!0)},S=L=>{s(L),m({tenDiaDiem:L.tenDiaDiem,diaChi:L.diaChi||"",viDo:L.viDo,kinhDo:L.kinhDo,banKinhMet:L.banKinhMet,phongBanId:L.phongBanId,apDungTatCa:L.apDungTatCa,batBuocGPS:L.batBuocGPS,chanNgoaiVung:L.chanNgoaiVung}),a(!0)},k=()=>{a(!1),s(null)},_=L=>{if(L.preventDefault(),!h.tenDiaDiem.trim()){le.error("Vui lng nhp tn a im");return}if(h.viDo===0&&h.kinhDo===0){le.error("Vui lng nhp ta  GPS");return}r?y.mutate({id:r.id,data:h}):g.mutate(h)},P=L=>{confirm(`Bn c chc mun xa geofence "${L.tenDiaDiem}"?`)&&N.mutate(L.id)},j=async()=>{try{const L=await DT();m({...h,viDo:L.viDo,kinhDo:L.kinhDo}),le.success(" ly v tr hin ti")}catch(L){le.error(L.message)}},A=f==null?void 0:f.filter(L=>{var W;return L.tenDiaDiem.toLowerCase().includes(d.toLowerCase())||((W=L.diaChi)==null?void 0:W.toLowerCase().includes(d.toLowerCase()))});return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-[var(--text-primary)]",children:"Cu hnh Geofence"}),t.jsx("p",{className:"text-[var(--text-muted)]",children:"Qun l vng a l cho php chm cng GPS"})]}),t.jsxs(mt,{onClick:T,children:[t.jsx(St,{className:"w-4 h-4 mr-2"}),"Thm a im"]})]}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[t.jsx("div",{className:"flex-1",children:t.jsxs("div",{className:"relative",children:[t.jsx(Ss,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Tm kim a im...",value:d,onChange:L=>u(L.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]})}),t.jsx("div",{className:"sm:w-64",children:t.jsxs("select",{value:l||"",onChange:L=>o(L.target.value?Number(L.target.value):void 0),className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),b==null?void 0:b.map(L=>t.jsx("option",{value:L.id,children:L.tenPhongBan},L.id))]})})]})}),t.jsx(st,{children:p?t.jsx("div",{className:"p-8 text-center text-[var(--text-muted)]",children:"ang ti..."}):A!=null&&A.length?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-[var(--bg-secondary)] border-b",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"a im"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Ta "}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Bn knh"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"p dng"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Cu hnh"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y",children:A.map(L=>t.jsxs("tr",{className:"hover:bg-[var(--bg-secondary)]/50",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center",children:t.jsx(qd,{className:"w-5 h-5 text-primary-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:L.tenDiaDiem}),L.diaChi&&t.jsx("p",{className:"text-sm text-[var(--text-muted)]",children:L.diaChi})]})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:[L.viDo.toFixed(6),", ",L.kinhDo.toFixed(6)]})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsxs("span",{className:"font-medium",children:[L.banKinhMet,"m"]})}),t.jsx("td",{className:"px-4 py-3",children:L.apDungTatCa?t.jsx(Tt,{variant:"info",children:"Ton cng ty"}):t.jsxs("span",{className:"text-sm text-[var(--text-muted)]",children:["Phng ban #",L.phongBanId]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[L.batBuocGPS&&t.jsxs(Tt,{variant:"warning",className:"text-xs",children:[t.jsx(Nc,{className:"w-3 h-3 mr-1"}),"GPS bt buc"]}),L.chanNgoaiVung&&t.jsxs(Tt,{variant:"danger",className:"text-xs",children:[t.jsx(na,{className:"w-3 h-3 mr-1"}),"Chn ngoi vng"]})]})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("button",{onClick:()=>C.mutate({id:L.id,trangThai:!L.trangThai}),className:"inline-flex items-center gap-1",children:L.trangThai?t.jsxs(t.Fragment,{children:[t.jsx(dj,{className:"w-6 h-6 text-green-500"}),t.jsx(Tt,{variant:"success",children:"Hot ng"})]}):t.jsxs(t.Fragment,{children:[t.jsx(cj,{className:"w-6 h-6 text-gray-400"}),t.jsx(Tt,{variant:"neutral",children:"Tt"})]})})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>S(L),className:"p-2 text-gray-500 hover:text-primary-600 hover:bg-primary-50 rounded-lg",title:"Chnh sa",children:t.jsx(Or,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>P(L),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Xa",children:t.jsx(Ir,{className:"w-4 h-4"})})]})})]},L.id))})]})}):t.jsxs("div",{className:"p-8 text-center text-[var(--text-muted)]",children:[t.jsx(qd,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Cha c geofence no c cu hnh"})]})}),t.jsx(js,{isOpen:n,onClose:k,size:"lg",children:t.jsxs("form",{onSubmit:_,children:[t.jsx(ws,{title:r?"Chnh sa Geofence":"Thm a im mi"}),t.jsx(ks,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Tn a im ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:h.tenDiaDiem,onChange:L=>m({...h,tenDiaDiem:L.target.value}),placeholder:"VD: Vn phng chnh, Nh my ABC...",className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"a ch"}),t.jsx("input",{type:"text",value:h.diaChi,onChange:L=>m({...h,diaChi:L.target.value}),placeholder:"a ch y ...",className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["V  (Latitude) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"number",step:"any",value:h.viDo,onChange:L=>m({...h,viDo:parseFloat(L.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Kinh  (Longitude) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"number",step:"any",value:h.kinhDo,onChange:L=>m({...h,kinhDo:parseFloat(L.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg",required:!0})]})]}),t.jsx("div",{children:t.jsxs(mt,{type:"button",variant:"outline",onClick:j,className:"w-full",children:[t.jsx(Nc,{className:"w-4 h-4 mr-2"}),"Ly v tr hin ti"]})}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Bn knh cho php (mt) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"number",min:"10",max:"5000",value:h.banKinhMet,onChange:L=>m({...h,banKinhMet:parseInt(L.target.value)||100}),className:"w-full px-3 py-2 border rounded-lg",required:!0}),t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1",children:"Khong cch ti a t im check-in n tm geofence"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Phm vi p dng"}),t.jsx("div",{className:"space-y-2",children:t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:h.apDungTatCa,onChange:L=>m({...h,apDungTatCa:L.target.checked,phongBanId:L.target.checked?void 0:h.phongBanId}),className:"rounded"}),t.jsx("span",{children:"p dng cho ton cng ty"})]})}),!h.apDungTatCa&&t.jsxs("select",{value:h.phongBanId||"",onChange:L=>m({...h,phongBanId:L.target.value?Number(L.target.value):void 0}),className:"w-full px-3 py-2 border rounded-lg mt-2",children:[t.jsx("option",{value:"",children:"Chn phng ban..."}),b==null?void 0:b.map(L=>t.jsx("option",{value:L.id,children:L.tenPhongBan},L.id))]})]}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Cu hnh bo mt"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("label",{className:"flex items-center gap-3 p-3 bg-[var(--bg-secondary)] rounded-lg cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:h.batBuocGPS,onChange:L=>m({...h,batBuocGPS:L.target.checked}),className:"rounded"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:"Bt buc bt GPS"}),t.jsx("p",{className:"text-sm text-[var(--text-muted)]",children:"Nhn vin phi bt GPS khi chm cng"})]})]}),t.jsxs("label",{className:"flex items-center gap-3 p-3 bg-[var(--bg-secondary)] rounded-lg cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:h.chanNgoaiVung,onChange:L=>m({...h,chanNgoaiVung:L.target.checked}),className:"rounded"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-red-600",children:"Chn check-in ngoi vng"}),t.jsx("p",{className:"text-sm text-[var(--text-muted)]",children:"Khng cho php chm cng nu ngoi bn knh cho php"})]})]})]})]})]})}),t.jsxs(ei,{children:[t.jsx(mt,{type:"button",variant:"secondary",onClick:k,children:"Hy"}),t.jsx(mt,{type:"submit",disabled:g.isPending||y.isPending,children:g.isPending||y.isPending?"ang lu...":r?t.jsxs(t.Fragment,{children:[t.jsx(Ma,{className:"w-4 h-4 mr-2"}),"Cp nht"]}):t.jsxs(t.Fragment,{children:[t.jsx(St,{className:"w-4 h-4 mr-2"}),"To mi"]})})]})]})})]})}function VV(){var P;const[e,n]=E.useState(),[a,r]=E.useState(),[s,l]=E.useState(),[o,d]=E.useState(()=>new Date().toISOString().split("T")[0]),[u,h]=E.useState(()=>new Date().toISOString().split("T")[0]),[m,f]=E.useState(1),p=20,{data:b,isLoading:g}=Ie({queryKey:["gps-logs",e,s,o,u,m],queryFn:()=>ur.layLichSuGPS({nhanVienId:e,tuNgay:o,denNgay:u,trangThai:s,page:m,limit:p})}),{data:y}=Ie({queryKey:["gps-thong-ke",o,u,a],queryFn:()=>ur.thongKeGPS(o,u,a),enabled:!!o&&!!u}),{data:N}=Ie({queryKey:["phong-ban"],queryFn:ln.layTatCa}),{data:C}=Ie({queryKey:["nhan-vien",a],queryFn:()=>Oa.layTatCa({phongBanId:a,trangThai:"DANG_LAM",soLuong:500})}),T=j=>{switch(j){case"HOP_LE":return t.jsx(Ma,{className:"w-4 h-4 text-green-500"});case"NGOAI_VUNG":return t.jsx(ho,{className:"w-4 h-4 text-red-500"});case"CANH_BAO":return t.jsx(na,{className:"w-4 h-4 text-yellow-500"});case"KHONG_CO_GPS":return t.jsx(Nc,{className:"w-4 h-4 text-gray-400"});default:return null}},S=j=>{switch(j){case"HOP_LE":return t.jsx(Tt,{variant:"success",children:"Hp l"});case"NGOAI_VUNG":return t.jsx(Tt,{variant:"danger",children:"Ngoi vng"});case"CANH_BAO":return t.jsx(Tt,{variant:"warning",children:"Cnh bo"});case"KHONG_CO_GPS":return t.jsx(Tt,{variant:"neutral",children:"Khng GPS"});default:return t.jsx(Tt,{variant:"neutral",children:j})}},k=j=>new Date(j).toLocaleString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),_=Array.isArray(C)?C:(C==null?void 0:C.data)||[];return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-[var(--text-primary)]",children:"Lch s GPS Chm cng"}),t.jsx("p",{className:"text-[var(--text-muted)]",children:"Theo di v kim tra v tr chm cng ca nhn vin"})]}),t.jsxs(mt,{variant:"outline",children:[t.jsx(Xs,{className:"w-4 h-4 mr-2"}),"Xut Excel"]})]}),y&&t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[t.jsxs(st,{className:"p-4 text-center",children:[t.jsx("p",{className:"text-2xl font-bold",children:y.thongKe.tongBanGhi}),t.jsx("p",{className:"text-sm text-[var(--text-muted)]",children:"Tng bn ghi"})]}),t.jsxs(st,{className:"p-4 text-center bg-green-50",children:[t.jsx("p",{className:"text-2xl font-bold text-green-600",children:y.thongKe.hopLe}),t.jsxs("p",{className:"text-sm text-green-600",children:["Hp l (",y.thongKe.tyLeHopLe,"%)"]})]}),t.jsxs(st,{className:"p-4 text-center bg-red-50",children:[t.jsx("p",{className:"text-2xl font-bold text-red-600",children:y.thongKe.ngoaiVung}),t.jsx("p",{className:"text-sm text-red-600",children:"Ngoi vng"})]}),t.jsxs(st,{className:"p-4 text-center bg-yellow-50",children:[t.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:y.thongKe.canhBao}),t.jsx("p",{className:"text-sm text-yellow-600",children:"Cnh bo"})]}),t.jsxs(st,{className:"p-4 text-center bg-gray-50",children:[t.jsx("p",{className:"text-2xl font-bold text-gray-600",children:y.thongKe.khongGPS}),t.jsx("p",{className:"text-sm text-gray-600",children:"Khng GPS"})]})]}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"T ngy"}),t.jsx("input",{type:"date",value:o,onChange:j=>{d(j.target.value),f(1)},className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"n ngy"}),t.jsx("input",{type:"date",value:u,onChange:j=>{h(j.target.value),f(1)},className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phng ban"}),t.jsxs("select",{value:a||"",onChange:j=>{r(j.target.value?Number(j.target.value):void 0),n(void 0),f(1)},className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Tt c"}),N==null?void 0:N.map(j=>t.jsx("option",{value:j.id,children:j.tenPhongBan},j.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Nhn vin"}),t.jsxs("select",{value:e||"",onChange:j=>{n(j.target.value?Number(j.target.value):void 0),f(1)},className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Tt c"}),_.map(j=>t.jsxs("option",{value:j.id,children:[j.hoTen," (",j.maNhanVien,")"]},j.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Trng thi"}),t.jsxs("select",{value:s||"",onChange:j=>{l(j.target.value||void 0),f(1)},className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"HOP_LE",children:"Hp l"}),t.jsx("option",{value:"NGOAI_VUNG",children:"Ngoi vng"}),t.jsx("option",{value:"CANH_BAO",children:"Cnh bo"}),t.jsx("option",{value:"KHONG_CO_GPS",children:"Khng GPS"})]})]})]})}),t.jsx(st,{children:g?t.jsx("div",{className:"p-8 text-center text-[var(--text-muted)]",children:"ang ti..."}):(P=b==null?void 0:b.data)!=null&&P.length?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-[var(--bg-secondary)] border-b",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Thi gian"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Loi"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Ta "}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Geofence"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Khong cch"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Trng thi"})]})}),t.jsx("tbody",{className:"divide-y",children:b.data.map(j=>t.jsxs("tr",{className:"hover:bg-[var(--bg-secondary)]/50",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(nn,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{className:"text-sm",children:k(j.thoiGian)})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("span",{className:"font-medium",children:["NV #",j.nhanVienId]})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx(Tt,{variant:j.loaiChamCong==="CHECK_IN"?"success":"info",children:j.loaiChamCong==="CHECK_IN"?"Vo":"Ra"})}),t.jsxs("td",{className:"px-4 py-3",children:[j.viDo&&j.kinhDo?t.jsxs("a",{href:`https://maps.google.com/?q=${j.viDo},${j.kinhDo}`,target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:underline text-sm",children:[t.jsx(qd,{className:"w-3 h-3 inline mr-1"}),j.viDo.toFixed(5),", ",j.kinhDo.toFixed(5)]}):t.jsx("span",{className:"text-gray-400 text-sm",children:"Khng c"}),j.doChinhXacMet&&t.jsxs("span",{className:"text-xs text-gray-400 ml-2",children:["(",j.doChinhXacMet,"m)"]})]}),t.jsx("td",{className:"px-4 py-3",children:j.geofence?t.jsx("span",{className:"text-sm",children:j.geofence.tenDiaDiem}):t.jsx("span",{className:"text-gray-400 text-sm",children:""})}),t.jsx("td",{className:"px-4 py-3 text-center",children:j.khoangCachMet!==void 0&&j.khoangCachMet!==null?t.jsxs("span",{className:`font-medium ${j.trongVung?"text-green-600":"text-red-600"}`,children:[j.khoangCachMet,"m"]}):t.jsx("span",{className:"text-gray-400",children:""})}),t.jsxs("td",{className:"px-4 py-3 text-center",children:[t.jsxs("div",{className:"flex items-center justify-center gap-1",children:[T(j.trangThai),S(j.trangThai)]}),j.ghiChu&&t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:j.ghiChu})]})]},j.id))})]})}),t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t",children:[t.jsxs("p",{className:"text-sm text-[var(--text-muted)]",children:["Hin th ",(m-1)*p+1,"-",Math.min(m*p,b.total)," /"," ",b.total," bn ghi"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(mt,{variant:"outline",size:"sm",onClick:()=>f(j=>Math.max(1,j-1)),disabled:m===1,children:t.jsx(Rr,{className:"w-4 h-4"})}),t.jsxs("span",{className:"px-3 py-1 bg-[var(--bg-secondary)] rounded",children:[m," / ",b.totalPages||1]}),t.jsx(mt,{variant:"outline",size:"sm",onClick:()=>f(j=>j+1),disabled:m>=(b.totalPages||1),children:t.jsx(aa,{className:"w-4 h-4"})})]})]})]}):t.jsxs("div",{className:"p-8 text-center text-[var(--text-muted)]",children:[t.jsx(Nc,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Khng c d liu GPS trong khong thi gian ny"})]})})]})}const If=e=>e?new Date(e).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-";function UV(){var _,P,j,A,L,W,R,M,q,ee;const e=Rt(),[n,a]=E.useState(""),[r,s]=E.useState(""),[l,o]=E.useState(1),[d,u]=E.useState({open:!1}),[h,m]=E.useState(""),[f,p]=E.useState({open:!1}),{data:b,isLoading:g}=Ie({queryKey:["devices",{search:n,trangThai:r,page:l}],queryFn:()=>ur.layDanhSachThietBi({search:n,trangThai:r,page:l,limit:20})}),{data:y}=Ie({queryKey:["device-history",f.nhanVienId],queryFn:()=>f.nhanVienId?ur.layLichSuThietBi({nhanVienId:f.nhanVienId,limit:50}):null,enabled:f.open&&!!f.nhanVienId}),N=De({mutationFn:z=>ur.resetDevice(z),onSuccess:()=>{alert(" reset thit b thnh cng"),e.invalidateQueries({queryKey:["devices"]}),u({open:!1}),m("")},onError:z=>{alert(z.message||"C li xy ra")}}),C=De({mutationFn:({nhanVienId:z,lyDo:fe})=>ur.blockDevice(z,fe),onSuccess:()=>{alert(" kha thit b"),e.invalidateQueries({queryKey:["devices"]})},onError:z=>{alert(z.message||"C li xy ra")}}),T=()=>{if(!d.device||!h.trim()){alert("Vui lng nhp l do reset");return}N.mutate({nhanVienId:d.device.nhanVienId,lyDo:h})},S=z=>{switch(z){case"ACTIVE":return{label:"Hot ng",variant:"success",icon:aj};case"BLOCKED":return{label:" kha",variant:"danger",icon:Js};case"PENDING_RESET":return{label:"Ch reset",variant:"warning",icon:nn};default:return{label:z,variant:"neutral",icon:na}}},k=z=>{if(!z)return t.jsx(rb,{className:"h-4 w-4"});const fe=z.toLowerCase();return fe.includes("ios")||fe.includes("iphone")?t.jsx(s0,{className:"h-4 w-4"}):fe.includes("android")?t.jsx(s0,{className:"h-4 w-4"}):t.jsx(rb,{className:"h-4 w-4"})};return t.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold",children:"Qun l thit b"}),t.jsx("p",{className:"text-gray-500",children:"Sprint 8: Device Binding - Mi nhn vin ch c ng nhp t 1 thit b"})]})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs(st,{children:[t.jsx(Un,{children:t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Tng thit b"})}),t.jsx(Bt,{children:t.jsx("div",{className:"text-2xl font-bold",children:(b==null?void 0:b.total)||0})})]}),t.jsxs(st,{children:[t.jsx(Un,{children:t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Hot ng"})}),t.jsx(Bt,{children:t.jsx("div",{className:"text-2xl font-bold text-green-600",children:((_=b==null?void 0:b.data)==null?void 0:_.filter(z=>z.trangThai==="ACTIVE").length)||0})})]}),t.jsxs(st,{children:[t.jsx(Un,{children:t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Ch reset"})}),t.jsx(Bt,{children:t.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:((P=b==null?void 0:b.data)==null?void 0:P.filter(z=>z.trangThai==="PENDING_RESET").length)||0})})]}),t.jsxs(st,{children:[t.jsx(Un,{children:t.jsx("span",{className:"text-sm font-medium text-gray-500",children:" kha"})}),t.jsx(Bt,{children:t.jsx("div",{className:"text-2xl font-bold text-red-600",children:((j=b==null?void 0:b.data)==null?void 0:j.filter(z=>z.trangThai==="BLOCKED").length)||0})})]})]}),t.jsxs(st,{children:[t.jsx(Un,{children:t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Danh sch thit b"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Qun l thit b  ng k ca nhn vin"})]})})}),t.jsxs(Bt,{children:[t.jsxs("div",{className:"flex gap-4 mb-4",children:[t.jsx("div",{className:"flex-1",children:t.jsx(ig,{placeholder:"Tm theo tn, m nhn vin...",value:n,onChange:z=>a(z.target.value)})}),t.jsxs("select",{className:"px-3 py-2 border rounded-lg bg-white",value:r,onChange:z=>s(z.target.value),children:[t.jsx("option",{value:"",children:"Tt c trng thi"}),t.jsx("option",{value:"ACTIVE",children:"Hot ng"}),t.jsx("option",{value:"PENDING_RESET",children:"Ch reset"}),t.jsx("option",{value:"BLOCKED",children:" kha"})]})]}),t.jsxs(Kj,{children:[t.jsx(zj,{children:t.jsxs(Ed,{children:[t.jsx(Al,{children:"Nhn vin"}),t.jsx(Al,{children:"Thit b"}),t.jsx(Al,{children:"Trng thi"}),t.jsx(Al,{children:"Ngy ng k"}),t.jsx(Al,{children:"ng nhp cui"}),t.jsx(Al,{align:"right",children:"Thao tc"})]})}),t.jsx($j,{children:g?t.jsx(Ed,{children:t.jsx(Ks,{colSpan:6,className:"text-center py-8",children:"ang ti..."})}):((A=b==null?void 0:b.data)==null?void 0:A.length)===0?t.jsx(Ed,{children:t.jsx(Ks,{colSpan:6,className:"text-center py-8 text-gray-500",children:"Cha c thit b no c ng k"})}):(L=b==null?void 0:b.data)==null?void 0:L.map(z=>{var J,G,he;const fe=S(z.trangThai),ae=fe.icon;return t.jsxs(Ed,{children:[t.jsx(Ks,{children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:((J=z.nhanVien)==null?void 0:J.hoTen)||"N/A"}),t.jsx("div",{className:"text-sm text-gray-500",children:(G=z.nhanVien)==null?void 0:G.maNhanVien})]})}),t.jsx(Ks,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[k(z.platform),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:z.tenThietBi||"Khng xc nh"}),t.jsxs("div",{className:"text-xs text-gray-500 truncate max-w-[200px]",children:[(he=z.deviceId)==null?void 0:he.substring(0,20),"..."]})]})]})}),t.jsx(Ks,{children:t.jsxs(Tt,{variant:fe.variant,children:[t.jsx(ae,{className:"h-3 w-3 mr-1"}),fe.label]})}),t.jsx(Ks,{children:If(z.ngayDangKy)}),t.jsx(Ks,{children:If(z.lanDangNhapCuoi)}),t.jsx(Ks,{align:"right",children:t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(mt,{variant:"ghost",size:"sm",title:"Xem lch s",onClick:()=>p({open:!0,nhanVienId:z.nhanVienId}),children:t.jsx(fu,{className:"h-4 w-4"})}),z.trangThai!=="PENDING_RESET"&&t.jsx(mt,{variant:"ghost",size:"sm",title:"Reset thit b",onClick:()=>u({open:!0,device:z}),children:t.jsx(Ra,{className:"h-4 w-4"})}),z.trangThai==="ACTIVE"&&t.jsx(mt,{variant:"ghost",size:"sm",title:"Kha thit b",onClick:()=>{confirm("Bn c chc mun kha thit b ny?")&&C.mutate({nhanVienId:z.nhanVienId,lyDo:"Kha th cng bi HR"})},children:t.jsx(Js,{className:"h-4 w-4"})})]})})]},z.id)})})]}),b&&b.totalPages>1&&t.jsxs("div",{className:"flex justify-center gap-2 mt-4",children:[t.jsx(mt,{variant:"outline",size:"sm",disabled:l===1,onClick:()=>o(z=>z-1),children:"Trc"}),t.jsxs("span",{className:"flex items-center px-4 text-sm",children:["Trang ",l," / ",b.totalPages]}),t.jsx(mt,{variant:"outline",size:"sm",disabled:l===b.totalPages,onClick:()=>o(z=>z+1),children:"Sau"})]})]})]}),t.jsxs(js,{isOpen:d.open,onClose:()=>u({open:!1}),children:[t.jsx(ws,{title:"Reset thit b"}),t.jsx(ks,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg",children:[t.jsx("div",{className:"font-medium",children:(R=(W=d.device)==null?void 0:W.nhanVien)==null?void 0:R.hoTen}),t.jsxs("div",{className:"text-sm text-gray-500",children:["Thit b hin ti: ",((M=d.device)==null?void 0:M.tenThietBi)||"Khng xc nh"]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"L do reset *"}),t.jsx(J0,{placeholder:"Nhp l do reset thit b...",value:h,onChange:z=>m(z.target.value),rows:3})]}),t.jsx("p",{className:"text-sm text-gray-500",children:"Reset s cho php nhn vin ng nhp t thit b mi"})]})}),t.jsxs(ei,{children:[t.jsx(mt,{variant:"outline",onClick:()=>u({open:!1}),children:"Hy"}),t.jsx(mt,{onClick:T,disabled:N.isPending,children:N.isPending?"ang x l...":"Xc nhn reset"})]})]}),t.jsxs(js,{isOpen:f.open,onClose:()=>p({open:!1}),size:"lg",children:[t.jsx(ws,{title:"Lch s thit b"}),t.jsx(ks,{className:"max-h-[60vh] overflow-y-auto",children:t.jsx("div",{className:"space-y-4",children:((q=y==null?void 0:y.data)==null?void 0:q.length)===0?t.jsx("p",{className:"text-center text-gray-500 py-8",children:"Cha c lch s"}):(ee=y==null?void 0:y.data)==null?void 0:ee.map(z=>t.jsxs("div",{className:"flex items-start gap-4 p-4 border rounded-lg",children:[t.jsxs("div",{className:`p-2 rounded-full ${z.hanhDong==="BIND"?"bg-green-100 text-green-600":z.hanhDong==="RESET"?"bg-yellow-100 text-yellow-600":z.hanhDong==="BLOCK"?"bg-red-100 text-red-600":"bg-gray-100"}`,children:[z.hanhDong==="BIND"&&t.jsx(s0,{className:"h-4 w-4"}),z.hanhDong==="RESET"&&t.jsx(Ra,{className:"h-4 w-4"}),z.hanhDong==="BLOCK"&&t.jsx(Js,{className:"h-4 w-4"}),z.hanhDong==="LOGIN_BLOCKED"&&t.jsx(na,{className:"h-4 w-4"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"font-medium",children:[z.hanhDong==="BIND"&&"ng k thit b mi",z.hanhDong==="RESET"&&"Reset thit b",z.hanhDong==="BLOCK"&&"Kha thit b",z.hanhDong==="LOGIN_BLOCKED"&&"Chn ng nhp t thit b l"]}),z.lyDo&&t.jsxs("div",{className:"text-sm text-gray-500",children:["L do: ",z.lyDo]}),z.nguoiThucHien&&t.jsxs("div",{className:"text-sm text-gray-500",children:["Thc hin bi: ",z.nguoiThucHien.hoTen]}),t.jsx("div",{className:"text-xs text-gray-400 mt-1",children:If(z.ngayTao)})]})]},z.id))})})]})]})}const KV=async e=>(await me.get("/timesheet",{params:e})).data,zV=async e=>(await me.get("/timesheet/yeu-cau-sua-cong",{params:e})).data,$V=async e=>(await me.post("/timesheet/yeu-cau-sua-cong",e)).data,GV=async(e,n)=>(await me.post(`/timesheet/yeu-cau-sua-cong/${e}/duyet`,n)).data,qV=async e=>(await me.put("/timesheet/sua-cong-truc-tiep",e)).data,Ji=e=>e?new Date(e).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}):"-",Mf=e=>({DI_LAM:{label:"i lm",color:"success"},NGHI_PHEP:{label:"Ngh php",color:"info"},NGHI_KHONG_LUONG:{label:"Ngh KL",color:"warning"},NGHI_BENH:{label:"Ngh bnh",color:"warning"},NGHI_LE:{label:"Ngh l",color:"info"},CHUA_XAC_DINH:{label:"-",color:"neutral"},VANG_MAT:{label:"Vng",color:"danger"}})[e]||{label:e,color:"neutral"},h2=(e,n)=>e==="NGAY_LE"?"bg-red-100":n===0?"bg-red-50":n===6?"bg-yellow-50":"",WV=(e,n)=>new Date(n,e,0).getDate(),XV=e=>["CN","T2","T3","T4","T5","T6","T7"][e];function QV(){var fe,ae;const e=Rt(),n=new Date,[a,r]=E.useState(n.getMonth()+1),[s,l]=E.useState(n.getFullYear()),[o,d]=E.useState(""),[u]=E.useState(),[h,m]=E.useState(null),[f,p]=E.useState(null),[b,g]=E.useState("view"),[y,N]=E.useState({gioVaoMoi:"",gioRaMoi:"",trangThaiMoi:"",lyDo:""}),[C,T]=E.useState(!1),{data:S,isLoading:k}=Ie({queryKey:["bang-cong",{thang:a,nam:s,search:o,phongBanId:u}],queryFn:()=>KV({thang:a,nam:s,search:o,phongBanId:u})}),{data:_}=Ie({queryKey:["yeu-cau-sua-cong",{thang:a,nam:s,trangThaiDuyet:"CHO_DUYET"}],queryFn:()=>{const J=new Date(s,a-1,1).toISOString().slice(0,10),G=new Date(s,a,0).toISOString().slice(0,10);return zV({trangThaiDuyet:"CHO_DUYET",tuNgay:J,denNgay:G})}}),P=De({mutationFn:$V,onSuccess:()=>{alert(" to yu cu sa cng"),e.invalidateQueries({queryKey:["bang-cong"]}),e.invalidateQueries({queryKey:["yeu-cau-sua-cong"]}),q()},onError:J=>{alert(J.message||"C li xy ra")}}),j=De({mutationFn:qV,onSuccess:()=>{alert(" cp nht chm cng"),e.invalidateQueries({queryKey:["bang-cong"]}),q()},onError:J=>{alert(J.message||"C li xy ra")}}),A=De({mutationFn:({id:J,payload:G})=>GV(J,G),onSuccess:()=>{alert(" x l yu cu"),e.invalidateQueries({queryKey:["bang-cong"]}),e.invalidateQueries({queryKey:["yeu-cau-sua-cong"]})},onError:J=>{alert(J.message||"C li xy ra")}}),L=E.useMemo(()=>WV(a,s),[a,s]),W=()=>{a===1?(r(12),l(s-1)):r(a-1)},R=()=>{a===12?(r(1),l(s+1)):r(a+1)},M=(J,G,he)=>{m(J),p(G),g(he),N({gioVaoMoi:G.gioVao?new Date(G.gioVao).toTimeString().slice(0,5):"",gioRaMoi:G.gioRa?new Date(G.gioRa).toTimeString().slice(0,5):"",trangThaiMoi:G.trangThai,lyDo:""})},q=()=>{m(null),p(null),g("view"),N({gioVaoMoi:"",gioRaMoi:"",trangThaiMoi:"",lyDo:""})},ee=()=>{if(!(!h||!f))if(b==="request"){if(!y.lyDo.trim()){alert("Vui lng nhp l do");return}P.mutate({nhanVienId:h.nhanVienId,ngayChamCong:f.ngay,gioVaoMoi:y.gioVaoMoi?`${f.ngay}T${y.gioVaoMoi}:00`:void 0,gioRaMoi:y.gioRaMoi?`${f.ngay}T${y.gioRaMoi}:00`:void 0,trangThaiMoi:y.trangThaiMoi!==f.trangThai?y.trangThaiMoi:void 0,lyDo:y.lyDo})}else j.mutate({nhanVienId:h.nhanVienId,ngayChamCong:f.ngay,gioVao:y.gioVaoMoi?`${f.ngay}T${y.gioVaoMoi}:00`:void 0,gioRa:y.gioRaMoi?`${f.ngay}T${y.gioRaMoi}:00`:void 0,trangThai:y.trangThaiMoi,ghiChu:y.lyDo})},z=S==null?void 0:S.thongKe;return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[t.jsx(Ot,{className:"h-6 w-6"}),"Bng Cng Thng ",a,"/",s]}),t.jsx("p",{className:"text-gray-500",children:"Theo di chm cng v sa cng nhn vin"})]}),t.jsx("div",{className:"flex gap-2",children:t.jsxs(mt,{variant:"outline",onClick:()=>T(!0),children:[t.jsx(ua,{className:"h-4 w-4 mr-2"}),"Duyt sa cng (",((fe=_==null?void 0:_.data)==null?void 0:fe.length)||0,")"]})})]}),z&&t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[t.jsx(st,{children:t.jsx(Bt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(on,{className:"h-5 w-5 text-blue-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Nhn vin"}),t.jsx("p",{className:"text-xl font-bold",children:z.tongNhanVien})]})]})})}),t.jsx(st,{children:t.jsx(Bt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Lr,{className:"h-5 w-5 text-green-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Ngy cng"}),t.jsx("p",{className:"text-xl font-bold",children:z.tongNgayCong})]})]})})}),t.jsx(st,{children:t.jsx(Bt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(z_,{className:"h-5 w-5 text-purple-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Gi OT"}),t.jsx("p",{className:"text-xl font-bold",children:z.tongGioOT.toFixed(1)})]})]})})}),t.jsx(st,{children:t.jsx(Bt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(na,{className:"h-5 w-5 text-orange-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"i tr"}),t.jsx("p",{className:"text-xl font-bold",children:z.tongLanDiTre})]})]})})}),t.jsx(st,{children:t.jsx(Bt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(hn,{className:"h-5 w-5 text-red-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Ngh"}),t.jsx("p",{className:"text-xl font-bold",children:z.tongNgayNghi})]})]})})}),t.jsx(st,{children:t.jsx(Bt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(nn,{className:"h-5 w-5 text-cyan-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Ch duyt"}),t.jsx("p",{className:"text-xl font-bold",children:z.yeuCauSuaCong.choDuyet})]})]})})})]}),t.jsxs(st,{children:[t.jsx(Un,{children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(mt,{variant:"outline",size:"sm",onClick:W,children:t.jsx(Rr,{className:"h-4 w-4"})}),t.jsxs("span",{className:"font-medium text-lg min-w-[120px] text-center",children:["Thng ",a,"/",s]}),t.jsx(mt,{variant:"outline",size:"sm",onClick:R,children:t.jsx(aa,{className:"h-4 w-4"})})]}),t.jsx(ig,{placeholder:"Tm nhn vin...",value:o,onChange:J=>d(J.target.value),className:"w-64"})]})}),t.jsxs(Bt,{children:[k?t.jsx("div",{className:"text-center py-8",children:"ang ti..."}):(ae=S==null?void 0:S.data)!=null&&ae.length?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full border-collapse text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-50",children:[t.jsx("th",{className:"border px-3 py-2 text-left sticky left-0 bg-gray-50 z-10 min-w-[150px]",children:"Nhn vin"}),Array.from({length:L},(J,G)=>{const H=new Date(s,a-1,G+1).getDay();return t.jsxs("th",{className:`border px-1 py-1 text-center min-w-[50px] ${h2("",H)}`,children:[t.jsx("div",{className:"text-xs",children:XV(H)}),t.jsx("div",{children:G+1})]},G)}),t.jsx("th",{className:"border px-2 py-2 text-center min-w-[60px] bg-gray-100",children:"Cng"}),t.jsx("th",{className:"border px-2 py-2 text-center min-w-[60px] bg-gray-100",children:"OT"})]})}),t.jsx("tbody",{children:S.data.map(J=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsxs("td",{className:"border px-3 py-2 sticky left-0 bg-white z-10",children:[t.jsx("div",{className:"font-medium",children:J.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:J.maNhanVien})]}),J.chiTiet.map(G=>{const{label:he,color:H}=Mf(G.trangThai);return t.jsxs("td",{className:`border px-1 py-1 text-center cursor-pointer hover:bg-blue-50 ${h2(G.loaiNgay,G.thuTrongTuan)}`,onClick:()=>M(J,G,"view"),children:[t.jsx("div",{className:"text-xs",children:G.trangThai==="DI_LAM"?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-green-600",children:Ji(G.gioVao)}),t.jsx("div",{className:"text-blue-600",children:Ji(G.gioRa)})]}):t.jsx(Tt,{variant:H,className:"text-[10px] px-1",children:he})}),G.coYeuCauSuaCong&&t.jsx(Ym,{className:"h-3 w-3 text-orange-500 mx-auto"})]},G.ngay)}),t.jsx("td",{className:"border px-2 py-2 text-center font-medium bg-gray-50",children:J.tongKet.soNgayDiLam}),t.jsx("td",{className:"border px-2 py-2 text-center font-medium bg-gray-50",children:J.tongKet.soGioOT.toFixed(1)})]},J.nhanVienId))})]})}):t.jsx("div",{className:"text-center py-8 text-gray-500",children:"Khng c d liu"}),t.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-sm",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"w-3 h-3 bg-red-50 border"})," Ch nht"]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"w-3 h-3 bg-yellow-50 border"})," Th 7"]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"w-3 h-3 bg-red-100 border"})," Ngy l"]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(Ym,{className:"h-3 w-3 text-orange-500"})," C yu cu sa"]})]})]})]}),t.jsxs(js,{isOpen:!!f,onClose:q,children:[t.jsx(ws,{title:b==="view"?"Chi tit chm cng":b==="edit"?"Sa cng trc tip":"Yu cu sa cng"}),t.jsx(ks,{children:f&&h&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Nhn vin:"}),t.jsx("span",{className:"ml-2 font-medium",children:h.hoTen})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Ngy:"}),t.jsx("span",{className:"ml-2 font-medium",children:f.ngay})]})]}),b==="view"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm border rounded p-3",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Gi vo:"}),t.jsx("span",{className:"ml-2",children:Ji(f.gioVao)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Gi ra:"}),t.jsx("span",{className:"ml-2",children:Ji(f.gioRa)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Trng thi:"}),t.jsx(Tt,{variant:Mf(f.trangThai).color,className:"ml-2",children:Mf(f.trangThai).label})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Gi lm:"}),t.jsxs("span",{className:"ml-2",children:[f.soGioLam.toFixed(1),"h"]})]}),f.phutDiTre&&f.phutDiTre>0&&t.jsxs("div",{className:"text-orange-600",children:["i tr: ",f.phutDiTre," pht"]}),f.phutVeSom&&f.phutVeSom>0&&t.jsxs("div",{className:"text-orange-600",children:["V sm: ",f.phutVeSom," pht"]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(mt,{variant:"outline",onClick:()=>g("edit"),children:[t.jsx(Ym,{className:"h-4 w-4 mr-2"}),"Sa trc tip"]}),t.jsxs(mt,{variant:"outline",onClick:()=>g("request"),children:[t.jsx(ua,{className:"h-4 w-4 mr-2"}),"To yu cu sa"]})]})]}):t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gi vo mi"}),t.jsx("input",{type:"time",className:"w-full border rounded px-3 py-2",value:y.gioVaoMoi,onChange:J=>N({...y,gioVaoMoi:J.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gi ra mi"}),t.jsx("input",{type:"time",className:"w-full border rounded px-3 py-2",value:y.gioRaMoi,onChange:J=>N({...y,gioRaMoi:J.target.value})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Trng thi"}),t.jsxs("select",{className:"w-full border rounded px-3 py-2",value:y.trangThaiMoi,onChange:J=>N({...y,trangThaiMoi:J.target.value}),children:[t.jsx("option",{value:"DI_LAM",children:"i lm"}),t.jsx("option",{value:"NGHI_PHEP",children:"Ngh php"}),t.jsx("option",{value:"NGHI_KHONG_LUONG",children:"Ngh khng lng"}),t.jsx("option",{value:"NGHI_BENH",children:"Ngh bnh"}),t.jsx("option",{value:"VANG_MAT",children:"Vng mt"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:b==="request"?"L do sa (bt buc)":"Ghi ch"}),t.jsx(J0,{placeholder:b==="request"?"Nhp l do yu cu sa cng...":"Ghi ch...",value:y.lyDo,onChange:J=>N({...y,lyDo:J.target.value}),rows:3})]})]})]})}),t.jsxs(ei,{children:[t.jsx(mt,{variant:"outline",onClick:q,children:"ng"}),b!=="view"&&t.jsx(mt,{onClick:ee,disabled:P.isPending||j.isPending,children:P.isPending||j.isPending?"ang x l...":"Lu"})]})]}),t.jsx(YV,{open:C,onClose:()=>T(!1),yeuCauList:(_==null?void 0:_.data)||[],onDuyet:(J,G,he)=>{A.mutate({id:J,payload:{trangThaiDuyet:G?"DA_DUYET":"TU_CHOI",lyDoTuChoi:he}})},isLoading:A.isPending})]})}function YV({open:e,onClose:n,yeuCauList:a,onDuyet:r,isLoading:s}){const[l,o]=E.useState({});return t.jsxs(js,{isOpen:e,onClose:n,size:"xl",children:[t.jsx(ws,{title:"Duyt yu cu sa cng"}),t.jsx(ks,{children:a.length===0?t.jsx("div",{className:"text-center py-8 text-gray-500",children:"Khng c yu cu no ang ch duyt"}):t.jsx("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto",children:a.map(d=>{var u,h,m;return t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"font-medium",children:[(u=d.nhanVien)==null?void 0:u.hoTen," - ",(h=d.nhanVien)==null?void 0:h.maNhanVien]}),t.jsxs("div",{className:"text-sm text-gray-500",children:["Ngy: ",new Date(d.ngayChamCong).toLocaleDateString("vi-VN")]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Thay i:"}),d.gioVaoMoi&&t.jsxs("span",{className:"ml-2",children:["Gi vo: ",Ji(d.gioVaoCu),"  ",Ji(d.gioVaoMoi)]}),d.gioRaMoi&&t.jsxs("span",{className:"ml-2",children:["Gi ra: ",Ji(d.gioRaCu),"  ",Ji(d.gioRaMoi)]}),d.trangThaiMoi&&t.jsxs("span",{className:"ml-2",children:["Trng thi: ",d.trangThaiCu,"  ",d.trangThaiMoi]})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"L do:"}),t.jsx("span",{className:"ml-2",children:d.lyDo})]}),t.jsxs("div",{className:"text-xs text-gray-400",children:["Ngi to: ",(m=d.nguoiTao)==null?void 0:m.hoTen," - ",new Date(d.ngayTao).toLocaleString("vi-VN")]}),t.jsx(J0,{placeholder:"L do t chi (nu t chi)",value:l[d.id]||"",onChange:f=>o({...l,[d.id]:f.target.value}),rows:2,className:"mt-2"})]}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsxs(mt,{variant:"primary",size:"sm",onClick:()=>r(d.id,!0),disabled:s,children:[t.jsx(Lr,{className:"h-4 w-4 mr-1"}),"Duyt"]}),t.jsxs(mt,{variant:"danger",size:"sm",onClick:()=>r(d.id,!1,l[d.id]),disabled:s,children:[t.jsx(hn,{className:"h-4 w-4 mr-1"}),"T chi"]})]})]})},d.id)})})}),t.jsx(ei,{children:t.jsx(mt,{variant:"outline",onClick:n,children:"ng"})})]})}const JV="tinh_luong_auth",nc=Jt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});nc.interceptors.request.use(e=>{const n=localStorage.getItem(JV);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e});const Rf={sync:e=>nc.post("/payroll-sync/sync",e).then(n=>n.data),getProgress:e=>nc.get(`/payroll-sync/progress/${e}`).then(n=>n.data),getStatus:(e,n)=>nc.get("/payroll-sync/status",{params:{thang:e,nam:n}}).then(a=>a.data),getRuleTrace:e=>nc.get("/payroll-sync/rule-trace",{params:e}).then(n=>n.data),getRuleTraceByEmployee:(e,n,a)=>nc.get(`/payroll-sync/rule-trace/nhan-vien/${e}`,{params:{thang:n,nam:a}}).then(r=>r.data)},ZV={CHAM_CONG:{label:"Chm cng",color:"bg-blue-100 text-blue-700",icon:nn},YEU_CAU:{label:"n yu cu",color:"bg-purple-100 text-purple-700",icon:ua},NGHI_PHEP:{label:"Ngh php",color:"bg-green-100 text-green-700",icon:Ot},PHAN_CA:{label:"Phn ca",color:"bg-yellow-100 text-yellow-700",icon:on},GPS:{label:"GPS",color:"bg-orange-100 text-orange-700",icon:Pd},KPI:{label:"KPI",color:"bg-pink-100 text-pink-700",icon:ej},MANUAL:{label:"Th cng",color:"bg-gray-100 text-gray-700",icon:ua},RULE_ENGINE:{label:"Rule Engine",color:"bg-indigo-100 text-indigo-700",icon:Pd}};function eU(){var S,k;const e=Rt(),[n,a]=E.useState(new Date().getMonth()+1),[r,s]=E.useState(new Date().getFullYear()),[l,o]=E.useState(),[d,u]=E.useState(new Set),[h,m]=E.useState(null),{data:f}=Ie({queryKey:["phong-ban"],queryFn:ln.layTatCa}),{data:p,isLoading:b}=Ie({queryKey:["pipeline-status",n,r],queryFn:()=>Rf.getStatus(n,r)}),{data:g,isLoading:y}=Ie({queryKey:["rule-trace",n,r,l],queryFn:()=>Rf.getRuleTrace({thang:n,nam:r,phongBanId:l})}),N=De({mutationFn:_=>Rf.sync({bangLuongId:_}),onMutate:_=>{m(_)},onSuccess:_=>{var P;e.invalidateQueries({queryKey:["pipeline-status"]}),e.invalidateQueries({queryKey:["rule-trace"]}),e.invalidateQueries({queryKey:["bang-luong"]}),_.currentStep==="HOAN_THANH"?le.success(`ng b hon thnh: ${((P=_.summary)==null?void 0:P.tongThayDoi)||0} thay i`):_.currentStep==="LOI"&&le.error(`ng b tht bi: ${_.errors[0]||"C li xy ra"}`)},onError:_=>{le.error(`Li ng b: ${_.message}`)},onSettled:()=>{m(null)}}),C=_=>{const P=new Set(d);P.has(_)?P.delete(_):P.add(_),u(P)},T=_=>{const j={CHUA_TAO:{color:"gray",label:"Cha to"},NHAP:{color:"yellow",label:"Nhp"},DA_TINH:{color:"blue",label:" tnh"},DA_KHOA:{color:"purple",label:" kha"},DA_DUYET:{color:"green",label:" duyt"}}[_]||{color:"gray",label:_};return t.jsx(Tt,{variant:j.color,children:j.label})};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Pipeline ng B Lng"}),t.jsx("p",{className:"text-gray-500",children:"ng b d liu chm cng, ngh php, yu cu vo bng lng"})]})}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thng"}),t.jsx("select",{value:n,onChange:_=>a(Number(_.target.value)),className:"input",children:[...Array(12)].map((_,P)=>t.jsxs("option",{value:P+1,children:["Thng ",P+1]},P+1))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nm"}),t.jsx("select",{value:r,onChange:_=>s(Number(_.target.value)),className:"input",children:[2024,2025,2026].map(_=>t.jsx("option",{value:_,children:_},_))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:l||"",onChange:_=>o(_.target.value?Number(_.target.value):void 0),className:"input",children:[t.jsx("option",{value:"",children:"Tt c"}),f==null?void 0:f.map(_=>t.jsx("option",{value:_.id,children:_.tenPhongBan},_.id))]})]})]})}),t.jsxs(st,{children:[t.jsx("div",{className:"p-4 border-b border-gray-200",children:t.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(Pd,{className:"w-5 h-5"}),"Trng thi Pipeline"]})}),b?t.jsx("div",{className:"p-8 text-center",children:t.jsx(In,{className:"w-8 h-8 animate-spin mx-auto text-blue-500"})}):t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[t.jsx("div",{className:"text-sm text-blue-600",children:"Tng nhn vin"}),t.jsx("div",{className:"text-2xl font-bold text-blue-700",children:(p==null?void 0:p.tongNhanVien)||0})]}),t.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[t.jsx("div",{className:"text-sm text-green-600",children:" sync hon thnh"}),t.jsx("div",{className:"text-2xl font-bold text-green-700",children:(p==null?void 0:p.tongDaSyncHoanThanh)||0})]}),t.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[t.jsx("div",{className:"text-sm text-yellow-600",children:"Cnh bo"}),t.jsx("div",{className:"text-2xl font-bold text-yellow-700",children:((S=p==null?void 0:p.warnings)==null?void 0:S.length)||0})]})]}),(p==null?void 0:p.warnings)&&p.warnings.length>0&&t.jsxs("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[t.jsxs("h3",{className:"font-medium text-yellow-800 flex items-center gap-2 mb-2",children:[t.jsx(uo,{className:"w-4 h-4"}),"Cnh bo"]}),t.jsxs("ul",{className:"space-y-1",children:[p.warnings.slice(0,5).map((_,P)=>t.jsxs("li",{className:"text-sm text-yellow-700",children:[" ",_.moTa]},P)),p.warnings.length>5&&t.jsxs("li",{className:"text-sm text-yellow-600 italic",children:["... v ",p.warnings.length-5," cnh bo khc"]})]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Tng lng"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:(k=p==null?void 0:p.phongBans)==null?void 0:k.map(_=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 font-medium",children:_.tenPhongBan}),t.jsx("td",{className:"px-4 py-3 text-center",children:T(_.trangThai)}),t.jsx("td",{className:"px-4 py-3 text-right",children:_.tongNhanVien}),t.jsx("td",{className:"px-4 py-3 text-right",children:Ze(_.tongLuong)}),t.jsx("td",{className:"px-4 py-3 text-center",children:_.bangLuongId&&_.trangThai!=="DA_KHOA"&&_.trangThai!=="DA_DUYET"?t.jsxs(mt,{size:"sm",variant:"primary",onClick:()=>N.mutate(_.bangLuongId),disabled:h===_.bangLuongId,children:[h===_.bangLuongId?t.jsx(In,{className:"w-4 h-4 animate-spin"}):t.jsx(Ra,{className:"w-4 h-4"}),t.jsx("span",{className:"ml-1",children:"Sync"})]}):_.trangThai==="CHUA_TAO"?t.jsx("span",{className:"text-sm text-gray-400",children:"Cha to BL"}):t.jsx("span",{className:"text-sm text-gray-400",children:" kha"})})]},_.phongBanId))})]})})]})]}),t.jsxs(st,{children:[t.jsxs("div",{className:"p-4 border-b border-gray-200",children:[t.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(ii,{className:"w-5 h-5"}),"Rule Trace - Ngun D Liu"]}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Xem chi tit d liu c s dng  tnh lng t cc ngun khc nhau"})]}),y?t.jsx("div",{className:"p-8 text-center",children:t.jsx(In,{className:"w-8 h-8 animate-spin mx-auto text-blue-500"})}):g&&g.length>0?t.jsx("div",{className:"divide-y divide-gray-200",children:g.map(_=>{var P;return t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>C(_.ruleId*1e3+_.nhanVienId),children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center",children:t.jsx(Pd,{className:"w-5 h-5 text-indigo-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:_.ruleName}),t.jsx("div",{className:"text-sm text-gray-500",children:_.hoTen})]})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-lg font-semibold text-green-600",children:Ze(_.ketQua)}),t.jsx("div",{className:"text-xs text-gray-400",children:new Date(_.ngayChay).toLocaleDateString("vi-VN")})]}),d.has(_.ruleId*1e3+_.nhanVienId)?t.jsx(Pl,{className:"w-5 h-5 text-gray-400"}):t.jsx(Er,{className:"w-5 h-5 text-gray-400"})]})]}),d.has(_.ruleId*1e3+_.nhanVienId)&&t.jsxs("div",{className:"mt-4 pl-14 space-y-3",children:[t.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[t.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Chi tit tnh ton:"}),t.jsx("div",{className:"text-sm font-mono bg-white p-2 rounded border",children:_.chiTiet})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Ngun d liu:"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:(P=_.nguonDuLieu)==null?void 0:P.map((j,A)=>{const L=ZV[j.type],W=L.icon;return t.jsxs("div",{className:`flex items-center gap-2 p-2 rounded-lg ${L.color}`,children:[t.jsx(W,{className:"w-4 h-4"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-sm font-medium",children:L.label}),t.jsxs("div",{className:"text-xs opacity-75",children:[j.sourceId," = ",String(j.value)]})]})]},A)})})]})]})]},`${_.ruleId}-${_.nhanVienId}`)})}):t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx(Pd,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),t.jsxs("p",{children:["Cha c d liu rule trace cho thng ",n,"/",r]})]})]})]})}const Fl={getDiTreVeSom:e=>me.get("/reports/di-tre-ve-som",{params:e}),getOT:e=>me.get("/reports/ot",{params:e}),getNghiPhep:e=>me.get("/reports/nghi-phep",{params:e}),getQuyLuong:e=>me.get("/reports/quy-luong",{params:e}),getHeadcount:e=>me.get("/reports/headcount",{params:e}),getChamCong:e=>me.get("/reports/cham-cong",{params:e}),getDashboard:(e,n)=>me.get("/reports/dashboard",{params:{thang:e,nam:n}})},FT=new Date,tU=FT.getMonth()+1,nU=FT.getFullYear(),ms=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),aU=e=>new Date(e).toLocaleDateString("vi-VN");function rU(){var g,y,N,C,T,S,k;const[e,n]=E.useState("dashboard"),[a,r]=E.useState({thang:tU,nam:nU}),s=Ie({queryKey:["reports","dashboard",a.thang,a.nam],queryFn:()=>Fl.getDashboard(a.thang,a.nam),enabled:e==="dashboard"}),l=Ie({queryKey:["reports","di-tre",a],queryFn:()=>Fl.getDiTreVeSom(a),enabled:e==="di-tre"}),o=Ie({queryKey:["reports","ot",a],queryFn:()=>Fl.getOT(a),enabled:e==="ot"}),d=Ie({queryKey:["reports","nghi-phep",a],queryFn:()=>Fl.getNghiPhep(a),enabled:e==="nghi-phep"}),u=Ie({queryKey:["reports","quy-luong",a],queryFn:()=>Fl.getQuyLuong(a),enabled:e==="quy-luong"}),h=Ie({queryKey:["reports","headcount",a],queryFn:()=>Fl.getHeadcount(a),enabled:e==="headcount"}),m=Ie({queryKey:["reports","cham-cong",a],queryFn:()=>Fl.getChamCong(a),enabled:e==="cham-cong"}),f=s.isLoading||l.isLoading||o.isLoading||d.isLoading||u.isLoading||h.isLoading||m.isLoading,p=()=>{switch(e){case"dashboard":s.refetch();break;case"di-tre":l.refetch();break;case"ot":o.refetch();break;case"nghi-phep":d.refetch();break;case"quy-luong":u.refetch();break;case"headcount":h.refetch();break;case"cham-cong":m.refetch();break}},b=[{key:"dashboard",label:"Dashboard"},{key:"di-tre",label:"i tr/V sm"},{key:"ot",label:"Tng ca (OT)"},{key:"nghi-phep",label:"Ngh php"},{key:"quy-luong",label:"Qu lng"},{key:"headcount",label:"Nhn s"},{key:"cham-cong",label:"Chm cng"}];return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Bo co & Thng k"}),t.jsx("p",{className:"text-slate-500",children:"Xem tng hp v chi tit cc bo co nhn s"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(mt,{variant:"outline",onClick:p,disabled:f,children:[t.jsx(Ra,{className:`h-4 w-4 mr-2 ${f?"animate-spin":""}`}),"Lm mi"]}),t.jsxs(mt,{variant:"primary",children:[t.jsx(qp,{className:"h-4 w-4 mr-2"}),"Xut Excel"]})]})]}),t.jsx(st,{children:t.jsx(Bt,{className:"pt-6",children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Thng"}),t.jsxs("div",{className:"relative",children:[t.jsx("select",{value:a.thang,onChange:_=>r({...a,thang:Number(_.target.value)}),className:"w-32 px-3 py-2 border border-slate-200 rounded-lg appearance-none focus:ring-2 focus:ring-blue-500 bg-white",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(_=>t.jsxs("option",{value:_,children:["Thng ",_]},_))}),t.jsx(Er,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400 pointer-events-none"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Nm"}),t.jsxs("div",{className:"relative",children:[t.jsx("select",{value:a.nam,onChange:_=>r({...a,nam:Number(_.target.value)}),className:"w-28 px-3 py-2 border border-slate-200 rounded-lg appearance-none focus:ring-2 focus:ring-blue-500 bg-white",children:[2023,2024,2025,2026].map(_=>t.jsx("option",{value:_,children:_},_))}),t.jsx(Er,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400 pointer-events-none"})]})]})]})})}),t.jsx("div",{className:"border-b border-slate-200",children:t.jsx("div",{className:"flex flex-wrap gap-1",children:b.map(_=>t.jsx("button",{onClick:()=>n(_.key),className:`px-4 py-3 text-sm font-medium transition-colors ${e===_.key?"text-blue-600 border-b-2 border-blue-600 -mb-[1px]":"text-slate-500 hover:text-slate-900"}`,children:_.label},_.key))})}),t.jsxs("div",{className:"mt-6",children:[e==="dashboard"&&t.jsx(sU,{data:(g=s.data)==null?void 0:g.data,isLoading:s.isLoading}),e==="di-tre"&&t.jsx(iU,{data:(y=l.data)==null?void 0:y.data,isLoading:l.isLoading}),e==="ot"&&t.jsx(lU,{data:(N=o.data)==null?void 0:N.data,isLoading:o.isLoading}),e==="nghi-phep"&&t.jsx(oU,{data:(C=d.data)==null?void 0:C.data,isLoading:d.isLoading}),e==="quy-luong"&&t.jsx(cU,{data:(T=u.data)==null?void 0:T.data,isLoading:u.isLoading}),e==="headcount"&&t.jsx(dU,{data:(S=h.data)==null?void 0:S.data,isLoading:h.isLoading}),e==="cham-cong"&&t.jsx(uU,{data:(k=m.data)==null?void 0:k.data,isLoading:m.isLoading})]})]})}function sU({data:e,isLoading:n}){return n?t.jsx(bo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:e.kpis.map((a,r)=>t.jsx(st,{children:t.jsxs(Bt,{className:"pt-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-slate-500",children:a.ten}),t.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[a.donVi==="VND"?ms(a.giaTri):a.giaTri.toLocaleString(),a.donVi!=="VND"&&t.jsx("span",{className:"text-sm ml-1",children:a.donVi})]})]}),t.jsxs("div",{className:`p-3 rounded-full bg-${a.mau}-100`,children:[a.icon==="users"&&t.jsx(on,{className:"h-6 w-6 text-blue-600"}),a.icon==="dollar"&&t.jsx(Ar,{className:"h-6 w-6 text-green-600"}),a.icon==="clock"&&t.jsx(nn,{className:"h-6 w-6 text-amber-600"}),a.icon==="calendar"&&t.jsx(Ot,{className:"h-6 w-6 text-purple-600"})]})]}),t.jsxs("div",{className:"mt-2 flex items-center text-sm",children:[a.soSanhThangTruoc>=0?t.jsx(al,{className:"h-4 w-4 text-green-500 mr-1"}):t.jsx(ip,{className:"h-4 w-4 text-red-500 mr-1"}),t.jsxs("span",{className:a.soSanhThangTruoc>=0?"text-green-500":"text-red-500",children:[Math.abs(a.soSanhThangTruoc).toFixed(1),"%"]}),t.jsx("span",{className:"text-slate-500 ml-1",children:"so vi thng trc"})]})]})},r))}),e.alerts.length>0&&t.jsxs(st,{children:[t.jsx(Un,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(na,{className:"h-5 w-5 text-amber-500"}),t.jsx("h3",{className:"font-semibold text-lg",children:"Cnh bo & Thng bo"})]})}),t.jsx(Bt,{children:t.jsx("div",{className:"space-y-3",children:e.alerts.map((a,r)=>t.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg ${a.loai==="ERROR"?"bg-red-50 border border-red-200":a.loai==="WARNING"?"bg-amber-50 border border-amber-200":"bg-blue-50 border border-blue-200"}`,children:[a.loai==="ERROR"&&t.jsx(ho,{className:"h-5 w-5 text-red-500 mt-0.5"}),a.loai==="WARNING"&&t.jsx(na,{className:"h-5 w-5 text-amber-500 mt-0.5"}),a.loai==="INFO"&&t.jsx(ij,{className:"h-5 w-5 text-blue-500 mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium",children:a.tieuDe}),t.jsx("p",{className:"text-sm text-slate-600",children:a.moTa})]}),t.jsx(Tt,{variant:"neutral",children:a.soLuong})]},r))})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(st,{children:[t.jsx(Un,{children:t.jsx("h3",{className:"font-semibold",children:"Bin ng nhn s 6 thng"})}),t.jsx(Bt,{children:t.jsx("div",{className:"space-y-4",children:e.bienDongNhanSu.map((a,r)=>{const s=Math.max(...e.bienDongNhanSu.map(l=>l.moiTuyen+l.nghiViec),1);return t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsxs("span",{children:["Thng ",a.thang]}),t.jsxs("span",{className:"text-green-600",children:["+",a.moiTuyen]}),t.jsxs("span",{className:"text-red-600",children:["-",a.nghiViec]})]}),t.jsxs("div",{className:"flex gap-1 h-2",children:[t.jsx("div",{className:"bg-green-500 rounded",style:{width:`${a.moiTuyen/s*100}%`}}),t.jsx("div",{className:"bg-red-500 rounded",style:{width:`${a.nghiViec/s*100}%`}})]})]},r)})})})]}),t.jsxs(st,{children:[t.jsx(Un,{children:t.jsx("h3",{className:"font-semibold",children:"Phn b qu lng theo phng ban"})}),t.jsx(Bt,{children:t.jsx("div",{className:"space-y-3",children:e.phanBoLuongTheoPB.map((a,r)=>t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[t.jsx("span",{children:a.tenPhongBan}),t.jsxs("span",{className:"text-slate-600",children:[a.tyLe.toFixed(1),"%"]})]}),t.jsx("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full rounded-full",style:{width:`${a.tyLe}%`,backgroundColor:`hsl(${210+r*30}, 70%, 50%)`}})})]},r))})})]})]})]}):t.jsx(No,{message:"Khng c d liu dashboard"})}function iU({data:e,isLoading:n}){return n?t.jsx(bo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsx(Wt,{title:"Nhn vin vi phm",value:e.summary.tongNhanVien,icon:t.jsx(on,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"Lt i tr",value:e.summary.tongLuotDiTre,icon:t.jsx(nn,{className:"h-5 w-5"}),color:"red"}),t.jsx(Wt,{title:"Lt v sm",value:e.summary.tongLuotVeSom,icon:t.jsx(nn,{className:"h-5 w-5"}),color:"amber"}),t.jsx(Wt,{title:"Tng pht tr",value:e.summary.tongPhutTre,unit:"pht",icon:t.jsx(nn,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"Tng pht v sm",value:e.summary.tongPhutVeSom,unit:"pht",icon:t.jsx(nn,{className:"h-5 w-5"})})]}),t.jsxs(st,{children:[t.jsx(Un,{children:t.jsx("h3",{className:"font-semibold",children:"Top nhn vin i tr nhiu nht"})}),t.jsx(Bt,{children:t.jsx("div",{className:"space-y-3",children:e.summary.topDiTre.map((a,r)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-red-100 flex items-center justify-center text-red-600 font-bold",children:r+1}),t.jsx("span",{className:"font-medium",children:a.hoTen})]}),t.jsxs(Tt,{variant:"danger",children:[a.soLan," ln"]})]},a.nhanVienId))})})]}),t.jsxs(st,{children:[t.jsx(Un,{children:t.jsxs("h3",{className:"font-semibold",children:["Chi tit (",e.chiTiet.length," bn ghi)"]})}),t.jsx(Bt,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-slate-200",children:[t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"M NV"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"H tn"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"Phng ban"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"Ngy"}),t.jsx("th",{className:"text-center p-3 font-medium text-slate-600",children:"Gi vo"}),t.jsx("th",{className:"text-center p-3 font-medium text-slate-600",children:"Gi ra"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Pht tr"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Pht v sm"})]})}),t.jsx("tbody",{children:e.chiTiet.slice(0,50).map((a,r)=>t.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[t.jsx("td",{className:"p-3",children:a.maNhanVien}),t.jsx("td",{className:"p-3",children:a.hoTen}),t.jsx("td",{className:"p-3",children:a.phongBan}),t.jsx("td",{className:"p-3",children:aU(a.ngay)}),t.jsx("td",{className:"text-center p-3",children:a.gioVao||"-"}),t.jsx("td",{className:"text-center p-3",children:a.gioRa||"-"}),t.jsx("td",{className:"text-right p-3",children:a.soPhutTre>0&&t.jsx("span",{className:"text-red-600 font-medium",children:a.soPhutTre})}),t.jsx("td",{className:"text-right p-3",children:a.soPhutVeSom>0&&t.jsx("span",{className:"text-amber-600 font-medium",children:a.soPhutVeSom})})]},r))})]})})})]})]}):t.jsx(No,{message:"Khng c d liu i tr/v sm"})}function lU({data:e,isLoading:n}){return n?t.jsx(bo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsx(Wt,{title:"Nhn vin OT",value:e.summary.tongNhanVien,icon:t.jsx(on,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"Tng gi OT",value:e.summary.tongGioOT.toFixed(1),unit:"gi",icon:t.jsx(nn,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Wt,{title:"Tng tin OT",value:ms(e.summary.tongTienOT),icon:t.jsx(Ar,{className:"h-5 w-5"}),color:"green"}),t.jsx(Wt,{title:"TB gi OT/ngy",value:e.summary.trungBinhGioOTNgay.toFixed(2),unit:"gi",icon:t.jsx(nn,{className:"h-5 w-5"})})]}),t.jsxs(st,{children:[t.jsx(Un,{children:t.jsx("h3",{className:"font-semibold",children:"Top phng ban OT nhiu nht"})}),t.jsx(Bt,{children:t.jsx("div",{className:"space-y-3",children:e.summary.phongBanNhieuOTNhat.map((a,r)=>{const s=Math.max(...e.summary.phongBanNhieuOTNhat.map(l=>l.tongGio),1);return t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[t.jsx("span",{children:a.phongBan}),t.jsxs("span",{className:"font-medium",children:[a.tongGio.toFixed(1)," gi"]})]}),t.jsx("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${a.tongGio/s*100}%`}})})]},r)})})})]})]}):t.jsx(No,{message:"Khng c d liu tng ca"})}function oU({data:e,isLoading:n}){return n?t.jsx(bo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsx(Wt,{title:"Tng n",value:e.summary.tongDon,icon:t.jsx(Ot,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"Tng ngy ngh",value:e.summary.tongNgayNghi,unit:"ngy",icon:t.jsx(Ot,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Wt,{title:" duyt",value:e.summary.daDuyet,icon:t.jsx(Ot,{className:"h-5 w-5"}),color:"green"}),t.jsx(Wt,{title:"Ch duyt",value:e.summary.choDuyet,icon:t.jsx(nn,{className:"h-5 w-5"}),color:"amber"}),t.jsx(Wt,{title:"T chi",value:e.summary.tuChoi,icon:t.jsx(ho,{className:"h-5 w-5"}),color:"red"})]}),t.jsxs(st,{children:[t.jsx(Un,{children:t.jsx("h3",{className:"font-semibold",children:"Thng k theo loi ngh"})}),t.jsx(Bt,{children:t.jsx("div",{className:"space-y-3",children:e.summary.theoLoai.map((a,r)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[t.jsx("span",{children:a.loai||"Cha phn loi"}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs(Tt,{variant:"info",children:[a.soDon," n"]}),t.jsxs(Tt,{variant:"warning",children:[a.soNgay," ngy"]})]})]},r))})})]})]}):t.jsx(No,{message:"Khng c d liu ngh php"})}function cU({data:e,isLoading:n}){return n?t.jsx(bo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsx(Wt,{title:"Tng qu lng",value:ms(e.summary.tongQuyLuong),icon:t.jsx(Ar,{className:"h-5 w-5"}),color:"green"}),t.jsx(Wt,{title:"Tng nhn vin",value:e.summary.tongNhanVien,icon:t.jsx(on,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"Lng trung bnh",value:ms(e.summary.luongTrungBinh),icon:t.jsx(Ar,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Wt,{title:"Tng thu TNCN",value:ms(e.summary.tongThueTNCN),icon:t.jsx(Ar,{className:"h-5 w-5"}),color:"red"})]}),t.jsxs(st,{children:[t.jsx(Un,{children:t.jsx("h3",{className:"font-semibold",children:"Qu lng theo phng ban"})}),t.jsx(Bt,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-slate-200",children:[t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"Phng ban"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Nhn vin"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Lng c bn"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Ph cp"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Thng"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Khu tr"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Thc lnh"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"T l"})]})}),t.jsx("tbody",{children:e.theoPhongBan.map((a,r)=>t.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[t.jsx("td",{className:"p-3 font-medium",children:a.tenPhongBan}),t.jsx("td",{className:"text-right p-3",children:a.tongNhanVien}),t.jsx("td",{className:"text-right p-3",children:ms(a.tongLuongCoBan)}),t.jsx("td",{className:"text-right p-3",children:ms(a.tongPhuCap)}),t.jsx("td",{className:"text-right p-3",children:ms(a.tongThuong)}),t.jsx("td",{className:"text-right p-3 text-red-600",children:ms(a.tongKhauTru)}),t.jsx("td",{className:"text-right p-3 font-medium text-green-600",children:ms(a.tongThucLinh)}),t.jsxs("td",{className:"text-right p-3",children:[a.tyLeQuyLuong.toFixed(1),"%"]})]},r))})]})})})]})]}):t.jsx(No,{message:"Khng c d liu qu lng"})}function dU({data:e,isLoading:n}){return n?t.jsx(bo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsx(Wt,{title:"Tng nhn s",value:e.summary.tongNhanVien,icon:t.jsx(on,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"ang lm",value:e.summary.dangLam,icon:t.jsx(on,{className:"h-5 w-5"}),color:"green"}),t.jsx(Wt,{title:"Mi tuyn",value:e.summary.moiTuyenThang,icon:t.jsx(al,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Wt,{title:"Ngh vic",value:e.summary.nghiViecThang,icon:t.jsx(ip,{className:"h-5 w-5"}),color:"red"}),t.jsx(Wt,{title:"T l ngh vic",value:`${e.summary.tyLeNghiViec.toFixed(1)}%`,icon:t.jsx(ip,{className:"h-5 w-5"}),color:"amber"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(st,{children:[t.jsx(Un,{children:t.jsx("h3",{className:"font-semibold",children:"Phn b theo gii tnh"})}),t.jsx(Bt,{children:t.jsxs("div",{className:"flex items-center justify-center gap-8",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-20 h-20 rounded-full bg-blue-100 flex items-center justify-center mx-auto mb-2",children:t.jsx("span",{className:"text-2xl font-bold text-blue-600",children:e.summary.theoGioiTinh.nam})}),t.jsx("span",{className:"text-slate-600",children:"Nam"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-20 h-20 rounded-full bg-pink-100 flex items-center justify-center mx-auto mb-2",children:t.jsx("span",{className:"text-2xl font-bold text-pink-600",children:e.summary.theoGioiTinh.nu})}),t.jsx("span",{className:"text-slate-600",children:"N"})]})]})})]}),t.jsxs(st,{children:[t.jsx(Un,{children:t.jsx("h3",{className:"font-semibold",children:"Phn b theo  tui"})}),t.jsx(Bt,{children:t.jsx("div",{className:"space-y-3",children:[{label:"Di 25",value:e.summary.theoDoTuoi.duoi25},{label:"25-35",value:e.summary.theoDoTuoi.tu25den35},{label:"35-45",value:e.summary.theoDoTuoi.tu35den45},{label:"Trn 45",value:e.summary.theoDoTuoi.tren45}].map((a,r)=>t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[t.jsx("span",{children:a.label}),t.jsxs("span",{className:"font-medium",children:[a.value," ngi"]})]}),t.jsx("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-purple-500 rounded-full",style:{width:`${e.summary.tongNhanVien>0?a.value/e.summary.tongNhanVien*100:0}%`}})})]},r))})})]})]})]}):t.jsx(No,{message:"Khng c d liu nhn s"})}function uU({data:e,isLoading:n}){return n?t.jsx(bo,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsx(Wt,{title:"Ngy cng chun",value:e.summary.ngayCongChuan,unit:"ngy",icon:t.jsx(Ot,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"Tng nhn vin",value:e.summary.tongNhanVien,icon:t.jsx(on,{className:"h-5 w-5"})}),t.jsx(Wt,{title:"TB ngy cng",value:e.summary.trungBinhNgayCong.toFixed(1),unit:"ngy",icon:t.jsx(Ot,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Wt,{title:"T l i lm",value:`${e.summary.tyLeDiLamTrungBinh.toFixed(1)}%`,icon:t.jsx(al,{className:"h-5 w-5"}),color:"green"}),t.jsx(Wt,{title:"Tng gi OT",value:e.summary.tongGioOT.toFixed(1),unit:"gi",icon:t.jsx(nn,{className:"h-5 w-5"}),color:"amber"})]}),t.jsxs(st,{children:[t.jsx(Un,{children:t.jsxs("h3",{className:"font-semibold",children:["Chi tit chm cng (",e.chiTiet.length," nhn vin)"]})}),t.jsx(Bt,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-slate-200",children:[t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"M NV"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"H tn"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"Phng ban"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Cng chun"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Cng thc"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Ngy ngh"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"i tr"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"V sm"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Gi OT"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"T l"})]})}),t.jsx("tbody",{children:e.chiTiet.slice(0,50).map((a,r)=>t.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[t.jsx("td",{className:"p-3",children:a.maNhanVien}),t.jsx("td",{className:"p-3",children:a.hoTen}),t.jsx("td",{className:"p-3",children:a.phongBan}),t.jsx("td",{className:"text-right p-3",children:a.ngayCongChuan}),t.jsx("td",{className:"text-right p-3 font-medium",children:a.ngayCongThuc}),t.jsx("td",{className:"text-right p-3",children:a.ngayNghi+a.ngayPhep}),t.jsx("td",{className:"text-right p-3",children:a.soLanDiTre>0&&t.jsx("span",{className:"text-red-600",children:a.soLanDiTre})}),t.jsx("td",{className:"text-right p-3",children:a.soLanVeSom>0&&t.jsx("span",{className:"text-amber-600",children:a.soLanVeSom})}),t.jsx("td",{className:"text-right p-3",children:a.tongGioOT>0&&t.jsx("span",{className:"text-blue-600",children:a.tongGioOT.toFixed(1)})}),t.jsx("td",{className:"text-right p-3",children:t.jsxs(Tt,{variant:a.tyLeDiLam>=90?"success":a.tyLeDiLam>=80?"warning":"danger",children:[a.tyLeDiLam.toFixed(1),"%"]})})]},r))})]})})})]})]}):t.jsx(No,{message:"Khng c d liu chm cng"})}function Wt({title:e,value:n,unit:a,icon:r,color:s="gray"}){const l={gray:"bg-slate-100",red:"bg-red-100",amber:"bg-amber-100",green:"bg-green-100",blue:"bg-blue-100"};return t.jsx(st,{children:t.jsx(Bt,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-slate-500",children:e}),t.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[n,a&&t.jsx("span",{className:"text-sm font-normal ml-1",children:a})]})]}),t.jsx("div",{className:`p-3 rounded-full ${l[s]||l.gray}`,children:r})]})})})}function bo(){return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[1,2,3,4].map(e=>t.jsx(st,{children:t.jsx(Bt,{className:"pt-6",children:t.jsx("div",{className:"h-16 bg-slate-200 animate-pulse rounded"})})},e))}),t.jsx(st,{children:t.jsx(Bt,{className:"pt-6",children:t.jsx("div",{className:"h-64 bg-slate-200 animate-pulse rounded"})})})]})}function No({message:e}){return t.jsx(st,{children:t.jsx(Bt,{className:"pt-6",children:t.jsxs("div",{className:"text-center py-12 text-slate-500",children:[t.jsx(Ot,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:e})]})})})}function hU(){return t.jsxs(s3,{children:[t.jsx(rt,{path:"/dang-nhap",element:t.jsx(SD,{})}),t.jsxs(rt,{path:"/",element:t.jsx(V5,{}),children:[t.jsx(rt,{index:!0,element:t.jsx(J5,{})}),t.jsx(rt,{path:"bang-luong",element:t.jsx(Z5,{})}),t.jsx(rt,{path:"bang-luong/:id",element:t.jsx(X6,{})}),t.jsx(rt,{path:"nhan-vien",element:t.jsx(J6,{})}),t.jsx(rt,{path:"nhan-vien/:id",element:t.jsx(vD,{})}),t.jsx(rt,{path:"nhom-nhan-vien",element:t.jsx(CD,{})}),t.jsx(rt,{path:"phong-ban",element:t.jsx(kD,{})}),t.jsx(rt,{path:"khoan-luong",element:t.jsx(bD,{})}),t.jsx(rt,{path:"cham-cong",element:t.jsx(wD,{})}),t.jsx(rt,{path:"import-excel",element:t.jsx(ND,{})}),t.jsx(rt,{path:"cai-dat",element:t.jsx(TD,{})}),t.jsx(rt,{path:"quy-che",element:t.jsx(Pt,{children:t.jsx(RD,{})})}),t.jsx(rt,{path:"quy-che/:id",element:t.jsx(Pt,{children:t.jsx(WD,{})})}),t.jsx(rt,{path:"su-kien",element:t.jsx(Pt,{children:t.jsx(QD,{})})}),t.jsx(rt,{path:"rule-trace",element:t.jsx(Pt,{children:t.jsx(JD,{})})}),t.jsx(rt,{path:"kpi/template",element:t.jsx(Pt,{children:t.jsx(ED,{})})}),t.jsx(rt,{path:"kpi/ky-danh-gia",element:t.jsx(Pt,{children:t.jsx(FD,{})})}),t.jsx(rt,{path:"kpi/cau-hinh-thuong",element:t.jsx(Pt,{children:t.jsx(AD,{})})}),t.jsx(rt,{path:"import-chia-hang",element:t.jsx(Pt,{children:t.jsx(iV,{})})}),t.jsx(rt,{path:"import-giao-hang",element:t.jsx(Pt,{children:t.jsx(lV,{})})}),t.jsx(rt,{path:"lich-su-import",element:t.jsx(Pt,{children:t.jsx(oV,{})})}),t.jsx(rt,{path:"ung-luong",element:t.jsx(Pt,{children:t.jsx(uV,{})})}),t.jsx(rt,{path:"ung-luong/:id",element:t.jsx(Pt,{children:t.jsx(xV,{})})}),t.jsx(rt,{path:"so-luong/nhan-vien",element:t.jsx(Pt,{children:t.jsx(mV,{})})}),t.jsx(rt,{path:"so-luong/phong-ban",element:t.jsx(Pt,{children:t.jsx(fV,{})})}),t.jsx(rt,{path:"nghi-phep/loai-nghi",element:t.jsx(Pt,{children:t.jsx(yV,{})})}),t.jsx(rt,{path:"nghi-phep/don-cua-toi",element:t.jsx(Pt,{children:t.jsx(vV,{})})}),t.jsx(rt,{path:"nghi-phep/duyet",element:t.jsx(Pt,{children:t.jsx(bV,{})})}),t.jsx(rt,{path:"nghi-phep/lich",element:t.jsx(Pt,{children:t.jsx(NV,{})})}),t.jsx(rt,{path:"xep-ca/danh-muc-ca",element:t.jsx(Pt,{children:t.jsx(jV,{})})}),t.jsx(rt,{path:"xep-ca/lich-phan-ca",element:t.jsx(Pt,{children:t.jsx(wV,{})})}),t.jsx(rt,{path:"yeu-cau/don-cua-toi",element:t.jsx(Pt,{children:t.jsx(kV,{})})}),t.jsx(rt,{path:"yeu-cau/duyet",element:t.jsx(Pt,{children:t.jsx(TV,{})})}),t.jsx(rt,{path:"quan-tri/nguoi-dung",element:t.jsx(Pt,{children:t.jsx(PD,{})})}),t.jsx(rt,{path:"quan-tri/audit-log",element:t.jsx(Pt,{children:t.jsx(LD,{})})}),t.jsx(rt,{path:"anti-fraud/geofence",element:t.jsx(Pt,{children:t.jsx(HV,{})})}),t.jsx(rt,{path:"anti-fraud/gps-logs",element:t.jsx(Pt,{children:t.jsx(VV,{})})}),t.jsx(rt,{path:"anti-fraud/devices",element:t.jsx(Pt,{children:t.jsx(UV,{})})}),t.jsx(rt,{path:"timesheet",element:t.jsx(Pt,{children:t.jsx(QV,{})})}),t.jsx(rt,{path:"payroll-sync",element:t.jsx(Pt,{children:t.jsx(eU,{})})}),t.jsx(rt,{path:"reports",element:t.jsx(Pt,{children:t.jsx(rU,{})})}),t.jsx(rt,{path:"*",element:t.jsx(a3,{to:"/",replace:!0})})]}),t.jsxs(rt,{path:"/portal",element:t.jsx(Pt,{children:t.jsx(SV,{})}),children:[t.jsx(rt,{index:!0,element:t.jsx(AV,{})}),t.jsx(rt,{path:"lich-lam",element:t.jsx(PV,{})}),t.jsx(rt,{path:"cham-cong",element:t.jsx(LV,{})}),t.jsx(rt,{path:"yeu-cau",element:t.jsx(OV,{})}),t.jsx(rt,{path:"ca-nhan",element:t.jsx(IV,{})}),t.jsx(rt,{path:"thong-bao",element:t.jsx(u2,{})})]}),t.jsx(rt,{path:"/thong-bao",element:t.jsx(Pt,{children:t.jsx(u2,{})})})]})}const xU=new YC({defaultOptions:{queries:{staleTime:300*1e3,retry:1}}});SC.createRoot(document.getElementById("root")).render(t.jsx(E.StrictMode,{children:t.jsx(JC,{client:xU,children:t.jsx(x3,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:t.jsxs(C5,{children:[t.jsx(hU,{}),t.jsx(s_,{position:"top-right",toastOptions:{duration:3e3,style:{background:"#333",color:"#fff"}}})]})})})}));
