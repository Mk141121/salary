var vC=Object.defineProperty;var S1=e=>{throw TypeError(e)};var bC=(e,n,a)=>n in e?vC(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a;var $m=(e,n,a)=>bC(e,typeof n!="symbol"?n+"":n,a),Gm=(e,n,a)=>n.has(e)||S1("Cannot "+a);var oe=(e,n,a)=>(Gm(e,n,"read from private field"),a?a.call(e):n.get(e)),nt=(e,n,a)=>n.has(e)?S1("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(e):n.set(e,a),$e=(e,n,a,r)=>(Gm(e,n,"write to private field"),r?r.call(e,a):n.set(e,a),a),yt=(e,n,a)=>(Gm(e,n,"access private method"),a);var Rh=(e,n,a,r)=>({set _(s){$e(e,n,s,a)},get _(){return oe(e,n,r)}});function NC(e,n){for(var a=0;a<n.length;a++){const r=n[a];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const l=Object.getOwnPropertyDescriptor(r,s);l&&Object.defineProperty(e,s,l.get?l:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function a(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(s){if(s.ep)return;s.ep=!0;const l=a(s);fetch(s.href,l)}})();function Ip(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var qm={exports:{}},Nd={},Wm={exports:{}},Nt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _1;function jC(){if(_1)return Nt;_1=1;var e=Symbol.for("react.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),o=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),f=Symbol.iterator;function p(K){return K===null||typeof K!="object"?null:(K=f&&K[f]||K["@@iterator"],typeof K=="function"?K:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,y={};function N(K,A,M){this.props=K,this.context=A,this.refs=y,this.updater=M||b}N.prototype.isReactComponent={},N.prototype.setState=function(K,A){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,A,"setState")},N.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function k(){}k.prototype=N.prototype;function T(K,A,M){this.props=K,this.context=A,this.refs=y,this.updater=M||b}var S=T.prototype=new k;S.constructor=T,g(S,N.prototype),S.isPureReactComponent=!0;var w=Array.isArray,_=Object.prototype.hasOwnProperty,L={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function P(K,A,M){var I,V={},J=null,ge=null;if(A!=null)for(I in A.ref!==void 0&&(ge=A.ref),A.key!==void 0&&(J=""+A.key),A)_.call(A,I)&&!C.hasOwnProperty(I)&&(V[I]=A[I]);var z=arguments.length-2;if(z===1)V.children=M;else if(1<z){for(var le=Array(z),ue=0;ue<z;ue++)le[ue]=arguments[ue+2];V.children=le}if(K&&K.defaultProps)for(I in z=K.defaultProps,z)V[I]===void 0&&(V[I]=z[I]);return{$$typeof:e,type:K,key:J,ref:ge,props:V,_owner:L.current}}function F(K,A){return{$$typeof:e,type:K.type,key:A,ref:K.ref,props:K.props,_owner:K._owner}}function H(K){return typeof K=="object"&&K!==null&&K.$$typeof===e}function O(K){var A={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(M){return A[M]})}var B=/\/+/g;function W(K,A){return typeof K=="object"&&K!==null&&K.key!=null?O(""+K.key):A.toString(36)}function ee(K,A,M,I,V){var J=typeof K;(J==="undefined"||J==="boolean")&&(K=null);var ge=!1;if(K===null)ge=!0;else switch(J){case"string":case"number":ge=!0;break;case"object":switch(K.$$typeof){case e:case n:ge=!0}}if(ge)return ge=K,V=V(ge),K=I===""?"."+W(ge,0):I,w(V)?(M="",K!=null&&(M=K.replace(B,"$&/")+"/"),ee(V,A,M,"",function(ue){return ue})):V!=null&&(H(V)&&(V=F(V,M+(!V.key||ge&&ge.key===V.key?"":(""+V.key).replace(B,"$&/")+"/")+K)),A.push(V)),1;if(ge=0,I=I===""?".":I+":",w(K))for(var z=0;z<K.length;z++){J=K[z];var le=I+W(J,z);ge+=ee(J,A,M,le,V)}else if(le=p(K),typeof le=="function")for(K=le.call(K),z=0;!(J=K.next()).done;)J=J.value,le=I+W(J,z++),ge+=ee(J,A,M,le,V);else if(J==="object")throw A=String(K),Error("Objects are not valid as a React child (found: "+(A==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":A)+"). If you meant to render a collection of children, use an array instead.");return ge}function q(K,A,M){if(K==null)return K;var I=[],V=0;return ee(K,I,"","",function(J){return A.call(M,J,V++)}),I}function fe(K){if(K._status===-1){var A=K._result;A=A(),A.then(function(M){(K._status===0||K._status===-1)&&(K._status=1,K._result=M)},function(M){(K._status===0||K._status===-1)&&(K._status=2,K._result=M)}),K._status===-1&&(K._status=0,K._result=A)}if(K._status===1)return K._result.default;throw K._result}var ne={current:null},Y={transition:null},X={ReactCurrentDispatcher:ne,ReactCurrentBatchConfig:Y,ReactCurrentOwner:L};function xe(){throw Error("act(...) is not supported in production builds of React.")}return Nt.Children={map:q,forEach:function(K,A,M){q(K,function(){A.apply(this,arguments)},M)},count:function(K){var A=0;return q(K,function(){A++}),A},toArray:function(K){return q(K,function(A){return A})||[]},only:function(K){if(!H(K))throw Error("React.Children.only expected to receive a single React element child.");return K}},Nt.Component=N,Nt.Fragment=a,Nt.Profiler=s,Nt.PureComponent=T,Nt.StrictMode=r,Nt.Suspense=u,Nt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,Nt.act=xe,Nt.cloneElement=function(K,A,M){if(K==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+K+".");var I=g({},K.props),V=K.key,J=K.ref,ge=K._owner;if(A!=null){if(A.ref!==void 0&&(J=A.ref,ge=L.current),A.key!==void 0&&(V=""+A.key),K.type&&K.type.defaultProps)var z=K.type.defaultProps;for(le in A)_.call(A,le)&&!C.hasOwnProperty(le)&&(I[le]=A[le]===void 0&&z!==void 0?z[le]:A[le])}var le=arguments.length-2;if(le===1)I.children=M;else if(1<le){z=Array(le);for(var ue=0;ue<le;ue++)z[ue]=arguments[ue+2];I.children=z}return{$$typeof:e,type:K.type,key:V,ref:J,props:I,_owner:ge}},Nt.createContext=function(K){return K={$$typeof:o,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},K.Provider={$$typeof:l,_context:K},K.Consumer=K},Nt.createElement=P,Nt.createFactory=function(K){var A=P.bind(null,K);return A.type=K,A},Nt.createRef=function(){return{current:null}},Nt.forwardRef=function(K){return{$$typeof:d,render:K}},Nt.isValidElement=H,Nt.lazy=function(K){return{$$typeof:m,_payload:{_status:-1,_result:K},_init:fe}},Nt.memo=function(K,A){return{$$typeof:x,type:K,compare:A===void 0?null:A}},Nt.startTransition=function(K){var A=Y.transition;Y.transition={};try{K()}finally{Y.transition=A}},Nt.unstable_act=xe,Nt.useCallback=function(K,A){return ne.current.useCallback(K,A)},Nt.useContext=function(K){return ne.current.useContext(K)},Nt.useDebugValue=function(){},Nt.useDeferredValue=function(K){return ne.current.useDeferredValue(K)},Nt.useEffect=function(K,A){return ne.current.useEffect(K,A)},Nt.useId=function(){return ne.current.useId()},Nt.useImperativeHandle=function(K,A,M){return ne.current.useImperativeHandle(K,A,M)},Nt.useInsertionEffect=function(K,A){return ne.current.useInsertionEffect(K,A)},Nt.useLayoutEffect=function(K,A){return ne.current.useLayoutEffect(K,A)},Nt.useMemo=function(K,A){return ne.current.useMemo(K,A)},Nt.useReducer=function(K,A,M){return ne.current.useReducer(K,A,M)},Nt.useRef=function(K){return ne.current.useRef(K)},Nt.useState=function(K){return ne.current.useState(K)},Nt.useSyncExternalStore=function(K,A,M){return ne.current.useSyncExternalStore(K,A,M)},Nt.useTransition=function(){return ne.current.useTransition()},Nt.version="18.3.1",Nt}var E1;function Op(){return E1||(E1=1,Wm.exports=jC()),Wm.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D1;function wC(){if(D1)return Nd;D1=1;var e=Op(),n=Symbol.for("react.element"),a=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function o(d,u,x){var m,f={},p=null,b=null;x!==void 0&&(p=""+x),u.key!==void 0&&(p=""+u.key),u.ref!==void 0&&(b=u.ref);for(m in u)r.call(u,m)&&!l.hasOwnProperty(m)&&(f[m]=u[m]);if(d&&d.defaultProps)for(m in u=d.defaultProps,u)f[m]===void 0&&(f[m]=u[m]);return{$$typeof:n,type:d,key:p,ref:b,props:f,_owner:s.current}}return Nd.Fragment=a,Nd.jsx=o,Nd.jsxs=o,Nd}var A1;function kC(){return A1||(A1=1,qm.exports=wC()),qm.exports}var t=kC(),E=Op();const S2=Ip(E),TC=NC({__proto__:null,default:S2},[E]);var Bh={},Xm={exports:{}},Ga={},Qm={exports:{}},Ym={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F1;function CC(){return F1||(F1=1,(function(e){function n(Y,X){var xe=Y.length;Y.push(X);e:for(;0<xe;){var K=xe-1>>>1,A=Y[K];if(0<s(A,X))Y[K]=X,Y[xe]=A,xe=K;else break e}}function a(Y){return Y.length===0?null:Y[0]}function r(Y){if(Y.length===0)return null;var X=Y[0],xe=Y.pop();if(xe!==X){Y[0]=xe;e:for(var K=0,A=Y.length,M=A>>>1;K<M;){var I=2*(K+1)-1,V=Y[I],J=I+1,ge=Y[J];if(0>s(V,xe))J<A&&0>s(ge,V)?(Y[K]=ge,Y[J]=xe,K=J):(Y[K]=V,Y[I]=xe,K=I);else if(J<A&&0>s(ge,xe))Y[K]=ge,Y[J]=xe,K=J;else break e}}return X}function s(Y,X){var xe=Y.sortIndex-X.sortIndex;return xe!==0?xe:Y.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,d=o.now();e.unstable_now=function(){return o.now()-d}}var u=[],x=[],m=1,f=null,p=3,b=!1,g=!1,y=!1,N=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(Y){for(var X=a(x);X!==null;){if(X.callback===null)r(x);else if(X.startTime<=Y)r(x),X.sortIndex=X.expirationTime,n(u,X);else break;X=a(x)}}function w(Y){if(y=!1,S(Y),!g)if(a(u)!==null)g=!0,fe(_);else{var X=a(x);X!==null&&ne(w,X.startTime-Y)}}function _(Y,X){g=!1,y&&(y=!1,k(P),P=-1),b=!0;var xe=p;try{for(S(X),f=a(u);f!==null&&(!(f.expirationTime>X)||Y&&!O());){var K=f.callback;if(typeof K=="function"){f.callback=null,p=f.priorityLevel;var A=K(f.expirationTime<=X);X=e.unstable_now(),typeof A=="function"?f.callback=A:f===a(u)&&r(u),S(X)}else r(u);f=a(u)}if(f!==null)var M=!0;else{var I=a(x);I!==null&&ne(w,I.startTime-X),M=!1}return M}finally{f=null,p=xe,b=!1}}var L=!1,C=null,P=-1,F=5,H=-1;function O(){return!(e.unstable_now()-H<F)}function B(){if(C!==null){var Y=e.unstable_now();H=Y;var X=!0;try{X=C(!0,Y)}finally{X?W():(L=!1,C=null)}}else L=!1}var W;if(typeof T=="function")W=function(){T(B)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,q=ee.port2;ee.port1.onmessage=B,W=function(){q.postMessage(null)}}else W=function(){N(B,0)};function fe(Y){C=Y,L||(L=!0,W())}function ne(Y,X){P=N(function(){Y(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Y){Y.callback=null},e.unstable_continueExecution=function(){g||b||(g=!0,fe(_))},e.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<Y?Math.floor(1e3/Y):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return a(u)},e.unstable_next=function(Y){switch(p){case 1:case 2:case 3:var X=3;break;default:X=p}var xe=p;p=X;try{return Y()}finally{p=xe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Y,X){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var xe=p;p=Y;try{return X()}finally{p=xe}},e.unstable_scheduleCallback=function(Y,X,xe){var K=e.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?K+xe:K):xe=K,Y){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=xe+A,Y={id:m++,callback:X,priorityLevel:Y,startTime:xe,expirationTime:A,sortIndex:-1},xe>K?(Y.sortIndex=xe,n(x,Y),a(u)===null&&Y===a(x)&&(y?(k(P),P=-1):y=!0,ne(w,xe-K))):(Y.sortIndex=A,n(u,Y),g||b||(g=!0,fe(_))),Y},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(Y){var X=p;return function(){var xe=p;p=X;try{return Y.apply(this,arguments)}finally{p=xe}}}})(Ym)),Ym}var L1;function SC(){return L1||(L1=1,Qm.exports=CC()),Qm.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P1;function _C(){if(P1)return Ga;P1=1;var e=Op(),n=SC();function a(i){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+i,h=1;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+i+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function l(i,c){o(i,c),o(i+"Capture",c)}function o(i,c){for(s[i]=c,i=0;i<c.length;i++)r.add(c[i])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,x=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},f={};function p(i){return u.call(f,i)?!0:u.call(m,i)?!1:x.test(i)?f[i]=!0:(m[i]=!0,!1)}function b(i,c,h,v){if(h!==null&&h.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return v?!1:h!==null?!h.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function g(i,c,h,v){if(c===null||typeof c>"u"||b(i,c,h,v))return!0;if(v)return!1;if(h!==null)switch(h.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function y(i,c,h,v,j,D,U){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=v,this.attributeNamespace=j,this.mustUseProperty=h,this.propertyName=i,this.type=c,this.sanitizeURL=D,this.removeEmptyString=U}var N={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){N[i]=new y(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var c=i[0];N[c]=new y(c,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){N[i]=new y(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){N[i]=new y(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){N[i]=new y(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){N[i]=new y(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){N[i]=new y(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){N[i]=new y(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){N[i]=new y(i,5,!1,i.toLowerCase(),null,!1,!1)});var k=/[\-:]([a-z])/g;function T(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var c=i.replace(k,T);N[c]=new y(c,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var c=i.replace(k,T);N[c]=new y(c,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var c=i.replace(k,T);N[c]=new y(c,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){N[i]=new y(i,1,!1,i.toLowerCase(),null,!1,!1)}),N.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){N[i]=new y(i,1,!1,i.toLowerCase(),null,!0,!0)});function S(i,c,h,v){var j=N.hasOwnProperty(c)?N[c]:null;(j!==null?j.type!==0:v||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(g(c,h,j,v)&&(h=null),v||j===null?p(c)&&(h===null?i.removeAttribute(c):i.setAttribute(c,""+h)):j.mustUseProperty?i[j.propertyName]=h===null?j.type===3?!1:"":h:(c=j.attributeName,v=j.attributeNamespace,h===null?i.removeAttribute(c):(j=j.type,h=j===3||j===4&&h===!0?"":""+h,v?i.setAttributeNS(v,c,h):i.setAttribute(c,h))))}var w=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),L=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),H=Symbol.for("react.provider"),O=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),W=Symbol.for("react.suspense"),ee=Symbol.for("react.suspense_list"),q=Symbol.for("react.memo"),fe=Symbol.for("react.lazy"),ne=Symbol.for("react.offscreen"),Y=Symbol.iterator;function X(i){return i===null||typeof i!="object"?null:(i=Y&&i[Y]||i["@@iterator"],typeof i=="function"?i:null)}var xe=Object.assign,K;function A(i){if(K===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);K=c&&c[1]||""}return`
`+K+i}var M=!1;function I(i,c){if(!i||M)return"";M=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(ke){var v=ke}Reflect.construct(i,[],c)}else{try{c.call()}catch(ke){v=ke}i.call(c.prototype)}else{try{throw Error()}catch(ke){v=ke}i()}}catch(ke){if(ke&&v&&typeof ke.stack=="string"){for(var j=ke.stack.split(`
`),D=v.stack.split(`
`),U=j.length-1,se=D.length-1;1<=U&&0<=se&&j[U]!==D[se];)se--;for(;1<=U&&0<=se;U--,se--)if(j[U]!==D[se]){if(U!==1||se!==1)do if(U--,se--,0>se||j[U]!==D[se]){var de=`
`+j[U].replace(" at new "," at ");return i.displayName&&de.includes("<anonymous>")&&(de=de.replace("<anonymous>",i.displayName)),de}while(1<=U&&0<=se);break}}}finally{M=!1,Error.prepareStackTrace=h}return(i=i?i.displayName||i.name:"")?A(i):""}function V(i){switch(i.tag){case 5:return A(i.type);case 16:return A("Lazy");case 13:return A("Suspense");case 19:return A("SuspenseList");case 0:case 2:case 15:return i=I(i.type,!1),i;case 11:return i=I(i.type.render,!1),i;case 1:return i=I(i.type,!0),i;default:return""}}function J(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case C:return"Fragment";case L:return"Portal";case F:return"Profiler";case P:return"StrictMode";case W:return"Suspense";case ee:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case O:return(i.displayName||"Context")+".Consumer";case H:return(i._context.displayName||"Context")+".Provider";case B:var c=i.render;return i=i.displayName,i||(i=c.displayName||c.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case q:return c=i.displayName||null,c!==null?c:J(i.type)||"Memo";case fe:c=i._payload,i=i._init;try{return J(i(c))}catch{}}return null}function ge(i){var c=i.type;switch(i.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=c.render,i=i.displayName||i.name||"",c.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return J(c);case 8:return c===P?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function z(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function le(i){var c=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function ue(i){var c=le(i)?"checked":"value",h=Object.getOwnPropertyDescriptor(i.constructor.prototype,c),v=""+i[c];if(!i.hasOwnProperty(c)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var j=h.get,D=h.set;return Object.defineProperty(i,c,{configurable:!0,get:function(){return j.call(this)},set:function(U){v=""+U,D.call(this,U)}}),Object.defineProperty(i,c,{enumerable:h.enumerable}),{getValue:function(){return v},setValue:function(U){v=""+U},stopTracking:function(){i._valueTracker=null,delete i[c]}}}}function ce(i){i._valueTracker||(i._valueTracker=ue(i))}function R(i){if(!i)return!1;var c=i._valueTracker;if(!c)return!0;var h=c.getValue(),v="";return i&&(v=le(i)?i.checked?"true":"false":i.value),i=v,i!==h?(c.setValue(i),!0):!1}function pe(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Oe(i,c){var h=c.checked;return xe({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??i._wrapperState.initialChecked})}function tt(i,c){var h=c.defaultValue==null?"":c.defaultValue,v=c.checked!=null?c.checked:c.defaultChecked;h=z(c.value!=null?c.value:h),i._wrapperState={initialChecked:v,initialValue:h,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function Ye(i,c){c=c.checked,c!=null&&S(i,"checked",c,!1)}function Re(i,c){Ye(i,c);var h=z(c.value),v=c.type;if(h!=null)v==="number"?(h===0&&i.value===""||i.value!=h)&&(i.value=""+h):i.value!==""+h&&(i.value=""+h);else if(v==="submit"||v==="reset"){i.removeAttribute("value");return}c.hasOwnProperty("value")?Ht(i,c.type,h):c.hasOwnProperty("defaultValue")&&Ht(i,c.type,z(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(i.defaultChecked=!!c.defaultChecked)}function Ot(i,c,h){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var v=c.type;if(!(v!=="submit"&&v!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+i._wrapperState.initialValue,h||c===i.value||(i.value=c),i.defaultValue=c}h=i.name,h!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,h!==""&&(i.name=h)}function Ht(i,c,h){(c!=="number"||pe(i.ownerDocument)!==i)&&(h==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+h&&(i.defaultValue=""+h))}var rn=Array.isArray;function Fn(i,c,h,v){if(i=i.options,c){c={};for(var j=0;j<h.length;j++)c["$"+h[j]]=!0;for(h=0;h<i.length;h++)j=c.hasOwnProperty("$"+i[h].value),i[h].selected!==j&&(i[h].selected=j),j&&v&&(i[h].defaultSelected=!0)}else{for(h=""+z(h),c=null,j=0;j<i.length;j++){if(i[j].value===h){i[j].selected=!0,v&&(i[j].defaultSelected=!0);return}c!==null||i[j].disabled||(c=i[j])}c!==null&&(c.selected=!0)}}function Ha(i,c){if(c.dangerouslySetInnerHTML!=null)throw Error(a(91));return xe({},c,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Sa(i,c){var h=c.value;if(h==null){if(h=c.children,c=c.defaultValue,h!=null){if(c!=null)throw Error(a(92));if(rn(h)){if(1<h.length)throw Error(a(93));h=h[0]}c=h}c==null&&(c=""),h=c}i._wrapperState={initialValue:z(h)}}function Be(i,c){var h=z(c.value),v=z(c.defaultValue);h!=null&&(h=""+h,h!==i.value&&(i.value=h),c.defaultValue==null&&i.defaultValue!==h&&(i.defaultValue=h)),v!=null&&(i.defaultValue=""+v)}function Xe(i){var c=i.textContent;c===i._wrapperState.initialValue&&c!==""&&c!==null&&(i.value=c)}function Lt(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Wt(i,c){return i==null||i==="http://www.w3.org/1999/xhtml"?Lt(c):i==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var Ct,Rn=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,h,v,j){MSApp.execUnsafeLocalFunction(function(){return i(c,h,v,j)})}:i})(function(i,c){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=c;else{for(Ct=Ct||document.createElement("div"),Ct.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Ct.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;c.firstChild;)i.appendChild(c.firstChild)}});function ot(i,c){if(c){var h=i.firstChild;if(h&&h===i.lastChild&&h.nodeType===3){h.nodeValue=c;return}}i.textContent=c}var Mt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qn=["Webkit","ms","Moz","O"];Object.keys(Mt).forEach(function(i){qn.forEach(function(c){c=c+i.charAt(0).toUpperCase()+i.substring(1),Mt[c]=Mt[i]})});function en(i,c,h){return c==null||typeof c=="boolean"||c===""?"":h||typeof c!="number"||c===0||Mt.hasOwnProperty(i)&&Mt[i]?(""+c).trim():c+"px"}function _a(i,c){i=i.style;for(var h in c)if(c.hasOwnProperty(h)){var v=h.indexOf("--")===0,j=en(h,c[h],v);h==="float"&&(h="cssFloat"),v?i.setProperty(h,j):i[h]=j}}var hi=xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function As(i,c){if(c){if(hi[i]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(a(137,i));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(a(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(a(61))}if(c.style!=null&&typeof c.style!="object")throw Error(a(62))}}function Fs(i,c){if(i.indexOf("-")===-1)return typeof c.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rs=null;function xi(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var wo=null,mi=null,fi=null;function ml(i){if(i=id(i)){if(typeof wo!="function")throw Error(a(280));var c=i.stateNode;c&&(c=Zu(c),wo(i.stateNode,i.type,c))}}function Du(i){mi?fi?fi.push(i):fi=[i]:mi=i}function Au(){if(mi){var i=mi,c=fi;if(fi=mi=null,ml(i),c)for(i=0;i<c.length;i++)ml(c[i])}}function Fu(i,c){return i(c)}function Lu(){}var Bc=!1;function Pu(i,c,h){if(Bc)return i(c,h);Bc=!0;try{return Fu(i,c,h)}finally{Bc=!1,(mi!==null||fi!==null)&&(Lu(),Au())}}function fl(i,c){var h=i.stateNode;if(h===null)return null;var v=Zu(h);if(v===null)return null;h=v[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(i=i.type,v=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!v;break e;default:i=!1}if(i)return null;if(h&&typeof h!="function")throw Error(a(231,c,typeof h));return h}var Hc=!1;if(d)try{var Ls={};Object.defineProperty(Ls,"passive",{get:function(){Hc=!0}}),window.addEventListener("test",Ls,Ls),window.removeEventListener("test",Ls,Ls)}catch{Hc=!1}function ux(i,c,h,v,j,D,U,se,de){var ke=Array.prototype.slice.call(arguments,3);try{c.apply(h,ke)}catch(Fe){this.onError(Fe)}}var pl=!1,ko=null,G=!1,te=null,Q={onError:function(i){pl=!0,ko=i}};function Z(i,c,h,v,j,D,U,se,de){pl=!1,ko=null,ux.apply(Q,arguments)}function ae(i,c,h,v,j,D,U,se,de){if(Z.apply(this,arguments),pl){if(pl){var ke=ko;pl=!1,ko=null}else throw Error(a(198));G||(G=!0,te=ke)}}function re(i){var c=i,h=i;if(i.alternate)for(;c.return;)c=c.return;else{i=c;do c=i,(c.flags&4098)!==0&&(h=c.return),i=c.return;while(i)}return c.tag===3?h:null}function Ne(i){if(i.tag===13){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function Se(i){if(re(i)!==i)throw Error(a(188))}function be(i){var c=i.alternate;if(!c){if(c=re(i),c===null)throw Error(a(188));return c!==i?null:i}for(var h=i,v=c;;){var j=h.return;if(j===null)break;var D=j.alternate;if(D===null){if(v=j.return,v!==null){h=v;continue}break}if(j.child===D.child){for(D=j.child;D;){if(D===h)return Se(j),i;if(D===v)return Se(j),c;D=D.sibling}throw Error(a(188))}if(h.return!==v.return)h=j,v=D;else{for(var U=!1,se=j.child;se;){if(se===h){U=!0,h=j,v=D;break}if(se===v){U=!0,v=j,h=D;break}se=se.sibling}if(!U){for(se=D.child;se;){if(se===h){U=!0,h=D,v=j;break}if(se===v){U=!0,v=D,h=j;break}se=se.sibling}if(!U)throw Error(a(189))}}if(h.alternate!==v)throw Error(a(190))}if(h.tag!==3)throw Error(a(188));return h.stateNode.current===h?i:c}function je(i){return i=be(i),i!==null?we(i):null}function we(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var c=we(i);if(c!==null)return c;i=i.sibling}return null}var Le=n.unstable_scheduleCallback,ze=n.unstable_cancelCallback,qe=n.unstable_shouldYield,He=n.unstable_requestPaint,Me=n.unstable_now,xt=n.unstable_getCurrentPriorityLevel,Yt=n.unstable_ImmediatePriority,tn=n.unstable_UserBlockingPriority,Tn=n.unstable_NormalPriority,gl=n.unstable_LowPriority,pi=n.unstable_IdlePriority,ss=null,Wn=null;function Vc(i){if(Wn&&typeof Wn.onCommitFiberRoot=="function")try{Wn.onCommitFiberRoot(ss,i,void 0,(i.current.flags&128)===128)}catch{}}var Cn=Math.clz32?Math.clz32:MT,IT=Math.log,OT=Math.LN2;function MT(i){return i>>>=0,i===0?32:31-(IT(i)/OT|0)|0}var Iu=64,Ou=4194304;function Uc(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Mu(i,c){var h=i.pendingLanes;if(h===0)return 0;var v=0,j=i.suspendedLanes,D=i.pingedLanes,U=h&268435455;if(U!==0){var se=U&~j;se!==0?v=Uc(se):(D&=U,D!==0&&(v=Uc(D)))}else U=h&~j,U!==0?v=Uc(U):D!==0&&(v=Uc(D));if(v===0)return 0;if(c!==0&&c!==v&&(c&j)===0&&(j=v&-v,D=c&-c,j>=D||j===16&&(D&4194240)!==0))return c;if((v&4)!==0&&(v|=h&16),c=i.entangledLanes,c!==0)for(i=i.entanglements,c&=v;0<c;)h=31-Cn(c),j=1<<h,v|=i[h],c&=~j;return v}function RT(i,c){switch(i){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function BT(i,c){for(var h=i.suspendedLanes,v=i.pingedLanes,j=i.expirationTimes,D=i.pendingLanes;0<D;){var U=31-Cn(D),se=1<<U,de=j[U];de===-1?((se&h)===0||(se&v)!==0)&&(j[U]=RT(se,c)):de<=c&&(i.expiredLanes|=se),D&=~se}}function hx(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function ry(){var i=Iu;return Iu<<=1,(Iu&4194240)===0&&(Iu=64),i}function xx(i){for(var c=[],h=0;31>h;h++)c.push(i);return c}function Kc(i,c,h){i.pendingLanes|=c,c!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,c=31-Cn(c),i[c]=h}function HT(i,c){var h=i.pendingLanes&~c;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=c,i.mutableReadLanes&=c,i.entangledLanes&=c,c=i.entanglements;var v=i.eventTimes;for(i=i.expirationTimes;0<h;){var j=31-Cn(h),D=1<<j;c[j]=0,v[j]=-1,i[j]=-1,h&=~D}}function mx(i,c){var h=i.entangledLanes|=c;for(i=i.entanglements;h;){var v=31-Cn(h),j=1<<v;j&c|i[v]&c&&(i[v]|=c),h&=~j}}var zt=0;function sy(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var iy,fx,ly,oy,cy,px=!1,Ru=[],gi=null,yi=null,vi=null,zc=new Map,$c=new Map,bi=[],VT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function dy(i,c){switch(i){case"focusin":case"focusout":gi=null;break;case"dragenter":case"dragleave":yi=null;break;case"mouseover":case"mouseout":vi=null;break;case"pointerover":case"pointerout":zc.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":$c.delete(c.pointerId)}}function Gc(i,c,h,v,j,D){return i===null||i.nativeEvent!==D?(i={blockedOn:c,domEventName:h,eventSystemFlags:v,nativeEvent:D,targetContainers:[j]},c!==null&&(c=id(c),c!==null&&fx(c)),i):(i.eventSystemFlags|=v,c=i.targetContainers,j!==null&&c.indexOf(j)===-1&&c.push(j),i)}function UT(i,c,h,v,j){switch(c){case"focusin":return gi=Gc(gi,i,c,h,v,j),!0;case"dragenter":return yi=Gc(yi,i,c,h,v,j),!0;case"mouseover":return vi=Gc(vi,i,c,h,v,j),!0;case"pointerover":var D=j.pointerId;return zc.set(D,Gc(zc.get(D)||null,i,c,h,v,j)),!0;case"gotpointercapture":return D=j.pointerId,$c.set(D,Gc($c.get(D)||null,i,c,h,v,j)),!0}return!1}function uy(i){var c=yl(i.target);if(c!==null){var h=re(c);if(h!==null){if(c=h.tag,c===13){if(c=Ne(h),c!==null){i.blockedOn=c,cy(i.priority,function(){ly(h)});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){i.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Bu(i){if(i.blockedOn!==null)return!1;for(var c=i.targetContainers;0<c.length;){var h=yx(i.domEventName,i.eventSystemFlags,c[0],i.nativeEvent);if(h===null){h=i.nativeEvent;var v=new h.constructor(h.type,h);rs=v,h.target.dispatchEvent(v),rs=null}else return c=id(h),c!==null&&fx(c),i.blockedOn=h,!1;c.shift()}return!0}function hy(i,c,h){Bu(i)&&h.delete(c)}function KT(){px=!1,gi!==null&&Bu(gi)&&(gi=null),yi!==null&&Bu(yi)&&(yi=null),vi!==null&&Bu(vi)&&(vi=null),zc.forEach(hy),$c.forEach(hy)}function qc(i,c){i.blockedOn===c&&(i.blockedOn=null,px||(px=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,KT)))}function Wc(i){function c(j){return qc(j,i)}if(0<Ru.length){qc(Ru[0],i);for(var h=1;h<Ru.length;h++){var v=Ru[h];v.blockedOn===i&&(v.blockedOn=null)}}for(gi!==null&&qc(gi,i),yi!==null&&qc(yi,i),vi!==null&&qc(vi,i),zc.forEach(c),$c.forEach(c),h=0;h<bi.length;h++)v=bi[h],v.blockedOn===i&&(v.blockedOn=null);for(;0<bi.length&&(h=bi[0],h.blockedOn===null);)uy(h),h.blockedOn===null&&bi.shift()}var To=w.ReactCurrentBatchConfig,Hu=!0;function zT(i,c,h,v){var j=zt,D=To.transition;To.transition=null;try{zt=1,gx(i,c,h,v)}finally{zt=j,To.transition=D}}function $T(i,c,h,v){var j=zt,D=To.transition;To.transition=null;try{zt=4,gx(i,c,h,v)}finally{zt=j,To.transition=D}}function gx(i,c,h,v){if(Hu){var j=yx(i,c,h,v);if(j===null)Ix(i,c,v,Vu,h),dy(i,v);else if(UT(j,i,c,h,v))v.stopPropagation();else if(dy(i,v),c&4&&-1<VT.indexOf(i)){for(;j!==null;){var D=id(j);if(D!==null&&iy(D),D=yx(i,c,h,v),D===null&&Ix(i,c,v,Vu,h),D===j)break;j=D}j!==null&&v.stopPropagation()}else Ix(i,c,v,null,h)}}var Vu=null;function yx(i,c,h,v){if(Vu=null,i=xi(v),i=yl(i),i!==null)if(c=re(i),c===null)i=null;else if(h=c.tag,h===13){if(i=Ne(c),i!==null)return i;i=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;i=null}else c!==i&&(i=null);return Vu=i,null}function xy(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xt()){case Yt:return 1;case tn:return 4;case Tn:case gl:return 16;case pi:return 536870912;default:return 16}default:return 16}}var Ni=null,vx=null,Uu=null;function my(){if(Uu)return Uu;var i,c=vx,h=c.length,v,j="value"in Ni?Ni.value:Ni.textContent,D=j.length;for(i=0;i<h&&c[i]===j[i];i++);var U=h-i;for(v=1;v<=U&&c[h-v]===j[D-v];v++);return Uu=j.slice(i,1<v?1-v:void 0)}function Ku(i){var c=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&c===13&&(i=13)):i=c,i===10&&(i=13),32<=i||i===13?i:0}function zu(){return!0}function fy(){return!1}function ar(i){function c(h,v,j,D,U){this._reactName=h,this._targetInst=j,this.type=v,this.nativeEvent=D,this.target=U,this.currentTarget=null;for(var se in i)i.hasOwnProperty(se)&&(h=i[se],this[se]=h?h(D):D[se]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?zu:fy,this.isPropagationStopped=fy,this}return xe(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=zu)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=zu)},persist:function(){},isPersistent:zu}),c}var Co={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bx=ar(Co),Xc=xe({},Co,{view:0,detail:0}),GT=ar(Xc),Nx,jx,Qc,$u=xe({},Xc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kx,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Qc&&(Qc&&i.type==="mousemove"?(Nx=i.screenX-Qc.screenX,jx=i.screenY-Qc.screenY):jx=Nx=0,Qc=i),Nx)},movementY:function(i){return"movementY"in i?i.movementY:jx}}),py=ar($u),qT=xe({},$u,{dataTransfer:0}),WT=ar(qT),XT=xe({},Xc,{relatedTarget:0}),wx=ar(XT),QT=xe({},Co,{animationName:0,elapsedTime:0,pseudoElement:0}),YT=ar(QT),JT=xe({},Co,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),ZT=ar(JT),e4=xe({},Co,{data:0}),gy=ar(e4),t4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},n4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},a4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function r4(i){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(i):(i=a4[i])?!!c[i]:!1}function kx(){return r4}var s4=xe({},Xc,{key:function(i){if(i.key){var c=t4[i.key]||i.key;if(c!=="Unidentified")return c}return i.type==="keypress"?(i=Ku(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?n4[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kx,charCode:function(i){return i.type==="keypress"?Ku(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Ku(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),i4=ar(s4),l4=xe({},$u,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yy=ar(l4),o4=xe({},Xc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kx}),c4=ar(o4),d4=xe({},Co,{propertyName:0,elapsedTime:0,pseudoElement:0}),u4=ar(d4),h4=xe({},$u,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),x4=ar(h4),m4=[9,13,27,32],Tx=d&&"CompositionEvent"in window,Yc=null;d&&"documentMode"in document&&(Yc=document.documentMode);var f4=d&&"TextEvent"in window&&!Yc,vy=d&&(!Tx||Yc&&8<Yc&&11>=Yc),by=" ",Ny=!1;function jy(i,c){switch(i){case"keyup":return m4.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wy(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var So=!1;function p4(i,c){switch(i){case"compositionend":return wy(c);case"keypress":return c.which!==32?null:(Ny=!0,by);case"textInput":return i=c.data,i===by&&Ny?null:i;default:return null}}function g4(i,c){if(So)return i==="compositionend"||!Tx&&jy(i,c)?(i=my(),Uu=vx=Ni=null,So=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return vy&&c.locale!=="ko"?null:c.data;default:return null}}var y4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ky(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c==="input"?!!y4[i.type]:c==="textarea"}function Ty(i,c,h,v){Du(v),c=Qu(c,"onChange"),0<c.length&&(h=new bx("onChange","change",null,h,v),i.push({event:h,listeners:c}))}var Jc=null,Zc=null;function v4(i){Ky(i,0)}function Gu(i){var c=Fo(i);if(R(c))return i}function b4(i,c){if(i==="change")return c}var Cy=!1;if(d){var Cx;if(d){var Sx="oninput"in document;if(!Sx){var Sy=document.createElement("div");Sy.setAttribute("oninput","return;"),Sx=typeof Sy.oninput=="function"}Cx=Sx}else Cx=!1;Cy=Cx&&(!document.documentMode||9<document.documentMode)}function _y(){Jc&&(Jc.detachEvent("onpropertychange",Ey),Zc=Jc=null)}function Ey(i){if(i.propertyName==="value"&&Gu(Zc)){var c=[];Ty(c,Zc,i,xi(i)),Pu(v4,c)}}function N4(i,c,h){i==="focusin"?(_y(),Jc=c,Zc=h,Jc.attachEvent("onpropertychange",Ey)):i==="focusout"&&_y()}function j4(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Gu(Zc)}function w4(i,c){if(i==="click")return Gu(c)}function k4(i,c){if(i==="input"||i==="change")return Gu(c)}function T4(i,c){return i===c&&(i!==0||1/i===1/c)||i!==i&&c!==c}var Ur=typeof Object.is=="function"?Object.is:T4;function ed(i,c){if(Ur(i,c))return!0;if(typeof i!="object"||i===null||typeof c!="object"||c===null)return!1;var h=Object.keys(i),v=Object.keys(c);if(h.length!==v.length)return!1;for(v=0;v<h.length;v++){var j=h[v];if(!u.call(c,j)||!Ur(i[j],c[j]))return!1}return!0}function Dy(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Ay(i,c){var h=Dy(i);i=0;for(var v;h;){if(h.nodeType===3){if(v=i+h.textContent.length,i<=c&&v>=c)return{node:h,offset:c-i};i=v}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Dy(h)}}function Fy(i,c){return i&&c?i===c?!0:i&&i.nodeType===3?!1:c&&c.nodeType===3?Fy(i,c.parentNode):"contains"in i?i.contains(c):i.compareDocumentPosition?!!(i.compareDocumentPosition(c)&16):!1:!1}function Ly(){for(var i=window,c=pe();c instanceof i.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)i=c.contentWindow;else break;c=pe(i.document)}return c}function _x(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c&&(c==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||c==="textarea"||i.contentEditable==="true")}function C4(i){var c=Ly(),h=i.focusedElem,v=i.selectionRange;if(c!==h&&h&&h.ownerDocument&&Fy(h.ownerDocument.documentElement,h)){if(v!==null&&_x(h)){if(c=v.start,i=v.end,i===void 0&&(i=c),"selectionStart"in h)h.selectionStart=c,h.selectionEnd=Math.min(i,h.value.length);else if(i=(c=h.ownerDocument||document)&&c.defaultView||window,i.getSelection){i=i.getSelection();var j=h.textContent.length,D=Math.min(v.start,j);v=v.end===void 0?D:Math.min(v.end,j),!i.extend&&D>v&&(j=v,v=D,D=j),j=Ay(h,D);var U=Ay(h,v);j&&U&&(i.rangeCount!==1||i.anchorNode!==j.node||i.anchorOffset!==j.offset||i.focusNode!==U.node||i.focusOffset!==U.offset)&&(c=c.createRange(),c.setStart(j.node,j.offset),i.removeAllRanges(),D>v?(i.addRange(c),i.extend(U.node,U.offset)):(c.setEnd(U.node,U.offset),i.addRange(c)))}}for(c=[],i=h;i=i.parentNode;)i.nodeType===1&&c.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<c.length;h++)i=c[h],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var S4=d&&"documentMode"in document&&11>=document.documentMode,_o=null,Ex=null,td=null,Dx=!1;function Py(i,c,h){var v=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Dx||_o==null||_o!==pe(v)||(v=_o,"selectionStart"in v&&_x(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),td&&ed(td,v)||(td=v,v=Qu(Ex,"onSelect"),0<v.length&&(c=new bx("onSelect","select",null,c,h),i.push({event:c,listeners:v}),c.target=_o)))}function qu(i,c){var h={};return h[i.toLowerCase()]=c.toLowerCase(),h["Webkit"+i]="webkit"+c,h["Moz"+i]="moz"+c,h}var Eo={animationend:qu("Animation","AnimationEnd"),animationiteration:qu("Animation","AnimationIteration"),animationstart:qu("Animation","AnimationStart"),transitionend:qu("Transition","TransitionEnd")},Ax={},Iy={};d&&(Iy=document.createElement("div").style,"AnimationEvent"in window||(delete Eo.animationend.animation,delete Eo.animationiteration.animation,delete Eo.animationstart.animation),"TransitionEvent"in window||delete Eo.transitionend.transition);function Wu(i){if(Ax[i])return Ax[i];if(!Eo[i])return i;var c=Eo[i],h;for(h in c)if(c.hasOwnProperty(h)&&h in Iy)return Ax[i]=c[h];return i}var Oy=Wu("animationend"),My=Wu("animationiteration"),Ry=Wu("animationstart"),By=Wu("transitionend"),Hy=new Map,Vy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ji(i,c){Hy.set(i,c),l(c,[i])}for(var Fx=0;Fx<Vy.length;Fx++){var Lx=Vy[Fx],_4=Lx.toLowerCase(),E4=Lx[0].toUpperCase()+Lx.slice(1);ji(_4,"on"+E4)}ji(Oy,"onAnimationEnd"),ji(My,"onAnimationIteration"),ji(Ry,"onAnimationStart"),ji("dblclick","onDoubleClick"),ji("focusin","onFocus"),ji("focusout","onBlur"),ji(By,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),D4=new Set("cancel close invalid load scroll toggle".split(" ").concat(nd));function Uy(i,c,h){var v=i.type||"unknown-event";i.currentTarget=h,ae(v,c,void 0,i),i.currentTarget=null}function Ky(i,c){c=(c&4)!==0;for(var h=0;h<i.length;h++){var v=i[h],j=v.event;v=v.listeners;e:{var D=void 0;if(c)for(var U=v.length-1;0<=U;U--){var se=v[U],de=se.instance,ke=se.currentTarget;if(se=se.listener,de!==D&&j.isPropagationStopped())break e;Uy(j,se,ke),D=de}else for(U=0;U<v.length;U++){if(se=v[U],de=se.instance,ke=se.currentTarget,se=se.listener,de!==D&&j.isPropagationStopped())break e;Uy(j,se,ke),D=de}}}if(G)throw i=te,G=!1,te=null,i}function sn(i,c){var h=c[Vx];h===void 0&&(h=c[Vx]=new Set);var v=i+"__bubble";h.has(v)||(zy(c,i,2,!1),h.add(v))}function Px(i,c,h){var v=0;c&&(v|=4),zy(h,i,v,c)}var Xu="_reactListening"+Math.random().toString(36).slice(2);function ad(i){if(!i[Xu]){i[Xu]=!0,r.forEach(function(h){h!=="selectionchange"&&(D4.has(h)||Px(h,!1,i),Px(h,!0,i))});var c=i.nodeType===9?i:i.ownerDocument;c===null||c[Xu]||(c[Xu]=!0,Px("selectionchange",!1,c))}}function zy(i,c,h,v){switch(xy(c)){case 1:var j=zT;break;case 4:j=$T;break;default:j=gx}h=j.bind(null,c,h,i),j=void 0,!Hc||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(j=!0),v?j!==void 0?i.addEventListener(c,h,{capture:!0,passive:j}):i.addEventListener(c,h,!0):j!==void 0?i.addEventListener(c,h,{passive:j}):i.addEventListener(c,h,!1)}function Ix(i,c,h,v,j){var D=v;if((c&1)===0&&(c&2)===0&&v!==null)e:for(;;){if(v===null)return;var U=v.tag;if(U===3||U===4){var se=v.stateNode.containerInfo;if(se===j||se.nodeType===8&&se.parentNode===j)break;if(U===4)for(U=v.return;U!==null;){var de=U.tag;if((de===3||de===4)&&(de=U.stateNode.containerInfo,de===j||de.nodeType===8&&de.parentNode===j))return;U=U.return}for(;se!==null;){if(U=yl(se),U===null)return;if(de=U.tag,de===5||de===6){v=D=U;continue e}se=se.parentNode}}v=v.return}Pu(function(){var ke=D,Fe=xi(h),Pe=[];e:{var Ae=Hy.get(i);if(Ae!==void 0){var Ge=bx,Qe=i;switch(i){case"keypress":if(Ku(h)===0)break e;case"keydown":case"keyup":Ge=i4;break;case"focusin":Qe="focus",Ge=wx;break;case"focusout":Qe="blur",Ge=wx;break;case"beforeblur":case"afterblur":Ge=wx;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ge=py;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ge=WT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ge=c4;break;case Oy:case My:case Ry:Ge=YT;break;case By:Ge=u4;break;case"scroll":Ge=GT;break;case"wheel":Ge=x4;break;case"copy":case"cut":case"paste":Ge=ZT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ge=yy}var Je=(c&4)!==0,Sn=!Je&&i==="scroll",ye=Je?Ae!==null?Ae+"Capture":null:Ae;Je=[];for(var me=ke,ve;me!==null;){ve=me;var Ve=ve.stateNode;if(ve.tag===5&&Ve!==null&&(ve=Ve,ye!==null&&(Ve=fl(me,ye),Ve!=null&&Je.push(rd(me,Ve,ve)))),Sn)break;me=me.return}0<Je.length&&(Ae=new Ge(Ae,Qe,null,h,Fe),Pe.push({event:Ae,listeners:Je}))}}if((c&7)===0){e:{if(Ae=i==="mouseover"||i==="pointerover",Ge=i==="mouseout"||i==="pointerout",Ae&&h!==rs&&(Qe=h.relatedTarget||h.fromElement)&&(yl(Qe)||Qe[Ps]))break e;if((Ge||Ae)&&(Ae=Fe.window===Fe?Fe:(Ae=Fe.ownerDocument)?Ae.defaultView||Ae.parentWindow:window,Ge?(Qe=h.relatedTarget||h.toElement,Ge=ke,Qe=Qe?yl(Qe):null,Qe!==null&&(Sn=re(Qe),Qe!==Sn||Qe.tag!==5&&Qe.tag!==6)&&(Qe=null)):(Ge=null,Qe=ke),Ge!==Qe)){if(Je=py,Ve="onMouseLeave",ye="onMouseEnter",me="mouse",(i==="pointerout"||i==="pointerover")&&(Je=yy,Ve="onPointerLeave",ye="onPointerEnter",me="pointer"),Sn=Ge==null?Ae:Fo(Ge),ve=Qe==null?Ae:Fo(Qe),Ae=new Je(Ve,me+"leave",Ge,h,Fe),Ae.target=Sn,Ae.relatedTarget=ve,Ve=null,yl(Fe)===ke&&(Je=new Je(ye,me+"enter",Qe,h,Fe),Je.target=ve,Je.relatedTarget=Sn,Ve=Je),Sn=Ve,Ge&&Qe)t:{for(Je=Ge,ye=Qe,me=0,ve=Je;ve;ve=Do(ve))me++;for(ve=0,Ve=ye;Ve;Ve=Do(Ve))ve++;for(;0<me-ve;)Je=Do(Je),me--;for(;0<ve-me;)ye=Do(ye),ve--;for(;me--;){if(Je===ye||ye!==null&&Je===ye.alternate)break t;Je=Do(Je),ye=Do(ye)}Je=null}else Je=null;Ge!==null&&$y(Pe,Ae,Ge,Je,!1),Qe!==null&&Sn!==null&&$y(Pe,Sn,Qe,Je,!0)}}e:{if(Ae=ke?Fo(ke):window,Ge=Ae.nodeName&&Ae.nodeName.toLowerCase(),Ge==="select"||Ge==="input"&&Ae.type==="file")var Ze=b4;else if(ky(Ae))if(Cy)Ze=k4;else{Ze=j4;var it=N4}else(Ge=Ae.nodeName)&&Ge.toLowerCase()==="input"&&(Ae.type==="checkbox"||Ae.type==="radio")&&(Ze=w4);if(Ze&&(Ze=Ze(i,ke))){Ty(Pe,Ze,h,Fe);break e}it&&it(i,Ae,ke),i==="focusout"&&(it=Ae._wrapperState)&&it.controlled&&Ae.type==="number"&&Ht(Ae,"number",Ae.value)}switch(it=ke?Fo(ke):window,i){case"focusin":(ky(it)||it.contentEditable==="true")&&(_o=it,Ex=ke,td=null);break;case"focusout":td=Ex=_o=null;break;case"mousedown":Dx=!0;break;case"contextmenu":case"mouseup":case"dragend":Dx=!1,Py(Pe,h,Fe);break;case"selectionchange":if(S4)break;case"keydown":case"keyup":Py(Pe,h,Fe)}var lt;if(Tx)e:{switch(i){case"compositionstart":var ht="onCompositionStart";break e;case"compositionend":ht="onCompositionEnd";break e;case"compositionupdate":ht="onCompositionUpdate";break e}ht=void 0}else So?jy(i,h)&&(ht="onCompositionEnd"):i==="keydown"&&h.keyCode===229&&(ht="onCompositionStart");ht&&(vy&&h.locale!=="ko"&&(So||ht!=="onCompositionStart"?ht==="onCompositionEnd"&&So&&(lt=my()):(Ni=Fe,vx="value"in Ni?Ni.value:Ni.textContent,So=!0)),it=Qu(ke,ht),0<it.length&&(ht=new gy(ht,i,null,h,Fe),Pe.push({event:ht,listeners:it}),lt?ht.data=lt:(lt=wy(h),lt!==null&&(ht.data=lt)))),(lt=f4?p4(i,h):g4(i,h))&&(ke=Qu(ke,"onBeforeInput"),0<ke.length&&(Fe=new gy("onBeforeInput","beforeinput",null,h,Fe),Pe.push({event:Fe,listeners:ke}),Fe.data=lt))}Ky(Pe,c)})}function rd(i,c,h){return{instance:i,listener:c,currentTarget:h}}function Qu(i,c){for(var h=c+"Capture",v=[];i!==null;){var j=i,D=j.stateNode;j.tag===5&&D!==null&&(j=D,D=fl(i,h),D!=null&&v.unshift(rd(i,D,j)),D=fl(i,c),D!=null&&v.push(rd(i,D,j))),i=i.return}return v}function Do(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function $y(i,c,h,v,j){for(var D=c._reactName,U=[];h!==null&&h!==v;){var se=h,de=se.alternate,ke=se.stateNode;if(de!==null&&de===v)break;se.tag===5&&ke!==null&&(se=ke,j?(de=fl(h,D),de!=null&&U.unshift(rd(h,de,se))):j||(de=fl(h,D),de!=null&&U.push(rd(h,de,se)))),h=h.return}U.length!==0&&i.push({event:c,listeners:U})}var A4=/\r\n?/g,F4=/\u0000|\uFFFD/g;function Gy(i){return(typeof i=="string"?i:""+i).replace(A4,`
`).replace(F4,"")}function Yu(i,c,h){if(c=Gy(c),Gy(i)!==c&&h)throw Error(a(425))}function Ju(){}var Ox=null,Mx=null;function Rx(i,c){return i==="textarea"||i==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Bx=typeof setTimeout=="function"?setTimeout:void 0,L4=typeof clearTimeout=="function"?clearTimeout:void 0,qy=typeof Promise=="function"?Promise:void 0,P4=typeof queueMicrotask=="function"?queueMicrotask:typeof qy<"u"?function(i){return qy.resolve(null).then(i).catch(I4)}:Bx;function I4(i){setTimeout(function(){throw i})}function Hx(i,c){var h=c,v=0;do{var j=h.nextSibling;if(i.removeChild(h),j&&j.nodeType===8)if(h=j.data,h==="/$"){if(v===0){i.removeChild(j),Wc(c);return}v--}else h!=="$"&&h!=="$?"&&h!=="$!"||v++;h=j}while(h);Wc(c)}function wi(i){for(;i!=null;i=i.nextSibling){var c=i.nodeType;if(c===1||c===3)break;if(c===8){if(c=i.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return i}function Wy(i){i=i.previousSibling;for(var c=0;i;){if(i.nodeType===8){var h=i.data;if(h==="$"||h==="$!"||h==="$?"){if(c===0)return i;c--}else h==="/$"&&c++}i=i.previousSibling}return null}var Ao=Math.random().toString(36).slice(2),is="__reactFiber$"+Ao,sd="__reactProps$"+Ao,Ps="__reactContainer$"+Ao,Vx="__reactEvents$"+Ao,O4="__reactListeners$"+Ao,M4="__reactHandles$"+Ao;function yl(i){var c=i[is];if(c)return c;for(var h=i.parentNode;h;){if(c=h[Ps]||h[is]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(i=Wy(i);i!==null;){if(h=i[is])return h;i=Wy(i)}return c}i=h,h=i.parentNode}return null}function id(i){return i=i[is]||i[Ps],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Fo(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(a(33))}function Zu(i){return i[sd]||null}var Ux=[],Lo=-1;function ki(i){return{current:i}}function ln(i){0>Lo||(i.current=Ux[Lo],Ux[Lo]=null,Lo--)}function nn(i,c){Lo++,Ux[Lo]=i.current,i.current=c}var Ti={},xa=ki(Ti),Va=ki(!1),vl=Ti;function Po(i,c){var h=i.type.contextTypes;if(!h)return Ti;var v=i.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===c)return v.__reactInternalMemoizedMaskedChildContext;var j={},D;for(D in h)j[D]=c[D];return v&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=c,i.__reactInternalMemoizedMaskedChildContext=j),j}function Ua(i){return i=i.childContextTypes,i!=null}function eh(){ln(Va),ln(xa)}function Xy(i,c,h){if(xa.current!==Ti)throw Error(a(168));nn(xa,c),nn(Va,h)}function Qy(i,c,h){var v=i.stateNode;if(c=c.childContextTypes,typeof v.getChildContext!="function")return h;v=v.getChildContext();for(var j in v)if(!(j in c))throw Error(a(108,ge(i)||"Unknown",j));return xe({},h,v)}function th(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Ti,vl=xa.current,nn(xa,i),nn(Va,Va.current),!0}function Yy(i,c,h){var v=i.stateNode;if(!v)throw Error(a(169));h?(i=Qy(i,c,vl),v.__reactInternalMemoizedMergedChildContext=i,ln(Va),ln(xa),nn(xa,i)):ln(Va),nn(Va,h)}var Is=null,nh=!1,Kx=!1;function Jy(i){Is===null?Is=[i]:Is.push(i)}function R4(i){nh=!0,Jy(i)}function Ci(){if(!Kx&&Is!==null){Kx=!0;var i=0,c=zt;try{var h=Is;for(zt=1;i<h.length;i++){var v=h[i];do v=v(!0);while(v!==null)}Is=null,nh=!1}catch(j){throw Is!==null&&(Is=Is.slice(i+1)),Le(Yt,Ci),j}finally{zt=c,Kx=!1}}return null}var Io=[],Oo=0,ah=null,rh=0,pr=[],gr=0,bl=null,Os=1,Ms="";function Nl(i,c){Io[Oo++]=rh,Io[Oo++]=ah,ah=i,rh=c}function Zy(i,c,h){pr[gr++]=Os,pr[gr++]=Ms,pr[gr++]=bl,bl=i;var v=Os;i=Ms;var j=32-Cn(v)-1;v&=~(1<<j),h+=1;var D=32-Cn(c)+j;if(30<D){var U=j-j%5;D=(v&(1<<U)-1).toString(32),v>>=U,j-=U,Os=1<<32-Cn(c)+j|h<<j|v,Ms=D+i}else Os=1<<D|h<<j|v,Ms=i}function zx(i){i.return!==null&&(Nl(i,1),Zy(i,1,0))}function $x(i){for(;i===ah;)ah=Io[--Oo],Io[Oo]=null,rh=Io[--Oo],Io[Oo]=null;for(;i===bl;)bl=pr[--gr],pr[gr]=null,Ms=pr[--gr],pr[gr]=null,Os=pr[--gr],pr[gr]=null}var rr=null,sr=null,xn=!1,Kr=null;function ev(i,c){var h=Nr(5,null,null,0);h.elementType="DELETED",h.stateNode=c,h.return=i,c=i.deletions,c===null?(i.deletions=[h],i.flags|=16):c.push(h)}function tv(i,c){switch(i.tag){case 5:var h=i.type;return c=c.nodeType!==1||h.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(i.stateNode=c,rr=i,sr=wi(c.firstChild),!0):!1;case 6:return c=i.pendingProps===""||c.nodeType!==3?null:c,c!==null?(i.stateNode=c,rr=i,sr=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(h=bl!==null?{id:Os,overflow:Ms}:null,i.memoizedState={dehydrated:c,treeContext:h,retryLane:1073741824},h=Nr(18,null,null,0),h.stateNode=c,h.return=i,i.child=h,rr=i,sr=null,!0):!1;default:return!1}}function Gx(i){return(i.mode&1)!==0&&(i.flags&128)===0}function qx(i){if(xn){var c=sr;if(c){var h=c;if(!tv(i,c)){if(Gx(i))throw Error(a(418));c=wi(h.nextSibling);var v=rr;c&&tv(i,c)?ev(v,h):(i.flags=i.flags&-4097|2,xn=!1,rr=i)}}else{if(Gx(i))throw Error(a(418));i.flags=i.flags&-4097|2,xn=!1,rr=i}}}function nv(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;rr=i}function sh(i){if(i!==rr)return!1;if(!xn)return nv(i),xn=!0,!1;var c;if((c=i.tag!==3)&&!(c=i.tag!==5)&&(c=i.type,c=c!=="head"&&c!=="body"&&!Rx(i.type,i.memoizedProps)),c&&(c=sr)){if(Gx(i))throw av(),Error(a(418));for(;c;)ev(i,c),c=wi(c.nextSibling)}if(nv(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));e:{for(i=i.nextSibling,c=0;i;){if(i.nodeType===8){var h=i.data;if(h==="/$"){if(c===0){sr=wi(i.nextSibling);break e}c--}else h!=="$"&&h!=="$!"&&h!=="$?"||c++}i=i.nextSibling}sr=null}}else sr=rr?wi(i.stateNode.nextSibling):null;return!0}function av(){for(var i=sr;i;)i=wi(i.nextSibling)}function Mo(){sr=rr=null,xn=!1}function Wx(i){Kr===null?Kr=[i]:Kr.push(i)}var B4=w.ReactCurrentBatchConfig;function ld(i,c,h){if(i=h.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(a(309));var v=h.stateNode}if(!v)throw Error(a(147,i));var j=v,D=""+i;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===D?c.ref:(c=function(U){var se=j.refs;U===null?delete se[D]:se[D]=U},c._stringRef=D,c)}if(typeof i!="string")throw Error(a(284));if(!h._owner)throw Error(a(290,i))}return i}function ih(i,c){throw i=Object.prototype.toString.call(c),Error(a(31,i==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":i))}function rv(i){var c=i._init;return c(i._payload)}function sv(i){function c(ye,me){if(i){var ve=ye.deletions;ve===null?(ye.deletions=[me],ye.flags|=16):ve.push(me)}}function h(ye,me){if(!i)return null;for(;me!==null;)c(ye,me),me=me.sibling;return null}function v(ye,me){for(ye=new Map;me!==null;)me.key!==null?ye.set(me.key,me):ye.set(me.index,me),me=me.sibling;return ye}function j(ye,me){return ye=Pi(ye,me),ye.index=0,ye.sibling=null,ye}function D(ye,me,ve){return ye.index=ve,i?(ve=ye.alternate,ve!==null?(ve=ve.index,ve<me?(ye.flags|=2,me):ve):(ye.flags|=2,me)):(ye.flags|=1048576,me)}function U(ye){return i&&ye.alternate===null&&(ye.flags|=2),ye}function se(ye,me,ve,Ve){return me===null||me.tag!==6?(me=Bm(ve,ye.mode,Ve),me.return=ye,me):(me=j(me,ve),me.return=ye,me)}function de(ye,me,ve,Ve){var Ze=ve.type;return Ze===C?Fe(ye,me,ve.props.children,Ve,ve.key):me!==null&&(me.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===fe&&rv(Ze)===me.type)?(Ve=j(me,ve.props),Ve.ref=ld(ye,me,ve),Ve.return=ye,Ve):(Ve=Dh(ve.type,ve.key,ve.props,null,ye.mode,Ve),Ve.ref=ld(ye,me,ve),Ve.return=ye,Ve)}function ke(ye,me,ve,Ve){return me===null||me.tag!==4||me.stateNode.containerInfo!==ve.containerInfo||me.stateNode.implementation!==ve.implementation?(me=Hm(ve,ye.mode,Ve),me.return=ye,me):(me=j(me,ve.children||[]),me.return=ye,me)}function Fe(ye,me,ve,Ve,Ze){return me===null||me.tag!==7?(me=El(ve,ye.mode,Ve,Ze),me.return=ye,me):(me=j(me,ve),me.return=ye,me)}function Pe(ye,me,ve){if(typeof me=="string"&&me!==""||typeof me=="number")return me=Bm(""+me,ye.mode,ve),me.return=ye,me;if(typeof me=="object"&&me!==null){switch(me.$$typeof){case _:return ve=Dh(me.type,me.key,me.props,null,ye.mode,ve),ve.ref=ld(ye,null,me),ve.return=ye,ve;case L:return me=Hm(me,ye.mode,ve),me.return=ye,me;case fe:var Ve=me._init;return Pe(ye,Ve(me._payload),ve)}if(rn(me)||X(me))return me=El(me,ye.mode,ve,null),me.return=ye,me;ih(ye,me)}return null}function Ae(ye,me,ve,Ve){var Ze=me!==null?me.key:null;if(typeof ve=="string"&&ve!==""||typeof ve=="number")return Ze!==null?null:se(ye,me,""+ve,Ve);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case _:return ve.key===Ze?de(ye,me,ve,Ve):null;case L:return ve.key===Ze?ke(ye,me,ve,Ve):null;case fe:return Ze=ve._init,Ae(ye,me,Ze(ve._payload),Ve)}if(rn(ve)||X(ve))return Ze!==null?null:Fe(ye,me,ve,Ve,null);ih(ye,ve)}return null}function Ge(ye,me,ve,Ve,Ze){if(typeof Ve=="string"&&Ve!==""||typeof Ve=="number")return ye=ye.get(ve)||null,se(me,ye,""+Ve,Ze);if(typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case _:return ye=ye.get(Ve.key===null?ve:Ve.key)||null,de(me,ye,Ve,Ze);case L:return ye=ye.get(Ve.key===null?ve:Ve.key)||null,ke(me,ye,Ve,Ze);case fe:var it=Ve._init;return Ge(ye,me,ve,it(Ve._payload),Ze)}if(rn(Ve)||X(Ve))return ye=ye.get(ve)||null,Fe(me,ye,Ve,Ze,null);ih(me,Ve)}return null}function Qe(ye,me,ve,Ve){for(var Ze=null,it=null,lt=me,ht=me=0,Yn=null;lt!==null&&ht<ve.length;ht++){lt.index>ht?(Yn=lt,lt=null):Yn=lt.sibling;var Pt=Ae(ye,lt,ve[ht],Ve);if(Pt===null){lt===null&&(lt=Yn);break}i&&lt&&Pt.alternate===null&&c(ye,lt),me=D(Pt,me,ht),it===null?Ze=Pt:it.sibling=Pt,it=Pt,lt=Yn}if(ht===ve.length)return h(ye,lt),xn&&Nl(ye,ht),Ze;if(lt===null){for(;ht<ve.length;ht++)lt=Pe(ye,ve[ht],Ve),lt!==null&&(me=D(lt,me,ht),it===null?Ze=lt:it.sibling=lt,it=lt);return xn&&Nl(ye,ht),Ze}for(lt=v(ye,lt);ht<ve.length;ht++)Yn=Ge(lt,ye,ht,ve[ht],Ve),Yn!==null&&(i&&Yn.alternate!==null&&lt.delete(Yn.key===null?ht:Yn.key),me=D(Yn,me,ht),it===null?Ze=Yn:it.sibling=Yn,it=Yn);return i&&lt.forEach(function(Ii){return c(ye,Ii)}),xn&&Nl(ye,ht),Ze}function Je(ye,me,ve,Ve){var Ze=X(ve);if(typeof Ze!="function")throw Error(a(150));if(ve=Ze.call(ve),ve==null)throw Error(a(151));for(var it=Ze=null,lt=me,ht=me=0,Yn=null,Pt=ve.next();lt!==null&&!Pt.done;ht++,Pt=ve.next()){lt.index>ht?(Yn=lt,lt=null):Yn=lt.sibling;var Ii=Ae(ye,lt,Pt.value,Ve);if(Ii===null){lt===null&&(lt=Yn);break}i&&lt&&Ii.alternate===null&&c(ye,lt),me=D(Ii,me,ht),it===null?Ze=Ii:it.sibling=Ii,it=Ii,lt=Yn}if(Pt.done)return h(ye,lt),xn&&Nl(ye,ht),Ze;if(lt===null){for(;!Pt.done;ht++,Pt=ve.next())Pt=Pe(ye,Pt.value,Ve),Pt!==null&&(me=D(Pt,me,ht),it===null?Ze=Pt:it.sibling=Pt,it=Pt);return xn&&Nl(ye,ht),Ze}for(lt=v(ye,lt);!Pt.done;ht++,Pt=ve.next())Pt=Ge(lt,ye,ht,Pt.value,Ve),Pt!==null&&(i&&Pt.alternate!==null&&lt.delete(Pt.key===null?ht:Pt.key),me=D(Pt,me,ht),it===null?Ze=Pt:it.sibling=Pt,it=Pt);return i&&lt.forEach(function(yC){return c(ye,yC)}),xn&&Nl(ye,ht),Ze}function Sn(ye,me,ve,Ve){if(typeof ve=="object"&&ve!==null&&ve.type===C&&ve.key===null&&(ve=ve.props.children),typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case _:e:{for(var Ze=ve.key,it=me;it!==null;){if(it.key===Ze){if(Ze=ve.type,Ze===C){if(it.tag===7){h(ye,it.sibling),me=j(it,ve.props.children),me.return=ye,ye=me;break e}}else if(it.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===fe&&rv(Ze)===it.type){h(ye,it.sibling),me=j(it,ve.props),me.ref=ld(ye,it,ve),me.return=ye,ye=me;break e}h(ye,it);break}else c(ye,it);it=it.sibling}ve.type===C?(me=El(ve.props.children,ye.mode,Ve,ve.key),me.return=ye,ye=me):(Ve=Dh(ve.type,ve.key,ve.props,null,ye.mode,Ve),Ve.ref=ld(ye,me,ve),Ve.return=ye,ye=Ve)}return U(ye);case L:e:{for(it=ve.key;me!==null;){if(me.key===it)if(me.tag===4&&me.stateNode.containerInfo===ve.containerInfo&&me.stateNode.implementation===ve.implementation){h(ye,me.sibling),me=j(me,ve.children||[]),me.return=ye,ye=me;break e}else{h(ye,me);break}else c(ye,me);me=me.sibling}me=Hm(ve,ye.mode,Ve),me.return=ye,ye=me}return U(ye);case fe:return it=ve._init,Sn(ye,me,it(ve._payload),Ve)}if(rn(ve))return Qe(ye,me,ve,Ve);if(X(ve))return Je(ye,me,ve,Ve);ih(ye,ve)}return typeof ve=="string"&&ve!==""||typeof ve=="number"?(ve=""+ve,me!==null&&me.tag===6?(h(ye,me.sibling),me=j(me,ve),me.return=ye,ye=me):(h(ye,me),me=Bm(ve,ye.mode,Ve),me.return=ye,ye=me),U(ye)):h(ye,me)}return Sn}var Ro=sv(!0),iv=sv(!1),lh=ki(null),oh=null,Bo=null,Xx=null;function Qx(){Xx=Bo=oh=null}function Yx(i){var c=lh.current;ln(lh),i._currentValue=c}function Jx(i,c,h){for(;i!==null;){var v=i.alternate;if((i.childLanes&c)!==c?(i.childLanes|=c,v!==null&&(v.childLanes|=c)):v!==null&&(v.childLanes&c)!==c&&(v.childLanes|=c),i===h)break;i=i.return}}function Ho(i,c){oh=i,Xx=Bo=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&c)!==0&&(Ka=!0),i.firstContext=null)}function yr(i){var c=i._currentValue;if(Xx!==i)if(i={context:i,memoizedValue:c,next:null},Bo===null){if(oh===null)throw Error(a(308));Bo=i,oh.dependencies={lanes:0,firstContext:i}}else Bo=Bo.next=i;return c}var jl=null;function Zx(i){jl===null?jl=[i]:jl.push(i)}function lv(i,c,h,v){var j=c.interleaved;return j===null?(h.next=h,Zx(c)):(h.next=j.next,j.next=h),c.interleaved=h,Rs(i,v)}function Rs(i,c){i.lanes|=c;var h=i.alternate;for(h!==null&&(h.lanes|=c),h=i,i=i.return;i!==null;)i.childLanes|=c,h=i.alternate,h!==null&&(h.childLanes|=c),h=i,i=i.return;return h.tag===3?h.stateNode:null}var Si=!1;function em(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ov(i,c){i=i.updateQueue,c.updateQueue===i&&(c.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Bs(i,c){return{eventTime:i,lane:c,tag:0,payload:null,callback:null,next:null}}function _i(i,c,h){var v=i.updateQueue;if(v===null)return null;if(v=v.shared,(_t&2)!==0){var j=v.pending;return j===null?c.next=c:(c.next=j.next,j.next=c),v.pending=c,Rs(i,h)}return j=v.interleaved,j===null?(c.next=c,Zx(v)):(c.next=j.next,j.next=c),v.interleaved=c,Rs(i,h)}function ch(i,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194240)!==0)){var v=c.lanes;v&=i.pendingLanes,h|=v,c.lanes=h,mx(i,h)}}function cv(i,c){var h=i.updateQueue,v=i.alternate;if(v!==null&&(v=v.updateQueue,h===v)){var j=null,D=null;if(h=h.firstBaseUpdate,h!==null){do{var U={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};D===null?j=D=U:D=D.next=U,h=h.next}while(h!==null);D===null?j=D=c:D=D.next=c}else j=D=c;h={baseState:v.baseState,firstBaseUpdate:j,lastBaseUpdate:D,shared:v.shared,effects:v.effects},i.updateQueue=h;return}i=h.lastBaseUpdate,i===null?h.firstBaseUpdate=c:i.next=c,h.lastBaseUpdate=c}function dh(i,c,h,v){var j=i.updateQueue;Si=!1;var D=j.firstBaseUpdate,U=j.lastBaseUpdate,se=j.shared.pending;if(se!==null){j.shared.pending=null;var de=se,ke=de.next;de.next=null,U===null?D=ke:U.next=ke,U=de;var Fe=i.alternate;Fe!==null&&(Fe=Fe.updateQueue,se=Fe.lastBaseUpdate,se!==U&&(se===null?Fe.firstBaseUpdate=ke:se.next=ke,Fe.lastBaseUpdate=de))}if(D!==null){var Pe=j.baseState;U=0,Fe=ke=de=null,se=D;do{var Ae=se.lane,Ge=se.eventTime;if((v&Ae)===Ae){Fe!==null&&(Fe=Fe.next={eventTime:Ge,lane:0,tag:se.tag,payload:se.payload,callback:se.callback,next:null});e:{var Qe=i,Je=se;switch(Ae=c,Ge=h,Je.tag){case 1:if(Qe=Je.payload,typeof Qe=="function"){Pe=Qe.call(Ge,Pe,Ae);break e}Pe=Qe;break e;case 3:Qe.flags=Qe.flags&-65537|128;case 0:if(Qe=Je.payload,Ae=typeof Qe=="function"?Qe.call(Ge,Pe,Ae):Qe,Ae==null)break e;Pe=xe({},Pe,Ae);break e;case 2:Si=!0}}se.callback!==null&&se.lane!==0&&(i.flags|=64,Ae=j.effects,Ae===null?j.effects=[se]:Ae.push(se))}else Ge={eventTime:Ge,lane:Ae,tag:se.tag,payload:se.payload,callback:se.callback,next:null},Fe===null?(ke=Fe=Ge,de=Pe):Fe=Fe.next=Ge,U|=Ae;if(se=se.next,se===null){if(se=j.shared.pending,se===null)break;Ae=se,se=Ae.next,Ae.next=null,j.lastBaseUpdate=Ae,j.shared.pending=null}}while(!0);if(Fe===null&&(de=Pe),j.baseState=de,j.firstBaseUpdate=ke,j.lastBaseUpdate=Fe,c=j.shared.interleaved,c!==null){j=c;do U|=j.lane,j=j.next;while(j!==c)}else D===null&&(j.shared.lanes=0);Tl|=U,i.lanes=U,i.memoizedState=Pe}}function dv(i,c,h){if(i=c.effects,c.effects=null,i!==null)for(c=0;c<i.length;c++){var v=i[c],j=v.callback;if(j!==null){if(v.callback=null,v=h,typeof j!="function")throw Error(a(191,j));j.call(v)}}}var od={},ls=ki(od),cd=ki(od),dd=ki(od);function wl(i){if(i===od)throw Error(a(174));return i}function tm(i,c){switch(nn(dd,c),nn(cd,i),nn(ls,od),i=c.nodeType,i){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Wt(null,"");break;default:i=i===8?c.parentNode:c,c=i.namespaceURI||null,i=i.tagName,c=Wt(c,i)}ln(ls),nn(ls,c)}function Vo(){ln(ls),ln(cd),ln(dd)}function uv(i){wl(dd.current);var c=wl(ls.current),h=Wt(c,i.type);c!==h&&(nn(cd,i),nn(ls,h))}function nm(i){cd.current===i&&(ln(ls),ln(cd))}var fn=ki(0);function uh(i){for(var c=i;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var am=[];function rm(){for(var i=0;i<am.length;i++)am[i]._workInProgressVersionPrimary=null;am.length=0}var hh=w.ReactCurrentDispatcher,sm=w.ReactCurrentBatchConfig,kl=0,pn=null,Bn=null,Xn=null,xh=!1,ud=!1,hd=0,H4=0;function ma(){throw Error(a(321))}function im(i,c){if(c===null)return!1;for(var h=0;h<c.length&&h<i.length;h++)if(!Ur(i[h],c[h]))return!1;return!0}function lm(i,c,h,v,j,D){if(kl=D,pn=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,hh.current=i===null||i.memoizedState===null?z4:$4,i=h(v,j),ud){D=0;do{if(ud=!1,hd=0,25<=D)throw Error(a(301));D+=1,Xn=Bn=null,c.updateQueue=null,hh.current=G4,i=h(v,j)}while(ud)}if(hh.current=ph,c=Bn!==null&&Bn.next!==null,kl=0,Xn=Bn=pn=null,xh=!1,c)throw Error(a(300));return i}function om(){var i=hd!==0;return hd=0,i}function os(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xn===null?pn.memoizedState=Xn=i:Xn=Xn.next=i,Xn}function vr(){if(Bn===null){var i=pn.alternate;i=i!==null?i.memoizedState:null}else i=Bn.next;var c=Xn===null?pn.memoizedState:Xn.next;if(c!==null)Xn=c,Bn=i;else{if(i===null)throw Error(a(310));Bn=i,i={memoizedState:Bn.memoizedState,baseState:Bn.baseState,baseQueue:Bn.baseQueue,queue:Bn.queue,next:null},Xn===null?pn.memoizedState=Xn=i:Xn=Xn.next=i}return Xn}function xd(i,c){return typeof c=="function"?c(i):c}function cm(i){var c=vr(),h=c.queue;if(h===null)throw Error(a(311));h.lastRenderedReducer=i;var v=Bn,j=v.baseQueue,D=h.pending;if(D!==null){if(j!==null){var U=j.next;j.next=D.next,D.next=U}v.baseQueue=j=D,h.pending=null}if(j!==null){D=j.next,v=v.baseState;var se=U=null,de=null,ke=D;do{var Fe=ke.lane;if((kl&Fe)===Fe)de!==null&&(de=de.next={lane:0,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null}),v=ke.hasEagerState?ke.eagerState:i(v,ke.action);else{var Pe={lane:Fe,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null};de===null?(se=de=Pe,U=v):de=de.next=Pe,pn.lanes|=Fe,Tl|=Fe}ke=ke.next}while(ke!==null&&ke!==D);de===null?U=v:de.next=se,Ur(v,c.memoizedState)||(Ka=!0),c.memoizedState=v,c.baseState=U,c.baseQueue=de,h.lastRenderedState=v}if(i=h.interleaved,i!==null){j=i;do D=j.lane,pn.lanes|=D,Tl|=D,j=j.next;while(j!==i)}else j===null&&(h.lanes=0);return[c.memoizedState,h.dispatch]}function dm(i){var c=vr(),h=c.queue;if(h===null)throw Error(a(311));h.lastRenderedReducer=i;var v=h.dispatch,j=h.pending,D=c.memoizedState;if(j!==null){h.pending=null;var U=j=j.next;do D=i(D,U.action),U=U.next;while(U!==j);Ur(D,c.memoizedState)||(Ka=!0),c.memoizedState=D,c.baseQueue===null&&(c.baseState=D),h.lastRenderedState=D}return[D,v]}function hv(){}function xv(i,c){var h=pn,v=vr(),j=c(),D=!Ur(v.memoizedState,j);if(D&&(v.memoizedState=j,Ka=!0),v=v.queue,um(pv.bind(null,h,v,i),[i]),v.getSnapshot!==c||D||Xn!==null&&Xn.memoizedState.tag&1){if(h.flags|=2048,md(9,fv.bind(null,h,v,j,c),void 0,null),Qn===null)throw Error(a(349));(kl&30)!==0||mv(h,c,j)}return j}function mv(i,c,h){i.flags|=16384,i={getSnapshot:c,value:h},c=pn.updateQueue,c===null?(c={lastEffect:null,stores:null},pn.updateQueue=c,c.stores=[i]):(h=c.stores,h===null?c.stores=[i]:h.push(i))}function fv(i,c,h,v){c.value=h,c.getSnapshot=v,gv(c)&&yv(i)}function pv(i,c,h){return h(function(){gv(c)&&yv(i)})}function gv(i){var c=i.getSnapshot;i=i.value;try{var h=c();return!Ur(i,h)}catch{return!0}}function yv(i){var c=Rs(i,1);c!==null&&qr(c,i,1,-1)}function vv(i){var c=os();return typeof i=="function"&&(i=i()),c.memoizedState=c.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xd,lastRenderedState:i},c.queue=i,i=i.dispatch=K4.bind(null,pn,i),[c.memoizedState,i]}function md(i,c,h,v){return i={tag:i,create:c,destroy:h,deps:v,next:null},c=pn.updateQueue,c===null?(c={lastEffect:null,stores:null},pn.updateQueue=c,c.lastEffect=i.next=i):(h=c.lastEffect,h===null?c.lastEffect=i.next=i:(v=h.next,h.next=i,i.next=v,c.lastEffect=i)),i}function bv(){return vr().memoizedState}function mh(i,c,h,v){var j=os();pn.flags|=i,j.memoizedState=md(1|c,h,void 0,v===void 0?null:v)}function fh(i,c,h,v){var j=vr();v=v===void 0?null:v;var D=void 0;if(Bn!==null){var U=Bn.memoizedState;if(D=U.destroy,v!==null&&im(v,U.deps)){j.memoizedState=md(c,h,D,v);return}}pn.flags|=i,j.memoizedState=md(1|c,h,D,v)}function Nv(i,c){return mh(8390656,8,i,c)}function um(i,c){return fh(2048,8,i,c)}function jv(i,c){return fh(4,2,i,c)}function wv(i,c){return fh(4,4,i,c)}function kv(i,c){if(typeof c=="function")return i=i(),c(i),function(){c(null)};if(c!=null)return i=i(),c.current=i,function(){c.current=null}}function Tv(i,c,h){return h=h!=null?h.concat([i]):null,fh(4,4,kv.bind(null,c,i),h)}function hm(){}function Cv(i,c){var h=vr();c=c===void 0?null:c;var v=h.memoizedState;return v!==null&&c!==null&&im(c,v[1])?v[0]:(h.memoizedState=[i,c],i)}function Sv(i,c){var h=vr();c=c===void 0?null:c;var v=h.memoizedState;return v!==null&&c!==null&&im(c,v[1])?v[0]:(i=i(),h.memoizedState=[i,c],i)}function _v(i,c,h){return(kl&21)===0?(i.baseState&&(i.baseState=!1,Ka=!0),i.memoizedState=h):(Ur(h,c)||(h=ry(),pn.lanes|=h,Tl|=h,i.baseState=!0),c)}function V4(i,c){var h=zt;zt=h!==0&&4>h?h:4,i(!0);var v=sm.transition;sm.transition={};try{i(!1),c()}finally{zt=h,sm.transition=v}}function Ev(){return vr().memoizedState}function U4(i,c,h){var v=Fi(i);if(h={lane:v,action:h,hasEagerState:!1,eagerState:null,next:null},Dv(i))Av(c,h);else if(h=lv(i,c,h,v),h!==null){var j=Da();qr(h,i,v,j),Fv(h,c,v)}}function K4(i,c,h){var v=Fi(i),j={lane:v,action:h,hasEagerState:!1,eagerState:null,next:null};if(Dv(i))Av(c,j);else{var D=i.alternate;if(i.lanes===0&&(D===null||D.lanes===0)&&(D=c.lastRenderedReducer,D!==null))try{var U=c.lastRenderedState,se=D(U,h);if(j.hasEagerState=!0,j.eagerState=se,Ur(se,U)){var de=c.interleaved;de===null?(j.next=j,Zx(c)):(j.next=de.next,de.next=j),c.interleaved=j;return}}catch{}finally{}h=lv(i,c,j,v),h!==null&&(j=Da(),qr(h,i,v,j),Fv(h,c,v))}}function Dv(i){var c=i.alternate;return i===pn||c!==null&&c===pn}function Av(i,c){ud=xh=!0;var h=i.pending;h===null?c.next=c:(c.next=h.next,h.next=c),i.pending=c}function Fv(i,c,h){if((h&4194240)!==0){var v=c.lanes;v&=i.pendingLanes,h|=v,c.lanes=h,mx(i,h)}}var ph={readContext:yr,useCallback:ma,useContext:ma,useEffect:ma,useImperativeHandle:ma,useInsertionEffect:ma,useLayoutEffect:ma,useMemo:ma,useReducer:ma,useRef:ma,useState:ma,useDebugValue:ma,useDeferredValue:ma,useTransition:ma,useMutableSource:ma,useSyncExternalStore:ma,useId:ma,unstable_isNewReconciler:!1},z4={readContext:yr,useCallback:function(i,c){return os().memoizedState=[i,c===void 0?null:c],i},useContext:yr,useEffect:Nv,useImperativeHandle:function(i,c,h){return h=h!=null?h.concat([i]):null,mh(4194308,4,kv.bind(null,c,i),h)},useLayoutEffect:function(i,c){return mh(4194308,4,i,c)},useInsertionEffect:function(i,c){return mh(4,2,i,c)},useMemo:function(i,c){var h=os();return c=c===void 0?null:c,i=i(),h.memoizedState=[i,c],i},useReducer:function(i,c,h){var v=os();return c=h!==void 0?h(c):c,v.memoizedState=v.baseState=c,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:c},v.queue=i,i=i.dispatch=U4.bind(null,pn,i),[v.memoizedState,i]},useRef:function(i){var c=os();return i={current:i},c.memoizedState=i},useState:vv,useDebugValue:hm,useDeferredValue:function(i){return os().memoizedState=i},useTransition:function(){var i=vv(!1),c=i[0];return i=V4.bind(null,i[1]),os().memoizedState=i,[c,i]},useMutableSource:function(){},useSyncExternalStore:function(i,c,h){var v=pn,j=os();if(xn){if(h===void 0)throw Error(a(407));h=h()}else{if(h=c(),Qn===null)throw Error(a(349));(kl&30)!==0||mv(v,c,h)}j.memoizedState=h;var D={value:h,getSnapshot:c};return j.queue=D,Nv(pv.bind(null,v,D,i),[i]),v.flags|=2048,md(9,fv.bind(null,v,D,h,c),void 0,null),h},useId:function(){var i=os(),c=Qn.identifierPrefix;if(xn){var h=Ms,v=Os;h=(v&~(1<<32-Cn(v)-1)).toString(32)+h,c=":"+c+"R"+h,h=hd++,0<h&&(c+="H"+h.toString(32)),c+=":"}else h=H4++,c=":"+c+"r"+h.toString(32)+":";return i.memoizedState=c},unstable_isNewReconciler:!1},$4={readContext:yr,useCallback:Cv,useContext:yr,useEffect:um,useImperativeHandle:Tv,useInsertionEffect:jv,useLayoutEffect:wv,useMemo:Sv,useReducer:cm,useRef:bv,useState:function(){return cm(xd)},useDebugValue:hm,useDeferredValue:function(i){var c=vr();return _v(c,Bn.memoizedState,i)},useTransition:function(){var i=cm(xd)[0],c=vr().memoizedState;return[i,c]},useMutableSource:hv,useSyncExternalStore:xv,useId:Ev,unstable_isNewReconciler:!1},G4={readContext:yr,useCallback:Cv,useContext:yr,useEffect:um,useImperativeHandle:Tv,useInsertionEffect:jv,useLayoutEffect:wv,useMemo:Sv,useReducer:dm,useRef:bv,useState:function(){return dm(xd)},useDebugValue:hm,useDeferredValue:function(i){var c=vr();return Bn===null?c.memoizedState=i:_v(c,Bn.memoizedState,i)},useTransition:function(){var i=dm(xd)[0],c=vr().memoizedState;return[i,c]},useMutableSource:hv,useSyncExternalStore:xv,useId:Ev,unstable_isNewReconciler:!1};function zr(i,c){if(i&&i.defaultProps){c=xe({},c),i=i.defaultProps;for(var h in i)c[h]===void 0&&(c[h]=i[h]);return c}return c}function xm(i,c,h,v){c=i.memoizedState,h=h(v,c),h=h==null?c:xe({},c,h),i.memoizedState=h,i.lanes===0&&(i.updateQueue.baseState=h)}var gh={isMounted:function(i){return(i=i._reactInternals)?re(i)===i:!1},enqueueSetState:function(i,c,h){i=i._reactInternals;var v=Da(),j=Fi(i),D=Bs(v,j);D.payload=c,h!=null&&(D.callback=h),c=_i(i,D,j),c!==null&&(qr(c,i,j,v),ch(c,i,j))},enqueueReplaceState:function(i,c,h){i=i._reactInternals;var v=Da(),j=Fi(i),D=Bs(v,j);D.tag=1,D.payload=c,h!=null&&(D.callback=h),c=_i(i,D,j),c!==null&&(qr(c,i,j,v),ch(c,i,j))},enqueueForceUpdate:function(i,c){i=i._reactInternals;var h=Da(),v=Fi(i),j=Bs(h,v);j.tag=2,c!=null&&(j.callback=c),c=_i(i,j,v),c!==null&&(qr(c,i,v,h),ch(c,i,v))}};function Lv(i,c,h,v,j,D,U){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(v,D,U):c.prototype&&c.prototype.isPureReactComponent?!ed(h,v)||!ed(j,D):!0}function Pv(i,c,h){var v=!1,j=Ti,D=c.contextType;return typeof D=="object"&&D!==null?D=yr(D):(j=Ua(c)?vl:xa.current,v=c.contextTypes,D=(v=v!=null)?Po(i,j):Ti),c=new c(h,D),i.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=gh,i.stateNode=c,c._reactInternals=i,v&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=j,i.__reactInternalMemoizedMaskedChildContext=D),c}function Iv(i,c,h,v){i=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,v),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,v),c.state!==i&&gh.enqueueReplaceState(c,c.state,null)}function mm(i,c,h,v){var j=i.stateNode;j.props=h,j.state=i.memoizedState,j.refs={},em(i);var D=c.contextType;typeof D=="object"&&D!==null?j.context=yr(D):(D=Ua(c)?vl:xa.current,j.context=Po(i,D)),j.state=i.memoizedState,D=c.getDerivedStateFromProps,typeof D=="function"&&(xm(i,c,D,h),j.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof j.getSnapshotBeforeUpdate=="function"||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(c=j.state,typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount(),c!==j.state&&gh.enqueueReplaceState(j,j.state,null),dh(i,h,j,v),j.state=i.memoizedState),typeof j.componentDidMount=="function"&&(i.flags|=4194308)}function Uo(i,c){try{var h="",v=c;do h+=V(v),v=v.return;while(v);var j=h}catch(D){j=`
Error generating stack: `+D.message+`
`+D.stack}return{value:i,source:c,stack:j,digest:null}}function fm(i,c,h){return{value:i,source:null,stack:h??null,digest:c??null}}function pm(i,c){try{console.error(c.value)}catch(h){setTimeout(function(){throw h})}}var q4=typeof WeakMap=="function"?WeakMap:Map;function Ov(i,c,h){h=Bs(-1,h),h.tag=3,h.payload={element:null};var v=c.value;return h.callback=function(){kh||(kh=!0,Am=v),pm(i,c)},h}function Mv(i,c,h){h=Bs(-1,h),h.tag=3;var v=i.type.getDerivedStateFromError;if(typeof v=="function"){var j=c.value;h.payload=function(){return v(j)},h.callback=function(){pm(i,c)}}var D=i.stateNode;return D!==null&&typeof D.componentDidCatch=="function"&&(h.callback=function(){pm(i,c),typeof v!="function"&&(Di===null?Di=new Set([this]):Di.add(this));var U=c.stack;this.componentDidCatch(c.value,{componentStack:U!==null?U:""})}),h}function Rv(i,c,h){var v=i.pingCache;if(v===null){v=i.pingCache=new q4;var j=new Set;v.set(c,j)}else j=v.get(c),j===void 0&&(j=new Set,v.set(c,j));j.has(h)||(j.add(h),i=lC.bind(null,i,c,h),c.then(i,i))}function Bv(i){do{var c;if((c=i.tag===13)&&(c=i.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return i;i=i.return}while(i!==null);return null}function Hv(i,c,h,v,j){return(i.mode&1)===0?(i===c?i.flags|=65536:(i.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(c=Bs(-1,1),c.tag=2,_i(h,c,1))),h.lanes|=1),i):(i.flags|=65536,i.lanes=j,i)}var W4=w.ReactCurrentOwner,Ka=!1;function Ea(i,c,h,v){c.child=i===null?iv(c,null,h,v):Ro(c,i.child,h,v)}function Vv(i,c,h,v,j){h=h.render;var D=c.ref;return Ho(c,j),v=lm(i,c,h,v,D,j),h=om(),i!==null&&!Ka?(c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~j,Hs(i,c,j)):(xn&&h&&zx(c),c.flags|=1,Ea(i,c,v,j),c.child)}function Uv(i,c,h,v,j){if(i===null){var D=h.type;return typeof D=="function"&&!Rm(D)&&D.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(c.tag=15,c.type=D,Kv(i,c,D,v,j)):(i=Dh(h.type,null,v,c,c.mode,j),i.ref=c.ref,i.return=c,c.child=i)}if(D=i.child,(i.lanes&j)===0){var U=D.memoizedProps;if(h=h.compare,h=h!==null?h:ed,h(U,v)&&i.ref===c.ref)return Hs(i,c,j)}return c.flags|=1,i=Pi(D,v),i.ref=c.ref,i.return=c,c.child=i}function Kv(i,c,h,v,j){if(i!==null){var D=i.memoizedProps;if(ed(D,v)&&i.ref===c.ref)if(Ka=!1,c.pendingProps=v=D,(i.lanes&j)!==0)(i.flags&131072)!==0&&(Ka=!0);else return c.lanes=i.lanes,Hs(i,c,j)}return gm(i,c,h,v,j)}function zv(i,c,h){var v=c.pendingProps,j=v.children,D=i!==null?i.memoizedState:null;if(v.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},nn(zo,ir),ir|=h;else{if((h&1073741824)===0)return i=D!==null?D.baseLanes|h:h,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:i,cachePool:null,transitions:null},c.updateQueue=null,nn(zo,ir),ir|=i,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=D!==null?D.baseLanes:h,nn(zo,ir),ir|=v}else D!==null?(v=D.baseLanes|h,c.memoizedState=null):v=h,nn(zo,ir),ir|=v;return Ea(i,c,j,h),c.child}function $v(i,c){var h=c.ref;(i===null&&h!==null||i!==null&&i.ref!==h)&&(c.flags|=512,c.flags|=2097152)}function gm(i,c,h,v,j){var D=Ua(h)?vl:xa.current;return D=Po(c,D),Ho(c,j),h=lm(i,c,h,v,D,j),v=om(),i!==null&&!Ka?(c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~j,Hs(i,c,j)):(xn&&v&&zx(c),c.flags|=1,Ea(i,c,h,j),c.child)}function Gv(i,c,h,v,j){if(Ua(h)){var D=!0;th(c)}else D=!1;if(Ho(c,j),c.stateNode===null)vh(i,c),Pv(c,h,v),mm(c,h,v,j),v=!0;else if(i===null){var U=c.stateNode,se=c.memoizedProps;U.props=se;var de=U.context,ke=h.contextType;typeof ke=="object"&&ke!==null?ke=yr(ke):(ke=Ua(h)?vl:xa.current,ke=Po(c,ke));var Fe=h.getDerivedStateFromProps,Pe=typeof Fe=="function"||typeof U.getSnapshotBeforeUpdate=="function";Pe||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(se!==v||de!==ke)&&Iv(c,U,v,ke),Si=!1;var Ae=c.memoizedState;U.state=Ae,dh(c,v,U,j),de=c.memoizedState,se!==v||Ae!==de||Va.current||Si?(typeof Fe=="function"&&(xm(c,h,Fe,v),de=c.memoizedState),(se=Si||Lv(c,h,se,v,Ae,de,ke))?(Pe||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount()),typeof U.componentDidMount=="function"&&(c.flags|=4194308)):(typeof U.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=v,c.memoizedState=de),U.props=v,U.state=de,U.context=ke,v=se):(typeof U.componentDidMount=="function"&&(c.flags|=4194308),v=!1)}else{U=c.stateNode,ov(i,c),se=c.memoizedProps,ke=c.type===c.elementType?se:zr(c.type,se),U.props=ke,Pe=c.pendingProps,Ae=U.context,de=h.contextType,typeof de=="object"&&de!==null?de=yr(de):(de=Ua(h)?vl:xa.current,de=Po(c,de));var Ge=h.getDerivedStateFromProps;(Fe=typeof Ge=="function"||typeof U.getSnapshotBeforeUpdate=="function")||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(se!==Pe||Ae!==de)&&Iv(c,U,v,de),Si=!1,Ae=c.memoizedState,U.state=Ae,dh(c,v,U,j);var Qe=c.memoizedState;se!==Pe||Ae!==Qe||Va.current||Si?(typeof Ge=="function"&&(xm(c,h,Ge,v),Qe=c.memoizedState),(ke=Si||Lv(c,h,ke,v,Ae,Qe,de)||!1)?(Fe||typeof U.UNSAFE_componentWillUpdate!="function"&&typeof U.componentWillUpdate!="function"||(typeof U.componentWillUpdate=="function"&&U.componentWillUpdate(v,Qe,de),typeof U.UNSAFE_componentWillUpdate=="function"&&U.UNSAFE_componentWillUpdate(v,Qe,de)),typeof U.componentDidUpdate=="function"&&(c.flags|=4),typeof U.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof U.componentDidUpdate!="function"||se===i.memoizedProps&&Ae===i.memoizedState||(c.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||se===i.memoizedProps&&Ae===i.memoizedState||(c.flags|=1024),c.memoizedProps=v,c.memoizedState=Qe),U.props=v,U.state=Qe,U.context=de,v=ke):(typeof U.componentDidUpdate!="function"||se===i.memoizedProps&&Ae===i.memoizedState||(c.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||se===i.memoizedProps&&Ae===i.memoizedState||(c.flags|=1024),v=!1)}return ym(i,c,h,v,D,j)}function ym(i,c,h,v,j,D){$v(i,c);var U=(c.flags&128)!==0;if(!v&&!U)return j&&Yy(c,h,!1),Hs(i,c,D);v=c.stateNode,W4.current=c;var se=U&&typeof h.getDerivedStateFromError!="function"?null:v.render();return c.flags|=1,i!==null&&U?(c.child=Ro(c,i.child,null,D),c.child=Ro(c,null,se,D)):Ea(i,c,se,D),c.memoizedState=v.state,j&&Yy(c,h,!0),c.child}function qv(i){var c=i.stateNode;c.pendingContext?Xy(i,c.pendingContext,c.pendingContext!==c.context):c.context&&Xy(i,c.context,!1),tm(i,c.containerInfo)}function Wv(i,c,h,v,j){return Mo(),Wx(j),c.flags|=256,Ea(i,c,h,v),c.child}var vm={dehydrated:null,treeContext:null,retryLane:0};function bm(i){return{baseLanes:i,cachePool:null,transitions:null}}function Xv(i,c,h){var v=c.pendingProps,j=fn.current,D=!1,U=(c.flags&128)!==0,se;if((se=U)||(se=i!==null&&i.memoizedState===null?!1:(j&2)!==0),se?(D=!0,c.flags&=-129):(i===null||i.memoizedState!==null)&&(j|=1),nn(fn,j&1),i===null)return qx(c),i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((c.mode&1)===0?c.lanes=1:i.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(U=v.children,i=v.fallback,D?(v=c.mode,D=c.child,U={mode:"hidden",children:U},(v&1)===0&&D!==null?(D.childLanes=0,D.pendingProps=U):D=Ah(U,v,0,null),i=El(i,v,h,null),D.return=c,i.return=c,D.sibling=i,c.child=D,c.child.memoizedState=bm(h),c.memoizedState=vm,i):Nm(c,U));if(j=i.memoizedState,j!==null&&(se=j.dehydrated,se!==null))return X4(i,c,U,v,se,j,h);if(D){D=v.fallback,U=c.mode,j=i.child,se=j.sibling;var de={mode:"hidden",children:v.children};return(U&1)===0&&c.child!==j?(v=c.child,v.childLanes=0,v.pendingProps=de,c.deletions=null):(v=Pi(j,de),v.subtreeFlags=j.subtreeFlags&14680064),se!==null?D=Pi(se,D):(D=El(D,U,h,null),D.flags|=2),D.return=c,v.return=c,v.sibling=D,c.child=v,v=D,D=c.child,U=i.child.memoizedState,U=U===null?bm(h):{baseLanes:U.baseLanes|h,cachePool:null,transitions:U.transitions},D.memoizedState=U,D.childLanes=i.childLanes&~h,c.memoizedState=vm,v}return D=i.child,i=D.sibling,v=Pi(D,{mode:"visible",children:v.children}),(c.mode&1)===0&&(v.lanes=h),v.return=c,v.sibling=null,i!==null&&(h=c.deletions,h===null?(c.deletions=[i],c.flags|=16):h.push(i)),c.child=v,c.memoizedState=null,v}function Nm(i,c){return c=Ah({mode:"visible",children:c},i.mode,0,null),c.return=i,i.child=c}function yh(i,c,h,v){return v!==null&&Wx(v),Ro(c,i.child,null,h),i=Nm(c,c.pendingProps.children),i.flags|=2,c.memoizedState=null,i}function X4(i,c,h,v,j,D,U){if(h)return c.flags&256?(c.flags&=-257,v=fm(Error(a(422))),yh(i,c,U,v)):c.memoizedState!==null?(c.child=i.child,c.flags|=128,null):(D=v.fallback,j=c.mode,v=Ah({mode:"visible",children:v.children},j,0,null),D=El(D,j,U,null),D.flags|=2,v.return=c,D.return=c,v.sibling=D,c.child=v,(c.mode&1)!==0&&Ro(c,i.child,null,U),c.child.memoizedState=bm(U),c.memoizedState=vm,D);if((c.mode&1)===0)return yh(i,c,U,null);if(j.data==="$!"){if(v=j.nextSibling&&j.nextSibling.dataset,v)var se=v.dgst;return v=se,D=Error(a(419)),v=fm(D,v,void 0),yh(i,c,U,v)}if(se=(U&i.childLanes)!==0,Ka||se){if(v=Qn,v!==null){switch(U&-U){case 4:j=2;break;case 16:j=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:j=32;break;case 536870912:j=268435456;break;default:j=0}j=(j&(v.suspendedLanes|U))!==0?0:j,j!==0&&j!==D.retryLane&&(D.retryLane=j,Rs(i,j),qr(v,i,j,-1))}return Mm(),v=fm(Error(a(421))),yh(i,c,U,v)}return j.data==="$?"?(c.flags|=128,c.child=i.child,c=oC.bind(null,i),j._reactRetry=c,null):(i=D.treeContext,sr=wi(j.nextSibling),rr=c,xn=!0,Kr=null,i!==null&&(pr[gr++]=Os,pr[gr++]=Ms,pr[gr++]=bl,Os=i.id,Ms=i.overflow,bl=c),c=Nm(c,v.children),c.flags|=4096,c)}function Qv(i,c,h){i.lanes|=c;var v=i.alternate;v!==null&&(v.lanes|=c),Jx(i.return,c,h)}function jm(i,c,h,v,j){var D=i.memoizedState;D===null?i.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:v,tail:h,tailMode:j}:(D.isBackwards=c,D.rendering=null,D.renderingStartTime=0,D.last=v,D.tail=h,D.tailMode=j)}function Yv(i,c,h){var v=c.pendingProps,j=v.revealOrder,D=v.tail;if(Ea(i,c,v.children,h),v=fn.current,(v&2)!==0)v=v&1|2,c.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=c.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Qv(i,h,c);else if(i.tag===19)Qv(i,h,c);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===c)break e;for(;i.sibling===null;){if(i.return===null||i.return===c)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}v&=1}if(nn(fn,v),(c.mode&1)===0)c.memoizedState=null;else switch(j){case"forwards":for(h=c.child,j=null;h!==null;)i=h.alternate,i!==null&&uh(i)===null&&(j=h),h=h.sibling;h=j,h===null?(j=c.child,c.child=null):(j=h.sibling,h.sibling=null),jm(c,!1,j,h,D);break;case"backwards":for(h=null,j=c.child,c.child=null;j!==null;){if(i=j.alternate,i!==null&&uh(i)===null){c.child=j;break}i=j.sibling,j.sibling=h,h=j,j=i}jm(c,!0,h,null,D);break;case"together":jm(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function vh(i,c){(c.mode&1)===0&&i!==null&&(i.alternate=null,c.alternate=null,c.flags|=2)}function Hs(i,c,h){if(i!==null&&(c.dependencies=i.dependencies),Tl|=c.lanes,(h&c.childLanes)===0)return null;if(i!==null&&c.child!==i.child)throw Error(a(153));if(c.child!==null){for(i=c.child,h=Pi(i,i.pendingProps),c.child=h,h.return=c;i.sibling!==null;)i=i.sibling,h=h.sibling=Pi(i,i.pendingProps),h.return=c;h.sibling=null}return c.child}function Q4(i,c,h){switch(c.tag){case 3:qv(c),Mo();break;case 5:uv(c);break;case 1:Ua(c.type)&&th(c);break;case 4:tm(c,c.stateNode.containerInfo);break;case 10:var v=c.type._context,j=c.memoizedProps.value;nn(lh,v._currentValue),v._currentValue=j;break;case 13:if(v=c.memoizedState,v!==null)return v.dehydrated!==null?(nn(fn,fn.current&1),c.flags|=128,null):(h&c.child.childLanes)!==0?Xv(i,c,h):(nn(fn,fn.current&1),i=Hs(i,c,h),i!==null?i.sibling:null);nn(fn,fn.current&1);break;case 19:if(v=(h&c.childLanes)!==0,(i.flags&128)!==0){if(v)return Yv(i,c,h);c.flags|=128}if(j=c.memoizedState,j!==null&&(j.rendering=null,j.tail=null,j.lastEffect=null),nn(fn,fn.current),v)break;return null;case 22:case 23:return c.lanes=0,zv(i,c,h)}return Hs(i,c,h)}var Jv,wm,Zv,e1;Jv=function(i,c){for(var h=c.child;h!==null;){if(h.tag===5||h.tag===6)i.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},wm=function(){},Zv=function(i,c,h,v){var j=i.memoizedProps;if(j!==v){i=c.stateNode,wl(ls.current);var D=null;switch(h){case"input":j=Oe(i,j),v=Oe(i,v),D=[];break;case"select":j=xe({},j,{value:void 0}),v=xe({},v,{value:void 0}),D=[];break;case"textarea":j=Ha(i,j),v=Ha(i,v),D=[];break;default:typeof j.onClick!="function"&&typeof v.onClick=="function"&&(i.onclick=Ju)}As(h,v);var U;h=null;for(ke in j)if(!v.hasOwnProperty(ke)&&j.hasOwnProperty(ke)&&j[ke]!=null)if(ke==="style"){var se=j[ke];for(U in se)se.hasOwnProperty(U)&&(h||(h={}),h[U]="")}else ke!=="dangerouslySetInnerHTML"&&ke!=="children"&&ke!=="suppressContentEditableWarning"&&ke!=="suppressHydrationWarning"&&ke!=="autoFocus"&&(s.hasOwnProperty(ke)?D||(D=[]):(D=D||[]).push(ke,null));for(ke in v){var de=v[ke];if(se=j!=null?j[ke]:void 0,v.hasOwnProperty(ke)&&de!==se&&(de!=null||se!=null))if(ke==="style")if(se){for(U in se)!se.hasOwnProperty(U)||de&&de.hasOwnProperty(U)||(h||(h={}),h[U]="");for(U in de)de.hasOwnProperty(U)&&se[U]!==de[U]&&(h||(h={}),h[U]=de[U])}else h||(D||(D=[]),D.push(ke,h)),h=de;else ke==="dangerouslySetInnerHTML"?(de=de?de.__html:void 0,se=se?se.__html:void 0,de!=null&&se!==de&&(D=D||[]).push(ke,de)):ke==="children"?typeof de!="string"&&typeof de!="number"||(D=D||[]).push(ke,""+de):ke!=="suppressContentEditableWarning"&&ke!=="suppressHydrationWarning"&&(s.hasOwnProperty(ke)?(de!=null&&ke==="onScroll"&&sn("scroll",i),D||se===de||(D=[])):(D=D||[]).push(ke,de))}h&&(D=D||[]).push("style",h);var ke=D;(c.updateQueue=ke)&&(c.flags|=4)}},e1=function(i,c,h,v){h!==v&&(c.flags|=4)};function fd(i,c){if(!xn)switch(i.tailMode){case"hidden":c=i.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?i.tail=null:h.sibling=null;break;case"collapsed":h=i.tail;for(var v=null;h!==null;)h.alternate!==null&&(v=h),h=h.sibling;v===null?c||i.tail===null?i.tail=null:i.tail.sibling=null:v.sibling=null}}function fa(i){var c=i.alternate!==null&&i.alternate.child===i.child,h=0,v=0;if(c)for(var j=i.child;j!==null;)h|=j.lanes|j.childLanes,v|=j.subtreeFlags&14680064,v|=j.flags&14680064,j.return=i,j=j.sibling;else for(j=i.child;j!==null;)h|=j.lanes|j.childLanes,v|=j.subtreeFlags,v|=j.flags,j.return=i,j=j.sibling;return i.subtreeFlags|=v,i.childLanes=h,c}function Y4(i,c,h){var v=c.pendingProps;switch($x(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fa(c),null;case 1:return Ua(c.type)&&eh(),fa(c),null;case 3:return v=c.stateNode,Vo(),ln(Va),ln(xa),rm(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(i===null||i.child===null)&&(sh(c)?c.flags|=4:i===null||i.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Kr!==null&&(Pm(Kr),Kr=null))),wm(i,c),fa(c),null;case 5:nm(c);var j=wl(dd.current);if(h=c.type,i!==null&&c.stateNode!=null)Zv(i,c,h,v,j),i.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!v){if(c.stateNode===null)throw Error(a(166));return fa(c),null}if(i=wl(ls.current),sh(c)){v=c.stateNode,h=c.type;var D=c.memoizedProps;switch(v[is]=c,v[sd]=D,i=(c.mode&1)!==0,h){case"dialog":sn("cancel",v),sn("close",v);break;case"iframe":case"object":case"embed":sn("load",v);break;case"video":case"audio":for(j=0;j<nd.length;j++)sn(nd[j],v);break;case"source":sn("error",v);break;case"img":case"image":case"link":sn("error",v),sn("load",v);break;case"details":sn("toggle",v);break;case"input":tt(v,D),sn("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!D.multiple},sn("invalid",v);break;case"textarea":Sa(v,D),sn("invalid",v)}As(h,D),j=null;for(var U in D)if(D.hasOwnProperty(U)){var se=D[U];U==="children"?typeof se=="string"?v.textContent!==se&&(D.suppressHydrationWarning!==!0&&Yu(v.textContent,se,i),j=["children",se]):typeof se=="number"&&v.textContent!==""+se&&(D.suppressHydrationWarning!==!0&&Yu(v.textContent,se,i),j=["children",""+se]):s.hasOwnProperty(U)&&se!=null&&U==="onScroll"&&sn("scroll",v)}switch(h){case"input":ce(v),Ot(v,D,!0);break;case"textarea":ce(v),Xe(v);break;case"select":case"option":break;default:typeof D.onClick=="function"&&(v.onclick=Ju)}v=j,c.updateQueue=v,v!==null&&(c.flags|=4)}else{U=j.nodeType===9?j:j.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=Lt(h)),i==="http://www.w3.org/1999/xhtml"?h==="script"?(i=U.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof v.is=="string"?i=U.createElement(h,{is:v.is}):(i=U.createElement(h),h==="select"&&(U=i,v.multiple?U.multiple=!0:v.size&&(U.size=v.size))):i=U.createElementNS(i,h),i[is]=c,i[sd]=v,Jv(i,c,!1,!1),c.stateNode=i;e:{switch(U=Fs(h,v),h){case"dialog":sn("cancel",i),sn("close",i),j=v;break;case"iframe":case"object":case"embed":sn("load",i),j=v;break;case"video":case"audio":for(j=0;j<nd.length;j++)sn(nd[j],i);j=v;break;case"source":sn("error",i),j=v;break;case"img":case"image":case"link":sn("error",i),sn("load",i),j=v;break;case"details":sn("toggle",i),j=v;break;case"input":tt(i,v),j=Oe(i,v),sn("invalid",i);break;case"option":j=v;break;case"select":i._wrapperState={wasMultiple:!!v.multiple},j=xe({},v,{value:void 0}),sn("invalid",i);break;case"textarea":Sa(i,v),j=Ha(i,v),sn("invalid",i);break;default:j=v}As(h,j),se=j;for(D in se)if(se.hasOwnProperty(D)){var de=se[D];D==="style"?_a(i,de):D==="dangerouslySetInnerHTML"?(de=de?de.__html:void 0,de!=null&&Rn(i,de)):D==="children"?typeof de=="string"?(h!=="textarea"||de!=="")&&ot(i,de):typeof de=="number"&&ot(i,""+de):D!=="suppressContentEditableWarning"&&D!=="suppressHydrationWarning"&&D!=="autoFocus"&&(s.hasOwnProperty(D)?de!=null&&D==="onScroll"&&sn("scroll",i):de!=null&&S(i,D,de,U))}switch(h){case"input":ce(i),Ot(i,v,!1);break;case"textarea":ce(i),Xe(i);break;case"option":v.value!=null&&i.setAttribute("value",""+z(v.value));break;case"select":i.multiple=!!v.multiple,D=v.value,D!=null?Fn(i,!!v.multiple,D,!1):v.defaultValue!=null&&Fn(i,!!v.multiple,v.defaultValue,!0);break;default:typeof j.onClick=="function"&&(i.onclick=Ju)}switch(h){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return fa(c),null;case 6:if(i&&c.stateNode!=null)e1(i,c,i.memoizedProps,v);else{if(typeof v!="string"&&c.stateNode===null)throw Error(a(166));if(h=wl(dd.current),wl(ls.current),sh(c)){if(v=c.stateNode,h=c.memoizedProps,v[is]=c,(D=v.nodeValue!==h)&&(i=rr,i!==null))switch(i.tag){case 3:Yu(v.nodeValue,h,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Yu(v.nodeValue,h,(i.mode&1)!==0)}D&&(c.flags|=4)}else v=(h.nodeType===9?h:h.ownerDocument).createTextNode(v),v[is]=c,c.stateNode=v}return fa(c),null;case 13:if(ln(fn),v=c.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(xn&&sr!==null&&(c.mode&1)!==0&&(c.flags&128)===0)av(),Mo(),c.flags|=98560,D=!1;else if(D=sh(c),v!==null&&v.dehydrated!==null){if(i===null){if(!D)throw Error(a(318));if(D=c.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(a(317));D[is]=c}else Mo(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;fa(c),D=!1}else Kr!==null&&(Pm(Kr),Kr=null),D=!0;if(!D)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=h,c):(v=v!==null,v!==(i!==null&&i.memoizedState!==null)&&v&&(c.child.flags|=8192,(c.mode&1)!==0&&(i===null||(fn.current&1)!==0?Hn===0&&(Hn=3):Mm())),c.updateQueue!==null&&(c.flags|=4),fa(c),null);case 4:return Vo(),wm(i,c),i===null&&ad(c.stateNode.containerInfo),fa(c),null;case 10:return Yx(c.type._context),fa(c),null;case 17:return Ua(c.type)&&eh(),fa(c),null;case 19:if(ln(fn),D=c.memoizedState,D===null)return fa(c),null;if(v=(c.flags&128)!==0,U=D.rendering,U===null)if(v)fd(D,!1);else{if(Hn!==0||i!==null&&(i.flags&128)!==0)for(i=c.child;i!==null;){if(U=uh(i),U!==null){for(c.flags|=128,fd(D,!1),v=U.updateQueue,v!==null&&(c.updateQueue=v,c.flags|=4),c.subtreeFlags=0,v=h,h=c.child;h!==null;)D=h,i=v,D.flags&=14680066,U=D.alternate,U===null?(D.childLanes=0,D.lanes=i,D.child=null,D.subtreeFlags=0,D.memoizedProps=null,D.memoizedState=null,D.updateQueue=null,D.dependencies=null,D.stateNode=null):(D.childLanes=U.childLanes,D.lanes=U.lanes,D.child=U.child,D.subtreeFlags=0,D.deletions=null,D.memoizedProps=U.memoizedProps,D.memoizedState=U.memoizedState,D.updateQueue=U.updateQueue,D.type=U.type,i=U.dependencies,D.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),h=h.sibling;return nn(fn,fn.current&1|2),c.child}i=i.sibling}D.tail!==null&&Me()>$o&&(c.flags|=128,v=!0,fd(D,!1),c.lanes=4194304)}else{if(!v)if(i=uh(U),i!==null){if(c.flags|=128,v=!0,h=i.updateQueue,h!==null&&(c.updateQueue=h,c.flags|=4),fd(D,!0),D.tail===null&&D.tailMode==="hidden"&&!U.alternate&&!xn)return fa(c),null}else 2*Me()-D.renderingStartTime>$o&&h!==1073741824&&(c.flags|=128,v=!0,fd(D,!1),c.lanes=4194304);D.isBackwards?(U.sibling=c.child,c.child=U):(h=D.last,h!==null?h.sibling=U:c.child=U,D.last=U)}return D.tail!==null?(c=D.tail,D.rendering=c,D.tail=c.sibling,D.renderingStartTime=Me(),c.sibling=null,h=fn.current,nn(fn,v?h&1|2:h&1),c):(fa(c),null);case 22:case 23:return Om(),v=c.memoizedState!==null,i!==null&&i.memoizedState!==null!==v&&(c.flags|=8192),v&&(c.mode&1)!==0?(ir&1073741824)!==0&&(fa(c),c.subtreeFlags&6&&(c.flags|=8192)):fa(c),null;case 24:return null;case 25:return null}throw Error(a(156,c.tag))}function J4(i,c){switch($x(c),c.tag){case 1:return Ua(c.type)&&eh(),i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 3:return Vo(),ln(Va),ln(xa),rm(),i=c.flags,(i&65536)!==0&&(i&128)===0?(c.flags=i&-65537|128,c):null;case 5:return nm(c),null;case 13:if(ln(fn),i=c.memoizedState,i!==null&&i.dehydrated!==null){if(c.alternate===null)throw Error(a(340));Mo()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 19:return ln(fn),null;case 4:return Vo(),null;case 10:return Yx(c.type._context),null;case 22:case 23:return Om(),null;case 24:return null;default:return null}}var bh=!1,pa=!1,Z4=typeof WeakSet=="function"?WeakSet:Set,We=null;function Ko(i,c){var h=i.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(v){bn(i,c,v)}else h.current=null}function km(i,c,h){try{h()}catch(v){bn(i,c,v)}}var t1=!1;function eC(i,c){if(Ox=Hu,i=Ly(),_x(i)){if("selectionStart"in i)var h={start:i.selectionStart,end:i.selectionEnd};else e:{h=(h=i.ownerDocument)&&h.defaultView||window;var v=h.getSelection&&h.getSelection();if(v&&v.rangeCount!==0){h=v.anchorNode;var j=v.anchorOffset,D=v.focusNode;v=v.focusOffset;try{h.nodeType,D.nodeType}catch{h=null;break e}var U=0,se=-1,de=-1,ke=0,Fe=0,Pe=i,Ae=null;t:for(;;){for(var Ge;Pe!==h||j!==0&&Pe.nodeType!==3||(se=U+j),Pe!==D||v!==0&&Pe.nodeType!==3||(de=U+v),Pe.nodeType===3&&(U+=Pe.nodeValue.length),(Ge=Pe.firstChild)!==null;)Ae=Pe,Pe=Ge;for(;;){if(Pe===i)break t;if(Ae===h&&++ke===j&&(se=U),Ae===D&&++Fe===v&&(de=U),(Ge=Pe.nextSibling)!==null)break;Pe=Ae,Ae=Pe.parentNode}Pe=Ge}h=se===-1||de===-1?null:{start:se,end:de}}else h=null}h=h||{start:0,end:0}}else h=null;for(Mx={focusedElem:i,selectionRange:h},Hu=!1,We=c;We!==null;)if(c=We,i=c.child,(c.subtreeFlags&1028)!==0&&i!==null)i.return=c,We=i;else for(;We!==null;){c=We;try{var Qe=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Qe!==null){var Je=Qe.memoizedProps,Sn=Qe.memoizedState,ye=c.stateNode,me=ye.getSnapshotBeforeUpdate(c.elementType===c.type?Je:zr(c.type,Je),Sn);ye.__reactInternalSnapshotBeforeUpdate=me}break;case 3:var ve=c.stateNode.containerInfo;ve.nodeType===1?ve.textContent="":ve.nodeType===9&&ve.documentElement&&ve.removeChild(ve.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(a(163))}}catch(Ve){bn(c,c.return,Ve)}if(i=c.sibling,i!==null){i.return=c.return,We=i;break}We=c.return}return Qe=t1,t1=!1,Qe}function pd(i,c,h){var v=c.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var j=v=v.next;do{if((j.tag&i)===i){var D=j.destroy;j.destroy=void 0,D!==void 0&&km(c,h,D)}j=j.next}while(j!==v)}}function Nh(i,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&i)===i){var v=h.create;h.destroy=v()}h=h.next}while(h!==c)}}function Tm(i){var c=i.ref;if(c!==null){var h=i.stateNode;switch(i.tag){case 5:i=h;break;default:i=h}typeof c=="function"?c(i):c.current=i}}function n1(i){var c=i.alternate;c!==null&&(i.alternate=null,n1(c)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(c=i.stateNode,c!==null&&(delete c[is],delete c[sd],delete c[Vx],delete c[O4],delete c[M4])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function a1(i){return i.tag===5||i.tag===3||i.tag===4}function r1(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||a1(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Cm(i,c,h){var v=i.tag;if(v===5||v===6)i=i.stateNode,c?h.nodeType===8?h.parentNode.insertBefore(i,c):h.insertBefore(i,c):(h.nodeType===8?(c=h.parentNode,c.insertBefore(i,h)):(c=h,c.appendChild(i)),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=Ju));else if(v!==4&&(i=i.child,i!==null))for(Cm(i,c,h),i=i.sibling;i!==null;)Cm(i,c,h),i=i.sibling}function Sm(i,c,h){var v=i.tag;if(v===5||v===6)i=i.stateNode,c?h.insertBefore(i,c):h.appendChild(i);else if(v!==4&&(i=i.child,i!==null))for(Sm(i,c,h),i=i.sibling;i!==null;)Sm(i,c,h),i=i.sibling}var ra=null,$r=!1;function Ei(i,c,h){for(h=h.child;h!==null;)s1(i,c,h),h=h.sibling}function s1(i,c,h){if(Wn&&typeof Wn.onCommitFiberUnmount=="function")try{Wn.onCommitFiberUnmount(ss,h)}catch{}switch(h.tag){case 5:pa||Ko(h,c);case 6:var v=ra,j=$r;ra=null,Ei(i,c,h),ra=v,$r=j,ra!==null&&($r?(i=ra,h=h.stateNode,i.nodeType===8?i.parentNode.removeChild(h):i.removeChild(h)):ra.removeChild(h.stateNode));break;case 18:ra!==null&&($r?(i=ra,h=h.stateNode,i.nodeType===8?Hx(i.parentNode,h):i.nodeType===1&&Hx(i,h),Wc(i)):Hx(ra,h.stateNode));break;case 4:v=ra,j=$r,ra=h.stateNode.containerInfo,$r=!0,Ei(i,c,h),ra=v,$r=j;break;case 0:case 11:case 14:case 15:if(!pa&&(v=h.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){j=v=v.next;do{var D=j,U=D.destroy;D=D.tag,U!==void 0&&((D&2)!==0||(D&4)!==0)&&km(h,c,U),j=j.next}while(j!==v)}Ei(i,c,h);break;case 1:if(!pa&&(Ko(h,c),v=h.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=h.memoizedProps,v.state=h.memoizedState,v.componentWillUnmount()}catch(se){bn(h,c,se)}Ei(i,c,h);break;case 21:Ei(i,c,h);break;case 22:h.mode&1?(pa=(v=pa)||h.memoizedState!==null,Ei(i,c,h),pa=v):Ei(i,c,h);break;default:Ei(i,c,h)}}function i1(i){var c=i.updateQueue;if(c!==null){i.updateQueue=null;var h=i.stateNode;h===null&&(h=i.stateNode=new Z4),c.forEach(function(v){var j=cC.bind(null,i,v);h.has(v)||(h.add(v),v.then(j,j))})}}function Gr(i,c){var h=c.deletions;if(h!==null)for(var v=0;v<h.length;v++){var j=h[v];try{var D=i,U=c,se=U;e:for(;se!==null;){switch(se.tag){case 5:ra=se.stateNode,$r=!1;break e;case 3:ra=se.stateNode.containerInfo,$r=!0;break e;case 4:ra=se.stateNode.containerInfo,$r=!0;break e}se=se.return}if(ra===null)throw Error(a(160));s1(D,U,j),ra=null,$r=!1;var de=j.alternate;de!==null&&(de.return=null),j.return=null}catch(ke){bn(j,c,ke)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)l1(c,i),c=c.sibling}function l1(i,c){var h=i.alternate,v=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Gr(c,i),cs(i),v&4){try{pd(3,i,i.return),Nh(3,i)}catch(Je){bn(i,i.return,Je)}try{pd(5,i,i.return)}catch(Je){bn(i,i.return,Je)}}break;case 1:Gr(c,i),cs(i),v&512&&h!==null&&Ko(h,h.return);break;case 5:if(Gr(c,i),cs(i),v&512&&h!==null&&Ko(h,h.return),i.flags&32){var j=i.stateNode;try{ot(j,"")}catch(Je){bn(i,i.return,Je)}}if(v&4&&(j=i.stateNode,j!=null)){var D=i.memoizedProps,U=h!==null?h.memoizedProps:D,se=i.type,de=i.updateQueue;if(i.updateQueue=null,de!==null)try{se==="input"&&D.type==="radio"&&D.name!=null&&Ye(j,D),Fs(se,U);var ke=Fs(se,D);for(U=0;U<de.length;U+=2){var Fe=de[U],Pe=de[U+1];Fe==="style"?_a(j,Pe):Fe==="dangerouslySetInnerHTML"?Rn(j,Pe):Fe==="children"?ot(j,Pe):S(j,Fe,Pe,ke)}switch(se){case"input":Re(j,D);break;case"textarea":Be(j,D);break;case"select":var Ae=j._wrapperState.wasMultiple;j._wrapperState.wasMultiple=!!D.multiple;var Ge=D.value;Ge!=null?Fn(j,!!D.multiple,Ge,!1):Ae!==!!D.multiple&&(D.defaultValue!=null?Fn(j,!!D.multiple,D.defaultValue,!0):Fn(j,!!D.multiple,D.multiple?[]:"",!1))}j[sd]=D}catch(Je){bn(i,i.return,Je)}}break;case 6:if(Gr(c,i),cs(i),v&4){if(i.stateNode===null)throw Error(a(162));j=i.stateNode,D=i.memoizedProps;try{j.nodeValue=D}catch(Je){bn(i,i.return,Je)}}break;case 3:if(Gr(c,i),cs(i),v&4&&h!==null&&h.memoizedState.isDehydrated)try{Wc(c.containerInfo)}catch(Je){bn(i,i.return,Je)}break;case 4:Gr(c,i),cs(i);break;case 13:Gr(c,i),cs(i),j=i.child,j.flags&8192&&(D=j.memoizedState!==null,j.stateNode.isHidden=D,!D||j.alternate!==null&&j.alternate.memoizedState!==null||(Dm=Me())),v&4&&i1(i);break;case 22:if(Fe=h!==null&&h.memoizedState!==null,i.mode&1?(pa=(ke=pa)||Fe,Gr(c,i),pa=ke):Gr(c,i),cs(i),v&8192){if(ke=i.memoizedState!==null,(i.stateNode.isHidden=ke)&&!Fe&&(i.mode&1)!==0)for(We=i,Fe=i.child;Fe!==null;){for(Pe=We=Fe;We!==null;){switch(Ae=We,Ge=Ae.child,Ae.tag){case 0:case 11:case 14:case 15:pd(4,Ae,Ae.return);break;case 1:Ko(Ae,Ae.return);var Qe=Ae.stateNode;if(typeof Qe.componentWillUnmount=="function"){v=Ae,h=Ae.return;try{c=v,Qe.props=c.memoizedProps,Qe.state=c.memoizedState,Qe.componentWillUnmount()}catch(Je){bn(v,h,Je)}}break;case 5:Ko(Ae,Ae.return);break;case 22:if(Ae.memoizedState!==null){d1(Pe);continue}}Ge!==null?(Ge.return=Ae,We=Ge):d1(Pe)}Fe=Fe.sibling}e:for(Fe=null,Pe=i;;){if(Pe.tag===5){if(Fe===null){Fe=Pe;try{j=Pe.stateNode,ke?(D=j.style,typeof D.setProperty=="function"?D.setProperty("display","none","important"):D.display="none"):(se=Pe.stateNode,de=Pe.memoizedProps.style,U=de!=null&&de.hasOwnProperty("display")?de.display:null,se.style.display=en("display",U))}catch(Je){bn(i,i.return,Je)}}}else if(Pe.tag===6){if(Fe===null)try{Pe.stateNode.nodeValue=ke?"":Pe.memoizedProps}catch(Je){bn(i,i.return,Je)}}else if((Pe.tag!==22&&Pe.tag!==23||Pe.memoizedState===null||Pe===i)&&Pe.child!==null){Pe.child.return=Pe,Pe=Pe.child;continue}if(Pe===i)break e;for(;Pe.sibling===null;){if(Pe.return===null||Pe.return===i)break e;Fe===Pe&&(Fe=null),Pe=Pe.return}Fe===Pe&&(Fe=null),Pe.sibling.return=Pe.return,Pe=Pe.sibling}}break;case 19:Gr(c,i),cs(i),v&4&&i1(i);break;case 21:break;default:Gr(c,i),cs(i)}}function cs(i){var c=i.flags;if(c&2){try{e:{for(var h=i.return;h!==null;){if(a1(h)){var v=h;break e}h=h.return}throw Error(a(160))}switch(v.tag){case 5:var j=v.stateNode;v.flags&32&&(ot(j,""),v.flags&=-33);var D=r1(i);Sm(i,D,j);break;case 3:case 4:var U=v.stateNode.containerInfo,se=r1(i);Cm(i,se,U);break;default:throw Error(a(161))}}catch(de){bn(i,i.return,de)}i.flags&=-3}c&4096&&(i.flags&=-4097)}function tC(i,c,h){We=i,o1(i)}function o1(i,c,h){for(var v=(i.mode&1)!==0;We!==null;){var j=We,D=j.child;if(j.tag===22&&v){var U=j.memoizedState!==null||bh;if(!U){var se=j.alternate,de=se!==null&&se.memoizedState!==null||pa;se=bh;var ke=pa;if(bh=U,(pa=de)&&!ke)for(We=j;We!==null;)U=We,de=U.child,U.tag===22&&U.memoizedState!==null?u1(j):de!==null?(de.return=U,We=de):u1(j);for(;D!==null;)We=D,o1(D),D=D.sibling;We=j,bh=se,pa=ke}c1(i)}else(j.subtreeFlags&8772)!==0&&D!==null?(D.return=j,We=D):c1(i)}}function c1(i){for(;We!==null;){var c=We;if((c.flags&8772)!==0){var h=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:pa||Nh(5,c);break;case 1:var v=c.stateNode;if(c.flags&4&&!pa)if(h===null)v.componentDidMount();else{var j=c.elementType===c.type?h.memoizedProps:zr(c.type,h.memoizedProps);v.componentDidUpdate(j,h.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var D=c.updateQueue;D!==null&&dv(c,D,v);break;case 3:var U=c.updateQueue;if(U!==null){if(h=null,c.child!==null)switch(c.child.tag){case 5:h=c.child.stateNode;break;case 1:h=c.child.stateNode}dv(c,U,h)}break;case 5:var se=c.stateNode;if(h===null&&c.flags&4){h=se;var de=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":de.autoFocus&&h.focus();break;case"img":de.src&&(h.src=de.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var ke=c.alternate;if(ke!==null){var Fe=ke.memoizedState;if(Fe!==null){var Pe=Fe.dehydrated;Pe!==null&&Wc(Pe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(a(163))}pa||c.flags&512&&Tm(c)}catch(Ae){bn(c,c.return,Ae)}}if(c===i){We=null;break}if(h=c.sibling,h!==null){h.return=c.return,We=h;break}We=c.return}}function d1(i){for(;We!==null;){var c=We;if(c===i){We=null;break}var h=c.sibling;if(h!==null){h.return=c.return,We=h;break}We=c.return}}function u1(i){for(;We!==null;){var c=We;try{switch(c.tag){case 0:case 11:case 15:var h=c.return;try{Nh(4,c)}catch(de){bn(c,h,de)}break;case 1:var v=c.stateNode;if(typeof v.componentDidMount=="function"){var j=c.return;try{v.componentDidMount()}catch(de){bn(c,j,de)}}var D=c.return;try{Tm(c)}catch(de){bn(c,D,de)}break;case 5:var U=c.return;try{Tm(c)}catch(de){bn(c,U,de)}}}catch(de){bn(c,c.return,de)}if(c===i){We=null;break}var se=c.sibling;if(se!==null){se.return=c.return,We=se;break}We=c.return}}var nC=Math.ceil,jh=w.ReactCurrentDispatcher,_m=w.ReactCurrentOwner,br=w.ReactCurrentBatchConfig,_t=0,Qn=null,Ln=null,sa=0,ir=0,zo=ki(0),Hn=0,gd=null,Tl=0,wh=0,Em=0,yd=null,za=null,Dm=0,$o=1/0,Vs=null,kh=!1,Am=null,Di=null,Th=!1,Ai=null,Ch=0,vd=0,Fm=null,Sh=-1,_h=0;function Da(){return(_t&6)!==0?Me():Sh!==-1?Sh:Sh=Me()}function Fi(i){return(i.mode&1)===0?1:(_t&2)!==0&&sa!==0?sa&-sa:B4.transition!==null?(_h===0&&(_h=ry()),_h):(i=zt,i!==0||(i=window.event,i=i===void 0?16:xy(i.type)),i)}function qr(i,c,h,v){if(50<vd)throw vd=0,Fm=null,Error(a(185));Kc(i,h,v),((_t&2)===0||i!==Qn)&&(i===Qn&&((_t&2)===0&&(wh|=h),Hn===4&&Li(i,sa)),$a(i,v),h===1&&_t===0&&(c.mode&1)===0&&($o=Me()+500,nh&&Ci()))}function $a(i,c){var h=i.callbackNode;BT(i,c);var v=Mu(i,i===Qn?sa:0);if(v===0)h!==null&&ze(h),i.callbackNode=null,i.callbackPriority=0;else if(c=v&-v,i.callbackPriority!==c){if(h!=null&&ze(h),c===1)i.tag===0?R4(x1.bind(null,i)):Jy(x1.bind(null,i)),P4(function(){(_t&6)===0&&Ci()}),h=null;else{switch(sy(v)){case 1:h=Yt;break;case 4:h=tn;break;case 16:h=Tn;break;case 536870912:h=pi;break;default:h=Tn}h=N1(h,h1.bind(null,i))}i.callbackPriority=c,i.callbackNode=h}}function h1(i,c){if(Sh=-1,_h=0,(_t&6)!==0)throw Error(a(327));var h=i.callbackNode;if(Go()&&i.callbackNode!==h)return null;var v=Mu(i,i===Qn?sa:0);if(v===0)return null;if((v&30)!==0||(v&i.expiredLanes)!==0||c)c=Eh(i,v);else{c=v;var j=_t;_t|=2;var D=f1();(Qn!==i||sa!==c)&&(Vs=null,$o=Me()+500,Sl(i,c));do try{sC();break}catch(se){m1(i,se)}while(!0);Qx(),jh.current=D,_t=j,Ln!==null?c=0:(Qn=null,sa=0,c=Hn)}if(c!==0){if(c===2&&(j=hx(i),j!==0&&(v=j,c=Lm(i,j))),c===1)throw h=gd,Sl(i,0),Li(i,v),$a(i,Me()),h;if(c===6)Li(i,v);else{if(j=i.current.alternate,(v&30)===0&&!aC(j)&&(c=Eh(i,v),c===2&&(D=hx(i),D!==0&&(v=D,c=Lm(i,D))),c===1))throw h=gd,Sl(i,0),Li(i,v),$a(i,Me()),h;switch(i.finishedWork=j,i.finishedLanes=v,c){case 0:case 1:throw Error(a(345));case 2:_l(i,za,Vs);break;case 3:if(Li(i,v),(v&130023424)===v&&(c=Dm+500-Me(),10<c)){if(Mu(i,0)!==0)break;if(j=i.suspendedLanes,(j&v)!==v){Da(),i.pingedLanes|=i.suspendedLanes&j;break}i.timeoutHandle=Bx(_l.bind(null,i,za,Vs),c);break}_l(i,za,Vs);break;case 4:if(Li(i,v),(v&4194240)===v)break;for(c=i.eventTimes,j=-1;0<v;){var U=31-Cn(v);D=1<<U,U=c[U],U>j&&(j=U),v&=~D}if(v=j,v=Me()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*nC(v/1960))-v,10<v){i.timeoutHandle=Bx(_l.bind(null,i,za,Vs),v);break}_l(i,za,Vs);break;case 5:_l(i,za,Vs);break;default:throw Error(a(329))}}}return $a(i,Me()),i.callbackNode===h?h1.bind(null,i):null}function Lm(i,c){var h=yd;return i.current.memoizedState.isDehydrated&&(Sl(i,c).flags|=256),i=Eh(i,c),i!==2&&(c=za,za=h,c!==null&&Pm(c)),i}function Pm(i){za===null?za=i:za.push.apply(za,i)}function aC(i){for(var c=i;;){if(c.flags&16384){var h=c.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var v=0;v<h.length;v++){var j=h[v],D=j.getSnapshot;j=j.value;try{if(!Ur(D(),j))return!1}catch{return!1}}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Li(i,c){for(c&=~Em,c&=~wh,i.suspendedLanes|=c,i.pingedLanes&=~c,i=i.expirationTimes;0<c;){var h=31-Cn(c),v=1<<h;i[h]=-1,c&=~v}}function x1(i){if((_t&6)!==0)throw Error(a(327));Go();var c=Mu(i,0);if((c&1)===0)return $a(i,Me()),null;var h=Eh(i,c);if(i.tag!==0&&h===2){var v=hx(i);v!==0&&(c=v,h=Lm(i,v))}if(h===1)throw h=gd,Sl(i,0),Li(i,c),$a(i,Me()),h;if(h===6)throw Error(a(345));return i.finishedWork=i.current.alternate,i.finishedLanes=c,_l(i,za,Vs),$a(i,Me()),null}function Im(i,c){var h=_t;_t|=1;try{return i(c)}finally{_t=h,_t===0&&($o=Me()+500,nh&&Ci())}}function Cl(i){Ai!==null&&Ai.tag===0&&(_t&6)===0&&Go();var c=_t;_t|=1;var h=br.transition,v=zt;try{if(br.transition=null,zt=1,i)return i()}finally{zt=v,br.transition=h,_t=c,(_t&6)===0&&Ci()}}function Om(){ir=zo.current,ln(zo)}function Sl(i,c){i.finishedWork=null,i.finishedLanes=0;var h=i.timeoutHandle;if(h!==-1&&(i.timeoutHandle=-1,L4(h)),Ln!==null)for(h=Ln.return;h!==null;){var v=h;switch($x(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&eh();break;case 3:Vo(),ln(Va),ln(xa),rm();break;case 5:nm(v);break;case 4:Vo();break;case 13:ln(fn);break;case 19:ln(fn);break;case 10:Yx(v.type._context);break;case 22:case 23:Om()}h=h.return}if(Qn=i,Ln=i=Pi(i.current,null),sa=ir=c,Hn=0,gd=null,Em=wh=Tl=0,za=yd=null,jl!==null){for(c=0;c<jl.length;c++)if(h=jl[c],v=h.interleaved,v!==null){h.interleaved=null;var j=v.next,D=h.pending;if(D!==null){var U=D.next;D.next=j,v.next=U}h.pending=v}jl=null}return i}function m1(i,c){do{var h=Ln;try{if(Qx(),hh.current=ph,xh){for(var v=pn.memoizedState;v!==null;){var j=v.queue;j!==null&&(j.pending=null),v=v.next}xh=!1}if(kl=0,Xn=Bn=pn=null,ud=!1,hd=0,_m.current=null,h===null||h.return===null){Hn=1,gd=c,Ln=null;break}e:{var D=i,U=h.return,se=h,de=c;if(c=sa,se.flags|=32768,de!==null&&typeof de=="object"&&typeof de.then=="function"){var ke=de,Fe=se,Pe=Fe.tag;if((Fe.mode&1)===0&&(Pe===0||Pe===11||Pe===15)){var Ae=Fe.alternate;Ae?(Fe.updateQueue=Ae.updateQueue,Fe.memoizedState=Ae.memoizedState,Fe.lanes=Ae.lanes):(Fe.updateQueue=null,Fe.memoizedState=null)}var Ge=Bv(U);if(Ge!==null){Ge.flags&=-257,Hv(Ge,U,se,D,c),Ge.mode&1&&Rv(D,ke,c),c=Ge,de=ke;var Qe=c.updateQueue;if(Qe===null){var Je=new Set;Je.add(de),c.updateQueue=Je}else Qe.add(de);break e}else{if((c&1)===0){Rv(D,ke,c),Mm();break e}de=Error(a(426))}}else if(xn&&se.mode&1){var Sn=Bv(U);if(Sn!==null){(Sn.flags&65536)===0&&(Sn.flags|=256),Hv(Sn,U,se,D,c),Wx(Uo(de,se));break e}}D=de=Uo(de,se),Hn!==4&&(Hn=2),yd===null?yd=[D]:yd.push(D),D=U;do{switch(D.tag){case 3:D.flags|=65536,c&=-c,D.lanes|=c;var ye=Ov(D,de,c);cv(D,ye);break e;case 1:se=de;var me=D.type,ve=D.stateNode;if((D.flags&128)===0&&(typeof me.getDerivedStateFromError=="function"||ve!==null&&typeof ve.componentDidCatch=="function"&&(Di===null||!Di.has(ve)))){D.flags|=65536,c&=-c,D.lanes|=c;var Ve=Mv(D,se,c);cv(D,Ve);break e}}D=D.return}while(D!==null)}g1(h)}catch(Ze){c=Ze,Ln===h&&h!==null&&(Ln=h=h.return);continue}break}while(!0)}function f1(){var i=jh.current;return jh.current=ph,i===null?ph:i}function Mm(){(Hn===0||Hn===3||Hn===2)&&(Hn=4),Qn===null||(Tl&268435455)===0&&(wh&268435455)===0||Li(Qn,sa)}function Eh(i,c){var h=_t;_t|=2;var v=f1();(Qn!==i||sa!==c)&&(Vs=null,Sl(i,c));do try{rC();break}catch(j){m1(i,j)}while(!0);if(Qx(),_t=h,jh.current=v,Ln!==null)throw Error(a(261));return Qn=null,sa=0,Hn}function rC(){for(;Ln!==null;)p1(Ln)}function sC(){for(;Ln!==null&&!qe();)p1(Ln)}function p1(i){var c=b1(i.alternate,i,ir);i.memoizedProps=i.pendingProps,c===null?g1(i):Ln=c,_m.current=null}function g1(i){var c=i;do{var h=c.alternate;if(i=c.return,(c.flags&32768)===0){if(h=Y4(h,c,ir),h!==null){Ln=h;return}}else{if(h=J4(h,c),h!==null){h.flags&=32767,Ln=h;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Hn=6,Ln=null;return}}if(c=c.sibling,c!==null){Ln=c;return}Ln=c=i}while(c!==null);Hn===0&&(Hn=5)}function _l(i,c,h){var v=zt,j=br.transition;try{br.transition=null,zt=1,iC(i,c,h,v)}finally{br.transition=j,zt=v}return null}function iC(i,c,h,v){do Go();while(Ai!==null);if((_t&6)!==0)throw Error(a(327));h=i.finishedWork;var j=i.finishedLanes;if(h===null)return null;if(i.finishedWork=null,i.finishedLanes=0,h===i.current)throw Error(a(177));i.callbackNode=null,i.callbackPriority=0;var D=h.lanes|h.childLanes;if(HT(i,D),i===Qn&&(Ln=Qn=null,sa=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||Th||(Th=!0,N1(Tn,function(){return Go(),null})),D=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||D){D=br.transition,br.transition=null;var U=zt;zt=1;var se=_t;_t|=4,_m.current=null,eC(i,h),l1(h,i),C4(Mx),Hu=!!Ox,Mx=Ox=null,i.current=h,tC(h),He(),_t=se,zt=U,br.transition=D}else i.current=h;if(Th&&(Th=!1,Ai=i,Ch=j),D=i.pendingLanes,D===0&&(Di=null),Vc(h.stateNode),$a(i,Me()),c!==null)for(v=i.onRecoverableError,h=0;h<c.length;h++)j=c[h],v(j.value,{componentStack:j.stack,digest:j.digest});if(kh)throw kh=!1,i=Am,Am=null,i;return(Ch&1)!==0&&i.tag!==0&&Go(),D=i.pendingLanes,(D&1)!==0?i===Fm?vd++:(vd=0,Fm=i):vd=0,Ci(),null}function Go(){if(Ai!==null){var i=sy(Ch),c=br.transition,h=zt;try{if(br.transition=null,zt=16>i?16:i,Ai===null)var v=!1;else{if(i=Ai,Ai=null,Ch=0,(_t&6)!==0)throw Error(a(331));var j=_t;for(_t|=4,We=i.current;We!==null;){var D=We,U=D.child;if((We.flags&16)!==0){var se=D.deletions;if(se!==null){for(var de=0;de<se.length;de++){var ke=se[de];for(We=ke;We!==null;){var Fe=We;switch(Fe.tag){case 0:case 11:case 15:pd(8,Fe,D)}var Pe=Fe.child;if(Pe!==null)Pe.return=Fe,We=Pe;else for(;We!==null;){Fe=We;var Ae=Fe.sibling,Ge=Fe.return;if(n1(Fe),Fe===ke){We=null;break}if(Ae!==null){Ae.return=Ge,We=Ae;break}We=Ge}}}var Qe=D.alternate;if(Qe!==null){var Je=Qe.child;if(Je!==null){Qe.child=null;do{var Sn=Je.sibling;Je.sibling=null,Je=Sn}while(Je!==null)}}We=D}}if((D.subtreeFlags&2064)!==0&&U!==null)U.return=D,We=U;else e:for(;We!==null;){if(D=We,(D.flags&2048)!==0)switch(D.tag){case 0:case 11:case 15:pd(9,D,D.return)}var ye=D.sibling;if(ye!==null){ye.return=D.return,We=ye;break e}We=D.return}}var me=i.current;for(We=me;We!==null;){U=We;var ve=U.child;if((U.subtreeFlags&2064)!==0&&ve!==null)ve.return=U,We=ve;else e:for(U=me;We!==null;){if(se=We,(se.flags&2048)!==0)try{switch(se.tag){case 0:case 11:case 15:Nh(9,se)}}catch(Ze){bn(se,se.return,Ze)}if(se===U){We=null;break e}var Ve=se.sibling;if(Ve!==null){Ve.return=se.return,We=Ve;break e}We=se.return}}if(_t=j,Ci(),Wn&&typeof Wn.onPostCommitFiberRoot=="function")try{Wn.onPostCommitFiberRoot(ss,i)}catch{}v=!0}return v}finally{zt=h,br.transition=c}}return!1}function y1(i,c,h){c=Uo(h,c),c=Ov(i,c,1),i=_i(i,c,1),c=Da(),i!==null&&(Kc(i,1,c),$a(i,c))}function bn(i,c,h){if(i.tag===3)y1(i,i,h);else for(;c!==null;){if(c.tag===3){y1(c,i,h);break}else if(c.tag===1){var v=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(Di===null||!Di.has(v))){i=Uo(h,i),i=Mv(c,i,1),c=_i(c,i,1),i=Da(),c!==null&&(Kc(c,1,i),$a(c,i));break}}c=c.return}}function lC(i,c,h){var v=i.pingCache;v!==null&&v.delete(c),c=Da(),i.pingedLanes|=i.suspendedLanes&h,Qn===i&&(sa&h)===h&&(Hn===4||Hn===3&&(sa&130023424)===sa&&500>Me()-Dm?Sl(i,0):Em|=h),$a(i,c)}function v1(i,c){c===0&&((i.mode&1)===0?c=1:(c=Ou,Ou<<=1,(Ou&130023424)===0&&(Ou=4194304)));var h=Da();i=Rs(i,c),i!==null&&(Kc(i,c,h),$a(i,h))}function oC(i){var c=i.memoizedState,h=0;c!==null&&(h=c.retryLane),v1(i,h)}function cC(i,c){var h=0;switch(i.tag){case 13:var v=i.stateNode,j=i.memoizedState;j!==null&&(h=j.retryLane);break;case 19:v=i.stateNode;break;default:throw Error(a(314))}v!==null&&v.delete(c),v1(i,h)}var b1;b1=function(i,c,h){if(i!==null)if(i.memoizedProps!==c.pendingProps||Va.current)Ka=!0;else{if((i.lanes&h)===0&&(c.flags&128)===0)return Ka=!1,Q4(i,c,h);Ka=(i.flags&131072)!==0}else Ka=!1,xn&&(c.flags&1048576)!==0&&Zy(c,rh,c.index);switch(c.lanes=0,c.tag){case 2:var v=c.type;vh(i,c),i=c.pendingProps;var j=Po(c,xa.current);Ho(c,h),j=lm(null,c,v,i,j,h);var D=om();return c.flags|=1,typeof j=="object"&&j!==null&&typeof j.render=="function"&&j.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Ua(v)?(D=!0,th(c)):D=!1,c.memoizedState=j.state!==null&&j.state!==void 0?j.state:null,em(c),j.updater=gh,c.stateNode=j,j._reactInternals=c,mm(c,v,i,h),c=ym(null,c,v,!0,D,h)):(c.tag=0,xn&&D&&zx(c),Ea(null,c,j,h),c=c.child),c;case 16:v=c.elementType;e:{switch(vh(i,c),i=c.pendingProps,j=v._init,v=j(v._payload),c.type=v,j=c.tag=uC(v),i=zr(v,i),j){case 0:c=gm(null,c,v,i,h);break e;case 1:c=Gv(null,c,v,i,h);break e;case 11:c=Vv(null,c,v,i,h);break e;case 14:c=Uv(null,c,v,zr(v.type,i),h);break e}throw Error(a(306,v,""))}return c;case 0:return v=c.type,j=c.pendingProps,j=c.elementType===v?j:zr(v,j),gm(i,c,v,j,h);case 1:return v=c.type,j=c.pendingProps,j=c.elementType===v?j:zr(v,j),Gv(i,c,v,j,h);case 3:e:{if(qv(c),i===null)throw Error(a(387));v=c.pendingProps,D=c.memoizedState,j=D.element,ov(i,c),dh(c,v,null,h);var U=c.memoizedState;if(v=U.element,D.isDehydrated)if(D={element:v,isDehydrated:!1,cache:U.cache,pendingSuspenseBoundaries:U.pendingSuspenseBoundaries,transitions:U.transitions},c.updateQueue.baseState=D,c.memoizedState=D,c.flags&256){j=Uo(Error(a(423)),c),c=Wv(i,c,v,h,j);break e}else if(v!==j){j=Uo(Error(a(424)),c),c=Wv(i,c,v,h,j);break e}else for(sr=wi(c.stateNode.containerInfo.firstChild),rr=c,xn=!0,Kr=null,h=iv(c,null,v,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Mo(),v===j){c=Hs(i,c,h);break e}Ea(i,c,v,h)}c=c.child}return c;case 5:return uv(c),i===null&&qx(c),v=c.type,j=c.pendingProps,D=i!==null?i.memoizedProps:null,U=j.children,Rx(v,j)?U=null:D!==null&&Rx(v,D)&&(c.flags|=32),$v(i,c),Ea(i,c,U,h),c.child;case 6:return i===null&&qx(c),null;case 13:return Xv(i,c,h);case 4:return tm(c,c.stateNode.containerInfo),v=c.pendingProps,i===null?c.child=Ro(c,null,v,h):Ea(i,c,v,h),c.child;case 11:return v=c.type,j=c.pendingProps,j=c.elementType===v?j:zr(v,j),Vv(i,c,v,j,h);case 7:return Ea(i,c,c.pendingProps,h),c.child;case 8:return Ea(i,c,c.pendingProps.children,h),c.child;case 12:return Ea(i,c,c.pendingProps.children,h),c.child;case 10:e:{if(v=c.type._context,j=c.pendingProps,D=c.memoizedProps,U=j.value,nn(lh,v._currentValue),v._currentValue=U,D!==null)if(Ur(D.value,U)){if(D.children===j.children&&!Va.current){c=Hs(i,c,h);break e}}else for(D=c.child,D!==null&&(D.return=c);D!==null;){var se=D.dependencies;if(se!==null){U=D.child;for(var de=se.firstContext;de!==null;){if(de.context===v){if(D.tag===1){de=Bs(-1,h&-h),de.tag=2;var ke=D.updateQueue;if(ke!==null){ke=ke.shared;var Fe=ke.pending;Fe===null?de.next=de:(de.next=Fe.next,Fe.next=de),ke.pending=de}}D.lanes|=h,de=D.alternate,de!==null&&(de.lanes|=h),Jx(D.return,h,c),se.lanes|=h;break}de=de.next}}else if(D.tag===10)U=D.type===c.type?null:D.child;else if(D.tag===18){if(U=D.return,U===null)throw Error(a(341));U.lanes|=h,se=U.alternate,se!==null&&(se.lanes|=h),Jx(U,h,c),U=D.sibling}else U=D.child;if(U!==null)U.return=D;else for(U=D;U!==null;){if(U===c){U=null;break}if(D=U.sibling,D!==null){D.return=U.return,U=D;break}U=U.return}D=U}Ea(i,c,j.children,h),c=c.child}return c;case 9:return j=c.type,v=c.pendingProps.children,Ho(c,h),j=yr(j),v=v(j),c.flags|=1,Ea(i,c,v,h),c.child;case 14:return v=c.type,j=zr(v,c.pendingProps),j=zr(v.type,j),Uv(i,c,v,j,h);case 15:return Kv(i,c,c.type,c.pendingProps,h);case 17:return v=c.type,j=c.pendingProps,j=c.elementType===v?j:zr(v,j),vh(i,c),c.tag=1,Ua(v)?(i=!0,th(c)):i=!1,Ho(c,h),Pv(c,v,j),mm(c,v,j,h),ym(null,c,v,!0,i,h);case 19:return Yv(i,c,h);case 22:return zv(i,c,h)}throw Error(a(156,c.tag))};function N1(i,c){return Le(i,c)}function dC(i,c,h,v){this.tag=i,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nr(i,c,h,v){return new dC(i,c,h,v)}function Rm(i){return i=i.prototype,!(!i||!i.isReactComponent)}function uC(i){if(typeof i=="function")return Rm(i)?1:0;if(i!=null){if(i=i.$$typeof,i===B)return 11;if(i===q)return 14}return 2}function Pi(i,c){var h=i.alternate;return h===null?(h=Nr(i.tag,c,i.key,i.mode),h.elementType=i.elementType,h.type=i.type,h.stateNode=i.stateNode,h.alternate=i,i.alternate=h):(h.pendingProps=c,h.type=i.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=i.flags&14680064,h.childLanes=i.childLanes,h.lanes=i.lanes,h.child=i.child,h.memoizedProps=i.memoizedProps,h.memoizedState=i.memoizedState,h.updateQueue=i.updateQueue,c=i.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=i.sibling,h.index=i.index,h.ref=i.ref,h}function Dh(i,c,h,v,j,D){var U=2;if(v=i,typeof i=="function")Rm(i)&&(U=1);else if(typeof i=="string")U=5;else e:switch(i){case C:return El(h.children,j,D,c);case P:U=8,j|=8;break;case F:return i=Nr(12,h,c,j|2),i.elementType=F,i.lanes=D,i;case W:return i=Nr(13,h,c,j),i.elementType=W,i.lanes=D,i;case ee:return i=Nr(19,h,c,j),i.elementType=ee,i.lanes=D,i;case ne:return Ah(h,j,D,c);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case H:U=10;break e;case O:U=9;break e;case B:U=11;break e;case q:U=14;break e;case fe:U=16,v=null;break e}throw Error(a(130,i==null?i:typeof i,""))}return c=Nr(U,h,c,j),c.elementType=i,c.type=v,c.lanes=D,c}function El(i,c,h,v){return i=Nr(7,i,v,c),i.lanes=h,i}function Ah(i,c,h,v){return i=Nr(22,i,v,c),i.elementType=ne,i.lanes=h,i.stateNode={isHidden:!1},i}function Bm(i,c,h){return i=Nr(6,i,null,c),i.lanes=h,i}function Hm(i,c,h){return c=Nr(4,i.children!==null?i.children:[],i.key,c),c.lanes=h,c.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},c}function hC(i,c,h,v,j){this.tag=c,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xx(0),this.expirationTimes=xx(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xx(0),this.identifierPrefix=v,this.onRecoverableError=j,this.mutableSourceEagerHydrationData=null}function Vm(i,c,h,v,j,D,U,se,de){return i=new hC(i,c,h,se,de),c===1?(c=1,D===!0&&(c|=8)):c=0,D=Nr(3,null,null,c),i.current=D,D.stateNode=i,D.memoizedState={element:v,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},em(D),i}function xC(i,c,h){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:L,key:v==null?null:""+v,children:i,containerInfo:c,implementation:h}}function j1(i){if(!i)return Ti;i=i._reactInternals;e:{if(re(i)!==i||i.tag!==1)throw Error(a(170));var c=i;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Ua(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(a(171))}if(i.tag===1){var h=i.type;if(Ua(h))return Qy(i,h,c)}return c}function w1(i,c,h,v,j,D,U,se,de){return i=Vm(h,v,!0,i,j,D,U,se,de),i.context=j1(null),h=i.current,v=Da(),j=Fi(h),D=Bs(v,j),D.callback=c??null,_i(h,D,j),i.current.lanes=j,Kc(i,j,v),$a(i,v),i}function Fh(i,c,h,v){var j=c.current,D=Da(),U=Fi(j);return h=j1(h),c.context===null?c.context=h:c.pendingContext=h,c=Bs(D,U),c.payload={element:i},v=v===void 0?null:v,v!==null&&(c.callback=v),i=_i(j,c,U),i!==null&&(qr(i,j,U,D),ch(i,j,U)),U}function Lh(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function k1(i,c){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var h=i.retryLane;i.retryLane=h!==0&&h<c?h:c}}function Um(i,c){k1(i,c),(i=i.alternate)&&k1(i,c)}function mC(){return null}var T1=typeof reportError=="function"?reportError:function(i){console.error(i)};function Km(i){this._internalRoot=i}Ph.prototype.render=Km.prototype.render=function(i){var c=this._internalRoot;if(c===null)throw Error(a(409));Fh(i,c,null,null)},Ph.prototype.unmount=Km.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var c=i.containerInfo;Cl(function(){Fh(null,i,null,null)}),c[Ps]=null}};function Ph(i){this._internalRoot=i}Ph.prototype.unstable_scheduleHydration=function(i){if(i){var c=oy();i={blockedOn:null,target:i,priority:c};for(var h=0;h<bi.length&&c!==0&&c<bi[h].priority;h++);bi.splice(h,0,i),h===0&&uy(i)}};function zm(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Ih(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function C1(){}function fC(i,c,h,v,j){if(j){if(typeof v=="function"){var D=v;v=function(){var ke=Lh(U);D.call(ke)}}var U=w1(c,v,i,0,null,!1,!1,"",C1);return i._reactRootContainer=U,i[Ps]=U.current,ad(i.nodeType===8?i.parentNode:i),Cl(),U}for(;j=i.lastChild;)i.removeChild(j);if(typeof v=="function"){var se=v;v=function(){var ke=Lh(de);se.call(ke)}}var de=Vm(i,0,!1,null,null,!1,!1,"",C1);return i._reactRootContainer=de,i[Ps]=de.current,ad(i.nodeType===8?i.parentNode:i),Cl(function(){Fh(c,de,h,v)}),de}function Oh(i,c,h,v,j){var D=h._reactRootContainer;if(D){var U=D;if(typeof j=="function"){var se=j;j=function(){var de=Lh(U);se.call(de)}}Fh(c,U,i,j)}else U=fC(h,c,i,j,v);return Lh(U)}iy=function(i){switch(i.tag){case 3:var c=i.stateNode;if(c.current.memoizedState.isDehydrated){var h=Uc(c.pendingLanes);h!==0&&(mx(c,h|1),$a(c,Me()),(_t&6)===0&&($o=Me()+500,Ci()))}break;case 13:Cl(function(){var v=Rs(i,1);if(v!==null){var j=Da();qr(v,i,1,j)}}),Um(i,1)}},fx=function(i){if(i.tag===13){var c=Rs(i,134217728);if(c!==null){var h=Da();qr(c,i,134217728,h)}Um(i,134217728)}},ly=function(i){if(i.tag===13){var c=Fi(i),h=Rs(i,c);if(h!==null){var v=Da();qr(h,i,c,v)}Um(i,c)}},oy=function(){return zt},cy=function(i,c){var h=zt;try{return zt=i,c()}finally{zt=h}},wo=function(i,c,h){switch(c){case"input":if(Re(i,h),c=h.name,h.type==="radio"&&c!=null){for(h=i;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<h.length;c++){var v=h[c];if(v!==i&&v.form===i.form){var j=Zu(v);if(!j)throw Error(a(90));R(v),Re(v,j)}}}break;case"textarea":Be(i,h);break;case"select":c=h.value,c!=null&&Fn(i,!!h.multiple,c,!1)}},Fu=Im,Lu=Cl;var pC={usingClientEntryPoint:!1,Events:[id,Fo,Zu,Du,Au,Im]},bd={findFiberByHostInstance:yl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},gC={bundleType:bd.bundleType,version:bd.version,rendererPackageName:bd.rendererPackageName,rendererConfig:bd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=je(i),i===null?null:i.stateNode},findFiberByHostInstance:bd.findFiberByHostInstance||mC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mh.isDisabled&&Mh.supportsFiber)try{ss=Mh.inject(gC),Wn=Mh}catch{}}return Ga.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pC,Ga.createPortal=function(i,c){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zm(c))throw Error(a(200));return xC(i,c,null,h)},Ga.createRoot=function(i,c){if(!zm(i))throw Error(a(299));var h=!1,v="",j=T1;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onRecoverableError!==void 0&&(j=c.onRecoverableError)),c=Vm(i,1,!1,null,null,h,!1,v,j),i[Ps]=c.current,ad(i.nodeType===8?i.parentNode:i),new Km(c)},Ga.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var c=i._reactInternals;if(c===void 0)throw typeof i.render=="function"?Error(a(188)):(i=Object.keys(i).join(","),Error(a(268,i)));return i=je(c),i=i===null?null:i.stateNode,i},Ga.flushSync=function(i){return Cl(i)},Ga.hydrate=function(i,c,h){if(!Ih(c))throw Error(a(200));return Oh(null,i,c,!0,h)},Ga.hydrateRoot=function(i,c,h){if(!zm(i))throw Error(a(405));var v=h!=null&&h.hydratedSources||null,j=!1,D="",U=T1;if(h!=null&&(h.unstable_strictMode===!0&&(j=!0),h.identifierPrefix!==void 0&&(D=h.identifierPrefix),h.onRecoverableError!==void 0&&(U=h.onRecoverableError)),c=w1(c,null,i,1,h??null,j,!1,D,U),i[Ps]=c.current,ad(i),v)for(i=0;i<v.length;i++)h=v[i],j=h._getVersion,j=j(h._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[h,j]:c.mutableSourceEagerHydrationData.push(h,j);return new Ph(c)},Ga.render=function(i,c,h){if(!Ih(c))throw Error(a(200));return Oh(null,i,c,!1,h)},Ga.unmountComponentAtNode=function(i){if(!Ih(i))throw Error(a(40));return i._reactRootContainer?(Cl(function(){Oh(null,null,i,!1,function(){i._reactRootContainer=null,i[Ps]=null})}),!0):!1},Ga.unstable_batchedUpdates=Im,Ga.unstable_renderSubtreeIntoContainer=function(i,c,h,v){if(!Ih(h))throw Error(a(200));if(i==null||i._reactInternals===void 0)throw Error(a(38));return Oh(i,c,h,!1,v)},Ga.version="18.3.1-next-f1338f8080-20240426",Ga}var I1;function _2(){if(I1)return Xm.exports;I1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),Xm.exports=_C(),Xm.exports}var O1;function EC(){if(O1)return Bh;O1=1;var e=_2();return Bh.createRoot=e.createRoot,Bh.hydrateRoot=e.hydrateRoot,Bh}var DC=EC(),Ec=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},AC={setTimeout:(e,n)=>setTimeout(e,n),clearTimeout:e=>clearTimeout(e),setInterval:(e,n)=>setInterval(e,n),clearInterval:e=>clearInterval(e)},Bi,Pp,p2,FC=(p2=class{constructor(){nt(this,Bi,AC);nt(this,Pp,!1)}setTimeoutProvider(e){$e(this,Bi,e)}setTimeout(e,n){return oe(this,Bi).setTimeout(e,n)}clearTimeout(e){oe(this,Bi).clearTimeout(e)}setInterval(e,n){return oe(this,Bi).setInterval(e,n)}clearInterval(e){oe(this,Bi).clearInterval(e)}},Bi=new WeakMap,Pp=new WeakMap,p2),Rl=new FC;function LC(e){setTimeout(e,0)}var no=typeof window>"u"||"Deno"in globalThis;function La(){}function PC(e,n){return typeof e=="function"?e(n):e}function Hf(e){return typeof e=="number"&&e>=0&&e!==1/0}function E2(e,n){return Math.max(e+(n||0)-Date.now(),0)}function el(e,n){return typeof e=="function"?e(n):e}function Er(e,n){return typeof e=="function"?e(n):e}function M1(e,n){const{type:a="all",exact:r,fetchStatus:s,predicate:l,queryKey:o,stale:d}=e;if(o){if(r){if(n.queryHash!==Mp(o,n.options))return!1}else if(!$d(n.queryKey,o))return!1}if(a!=="all"){const u=n.isActive();if(a==="active"&&!u||a==="inactive"&&u)return!1}return!(typeof d=="boolean"&&n.isStale()!==d||s&&s!==n.state.fetchStatus||l&&!l(n))}function R1(e,n){const{exact:a,status:r,predicate:s,mutationKey:l}=e;if(l){if(!n.options.mutationKey)return!1;if(a){if(ao(n.options.mutationKey)!==ao(l))return!1}else if(!$d(n.options.mutationKey,l))return!1}return!(r&&n.state.status!==r||s&&!s(n))}function Mp(e,n){return((n==null?void 0:n.queryKeyHashFn)||ao)(e)}function ao(e){return JSON.stringify(e,(n,a)=>Vf(a)?Object.keys(a).sort().reduce((r,s)=>(r[s]=a[s],r),{}):a)}function $d(e,n){return e===n?!0:typeof e!=typeof n?!1:e&&n&&typeof e=="object"&&typeof n=="object"?Object.keys(n).every(a=>$d(e[a],n[a])):!1}var IC=Object.prototype.hasOwnProperty;function D2(e,n){if(e===n)return e;const a=B1(e)&&B1(n);if(!a&&!(Vf(e)&&Vf(n)))return n;const s=(a?e:Object.keys(e)).length,l=a?n:Object.keys(n),o=l.length,d=a?new Array(o):{};let u=0;for(let x=0;x<o;x++){const m=a?x:l[x],f=e[m],p=n[m];if(f===p){d[m]=f,(a?x<s:IC.call(e,m))&&u++;continue}if(f===null||p===null||typeof f!="object"||typeof p!="object"){d[m]=p;continue}const b=D2(f,p);d[m]=b,b===f&&u++}return s===o&&u===s?e:d}function u0(e,n){if(!n||Object.keys(e).length!==Object.keys(n).length)return!1;for(const a in e)if(e[a]!==n[a])return!1;return!0}function B1(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Vf(e){if(!H1(e))return!1;const n=e.constructor;if(n===void 0)return!0;const a=n.prototype;return!(!H1(a)||!a.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function H1(e){return Object.prototype.toString.call(e)==="[object Object]"}function OC(e){return new Promise(n=>{Rl.setTimeout(n,e)})}function Uf(e,n,a){return typeof a.structuralSharing=="function"?a.structuralSharing(e,n):a.structuralSharing!==!1?D2(e,n):n}function MC(e,n,a=0){const r=[...e,n];return a&&r.length>a?r.slice(1):r}function RC(e,n,a=0){const r=[n,...e];return a&&r.length>a?r.slice(0,-1):r}var Rp=Symbol();function A2(e,n){return!e.queryFn&&(n!=null&&n.initialPromise)?()=>n.initialPromise:!e.queryFn||e.queryFn===Rp?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function Bp(e,n){return typeof e=="function"?e(...n):!!e}function BC(e,n,a){let r=!1,s;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(s??(s=n()),r||(r=!0,s.aborted?a():s.addEventListener("abort",a,{once:!0})),s)}),e}var Ul,Hi,cc,g2,HC=(g2=class extends Ec{constructor(){super();nt(this,Ul);nt(this,Hi);nt(this,cc);$e(this,cc,n=>{if(!no&&window.addEventListener){const a=()=>n();return window.addEventListener("visibilitychange",a,!1),()=>{window.removeEventListener("visibilitychange",a)}}})}onSubscribe(){oe(this,Hi)||this.setEventListener(oe(this,cc))}onUnsubscribe(){var n;this.hasListeners()||((n=oe(this,Hi))==null||n.call(this),$e(this,Hi,void 0))}setEventListener(n){var a;$e(this,cc,n),(a=oe(this,Hi))==null||a.call(this),$e(this,Hi,n(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(n){oe(this,Ul)!==n&&($e(this,Ul,n),this.onFocus())}onFocus(){const n=this.isFocused();this.listeners.forEach(a=>{a(n)})}isFocused(){var n;return typeof oe(this,Ul)=="boolean"?oe(this,Ul):((n=globalThis.document)==null?void 0:n.visibilityState)!=="hidden"}},Ul=new WeakMap,Hi=new WeakMap,cc=new WeakMap,g2),Hp=new HC;function Kf(){let e,n;const a=new Promise((s,l)=>{e=s,n=l});a.status="pending",a.catch(()=>{});function r(s){Object.assign(a,s),delete a.resolve,delete a.reject}return a.resolve=s=>{r({status:"fulfilled",value:s}),e(s)},a.reject=s=>{r({status:"rejected",reason:s}),n(s)},a}var VC=LC;function UC(){let e=[],n=0,a=d=>{d()},r=d=>{d()},s=VC;const l=d=>{n?e.push(d):s(()=>{a(d)})},o=()=>{const d=e;e=[],d.length&&s(()=>{r(()=>{d.forEach(u=>{a(u)})})})};return{batch:d=>{let u;n++;try{u=d()}finally{n--,n||o()}return u},batchCalls:d=>(...u)=>{l(()=>{d(...u)})},schedule:l,setNotifyFunction:d=>{a=d},setBatchNotifyFunction:d=>{r=d},setScheduler:d=>{s=d}}}var Un=UC(),dc,Vi,uc,y2,KC=(y2=class extends Ec{constructor(){super();nt(this,dc,!0);nt(this,Vi);nt(this,uc);$e(this,uc,n=>{if(!no&&window.addEventListener){const a=()=>n(!0),r=()=>n(!1);return window.addEventListener("online",a,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",a),window.removeEventListener("offline",r)}}})}onSubscribe(){oe(this,Vi)||this.setEventListener(oe(this,uc))}onUnsubscribe(){var n;this.hasListeners()||((n=oe(this,Vi))==null||n.call(this),$e(this,Vi,void 0))}setEventListener(n){var a;$e(this,uc,n),(a=oe(this,Vi))==null||a.call(this),$e(this,Vi,n(this.setOnline.bind(this)))}setOnline(n){oe(this,dc)!==n&&($e(this,dc,n),this.listeners.forEach(r=>{r(n)}))}isOnline(){return oe(this,dc)}},dc=new WeakMap,Vi=new WeakMap,uc=new WeakMap,y2),h0=new KC;function zC(e){return Math.min(1e3*2**e,3e4)}function F2(e){return(e??"online")==="online"?h0.isOnline():!0}var zf=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function L2(e){let n=!1,a=0,r;const s=Kf(),l=()=>s.status!=="pending",o=y=>{var N;if(!l()){const k=new zf(y);p(k),(N=e.onCancel)==null||N.call(e,k)}},d=()=>{n=!0},u=()=>{n=!1},x=()=>Hp.isFocused()&&(e.networkMode==="always"||h0.isOnline())&&e.canRun(),m=()=>F2(e.networkMode)&&e.canRun(),f=y=>{l()||(r==null||r(),s.resolve(y))},p=y=>{l()||(r==null||r(),s.reject(y))},b=()=>new Promise(y=>{var N;r=k=>{(l()||x())&&y(k)},(N=e.onPause)==null||N.call(e)}).then(()=>{var y;r=void 0,l()||(y=e.onContinue)==null||y.call(e)}),g=()=>{if(l())return;let y;const N=a===0?e.initialPromise:void 0;try{y=N??e.fn()}catch(k){y=Promise.reject(k)}Promise.resolve(y).then(f).catch(k=>{var L;if(l())return;const T=e.retry??(no?0:3),S=e.retryDelay??zC,w=typeof S=="function"?S(a,k):S,_=T===!0||typeof T=="number"&&a<T||typeof T=="function"&&T(a,k);if(n||!_){p(k);return}a++,(L=e.onFail)==null||L.call(e,a,k),OC(w).then(()=>x()?void 0:b()).then(()=>{n?p(k):g()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r==null||r(),s),cancelRetry:d,continueRetry:u,canStart:m,start:()=>(m()?g():b().then(g),s)}}var Kl,v2,P2=(v2=class{constructor(){nt(this,Kl)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Hf(this.gcTime)&&$e(this,Kl,Rl.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(no?1/0:300*1e3))}clearGcTimeout(){oe(this,Kl)&&(Rl.clearTimeout(oe(this,Kl)),$e(this,Kl,void 0))}},Kl=new WeakMap,v2),zl,hc,Sr,$l,Jn,du,Gl,Xr,Ks,b2,$C=(b2=class extends P2{constructor(n){super();nt(this,Xr);nt(this,zl);nt(this,hc);nt(this,Sr);nt(this,$l);nt(this,Jn);nt(this,du);nt(this,Gl);$e(this,Gl,!1),$e(this,du,n.defaultOptions),this.setOptions(n.options),this.observers=[],$e(this,$l,n.client),$e(this,Sr,oe(this,$l).getQueryCache()),this.queryKey=n.queryKey,this.queryHash=n.queryHash,$e(this,zl,U1(this.options)),this.state=n.state??oe(this,zl),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var n;return(n=oe(this,Jn))==null?void 0:n.promise}setOptions(n){if(this.options={...oe(this,du),...n},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const a=U1(this.options);a.data!==void 0&&(this.setState(V1(a.data,a.dataUpdatedAt)),$e(this,zl,a))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&oe(this,Sr).remove(this)}setData(n,a){const r=Uf(this.state.data,n,this.options);return yt(this,Xr,Ks).call(this,{data:r,type:"success",dataUpdatedAt:a==null?void 0:a.updatedAt,manual:a==null?void 0:a.manual}),r}setState(n,a){yt(this,Xr,Ks).call(this,{type:"setState",state:n,setStateOptions:a})}cancel(n){var r,s;const a=(r=oe(this,Jn))==null?void 0:r.promise;return(s=oe(this,Jn))==null||s.cancel(n),a?a.then(La).catch(La):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(oe(this,zl))}isActive(){return this.observers.some(n=>Er(n.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Rp||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(n=>el(n.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(n=>n.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(n=0){return this.state.data===void 0?!0:n==="static"?!1:this.state.isInvalidated?!0:!E2(this.state.dataUpdatedAt,n)}onFocus(){var a;const n=this.observers.find(r=>r.shouldFetchOnWindowFocus());n==null||n.refetch({cancelRefetch:!1}),(a=oe(this,Jn))==null||a.continue()}onOnline(){var a;const n=this.observers.find(r=>r.shouldFetchOnReconnect());n==null||n.refetch({cancelRefetch:!1}),(a=oe(this,Jn))==null||a.continue()}addObserver(n){this.observers.includes(n)||(this.observers.push(n),this.clearGcTimeout(),oe(this,Sr).notify({type:"observerAdded",query:this,observer:n}))}removeObserver(n){this.observers.includes(n)&&(this.observers=this.observers.filter(a=>a!==n),this.observers.length||(oe(this,Jn)&&(oe(this,Gl)?oe(this,Jn).cancel({revert:!0}):oe(this,Jn).cancelRetry()),this.scheduleGc()),oe(this,Sr).notify({type:"observerRemoved",query:this,observer:n}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||yt(this,Xr,Ks).call(this,{type:"invalidate"})}async fetch(n,a){var u,x,m,f,p,b,g,y,N,k,T,S;if(this.state.fetchStatus!=="idle"&&((u=oe(this,Jn))==null?void 0:u.status())!=="rejected"){if(this.state.data!==void 0&&(a!=null&&a.cancelRefetch))this.cancel({silent:!0});else if(oe(this,Jn))return oe(this,Jn).continueRetry(),oe(this,Jn).promise}if(n&&this.setOptions(n),!this.options.queryFn){const w=this.observers.find(_=>_.options.queryFn);w&&this.setOptions(w.options)}const r=new AbortController,s=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>($e(this,Gl,!0),r.signal)})},l=()=>{const w=A2(this.options,a),L=(()=>{const C={client:oe(this,$l),queryKey:this.queryKey,meta:this.meta};return s(C),C})();return $e(this,Gl,!1),this.options.persister?this.options.persister(w,L,this):w(L)},d=(()=>{const w={fetchOptions:a,options:this.options,queryKey:this.queryKey,client:oe(this,$l),state:this.state,fetchFn:l};return s(w),w})();(x=this.options.behavior)==null||x.onFetch(d,this),$e(this,hc,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((m=d.fetchOptions)==null?void 0:m.meta))&&yt(this,Xr,Ks).call(this,{type:"fetch",meta:(f=d.fetchOptions)==null?void 0:f.meta}),$e(this,Jn,L2({initialPromise:a==null?void 0:a.initialPromise,fn:d.fetchFn,onCancel:w=>{w instanceof zf&&w.revert&&this.setState({...oe(this,hc),fetchStatus:"idle"}),r.abort()},onFail:(w,_)=>{yt(this,Xr,Ks).call(this,{type:"failed",failureCount:w,error:_})},onPause:()=>{yt(this,Xr,Ks).call(this,{type:"pause"})},onContinue:()=>{yt(this,Xr,Ks).call(this,{type:"continue"})},retry:d.options.retry,retryDelay:d.options.retryDelay,networkMode:d.options.networkMode,canRun:()=>!0}));try{const w=await oe(this,Jn).start();if(w===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(w),(b=(p=oe(this,Sr).config).onSuccess)==null||b.call(p,w,this),(y=(g=oe(this,Sr).config).onSettled)==null||y.call(g,w,this.state.error,this),w}catch(w){if(w instanceof zf){if(w.silent)return oe(this,Jn).promise;if(w.revert){if(this.state.data===void 0)throw w;return this.state.data}}throw yt(this,Xr,Ks).call(this,{type:"error",error:w}),(k=(N=oe(this,Sr).config).onError)==null||k.call(N,w,this),(S=(T=oe(this,Sr).config).onSettled)==null||S.call(T,this.state.data,w,this),w}finally{this.scheduleGc()}}},zl=new WeakMap,hc=new WeakMap,Sr=new WeakMap,$l=new WeakMap,Jn=new WeakMap,du=new WeakMap,Gl=new WeakMap,Xr=new WeakSet,Ks=function(n){const a=r=>{switch(n.type){case"failed":return{...r,fetchFailureCount:n.failureCount,fetchFailureReason:n.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...I2(r.data,this.options),fetchMeta:n.meta??null};case"success":const s={...r,...V1(n.data,n.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!n.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return $e(this,hc,n.manual?s:void 0),s;case"error":const l=n.error;return{...r,error:l,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...n.state}}};this.state=a(this.state),Un.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),oe(this,Sr).notify({query:this,type:"updated",action:n})})},b2);function I2(e,n){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:F2(n.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function V1(e,n){return{data:e,dataUpdatedAt:n??Date.now(),error:null,isInvalidated:!1,status:"success"}}function U1(e){const n=typeof e.initialData=="function"?e.initialData():e.initialData,a=n!==void 0,r=a?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:n,dataUpdateCount:0,dataUpdatedAt:a?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:a?"success":"pending",fetchStatus:"idle"}}var qa,wt,uu,Aa,ql,xc,Gs,Ui,hu,mc,fc,Wl,Xl,Ki,pc,Kt,Ed,$f,Gf,qf,Wf,Xf,Qf,Yf,O2,N2,GC=(N2=class extends Ec{constructor(n,a){super();nt(this,Kt);nt(this,qa);nt(this,wt);nt(this,uu);nt(this,Aa);nt(this,ql);nt(this,xc);nt(this,Gs);nt(this,Ui);nt(this,hu);nt(this,mc);nt(this,fc);nt(this,Wl);nt(this,Xl);nt(this,Ki);nt(this,pc,new Set);this.options=a,$e(this,qa,n),$e(this,Ui,null),$e(this,Gs,Kf()),this.bindMethods(),this.setOptions(a)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(oe(this,wt).addObserver(this),K1(oe(this,wt),this.options)?yt(this,Kt,Ed).call(this):this.updateResult(),yt(this,Kt,Wf).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Jf(oe(this,wt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Jf(oe(this,wt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,yt(this,Kt,Xf).call(this),yt(this,Kt,Qf).call(this),oe(this,wt).removeObserver(this)}setOptions(n){const a=this.options,r=oe(this,wt);if(this.options=oe(this,qa).defaultQueryOptions(n),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Er(this.options.enabled,oe(this,wt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");yt(this,Kt,Yf).call(this),oe(this,wt).setOptions(this.options),a._defaulted&&!u0(this.options,a)&&oe(this,qa).getQueryCache().notify({type:"observerOptionsUpdated",query:oe(this,wt),observer:this});const s=this.hasListeners();s&&z1(oe(this,wt),r,this.options,a)&&yt(this,Kt,Ed).call(this),this.updateResult(),s&&(oe(this,wt)!==r||Er(this.options.enabled,oe(this,wt))!==Er(a.enabled,oe(this,wt))||el(this.options.staleTime,oe(this,wt))!==el(a.staleTime,oe(this,wt)))&&yt(this,Kt,$f).call(this);const l=yt(this,Kt,Gf).call(this);s&&(oe(this,wt)!==r||Er(this.options.enabled,oe(this,wt))!==Er(a.enabled,oe(this,wt))||l!==oe(this,Ki))&&yt(this,Kt,qf).call(this,l)}getOptimisticResult(n){const a=oe(this,qa).getQueryCache().build(oe(this,qa),n),r=this.createResult(a,n);return WC(this,r)&&($e(this,Aa,r),$e(this,xc,this.options),$e(this,ql,oe(this,wt).state)),r}getCurrentResult(){return oe(this,Aa)}trackResult(n,a){return new Proxy(n,{get:(r,s)=>(this.trackProp(s),a==null||a(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&oe(this,Gs).status==="pending"&&oe(this,Gs).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,s))})}trackProp(n){oe(this,pc).add(n)}getCurrentQuery(){return oe(this,wt)}refetch({...n}={}){return this.fetch({...n})}fetchOptimistic(n){const a=oe(this,qa).defaultQueryOptions(n),r=oe(this,qa).getQueryCache().build(oe(this,qa),a);return r.fetch().then(()=>this.createResult(r,a))}fetch(n){return yt(this,Kt,Ed).call(this,{...n,cancelRefetch:n.cancelRefetch??!0}).then(()=>(this.updateResult(),oe(this,Aa)))}createResult(n,a){var F;const r=oe(this,wt),s=this.options,l=oe(this,Aa),o=oe(this,ql),d=oe(this,xc),x=n!==r?n.state:oe(this,uu),{state:m}=n;let f={...m},p=!1,b;if(a._optimisticResults){const H=this.hasListeners(),O=!H&&K1(n,a),B=H&&z1(n,r,a,s);(O||B)&&(f={...f,...I2(m.data,n.options)}),a._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:g,errorUpdatedAt:y,status:N}=f;b=f.data;let k=!1;if(a.placeholderData!==void 0&&b===void 0&&N==="pending"){let H;l!=null&&l.isPlaceholderData&&a.placeholderData===(d==null?void 0:d.placeholderData)?(H=l.data,k=!0):H=typeof a.placeholderData=="function"?a.placeholderData((F=oe(this,fc))==null?void 0:F.state.data,oe(this,fc)):a.placeholderData,H!==void 0&&(N="success",b=Uf(l==null?void 0:l.data,H,a),p=!0)}if(a.select&&b!==void 0&&!k)if(l&&b===(o==null?void 0:o.data)&&a.select===oe(this,hu))b=oe(this,mc);else try{$e(this,hu,a.select),b=a.select(b),b=Uf(l==null?void 0:l.data,b,a),$e(this,mc,b),$e(this,Ui,null)}catch(H){$e(this,Ui,H)}oe(this,Ui)&&(g=oe(this,Ui),b=oe(this,mc),y=Date.now(),N="error");const T=f.fetchStatus==="fetching",S=N==="pending",w=N==="error",_=S&&T,L=b!==void 0,P={status:N,fetchStatus:f.fetchStatus,isPending:S,isSuccess:N==="success",isError:w,isInitialLoading:_,isLoading:_,data:b,dataUpdatedAt:f.dataUpdatedAt,error:g,errorUpdatedAt:y,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>x.dataUpdateCount||f.errorUpdateCount>x.errorUpdateCount,isFetching:T,isRefetching:T&&!S,isLoadingError:w&&!L,isPaused:f.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:w&&L,isStale:Vp(n,a),refetch:this.refetch,promise:oe(this,Gs),isEnabled:Er(a.enabled,n)!==!1};if(this.options.experimental_prefetchInRender){const H=W=>{P.status==="error"?W.reject(P.error):P.data!==void 0&&W.resolve(P.data)},O=()=>{const W=$e(this,Gs,P.promise=Kf());H(W)},B=oe(this,Gs);switch(B.status){case"pending":n.queryHash===r.queryHash&&H(B);break;case"fulfilled":(P.status==="error"||P.data!==B.value)&&O();break;case"rejected":(P.status!=="error"||P.error!==B.reason)&&O();break}}return P}updateResult(){const n=oe(this,Aa),a=this.createResult(oe(this,wt),this.options);if($e(this,ql,oe(this,wt).state),$e(this,xc,this.options),oe(this,ql).data!==void 0&&$e(this,fc,oe(this,wt)),u0(a,n))return;$e(this,Aa,a);const r=()=>{if(!n)return!0;const{notifyOnChangeProps:s}=this.options,l=typeof s=="function"?s():s;if(l==="all"||!l&&!oe(this,pc).size)return!0;const o=new Set(l??oe(this,pc));return this.options.throwOnError&&o.add("error"),Object.keys(oe(this,Aa)).some(d=>{const u=d;return oe(this,Aa)[u]!==n[u]&&o.has(u)})};yt(this,Kt,O2).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&yt(this,Kt,Wf).call(this)}},qa=new WeakMap,wt=new WeakMap,uu=new WeakMap,Aa=new WeakMap,ql=new WeakMap,xc=new WeakMap,Gs=new WeakMap,Ui=new WeakMap,hu=new WeakMap,mc=new WeakMap,fc=new WeakMap,Wl=new WeakMap,Xl=new WeakMap,Ki=new WeakMap,pc=new WeakMap,Kt=new WeakSet,Ed=function(n){yt(this,Kt,Yf).call(this);let a=oe(this,wt).fetch(this.options,n);return n!=null&&n.throwOnError||(a=a.catch(La)),a},$f=function(){yt(this,Kt,Xf).call(this);const n=el(this.options.staleTime,oe(this,wt));if(no||oe(this,Aa).isStale||!Hf(n))return;const r=E2(oe(this,Aa).dataUpdatedAt,n)+1;$e(this,Wl,Rl.setTimeout(()=>{oe(this,Aa).isStale||this.updateResult()},r))},Gf=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(oe(this,wt)):this.options.refetchInterval)??!1},qf=function(n){yt(this,Kt,Qf).call(this),$e(this,Ki,n),!(no||Er(this.options.enabled,oe(this,wt))===!1||!Hf(oe(this,Ki))||oe(this,Ki)===0)&&$e(this,Xl,Rl.setInterval(()=>{(this.options.refetchIntervalInBackground||Hp.isFocused())&&yt(this,Kt,Ed).call(this)},oe(this,Ki)))},Wf=function(){yt(this,Kt,$f).call(this),yt(this,Kt,qf).call(this,yt(this,Kt,Gf).call(this))},Xf=function(){oe(this,Wl)&&(Rl.clearTimeout(oe(this,Wl)),$e(this,Wl,void 0))},Qf=function(){oe(this,Xl)&&(Rl.clearInterval(oe(this,Xl)),$e(this,Xl,void 0))},Yf=function(){const n=oe(this,qa).getQueryCache().build(oe(this,qa),this.options);if(n===oe(this,wt))return;const a=oe(this,wt);$e(this,wt,n),$e(this,uu,n.state),this.hasListeners()&&(a==null||a.removeObserver(this),n.addObserver(this))},O2=function(n){Un.batch(()=>{n.listeners&&this.listeners.forEach(a=>{a(oe(this,Aa))}),oe(this,qa).getQueryCache().notify({query:oe(this,wt),type:"observerResultsUpdated"})})},N2);function qC(e,n){return Er(n.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&n.retryOnMount===!1)}function K1(e,n){return qC(e,n)||e.state.data!==void 0&&Jf(e,n,n.refetchOnMount)}function Jf(e,n,a){if(Er(n.enabled,e)!==!1&&el(n.staleTime,e)!=="static"){const r=typeof a=="function"?a(e):a;return r==="always"||r!==!1&&Vp(e,n)}return!1}function z1(e,n,a,r){return(e!==n||Er(r.enabled,e)===!1)&&(!a.suspense||e.state.status!=="error")&&Vp(e,a)}function Vp(e,n){return Er(n.enabled,e)!==!1&&e.isStaleByTime(el(n.staleTime,e))}function WC(e,n){return!u0(e.getCurrentResult(),n)}function $1(e){return{onFetch:(n,a)=>{var m,f,p,b,g;const r=n.options,s=(p=(f=(m=n.fetchOptions)==null?void 0:m.meta)==null?void 0:f.fetchMore)==null?void 0:p.direction,l=((b=n.state.data)==null?void 0:b.pages)||[],o=((g=n.state.data)==null?void 0:g.pageParams)||[];let d={pages:[],pageParams:[]},u=0;const x=async()=>{let y=!1;const N=S=>{BC(S,()=>n.signal,()=>y=!0)},k=A2(n.options,n.fetchOptions),T=async(S,w,_)=>{if(y)return Promise.reject();if(w==null&&S.pages.length)return Promise.resolve(S);const C=(()=>{const O={client:n.client,queryKey:n.queryKey,pageParam:w,direction:_?"backward":"forward",meta:n.options.meta};return N(O),O})(),P=await k(C),{maxPages:F}=n.options,H=_?RC:MC;return{pages:H(S.pages,P,F),pageParams:H(S.pageParams,w,F)}};if(s&&l.length){const S=s==="backward",w=S?XC:G1,_={pages:l,pageParams:o},L=w(r,_);d=await T(_,L,S)}else{const S=e??l.length;do{const w=u===0?o[0]??r.initialPageParam:G1(r,d);if(u>0&&w==null)break;d=await T(d,w),u++}while(u<S)}return d};n.options.persister?n.fetchFn=()=>{var y,N;return(N=(y=n.options).persister)==null?void 0:N.call(y,x,{client:n.client,queryKey:n.queryKey,meta:n.options.meta,signal:n.signal},a)}:n.fetchFn=x}}}function G1(e,{pages:n,pageParams:a}){const r=n.length-1;return n.length>0?e.getNextPageParam(n[r],n,a[r],a):void 0}function XC(e,{pages:n,pageParams:a}){var r;return n.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,n[0],n,a[0],a):void 0}var xu,ps,Fa,Ql,gs,Mi,j2,QC=(j2=class extends P2{constructor(n){super();nt(this,gs);nt(this,xu);nt(this,ps);nt(this,Fa);nt(this,Ql);$e(this,xu,n.client),this.mutationId=n.mutationId,$e(this,Fa,n.mutationCache),$e(this,ps,[]),this.state=n.state||M2(),this.setOptions(n.options),this.scheduleGc()}setOptions(n){this.options=n,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(n){oe(this,ps).includes(n)||(oe(this,ps).push(n),this.clearGcTimeout(),oe(this,Fa).notify({type:"observerAdded",mutation:this,observer:n}))}removeObserver(n){$e(this,ps,oe(this,ps).filter(a=>a!==n)),this.scheduleGc(),oe(this,Fa).notify({type:"observerRemoved",mutation:this,observer:n})}optionalRemove(){oe(this,ps).length||(this.state.status==="pending"?this.scheduleGc():oe(this,Fa).remove(this))}continue(){var n;return((n=oe(this,Ql))==null?void 0:n.continue())??this.execute(this.state.variables)}async execute(n){var o,d,u,x,m,f,p,b,g,y,N,k,T,S,w,_,L,C,P,F;const a=()=>{yt(this,gs,Mi).call(this,{type:"continue"})},r={client:oe(this,xu),meta:this.options.meta,mutationKey:this.options.mutationKey};$e(this,Ql,L2({fn:()=>this.options.mutationFn?this.options.mutationFn(n,r):Promise.reject(new Error("No mutationFn found")),onFail:(H,O)=>{yt(this,gs,Mi).call(this,{type:"failed",failureCount:H,error:O})},onPause:()=>{yt(this,gs,Mi).call(this,{type:"pause"})},onContinue:a,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>oe(this,Fa).canRun(this)}));const s=this.state.status==="pending",l=!oe(this,Ql).canStart();try{if(s)a();else{yt(this,gs,Mi).call(this,{type:"pending",variables:n,isPaused:l}),await((d=(o=oe(this,Fa).config).onMutate)==null?void 0:d.call(o,n,this,r));const O=await((x=(u=this.options).onMutate)==null?void 0:x.call(u,n,r));O!==this.state.context&&yt(this,gs,Mi).call(this,{type:"pending",context:O,variables:n,isPaused:l})}const H=await oe(this,Ql).start();return await((f=(m=oe(this,Fa).config).onSuccess)==null?void 0:f.call(m,H,n,this.state.context,this,r)),await((b=(p=this.options).onSuccess)==null?void 0:b.call(p,H,n,this.state.context,r)),await((y=(g=oe(this,Fa).config).onSettled)==null?void 0:y.call(g,H,null,this.state.variables,this.state.context,this,r)),await((k=(N=this.options).onSettled)==null?void 0:k.call(N,H,null,n,this.state.context,r)),yt(this,gs,Mi).call(this,{type:"success",data:H}),H}catch(H){try{await((S=(T=oe(this,Fa).config).onError)==null?void 0:S.call(T,H,n,this.state.context,this,r))}catch(O){Promise.reject(O)}try{await((_=(w=this.options).onError)==null?void 0:_.call(w,H,n,this.state.context,r))}catch(O){Promise.reject(O)}try{await((C=(L=oe(this,Fa).config).onSettled)==null?void 0:C.call(L,void 0,H,this.state.variables,this.state.context,this,r))}catch(O){Promise.reject(O)}try{await((F=(P=this.options).onSettled)==null?void 0:F.call(P,void 0,H,n,this.state.context,r))}catch(O){Promise.reject(O)}throw yt(this,gs,Mi).call(this,{type:"error",error:H}),H}finally{oe(this,Fa).runNext(this)}}},xu=new WeakMap,ps=new WeakMap,Fa=new WeakMap,Ql=new WeakMap,gs=new WeakSet,Mi=function(n){const a=r=>{switch(n.type){case"failed":return{...r,failureCount:n.failureCount,failureReason:n.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:n.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:n.isPaused,status:"pending",variables:n.variables,submittedAt:Date.now()};case"success":return{...r,data:n.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:n.error,failureCount:r.failureCount+1,failureReason:n.error,isPaused:!1,status:"error"}}};this.state=a(this.state),Un.batch(()=>{oe(this,ps).forEach(r=>{r.onMutationUpdate(n)}),oe(this,Fa).notify({mutation:this,type:"updated",action:n})})},j2);function M2(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var qs,Qr,mu,w2,YC=(w2=class extends Ec{constructor(n={}){super();nt(this,qs);nt(this,Qr);nt(this,mu);this.config=n,$e(this,qs,new Set),$e(this,Qr,new Map),$e(this,mu,0)}build(n,a,r){const s=new QC({client:n,mutationCache:this,mutationId:++Rh(this,mu)._,options:n.defaultMutationOptions(a),state:r});return this.add(s),s}add(n){oe(this,qs).add(n);const a=Hh(n);if(typeof a=="string"){const r=oe(this,Qr).get(a);r?r.push(n):oe(this,Qr).set(a,[n])}this.notify({type:"added",mutation:n})}remove(n){if(oe(this,qs).delete(n)){const a=Hh(n);if(typeof a=="string"){const r=oe(this,Qr).get(a);if(r)if(r.length>1){const s=r.indexOf(n);s!==-1&&r.splice(s,1)}else r[0]===n&&oe(this,Qr).delete(a)}}this.notify({type:"removed",mutation:n})}canRun(n){const a=Hh(n);if(typeof a=="string"){const r=oe(this,Qr).get(a),s=r==null?void 0:r.find(l=>l.state.status==="pending");return!s||s===n}else return!0}runNext(n){var r;const a=Hh(n);if(typeof a=="string"){const s=(r=oe(this,Qr).get(a))==null?void 0:r.find(l=>l!==n&&l.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Un.batch(()=>{oe(this,qs).forEach(n=>{this.notify({type:"removed",mutation:n})}),oe(this,qs).clear(),oe(this,Qr).clear()})}getAll(){return Array.from(oe(this,qs))}find(n){const a={exact:!0,...n};return this.getAll().find(r=>R1(a,r))}findAll(n={}){return this.getAll().filter(a=>R1(n,a))}notify(n){Un.batch(()=>{this.listeners.forEach(a=>{a(n)})})}resumePausedMutations(){const n=this.getAll().filter(a=>a.state.isPaused);return Un.batch(()=>Promise.all(n.map(a=>a.continue().catch(La))))}},qs=new WeakMap,Qr=new WeakMap,mu=new WeakMap,w2);function Hh(e){var n;return(n=e.options.scope)==null?void 0:n.id}var Ws,zi,Wa,Xs,ri,r0,Zf,k2,JC=(k2=class extends Ec{constructor(a,r){super();nt(this,ri);nt(this,Ws);nt(this,zi);nt(this,Wa);nt(this,Xs);$e(this,Ws,a),this.setOptions(r),this.bindMethods(),yt(this,ri,r0).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(a){var s;const r=this.options;this.options=oe(this,Ws).defaultMutationOptions(a),u0(this.options,r)||oe(this,Ws).getMutationCache().notify({type:"observerOptionsUpdated",mutation:oe(this,Wa),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&ao(r.mutationKey)!==ao(this.options.mutationKey)?this.reset():((s=oe(this,Wa))==null?void 0:s.state.status)==="pending"&&oe(this,Wa).setOptions(this.options)}onUnsubscribe(){var a;this.hasListeners()||(a=oe(this,Wa))==null||a.removeObserver(this)}onMutationUpdate(a){yt(this,ri,r0).call(this),yt(this,ri,Zf).call(this,a)}getCurrentResult(){return oe(this,zi)}reset(){var a;(a=oe(this,Wa))==null||a.removeObserver(this),$e(this,Wa,void 0),yt(this,ri,r0).call(this),yt(this,ri,Zf).call(this)}mutate(a,r){var s;return $e(this,Xs,r),(s=oe(this,Wa))==null||s.removeObserver(this),$e(this,Wa,oe(this,Ws).getMutationCache().build(oe(this,Ws),this.options)),oe(this,Wa).addObserver(this),oe(this,Wa).execute(a)}},Ws=new WeakMap,zi=new WeakMap,Wa=new WeakMap,Xs=new WeakMap,ri=new WeakSet,r0=function(){var r;const a=((r=oe(this,Wa))==null?void 0:r.state)??M2();$e(this,zi,{...a,isPending:a.status==="pending",isSuccess:a.status==="success",isError:a.status==="error",isIdle:a.status==="idle",mutate:this.mutate,reset:this.reset})},Zf=function(a){Un.batch(()=>{var r,s,l,o,d,u,x,m;if(oe(this,Xs)&&this.hasListeners()){const f=oe(this,zi).variables,p=oe(this,zi).context,b={client:oe(this,Ws),meta:this.options.meta,mutationKey:this.options.mutationKey};if((a==null?void 0:a.type)==="success"){try{(s=(r=oe(this,Xs)).onSuccess)==null||s.call(r,a.data,f,p,b)}catch(g){Promise.reject(g)}try{(o=(l=oe(this,Xs)).onSettled)==null||o.call(l,a.data,null,f,p,b)}catch(g){Promise.reject(g)}}else if((a==null?void 0:a.type)==="error"){try{(u=(d=oe(this,Xs)).onError)==null||u.call(d,a.error,f,p,b)}catch(g){Promise.reject(g)}try{(m=(x=oe(this,Xs)).onSettled)==null||m.call(x,void 0,a.error,f,p,b)}catch(g){Promise.reject(g)}}}this.listeners.forEach(f=>{f(oe(this,zi))})})},k2),ys,T2,ZC=(T2=class extends Ec{constructor(n={}){super();nt(this,ys);this.config=n,$e(this,ys,new Map)}build(n,a,r){const s=a.queryKey,l=a.queryHash??Mp(s,a);let o=this.get(l);return o||(o=new $C({client:n,queryKey:s,queryHash:l,options:n.defaultQueryOptions(a),state:r,defaultOptions:n.getQueryDefaults(s)}),this.add(o)),o}add(n){oe(this,ys).has(n.queryHash)||(oe(this,ys).set(n.queryHash,n),this.notify({type:"added",query:n}))}remove(n){const a=oe(this,ys).get(n.queryHash);a&&(n.destroy(),a===n&&oe(this,ys).delete(n.queryHash),this.notify({type:"removed",query:n}))}clear(){Un.batch(()=>{this.getAll().forEach(n=>{this.remove(n)})})}get(n){return oe(this,ys).get(n)}getAll(){return[...oe(this,ys).values()]}find(n){const a={exact:!0,...n};return this.getAll().find(r=>M1(a,r))}findAll(n={}){const a=this.getAll();return Object.keys(n).length>0?a.filter(r=>M1(n,r)):a}notify(n){Un.batch(()=>{this.listeners.forEach(a=>{a(n)})})}onFocus(){Un.batch(()=>{this.getAll().forEach(n=>{n.onFocus()})})}onOnline(){Un.batch(()=>{this.getAll().forEach(n=>{n.onOnline()})})}},ys=new WeakMap,T2),Nn,$i,Gi,gc,yc,qi,vc,bc,C2,eS=(C2=class{constructor(e={}){nt(this,Nn);nt(this,$i);nt(this,Gi);nt(this,gc);nt(this,yc);nt(this,qi);nt(this,vc);nt(this,bc);$e(this,Nn,e.queryCache||new ZC),$e(this,$i,e.mutationCache||new YC),$e(this,Gi,e.defaultOptions||{}),$e(this,gc,new Map),$e(this,yc,new Map),$e(this,qi,0)}mount(){Rh(this,qi)._++,oe(this,qi)===1&&($e(this,vc,Hp.subscribe(async e=>{e&&(await this.resumePausedMutations(),oe(this,Nn).onFocus())})),$e(this,bc,h0.subscribe(async e=>{e&&(await this.resumePausedMutations(),oe(this,Nn).onOnline())})))}unmount(){var e,n;Rh(this,qi)._--,oe(this,qi)===0&&((e=oe(this,vc))==null||e.call(this),$e(this,vc,void 0),(n=oe(this,bc))==null||n.call(this),$e(this,bc,void 0))}isFetching(e){return oe(this,Nn).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return oe(this,$i).findAll({...e,status:"pending"}).length}getQueryData(e){var a;const n=this.defaultQueryOptions({queryKey:e});return(a=oe(this,Nn).get(n.queryHash))==null?void 0:a.state.data}ensureQueryData(e){const n=this.defaultQueryOptions(e),a=oe(this,Nn).build(this,n),r=a.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&a.isStaleByTime(el(n.staleTime,a))&&this.prefetchQuery(n),Promise.resolve(r))}getQueriesData(e){return oe(this,Nn).findAll(e).map(({queryKey:n,state:a})=>{const r=a.data;return[n,r]})}setQueryData(e,n,a){const r=this.defaultQueryOptions({queryKey:e}),s=oe(this,Nn).get(r.queryHash),l=s==null?void 0:s.state.data,o=PC(n,l);if(o!==void 0)return oe(this,Nn).build(this,r).setData(o,{...a,manual:!0})}setQueriesData(e,n,a){return Un.batch(()=>oe(this,Nn).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,n,a)]))}getQueryState(e){var a;const n=this.defaultQueryOptions({queryKey:e});return(a=oe(this,Nn).get(n.queryHash))==null?void 0:a.state}removeQueries(e){const n=oe(this,Nn);Un.batch(()=>{n.findAll(e).forEach(a=>{n.remove(a)})})}resetQueries(e,n){const a=oe(this,Nn);return Un.batch(()=>(a.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},n)))}cancelQueries(e,n={}){const a={revert:!0,...n},r=Un.batch(()=>oe(this,Nn).findAll(e).map(s=>s.cancel(a)));return Promise.all(r).then(La).catch(La)}invalidateQueries(e,n={}){return Un.batch(()=>(oe(this,Nn).findAll(e).forEach(a=>{a.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},n)))}refetchQueries(e,n={}){const a={...n,cancelRefetch:n.cancelRefetch??!0},r=Un.batch(()=>oe(this,Nn).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let l=s.fetch(void 0,a);return a.throwOnError||(l=l.catch(La)),s.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(r).then(La)}fetchQuery(e){const n=this.defaultQueryOptions(e);n.retry===void 0&&(n.retry=!1);const a=oe(this,Nn).build(this,n);return a.isStaleByTime(el(n.staleTime,a))?a.fetch(n):Promise.resolve(a.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(La).catch(La)}fetchInfiniteQuery(e){return e.behavior=$1(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(La).catch(La)}ensureInfiniteQueryData(e){return e.behavior=$1(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return h0.isOnline()?oe(this,$i).resumePausedMutations():Promise.resolve()}getQueryCache(){return oe(this,Nn)}getMutationCache(){return oe(this,$i)}getDefaultOptions(){return oe(this,Gi)}setDefaultOptions(e){$e(this,Gi,e)}setQueryDefaults(e,n){oe(this,gc).set(ao(e),{queryKey:e,defaultOptions:n})}getQueryDefaults(e){const n=[...oe(this,gc).values()],a={};return n.forEach(r=>{$d(e,r.queryKey)&&Object.assign(a,r.defaultOptions)}),a}setMutationDefaults(e,n){oe(this,yc).set(ao(e),{mutationKey:e,defaultOptions:n})}getMutationDefaults(e){const n=[...oe(this,yc).values()],a={};return n.forEach(r=>{$d(e,r.mutationKey)&&Object.assign(a,r.defaultOptions)}),a}defaultQueryOptions(e){if(e._defaulted)return e;const n={...oe(this,Gi).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return n.queryHash||(n.queryHash=Mp(n.queryKey,n)),n.refetchOnReconnect===void 0&&(n.refetchOnReconnect=n.networkMode!=="always"),n.throwOnError===void 0&&(n.throwOnError=!!n.suspense),!n.networkMode&&n.persister&&(n.networkMode="offlineFirst"),n.queryFn===Rp&&(n.enabled=!1),n}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...oe(this,Gi).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){oe(this,Nn).clear(),oe(this,$i).clear()}},Nn=new WeakMap,$i=new WeakMap,Gi=new WeakMap,gc=new WeakMap,yc=new WeakMap,qi=new WeakMap,vc=new WeakMap,bc=new WeakMap,C2),R2=E.createContext(void 0),Bt=e=>{const n=E.useContext(R2);if(!n)throw new Error("No QueryClient set, use QueryClientProvider to set one");return n},tS=({client:e,children:n})=>(E.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),t.jsx(R2.Provider,{value:e,children:n})),B2=E.createContext(!1),nS=()=>E.useContext(B2);B2.Provider;function aS(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var rS=E.createContext(aS()),sS=()=>E.useContext(rS),iS=(e,n,a)=>{const r=a!=null&&a.state.error&&typeof e.throwOnError=="function"?Bp(e.throwOnError,[a.state.error,a]):e.throwOnError;(e.suspense||e.experimental_prefetchInRender||r)&&(n.isReset()||(e.retryOnMount=!1))},lS=e=>{E.useEffect(()=>{e.clearReset()},[e])},oS=({result:e,errorResetBoundary:n,throwOnError:a,query:r,suspense:s})=>e.isError&&!n.isReset()&&!e.isFetching&&r&&(s&&e.data===void 0||Bp(a,[e.error,r])),cS=e=>{if(e.suspense){const a=s=>s==="static"?s:Math.max(s??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...s)=>a(r(...s)):a(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},dS=(e,n)=>e.isLoading&&e.isFetching&&!n,uS=(e,n)=>(e==null?void 0:e.suspense)&&n.isPending,q1=(e,n,a)=>n.fetchOptimistic(e).catch(()=>{a.clearReset()});function hS(e,n,a){var p,b,g,y;const r=nS(),s=sS(),l=Bt(),o=l.defaultQueryOptions(e);(b=(p=l.getDefaultOptions().queries)==null?void 0:p._experimental_beforeQuery)==null||b.call(p,o);const d=l.getQueryCache().get(o.queryHash);o._optimisticResults=r?"isRestoring":"optimistic",cS(o),iS(o,s,d),lS(s);const u=!l.getQueryCache().get(o.queryHash),[x]=E.useState(()=>new n(l,o)),m=x.getOptimisticResult(o),f=!r&&e.subscribed!==!1;if(E.useSyncExternalStore(E.useCallback(N=>{const k=f?x.subscribe(Un.batchCalls(N)):La;return x.updateResult(),k},[x,f]),()=>x.getCurrentResult(),()=>x.getCurrentResult()),E.useEffect(()=>{x.setOptions(o)},[o,x]),uS(o,m))throw q1(o,x,s);if(oS({result:m,errorResetBoundary:s,throwOnError:o.throwOnError,query:d,suspense:o.suspense}))throw m.error;if((y=(g=l.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||y.call(g,o,m),o.experimental_prefetchInRender&&!no&&dS(m,r)){const N=u?q1(o,x,s):d==null?void 0:d.promise;N==null||N.catch(La).finally(()=>{x.updateResult()})}return o.notifyOnChangeProps?m:x.trackResult(m)}function Ie(e,n){return hS(e,GC)}function De(e,n){const a=Bt(),[r]=E.useState(()=>new JC(a,e));E.useEffect(()=>{r.setOptions(e)},[r,e]);const s=E.useSyncExternalStore(E.useCallback(o=>r.subscribe(Un.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),l=E.useCallback((o,d)=>{r.mutate(o,d).catch(La)},[r]);if(s.error&&Bp(r.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:l,mutateAsync:s.mutate}}var xS=_2();/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gd(){return Gd=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},Gd.apply(this,arguments)}var Wi;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Wi||(Wi={}));const W1="popstate";function mS(e){e===void 0&&(e={});function n(r,s){let{pathname:l,search:o,hash:d}=r.location;return ep("",{pathname:l,search:o,hash:d},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function a(r,s){return typeof s=="string"?s:x0(s)}return pS(n,a,null,e)}function En(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function Up(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function fS(){return Math.random().toString(36).substr(2,8)}function X1(e,n){return{usr:e.state,key:e.key,idx:n}}function ep(e,n,a,r){return a===void 0&&(a=null),Gd({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof n=="string"?Dc(n):n,{state:a,key:n&&n.key||r||fS()})}function x0(e){let{pathname:n="/",search:a="",hash:r=""}=e;return a&&a!=="?"&&(n+=a.charAt(0)==="?"?a:"?"+a),r&&r!=="#"&&(n+=r.charAt(0)==="#"?r:"#"+r),n}function Dc(e){let n={};if(e){let a=e.indexOf("#");a>=0&&(n.hash=e.substr(a),e=e.substr(0,a));let r=e.indexOf("?");r>=0&&(n.search=e.substr(r),e=e.substr(0,r)),e&&(n.pathname=e)}return n}function pS(e,n,a,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:l=!1}=r,o=s.history,d=Wi.Pop,u=null,x=m();x==null&&(x=0,o.replaceState(Gd({},o.state,{idx:x}),""));function m(){return(o.state||{idx:null}).idx}function f(){d=Wi.Pop;let N=m(),k=N==null?null:N-x;x=N,u&&u({action:d,location:y.location,delta:k})}function p(N,k){d=Wi.Push;let T=ep(y.location,N,k);x=m()+1;let S=X1(T,x),w=y.createHref(T);try{o.pushState(S,"",w)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;s.location.assign(w)}l&&u&&u({action:d,location:y.location,delta:1})}function b(N,k){d=Wi.Replace;let T=ep(y.location,N,k);x=m();let S=X1(T,x),w=y.createHref(T);o.replaceState(S,"",w),l&&u&&u({action:d,location:y.location,delta:0})}function g(N){let k=s.location.origin!=="null"?s.location.origin:s.location.href,T=typeof N=="string"?N:x0(N);return T=T.replace(/ $/,"%20"),En(k,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,k)}let y={get action(){return d},get location(){return e(s,o)},listen(N){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(W1,f),u=N,()=>{s.removeEventListener(W1,f),u=null}},createHref(N){return n(s,N)},createURL:g,encodeLocation(N){let k=g(N);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:p,replace:b,go(N){return o.go(N)}};return y}var Q1;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Q1||(Q1={}));function gS(e,n,a){return a===void 0&&(a="/"),yS(e,n,a)}function yS(e,n,a,r){let s=typeof n=="string"?Dc(n):n,l=Kp(s.pathname||"/",a);if(l==null)return null;let o=H2(e);vS(o);let d=null;for(let u=0;d==null&&u<o.length;++u){let x=AS(l);d=_S(o[u],x)}return d}function H2(e,n,a,r){n===void 0&&(n=[]),a===void 0&&(a=[]),r===void 0&&(r="");let s=(l,o,d)=>{let u={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};u.relativePath.startsWith("/")&&(En(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let x=tl([r,u.relativePath]),m=a.concat(u);l.children&&l.children.length>0&&(En(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+x+'".')),H2(l.children,n,m,x)),!(l.path==null&&!l.index)&&n.push({path:x,score:CS(x,l.index),routesMeta:m})};return e.forEach((l,o)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))s(l,o);else for(let u of V2(l.path))s(l,o,u)}),n}function V2(e){let n=e.split("/");if(n.length===0)return[];let[a,...r]=n,s=a.endsWith("?"),l=a.replace(/\?$/,"");if(r.length===0)return s?[l,""]:[l];let o=V2(r.join("/")),d=[];return d.push(...o.map(u=>u===""?l:[l,u].join("/"))),s&&d.push(...o),d.map(u=>e.startsWith("/")&&u===""?"/":u)}function vS(e){e.sort((n,a)=>n.score!==a.score?a.score-n.score:SS(n.routesMeta.map(r=>r.childrenIndex),a.routesMeta.map(r=>r.childrenIndex)))}const bS=/^:[\w-]+$/,NS=3,jS=2,wS=1,kS=10,TS=-2,Y1=e=>e==="*";function CS(e,n){let a=e.split("/"),r=a.length;return a.some(Y1)&&(r+=TS),n&&(r+=jS),a.filter(s=>!Y1(s)).reduce((s,l)=>s+(bS.test(l)?NS:l===""?wS:kS),r)}function SS(e,n){return e.length===n.length&&e.slice(0,-1).every((r,s)=>r===n[s])?e[e.length-1]-n[n.length-1]:0}function _S(e,n,a){let{routesMeta:r}=e,s={},l="/",o=[];for(let d=0;d<r.length;++d){let u=r[d],x=d===r.length-1,m=l==="/"?n:n.slice(l.length)||"/",f=ES({path:u.relativePath,caseSensitive:u.caseSensitive,end:x},m),p=u.route;if(!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:tl([l,f.pathname]),pathnameBase:OS(tl([l,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(l=tl([l,f.pathnameBase]))}return o}function ES(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[a,r]=DS(e.path,e.caseSensitive,e.end),s=n.match(a);if(!s)return null;let l=s[0],o=l.replace(/(.)\/+$/,"$1"),d=s.slice(1);return{params:r.reduce((x,m,f)=>{let{paramName:p,isOptional:b}=m;if(p==="*"){let y=d[f]||"";o=l.slice(0,l.length-y.length).replace(/(.)\/+$/,"$1")}const g=d[f];return b&&!g?x[p]=void 0:x[p]=(g||"").replace(/%2F/g,"/"),x},{}),pathname:l,pathnameBase:o,pattern:e}}function DS(e,n,a){n===void 0&&(n=!1),a===void 0&&(a=!0),Up(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,d,u)=>(r.push({paramName:d,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,n?void 0:"i"),r]}function AS(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return Up(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+n+").")),e}}function Kp(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let a=n.endsWith("/")?n.length-1:n.length,r=e.charAt(a);return r&&r!=="/"?null:e.slice(a)||"/"}const FS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,LS=e=>FS.test(e);function PS(e,n){n===void 0&&(n="/");let{pathname:a,search:r="",hash:s=""}=typeof e=="string"?Dc(e):e,l;if(a)if(LS(a))l=a;else{if(a.includes("//")){let o=a;a=a.replace(/\/\/+/g,"/"),Up(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+a))}a.startsWith("/")?l=J1(a.substring(1),"/"):l=J1(a,n)}else l=n;return{pathname:l,search:MS(r),hash:RS(s)}}function J1(e,n){let a=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?a.length>1&&a.pop():s!=="."&&a.push(s)}),a.length>1?a.join("/"):"/"}function Jm(e,n,a,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+n+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function IS(e){return e.filter((n,a)=>a===0||n.route.path&&n.route.path.length>0)}function zp(e,n){let a=IS(e);return n?a.map((r,s)=>s===a.length-1?r.pathname:r.pathnameBase):a.map(r=>r.pathnameBase)}function $p(e,n,a,r){r===void 0&&(r=!1);let s;typeof e=="string"?s=Dc(e):(s=Gd({},e),En(!s.pathname||!s.pathname.includes("?"),Jm("?","pathname","search",s)),En(!s.pathname||!s.pathname.includes("#"),Jm("#","pathname","hash",s)),En(!s.search||!s.search.includes("#"),Jm("#","search","hash",s)));let l=e===""||s.pathname==="",o=l?"/":s.pathname,d;if(o==null)d=a;else{let f=n.length-1;if(!r&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;s.pathname=p.join("/")}d=f>=0?n[f]:"/"}let u=PS(s,d),x=o&&o!=="/"&&o.endsWith("/"),m=(l||o===".")&&a.endsWith("/");return!u.pathname.endsWith("/")&&(x||m)&&(u.pathname+="/"),u}const tl=e=>e.join("/").replace(/\/\/+/g,"/"),OS=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),MS=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,RS=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function BS(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const U2=["post","put","patch","delete"];new Set(U2);const HS=["get",...U2];new Set(HS);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qd(){return qd=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},qd.apply(this,arguments)}const Gp=E.createContext(null),VS=E.createContext(null),ol=E.createContext(null),K0=E.createContext(null),Ss=E.createContext({outlet:null,matches:[],isDataRoute:!1}),K2=E.createContext(null);function US(e,n){let{relative:a}=n===void 0?{}:n;Ac()||En(!1);let{basename:r,navigator:s}=E.useContext(ol),{hash:l,pathname:o,search:d}=$2(e,{relative:a}),u=o;return r!=="/"&&(u=o==="/"?r:tl([r,o])),s.createHref({pathname:u,search:d,hash:l})}function Ac(){return E.useContext(K0)!=null}function _s(){return Ac()||En(!1),E.useContext(K0).location}function z2(e){E.useContext(ol).static||E.useLayoutEffect(e)}function mr(){let{isDataRoute:e}=E.useContext(Ss);return e?a3():KS()}function KS(){Ac()||En(!1);let e=E.useContext(Gp),{basename:n,future:a,navigator:r}=E.useContext(ol),{matches:s}=E.useContext(Ss),{pathname:l}=_s(),o=JSON.stringify(zp(s,a.v7_relativeSplatPath)),d=E.useRef(!1);return z2(()=>{d.current=!0}),E.useCallback(function(x,m){if(m===void 0&&(m={}),!d.current)return;if(typeof x=="number"){r.go(x);return}let f=$p(x,JSON.parse(o),l,m.relative==="path");e==null&&n!=="/"&&(f.pathname=f.pathname==="/"?n:tl([n,f.pathname])),(m.replace?r.replace:r.push)(f,m.state,m)},[n,r,o,l,e])}const zS=E.createContext(null);function $S(e){let n=E.useContext(Ss).outlet;return n&&E.createElement(zS.Provider,{value:e},n)}function z0(){let{matches:e}=E.useContext(Ss),n=e[e.length-1];return n?n.params:{}}function $2(e,n){let{relative:a}=n===void 0?{}:n,{future:r}=E.useContext(ol),{matches:s}=E.useContext(Ss),{pathname:l}=_s(),o=JSON.stringify(zp(s,r.v7_relativeSplatPath));return E.useMemo(()=>$p(e,JSON.parse(o),l,a==="path"),[e,o,l,a])}function GS(e,n){return qS(e,n)}function qS(e,n,a,r){Ac()||En(!1);let{navigator:s}=E.useContext(ol),{matches:l}=E.useContext(Ss),o=l[l.length-1],d=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let x=_s(),m;if(n){var f;let N=typeof n=="string"?Dc(n):n;u==="/"||(f=N.pathname)!=null&&f.startsWith(u)||En(!1),m=N}else m=x;let p=m.pathname||"/",b=p;if(u!=="/"){let N=u.replace(/^\//,"").split("/");b="/"+p.replace(/^\//,"").split("/").slice(N.length).join("/")}let g=gS(e,{pathname:b}),y=JS(g&&g.map(N=>Object.assign({},N,{params:Object.assign({},d,N.params),pathname:tl([u,s.encodeLocation?s.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?u:tl([u,s.encodeLocation?s.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),l,a,r);return n&&y?E.createElement(K0.Provider,{value:{location:qd({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:Wi.Pop}},y):y}function WS(){let e=n3(),n=BS(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},n),a?E.createElement("pre",{style:s},a):null,null)}const XS=E.createElement(WS,null);class QS extends E.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,a){return a.location!==n.location||a.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:a.error,location:a.location,revalidation:n.revalidation||a.revalidation}}componentDidCatch(n,a){console.error("React Router caught the following error during render",n,a)}render(){return this.state.error!==void 0?E.createElement(Ss.Provider,{value:this.props.routeContext},E.createElement(K2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function YS(e){let{routeContext:n,match:a,children:r}=e,s=E.useContext(Gp);return s&&s.static&&s.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=a.route.id),E.createElement(Ss.Provider,{value:n},r)}function JS(e,n,a,r){var s;if(n===void 0&&(n=[]),a===void 0&&(a=null),r===void 0&&(r=null),e==null){var l;if(!a)return null;if(a.errors)e=a.matches;else if((l=r)!=null&&l.v7_partialHydration&&n.length===0&&!a.initialized&&a.matches.length>0)e=a.matches;else return null}let o=e,d=(s=a)==null?void 0:s.errors;if(d!=null){let m=o.findIndex(f=>f.route.id&&(d==null?void 0:d[f.route.id])!==void 0);m>=0||En(!1),o=o.slice(0,Math.min(o.length,m+1))}let u=!1,x=-1;if(a&&r&&r.v7_partialHydration)for(let m=0;m<o.length;m++){let f=o[m];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(x=m),f.route.id){let{loaderData:p,errors:b}=a,g=f.route.loader&&p[f.route.id]===void 0&&(!b||b[f.route.id]===void 0);if(f.route.lazy||g){u=!0,x>=0?o=o.slice(0,x+1):o=[o[0]];break}}}return o.reduceRight((m,f,p)=>{let b,g=!1,y=null,N=null;a&&(b=d&&f.route.id?d[f.route.id]:void 0,y=f.route.errorElement||XS,u&&(x<0&&p===0?(r3("route-fallback"),g=!0,N=null):x===p&&(g=!0,N=f.route.hydrateFallbackElement||null)));let k=n.concat(o.slice(0,p+1)),T=()=>{let S;return b?S=y:g?S=N:f.route.Component?S=E.createElement(f.route.Component,null):f.route.element?S=f.route.element:S=m,E.createElement(YS,{match:f,routeContext:{outlet:m,matches:k,isDataRoute:a!=null},children:S})};return a&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?E.createElement(QS,{location:a.location,revalidation:a.revalidation,component:y,error:b,children:T(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):T()},null)}var G2=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(G2||{}),q2=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(q2||{});function ZS(e){let n=E.useContext(Gp);return n||En(!1),n}function e3(e){let n=E.useContext(VS);return n||En(!1),n}function t3(e){let n=E.useContext(Ss);return n||En(!1),n}function W2(e){let n=t3(),a=n.matches[n.matches.length-1];return a.route.id||En(!1),a.route.id}function n3(){var e;let n=E.useContext(K2),a=e3(),r=W2();return n!==void 0?n:(e=a.errors)==null?void 0:e[r]}function a3(){let{router:e}=ZS(G2.UseNavigateStable),n=W2(q2.UseNavigateStable),a=E.useRef(!1);return z2(()=>{a.current=!0}),E.useCallback(function(s,l){l===void 0&&(l={}),a.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,qd({fromRouteId:n},l)))},[e,n])}const Z1={};function r3(e,n,a){Z1[e]||(Z1[e]=!0)}function s3(e,n){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function i3(e){let{to:n,replace:a,state:r,relative:s}=e;Ac()||En(!1);let{future:l,static:o}=E.useContext(ol),{matches:d}=E.useContext(Ss),{pathname:u}=_s(),x=mr(),m=$p(n,zp(d,l.v7_relativeSplatPath),u,s==="path"),f=JSON.stringify(m);return E.useEffect(()=>x(JSON.parse(f),{replace:a,state:r,relative:s}),[x,f,s,a,r]),null}function X2(e){return $S(e.context)}function rt(e){En(!1)}function l3(e){let{basename:n="/",children:a=null,location:r,navigationType:s=Wi.Pop,navigator:l,static:o=!1,future:d}=e;Ac()&&En(!1);let u=n.replace(/^\/*/,"/"),x=E.useMemo(()=>({basename:u,navigator:l,static:o,future:qd({v7_relativeSplatPath:!1},d)}),[u,d,l,o]);typeof r=="string"&&(r=Dc(r));let{pathname:m="/",search:f="",hash:p="",state:b=null,key:g="default"}=r,y=E.useMemo(()=>{let N=Kp(m,u);return N==null?null:{location:{pathname:N,search:f,hash:p,state:b,key:g},navigationType:s}},[u,m,f,p,b,g,s]);return y==null?null:E.createElement(ol.Provider,{value:x},E.createElement(K0.Provider,{children:a,value:y}))}function o3(e){let{children:n,location:a}=e;return GS(tp(n),a)}new Promise(()=>{});function tp(e,n){n===void 0&&(n=[]);let a=[];return E.Children.forEach(e,(r,s)=>{if(!E.isValidElement(r))return;let l=[...n,s];if(r.type===E.Fragment){a.push.apply(a,tp(r.props.children,l));return}r.type!==rt&&En(!1),!r.props.index||!r.props.children||En(!1);let o={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=tp(r.props.children,l)),a.push(o)}),a}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function np(){return np=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},np.apply(this,arguments)}function c3(e,n){if(e==null)return{};var a={},r=Object.keys(e),s,l;for(l=0;l<r.length;l++)s=r[l],!(n.indexOf(s)>=0)&&(a[s]=e[s]);return a}function d3(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function u3(e,n){return e.button===0&&(!n||n==="_self")&&!d3(e)}function ap(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((n,a)=>{let r=e[a];return n.concat(Array.isArray(r)?r.map(s=>[a,s]):[[a,r]])},[]))}function h3(e,n){let a=ap(e);return n&&n.forEach((r,s)=>{a.has(s)||n.getAll(s).forEach(l=>{a.append(s,l)})}),a}const x3=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],m3="6";try{window.__reactRouterVersion=m3}catch{}const f3="startTransition",eb=TC[f3];function p3(e){let{basename:n,children:a,future:r,window:s}=e,l=E.useRef();l.current==null&&(l.current=mS({window:s,v5Compat:!0}));let o=l.current,[d,u]=E.useState({action:o.action,location:o.location}),{v7_startTransition:x}=r||{},m=E.useCallback(f=>{x&&eb?eb(()=>u(f)):u(f)},[u,x]);return E.useLayoutEffect(()=>o.listen(m),[o,m]),E.useEffect(()=>s3(r),[r]),E.createElement(l3,{basename:n,children:a,location:d.location,navigationType:d.action,navigator:o,future:r})}const g3=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",y3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ca=E.forwardRef(function(n,a){let{onClick:r,relative:s,reloadDocument:l,replace:o,state:d,target:u,to:x,preventScrollReset:m,viewTransition:f}=n,p=c3(n,x3),{basename:b}=E.useContext(ol),g,y=!1;if(typeof x=="string"&&y3.test(x)&&(g=x,g3))try{let S=new URL(window.location.href),w=x.startsWith("//")?new URL(S.protocol+x):new URL(x),_=Kp(w.pathname,b);w.origin===S.origin&&_!=null?x=_+w.search+w.hash:y=!0}catch{}let N=US(x,{relative:s}),k=v3(x,{replace:o,state:d,target:u,preventScrollReset:m,relative:s,viewTransition:f});function T(S){r&&r(S),S.defaultPrevented||k(S)}return E.createElement("a",np({},p,{href:g||N,onClick:y||l?r:T,ref:a,target:u}))});var tb;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(tb||(tb={}));var nb;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(nb||(nb={}));function v3(e,n){let{target:a,replace:r,state:s,preventScrollReset:l,relative:o,viewTransition:d}=n===void 0?{}:n,u=mr(),x=_s(),m=$2(e,{relative:o});return E.useCallback(f=>{if(u3(f,a)){f.preventDefault();let p=r!==void 0?r:x0(x)===x0(m);u(e,{replace:p,state:s,preventScrollReset:l,relative:o,viewTransition:d})}},[x,u,m,r,s,a,e,l,o,d])}function b3(e){let n=E.useRef(ap(e)),a=E.useRef(!1),r=_s(),s=E.useMemo(()=>h3(r.search,a.current?null:n.current),[r.search]),l=mr(),o=E.useCallback((d,u)=>{const x=ap(typeof d=="function"?d(s):d);a.current=!0,l("?"+x,u)},[l,s]);return[s,o]}let N3={data:""},j3=e=>{if(typeof window=="object"){let n=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return n.nonce=window.__nonce__,n.parentNode||(e||document.head).appendChild(n),n.firstChild}return e||N3},w3=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,k3=/\/\*[^]*?\*\/|  +/g,ab=/\n+/g,Ri=(e,n)=>{let a="",r="",s="";for(let l in e){let o=e[l];l[0]=="@"?l[1]=="i"?a=l+" "+o+";":r+=l[1]=="f"?Ri(o,l):l+"{"+Ri(o,l[1]=="k"?"":n)+"}":typeof o=="object"?r+=Ri(o,n?n.replace(/([^,])+/g,d=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,d):d?d+" "+u:u)):l):o!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=Ri.p?Ri.p(l,o):l+":"+o+";")}return a+(n&&s?n+"{"+s+"}":s)+r},Us={},Q2=e=>{if(typeof e=="object"){let n="";for(let a in e)n+=a+Q2(e[a]);return n}return e},T3=(e,n,a,r,s)=>{let l=Q2(e),o=Us[l]||(Us[l]=(u=>{let x=0,m=11;for(;x<u.length;)m=101*m+u.charCodeAt(x++)>>>0;return"go"+m})(l));if(!Us[o]){let u=l!==e?e:(x=>{let m,f,p=[{}];for(;m=w3.exec(x.replace(k3,""));)m[4]?p.shift():m[3]?(f=m[3].replace(ab," ").trim(),p.unshift(p[0][f]=p[0][f]||{})):p[0][m[1]]=m[2].replace(ab," ").trim();return p[0]})(e);Us[o]=Ri(s?{["@keyframes "+o]:u}:u,a?"":"."+o)}let d=a&&Us.g?Us.g:null;return a&&(Us.g=Us[o]),((u,x,m,f)=>{f?x.data=x.data.replace(f,u):x.data.indexOf(u)===-1&&(x.data=m?u+x.data:x.data+u)})(Us[o],n,r,d),o},C3=(e,n,a)=>e.reduce((r,s,l)=>{let o=n[l];if(o&&o.call){let d=o(a),u=d&&d.props&&d.props.className||/^go/.test(d)&&d;o=u?"."+u:d&&typeof d=="object"?d.props?"":Ri(d,""):d===!1?"":d}return r+s+(o??"")},"");function $0(e){let n=this||{},a=e.call?e(n.p):e;return T3(a.unshift?a.raw?C3(a,[].slice.call(arguments,1),n.p):a.reduce((r,s)=>Object.assign(r,s&&s.call?s(n.p):s),{}):a,j3(n.target),n.g,n.o,n.k)}let Y2,rp,sp;$0.bind({g:1});let si=$0.bind({k:1});function S3(e,n,a,r){Ri.p=n,Y2=e,rp=a,sp=r}function cl(e,n){let a=this||{};return function(){let r=arguments;function s(l,o){let d=Object.assign({},l),u=d.className||s.className;a.p=Object.assign({theme:rp&&rp()},d),a.o=/ *go\d+/.test(u),d.className=$0.apply(a,r)+(u?" "+u:"");let x=e;return e[0]&&(x=d.as||e,delete d.as),sp&&x[0]&&sp(d),Y2(x,d)}return s}}var _3=e=>typeof e=="function",m0=(e,n)=>_3(e)?e(n):e,E3=(()=>{let e=0;return()=>(++e).toString()})(),J2=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let n=matchMedia("(prefers-reduced-motion: reduce)");e=!n||n.matches}return e}})(),D3=20,qp="default",Z2=(e,n)=>{let{toastLimit:a}=e.settings;switch(n.type){case 0:return{...e,toasts:[n.toast,...e.toasts].slice(0,a)};case 1:return{...e,toasts:e.toasts.map(o=>o.id===n.toast.id?{...o,...n.toast}:o)};case 2:let{toast:r}=n;return Z2(e,{type:e.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=n;return{...e,toasts:e.toasts.map(o=>o.id===s||s===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return n.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==n.toastId)};case 5:return{...e,pausedAt:n.time};case 6:let l=n.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+l}))}}},s0=[],ej={toasts:[],pausedAt:void 0,settings:{toastLimit:D3}},Ns={},tj=(e,n=qp)=>{Ns[n]=Z2(Ns[n]||ej,e),s0.forEach(([a,r])=>{a===n&&r(Ns[n])})},nj=e=>Object.keys(Ns).forEach(n=>tj(e,n)),A3=e=>Object.keys(Ns).find(n=>Ns[n].toasts.some(a=>a.id===e)),G0=(e=qp)=>n=>{tj(n,e)},F3={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},L3=(e={},n=qp)=>{let[a,r]=E.useState(Ns[n]||ej),s=E.useRef(Ns[n]);E.useEffect(()=>(s.current!==Ns[n]&&r(Ns[n]),s0.push([n,r]),()=>{let o=s0.findIndex(([d])=>d===n);o>-1&&s0.splice(o,1)}),[n]);let l=a.toasts.map(o=>{var d,u,x;return{...e,...e[o.type],...o,removeDelay:o.removeDelay||((d=e[o.type])==null?void 0:d.removeDelay)||(e==null?void 0:e.removeDelay),duration:o.duration||((u=e[o.type])==null?void 0:u.duration)||(e==null?void 0:e.duration)||F3[o.type],style:{...e.style,...(x=e[o.type])==null?void 0:x.style,...o.style}}});return{...a,toasts:l}},P3=(e,n="blank",a)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:n,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...a,id:(a==null?void 0:a.id)||E3()}),fu=e=>(n,a)=>{let r=P3(n,e,a);return G0(r.toasterId||A3(r.id))({type:2,toast:r}),r.id},vt=(e,n)=>fu("blank")(e,n);vt.error=fu("error");vt.success=fu("success");vt.loading=fu("loading");vt.custom=fu("custom");vt.dismiss=(e,n)=>{let a={type:3,toastId:e};n?G0(n)(a):nj(a)};vt.dismissAll=e=>vt.dismiss(void 0,e);vt.remove=(e,n)=>{let a={type:4,toastId:e};n?G0(n)(a):nj(a)};vt.removeAll=e=>vt.remove(void 0,e);vt.promise=(e,n,a)=>{let r=vt.loading(n.loading,{...a,...a==null?void 0:a.loading});return typeof e=="function"&&(e=e()),e.then(s=>{let l=n.success?m0(n.success,s):void 0;return l?vt.success(l,{id:r,...a,...a==null?void 0:a.success}):vt.dismiss(r),s}).catch(s=>{let l=n.error?m0(n.error,s):void 0;l?vt.error(l,{id:r,...a,...a==null?void 0:a.error}):vt.dismiss(r)}),e};var I3=1e3,O3=(e,n="default")=>{let{toasts:a,pausedAt:r}=L3(e,n),s=E.useRef(new Map).current,l=E.useCallback((f,p=I3)=>{if(s.has(f))return;let b=setTimeout(()=>{s.delete(f),o({type:4,toastId:f})},p);s.set(f,b)},[]);E.useEffect(()=>{if(r)return;let f=Date.now(),p=a.map(b=>{if(b.duration===1/0)return;let g=(b.duration||0)+b.pauseDuration-(f-b.createdAt);if(g<0){b.visible&&vt.dismiss(b.id);return}return setTimeout(()=>vt.dismiss(b.id,n),g)});return()=>{p.forEach(b=>b&&clearTimeout(b))}},[a,r,n]);let o=E.useCallback(G0(n),[n]),d=E.useCallback(()=>{o({type:5,time:Date.now()})},[o]),u=E.useCallback((f,p)=>{o({type:1,toast:{id:f,height:p}})},[o]),x=E.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),m=E.useCallback((f,p)=>{let{reverseOrder:b=!1,gutter:g=8,defaultPosition:y}=p||{},N=a.filter(S=>(S.position||y)===(f.position||y)&&S.height),k=N.findIndex(S=>S.id===f.id),T=N.filter((S,w)=>w<k&&S.visible).length;return N.filter(S=>S.visible).slice(...b?[T+1]:[0,T]).reduce((S,w)=>S+(w.height||0)+g,0)},[a]);return E.useEffect(()=>{a.forEach(f=>{if(f.dismissed)l(f.id,f.removeDelay);else{let p=s.get(f.id);p&&(clearTimeout(p),s.delete(f.id))}})},[a,l]),{toasts:a,handlers:{updateHeight:u,startPause:d,endPause:x,calculateOffset:m}}},M3=si`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,R3=si`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,B3=si`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,H3=cl("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${M3} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${R3} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${B3} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,V3=si`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,U3=cl("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${V3} 1s linear infinite;
`,K3=si`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,z3=si`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,$3=cl("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${K3} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${z3} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,G3=cl("div")`
  position: absolute;
`,q3=cl("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,W3=si`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,X3=cl("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${W3} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Q3=({toast:e})=>{let{icon:n,type:a,iconTheme:r}=e;return n!==void 0?typeof n=="string"?E.createElement(X3,null,n):n:a==="blank"?null:E.createElement(q3,null,E.createElement(U3,{...r}),a!=="loading"&&E.createElement(G3,null,a==="error"?E.createElement(H3,{...r}):E.createElement($3,{...r})))},Y3=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,J3=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,Z3="0%{opacity:0;} 100%{opacity:1;}",e_="0%{opacity:1;} 100%{opacity:0;}",t_=cl("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,n_=cl("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,a_=(e,n)=>{let a=e.includes("top")?1:-1,[r,s]=J2()?[Z3,e_]:[Y3(a),J3(a)];return{animation:n?`${si(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${si(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},r_=E.memo(({toast:e,position:n,style:a,children:r})=>{let s=e.height?a_(e.position||n||"top-center",e.visible):{opacity:0},l=E.createElement(Q3,{toast:e}),o=E.createElement(n_,{...e.ariaProps},m0(e.message,e));return E.createElement(t_,{className:e.className,style:{...s,...a,...e.style}},typeof r=="function"?r({icon:l,message:o}):E.createElement(E.Fragment,null,l,o))});S3(E.createElement);var s_=({id:e,className:n,style:a,onHeightUpdate:r,children:s})=>{let l=E.useCallback(o=>{if(o){let d=()=>{let u=o.getBoundingClientRect().height;r(e,u)};d(),new MutationObserver(d).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return E.createElement("div",{ref:l,className:n,style:a},s)},i_=(e,n)=>{let a=e.includes("top"),r=a?{top:0}:{bottom:0},s=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:J2()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${n*(a?1:-1)}px)`,...r,...s}},l_=$0`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Vh=16,o_=({reverseOrder:e,position:n="top-center",toastOptions:a,gutter:r,children:s,toasterId:l,containerStyle:o,containerClassName:d})=>{let{toasts:u,handlers:x}=O3(a,l);return E.createElement("div",{"data-rht-toaster":l||"",style:{position:"fixed",zIndex:9999,top:Vh,left:Vh,right:Vh,bottom:Vh,pointerEvents:"none",...o},className:d,onMouseEnter:x.startPause,onMouseLeave:x.endPause},u.map(m=>{let f=m.position||n,p=x.calculateOffset(m,{reverseOrder:e,gutter:r,defaultPosition:n}),b=i_(f,p);return E.createElement(s_,{id:m.id,key:m.id,onHeightUpdate:x.updateHeight,className:m.visible?l_:"",style:b},m.type==="custom"?m0(m.message,m):s?s(m):E.createElement(r_,{toast:m,position:f}))}))},ie=vt;/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var c_={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d_=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),_e=(e,n)=>{const a=E.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:o,className:d="",children:u,...x},m)=>E.createElement("svg",{ref:m,...c_,width:s,height:s,stroke:r,strokeWidth:o?Number(l)*24/Number(s):l,className:["lucide",`lucide-${d_(e)}`,d].join(" "),...x},[...n.map(([f,p])=>E.createElement(f,p)),...Array.isArray(u)?u:[u]]));return a.displayName=`${e}`,a};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dl=_e("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=_e("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q0=_e("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u_=_e("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h_=_e("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aj=_e("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rj=_e("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nc=_e("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x_=_e("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m_=_e("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f_=_e("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f0=_e("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=_e("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p_=_e("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rb=_e("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g_=_e("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sb=_e("CalendarRange",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=_e("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y_=_e("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sj=_e("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ij=_e("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=_e("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=_e("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=_e("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=_e("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $n=_e("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Il=_e("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v_=_e("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b_=_e("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N_=_e("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=_e("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j_=_e("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w_=_e("Command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lj=_e("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k_=_e("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pd=_e("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=_e("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=_e("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T_=_e("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ii=_e("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wp=_e("FileDown",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=_e("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=_e("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xp=_e("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oj=_e("FolderTree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C_=_e("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S_=_e("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ib=_e("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __=_e("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pu=_e("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W0=_e("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E_=_e("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cj=_e("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p0=_e("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D_=_e("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A_=_e("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=_e("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=_e("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F_=_e("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qp=_e("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yp=_e("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wd=_e("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L_=_e("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lb=_e("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ob=_e("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jc=_e("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jp=_e("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P_=_e("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dj=_e("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zm=_e("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=_e("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I_=_e("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O_=_e("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M_=_e("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ip=_e("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=_e("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R_=_e("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B_=_e("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H_=_e("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=_e("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zp=_e("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const al=_e("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V_=_e("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U_=_e("ScrollText",[["path",{d:"M8 21h12a2 2 0 0 0 2-2v-2H10v2a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v3h4",key:"13a6an"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M15 12h-5",key:"r7krc0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=_e("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gu=_e("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=_e("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K_=_e("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0=_e("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z_=_e("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g0=_e("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uj=_e("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $_=_e("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G_=_e("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hj=_e("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xj=_e("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=_e("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lp=_e("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const li=_e("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eg=_e("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tg=_e("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=_e("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q_=_e("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W_=_e("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=_e("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dn=_e("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ng=_e("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xo=_e("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mn=_e("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ag=_e("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function mj(e,n){return function(){return e.apply(n,arguments)}}const{toString:X_}=Object.prototype,{getPrototypeOf:rg}=Object,{iterator:X0,toStringTag:fj}=Symbol,Q0=(e=>n=>{const a=X_.call(n);return e[a]||(e[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),ns=e=>(e=e.toLowerCase(),n=>Q0(n)===e),Y0=e=>n=>typeof n===e,{isArray:Fc}=Array,wc=Y0("undefined");function yu(e){return e!==null&&!wc(e)&&e.constructor!==null&&!wc(e.constructor)&&Ja(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const pj=ns("ArrayBuffer");function Q_(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&pj(e.buffer),n}const Y_=Y0("string"),Ja=Y0("function"),gj=Y0("number"),vu=e=>e!==null&&typeof e=="object",J_=e=>e===!0||e===!1,l0=e=>{if(Q0(e)!=="object")return!1;const n=rg(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(fj in e)&&!(X0 in e)},Z_=e=>{if(!vu(e)||yu(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},eE=ns("Date"),tE=ns("File"),nE=ns("Blob"),aE=ns("FileList"),rE=e=>vu(e)&&Ja(e.pipe),sE=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||Ja(e.append)&&((n=Q0(e))==="formdata"||n==="object"&&Ja(e.toString)&&e.toString()==="[object FormData]"))},iE=ns("URLSearchParams"),[lE,oE,cE,dE]=["ReadableStream","Request","Response","Headers"].map(ns),uE=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function bu(e,n,{allOwnKeys:a=!1}={}){if(e===null||typeof e>"u")return;let r,s;if(typeof e!="object"&&(e=[e]),Fc(e))for(r=0,s=e.length;r<s;r++)n.call(null,e[r],r,e);else{if(yu(e))return;const l=a?Object.getOwnPropertyNames(e):Object.keys(e),o=l.length;let d;for(r=0;r<o;r++)d=l[r],n.call(null,e[d],d,e)}}function yj(e,n){if(yu(e))return null;n=n.toLowerCase();const a=Object.keys(e);let r=a.length,s;for(;r-- >0;)if(s=a[r],n===s.toLowerCase())return s;return null}const Bl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,vj=e=>!wc(e)&&e!==Bl;function op(){const{caseless:e,skipUndefined:n}=vj(this)&&this||{},a={},r=(s,l)=>{const o=e&&yj(a,l)||l;l0(a[o])&&l0(s)?a[o]=op(a[o],s):l0(s)?a[o]=op({},s):Fc(s)?a[o]=s.slice():(!n||!wc(s))&&(a[o]=s)};for(let s=0,l=arguments.length;s<l;s++)arguments[s]&&bu(arguments[s],r);return a}const hE=(e,n,a,{allOwnKeys:r}={})=>(bu(n,(s,l)=>{a&&Ja(s)?e[l]=mj(s,a):e[l]=s},{allOwnKeys:r}),e),xE=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),mE=(e,n,a,r)=>{e.prototype=Object.create(n.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),a&&Object.assign(e.prototype,a)},fE=(e,n,a,r)=>{let s,l,o;const d={};if(n=n||{},e==null)return n;do{for(s=Object.getOwnPropertyNames(e),l=s.length;l-- >0;)o=s[l],(!r||r(o,e,n))&&!d[o]&&(n[o]=e[o],d[o]=!0);e=a!==!1&&rg(e)}while(e&&(!a||a(e,n))&&e!==Object.prototype);return n},pE=(e,n,a)=>{e=String(e),(a===void 0||a>e.length)&&(a=e.length),a-=n.length;const r=e.indexOf(n,a);return r!==-1&&r===a},gE=e=>{if(!e)return null;if(Fc(e))return e;let n=e.length;if(!gj(n))return null;const a=new Array(n);for(;n-- >0;)a[n]=e[n];return a},yE=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&rg(Uint8Array)),vE=(e,n)=>{const r=(e&&e[X0]).call(e);let s;for(;(s=r.next())&&!s.done;){const l=s.value;n.call(e,l[0],l[1])}},bE=(e,n)=>{let a;const r=[];for(;(a=e.exec(n))!==null;)r.push(a);return r},NE=ns("HTMLFormElement"),jE=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,r,s){return r.toUpperCase()+s}),cb=(({hasOwnProperty:e})=>(n,a)=>e.call(n,a))(Object.prototype),wE=ns("RegExp"),bj=(e,n)=>{const a=Object.getOwnPropertyDescriptors(e),r={};bu(a,(s,l)=>{let o;(o=n(s,l,e))!==!1&&(r[l]=o||s)}),Object.defineProperties(e,r)},kE=e=>{bj(e,(n,a)=>{if(Ja(e)&&["arguments","caller","callee"].indexOf(a)!==-1)return!1;const r=e[a];if(Ja(r)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")})}})},TE=(e,n)=>{const a={},r=s=>{s.forEach(l=>{a[l]=!0})};return Fc(e)?r(e):r(String(e).split(n)),a},CE=()=>{},SE=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function _E(e){return!!(e&&Ja(e.append)&&e[fj]==="FormData"&&e[X0])}const EE=e=>{const n=new Array(10),a=(r,s)=>{if(vu(r)){if(n.indexOf(r)>=0)return;if(yu(r))return r;if(!("toJSON"in r)){n[s]=r;const l=Fc(r)?[]:{};return bu(r,(o,d)=>{const u=a(o,s+1);!wc(u)&&(l[d]=u)}),n[s]=void 0,l}}return r};return a(e,0)},DE=ns("AsyncFunction"),AE=e=>e&&(vu(e)||Ja(e))&&Ja(e.then)&&Ja(e.catch),Nj=((e,n)=>e?setImmediate:n?((a,r)=>(Bl.addEventListener("message",({source:s,data:l})=>{s===Bl&&l===a&&r.length&&r.shift()()},!1),s=>{r.push(s),Bl.postMessage(a,"*")}))(`axios@${Math.random()}`,[]):a=>setTimeout(a))(typeof setImmediate=="function",Ja(Bl.postMessage)),FE=typeof queueMicrotask<"u"?queueMicrotask.bind(Bl):typeof process<"u"&&process.nextTick||Nj,LE=e=>e!=null&&Ja(e[X0]),Te={isArray:Fc,isArrayBuffer:pj,isBuffer:yu,isFormData:sE,isArrayBufferView:Q_,isString:Y_,isNumber:gj,isBoolean:J_,isObject:vu,isPlainObject:l0,isEmptyObject:Z_,isReadableStream:lE,isRequest:oE,isResponse:cE,isHeaders:dE,isUndefined:wc,isDate:eE,isFile:tE,isBlob:nE,isRegExp:wE,isFunction:Ja,isStream:rE,isURLSearchParams:iE,isTypedArray:yE,isFileList:aE,forEach:bu,merge:op,extend:hE,trim:uE,stripBOM:xE,inherits:mE,toFlatObject:fE,kindOf:Q0,kindOfTest:ns,endsWith:pE,toArray:gE,forEachEntry:vE,matchAll:bE,isHTMLForm:NE,hasOwnProperty:cb,hasOwnProp:cb,reduceDescriptors:bj,freezeMethods:kE,toObjectSet:TE,toCamelCase:jE,noop:CE,toFiniteNumber:SE,findKey:yj,global:Bl,isContextDefined:vj,isSpecCompliantForm:_E,toJSONObject:EE,isAsyncFn:DE,isThenable:AE,setImmediate:Nj,asap:FE,isIterable:LE};function ft(e,n,a,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),a&&(this.config=a),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}Te.inherits(ft,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Te.toJSONObject(this.config),code:this.code,status:this.status}}});const jj=ft.prototype,wj={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{wj[e]={value:e}});Object.defineProperties(ft,wj);Object.defineProperty(jj,"isAxiosError",{value:!0});ft.from=(e,n,a,r,s,l)=>{const o=Object.create(jj);Te.toFlatObject(e,o,function(m){return m!==Error.prototype},x=>x!=="isAxiosError");const d=e&&e.message?e.message:"Error",u=n==null&&e?e.code:n;return ft.call(o,d,u,a,r,s),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",l&&Object.assign(o,l),o};const PE=null;function cp(e){return Te.isPlainObject(e)||Te.isArray(e)}function kj(e){return Te.endsWith(e,"[]")?e.slice(0,-2):e}function db(e,n,a){return e?e.concat(n).map(function(s,l){return s=kj(s),!a&&l?"["+s+"]":s}).join(a?".":""):n}function IE(e){return Te.isArray(e)&&!e.some(cp)}const OE=Te.toFlatObject(Te,{},null,function(n){return/^is[A-Z]/.test(n)});function J0(e,n,a){if(!Te.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,a=Te.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,N){return!Te.isUndefined(N[y])});const r=a.metaTokens,s=a.visitor||m,l=a.dots,o=a.indexes,u=(a.Blob||typeof Blob<"u"&&Blob)&&Te.isSpecCompliantForm(n);if(!Te.isFunction(s))throw new TypeError("visitor must be a function");function x(g){if(g===null)return"";if(Te.isDate(g))return g.toISOString();if(Te.isBoolean(g))return g.toString();if(!u&&Te.isBlob(g))throw new ft("Blob is not supported. Use a Buffer instead.");return Te.isArrayBuffer(g)||Te.isTypedArray(g)?u&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function m(g,y,N){let k=g;if(g&&!N&&typeof g=="object"){if(Te.endsWith(y,"{}"))y=r?y:y.slice(0,-2),g=JSON.stringify(g);else if(Te.isArray(g)&&IE(g)||(Te.isFileList(g)||Te.endsWith(y,"[]"))&&(k=Te.toArray(g)))return y=kj(y),k.forEach(function(S,w){!(Te.isUndefined(S)||S===null)&&n.append(o===!0?db([y],w,l):o===null?y:y+"[]",x(S))}),!1}return cp(g)?!0:(n.append(db(N,y,l),x(g)),!1)}const f=[],p=Object.assign(OE,{defaultVisitor:m,convertValue:x,isVisitable:cp});function b(g,y){if(!Te.isUndefined(g)){if(f.indexOf(g)!==-1)throw Error("Circular reference detected in "+y.join("."));f.push(g),Te.forEach(g,function(k,T){(!(Te.isUndefined(k)||k===null)&&s.call(n,k,Te.isString(T)?T.trim():T,y,p))===!0&&b(k,y?y.concat(T):[T])}),f.pop()}}if(!Te.isObject(e))throw new TypeError("data must be an object");return b(e),n}function ub(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return n[r]})}function sg(e,n){this._pairs=[],e&&J0(e,this,n)}const Tj=sg.prototype;Tj.append=function(n,a){this._pairs.push([n,a])};Tj.toString=function(n){const a=n?function(r){return n.call(this,r,ub)}:ub;return this._pairs.map(function(s){return a(s[0])+"="+a(s[1])},"").join("&")};function ME(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Cj(e,n,a){if(!n)return e;const r=a&&a.encode||ME;Te.isFunction(a)&&(a={serialize:a});const s=a&&a.serialize;let l;if(s?l=s(n,a):l=Te.isURLSearchParams(n)?n.toString():new sg(n,a).toString(r),l){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+l}return e}class hb{constructor(){this.handlers=[]}use(n,a,r){return this.handlers.push({fulfilled:n,rejected:a,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){Te.forEach(this.handlers,function(r){r!==null&&n(r)})}}const Sj={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},RE=typeof URLSearchParams<"u"?URLSearchParams:sg,BE=typeof FormData<"u"?FormData:null,HE=typeof Blob<"u"?Blob:null,VE={isBrowser:!0,classes:{URLSearchParams:RE,FormData:BE,Blob:HE},protocols:["http","https","file","blob","url","data"]},ig=typeof window<"u"&&typeof document<"u",dp=typeof navigator=="object"&&navigator||void 0,UE=ig&&(!dp||["ReactNative","NativeScript","NS"].indexOf(dp.product)<0),KE=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",zE=ig&&window.location.href||"http://localhost",$E=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ig,hasStandardBrowserEnv:UE,hasStandardBrowserWebWorkerEnv:KE,navigator:dp,origin:zE},Symbol.toStringTag,{value:"Module"})),ja={...$E,...VE};function GE(e,n){return J0(e,new ja.classes.URLSearchParams,{visitor:function(a,r,s,l){return ja.isNode&&Te.isBuffer(a)?(this.append(r,a.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...n})}function qE(e){return Te.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function WE(e){const n={},a=Object.keys(e);let r;const s=a.length;let l;for(r=0;r<s;r++)l=a[r],n[l]=e[l];return n}function _j(e){function n(a,r,s,l){let o=a[l++];if(o==="__proto__")return!0;const d=Number.isFinite(+o),u=l>=a.length;return o=!o&&Te.isArray(s)?s.length:o,u?(Te.hasOwnProp(s,o)?s[o]=[s[o],r]:s[o]=r,!d):((!s[o]||!Te.isObject(s[o]))&&(s[o]=[]),n(a,r,s[o],l)&&Te.isArray(s[o])&&(s[o]=WE(s[o])),!d)}if(Te.isFormData(e)&&Te.isFunction(e.entries)){const a={};return Te.forEachEntry(e,(r,s)=>{n(qE(r),s,a,0)}),a}return null}function XE(e,n,a){if(Te.isString(e))try{return(n||JSON.parse)(e),Te.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(a||JSON.stringify)(e)}const Nu={transitional:Sj,adapter:["xhr","http","fetch"],transformRequest:[function(n,a){const r=a.getContentType()||"",s=r.indexOf("application/json")>-1,l=Te.isObject(n);if(l&&Te.isHTMLForm(n)&&(n=new FormData(n)),Te.isFormData(n))return s?JSON.stringify(_j(n)):n;if(Te.isArrayBuffer(n)||Te.isBuffer(n)||Te.isStream(n)||Te.isFile(n)||Te.isBlob(n)||Te.isReadableStream(n))return n;if(Te.isArrayBufferView(n))return n.buffer;if(Te.isURLSearchParams(n))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let d;if(l){if(r.indexOf("application/x-www-form-urlencoded")>-1)return GE(n,this.formSerializer).toString();if((d=Te.isFileList(n))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return J0(d?{"files[]":n}:n,u&&new u,this.formSerializer)}}return l||s?(a.setContentType("application/json",!1),XE(n)):n}],transformResponse:[function(n){const a=this.transitional||Nu.transitional,r=a&&a.forcedJSONParsing,s=this.responseType==="json";if(Te.isResponse(n)||Te.isReadableStream(n))return n;if(n&&Te.isString(n)&&(r&&!this.responseType||s)){const o=!(a&&a.silentJSONParsing)&&s;try{return JSON.parse(n,this.parseReviver)}catch(d){if(o)throw d.name==="SyntaxError"?ft.from(d,ft.ERR_BAD_RESPONSE,this,null,this.response):d}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ja.classes.FormData,Blob:ja.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Te.forEach(["delete","get","head","post","put","patch"],e=>{Nu.headers[e]={}});const QE=Te.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),YE=e=>{const n={};let a,r,s;return e&&e.split(`
`).forEach(function(o){s=o.indexOf(":"),a=o.substring(0,s).trim().toLowerCase(),r=o.substring(s+1).trim(),!(!a||n[a]&&QE[a])&&(a==="set-cookie"?n[a]?n[a].push(r):n[a]=[r]:n[a]=n[a]?n[a]+", "+r:r)}),n},xb=Symbol("internals");function jd(e){return e&&String(e).trim().toLowerCase()}function o0(e){return e===!1||e==null?e:Te.isArray(e)?e.map(o0):String(e)}function JE(e){const n=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=a.exec(e);)n[r[1]]=r[2];return n}const ZE=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function ef(e,n,a,r,s){if(Te.isFunction(r))return r.call(this,n,a);if(s&&(n=a),!!Te.isString(n)){if(Te.isString(r))return n.indexOf(r)!==-1;if(Te.isRegExp(r))return r.test(n)}}function e5(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,a,r)=>a.toUpperCase()+r)}function t5(e,n){const a=Te.toCamelCase(" "+n);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+a,{value:function(s,l,o){return this[r].call(this,n,s,l,o)},configurable:!0})})}let Za=class{constructor(n){n&&this.set(n)}set(n,a,r){const s=this;function l(d,u,x){const m=jd(u);if(!m)throw new Error("header name must be a non-empty string");const f=Te.findKey(s,m);(!f||s[f]===void 0||x===!0||x===void 0&&s[f]!==!1)&&(s[f||u]=o0(d))}const o=(d,u)=>Te.forEach(d,(x,m)=>l(x,m,u));if(Te.isPlainObject(n)||n instanceof this.constructor)o(n,a);else if(Te.isString(n)&&(n=n.trim())&&!ZE(n))o(YE(n),a);else if(Te.isObject(n)&&Te.isIterable(n)){let d={},u,x;for(const m of n){if(!Te.isArray(m))throw TypeError("Object iterator must return a key-value pair");d[x=m[0]]=(u=d[x])?Te.isArray(u)?[...u,m[1]]:[u,m[1]]:m[1]}o(d,a)}else n!=null&&l(a,n,r);return this}get(n,a){if(n=jd(n),n){const r=Te.findKey(this,n);if(r){const s=this[r];if(!a)return s;if(a===!0)return JE(s);if(Te.isFunction(a))return a.call(this,s,r);if(Te.isRegExp(a))return a.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,a){if(n=jd(n),n){const r=Te.findKey(this,n);return!!(r&&this[r]!==void 0&&(!a||ef(this,this[r],r,a)))}return!1}delete(n,a){const r=this;let s=!1;function l(o){if(o=jd(o),o){const d=Te.findKey(r,o);d&&(!a||ef(r,r[d],d,a))&&(delete r[d],s=!0)}}return Te.isArray(n)?n.forEach(l):l(n),s}clear(n){const a=Object.keys(this);let r=a.length,s=!1;for(;r--;){const l=a[r];(!n||ef(this,this[l],l,n,!0))&&(delete this[l],s=!0)}return s}normalize(n){const a=this,r={};return Te.forEach(this,(s,l)=>{const o=Te.findKey(r,l);if(o){a[o]=o0(s),delete a[l];return}const d=n?e5(l):String(l).trim();d!==l&&delete a[l],a[d]=o0(s),r[d]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const a=Object.create(null);return Te.forEach(this,(r,s)=>{r!=null&&r!==!1&&(a[s]=n&&Te.isArray(r)?r.join(", "):r)}),a}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,a])=>n+": "+a).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...a){const r=new this(n);return a.forEach(s=>r.set(s)),r}static accessor(n){const r=(this[xb]=this[xb]={accessors:{}}).accessors,s=this.prototype;function l(o){const d=jd(o);r[d]||(t5(s,o),r[d]=!0)}return Te.isArray(n)?n.forEach(l):l(n),this}};Za.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Te.reduceDescriptors(Za.prototype,({value:e},n)=>{let a=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(r){this[a]=r}}});Te.freezeMethods(Za);function tf(e,n){const a=this||Nu,r=n||a,s=Za.from(r.headers);let l=r.data;return Te.forEach(e,function(d){l=d.call(a,l,s.normalize(),n?n.status:void 0)}),s.normalize(),l}function Ej(e){return!!(e&&e.__CANCEL__)}function Lc(e,n,a){ft.call(this,e??"canceled",ft.ERR_CANCELED,n,a),this.name="CanceledError"}Te.inherits(Lc,ft,{__CANCEL__:!0});function Dj(e,n,a){const r=a.config.validateStatus;!a.status||!r||r(a.status)?e(a):n(new ft("Request failed with status code "+a.status,[ft.ERR_BAD_REQUEST,ft.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}function n5(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function a5(e,n){e=e||10;const a=new Array(e),r=new Array(e);let s=0,l=0,o;return n=n!==void 0?n:1e3,function(u){const x=Date.now(),m=r[l];o||(o=x),a[s]=u,r[s]=x;let f=l,p=0;for(;f!==s;)p+=a[f++],f=f%e;if(s=(s+1)%e,s===l&&(l=(l+1)%e),x-o<n)return;const b=m&&x-m;return b?Math.round(p*1e3/b):void 0}}function r5(e,n){let a=0,r=1e3/n,s,l;const o=(x,m=Date.now())=>{a=m,s=null,l&&(clearTimeout(l),l=null),e(...x)};return[(...x)=>{const m=Date.now(),f=m-a;f>=r?o(x,m):(s=x,l||(l=setTimeout(()=>{l=null,o(s)},r-f)))},()=>s&&o(s)]}const y0=(e,n,a=3)=>{let r=0;const s=a5(50,250);return r5(l=>{const o=l.loaded,d=l.lengthComputable?l.total:void 0,u=o-r,x=s(u),m=o<=d;r=o;const f={loaded:o,total:d,progress:d?o/d:void 0,bytes:u,rate:x||void 0,estimated:x&&d&&m?(d-o)/x:void 0,event:l,lengthComputable:d!=null,[n?"download":"upload"]:!0};e(f)},a)},mb=(e,n)=>{const a=e!=null;return[r=>n[0]({lengthComputable:a,total:e,loaded:r}),n[1]]},fb=e=>(...n)=>Te.asap(()=>e(...n)),s5=ja.hasStandardBrowserEnv?((e,n)=>a=>(a=new URL(a,ja.origin),e.protocol===a.protocol&&e.host===a.host&&(n||e.port===a.port)))(new URL(ja.origin),ja.navigator&&/(msie|trident)/i.test(ja.navigator.userAgent)):()=>!0,i5=ja.hasStandardBrowserEnv?{write(e,n,a,r,s,l,o){if(typeof document>"u")return;const d=[`${e}=${encodeURIComponent(n)}`];Te.isNumber(a)&&d.push(`expires=${new Date(a).toUTCString()}`),Te.isString(r)&&d.push(`path=${r}`),Te.isString(s)&&d.push(`domain=${s}`),l===!0&&d.push("secure"),Te.isString(o)&&d.push(`SameSite=${o}`),document.cookie=d.join("; ")},read(e){if(typeof document>"u")return null;const n=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return n?decodeURIComponent(n[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function l5(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function o5(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function Aj(e,n,a){let r=!l5(n);return e&&(r||a==!1)?o5(e,n):n}const pb=e=>e instanceof Za?{...e}:e;function so(e,n){n=n||{};const a={};function r(x,m,f,p){return Te.isPlainObject(x)&&Te.isPlainObject(m)?Te.merge.call({caseless:p},x,m):Te.isPlainObject(m)?Te.merge({},m):Te.isArray(m)?m.slice():m}function s(x,m,f,p){if(Te.isUndefined(m)){if(!Te.isUndefined(x))return r(void 0,x,f,p)}else return r(x,m,f,p)}function l(x,m){if(!Te.isUndefined(m))return r(void 0,m)}function o(x,m){if(Te.isUndefined(m)){if(!Te.isUndefined(x))return r(void 0,x)}else return r(void 0,m)}function d(x,m,f){if(f in n)return r(x,m);if(f in e)return r(void 0,x)}const u={url:l,method:l,data:l,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:d,headers:(x,m,f)=>s(pb(x),pb(m),f,!0)};return Te.forEach(Object.keys({...e,...n}),function(m){const f=u[m]||s,p=f(e[m],n[m],m);Te.isUndefined(p)&&f!==d||(a[m]=p)}),a}const Fj=e=>{const n=so({},e);let{data:a,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:l,headers:o,auth:d}=n;if(n.headers=o=Za.from(o),n.url=Cj(Aj(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),d&&o.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):""))),Te.isFormData(a)){if(ja.hasStandardBrowserEnv||ja.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(Te.isFunction(a.getHeaders)){const u=a.getHeaders(),x=["content-type","content-length"];Object.entries(u).forEach(([m,f])=>{x.includes(m.toLowerCase())&&o.set(m,f)})}}if(ja.hasStandardBrowserEnv&&(r&&Te.isFunction(r)&&(r=r(n)),r||r!==!1&&s5(n.url))){const u=s&&l&&i5.read(l);u&&o.set(s,u)}return n},c5=typeof XMLHttpRequest<"u",d5=c5&&function(e){return new Promise(function(a,r){const s=Fj(e);let l=s.data;const o=Za.from(s.headers).normalize();let{responseType:d,onUploadProgress:u,onDownloadProgress:x}=s,m,f,p,b,g;function y(){b&&b(),g&&g(),s.cancelToken&&s.cancelToken.unsubscribe(m),s.signal&&s.signal.removeEventListener("abort",m)}let N=new XMLHttpRequest;N.open(s.method.toUpperCase(),s.url,!0),N.timeout=s.timeout;function k(){if(!N)return;const S=Za.from("getAllResponseHeaders"in N&&N.getAllResponseHeaders()),_={data:!d||d==="text"||d==="json"?N.responseText:N.response,status:N.status,statusText:N.statusText,headers:S,config:e,request:N};Dj(function(C){a(C),y()},function(C){r(C),y()},_),N=null}"onloadend"in N?N.onloadend=k:N.onreadystatechange=function(){!N||N.readyState!==4||N.status===0&&!(N.responseURL&&N.responseURL.indexOf("file:")===0)||setTimeout(k)},N.onabort=function(){N&&(r(new ft("Request aborted",ft.ECONNABORTED,e,N)),N=null)},N.onerror=function(w){const _=w&&w.message?w.message:"Network Error",L=new ft(_,ft.ERR_NETWORK,e,N);L.event=w||null,r(L),N=null},N.ontimeout=function(){let w=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const _=s.transitional||Sj;s.timeoutErrorMessage&&(w=s.timeoutErrorMessage),r(new ft(w,_.clarifyTimeoutError?ft.ETIMEDOUT:ft.ECONNABORTED,e,N)),N=null},l===void 0&&o.setContentType(null),"setRequestHeader"in N&&Te.forEach(o.toJSON(),function(w,_){N.setRequestHeader(_,w)}),Te.isUndefined(s.withCredentials)||(N.withCredentials=!!s.withCredentials),d&&d!=="json"&&(N.responseType=s.responseType),x&&([p,g]=y0(x,!0),N.addEventListener("progress",p)),u&&N.upload&&([f,b]=y0(u),N.upload.addEventListener("progress",f),N.upload.addEventListener("loadend",b)),(s.cancelToken||s.signal)&&(m=S=>{N&&(r(!S||S.type?new Lc(null,e,N):S),N.abort(),N=null)},s.cancelToken&&s.cancelToken.subscribe(m),s.signal&&(s.signal.aborted?m():s.signal.addEventListener("abort",m)));const T=n5(s.url);if(T&&ja.protocols.indexOf(T)===-1){r(new ft("Unsupported protocol "+T+":",ft.ERR_BAD_REQUEST,e));return}N.send(l||null)})},u5=(e,n)=>{const{length:a}=e=e?e.filter(Boolean):[];if(n||a){let r=new AbortController,s;const l=function(x){if(!s){s=!0,d();const m=x instanceof Error?x:this.reason;r.abort(m instanceof ft?m:new Lc(m instanceof Error?m.message:m))}};let o=n&&setTimeout(()=>{o=null,l(new ft(`timeout ${n} of ms exceeded`,ft.ETIMEDOUT))},n);const d=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(x=>{x.unsubscribe?x.unsubscribe(l):x.removeEventListener("abort",l)}),e=null)};e.forEach(x=>x.addEventListener("abort",l));const{signal:u}=r;return u.unsubscribe=()=>Te.asap(d),u}},h5=function*(e,n){let a=e.byteLength;if(a<n){yield e;return}let r=0,s;for(;r<a;)s=r+n,yield e.slice(r,s),r=s},x5=async function*(e,n){for await(const a of m5(e))yield*h5(a,n)},m5=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:a,value:r}=await n.read();if(a)break;yield r}}finally{await n.cancel()}},gb=(e,n,a,r)=>{const s=x5(e,n);let l=0,o,d=u=>{o||(o=!0,r&&r(u))};return new ReadableStream({async pull(u){try{const{done:x,value:m}=await s.next();if(x){d(),u.close();return}let f=m.byteLength;if(a){let p=l+=f;a(p)}u.enqueue(new Uint8Array(m))}catch(x){throw d(x),x}},cancel(u){return d(u),s.return()}},{highWaterMark:2})},yb=64*1024,{isFunction:Uh}=Te,f5=(({Request:e,Response:n})=>({Request:e,Response:n}))(Te.global),{ReadableStream:vb,TextEncoder:bb}=Te.global,Nb=(e,...n)=>{try{return!!e(...n)}catch{return!1}},p5=e=>{e=Te.merge.call({skipUndefined:!0},f5,e);const{fetch:n,Request:a,Response:r}=e,s=n?Uh(n):typeof fetch=="function",l=Uh(a),o=Uh(r);if(!s)return!1;const d=s&&Uh(vb),u=s&&(typeof bb=="function"?(g=>y=>g.encode(y))(new bb):async g=>new Uint8Array(await new a(g).arrayBuffer())),x=l&&d&&Nb(()=>{let g=!1;const y=new a(ja.origin,{body:new vb,method:"POST",get duplex(){return g=!0,"half"}}).headers.has("Content-Type");return g&&!y}),m=o&&d&&Nb(()=>Te.isReadableStream(new r("").body)),f={stream:m&&(g=>g.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(g=>{!f[g]&&(f[g]=(y,N)=>{let k=y&&y[g];if(k)return k.call(y);throw new ft(`Response type '${g}' is not supported`,ft.ERR_NOT_SUPPORT,N)})});const p=async g=>{if(g==null)return 0;if(Te.isBlob(g))return g.size;if(Te.isSpecCompliantForm(g))return(await new a(ja.origin,{method:"POST",body:g}).arrayBuffer()).byteLength;if(Te.isArrayBufferView(g)||Te.isArrayBuffer(g))return g.byteLength;if(Te.isURLSearchParams(g)&&(g=g+""),Te.isString(g))return(await u(g)).byteLength},b=async(g,y)=>{const N=Te.toFiniteNumber(g.getContentLength());return N??p(y)};return async g=>{let{url:y,method:N,data:k,signal:T,cancelToken:S,timeout:w,onDownloadProgress:_,onUploadProgress:L,responseType:C,headers:P,withCredentials:F="same-origin",fetchOptions:H}=Fj(g),O=n||fetch;C=C?(C+"").toLowerCase():"text";let B=u5([T,S&&S.toAbortSignal()],w),W=null;const ee=B&&B.unsubscribe&&(()=>{B.unsubscribe()});let q;try{if(L&&x&&N!=="get"&&N!=="head"&&(q=await b(P,k))!==0){let K=new a(y,{method:"POST",body:k,duplex:"half"}),A;if(Te.isFormData(k)&&(A=K.headers.get("content-type"))&&P.setContentType(A),K.body){const[M,I]=mb(q,y0(fb(L)));k=gb(K.body,yb,M,I)}}Te.isString(F)||(F=F?"include":"omit");const fe=l&&"credentials"in a.prototype,ne={...H,signal:B,method:N.toUpperCase(),headers:P.normalize().toJSON(),body:k,duplex:"half",credentials:fe?F:void 0};W=l&&new a(y,ne);let Y=await(l?O(W,H):O(y,ne));const X=m&&(C==="stream"||C==="response");if(m&&(_||X&&ee)){const K={};["status","statusText","headers"].forEach(V=>{K[V]=Y[V]});const A=Te.toFiniteNumber(Y.headers.get("content-length")),[M,I]=_&&mb(A,y0(fb(_),!0))||[];Y=new r(gb(Y.body,yb,M,()=>{I&&I(),ee&&ee()}),K)}C=C||"text";let xe=await f[Te.findKey(f,C)||"text"](Y,g);return!X&&ee&&ee(),await new Promise((K,A)=>{Dj(K,A,{data:xe,headers:Za.from(Y.headers),status:Y.status,statusText:Y.statusText,config:g,request:W})})}catch(fe){throw ee&&ee(),fe&&fe.name==="TypeError"&&/Load failed|fetch/i.test(fe.message)?Object.assign(new ft("Network Error",ft.ERR_NETWORK,g,W),{cause:fe.cause||fe}):ft.from(fe,fe&&fe.code,g,W)}}},g5=new Map,Lj=e=>{let n=e&&e.env||{};const{fetch:a,Request:r,Response:s}=n,l=[r,s,a];let o=l.length,d=o,u,x,m=g5;for(;d--;)u=l[d],x=m.get(u),x===void 0&&m.set(u,x=d?new Map:p5(n)),m=x;return x};Lj();const lg={http:PE,xhr:d5,fetch:{get:Lj}};Te.forEach(lg,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const jb=e=>`- ${e}`,y5=e=>Te.isFunction(e)||e===null||e===!1;function v5(e,n){e=Te.isArray(e)?e:[e];const{length:a}=e;let r,s;const l={};for(let o=0;o<a;o++){r=e[o];let d;if(s=r,!y5(r)&&(s=lg[(d=String(r)).toLowerCase()],s===void 0))throw new ft(`Unknown adapter '${d}'`);if(s&&(Te.isFunction(s)||(s=s.get(n))))break;l[d||"#"+o]=s}if(!s){const o=Object.entries(l).map(([u,x])=>`adapter ${u} `+(x===!1?"is not supported by the environment":"is not available in the build"));let d=a?o.length>1?`since :
`+o.map(jb).join(`
`):" "+jb(o[0]):"as no adapter specified";throw new ft("There is no suitable adapter to dispatch the request "+d,"ERR_NOT_SUPPORT")}return s}const Pj={getAdapter:v5,adapters:lg};function nf(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Lc(null,e)}function wb(e){return nf(e),e.headers=Za.from(e.headers),e.data=tf.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Pj.getAdapter(e.adapter||Nu.adapter,e)(e).then(function(r){return nf(e),r.data=tf.call(e,e.transformResponse,r),r.headers=Za.from(r.headers),r},function(r){return Ej(r)||(nf(e),r&&r.response&&(r.response.data=tf.call(e,e.transformResponse,r.response),r.response.headers=Za.from(r.response.headers))),Promise.reject(r)})}const Ij="1.13.2",Z0={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{Z0[e]=function(r){return typeof r===e||"a"+(n<1?"n ":" ")+e}});const kb={};Z0.transitional=function(n,a,r){function s(l,o){return"[Axios v"+Ij+"] Transitional option '"+l+"'"+o+(r?". "+r:"")}return(l,o,d)=>{if(n===!1)throw new ft(s(o," has been removed"+(a?" in "+a:"")),ft.ERR_DEPRECATED);return a&&!kb[o]&&(kb[o]=!0,console.warn(s(o," has been deprecated since v"+a+" and will be removed in the near future"))),n?n(l,o,d):!0}};Z0.spelling=function(n){return(a,r)=>(console.warn(`${r} is likely a misspelling of ${n}`),!0)};function b5(e,n,a){if(typeof e!="object")throw new ft("options must be an object",ft.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let s=r.length;for(;s-- >0;){const l=r[s],o=n[l];if(o){const d=e[l],u=d===void 0||o(d,l,e);if(u!==!0)throw new ft("option "+l+" must be "+u,ft.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new ft("Unknown option "+l,ft.ERR_BAD_OPTION)}}const c0={assertOptions:b5,validators:Z0},ds=c0.validators;let Yl=class{constructor(n){this.defaults=n||{},this.interceptors={request:new hb,response:new hb}}async request(n,a){try{return await this._request(n,a)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const l=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?l&&!String(r.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+l):r.stack=l}catch{}}throw r}}_request(n,a){typeof n=="string"?(a=a||{},a.url=n):a=n||{},a=so(this.defaults,a);const{transitional:r,paramsSerializer:s,headers:l}=a;r!==void 0&&c0.assertOptions(r,{silentJSONParsing:ds.transitional(ds.boolean),forcedJSONParsing:ds.transitional(ds.boolean),clarifyTimeoutError:ds.transitional(ds.boolean)},!1),s!=null&&(Te.isFunction(s)?a.paramsSerializer={serialize:s}:c0.assertOptions(s,{encode:ds.function,serialize:ds.function},!0)),a.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?a.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:a.allowAbsoluteUrls=!0),c0.assertOptions(a,{baseUrl:ds.spelling("baseURL"),withXsrfToken:ds.spelling("withXSRFToken")},!0),a.method=(a.method||this.defaults.method||"get").toLowerCase();let o=l&&Te.merge(l.common,l[a.method]);l&&Te.forEach(["delete","get","head","post","put","patch","common"],g=>{delete l[g]}),a.headers=Za.concat(o,l);const d=[];let u=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(a)===!1||(u=u&&y.synchronous,d.unshift(y.fulfilled,y.rejected))});const x=[];this.interceptors.response.forEach(function(y){x.push(y.fulfilled,y.rejected)});let m,f=0,p;if(!u){const g=[wb.bind(this),void 0];for(g.unshift(...d),g.push(...x),p=g.length,m=Promise.resolve(a);f<p;)m=m.then(g[f++],g[f++]);return m}p=d.length;let b=a;for(;f<p;){const g=d[f++],y=d[f++];try{b=g(b)}catch(N){y.call(this,N);break}}try{m=wb.call(this,b)}catch(g){return Promise.reject(g)}for(f=0,p=x.length;f<p;)m=m.then(x[f++],x[f++]);return m}getUri(n){n=so(this.defaults,n);const a=Aj(n.baseURL,n.url,n.allowAbsoluteUrls);return Cj(a,n.params,n.paramsSerializer)}};Te.forEach(["delete","get","head","options"],function(n){Yl.prototype[n]=function(a,r){return this.request(so(r||{},{method:n,url:a,data:(r||{}).data}))}});Te.forEach(["post","put","patch"],function(n){function a(r){return function(l,o,d){return this.request(so(d||{},{method:n,headers:r?{"Content-Type":"multipart/form-data"}:{},url:l,data:o}))}}Yl.prototype[n]=a(),Yl.prototype[n+"Form"]=a(!0)});let N5=class Oj{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(l){a=l});const r=this;this.promise.then(s=>{if(!r._listeners)return;let l=r._listeners.length;for(;l-- >0;)r._listeners[l](s);r._listeners=null}),this.promise.then=s=>{let l;const o=new Promise(d=>{r.subscribe(d),l=d}).then(s);return o.cancel=function(){r.unsubscribe(l)},o},n(function(l,o,d){r.reason||(r.reason=new Lc(l,o,d),a(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const a=this._listeners.indexOf(n);a!==-1&&this._listeners.splice(a,1)}toAbortSignal(){const n=new AbortController,a=r=>{n.abort(r)};return this.subscribe(a),n.signal.unsubscribe=()=>this.unsubscribe(a),n.signal}static source(){let n;return{token:new Oj(function(s){n=s}),cancel:n}}};function j5(e){return function(a){return e.apply(null,a)}}function w5(e){return Te.isObject(e)&&e.isAxiosError===!0}const up={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(up).forEach(([e,n])=>{up[n]=e});function Mj(e){const n=new Yl(e),a=mj(Yl.prototype.request,n);return Te.extend(a,Yl.prototype,n,{allOwnKeys:!0}),Te.extend(a,n,null,{allOwnKeys:!0}),a.create=function(s){return Mj(so(e,s))},a}const Zt=Mj(Nu);Zt.Axios=Yl;Zt.CanceledError=Lc;Zt.CancelToken=N5;Zt.isCancel=Ej;Zt.VERSION=Ij;Zt.toFormData=J0;Zt.AxiosError=ft;Zt.Cancel=Zt.CanceledError;Zt.all=function(n){return Promise.all(n)};Zt.spread=j5;Zt.isAxiosError=w5;Zt.mergeConfig=so;Zt.AxiosHeaders=Za;Zt.formToJSON=e=>_j(Te.isHTMLForm(e)?new FormData(e):e);Zt.getAdapter=Pj.getAdapter;Zt.HttpStatusCode=up;Zt.default=Zt;const{Axios:bU,AxiosError:NU,CanceledError:jU,isCancel:wU,CancelToken:kU,VERSION:TU,all:CU,Cancel:SU,isAxiosError:_U,spread:EU,toFormData:DU,AxiosHeaders:AU,HttpStatusCode:FU,formToJSON:LU,getAdapter:PU,mergeConfig:IU}=Zt,k5="tinh_luong_auth",ea=Zt.create({baseURL:"/api/rbac",headers:{"Content-Type":"application/json"}});ea.interceptors.request.use(e=>{const n=localStorage.getItem(k5);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const af={dangNhap:(e,n)=>ea.post("/dang-nhap",{tenDangNhap:e,matKhau:n}).then(a=>a.data),dangXuat:e=>ea.post("/dang-xuat",null,{headers:{Authorization:`Bearer ${e}`}}).then(n=>n.data),kiemTraToken:e=>ea.get("/kiem-tra-token",{headers:{Authorization:`Bearer ${e}`}}).then(n=>n.data)},rf={layTatCa:()=>ea.get("/nguoi-dung").then(e=>e.data),layTheoId:e=>ea.get(`/nguoi-dung/${e}`).then(n=>n.data),taoMoi:e=>ea.post("/nguoi-dung",e).then(n=>n.data),capNhat:(e,n)=>ea.put(`/nguoi-dung/${e}`,n).then(a=>a.data),doiMatKhau:(e,n,a)=>ea.put(`/nguoi-dung/${e}/doi-mat-khau`,{matKhauCu:n,matKhauMoi:a}).then(r=>r.data)},Tb={layTatCa:()=>ea.get("/vai-tro").then(e=>e.data),layTheoId:e=>ea.get(`/vai-tro/${e}`).then(n=>n.data),taoMoi:e=>ea.post("/vai-tro",e).then(n=>n.data),capNhat:(e,n)=>ea.put(`/vai-tro/${e}`,n).then(a=>a.data),ganVaiTro:(e,n)=>ea.post("/vai-tro/gan",{nguoiDungId:e,vaiTroId:n}).then(a=>a.data),goVaiTro:(e,n)=>ea.delete("/vai-tro/go",{data:{nguoiDungId:e,vaiTroId:n}}).then(a=>a.data)},T5={layDanhSach:e=>ea.get("/audit-log",{params:e}).then(n=>n.data),layTheoNguoiDung:e=>ea.get(`/audit-log/nguoi-dung/${e}`).then(n=>n.data),layTheoBanGhi:(e,n)=>ea.get(`/audit-log/ban-ghi/${e}/${n}`).then(a=>a.data)},Rj=E.createContext(void 0),qo="tinh_luong_auth",C5=6e4;function S5({children:e}){const[n,a]=E.useState(null),[r,s]=E.useState(null),[l,o]=E.useState([]),[d,u]=E.useState([]),[x,m]=E.useState(!0),f=E.useCallback(()=>{localStorage.removeItem(qo),s(null),a(null),o([]),u([])},[]),p=E.useCallback(()=>{const T=localStorage.getItem(qo);if(T)try{const S=JSON.parse(T),w=new Date(S.hetHan),_=new Date;if(w<=_)return f(),window.location.href="/dang-nhap?expired=1",!1;const L=w.getTime()-_.getTime();return L<600*1e3&&L>0&&console.warn("Token sp ht hn trong",Math.floor(L/6e4),"pht"),!0}catch{return f(),!1}return!1},[f]);E.useEffect(()=>{const T=localStorage.getItem(qo);if(T)try{const S=JSON.parse(T);new Date(S.hetHan)>new Date?(s(S.token),a(S.user),o(S.vaiTros),u(S.quyens)):localStorage.removeItem(qo)}catch{localStorage.removeItem(qo)}m(!1)},[]),E.useEffect(()=>{if(r){const T=setInterval(p,C5);return()=>clearInterval(T)}},[r,p]);const b=async(T,S)=>{const w=await af.dangNhap(T,S),_={token:w.token,user:w.nguoiDung,vaiTros:w.vaiTros,quyens:w.quyens,hetHan:w.hetHan};localStorage.setItem(qo,JSON.stringify(_)),s(w.token),a(w.nguoiDung),o(w.vaiTros),u(w.quyens)},g=async()=>{if(r)try{await af.dangXuat(r)}catch{}f()},y=async()=>{if(r)try{(await af.kiemTraToken(r)).hieu_luc||(f(),window.location.href="/dang-nhap?expired=1")}catch{f()}},N=T=>d.includes(T)||l.includes("ADMIN"),k=T=>l.includes(T);return t.jsx(Rj.Provider,{value:{user:n,token:r,vaiTros:l,quyens:d,isAuthenticated:!!n,isLoading:x,dangNhap:b,dangXuat:g,coQuyen:N,coVaiTro:k,refreshToken:y},children:e})}function as(){const e=E.useContext(Rj);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}function Et({children:e,quyen:n}){const{isAuthenticated:a,isLoading:r,coQuyen:s}=as();return r?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):a?n&&!s(n)?t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[t.jsx("h3",{className:"text-lg font-medium text-red-800",children:"Khng c quyn truy cp"}),t.jsx("p",{className:"text-red-600 mt-2",children:"Bn khng c quyn truy cp trang ny."})]}):t.jsx(t.Fragment,{children:e}):(window.location.href="/dang-nhap",null)}const sf=8,_5="payroll_favorites_";function Bj(){const{user:e,coQuyen:n,coVaiTro:a}=as(),[r,s]=E.useState([]),l=e?`${_5}${e.id}`:null;E.useEffect(()=>{if(l){const f=localStorage.getItem(l);if(f)try{const p=JSON.parse(f);Array.isArray(p)&&s(p)}catch{}}},[l]);const o=E.useCallback(f=>{l&&localStorage.setItem(l,JSON.stringify(f))},[l]),d=E.useCallback(f=>{s(p=>{let b;if(p.includes(f))b=p.filter(g=>g!==f);else{if(p.length>=sf)return p;b=[...p,f]}return o(b),b})},[o]),u=E.useCallback(f=>r.includes(f),[r]),x=r.length>=sf,m=E.useCallback(f=>!f||f.length===0||a("ADMIN")?!0:f.some(p=>n(p)||a(p)),[n,a]);return{favorites:r,toggleFavorite:d,isFavorite:u,isFull:x,maxFavorites:sf,filterByPermission:m}}const hp=[{id:"tong-quan",title:"Tng quan",collapsible:!1,items:[{id:"trang-chu",label:"Trang ch",icon:W0,path:"/",tags:["dashboard","home","tng quan"]},{id:"cong-nhan-vien",label:"Cng nhn vin",icon:i0,path:"/portal",tags:["portal","employee","self-service","mobile","pwa"],badge:"Mi"}]},{id:"ky-luong",title:"K lng",collapsible:!0,color:"blue",items:[{id:"bang-luong",label:"Bng lng",icon:Ys,path:"/bang-luong",requiredPermissions:["BANG_LUONG_VIEW"],tags:["payroll","salary sheet","bng tnh"]}]},{id:"ung-luong",title:"ng lng",collapsible:!0,color:"purple",items:[{id:"bang-ung-luong",label:"Bng ng lng",icon:ng,path:"/ung-luong",requiredPermissions:["UNG_LUONG_VIEW"],tags:["advance","tm ng"]}]},{id:"bao-cao",title:"Bo co & S lng",collapsible:!0,color:"green",items:[{id:"so-luong-nhan-vien",label:"S lng nhn vin",icon:x_,path:"/so-luong/nhan-vien",requiredPermissions:["SO_LUONG_VIEW"],tags:["employee salary book","s lng"]},{id:"so-luong-phong-ban",label:"S lng phng ban",icon:rj,path:"/so-luong/phong-ban",requiredPermissions:["SO_LUONG_VIEW"],tags:["department salary","bo co phng ban"]}]},{id:"tinh-luong",title:"Tnh lng",collapsible:!0,color:"orange",items:[{id:"khoan-luong",label:"Khon lng",icon:B_,path:"/khoan-luong",requiredPermissions:["KHOAN_LUONG_VIEW"],tags:["salary component","thnh phn lng"]},{id:"quy-che",label:"Quy ch lng",icon:V_,path:"/quy-che",requiredPermissions:["QUY_CHE_VIEW"],tags:["rule","engine","cng thc","quy tc"]},{id:"su-kien",label:"S kin thng/pht",icon:ag,path:"/su-kien",requiredPermissions:["SU_KIEN_VIEW"],tags:["bonus","penalty","thng","pht"]}]},{id:"du-lieu-dau-vao",title:"D liu u vo",collapsible:!0,color:"slate",items:[{id:"nhan-vien",label:"Nhn vin",icon:W_,path:"/nhan-vien",requiredPermissions:["NHAN_VIEN_VIEW"],tags:["employee","staff","nhn s"]},{id:"phong-ban",label:"Phng ban",icon:oj,path:"/phong-ban",requiredPermissions:["PHONG_BAN_VIEW"],tags:["department","t chc"]},{id:"nhom-nhan-vien",label:"Nhm nhn vin",icon:f0,path:"/nhom-nhan-vien",requiredPermissions:["NHOM_NV_VIEW"],tags:["group","team"]},{id:"cham-cong",label:"Chm cng",icon:an,path:"/cham-cong",requiredPermissions:["CHAM_CONG_VIEW"],tags:["attendance","timesheet","gi lm"]},{id:"xep-ca",label:"Xp ca",icon:At,requiredPermissions:["PHAN_CA_VIEW"],tags:["scheduling","shift","ca lm vic"],badge:"Mi",children:[{id:"danh-muc-ca",label:"Danh mc ca",icon:uj,path:"/xep-ca/danh-muc-ca",tags:["shift","ca"]},{id:"lich-phan-ca",label:"Lch phn ca",icon:sb,path:"/xep-ca/lich-phan-ca",tags:["schedule","calendar","lch"]}]},{id:"nghi-phep",label:"Ngh php",icon:g_,requiredPermissions:["NGHI_PHEP_VIEW"],tags:["leave","off","ngh"],children:[{id:"don-cua-toi",label:"n ngh ca ti",icon:ha,path:"/nghi-phep/don-cua-toi",tags:["my leave","n ca ti"]},{id:"duyet-nghi-phep",label:"Duyt ngh php",icon:ua,path:"/nghi-phep/duyet",requiredPermissions:["NGHI_PHEP_DUYET"],tags:["approve","duyt"]},{id:"lich-nghi",label:"Lch ngh php",icon:sb,path:"/nghi-phep/lich",tags:["calendar","lch"]},{id:"loai-nghi",label:"Danh mc loi ngh",icon:A_,path:"/nghi-phep/loai-nghi",requiredPermissions:["ADMIN"],tags:["category","loi"]}]},{id:"yeu-cau",label:"Yu cu",icon:b_,requiredPermissions:["YEU_CAU_VIEW"],tags:["request","OT","tr gi","v sm","cng tc"],badge:"Mi",children:[{id:"don-yeu-cau-cua-toi",label:"n ca ti",icon:gu,path:"/yeu-cau/don-cua-toi",tags:["my request","n ca ti"]},{id:"duyet-yeu-cau",label:"Duyt yu cu",icon:ua,path:"/yeu-cau/duyet",requiredPermissions:["YEU_CAU_DUYET_CAP_1","YEU_CAU_DUYET_CAP_2"],tags:["approve","duyt"]}]},{id:"kpi",label:"KPI",icon:$_,requiredPermissions:["KPI_VIEW"],tags:["performance","nh gi","hiu sut"],children:[{id:"kpi-template",label:"Template KPI",icon:N_,path:"/kpi/template",tags:["template","mu"]},{id:"kpi-ky-danh-gia",label:"K nh gi",icon:aj,path:"/kpi/ky-danh-gia",tags:["period","k"]},{id:"kpi-cau-hinh-thuong",label:"Cu hnh thng",icon:Pr,path:"/kpi/cau-hinh-thuong",tags:["bonus","thng"]}]},{id:"san-luong",label:"Sn lng",icon:f_,requiredPermissions:["SAN_LUONG_VIEW"],tags:["output","production"],children:[{id:"tra-cuu-san-luong",label:"Tra cu sn lng",icon:Hr,path:"/san-luong",tags:["tra cu","search","xem"]},{id:"import-chia-hang",label:"Chia hng",icon:Jp,path:"/import-chia-hang",tags:["sorting","phn loi"]},{id:"import-giao-hang",label:"Giao hng",icon:eg,path:"/import-giao-hang",tags:["delivery","vn chuyn"]},{id:"lich-su-import",label:"Lch s Import",icon:pu,path:"/lich-su-import",tags:["history","lch s"]}]},{id:"import-excel",label:"Import Excel",icon:Wp,path:"/import-excel",requiredPermissions:["IMPORT_EXCEL"],tags:["import","upload","excel"]}]},{id:"thiet-lap",title:"Thit lp h thng",collapsible:!0,color:"cyan",items:[{id:"cai-dat",label:"Ci t h thng",icon:Zs,path:"/cai-dat",requiredPermissions:["ADMIN"],tags:["settings","configuration","cu hnh"]}]},{id:"quan-tri",title:"Qun tr",collapsible:!0,color:"red",items:[{id:"nguoi-dung",label:"Ngi dng",icon:q_,path:"/quan-tri/nguoi-dung",requiredPermissions:["ADMIN"],tags:["user","account","ti khon"]},{id:"audit-log",label:"Nht k h thng",icon:U_,path:"/quan-tri/audit-log",requiredPermissions:["ADMIN"],tags:["log","history","nht k"]}]}];function Hj(e){const n=[];for(const a of e)for(const r of a.items)n.push(r),r.children&&n.push(...r.children);return n}function E5({isOpen:e,isCollapsed:n,onToggleCollapse:a}){var W;const r=_s(),{coQuyen:s,coVaiTro:l,user:o,dangXuat:d}=as(),{favorites:u,toggleFavorite:x,isFavorite:m,isFull:f}=Bj(),[p,b]=E.useState(["trang-chu","ky-luong","ung-luong"]),[g,y]=E.useState([]),[N,k]=E.useState(""),T=E.useCallback(ee=>!ee||ee.length===0||l("ADMIN")?!0:ee.some(q=>s(q)||l(q)),[s,l]),S=E.useCallback(ee=>ee.filter(q=>T(q.requiredPermissions)).map(q=>({...q,children:q.children?S(q.children):void 0})).filter(q=>!q.children||q.children.length>0),[T]),w=E.useCallback((ee,q)=>{var Y;const fe=q.toLowerCase(),ne=[];for(const X of ee){const xe=X.label.toLowerCase().includes(fe),K=(Y=X.tags)==null?void 0:Y.some(M=>M.toLowerCase().includes(fe)),A=X.children?w(X.children,q):[];(xe||K||A.length>0)&&ne.push({...X,children:A.length>0?A:X.children})}return ne},[]),_=E.useMemo(()=>{let ee=hp.map(q=>({...q,items:S(q.items)})).filter(q=>q.items.length>0);return N&&(ee=ee.map(q=>({...q,items:w(q.items,N)})).filter(q=>q.items.length>0)),ee},[S,w,N]),L=E.useMemo(()=>{if(u.length===0)return null;const ee=Hj(hp),q=u.map(fe=>ee.find(ne=>ne.id===fe)).filter(fe=>!!fe&&T(fe.requiredPermissions));return q.length===0?null:{id:"favorites",title:"Yu thch",items:q}},[u,T]),C=ee=>{b(q=>q.includes(ee)?q.filter(fe=>fe!==ee):[...q,ee])},P=ee=>{y(q=>q.includes(ee)?q.filter(fe=>fe!==ee):[...q,ee])},F=(ee,q)=>{ee.preventDefault(),ee.stopPropagation(),m(q.id)?(x(q.id),ie.success(` b "${q.label}" khi yu thch`)):f?ie.error("Ch c th ghim ti a 8 mc yu thch"):(x(q.id),ie.success(` thm "${q.label}" vo yu thch`))},H=ee=>ee.path==="/"?r.pathname==="/":ee.path&&r.pathname.startsWith(ee.path),O=(ee,q=0)=>{var M;const fe=ee.icon,ne=ee.children&&ee.children.length>0,Y=g.includes(ee.id),X=H(ee),xe=m(ee.id),K=t.jsxs(t.Fragment,{children:[t.jsx("div",{className:`
          flex items-center justify-center w-9 h-9 rounded-xl transition-all
          ${X?"bg-accent/20":"bg-transparent"}
        `,children:t.jsx(fe,{size:q>0?16:18,className:X?"text-accent":"text-sidebar-muted",strokeWidth:X?2.5:2})}),!n&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:`
              flex-1 truncate text-sm transition-colors
              ${X?"text-white font-medium":"text-sidebar-muted"}
            `,children:ee.label}),ee.path&&t.jsx("button",{onClick:I=>F(I,ee),className:`
                  p-1.5 rounded-lg opacity-0 group-hover:opacity-100 transition-all
                  ${xe?"opacity-100 text-yellow-400":"text-sidebar-muted hover:text-yellow-400"}
                  hover:bg-white/5
                `,title:xe?"B yu thch":"Thm vo yu thch",children:t.jsx(g0,{size:14,fill:xe?"currentColor":"none"})}),ne&&t.jsx(Ar,{size:16,className:`text-sidebar-muted transition-transform ${Y?"rotate-180":""}`})]})]}),A=`
      group flex items-center gap-3 px-2 py-1.5 mx-2 rounded-xl transition-all duration-200
      ${X?"bg-white/5 border border-accent/50 text-white":"hover:bg-white/5 border border-transparent"}
      ${q>0?"ml-4":""}
    `;return ne?t.jsxs("div",{children:[t.jsx("button",{onClick:()=>P(ee.id),className:A,style:{width:"calc(100% - 16px)"},title:n?ee.label:void 0,children:K}),Y&&!n&&t.jsx("div",{className:"mt-1 space-y-0.5 ml-4 border-l border-white/10 pl-2",children:(M=ee.children)==null?void 0:M.map(I=>O(I,q+1))})]},ee.id):t.jsx(ca,{to:ee.path||"#",className:A,title:n?ee.label:void 0,children:K},ee.id)},B=(ee,q)=>{const fe=p.includes(ee.id);return t.jsxs("div",{className:"mb-2",children:[!n&&t.jsxs("button",{onClick:()=>C(ee.id),className:`
              w-full flex items-center justify-between px-4 py-2 
              text-[11px] font-semibold uppercase tracking-wider text-sidebar-muted
              hover:text-white/80 transition-colors
            `,children:[t.jsxs("span",{className:"flex items-center gap-2",children:[q&&t.jsx(g0,{size:12,className:"text-yellow-400",fill:"currentColor"}),ee.title]}),t.jsx($n,{size:12,className:`transition-transform ${fe?"rotate-90":""}`})]}),(fe||n)&&t.jsx("div",{className:"space-y-0.5",children:ee.items.map(ne=>O(ne,0))})]},ee.id)};return e?t.jsxs("aside",{className:`
        fixed left-0 top-0 bottom-0 z-50
        flex flex-col
        transition-all duration-300 ease-out
        ${n?"w-[72px]":"w-[260px]"}
      `,style:{background:"linear-gradient(180deg, #0B1220 0%, #0F1B2E 100%)",borderRadius:"0 32px 32px 0",margin:"12px 0 12px 12px",height:"calc(100vh - 24px)",boxShadow:"0 0 40px rgba(0, 0, 0, 0.3)"},children:[t.jsxs("div",{className:`
        flex items-center gap-3 px-5 py-6 border-b border-white/5
        ${n?"justify-center":""}
      `,children:[t.jsx("div",{className:`
          w-10 h-10 rounded-xl bg-gradient-to-br from-accent to-accent2 
          flex items-center justify-center shadow-glow-accent
        `,children:t.jsx(ag,{size:22,className:"text-sidebar-solid",strokeWidth:2.5})}),!n&&t.jsxs("div",{children:[t.jsx("h1",{className:"text-white font-bold text-lg tracking-tight",children:"Payroll"}),t.jsx("p",{className:"text-sidebar-muted text-xs",children:"H thng lng"})]})]}),!n&&t.jsx("div",{className:"px-4 py-3",children:t.jsxs("div",{className:"relative",children:[t.jsx(Hr,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-sidebar-muted"}),t.jsx("input",{type:"text",value:N,onChange:ee=>k(ee.target.value),placeholder:"Tm nhanh (Ctrl+K)",className:`
                w-full pl-9 pr-8 py-2.5 text-sm rounded-xl
                bg-white/5 border border-white/10
                text-white placeholder:text-sidebar-muted
                focus:outline-none focus:ring-2 focus:ring-accent/50 focus:border-accent/50
                transition-all
              `}),N&&t.jsx("button",{onClick:()=>k(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-sidebar-muted hover:text-white",children:t.jsx(mn,{size:16})})]})}),t.jsxs("nav",{className:"flex-1 py-2 overflow-y-auto overflow-x-hidden scrollbar-thin",children:[L&&!N&&B(L,!0),L&&!N&&t.jsx("div",{className:"my-3 mx-4 border-t border-white/5"}),_.map(ee=>B(ee)),N&&_.length===0&&t.jsxs("div",{className:"px-4 py-8 text-center text-sidebar-muted text-sm",children:['Khng tm thy "',N,'"']})]}),t.jsxs("div",{className:"border-t border-white/5 p-3",children:[t.jsxs("div",{className:`flex items-center gap-2 ${n?"flex-col":""}`,children:[t.jsxs(ca,{to:"/ho-so",className:`
              flex items-center gap-3 flex-1 p-2 rounded-xl
              hover:bg-white/5 transition-all group
            `,title:n?(o==null?void 0:o.hoTen)||"H s":void 0,children:[t.jsx("div",{className:`
              w-9 h-9 rounded-xl bg-gradient-to-br from-purple-500 to-pink-500
              flex items-center justify-center text-white font-semibold text-sm
            `,children:((W=o==null?void 0:o.hoTen)==null?void 0:W.charAt(0))||"U"}),!n&&t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-white text-sm font-medium truncate",children:(o==null?void 0:o.hoTen)||"Ngi dng"}),t.jsx("p",{className:"text-sidebar-muted text-xs truncate",children:(o==null?void 0:o.email)||(o==null?void 0:o.tenDangNhap)})]})]}),t.jsxs("div",{className:`flex gap-1 ${n?"flex-col":""}`,children:[t.jsx(ca,{to:"/cai-dat",className:`
                p-2.5 rounded-xl text-sidebar-muted hover:text-white hover:bg-white/5
                transition-all
              `,title:"Ci t",children:t.jsx(Zs,{size:18})}),t.jsx("button",{onClick:d,className:`
                p-2.5 rounded-xl text-sidebar-muted hover:text-red-400 hover:bg-red-500/10
                transition-all
              `,title:"ng xut",children:t.jsx(Qp,{size:18})})]})]}),t.jsx("button",{onClick:a,className:`
            w-full mt-3 flex items-center justify-center gap-2 py-2.5 rounded-xl
            text-sidebar-muted hover:text-white hover:bg-white/5
            transition-all text-sm
          `,children:n?t.jsx($n,{size:18}):t.jsxs(t.Fragment,{children:[t.jsx(fr,{size:18}),t.jsx("span",{children:"Thu gn"})]})})]})]}):null}const xp=[{path:"/",label:"Trang ch",group:"Tng quan",quickActions:[{id:"tao-ky-luong",label:"To k lng",icon:St,type:"route",to:"/bang-luong?action=create",requiredPermissions:["BANG_LUONG_CREATE"]},{id:"import-excel",label:"Import Excel",icon:js,type:"route",to:"/import-excel",requiredPermissions:["IMPORT_EXCEL"]}]},{path:"/nhan-vien",label:"Nhn vin",group:"D liu u vo",quickActions:[{id:"them-nhan-vien",label:"Thm nhn vin",icon:St,type:"callback",callbackKey:"OPEN_ADD_NHAN_VIEN_MODAL",requiredPermissions:["NHAN_VIEN_CREATE"]},{id:"xuat-excel-nv",label:"Xut Excel",icon:bs,type:"callback",callbackKey:"EXPORT_NHAN_VIEN_EXCEL"}]},{path:"/nhan-vien/:id",label:"Chi tit nhn vin",parent:"/nhan-vien",dynamicLabel:e=>`Nhn vin #${e.id}`},{path:"/phong-ban",label:"Phng ban",group:"D liu u vo",quickActions:[{id:"them-phong-ban",label:"Thm phng ban",icon:St,type:"callback",callbackKey:"OPEN_ADD_PHONG_BAN_MODAL",requiredPermissions:["PHONG_BAN_CREATE"]}]},{path:"/nhom-nhan-vien",label:"Nhm nhn vin",group:"D liu u vo"},{path:"/cham-cong",label:"Chm cng",group:"D liu u vo",quickActions:[{id:"import-cham-cong",label:"Import chm cng",icon:js,type:"callback",callbackKey:"IMPORT_CHAM_CONG",requiredPermissions:["CHAM_CONG_IMPORT"]},{id:"tong-hop-ngay-cong",label:"Tng hp ngy cng",icon:rb,type:"callback",callbackKey:"TONG_HOP_NGAY_CONG"}]},{path:"/nghi-phep/don-cua-toi",label:"n ngh ca ti",group:"Ngh php",quickActions:[{id:"tao-don-nghi",label:"To n ngh",icon:St,type:"callback",callbackKey:"OPEN_TAO_DON_NGHI_MODAL"}]},{path:"/nghi-phep/duyet",label:"Duyt ngh php",group:"Ngh php",requiredPermissions:["NGHI_PHEP_DUYET"]},{path:"/nghi-phep/lich",label:"Lch ngh php",group:"Ngh php"},{path:"/nghi-phep/loai-nghi",label:"Danh mc loi ngh",group:"Ngh php",requiredPermissions:["ADMIN"],quickActions:[{id:"them-loai-nghi",label:"Thm loi ngh",icon:St,type:"callback",callbackKey:"OPEN_ADD_LOAI_NGHI_MODAL",requiredPermissions:["ADMIN"]}]},{path:"/kpi/template",label:"Template KPI",group:"KPI"},{path:"/kpi/ky-danh-gia",label:"K nh gi",group:"KPI"},{path:"/kpi/cau-hinh-thuong",label:"Cu hnh thng",group:"KPI"},{path:"/import-chia-hang",label:"Chia hng",group:"Sn lng",quickActions:[{id:"import-chia-hang",label:"Import file",icon:js,type:"callback",callbackKey:"IMPORT_CHIA_HANG"}]},{path:"/import-giao-hang",label:"Giao hng",group:"Sn lng",quickActions:[{id:"import-giao-hang",label:"Import file",icon:js,type:"callback",callbackKey:"IMPORT_GIAO_HANG"}]},{path:"/lich-su-import",label:"Lch s Import",group:"Sn lng"},{path:"/import-excel",label:"Import Excel",group:"D liu u vo"},{path:"/quy-che",label:"Quy ch lng",group:"Tnh lng",quickActions:[{id:"tao-rule",label:"To rule mi",icon:St,type:"callback",callbackKey:"OPEN_TAO_RULE_MODAL",requiredPermissions:["QUY_CHE_CREATE"]},{id:"preview-rule",label:"Preview",icon:ip,type:"route",to:"/rule-trace"}]},{path:"/quy-che/:id",label:"Chi tit quy ch",parent:"/quy-che",dynamicLabel:e=>`Quy ch #${e.id}`},{path:"/khoan-luong",label:"Khon lng",group:"Tnh lng",quickActions:[{id:"them-khoan-luong",label:"Thm khon lng",icon:St,type:"callback",callbackKey:"OPEN_ADD_KHOAN_LUONG_MODAL",requiredPermissions:["KHOAN_LUONG_CREATE"]}]},{path:"/su-kien",label:"S kin thng/pht",group:"Tnh lng"},{path:"/bang-luong",label:"Bng lng",group:"K lng",quickActions:[{id:"tao-bang-luong",label:"To bng lng",icon:St,type:"callback",callbackKey:"OPEN_TAO_BANG_LUONG_MODAL",requiredPermissions:["BANG_LUONG_CREATE"]}]},{path:"/bang-luong/:id",label:"Chi tit bng lng",parent:"/bang-luong",dynamicLabel:e=>`Bng lng #${e.id}`,quickActions:[{id:"snapshot",label:"Snapshot",icon:y_,type:"callback",callbackKey:"SNAPSHOT_BANG_LUONG"},{id:"chay-rule",label:"Chy Rule",icon:ip,type:"callback",callbackKey:"RUN_RULE_ENGINE",requiredPermissions:["BANG_LUONG_TINH"]},{id:"tinh-lai",label:"Tnh li",icon:Ba,type:"callback",callbackKey:"TINH_LAI_LUONG"},{id:"chot-ky",label:"Cht k",icon:ua,type:"callback",callbackKey:"CHOT_KY_LUONG",requiredPermissions:["BANG_LUONG_CHOT"]},{id:"khoa-ky",label:"Kho k",icon:Js,type:"callback",callbackKey:"KHOA_KY_LUONG",danger:!0,confirmMessage:"Kho vnh vin k lng ny? Sau khi kho s khng th m li.",confirmKeyword:"KHOA",requiredPermissions:["BANG_LUONG_KHOA"]},{id:"mo-khoa",label:"M kho",icon:tg,type:"callback",callbackKey:"MO_KHOA_BANG_LUONG",requiredPermissions:["BANG_LUONG_KHOA"]},{id:"xuat-excel",label:"Xut Excel",icon:bs,type:"callback",callbackKey:"EXPORT_BANG_LUONG_EXCEL"},{id:"gui-phieu-luong",label:"Gi phiu lng",icon:gu,type:"callback",callbackKey:"GUI_PHIEU_LUONG_TAT_CA"}]},{path:"/ung-luong",label:"Bng ng lng",group:"ng lng",quickActions:[{id:"tao-bang-ung",label:"To bng ng",icon:St,type:"callback",callbackKey:"OPEN_TAO_BANG_UNG_MODAL",requiredPermissions:["UNG_LUONG_CREATE"]}]},{path:"/ung-luong/:id",label:"Chi tit bng ng lng",parent:"/ung-luong",dynamicLabel:e=>`Bng ng #${e.id}`,quickActions:[{id:"tinh-eligibility",label:"Tnh eligibility",icon:rb,type:"callback",callbackKey:"TINH_ELIGIBILITY_UNG_LUONG"},{id:"chot-bang-ung",label:"Cht",icon:ua,type:"callback",callbackKey:"CHOT_BANG_UNG_LUONG",requiredPermissions:["UNG_LUONG_CHOT"]},{id:"xuat-excel-ung",label:"Xut Excel",icon:bs,type:"callback",callbackKey:"EXPORT_UNG_LUONG_EXCEL"}]},{path:"/so-luong/nhan-vien",label:"S lng nhn vin",group:"Bo co",quickActions:[{id:"xuat-so-luong-nv",label:"Xut Excel",icon:bs,type:"callback",callbackKey:"EXPORT_SO_LUONG_NV"}]},{path:"/so-luong/phong-ban",label:"S lng phng ban",group:"Bo co",quickActions:[{id:"xuat-so-luong-pb",label:"Xut Excel",icon:bs,type:"callback",callbackKey:"EXPORT_SO_LUONG_PB"}]},{path:"/cai-dat",label:"Ci t h thng",group:"Thit lp",requiredPermissions:["ADMIN"]},{path:"/quan-tri/nguoi-dung",label:"Ngi dng",group:"Qun tr",requiredPermissions:["ADMIN"],quickActions:[{id:"them-nguoi-dung",label:"Thm ngi dng",icon:St,type:"callback",callbackKey:"OPEN_ADD_NGUOI_DUNG_MODAL",requiredPermissions:["ADMIN"]}]},{path:"/quan-tri/audit-log",label:"Audit Log",group:"Qun tr",requiredPermissions:["ADMIN"]},{path:"/rule-trace",label:"Rule Trace",group:"Tnh lng"}];function mp(e){const n=xp.find(a=>a.path===e);if(n)return n;for(const a of xp)if(a.path.includes(":")){const r=a.path.replace(/:[^/]+/g,"[^/]+");if(new RegExp(`^${r}$`).test(e))return a}}function D5(e,n){const a={},r=n.split("/"),s=e.split("/");for(let l=0;l<r.length;l++)if(r[l].startsWith(":")){const o=r[l].slice(1);a[o]=s[l]}return a}function A5(){const e=_s(),n=E.useMemo(()=>{const a=[];e.pathname!=="/"&&a.push({label:"Trang ch",path:"/"});const r=mp(e.pathname);if(!r)return a;if(r.group&&r.group!=="Tng quan"&&a.push({label:r.group}),r.parent){const l=mp(r.parent);l&&a.push({label:l.label,path:l.path})}let s=r.label;if(r.dynamicLabel&&r.path.includes(":")){const l=D5(e.pathname,r.path);s=r.dynamicLabel(l)}return a.push({label:s}),a},[e.pathname]);return n.length<=1&&e.pathname==="/"?null:t.jsx("nav",{className:"flex items-center gap-1",children:n.map((a,r)=>{const s=r===n.length-1,l=r===0;return t.jsxs("div",{className:"flex items-center",children:[r>0&&t.jsx($n,{size:14,className:"mx-1.5 text-text-muted"}),a.path&&!s?t.jsxs(ca,{to:a.path,className:`
                  flex items-center gap-1.5 px-2 py-1 rounded-lg
                  text-text-secondary text-sm
                  hover:text-text hover:bg-panel
                  transition-all
                `,children:[l&&t.jsx(W0,{size:14}),t.jsx("span",{children:a.label})]}):t.jsx("span",{className:`
                  px-2 py-1 rounded-lg text-sm
                  ${s?"text-text font-medium bg-panel border border-border":"text-text-muted"}
                  max-w-[200px] truncate
                `,title:a.label,children:a.label})]},r)})})}const F5=[{id:1,type:"success",title:"Bng lng  tnh xong",message:"Bng lng thng 01/2026  c tnh ton thnh cng",time:"5 pht trc",read:!1},{id:2,type:"warning",title:"Cn duyt ng lng",message:"C 3 yu cu ng lng ch duyt",time:"1 gi trc",read:!1},{id:3,type:"info",title:"Import sn lng",message:"File chia hng thng 01  c import",time:"2 gi trc",read:!0}];function L5({sidebarCollapsed:e}){const[n,a]=E.useState(!1),[r,s]=E.useState(F5),l=E.useRef(null),o=r.filter(p=>!p.read).length;E.useEffect(()=>{const p=b=>{l.current&&!l.current.contains(b.target)&&a(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]);const d=p=>{s(b=>b.map(g=>g.id===p?{...g,read:!0}:g))},u=()=>{s(p=>p.map(b=>({...b,read:!0})))},x=()=>{s([])},m=p=>{switch(p){case"success":return t.jsx(ij,{size:16,className:"text-green-500"});case"warning":return t.jsx(aa,{size:16,className:"text-amber-500"});default:return t.jsx(cj,{size:16,className:"text-blue-500"})}},f=()=>{window.dispatchEvent(new CustomEvent("open-command-palette"))};return t.jsxs("header",{className:`
        fixed top-0 right-0 z-40
        h-16 flex items-center justify-between gap-4
        px-6 transition-all duration-300
        bg-bg-main/80 backdrop-blur-md
      `,style:{left:e?"96px":"284px"},children:[t.jsx("div",{className:"flex items-center gap-4",children:t.jsx(A5,{})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:f,className:`
            flex items-center gap-2 px-3 py-2 rounded-xl
            bg-panel border border-border
            text-text-secondary text-sm
            hover:bg-panel-hover hover:border-border-hover
            transition-all
            backdrop-blur-xl
          `,title:"Tm kim nhanh (Ctrl+K)",children:[t.jsx(Hr,{size:16}),t.jsx("span",{className:"hidden md:inline",children:"Tm kim..."}),t.jsxs("kbd",{className:`
            hidden md:inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded
            bg-bg-2 text-text-muted text-xs font-mono
          `,children:[t.jsx(w_,{size:10}),"K"]})]}),t.jsxs("div",{className:"relative",ref:l,children:[t.jsxs("button",{onClick:()=>a(!n),className:`
              relative p-2.5 rounded-xl
              bg-panel border border-border
              text-text-secondary
              hover:bg-panel-hover hover:text-text
              transition-all
              backdrop-blur-xl
            `,title:"Thng bo",children:[t.jsx(Nc,{size:18}),o>0&&t.jsx("span",{className:`
                absolute -top-1 -right-1 min-w-[18px] h-[18px] 
                flex items-center justify-center
                bg-accent text-white text-xs font-medium
                rounded-full px-1
              `,children:o>9?"9+":o})]}),n&&t.jsxs("div",{className:`
              absolute top-full right-0 mt-2 w-80
              bg-panel border border-border rounded-xl
              shadow-xl overflow-hidden
              animate-in fade-in slide-in-from-top-2 duration-200
            `,children:[t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[t.jsx("h3",{className:"font-semibold text-text",children:"Thng bo"}),t.jsxs("div",{className:"flex items-center gap-2",children:[o>0&&t.jsx("button",{onClick:u,className:"text-xs text-accent hover:text-accent/80 transition-colors",title:"nh du tt c  c",children:t.jsx(Or,{size:14})}),r.length>0&&t.jsx("button",{onClick:x,className:"text-xs text-text-muted hover:text-text transition-colors",title:"Xa tt c",children:t.jsx(mn,{size:14})})]})]}),t.jsx("div",{className:"max-h-80 overflow-y-auto",children:r.length===0?t.jsxs("div",{className:"px-4 py-8 text-center text-text-muted",children:[t.jsx(Nc,{size:32,className:"mx-auto mb-2 opacity-50"}),t.jsx("p",{children:"Khng c thng bo"})]}):r.map(p=>t.jsx("div",{onClick:()=>d(p.id),className:`
                        px-4 py-3 border-b border-border/50 last:border-0
                        hover:bg-panel-hover cursor-pointer transition-colors
                        ${p.read?"":"bg-accent/5"}
                      `,children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{className:"mt-0.5",children:m(p.type)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsx("p",{className:`text-sm font-medium ${p.read?"text-text-secondary":"text-text"}`,children:p.title}),!p.read&&t.jsx("span",{className:"w-2 h-2 bg-accent rounded-full flex-shrink-0 mt-1.5"})]}),t.jsx("p",{className:"text-xs text-text-muted mt-0.5 line-clamp-2",children:p.message}),t.jsx("p",{className:"text-xs text-text-muted/70 mt-1",children:p.time})]})]})},p.id))}),r.length>0&&t.jsx("div",{className:"px-4 py-2 border-t border-border bg-bg-2/50",children:t.jsx("button",{className:"w-full text-center text-xs text-accent hover:text-accent/80 py-1",children:"Xem tt c thng bo"})})]})]})]})]})}const P5=10,I5="payroll_recent_";function Vj(){const{user:e}=as(),n=_s(),[a,r]=E.useState([]),s=e?`${I5}${e.id}`:null;E.useEffect(()=>{if(s){const u=localStorage.getItem(s);if(u)try{const x=JSON.parse(u);Array.isArray(x)&&r(x)}catch{}}},[s]);const l=E.useCallback(u=>{s&&localStorage.setItem(s,JSON.stringify(u))},[s]);E.useEffect(()=>{if(!s)return;const u=mp(n.pathname);if(!u||n.pathname==="/dang-nhap")return;const x={path:n.pathname,title:u.label,time:Date.now()};r(m=>{const f=m.filter(b=>b.path!==x.path),p=[x,...f].slice(0,P5);return l(p),p})},[n.pathname,s,l]);const o=E.useCallback(u=>{r(x=>{const m=x.filter(f=>f.path!==u);return l(m),m})},[l]),d=E.useCallback(()=>{r([]),s&&localStorage.removeItem(s)},[s]);return{recentPages:a,removeRecent:o,clearRecent:d}}class O5{constructor(){$m(this,"handlers",new Map);$m(this,"listeners",new Set)}register(n,a){return this.handlers.set(n,a),this.notifyListeners(),()=>this.unregister(n)}unregister(n){this.handlers.delete(n),this.notifyListeners()}has(n){return this.handlers.has(n)}async execute(n){const a=this.handlers.get(n);return a?(await a(),!0):(console.warn(`Quick action "${n}" khng c handler ng k`),!1)}getRegisteredKeys(){return Array.from(this.handlers.keys())}subscribe(n){return this.listeners.add(n),()=>this.listeners.delete(n)}notifyListeners(){this.listeners.forEach(n=>n())}}const Kh=new O5;function M5(){const[,e]=E.useState(0);return E.useEffect(()=>{const n=Kh.subscribe(()=>{e(a=>a+1)});return()=>{n()}},[]),{has:n=>Kh.has(n),execute:n=>Kh.execute(n),keys:Kh.getRegisteredKeys()}}function R5({isOpen:e,onClose:n}){const a=mr(),{coQuyen:r,coVaiTro:s}=as(),{favorites:l}=Bj(),{recentPages:o}=Vj(),d=M5(),[u,x]=E.useState(""),[m,f]=E.useState(0),[p,b]=E.useState(null),[g,y]=E.useState(""),N=E.useRef(null),k=E.useRef(null);E.useEffect(()=>{e&&(x(""),f(0),b(null),setTimeout(()=>{var F;return(F=N.current)==null?void 0:F.focus()},50))},[e]);const T=E.useCallback(F=>!F||F.length===0||s("ADMIN")?!0:F.some(H=>r(H)||s(H)),[r,s]),S=E.useMemo(()=>{const F=[],H=Hj(hp),O=u.toLowerCase();if(!u&&l.length>0){const ee=l.map(q=>H.find(fe=>fe.id===q)).filter(q=>!!q&&T(q.requiredPermissions)).map(q=>({id:`fav-${q.id}`,type:"favorite",label:q.label,icon:t.jsx(q.icon,{size:16}),path:q.path}));ee.length>0&&F.push({id:"favorites",title:"Yu thch",icon:t.jsx(g0,{size:14}),items:ee})}if(!u&&o.length>0){const ee=o.slice(0,5).map(q=>({id:`recent-${q.path}`,type:"recent",label:q.title,description:q.path,icon:t.jsx(an,{size:16}),path:q.path}));ee.length>0&&F.push({id:"recent",title:"Gn y",icon:t.jsx(an,{size:14}),items:ee})}const B=H.filter(ee=>{var q;return!ee.path||!T(ee.requiredPermissions)?!1:u?ee.label.toLowerCase().includes(O)||((q=ee.tags)==null?void 0:q.some(fe=>fe.toLowerCase().includes(O))):!0}).map(ee=>({id:`route-${ee.id}`,type:"route",label:ee.label,icon:t.jsx(ee.icon,{size:16}),path:ee.path}));B.length>0&&F.push({id:"routes",title:"i ti",icon:t.jsx(jc,{size:14}),items:u?B.slice(0,8):B.slice(0,5)});const W=[];for(const ee of xp)if(ee.quickActions)for(const q of ee.quickActions){if(!T(q.requiredPermissions))continue;(!u||q.label.toLowerCase().includes(O)||ee.label.toLowerCase().includes(O))&&W.push({id:`action-${ee.path}-${q.id}`,type:"action",label:q.label,description:`trong ${ee.label}`,icon:t.jsx(q.icon,{size:16}),action:q,danger:q.danger})}return W.length>0&&F.push({id:"actions",title:"Thao tc nhanh",icon:t.jsx(ag,{size:14}),items:u?W.slice(0,8):W.slice(0,5)}),s("ADMIN")&&!u&&F.push({id:"admin",title:"Qun tr",icon:t.jsx(Zs,{size:14}),items:[{id:"admin-users",type:"route",label:"Qun l ngi dng",icon:t.jsx(Zs,{size:16}),path:"/quan-tri/nguoi-dung"},{id:"admin-audit",type:"route",label:"Audit Log",icon:t.jsx(Zs,{size:16}),path:"/quan-tri/audit-log"}]}),F},[u,l,o,T,s]),w=E.useMemo(()=>S.flatMap(F=>F.items),[S]);E.useEffect(()=>{const F=document.querySelector(`[data-index="${m}"]`);F==null||F.scrollIntoView({block:"nearest"})},[m]);const _=F=>{if(p){F.key==="Escape"?(b(null),y("")):F.key==="Enter"&&(!p.confirmKeyword||g.toUpperCase()===p.confirmKeyword.toUpperCase())&&(L(p),b(null),y(""));return}switch(F.key){case"ArrowDown":F.preventDefault(),f(H=>Math.min(H+1,w.length-1));break;case"ArrowUp":F.preventDefault(),f(H=>Math.max(H-1,0));break;case"Enter":F.preventDefault(),w[m]&&C(w[m]);break;case"Escape":n();break}},L=async F=>{n(),F.type==="route"&&F.to?a(F.to):F.type==="callback"&&F.callbackKey&&await d.execute(F.callbackKey)},C=F=>{if(F.type==="action"&&F.action){if(F.danger&&F.action.confirmKeyword){b(F.action);return}L(F.action)}else F.path&&(n(),a(F.path))},P=F=>u?F.split(new RegExp(`(${u})`,"gi")).map((O,B)=>O.toLowerCase()===u.toLowerCase()?t.jsx("mark",{className:"bg-[#53F39A]/30 text-[#53F39A] px-0.5 rounded",children:O},B):O):F;return e?t.jsxs("div",{className:"fixed inset-0 z-[100] flex items-start justify-center pt-[12vh]",children:[t.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-md",onClick:n}),t.jsx("div",{className:`
          relative w-full max-w-2xl overflow-hidden
          rounded-2xl border border-white/10
          bg-[#0B1220]/95 backdrop-blur-xl
          shadow-2xl shadow-black/40
          animate-fade-in
        `,onKeyDown:_,children:p?t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center gap-3 text-[#FF4D6D] mb-4",children:[t.jsx(aa,{size:24}),t.jsx("h3",{className:"text-lg font-semibold",children:"Xc nhn thao tc"})]}),t.jsx("p",{className:"text-slate-300 mb-4",children:p.confirmMessage||`Bn c chc mun "${p.label}"?`}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("label",{className:"block text-sm text-slate-400 mb-2",children:["G ",t.jsx("span",{className:"font-mono font-bold text-[#FF4D6D]",children:p.confirmKeyword}),"  xc nhn:"]}),t.jsx("input",{type:"text",value:g,onChange:F=>y(F.target.value),className:`
                  w-full px-4 py-3 rounded-xl
                  bg-white/5 border border-white/10
                  text-white placeholder-slate-500
                  focus:outline-none focus:ring-2 focus:ring-[#FF4D6D]/50 focus:border-[#FF4D6D]/50
                `,placeholder:`G ${p.confirmKeyword}...`,autoFocus:!0})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{b(null),y("")},className:"px-4 py-2 text-slate-400 hover:text-white hover:bg-white/10 rounded-xl transition-colors",children:"Hu"}),t.jsx("button",{onClick:()=>{(!p.confirmKeyword||g.toUpperCase()===p.confirmKeyword.toUpperCase())&&(L(p),b(null),y(""))},disabled:!!(p.confirmKeyword&&g.toUpperCase()!==p.confirmKeyword.toUpperCase()),className:"px-4 py-2 bg-[#FF4D6D] text-white rounded-xl hover:bg-[#FF4D6D]/80 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Xc nhn"})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-3 px-5 py-4 border-b border-white/10",children:[t.jsx(Hr,{size:20,className:"text-slate-500"}),t.jsx("input",{ref:N,type:"text",value:u,onChange:F=>{x(F.target.value),f(0)},placeholder:"Tm trang, thao tc...",className:`
                  flex-1 text-lg bg-transparent text-white
                  outline-none placeholder:text-slate-500
                `}),t.jsx("kbd",{className:"hidden sm:inline-flex items-center px-2 py-1 text-xs text-slate-500 bg-white/5 border border-white/10 rounded-lg",children:"ESC"}),t.jsx("button",{onClick:n,className:"p-1 text-slate-500 hover:text-white sm:hidden transition-colors",children:t.jsx(mn,{size:20})})]}),t.jsx("div",{ref:k,className:"max-h-[55vh] overflow-y-auto",children:S.length===0?t.jsxs("div",{className:"px-5 py-10 text-center text-slate-500",children:['Khng tm thy kt qu cho "',u,'"']}):S.map((F,H)=>{const O=S.slice(0,H).reduce((B,W)=>B+W.items.length,0);return t.jsxs("div",{className:"py-2",children:[t.jsxs("div",{className:"flex items-center gap-2 px-5 py-2 text-xs font-semibold text-slate-500 uppercase tracking-wider",children:[F.icon,F.title]}),F.items.map((B,W)=>{const ee=O+W,q=ee===m;return t.jsxs("button",{"data-index":ee,onClick:()=>C(B),onMouseEnter:()=>f(ee),className:`
                              w-full flex items-center gap-3 px-5 py-3 text-left transition-all duration-150
                              ${q?"bg-[#53F39A]/10 border-l-2 border-l-[#53F39A]":"border-l-2 border-l-transparent hover:bg-white/5"}
                              ${B.danger?"text-[#FF4D6D]":"text-slate-300"}
                            `,children:[t.jsx("span",{className:`
                              flex-shrink-0 w-8 h-8 rounded-lg flex items-center justify-center
                              ${q?"bg-[#53F39A]/20 text-[#53F39A]":B.danger?"bg-[#FF4D6D]/10 text-[#FF4D6D]":"bg-white/5 text-slate-400"}
                            `,children:B.icon}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:`font-medium ${q?"text-white":""}`,children:P(B.label)}),B.description&&t.jsx("div",{className:"text-xs text-slate-500 truncate",children:B.description})]}),B.type==="favorite"&&t.jsx(g0,{size:14,className:"text-amber-400",fill:"currentColor"})]},B.id)})]},F.id)})}),t.jsxs("div",{className:"flex items-center justify-between px-5 py-3 border-t border-white/10 bg-white/[0.02] text-xs text-slate-500",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("kbd",{className:"px-1.5 py-0.5 bg-white/5 border border-white/10 rounded",children:""}),t.jsx("span",{className:"hidden sm:inline",children:"di chuyn"})]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("kbd",{className:"px-1.5 py-0.5 bg-white/5 border border-white/10 rounded",children:""}),t.jsx("span",{className:"hidden sm:inline",children:"chn"})]})]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("kbd",{className:"px-1.5 py-0.5 bg-white/5 border border-white/10 rounded",children:"esc"}),t.jsx("span",{className:"hidden sm:inline",children:"ng"})]})]})]})})]}):null}function B5(){const[e,n]=E.useState(!1),a=E.useCallback(()=>n(!0),[]),r=E.useCallback(()=>n(!1),[]),s=E.useCallback(()=>n(l=>!l),[]);return E.useEffect(()=>{const l=o=>{(o.ctrlKey||o.metaKey)&&o.key==="k"&&(o.preventDefault(),s())};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[s]),{isOpen:e,open:a,close:r,toggle:s}}function H5(){document.documentElement.setAttribute("data-theme","light");const e=document.querySelector('meta[name="theme-color"]');e&&e.setAttribute("content","#f8fafc")}function V5(){H5()}function U5(){const[e,n]=E.useState(!0),[a,r]=E.useState(!1),s=B5();Vj(),E.useEffect(()=>{V5()},[]),E.useEffect(()=>{const u=()=>{window.innerWidth<768?n(!1):window.innerWidth<1024?(n(!0),r(!0)):(n(!0),r(!1))};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),E.useEffect(()=>{const u=()=>s.open();return window.addEventListener("open-command-palette",u),()=>window.removeEventListener("open-command-palette",u)},[s]);const l=()=>{r(!a)},d=(a?72:260)+36;return t.jsxs("div",{className:"min-h-screen",style:{background:"var(--bg-app)"},children:[t.jsx(E5,{isOpen:e,isCollapsed:a,onToggleCollapse:l}),t.jsxs("div",{className:"min-h-screen transition-all duration-300",style:{marginLeft:e?`${d}px`:"24px",paddingRight:"24px"},children:[t.jsx(L5,{onToggleSidebar:l,sidebarCollapsed:a}),t.jsx("main",{className:"pt-20 pb-8",children:t.jsx("div",{className:"animate-fade-in",children:t.jsx(X2,{})})})]}),t.jsx(R5,{isOpen:s.isOpen,onClose:s.close}),e&&t.jsx("div",{className:"fixed inset-0 bg-black/30 z-40 lg:hidden backdrop-blur-sm",onClick:()=>n(!1)})]})}const Uj="tinh_luong_auth",he=Zt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});he.interceptors.request.use(e=>{const n=localStorage.getItem(Uj);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));he.interceptors.response.use(e=>e,e=>{var n;return((n=e.response)==null?void 0:n.status)===401&&(localStorage.removeItem(Uj),window.location.pathname!=="/dang-nhap"&&(window.location.href="/dang-nhap?expired=1")),Promise.reject(e)});const cn={layTatCa:()=>he.get("/phong-ban").then(e=>e.data),layCayPhongBan:()=>he.get("/phong-ban/cay").then(e=>e.data),layTheoId:e=>he.get(`/phong-ban/${e}`).then(n=>n.data),taoMoi:e=>he.post("/phong-ban",e).then(n=>n.data),capNhat:(e,n)=>he.put(`/phong-ban/${e}`,n).then(a=>a.data),doiPhongBanCha:(e,n)=>he.put(`/phong-ban/${e}/doi-phong-ban-cha`,{phongBanChaId:n}).then(a=>a.data),ngungHoatDong:e=>he.post(`/phong-ban/${e}/ngung-hoat-dong`).then(n=>n.data),kichHoat:e=>he.post(`/phong-ban/${e}/kich-hoat`).then(n=>n.data),xoa:e=>he.delete(`/phong-ban/${e}`).then(n=>n.data),layDonViCon:e=>he.get(`/phong-ban/${e}/don-vi-con`).then(n=>n.data),taoDonViCon:(e,n)=>he.post(`/phong-ban/${e}/don-vi-con`,n).then(a=>a.data),capNhatDonViCon:(e,n)=>he.put(`/don-vi-con/${e}`,n).then(a=>a.data),ngungDonViCon:e=>he.post(`/don-vi-con/${e}/ngung-hoat-dong`).then(n=>n.data)},v0={THU_VIEC:{label:"Th vic",color:"bg-yellow-100 text-yellow-700"},CHINH_THUC:{label:"Chnh thc",color:"bg-green-100 text-green-700"},HOC_VIEC:{label:"Hc vic",color:"bg-blue-100 text-blue-700"},THUC_TAP:{label:"Thc tp",color:"bg-purple-100 text-purple-700"},CONG_TAC_VIEN:{label:"Cng tc vin",color:"bg-indigo-100 text-indigo-700"},THOI_VU:{label:"Thi v",color:"bg-orange-100 text-orange-700"}},Ma={layTatCa:e=>he.get("/nhan-vien",{params:e}).then(n=>n.data),layTheoId:e=>he.get(`/nhan-vien/${e}`).then(n=>n.data),layMaTuDong:()=>he.get("/nhan-vien/ma-tu-dong").then(e=>e.data),taoMoi:e=>he.post("/nhan-vien",e).then(n=>n.data),capNhat:(e,n)=>he.put(`/nhan-vien/${e}`,n).then(a=>a.data),xoa:e=>he.delete(`/nhan-vien/${e}`).then(n=>n.data),layLichSuPhongBan:e=>he.get(`/nhan-vien/${e}/lich-su-phong-ban`).then(n=>n.data),chuyenPhongBan:(e,n)=>he.post(`/nhan-vien/${e}/chuyen-phong-ban`,n).then(a=>a.data)},Fr={layTatCa:e=>he.get("/khoan-luong",{params:{loai:e}}).then(n=>n.data),layTheoId:e=>he.get(`/khoan-luong/${e}`).then(n=>n.data),taoMoi:e=>he.post("/khoan-luong",e).then(n=>n.data),capNhat:(e,n)=>he.put(`/khoan-luong/${e}`,n).then(a=>a.data),xoa:e=>he.delete(`/khoan-luong/${e}`).then(n=>n.data)},Dr={layDanhSach:e=>he.get("/bang-luong",{params:e}).then(n=>n.data),layTheoId:e=>he.get(`/bang-luong/${e}`).then(n=>n.data),taoMoi:e=>he.post("/bang-luong",e).then(n=>n.data),capNhatChiTiet:e=>he.put("/bang-luong/chi-tiet/cap-nhat",e).then(n=>n.data),capNhatNhieuChiTiet:e=>he.put("/bang-luong/chi-tiet/cap-nhat-nhieu",{danhSach:e}).then(n=>n.data),chotBangLuong:(e,n)=>he.post(`/bang-luong/${e}/chot`,n).then(a=>a.data),moKhoa:e=>he.post(`/bang-luong/${e}/mo-khoa`).then(n=>n.data),khoa:e=>he.post(`/bang-luong/${e}/khoa`).then(n=>n.data),xoa:(e,n=!1)=>he.delete(`/bang-luong/${e}`,{params:{force:n?"true":void 0}}).then(a=>a.data),layLichSu:e=>he.get(`/bang-luong/${e}/lich-su`).then(n=>n.data),soSanhExcel:(e,n)=>he.post(`/bang-luong/${e}/so-sanh-excel`,{tongExcel:n}).then(a=>a.data),tinhLaiLuong:e=>he.post(`/bang-luong/${e}/tinh-lai-luong`).then(n=>n.data)},fp={layPhieuLuong:(e,n)=>he.get(`/bang-luong/${e}/phieu-luong/${n}`).then(a=>a.data),layPhieuLuongHtml:(e,n)=>he.get(`/bang-luong/${e}/phieu-luong/${n}/html`).then(a=>a.data),guiPhieuLuong:(e,n)=>he.post(`/bang-luong/${e}/gui-phieu-luong/${n}`).then(a=>a.data),guiTatCa:e=>he.post(`/bang-luong/${e}/gui-tat-ca`).then(n=>n.data)},d0={docHeader:e=>{const n=new FormData;return n.append("file",e),he.post("/import-excel/doc-header",n,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>a.data)},goiYMapping:e=>{const n=new FormData;return n.append("file",e),he.post("/import-excel/goi-y-mapping",n,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>a.data)},import:(e,n,a,r,s)=>{const l=new FormData;return l.append("file",e),l.append("thang",String(n)),l.append("nam",String(a)),l.append("phongBanId",String(r)),l.append("mappings",JSON.stringify(s)),he.post("/import-excel/import",l,{headers:{"Content-Type":"multipart/form-data"}}).then(o=>o.data)},export:e=>he.get(`/import-excel/export/${e}`,{responseType:"blob"})},Wo={layTheoNhanVien:e=>he.get(`/phu-cap-nhan-vien/nhan-vien/${e}`).then(n=>n.data),layHieuLuc:e=>he.get(`/phu-cap-nhan-vien/nhan-vien/${e}/hieu-luc`).then(n=>n.data),layTheoThang:(e,n,a)=>he.get(`/phu-cap-nhan-vien/nhan-vien/${e}/theo-thang`,{params:{thang:n,nam:a}}).then(r=>r.data),layLichSu:(e,n)=>he.get(`/phu-cap-nhan-vien/nhan-vien/${e}/lich-su`,{params:{khoanLuongId:n}}).then(a=>a.data),taoPhuCap:e=>he.post("/phu-cap-nhan-vien",e).then(n=>n.data),ketThuc:(e,n,a)=>he.put(`/phu-cap-nhan-vien/${e}/ket-thuc`,{denNgay:n,nguoiCapNhat:a}).then(r=>r.data),tang:(e,n)=>he.post(`/phu-cap-nhan-vien/${e}/tang`,n).then(a=>a.data),tamDung:e=>he.put(`/phu-cap-nhan-vien/${e}/tam-dung`).then(n=>n.data),kichHoat:e=>he.put(`/phu-cap-nhan-vien/${e}/kich-hoat`).then(n=>n.data),thongKePhongBan:e=>he.get(`/phu-cap-nhan-vien/thong-ke/phong-ban/${e}`).then(n=>n.data)},Cb={layTatCa:e=>he.get(`/bang-luong/${e}/ngay-cong`).then(n=>n.data),layTheoNhanVien:(e,n)=>he.get(`/bang-luong/${e}/ngay-cong/${n}`).then(a=>a.data),khoiTao:e=>he.post(`/bang-luong/${e}/ngay-cong/khoi-tao`).then(n=>n.data),dieuChinh:(e,n,a)=>he.put(`/bang-luong/${e}/ngay-cong/${n}/dieu-chinh`,a).then(r=>r.data),xoaDieuChinh:(e,n)=>he.delete(`/bang-luong/${e}/ngay-cong/${n}/dieu-chinh`).then(a=>a.data)},Sb={lay:()=>he.get("/thong-tin-cong-ty").then(e=>e.data),capNhat:e=>he.put("/thong-tin-cong-ty",e).then(n=>n.data)},wd={layTatCa:e=>he.get("/thong-tin-cong-ty/don-gia",{params:{phongBanId:e}}).then(n=>n.data),layTheoId:e=>he.get(`/thong-tin-cong-ty/don-gia/${e}`).then(n=>n.data),taoMoi:e=>he.post("/thong-tin-cong-ty/don-gia",e).then(n=>n.data),capNhat:(e,n)=>he.put(`/thong-tin-cong-ty/don-gia/${e}`,n).then(a=>a.data),xoa:e=>he.delete(`/thong-tin-cong-ty/don-gia/${e}`).then(n=>n.data),khoiTaoMau:()=>he.post("/thong-tin-cong-ty/don-gia/khoi-tao-mau").then(e=>e.data)},Xa={layDanhSach:e=>he.get("/ung-luong/bang",{params:e}).then(n=>n.data),layTheoId:e=>he.get(`/ung-luong/bang/${e}`).then(n=>n.data),taoMoi:e=>he.post("/ung-luong/bang",e).then(n=>n.data),capNhat:(e,n)=>he.put(`/ung-luong/bang/${e}`,n).then(a=>a.data),xoa:(e,n=!1)=>he.delete(`/ung-luong/bang/${e}`,{params:{force:n?"true":void 0}}).then(a=>a.data),sinhDanhSach:(e,n)=>he.post(`/ung-luong/bang/${e}/generate-danh-sach`,n||{}).then(a=>a.data),capNhatBulk:(e,n)=>he.put(`/ung-luong/bang/${e}/rows/bulk`,n).then(a=>a.data),setTheoTiLe:(e,n)=>he.post(`/ung-luong/bang/${e}/set-ti-le`,n).then(a=>a.data),setSoTienCoDinh:(e,n)=>he.post(`/ung-luong/bang/${e}/set-so-tien`,n).then(a=>a.data),chot:e=>he.post(`/ung-luong/bang/${e}/chot`).then(n=>n.data),khoa:e=>he.post(`/ung-luong/bang/${e}/khoa`).then(n=>n.data),moKhoa:(e,n)=>he.post(`/ung-luong/bang/${e}/mo-khoa`,n).then(a=>a.data),ghiNhanKhauTru:(e,n)=>he.post(`/ung-luong/bang/${e}/ghi-nhan-khau-tru`,n).then(a=>a.data)},Kj={layNhanVien:(e,n)=>{const a=`${n.tuNam}-${String(n.tuThang).padStart(2,"0")}-01`,r=new Date(n.denNam,n.denThang,0).toISOString().split("T")[0];return he.get(`/so-luong/nhan-vien/${e}`,{params:{tuNgay:a,denNgay:r}}).then(s=>s.data)},layPhongBan:(e,n)=>{const a=`${n.tuNam}-${String(n.tuThang).padStart(2,"0")}-01`,r=new Date(n.denNam,n.denThang,0).toISOString().split("T")[0];return he.get(`/so-luong/phong-ban/${e}`,{params:{tuNgay:a,denNgay:r}}).then(s=>s.data)},timKiem:e=>he.get("/so-luong/tim-kiem",{params:e}).then(n=>n.data)};function et(e){if(e==null)return"0";const n=typeof e=="string"?parseFloat(e):e;return isNaN(n)?"0":new Intl.NumberFormat("vi-VN").format(n)}function K5(e){if(!e)return 0;const n=e.replace(/[^\d]/g,"");return parseInt(n,10)||0}function vs(e){return e?new Date(e).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):""}function z5(e){switch(e){case"NHAP":return"ang nhp";case"DA_CHOT":return" cht";case"KHOA":return" kha";default:return e}}function $5(e,n){const a=window.URL.createObjectURL(e),r=document.createElement("a");r.href=a,r.setAttribute("download",n),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(a)}function Rt(...e){const n=[];for(const a of e)if(a){if(typeof a=="string")n.push(a);else if(typeof a=="number")n.push(String(a));else if(Array.isArray(a)){const r=Rt(...a);r&&n.push(r)}}return n.join(" ").replace(/\s+/g," ").trim()}const st=E.forwardRef(({className:e,variant:n="default",padding:a="md",hover:r=!1,clickable:s=!1,children:l,...o},d)=>{const u="rounded-2xl transition-all duration-200",x={default:"bg-[var(--panel)] border border-[var(--border)]",glass:`
        bg-[var(--panel)]/80 backdrop-blur-xl 
        border border-white/10 
        shadow-lg shadow-black/5
      `,elevated:`
        bg-[var(--panel)] 
        border border-[var(--border)]
        shadow-xl shadow-black/10
      `,bordered:"bg-transparent border-2 border-[var(--border)]",gradient:`
        bg-gradient-to-br from-[var(--panel)] to-[var(--bg-2)]
        border border-[var(--border)]
      `},m={none:"",sm:"p-3",md:"p-5",lg:"p-6",xl:"p-8"},f=r?"hover:shadow-xl hover:border-[var(--accent)]/30 hover:-translate-y-0.5":"",p=s?"cursor-pointer active:scale-[0.99]":"";return t.jsx("div",{ref:d,className:Rt(u,x[n],m[a],f,p,e),...o,children:l})});st.displayName="Card";const Kn=E.forwardRef(({className:e,title:n,subtitle:a,action:r,icon:s,children:l,...o},d)=>t.jsxs("div",{ref:d,className:Rt("flex items-start justify-between gap-4 mb-4",e),...o,children:[t.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[s&&t.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-xl bg-[var(--accent)]/10 flex items-center justify-center text-[var(--accent)]",children:s}),t.jsxs("div",{className:"flex-1 min-w-0",children:[n&&t.jsx("h3",{className:"text-lg font-semibold text-[var(--text-primary)] truncate",children:n}),a&&t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-0.5",children:a}),l]})]}),r&&t.jsx("div",{className:"flex-shrink-0",children:r})]}));Kn.displayName="CardHeader";const Vt=E.forwardRef(({className:e,...n},a)=>t.jsx("div",{ref:a,className:Rt("",e),...n}));Vt.displayName="CardContent";const G5=E.forwardRef(({className:e,separator:n=!0,...a},r)=>t.jsx("div",{ref:r,className:Rt("flex items-center justify-between gap-4 mt-4 pt-4",n&&"border-t border-[var(--border)]",e),...a}));G5.displayName="CardFooter";const zj=E.forwardRef(({className:e,title:n,value:a,subtitle:r,icon:s,trend:l,accentColor:o="green",...d},u)=>{const m={green:{bg:"bg-[#53F39A]/10",text:"text-[#53F39A]",glow:"shadow-[#53F39A]/20"},cyan:{bg:"bg-[#4FC3FF]/10",text:"text-[#4FC3FF]",glow:"shadow-[#4FC3FF]/20"},yellow:{bg:"bg-amber-500/10",text:"text-amber-400",glow:"shadow-amber-500/20"},red:{bg:"bg-[#FF4D6D]/10",text:"text-[#FF4D6D]",glow:"shadow-[#FF4D6D]/20"},purple:{bg:"bg-purple-500/10",text:"text-purple-400",glow:"shadow-purple-500/20"}}[o],f={up:"text-[#53F39A]",down:"text-[#FF4D6D]",neutral:"text-[var(--text-muted)]"},p={up:"",down:"",neutral:""};return t.jsxs(st,{ref:u,variant:"glass",className:Rt("group hover:shadow-lg",m.glow,e),hover:!0,...d,children:[t.jsxs("div",{className:"flex items-start justify-between",children:[s&&t.jsx("div",{className:Rt("w-12 h-12 rounded-xl flex items-center justify-center transition-transform group-hover:scale-110",m.bg,m.text),children:s}),l&&t.jsxs("div",{className:Rt("flex items-center gap-1 text-sm font-medium",f[l.direction]),children:[t.jsx("span",{children:p[l.direction]}),t.jsxs("span",{children:[Math.abs(l.value),"%"]})]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("p",{className:"text-3xl font-bold text-[var(--text-primary)] tabular-nums",children:typeof a=="number"?a.toLocaleString("vi-VN"):a}),t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1",children:n}),r&&t.jsx("p",{className:"text-xs text-[var(--text-disabled)] mt-0.5",children:r})]})]})});zj.displayName="StatCard";const mt=E.forwardRef(({className:e,variant:n="primary",size:a="md",rounded:r="xl",loading:s=!1,icon:l,iconPosition:o="left",fullWidth:d=!1,disabled:u,children:x,...m},f)=>{const p=u||s,b=`
      inline-flex items-center justify-center gap-2
      font-medium transition-all duration-200
      focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[var(--accent)]
      disabled:opacity-50 disabled:cursor-not-allowed
      active:scale-[0.98]
    `,g={primary:`
        bg-[var(--accent)] text-[#0B1220]
        hover:bg-[var(--accent)]/90
        shadow-lg shadow-[var(--accent)]/25
      `,secondary:`
        bg-[var(--bg-2)] text-[var(--text-primary)]
        border border-[var(--border)]
        hover:bg-[var(--bg-3)] hover:border-[var(--accent)]/30
      `,outline:`
        bg-transparent text-[var(--text-primary)]
        border-2 border-[var(--border)]
        hover:bg-[var(--bg-2)] hover:border-[var(--accent)]/50
      `,ghost:`
        bg-transparent text-[var(--text-secondary)]
        hover:bg-[var(--bg-2)] hover:text-[var(--text-primary)]
      `,danger:`
        bg-[#FF4D6D] text-white
        hover:bg-[#FF4D6D]/90
        shadow-lg shadow-[#FF4D6D]/25
      `,success:`
        bg-[#53F39A] text-[#0B1220]
        hover:bg-[#53F39A]/90
        shadow-lg shadow-[#53F39A]/25
      `},y={xs:"text-xs px-2.5 py-1.5 h-7",sm:"text-sm px-3 py-2 h-8",md:"text-sm px-4 py-2.5 h-10",lg:"text-base px-5 py-3 h-11",xl:"text-base px-6 py-3.5 h-12"},N={md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl",full:"rounded-full"};return t.jsxs("button",{ref:f,className:Rt(b,g[n],y[a],N[r],d&&"w-full",e),disabled:p,...m,children:[s&&t.jsx(Mn,{className:"w-4 h-4 animate-spin"}),!s&&l&&o==="left"&&t.jsx("span",{className:"flex-shrink-0",children:l}),x&&t.jsx("span",{children:x}),!s&&l&&o==="right"&&t.jsx("span",{className:"flex-shrink-0",children:l})]})});mt.displayName="Button";const $j=E.forwardRef(({className:e,variant:n="ghost",size:a="md",loading:r=!1,tooltip:s,disabled:l,children:o,...d},u)=>{const x=l||r,m=`
      inline-flex items-center justify-center
      rounded-xl transition-all duration-200
      focus:outline-none focus-visible:ring-2 focus-visible:ring-[var(--accent)]
      disabled:opacity-50 disabled:cursor-not-allowed
      active:scale-95
    `,f={primary:`
        bg-[var(--accent)] text-[#0B1220]
        hover:bg-[var(--accent)]/80
      `,secondary:`
        bg-[var(--bg-2)] text-[var(--text-secondary)]
        hover:bg-[var(--bg-3)] hover:text-[var(--text-primary)]
      `,ghost:`
        text-[var(--text-muted)]
        hover:bg-[var(--bg-2)] hover:text-[var(--text-primary)]
      `,danger:`
        text-[#FF4D6D]
        hover:bg-[#FF4D6D]/10
      `},p={xs:"w-6 h-6",sm:"w-8 h-8",md:"w-10 h-10",lg:"w-12 h-12"};return t.jsx("button",{ref:u,className:Rt(m,f[n],p[a],e),disabled:x,title:s,...d,children:r?t.jsx(Mn,{className:"w-4 h-4 animate-spin"}):o})});$j.displayName="IconButton";const Tt=E.forwardRef(({className:e,variant:n="default",size:a="sm",dot:r=!1,icon:s,removable:l=!1,onRemove:o,children:d,...u},x)=>{const m=`
      inline-flex items-center gap-1.5
      font-medium rounded-full
      transition-colors duration-150
    `,f={default:"bg-[var(--accent)]/15 text-[var(--accent)]",success:"bg-[#53F39A]/15 text-[#53F39A]",warning:"bg-amber-500/15 text-amber-400",danger:"bg-[#FF4D6D]/15 text-[#FF4D6D]",info:"bg-[#4FC3FF]/15 text-[#4FC3FF]",neutral:"bg-[var(--bg-3)] text-[var(--text-muted)]"},p={xs:"text-[10px] px-1.5 py-0.5",sm:"text-xs px-2 py-0.5",md:"text-sm px-2.5 py-1"},b={default:"bg-[var(--accent)]",success:"bg-[#53F39A]",warning:"bg-amber-400",danger:"bg-[#FF4D6D]",info:"bg-[#4FC3FF]",neutral:"bg-[var(--text-muted)]"};return t.jsxs("span",{ref:x,className:Rt(m,f[n],p[a],e),...u,children:[r&&t.jsx("span",{className:Rt("w-1.5 h-1.5 rounded-full animate-pulse",b[n])}),s&&t.jsx("span",{className:"flex-shrink-0 w-3 h-3",children:s}),d,l&&t.jsx("button",{type:"button",onClick:g=>{g.stopPropagation(),o==null||o()},className:"ml-0.5 -mr-0.5 p-0.5 rounded-full hover:bg-white/20 transition-colors",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-3 h-3",children:t.jsx("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})})})]})});Tt.displayName="Badge";const q5={active:{label:"Hot ng",variant:"success"},inactive:{label:"Ngng",variant:"neutral"},pending:{label:"Ch duyt",variant:"warning"},approved:{label:" duyt",variant:"success"},rejected:{label:"T chi",variant:"danger"},draft:{label:"Nhp",variant:"neutral"},completed:{label:"Hon thnh",variant:"info"}},W5=E.forwardRef(({status:e,className:n,...a},r)=>{const s=q5[e];return t.jsx(Tt,{ref:r,variant:s.variant,dot:!0,className:n,...a,children:s.label})});W5.displayName="StatusBadge";const X5=E.forwardRef(({count:e,max:n=99,variant:a="danger",className:r,...s},l)=>{const o=e>n?`${n}+`:e,d=`
      inline-flex items-center justify-center
      min-w-[18px] h-[18px] px-1.5
      text-[10px] font-bold rounded-full
    `,u={default:"bg-[var(--accent)] text-[#0B1220]",danger:"bg-[#FF4D6D] text-white"};return e<=0?null:t.jsx("span",{ref:l,className:Rt(d,u[a],r),...s,children:o})});X5.displayName="CounterBadge";const og=E.forwardRef(({className:e,type:n="text",size:a="md",variant:r="default",error:s=!1,success:l=!1,icon:o,iconPosition:d="left",clearable:u=!1,onClear:x,value:m,...f},p)=>{const b=`
      w-full transition-all duration-200
      placeholder:text-[var(--text-disabled)]
      focus:outline-none
      disabled:opacity-50 disabled:cursor-not-allowed
    `,g={default:`
        bg-[var(--bg-1)] 
        border border-[var(--border)]
        focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
      `,filled:`
        bg-[var(--bg-2)] 
        border border-transparent
        focus:bg-[var(--bg-1)] focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
      `,ghost:`
        bg-transparent 
        border border-transparent
        hover:bg-[var(--bg-2)]
        focus:bg-[var(--bg-2)] focus:border-[var(--border)]
      `},y={sm:"h-8 px-3 text-sm rounded-lg",md:"h-10 px-4 text-sm rounded-xl",lg:"h-12 px-4 text-base rounded-xl"},N=s?"border-[#FF4D6D] focus:border-[#FF4D6D] focus:ring-[#FF4D6D]/20":l?"border-[#53F39A] focus:border-[#53F39A] focus:ring-[#53F39A]/20":"",k=!!o,T=u&&m,S=k&&d==="left"?"pl-10":"",w=k&&d==="right"||T?"pr-10":"";return t.jsxs("div",{className:"relative",children:[o&&d==="left"&&t.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)]",children:o}),t.jsx("input",{ref:p,type:n,value:m,className:Rt(b,g[r],y[a],N,S,w,"text-[var(--text-primary)]",e),...f}),o&&d==="right"&&!T&&t.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)]",children:o}),T&&t.jsx("button",{type:"button",onClick:x,className:"absolute right-3 top-1/2 -translate-y-1/2 p-0.5 rounded-full text-[var(--text-muted)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-3)] transition-colors",children:t.jsx(mn,{size:14})})]})});og.displayName="Input";const cg=E.forwardRef(({className:e,onSearch:n,...a},r)=>t.jsx(og,{ref:r,type:"search",icon:t.jsx(Hr,{size:18}),iconPosition:"left",clearable:!0,placeholder:"Tm kim...",className:e,...a}));cg.displayName="SearchInput";const Q5=E.forwardRef(({className:e,...n},a)=>{const[r,s]=E.useState(!1);return t.jsxs("div",{className:"relative",children:[t.jsx(og,{ref:a,type:r?"text":"password",className:Rt("pr-10",e),...n}),t.jsx("button",{type:"button",onClick:()=>s(!r),className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 rounded-lg text-[var(--text-muted)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-3)] transition-colors",children:r?t.jsx(T_,{size:18}):t.jsx(ii,{size:18})})]})});Q5.displayName="PasswordInput";const ex=E.forwardRef(({className:e,variant:n="default",error:a,success:r,...s},l)=>{const o=`
      w-full min-h-[100px] px-4 py-3
      text-sm text-[var(--text-primary)]
      rounded-xl resize-y
      transition-all duration-200
      placeholder:text-[var(--text-disabled)]
      focus:outline-none
      disabled:opacity-50 disabled:cursor-not-allowed
    `,d={default:`
        bg-[var(--bg-1)] 
        border border-[var(--border)]
        focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
      `,filled:`
        bg-[var(--bg-2)] 
        border border-transparent
        focus:bg-[var(--bg-1)] focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
      `},u=a?"border-[#FF4D6D] focus:border-[#FF4D6D] focus:ring-[#FF4D6D]/20":r?"border-[#53F39A] focus:border-[#53F39A] focus:ring-[#53F39A]/20":"";return t.jsx("textarea",{ref:l,className:Rt(o,d[n],u,e),...s})});ex.displayName="Textarea";const Y5=E.forwardRef(({className:e,loading:n,empty:a,emptyMessage:r="Khng c d liu",emptyIcon:s,children:l,...o},d)=>t.jsxs("div",{ref:d,className:Rt("relative overflow-hidden rounded-2xl","bg-[var(--panel)] border border-[var(--border)]",e),...o,children:[n&&t.jsx("div",{className:"absolute inset-0 bg-[var(--panel)]/80 backdrop-blur-sm z-10 flex items-center justify-center",children:t.jsxs("div",{className:"flex flex-col items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 border-2 border-[var(--accent)] border-t-transparent rounded-full animate-spin"}),t.jsx("span",{className:"text-sm text-[var(--text-muted)]",children:"ang ti..."})]})}),a?t.jsxs("div",{className:"py-16 flex flex-col items-center justify-center text-center",children:[s&&t.jsx("div",{className:"w-16 h-16 rounded-2xl bg-[var(--bg-2)] flex items-center justify-center text-[var(--text-muted)] mb-4",children:s}),t.jsx("p",{className:"text-[var(--text-muted)]",children:r})]}):t.jsx("div",{className:"overflow-x-auto",children:l})]}));Y5.displayName="TableContainer";const Gj=E.forwardRef(({className:e,compact:n,striped:a,hoverable:r=!0,...s},l)=>t.jsx("table",{ref:l,className:Rt("w-full text-sm",n?"table-compact":"",a?"table-striped":"",r?"table-hoverable":"",e),...s}));Gj.displayName="Table";const qj=E.forwardRef(({className:e,...n},a)=>t.jsx("thead",{ref:a,className:Rt("bg-[var(--bg-2)] border-b border-[var(--border)]",e),...n}));qj.displayName="TableHead";const Wj=E.forwardRef(({className:e,...n},a)=>t.jsx("tbody",{ref:a,className:Rt("divide-y divide-[var(--border)]",e),...n}));Wj.displayName="TableBody";const Dd=E.forwardRef(({className:e,selected:n,clickable:a,...r},s)=>t.jsx("tr",{ref:s,className:Rt("transition-colors","hover:bg-[var(--bg-2)]",n&&"bg-[var(--accent)]/5",a&&"cursor-pointer",e),...r}));Dd.displayName="TableRow";const Pl=E.forwardRef(({className:e,children:n,sortable:a,sortDirection:r,onSort:s,align:l="left",...o},d)=>{const u={left:"text-left",center:"text-center",right:"text-right"};return t.jsx("th",{ref:d,className:Rt("px-4 py-3 font-semibold text-xs uppercase tracking-wider","text-[var(--text-muted)]",u[l],a&&"cursor-pointer select-none hover:text-[var(--text-primary)] group",e),onClick:a?s:void 0,...o,children:t.jsxs("div",{className:Rt("inline-flex items-center gap-1.5",l==="right"&&"flex-row-reverse",l==="center"&&"justify-center"),children:[n,a&&t.jsx("span",{className:Rt("transition-colors",r?"text-[var(--accent)]":"text-[var(--text-disabled)] group-hover:text-[var(--text-muted)]"),children:r==="asc"?t.jsx(Il,{size:14}):r==="desc"?t.jsx(Ar,{size:14}):t.jsx(v_,{size:14})})]})})});Pl.displayName="TableHeadCell";const zs=E.forwardRef(({className:e,align:n="left",numeric:a,truncate:r,maxWidth:s,style:l,...o},d)=>{const u={left:"text-left",center:"text-center",right:"text-right"};return t.jsx("td",{ref:d,className:Rt("px-4 py-3","text-[var(--text-primary)]",u[n],a&&"tabular-nums font-medium",r&&"truncate",e),style:{maxWidth:s?`${s}px`:void 0,...l},...o})});zs.displayName="TableCell";const J5=E.forwardRef(({className:e,...n},a)=>t.jsx("tfoot",{ref:a,className:Rt("bg-[var(--bg-2)] border-t border-[var(--border)]",e),...n}));J5.displayName="TableFooter";const ks=({isOpen:e,onClose:n,children:a,size:r="md",closable:s=!0,closeOnOverlay:l=!0,closeOnEscape:o=!0,className:d})=>{if(E.useEffect(()=>{if(!e||!o)return;const m=f=>{f.key==="Escape"&&n()};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[e,o,n]),E.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),!e)return null;const u={sm:"max-w-sm",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-[90vw]"},x=t.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4",children:[t.jsx("div",{className:Rt("absolute inset-0 bg-black/50","animate-in fade-in duration-200"),onClick:l?n:void 0}),t.jsxs("div",{className:Rt("relative w-full",u[r],"bg-[var(--panel)]/95 backdrop-blur-xl","border border-[var(--border)]","rounded-2xl shadow-2xl shadow-black/40","animate-in fade-in zoom-in-95 duration-200",d),onClick:m=>m.stopPropagation(),children:[s&&t.jsx($j,{variant:"ghost",size:"sm",onClick:n,className:"absolute top-4 right-4 z-10",children:t.jsx(mn,{size:18})}),a]})]});return xS.createPortal(x,document.body)},Ts=({title:e,subtitle:n,icon:a,className:r})=>t.jsx("div",{className:Rt("px-6 pt-6 pb-4",r),children:t.jsxs("div",{className:"flex items-start gap-4",children:[a&&t.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-xl bg-[var(--accent)]/10 flex items-center justify-center text-[var(--accent)]",children:a}),t.jsxs("div",{className:"flex-1 min-w-0 pr-8",children:[t.jsx("h2",{className:"text-xl font-semibold text-[var(--text-primary)]",children:e}),n&&t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1",children:n})]})]})}),Cs=({children:e,className:n,padding:a=!0})=>t.jsx("div",{className:Rt("max-h-[60vh] overflow-y-auto modal-scroll",a&&"px-6 py-4",n),children:e}),ei=({children:e,className:n})=>t.jsx("div",{className:Rt("flex items-center justify-end gap-3","px-6 py-4","border-t border-[var(--border)]","bg-[var(--bg-2)]/50",n),children:e});function Z5(){const{data:e}=Ie({queryKey:["phong-ban"],queryFn:cn.layTatCa}),{data:n}=Ie({queryKey:["nhan-vien"],queryFn:()=>Ma.layTatCa()}),{data:a}=Ie({queryKey:["khoan-luong"],queryFn:()=>Fr.layTatCa()}),{data:r}=Ie({queryKey:["bang-luong"],queryFn:()=>Dr.layDanhSach()}),s=(Array.isArray(n)?n:(n==null?void 0:n.data)||[]).filter(x=>x&&x.id),l=(Array.isArray(r)?r:(r==null?void 0:r.data)||[]).filter(x=>x&&x.id),o=l.reduce((x,m)=>x+((m==null?void 0:m.thucLinh)||0),0)||0,d=[{label:"Phng ban",value:(e==null?void 0:e.length)||0,icon:Lr,color:"cyan",link:"/nhan-vien"},{label:"Nhn vin",value:(s==null?void 0:s.length)||0,icon:dn,color:"green",link:"/nhan-vien"},{label:"Khon lng",value:(a==null?void 0:a.length)||0,icon:Pr,color:"purple",link:"/khoan-luong"},{label:"Bng lng",value:(l==null?void 0:l.length)||0,icon:Ys,color:"yellow",link:"/bang-luong"}],u=x=>{switch(x){case"NHAP":return t.jsx(Tt,{variant:"neutral",dot:!0,children:"ang nhp"});case"DA_CHOT":return t.jsx(Tt,{variant:"success",dot:!0,children:" cht"});case"KHOA":return t.jsx(Tt,{variant:"info",dot:!0,children:" kha"});default:return t.jsx(Tt,{variant:"neutral",children:x})}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-[var(--text-primary)] flex items-center gap-2",children:[t.jsx(z_,{size:24,className:"text-[var(--accent)]"}),"Tng quan H thng"]}),t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1",children:"Cho mng tr li! y l tng quan hot ng ca bn."})]}),t.jsxs(ca,{to:"/bang-luong",className:`
            inline-flex items-center gap-2 px-4 py-2.5 
            bg-[var(--accent)] text-[#0B1220] font-medium
            rounded-xl hover:bg-[var(--accent)]/90 
            shadow-lg shadow-[var(--accent)]/25
            transition-all duration-200
          `,children:[t.jsx(Ys,{size:18}),"To bng lng",t.jsx(h_,{size:16})]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:d.map(x=>{const m=x.icon;return t.jsx(ca,{to:x.link,children:t.jsx(zj,{title:x.label,value:x.value,icon:t.jsx(m,{size:24}),accentColor:x.color})},x.label)})}),t.jsxs(st,{variant:"glass",className:`
          relative overflow-hidden
          bg-gradient-to-br from-[#53F39A]/5 via-[var(--panel)] to-[#4FC3FF]/5
          border border-[var(--accent)]/20
        `,children:[t.jsx("div",{className:"absolute -top-20 -right-20 w-60 h-60 bg-[var(--accent)]/10 rounded-full blur-3xl"}),t.jsx("div",{className:"absolute -bottom-20 -left-20 w-40 h-40 bg-[#4FC3FF]/10 rounded-full blur-3xl"}),t.jsxs("div",{className:"relative flex items-center gap-6",children:[t.jsx("div",{className:`
            p-5 rounded-2xl
            bg-gradient-to-br from-[#53F39A] to-[#4FC3FF]
            shadow-lg shadow-[#53F39A]/30
          `,children:t.jsx(li,{size:32,className:"text-[#0B1220]"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-[var(--text-muted)] uppercase tracking-wider font-medium",children:"Tng qu lng"}),t.jsxs("p",{className:"text-4xl font-bold text-[var(--text-primary)] mt-1 tabular-nums",children:[et(o),t.jsx("span",{className:"text-lg text-[var(--text-muted)] ml-2 font-normal",children:"VN"})]})]})]})]}),t.jsxs(st,{variant:"glass",padding:"none",children:[t.jsx(Kn,{title:t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(At,{size:20,className:"text-[var(--accent)]"}),"Bng lng gn y"]}),action:t.jsxs(ca,{to:"/bang-luong",className:`
                flex items-center gap-1 text-sm text-[var(--text-muted)]
                hover:text-[var(--accent)] transition-colors
              `,children:["Xem tt c",t.jsx($n,{size:16})]}),className:"px-5 pt-5"}),l&&l.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-[var(--border)]",children:[t.jsx("th",{className:"text-left py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Thng/Nm"}),t.jsx("th",{className:"text-left py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Phng ban"}),t.jsx("th",{className:"text-right py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"S NV"}),t.jsx("th",{className:"text-right py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Thc lnh"}),t.jsx("th",{className:"text-center py-3 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Trng thi"})]})}),t.jsx("tbody",{className:"divide-y divide-[var(--border)]",children:l.slice(0,5).map(x=>{var m;return t.jsxs("tr",{className:"hover:bg-[var(--bg-2)] transition-colors group",children:[t.jsx("td",{className:"py-4 px-5",children:t.jsxs(ca,{to:`/bang-luong/${x.id}`,className:`
                          font-medium text-[var(--text-primary)]
                          group-hover:text-[var(--accent)] transition-colors
                        `,children:["Thng ",x.thang,"/",x.nam]})}),t.jsx("td",{className:"py-4 px-5 text-[var(--text-secondary)]",children:((m=x.phongBan)==null?void 0:m.tenPhongBan)||"Tt c phng ban"}),t.jsx("td",{className:"py-4 px-5 text-right text-[var(--text-secondary)] tabular-nums",children:x.soNhanVien||0}),t.jsx("td",{className:"py-4 px-5 text-right font-semibold text-[var(--accent)] tabular-nums",children:et(x.thucLinh)}),t.jsx("td",{className:"py-4 px-5 text-center",children:u(x.trangThai)})]},x.id)})})]})}):t.jsxs("div",{className:"text-center py-12 px-5",children:[t.jsx("div",{className:`
              w-16 h-16 mx-auto mb-4 rounded-2xl
              bg-[var(--bg-2)] flex items-center justify-center
              text-[var(--text-muted)]
            `,children:t.jsx(Ys,{size:28})}),t.jsxs("p",{className:"text-[var(--text-muted)]",children:["Cha c bng lng no."," ",t.jsx(ca,{to:"/bang-luong",className:"text-[var(--accent)] hover:underline",children:"To bng lng mi"})]})]})]})]})}function e6(){const{coVaiTro:e}=as(),n=e("ADMIN"),a=Bt(),[r,s]=E.useState(!1),[l,o]=E.useState(new Date().getFullYear()),[d,u]=E.useState(),[x,m]=E.useState({thang:new Date().getMonth()+1,nam:new Date().getFullYear(),phongBanIds:[],tenBangLuong:""}),{data:f,isLoading:p}=Ie({queryKey:["bang-luong",l,d],queryFn:()=>Dr.layDanhSach({nam:l,phongBanId:d})}),b=(Array.isArray(f)?f:(f==null?void 0:f.data)||[]).filter(w=>w&&w.id),{data:g}=Ie({queryKey:["phong-ban"],queryFn:cn.layTatCa}),y=De({mutationFn:async w=>{const _=await Promise.allSettled(w.phongBanIds.map(P=>Dr.taoMoi({thang:w.thang,nam:w.nam,phongBanId:P,tenBangLuong:w.phongBanIds.length>1?"":w.tenBangLuong}))),L=_.filter(P=>P.status==="fulfilled"),C=_.filter(P=>P.status==="rejected");return{successful:L,failed:C,total:_.length}},onSuccess:({successful:w,failed:_,total:L})=>{var C,P,F;if(a.invalidateQueries({queryKey:["bang-luong"]}),w.length>0&&_.length===0)ie.success(`To ${w.length} bng lng thnh cng!`);else if(w.length>0&&_.length>0)ie.success(`To ${w.length}/${L} bng lng thnh cng!`),ie.error(`${_.length} bng lng to tht bi`);else if(_.length>0){const O=((F=(P=(C=_[0].reason)==null?void 0:C.response)==null?void 0:P.data)==null?void 0:F.message)||"C li xy ra";ie.error(O)}w.length>0&&(s(!1),m({thang:new Date().getMonth()+1,nam:new Date().getFullYear(),phongBanIds:[],tenBangLuong:""}))},onError:w=>{var _,L;ie.error(((L=(_=w.response)==null?void 0:_.data)==null?void 0:L.message)||"C li xy ra")}}),N=De({mutationFn:({id:w,force:_})=>Dr.xoa(w,_),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-luong"]}),ie.success("Xa bng lng thnh cng!")},onError:w=>{var _,L;ie.error(((L=(_=w.response)==null?void 0:_.data)==null?void 0:L.message)||"C li xy ra")}}),k=()=>{if(x.phongBanIds.length===0){ie.error("Vui lng chn t nht mt phng ban");return}y.mutate(x)},T=(w,_,L=!1)=>{if(!L&&_!=="NHAP"){ie.error("Ch c th xa bng lng ang  trng thi Nhp. ADMIN c th xa bng  kha.");return}confirm(L?" BN ANG XA BNG LNG  KHA! Hnh ng ny khng th hon tc. Bn c chc chn?":"Bn c chc mun xa bng lng ny?")&&N.mutate({id:w,force:L})},S=w=>{switch(w){case"NHAP":return t.jsx(Tt,{variant:"neutral",dot:!0,children:"ang nhp"});case"DA_CHOT":return t.jsx(Tt,{variant:"success",dot:!0,children:" cht"});case"KHOA":return t.jsx(Tt,{variant:"info",dot:!0,children:" kha"});default:return t.jsx(Tt,{variant:"neutral",children:z5(w)})}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-[var(--text-primary)] flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-xl bg-[var(--accent)]/10 flex items-center justify-center",children:t.jsx(Ys,{size:22,className:"text-[var(--accent)]"})}),"Qun l Bng lng"]}),t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1 ml-13",children:"To v qun l bng lng hng thng"})]}),t.jsx(mt,{onClick:()=>s(!0),icon:t.jsx(St,{size:18}),children:"To bng lng mi"})]}),t.jsx(st,{variant:"glass",padding:"md",children:t.jsxs("div",{className:"flex gap-4 items-end flex-wrap",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-[var(--text-muted)] mb-1.5 uppercase tracking-wider",children:"Nm"}),t.jsx("select",{value:l,onChange:w=>o(Number(w.target.value)),className:`
                h-10 px-4 rounded-xl
                bg-[var(--bg-1)] border border-[var(--border)]
                text-[var(--text-primary)]
                focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                transition-all
              `,children:[2024,2025,2026,2027].map(w=>t.jsx("option",{value:w,children:w},w))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-[var(--text-muted)] mb-1.5 uppercase tracking-wider",children:"Phng ban"}),t.jsxs("select",{value:d||"",onChange:w=>u(w.target.value?Number(w.target.value):void 0),className:`
                h-10 px-4 rounded-xl min-w-[200px]
                bg-[var(--bg-1)] border border-[var(--border)]
                text-[var(--text-primary)]
                focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                transition-all
              `,children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),g==null?void 0:g.map(w=>t.jsx("option",{value:w.id,children:w.tenPhongBan},w.id))]})]})]})}),t.jsx(st,{variant:"glass",padding:"none",children:p?t.jsx("div",{className:"flex items-center justify-center py-16",children:t.jsx("div",{className:"w-8 h-8 border-2 border-[var(--accent)] border-t-transparent rounded-full animate-spin"})}):b&&b.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-[var(--border)] bg-[var(--bg-2)]",children:[t.jsx("th",{className:"text-left py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Tn bng lng"}),t.jsx("th",{className:"text-center py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"K lng"}),t.jsx("th",{className:"text-left py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Phng ban"}),t.jsx("th",{className:"text-right py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"S NV"}),t.jsx("th",{className:"text-right py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Tng thu nhp"}),t.jsx("th",{className:"text-right py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Thc lnh"}),t.jsx("th",{className:"text-center py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Trng thi"}),t.jsx("th",{className:"text-center py-4 px-5 text-xs font-semibold text-[var(--text-muted)] uppercase tracking-wider",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-[var(--border)]",children:b.map(w=>{var _;return t.jsxs("tr",{className:"hover:bg-[var(--bg-2)] transition-colors group",children:[t.jsx("td",{className:"py-4 px-5",children:t.jsx(ca,{to:`/bang-luong/${w.id}`,className:"font-medium text-[var(--text-primary)] group-hover:text-[var(--accent)] transition-colors",children:w.tenBangLuong||`Bng lng T${w.thang}/${w.nam}`})}),t.jsx("td",{className:"py-4 px-5 text-center",children:t.jsxs("span",{className:"inline-flex items-center gap-1.5 text-[var(--text-secondary)]",children:[t.jsx(At,{size:14,className:"text-[var(--text-muted)]"}),"T",w.thang,"/",w.nam]})}),t.jsx("td",{className:"py-4 px-5 text-[var(--text-secondary)]",children:((_=w.phongBan)==null?void 0:_.tenPhongBan)||""}),t.jsx("td",{className:"py-4 px-5 text-right text-[var(--text-secondary)] tabular-nums",children:w.soNhanVien||0}),t.jsx("td",{className:"py-4 px-5 text-right text-[var(--text-secondary)] tabular-nums",children:et(w.tongThuNhap)}),t.jsx("td",{className:"py-4 px-5 text-right font-semibold text-[var(--accent)] tabular-nums",children:et(w.thucLinh)}),t.jsx("td",{className:"py-4 px-5 text-center",children:S(w.trangThai)}),t.jsx("td",{className:"py-4 px-5",children:t.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t.jsx(ca,{to:`/bang-luong/${w.id}`,className:"p-2 text-[var(--text-muted)] hover:text-[var(--accent)] hover:bg-[var(--accent)]/10 rounded-lg transition-colors",title:"Xem chi tit",children:t.jsx(ii,{size:18})}),w.trangThai==="NHAP"&&t.jsx("button",{onClick:()=>T(w.id,w.trangThai),className:"p-2 text-[var(--text-muted)] hover:text-[#FF4D6D] hover:bg-[#FF4D6D]/10 rounded-lg transition-colors",title:"Xa",children:t.jsx(Rr,{size:18})}),w.trangThai==="DA_CHOT"&&t.jsx("span",{className:"p-2 text-[var(--text-disabled)]",title:" cht",children:t.jsx(Js,{size:18})}),w.trangThai==="KHOA"&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"p-2 text-[var(--text-disabled)]",title:" kha",children:t.jsx(Js,{size:18})}),n&&t.jsx("button",{onClick:()=>T(w.id,w.trangThai,!0),className:"p-2 text-[#FF4D6D] hover:text-white hover:bg-[#FF4D6D] rounded-lg transition-colors",title:"ADMIN: Xa bng  kha",children:t.jsx(aa,{size:18})})]})]})})]},w.id)})})]})}):t.jsxs("div",{className:"text-center py-16",children:[t.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl bg-[var(--bg-2)] flex items-center justify-center text-[var(--text-muted)]",children:t.jsx(Ys,{size:28})}),t.jsx("p",{className:"text-[var(--text-muted)]",children:"Cha c bng lng no"}),t.jsxs(mt,{onClick:()=>s(!0),variant:"secondary",size:"sm",className:"mt-4",children:[t.jsx(St,{size:16}),"To bng lng u tin"]})]})}),t.jsxs(ks,{isOpen:r,onClose:()=>s(!1),size:"md",children:[t.jsx(Ts,{title:"To bng lng mi",subtitle:"Chn k lng v phng ban  to bng lng",icon:t.jsx(Ys,{size:24})}),t.jsx(Cs,{children:t.jsxs("div",{className:"space-y-5",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-1.5",children:"Thng"}),t.jsx("select",{value:x.thang,onChange:w=>m({...x,thang:Number(w.target.value)}),className:`
                    w-full h-10 px-4 rounded-xl
                    bg-[var(--bg-1)] border border-[var(--border)]
                    text-[var(--text-primary)]
                    focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                  `,children:Array.from({length:12},(w,_)=>_+1).map(w=>t.jsxs("option",{value:w,children:["Thng ",w]},w))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-1.5",children:"Nm"}),t.jsx("select",{value:x.nam,onChange:w=>m({...x,nam:Number(w.target.value)}),className:`
                    w-full h-10 px-4 rounded-xl
                    bg-[var(--bg-1)] border border-[var(--border)]
                    text-[var(--text-primary)]
                    focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                  `,children:[2024,2025,2026,2027].map(w=>t.jsx("option",{value:w,children:w},w))})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-1.5",children:["Phng ban ",t.jsx("span",{className:"text-[#FF4D6D]",children:"*"}),t.jsx("span",{className:"text-[var(--text-muted)] font-normal ml-1",children:"(chn nhiu)"})]}),t.jsxs("div",{className:"border border-[var(--border)] rounded-xl max-h-48 overflow-y-auto bg-[var(--bg-1)] modal-scroll",children:[t.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-[var(--accent-light)] cursor-pointer border-b border-[var(--border)] transition-colors",children:[t.jsx("input",{type:"checkbox",checked:g&&x.phongBanIds.length===g.length,onChange:w=>{w.target.checked?m({...x,phongBanIds:(g==null?void 0:g.map(_=>_.id))||[]}):m({...x,phongBanIds:[]})},className:"flex-shrink-0"}),t.jsxs("span",{className:"font-medium text-[var(--accent)]",children:["Chn tt c (",(g==null?void 0:g.length)||0," phng ban)"]})]}),g==null?void 0:g.map(w=>t.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-[var(--accent-light)] cursor-pointer transition-colors",children:[t.jsx("input",{type:"checkbox",checked:x.phongBanIds.includes(w.id),onChange:_=>{_.target.checked?m({...x,phongBanIds:[...x.phongBanIds,w.id]}):m({...x,phongBanIds:x.phongBanIds.filter(L=>L!==w.id)})},className:"flex-shrink-0"}),t.jsx("span",{className:"text-[var(--text-primary)] flex-1",children:w.tenPhongBan}),x.phongBanIds.includes(w.id)&&t.jsx(Or,{className:"w-4 h-4 text-[var(--accent)] flex-shrink-0"})]},w.id))]}),x.phongBanIds.length>0&&t.jsxs("p",{className:"text-xs text-[var(--accent)] mt-1.5 font-medium",children:["  chn: ",x.phongBanIds.length," phng ban"]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-[var(--text-secondary)] mb-1.5",children:["Tn bng lng",t.jsx("span",{className:"text-[var(--text-muted)] font-normal ml-1",children:"(tu chn)"})]}),t.jsx("input",{type:"text",value:x.tenBangLuong,onChange:w=>m({...x,tenBangLuong:w.target.value}),className:`
                  w-full h-10 px-4 rounded-xl
                  bg-[var(--bg-1)] border border-[var(--border)]
                  text-[var(--text-primary)] placeholder:text-[var(--text-disabled)]
                  focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20
                `,placeholder:"T ng to nu  trng"})]})]})}),t.jsxs(ei,{children:[t.jsx(mt,{variant:"secondary",onClick:()=>s(!1),children:"Hu"}),t.jsx(mt,{onClick:k,loading:y.isPending,icon:t.jsx(St,{size:16}),children:"To bng lng"})]})]})]})}function t6(e,n){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const a=document.implementation.createHTMLDocument(),r=a.createElement("base"),s=a.createElement("a");return a.head.appendChild(r),a.body.appendChild(s),n&&(r.href=n),s.href=e,s.href}const n6=(()=>{let e=0;const n=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${n()}${e}`)})();function nl(e){const n=[];for(let a=0,r=e.length;a<r;a++)n.push(e[a]);return n}let Xo=null;function Xj(e={}){return Xo||(e.includeStyleProperties?(Xo=e.includeStyleProperties,Xo):(Xo=nl(window.getComputedStyle(document.documentElement)),Xo))}function b0(e,n){const r=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(n);return r?parseFloat(r.replace("px","")):0}function a6(e){const n=b0(e,"border-left-width"),a=b0(e,"border-right-width");return e.clientWidth+n+a}function r6(e){const n=b0(e,"border-top-width"),a=b0(e,"border-bottom-width");return e.clientHeight+n+a}function Qj(e,n={}){const a=n.width||a6(e),r=n.height||r6(e);return{width:a,height:r}}function s6(){let e,n;try{n=process}catch{}const a=n&&n.env?n.env.devicePixelRatio:null;return a&&(e=parseInt(a,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const lr=16384;function i6(e){(e.width>lr||e.height>lr)&&(e.width>lr&&e.height>lr?e.width>e.height?(e.height*=lr/e.width,e.width=lr):(e.width*=lr/e.height,e.height=lr):e.width>lr?(e.height*=lr/e.width,e.width=lr):(e.width*=lr/e.height,e.height=lr))}function N0(e){return new Promise((n,a)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>n(r))})},r.onerror=a,r.crossOrigin="anonymous",r.decoding="async",r.src=e})}async function l6(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(n=>`data:image/svg+xml;charset=utf-8,${n}`)}async function o6(e,n,a){const r="http://www.w3.org/2000/svg",s=document.createElementNS(r,"svg"),l=document.createElementNS(r,"foreignObject");return s.setAttribute("width",`${n}`),s.setAttribute("height",`${a}`),s.setAttribute("viewBox",`0 0 ${n} ${a}`),l.setAttribute("width","100%"),l.setAttribute("height","100%"),l.setAttribute("x","0"),l.setAttribute("y","0"),l.setAttribute("externalResourcesRequired","true"),s.appendChild(l),l.appendChild(e),l6(s)}const er=(e,n)=>{if(e instanceof n)return!0;const a=Object.getPrototypeOf(e);return a===null?!1:a.constructor.name===n.name||er(a,n)};function c6(e){const n=e.getPropertyValue("content");return`${e.cssText} content: '${n.replace(/'|"/g,"")}';`}function d6(e,n){return Xj(n).map(a=>{const r=e.getPropertyValue(a),s=e.getPropertyPriority(a);return`${a}: ${r}${s?" !important":""};`}).join(" ")}function u6(e,n,a,r){const s=`.${e}:${n}`,l=a.cssText?c6(a):d6(a,r);return document.createTextNode(`${s}{${l}}`)}function _b(e,n,a,r){const s=window.getComputedStyle(e,a),l=s.getPropertyValue("content");if(l===""||l==="none")return;const o=n6();try{n.className=`${n.className} ${o}`}catch{return}const d=document.createElement("style");d.appendChild(u6(o,a,s,r)),n.appendChild(d)}function h6(e,n,a){_b(e,n,":before",a),_b(e,n,":after",a)}const Eb="application/font-woff",Db="image/jpeg",x6={woff:Eb,woff2:Eb,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Db,jpeg:Db,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function m6(e){const n=/\.([^./]*?)$/g.exec(e);return n?n[1]:""}function dg(e){const n=m6(e).toLowerCase();return x6[n]||""}function f6(e){return e.split(/,/)[1]}function pp(e){return e.search(/^(data:)/)!==-1}function p6(e,n){return`data:${n};base64,${e}`}async function Yj(e,n,a){const r=await fetch(e,n);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const s=await r.blob();return new Promise((l,o)=>{const d=new FileReader;d.onerror=o,d.onloadend=()=>{try{l(a({res:r,result:d.result}))}catch(u){o(u)}},d.readAsDataURL(s)})}const lf={};function g6(e,n,a){let r=e.replace(/\?.*/,"");return a&&(r=e),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),n?`[${n}]${r}`:r}async function ug(e,n,a){const r=g6(e,n,a.includeQueryParams);if(lf[r]!=null)return lf[r];a.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let s;try{const l=await Yj(e,a.fetchRequestInit,({res:o,result:d})=>(n||(n=o.headers.get("Content-Type")||""),f6(d)));s=p6(l,n)}catch(l){s=a.imagePlaceholder||"";let o=`Failed to fetch resource: ${e}`;l&&(o=typeof l=="string"?l:l.message),o&&console.warn(o)}return lf[r]=s,s}async function y6(e){const n=e.toDataURL();return n==="data:,"?e.cloneNode(!1):N0(n)}async function v6(e,n){if(e.currentSrc){const l=document.createElement("canvas"),o=l.getContext("2d");l.width=e.clientWidth,l.height=e.clientHeight,o==null||o.drawImage(e,0,0,l.width,l.height);const d=l.toDataURL();return N0(d)}const a=e.poster,r=dg(a),s=await ug(a,r,n);return N0(s)}async function b6(e,n){var a;try{if(!((a=e==null?void 0:e.contentDocument)===null||a===void 0)&&a.body)return await tx(e.contentDocument.body,n,!0)}catch{}return e.cloneNode(!1)}async function N6(e,n){return er(e,HTMLCanvasElement)?y6(e):er(e,HTMLVideoElement)?v6(e,n):er(e,HTMLIFrameElement)?b6(e,n):e.cloneNode(Jj(e))}const j6=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",Jj=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function w6(e,n,a){var r,s;if(Jj(n))return n;let l=[];return j6(e)&&e.assignedNodes?l=nl(e.assignedNodes()):er(e,HTMLIFrameElement)&&(!((r=e.contentDocument)===null||r===void 0)&&r.body)?l=nl(e.contentDocument.body.childNodes):l=nl(((s=e.shadowRoot)!==null&&s!==void 0?s:e).childNodes),l.length===0||er(e,HTMLVideoElement)||await l.reduce((o,d)=>o.then(()=>tx(d,a)).then(u=>{u&&n.appendChild(u)}),Promise.resolve()),n}function k6(e,n,a){const r=n.style;if(!r)return;const s=window.getComputedStyle(e);s.cssText?(r.cssText=s.cssText,r.transformOrigin=s.transformOrigin):Xj(a).forEach(l=>{let o=s.getPropertyValue(l);l==="font-size"&&o.endsWith("px")&&(o=`${Math.floor(parseFloat(o.substring(0,o.length-2)))-.1}px`),er(e,HTMLIFrameElement)&&l==="display"&&o==="inline"&&(o="block"),l==="d"&&n.getAttribute("d")&&(o=`path(${n.getAttribute("d")})`),r.setProperty(l,o,s.getPropertyPriority(l))})}function T6(e,n){er(e,HTMLTextAreaElement)&&(n.innerHTML=e.value),er(e,HTMLInputElement)&&n.setAttribute("value",e.value)}function C6(e,n){if(er(e,HTMLSelectElement)){const r=Array.from(n.children).find(s=>e.value===s.getAttribute("value"));r&&r.setAttribute("selected","")}}function S6(e,n,a){return er(n,Element)&&(k6(e,n,a),h6(e,n,a),T6(e,n),C6(e,n)),n}async function _6(e,n){const a=e.querySelectorAll?e.querySelectorAll("use"):[];if(a.length===0)return e;const r={};for(let l=0;l<a.length;l++){const d=a[l].getAttribute("xlink:href");if(d){const u=e.querySelector(d),x=document.querySelector(d);!u&&x&&!r[d]&&(r[d]=await tx(x,n,!0))}}const s=Object.values(r);if(s.length){const l="http://www.w3.org/1999/xhtml",o=document.createElementNS(l,"svg");o.setAttribute("xmlns",l),o.style.position="absolute",o.style.width="0",o.style.height="0",o.style.overflow="hidden",o.style.display="none";const d=document.createElementNS(l,"defs");o.appendChild(d);for(let u=0;u<s.length;u++)d.appendChild(s[u]);e.appendChild(o)}return e}async function tx(e,n,a){return!a&&n.filter&&!n.filter(e)?null:Promise.resolve(e).then(r=>N6(r,n)).then(r=>w6(e,r,n)).then(r=>S6(e,r,n)).then(r=>_6(r,n))}const Zj=/url\((['"]?)([^'"]+?)\1\)/g,E6=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,D6=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function A6(e){const n=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${n})(['"]?\\))`,"g")}function F6(e){const n=[];return e.replace(Zj,(a,r,s)=>(n.push(s),a)),n.filter(a=>!pp(a))}async function L6(e,n,a,r,s){try{const l=a?t6(n,a):n,o=dg(n);let d;return s||(d=await ug(l,o,r)),e.replace(A6(n),`$1${d}$3`)}catch{}return e}function P6(e,{preferredFontFormat:n}){return n?e.replace(D6,a=>{for(;;){const[r,,s]=E6.exec(a)||[];if(!s)return"";if(s===n)return`src: ${r};`}}):e}function ew(e){return e.search(Zj)!==-1}async function tw(e,n,a){if(!ew(e))return e;const r=P6(e,a);return F6(r).reduce((l,o)=>l.then(d=>L6(d,o,n,a)),Promise.resolve(r))}async function Qo(e,n,a){var r;const s=(r=n.style)===null||r===void 0?void 0:r.getPropertyValue(e);if(s){const l=await tw(s,null,a);return n.style.setProperty(e,l,n.style.getPropertyPriority(e)),!0}return!1}async function I6(e,n){await Qo("background",e,n)||await Qo("background-image",e,n),await Qo("mask",e,n)||await Qo("-webkit-mask",e,n)||await Qo("mask-image",e,n)||await Qo("-webkit-mask-image",e,n)}async function O6(e,n){const a=er(e,HTMLImageElement);if(!(a&&!pp(e.src))&&!(er(e,SVGImageElement)&&!pp(e.href.baseVal)))return;const r=a?e.src:e.href.baseVal,s=await ug(r,dg(r),n);await new Promise((l,o)=>{e.onload=l,e.onerror=n.onImageErrorHandler?(...u)=>{try{l(n.onImageErrorHandler(...u))}catch(x){o(x)}}:o;const d=e;d.decode&&(d.decode=l),d.loading==="lazy"&&(d.loading="eager"),a?(e.srcset="",e.src=s):e.href.baseVal=s})}async function M6(e,n){const r=nl(e.childNodes).map(s=>nw(s,n));await Promise.all(r).then(()=>e)}async function nw(e,n){er(e,Element)&&(await I6(e,n),await O6(e,n),await M6(e,n))}function R6(e,n){const{style:a}=e;n.backgroundColor&&(a.backgroundColor=n.backgroundColor),n.width&&(a.width=`${n.width}px`),n.height&&(a.height=`${n.height}px`);const r=n.style;return r!=null&&Object.keys(r).forEach(s=>{a[s]=r[s]}),e}const Ab={};async function Fb(e){let n=Ab[e];if(n!=null)return n;const r=await(await fetch(e)).text();return n={url:e,cssText:r},Ab[e]=n,n}async function Lb(e,n){let a=e.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,l=(a.match(/url\([^)]+\)/g)||[]).map(async o=>{let d=o.replace(r,"$1");return d.startsWith("https://")||(d=new URL(d,e.url).href),Yj(d,n.fetchRequestInit,({result:u})=>(a=a.replace(o,`url(${u})`),[o,u]))});return Promise.all(l).then(()=>a)}function Pb(e){if(e==null)return[];const n=[],a=/(\/\*[\s\S]*?\*\/)/gi;let r=e.replace(a,"");const s=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const u=s.exec(r);if(u===null)break;n.push(u[0])}r=r.replace(s,"");const l=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,o="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",d=new RegExp(o,"gi");for(;;){let u=l.exec(r);if(u===null){if(u=d.exec(r),u===null)break;l.lastIndex=d.lastIndex}else d.lastIndex=l.lastIndex;n.push(u[0])}return n}async function B6(e,n){const a=[],r=[];return e.forEach(s=>{if("cssRules"in s)try{nl(s.cssRules||[]).forEach((l,o)=>{if(l.type===CSSRule.IMPORT_RULE){let d=o+1;const u=l.href,x=Fb(u).then(m=>Lb(m,n)).then(m=>Pb(m).forEach(f=>{try{s.insertRule(f,f.startsWith("@import")?d+=1:s.cssRules.length)}catch(p){console.error("Error inserting rule from remote css",{rule:f,error:p})}})).catch(m=>{console.error("Error loading remote css",m.toString())});r.push(x)}})}catch(l){const o=e.find(d=>d.href==null)||document.styleSheets[0];s.href!=null&&r.push(Fb(s.href).then(d=>Lb(d,n)).then(d=>Pb(d).forEach(u=>{o.insertRule(u,o.cssRules.length)})).catch(d=>{console.error("Error loading remote stylesheet",d)})),console.error("Error inlining remote css file",l)}}),Promise.all(r).then(()=>(e.forEach(s=>{if("cssRules"in s)try{nl(s.cssRules||[]).forEach(l=>{a.push(l)})}catch(l){console.error(`Error while reading CSS rules from ${s.href}`,l)}}),a))}function H6(e){return e.filter(n=>n.type===CSSRule.FONT_FACE_RULE).filter(n=>ew(n.style.getPropertyValue("src")))}async function V6(e,n){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const a=nl(e.ownerDocument.styleSheets),r=await B6(a,n);return H6(r)}function aw(e){return e.trim().replace(/["']/g,"")}function U6(e){const n=new Set;function a(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(l=>{n.add(aw(l))}),Array.from(r.children).forEach(l=>{l instanceof HTMLElement&&a(l)})}return a(e),n}async function K6(e,n){const a=await V6(e,n),r=U6(e);return(await Promise.all(a.filter(l=>r.has(aw(l.style.fontFamily))).map(l=>{const o=l.parentStyleSheet?l.parentStyleSheet.href:null;return tw(l.cssText,o,n)}))).join(`
`)}async function z6(e,n){const a=n.fontEmbedCSS!=null?n.fontEmbedCSS:n.skipFonts?null:await K6(e,n);if(a){const r=document.createElement("style"),s=document.createTextNode(a);r.appendChild(s),e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)}}async function $6(e,n={}){const{width:a,height:r}=Qj(e,n),s=await tx(e,n,!0);return await z6(s,n),await nw(s,n),R6(s,n),await o6(s,a,r)}async function G6(e,n={}){const{width:a,height:r}=Qj(e,n),s=await $6(e,n),l=await N0(s),o=document.createElement("canvas"),d=o.getContext("2d"),u=n.pixelRatio||s6(),x=n.canvasWidth||a,m=n.canvasHeight||r;return o.width=x*u,o.height=m*u,n.skipAutoScale||i6(o),o.style.width=`${x}`,o.style.height=`${m}`,n.backgroundColor&&(d.fillStyle=n.backgroundColor,d.fillRect(0,0,o.width,o.height)),d.drawImage(l,0,0,o.width,o.height),o}async function q6(e,n={}){return(await G6(e,n)).toDataURL()}const kd=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),rw=E.forwardRef(({data:e},n)=>{const a=e.cacKhoanLuong.filter(s=>s.loai==="THU_NHAP"),r=e.cacKhoanLuong.filter(s=>s.loai==="KHAU_TRU");return t.jsxs("div",{ref:n,className:"bg-white rounded-xl shadow-lg overflow-hidden max-w-2xl mx-auto",style:{width:"700px",fontFamily:"system-ui, -apple-system, sans-serif"},children:[t.jsxs("div",{className:"text-white text-center py-8 px-6",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[t.jsx("h1",{className:"text-3xl font-bold mb-1",children:"PHIU LNG"}),t.jsxs("p",{className:"text-lg opacity-90",children:["Thng ",e.thang," / ",e.nam]})]}),t.jsxs("div",{className:"text-center py-4 px-6 border-b-2 border-dashed border-gray-200 bg-gray-50",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"CNG TY TNHH ABC"}),t.jsx("p",{className:"text-sm text-gray-600",children:"123 ng ABC, Qun 1, TP.HCM"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 p-6 bg-gray-50 border-b border-gray-200",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500",children:"H v tn"}),t.jsx("p",{className:"font-semibold text-gray-800",children:e.hoTen})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500",children:"M nhn vin"}),t.jsx("p",{className:"font-semibold text-gray-800",children:e.maNhanVien})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500",children:"Phng ban"}),t.jsx("p",{className:"font-semibold text-gray-800",children:e.phongBan})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500",children:"Chc v"}),t.jsx("p",{className:"font-semibold text-gray-800",children:e.chucVu||"Nhn vin"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("span",{className:"text-xs text-gray-500",children:"Ngy cng thc t"}),t.jsxs("p",{className:"font-semibold text-gray-800",children:[t.jsx("span",{className:"text-blue-600",children:e.ngayCongThucTe})," / ",e.ngayCongLyThuyet," ngy"]})]})]}),t.jsxs("div",{className:"p-6 border-b border-gray-100",children:[t.jsx("h3",{className:"text-base font-bold text-gray-800 mb-4 pb-2 border-b-2 border-green-500 inline-block",children:"THU NHP"}),t.jsx("div",{className:"space-y-3",children:a.map((s,l)=>t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-600",children:s.tenKhoan}),t.jsx("span",{className:"font-medium text-green-600",children:kd(s.soTien)})]},l))})]}),t.jsxs("div",{className:"p-6 border-b border-gray-100",children:[t.jsx("h3",{className:"text-base font-bold text-gray-800 mb-4 pb-2 border-b-2 border-red-500 inline-block",children:"KHU TR"}),t.jsx("div",{className:"space-y-3",children:r.length>0?r.map((s,l)=>t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-600",children:s.tenKhoan}),t.jsxs("span",{className:"font-medium text-red-600",children:["-",kd(s.soTien)]})]},l)):t.jsx("p",{className:"text-gray-400 italic",children:"Khng c khon khu tr"})})]}),t.jsxs("div",{className:"p-6 text-white",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:[t.jsxs("div",{className:"flex justify-between items-center py-2",children:[t.jsx("span",{className:"opacity-90",children:"Tng thu nhp:"}),t.jsx("span",{className:"font-semibold",children:kd(e.tongThuNhap)})]}),t.jsxs("div",{className:"flex justify-between items-center py-2",children:[t.jsx("span",{className:"opacity-90",children:"Tng khu tr:"}),t.jsxs("span",{className:"font-semibold",children:["-",kd(e.tongKhauTru)]})]}),t.jsxs("div",{className:"flex justify-between items-center pt-4 mt-4 border-t border-white/30",children:[t.jsx("span",{className:"text-xl font-bold",children:"THC LNH:"}),t.jsx("span",{className:"text-2xl font-bold",children:kd(e.thucLinh)})]})]}),t.jsxs("div",{className:"text-center py-4 px-6 text-sm text-gray-500 border-t border-gray-100",children:[t.jsx("p",{children:"Phiu lng c to t ng bi h thng tnh lng."}),t.jsx("p",{children:"Nu c thc mc, vui lng lin h phng Nhn s."})]})]})});rw.displayName="PhieuLuong";function W6({isOpen:e,onClose:n,bangLuongId:a,nhanVienId:r,hoTen:s}){const l=E.useRef(null),[o,d]=E.useState(!1),{data:u,isLoading:x,error:m}=Ie({queryKey:["phieu-luong",a,r],queryFn:()=>fp.layPhieuLuong(a,r),enabled:e}),f=De({mutationFn:()=>fp.guiPhieuLuong(a,r),onSuccess:g=>{g.success?ie.success(g.message):ie.error(g.message)},onError:()=>{ie.error("C li khi gi email")}}),p=E.useCallback(async()=>{if(!(!l.current||!u)){d(!0);try{const g=await q6(l.current,{cacheBust:!0,pixelRatio:2,backgroundColor:"#ffffff"}),y=document.createElement("a");y.download=`phieu-luong-${u.maNhanVien}-thang-${u.thang}-${u.nam}.png`,y.href=g,y.click(),ie.success(" xut phiu lng thnh cng!")}catch(g){console.error("Export error:",g),ie.error("C li khi xut nh")}finally{d(!1)}}},[u]),b=E.useCallback(()=>{if(!(u!=null&&u.email)){ie.error("Nhn vin khng c email");return}f.mutate()},[u==null?void 0:u.email,f]);return e?t.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[t.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:n}),t.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col mx-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gray-50",children:[t.jsxs("h2",{className:"text-lg font-bold text-gray-800",children:["Phiu lng - ",s]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:p,disabled:o||x,className:"btn btn-secondary flex items-center gap-2",children:[o?t.jsx(Mn,{size:18,className:"animate-spin"}):t.jsx(E_,{size:18}),"Xut nh"]}),t.jsxs("button",{onClick:b,disabled:f.isPending||x||!(u!=null&&u.email),className:"btn btn-primary flex items-center gap-2",title:u!=null&&u.email?"Gi phiu lng qua email":"Nhn vin khng c email",children:[f.isPending?t.jsx(Mn,{size:18,className:"animate-spin"}):t.jsx(Yp,{size:18}),"Gi email"]}),t.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-200 rounded-lg",children:t.jsx(mn,{size:20})})]})]}),t.jsx("div",{className:"flex-1 overflow-auto p-6 bg-gray-100",children:x?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx(Mn,{size:40,className:"animate-spin text-blue-500"})}):m?t.jsx("div",{className:"text-center py-8",children:t.jsx("p",{className:"text-red-500",children:"C li khi ti phiu lng"})}):u?t.jsx(rw,{ref:l,data:u}):null}),u&&t.jsxs("div",{className:"p-3 bg-gray-50 border-t text-sm text-gray-600 flex items-center justify-between",children:[t.jsxs("span",{children:["Email: ",u.email||t.jsx("span",{className:"italic text-gray-400",children:"Cha c"})]}),t.jsxs("span",{children:["Thc lnh: ",t.jsx("strong",{className:"text-green-600",children:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(u.thucLinh)})]})]})]})]}):null}function X6({ngayCong:e,onClose:n,onSave:a,isLoading:r}){var m,f,p;const[s,l]=E.useState(((m=e==null?void 0:e.ngayCongDieuChinh)==null?void 0:m.toString())||""),[o,d]=E.useState((e==null?void 0:e.ghiChu)||"");if(!e)return null;const u=e.ngayCongDieuChinh?Number(e.ngayCongDieuChinh):Number(e.soCongThucTe)+Number(e.soNgayNghiPhep),x=async b=>{if(b.preventDefault(),!s)return;const g=parseFloat(s);if(isNaN(g)||g<0){alert("S ngy cng khng hp l");return}await a(g,o||void 0)};return t.jsx("div",{className:"modal-overlay",onClick:n,children:t.jsxs("div",{className:"modal-content max-w-lg",onClick:b=>b.stopPropagation(),children:[t.jsxs("div",{className:"modal-header",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(At,{className:"w-5 h-5"}),t.jsx("h3",{className:"text-lg font-semibold",children:"iu chnh ngy cng"})]}),t.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:t.jsx(mn,{className:"w-5 h-5"})})]}),t.jsxs("form",{onSubmit:x,children:[t.jsxs("div",{className:"modal-body space-y-4",children:[t.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-sm text-gray-600",children:"Nhn vin"}),t.jsx("div",{className:"font-semibold text-gray-900",children:((f=e.nhanVien)==null?void 0:f.hoTen)||"N/A"}),t.jsx("div",{className:"text-sm text-gray-500",children:((p=e.nhanVien)==null?void 0:p.maNhanVien)||"N/A"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Ngy cng l thuyt"}),t.jsx("div",{className:"text-xl font-bold text-blue-700",children:Number(e.ngayCongLyThuyet).toFixed(1)})]}),t.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"S cng thc t"}),t.jsx("div",{className:"text-xl font-bold text-green-700",children:Number(e.soCongThucTe).toFixed(1)})]}),t.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Ngh c php"}),t.jsx("div",{className:"text-xl font-bold text-yellow-700",children:Number(e.soNgayNghiPhep).toFixed(1)})]}),t.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[t.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Ngh khng php"}),t.jsx("div",{className:"text-xl font-bold text-red-700",children:Number(e.soNgayNghiKhongPhep).toFixed(1)})]})]}),t.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border-2 border-purple-200",children:[t.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Ngy cng hin ti (dng  tnh lng)"}),t.jsxs("div",{className:"text-2xl font-bold text-purple-700",children:[u.toFixed(1)," ngy"]}),e.ngayCongDieuChinh&&t.jsx("div",{className:"text-xs text-purple-600 mt-1",children:"  iu chnh th cng"})]}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsx("label",{className:"label",children:t.jsx("span",{className:"label-text font-semibold",children:"iu chnh ngy cng mi"})}),t.jsx("input",{type:"number",step:"0.5",min:"0",max:Number(e.ngayCongLyThuyet),className:"input input-bordered w-full",value:s,onChange:b=>l(b.target.value),placeholder:"Nhp s ngy cng",required:!0}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Nhp s ngy cng mi  iu chnh th cng"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"label",children:t.jsx("span",{className:"label-text font-semibold",children:"Ghi ch"})}),t.jsx("textarea",{className:"textarea textarea-bordered w-full",rows:3,value:o,onChange:b=>d(b.target.value),placeholder:"L do iu chnh..."})]}),t.jsxs("div",{className:"flex items-start gap-2 bg-yellow-50 p-3 rounded-lg border border-yellow-200",children:[t.jsx(dl,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"text-sm text-yellow-800",children:[t.jsx("div",{className:"font-semibold mb-1",children:"Lu :"}),t.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[t.jsx("li",{children:"iu chnh ngy cng s nh hng n lng c bn"}),t.jsx("li",{children:"Nn c l do r rng trong phn ghi ch"}),t.jsx("li",{children:"C th xa iu chnh  tr v tnh t ng"})]})]})]})]}),t.jsxs("div",{className:"modal-footer",children:[t.jsx("button",{type:"button",onClick:n,className:"btn btn-ghost",children:"Hy"}),t.jsx("button",{type:"submit",className:"btn btn-primary",disabled:r||!s,children:r?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"loading loading-spinner loading-sm"}),"ang lu..."]}):t.jsxs(t.Fragment,{children:[t.jsx(al,{className:"w-4 h-4"}),"Lu iu chnh"]})})]})]})]})})}function Q6(){const{id:e}=z0(),n=mr(),a=Bt(),[r,s]=E.useState(null),[l,o]=E.useState(new Map),[d,u]=E.useState(!1),[x,m]=E.useState(!1),[f,p]=E.useState(""),[b,g]=E.useState(null),[y,N]=E.useState(null),{data:k,isLoading:T}=Ie({queryKey:["bang-luong",e],queryFn:()=>Dr.layTheoId(Number(e)),enabled:!!e}),{data:S}=Ie({queryKey:["ngay-cong",e],queryFn:()=>Cb.layTatCa(Number(e)),enabled:!!e}),{data:w}=Ie({queryKey:["bang-luong-lich-su",e],queryFn:()=>Dr.layLichSu(Number(e)),enabled:!!e&&d}),_=De({mutationFn:Dr.capNhatNhieuChiTiet,onSuccess:()=>{a.invalidateQueries({queryKey:["bang-luong",e]}),o(new Map),ie.success("Lu thay i thnh cng!")},onError:()=>{ie.error("C li khi lu")}}),L=De({mutationFn:({nguoiChot:M})=>Dr.chotBangLuong(Number(e),{nguoiChot:M}),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-luong",e]}),ie.success("Cht bng lng thnh cng!"),m(!1)},onError:()=>{ie.error("C li khi cht")}}),C=De({mutationFn:()=>Dr.moKhoa(Number(e)),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-luong",e]}),ie.success("M kha thnh cng!")}}),P=De({mutationFn:()=>fp.guiTatCa(Number(e)),onSuccess:M=>{M.success>0&&ie.success(` gi ${M.success} phiu lng thnh cng!`),M.failed>0&&ie.error(`${M.failed} phiu lng gi tht bi`)},onError:()=>{ie.error("C li khi gi phiu lng")}}),F=De({mutationFn:({nhanVienId:M,ngayCongMoi:I,ghiChu:V})=>Cb.dieuChinh(Number(e),M,{ngayCongMoi:I,ghiChu:V}),onSuccess:()=>{a.invalidateQueries({queryKey:["ngay-cong",e]}),a.invalidateQueries({queryKey:["bang-luong",e]}),ie.success("Cp nht ngy cng thnh cng!"),N(null)},onError:()=>{ie.error("C li khi cp nht ngy cng")}}),H=De({mutationFn:()=>Dr.tinhLaiLuong(Number(e)),onSuccess:M=>{a.invalidateQueries({queryKey:["bang-luong",e]}),ie.success(M.message)},onError:()=>{ie.error("C li khi tnh li lng")}}),O=M=>{const I=S==null?void 0:S.find(V=>V.nhanVienId===M);if(I)N(I);else{const V=k==null?void 0:k.danhSachNhanVien.find(J=>J.nhanVienId===M);if(V&&k){const J={id:0,bangLuongId:k.id,nhanVienId:M,ngayCongLyThuyet:k.ngayCongLyThuyet,soCongThucTe:V.ngayCongThucTe,soNgayNghiPhep:0,soNgayNghiKhongPhep:0,ngayCongDieuChinh:null,ghiChu:null,nhanVien:{id:M,maNhanVien:V.maNhanVien,hoTen:V.hoTen}};N(J)}else ie.error("Khng tm thy thng tin nhn vin")}},B=async(M,I)=>{y&&await F.mutateAsync({nhanVienId:y.nhanVienId,ngayCongMoi:M,ghiChu:I})},W=(M,I,V)=>{(k==null?void 0:k.trangThai)==="NHAP"&&s({nhanVienId:M,khoanLuongId:I,value:V.toString()})},ee=M=>{r&&s({...r,value:M})},q=()=>{var ge;if(!r||!k)return;const M=K5(r.value),I=`${r.nhanVienId}-${r.khoanLuongId}`,V=k.danhSachNhanVien.find(z=>z.nhanVienId===r.nhanVienId),J=((ge=V==null?void 0:V.cacKhoanLuong.find(z=>z.khoanLuongId===r.khoanLuongId))==null?void 0:ge.soTien)||0;if(M!==J){const z=new Map(l);z.set(I,{nhanVienId:r.nhanVienId,khoanLuongId:r.khoanLuongId,soTien:M}),o(z)}s(null)},fe=M=>{M.key==="Enter"?q():M.key==="Escape"&&s(null)},ne=()=>{if(l.size===0){ie("Khng c thay i  lu");return}const M=Array.from(l.values()).map(I=>({bangLuongId:Number(e),...I}));_.mutate(M)},Y=async()=>{try{const M=await d0.export(Number(e));$5(M.data,`bang-luong-${e}.xlsx`),ie.success("Xut file thnh cng!")}catch{ie.error("C li khi xut file")}},X=E.useCallback((M,I,V)=>{const J=`${M}-${I}`,ge=l.get(J);return ge?ge.soTien:V},[l]),xe=E.useCallback(M=>{let I=0,V=0;for(const J of M.cacKhoanLuong){const ge=X(M.nhanVienId,J.khoanLuongId,J.soTien);J.loai==="THU_NHAP"?I+=ge:V+=ge}return l.forEach(J=>{if(J.nhanVienId===M.nhanVienId&&!M.cacKhoanLuong.find(z=>z.khoanLuongId===J.khoanLuongId)){const z=k==null?void 0:k.danhSachKhoanLuong.find(le=>le.id===J.khoanLuongId);(z==null?void 0:z.loai)==="THU_NHAP"?I+=J.soTien:V+=J.soTien}}),{tongThuNhap:I,tongKhauTru:V,thucLinh:I-V}},[X,l,k==null?void 0:k.danhSachKhoanLuong]),K=l.size>0;if(E.useEffect(()=>{const M=I=>{if(K)return I.preventDefault(),I.returnValue="Bn c thay i cha lu. Bn c chc mun ri i?",I.returnValue};return window.addEventListener("beforeunload",M),()=>window.removeEventListener("beforeunload",M)},[K]),T)return t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"text-gray-500",children:"ang ti..."})});if(!k)return t.jsxs("div",{className:"text-center py-8",children:[t.jsx("p",{className:"text-gray-500",children:"Khng tm thy bng lng"}),t.jsx("button",{onClick:()=>n("/bang-luong"),className:"btn btn-primary mt-4",children:"Quay li"})]});const A=k.trangThai==="NHAP";return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>n("/bang-luong"),className:"p-2 hover:bg-gray-200 rounded-lg",children:t.jsx(q0,{size:20})}),t.jsxs("div",{children:[t.jsxs("h1",{className:"text-xl font-bold text-gray-800",children:["Bng lng ",k.phongBan.tenPhongBan]}),t.jsxs("p",{className:"text-sm text-gray-500",children:["Thng ",k.thang,"/",k.nam]})]}),t.jsxs("span",{className:`badge ${k.trangThai==="NHAP"?"badge-nhap":k.trangThai==="DA_CHOT"?"badge-da-chot":"badge-khoa"}`,children:[k.trangThai==="NHAP"&&"ang nhp",k.trangThai==="DA_CHOT"&&" cht",k.trangThai==="KHOA"&&" kha"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[l.size>0&&t.jsxs("span",{className:"text-sm text-orange-600 mr-2",children:[l.size," thay i cha lu"]}),A&&l.size>0&&t.jsxs("button",{onClick:ne,disabled:_.isPending,className:"btn btn-success",children:[t.jsx(al,{size:18}),"Lu (",l.size,")"]}),t.jsxs("button",{onClick:Y,className:"btn btn-secondary",children:[t.jsx(bs,{size:18}),"Xut Excel"]}),t.jsxs("button",{onClick:()=>u(!d),className:"btn btn-secondary",children:[t.jsx(pu,{size:18}),"Lch s"]}),t.jsxs("button",{onClick:()=>P.mutate(),disabled:P.isPending,className:"btn btn-secondary",title:"Gi phiu lng cho tt c nhn vin qua email",children:[P.isPending?t.jsx(Mn,{size:18,className:"animate-spin"}):t.jsx(Yp,{size:18}),"Gi tt c"]}),A&&t.jsxs("button",{onClick:()=>H.mutate(),disabled:H.isPending,className:"btn btn-secondary",title:"Tnh li lng theo ngy cng",children:[H.isPending?t.jsx(Mn,{size:18,className:"animate-spin"}):t.jsx(Ba,{size:18}),"Tnh li lng"]}),A&&t.jsxs("button",{onClick:()=>m(!0),className:"btn btn-primary",children:[t.jsx(Js,{size:18}),"Cht"]}),k.trangThai==="DA_CHOT"&&t.jsxs("button",{onClick:()=>C.mutate(),className:"btn btn-secondary",children:[t.jsx(tg,{size:18}),"M kha"]})]})]}),t.jsx("div",{className:"card overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"excel-table w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{className:"sticky left-0 z-20 bg-gray-200",children:"STT"}),t.jsx("th",{className:"sticky left-10 z-20 bg-gray-200 min-w-[80px]",children:"M NV"}),t.jsx("th",{className:"sticky left-[120px] z-20 bg-gray-200 min-w-[180px]",children:"H tn"}),t.jsx("th",{className:"min-w-[120px]",children:"Chc v"}),t.jsx("th",{className:"min-w-[80px] text-center bg-orange-100",children:"Ngy cng"}),t.jsx("th",{className:"min-w-[100px] text-center bg-orange-100",children:"NC iu chnh"}),k.coSanLuong&&(k.loaiSanLuong==="CHIA_HANG"||k.loaiSanLuong==="CA_HAI")&&t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"min-w-[90px] text-right bg-cyan-100",children:"SP t"}),t.jsx("th",{className:"min-w-[80px] text-right bg-cyan-100",children:"SP li"})]}),k.coSanLuong&&(k.loaiSanLuong==="GIAO_HANG"||k.loaiSanLuong==="CA_HAI")&&t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"min-w-[100px] text-right bg-teal-100",children:"KL giao (kg)"}),t.jsx("th",{className:"min-w-[80px] text-right bg-teal-100",children:"Tr gi"})]}),k.danhSachKhoanLuong.map(M=>t.jsx("th",{className:"min-w-[120px] text-right",children:M.tenKhoan},M.id)),t.jsx("th",{className:"min-w-[130px] text-right bg-blue-100",children:"Tng thu nhp"}),t.jsx("th",{className:"min-w-[100px] text-right bg-red-100",children:"Khu tr"}),t.jsx("th",{className:"min-w-[130px] text-right bg-green-100",children:"Thc lnh"}),t.jsx("th",{className:"min-w-[80px] text-center bg-purple-100",children:"Phiu lng"})]})}),t.jsx("tbody",{children:k.danhSachNhanVien.map((M,I)=>{var z,le,ue,ce,R,pe,Oe,tt,Ye,Re,Ot;const V=xe(M),J=S==null?void 0:S.find(Ht=>Ht.nhanVienId===M.nhanVienId),ge=J!=null&&J.ngayCongDieuChinh?Number(J.ngayCongDieuChinh):J?Number(J.soCongThucTe)+Number(J.soNgayNghiPhep):M.ngayCongThucTe;return t.jsxs("tr",{children:[t.jsx("td",{className:"sticky left-0 bg-white",children:I+1}),t.jsx("td",{className:"sticky left-10 bg-white font-medium",children:M.maNhanVien}),t.jsx("td",{className:"sticky left-[120px] bg-white",children:M.hoTen}),t.jsx("td",{children:M.chucVu||"-"}),t.jsxs("td",{className:"text-center bg-orange-50 relative group",children:[t.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t.jsxs("span",{className:`font-medium ${J!=null&&J.ngayCongDieuChinh?"text-orange-600":""}`,children:[ge.toFixed(1),"/",k.ngayCongLyThuyet]}),A&&t.jsx("button",{onClick:()=>O(M.nhanVienId),className:"opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-orange-200 rounded",title:"Chi tit v iu chnh",children:t.jsx(dj,{className:"w-3 h-3 text-orange-600"})}),(J==null?void 0:J.ngayCongDieuChinh)&&t.jsx("span",{className:"text-xs text-orange-600",title:" iu chnh th cng",children:""})]}),J&&t.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[t.jsxs("span",{className:"text-green-600",children:[Number(J.soNgayNghiPhep).toFixed(1),"P"]}),Number(J.soNgayNghiKhongPhep)>0&&t.jsxs("span",{className:"text-red-600 ml-1",children:[Number(J.soNgayNghiKhongPhep).toFixed(1),"KP"]})]})]}),t.jsx("td",{className:`text-center bg-orange-50 ${A?"cursor-pointer hover:bg-orange-100":""}`,onClick:()=>A&&O(M.nhanVienId),title:A?"Click  iu chnh ngy cng":"",children:J!=null&&J.ngayCongDieuChinh?t.jsx("span",{className:"font-medium text-orange-600",children:Number(J.ngayCongDieuChinh).toFixed(1)}):t.jsx("span",{className:A?"text-blue-500 hover:underline":"text-gray-400",children:A?"Nhp":"-"})}),k.coSanLuong&&(k.loaiSanLuong==="CHIA_HANG"||k.loaiSanLuong==="CA_HAI")&&t.jsxs(t.Fragment,{children:[t.jsx("td",{className:"text-right bg-cyan-50 font-medium",children:((ue=(le=(z=M.sanLuong)==null?void 0:z.chiaHang)==null?void 0:le.tongSpDat)==null?void 0:ue.toLocaleString("vi-VN"))||"-"}),t.jsx("td",{className:"text-right bg-cyan-50 text-red-600",children:((pe=(R=(ce=M.sanLuong)==null?void 0:ce.chiaHang)==null?void 0:R.tongSpLoi)==null?void 0:pe.toLocaleString("vi-VN"))||"-"})]}),k.coSanLuong&&(k.loaiSanLuong==="GIAO_HANG"||k.loaiSanLuong==="CA_HAI")&&t.jsxs(t.Fragment,{children:[t.jsx("td",{className:"text-right bg-teal-50 font-medium",children:((Ye=(tt=(Oe=M.sanLuong)==null?void 0:Oe.giaoHang)==null?void 0:tt.tongKhoiLuongThanhCong)==null?void 0:Ye.toLocaleString("vi-VN"))||"-"}),t.jsx("td",{className:"text-right bg-teal-50 text-orange-600",children:((Ot=(Re=M.sanLuong)==null?void 0:Re.giaoHang)==null?void 0:Ot.tongSoLanTreGio)||"-"})]}),k.danhSachKhoanLuong.map(Ht=>{const rn=M.cacKhoanLuong.find(Xe=>Xe.khoanLuongId===Ht.id),Fn=(rn==null?void 0:rn.soTien)||0,Ha=X(M.nhanVienId,Ht.id,Fn),Sa=(r==null?void 0:r.nhanVienId)===M.nhanVienId&&(r==null?void 0:r.khoanLuongId)===Ht.id,Be=l.has(`${M.nhanVienId}-${Ht.id}`);return t.jsx("td",{className:`number ${A?"editable":""} ${Be?"bg-yellow-100":""}`,onClick:()=>W(M.nhanVienId,Ht.id,Ha),children:Sa?t.jsx("input",{type:"text",value:r.value,onChange:Xe=>ee(Xe.target.value),onBlur:q,onKeyDown:fe,className:"cell-input",autoFocus:!0}):et(Ha)},Ht.id)}),t.jsx("td",{className:"number font-semibold bg-blue-50",children:et(V.tongThuNhap)}),t.jsx("td",{className:"number text-red-600 bg-red-50",children:et(V.tongKhauTru)}),t.jsx("td",{className:"number font-bold text-green-600 bg-green-50",children:et(V.thucLinh)}),t.jsx("td",{className:"text-center bg-purple-50",children:t.jsx("button",{onClick:()=>g({id:M.nhanVienId,hoTen:M.hoTen}),className:"p-1.5 hover:bg-purple-200 rounded-lg text-purple-600 transition-colors",title:"Xem phiu lng",children:t.jsx(ha,{size:18})})})]},M.nhanVienId)})}),t.jsx("tfoot",{children:t.jsxs("tr",{className:"total-row",children:[t.jsx("td",{colSpan:4,className:"text-right font-bold",children:"TNG CNG"}),t.jsx("td",{className:"bg-orange-100"}),t.jsx("td",{className:"bg-orange-100"}),k.coSanLuong&&(k.loaiSanLuong==="CHIA_HANG"||k.loaiSanLuong==="CA_HAI")&&t.jsxs(t.Fragment,{children:[t.jsx("td",{className:"number font-bold bg-cyan-100",children:k.danhSachNhanVien.reduce((M,I)=>{var V,J;return M+(((J=(V=I.sanLuong)==null?void 0:V.chiaHang)==null?void 0:J.tongSpDat)||0)},0).toLocaleString("vi-VN")}),t.jsx("td",{className:"number font-bold text-red-600 bg-cyan-100",children:k.danhSachNhanVien.reduce((M,I)=>{var V,J;return M+(((J=(V=I.sanLuong)==null?void 0:V.chiaHang)==null?void 0:J.tongSpLoi)||0)},0).toLocaleString("vi-VN")})]}),k.coSanLuong&&(k.loaiSanLuong==="GIAO_HANG"||k.loaiSanLuong==="CA_HAI")&&t.jsxs(t.Fragment,{children:[t.jsx("td",{className:"number font-bold bg-teal-100",children:k.danhSachNhanVien.reduce((M,I)=>{var V,J;return M+(((J=(V=I.sanLuong)==null?void 0:V.giaoHang)==null?void 0:J.tongKhoiLuongThanhCong)||0)},0).toLocaleString("vi-VN")}),t.jsx("td",{className:"number font-bold text-orange-600 bg-teal-100",children:k.danhSachNhanVien.reduce((M,I)=>{var V,J;return M+(((J=(V=I.sanLuong)==null?void 0:V.giaoHang)==null?void 0:J.tongSoLanTreGio)||0)},0)})]}),k.danhSachKhoanLuong.map(M=>{const I=k.danhSachNhanVien.reduce((V,J)=>{const ge=J.cacKhoanLuong.find(z=>z.khoanLuongId===M.id);return V+X(J.nhanVienId,M.id,(ge==null?void 0:ge.soTien)||0)},0);return t.jsx("td",{className:"number font-bold",children:et(I)},M.id)}),t.jsx("td",{className:"number font-bold bg-blue-100",children:et(k.danhSachNhanVien.reduce((M,I)=>M+xe(I).tongThuNhap,0))}),t.jsx("td",{className:"number font-bold text-red-600 bg-red-100",children:et(k.danhSachNhanVien.reduce((M,I)=>M+xe(I).tongKhauTru,0))}),t.jsx("td",{className:"number font-bold text-green-600 bg-green-100",children:et(k.danhSachNhanVien.reduce((M,I)=>M+xe(I).thucLinh,0))}),t.jsx("td",{className:"bg-purple-100"})]})})]})})}),d&&t.jsxs("div",{className:"card mt-4",children:[t.jsx("h3",{className:"font-semibold mb-3",children:"Lch s chnh sa"}),w&&w.length>0?t.jsx("div",{className:"max-h-64 overflow-y-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b",children:[t.jsx("th",{className:"text-left py-2",children:"Thi gian"}),t.jsx("th",{className:"text-left py-2",children:"Nhn vin"}),t.jsx("th",{className:"text-left py-2",children:"Khon"}),t.jsx("th",{className:"text-right py-2",children:"C"}),t.jsx("th",{className:"text-right py-2",children:"Mi"}),t.jsx("th",{className:"text-left py-2",children:"Ngi sa"})]})}),t.jsx("tbody",{children:w.map(M=>{var I,V;return t.jsxs("tr",{className:"border-b",children:[t.jsx("td",{className:"py-2",children:new Date(M.ngayThayDoi).toLocaleString("vi-VN")}),t.jsx("td",{className:"py-2",children:(I=M.nhanVien)==null?void 0:I.hoTen}),t.jsx("td",{className:"py-2",children:(V=M.khoanLuong)==null?void 0:V.tenKhoan}),t.jsx("td",{className:"py-2 text-right",children:et(M.giaTriCu)}),t.jsx("td",{className:"py-2 text-right font-medium",children:et(M.giaTriMoi)}),t.jsx("td",{className:"py-2",children:M.nguoiThayDoi})]},M.id)})})]})}):t.jsx("p",{className:"text-gray-500",children:"Cha c lch s chnh sa"})]}),x&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Cht bng lng"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"Sau khi cht, bng lng s khng th chnh sa. Bn c chc chn?"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngi cht *"}),t.jsx("input",{type:"text",value:f,onChange:M=>p(M.target.value),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp tn ngi cht"})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsxs("button",{onClick:()=>m(!1),className:"btn btn-secondary",children:[t.jsx(mn,{size:18}),"Hy"]}),t.jsxs("button",{onClick:()=>L.mutate({nguoiChot:f}),disabled:!f||L.isPending,className:"btn btn-primary",children:[t.jsx(Or,{size:18}),"Xc nhn cht"]})]})]})}),b&&t.jsx(W6,{isOpen:!!b,onClose:()=>g(null),bangLuongId:Number(e),nhanVienId:b.id,hoTen:b.hoTen}),y&&t.jsx(X6,{ngayCong:y,onClose:()=>N(null),onSave:B,isLoading:F.isPending})]})}const sw=["Thng 1","Thng 2","Thng 3","Thng 4","Thng 5","Thng 6","Thng 7","Thng 8","Thng 9","Thng 10","Thng 11","Thng 12"],Y6=["Th1","Th2","Th3","Th4","Th5","Th6","Th7","Th8","Th9","Th10","Th11","Th12"],J6=["CN","T2","T3","T4","T5","T6","T7"];function Ut({value:e,onChange:n,className:a="",placeholder:r="Chn ngy",min:s,max:l,disabled:o=!1}){const[d,u]=E.useState(!1),[x,m]=E.useState(()=>e?new Date(e):new Date),f=E.useRef(null);E.useEffect(()=>{const C=P=>{f.current&&!f.current.contains(P.target)&&u(!1)};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]);const p=e?new Date(e):null,b=C=>{if(!C)return"";const P=new Date(C);return`${P.getDate().toString().padStart(2,"0")}/${(P.getMonth()+1).toString().padStart(2,"0")}/${P.getFullYear()}`},g=(C,P)=>new Date(C,P+1,0).getDate(),y=(C,P)=>new Date(C,P,1).getDay(),N=()=>{m(C=>new Date(C.getFullYear(),C.getMonth()-1,1))},k=()=>{m(C=>new Date(C.getFullYear(),C.getMonth()+1,1))},T=C=>{const P=new Date(x.getFullYear(),x.getMonth(),C),F=`${P.getFullYear()}-${(P.getMonth()+1).toString().padStart(2,"0")}-${C.toString().padStart(2,"0")}`;n(F),u(!1)},S=C=>{const P=new Date(x.getFullYear(),x.getMonth(),C);return!!(s&&P<new Date(s)||l&&P>new Date(l))},w=C=>{const P=new Date;return x.getFullYear()===P.getFullYear()&&x.getMonth()===P.getMonth()&&C===P.getDate()},_=C=>p?x.getFullYear()===p.getFullYear()&&x.getMonth()===p.getMonth()&&C===p.getDate():!1,L=()=>{const C=x.getFullYear(),P=x.getMonth(),F=g(C,P),H=y(C,P),O=[];for(let B=0;B<H;B++)O.push(null);for(let B=1;B<=F;B++)O.push(B);return t.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[J6.map(B=>t.jsx("div",{className:"text-center text-xs font-medium text-gray-500 py-1",children:B},B)),O.map((B,W)=>t.jsx("div",{className:"aspect-square",children:B!==null&&t.jsx("button",{type:"button",disabled:S(B),onClick:()=>T(B),className:`
                  w-full h-full rounded-lg text-sm transition-colors
                  ${_(B)?"bg-primary-600 text-white":w(B)?"bg-primary-100 text-primary-700":"hover:bg-gray-100"}
                  ${S(B)?"opacity-50 cursor-not-allowed":""}
                `,children:B})},W))]})};return t.jsxs("div",{ref:f,className:"relative",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",value:b(e),readOnly:!0,onClick:()=>!o&&u(!d),placeholder:r,disabled:o,className:`
            w-full px-3 py-2 pr-10 border rounded-lg cursor-pointer
            focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent
            ${o?"bg-gray-100 cursor-not-allowed":"bg-white"}
            ${a}
          `}),t.jsx(At,{size:18,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"})]}),d&&t.jsxs("div",{className:"absolute z-50 mt-1 p-3 bg-white rounded-xl shadow-lg border min-w-[280px]",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("button",{type:"button",onClick:N,className:"p-1 hover:bg-gray-100 rounded-lg",children:t.jsx(fr,{size:20})}),t.jsxs("span",{className:"font-medium",children:[sw[x.getMonth()]," ",x.getFullYear()]}),t.jsx("button",{type:"button",onClick:k,className:"p-1 hover:bg-gray-100 rounded-lg",children:t.jsx($n,{size:20})})]}),L(),t.jsxs("div",{className:"flex justify-between mt-3 pt-3 border-t",children:[t.jsx("button",{type:"button",onClick:()=>{n(""),u(!1)},className:"text-sm text-gray-500 hover:text-gray-700",children:"Xa"}),t.jsx("button",{type:"button",onClick:()=>{const C=new Date,P=`${C.getFullYear()}-${(C.getMonth()+1).toString().padStart(2,"0")}-${C.getDate().toString().padStart(2,"0")}`;n(P),u(!1)},className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Hm nay"})]})]})]})}function kc({value:e,onChange:n,className:a="",placeholder:r="Chn thng",disabled:s=!1}){const[l,o]=E.useState(!1),[d,u]=E.useState(()=>e?parseInt(e.split("-")[0]):new Date().getFullYear()),x=E.useRef(null);E.useEffect(()=>{const g=y=>{x.current&&!x.current.contains(y.target)&&o(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]);const m=g=>{if(!g)return"";const[y,N]=g.split("-");return`${sw[parseInt(N)-1]} ${y}`},f=g=>{const y=`${d}-${(g+1).toString().padStart(2,"0")}`;n(y),o(!1)},p=g=>{if(!e)return!1;const[y,N]=e.split("-");return parseInt(y)===d&&parseInt(N)===g+1},b=g=>{const y=new Date;return d===y.getFullYear()&&g===y.getMonth()};return t.jsxs("div",{ref:x,className:"relative",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",value:m(e),readOnly:!0,onClick:()=>!s&&o(!l),placeholder:r,disabled:s,className:`
            w-full px-3 py-2 pr-10 border rounded-lg cursor-pointer
            focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent
            ${s?"bg-gray-100 cursor-not-allowed":"bg-white"}
            ${a}
          `}),t.jsx(At,{size:18,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"})]}),l&&t.jsxs("div",{className:"absolute z-50 mt-1 p-3 bg-white rounded-xl shadow-lg border min-w-[280px]",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("button",{type:"button",onClick:()=>u(g=>g-1),className:"p-1 hover:bg-gray-100 rounded-lg",children:t.jsx(fr,{size:20})}),t.jsx("span",{className:"font-medium text-lg",children:d}),t.jsx("button",{type:"button",onClick:()=>u(g=>g+1),className:"p-1 hover:bg-gray-100 rounded-lg",children:t.jsx($n,{size:20})})]}),t.jsx("div",{className:"grid grid-cols-4 gap-2",children:Y6.map((g,y)=>t.jsx("button",{type:"button",onClick:()=>f(y),className:`
                  py-2 px-1 rounded-lg text-sm transition-colors
                  ${p(y)?"bg-primary-600 text-white":b(y)?"bg-primary-100 text-primary-700":"hover:bg-gray-100"}
                `,children:g},g))}),t.jsxs("div",{className:"flex justify-between mt-3 pt-3 border-t",children:[t.jsx("button",{type:"button",onClick:()=>{n(""),o(!1)},className:"text-sm text-gray-500 hover:text-gray-700",children:"Xa"}),t.jsx("button",{type:"button",onClick:()=>{const g=new Date,y=`${g.getFullYear()}-${(g.getMonth()+1).toString().padStart(2,"0")}`;n(y),o(!1)},className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Thng ny"})]})]})]})}const Ib={DANG_LAM:{label:"ang lm",color:"bg-green-100 text-green-700"},NGHI_VIEC:{label:" ngh",color:"bg-red-100 text-red-700"},TAM_NGHI:{label:"Tm ngh",color:"bg-yellow-100 text-yellow-700"}};function Z6(){const e=Bt(),[n,a]=E.useState(!1),[r,s]=E.useState(),[l,o]=E.useState(""),[d,u]=E.useState(""),[x,m]=E.useState(""),[f,p]=E.useState({maNhanVien:"",hoTen:"",email:"",soDienThoai:"",phongBanId:0,chucVu:"",ngayVaoLam:"",gioiTinh:"",ngaySinh:"",diaChi:"",trangThai:"DANG_LAM",loaiNhanVien:"CHINH_THUC",dongBHXH:!0}),{data:b,isLoading:g}=Ie({queryKey:["nhan-vien",r,l,x],queryFn:()=>Ma.layTatCa({phongBanId:r,tuKhoa:x,trangThai:l||void 0})}),y=Array.isArray(b)?b:(b==null?void 0:b.data)||[],N=d?y.filter(H=>H.loaiNhanVien===d):y,{data:k}=Ie({queryKey:["phong-ban"],queryFn:cn.layTatCa}),T=De({mutationFn:Ma.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["nhan-vien"]}),ie.success("To nhn vin thnh cng!"),_()},onError:H=>{var O,B;ie.error(((B=(O=H.response)==null?void 0:O.data)==null?void 0:B.message)||"C li xy ra")}}),S=De({mutationFn:({id:H,data:O})=>Ma.capNhat(H,O),onSuccess:()=>{e.invalidateQueries({queryKey:["nhan-vien"]}),ie.success("Cp nht thnh cng!"),_()},onError:H=>{var O,B;ie.error(((B=(O=H.response)==null?void 0:O.data)==null?void 0:B.message)||"C li xy ra")}}),w=De({mutationFn:Ma.xoa,onSuccess:()=>{e.invalidateQueries({queryKey:["nhan-vien"]}),ie.success("Xa nhn vin thnh cng!")},onError:H=>{var O,B;ie.error(((B=(O=H.response)==null?void 0:O.data)==null?void 0:B.message)||"C li xy ra")}}),_=()=>{a(!1),p({maNhanVien:"",hoTen:"",email:"",soDienThoai:"",phongBanId:0,chucVu:"",ngayVaoLam:"",gioiTinh:"",ngaySinh:"",diaChi:"",trangThai:"DANG_LAM",loaiNhanVien:"CHINH_THUC",dongBHXH:!0})},L=async()=>{try{const{maNhanVien:H}=await Ma.layMaTuDong();p(O=>({...O,maNhanVien:H})),a(!0)}catch{a(!0)}},C=H=>{confirm(`Khi phc nhn vin "${H.hoTen}" v trng thi ang lm?`)&&S.mutate({id:H.id,data:{trangThai:"DANG_LAM"}})},P=()=>{if(!f.maNhanVien||!f.hoTen||!f.phongBanId){ie.error("Vui lng in y  thng tin bt buc");return}T.mutate(f)},F=H=>{confirm(`Bn c chc mun xa nhn vin "${H.hoTen}"?`)&&w.mutate(H.id)};return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[t.jsx(dn,{size:28}),"Qun l Nhn vin"]}),t.jsxs("button",{onClick:L,className:"btn btn-primary",children:[t.jsx(St,{size:20}),"Thm nhn vin"]})]}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx("div",{className:"flex-1",children:t.jsxs("div",{className:"relative",children:[t.jsx(Hr,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),t.jsx("input",{type:"text",value:x,onChange:H=>m(H.target.value),placeholder:"Tm kim theo tn, m NV, email...",className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]})}),t.jsx("div",{children:t.jsxs("select",{value:r||"",onChange:H=>s(H.target.value?Number(H.target.value):void 0),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),k==null?void 0:k.map(H=>t.jsx("option",{value:H.id,children:H.tenPhongBan},H.id))]})}),t.jsx("div",{children:t.jsxs("select",{value:l,onChange:H=>o(H.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c trng thi"}),t.jsx("option",{value:"DANG_LAM",children:"ang lm"}),t.jsx("option",{value:"NGHI_VIEC",children:" ngh"}),t.jsx("option",{value:"TAM_NGHI",children:"Tm ngh"})]})}),t.jsx("div",{children:t.jsxs("select",{value:d,onChange:H=>u(H.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c loi NV"}),t.jsx("option",{value:"CHINH_THUC",children:"Chnh thc"}),t.jsx("option",{value:"THU_VIEC",children:"Th vic"}),t.jsx("option",{value:"HOC_VIEC",children:"Hc vic"}),t.jsx("option",{value:"THUC_TAP",children:"Thc tp"}),t.jsx("option",{value:"CONG_TAC_VIEN",children:"Cng tc vin"}),t.jsx("option",{value:"THOI_VU",children:"Thi v"})]})})]})}),t.jsx("div",{className:"card",children:g?t.jsx("p",{className:"text-center py-8 text-gray-500",children:"ang ti..."}):N&&N.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"M NV"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"H tn"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Phng ban"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Chc v"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Loi NV"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"BHXH"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Trng thi"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Thao tc"})]})}),t.jsx("tbody",{children:N.map(H=>{var O,B,W,ee,q;return t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4 font-medium",children:H.maNhanVien}),t.jsx("td",{className:"py-3 px-4",children:H.hoTen}),t.jsx("td",{className:"py-3 px-4",children:(O=H.phongBan)==null?void 0:O.tenPhongBan}),t.jsx("td",{className:"py-3 px-4",children:H.chucVu||"-"}),t.jsx("td",{className:"py-3 px-4 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${((B=v0[H.loaiNhanVien||"CHINH_THUC"])==null?void 0:B.color)||"bg-gray-100"}`,children:((W=v0[H.loaiNhanVien||"CHINH_THUC"])==null?void 0:W.label)||"Chnh thc"})}),t.jsx("td",{className:"py-3 px-4 text-center",children:H.dongBHXH!==!1?t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700",children:"C"}):t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-700",children:"Khng"})}),t.jsx("td",{className:"py-3 px-4 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${((ee=Ib[H.trangThai])==null?void 0:ee.color)||"bg-gray-100"}`,children:((q=Ib[H.trangThai])==null?void 0:q.label)||H.trangThai})}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsxs(ca,{to:`/nhan-vien/${H.id}`,className:"px-3 py-1.5 text-xs bg-blue-100 text-blue-700 hover:bg-blue-200 rounded flex items-center gap-1 font-medium",title:"Xem & chnh sa thng tin nhn vin",children:[t.jsx(Mr,{size:14}),"Chi tit"]}),H.trangThai==="NGHI_VIEC"?t.jsx("button",{onClick:()=>C(H),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg",title:"Khi phc",children:t.jsx(Zp,{size:18})}):t.jsx("button",{onClick:()=>F(H),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Cho ngh vic",children:t.jsx(Rr,{size:18})})]})})]},H.id)})})]})}):t.jsx("p",{className:"text-center py-8 text-gray-500",children:"Cha c nhn vin no"})}),n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-lg",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Thm nhn vin mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M nhn vin *"}),t.jsx("input",{type:"text",value:f.maNhanVien,onChange:H=>p({...f,maNhanVien:H.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"H tn *"}),t.jsx("input",{type:"text",value:f.hoTen,onChange:H=>p({...f,hoTen:H.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phng ban *"}),t.jsxs("select",{value:f.phongBanId,onChange:H=>p({...f,phongBanId:Number(H.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn phng ban --"}),k==null?void 0:k.map(H=>t.jsx("option",{value:H.id,children:H.tenPhongBan},H.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chc v"}),t.jsx("input",{type:"text",value:f.chucVu,onChange:H=>p({...f,chucVu:H.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gii tnh"}),t.jsxs("select",{value:f.gioiTinh,onChange:H=>p({...f,gioiTinh:H.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn --"}),t.jsx("option",{value:"NAM",children:"Nam"}),t.jsx("option",{value:"NU",children:"N"}),t.jsx("option",{value:"KHAC",children:"Khc"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy sinh"}),t.jsx(Ut,{value:f.ngaySinh,onChange:H=>p({...f,ngaySinh:H}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),t.jsx("input",{type:"email",value:f.email,onChange:H=>p({...f,email:H.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S in thoi"}),t.jsx("input",{type:"text",value:f.soDienThoai,onChange:H=>p({...f,soDienThoai:H.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"a ch"}),t.jsx("input",{type:"text",value:f.diaChi,onChange:H=>p({...f,diaChi:H.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp a ch..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy vo lm"}),t.jsx(Ut,{value:f.ngayVaoLam,onChange:H=>p({...f,ngayVaoLam:H}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi nhn vin"}),t.jsxs("select",{value:f.loaiNhanVien,onChange:H=>p({...f,loaiNhanVien:H.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"CHINH_THUC",children:"Chnh thc"}),t.jsx("option",{value:"THU_VIEC",children:"Th vic"}),t.jsx("option",{value:"HOC_VIEC",children:"Hc vic"}),t.jsx("option",{value:"THUC_TAP",children:"Thc tp"}),t.jsx("option",{value:"CONG_TAC_VIEN",children:"Cng tc vin"}),t.jsx("option",{value:"THOI_VU",children:"Thi v"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"ng BHXH"}),t.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:"dongBHXH",checked:f.dongBHXH===!0,onChange:()=>p({...f,dongBHXH:!0}),className:"w-4 h-4 text-blue-600"}),t.jsx("span",{children:"C ng"})]}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:"dongBHXH",checked:f.dongBHXH===!1,onChange:()=>p({...f,dongBHXH:!1}),className:"w-4 h-4 text-red-600"}),t.jsx("span",{children:"Khng ng"})]})]})]})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:_,className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:P,disabled:T.isPending||S.isPending,className:"btn btn-primary",children:T.isPending||S.isPending?"ang lu...":"Lu"})]})]})})]})}const eD=async e=>(await he.get(`/nhan-vien/${e}/hop-dong`)).data,tD=async(e,n)=>(await he.post(`/nhan-vien/${e}/hop-dong`,n)).data,nD=async(e,n)=>(await he.put(`/nhan-vien/hop-dong/${e}`,n)).data,aD=async(e,n)=>(await he.post(`/nhan-vien/hop-dong/${e}/ngung`,n)).data,rD=async e=>{await he.delete(`/nhan-vien/hop-dong/${e}`)},sD=async e=>(await he.get(`/nhan-vien/${e}/ngan-hang`)).data,iD=async(e,n)=>(await he.post(`/nhan-vien/${e}/ngan-hang`,n)).data,lD=async(e,n)=>(await he.put(`/nhan-vien/ngan-hang/${e}`,n)).data,oD=async e=>(await he.post(`/nhan-vien/ngan-hang/${e}/dat-mac-dinh`)).data,cD=async e=>{await he.delete(`/nhan-vien/ngan-hang/${e}`)},iw=async()=>(await he.get("/nhom-nhan-vien")).data,dD=async e=>(await he.post("/nhom-nhan-vien",e)).data,uD=async(e,n)=>(await he.put(`/nhom-nhan-vien/${e}`,n)).data,hD=async e=>{await he.delete(`/nhom-nhan-vien/${e}`)},Ob={THU_VIEC:"Th vic",MOT_NAM:"1 nm",BA_NAM:"3 nm",VO_THOI_HAN:"V thi hn"},xD={HIEU_LUC:"Hiu lc",HET_HAN:"Ht hn",HUY_BO:"Hy b"},mD=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e);function fD({nhanVienId:e}){const n=Bt(),[a,r]=E.useState(!1),[s,l]=E.useState(null),[o,d]=E.useState(null),[u,x]=E.useState({loaiHopDong:"VO_THOI_HAN",tuNgay:new Date().toISOString().split("T")[0],denNgay:"",luongCoBan:0,luongDongBH:0,heSoLuong:1,ghiChu:""}),[m,f]=E.useState({ngayKetThuc:new Date().toISOString().split("T")[0],lyDo:""}),{data:p,isLoading:b}=Ie({queryKey:["hop-dong",e],queryFn:()=>eD(e)}),g=De({mutationFn:L=>tD(e,{...L,denNgay:L.denNgay||void 0}),onSuccess:()=>{ie.success("To hp ng thnh cng"),n.invalidateQueries({queryKey:["hop-dong",e]}),r(!1),T()},onError:L=>{var C,P;ie.error(((P=(C=L.response)==null?void 0:C.data)==null?void 0:P.message)||"Li to hp ng")}}),y=De({mutationFn:({id:L,data:C})=>nD(L,C),onSuccess:()=>{ie.success("Cp nht hp ng thnh cng"),n.invalidateQueries({queryKey:["hop-dong",e]}),l(null),T()},onError:L=>{var C,P;ie.error(((P=(C=L.response)==null?void 0:C.data)==null?void 0:P.message)||"Li cp nht")}}),N=De({mutationFn:({id:L,data:C})=>aD(L,C),onSuccess:()=>{ie.success(" ngng hp ng"),n.invalidateQueries({queryKey:["hop-dong",e]}),d(null)},onError:L=>{var C,P;ie.error(((P=(C=L.response)==null?void 0:C.data)==null?void 0:P.message)||"Li ngng hp ng")}}),k=De({mutationFn:rD,onSuccess:()=>{ie.success(" xa hp ng"),n.invalidateQueries({queryKey:["hop-dong",e]})},onError:L=>{var C,P;ie.error(((P=(C=L.response)==null?void 0:C.data)==null?void 0:P.message)||"Li xa")}}),T=()=>{x({loaiHopDong:"VO_THOI_HAN",tuNgay:new Date().toISOString().split("T")[0],denNgay:"",luongCoBan:0,luongDongBH:0,heSoLuong:1,ghiChu:""})},S=L=>{var C;x({loaiHopDong:L.loaiHopDong,tuNgay:L.tuNgay.split("T")[0],denNgay:((C=L.denNgay)==null?void 0:C.split("T")[0])||"",luongCoBan:Number(L.luongCoBan),luongDongBH:Number(L.luongDongBH||0),heSoLuong:Number(L.heSoLuong||1),ghiChu:L.ghiChu||""}),l(L.id),r(!0)},w=L=>{L.preventDefault(),s?y.mutate({id:s,data:u}):g.mutate(u)},_=L=>{L.preventDefault(),o&&N.mutate({id:o,data:m})};return b?t.jsx("div",{className:"p-4 text-center",children:"ang ti..."}):t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Lch s Hp ng / Lng"}),t.jsxs("button",{onClick:()=>{r(!0),l(null),T()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[t.jsx("span",{children:"+"})," Thm hp ng"]})]}),a&&t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[t.jsx("h4",{className:"font-medium mb-3",children:s?"Sa hp ng":"To hp ng mi"}),t.jsxs("form",{onSubmit:w,className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi hp ng"}),t.jsx("select",{value:u.loaiHopDong,onChange:L=>x({...u,loaiHopDong:L.target.value}),className:"w-full border rounded-lg px-3 py-2",children:Object.entries(Ob).map(([L,C])=>t.jsx("option",{value:L,children:C},L))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lng c bn"}),t.jsx("input",{type:"number",value:u.luongCoBan,onChange:L=>x({...u,luongCoBan:Number(L.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0,required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"T ngy"}),t.jsx(Ut,{value:u.tuNgay,onChange:L=>x({...u,tuNgay:L}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"n ngy ( trng nu v thi hn)"}),t.jsx(Ut,{value:u.denNgay,onChange:L=>x({...u,denNgay:L}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lng ng BH"}),t.jsx("input",{type:"number",value:u.luongDongBH,onChange:L=>x({...u,luongDongBH:Number(L.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"H s lng"}),t.jsx("input",{type:"number",step:"0.01",value:u.heSoLuong,onChange:L=>x({...u,heSoLuong:Number(L.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ghi ch"}),t.jsx("textarea",{value:u.ghiChu,onChange:L=>x({...u,ghiChu:L.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),t.jsxs("div",{className:"col-span-2 flex gap-2",children:[t.jsx("button",{type:"submit",disabled:g.isPending||y.isPending,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:s?"Cp nht":"To mi"}),t.jsx("button",{type:"button",onClick:()=>{r(!1),l(null)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Hy"})]})]})]}),o&&t.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[t.jsx("h4",{className:"font-medium mb-3 text-yellow-800",children:"Ngng hp ng sm"}),t.jsxs("form",{onSubmit:_,className:"flex gap-4 items-end",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy kt thc"}),t.jsx(Ut,{value:m.ngayKetThuc,onChange:L=>f({...m,ngayKetThuc:L}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"L do"}),t.jsx("input",{type:"text",value:m.lyDo,onChange:L=>f({...m,lyDo:L.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp l do..."})]}),t.jsx("button",{type:"submit",disabled:N.isPending,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:opacity-50",children:"Xc nhn"}),t.jsx("button",{type:"button",onClick:()=>d(null),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Hy"})]})]}),t.jsx("div",{className:"relative",children:(p==null?void 0:p.length)===0?t.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:"Cha c hp ng no"}):t.jsx("div",{className:"space-y-4",children:p==null?void 0:p.map((L,C)=>t.jsxs("div",{className:`relative pl-8 pb-4 ${C<((p==null?void 0:p.length)||0)-1?"border-l-2 border-gray-200":""}`,children:[t.jsx("div",{className:`absolute left-[-5px] w-3 h-3 rounded-full ${L.trangThai==="HIEU_LUC"?"bg-green-500":"bg-gray-400"}`}),t.jsxs("div",{className:`bg-white rounded-lg shadow p-4 ${L.trangThai==="HIEU_LUC"?"border-l-4 border-green-500":""}`,children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-semibold",children:Ob[L.loaiHopDong]}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${L.trangThai==="HIEU_LUC"?"bg-green-100 text-green-800":L.trangThai==="HET_HAN"?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"}`,children:xD[L.trangThai]})]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[new Date(L.tuNgay).toLocaleDateString("vi-VN"),"  ",L.denNgay?new Date(L.denNgay).toLocaleDateString("vi-VN"):"V thi hn"]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-lg font-bold text-blue-600",children:mD(Number(L.luongCoBan))}),L.heSoLuong&&t.jsxs("div",{className:"text-xs text-gray-500",children:["H s: ",L.heSoLuong]})]})]}),L.ghiChu&&t.jsx("div",{className:"text-sm text-gray-500 mt-2 italic",children:L.ghiChu}),t.jsxs("div",{className:"flex gap-2 mt-3",children:[t.jsx("button",{onClick:()=>S(L),className:"text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100",children:"Sa"}),L.trangThai==="HIEU_LUC"&&t.jsx("button",{onClick:()=>d(L.id),className:"text-xs px-2 py-1 bg-yellow-50 text-yellow-600 rounded hover:bg-yellow-100",children:"Ngng sm"}),t.jsx("button",{onClick:()=>{confirm("Xc nhn xa hp ng ny?")&&k.mutate(L.id)},className:"text-xs px-2 py-1 bg-red-50 text-red-600 rounded hover:bg-red-100",children:"Xa"})]})]})]},L.id))})})]})}const Mb=[{code:"VCB",name:"Vietcombank"},{code:"TCB",name:"Techcombank"},{code:"BIDV",name:"BIDV"},{code:"VTB",name:"Vietinbank"},{code:"ACB",name:"ACB"},{code:"MBB",name:"MB Bank"},{code:"VPB",name:"VPBank"},{code:"TPB",name:"TPBank"},{code:"STB",name:"Sacombank"},{code:"SHB",name:"SHB"},{code:"MSB",name:"MSB"},{code:"OCB",name:"OCB"},{code:"HDB",name:"HDBank"},{code:"SCB",name:"SCB"},{code:"EIB",name:"Eximbank"},{code:"AGRI",name:"Agribank"},{code:"KHAC",name:"Khc"}];function pD({nhanVienId:e}){const n=Bt(),[a,r]=E.useState(!1),[s,l]=E.useState(null),[o,d]=E.useState({tenNganHang:"VCB",chiNhanh:"",soTaiKhoan:"",chuTaiKhoan:"",laMacDinh:!1,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""}),{data:u,isLoading:x}=Ie({queryKey:["ngan-hang",e],queryFn:()=>sD(e)}),m=De({mutationFn:T=>iD(e,{...T,denNgay:T.denNgay||void 0}),onSuccess:()=>{ie.success("Thm ti khon ngn hng thnh cng"),n.invalidateQueries({queryKey:["ngan-hang",e]}),r(!1),g()},onError:T=>{var S,w;ie.error(((w=(S=T.response)==null?void 0:S.data)==null?void 0:w.message)||"Li thm ti khon")}}),f=De({mutationFn:({id:T,data:S})=>lD(T,S),onSuccess:()=>{ie.success("Cp nht ti khon thnh cng"),n.invalidateQueries({queryKey:["ngan-hang",e]}),l(null),r(!1),g()},onError:T=>{var S,w;ie.error(((w=(S=T.response)==null?void 0:S.data)==null?void 0:w.message)||"Li cp nht")}}),p=De({mutationFn:cD,onSuccess:()=>{ie.success(" xa ti khon"),n.invalidateQueries({queryKey:["ngan-hang",e]})},onError:T=>{var S,w;ie.error(((w=(S=T.response)==null?void 0:S.data)==null?void 0:w.message)||"Li xa")}}),b=De({mutationFn:oD,onSuccess:()=>{ie.success(" t lm mc nh"),n.invalidateQueries({queryKey:["ngan-hang",e]})},onError:T=>{var S,w;ie.error(((w=(S=T.response)==null?void 0:S.data)==null?void 0:w.message)||"Li")}}),g=()=>{d({tenNganHang:"VCB",chiNhanh:"",soTaiKhoan:"",chuTaiKhoan:"",laMacDinh:!1,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""})},y=T=>{var S,w;d({tenNganHang:T.tenNganHang,chiNhanh:T.chiNhanh||"",soTaiKhoan:T.soTaiKhoan,chuTaiKhoan:T.chuTaiKhoan,laMacDinh:T.laMacDinh,tuNgay:((S=T.tuNgay)==null?void 0:S.split("T")[0])||"",denNgay:((w=T.denNgay)==null?void 0:w.split("T")[0])||"",ghiChu:T.ghiChu||""}),l(T.id),r(!0)},N=T=>{T.preventDefault(),s?f.mutate({id:s,data:o}):m.mutate(o)},k=T=>{const S=Mb.find(w=>w.code===T);return S?S.name:T};return x?t.jsx("div",{className:"p-4 text-center",children:"ang ti..."}):t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Ti khon Ngn hng"}),t.jsxs("button",{onClick:()=>{r(!0),l(null),g()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[t.jsx("span",{children:"+"})," Thm ti khon"]})]}),a&&t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[t.jsx("h4",{className:"font-medium mb-3",children:s?"Sa ti khon":"Thm ti khon mi"}),t.jsxs("form",{onSubmit:N,className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngn hng"}),t.jsx("select",{value:o.tenNganHang,onChange:T=>d({...o,tenNganHang:T.target.value}),className:"w-full border rounded-lg px-3 py-2",children:Mb.map(T=>t.jsx("option",{value:T.code,children:T.name},T.code))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chi nhnh"}),t.jsx("input",{type:"text",value:o.chiNhanh,onChange:T=>d({...o,chiNhanh:T.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: H Ni, TP.HCM..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S ti khon *"}),t.jsx("input",{type:"text",value:o.soTaiKhoan,onChange:T=>d({...o,soTaiKhoan:T.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp s ti khon",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ch ti khon *"}),t.jsx("input",{type:"text",value:o.chuTaiKhoan,onChange:T=>d({...o,chuTaiKhoan:T.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"NGUYEN VAN A",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hiu lc t"}),t.jsx(Ut,{value:o.tuNgay,onChange:T=>d({...o,tuNgay:T}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hiu lc n"}),t.jsx(Ut,{value:o.denNgay,onChange:T=>d({...o,denNgay:T}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ghi ch"}),t.jsx("input",{type:"text",value:o.ghiChu,onChange:T=>d({...o,ghiChu:T.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ti khon nhn lng, ti khon ph..."})]}),t.jsx("div",{className:"col-span-2",children:t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:o.laMacDinh,onChange:T=>d({...o,laMacDinh:T.target.checked}),className:"w-4 h-4 rounded"}),t.jsx("span",{className:"text-sm",children:"t lm ti khon mc nh"})]})}),t.jsxs("div",{className:"col-span-2 flex gap-2",children:[t.jsx("button",{type:"submit",disabled:m.isPending||f.isPending,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:s?"Cp nht":"Thm"}),t.jsx("button",{type:"button",onClick:()=>{r(!1),l(null)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Hy"})]})]})]}),t.jsx("div",{className:"grid gap-4",children:(u==null?void 0:u.length)===0?t.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:"Cha c ti khon ngn hng no"}):u==null?void 0:u.map(T=>t.jsxs("div",{className:`bg-white rounded-lg shadow p-4 ${T.laMacDinh?"border-l-4 border-green-500":""}`,children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 font-bold text-sm",children:T.tenNganHang.slice(0,3)}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-semibold",children:k(T.tenNganHang)}),T.chiNhanh&&t.jsxs("span",{className:"text-sm text-gray-500",children:["- ",T.chiNhanh]}),T.laMacDinh&&t.jsx("span",{className:"text-xs px-2 py-0.5 bg-green-100 text-green-800 rounded-full",children:"Mc nh"})]}),t.jsx("div",{className:"text-lg font-mono text-gray-800",children:T.soTaiKhoan}),t.jsx("div",{className:"text-sm text-gray-500",children:T.chuTaiKhoan})]})]}),t.jsxs("div",{className:"flex flex-col items-end gap-2",children:[T.tuNgay&&t.jsxs("div",{className:"text-xs text-gray-400",children:[new Date(T.tuNgay).toLocaleDateString("vi-VN"),T.denNgay&&`  ${new Date(T.denNgay).toLocaleDateString("vi-VN")}`]}),t.jsxs("div",{className:"flex gap-2",children:[!T.laMacDinh&&t.jsx("button",{onClick:()=>b.mutate(T.id),className:"text-xs px-2 py-1 bg-green-50 text-green-600 rounded hover:bg-green-100",children:"t mc nh"}),t.jsx("button",{onClick:()=>y(T),className:"text-xs px-2 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100",children:"Sa"}),t.jsx("button",{onClick:()=>{confirm("Xc nhn xa ti khon ny?")&&p.mutate(T.id)},className:"text-xs px-2 py-1 bg-red-50 text-red-600 rounded hover:bg-red-100",children:"Xa"})]})]})]}),T.ghiChu&&t.jsx("div",{className:"text-sm text-gray-500 mt-2 italic",children:T.ghiChu})]},T.id))})]})}function gD({nhanVienId:e}){const n=Bt(),[a,r]=E.useState(null),{data:s,isLoading:l}=Ie({queryKey:["nhan-vien-nhom",e],queryFn:async()=>(await he.get(`/nhan-vien/${e}/nhom`)).data}),{data:o}=Ie({queryKey:["nhom-nhan-vien"],queryFn:()=>iw()}),d=o==null?void 0:o.filter(p=>!(s!=null&&s.some(b=>b.nhom.id===p.id))),u=De({mutationFn:async p=>he.post(`/nhan-vien/${e}/them-vao-nhom`,{nhomId:p,tuNgay:new Date().toISOString().split("T")[0]}),onSuccess:()=>{ie.success(" thm vo nhm"),n.invalidateQueries({queryKey:["nhan-vien-nhom",e]}),r(null)},onError:p=>{var b,g;ie.error(((g=(b=p.response)==null?void 0:b.data)==null?void 0:g.message)||"Li thm vo nhm")}}),x=De({mutationFn:async p=>he.post(`/nhan-vien/${e}/go-khoi-nhom`,{nhomId:p,denNgay:new Date().toISOString().split("T")[0]}),onSuccess:()=>{ie.success(" g khi nhm"),n.invalidateQueries({queryKey:["nhan-vien-nhom",e]})},onError:p=>{var b,g;ie.error(((g=(b=p.response)==null?void 0:b.data)==null?void 0:g.message)||"Li g khi nhm")}}),m=()=>{a&&u.mutate(a)},f=p=>{confirm("Xc nhn g khi nhm?")&&x.mutate(p)};return l?t.jsx("div",{className:"p-4 text-center",children:"ang ti..."}):t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"flex justify-between items-center",children:t.jsx("h3",{className:"text-lg font-semibold",children:"Nhm Nhn vin"})}),d&&d.length>0&&t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[t.jsx("h4",{className:"font-medium mb-3",children:"Thm vo nhm"}),t.jsxs("div",{className:"flex gap-2 items-center",children:[t.jsxs("select",{value:a||"",onChange:p=>r(Number(p.target.value)),className:"flex-1 border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn nhm --"}),d.map(p=>t.jsxs("option",{value:p.id,children:[p.tenNhom," ",p.moTa&&`(${p.moTa})`]},p.id))]}),t.jsx("button",{onClick:m,disabled:!a,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:"Thm"})]})]}),t.jsx("div",{className:"grid gap-3",children:(s==null?void 0:s.length)===0?t.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:"Nhn vin cha thuc nhm no"}):s==null?void 0:s.map(p=>t.jsxs("div",{className:"bg-white rounded-lg shadow p-4 flex justify-between items-center",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-white font-bold",style:{backgroundColor:p.nhom.mauSac||"#6B7280"},children:p.nhom.tenNhom.charAt(0).toUpperCase()}),t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold",children:p.nhom.tenNhom}),p.nhom.moTa&&t.jsx("div",{className:"text-sm text-gray-500",children:p.nhom.moTa}),t.jsxs("div",{className:"text-xs text-gray-400",children:["T ",new Date(p.tuNgay).toLocaleDateString("vi-VN"),p.denNgay&&` n ${new Date(p.denNgay).toLocaleDateString("vi-VN")}`]})]})]}),t.jsx("button",{onClick:()=>f(p.nhom.id),className:"text-xs px-3 py-1 bg-red-50 text-red-600 rounded hover:bg-red-100",children:"G khi nhm"})]},p.id))}),t.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-sm text-gray-600",children:[t.jsx("strong",{children:"Lu :"})," Nhm nhn vin c s dng trong Rule Engine  p dng cc quy tc tnh lng cho tng nhm ring bit (VD: nhm Qun l, nhm K thut, nhm Sales...)."]})]})}const yD=({nhanVienId:e})=>{const[n,a]=E.useState(null),[r,s]=E.useState(!0),[l,o]=E.useState(!1),[d,u]=E.useState(!1),[x,m]=E.useState({mstCaNhan:"",soCmndCccd:"",ngayCap:"",noiCap:"",soNguoiPhuThuoc:0,ghiChu:""}),f=async()=>{try{s(!0);const N=(await he.get(`/nhan-vien/${e}/thue-bh`)).data;a(N),N&&m({mstCaNhan:N.mstCaNhan||"",soCmndCccd:N.soCmndCccd||"",ngayCap:N.ngayCap?N.ngayCap.split("T")[0]:"",noiCap:N.noiCap||"",soNguoiPhuThuoc:N.soNguoiPhuThuoc||0,ghiChu:N.ghiChu||""})}catch(y){console.error("Li khi ti thng tin thu/BHXH:",y)}finally{s(!1)}};E.useEffect(()=>{f()},[e]);const p=y=>{const{name:N,value:k}=y.target;m(T=>({...T,[N]:N==="soNguoiPhuThuoc"?parseInt(k)||0:k}))},b=async()=>{try{o(!0),await he.post(`/nhan-vien/${e}/thue-bh`,x),await f(),u(!1)}catch(y){console.error("Li khi lu thng tin thu/BHXH:",y),alert("C li xy ra khi lu thng tin")}finally{o(!1)}},g=()=>{m(n?{mstCaNhan:n.mstCaNhan||"",soCmndCccd:n.soCmndCccd||"",ngayCap:n.ngayCap?n.ngayCap.split("T")[0]:"",noiCap:n.noiCap||"",soNguoiPhuThuoc:n.soNguoiPhuThuoc||0,ghiChu:n.ghiChu||""}:{mstCaNhan:"",soCmndCccd:"",ngayCap:"",noiCap:"",soNguoiPhuThuoc:0,ghiChu:""}),u(!1)};return r?t.jsx("div",{className:"flex justify-center items-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Thng tin Thu & BHXH"}),d?t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:g,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:b,disabled:l,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:l?"ang lu...":"Lu"})]}):t.jsx("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:n?"Chnh sa":"Thm thng tin"})]}),t.jsxs("div",{className:"bg-white border rounded-lg p-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S CMND/CCCD"}),d?t.jsx("input",{type:"text",name:"soCmndCccd",value:x.soCmndCccd,onChange:p,placeholder:"Nhp s CMND/CCCD",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:(n==null?void 0:n.soCmndCccd)||""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy cp"}),d?t.jsx(Ut,{value:x.ngayCap,onChange:y=>m(N=>({...N,ngayCap:y})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:n!=null&&n.ngayCap?new Date(n.ngayCap).toLocaleDateString("vi-VN"):""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ni cp"}),d?t.jsx("input",{type:"text",name:"noiCap",value:x.noiCap,onChange:p,placeholder:"Nhp ni cp",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:(n==null?void 0:n.noiCap)||""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M s thu c nhn"}),d?t.jsx("input",{type:"text",name:"mstCaNhan",value:x.mstCaNhan,onChange:p,placeholder:"Nhp m s thu",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:(n==null?void 0:n.mstCaNhan)||""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S ngi ph thuc"}),d?t.jsx("input",{type:"number",name:"soNguoiPhuThuoc",min:"0",value:x.soNguoiPhuThuoc,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsxs("p",{className:"text-gray-900",children:[(n==null?void 0:n.soNguoiPhuThuoc)??0," ngi"]})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),d?t.jsx("textarea",{name:"ghiChu",value:x.ghiChu,onChange:p,rows:3,placeholder:"Nhp ghi ch (nu c)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}):t.jsx("p",{className:"text-gray-900",children:(n==null?void 0:n.ghiChu)||""})]})]}),t.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[t.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:" Thng tin gim tr thu TNCN"}),t.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[t.jsx("p",{children:" Gim tr bn thn: 11.000.000 /thng"}),t.jsx("p",{children:" Gim tr ngi ph thuc: 4.400.000 /ngi/thng"}),t.jsx("p",{children:t.jsxs("strong",{children:["Tng gim tr: ",(11e6+(x.soNguoiPhuThuoc||0)*44e5).toLocaleString("vi-VN")," /thng"]})})]})]})]}),n&&t.jsxs("div",{className:"text-sm text-gray-500",children:["Cp nht ln cui: ",new Date().toLocaleDateString("vi-VN")]})]})};function vD({nhanVienId:e}){var l;const{data:n,isLoading:a}=Ie({queryKey:["lich-su-phong-ban",e],queryFn:()=>Ma.layLichSuPhongBan(e)});if(a)return t.jsxs("div",{className:"card animate-pulse",children:[t.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-4"}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"h-16 bg-gray-200 rounded"}),t.jsx("div",{className:"h-16 bg-gray-200 rounded"})]})]});const r=n==null?void 0:n.find(o=>!o.denNgay),s=(n==null?void 0:n.filter(o=>o.denNgay))||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"card border-l-4 border-l-green-500",children:[t.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2 text-lg",children:[t.jsx(Lr,{className:"text-green-600",size:20}),"Phng ban hin ti"]}),r?t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:t.jsx(Lr,{className:"text-green-600",size:24})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium text-gray-900 text-lg",children:((l=r.phongBan)==null?void 0:l.tenPhongBan)||"N/A"}),r.donViCon&&t.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1 mt-1",children:[t.jsx(dn,{size:14}),r.donViCon.loaiDonVi,": ",r.donViCon.tenDonVi]}),t.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1 mt-2",children:[t.jsx(At,{size:14}),"T: ",vs(r.tuNgay)]}),r.ghiChu&&t.jsx("div",{className:"text-sm text-gray-500 mt-2 italic",children:r.ghiChu})]}),t.jsx("div",{className:"px-3 py-1 rounded-full bg-green-100 text-green-700 text-sm font-medium",children:"ang lm vic"})]}):t.jsxs("div",{className:"text-center text-gray-500 py-4",children:[t.jsx(Wd,{size:40,className:"mx-auto text-gray-300 mb-2"}),t.jsx("p",{children:"Cha c thng tin phng ban"})]})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2 text-lg",children:[t.jsx(an,{className:"text-gray-600",size:20}),"Lch s chuyn phng ban",s.length>0&&t.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:[s.length," ln"]})]}),s.length>0?t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute left-6 top-0 bottom-0 w-0.5 bg-gray-200"}),t.jsx("div",{className:"space-y-4",children:s.map(o=>{var d;return t.jsxs("div",{className:"relative flex items-start gap-4 pl-2",children:[t.jsx("div",{className:"absolute left-4 w-4 h-4 bg-gray-300 rounded-full border-2 border-white z-10"}),t.jsxs("div",{className:"ml-10 flex-1 bg-gray-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:((d=o.phongBan)==null?void 0:d.tenPhongBan)||"N/A"}),o.donViCon&&t.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1 mt-1",children:[t.jsx(dn,{size:12}),o.donViCon.loaiDonVi,": ",o.donViCon.tenDonVi]})]}),t.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[t.jsx("div",{children:vs(o.tuNgay)}),t.jsxs("div",{children:[" ",vs(o.denNgay)]})]})]}),o.ghiChu&&t.jsx("div",{className:"text-sm text-gray-500 mt-2 italic",children:o.ghiChu})]})]},o.id)})})]}):t.jsxs("div",{className:"text-center text-gray-500 py-8",children:[t.jsx(an,{size:40,className:"mx-auto text-gray-300 mb-2"}),t.jsx("p",{children:"Cha c lch s chuyn phng ban"}),t.jsx("p",{className:"text-sm",children:"Nhn vin cha tng chuyn phng ban"})]})]})]})}function bD(){var le,ue,ce;const{id:e}=z0(),n=parseInt(e),a=Bt(),[r,s]=E.useState("thong-tin"),[l,o]=E.useState(!1),[d,u]=E.useState(null),[x,m]=E.useState(null),[f,p]=E.useState(!1),[b,g]=E.useState({hoTen:"",email:"",soDienThoai:"",phongBanId:0,chucVu:"",gioiTinh:"",ngaySinh:"",diaChi:"",ngayVaoLam:"",luongCoBan:0,loaiNhanVien:"CHINH_THUC",dongBHXH:!0}),[y,N]=E.useState({khoanLuongId:0,soTien:0,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""}),[k,T]=E.useState({soTienMoi:0,tuNgay:new Date().toISOString().split("T")[0],ghiChu:""}),[S,w]=E.useState({denNgay:new Date().toISOString().split("T")[0]}),{data:_,isLoading:L}=Ie({queryKey:["nhan-vien",n],queryFn:()=>Ma.layTheoId(n)}),{data:C}=Ie({queryKey:["phong-ban"],queryFn:()=>cn.layTatCa()}),{data:P,isLoading:F}=Ie({queryKey:["phu-cap",n],queryFn:()=>Wo.layTheoNhanVien(n)}),{data:H}=Ie({queryKey:["khoan-luong","THU_NHAP"],queryFn:()=>Fr.layTatCa("THU_NHAP")}),O=De({mutationFn:R=>Wo.taoPhuCap(R),onSuccess:()=>{ie.success("Thm ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]}),o(!1),ne()},onError:R=>{var pe,Oe;ie.error(((Oe=(pe=R.response)==null?void 0:pe.data)==null?void 0:Oe.message)||"C li xy ra")}}),B=De({mutationFn:({id:R,data:pe})=>Wo.tang(R,pe),onSuccess:()=>{ie.success("iu chnh ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]}),u(null)},onError:R=>{var pe,Oe;ie.error(((Oe=(pe=R.response)==null?void 0:pe.data)==null?void 0:Oe.message)||"C li xy ra")}}),W=De({mutationFn:({id:R,denNgay:pe})=>Wo.ketThuc(R,pe,"Admin"),onSuccess:()=>{ie.success("Kt thc ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]}),m(null)},onError:R=>{var pe,Oe;ie.error(((Oe=(pe=R.response)==null?void 0:pe.data)==null?void 0:Oe.message)||"C li xy ra")}}),ee=De({mutationFn:R=>Wo.tamDung(R),onSuccess:()=>{ie.success("Tm dng ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]})}}),q=De({mutationFn:R=>Wo.kichHoat(R),onSuccess:()=>{ie.success("Kch hot ph cp thnh cng"),a.invalidateQueries({queryKey:["phu-cap",n]})}}),fe=De({mutationFn:R=>Ma.capNhat(n,R),onSuccess:()=>{ie.success("Cp nht thng tin nhn vin thnh cng"),a.invalidateQueries({queryKey:["nhan-vien",n]}),p(!1)},onError:R=>{var pe,Oe;ie.error(((Oe=(pe=R.response)==null?void 0:pe.data)==null?void 0:Oe.message)||"C li xy ra khi cp nht")}});E.useEffect(()=>{_&&g({hoTen:_.hoTen||"",email:_.email||"",soDienThoai:_.soDienThoai||"",phongBanId:_.phongBanId||0,chucVu:_.chucVu||"",gioiTinh:_.gioiTinh||"",ngaySinh:_.ngaySinh?new Date(_.ngaySinh).toISOString().split("T")[0]:"",diaChi:_.diaChi||"",ngayVaoLam:_.ngayVaoLam?new Date(_.ngayVaoLam).toISOString().split("T")[0]:"",luongCoBan:_.luongCoBan||0,loaiNhanVien:_.loaiNhanVien||"CHINH_THUC",dongBHXH:_.dongBHXH!==!1})},[_]);const ne=()=>{N({khoanLuongId:0,soTien:0,tuNgay:new Date().toISOString().split("T")[0],denNgay:"",ghiChu:""})},Y=()=>{if(!y.khoanLuongId){ie.error("Vui lng chn khon ph cp");return}if(y.soTien<=0){ie.error("S tin phi > 0");return}O.mutate({nhanVienId:n,khoanLuongId:y.khoanLuongId,soTien:y.soTien,tuNgay:y.tuNgay,denNgay:y.denNgay||void 0,ghiChu:y.ghiChu||void 0,nguoiTao:"Admin"})},X=()=>{if(d){if(k.soTienMoi<=0){ie.error("S tin mi phi > 0");return}B.mutate({id:d.id,data:{soTienMoi:k.soTienMoi,tuNgay:k.tuNgay,ghiChu:k.ghiChu||void 0,nguoiTao:"Admin"}})}},xe=()=>{x&&W.mutate({id:x.id,denNgay:S.denNgay})},K=()=>{var R,pe,Oe,tt;if(!b.hoTen.trim()){ie.error("Vui lng nhp h tn");return}if(!b.phongBanId){ie.error("Vui lng chn phng ban");return}fe.mutate({hoTen:b.hoTen.trim(),email:((R=b.email)==null?void 0:R.trim())||null,soDienThoai:((pe=b.soDienThoai)==null?void 0:pe.trim())||null,phongBanId:b.phongBanId,chucVu:((Oe=b.chucVu)==null?void 0:Oe.trim())||null,gioiTinh:b.gioiTinh||null,ngaySinh:b.ngaySinh||null,diaChi:((tt=b.diaChi)==null?void 0:tt.trim())||null,ngayVaoLam:b.ngayVaoLam||null,luongCoBan:b.luongCoBan||0,loaiNhanVien:b.loaiNhanVien,dongBHXH:b.dongBHXH})},A=()=>{_&&g({hoTen:_.hoTen||"",email:_.email||"",soDienThoai:_.soDienThoai||"",phongBanId:_.phongBanId||0,chucVu:_.chucVu||"",gioiTinh:_.gioiTinh||"",ngaySinh:_.ngaySinh?new Date(_.ngaySinh).toISOString().split("T")[0]:"",diaChi:_.diaChi||"",ngayVaoLam:_.ngayVaoLam?new Date(_.ngayVaoLam).toISOString().split("T")[0]:"",luongCoBan:_.luongCoBan||0,loaiNhanVien:_.loaiNhanVien||"CHINH_THUC",dongBHXH:_.dongBHXH!==!1}),p(!1)},M=(P==null?void 0:P.filter(R=>R.trangThai==="HIEU_LUC"))||[],I=(P==null?void 0:P.filter(R=>R.trangThai==="TAM_DUNG"))||[],V=(P==null?void 0:P.filter(R=>R.trangThai==="KET_THUC"))||[],J=M.reduce((R,pe)=>R+Number(pe.soTien||0),0);if(L)return t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});if(!_)return t.jsx("div",{className:"text-center py-12 text-gray-500",children:"Khng tm thy nhn vin"});const ge=R=>{switch(R){case"HIEU_LUC":return"bg-green-100 text-green-800";case"TAM_DUNG":return"bg-yellow-100 text-yellow-800";case"KET_THUC":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},z=R=>{switch(R){case"HIEU_LUC":return"Hiu lc";case"TAM_DUNG":return"Tm dng";case"KET_THUC":return"Kt thc";default:return R}};return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[t.jsx(ca,{to:"/nhan-vien",className:"p-2 hover:bg-gray-100 rounded-lg",children:t.jsx(q0,{size:24})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:_.hoTen}),t.jsxs("p",{className:"text-gray-500",children:[_.maNhanVien," - ",_.chucVu||"Nhn vin"]})]})]}),t.jsxs("div",{className:"flex gap-2 mb-6 border-b overflow-x-auto",children:[t.jsxs("button",{onClick:()=>s("thong-tin"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="thong-tin"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(ro,{size:18,className:"inline-block mr-2"}),"Thng tin"]}),t.jsxs("button",{onClick:()=>s("hop-dong"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="hop-dong"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(ha,{size:18,className:"inline-block mr-2"}),"Hp ng / Lng"]}),t.jsxs("button",{onClick:()=>s("phu-cap"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="phu-cap"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(ng,{size:18,className:"inline-block mr-2"}),"Ph cp",M.length>0&&t.jsx("span",{className:"ml-2 bg-primary-100 text-primary-700 px-2 py-0.5 rounded-full text-xs",children:M.length})]}),t.jsxs("button",{onClick:()=>s("lich-su"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="lich-su"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(pu,{size:18,className:"inline-block mr-2"}),"Lch s ph cp"]}),t.jsxs("button",{onClick:()=>s("lich-su-phong-ban"),className:`px-4 py-2 font-medium border-b-2 transition-colors whitespace-nowrap ${r==="lich-su-phong-ban"?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(Lr,{size:18,className:"inline-block mr-2"}),"Lch s phng ban"]})]}),r==="thong-tin"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:[t.jsx(ro,{size:20}),"Thng tin c bn"]}),f?t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:A,className:"btn btn-secondary flex items-center gap-2",disabled:fe.isPending,children:[t.jsx(mn,{size:16}),"Hy"]}),t.jsxs("button",{onClick:K,className:"btn btn-primary flex items-center gap-2",disabled:fe.isPending,children:[t.jsx(al,{size:16}),fe.isPending?"ang lu...":"Lu"]})]}):t.jsxs("button",{onClick:()=>p(!0),className:"btn btn-secondary flex items-center gap-2",children:[t.jsx(I_,{size:16}),"Chnh sa"]})]}),f?t.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"M nhn vin"}),t.jsx("p",{className:"font-medium text-gray-400",children:_.maNhanVien}),t.jsx("span",{className:"text-xs text-gray-400",children:"(Khng th sa)"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"H tn *"}),t.jsx("input",{type:"text",value:b.hoTen,onChange:R=>g({...b,hoTen:R.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp h tn"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phng ban *"}),t.jsxs("select",{value:b.phongBanId,onChange:R=>g({...b,phongBanId:parseInt(R.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn phng ban --"}),C==null?void 0:C.map(R=>t.jsx("option",{value:R.id,children:R.tenPhongBan},R.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chc v"}),t.jsx("input",{type:"text",value:b.chucVu,onChange:R=>g({...b,chucVu:R.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp chc v"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gii tnh"}),t.jsxs("select",{value:b.gioiTinh,onChange:R=>g({...b,gioiTinh:R.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn gii tnh --"}),t.jsx("option",{value:"NAM",children:"Nam"}),t.jsx("option",{value:"NU",children:"N"}),t.jsx("option",{value:"KHAC",children:"Khc"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy sinh"}),t.jsx(Ut,{value:b.ngaySinh,onChange:R=>g({...b,ngaySinh:R}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),t.jsx("input",{type:"email",value:b.email,onChange:R=>g({...b,email:R.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp email"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S in thoi"}),t.jsx("input",{type:"tel",value:b.soDienThoai,onChange:R=>g({...b,soDienThoai:R.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp s in thoi"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"a ch"}),t.jsx("input",{type:"text",value:b.diaChi,onChange:R=>g({...b,diaChi:R.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp a ch"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy vo lm"}),t.jsx(Ut,{value:b.ngayVaoLam,onChange:R=>g({...b,ngayVaoLam:R}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lng c bn"}),t.jsx("input",{type:"number",value:b.luongCoBan,onChange:R=>g({...b,luongCoBan:parseFloat(R.target.value)||0}),className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp lng c bn",min:0,step:1e5})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi nhn vin"}),t.jsxs("select",{value:b.loaiNhanVien,onChange:R=>g({...b,loaiNhanVien:R.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"CHINH_THUC",children:"Chnh thc"}),t.jsx("option",{value:"THU_VIEC",children:"Th vic"}),t.jsx("option",{value:"HOC_VIEC",children:"Hc vic"}),t.jsx("option",{value:"THUC_TAP",children:"Thc tp"}),t.jsx("option",{value:"CONG_TAC_VIEN",children:"Cng tc vin"}),t.jsx("option",{value:"THOI_VU",children:"Thi v"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"ng BHXH"}),t.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:"editDongBHXH",checked:b.dongBHXH===!0,onChange:()=>g({...b,dongBHXH:!0}),className:"w-4 h-4 text-blue-600"}),t.jsx("span",{children:"C ng"})]}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:"editDongBHXH",checked:b.dongBHXH===!1,onChange:()=>g({...b,dongBHXH:!1}),className:"w-4 h-4 text-red-600"}),t.jsx("span",{children:"Khng ng"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Tng ph cp hin ti"}),t.jsx("p",{className:"font-medium text-green-600",children:et(J)}),t.jsx("span",{className:"text-xs text-gray-400",children:"(T ng tnh t cc khon ph cp)"})]})]}):t.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"M nhn vin"}),t.jsx("p",{className:"font-medium",children:_.maNhanVien})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"H tn"}),t.jsx("p",{className:"font-medium",children:_.hoTen})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Phng ban"}),t.jsx("p",{className:"font-medium",children:(le=_.phongBan)==null?void 0:le.tenPhongBan})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Chc v"}),t.jsx("p",{className:"font-medium",children:_.chucVu||"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Gii tnh"}),t.jsx("p",{className:"font-medium",children:_.gioiTinh==="NAM"?"Nam":_.gioiTinh==="NU"?"N":_.gioiTinh==="KHAC"?"Khc":"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Ngy sinh"}),t.jsx("p",{className:"font-medium",children:_.ngaySinh?vs(_.ngaySinh):"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Email"}),t.jsx("p",{className:"font-medium",children:_.email||"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"S in thoi"}),t.jsx("p",{className:"font-medium",children:_.soDienThoai||"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"a ch"}),t.jsx("p",{className:"font-medium",children:_.diaChi||"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Ngy vo lm"}),t.jsx("p",{className:"font-medium",children:_.ngayVaoLam?vs(_.ngayVaoLam):"-"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Lng c bn"}),t.jsx("p",{className:"font-medium text-primary-600",children:et(_.luongCoBan)})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Loi nhn vin"}),t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${((ue=v0[_.loaiNhanVien||"CHINH_THUC"])==null?void 0:ue.color)||"bg-gray-100"}`,children:((ce=v0[_.loaiNhanVien||"CHINH_THUC"])==null?void 0:ce.label)||"Chnh thc"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"ng BHXH"}),_.dongBHXH!==!1?t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700",children:"C ng"}):t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-700",children:"Khng ng"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-500",children:"Tng ph cp hin ti"}),t.jsx("p",{className:"font-medium text-green-600",children:et(J)})]})]})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[t.jsx(Lr,{size:20}),"Ti khon ngn hng"]}),t.jsx(pD,{nhanVienId:n})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[t.jsx(ha,{size:20}),"Thng tin Thu & BHXH"]}),t.jsx(yD,{nhanVienId:n})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[t.jsx(dn,{size:20}),"Nhm nhn vin"]}),t.jsx(gD,{nhanVienId:n})]})]}),r==="hop-dong"&&t.jsx("div",{className:"card",children:t.jsx(fD,{nhanVienId:n})}),r==="phu-cap"&&t.jsxs("div",{children:[t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"card bg-green-50",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Ph cp hiu lc"}),t.jsx("p",{className:"text-2xl font-bold text-green-600",children:M.length}),t.jsxs("p",{className:"text-sm text-green-600",children:[et(J),"/thng"]})]}),t.jsxs("div",{className:"card bg-yellow-50",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Tm dng"}),t.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:I.length})]}),t.jsxs("div",{className:"card bg-gray-50",children:[t.jsx("p",{className:"text-sm text-gray-600",children:" kt thc"}),t.jsx("p",{className:"text-2xl font-bold text-gray-600",children:V.length})]})]}),t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h3",{className:"font-semibold text-lg",children:"Danh sch ph cp"}),t.jsxs("button",{onClick:()=>o(!0),className:"btn btn-primary",children:[t.jsx(St,{size:20}),"Thm ph cp"]})]}),M.length>0&&t.jsxs("div",{className:"card mb-4",children:[t.jsxs("h4",{className:"font-medium text-green-700 mb-3 flex items-center gap-2",children:[t.jsx("span",{className:"w-3 h-3 bg-green-500 rounded-full"}),"ang hiu lc (",M.length,")"]}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Khon ph cp"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"T ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"n ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Ghi ch"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Thao tc"})]})}),t.jsx("tbody",{children:M.map(R=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3 font-medium",children:R.khoanLuong.tenKhoan}),t.jsx("td",{className:"py-2 px-3 text-right font-semibold text-primary-600",children:et(R.soTien)}),t.jsx("td",{className:"py-2 px-3",children:vs(R.tuNgay)}),t.jsx("td",{className:"py-2 px-3",children:R.denNgay?vs(R.denNgay):"Khng xc nh"}),t.jsx("td",{className:"py-2 px-3 text-gray-500 text-sm",children:R.ghiChu||"-"}),t.jsx("td",{className:"py-2 px-3",children:t.jsxs("div",{className:"flex justify-center gap-1",children:[t.jsx("button",{onClick:()=>{u(R),T({soTienMoi:R.soTien,tuNgay:new Date().toISOString().split("T")[0],ghiChu:""})},className:"p-1 hover:bg-blue-100 rounded text-blue-600",title:"iu chnh",children:t.jsx(li,{size:18})}),t.jsx("button",{onClick:()=>ee.mutate(R.id),className:"p-1 hover:bg-yellow-100 rounded text-yellow-600",title:"Tm dng",children:t.jsx(P_,{size:18})}),t.jsx("button",{onClick:()=>{m(R),w({denNgay:new Date().toISOString().split("T")[0]})},className:"p-1 hover:bg-red-100 rounded text-red-600",title:"Kt thc",children:t.jsx(At,{size:18})})]})})]},R.id))})]})]}),I.length>0&&t.jsxs("div",{className:"card mb-4",children:[t.jsxs("h4",{className:"font-medium text-yellow-700 mb-3 flex items-center gap-2",children:[t.jsx("span",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),"Tm dng (",I.length,")"]}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Khon ph cp"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Trng thi"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Thao tc"})]})}),t.jsx("tbody",{children:I.map(R=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3",children:R.khoanLuong.tenKhoan}),t.jsx("td",{className:"py-2 px-3 text-right",children:et(R.soTien)}),t.jsx("td",{className:"py-2 px-3",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${ge(R.trangThai)}`,children:z(R.trangThai)})}),t.jsx("td",{className:"py-2 px-3 text-center",children:t.jsx("button",{onClick:()=>q.mutate(R.id),className:"p-1 hover:bg-green-100 rounded text-green-600",title:"Kch hot li",children:t.jsx(ip,{size:18})})})]},R.id))})]})]}),F?t.jsx("div",{className:"text-center py-8",children:"ang ti..."}):(P==null?void 0:P.length)===0?t.jsxs("div",{className:"card text-center py-8 text-gray-500",children:[t.jsx(dl,{size:48,className:"mx-auto mb-4 text-gray-300"}),t.jsx("p",{children:"Nhn vin cha c ph cp no"}),t.jsxs("button",{onClick:()=>o(!0),className:"btn btn-primary mt-4",children:[t.jsx(St,{size:20}),"Thm ph cp u tin"]})]}):null]}),r==="lich-su"&&t.jsxs("div",{className:"card",children:[t.jsx("h3",{className:"font-semibold mb-4",children:"Lch s thay i ph cp"}),P&&P.length>0?t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Khon ph cp"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"T ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"n ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Trng thi"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Ghi ch"})]})}),t.jsx("tbody",{children:P.map(R=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3",children:R.khoanLuong.tenKhoan}),t.jsx("td",{className:"py-2 px-3 text-right font-medium",children:et(R.soTien)}),t.jsx("td",{className:"py-2 px-3",children:vs(R.tuNgay)}),t.jsx("td",{className:"py-2 px-3",children:R.denNgay?vs(R.denNgay):"-"}),t.jsx("td",{className:"py-2 px-3",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${ge(R.trangThai)}`,children:z(R.trangThai)})}),t.jsx("td",{className:"py-2 px-3 text-gray-500 text-sm",children:R.ghiChu||"-"})]},R.id))})]}):t.jsx("p",{className:"text-gray-500 text-center py-8",children:"Cha c d liu lch s"})]}),r==="lich-su-phong-ban"&&t.jsx(vD,{nhanVienId:n}),l&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm ph cp mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Khon ph cp *"}),t.jsxs("select",{value:y.khoanLuongId,onChange:R=>N({...y,khoanLuongId:Number(R.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn khon ph cp --"}),H==null?void 0:H.map(R=>t.jsx("option",{value:R.id,children:R.tenKhoan},R.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S tin *"}),t.jsx("input",{type:"number",value:y.soTien,onChange:R=>N({...y,soTien:Number(R.target.value)}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: 500000"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy bt u *"}),t.jsx(Ut,{value:y.tuNgay,onChange:R=>N({...y,tuNgay:R}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy kt thc (ty chn)"}),t.jsx(Ut,{value:y.denNgay,onChange:R=>N({...y,denNgay:R}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ghi ch"}),t.jsx("textarea",{value:y.ghiChu,onChange:R=>N({...y,ghiChu:R.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[t.jsx("button",{onClick:()=>o(!1),className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:Y,disabled:O.isPending,className:"btn btn-primary",children:O.isPending?"ang lu...":"Thm ph cp"})]})]})}),d&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"iu chnh ph cp"}),t.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg mb-4",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Khon ph cp"}),t.jsx("p",{className:"font-medium",children:d.khoanLuong.tenKhoan}),t.jsxs("p",{className:"text-sm text-gray-500",children:["Hin ti: ",et(d.soTien)]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"S tin mi *"}),t.jsx("input",{type:"number",value:k.soTienMoi,onChange:R=>T({...k,soTienMoi:Number(R.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy hiu lc mi *"}),t.jsx(Ut,{value:k.tuNgay,onChange:R=>T({...k,tuNgay:R}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"L do iu chnh"}),t.jsx("textarea",{value:k.ghiChu,onChange:R=>T({...k,ghiChu:R.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[t.jsx("button",{onClick:()=>u(null),className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:X,disabled:B.isPending,className:"btn btn-primary",children:B.isPending?"ang lu...":"iu chnh"})]})]})}),x&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Kt thc ph cp"}),t.jsxs("div",{className:"bg-red-50 p-3 rounded-lg mb-4",children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Khon ph cp"}),t.jsx("p",{className:"font-medium",children:x.khoanLuong.tenKhoan}),t.jsxs("p",{className:"text-sm text-red-600",children:["S tin: ",et(x.soTien)]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ngy kt thc *"}),t.jsx(Ut,{value:S.denNgay,onChange:R=>w({denNgay:R}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[t.jsx("button",{onClick:()=>m(null),className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:xe,disabled:W.isPending,className:"btn btn-danger",children:W.isPending?"ang lu...":"Kt thc"})]})]})})]})}function ND(){const e=Bt(),[n,a]=E.useState(!1),[r,s]=E.useState(null),[l,o]=E.useState({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",chiuThue:!1,moTa:""}),{data:d,isLoading:u}=Ie({queryKey:["khoan-luong"],queryFn:()=>Fr.layTatCa()}),x=De({mutationFn:Fr.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["khoan-luong"]}),ie.success("To khon lng thnh cng!"),p()},onError:T=>{var S,w;ie.error(((w=(S=T.response)==null?void 0:S.data)==null?void 0:w.message)||"C li xy ra")}}),m=De({mutationFn:({id:T,data:S})=>Fr.capNhat(T,S),onSuccess:()=>{e.invalidateQueries({queryKey:["khoan-luong"]}),ie.success("Cp nht thnh cng!"),p()},onError:T=>{var S,w;ie.error(((w=(S=T.response)==null?void 0:S.data)==null?void 0:w.message)||"C li xy ra")}}),f=De({mutationFn:Fr.xoa,onSuccess:()=>{e.invalidateQueries({queryKey:["khoan-luong"]}),ie.success("Xa khon lng thnh cng!")},onError:T=>{var S,w;ie.error(((w=(S=T.response)==null?void 0:S.data)==null?void 0:w.message)||"C li xy ra")}}),p=()=>{a(!1),s(null),o({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",chiuThue:!1,moTa:""})},b=T=>{s(T),o({maKhoan:T.maKhoan,tenKhoan:T.tenKhoan,loai:T.loai,chiuThue:T.chiuThue,moTa:T.moTa||""}),a(!0)},g=()=>{if(!l.maKhoan||!l.tenKhoan){ie.error("Vui lng in y  thng tin bt buc");return}r?m.mutate({id:r.id,data:l}):x.mutate(l)},y=T=>{confirm(`Bn c chc mun xa khon lng "${T.tenKhoan}"?`)&&f.mutate(T.id)},N=(d==null?void 0:d.filter(T=>T.loai==="THU_NHAP"))||[],k=(d==null?void 0:d.filter(T=>T.loai==="KHAU_TRU"))||[];return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[t.jsx(Pr,{size:28}),"Qun l Khon lng"]}),t.jsxs("button",{onClick:()=>a(!0),className:"btn btn-primary",children:[t.jsx(St,{size:20}),"Thm khon lng"]})]}),u?t.jsx("p",{className:"text-center py-8 text-gray-500",children:"ang ti..."}):t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"card",children:[t.jsxs("h2",{className:"text-lg font-semibold text-green-700 mb-4 flex items-center gap-2",children:[t.jsx("span",{className:"w-3 h-3 bg-green-500 rounded-full"}),"Cc khon Thu nhp (",N.length,")"]}),t.jsxs("div",{className:"space-y-2",children:[N.map(T=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(ib,{size:16,className:"text-gray-400 cursor-grab"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:T.tenKhoan}),t.jsxs("p",{className:"text-xs text-gray-500",children:[T.maKhoan,T.chiuThue&&t.jsx("span",{className:"ml-2 px-1.5 py-0.5 bg-orange-100 text-orange-700 rounded",children:"Chu thu"})]})]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:()=>b(T),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-lg",children:t.jsx(Mr,{size:16})}),t.jsx("button",{onClick:()=>y(T),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg",children:t.jsx(Rr,{size:16})})]})]},T.id)),N.length===0&&t.jsx("p",{className:"text-gray-500 text-center py-4",children:"Cha c khon thu nhp"})]})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h2",{className:"text-lg font-semibold text-red-700 mb-4 flex items-center gap-2",children:[t.jsx("span",{className:"w-3 h-3 bg-red-500 rounded-full"}),"Cc khon Khu tr (",k.length,")"]}),t.jsxs("div",{className:"space-y-2",children:[k.map(T=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(ib,{size:16,className:"text-gray-400 cursor-grab"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:T.tenKhoan}),t.jsx("p",{className:"text-xs text-gray-500",children:T.maKhoan})]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:()=>b(T),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-lg",children:t.jsx(Mr,{size:16})}),t.jsx("button",{onClick:()=>y(T),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg",children:t.jsx(Rr,{size:16})})]})]},T.id)),k.length===0&&t.jsx("p",{className:"text-gray-500 text-center py-4",children:"Cha c khon khu tr (BHXH, thu s thm  y)"})]})]})]}),n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:r?"Sa khon lng":"Thm khon lng mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M khon *"}),t.jsx("input",{type:"text",value:l.maKhoan,onChange:T=>o({...l,maKhoan:T.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: PHU_CAP_XE",disabled:!!r})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tn khon *"}),t.jsx("input",{type:"text",value:l.tenKhoan,onChange:T=>o({...l,tenKhoan:T.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ph cp xe"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi"}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"radio",name:"loai",checked:l.loai==="THU_NHAP",onChange:()=>o({...l,loai:"THU_NHAP"})}),t.jsx("span",{className:"text-green-700",children:"Thu nhp (+)"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"radio",name:"loai",checked:l.loai==="KHAU_TRU",onChange:()=>o({...l,loai:"KHAU_TRU"})}),t.jsx("span",{className:"text-red-700",children:"Khu tr (-)"})]})]})]}),t.jsx("div",{children:t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:l.chiuThue,onChange:T=>o({...l,chiuThue:T.target.checked})}),t.jsx("span",{className:"text-sm",children:"Khon ny chu thu TNCN"})]})}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M t"}),t.jsx("textarea",{value:l.moTa,onChange:T=>o({...l,moTa:T.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:p,className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:g,disabled:x.isPending||m.isPending,className:"btn btn-primary",children:x.isPending||m.isPending?"ang lu...":"Lu"})]})]})})]})}function jD(){const e=Bt(),n=E.useRef(null),[a,r]=E.useState("upload"),[s,l]=E.useState(null),[o,d]=E.useState([]),[u,x]=E.useState([]),[m,f]=E.useState([]),[p,b]=E.useState(new Date().getMonth()+1),[g,y]=E.useState(new Date().getFullYear()),[N,k]=E.useState(0),[T,S]=E.useState(null),{data:w}=Ie({queryKey:["phong-ban"],queryFn:cn.layTatCa}),{data:_}=Ie({queryKey:["khoan-luong"],queryFn:()=>Fr.layTatCa()}),L=De({mutationFn:W=>d0.docHeader(W),onSuccess:W=>{d(W.headers),x(W.duLieuMau),C.mutate(s)},onError:()=>{ie.error("Khng th c file Excel")}}),C=De({mutationFn:W=>d0.goiYMapping(W),onSuccess:W=>{f(W),r("mapping")}}),P=De({mutationFn:()=>d0.import(s,p,g,N,m),onSuccess:W=>{S(W),r("result"),e.invalidateQueries({queryKey:["bang-luong"]}),W.thanhCong?ie.success("Import thnh cng!"):ie.error(`Import c ${W.dongLoi} dng li`)},onError:W=>{var ee,q;ie.error(((q=(ee=W.response)==null?void 0:ee.data)==null?void 0:q.message)||"C li khi import")}}),F=W=>{var q;const ee=(q=W.target.files)==null?void 0:q[0];if(ee){if(!ee.name.endsWith(".xlsx")&&!ee.name.endsWith(".xls")){ie.error("Vui lng chn file Excel (.xlsx hoc .xls)");return}l(ee),L.mutate(ee)}},H=(W,ee,q)=>{const fe=[...m];fe[W]={...fe[W],[ee]:q},f(fe)},O=()=>{if(!N){ie.error("Vui lng chn phng ban");return}if(!m.some(ee=>ee.loaiMapping==="thong_tin"&&ee.truongHeThong==="ma_nhan_vien")){ie.error("Cn mapping ct M nhn vin");return}P.mutate()},B=()=>{r("upload"),l(null),d([]),x([]),f([]),S(null),n.current&&(n.current.value="")};return t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2 mb-6",children:[t.jsx(js,{size:28}),"Import t Excel"]}),t.jsx("div",{className:"flex items-center gap-4 mb-8",children:["Upload file","Mapping ct","Kt qu"].map((W,ee)=>{const q=["upload","mapping","result"],fe=a===q[ee],ne=q.indexOf(a)>ee;return t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:`
                  w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold
                  ${fe?"bg-primary-600 text-white":""}
                  ${ne?"bg-green-500 text-white":""}
                  ${!fe&&!ne?"bg-gray-200 text-gray-500":""}
                `,children:ne?"":ee+1}),t.jsx("span",{className:fe?"font-semibold":"text-gray-500",children:W}),ee<2&&t.jsx(u_,{size:16,className:"text-gray-400 ml-2"})]},W)})}),a==="upload"&&t.jsx("div",{className:"card",children:t.jsxs("div",{className:"text-center py-12",children:[t.jsx(Ys,{size:64,className:"mx-auto text-gray-400 mb-4"}),t.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Chn file Excel  import"}),t.jsx("p",{className:"text-gray-500 mb-6",children:"H tr nh dng .xlsx v .xls"}),t.jsx("input",{ref:n,type:"file",accept:".xlsx,.xls",onChange:F,className:"hidden"}),t.jsxs("button",{onClick:()=>{var W;return(W=n.current)==null?void 0:W.click()},disabled:L.isPending,className:"btn btn-primary",children:[t.jsx(js,{size:20}),L.isPending?"ang c file...":"Chn file Excel"]})]})}),a==="mapping"&&t.jsxs("div",{children:[t.jsxs("div",{className:"card mb-6",children:[t.jsx("h3",{className:"font-semibold mb-4",children:"Thng tin import"}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"File"}),t.jsx("p",{className:"font-medium",children:s==null?void 0:s.name})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Thng"}),t.jsx("select",{value:p,onChange:W=>b(Number(W.target.value)),className:"w-full border rounded-lg px-3 py-2",children:Array.from({length:12},(W,ee)=>ee+1).map(W=>t.jsxs("option",{value:W,children:["Thng ",W]},W))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Nm"}),t.jsx("select",{value:g,onChange:W=>y(Number(W.target.value)),className:"w-full border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(W=>t.jsx("option",{value:W,children:W},W))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban *"}),t.jsxs("select",{value:N,onChange:W=>k(Number(W.target.value)),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn --"}),w==null?void 0:w.map(W=>t.jsx("option",{value:W.id,children:W.tenPhongBan},W.id))]})]})]})]}),t.jsxs("div",{className:"card mb-6",children:[t.jsx("h3",{className:"font-semibold mb-4",children:"Mapping ct Excel  Khon lng"}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Ct"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Tn ct Excel"}),t.jsx("th",{className:"text-left py-2 px-3",children:"D liu mu"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Loi"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Mapping"})]})}),t.jsx("tbody",{children:m.map((W,ee)=>{var q;return t.jsxs("tr",{className:"border-b",children:[t.jsx("td",{className:"py-2 px-3",children:W.soCot}),t.jsx("td",{className:"py-2 px-3 font-medium",children:W.tenCot}),t.jsx("td",{className:"py-2 px-3 text-gray-500",children:((q=u[0])==null?void 0:q[ee])||"-"}),t.jsx("td",{className:"py-2 px-3",children:t.jsxs("select",{value:W.loaiMapping,onChange:fe=>H(ee,"loaiMapping",fe.target.value),className:"border rounded px-2 py-1 text-sm",children:[t.jsx("option",{value:"thong_tin",children:"Thng tin"}),t.jsx("option",{value:"khoan_luong",children:"Khon lng"})]})}),t.jsx("td",{className:"py-2 px-3",children:W.loaiMapping==="thong_tin"?t.jsxs("select",{value:W.truongHeThong||"",onChange:fe=>H(ee,"truongHeThong",fe.target.value),className:"border rounded px-2 py-1 text-sm w-full",children:[t.jsx("option",{value:"",children:"-- B qua --"}),t.jsx("option",{value:"ma_nhan_vien",children:"M nhn vin"}),t.jsx("option",{value:"ho_ten",children:"H tn"}),t.jsx("option",{value:"phong_ban",children:"Phng ban"}),t.jsx("option",{value:"tong_luong_bo_qua",children:"Tng (b qua)"})]}):t.jsxs("select",{value:W.khoanLuongId||"",onChange:fe=>H(ee,"khoanLuongId",Number(fe.target.value)||void 0),className:"border rounded px-2 py-1 text-sm w-full",children:[t.jsx("option",{value:"",children:"-- B qua --"}),_==null?void 0:_.map(fe=>t.jsx("option",{value:fe.id,children:fe.tenKhoan},fe.id))]})})]},ee)})})]})})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("button",{onClick:B,className:"btn btn-secondary",children:"Quay li"}),t.jsx("button",{onClick:O,disabled:P.isPending,className:"btn btn-primary",children:P.isPending?"ang import...":"Bt u Import"})]})]}),a==="result"&&T&&t.jsxs("div",{children:[t.jsx("div",{className:`card mb-6 ${T.thanhCong?"bg-green-50":"bg-yellow-50"}`,children:t.jsxs("div",{className:"flex items-center gap-4",children:[T.thanhCong?t.jsx(ua,{size:48,className:"text-green-500"}):t.jsx(dl,{size:48,className:"text-yellow-500"}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold",children:T.thanhCong?"Import thnh cng!":"Import hon tt (c li)"}),t.jsxs("p",{className:"text-gray-600",children:[" import ",T.dongThanhCong,"/",T.tongDong," dng"]})]})]})}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"card text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-green-600",children:T.dongThanhCong}),t.jsx("p",{className:"text-gray-500",children:"Dng thnh cng"})]}),t.jsxs("div",{className:"card text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-red-600",children:T.dongLoi}),t.jsx("p",{className:"text-gray-500",children:"Dng li"})]}),t.jsxs("div",{className:"card text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-primary-600",children:et(T.tongTienImport)}),t.jsx("p",{className:"text-gray-500",children:"Tng tin import"})]})]}),T.chiTietLoi.length>0&&t.jsxs("div",{className:"card mb-6",children:[t.jsx("h3",{className:"font-semibold text-red-600 mb-3",children:"Chi tit li"}),t.jsx("div",{className:"max-h-48 overflow-y-auto",children:T.chiTietLoi.map((W,ee)=>t.jsxs("div",{className:"flex items-center gap-2 py-2 border-b",children:[t.jsx(xo,{size:16,className:"text-red-500"}),t.jsxs("span",{className:"font-medium",children:["Dng ",W.dong,":"]}),t.jsx("span",{className:"text-gray-600",children:W.lyDo})]},ee))})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx("button",{onClick:B,className:"btn btn-secondary",children:"Import file khc"}),t.jsx("a",{href:`/bang-luong/${T.bangLuongId}`,className:"btn btn-primary",children:"Xem bng lng"})]})]})]})}const of={layDanhSach:(e,n,a)=>{const r=new URLSearchParams({thang:String(e),nam:String(n)});return a&&r.append("phongBanId",String(a)),he.get(`/cham-cong?${r}`)},layChamCongNhanVien:(e,n,a)=>he.get(`/cham-cong/nhan-vien/${e}?thang=${n}&nam=${a}`),luu:e=>he.post("/cham-cong",e),khoiTao:(e,n,a=26)=>he.post("/cham-cong/khoi-tao",{thang:e,nam:n,soCongChuan:a}),import:(e,n,a)=>he.post("/cham-cong/import",{thang:e,nam:n,duLieu:a})},cf={lay:e=>he.get(`/cham-cong/cau-hinh-phat/${e}`),capNhat:(e,n)=>he.put(`/cham-cong/cau-hinh-phat/${e}`,n),tinhPhat:(e,n,a)=>he.get(`/cham-cong/tinh-phat/${e}?thang=${n}&nam=${a}`)},wD={dongBoCSV:e=>he.post("/cham-cong/dong-bo-csv",{csvContent:e})};function kD(){const[e,n]=E.useState("cham-cong"),[a,r]=E.useState(new Date().getMonth()+1),[s,l]=E.useState(new Date().getFullYear()),[o,d]=E.useState(),[u,x]=E.useState([]),[m,f]=E.useState([]),[p,b]=E.useState(null),[g,y]=E.useState({}),[N,k]=E.useState(!1),[T,S]=E.useState(null),[w,_]=E.useState({}),[L,C]=E.useState(null),[P,F]=E.useState(null),[H,O]=E.useState(!1),B=E.useRef(null);E.useEffect(()=>{he.get("/phong-ban").then(A=>x(A.data))},[]),E.useEffect(()=>{W()},[a,s,o]),E.useEffect(()=>{e==="cau-hinh"&&ee()},[e,s]);const W=async()=>{k(!0);try{const A=await of.layDanhSach(a,s,o);f(A.data);const M={};for(const I of A.data)if(I.soLanDiMuon>0||I.soLanVeSom>0||Number(I.soNgayNghiKhongLuong)>0)try{const V=await cf.tinhPhat(I.nhanVienId,a,s);M[I.nhanVienId]=V.data}catch{}y(M)}catch{ie.error("Li ti d liu chm cng")}k(!1)},ee=async()=>{try{const A=await cf.lay(s);b(A.data)}catch{ie.error("Li ti cu hnh pht")}},q=async()=>{if(confirm(`Khi to chm cng thng ${a}/${s} cho tt c nhn vin?`))try{const A=await of.khoiTao(a,s,26);ie.success(`${A.data.message} -  to: ${A.data.created}, B qua: ${A.data.skipped}`),W()}catch{ie.error("Li khi to chm cng")}},fe=A=>{S(A.id),_({nhanVienId:A.nhanVienId,thang:A.thang,nam:A.nam,soCongChuan:Number(A.soCongChuan),soCongThucTe:Number(A.soCongThucTe),soNgayNghiPhep:Number(A.soNgayNghiPhep),soNgayNghiKhongLuong:Number(A.soNgayNghiKhongLuong),soGioOT:Number(A.soGioOT),soLanDiMuon:A.soLanDiMuon,soLanVeSom:A.soLanVeSom})},ne=async()=>{if(w.nhanVienId)try{await of.luu(w),ie.success(" lu chm cng"),S(null),_({}),W()}catch{ie.error("Li lu chm cng")}},Y=async()=>{if(p)try{await cf.capNhat(s,p),ie.success(" lu cu hnh pht")}catch{ie.error("Li lu cu hnh")}},X=A=>new Intl.NumberFormat("vi-VN").format(A)+" ",xe=A=>{var I;const M=(I=A.target.files)==null?void 0:I[0];M&&(C(M),F(null))},K=async()=>{var A,M;if(!L){ie.error("Vui lng chn file CSV");return}O(!0);try{const I=await L.text(),V=await wD.dongBoCSV(I);F(V.data),ie.success(` ng b ${V.data.luuThanhCong} nhn vin thnh cng`),W()}catch(I){ie.error(((M=(A=I==null?void 0:I.response)==null?void 0:A.data)==null?void 0:M.message)||"Li ng b file")}O(!1)};return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex justify-between items-center",children:t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[t.jsx(an,{className:"text-primary-600"}),"Qun l Chm cng"]}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Theo di chm cng, i mun, ngh khng php"})]})}),t.jsx("div",{className:"border-b border-gray-200",children:t.jsxs("nav",{className:"flex gap-4",children:[t.jsxs("button",{onClick:()=>n("cham-cong"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${e==="cham-cong"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(dn,{size:18,className:"inline mr-2"}),"Chm cng thng"]}),t.jsxs("button",{onClick:()=>n("dong-bo"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${e==="dong-bo"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(js,{size:18,className:"inline mr-2"}),"ng b my chm cng"]}),t.jsxs("button",{onClick:()=>n("cau-hinh"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${e==="cau-hinh"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(Zs,{size:18,className:"inline mr-2"}),"Cu hnh pht"]})]})}),e==="cham-cong"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Thng"}),t.jsx("select",{value:a,onChange:A=>r(Number(A.target.value)),className:"border rounded-lg px-3 py-2",children:[...Array(12)].map((A,M)=>t.jsxs("option",{value:M+1,children:["Thng ",M+1]},M+1))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Nm"}),t.jsx("select",{value:s,onChange:A=>l(Number(A.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(A=>t.jsx("option",{value:A,children:A},A))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban"}),t.jsxs("select",{value:o||"",onChange:A=>d(A.target.value?Number(A.target.value):void 0),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),u.map(A=>t.jsx("option",{value:A.id,children:A.tenPhongBan},A.id))]})]}),t.jsxs("button",{onClick:W,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg",children:[t.jsx(Ba,{size:18}),"Lm mi"]}),t.jsxs("button",{onClick:q,className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white hover:bg-primary-700 rounded-lg",children:[t.jsx(At,{size:18}),"Khi to thng"]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Cng chun"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Cng thc"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Ngh php"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Ngh KL"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"i mun"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"V sm"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"OT (gi)"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Tin pht"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:N?t.jsx("tr",{children:t.jsx("td",{colSpan:11,className:"px-4 py-8 text-center text-gray-500",children:"ang ti..."})}):m.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:11,className:"px-4 py-8 text-center text-gray-500",children:'Cha c d liu chm cng. Nhn "Khi to thng"  bt u.'})}):m.map(A=>{var J,ge,z,le;const M=T===A.id,I=g[A.nhanVienId],V=A.soLanDiMuon>0||A.soLanVeSom>0||Number(A.soNgayNghiKhongLuong)>0;return t.jsxs("tr",{className:V?"bg-red-50":"",children:[t.jsxs("td",{className:"px-4 py-3",children:[t.jsx("div",{className:"font-medium text-gray-900",children:(J=A.nhanVien)==null?void 0:J.hoTen}),t.jsx("div",{className:"text-sm text-gray-500",children:(ge=A.nhanVien)==null?void 0:ge.maNhanVien})]}),t.jsx("td",{className:"px-4 py-3 text-gray-600",children:(le=(z=A.nhanVien)==null?void 0:z.phongBan)==null?void 0:le.tenPhongBan}),t.jsx("td",{className:"px-4 py-3 text-center",children:M?t.jsx("input",{type:"number",value:w.soCongChuan||0,onChange:ue=>_({...w,soCongChuan:Number(ue.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(A.soCongChuan)}),t.jsx("td",{className:"px-4 py-3 text-center",children:M?t.jsx("input",{type:"number",value:w.soCongThucTe||0,onChange:ue=>_({...w,soCongThucTe:Number(ue.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(A.soCongThucTe)}),t.jsx("td",{className:"px-4 py-3 text-center",children:M?t.jsx("input",{type:"number",value:w.soNgayNghiPhep||0,onChange:ue=>_({...w,soNgayNghiPhep:Number(ue.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(A.soNgayNghiPhep)}),t.jsx("td",{className:"px-4 py-3 text-center",children:M?t.jsx("input",{type:"number",value:w.soNgayNghiKhongLuong||0,onChange:ue=>_({...w,soNgayNghiKhongLuong:Number(ue.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):t.jsx("span",{className:Number(A.soNgayNghiKhongLuong)>0?"text-red-600 font-semibold":"",children:Number(A.soNgayNghiKhongLuong)})}),t.jsx("td",{className:"px-4 py-3 text-center",children:M?t.jsx("input",{type:"number",value:w.soLanDiMuon||0,onChange:ue=>_({...w,soLanDiMuon:Number(ue.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):t.jsx("span",{className:A.soLanDiMuon>0?"text-orange-600 font-semibold":"",children:A.soLanDiMuon})}),t.jsx("td",{className:"px-4 py-3 text-center",children:M?t.jsx("input",{type:"number",value:w.soLanVeSom||0,onChange:ue=>_({...w,soLanVeSom:Number(ue.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):t.jsx("span",{className:A.soLanVeSom>0?"text-orange-600 font-semibold":"",children:A.soLanVeSom})}),t.jsx("td",{className:"px-4 py-3 text-center text-blue-600",children:M?t.jsx("input",{type:"number",value:w.soGioOT||0,onChange:ue=>_({...w,soGioOT:Number(ue.target.value)}),className:"w-16 border rounded px-2 py-1 text-center"}):Number(A.soGioOT)}),t.jsx("td",{className:"px-4 py-3 text-right",children:I&&I.tongPhat>0&&t.jsx("div",{className:"text-red-600 font-semibold",title:`Pht i mun: ${X(I.tienPhatDiMuon)}
Pht v sm: ${X(I.tienPhatVeSom)}
Pht ngh KP: ${X(I.tienPhatNghiKhongPhep)}
Tr lng: ${X(I.truLuongNgayCong)}`,children:X(I.tongPhat)})}),t.jsx("td",{className:"px-4 py-3 text-center",children:M?t.jsxs("div",{className:"flex gap-2 justify-center",children:[t.jsx("button",{onClick:ne,className:"p-1 text-green-600 hover:bg-green-50 rounded",children:t.jsx(al,{size:18})}),t.jsx("button",{onClick:()=>{S(null),_({})},className:"p-1 text-gray-600 hover:bg-gray-100 rounded",children:""})]}):t.jsx("button",{onClick:()=>fe(A),className:"p-1 text-primary-600 hover:bg-primary-50 rounded",children:"Sa"})})]},A.id)})})]})})}),m.length>0&&t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng nhn vin"}),t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:m.length})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"i mun"}),t.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[m.filter(A=>A.soLanDiMuon>0).length," NV"]})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Ngh khng php"}),t.jsxs("div",{className:"text-2xl font-bold text-red-600",children:[m.filter(A=>Number(A.soNgayNghiKhongLuong)>0).length," NV"]})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng tin pht"}),t.jsx("div",{className:"text-2xl font-bold text-red-600",children:X(Object.values(g).reduce((A,M)=>A+M.tongPhat,0))})]})]})]}),e==="dong-bo"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(js,{className:"text-primary-600",size:20}),"Upload file CSV t my chm cng"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{onClick:()=>{var A;return(A=B.current)==null?void 0:A.click()},className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-primary-400 transition-colors",children:[t.jsx(ha,{className:"mx-auto text-gray-400 mb-3",size:48}),L?t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-800",children:L.name}),t.jsxs("p",{className:"text-sm text-gray-500",children:[(L.size/1024).toFixed(1)," KB"]})]}):t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-600",children:"Nhp  chn file CSV"}),t.jsx("p",{className:"text-sm text-gray-400",children:"H tr file t my chm cng (Access Controller)"})]}),t.jsx("input",{ref:B,type:"file",accept:".csv",onChange:xe,className:"hidden"})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsxs("button",{onClick:K,disabled:!L||H,className:"flex items-center gap-2 px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[H?t.jsx(Ba,{size:18,className:"animate-spin"}):t.jsx(js,{size:18}),H?"ang x l...":"ng b d liu"]}),L&&t.jsx("button",{onClick:()=>{C(null),F(null),B.current&&(B.current.value="")},className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"Xa file"})]})]})]}),P&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng bn ghi"}),t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:P.tongBanGhi})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"S ngy cng"}),t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:P.tongNgay})]}),t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Lu thnh cng"}),t.jsxs("div",{className:"text-2xl font-bold text-green-600 flex items-center gap-2",children:[t.jsx(ua,{size:24})," ",P.luuThanhCong]})]}),t.jsxs("div",{className:"bg-red-50 p-4 rounded-lg shadow-sm",children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Li"}),t.jsxs("div",{className:"text-2xl font-bold text-red-600 flex items-center gap-2",children:[t.jsx(xo,{size:24})," ",P.luuThatBai]})]})]}),P.thongKe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b",children:t.jsx("h4",{className:"font-semibold",children:"Thng k theo nhn vin"})}),t.jsx("div",{className:"overflow-x-auto max-h-64",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Thng/Nm"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"S cng"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"i mun"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"V sm"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:P.thongKe.map((A,M)=>t.jsxs("tr",{className:A.soLanDiMuon>0||A.soLanVeSom>0?"bg-orange-50":"",children:[t.jsx("td",{className:"px-4 py-2 font-medium",children:A.maNhanVien}),t.jsxs("td",{className:"px-4 py-2 text-center",children:[A.thang,"/",A.nam]}),t.jsx("td",{className:"px-4 py-2 text-center text-blue-600 font-semibold",children:A.soCongThucTe}),t.jsx("td",{className:"px-4 py-2 text-center",children:t.jsx("span",{className:A.soLanDiMuon>0?"text-orange-600 font-semibold":"",children:A.soLanDiMuon})}),t.jsx("td",{className:"px-4 py-2 text-center",children:t.jsx("span",{className:A.soLanVeSom>0?"text-orange-600 font-semibold":"",children:A.soLanVeSom})})]},M))})]})})]}),P.chiTiet.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b",children:t.jsxs("h4",{className:"font-semibold",children:["Chi tit chm cng (",P.chiTiet.length," ngy)"]})}),t.jsxs("div",{className:"overflow-x-auto max-h-96",children:[t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Gi vo"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Gi ra"}),t.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:P.chiTiet.slice(0,100).map((A,M)=>t.jsxs("tr",{className:A.diMuon||A.veSom?"bg-orange-50":"",children:[t.jsx("td",{className:"px-4 py-2 font-medium",children:A.maNhanVien}),t.jsx("td",{className:"px-4 py-2",children:A.ngay}),t.jsxs("td",{className:"px-4 py-2 text-center",children:[t.jsx("span",{className:A.diMuon?"text-orange-600 font-semibold":"",children:A.gioVao||"-"}),A.diMuon&&t.jsxs("span",{className:"text-xs text-orange-500 ml-1",children:["(+",A.phutMuon,"p)"]})]}),t.jsxs("td",{className:"px-4 py-2 text-center",children:[t.jsx("span",{className:A.veSom?"text-orange-600 font-semibold":"",children:A.gioRa||"-"}),A.veSom&&t.jsxs("span",{className:"text-xs text-orange-500 ml-1",children:["(-",A.phutSom,"p)"]})]}),t.jsxs("td",{className:"px-4 py-2 text-center",children:[A.diMuon&&t.jsx("span",{className:"px-2 py-0.5 bg-orange-100 text-orange-700 text-xs rounded mr-1",children:"Mun"}),A.veSom&&t.jsx("span",{className:"px-2 py-0.5 bg-orange-100 text-orange-700 text-xs rounded",children:"Sm"}),!A.diMuon&&!A.veSom&&t.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded",children:"OK"})]})]},M))})]}),P.chiTiet.length>100&&t.jsxs("div",{className:"px-4 py-2 bg-gray-50 text-center text-sm text-gray-500",children:["Hin th 100/",P.chiTiet.length," bn ghi"]})]})]}),P.loi.length>0&&t.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[t.jsxs("h4",{className:"font-semibold text-red-800 mb-2",children:[" Li (",P.loi.length,")"]}),t.jsx("ul",{className:"text-sm text-red-700 space-y-1 list-disc ml-5",children:P.loi.map((A,M)=>t.jsx("li",{children:A},M))})]})]}),t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:" Hng dn:"}),t.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc ml-5",children:[t.jsx("li",{children:"Upload file CSV xut t my chm cng (Access Controller)"}),t.jsxs("li",{children:["Format: Tn ring, H, ",t.jsx("strong",{children:"ID (m NV)"}),", B phn, ",t.jsx("strong",{children:"Ngy"}),", ",t.jsx("strong",{children:"Thi gian"}),", ..."]}),t.jsx("li",{children:"H thng t ng nhn din gi vo (qut u bui sng) v gi ra (qut cui bui chiu)"}),t.jsx("li",{children:"So snh vi gi chun (cu hnh trong tab Cu hnh pht)  xc nh i mun/v sm"}),t.jsx("li",{children:"D liu s c tng hp theo thng v lu vo h thng"})]})]})]}),e==="cau-hinh"&&p&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx("label",{className:"font-medium",children:"Nm p dng:"}),t.jsx("select",{value:s,onChange:A=>l(Number(A.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(A=>t.jsx("option",{value:A,children:A},A))})]}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(aa,{className:"text-orange-500",size:20}),"Pht i mun (theo thng)"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"i mun 1-3 ln"}),t.jsx("input",{type:"number",value:Number(p.phatDiMuon1_3Lan),onChange:A=>b({...p,phatDiMuon1_3Lan:Number(A.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"i mun 4-6 ln"}),t.jsx("input",{type:"number",value:Number(p.phatDiMuon4_6Lan),onChange:A=>b({...p,phatDiMuon4_6Lan:Number(A.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"i mun trn 6 ln"}),t.jsx("input",{type:"number",value:Number(p.phatDiMuonTren6Lan),onChange:A=>b({...p,phatDiMuonTren6Lan:Number(A.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]})]}),t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(aa,{className:"text-orange-500",size:20}),"Pht v sm (theo thng)"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"V sm 1-3 ln"}),t.jsx("input",{type:"number",value:Number(p.phatVeSom1_3Lan),onChange:A=>b({...p,phatVeSom1_3Lan:Number(A.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"V sm 4-6 ln"}),t.jsx("input",{type:"number",value:Number(p.phatVeSom4_6Lan),onChange:A=>b({...p,phatVeSom4_6Lan:Number(A.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"V sm trn 6 ln"}),t.jsx("input",{type:"number",value:Number(p.phatVeSomTren6Lan),onChange:A=>b({...p,phatVeSomTren6Lan:Number(A.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]})]}),t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(aa,{className:"text-red-500",size:20}),"Ngh khng php"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Tin pht mi ngy (VN)"}),t.jsx("input",{type:"number",value:Number(p.phatNghiKhongPhep),onChange:A=>b({...p,phatNghiKhongPhep:Number(A.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",id:"truLuong",checked:p.truLuongNghiKhongPhep,onChange:A=>b({...p,truLuongNghiKhongPhep:A.target.checked}),className:"rounded"}),t.jsx("label",{htmlFor:"truLuong",className:"text-sm text-gray-700",children:"Tr thm lng theo ngy cng (Lng / Cng chun  S ngy ngh)"})]})]})]}),t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t.jsx(an,{className:"text-blue-500",size:20}),"Gi lm vic chun"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Gi vo"}),t.jsx("input",{type:"time",value:p.gioVaoChuan,onChange:A=>b({...p,gioVaoChuan:A.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Gi ra"}),t.jsx("input",{type:"time",value:p.gioRaChuan,onChange:A=>b({...p,gioRaChuan:A.target.value}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"S pht c php tr"}),t.jsx("input",{type:"number",value:p.phutChoPhepTre,onChange:A=>b({...p,phutChoPhepTre:Number(A.target.value)}),className:"w-full border rounded-lg px-3 py-2"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Nhn vin n tr trong khong thi gian ny khng b tnh i mun"})]})]})]})]}),t.jsx("div",{className:"flex justify-end",children:t.jsxs("button",{onClick:Y,className:"flex items-center gap-2 px-6 py-2 bg-primary-600 text-white hover:bg-primary-700 rounded-lg",children:[t.jsx(al,{size:18}),"Lu cu hnh"]})}),t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:" Cch tnh tin pht:"}),t.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc ml-5",children:[t.jsx("li",{children:"Pht i mun: Tnh theo s ln i mun trong thng (1-3, 4-6, hoc >6 ln)"}),t.jsx("li",{children:"Pht v sm: Tnh theo s ln v sm trong thng"}),t.jsx("li",{children:"Pht ngh khng php: Tin pht  S ngy ngh"}),t.jsx("li",{children:"Tr lng: (Lng c bn  Cng chun)  S ngy ngh khng php"}),t.jsx("li",{children:"Tng pht = Pht i mun + Pht v sm + Pht ngh KP + Tr lng"})]})]})]})]})}const lw=[{value:"VAN_HANH",label:"Vn hnh"},{value:"KINH_DOANH",label:"Kinh doanh"},{value:"VAN_PHONG",label:"Vn phng"},{value:"SAN_XUAT",label:"Sn xut"}],Rb=[{value:"TO",label:"T"},{value:"NHOM",label:"Nhm"},{value:"CA",label:"Ca"}];function ow({node:e,level:n=0,onEdit:a,onDelete:r,onAddChild:s,onManageDonViCon:l,expandedNodes:o,toggleExpand:d}){var m,f,p,b;const u=e.children&&e.children.length>0,x=o.has(e.id);return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 py-2 px-3 hover:bg-gray-50 rounded-lg group",style:{marginLeft:n*24},children:[t.jsx("button",{onClick:()=>d(e.id),className:`w-6 h-6 flex items-center justify-center rounded hover:bg-gray-200 ${u?"":"invisible"}`,children:x?t.jsx(Ar,{size:16}):t.jsx($n,{size:16})}),t.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${n===0?"bg-primary-100 text-primary-600":n===1?"bg-blue-100 text-blue-600":n===2?"bg-green-100 text-green-600":"bg-orange-100 text-orange-600"}`,children:n===0?t.jsx(Lr,{size:16}):t.jsx(oj,{size:16})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-medium text-gray-900",children:e.tenPhongBan}),t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-600",children:e.maPhongBan}),e.loaiPhongBan&&t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-indigo-100 text-indigo-600",children:((m=lw.find(g=>g.value===e.loaiPhongBan))==null?void 0:m.label)||e.loaiPhongBan})]}),e.moTa&&t.jsx("div",{className:"text-xs text-gray-500 truncate",children:e.moTa})]}),t.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[t.jsxs("div",{className:"flex items-center gap-1 text-gray-500",title:"Nhn vin",children:[t.jsx(dn,{size:14}),t.jsx("span",{children:((f=e._count)==null?void 0:f.nhanViens)||0})]}),(((p=e._count)==null?void 0:p.donViCons)||0)>0&&t.jsxs("div",{className:"flex items-center gap-1 text-gray-500",title:"n v con",children:[t.jsx(p0,{size:14}),t.jsx("span",{children:(b=e._count)==null?void 0:b.donViCons})]})]}),t.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[t.jsx("button",{onClick:()=>s(e.id),className:"p-1.5 text-green-600 hover:bg-green-50 rounded",title:"Thm phng ban con",children:t.jsx(St,{size:16})}),t.jsx("button",{onClick:()=>l(e),className:"p-1.5 text-purple-600 hover:bg-purple-50 rounded",title:"Qun l T/Ca",children:t.jsx(p0,{size:16})}),t.jsx("button",{onClick:()=>a(e),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:"Sa",children:t.jsx(Mr,{size:16})}),t.jsx("button",{onClick:()=>r(e),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Ngng hot ng",children:t.jsx(Rr,{size:16})})]})]}),u&&x&&t.jsx("div",{children:e.children.map(g=>t.jsx(ow,{node:g,level:n+1,onEdit:a,onDelete:r,onAddChild:s,onManageDonViCon:l,expandedNodes:o,toggleExpand:d},g.id))})]})}function TD(){const e=Bt(),[n,a]=E.useState(""),[r,s]=E.useState(new Set),[l,o]=E.useState(!1),[d,u]=E.useState(!1),[x,m]=E.useState(null),[f,p]=E.useState(null),[b,g]=E.useState(null),[y,N]=E.useState({maPhongBan:"",tenPhongBan:"",moTa:"",loaiPhongBan:"",gioVaoChuan:"08:00",gioRaChuan:"17:00",phutChoPhepTre:5}),[k,T]=E.useState({maDonVi:"",tenDonVi:"",loaiDonVi:"TO"}),{data:S,isLoading:w}=Ie({queryKey:["phong-ban-cay"],queryFn:cn.layCayPhongBan}),{data:_}=Ie({queryKey:["phong-ban"],queryFn:cn.layTatCa}),{data:L,refetch:C}=Ie({queryKey:["don-vi-con",b==null?void 0:b.id],queryFn:()=>b?cn.layDonViCon(b.id):Promise.resolve([]),enabled:!!b}),P=De({mutationFn:cn.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["phong-ban-cay"]}),e.invalidateQueries({queryKey:["phong-ban"]}),ne()},onError:I=>{var V,J;alert(((J=(V=I.response)==null?void 0:V.data)==null?void 0:J.message)||"C li xy ra")}}),F=De({mutationFn:({id:I,data:V})=>cn.capNhat(I,V),onSuccess:()=>{e.invalidateQueries({queryKey:["phong-ban-cay"]}),e.invalidateQueries({queryKey:["phong-ban"]}),ne()},onError:I=>{var V,J;alert(((J=(V=I.response)==null?void 0:V.data)==null?void 0:J.message)||"C li xy ra")}}),H=De({mutationFn:cn.ngungHoatDong,onSuccess:()=>{e.invalidateQueries({queryKey:["phong-ban-cay"]}),e.invalidateQueries({queryKey:["phong-ban"]})},onError:I=>{var V,J;alert(((J=(V=I.response)==null?void 0:V.data)==null?void 0:J.message)||"Khng th ngng hot ng phng ban")}}),O=De({mutationFn:({phongBanId:I,data:V})=>cn.taoDonViCon(I,V),onSuccess:()=>{C(),T({maDonVi:"",tenDonVi:"",loaiDonVi:"TO"})},onError:I=>{var V,J;alert(((J=(V=I.response)==null?void 0:V.data)==null?void 0:J.message)||"C li xy ra")}}),B=I=>{s(V=>{const J=new Set(V);return J.has(I)?J.delete(I):J.add(I),J})},W=()=>{const I=new Set,V=J=>{J.forEach(ge=>{I.add(ge.id),ge.children&&V(ge.children)})};S&&V(S),s(I)},ee=()=>{s(new Set)},q=I=>{m(null),p(I||null),N({maPhongBan:"",tenPhongBan:"",moTa:"",loaiPhongBan:"",gioVaoChuan:"08:00",gioRaChuan:"17:00",phutChoPhepTre:5}),o(!0)},fe=I=>{m(I),p(I.phongBanChaId||null),N({maPhongBan:I.maPhongBan,tenPhongBan:I.tenPhongBan,moTa:I.moTa||"",loaiPhongBan:I.loaiPhongBan||"",gioVaoChuan:I.gioVaoChuan||"08:00",gioRaChuan:I.gioRaChuan||"17:00",phutChoPhepTre:I.phutChoPhepTre??5}),o(!0)},ne=()=>{o(!1),m(null),p(null)},Y=I=>{if(I.preventDefault(),!y.maPhongBan.trim()||!y.tenPhongBan.trim()){alert("Vui lng nhp m v tn phng ban");return}const V={...y,phongBanChaId:f||void 0,loaiPhongBan:y.loaiPhongBan||void 0};x?F.mutate({id:x.id,data:V}):P.mutate(V)},X=I=>{confirm(`Bn c chc mun ngng hot ng phng ban "${I.tenPhongBan}"?`)&&H.mutate(I.id)},xe=I=>{g(I),u(!0)},K=I=>{if(I.preventDefault(),!!b){if(!k.maDonVi.trim()||!k.tenDonVi.trim()){alert("Vui lng nhp m v tn n v");return}O.mutate({phongBanId:b.id,data:k})}},A=I=>I.reduce((V,J)=>V+1+(J.children?A(J.children):0),0),M=S?A(S):0;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Lr,{className:"w-8 h-8 text-primary-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Phng ban"}),t.jsx("p",{className:"text-gray-500",children:"Cu trc t chc cng ty dng cy phn cp"})]})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("button",{onClick:()=>q(),className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[t.jsx(St,{size:20}),"Thm phng ban"]})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary-100 flex items-center justify-center",children:t.jsx(Lr,{className:"w-6 h-6 text-primary-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng phng ban"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:M})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-green-100 flex items-center justify-center",children:t.jsx(dn,{className:"w-6 h-6 text-green-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng nhn vin"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:(_==null?void 0:_.reduce((I,V)=>{var J;return I+(((J=V._count)==null?void 0:J.nhanViens)||0)},0))||0})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-purple-100 flex items-center justify-center",children:t.jsx(p0,{className:"w-6 h-6 text-purple-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Tng T/Ca"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:(_==null?void 0:_.reduce((I,V)=>{var J;return I+(((J=V._count)==null?void 0:J.donViCons)||0)},0))||0})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-100 flex items-center justify-center",children:t.jsx(S_,{className:"w-6 h-6 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Cp su nht"}),t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Math.max(...(_==null?void 0:_.map(I=>I.capDo))||[0],0)})]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:W,className:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50",children:"M tt c"}),t.jsx("button",{onClick:ee,className:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50",children:"Thu gn"})]}),t.jsxs("div",{className:"relative max-w-xs",children:[t.jsx(Hr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),t.jsx("input",{type:"text",placeholder:"Tm kim...",className:"w-full pl-9 pr-4 py-1.5 text-sm border rounded-lg focus:ring-2 focus:ring-primary-500",value:n,onChange:I=>a(I.target.value)})]})]}),t.jsx("div",{className:"p-4",children:w?t.jsx("div",{className:"text-center py-8 text-gray-500",children:"ang ti..."}):!S||S.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(Lr,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Cha c phng ban no"}),t.jsx("button",{onClick:()=>q(),className:"mt-3 text-primary-600 hover:text-primary-700 text-sm font-medium",children:"+ Thm phng ban u tin"})]}):t.jsx("div",{className:"space-y-1",children:S.map(I=>t.jsx(ow,{node:I,onEdit:fe,onDelete:X,onAddChild:q,onManageDonViCon:xe,expandedNodes:r,toggleExpand:B},I.id))})})]}),l&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:x?"Cp nht phng ban":"Thm phng ban mi"}),t.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban cha"}),t.jsxs("select",{value:f||"",onChange:I=>p(I.target.value?Number(I.target.value):null),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",children:[t.jsx("option",{value:"",children:"-- Khng c (phng ban gc) --"}),_==null?void 0:_.filter(I=>!x||I.id!==x.id).map(I=>t.jsxs("option",{value:I.id,children:["".repeat(I.capDo-1)," ",I.tenPhongBan]},I.id))]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["M phng ban ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:y.maPhongBan,onChange:I=>N({...y,maPhongBan:I.target.value.toUpperCase()}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"VD: HR, IT..."})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn phng ban ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:y.tenPhongBan,onChange:I=>N({...y,tenPhongBan:I.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"VD: Phng Nhn s..."})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi phng ban"}),t.jsxs("select",{value:y.loaiPhongBan,onChange:I=>N({...y,loaiPhongBan:I.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",children:[t.jsx("option",{value:"",children:"-- Chn loi --"}),lw.map(I=>t.jsx("option",{value:I.value,children:I.label},I.value))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("input",{type:"text",value:y.moTa,onChange:I=>N({...y,moTa:I.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"M t ngn..."})]})]}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(an,{className:"w-5 h-5 text-indigo-600"}),t.jsx("h3",{className:"font-medium text-gray-900",children:"Gi lm vic"})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi vo"}),t.jsx("input",{type:"time",value:y.gioVaoChuan,onChange:I=>N({...y,gioVaoChuan:I.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi ra"}),t.jsx("input",{type:"time",value:y.gioRaChuan,onChange:I=>N({...y,gioRaChuan:I.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cho php tr"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"number",min:"0",max:"60",value:y.phutChoPhepTre,onChange:I=>N({...y,phutChoPhepTre:Number(I.target.value)}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 pr-12"}),t.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm",children:"pht"})]})]})]})]}),t.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[t.jsx("button",{type:"button",onClick:ne,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",disabled:P.isPending||F.isPending,className:"flex-1 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:P.isPending||F.isPending?"ang lu...":x?"Cp nht":"Thm mi"})]})]})]})}),d&&b&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["T/Ca/Nhm - ",b.tenPhongBan]}),t.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),t.jsxs("form",{onSubmit:K,className:"flex items-end gap-3 mb-4 p-4 bg-gray-50 rounded-lg",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M"}),t.jsx("input",{type:"text",value:k.maDonVi,onChange:I=>T({...k,maDonVi:I.target.value.toUpperCase()}),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"TO_A"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn"}),t.jsx("input",{type:"text",value:k.tenDonVi,onChange:I=>T({...k,tenDonVi:I.target.value}),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"T A"})]}),t.jsxs("div",{className:"w-32",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi"}),t.jsx("select",{value:k.loaiDonVi,onChange:I=>T({...k,loaiDonVi:I.target.value}),className:"w-full px-3 py-2 border rounded-lg text-sm",children:Rb.map(I=>t.jsx("option",{value:I.value,children:I.label},I.value))})]}),t.jsx("button",{type:"submit",disabled:O.isPending,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:t.jsx(St,{size:18})})]}),L&&L.length>0?t.jsx("div",{className:"divide-y",children:L.map(I=>{var V;return t.jsxs("div",{className:"flex items-center justify-between py-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${I.loaiDonVi==="TO"?"bg-blue-100 text-blue-600":I.loaiDonVi==="NHOM"?"bg-green-100 text-green-600":"bg-orange-100 text-orange-600"}`,children:t.jsx(p0,{size:16})}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:I.tenDonVi}),t.jsxs("div",{className:"text-xs text-gray-500",children:[I.maDonVi,"  ",(V=Rb.find(J=>J.value===I.loaiDonVi))==null?void 0:V.label]})]})]}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${I.trangThai==="HOAT_DONG"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:I.trangThai==="HOAT_DONG"?"Hot ng":"Ngng"})]},I.id)})}):t.jsx("div",{className:"text-center py-8 text-gray-500",children:"Cha c n v con no"})]})})]})}const zh={LUONG_THANG_CO_DINH:{label:"C nh theo thng",desc:"Nhn  s tin mi thng, khng ph thuc ngy cng"},THEO_NGAY_CONG:{label:"Theo ngy cng",desc:"Tnh theo cng thc: S tin  (Ngy cng thc t / Ngy cng l thuyt)"},CHUYEN_CAN_DIEU_KIEN:{label:"Chuyn cn c iu kin",desc:"Nhn  nu ngh khng php  2 ngy, mt ht nu > 2 ngy"}};function CD(){var ue;const[e,n]=E.useState("phucap"),a=Bt(),[r,s]=E.useState(!1),[l,o]=E.useState(null),[d,u]=E.useState(""),[x,m]=E.useState({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",cachTinh:"LUONG_THANG_CO_DINH",chiuThue:!1,moTa:"",thuTu:0}),{data:f,isLoading:p}=Ie({queryKey:["khoan-luong"],queryFn:()=>Fr.layTatCa()}),b=(f==null?void 0:f.filter(ce=>d===""||ce.loai===d))||[],g=De({mutationFn:Fr.taoMoi,onSuccess:()=>{a.invalidateQueries({queryKey:["khoan-luong"]}),ie.success("To ph cp thnh cng!"),k()},onError:ce=>{var R,pe;ie.error(((pe=(R=ce.response)==null?void 0:R.data)==null?void 0:pe.message)||"C li xy ra")}}),y=De({mutationFn:({id:ce,data:R})=>Fr.capNhat(ce,R),onSuccess:()=>{a.invalidateQueries({queryKey:["khoan-luong"]}),ie.success("Cp nht ph cp thnh cng!"),k()},onError:ce=>{var R,pe;ie.error(((pe=(R=ce.response)==null?void 0:R.data)==null?void 0:pe.message)||"C li xy ra")}}),N=De({mutationFn:Fr.xoa,onSuccess:()=>{a.invalidateQueries({queryKey:["khoan-luong"]}),ie.success("Xa ph cp thnh cng!")},onError:ce=>{var R,pe;ie.error(((pe=(R=ce.response)==null?void 0:R.data)==null?void 0:pe.message)||"C li xy ra")}}),k=()=>{s(!1),o(null),m({maKhoan:"",tenKhoan:"",loai:"THU_NHAP",cachTinh:"LUONG_THANG_CO_DINH",chiuThue:!1,moTa:"",thuTu:0})},T=ce=>{o(ce),m({maKhoan:ce.maKhoan,tenKhoan:ce.tenKhoan,loai:ce.loai,cachTinh:ce.cachTinh||"LUONG_THANG_CO_DINH",chiuThue:ce.chiuThue,moTa:ce.moTa||"",thuTu:ce.thuTu}),s(!0)},S=()=>{if(!x.maKhoan||!x.tenKhoan){ie.error("Vui lng in m v tn ph cp");return}l?y.mutate({id:l.id,data:x}):g.mutate(x)},w=ce=>{confirm(`Bn c chc mun xa ph cp "${ce.tenKhoan}"?`)&&N.mutate(ce.id)},[_,L]=E.useState({nam:new Date().getFullYear(),tyLeBHXH_NV:8,tyLeBHYT_NV:1.5,tyLeBHTN_NV:1,tyLeBHXH_DN:17.5,tyLeBHYT_DN:3,tyLeBHTN_DN:1,tyLeBHXH_KPCCD_NV:.5,tyLeBHXH_KPCCD_DN:1,mucLuongCoSo:18e5,mucLuongToiThieu:496e4}),[C,P]=E.useState(!1),[F,H]=E.useState(null),[O,B]=E.useState({maBien:"",tenBien:"",moTa:"",giaTri:0,donVi:"VND"}),{data:W,isLoading:ee}=Ie({queryKey:["cau-hinh-don-gia"],queryFn:()=>wd.layTatCa()}),q=De({mutationFn:wd.taoMoi,onSuccess:()=>{a.invalidateQueries({queryKey:["cau-hinh-don-gia"]}),ie.success("To n gi thnh cng!"),X()},onError:ce=>{var R,pe;ie.error(((pe=(R=ce.response)==null?void 0:R.data)==null?void 0:pe.message)||"C li xy ra")}}),fe=De({mutationFn:({id:ce,data:R})=>wd.capNhat(ce,R),onSuccess:()=>{a.invalidateQueries({queryKey:["cau-hinh-don-gia"]}),ie.success("Cp nht n gi thnh cng!"),X()},onError:ce=>{var R,pe;ie.error(((pe=(R=ce.response)==null?void 0:R.data)==null?void 0:pe.message)||"C li xy ra")}}),ne=De({mutationFn:wd.xoa,onSuccess:()=>{a.invalidateQueries({queryKey:["cau-hinh-don-gia"]}),ie.success("Xa n gi thnh cng!")},onError:ce=>{var R,pe;ie.error(((pe=(R=ce.response)==null?void 0:R.data)==null?void 0:pe.message)||"C li xy ra")}}),Y=De({mutationFn:wd.khoiTaoMau,onSuccess:ce=>{a.invalidateQueries({queryKey:["cau-hinh-don-gia"]}),ie.success(ce.message||"Khi to n gi mu thnh cng!")},onError:ce=>{var R,pe;ie.error(((pe=(R=ce.response)==null?void 0:R.data)==null?void 0:pe.message)||"C li xy ra")}}),X=()=>{P(!1),H(null),B({maBien:"",tenBien:"",moTa:"",giaTri:0,donVi:"VND"})},xe=ce=>{H(ce),B({maBien:ce.maBien,tenBien:ce.tenBien,moTa:ce.moTa||"",giaTri:Number(ce.giaTri),donVi:ce.donVi||"VND"}),P(!0)},K=()=>{if(!O.maBien||!O.tenBien){ie.error("Vui lng in m v tn n gi");return}F?fe.mutate({id:F.id,data:{tenBien:O.tenBien,moTa:O.moTa,giaTri:O.giaTri,donVi:O.donVi}}):q.mutate(O)},A=ce=>{confirm(`Bn c chc mun xa n gi "${ce.tenBien}"?`)&&ne.mutate(ce.id)},{data:M,isLoading:I}=Ie({queryKey:["thong-tin-cong-ty"],queryFn:Sb.lay}),[V,J]=E.useState({tenCongTy:"",maSoThue:"",diaChi:"",dienThoai:"",email:"",website:"",nguoiDaiDien:"",chucVuDaiDien:""});E.useEffect(()=>{M&&J(M)},[M]);const ge=De({mutationFn:Sb.capNhat,onSuccess:()=>{a.invalidateQueries({queryKey:["thong-tin-cong-ty"]}),ie.success("Cp nht thng tin cng ty thnh cng!")},onError:()=>{ie.error("C li khi cp nht thng tin cng ty")}}),z=async ce=>{ce.preventDefault(),ie.success("Lu cu hnh BHXH/Thu thnh cng!")},le=async ce=>{ce.preventDefault(),await ge.mutateAsync(V)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Zs,{className:"w-8 h-8 text-blue-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Ci t h thng"}),t.jsx("p",{className:"text-gray-600",children:"Qun l cu hnh BHXH, thu v thng tin cng ty"})]})]}),t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"border-b",children:t.jsxs("div",{className:"flex gap-4",children:[t.jsx("button",{onClick:()=>n("phucap"),className:`px-4 py-3 font-medium border-b-2 transition-colors ${e==="phucap"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(C_,{className:"w-4 h-4"}),"Ph cp & Khon lng"]})}),t.jsx("button",{onClick:()=>n("bhxh"),className:`px-4 py-3 font-medium border-b-2 transition-colors ${e==="bhxh"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ha,{className:"w-4 h-4"}),"BHXH / Thu"]})}),t.jsx("button",{onClick:()=>n("congty"),className:`px-4 py-3 font-medium border-b-2 transition-colors ${e==="congty"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Lr,{className:"w-4 h-4"}),"Thng tin cng ty"]})}),t.jsx("button",{onClick:()=>n("dongia"),className:`px-4 py-3 font-medium border-b-2 transition-colors ${e==="dongia"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Pr,{className:"w-4 h-4"}),"n gi sn lng"]})})]})}),t.jsxs("div",{className:"p-6",children:[e==="phucap"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Danh sch Ph cp & Khon lng"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Cu hnh cc khon ph cp, thu nhp, khu tr p dng cho nhn vin"})]}),t.jsxs("button",{onClick:()=>s(!0),className:"btn btn-primary",children:[t.jsx(St,{size:18}),"Thm mi"]})]}),t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsxs("select",{value:d,onChange:ce=>u(ce.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c loi"}),t.jsx("option",{value:"THU_NHAP",children:"Thu nhp"}),t.jsx("option",{value:"KHAU_TRU",children:"Khu tr"})]}),t.jsxs("span",{className:"text-sm text-gray-500",children:["Tng: ",b.length," khon"]})]}),p?t.jsx("div",{className:"text-center py-8",children:t.jsx(Mn,{className:"w-8 h-8 animate-spin mx-auto text-blue-600"})}):t.jsx("div",{className:"overflow-x-auto border rounded-lg",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"M"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Tn khon"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Loi"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Cch tnh"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Chu thu"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Th t"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Thao tc"})]})}),t.jsx("tbody",{children:b.map(ce=>{var R;return t.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4 font-mono text-sm",children:ce.maKhoan}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:ce.tenKhoan}),ce.moTa&&t.jsx("div",{className:"text-xs text-gray-500",children:ce.moTa})]})}),t.jsx("td",{className:"py-3 px-4",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ce.loai==="THU_NHAP"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:ce.loai==="THU_NHAP"?"Thu nhp":"Khu tr"})}),t.jsx("td",{className:"py-3 px-4",children:t.jsx("span",{className:"text-sm",children:((R=zh[ce.cachTinh])==null?void 0:R.label)||ce.cachTinh})}),t.jsx("td",{className:"py-3 px-4 text-center",children:ce.chiuThue?t.jsx("span",{className:"text-green-600",children:""}):t.jsx("span",{className:"text-gray-400",children:"-"})}),t.jsx("td",{className:"py-3 px-4 text-center text-gray-500",children:ce.thuTu}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>T(ce),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Sa",children:t.jsx(Mr,{size:16})}),t.jsx("button",{onClick:()=>w(ce),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Xa",children:t.jsx(Rr,{size:16})})]})})]},ce.id)})})]})}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Hng dn cch tnh lng"}),t.jsx("div",{className:"space-y-2 text-sm text-blue-800",children:Object.entries(zh).map(([ce,R])=>t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("span",{className:"font-medium min-w-[180px]",children:[R.label,":"]}),t.jsx("span",{children:R.desc})]},ce))})]})]}),e==="bhxh"&&t.jsxs("form",{onSubmit:z,className:"space-y-6 max-w-3xl",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Cu hnh BHXH/BHYT/BHTN"}),t.jsx("div",{className:"grid grid-cols-2 gap-4 mb-6",children:t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Nm p dng"})}),t.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.nam,onChange:ce=>L({..._,nam:Number(ce.target.value)})})]})}),t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:[t.jsx("h4",{className:"font-semibold text-blue-900 mb-3",children:"T l ng Nhn vin (%)"}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHXH"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.tyLeBHXH_NV,onChange:ce=>L({..._,tyLeBHXH_NV:Number(ce.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHYT"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.tyLeBHYT_NV,onChange:ce=>L({..._,tyLeBHYT_NV:Number(ce.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHTN"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.tyLeBHTN_NV,onChange:ce=>L({..._,tyLeBHTN_NV:Number(ce.target.value)})})]})]})]}),t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg mb-4",children:[t.jsx("h4",{className:"font-semibold text-green-900 mb-3",children:"T l ng Doanh nghip (%)"}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHXH"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.tyLeBHXH_DN,onChange:ce=>L({..._,tyLeBHXH_DN:Number(ce.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHYT"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.tyLeBHYT_DN,onChange:ce=>L({..._,tyLeBHYT_DN:Number(ce.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"BHTN"})}),t.jsx("input",{type:"number",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.tyLeBHTN_DN,onChange:ce=>L({..._,tyLeBHTN_DN:Number(ce.target.value)})})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Mc lng c s (VN)"})}),t.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.mucLuongCoSo,onChange:ce=>L({..._,mucLuongCoSo:Number(ce.target.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Mc lng ti thiu vng (VN)"})}),t.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:_.mucLuongToiThieu,onChange:ce=>L({..._,mucLuongToiThieu:Number(ce.target.value)})})]})]}),t.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 p-4 rounded-lg text-sm text-yellow-800",children:[t.jsx("strong",{children:"Lu :"})," Cc t l ny s c p dng cho tt c nhn vin khi tnh lng. Vui lng kim tra k trc khi lu."]})]}),t.jsx("div",{className:"flex justify-end gap-2",children:t.jsxs("button",{type:"submit",className:"btn btn-primary",children:[t.jsx(al,{className:"w-4 h-4"}),"Lu cu hnh"]})})]}),e==="congty"&&t.jsx("form",{onSubmit:le,className:"space-y-6 max-w-3xl",children:I?t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx(Mn,{className:"w-8 h-8 animate-spin text-blue-600"})}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thng tin cng ty"}),t.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Tn cng ty *"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:V.tenCongTy||"",onChange:ce=>J({...V,tenCongTy:ce.target.value}),required:!0})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"M s thu"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:V.maSoThue||"",onChange:ce=>J({...V,maSoThue:ce.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"in thoi"})}),t.jsx("input",{type:"tel",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:V.dienThoai||"",onChange:ce=>J({...V,dienThoai:ce.target.value})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"a ch"})}),t.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",rows:2,value:V.diaChi||"",onChange:ce=>J({...V,diaChi:ce.target.value})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Email"})}),t.jsx("input",{type:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:V.email||"",onChange:ce=>J({...V,email:ce.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Website"})}),t.jsx("input",{type:"url",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:V.website||"",onChange:ce=>J({...V,website:ce.target.value})})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Ngi i din"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:V.nguoiDaiDien||"",onChange:ce=>J({...V,nguoiDaiDien:ce.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Chc v ngi i din"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:V.chucVuDaiDien||"",onChange:ce=>J({...V,chucVuDaiDien:ce.target.value})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1",children:t.jsx("span",{className:"text-sm text-gray-700",children:"Logo (URL)"})}),t.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 bg-white",value:V.logo||"",onChange:ce=>J({...V,logo:ce.target.value}),placeholder:"https://example.com/logo.png"}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Nhp URL ca logo cng ty (hin th trn phiu lng)"})]})]}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg text-sm text-blue-800 mt-4",children:[t.jsx("strong",{children:"Lu :"})," Thng tin ny s c hin th trn cc phiu lng khi xut."]})]}),t.jsx("div",{className:"flex justify-end gap-2",children:t.jsx("button",{type:"submit",className:"btn btn-primary",disabled:ge.isPending,children:ge.isPending?t.jsxs(t.Fragment,{children:[t.jsx(Mn,{className:"w-4 h-4 animate-spin"}),"ang lu..."]}):t.jsxs(t.Fragment,{children:[t.jsx(al,{className:"w-4 h-4"}),"Lu thng tin"]})})})]})}),e==="dongia"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Cu hnh n gi sn lng"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Thit lp n gi  tnh thng/pht da trn sn lng, giao hng"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:()=>Y.mutate(),disabled:Y.isPending,className:"btn btn-secondary",children:[t.jsx(Ba,{size:18,className:Y.isPending?"animate-spin":""}),"Khi to mu"]}),t.jsxs("button",{onClick:()=>P(!0),className:"btn btn-primary",children:[t.jsx(St,{size:18}),"Thm n gi"]})]})]}),ee?t.jsx("div",{className:"text-center py-8",children:t.jsx(Mn,{className:"w-8 h-8 animate-spin mx-auto text-blue-600"})}):W&&W.length>0?t.jsx("div",{className:"overflow-x-auto border rounded-lg",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"M bin"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"Tn n gi"}),t.jsx("th",{className:"text-right py-3 px-4 text-sm font-semibold text-gray-600",children:"Gi tr"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"n v"}),t.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600",children:"M t"}),t.jsx("th",{className:"text-center py-3 px-4 text-sm font-semibold text-gray-600",children:"Thao tc"})]})}),t.jsx("tbody",{children:W.map(ce=>t.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4 font-mono text-sm text-blue-600",children:ce.maBien}),t.jsx("td",{className:"py-3 px-4 font-medium",children:ce.tenBien}),t.jsx("td",{className:"py-3 px-4 text-right font-semibold text-green-600",children:Number(ce.giaTri).toLocaleString("vi-VN")}),t.jsx("td",{className:"py-3 px-4 text-center",children:t.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded text-sm",children:ce.donVi||"VND"})}),t.jsx("td",{className:"py-3 px-4 text-sm text-gray-500 max-w-xs truncate",children:ce.moTa}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>xe(ce),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Sa",children:t.jsx(Mr,{size:16})}),t.jsx("button",{onClick:()=>A(ce),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Xa",children:t.jsx(Rr,{size:16})})]})})]},ce.id))})]})}):t.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-dashed",children:[t.jsx(Pr,{className:"w-12 h-12 mx-auto text-gray-400 mb-3"}),t.jsx("p",{className:"text-gray-600 mb-2",children:"Cha c n gi no c cu hnh"}),t.jsx("p",{className:"text-sm text-gray-500 mb-4",children:'Nhn "Khi to mu"  to cc n gi mc nh'}),t.jsxs("button",{onClick:()=>Y.mutate(),disabled:Y.isPending,className:"btn btn-primary",children:[t.jsx(Ba,{size:18,className:Y.isPending?"animate-spin":""}),"Khi to n gi mu"]})]}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Hng dn s dng"}),t.jsxs("div",{className:"space-y-2 text-sm text-blue-800",children:[t.jsxs("p",{children:[" ",t.jsx("strong",{children:"DON_GIA_SP"}),": n gi thng cho mi sn phm t"]}),t.jsxs("p",{children:[" ",t.jsx("strong",{children:"DON_GIA_KHOI_LUONG"}),": n gi thng cho mi n v khi lng giao hng"]}),t.jsxs("p",{children:[" ",t.jsx("strong",{children:"DON_GIA_PHAT_TRE"}),": S tin pht cho mi ln tr gi"]}),t.jsxs("p",{children:[" ",t.jsx("strong",{children:"HE_SO_LOI_SP"}),": H s nhn khi tnh pht sn phm li"]}),t.jsx("p",{className:"mt-2 pt-2 border-t border-blue-200",children:"Cc bin ny s c s dng trong cng thc tnh lng khi c d liu sn lng."})]})]})]})]})]}),r&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:l?"Sa khon ph cp":"Thm khon ph cp mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M khon *"}),t.jsx("input",{type:"text",value:x.maKhoan,onChange:ce=>m({...x,maKhoan:ce.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: PHU_CAP_AN_TRUA",disabled:!!l})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Th t hin th"}),t.jsx("input",{type:"number",value:x.thuTu,onChange:ce=>m({...x,thuTu:Number(ce.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tn khon *"}),t.jsx("input",{type:"text",value:x.tenKhoan,onChange:ce=>m({...x,tenKhoan:ce.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ph cp n tra"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi khon"}),t.jsxs("select",{value:x.loai,onChange:ce=>m({...x,loai:ce.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"THU_NHAP",children:"Thu nhp (cng vo lng)"}),t.jsx("option",{value:"KHAU_TRU",children:"Khu tr (tr khi lng)"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Chu thu TNCN"}),t.jsxs("select",{value:x.chiuThue?"true":"false",onChange:ce=>m({...x,chiuThue:ce.target.value==="true"}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"false",children:"Khng chu thu"}),t.jsx("option",{value:"true",children:"C chu thu"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Cch tnh lng"}),t.jsx("select",{value:x.cachTinh,onChange:ce=>m({...x,cachTinh:ce.target.value}),className:"w-full border rounded-lg px-3 py-2",children:Object.entries(zh).map(([ce,R])=>t.jsx("option",{value:ce,children:R.label},ce))}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:(ue=zh[x.cachTinh])==null?void 0:ue.desc})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M t"}),t.jsx("textarea",{value:x.moTa,onChange:ce=>m({...x,moTa:ce.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2,placeholder:"Ghi ch v khon ph cp ny..."})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:k,className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:S,disabled:g.isPending||y.isPending,className:"btn btn-primary",children:g.isPending||y.isPending?"ang lu...":"Lu"})]})]})}),C&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:F?"Chnh sa n gi":"Thm n gi mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M bin *"}),t.jsx("input",{type:"text",value:O.maBien,onChange:ce=>B({...O,maBien:ce.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: DON_GIA_SP",disabled:!!F})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"n v"}),t.jsxs("select",{value:O.donVi,onChange:ce=>B({...O,donVi:ce.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"VND",children:"VND (ng)"}),t.jsx("option",{value:"%",children:"% (phn trm)"}),t.jsx("option",{value:"ln",children:"Ln (h s)"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tn n gi *"}),t.jsx("input",{type:"text",value:O.tenBien,onChange:ce=>B({...O,tenBien:ce.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: n gi sn phm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gi tr *"}),t.jsx("input",{type:"number",value:O.giaTri,onChange:ce=>B({...O,giaTri:Number(ce.target.value)}),className:"w-full border rounded-lg px-3 py-2",step:"0.01"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M t"}),t.jsx("textarea",{value:O.moTa,onChange:ce=>B({...O,moTa:ce.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2,placeholder:"Ghi ch v n gi ny..."})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:X,className:"btn btn-secondary",children:"Hy"}),t.jsx("button",{onClick:K,disabled:q.isPending||fe.isPending,className:"btn btn-primary",children:q.isPending||fe.isPending?"ang lu...":"Lu"})]})]})})]})}function SD(){const e=Bt(),[n,a]=E.useState(!1),[r,s]=E.useState(null),[l,o]=E.useState({maNhom:"",tenNhom:"",moTa:"",mauSac:"#3B82F6",trangThai:!0}),{data:d,isLoading:u}=Ie({queryKey:["nhom-nhan-vien"],queryFn:iw}),x=De({mutationFn:dD,onSuccess:()=>{ie.success("To nhm thnh cng"),e.invalidateQueries({queryKey:["nhom-nhan-vien"]}),a(!1),p()},onError:y=>{var N,k;ie.error(((k=(N=y.response)==null?void 0:N.data)==null?void 0:k.message)||"Li to nhm")}}),m=De({mutationFn:({id:y,data:N})=>uD(y,N),onSuccess:()=>{ie.success("Cp nht nhm thnh cng"),e.invalidateQueries({queryKey:["nhom-nhan-vien"]}),s(null),a(!1),p()},onError:y=>{var N,k;ie.error(((k=(N=y.response)==null?void 0:N.data)==null?void 0:k.message)||"Li cp nht")}}),f=De({mutationFn:hD,onSuccess:()=>{ie.success(" xa nhm"),e.invalidateQueries({queryKey:["nhom-nhan-vien"]})},onError:y=>{var N,k;ie.error(((k=(N=y.response)==null?void 0:N.data)==null?void 0:k.message)||"Li xa nhm")}}),p=()=>{o({maNhom:"",tenNhom:"",moTa:"",mauSac:"#3B82F6",trangThai:!0})},b=y=>{o({maNhom:y.maNhom,tenNhom:y.tenNhom,moTa:y.moTa||"",mauSac:y.mauSac||"#3B82F6",trangThai:y.trangThai}),s(y.id),a(!0)},g=y=>{y.preventDefault(),r?m.mutate({id:r,data:l}):x.mutate(l)};return u?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Qun l Nhm Nhn vin"}),t.jsxs("button",{onClick:()=>{a(!0),s(null),p()},className:"btn btn-primary flex items-center gap-2",children:[t.jsx(St,{size:20}),"Thm nhm"]})]}),n&&t.jsxs("div",{className:"card mb-6 bg-blue-50 border border-blue-200",children:[t.jsx("h3",{className:"font-semibold mb-4",children:r?"Sa nhm":"To nhm mi"}),t.jsxs("form",{onSubmit:g,className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M nhm *"}),t.jsx("input",{type:"text",value:l.maNhom,onChange:y=>o({...l,maNhom:y.target.value.toUpperCase()}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: NHOM_KT, NHOM_HR...",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tn nhm *"}),t.jsx("input",{type:"text",value:l.tenNhom,onChange:y=>o({...l,tenNhom:y.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Nhm K ton, Nhm HR...",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"M t"}),t.jsx("input",{type:"text",value:l.moTa,onChange:y=>o({...l,moTa:y.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"M t ngn v nhm..."})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Mu sc"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"color",value:l.mauSac,onChange:y=>o({...l,mauSac:y.target.value}),className:"w-10 h-10 rounded cursor-pointer"}),t.jsx("span",{className:"text-sm text-gray-500",children:l.mauSac})]})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Trng thi"}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:l.trangThai,onChange:y=>o({...l,trangThai:y.target.checked}),className:"w-4 h-4 rounded"}),t.jsx("span",{className:"text-sm",children:"ang hot ng"})]})]})]}),t.jsxs("div",{className:"col-span-2 flex gap-2",children:[t.jsx("button",{type:"submit",disabled:x.isPending||m.isPending,className:"btn btn-primary",children:r?"Cp nht":"To mi"}),t.jsx("button",{type:"button",onClick:()=>{a(!1),s(null)},className:"btn btn-secondary",children:"Hy"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[d==null?void 0:d.map(y=>{var N;return t.jsxs("div",{className:`card ${y.trangThai?"":"opacity-60"}`,style:{borderLeftWidth:"4px",borderLeftColor:y.mauSac||"#6B7280"},children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center text-white font-bold text-lg",style:{backgroundColor:y.mauSac||"#6B7280"},children:y.tenNhom.charAt(0).toUpperCase()}),t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold",children:y.tenNhom}),t.jsx("div",{className:"text-xs text-gray-500",children:y.maNhom})]})]}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{onClick:()=>b(y),className:"p-1.5 hover:bg-blue-100 rounded text-blue-600",title:"Sa",children:t.jsx(Mr,{size:16})}),t.jsx("button",{onClick:()=>{confirm(`Xc nhn xa nhm "${y.tenNhom}"?`)&&f.mutate(y.id)},className:"p-1.5 hover:bg-red-100 rounded text-red-600",title:"Xa",children:t.jsx(Rr,{size:16})})]})]}),y.moTa&&t.jsx("div",{className:"text-sm text-gray-600 mt-2",children:y.moTa}),t.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t",children:[t.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[t.jsx(dn,{size:16}),t.jsxs("span",{children:[((N=y._count)==null?void 0:N.thanhViens)||0," thnh vin"]})]}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${y.trangThai?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:y.trangThai?"Hot ng":"Tm dng"})]})]},y.id)}),(d==null?void 0:d.length)===0&&t.jsxs("div",{className:"col-span-3 text-center py-12 text-gray-500 bg-gray-50 rounded-lg",children:[t.jsx(dn,{size:48,className:"mx-auto mb-4 text-gray-300"}),t.jsx("p",{children:"Cha c nhm no"}),t.jsxs("button",{onClick:()=>{a(!0),s(null),p()},className:"btn btn-primary mt-4",children:[t.jsx(St,{size:20}),"To nhm u tin"]})]})]}),t.jsxs("div",{className:"mt-6 bg-blue-50 p-4 rounded-lg text-sm text-blue-800",children:[t.jsx("strong",{children:" Hng dn:"})," Nhm nhn vin c s dng trong Rule Engine  p dng cc quy tc tnh lng khc nhau cho tng nhm. V d: nhm Qun l c ph cp chc v, nhm K thut c ph cp c hi..."]})]})}function _D(){const e=mr(),{dangNhap:n,isAuthenticated:a}=as(),[r,s]=E.useState(""),[l,o]=E.useState(""),[d,u]=E.useState(!1),[x,m]=E.useState("");if(a)return e("/",{replace:!0}),null;const f=async p=>{var b,g;if(p.preventDefault(),m(""),!r||!l){m("Vui lng nhp tn ng nhp v mt khu");return}u(!0);try{await n(r,l),e("/",{replace:!0})}catch(y){m(((g=(b=y.response)==null?void 0:b.data)==null?void 0:g.message)||"ng nhp tht bi")}finally{u(!1)}};return t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:t.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg p-8",children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-blue-100 mb-4",children:t.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"H thng Tnh Lng"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"ng nhp  tip tc"})]}),x&&t.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:x}),t.jsxs("form",{onSubmit:f,className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"tenDangNhap",className:"block text-sm font-medium text-gray-700 mb-2",children:"Tn ng nhp"}),t.jsx("input",{type:"text",id:"tenDangNhap",value:r,onChange:p=>s(p.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition",placeholder:"Nhp tn ng nhp",autoComplete:"username"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"matKhau",className:"block text-sm font-medium text-gray-700 mb-2",children:"Mt khu"}),t.jsx("input",{type:"password",id:"matKhau",value:l,onChange:p=>o(p.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition",placeholder:"Nhp mt khu",autoComplete:"current-password"})]}),t.jsx("button",{type:"submit",disabled:d,className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium rounded-lg transition flex items-center justify-center",children:d?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"ang ng nhp..."]}):"ng nhp"})]}),t.jsx("div",{className:"mt-6 text-center",children:t.jsxs("p",{className:"text-sm text-gray-500",children:["Ti khon mc nh: ",t.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:"admin"})," / ",t.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:"admin123"})]})})]})})}const ED="tinh_luong_auth",Ya=Zt.create({baseURL:"/api/kpi",headers:{"Content-Type":"application/json"}});Ya.interceptors.request.use(e=>{const n=localStorage.getItem(ED);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const Yo={layTatCa:e=>Ya.get("/template",{params:e}).then(n=>n.data),layTheoId:e=>Ya.get(`/template/${e}`).then(n=>n.data),taoMoi:e=>Ya.post("/template",e).then(n=>n.data),capNhat:(e,n)=>Ya.put(`/template/${e}`,n).then(a=>a.data),themChiTieu:(e,n)=>Ya.post(`/template/${e}/chi-tieu`,n).then(a=>a.data),xoaChiTieu:e=>Ya.delete(`/chi-tieu/${e}`).then(n=>n.data)},df={layTatCa:e=>Ya.get("/ky-danh-gia",{params:e}).then(n=>n.data),layTheoId:e=>Ya.get(`/ky-danh-gia/${e}`).then(n=>n.data),taoMoi:e=>Ya.post("/ky-danh-gia",e).then(n=>n.data),capNhatTrangThai:(e,n)=>Ya.put(`/ky-danh-gia/${e}/trang-thai`,{trangThai:n}).then(a=>a.data)},uf={layTheoNam:e=>Ya.get(`/cau-hinh-thuong/${e}`).then(n=>n.data),taoMoi:e=>Ya.post("/cau-hinh-thuong",e).then(n=>n.data),khoiTaoMacDinh:e=>Ya.post(`/cau-hinh-thuong/khoi-tao/${e}`).then(n=>n.data)};function DD(){var _,L;const[e,n]=E.useState([]),[a,r]=E.useState([]),[s,l]=E.useState(null),[o,d]=E.useState(!0),[u,x]=E.useState(!1),[m,f]=E.useState(!1),[p,b]=E.useState({maTemplate:"",tenTemplate:"",phongBanId:"",moTa:""}),[g,y]=E.useState({maChiTieu:"",tenChiTieu:"",donViTinh:"",trongSo:0,loaiChiTieu:"SO",chiTieuToiThieu:0,chiTieuMucTieu:0,chiTieuVuotMuc:0});E.useEffect(()=>{N()},[]);const N=async()=>{try{const[C,P]=await Promise.all([Yo.layTatCa(),cn.layTatCa()]);n(C),r(P)}catch(C){console.error("Li ti d liu:",C)}finally{d(!1)}},k=async C=>{C.preventDefault();try{await Yo.taoMoi({maTemplate:p.maTemplate,tenTemplate:p.tenTemplate,phongBanId:p.phongBanId?parseInt(p.phongBanId):void 0,moTa:p.moTa||void 0}),x(!1),b({maTemplate:"",tenTemplate:"",phongBanId:"",moTa:""}),N()}catch(P){console.error("Li to template:",P)}},T=async C=>{var P;if(C.preventDefault(),!!s)try{await Yo.themChiTieu(s.id,{...g,thuTu:(((P=s.chiTieuKPIs)==null?void 0:P.length)||0)+1}),f(!1),y({maChiTieu:"",tenChiTieu:"",donViTinh:"",trongSo:0,loaiChiTieu:"SO",chiTieuToiThieu:0,chiTieuMucTieu:0,chiTieuVuotMuc:0}),N();const F=await Yo.layTheoId(s.id);l(F)}catch(F){console.error("Li thm ch tiu:",F)}},S=async C=>{if(confirm("Xc nhn xa ch tiu ny?"))try{if(await Yo.xoaChiTieu(C),N(),s){const P=await Yo.layTheoId(s.id);l(P)}}catch(P){console.error("Li xa ch tiu:",P)}},w=C=>(C==null?void 0:C.reduce((P,F)=>P+Number(F.trongSo),0))||0;return o?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Template KPI"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Thit lp cc ch tiu nh gi KPI"})]}),t.jsxs("button",{onClick:()=>x(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm Template"]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow",children:[t.jsx("div",{className:"p-4 border-b",children:t.jsx("h2",{className:"font-semibold text-gray-800",children:"Danh sch Template"})}),t.jsx("div",{className:"divide-y max-h-[600px] overflow-y-auto",children:e.length===0?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Cha c template no"}):e.map(C=>{var P;return t.jsx("div",{onClick:()=>l(C),className:`p-4 cursor-pointer hover:bg-gray-50 ${(s==null?void 0:s.id)===C.id?"bg-blue-50 border-l-4 border-blue-500":""}`,children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-900",children:C.tenTemplate}),t.jsx("p",{className:"text-sm text-gray-500",children:C.maTemplate}),C.phongBan&&t.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded",children:C.phongBan.tenPhongBan})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("span",{className:"text-sm text-gray-600",children:[((P=C.chiTieuKPIs)==null?void 0:P.length)||0," ch tiu"]}),t.jsxs("div",{className:`text-xs mt-1 ${w(C.chiTieuKPIs)===100?"text-green-600":"text-amber-600"}`,children:["Tng: ",w(C.chiTieuKPIs),"%"]})]})]})},C.id)})})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow",children:[t.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[t.jsx("h2",{className:"font-semibold text-gray-800",children:s?s.tenTemplate:"Chi tit Template"}),s&&t.jsxs("button",{onClick:()=>f(!0),className:"text-blue-600 hover:text-blue-700 text-sm flex items-center gap-1",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm ch tiu"]})]}),s?t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[t.jsxs("p",{className:"text-sm",children:[t.jsx("span",{className:"font-medium",children:"M:"})," ",s.maTemplate]}),s.moTa&&t.jsxs("p",{className:"text-sm mt-1",children:[t.jsx("span",{className:"font-medium",children:"M t:"})," ",s.moTa]}),t.jsxs("p",{className:`text-sm mt-1 ${w(s.chiTieuKPIs)===100?"text-green-600":"text-amber-600"}`,children:[t.jsx("span",{className:"font-medium",children:"Tng trng s:"})," ",w(s.chiTieuKPIs),"%",w(s.chiTieuKPIs)!==100&&" (cn = 100%)"]})]}),t.jsx("div",{className:"space-y-3",children:((_=s.chiTieuKPIs)==null?void 0:_.length)===0?t.jsx("p",{className:"text-gray-500 text-center py-4",children:"Cha c ch tiu"}):(L=s.chiTieuKPIs)==null?void 0:L.map(C=>t.jsxs("div",{className:"border rounded-lg p-3",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900",children:C.tenChiTieu}),t.jsx("p",{className:"text-sm text-gray-500",children:C.maChiTieu})]}),t.jsx("button",{onClick:()=>S(C.id),className:"text-red-500 hover:text-red-700",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),t.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Trng s:"})," ",C.trongSo,"%"]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"n v:"})," ",C.donViTinh]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Loi:"})," ",C.loaiChiTieu]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Mc tiu:"})," ",Number(C.chiTieuMucTieu).toLocaleString()]})]})]},C.id))})]}):t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Chn mt template  xem chi tit"})]})]}),u&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm Template KPI"}),t.jsxs("form",{onSubmit:k,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M template *"}),t.jsx("input",{type:"text",value:p.maTemplate,onChange:C=>b({...p,maTemplate:C.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn template *"}),t.jsx("input",{type:"text",value:p.tenTemplate,onChange:C=>b({...p,tenTemplate:C.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:p.phongBanId,onChange:C=>b({...p,phongBanId:C.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- p dng chung --"}),a.map(C=>t.jsx("option",{value:C.id,children:C.tenPhongBan},C.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:p.moTa,onChange:C=>b({...p,moTa:C.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To"})]})]})]})}),m&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm Ch tiu KPI"}),t.jsxs("form",{onSubmit:T,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M ch tiu *"}),t.jsx("input",{type:"text",value:g.maChiTieu,onChange:C=>y({...g,maChiTieu:C.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn ch tiu *"}),t.jsx("input",{type:"text",value:g.tenChiTieu,onChange:C=>y({...g,tenChiTieu:C.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n v *"}),t.jsx("input",{type:"text",value:g.donViTinh,onChange:C=>y({...g,donViTinh:C.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VN, %, S...",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng s (%) *"}),t.jsx("input",{type:"number",value:g.trongSo,onChange:C=>y({...g,trongSo:Number(C.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:0,max:100,required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi *"}),t.jsxs("select",{value:g.loaiChiTieu,onChange:C=>y({...g,loaiChiTieu:C.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[t.jsx("option",{value:"SO",children:"S lng"}),t.jsx("option",{value:"PHAN_TRAM",children:"Phn trm"}),t.jsx("option",{value:"TIEN",children:"Tin"}),t.jsx("option",{value:"DANH_GIA",children:"nh gi (1-5)"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ti thiu"}),t.jsx("input",{type:"number",value:g.chiTieuToiThieu,onChange:C=>y({...g,chiTieuToiThieu:Number(C.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mc tiu"}),t.jsx("input",{type:"number",value:g.chiTieuMucTieu,onChange:C=>y({...g,chiTieuMucTieu:Number(C.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vt mc"}),t.jsx("input",{type:"number",value:g.chiTieuVuotMuc,onChange:C=>y({...g,chiTieuVuotMuc:Number(C.target.value)}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Thm"})]})]})]})})]})}const AD={THANG:"Thng",QUY:"Qu",NAM:"Nm"},Bb={CHUA_BAT_DAU:{label:"Cha bt u",color:"bg-gray-100 text-gray-600"},DANG_DIEN_RA:{label:"ang din ra",color:"bg-green-100 text-green-700"},DA_KET_THUC:{label:" kt thc",color:"bg-blue-100 text-blue-700"},DA_DONG:{label:" ng",color:"bg-red-100 text-red-700"}};function FD(){const[e,n]=E.useState([]),[a,r]=E.useState(!0),[s,l]=E.useState(!1),[o,d]=E.useState(new Date().getFullYear()),[u,x]=E.useState({maKy:"",tenKy:"",loaiKy:"THANG",tuNgay:"",denNgay:"",moTa:""});E.useEffect(()=>{m()},[o]);const m=async()=>{r(!0);try{const g=await df.layTatCa({nam:o});n(g)}catch(g){console.error("Li ti d liu:",g)}finally{r(!1)}},f=async g=>{g.preventDefault();try{await df.taoMoi({...u,moTa:u.moTa||void 0}),l(!1),x({maKy:"",tenKy:"",loaiKy:"THANG",tuNgay:"",denNgay:"",moTa:""}),m()}catch(y){console.error("Li to k nh gi:",y)}},p=async(g,y)=>{try{await df.capNhatTrangThai(g,y),m()}catch(N){console.error("Li cp nht trng thi:",N)}},b=g=>new Date(g).toLocaleDateString("vi-VN");return a?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"K nh Gi KPI"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Qun l cc k nh gi hiu sut"})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx("select",{value:o,onChange:g=>d(Number(g.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(g=>t.jsxs("option",{value:g,children:["Nm ",g]},g))}),t.jsxs("button",{onClick:()=>l(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm K nh Gi"]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M k"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tn k"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Loi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"S nh gi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.length===0?t.jsx("tr",{children:t.jsxs("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:["Cha c k nh gi no trong nm ",o]})}):e.map(g=>{var y;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"font-mono text-sm text-gray-900",children:g.maKy})}),t.jsxs("td",{className:"px-6 py-4",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:g.tenKy}),g.moTa&&t.jsx("div",{className:"text-xs text-gray-500",children:g.moTa})]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded",children:AD[g.loaiKy]})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:[b(g.tuNgay)," - ",b(g.denNgay)]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 py-1 text-xs rounded ${Bb[g.trangThai].color}`,children:Bb[g.trangThai].label})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:((y=g._count)==null?void 0:y.danhGias)||0}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:t.jsxs("div",{className:"flex gap-2",children:[g.trangThai==="CHUA_BAT_DAU"&&t.jsx("button",{onClick:()=>p(g.id,"DANG_DIEN_RA"),className:"text-green-600 hover:text-green-800",children:"Bt u"}),g.trangThai==="DANG_DIEN_RA"&&t.jsx("button",{onClick:()=>p(g.id,"DA_KET_THUC"),className:"text-blue-600 hover:text-blue-800",children:"Kt thc"}),g.trangThai==="DA_KET_THUC"&&t.jsx("button",{onClick:()=>p(g.id,"DA_DONG"),className:"text-red-600 hover:text-red-800",children:"ng"}),t.jsx("a",{href:`/kpi/ky-danh-gia/${g.id}`,className:"text-indigo-600 hover:text-indigo-800",children:"Chi tit"})]})})]},g.id)})})]})}),s&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm K nh Gi"}),t.jsxs("form",{onSubmit:f,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M k *"}),t.jsx("input",{type:"text",value:u.maKy,onChange:g=>x({...u,maKy:g.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: KPI-2026-Q1",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi k *"}),t.jsxs("select",{value:u.loaiKy,onChange:g=>x({...u,loaiKy:g.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[t.jsx("option",{value:"THANG",children:"Thng"}),t.jsx("option",{value:"QUY",children:"Qu"}),t.jsx("option",{value:"NAM",children:"Nm"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn k *"}),t.jsx("input",{type:"text",value:u.tenKy,onChange:g=>x({...u,tenKy:g.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: nh gi KPI Qu 1/2026",required:!0})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T ngy *"}),t.jsx(Ut,{value:u.tuNgay,onChange:g=>x({...u,tuNgay:g}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n ngy *"}),t.jsx(Ut,{value:u.denNgay,onChange:g=>x({...u,denNgay:g}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:u.moTa,onChange:g=>x({...u,moTa:g.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To"})]})]})]})})]})}const hf={XUAT_SAC:{label:"Xut sc",color:"bg-purple-100 text-purple-700"},TOT:{label:"Tt",color:"bg-green-100 text-green-700"},KHA:{label:"Kh",color:"bg-blue-100 text-blue-700"},TRUNG_BINH:{label:"Trung bnh",color:"bg-yellow-100 text-yellow-700"},YEU:{label:"Yu",color:"bg-red-100 text-red-700"}};function LD(){const[e,n]=E.useState([]),[a,r]=E.useState(!0),[s,l]=E.useState(new Date().getFullYear()),[o,d]=E.useState(!1),[u,x]=E.useState({xepLoai:"TOT",diemToiThieu:0,diemToiDa:100,heSoThuong:1,moTa:""});E.useEffect(()=>{m()},[s]);const m=async()=>{r(!0);try{const b=await uf.layTheoNam(s);n(b)}catch(b){console.error("Li ti d liu:",b)}finally{r(!1)}},f=async()=>{if(confirm(`Khi to cu hnh thng mc nh cho nm ${s}?`))try{await uf.khoiTaoMacDinh(s),m()}catch(b){console.error("Li khi to:",b)}},p=async b=>{b.preventDefault();try{await uf.taoMoi({nam:s,...u,moTa:u.moTa||void 0}),d(!1),m()}catch(g){console.error("Li to cu hnh:",g)}};return a?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Cu hnh Thng KPI"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Thit lp h s thng theo mc xp loi"})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx("select",{value:s,onChange:b=>l(Number(b.target.value)),className:"border rounded-lg px-3 py-2",children:[2024,2025,2026,2027].map(b=>t.jsxs("option",{value:b,children:["Nm ",b]},b))}),t.jsx("button",{onClick:f,className:"border border-blue-600 text-blue-600 hover:bg-blue-50 px-4 py-2 rounded-lg",children:"Khi to mc nh"}),t.jsxs("button",{onClick:()=>d(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thm Cu hnh"]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Xp loi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"im ti thiu"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"im ti a"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"H s thng"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M t"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Trng thi"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.length===0?t.jsx("tr",{children:t.jsxs("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:[t.jsxs("p",{children:["Cha c cu hnh thng cho nm ",s]}),t.jsx("button",{onClick:f,className:"mt-4 text-blue-600 hover:text-blue-700 underline",children:"Khi to cu hnh mc nh"})]})}):e.map(b=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-3 py-1 text-sm rounded-full font-medium ${hf[b.xepLoai].color}`,children:hf[b.xepLoai].label})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("span",{className:"text-gray-900 font-mono",children:[Number(b.diemToiThieu).toFixed(1),"%"]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("span",{className:"text-gray-900 font-mono",children:[Number(b.diemToiDa).toFixed(2),"%"]})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[t.jsxs("span",{className:"text-lg font-semibold text-indigo-600",children:[Number(b.heSoThuong),"x"]}),t.jsx("span",{className:"text-gray-500 text-sm ml-1",children:"lng c bn"})]}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("span",{className:"text-gray-600 text-sm",children:b.moTa||"-"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 py-1 text-xs rounded ${b.trangThai?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:b.trangThai?"Hot ng":"Ngng"})})]},b.id))})]})}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[t.jsx("h3",{className:"font-semibold text-blue-800 mb-3",children:" Cng thc tnh thng KPI"}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-blue-700",children:[t.jsxs("div",{children:[t.jsx("p",{children:t.jsx("strong",{children:"Tin thng = Lng c bn  H s thng"})}),t.jsx("p",{className:"mt-2",children:'V d: Nhn vin lng 15,000,000, xp loi "Tt" (h s 1.5x)'}),t.jsxs("p",{children:[" Thng = 15,000,000  1.5 = ",t.jsx("strong",{children:"22,500,000"})]})]}),t.jsxs("div",{children:[t.jsx("p",{children:t.jsx("strong",{children:"im KPI c tnh t:"})}),t.jsxs("ul",{className:"list-disc ml-4 mt-2",children:[t.jsx("li",{children:"Tng im =  (im ch tiu  Trng s)"}),t.jsx("li",{children:"im ch tiu = (Kt qu / Mc tiu)  100"}),t.jsx("li",{children:"Ti a 150% nu vt mc"})]})]})]})]}),o&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm Cu hnh Thng"}),t.jsxs("form",{onSubmit:p,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Xp loi *"}),t.jsx("select",{value:u.xepLoai,onChange:b=>x({...u,xepLoai:b.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:Object.entries(hf).map(([b,{label:g}])=>t.jsx("option",{value:b,children:g},b))})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"im ti thiu *"}),t.jsx("input",{type:"number",step:"0.01",value:u.diemToiThieu,onChange:b=>x({...u,diemToiThieu:Number(b.target.value)}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"im ti a *"}),t.jsx("input",{type:"number",step:"0.01",value:u.diemToiDa,onChange:b=>x({...u,diemToiDa:Number(b.target.value)}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"H s thng *"}),t.jsx("input",{type:"number",step:"0.1",value:u.heSoThuong,onChange:b=>x({...u,heSoThuong:Number(b.target.value)}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("input",{type:"text",value:u.moTa,onChange:b=>x({...u,moTa:b.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To"})]})]})]})})]})}const Hb={HOAT_DONG:{label:"Hot ng",color:"bg-green-100 text-green-700"},TAM_KHOA:{label:"Tm kha",color:"bg-yellow-100 text-yellow-700"},NGUNG_HOAT_DONG:{label:"Ngng",color:"bg-red-100 text-red-700"}};function PD(){const[e,n]=E.useState([]),[a,r]=E.useState([]),[s,l]=E.useState(!0),[o,d]=E.useState(!1),[u,x]=E.useState("nguoi-dung"),[m,f]=E.useState({tenDangNhap:"",matKhau:"",hoTen:"",email:"",soDienThoai:"",vaiTroIds:[]}),[p,b]=E.useState({maVaiTro:"",tenVaiTro:"",moTa:"",capDo:50});E.useEffect(()=>{g()},[]);const g=async()=>{try{const[w,_]=await Promise.all([rf.layTatCa(),Tb.layTatCa()]);n(w),r(_)}catch(w){console.error("Li ti d liu:",w)}finally{l(!1)}},y=async w=>{w.preventDefault();try{await rf.taoMoi({tenDangNhap:m.tenDangNhap,matKhau:m.matKhau,hoTen:m.hoTen,email:m.email,soDienThoai:m.soDienThoai||void 0,vaiTroIds:m.vaiTroIds}),d(!1),f({tenDangNhap:"",matKhau:"",hoTen:"",email:"",soDienThoai:"",vaiTroIds:[]}),g()}catch(_){console.error("Li to ngi dng:",_)}},N=async w=>{w.preventDefault();try{await Tb.taoMoi({maVaiTro:p.maVaiTro,tenVaiTro:p.tenVaiTro,moTa:p.moTa||void 0,capDo:p.capDo}),d(!1),b({maVaiTro:"",tenVaiTro:"",moTa:"",capDo:50}),g()}catch(_){console.error("Li to vai tr:",_)}},k=async(w,_)=>{try{await rf.capNhat(w,{trangThai:_}),g()}catch(L){console.error("Li cp nht:",L)}},T=w=>{f(_=>({..._,vaiTroIds:_.vaiTroIds.includes(w)?_.vaiTroIds.filter(L=>L!==w):[..._.vaiTroIds,w]}))},S=w=>w?new Date(w).toLocaleString("vi-VN"):"-";return s?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Ngi dng & Vai tr"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Phn quyn truy cp h thng"})]}),t.jsxs("button",{onClick:()=>d(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),u==="nguoi-dung"?"Thm Ngi dng":"Thm Vai tr"]})]}),t.jsx("div",{className:"border-b border-gray-200",children:t.jsxs("nav",{className:"-mb-px flex gap-6",children:[t.jsxs("button",{onClick:()=>x("nguoi-dung"),className:`py-3 px-1 border-b-2 font-medium text-sm ${u==="nguoi-dung"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Ngi dng (",e.length,")"]}),t.jsxs("button",{onClick:()=>x("vai-tro"),className:`py-3 px-1 border-b-2 font-medium text-sm ${u==="vai-tro"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Vai tr (",a.length,")"]})]})}),u==="nguoi-dung"?t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngi dng"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Vai tr"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ng nhp cui"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(w=>{var _,L,C;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:t.jsx("span",{className:"text-blue-600 font-medium",children:w.hoTen.charAt(0).toUpperCase()})}),t.jsxs("div",{className:"ml-3",children:[t.jsx("div",{className:"font-medium text-gray-900",children:w.hoTen}),t.jsxs("div",{className:"text-sm text-gray-500",children:["@",w.tenDangNhap]})]})]})}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:w.email}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("div",{className:"flex flex-wrap gap-1",children:((_=w.vaiTros)==null?void 0:_.map(P=>t.jsx("span",{className:"px-2 py-0.5 bg-indigo-100 text-indigo-700 text-xs rounded",children:P.vaiTro.tenVaiTro},P.id)))||t.jsx("span",{className:"text-gray-400 text-sm",children:"Cha gn"})})}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:S(w.lanDangNhapCuoi)}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("span",{className:`px-2 py-1 text-xs rounded ${((L=Hb[w.trangThai])==null?void 0:L.color)||"bg-gray-100"}`,children:((C=Hb[w.trangThai])==null?void 0:C.label)||w.trangThai})}),t.jsx("td",{className:"px-6 py-4 text-sm",children:t.jsxs("div",{className:"flex gap-2",children:[w.trangThai==="HOAT_DONG"&&t.jsx("button",{onClick:()=>k(w.id,"TAM_KHOA"),className:"text-yellow-600 hover:text-yellow-800",children:"Kha"}),w.trangThai==="TAM_KHOA"&&t.jsx("button",{onClick:()=>k(w.id,"HOAT_DONG"),className:"text-green-600 hover:text-green-800",children:"M kha"})]})})]},w.id)})})]})}):t.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map(w=>{var _,L,C,P,F;return t.jsxs("div",{className:"bg-white rounded-lg shadow p-5",children:[t.jsxs("div",{className:"flex justify-between items-start mb-3",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:w.tenVaiTro}),t.jsx("p",{className:"text-sm text-gray-500 font-mono",children:w.maVaiTro})]}),t.jsx("span",{className:`px-2 py-1 text-xs rounded ${w.trangThai?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:w.trangThai?"Hot ng":"Ngng"})]}),w.moTa&&t.jsx("p",{className:"text-sm text-gray-600 mb-3",children:w.moTa}),t.jsxs("div",{className:"flex justify-between items-center text-sm",children:[t.jsxs("span",{className:"text-gray-500",children:["Cp : ",w.capDo]}),t.jsxs("span",{className:"text-indigo-600",children:[((_=w._count)==null?void 0:_.nguoiDungs)||0," ngi dng"]})]}),t.jsxs("div",{className:"mt-3 pt-3 border-t",children:[t.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:["Quyn (",((L=w.quyens)==null?void 0:L.length)||0,"):"]}),t.jsxs("div",{className:"flex flex-wrap gap-1 max-h-20 overflow-y-auto",children:[(C=w.quyens)==null?void 0:C.slice(0,8).map(H=>t.jsx("span",{className:"px-1.5 py-0.5 bg-gray-100 text-gray-600 text-xs rounded",children:H.quyen.tenQuyen},H.id)),(((P=w.quyens)==null?void 0:P.length)||0)>8&&t.jsxs("span",{className:"px-1.5 py-0.5 bg-gray-200 text-gray-700 text-xs rounded",children:["+",(((F=w.quyens)==null?void 0:F.length)||0)-8," quyn"]})]})]})]},w.id)})}),o&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:u==="nguoi-dung"?"Thm Ngi dng":"Thm Vai tr"}),u==="nguoi-dung"?t.jsxs("form",{onSubmit:y,className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn ng nhp *"}),t.jsx("input",{type:"text",value:m.tenDangNhap,onChange:w=>f({...m,tenDangNhap:w.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mt khu *"}),t.jsx("input",{type:"password",value:m.matKhau,onChange:w=>f({...m,matKhau:w.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"H tn *"}),t.jsx("input",{type:"text",value:m.hoTen,onChange:w=>f({...m,hoTen:w.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),t.jsx("input",{type:"email",value:m.email,onChange:w=>f({...m,email:w.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vai tr"}),t.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:a.map(w=>t.jsxs("label",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"checkbox",checked:m.vaiTroIds.includes(w.id),onChange:()=>T(w.id),className:"rounded"}),t.jsx("span",{className:"text-sm",children:w.tenVaiTro})]},w.id))})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border rounded-lg",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:"To"})]})]}):t.jsxs("form",{onSubmit:N,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M vai tr *"}),t.jsx("input",{type:"text",value:p.maVaiTro,onChange:w=>b({...p,maVaiTro:w.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: SUPERVISOR",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn vai tr *"}),t.jsx("input",{type:"text",value:p.tenVaiTro,onChange:w=>b({...p,tenVaiTro:w.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cp "}),t.jsx("input",{type:"number",value:p.capDo,onChange:w=>b({...p,capDo:Number(w.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:1,max:100})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:p.moTa,onChange:w=>b({...p,moTa:w.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border rounded-lg",children:"Hy"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:"To"})]})]})]})})]})}const xf={TAO:{label:"To mi",color:"bg-green-100 text-green-700",icon:""},SUA:{label:"Cp nht",color:"bg-blue-100 text-blue-700",icon:""},XOA:{label:"Xa",color:"bg-red-100 text-red-700",icon:""},XEM:{label:"Xem",color:"bg-gray-100 text-gray-700",icon:""},DANG_NHAP:{label:"ng nhp",color:"bg-indigo-100 text-indigo-700",icon:""},DANG_XUAT:{label:"ng xut",color:"bg-purple-100 text-purple-700",icon:""},CHOT:{label:"Cht",color:"bg-yellow-100 text-yellow-700",icon:""},MO_KHOA:{label:"M kha",color:"bg-cyan-100 text-cyan-700",icon:""},DUYET:{label:"Duyt",color:"bg-emerald-100 text-emerald-700",icon:""},TU_CHOI:{label:"T chi",color:"bg-orange-100 text-orange-700",icon:""}};function ID(){var k,T;const[e,n]=E.useState([]),[a,r]=E.useState(!0),[s,l]=E.useState(null),[o,d]=E.useState(""),[u,x]=E.useState(""),[m,f]=E.useState(""),[p,b]=E.useState("");E.useEffect(()=>{g()},[o,u,m,p]);const g=async()=>{r(!0);try{const S=await T5.layDanhSach({hanhDong:o||void 0,bangDuLieu:u||void 0,tuNgay:m||void 0,denNgay:p||void 0}),w=Array.isArray(S)?S:(S==null?void 0:S.items)||[];n(w)}catch(S){console.error("Li ti d liu:",S)}finally{r(!1)}},y=S=>new Date(S).toLocaleString("vi-VN"),N=S=>S?JSON.stringify(S,null,2):null;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Audit Log"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Lch s thao tc trn h thng"})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hnh ng"}),t.jsxs("select",{value:o,onChange:S=>d(S.target.value),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),Object.entries(xf).map(([S,{label:w}])=>t.jsx("option",{value:S,children:w},S))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bng d liu"}),t.jsxs("select",{value:u,onChange:S=>x(S.target.value),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"NhanVien",children:"Nhn vin"}),t.jsx("option",{value:"BangLuong",children:"Bng lng"}),t.jsx("option",{value:"KhoanLuong",children:"Khon lng"}),t.jsx("option",{value:"PhongBan",children:"Phng ban"}),t.jsx("option",{value:"NguoiDung",children:"Ngi dng"}),t.jsx("option",{value:"DanhGiaKPI",children:"nh gi KPI"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T ngy"}),t.jsx(Ut,{value:m,onChange:f,className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n ngy"}),t.jsx(Ut,{value:p,onChange:b,className:"w-full border rounded-lg px-3 py-2"})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:a?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):e.length===0?t.jsx("div",{className:"p-12 text-center text-gray-500",children:"Khng c d liu audit log"}):t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngi dng"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Hnh ng"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Bng d liu"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ID bn ghi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Chi tit"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(S=>{const w=xf[S.hanhDong]||{label:S.hanhDong,color:"bg-gray-100",icon:""};return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:y(S.ngayTao)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:S.nguoiDung?t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:t.jsx("span",{className:"text-blue-600 text-xs font-medium",children:S.nguoiDung.hoTen.charAt(0)})}),t.jsx("span",{className:"ml-2 text-sm text-gray-900",children:S.nguoiDung.hoTen})]}):t.jsx("span",{className:"text-gray-400 text-sm",children:"H thng"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("span",{className:`px-2 py-1 text-xs rounded ${w.color}`,children:[w.icon," ",w.label]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:S.bangDuLieu||"-"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 font-mono",children:S.banGhiId||"-"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(S.duLieuCu||S.duLieuMoi)&&t.jsx("button",{onClick:()=>l(S),className:"text-blue-600 hover:text-blue-800 text-sm",children:"Xem chi tit"})})]},S.id)})})]})}),s&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-3xl max-h-[80vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex justify-between items-start mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Chi tit thay i"}),t.jsx("button",{onClick:()=>l(null),className:"text-gray-400 hover:text-gray-600",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Thi gian:"})," ",y(s.ngayTao)]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Ngi dng:"})," ",((k=s.nguoiDung)==null?void 0:k.hoTen)||"H thng"]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Hnh ng:"})," ",(T=xf[s.hanhDong])==null?void 0:T.label]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Bng:"})," ",s.bangDuLieu," #",s.banGhiId]}),s.ipAddress&&t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"IP:"})," ",s.ipAddress]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.duLieuCu&&t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-red-600 mb-2",children:"D liu c"}),t.jsx("pre",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-xs overflow-x-auto",children:N(s.duLieuCu)})]}),s.duLieuMoi&&t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-green-600 mb-2",children:"D liu mi"}),t.jsx("pre",{className:"bg-green-50 border border-green-200 rounded-lg p-3 text-xs overflow-x-auto",children:N(s.duLieuMoi)})]})]})]})})]})}const OD="tinh_luong_auth",kt=Zt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});kt.interceptors.request.use(e=>{const n=localStorage.getItem(OD);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const $s={layDanhSach:e=>kt.get("/quy-che-luong",{params:e}).then(n=>n.data),layChiTiet:e=>kt.get(`/quy-che-luong/${e}`).then(n=>n.data),tao:e=>kt.post("/quy-che-luong",e).then(n=>n.data),capNhat:(e,n)=>kt.put(`/quy-che-luong/${e}`,n).then(a=>a.data),nhanBan:(e,n)=>kt.post(`/quy-che-luong/${e}/nhan-ban`,n).then(a=>a.data),kichHoat:e=>kt.post(`/quy-che-luong/${e}/kich-hoat`).then(n=>n.data),ngung:e=>kt.post(`/quy-che-luong/${e}/ngung`).then(n=>n.data),xoa:e=>kt.delete(`/quy-che-luong/${e}`).then(n=>n.data),layRules:e=>kt.get(`/quy-che-luong/${e}/rules`).then(n=>n.data),taoRule:(e,n)=>kt.post(`/quy-che-luong/${e}/rule`,n).then(a=>a.data),sapXepRules:(e,n)=>kt.put(`/quy-che-luong/${e}/sap-xep-rule`,{danhSachRuleId:n}).then(a=>a.data)},Id={layChiTiet:e=>kt.get(`/quy-che-rule/${e}`).then(n=>n.data),capNhat:(e,n)=>kt.put(`/quy-che-rule/${e}`,n).then(a=>a.data),xoa:e=>kt.delete(`/quy-che-rule/${e}`).then(n=>n.data),validate:e=>kt.post("/quy-che-rule/validate",e).then(n=>n.data),preview:e=>kt.post("/quy-che-rule/preview",e).then(n=>n.data)},Dl={layDanhSach:e=>kt.get("/su-kien-thuong-phat",{params:e}).then(n=>n.data),layChiTiet:e=>kt.get(`/su-kien-thuong-phat/${e}`).then(n=>n.data),tao:e=>kt.post("/su-kien-thuong-phat",e).then(n=>n.data),capNhat:(e,n)=>kt.put(`/su-kien-thuong-phat/${e}`,n).then(a=>a.data),duyet:(e,n)=>kt.post(`/su-kien-thuong-phat/${e}/duyet`,{duyetBoi:n.duyetBoi||"admin",ghiChu:n.lyDo}).then(a=>a.data),duyetNhieu:e=>kt.post("/su-kien-thuong-phat/duyet-nhieu",{ids:e.danhSachId,duyetBoi:e.duyetBoi||"admin"}).then(n=>n.data),huy:e=>kt.post(`/su-kien-thuong-phat/${e}/huy`).then(n=>n.data),thongKe:(e,n,a)=>kt.get(`/su-kien-thuong-phat/thong-ke/${e}`,{params:{thang:n,nam:a}}).then(r=>r.data),layDanhMucSuKien:e=>kt.get("/su-kien-thuong-phat/danh-muc",{params:{loai:e}}).then(n=>n.data),taoDanhMucSuKien:e=>kt.post("/su-kien-thuong-phat/danh-muc",e).then(n=>n.data),khoiTaoDanhMucMau:()=>kt.post("/su-kien-thuong-phat/khoi-tao-danh-muc-mau").then(e=>e.data)},MD={chay:(e,n)=>kt.post(`/bang-luong/${e}/chay-rule-engine`,{nguoiThucHien:n}).then(a=>a.data),xemTrace:(e,n)=>kt.get(`/bang-luong/${e}/rule-trace`,{params:n?{nhanVienId:n}:void 0}).then(a=>a.data)},Od={goiYRule:(e,n,a)=>kt.post("/tro-ly-ai/goi-y-rule",{phongBanId:e,quyCheId:n,noiDungTiengViet:a}).then(r=>r.data),layContext:(e,n)=>kt.get(`/tro-ly-ai/context/${e}/${n}`).then(a=>a.data),apDungRule:(e,n,a)=>kt.post(`/tro-ly-ai/ap-dung/${e}`,{auditId:n,ruleDeXuat:a}).then(r=>r.data),huyDeXuat:e=>kt.post(`/tro-ly-ai/huy/${e}`).then(n=>n.data),lichSuDeXuat:e=>kt.get(`/tro-ly-ai/lich-su/${e}`).then(n=>n.data)},RD=({trangThai:e})=>{const a={NHAP:{bg:"bg-gray-100",text:"text-gray-800",label:"Nhp"},HIEU_LUC:{bg:"bg-green-100",text:"text-green-800",label:"Hiu lc"},TAM_DUNG:{bg:"bg-yellow-100",text:"text-yellow-800",label:"Tm dng"},NGUNG:{bg:"bg-red-100",text:"text-red-800",label:"Ngng"}}[e];return t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${a.bg} ${a.text}`,children:a.label})};function BD(){const e=mr(),[n,a]=E.useState([]),[r,s]=E.useState([]),[l,o]=E.useState(!1),[d,u]=E.useState(""),[x,m]=E.useState(!1),[f,p]=E.useState({phongBanId:0,tenQuyChe:"",moTa:"",tuNgay:new Date().toISOString().split("T")[0]});E.useEffect(()=>{b(),g()},[d]);const b=async()=>{try{const _=await cn.layTatCa();s(_)}catch(_){console.error("Li load phng ban:",_)}},g=async()=>{o(!0);try{const _=d?{phongBanId:d}:{},L=await $s.layDanhSach(_);a(L)}catch(_){console.error("Li load quy ch:",_)}finally{o(!1)}},y=async()=>{if(!f.phongBanId||!f.tenQuyChe||!f.tuNgay){alert("Vui lng nhp y  thng tin");return}try{await $s.tao({phongBanId:f.phongBanId,tenQuyChe:f.tenQuyChe,moTa:f.moTa,tuNgay:new Date(f.tuNgay)}),m(!1),p({phongBanId:0,tenQuyChe:"",moTa:"",tuNgay:new Date().toISOString().split("T")[0]}),g()}catch(_){console.error("Li to quy ch:",_),alert("Li to quy ch")}},N=async _=>{if(confirm("Kch hot quy ch ny? Cc quy ch khc cng phng ban s b ngng."))try{await $s.kichHoat(_),g()}catch(L){console.error("Li kch hot:",L),alert("Li kch hot quy ch")}},k=async _=>{if(confirm("Ngng quy ch ny?"))try{await $s.ngung(_),g()}catch(L){console.error("Li ngng:",L),alert("Li ngng quy ch")}},T=async(_,L)=>{const C=prompt("Tn quy ch mi:",`${L} (v2)`);if(C)try{const P=await $s.nhanBan(_,{tenQuyChe:C,tuNgay:new Date});e(`/quy-che/${P.id}`)}catch(P){console.error("Li nhn bn:",P),alert("Li nhn bn quy ch")}},S=async _=>{if(confirm("Xa quy ch ny? Ch c th xa quy ch ang  trng thi Nhp."))try{await $s.xoa(_),g()}catch(L){console.error("Li xa:",L),alert("Khng th xa quy ch ny")}},w=n.reduce((_,L)=>{var P;const C=((P=L.phongBan)==null?void 0:P.tenPhongBan)||"Khc";return _[C]||(_[C]=[]),_[C].push(L),_},{});return t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l Quy ch lng"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Cu hnh quy ch lng theo phng ban vi cc rule t ng"})]}),t.jsxs("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"To quy ch mi"]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:t.jsx("div",{className:"flex items-center gap-4",children:t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:d,onChange:_=>u(_.target.value?Number(_.target.value):""),className:"border rounded-lg px-3 py-2 min-w-[200px]",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),r.map(_=>t.jsx("option",{value:_.id,children:_.tenPhongBan},_.id))]})]})})}),l&&t.jsx("div",{className:"text-center py-10",children:t.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}),!l&&t.jsxs("div",{className:"space-y-6",children:[Object.entries(w).map(([_,L])=>t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b",children:t.jsx("h2",{className:"font-semibold text-gray-900",children:_})}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tn quy ch"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Phin bn"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"S rule"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"T ngy"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:L.map(C=>{var P;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsxs("td",{className:"px-4 py-3",children:[t.jsx("button",{onClick:()=>e(`/quy-che/${C.id}`),className:"text-blue-600 hover:text-blue-800 font-medium",children:C.tenQuyChe}),C.moTa&&t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:C.moTa})]}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-sm",children:["v",C.phienBan]})}),t.jsx("td",{className:"px-4 py-3 text-center",children:((P=C._count)==null?void 0:P.rules)||0}),t.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-600",children:new Date(C.tuNgay).toLocaleDateString("vi-VN")}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx(RD,{trangThai:C.trangThai})}),t.jsx("td",{className:"px-4 py-3 text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx("button",{onClick:()=>e(`/quy-che/${C.id}`),className:"p-1 text-gray-400 hover:text-blue-600",title:"Cu hnh",children:t.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),C.trangThai==="NHAP"&&t.jsx("button",{onClick:()=>N(C.id),className:"p-1 text-gray-400 hover:text-green-600",title:"Kch hot",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),C.trangThai==="HIEU_LUC"&&t.jsx("button",{onClick:()=>k(C.id),className:"p-1 text-gray-400 hover:text-yellow-600",title:"Ngng",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsx("button",{onClick:()=>T(C.id,C.tenQuyChe),className:"p-1 text-gray-400 hover:text-purple-600",title:"Nhn bn",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),C.trangThai==="NHAP"&&t.jsx("button",{onClick:()=>S(C.id),className:"p-1 text-gray-400 hover:text-red-600",title:"Xa",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},C.id)})})]})]},_)),Object.keys(w).length===0&&t.jsx("div",{className:"bg-white rounded-lg shadow p-10 text-center text-gray-500",children:'Cha c quy ch no. Bm "To quy ch mi"  bt u.'})]}),x&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[t.jsx("div",{className:"px-6 py-4 border-b",children:t.jsx("h3",{className:"text-lg font-semibold",children:"To quy ch mi"})}),t.jsxs("div",{className:"px-6 py-4 space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Phng ban ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("select",{value:f.phongBanId,onChange:_=>p({...f,phongBanId:Number(_.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn phng ban --"}),r.map(_=>t.jsx("option",{value:_.id,children:_.tenPhongBan},_.id))]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn quy ch ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:f.tenQuyChe,onChange:_=>p({...f,tenQuyChe:_.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Quy ch lng phng Kho 2026"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:f.moTa,onChange:_=>p({...f,moTa:_.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:3,placeholder:"M t quy ch..."})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["p dng t ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ut,{value:f.tuNgay,onChange:_=>p({...f,tuNgay:_}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"px-6 py-4 border-t flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:y,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"To quy ch"})]})]})})]})}const HD=["Pht i tr: 1-2 ln 50k/ln, t ln 3 tr ln 100k/ln","Trch nhim kho: cp 1 500k, cp 2 1tr, cp 3 1.5tr","Tin trch nhim = lng c bn * 0.15","Thng chuyn cn: 200k/thng nu khng ngh","Ph cp trch nhim c nh 500k/thng"],mf={CO_DINH:"C nh",THEO_HE_SO:"Theo h s",BAC_THANG:"Bc thang",THEO_SU_KIEN:"Theo s kin",CONG_THUC:"Cng thc"},Vb={CONG_DON:"Cng dn",GHI_DE:"Ghi "};function VD({isOpen:e,onClose:n,phongBanId:a,quyCheId:r,onRuleApplied:s}){const l=E.useRef(null),o=E.useRef(null),[d,u]=E.useState(""),[x,m]=E.useState(!1),[f,p]=E.useState(null),[b,g]=E.useState(null),[y,N]=E.useState(!1),[k,T]=E.useState(!1),[S,w]=E.useState(null),[_,L]=E.useState(!1),[C,P]=E.useState(null),[F,H]=E.useState(!1),[O,B]=E.useState(null),[W,ee]=E.useState("goi-y"),[q,fe]=E.useState(!1),[ne,Y]=E.useState(!1),[X,xe]=E.useState(!1),[K,A]=E.useState({luongCoBan:1e7,capTrachNhiem:2,heSoTrachNhiem:1.2,soLanDiTre:3,soLanNghiKhongPhep:0});E.useEffect(()=>{e&&a&&r&&(Od.layContext(a,r).then(g).catch(console.error),setTimeout(()=>{var pe;return(pe=l.current)==null?void 0:pe.focus()},100))},[e,a,r]),E.useEffect(()=>{e||(u(""),p(null),w(null),P(null),B(null),H(!1),fe(!1),Y(!1),xe(!1))},[e]);const M=E.useCallback(pe=>{e&&(pe.key==="Escape"&&n(),(pe.ctrlKey||pe.metaKey)&&pe.key==="Enter"&&d.trim()&&!x&&pe.preventDefault())},[e,d,x,n]);E.useEffect(()=>(document.addEventListener("keydown",M),()=>document.removeEventListener("keydown",M)),[M]);const I=async()=>{if(d.trim()){m(!0),p(null),w(null),P(null);try{const pe=await Od.goiYRule(a,r,d);p(pe),pe.ruleDeXuat&&B({...pe.ruleDeXuat})}catch(pe){console.error("Li gi  rule:",pe),p({hopLeSoBo:!1,canLamRo:["C li xy ra khi x l yu cu. Vui lng th li."]})}finally{m(!1)}}},V=async()=>{if(!O)return;const pe=le();if(pe.length>0){w({hopLe:!1,loi:["[Client] "+pe.join(", [Client] ")]});return}T(!0);try{const Oe=await Id.validate({loaiRule:O.loaiRule,dieuKienJson:O.dieuKienJson,congThucJson:O.congThucJson});w({hopLe:Oe.hopLe,loi:Oe.danhSachLoi||[]})}catch(Oe){console.error("Li validate:",Oe),w({hopLe:!1,loi:["C li xy ra khi validate server"]})}finally{T(!1)}},J=async()=>{if(O){L(!0);try{const pe=await Id.preview({quyCheId:r,duLieuGiaLap:K});P({soTien:pe.tongTien,trace:pe.trace.map(Oe=>`${Oe.ruleName}: ${Oe.message}  ${Oe.output.toLocaleString("vi-VN")}`).join(`
`)})}catch(pe){console.error("Li preview:",pe)}finally{L(!1)}}},ge=async()=>{if(O)try{await navigator.clipboard.writeText(JSON.stringify(O,null,2)),xe(!0),setTimeout(()=>xe(!1),2e3)}catch(pe){console.error("Li copy:",pe)}},z=()=>{f!=null&&f.ruleDeXuat&&B({...f.ruleDeXuat})},le=()=>{const pe=[];if(!O)return["Khng c rule  validate"];(!O.tenRule||O.tenRule.trim().length<3)&&pe.push("Tn rule phi c t nht 3 k t"),O.khoanLuongMa||pe.push("Cha chn khon lng");const Oe=O.congThucJson;switch(O.loaiRule){case"CO_DINH":(!Oe.soTien||Oe.soTien<=0)&&pe.push("S tin c nh phi ln hn 0");break;case"THEO_HE_SO":Oe.base||pe.push("Cha chn ngun tnh (base)"),(!Oe.heSo||Oe.heSo<=0)&&pe.push("H s phi ln hn 0");break;case"BAC_THANG":{const tt=Oe.bac;!tt||tt.length===0?pe.push("Phi c t nht 1 bc thang"):tt.forEach((Ye,Re)=>{(Ye.from===void 0||Ye.to===void 0)&&pe.push(`Bc ${Re+1}: Cha nh ngha khong from-to`),!Ye.soTien&&!Ye.soTienMoiLan&&pe.push(`Bc ${Re+1}: Cha nh ngha s tin`)})}break;case"CONG_THUC":(!Oe.bieuThuc||Oe.bieuThuc.trim().length===0)&&pe.push("Cha nhp biu thc cng thc");break;case"THEO_SU_KIEN":Oe.maSuKien||pe.push("Cha chn m s kin");break}return pe},ue=async()=>{if(!(f!=null&&f.auditId)||!O)return;const pe=le();if(pe.length>0){w({hopLe:!1,loi:pe}),alert(`Vui lng sa cc li trc khi p dng:

`+pe.join(`
`));return}if(confirm(`Xc nhn p dng rule "${O.tenRule}"?

Loi: ${mf[O.loaiRule]}
Khon lng: ${O.khoanLuongMa}`)){N(!0);try{await Od.apDungRule(r,f.auditId,O),alert("  p dng rule thnh cng!"),s(),n()}catch(tt){console.error("Li p dng rule:",tt);const Ye=tt instanceof Error?tt.message:"Li khng xc nh";alert(` C li khi p dng rule: ${Ye}`)}finally{N(!1)}}},ce=pe=>{u(pe)},R=pe=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(pe);return e?t.jsxs("div",{className:"fixed inset-0 z-50 flex overflow-hidden",children:[t.jsx("div",{className:"flex-1 bg-black/50 backdrop-blur-sm animate-fadeIn",onClick:n}),t.jsxs("div",{ref:o,className:"w-[600px] max-w-full bg-white shadow-2xl flex flex-col h-full animate-slideInRight",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 text-white shadow-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:t.jsx(m_,{className:"h-6 w-6"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"font-semibold text-lg",children:"Tr l AI gi  Rule"}),t.jsx("p",{className:"text-sm text-white/80",children:"Nhp ting Vit  To rule t ng"})]})]}),t.jsx("button",{onClick:n,className:"p-2 hover:bg-white/20 rounded-lg transition-all hover:rotate-90",title:"ng (Escape)",children:t.jsx(mn,{className:"h-5 w-5"})})]}),t.jsxs("div",{className:"flex border-b bg-gray-50",children:[t.jsxs("button",{onClick:()=>ee("goi-y"),className:`flex-1 py-3 text-sm font-medium transition-all ${W==="goi-y"?"border-b-2 border-blue-600 text-blue-600 bg-white":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[t.jsx(D_,{className:"h-4 w-4 inline mr-2"}),"Gi  Rule"]}),t.jsxs("button",{onClick:()=>ee("lich-su"),className:`flex-1 py-3 text-sm font-medium transition-all ${W==="lich-su"?"border-b-2 border-blue-600 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[t.jsx(pu,{className:"h-4 w-4 inline mr-2"}),"Lch s"]})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[W==="goi-y"&&t.jsxs(t.Fragment,{children:[b&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-sm",children:[t.jsx("div",{className:"font-medium text-gray-700 mb-2",children:"Ng cnh hin ti:"}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-gray-600",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Phng ban:"})," ",t.jsx("span",{className:"font-medium",children:b.phongBan.tenPhongBan})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Quy ch:"})," ",t.jsxs("span",{className:"font-medium",children:["v",b.quyChe.phienBan]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Khon lng:"})," ",t.jsxs("span",{className:"font-medium",children:[b.khoanLuongs.length," khon"]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"S kin:"})," ",t.jsxs("span",{className:"font-medium",children:[b.danhMucSuKien.length," mc"]})]})]})]}),t.jsxs("div",{className:"animate-slideInUp",children:[t.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:" Mu gi :"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:HD.map((pe,Oe)=>t.jsx("button",{onClick:()=>ce(pe),className:"text-xs px-3 py-1.5 bg-blue-50 text-blue-700 rounded-full hover:bg-blue-100 hover:scale-105 transition-all",children:pe.length>40?pe.substring(0,37)+"...":pe},Oe))})]}),t.jsxs("div",{className:"animate-slideInUp",style:{animationDelay:"0.1s"},children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" M t bng ting Vit:"}),t.jsx("textarea",{ref:l,value:d,onChange:pe=>u(pe.target.value),onKeyDown:pe=>{(pe.ctrlKey||pe.metaKey)&&pe.key==="Enter"&&(pe.preventDefault(),d.trim()&&!x&&I())},placeholder:"V d: Pht i tr 1-2 ln 50k/ln, t ln 3 tr ln 100k/ln",className:"w-full h-28 px-3 py-2 border rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",disabled:x}),t.jsxs("div",{className:"flex items-center justify-between mt-1",children:[t.jsx("span",{className:"text-xs text-gray-400",children:"/Ctrl + Enter  gi"}),t.jsxs("span",{className:"text-xs text-gray-400",children:[d.length," k t"]})]}),t.jsx("button",{onClick:I,disabled:!d.trim()||x,className:"mt-2 w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-md hover:shadow-lg",children:x?t.jsxs(t.Fragment,{children:[t.jsx(Mn,{className:"h-4 w-4 animate-spin"}),"ang x l..."]}):t.jsxs(t.Fragment,{children:[t.jsx(gu,{className:"h-4 w-4"}),"To  xut"]})})]}),f&&t.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[t.jsxs("div",{className:`p-3 flex items-center gap-2 ${f.hopLeSoBo?"bg-green-50":"bg-yellow-50"}`,children:[f.hopLeSoBo?t.jsx(ua,{className:"h-5 w-5 text-green-600"}):t.jsx(__,{className:"h-5 w-5 text-yellow-600"}),t.jsx("span",{className:`font-medium ${f.hopLeSoBo?"text-green-700":"text-yellow-700"}`,children:f.hopLeSoBo?" to  xut thnh cng":"Cn lm r thm"})]}),f.canLamRo.length>0&&t.jsxs("div",{className:"p-3 bg-yellow-50 border-t",children:[t.jsx("div",{className:"text-sm font-medium text-yellow-800 mb-2",children:"Cu hi:"}),t.jsx("ul",{className:"space-y-1",children:f.canLamRo.map((pe,Oe)=>t.jsxs("li",{className:"text-sm text-yellow-700 flex items-start gap-2",children:[t.jsx("span",{children:""}),t.jsx("span",{children:pe})]},Oe))})]}),f.ruleDeXuat&&O&&t.jsxs("div",{className:"p-3 space-y-3",children:[f.tomTatRule&&t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Tm tt:"})," ",t.jsx("span",{className:"font-medium",children:f.tomTatRule})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2 text-sm",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Loi rule:"})," ",t.jsx("span",{className:"font-medium text-blue-600",children:mf[O.loaiRule]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Ch  gp:"})," ",t.jsx("span",{className:"font-medium",children:Vb[O.cheDoGop]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Khon lng:"})," ",t.jsx("span",{className:"font-medium",children:O.khoanLuongMa})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"u tin:"})," ",t.jsx("span",{className:"font-medium",children:O.thuTuUuTien})]})]}),t.jsxs("div",{className:"pt-2 border-t flex items-center gap-2 flex-wrap",children:[t.jsxs("button",{onClick:()=>H(!F),className:"text-blue-600 hover:text-blue-800 text-sm flex items-center gap-1",children:[F?t.jsx(ii,{className:"h-4 w-4"}):t.jsx(dj,{className:"h-4 w-4"}),F?"n JSON":"Xem JSON"]}),t.jsxs("button",{onClick:ge,className:"text-gray-600 hover:text-gray-800 text-sm flex items-center gap-1",children:[t.jsx(lj,{className:"h-4 w-4"}),X?" copy!":"Copy JSON"]}),t.jsxs("button",{onClick:()=>fe(!q),className:"text-purple-600 hover:text-purple-800 text-sm flex items-center gap-1",children:[t.jsx(Zs,{className:"h-4 w-4"}),q?"n form":"Chnh sa"]}),t.jsxs("button",{onClick:z,className:"text-orange-600 hover:text-orange-800 text-sm flex items-center gap-1",children:[t.jsx(Zp,{className:"h-4 w-4"}),"Reset"]})]}),F&&t.jsx("pre",{className:"mt-2 p-2 bg-gray-800 text-green-400 rounded text-xs overflow-x-auto max-h-48",children:JSON.stringify(O,null,2)}),q&&t.jsxs("div",{className:"mt-2 p-3 bg-white border rounded-lg space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Tn rule"}),t.jsx("input",{type:"text",value:O.tenRule,onChange:pe=>B({...O,tenRule:pe.target.value}),className:"w-full px-2 py-1.5 border rounded text-sm"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Loi rule"}),t.jsx("select",{value:O.loaiRule,onChange:pe=>B({...O,loaiRule:pe.target.value}),className:"w-full px-2 py-1.5 border rounded text-sm",children:Object.entries(mf).map(([pe,Oe])=>t.jsx("option",{value:pe,children:Oe},pe))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Ch  gp"}),t.jsx("select",{value:O.cheDoGop,onChange:pe=>B({...O,cheDoGop:pe.target.value}),className:"w-full px-2 py-1.5 border rounded text-sm",children:Object.entries(Vb).map(([pe,Oe])=>t.jsx("option",{value:pe,children:Oe},pe))})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Th t u tin"}),t.jsx("input",{type:"number",value:O.thuTuUuTien,onChange:pe=>B({...O,thuTuUuTien:Number(pe.target.value)}),className:"w-24 px-2 py-1.5 border rounded text-sm"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",id:"choPhepChinhTay",checked:O.choPhepChinhTay,onChange:pe=>B({...O,choPhepChinhTay:pe.target.checked})}),t.jsx("label",{htmlFor:"choPhepChinhTay",className:"text-sm text-gray-700",children:"Cho php chnh tay"})]})]})]}),f.giaiThich&&f.giaiThich.length>0&&t.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[t.jsx("div",{className:"text-sm font-medium text-blue-800 mb-1",children:"Gii thch:"}),t.jsx("ul",{className:"space-y-1",children:f.giaiThich.map((pe,Oe)=>t.jsxs("li",{className:"text-sm text-blue-700 flex items-start gap-2",children:[t.jsx("span",{children:""}),t.jsx("span",{children:pe})]},Oe))})]}),f.canhBao&&f.canhBao.length>0&&t.jsxs("div",{className:"bg-orange-50 rounded-lg p-3",children:[t.jsxs("div",{className:"text-sm font-medium text-orange-800 mb-1 flex items-center gap-1",children:[t.jsx(aa,{className:"h-4 w-4"}),"Cnh bo:"]}),t.jsx("ul",{className:"space-y-1",children:f.canhBao.map((pe,Oe)=>t.jsxs("li",{className:"text-sm text-orange-700 flex items-start gap-2",children:[t.jsx("span",{children:""}),t.jsx("span",{children:pe})]},Oe))})]}),S&&t.jsxs("div",{className:`rounded-lg p-3 ${S.hopLe?"bg-green-50":"bg-red-50"}`,children:[t.jsxs("div",{className:`text-sm font-medium mb-1 flex items-center gap-1 ${S.hopLe?"text-green-800":"text-red-800"}`,children:[S.hopLe?t.jsx(ua,{className:"h-4 w-4"}):t.jsx(aa,{className:"h-4 w-4"}),S.hopLe?"Validate thnh cng":"Validate tht bi"]}),S.loi.length>0&&t.jsx("ul",{className:"space-y-1",children:S.loi.map((pe,Oe)=>t.jsxs("li",{className:"text-sm text-red-700 flex items-start gap-2",children:[t.jsx("span",{children:""}),t.jsx("span",{children:pe})]},Oe))})]}),C&&t.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[t.jsx("div",{className:"text-sm font-medium text-purple-800 mb-1",children:"Preview (d liu gi lp):"}),t.jsx("div",{className:"text-lg font-bold text-purple-600",children:R(C.soTien)}),t.jsx("div",{className:"text-xs text-purple-600 mt-1",children:C.trace})]}),t.jsxs("div",{className:"border rounded-lg",children:[t.jsxs("button",{onClick:()=>Y(!ne),className:"w-full px-3 py-2 flex items-center justify-between text-sm text-gray-600 hover:bg-gray-50",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(Zs,{className:"h-4 w-4"}),"Ci t d liu gi lp"]}),t.jsx("span",{children:ne?"":""})]}),ne&&t.jsx("div",{className:"p-3 border-t space-y-2",children:t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Lng c bn"}),t.jsx("input",{type:"number",value:K.luongCoBan,onChange:pe=>A({...K,luongCoBan:Number(pe.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"H s trch nhim"}),t.jsx("input",{type:"number",step:"0.1",value:K.heSoTrachNhiem,onChange:pe=>A({...K,heSoTrachNhiem:Number(pe.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Cp trch nhim"}),t.jsx("input",{type:"number",value:K.capTrachNhiem,onChange:pe=>A({...K,capTrachNhiem:Number(pe.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"S ln i tr"}),t.jsx("input",{type:"number",value:K.soLanDiTre,onChange:pe=>A({...K,soLanDiTre:Number(pe.target.value)}),className:"w-full px-2 py-1 border rounded text-sm"})]})]})})]}),t.jsxs("div",{className:"flex gap-2 pt-2",children:[t.jsxs("button",{onClick:V,disabled:k,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 disabled:opacity-50 transition",children:[k?t.jsx(Mn,{className:"h-4 w-4 animate-spin"}):t.jsx(Ba,{className:"h-4 w-4"}),"Validate"]}),t.jsxs("button",{onClick:J,disabled:_,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 border border-purple-600 text-purple-600 rounded-lg hover:bg-purple-50 disabled:opacity-50 transition",children:[_?t.jsx(Mn,{className:"h-4 w-4 animate-spin"}):t.jsx(ii,{className:"h-4 w-4"}),"Preview"]}),t.jsxs("button",{onClick:ue,disabled:y,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition",children:[y?t.jsx(Mn,{className:"h-4 w-4 animate-spin"}):t.jsx(Or,{className:"h-4 w-4"}),"p dng"]})]})]})]})]}),W==="lich-su"&&t.jsx(UD,{quyCheId:r,onTaiSuDung:pe=>{u(pe),ee("goi-y")}})]})]})]}):null}function UD({quyCheId:e,onTaiSuDung:n}){const[a,r]=E.useState([]),[s,l]=E.useState(!0);E.useEffect(()=>{Od.lichSuDeXuat(e).then(r).catch(console.error).finally(()=>l(!1))},[e]);const o=async u=>{if(confirm("Hy  xut ny?"))try{await Od.huyDeXuat(u),r(x=>x.map(m=>m.id===u?{...m,trangThai:"HUY"}:m))}catch(x){console.error("Li hy:",x)}};if(s)return t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx(Mn,{className:"h-6 w-6 animate-spin text-gray-400"})});if(a.length===0)return t.jsx("div",{className:"text-center py-8 text-gray-500",children:"Cha c lch s  xut no"});const d={DE_XUAT:{text:" xut",color:"bg-yellow-100 text-yellow-800"},DA_AP_DUNG:{text:" p dng",color:"bg-green-100 text-green-800"},HUY:{text:" hy",color:"bg-gray-100 text-gray-800"}};return t.jsx("div",{className:"space-y-3",children:a.map(u=>{var x,m;return t.jsxs("div",{className:"border rounded-lg p-3 hover:border-gray-300 transition",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("div",{className:"text-sm text-gray-500",children:[new Date(u.taoLuc).toLocaleString("vi-VN"),u.nguoiTao&&`  ${u.nguoiTao.hoTen}`]}),t.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${((x=d[u.trangThai])==null?void 0:x.color)||"bg-gray-100"}`,children:((m=d[u.trangThai])==null?void 0:m.text)||u.trangThai})]}),t.jsx("div",{className:"text-sm text-gray-700 line-clamp-2",children:u.promptGoc}),u.rule&&t.jsxs("div",{className:"mt-2 text-xs text-blue-600",children:[" Rule: ",u.rule.tenRule]}),t.jsxs("div",{className:"mt-2 flex gap-2",children:[t.jsxs("button",{onClick:()=>n==null?void 0:n(u.promptGoc),className:"text-xs text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[t.jsx(Zp,{className:"h-3 w-3"}),"Ti s dng"]}),u.trangThai==="DE_XUAT"&&t.jsxs("button",{onClick:()=>o(u.id),className:"text-xs text-red-600 hover:text-red-800 flex items-center gap-1",children:[t.jsx(Rr,{className:"h-3 w-3"}),"Hy"]})]})]},u.id)})})}const hg={CO_DINH:"C nh",THEO_HE_SO:"Theo h s",BAC_THANG:"Bc thang",THEO_SU_KIEN:"Theo s kin",CONG_THUC:"Cng thc"},KD={CO_DINH:"bg-blue-100 text-blue-800",THEO_HE_SO:"bg-green-100 text-green-800",BAC_THANG:"bg-purple-100 text-purple-800",THEO_SU_KIEN:"bg-orange-100 text-orange-800",CONG_THUC:"bg-pink-100 text-pink-800"},zD=({rule:e,index:n,isSelected:a,onSelect:r,onDragStart:s,onDragOver:l,onDrop:o,isDragging:d})=>{var u;return t.jsx("div",{draggable:!0,onDragStart:s,onDragOver:l,onDrop:o,onClick:r,className:`
        p-3 rounded-lg border-2 cursor-pointer transition-all
        ${a?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}
        ${d?"opacity-50":""}
      `,children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"cursor-grab text-gray-400 hover:text-gray-600 mt-1",children:t.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{d:"M7 2a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 2zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 8zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 14zm6-8a2 2 0 1 0-.001-4.001A2 2 0 0 0 13 6zm0 2a2 2 0 1 0 .001 4.001A2 2 0 0 0 13 8zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 13 14z"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsxs("span",{className:"text-xs font-medium text-gray-500",children:["#",n+1]}),t.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${KD[e.loaiRule]}`,children:hg[e.loaiRule]})]}),t.jsx("h4",{className:"font-medium text-gray-900 truncate",children:e.tenRule}),t.jsx("p",{className:"text-sm text-gray-500 truncate mt-1",children:(u=e.khoanLuong)==null?void 0:u.tenKhoan})]}),t.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${e.trangThai?"bg-green-500":"bg-gray-300"}`})]})})},$D=({value:e,onChange:n})=>t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S tin c nh"}),t.jsx("input",{type:"number",value:e.soTien||"",onChange:a=>n({soTien:Number(a.target.value)}),className:"w-full border rounded-lg px-3 py-2",placeholder:"1000000"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.soTien?new Intl.NumberFormat("vi-VN").format(e.soTien)+"":""})]}),GD=({value:e,onChange:n})=>t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Base (ngun tnh)"}),t.jsxs("select",{value:e.base||"",onChange:a=>n({...e,base:a.target.value,heSo:e.heSo||1}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn --"}),t.jsx("option",{value:"LUONG_CO_BAN",children:"Lng c bn"}),t.jsx("option",{value:"HE_SO_TRACH_NHIEM",children:"H s trch nhim"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"H s"}),t.jsx("input",{type:"number",step:"0.01",value:e.heSo||"",onChange:a=>n({...e,base:e.base||"LUONG_CO_BAN",heSo:Number(a.target.value)}),className:"w-full border rounded-lg px-3 py-2",placeholder:"0.2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cng thm (ty chn)"}),t.jsx("input",{type:"number",value:e.congThem||"",onChange:a=>n({...e,base:e.base||"LUONG_CO_BAN",heSo:e.heSo||1,congThem:Number(a.target.value)||void 0}),className:"w-full border rounded-lg px-3 py-2",placeholder:"200000"})]})]}),qD=({value:e,onChange:n})=>{const a=e.bac||[{from:1,to:1,soTien:0}],r=()=>{const o=a[a.length-1];n({field:e.field||"cap_trach_nhiem",bac:[...a,{from:((o==null?void 0:o.to)||0)+1,to:((o==null?void 0:o.to)||0)+1,soTien:0}]})},s=o=>{a.length<=1||n({field:e.field||"cap_trach_nhiem",bac:a.filter((d,u)=>u!==o)})},l=(o,d)=>{n({field:e.field||"cap_trach_nhiem",bac:a.map((u,x)=>x===o?{...u,...d}:u)})};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng d liu"}),t.jsxs("select",{value:e.field||"",onChange:o=>n({...e,field:o.target.value,bac:a}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn --"}),t.jsx("option",{value:"cap_trach_nhiem",children:"Cp trch nhim"}),t.jsx("option",{value:"he_so_trach_nhiem",children:"H s trch nhim"})]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Bc thang"}),t.jsx("button",{type:"button",onClick:r,className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Thm bc"})]}),t.jsx("div",{className:"space-y-2",children:a.map((o,d)=>t.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded",children:[t.jsxs("span",{className:"text-sm text-gray-500 w-16",children:["Bc ",d+1]}),t.jsx("input",{type:"number",value:o.from,onChange:u=>l(d,{from:Number(u.target.value)}),className:"w-20 border rounded px-2 py-1 text-sm",placeholder:"T"}),t.jsx("span",{className:"text-gray-400",children:""}),t.jsx("input",{type:"number",value:o.to,onChange:u=>l(d,{to:Number(u.target.value)}),className:"w-20 border rounded px-2 py-1 text-sm",placeholder:"n"}),t.jsx("input",{type:"number",value:o.soTien||"",onChange:u=>l(d,{soTien:Number(u.target.value)}),className:"flex-1 border rounded px-2 py-1 text-sm",placeholder:"S tin"}),a.length>1&&t.jsx("button",{type:"button",onClick:()=>s(d),className:"text-red-500 hover:text-red-700",children:""})]},d))})]})]})},WD=({value:e,onChange:n})=>t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Biu thc cng thc"}),t.jsx("textarea",{value:e.bieuThuc||"",onChange:a=>n({bieuThuc:a.target.value}),className:"w-full border rounded-lg px-3 py-2 font-mono text-sm",rows:3,placeholder:"LUONG_CO_BAN * HE_SO_TRACH_NHIEM + 200000"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Bin cho php: LUONG_CO_BAN, HE_SO_TRACH_NHIEM, CAP_TRACH_NHIEM, CONG_CHUAN, CONG_THUC_TE, ..."})]});function XD(){var X,xe,K,A,M;const{id:e}=z0(),n=mr(),[a,r]=E.useState(null),[s,l]=E.useState([]),[o,d]=E.useState([]),[u,x]=E.useState(null),[m,f]=E.useState(!0),[p,b]=E.useState(!1),[g,y]=E.useState(null),[N,k]=E.useState(!1),[T,S]=E.useState(!1),[w,_]=E.useState(null),[L,C]=E.useState("thongtin"),[P,F]=E.useState({tenRule:"",moTa:"",khoanLuongId:0,loaiRule:"CO_DINH",congThucJson:{soTien:0},dieuKienJson:{},cheDoGop:"GHI_DE",choPhepChinhTay:!0});E.useEffect(()=>{e&&H()},[e]);const H=async()=>{f(!0);try{const[I,V]=await Promise.all([$s.layChiTiet(Number(e)),Fr.layTatCa()]);r(I),l(I.rules||[]),d(V),I.rules&&I.rules.length>0&&O(I.rules[0])}catch(I){console.error("Li load d liu:",I)}finally{f(!1)}},O=I=>{x(I),F({tenRule:I.tenRule,moTa:I.moTa||"",khoanLuongId:I.khoanLuongId,loaiRule:I.loaiRule,congThucJson:JSON.parse(I.congThucJson),dieuKienJson:I.dieuKienJson?JSON.parse(I.dieuKienJson):{},cheDoGop:I.cheDoGop,choPhepChinhTay:I.choPhepChinhTay}),C("thongtin"),_(null)},B=I=>{y(I)},W=I=>{I.preventDefault()},ee=async I=>{if(g===null||g===I){y(null);return}const V=[...s],[J]=V.splice(g,1);V.splice(I,0,J),l(V),y(null);try{await $s.sapXepRules(Number(e),V.map(ge=>ge.id))}catch(ge){console.error("Li sp xp:",ge),H()}},q=async()=>{var I,V,J;if(u){b(!0);try{await Id.capNhat(u.id,{tenRule:P.tenRule,moTa:P.moTa,loaiRule:P.loaiRule,congThucJson:P.congThucJson,dieuKienJson:P.dieuKienJson,cheDoGop:P.cheDoGop,choPhepChinhTay:P.choPhepChinhTay}),H()}catch(ge){console.error("Li lu rule:",ge),alert(((J=(V=(I=ge.response)==null?void 0:I.data)==null?void 0:V.loi)==null?void 0:J.join(`
`))||"Li lu rule")}finally{b(!1)}}},fe=async()=>{if(u&&confirm("Xa rule ny?"))try{await Id.xoa(u.id),x(null),H()}catch(I){console.error("Li xa:",I),alert("Khng th xa rule ny")}},ne=async()=>{if(e)try{const I=await Id.preview({quyCheId:Number(e),duLieuGiaLap:{LUONG_CO_BAN:1e7,CAP_TRACH_NHIEM:2,HE_SO_TRACH_NHIEM:1.2}});_(I),C("preview")}catch(I){console.error("Li preview:",I),alert("Li chy th")}},Y=async I=>{try{let V={soTien:0};I.loaiRule==="THEO_HE_SO"?V={base:"LUONG_CO_BAN",heSo:.1}:I.loaiRule==="BAC_THANG"?V={field:"cap_trach_nhiem",bac:[{from:1,to:1,soTien:5e5}]}:I.loaiRule==="CONG_THUC"&&(V={bieuThuc:"LUONG_CO_BAN * 0.1"}),await $s.taoRule(Number(e),{khoanLuongId:I.khoanLuongId,tenRule:I.tenRule,loaiRule:I.loaiRule,congThucJson:V}),k(!1),H()}catch(V){console.error("Li thm rule:",V),alert("Li thm rule")}};return m?t.jsx("div",{className:"flex items-center justify-center h-96",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}):a?t.jsxs("div",{className:"h-screen flex flex-col",children:[t.jsx("div",{className:"bg-white border-b px-6 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>n("/quy-che"),className:"p-2 hover:bg-gray-100 rounded",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl font-bold",children:a.tenQuyChe}),t.jsxs("p",{className:"text-sm text-gray-500",children:[(X=a.phongBan)==null?void 0:X.tenPhongBan,"  Phin bn ",a.phienBan]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[!a.coDuocSua&&t.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded text-sm",children:" Quy ch  kho"}),t.jsx("button",{onClick:ne,className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Chy th"}),t.jsxs("button",{onClick:()=>S(!0),disabled:!a.coDuocSua,className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 disabled:opacity-50 flex items-center gap-2",children:[t.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[t.jsx("path",{d:"M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73A2 2 0 0 1 12 2z"}),t.jsx("path",{d:"M9 14a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"}),t.jsx("path",{d:"M15 14a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"})]}),"Tr l AI"]}),t.jsx("button",{onClick:()=>k(!0),disabled:!a.coDuocSua,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"+ Thm rule"})]})]})}),t.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[t.jsxs("div",{className:"w-80 border-r bg-gray-50 flex flex-col",children:[t.jsxs("div",{className:"p-4 border-b bg-white",children:[t.jsxs("h3",{className:"font-semibold text-gray-900",children:["Danh sch Rule (",s.length,")"]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ko th  sp xp th t u tin"})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[s.map((I,V)=>t.jsx(zD,{rule:I,index:V,isSelected:(u==null?void 0:u.id)===I.id,onSelect:()=>O(I),onDragStart:()=>B(V),onDragOver:W,onDrop:()=>ee(V),isDragging:g===V},I.id)),s.length===0&&t.jsxs("div",{className:"text-center text-gray-500 py-10",children:["Cha c rule no.",t.jsx("br",{}),t.jsx("button",{onClick:()=>k(!0),className:"text-blue-600 hover:underline mt-2",children:"Thm rule u tin"})]})]})]}),t.jsx("div",{className:"flex-1 flex flex-col bg-white overflow-hidden",children:u?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"border-b",children:t.jsx("nav",{className:"flex px-6",children:["thongtin","dieukien","congthuc","preview"].map(I=>t.jsx("button",{onClick:()=>C(I),className:`px-4 py-3 text-sm font-medium border-b-2 -mb-px ${L===I?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:{thongtin:"Thng tin",dieukien:"iu kin",congthuc:"Cch tnh",preview:"Xem th"}[I]},I))})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[L==="thongtin"&&t.jsxs("div",{className:"space-y-4 max-w-lg",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn rule"}),t.jsx("input",{type:"text",value:P.tenRule,onChange:I=>F({...P,tenRule:I.target.value}),className:"w-full border rounded-lg px-3 py-2",disabled:!a.coDuocSua})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Khon lng"}),t.jsx("select",{value:P.khoanLuongId,onChange:I=>F({...P,khoanLuongId:Number(I.target.value)}),className:"w-full border rounded-lg px-3 py-2",disabled:!a.coDuocSua,children:o.map(I=>t.jsxs("option",{value:I.id,children:[I.tenKhoan," (",I.loai==="THU_NHAP"?"+":"-",")"]},I.id))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi rule"}),t.jsx("select",{value:P.loaiRule,onChange:I=>F({...P,loaiRule:I.target.value}),className:"w-full border rounded-lg px-3 py-2",disabled:!a.coDuocSua,children:Object.entries(hg).map(([I,V])=>t.jsx("option",{value:I,children:V},I))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),t.jsx("textarea",{value:P.moTa,onChange:I=>F({...P,moTa:I.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:3,disabled:!a.coDuocSua})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:P.choPhepChinhTay,onChange:I=>F({...P,choPhepChinhTay:I.target.checked}),disabled:!a.coDuocSua}),t.jsx("span",{className:"text-sm",children:"Cho php chnh tay"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm",children:"Ch  gp:"}),t.jsxs("select",{value:P.cheDoGop,onChange:I=>F({...P,cheDoGop:I.target.value}),className:"border rounded px-2 py-1 text-sm",disabled:!a.coDuocSua,children:[t.jsx("option",{value:"GHI_DE",children:"Ghi "}),t.jsx("option",{value:"CONG_DON",children:"Cng dn"})]})]})]})]}),L==="dieukien"&&t.jsxs("div",{className:"max-w-lg space-y-4",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"iu kin p dng rule.  trng = p dng cho tt c nhn vin."}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vai tr"}),t.jsx("input",{type:"text",value:(((K=(xe=P.dieuKienJson)==null?void 0:xe.apDungCho)==null?void 0:K.vaiTro)||[]).join(", "),onChange:I=>{var V;return F({...P,dieuKienJson:{apDungCho:{...(V=P.dieuKienJson)==null?void 0:V.apDungCho,vaiTro:I.target.value?I.target.value.split(",").map(J=>J.trim()):void 0}}})},className:"w-full border rounded-lg px-3 py-2",placeholder:"TO_TRUONG, QUAN_LY",disabled:!a.coDuocSua}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Phn cch bng du phy"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cp trch nhim"}),t.jsx("input",{type:"text",value:(((M=(A=P.dieuKienJson)==null?void 0:A.apDungCho)==null?void 0:M.capTrachNhiem)||[]).join(", "),onChange:I=>{var V;return F({...P,dieuKienJson:{apDungCho:{...(V=P.dieuKienJson)==null?void 0:V.apDungCho,capTrachNhiem:I.target.value?I.target.value.split(",").map(J=>Number(J.trim())).filter(J=>!isNaN(J)):void 0}}})},className:"w-full border rounded-lg px-3 py-2",placeholder:"1, 2, 3",disabled:!a.coDuocSua})]})]}),L==="congthuc"&&t.jsxs("div",{className:"max-w-lg",children:[P.loaiRule==="CO_DINH"&&t.jsx($D,{value:P.congThucJson,onChange:I=>F({...P,congThucJson:I})}),P.loaiRule==="THEO_HE_SO"&&t.jsx(GD,{value:P.congThucJson,onChange:I=>F({...P,congThucJson:I})}),P.loaiRule==="BAC_THANG"&&t.jsx(qD,{value:P.congThucJson,onChange:I=>F({...P,congThucJson:I})}),P.loaiRule==="CONG_THUC"&&t.jsx(WD,{value:P.congThucJson,onChange:I=>F({...P,congThucJson:I})}),P.loaiRule==="THEO_SU_KIEN"&&t.jsx("div",{className:"text-gray-500",children:"Form s kin s c thm sau..."})]}),L==="preview"&&w&&t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"p-4 bg-blue-50 rounded-lg",children:t.jsxs("h4",{className:"font-semibold text-blue-900",children:["Tng tin: ",new Intl.NumberFormat("vi-VN").format(w.tongTien),""]})}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-2",children:"Chi tit"}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Khon lng"}),t.jsx("th",{className:"px-4 py-2 text-right text-sm",children:"S tin"}),t.jsx("th",{className:"px-4 py-2 text-left text-sm",children:"Gii thch"})]})}),t.jsx("tbody",{children:w.chiTiet.map((I,V)=>t.jsxs("tr",{className:"border-t",children:[t.jsx("td",{className:"px-4 py-2",children:I.khoanLuong}),t.jsx("td",{className:"px-4 py-2 text-right font-mono",children:new Intl.NumberFormat("vi-VN").format(I.soTien)}),t.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:I.giaiThich})]},V))})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-2",children:"Trace"}),t.jsx("div",{className:"space-y-2",children:w.trace.map((I,V)=>t.jsxs("div",{className:"p-3 bg-gray-50 rounded text-sm",children:[t.jsx("div",{className:"font-medium",children:I.ruleName}),t.jsx("div",{className:"text-gray-600",children:I.message}),t.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Output: ",new Intl.NumberFormat("vi-VN").format(I.output),""]})]},V))})]})]})]}),a.coDuocSua&&t.jsxs("div",{className:"border-t px-6 py-4 flex justify-between",children:[t.jsx("button",{onClick:fe,className:"px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg",children:"Xa rule"}),t.jsx("button",{onClick:q,disabled:p,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:p?"ang lu...":"Lu thay i"})]})]}):t.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:"Chn mt rule  xem chi tit"})})]}),N&&t.jsx(QD,{khoanLuongs:o,onClose:()=>k(!1),onAdd:Y}),t.jsx(VD,{isOpen:T,onClose:()=>S(!1),phongBanId:a.phongBanId,quyCheId:a.id,onRuleApplied:H})]}):t.jsx("div",{className:"p-6 text-center text-gray-500",children:"Khng tm thy quy ch"})}function QD({khoanLuongs:e,onClose:n,onAdd:a}){var l;const[r,s]=E.useState({khoanLuongId:((l=e[0])==null?void 0:l.id)||0,tenRule:"",loaiRule:"CO_DINH"});return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[t.jsx("div",{className:"px-6 py-4 border-b",children:t.jsx("h3",{className:"text-lg font-semibold",children:"Thm Rule mi"})}),t.jsxs("div",{className:"px-6 py-4 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn rule"}),t.jsx("input",{type:"text",value:r.tenRule,onChange:o=>s({...r,tenRule:o.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Ph cp trch nhim t trng"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Khon lng"}),t.jsx("select",{value:r.khoanLuongId,onChange:o=>s({...r,khoanLuongId:Number(o.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:e.map(o=>t.jsxs("option",{value:o.id,children:[o.tenKhoan," (",o.loai==="THU_NHAP"?"+":"-",")"]},o.id))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi rule"}),t.jsx("select",{value:r.loaiRule,onChange:o=>s({...r,loaiRule:o.target.value}),className:"w-full border rounded-lg px-3 py-2",children:Object.entries(hg).map(([o,d])=>t.jsx("option",{value:o,children:d},o))})]})]}),t.jsxs("div",{className:"px-6 py-4 border-t flex justify-end gap-3",children:[t.jsx("button",{onClick:n,className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:()=>a(r),disabled:!r.tenRule||!r.khoanLuongId,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Thm rule"})]})]})})}const ff={NHAP:{label:"Nhp",color:"bg-gray-100 text-gray-800"},DA_DUYET:{label:" duyt",color:"bg-green-100 text-green-800"},TU_CHOI:{label:"T chi",color:"bg-red-100 text-red-800"},HUY:{label:"Hu",color:"bg-gray-400 text-white"}},Td={THUONG:{label:"Thng",color:"bg-green-100 text-green-800",icon:""},PHAT:{label:"Pht",color:"bg-red-100 text-red-800",icon:""}};function YD(){const[e,n]=E.useState([]),[a,r]=E.useState([]),[s,l]=E.useState([]),[o,d]=E.useState([]),[u,x]=E.useState(!0),[m,f]=E.useState(!1),[p,b]=E.useState(!1),[g,y]=E.useState([]),[N,k]=E.useState({}),[T,S]=E.useState({nhanVienId:0,phongBanId:0,ngay:new Date().toISOString().split("T")[0],loaiSuKien:"THUONG",maSuKien:"",giaTri:1,soTien:0,ghiChu:""}),[w,_]=E.useState({maSuKien:"",tenSuKien:"",loai:"THUONG",moTa:"",soTienMacDinh:0});E.useEffect(()=>{L()},[]);const L=async()=>{x(!0);try{const ne={...N,tuNgay:N.tuNgay?new Date(N.tuNgay):void 0,denNgay:N.denNgay?new Date(N.denNgay):void 0},[Y,X,xe,K]=await Promise.all([Dl.layDanhSach(ne),Dl.layDanhMucSuKien(),cn.layTatCa(),Ma.layTatCa()]);n(Array.isArray(Y)?Y:[]),r(X),l(xe);const A="data"in K?K.data:K;d(Array.isArray(A)?A:[])}catch(ne){console.error("Li load d liu:",ne)}finally{x(!1)}},C=()=>{L()},P=async()=>{try{await Dl.tao({...T,ngay:new Date(T.ngay)}),f(!1),L(),W()}catch(ne){console.error("Li to s kin:",ne),alert("Li to s kin")}},F=async ne=>{try{await Dl.duyet(ne,{trangThai:"DA_DUYET"}),L()}catch(Y){console.error("Li duyt:",Y),alert("Li duyt s kin")}},H=async ne=>{const Y=prompt("L do t chi:");if(Y)try{await Dl.duyet(ne,{trangThai:"TU_CHOI",lyDo:Y}),L()}catch(X){console.error("Li t chi:",X)}},O=async()=>{if(g.length!==0&&confirm(`Duyt ${g.length} s kin?`))try{await Dl.duyetNhieu({danhSachId:g,trangThai:"DA_DUYET"}),y([]),L()}catch(ne){console.error("Li duyt nhiu:",ne)}},B=async()=>{try{await Dl.taoDanhMucSuKien(w),b(!1),L(),_({maSuKien:"",tenSuKien:"",loai:"THUONG",moTa:"",soTienMacDinh:0})}catch(ne){console.error("Li to danh mc:",ne),alert("Li to danh mc")}},W=()=>{S({nhanVienId:0,phongBanId:0,ngay:new Date().toISOString().split("T")[0],loaiSuKien:"THUONG",maSuKien:"",giaTri:1,soTien:0,ghiChu:""})},ee=ne=>{y(Y=>Y.includes(ne)?Y.filter(X=>X!==ne):[...Y,ne])},q=()=>{const ne=e.filter(Y=>Y.trangThai==="NHAP").map(Y=>Y.id);g.length===ne.length?y([]):y(ne)},fe=ne=>{const Y=a.find(X=>X.maSuKien===ne);S({...T,maSuKien:ne,loaiSuKien:(Y==null?void 0:Y.loai)||"THUONG",soTien:(Y==null?void 0:Y.soTienMacDinh)||0})};return u?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}):t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"S kin Thng/Pht"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Qun l cc s kin thng, pht cho nhn vin"})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>b(!0),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Danh mc s kin"}),t.jsxs("button",{onClick:()=>f(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[t.jsx(St,{size:18}),"Thm s kin"]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban"}),t.jsxs("select",{value:N.phongBanId||"",onChange:ne=>k({...N,phongBanId:Number(ne.target.value)||void 0}),className:"border rounded-lg px-3 py-2 w-48",children:[t.jsx("option",{value:"",children:"Tt c"}),s.map(ne=>t.jsx("option",{value:ne.id,children:ne.tenPhongBan},ne.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Loi"}),t.jsxs("select",{value:N.loaiSuKien||"",onChange:ne=>k({...N,loaiSuKien:ne.target.value||void 0}),className:"border rounded-lg px-3 py-2 w-32",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"THUONG",children:"Thng"}),t.jsx("option",{value:"PHAT",children:"Pht"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Trng thi"}),t.jsxs("select",{value:N.trangThai||"",onChange:ne=>k({...N,trangThai:ne.target.value||void 0}),className:"border rounded-lg px-3 py-2 w-32",children:[t.jsx("option",{value:"",children:"Tt c"}),Object.entries(ff).map(([ne,{label:Y}])=>t.jsx("option",{value:ne,children:Y},ne))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"T ngy"}),t.jsx(Ut,{value:N.tuNgay||"",onChange:ne=>k({...N,tuNgay:ne}),className:"border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"n ngy"}),t.jsx(Ut,{value:N.denNgay||"",onChange:ne=>k({...N,denNgay:ne}),className:"border rounded-lg px-3 py-2"})]}),t.jsxs("button",{onClick:C,className:"px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 flex items-center gap-2",children:[t.jsx(Xp,{size:16}),"Lc"]})]})}),g.length>0&&t.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 mb-4 flex items-center justify-between",children:[t.jsxs("span",{className:"text-blue-800",children:[" chn ",g.length," s kin"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:O,className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 text-sm",children:"Duyt tt c"}),t.jsx("button",{onClick:()=>y([]),className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 text-sm",children:"B chn"})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left w-10",children:t.jsx("input",{type:"checkbox",checked:e.filter(ne=>ne.trangThai==="NHAP").length>0&&g.length===e.filter(ne=>ne.trangThai==="NHAP").length,onChange:q})}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Ngy"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Loi"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M s kin"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"Gi tr"}),t.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"S tin"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Thao tc"})]})}),t.jsxs("tbody",{children:[e.map(ne=>{var Y,X,xe;return t.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3",children:ne.trangThai==="NHAP"&&t.jsx("input",{type:"checkbox",checked:g.includes(ne.id),onChange:()=>ee(ne.id)})}),t.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(ne.ngay).toLocaleDateString("vi-VN")}),t.jsxs("td",{className:"px-4 py-3",children:[t.jsx("div",{className:"text-sm font-medium",children:(Y=ne.nhanVien)==null?void 0:Y.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:(X=ne.nhanVien)==null?void 0:X.maNhanVien})]}),t.jsx("td",{className:"px-4 py-3 text-sm",children:(xe=ne.phongBan)==null?void 0:xe.tenPhongBan}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("span",{className:`px-2 py-1 rounded text-xs ${Td[ne.loaiSuKien].color}`,children:[Td[ne.loaiSuKien].icon," ",Td[ne.loaiSuKien].label]})}),t.jsx("td",{className:"px-4 py-3 text-sm font-mono",children:ne.maSuKien}),t.jsx("td",{className:"px-4 py-3 text-sm text-right",children:ne.giaTri}),t.jsxs("td",{className:"px-4 py-3 text-sm text-right font-mono",children:[new Intl.NumberFormat("vi-VN").format(ne.soTien),""]}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded text-xs ${ff[ne.trangThai].color}`,children:ff[ne.trangThai].label})}),t.jsx("td",{className:"px-4 py-3 text-center",children:ne.trangThai==="NHAP"&&t.jsxs("div",{className:"flex justify-center gap-1",children:[t.jsx("button",{onClick:()=>F(ne.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Duyt",children:t.jsx(Or,{size:16})}),t.jsx("button",{onClick:()=>H(ne.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"T chi",children:t.jsx(mn,{size:16})})]})})]},ne.id)}),e.length===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:10,className:"px-4 py-10 text-center text-gray-500",children:"Khng c s kin no"})})]})]})}),m&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg",children:[t.jsx("div",{className:"px-6 py-4 border-b",children:t.jsx("h3",{className:"text-lg font-semibold",children:"Thm s kin Thng/Pht"})}),t.jsxs("div",{className:"px-6 py-4 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nhn vin"}),t.jsxs("select",{value:T.nhanVienId,onChange:ne=>{const Y=o.find(X=>X.id===Number(ne.target.value));S({...T,nhanVienId:Number(ne.target.value),phongBanId:(Y==null?void 0:Y.phongBanId)||T.phongBanId})},className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn --"}),o.map(ne=>t.jsxs("option",{value:ne.id,children:[ne.hoTen," (",ne.maNhanVien,")"]},ne.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy"}),t.jsx(Ut,{value:T.ngay,onChange:ne=>S({...T,ngay:ne}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi s kin"}),t.jsxs("select",{value:T.maSuKien,onChange:ne=>fe(ne.target.value),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn s kin --"}),t.jsx("optgroup",{label:"Thng",children:a.filter(ne=>ne.loai==="THUONG").map(ne=>t.jsxs("option",{value:ne.maSuKien,children:[ne.tenSuKien," (",ne.maSuKien,")"]},ne.maSuKien))}),t.jsx("optgroup",{label:"Pht",children:a.filter(ne=>ne.loai==="PHAT").map(ne=>t.jsxs("option",{value:ne.maSuKien,children:[ne.tenSuKien," (",ne.maSuKien,")"]},ne.maSuKien))})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi tr (ln/ngy/...)"}),t.jsx("input",{type:"number",value:T.giaTri,onChange:ne=>S({...T,giaTri:Number(ne.target.value)}),className:"w-full border rounded-lg px-3 py-2",min:1})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S tin"}),t.jsx("input",{type:"number",value:T.soTien,onChange:ne=>S({...T,soTien:Number(ne.target.value)}),className:"w-full border rounded-lg px-3 py-2"}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[new Intl.NumberFormat("vi-VN").format(T.soTien),""]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),t.jsx("textarea",{value:T.ghiChu,onChange:ne=>S({...T,ghiChu:ne.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"px-6 py-4 border-t flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{f(!1),W()},className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:P,disabled:!T.nhanVienId||!T.maSuKien,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Thm s kin"})]})]})}),p&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[80vh] flex flex-col",children:[t.jsxs("div",{className:"px-6 py-4 border-b flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Danh mc S kin"}),t.jsx("button",{onClick:()=>b(!1),className:"p-2 hover:bg-gray-100 rounded",children:t.jsx(mn,{size:20})})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[t.jsx("h4",{className:"font-medium mb-3",children:"Thm danh mc mi"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsx("input",{type:"text",placeholder:"M s kin",value:w.maSuKien,onChange:ne=>_({...w,maSuKien:ne.target.value}),className:"border rounded px-3 py-2"}),t.jsx("input",{type:"text",placeholder:"Tn s kin",value:w.tenSuKien,onChange:ne=>_({...w,tenSuKien:ne.target.value}),className:"border rounded px-3 py-2"}),t.jsxs("select",{value:w.loai,onChange:ne=>_({...w,loai:ne.target.value}),className:"border rounded px-3 py-2",children:[t.jsx("option",{value:"THUONG",children:"Thng"}),t.jsx("option",{value:"PHAT",children:"Pht"})]}),t.jsx("input",{type:"number",placeholder:"S tin mc nh",value:w.soTienMacDinh||"",onChange:ne=>_({...w,soTienMacDinh:Number(ne.target.value)}),className:"border rounded px-3 py-2"})]}),t.jsx("div",{className:"mt-3 flex justify-end",children:t.jsx("button",{onClick:B,disabled:!w.maSuKien||!w.tenSuKien,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:"Thm"})})]}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-100",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-3 py-2 text-left text-sm",children:"M"}),t.jsx("th",{className:"px-3 py-2 text-left text-sm",children:"Tn"}),t.jsx("th",{className:"px-3 py-2 text-left text-sm",children:"Loi"}),t.jsx("th",{className:"px-3 py-2 text-right text-sm",children:"S tin mc nh"})]})}),t.jsx("tbody",{children:a.map(ne=>t.jsxs("tr",{className:"border-t",children:[t.jsx("td",{className:"px-3 py-2 font-mono text-sm",children:ne.maSuKien}),t.jsx("td",{className:"px-3 py-2",children:ne.tenSuKien}),t.jsx("td",{className:"px-3 py-2",children:t.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Td[ne.loai].color}`,children:Td[ne.loai].label})}),t.jsx("td",{className:"px-3 py-2 text-right font-mono",children:ne.soTienMacDinh?new Intl.NumberFormat("vi-VN").format(ne.soTienMacDinh)+"":"-"})]},ne.id))})]})]})]})})]})}const JD={CO_DINH:"C nh",THEO_HE_SO:"Theo h s",BAC_THANG:"Bc thang",THEO_SU_KIEN:"Theo s kin",CONG_THUC:"Cng thc"};function ZD(){const[e]=b3(),n=Number(e.get("bangLuongId"))||0,[a,r]=E.useState(null),[s,l]=E.useState([]),[o,d]=E.useState(!0),[u,x]=E.useState(""),[m,f]=E.useState([]);E.useEffect(()=>{n&&p()},[n]);const p=async()=>{d(!0);try{const[k,T]=await Promise.all([Dr.layTheoId(n),MD.xemTrace(n)]);r(k),l(T)}catch(k){console.error("Li load d liu:",k)}finally{d(!1)}},b=s.reduce((k,T)=>{const S=T.nhanVienId;return k[S]||(k[S]={nhanVien:T.nhanVien,traces:[]}),k[S].traces.push(T),k},{}),g=Object.entries(b).filter(([k,T])=>{var w,_;if(!u)return!0;const S=u.toLowerCase();return((w=T.nhanVien)==null?void 0:w.hoTen.toLowerCase().includes(S))||((_=T.nhanVien)==null?void 0:_.maNhanVien.toLowerCase().includes(S))}),y=k=>{f(T=>T.includes(k)?T.filter(S=>S!==k):[...T,k])},N=k=>new Intl.NumberFormat("vi-VN").format(k);return o?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"})}):t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[t.jsx(ca,{to:`/bang-luong/${n}`,className:"p-2 hover:bg-gray-100 rounded",children:t.jsx(q0,{size:20})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Rule Trace - Gii trnh tnh lng"}),a&&t.jsxs("p",{className:"text-gray-500 mt-1",children:[a.phongBan.tenPhongBan," - Thng ",a.thang,"/",a.nam]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:t.jsxs("div",{className:"relative",children:[t.jsx(Hr,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),t.jsx("input",{type:"text",placeholder:"Tm theo tn hoc m nhn vin...",value:u,onChange:k=>x(k.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]})}),t.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 mb-6 flex items-center justify-between",children:[t.jsx("div",{children:t.jsxs("span",{className:"text-blue-800",children:["Tng: ",Object.keys(b).length," nhn vin, ",s.length," dng trace"]})}),t.jsx("button",{onClick:()=>{m.length===Object.keys(b).length?f([]):f(Object.keys(b).map(Number))},className:"text-sm text-blue-600 hover:underline",children:m.length===Object.keys(b).length?"Thu gn tt c":"M rng tt c"})]}),t.jsxs("div",{className:"space-y-4",children:[g.map(([k,T])=>{var L,C;const S=Number(k),w=m.includes(S),_=T.traces.reduce((P,F)=>P+F.outputSoTien,0);return t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsxs("button",{onClick:()=>y(S),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-gray-50",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[w?t.jsx(Ar,{size:18,className:"text-gray-400"}):t.jsx($n,{size:18,className:"text-gray-400"}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"font-medium",children:(L=T.nhanVien)==null?void 0:L.hoTen}),t.jsx("div",{className:"text-sm text-gray-500",children:(C=T.nhanVien)==null?void 0:C.maNhanVien})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"font-medium text-blue-600",children:[N(_),""]}),t.jsxs("div",{className:"text-sm text-gray-500",children:[T.traces.length," rules"]})]})]}),w&&t.jsx("div",{className:"border-t",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Quy ch"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Rule"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Khon lng"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500",children:"S tin"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Gii thch"})]})}),t.jsx("tbody",{children:T.traces.map(P=>{var F,H,O,B,W,ee;return t.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[t.jsxs("td",{className:"px-4 py-2",children:[t.jsx("div",{className:"text-sm",children:(F=P.quyChe)==null?void 0:F.tenQuyChe}),t.jsxs("div",{className:"text-xs text-gray-500",children:["v",(H=P.quyChe)==null?void 0:H.phienBan]})]}),t.jsx("td",{className:"px-4 py-2",children:P.quyCheRule?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-sm",children:P.quyCheRule.tenRule}),t.jsx("div",{className:"text-xs text-gray-500",children:JD[P.quyCheRule.loaiRule]})]}):t.jsx("span",{className:"text-gray-400 text-sm",children:"-"})}),t.jsxs("td",{className:"px-4 py-2",children:[t.jsx("div",{className:"text-sm",children:(O=P.khoanLuong)==null?void 0:O.tenKhoan}),t.jsx("div",{className:"text-xs text-gray-500",children:(B=P.khoanLuong)==null?void 0:B.maKhoan})]}),t.jsx("td",{className:"px-4 py-2 text-right",children:t.jsxs("span",{className:`font-mono text-sm ${((W=P.khoanLuong)==null?void 0:W.loai)==="KHAU_TRU"?"text-red-600":"text-green-600"}`,children:[((ee=P.khoanLuong)==null?void 0:ee.loai)==="KHAU_TRU"?"-":"+",N(P.outputSoTien),""]})}),t.jsxs("td",{className:"px-4 py-2",children:[t.jsx("div",{className:"text-sm text-gray-600",children:P.messageGiaiThich}),P.inputJson&&t.jsxs("details",{className:"mt-1",children:[t.jsx("summary",{className:"text-xs text-blue-600 cursor-pointer",children:"Xem input"}),t.jsx("pre",{className:"mt-1 text-xs bg-gray-100 p-2 rounded overflow-x-auto",children:JSON.stringify(JSON.parse(P.inputJson),null,2)})]})]})]},P.id)})})]})})]},S)}),g.length===0&&t.jsx("div",{className:"text-center text-gray-500 py-10",children:"Khng c d liu trace"})]})]})}var pf={exports:{}},gf,Ub;function eA(){if(Ub)return gf;Ub=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return gf=e,gf}var yf,Kb;function tA(){if(Kb)return yf;Kb=1;var e=eA();function n(){}function a(){}return a.resetWarningCache=n,yf=function(){function r(o,d,u,x,m,f){if(f!==e){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}r.isRequired=r;function s(){return r}var l={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:s,element:r,elementType:r,instanceOf:s,node:r,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:a,resetWarningCache:n};return l.PropTypes=l,l},yf}var zb;function nA(){return zb||(zb=1,pf.exports=tA()()),pf.exports}var aA=nA();const Jt=Ip(aA);function mo(e,n,a,r){function s(l){return l instanceof a?l:new a(function(o){o(l)})}return new(a||(a=Promise))(function(l,o){function d(m){try{x(r.next(m))}catch(f){o(f)}}function u(m){try{x(r.throw(m))}catch(f){o(f)}}function x(m){m.done?l(m.value):s(m.value).then(d,u)}x((r=r.apply(e,n||[])).next())})}const rA=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function Tc(e,n,a){const r=sA(e),{webkitRelativePath:s}=e,l=typeof n=="string"?n:typeof s=="string"&&s.length>0?s:`./${e.name}`;return typeof r.path!="string"&&$b(r,"path",l),$b(r,"relativePath",l),r}function sA(e){const{name:n}=e;if(n&&n.lastIndexOf(".")!==-1&&!e.type){const r=n.split(".").pop().toLowerCase(),s=rA.get(r);s&&Object.defineProperty(e,"type",{value:s,writable:!1,configurable:!1,enumerable:!0})}return e}function $b(e,n,a){Object.defineProperty(e,n,{value:a,writable:!1,configurable:!1,enumerable:!0})}const iA=[".DS_Store","Thumbs.db"];function lA(e){return mo(this,void 0,void 0,function*(){return j0(e)&&oA(e.dataTransfer)?hA(e.dataTransfer,e.type):cA(e)?dA(e):Array.isArray(e)&&e.every(n=>"getFile"in n&&typeof n.getFile=="function")?uA(e):[]})}function oA(e){return j0(e)}function cA(e){return j0(e)&&j0(e.target)}function j0(e){return typeof e=="object"&&e!==null}function dA(e){return gp(e.target.files).map(n=>Tc(n))}function uA(e){return mo(this,void 0,void 0,function*(){return(yield Promise.all(e.map(a=>a.getFile()))).map(a=>Tc(a))})}function hA(e,n){return mo(this,void 0,void 0,function*(){if(e.items){const a=gp(e.items).filter(s=>s.kind==="file");if(n!=="drop")return a;const r=yield Promise.all(a.map(xA));return Gb(cw(r))}return Gb(gp(e.files).map(a=>Tc(a)))})}function Gb(e){return e.filter(n=>iA.indexOf(n.name)===-1)}function gp(e){if(e===null)return[];const n=[];for(let a=0;a<e.length;a++){const r=e[a];n.push(r)}return n}function xA(e){if(typeof e.webkitGetAsEntry!="function")return qb(e);const n=e.webkitGetAsEntry();return n&&n.isDirectory?dw(n):qb(e,n)}function cw(e){return e.reduce((n,a)=>[...n,...Array.isArray(a)?cw(a):[a]],[])}function qb(e,n){return mo(this,void 0,void 0,function*(){var a;if(globalThis.isSecureContext&&typeof e.getAsFileSystemHandle=="function"){const l=yield e.getAsFileSystemHandle();if(l===null)throw new Error(`${e} is not a File`);if(l!==void 0){const o=yield l.getFile();return o.handle=l,Tc(o)}}const r=e.getAsFile();if(!r)throw new Error(`${e} is not a File`);return Tc(r,(a=n==null?void 0:n.fullPath)!==null&&a!==void 0?a:void 0)})}function mA(e){return mo(this,void 0,void 0,function*(){return e.isDirectory?dw(e):fA(e)})}function dw(e){const n=e.createReader();return new Promise((a,r)=>{const s=[];function l(){n.readEntries(o=>mo(this,void 0,void 0,function*(){if(o.length){const d=Promise.all(o.map(mA));s.push(d),l()}else try{const d=yield Promise.all(s);a(d)}catch(d){r(d)}}),o=>{r(o)})}l()})}function fA(e){return mo(this,void 0,void 0,function*(){return new Promise((n,a)=>{e.file(r=>{const s=Tc(r,e.fullPath);n(s)},r=>{a(r)})})})}var $h={},Wb;function pA(){return Wb||(Wb=1,$h.__esModule=!0,$h.default=function(e,n){if(e&&n){var a=Array.isArray(n)?n:n.split(",");if(a.length===0)return!0;var r=e.name||"",s=(e.type||"").toLowerCase(),l=s.replace(/\/.*$/,"");return a.some(function(o){var d=o.trim().toLowerCase();return d.charAt(0)==="."?r.toLowerCase().endsWith(d):d.endsWith("/*")?l===d.replace(/\/.*$/,""):s===d})}return!0}),$h}var gA=pA();const vf=Ip(gA);function Xb(e){return bA(e)||vA(e)||hw(e)||yA()}function yA(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vA(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bA(e){if(Array.isArray(e))return yp(e)}function Qb(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),a.push.apply(a,r)}return a}function Yb(e){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?Qb(Object(a),!0).forEach(function(r){uw(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Qb(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function uw(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function Xd(e,n){return wA(e)||jA(e,n)||hw(e,n)||NA()}function NA(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hw(e,n){if(e){if(typeof e=="string")return yp(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return yp(e,n)}}function yp(e,n){(n==null||n>e.length)&&(n=e.length);for(var a=0,r=new Array(n);a<n;a++)r[a]=e[a];return r}function jA(e,n){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var r=[],s=!0,l=!1,o,d;try{for(a=a.call(e);!(s=(o=a.next()).done)&&(r.push(o.value),!(n&&r.length===n));s=!0);}catch(u){l=!0,d=u}finally{try{!s&&a.return!=null&&a.return()}finally{if(l)throw d}}return r}}function wA(e){if(Array.isArray(e))return e}var kA=typeof vf=="function"?vf:vf.default,TA="file-invalid-type",CA="file-too-large",SA="file-too-small",_A="too-many-files",EA=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=n.split(","),r=a.length>1?"one of ".concat(a.join(", ")):a[0];return{code:TA,message:"File type must be ".concat(r)}},Jb=function(n){return{code:CA,message:"File is larger than ".concat(n," ").concat(n===1?"byte":"bytes")}},Zb=function(n){return{code:SA,message:"File is smaller than ".concat(n," ").concat(n===1?"byte":"bytes")}},DA={code:_A,message:"Too many files"};function xw(e,n){var a=e.type==="application/x-moz-file"||kA(e,n);return[a,a?null:EA(n)]}function mw(e,n,a){if(Ol(e.size))if(Ol(n)&&Ol(a)){if(e.size>a)return[!1,Jb(a)];if(e.size<n)return[!1,Zb(n)]}else{if(Ol(n)&&e.size<n)return[!1,Zb(n)];if(Ol(a)&&e.size>a)return[!1,Jb(a)]}return[!0,null]}function Ol(e){return e!=null}function AA(e){var n=e.files,a=e.accept,r=e.minSize,s=e.maxSize,l=e.multiple,o=e.maxFiles,d=e.validator;return!l&&n.length>1||l&&o>=1&&n.length>o?!1:n.every(function(u){var x=xw(u,a),m=Xd(x,1),f=m[0],p=mw(u,r,s),b=Xd(p,1),g=b[0],y=d?d(u):null;return f&&g&&!y})}function w0(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function Gh(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(n){return n==="Files"||n==="application/x-moz-file"}):!!e.target&&!!e.target.files}function eN(e){e.preventDefault()}function FA(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function LA(e){return e.indexOf("Edge/")!==-1}function PA(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return FA(e)||LA(e)}function us(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return function(r){for(var s=arguments.length,l=new Array(s>1?s-1:0),o=1;o<s;o++)l[o-1]=arguments[o];return n.some(function(d){return!w0(r)&&d&&d.apply(void 0,[r].concat(l)),w0(r)})}}function IA(){return"showOpenFilePicker"in window}function OA(e){if(Ol(e)){var n=Object.entries(e).filter(function(a){var r=Xd(a,2),s=r[0],l=r[1],o=!0;return fw(s)||(console.warn('Skipped "'.concat(s,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),o=!1),(!Array.isArray(l)||!l.every(pw))&&(console.warn('Skipped "'.concat(s,'" because an invalid file extension was provided.')),o=!1),o}).reduce(function(a,r){var s=Xd(r,2),l=s[0],o=s[1];return Yb(Yb({},a),{},uw({},l,o))},{});return[{description:"Files",accept:n}]}return e}function MA(e){if(Ol(e))return Object.entries(e).reduce(function(n,a){var r=Xd(a,2),s=r[0],l=r[1];return[].concat(Xb(n),[s],Xb(l))},[]).filter(function(n){return fw(n)||pw(n)}).join(",")}function RA(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function BA(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function fw(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||e==="application/*"||/\w+\/[-+.\w]+/g.test(e)}function pw(e){return/^.*\.[\w]+$/.test(e)}var HA=["children"],VA=["open"],UA=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],KA=["refKey","onChange","onClick"];function zA(e){return qA(e)||GA(e)||gw(e)||$A()}function $A(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GA(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function qA(e){if(Array.isArray(e))return vp(e)}function bf(e,n){return QA(e)||XA(e,n)||gw(e,n)||WA()}function WA(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gw(e,n){if(e){if(typeof e=="string")return vp(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return vp(e,n)}}function vp(e,n){(n==null||n>e.length)&&(n=e.length);for(var a=0,r=new Array(n);a<n;a++)r[a]=e[a];return r}function XA(e,n){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var r=[],s=!0,l=!1,o,d;try{for(a=a.call(e);!(s=(o=a.next()).done)&&(r.push(o.value),!(n&&r.length===n));s=!0);}catch(u){l=!0,d=u}finally{try{!s&&a.return!=null&&a.return()}finally{if(l)throw d}}return r}}function QA(e){if(Array.isArray(e))return e}function tN(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),a.push.apply(a,r)}return a}function gn(e){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?tN(Object(a),!0).forEach(function(r){bp(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):tN(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function bp(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function k0(e,n){if(e==null)return{};var a=YA(e,n),r,s;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(s=0;s<l.length;s++)r=l[s],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function YA(e,n){if(e==null)return{};var a={},r=Object.keys(e),s,l;for(l=0;l<r.length;l++)s=r[l],!(n.indexOf(s)>=0)&&(a[s]=e[s]);return a}var xg=E.forwardRef(function(e,n){var a=e.children,r=k0(e,HA),s=mg(r),l=s.open,o=k0(s,VA);return E.useImperativeHandle(n,function(){return{open:l}},[l]),S2.createElement(E.Fragment,null,a(gn(gn({},o),{},{open:l})))});xg.displayName="Dropzone";var yw={disabled:!1,getFilesFromEvent:lA,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};xg.defaultProps=yw;xg.propTypes={children:Jt.func,accept:Jt.objectOf(Jt.arrayOf(Jt.string)),multiple:Jt.bool,preventDropOnDocument:Jt.bool,noClick:Jt.bool,noKeyboard:Jt.bool,noDrag:Jt.bool,noDragEventsBubbling:Jt.bool,minSize:Jt.number,maxSize:Jt.number,maxFiles:Jt.number,disabled:Jt.bool,getFilesFromEvent:Jt.func,onFileDialogCancel:Jt.func,onFileDialogOpen:Jt.func,useFsAccessApi:Jt.bool,autoFocus:Jt.bool,onDragEnter:Jt.func,onDragLeave:Jt.func,onDragOver:Jt.func,onDrop:Jt.func,onDropAccepted:Jt.func,onDropRejected:Jt.func,onError:Jt.func,validator:Jt.func};var Np={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function mg(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=gn(gn({},yw),e),a=n.accept,r=n.disabled,s=n.getFilesFromEvent,l=n.maxSize,o=n.minSize,d=n.multiple,u=n.maxFiles,x=n.onDragEnter,m=n.onDragLeave,f=n.onDragOver,p=n.onDrop,b=n.onDropAccepted,g=n.onDropRejected,y=n.onFileDialogCancel,N=n.onFileDialogOpen,k=n.useFsAccessApi,T=n.autoFocus,S=n.preventDropOnDocument,w=n.noClick,_=n.noKeyboard,L=n.noDrag,C=n.noDragEventsBubbling,P=n.onError,F=n.validator,H=E.useMemo(function(){return MA(a)},[a]),O=E.useMemo(function(){return OA(a)},[a]),B=E.useMemo(function(){return typeof N=="function"?N:nN},[N]),W=E.useMemo(function(){return typeof y=="function"?y:nN},[y]),ee=E.useRef(null),q=E.useRef(null),fe=E.useReducer(JA,Np),ne=bf(fe,2),Y=ne[0],X=ne[1],xe=Y.isFocused,K=Y.isFileDialogActive,A=E.useRef(typeof window<"u"&&window.isSecureContext&&k&&IA()),M=function(){!A.current&&K&&setTimeout(function(){if(q.current){var Xe=q.current.files;Xe.length||(X({type:"closeDialog"}),W())}},300)};E.useEffect(function(){return window.addEventListener("focus",M,!1),function(){window.removeEventListener("focus",M,!1)}},[q,K,W,A]);var I=E.useRef([]),V=function(Xe){ee.current&&ee.current.contains(Xe.target)||(Xe.preventDefault(),I.current=[])};E.useEffect(function(){return S&&(document.addEventListener("dragover",eN,!1),document.addEventListener("drop",V,!1)),function(){S&&(document.removeEventListener("dragover",eN),document.removeEventListener("drop",V))}},[ee,S]),E.useEffect(function(){return!r&&T&&ee.current&&ee.current.focus(),function(){}},[ee,T,r]);var J=E.useCallback(function(Be){P?P(Be):console.error(Be)},[P]),ge=E.useCallback(function(Be){Be.preventDefault(),Be.persist(),rn(Be),I.current=[].concat(zA(I.current),[Be.target]),Gh(Be)&&Promise.resolve(s(Be)).then(function(Xe){if(!(w0(Be)&&!C)){var Lt=Xe.length,Wt=Lt>0&&AA({files:Xe,accept:H,minSize:o,maxSize:l,multiple:d,maxFiles:u,validator:F}),Ct=Lt>0&&!Wt;X({isDragAccept:Wt,isDragReject:Ct,isDragActive:!0,type:"setDraggedFiles"}),x&&x(Be)}}).catch(function(Xe){return J(Xe)})},[s,x,J,C,H,o,l,d,u,F]),z=E.useCallback(function(Be){Be.preventDefault(),Be.persist(),rn(Be);var Xe=Gh(Be);if(Xe&&Be.dataTransfer)try{Be.dataTransfer.dropEffect="copy"}catch{}return Xe&&f&&f(Be),!1},[f,C]),le=E.useCallback(function(Be){Be.preventDefault(),Be.persist(),rn(Be);var Xe=I.current.filter(function(Wt){return ee.current&&ee.current.contains(Wt)}),Lt=Xe.indexOf(Be.target);Lt!==-1&&Xe.splice(Lt,1),I.current=Xe,!(Xe.length>0)&&(X({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),Gh(Be)&&m&&m(Be))},[ee,m,C]),ue=E.useCallback(function(Be,Xe){var Lt=[],Wt=[];Be.forEach(function(Ct){var Rn=xw(Ct,H),ot=bf(Rn,2),Mt=ot[0],qn=ot[1],en=mw(Ct,o,l),_a=bf(en,2),hi=_a[0],As=_a[1],Fs=F?F(Ct):null;if(Mt&&hi&&!Fs)Lt.push(Ct);else{var rs=[qn,As];Fs&&(rs=rs.concat(Fs)),Wt.push({file:Ct,errors:rs.filter(function(xi){return xi})})}}),(!d&&Lt.length>1||d&&u>=1&&Lt.length>u)&&(Lt.forEach(function(Ct){Wt.push({file:Ct,errors:[DA]})}),Lt.splice(0)),X({acceptedFiles:Lt,fileRejections:Wt,isDragReject:Wt.length>0,type:"setFiles"}),p&&p(Lt,Wt,Xe),Wt.length>0&&g&&g(Wt,Xe),Lt.length>0&&b&&b(Lt,Xe)},[X,d,H,o,l,u,p,b,g,F]),ce=E.useCallback(function(Be){Be.preventDefault(),Be.persist(),rn(Be),I.current=[],Gh(Be)&&Promise.resolve(s(Be)).then(function(Xe){w0(Be)&&!C||ue(Xe,Be)}).catch(function(Xe){return J(Xe)}),X({type:"reset"})},[s,ue,J,C]),R=E.useCallback(function(){if(A.current){X({type:"openDialog"}),B();var Be={multiple:d,types:O};window.showOpenFilePicker(Be).then(function(Xe){return s(Xe)}).then(function(Xe){ue(Xe,null),X({type:"closeDialog"})}).catch(function(Xe){RA(Xe)?(W(Xe),X({type:"closeDialog"})):BA(Xe)?(A.current=!1,q.current?(q.current.value=null,q.current.click()):J(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):J(Xe)});return}q.current&&(X({type:"openDialog"}),B(),q.current.value=null,q.current.click())},[X,B,W,k,ue,J,O,d]),pe=E.useCallback(function(Be){!ee.current||!ee.current.isEqualNode(Be.target)||(Be.key===" "||Be.key==="Enter"||Be.keyCode===32||Be.keyCode===13)&&(Be.preventDefault(),R())},[ee,R]),Oe=E.useCallback(function(){X({type:"focus"})},[]),tt=E.useCallback(function(){X({type:"blur"})},[]),Ye=E.useCallback(function(){w||(PA()?setTimeout(R,0):R())},[w,R]),Re=function(Xe){return r?null:Xe},Ot=function(Xe){return _?null:Re(Xe)},Ht=function(Xe){return L?null:Re(Xe)},rn=function(Xe){C&&Xe.stopPropagation()},Fn=E.useMemo(function(){return function(){var Be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Xe=Be.refKey,Lt=Xe===void 0?"ref":Xe,Wt=Be.role,Ct=Be.onKeyDown,Rn=Be.onFocus,ot=Be.onBlur,Mt=Be.onClick,qn=Be.onDragEnter,en=Be.onDragOver,_a=Be.onDragLeave,hi=Be.onDrop,As=k0(Be,UA);return gn(gn(bp({onKeyDown:Ot(us(Ct,pe)),onFocus:Ot(us(Rn,Oe)),onBlur:Ot(us(ot,tt)),onClick:Re(us(Mt,Ye)),onDragEnter:Ht(us(qn,ge)),onDragOver:Ht(us(en,z)),onDragLeave:Ht(us(_a,le)),onDrop:Ht(us(hi,ce)),role:typeof Wt=="string"&&Wt!==""?Wt:"presentation"},Lt,ee),!r&&!_?{tabIndex:0}:{}),As)}},[ee,pe,Oe,tt,Ye,ge,z,le,ce,_,L,r]),Ha=E.useCallback(function(Be){Be.stopPropagation()},[]),Sa=E.useMemo(function(){return function(){var Be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Xe=Be.refKey,Lt=Xe===void 0?"ref":Xe,Wt=Be.onChange,Ct=Be.onClick,Rn=k0(Be,KA),ot=bp({accept:H,multiple:d,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:Re(us(Wt,ce)),onClick:Re(us(Ct,Ha)),tabIndex:-1},Lt,q);return gn(gn({},ot),Rn)}},[q,a,d,ce,r]);return gn(gn({},Y),{},{isFocused:xe&&!r,getRootProps:Fn,getInputProps:Sa,rootRef:ee,inputRef:q,open:Re(R)})}function JA(e,n){switch(n.type){case"focus":return gn(gn({},e),{},{isFocused:!0});case"blur":return gn(gn({},e),{},{isFocused:!1});case"openDialog":return gn(gn({},Np),{},{isFileDialogActive:!0});case"closeDialog":return gn(gn({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return gn(gn({},e),{},{isDragActive:n.isDragActive,isDragAccept:n.isDragAccept,isDragReject:n.isDragReject});case"setFiles":return gn(gn({},e),{},{acceptedFiles:n.acceptedFiles,fileRejections:n.fileRejections,isDragReject:n.isDragReject});case"reset":return gn({},Np);default:return e}}function nN(){}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var T0={};T0.version="0.18.5";var vw=1252,ZA=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],fg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},pg=function(e){ZA.indexOf(e)!=-1&&(vw=fg[0]=e)};function eF(){pg(1252)}var Jr=function(e){pg(e)};function gg(){Jr(1200),eF()}function aN(e){for(var n=[],a=0,r=e.length;a<r;++a)n[a]=e.charCodeAt(a);return n}function tF(e){for(var n=[],a=0;a<e.length>>1;++a)n[a]=String.fromCharCode(e.charCodeAt(2*a)+(e.charCodeAt(2*a+1)<<8));return n.join("")}function bw(e){for(var n=[],a=0;a<e.length>>1;++a)n[a]=String.fromCharCode(e.charCodeAt(2*a+1)+(e.charCodeAt(2*a)<<8));return n.join("")}var Ad=function(e){var n=e.charCodeAt(0),a=e.charCodeAt(1);return n==255&&a==254?tF(e.slice(2)):n==254&&a==255?bw(e.slice(2)):n==65279?e.slice(1):e},qh=function(n){return String.fromCharCode(n)},rN=function(n){return String.fromCharCode(n)},Qd,Xi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Yd(e){for(var n="",a=0,r=0,s=0,l=0,o=0,d=0,u=0,x=0;x<e.length;)a=e.charCodeAt(x++),l=a>>2,r=e.charCodeAt(x++),o=(a&3)<<4|r>>4,s=e.charCodeAt(x++),d=(r&15)<<2|s>>6,u=s&63,isNaN(r)?d=u=64:isNaN(s)&&(u=64),n+=Xi.charAt(l)+Xi.charAt(o)+Xi.charAt(d)+Xi.charAt(u);return n}function xr(e){var n="",a=0,r=0,s=0,l=0,o=0,d=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var x=0;x<e.length;)l=Xi.indexOf(e.charAt(x++)),o=Xi.indexOf(e.charAt(x++)),a=l<<2|o>>4,n+=String.fromCharCode(a),d=Xi.indexOf(e.charAt(x++)),r=(o&15)<<4|d>>2,d!==64&&(n+=String.fromCharCode(r)),u=Xi.indexOf(e.charAt(x++)),s=(d&3)<<6|u,u!==64&&(n+=String.fromCharCode(s));return n}var bt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ci=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(n,a){return a?new Buffer(n,a):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}})();function rl(e){return bt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function sN(e){return bt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var dr=function(n){return bt?ci(n,"binary"):n.split("").map(function(a){return a.charCodeAt(0)&255})};function nx(e){if(typeof ArrayBuffer>"u")return dr(e);for(var n=new ArrayBuffer(e.length),a=new Uint8Array(n),r=0;r!=e.length;++r)a[r]=e.charCodeAt(r)&255;return n}function ul(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var n=[],a=0;a<e.length;++a)n[a]=String.fromCharCode(e[a]);return n.join("")}function nF(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function yg(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return yg(new Uint8Array(e));for(var n=new Array(e.length),a=0;a<e.length;++a)n[a]=e[a];return n}var ta=bt?function(e){return Buffer.concat(e.map(function(n){return Buffer.isBuffer(n)?n:ci(n)}))}:function(e){if(typeof Uint8Array<"u"){var n=0,a=0;for(n=0;n<e.length;++n)a+=e[n].length;var r=new Uint8Array(a),s=0;for(n=0,a=0;n<e.length;a+=s,++n)if(s=e[n].length,e[n]instanceof Uint8Array)r.set(e[n],a);else{if(typeof e[n]=="string")throw"wtf";r.set(new Uint8Array(e[n]),a)}return r}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function aF(e){for(var n=[],a=0,r=e.length+250,s=rl(e.length+255),l=0;l<e.length;++l){var o=e.charCodeAt(l);if(o<128)s[a++]=o;else if(o<2048)s[a++]=192|o>>6&31,s[a++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var d=e.charCodeAt(++l)&1023;s[a++]=240|o>>8&7,s[a++]=128|o>>2&63,s[a++]=128|d>>6&15|(o&3)<<4,s[a++]=128|d&63}else s[a++]=224|o>>12&15,s[a++]=128|o>>6&63,s[a++]=128|o&63;a>r&&(n.push(s.slice(0,a)),a=0,s=rl(65535),r=65530)}return n.push(s.slice(0,a)),ta(n)}var Ra=/\u0000/g,Fd=/[\u0001-\u0006]/g;function sc(e){for(var n="",a=e.length-1;a>=0;)n+=e.charAt(a--);return n}function Zr(e,n){var a=""+e;return a.length>=n?a:jn("0",n-a.length)+a}function vg(e,n){var a=""+e;return a.length>=n?a:jn(" ",n-a.length)+a}function C0(e,n){var a=""+e;return a.length>=n?a:a+jn(" ",n-a.length)}function rF(e,n){var a=""+Math.round(e);return a.length>=n?a:jn("0",n-a.length)+a}function sF(e,n){var a=""+e;return a.length>=n?a:jn("0",n-a.length)+a}var iN=Math.pow(2,32);function Jo(e,n){if(e>iN||e<-iN)return rF(e,n);var a=Math.round(e);return sF(a,n)}function S0(e,n){return n=n||0,e.length>=7+n&&(e.charCodeAt(n)|32)===103&&(e.charCodeAt(n+1)|32)===101&&(e.charCodeAt(n+2)|32)===110&&(e.charCodeAt(n+3)|32)===101&&(e.charCodeAt(n+4)|32)===114&&(e.charCodeAt(n+5)|32)===97&&(e.charCodeAt(n+6)|32)===108}var lN=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Nf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function iF(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ct={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},oN={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},lF={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function _0(e,n,a){for(var r=e<0?-1:1,s=e*r,l=0,o=1,d=0,u=1,x=0,m=0,f=Math.floor(s);x<n&&(f=Math.floor(s),d=f*o+l,m=f*x+u,!(s-f<5e-8));)s=1/(s-f),l=o,o=d,u=x,x=m;if(m>n&&(x>n?(m=u,d=l):(m=x,d=o)),!a)return[0,r*d,m];var p=Math.floor(r*d/m);return[p,r*d-p*m,m]}function Hl(e,n,a){if(e>2958465||e<0)return null;var r=e|0,s=Math.floor(86400*(e-r)),l=0,o=[],d={D:r,T:s,u:86400*(e-r)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),n&&n.date1904&&(r+=1462),d.u>.9999&&(d.u=0,++s==86400&&(d.T=s=0,++r,++d.D)),r===60)o=a?[1317,10,29]:[1900,2,29],l=3;else if(r===0)o=a?[1317,8,29]:[1900,1,0],l=6;else{r>60&&--r;var u=new Date(1900,0,1);u.setDate(u.getDate()+r-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],l=u.getDay(),r<60&&(l=(l+6)%7),a&&(l=xF(u,o))}return d.y=o[0],d.m=o[1],d.d=o[2],d.S=s%60,s=Math.floor(s/60),d.M=s%60,s=Math.floor(s/60),d.H=s,d.q=l,d}var Nw=new Date(1899,11,31,0,0,0),oF=Nw.getTime(),cF=new Date(1900,2,1,0,0,0);function jw(e,n){var a=e.getTime();return n?a-=1461*24*60*60*1e3:e>=cF&&(a+=1440*60*1e3),(a-(oF+(e.getTimezoneOffset()-Nw.getTimezoneOffset())*6e4))/(1440*60*1e3)}function bg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function dF(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function uF(e){var n=e<0?12:11,a=bg(e.toFixed(12));return a.length<=n||(a=e.toPrecision(10),a.length<=n)?a:e.toExponential(5)}function hF(e){var n=bg(e.toFixed(11));return n.length>(e<0?12:11)||n==="0"||n==="-0"?e.toPrecision(6):n}function Jd(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),a;return n>=-4&&n<=-1?a=e.toPrecision(10+n):Math.abs(n)<=9?a=uF(e):n===10?a=e.toFixed(10).substr(0,12):a=hF(e),bg(dF(a.toUpperCase()))}function io(e,n){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Jd(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Br(14,jw(e,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+e)}function xF(e,n){n[0]-=581;var a=e.getDay();return e<60&&(a=(a+6)%7),a}function mF(e,n,a,r){var s="",l=0,o=0,d=a.y,u,x=0;switch(e){case 98:d=a.y+543;case 121:switch(n.length){case 1:case 2:u=d%100,x=2;break;default:u=d%1e4,x=4;break}break;case 109:switch(n.length){case 1:case 2:u=a.m,x=n.length;break;case 3:return Nf[a.m-1][1];case 5:return Nf[a.m-1][0];default:return Nf[a.m-1][2]}break;case 100:switch(n.length){case 1:case 2:u=a.d,x=n.length;break;case 3:return lN[a.q][0];default:return lN[a.q][1]}break;case 104:switch(n.length){case 1:case 2:u=1+(a.H+11)%12,x=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:u=a.H,x=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:u=a.M,x=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return a.u===0&&(n=="s"||n=="ss")?Zr(a.S,n.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,l=Math.round(o*(a.S+a.u)),l>=60*o&&(l=0),n==="s"?l===0?"0":""+l/o:(s=Zr(l,2+r),n==="ss"?s.substr(0,2):"."+s.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":u=a.D*24+a.H;break;case"[m]":case"[mm]":u=(a.D*24+a.H)*60+a.M;break;case"[s]":case"[ss]":u=((a.D*24+a.H)*60+a.M)*60+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+n}x=n.length===3?1:2;break;case 101:u=d,x=1;break}var m=x>0?Zr(u,x):"";return m}function Qi(e){var n=3;if(e.length<=n)return e;for(var a=e.length%n,r=e.substr(0,a);a!=e.length;a+=n)r+=(r.length>0?",":"")+e.substr(a,n);return r}var ww=/%/g;function fF(e,n,a){var r=n.replace(ww,""),s=n.length-r.length;return ti(e,r,a*Math.pow(10,2*s))+jn("%",s)}function pF(e,n,a){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return ti(e,n.substr(0,r),a/Math.pow(10,3*(n.length-r)))}function kw(e,n){var a,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+kw(e,-n);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(n)*Math.LOG10E)%s;if(l<0&&(l+=s),a=(n/Math.pow(10,l)).toPrecision(r+1+(s+l)%s),a.indexOf("e")===-1){var o=Math.floor(Math.log(n)*Math.LOG10E);for(a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(o-a.length+l):a+="E+"+(o-l);a.substr(0,2)==="0.";)a=a.charAt(0)+a.substr(2,s)+"."+a.substr(2+s),a=a.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,u,x,m){return u+x+m.substr(0,(s+l)%s)+"."+m.substr(l)+"E"})}else a=n.toExponential(r);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var Tw=/# (\?+)( ?)\/( ?)(\d+)/;function gF(e,n,a){var r=parseInt(e[4],10),s=Math.round(n*r),l=Math.floor(s/r),o=s-l*r,d=r;return a+(l===0?"":""+l)+" "+(o===0?jn(" ",e[1].length+1+e[4].length):vg(o,e[1].length)+e[2]+"/"+e[3]+Zr(d,e[4].length))}function yF(e,n,a){return a+(n===0?"":""+n)+jn(" ",e[1].length+2+e[4].length)}var Cw=/^#*0*\.([0#]+)/,Sw=/\).*[0#]/,_w=/\(###\) ###\\?-####/;function Pa(e){for(var n="",a,r=0;r!=e.length;++r)switch(a=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(a)}return n}function cN(e,n){var a=Math.pow(10,n);return""+Math.round(e*a)/a}function dN(e,n){var a=e-Math.floor(e),r=Math.pow(10,n);return n<(""+Math.round(a*r)).length?0:Math.round(a*r)}function vF(e,n){return n<(""+Math.round((e-Math.floor(e))*Math.pow(10,n))).length?1:0}function bF(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function wr(e,n,a){if(e.charCodeAt(0)===40&&!n.match(Sw)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?wr("n",r,a):"("+wr("n",r,-a)+")"}if(n.charCodeAt(n.length-1)===44)return pF(e,n,a);if(n.indexOf("%")!==-1)return fF(e,n,a);if(n.indexOf("E")!==-1)return kw(n,a);if(n.charCodeAt(0)===36)return"$"+wr(e,n.substr(n.charAt(1)==" "?2:1),a);var s,l,o,d,u=Math.abs(a),x=a<0?"-":"";if(n.match(/^00+$/))return x+Jo(u,n.length);if(n.match(/^[#?]+$/))return s=Jo(a,0),s==="0"&&(s=""),s.length>n.length?s:Pa(n.substr(0,n.length-s.length))+s;if(l=n.match(Tw))return gF(l,u,x);if(n.match(/^#+0+$/))return x+Jo(u,n.length-n.indexOf("0"));if(l=n.match(Cw))return s=cN(a,l[1].length).replace(/^([^\.]+)$/,"$1."+Pa(l[1])).replace(/\.$/,"."+Pa(l[1])).replace(/\.(\d*)$/,function(g,y){return"."+y+jn("0",Pa(l[1]).length-y.length)}),n.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),l=n.match(/^(0*)\.(#*)$/))return x+cN(u,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=n.match(/^#{1,3},##0(\.?)$/))return x+Qi(Jo(u,0));if(l=n.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+wr(e,n,-a):Qi(""+(Math.floor(a)+vF(a,l[1].length)))+"."+Zr(dN(a,l[1].length),l[1].length);if(l=n.match(/^#,#*,#0/))return wr(e,n.replace(/^#,#*,/,""),a);if(l=n.match(/^([0#]+)(\\?-([0#]+))+$/))return s=sc(wr(e,n.replace(/[\\-]/g,""),a)),o=0,sc(sc(n.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<s.length?s.charAt(o++):g==="0"?"0":""}));if(n.match(_w))return s=wr(e,"##########",a),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var m="";if(l=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),d=_0(u,Math.pow(10,o)-1,!1),s=""+x,m=ti("n",l[1],d[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),s+=m+l[2]+"/"+l[3],m=C0(d[2],o),m.length<l[4].length&&(m=Pa(l[4].substr(l[4].length-m.length))+m),s+=m,s;if(l=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),d=_0(u,Math.pow(10,o)-1,!0),x+(d[0]||(d[1]?"":"0"))+" "+(d[1]?vg(d[1],o)+l[2]+"/"+l[3]+C0(d[2],o):jn(" ",2*o+1+l[2].length+l[3].length));if(l=n.match(/^[#0?]+$/))return s=Jo(a,0),n.length<=s.length?s:Pa(n.substr(0,n.length-s.length))+s;if(l=n.match(/^([#0?]+)\.([#0]+)$/)){s=""+a.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=n.indexOf(".")-o,p=n.length-s.length-f;return Pa(n.substr(0,f)+s+n.substr(n.length-p))}if(l=n.match(/^00,000\.([#0]*0)$/))return o=dN(a,l[1].length),a<0?"-"+wr(e,n,-a):Qi(bF(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Zr(0,3-g.length):"")+g})+"."+Zr(o,l[1].length);switch(n){case"###,##0.00":return wr(e,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var b=Qi(Jo(u,0));return b!=="0"?x+b:"";case"###,###.00":return wr(e,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return wr(e,"#,##0.00",a).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function NF(e,n,a){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return ti(e,n.substr(0,r),a/Math.pow(10,3*(n.length-r)))}function jF(e,n,a){var r=n.replace(ww,""),s=n.length-r.length;return ti(e,r,a*Math.pow(10,2*s))+jn("%",s)}function Ew(e,n){var a,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Ew(e,-n);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(n)*Math.LOG10E)%s;if(l<0&&(l+=s),a=(n/Math.pow(10,l)).toPrecision(r+1+(s+l)%s),!a.match(/[Ee]/)){var o=Math.floor(Math.log(n)*Math.LOG10E);a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(o-a.length+l):a+="E+"+(o-l),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,u,x,m){return u+x+m.substr(0,(s+l)%s)+"."+m.substr(l)+"E"})}else a=n.toExponential(r);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function xs(e,n,a){if(e.charCodeAt(0)===40&&!n.match(Sw)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?xs("n",r,a):"("+xs("n",r,-a)+")"}if(n.charCodeAt(n.length-1)===44)return NF(e,n,a);if(n.indexOf("%")!==-1)return jF(e,n,a);if(n.indexOf("E")!==-1)return Ew(n,a);if(n.charCodeAt(0)===36)return"$"+xs(e,n.substr(n.charAt(1)==" "?2:1),a);var s,l,o,d,u=Math.abs(a),x=a<0?"-":"";if(n.match(/^00+$/))return x+Zr(u,n.length);if(n.match(/^[#?]+$/))return s=""+a,a===0&&(s=""),s.length>n.length?s:Pa(n.substr(0,n.length-s.length))+s;if(l=n.match(Tw))return yF(l,u,x);if(n.match(/^#+0+$/))return x+Zr(u,n.length-n.indexOf("0"));if(l=n.match(Cw))return s=(""+a).replace(/^([^\.]+)$/,"$1."+Pa(l[1])).replace(/\.$/,"."+Pa(l[1])),s=s.replace(/\.(\d*)$/,function(g,y){return"."+y+jn("0",Pa(l[1]).length-y.length)}),n.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),l=n.match(/^(0*)\.(#*)$/))return x+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=n.match(/^#{1,3},##0(\.?)$/))return x+Qi(""+u);if(l=n.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+xs(e,n,-a):Qi(""+a)+"."+jn("0",l[1].length);if(l=n.match(/^#,#*,#0/))return xs(e,n.replace(/^#,#*,/,""),a);if(l=n.match(/^([0#]+)(\\?-([0#]+))+$/))return s=sc(xs(e,n.replace(/[\\-]/g,""),a)),o=0,sc(sc(n.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<s.length?s.charAt(o++):g==="0"?"0":""}));if(n.match(_w))return s=xs(e,"##########",a),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var m="";if(l=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),d=_0(u,Math.pow(10,o)-1,!1),s=""+x,m=ti("n",l[1],d[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),s+=m+l[2]+"/"+l[3],m=C0(d[2],o),m.length<l[4].length&&(m=Pa(l[4].substr(l[4].length-m.length))+m),s+=m,s;if(l=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),d=_0(u,Math.pow(10,o)-1,!0),x+(d[0]||(d[1]?"":"0"))+" "+(d[1]?vg(d[1],o)+l[2]+"/"+l[3]+C0(d[2],o):jn(" ",2*o+1+l[2].length+l[3].length));if(l=n.match(/^[#0?]+$/))return s=""+a,n.length<=s.length?s:Pa(n.substr(0,n.length-s.length))+s;if(l=n.match(/^([#0]+)\.([#0]+)$/)){s=""+a.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=n.indexOf(".")-o,p=n.length-s.length-f;return Pa(n.substr(0,f)+s+n.substr(n.length-p))}if(l=n.match(/^00,000\.([#0]*0)$/))return a<0?"-"+xs(e,n,-a):Qi(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Zr(0,3-g.length):"")+g})+"."+Zr(0,l[1].length);switch(n){case"###,###":case"##,###":case"#,###":var b=Qi(""+u);return b!=="0"?x+b:"";default:if(n.match(/\.[0#?]*$/))return xs(e,n.slice(0,n.lastIndexOf(".")),a)+Pa(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function ti(e,n,a){return(a|0)===a?xs(e,n,a):wr(e,n,a)}function wF(e){for(var n=[],a=!1,r=0,s=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:a=!a;break;case 95:case 42:case 92:++r;break;case 59:n[n.length]=e.substr(s,r-s),s=r+1}if(n[n.length]=e.substr(s),a===!0)throw new Error("Format |"+e+"| unterminated string ");return n}var Dw=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Pc(e){for(var n=0,a="",r="";n<e.length;)switch(a=e.charAt(n)){case"G":S0(e,n)&&(n+=6),n++;break;case'"':for(;e.charCodeAt(++n)!==34&&n<e.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(e.charAt(n+1)==="1"||e.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(n,3).toUpperCase()==="A/P"||e.substr(n,5).toUpperCase()==="AM/PM"||e.substr(n,5).toUpperCase()==="/")return!0;++n;break;case"[":for(r=a;e.charAt(n++)!=="]"&&n<e.length;)r+=e.charAt(n);if(r.match(Dw))return!0;break;case".":case"0":case"#":for(;n<e.length&&("0#?.,E+-%".indexOf(a=e.charAt(++n))>-1||a=="\\"&&e.charAt(n+1)=="-"&&"0#".indexOf(e.charAt(n+2))>-1););break;case"?":for(;e.charAt(++n)===a;);break;case"*":++n,(e.charAt(n)==" "||e.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<e.length&&"0123456789".indexOf(e.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function kF(e,n,a,r){for(var s=[],l="",o=0,d="",u="t",x,m,f,p="H";o<e.length;)switch(d=e.charAt(o)){case"G":if(!S0(e,o))throw new Error("unrecognized character "+d+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(l="";(f=e.charCodeAt(++o))!==34&&o<e.length;)l+=String.fromCharCode(f);s[s.length]={t:"t",v:l},++o;break;case"\\":var b=e.charAt(++o),g=b==="("||b===")"?b:"t";s[s.length]={t:g,v:b},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:n},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(x==null&&(x=Hl(n,a,e.charAt(o+1)==="2"),x==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},u=d,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||x==null&&(x=Hl(n,a),x==null))return"";for(l=d;++o<e.length&&e.charAt(o).toLowerCase()===d;)l+=d;d==="m"&&u.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=p),s[s.length]={t:d,v:l},u=d;break;case"A":case"a":case"":var y={t:d,v:d};if(x==null&&(x=Hl(n,a)),e.substr(o,3).toUpperCase()==="A/P"?(x!=null&&(y.v=x.H>=12?"P":"A"),y.t="T",p="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(x!=null&&(y.v=x.H>=12?"PM":"AM"),y.t="T",o+=5,p="h"):e.substr(o,5).toUpperCase()==="/"?(x!=null&&(y.v=x.H>=12?"":""),y.t="T",o+=5,p="h"):(y.t="t",++o),x==null&&y.t==="T")return"";s[s.length]=y,u=d;break;case"[":for(l=d;e.charAt(o++)!=="]"&&o<e.length;)l+=e.charAt(o);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(Dw)){if(x==null&&(x=Hl(n,a),x==null))return"";s[s.length]={t:"Z",v:l.toLowerCase()},u=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Pc(e)||(s[s.length]={t:"t",v:l}));break;case".":if(x!=null){for(l=d;++o<e.length&&(d=e.charAt(o))==="0";)l+=d;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=d;++o<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(o))>-1;)l+=d;s[s.length]={t:"n",v:l};break;case"?":for(l=d;e.charAt(++o)===d;)l+=d;s[s.length]={t:d,v:l},u=d;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:r===1?"t":d,v:d},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=d;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)l+=e.charAt(o);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:d,v:d},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+e);s[s.length]={t:"t",v:d},++o;break}var N=0,k=0,T;for(o=s.length-1,u="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=p,u="h",N<1&&(N=1);break;case"s":(T=s[o].v.match(/\.0+$/))&&(k=Math.max(k,T[0].length-1)),N<3&&(N=3);case"d":case"y":case"M":case"e":u=s[o].t;break;case"m":u==="s"&&(s[o].t="M",N<2&&(N=2));break;case"X":break;case"Z":N<1&&s[o].v.match(/[Hh]/)&&(N=1),N<2&&s[o].v.match(/[Mm]/)&&(N=2),N<3&&s[o].v.match(/[Ss]/)&&(N=3)}switch(N){case 0:break;case 1:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M),x.M>=60&&(x.M=0,++x.H);break;case 2:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M);break}var S="",w;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=mF(s[o].t.charCodeAt(0),s[o].v,x,k),s[o].t="t";break;case"n":case"?":for(w=o+1;s[w]!=null&&((d=s[w].t)==="?"||d==="D"||(d===" "||d==="t")&&s[w+1]!=null&&(s[w+1].t==="?"||s[w+1].t==="t"&&s[w+1].v==="/")||s[o].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(s[w].v==="/"||s[w].v===" "&&s[w+1]!=null&&s[w+1].t=="?"));)s[o].v+=s[w].v,s[w]={v:"",t:";"},++w;S+=s[o].v,o=w-1;break;case"G":s[o].t="t",s[o].v=io(n,a);break}var _="",L,C;if(S.length>0){S.charCodeAt(0)==40?(L=n<0&&S.charCodeAt(0)===45?-n:n,C=ti("n",S,L)):(L=n<0&&r>1?-n:n,C=ti("n",S,L),L<0&&s[0]&&s[0].t=="t"&&(C=C.substr(1),s[0].v="-"+s[0].v)),w=C.length-1;var P=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){P=o;break}var F=s.length;if(P===s.length&&C.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(w>=s[o].v.length-1?(w-=s[o].v.length,s[o].v=C.substr(w+1,s[o].v.length)):w<0?s[o].v="":(s[o].v=C.substr(0,w+1),w=-1),s[o].t="t",F=o);w>=0&&F<s.length&&(s[F].v=C.substr(0,w+1)+s[F].v)}else if(P!==s.length&&C.indexOf("E")===-1){for(w=C.indexOf(".")-1,o=P;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(m=s[o].v.indexOf(".")>-1&&o===P?s[o].v.indexOf(".")-1:s[o].v.length-1,_=s[o].v.substr(m+1);m>=0;--m)w>=0&&(s[o].v.charAt(m)==="0"||s[o].v.charAt(m)==="#")&&(_=C.charAt(w--)+_);s[o].v=_,s[o].t="t",F=o}for(w>=0&&F<s.length&&(s[F].v=C.substr(0,w+1)+s[F].v),w=C.indexOf(".")+1,o=P;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==P)){for(m=s[o].v.indexOf(".")>-1&&o===P?s[o].v.indexOf(".")+1:0,_=s[o].v.substr(0,m);m<s[o].v.length;++m)w<C.length&&(_+=C.charAt(w++));s[o].v=_,s[o].t="t",F=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(L=r>1&&n<0&&o>0&&s[o-1].v==="-"?-n:n,s[o].v=ti(s[o].t,s[o].v,L),s[o].t="t");var H="";for(o=0;o!==s.length;++o)s[o]!=null&&(H+=s[o].v);return H}var uN=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function hN(e,n){if(n==null)return!1;var a=parseFloat(n[2]);switch(n[1]){case"=":if(e==a)return!0;break;case">":if(e>a)return!0;break;case"<":if(e<a)return!0;break;case"<>":if(e!=a)return!0;break;case">=":if(e>=a)return!0;break;case"<=":if(e<=a)return!0;break}return!1}function TF(e,n){var a=wF(e),r=a.length,s=a[r-1].indexOf("@");if(r<4&&s>-1&&--r,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if(typeof n!="number")return[4,a.length===4||s>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=s>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=s>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=s>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"];break}var l=n>0?a[0]:n<0?a[1]:a[2];if(a[0].indexOf("[")===-1&&a[1].indexOf("[")===-1)return[r,l];if(a[0].match(/\[[=<>]/)!=null||a[1].match(/\[[=<>]/)!=null){var o=a[0].match(uN),d=a[1].match(uN);return hN(n,o)?[r,a[0]]:hN(n,d)?[r,a[1]]:[r,a[o!=null&&d!=null?2:1]]}return[r,l]}function Br(e,n,a){a==null&&(a={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&a.dateNF?r=a.dateNF:r=e;break;case"number":e==14&&a.dateNF?r=a.dateNF:r=(a.table!=null?a.table:ct)[e],r==null&&(r=a.table&&a.table[oN[e]]||ct[oN[e]]),r==null&&(r=lF[e]||"General");break}if(S0(r,0))return io(n,a);n instanceof Date&&(n=jw(n,a.date1904));var s=TF(r,n);if(S0(s[1]))return io(n,a);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return kF(s[1],n,a,s[0])}function ni(e,n){if(typeof n!="number"){n=+n||-1;for(var a=0;a<392;++a){if(ct[a]==null){n<0&&(n=a);continue}if(ct[a]==e){n=a;break}}n<0&&(n=391)}return ct[n]=e,n}function ax(e){for(var n=0;n!=392;++n)e[n]!==void 0&&ni(e[n],n)}function Ic(){ct=iF()}var CF={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Aw=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function SF(e){var n=typeof e=="number"?ct[e]:e;return n=n.replace(Aw,"(\\d+)"),new RegExp("^"+n+"$")}function _F(e,n,a){var r=-1,s=-1,l=-1,o=-1,d=-1,u=-1;(n.match(Aw)||[]).forEach(function(f,p){var b=parseInt(a[p+1],10);switch(f.toLowerCase().charAt(0)){case"y":r=b;break;case"d":l=b;break;case"h":o=b;break;case"s":u=b;break;case"m":o>=0?d=b:s=b;break}}),u>=0&&d==-1&&s>=0&&(d=s,s=-1);var x=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);x.length==7&&(x="0"+x),x.length==8&&(x="20"+x);var m=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&d==-1&&u==-1?x:r==-1&&s==-1&&l==-1?m:x+"T"+m}var EF=(function(){var e={};e.version="1.2.0";function n(){for(var C=0,P=new Array(256),F=0;F!=256;++F)C=F,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,P[F]=C;return typeof Int32Array<"u"?new Int32Array(P):P}var a=n();function r(C){var P=0,F=0,H=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(H=0;H!=256;++H)O[H]=C[H];for(H=0;H!=256;++H)for(F=C[H],P=256+H;P<4096;P+=256)F=O[P]=F>>>8^C[F&255];var B=[];for(H=1;H!=16;++H)B[H-1]=typeof Int32Array<"u"?O.subarray(H*256,H*256+256):O.slice(H*256,H*256+256);return B}var s=r(a),l=s[0],o=s[1],d=s[2],u=s[3],x=s[4],m=s[5],f=s[6],p=s[7],b=s[8],g=s[9],y=s[10],N=s[11],k=s[12],T=s[13],S=s[14];function w(C,P){for(var F=P^-1,H=0,O=C.length;H<O;)F=F>>>8^a[(F^C.charCodeAt(H++))&255];return~F}function _(C,P){for(var F=P^-1,H=C.length-15,O=0;O<H;)F=S[C[O++]^F&255]^T[C[O++]^F>>8&255]^k[C[O++]^F>>16&255]^N[C[O++]^F>>>24]^y[C[O++]]^g[C[O++]]^b[C[O++]]^p[C[O++]]^f[C[O++]]^m[C[O++]]^x[C[O++]]^u[C[O++]]^d[C[O++]]^o[C[O++]]^l[C[O++]]^a[C[O++]];for(H+=15;O<H;)F=F>>>8^a[(F^C[O++])&255];return~F}function L(C,P){for(var F=P^-1,H=0,O=C.length,B=0,W=0;H<O;)B=C.charCodeAt(H++),B<128?F=F>>>8^a[(F^B)&255]:B<2048?(F=F>>>8^a[(F^(192|B>>6&31))&255],F=F>>>8^a[(F^(128|B&63))&255]):B>=55296&&B<57344?(B=(B&1023)+64,W=C.charCodeAt(H++)&1023,F=F>>>8^a[(F^(240|B>>8&7))&255],F=F>>>8^a[(F^(128|B>>2&63))&255],F=F>>>8^a[(F^(128|W>>6&15|(B&3)<<4))&255],F=F>>>8^a[(F^(128|W&63))&255]):(F=F>>>8^a[(F^(224|B>>12&15))&255],F=F>>>8^a[(F^(128|B>>6&63))&255],F=F>>>8^a[(F^(128|B&63))&255]);return~F}return e.table=a,e.bstr=w,e.buf=_,e.str=L,e})(),at=(function(){var n={};n.version="1.2.1";function a(G,te){for(var Q=G.split("/"),Z=te.split("/"),ae=0,re=0,Ne=Math.min(Q.length,Z.length);ae<Ne;++ae){if(re=Q[ae].length-Z[ae].length)return re;if(Q[ae]!=Z[ae])return Q[ae]<Z[ae]?-1:1}return Q.length-Z.length}function r(G){if(G.charAt(G.length-1)=="/")return G.slice(0,-1).indexOf("/")===-1?G:r(G.slice(0,-1));var te=G.lastIndexOf("/");return te===-1?G:G.slice(0,te+1)}function s(G){if(G.charAt(G.length-1)=="/")return s(G.slice(0,-1));var te=G.lastIndexOf("/");return te===-1?G:G.slice(te+1)}function l(G,te){typeof te=="string"&&(te=new Date(te));var Q=te.getHours();Q=Q<<6|te.getMinutes(),Q=Q<<5|te.getSeconds()>>>1,G.write_shift(2,Q);var Z=te.getFullYear()-1980;Z=Z<<4|te.getMonth()+1,Z=Z<<5|te.getDate(),G.write_shift(2,Z)}function o(G){var te=G.read_shift(2)&65535,Q=G.read_shift(2)&65535,Z=new Date,ae=Q&31;Q>>>=5;var re=Q&15;Q>>>=4,Z.setMilliseconds(0),Z.setFullYear(Q+1980),Z.setMonth(re-1),Z.setDate(ae);var Ne=te&31;te>>>=5;var Se=te&63;return te>>>=6,Z.setHours(te),Z.setMinutes(Se),Z.setSeconds(Ne<<1),Z}function d(G){oa(G,0);for(var te={},Q=0;G.l<=G.length-4;){var Z=G.read_shift(2),ae=G.read_shift(2),re=G.l+ae,Ne={};switch(Z){case 21589:Q=G.read_shift(1),Q&1&&(Ne.mtime=G.read_shift(4)),ae>5&&(Q&2&&(Ne.atime=G.read_shift(4)),Q&4&&(Ne.ctime=G.read_shift(4))),Ne.mtime&&(Ne.mt=new Date(Ne.mtime*1e3));break}G.l=re,te[Z]=Ne}return te}var u;function x(){return u||(u={})}function m(G,te){if(G[0]==80&&G[1]==75)return wo(G,te);if((G[0]|32)==109&&(G[1]|32)==105)return Pu(G,te);if(G.length<512)throw new Error("CFB file size "+G.length+" < 512");var Q=3,Z=512,ae=0,re=0,Ne=0,Se=0,be=0,je=[],we=G.slice(0,512);oa(we,0);var Le=f(we);switch(Q=Le[0],Q){case 3:Z=512;break;case 4:Z=4096;break;case 0:if(Le[1]==0)return wo(G,te);default:throw new Error("Major Version: Expected 3 or 4 saw "+Q)}Z!==512&&(we=G.slice(0,Z),oa(we,28));var ze=G.slice(0,Z);p(we,Q);var qe=we.read_shift(4,"i");if(Q===3&&qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qe);we.l+=4,Ne=we.read_shift(4,"i"),we.l+=4,we.chk("00100000","Mini Stream Cutoff Size: "),Se=we.read_shift(4,"i"),ae=we.read_shift(4,"i"),be=we.read_shift(4,"i"),re=we.read_shift(4,"i");for(var He=-1,Me=0;Me<109&&(He=we.read_shift(4,"i"),!(He<0));++Me)je[Me]=He;var xt=b(G,Z);N(be,re,xt,Z,je);var Yt=T(xt,Ne,je,Z);Yt[Ne].name="!Directory",ae>0&&Se!==W&&(Yt[Se].name="!MiniFAT"),Yt[je[0]].name="!FAT",Yt.fat_addrs=je,Yt.ssz=Z;var tn={},Tn=[],gl=[],pi=[];S(Ne,Yt,xt,Tn,ae,tn,gl,Se),g(gl,pi,Tn),Tn.shift();var ss={FileIndex:gl,FullPaths:pi};return te&&te.raw&&(ss.raw={header:ze,sectors:xt}),ss}function f(G){if(G[G.l]==80&&G[G.l+1]==75)return[0,0];G.chk(ee,"Header Signature: "),G.l+=16;var te=G.read_shift(2,"u");return[G.read_shift(2,"u"),te]}function p(G,te){var Q=9;switch(G.l+=2,Q=G.read_shift(2)){case 9:if(te!=3)throw new Error("Sector Shift: Expected 9 saw "+Q);break;case 12:if(te!=4)throw new Error("Sector Shift: Expected 12 saw "+Q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Q)}G.chk("0600","Mini Sector Shift: "),G.chk("000000000000","Reserved: ")}function b(G,te){for(var Q=Math.ceil(G.length/te)-1,Z=[],ae=1;ae<Q;++ae)Z[ae-1]=G.slice(ae*te,(ae+1)*te);return Z[Q-1]=G.slice(Q*te),Z}function g(G,te,Q){for(var Z=0,ae=0,re=0,Ne=0,Se=0,be=Q.length,je=[],we=[];Z<be;++Z)je[Z]=we[Z]=Z,te[Z]=Q[Z];for(;Se<we.length;++Se)Z=we[Se],ae=G[Z].L,re=G[Z].R,Ne=G[Z].C,je[Z]===Z&&(ae!==-1&&je[ae]!==ae&&(je[Z]=je[ae]),re!==-1&&je[re]!==re&&(je[Z]=je[re])),Ne!==-1&&(je[Ne]=Z),ae!==-1&&Z!=je[Z]&&(je[ae]=je[Z],we.lastIndexOf(ae)<Se&&we.push(ae)),re!==-1&&Z!=je[Z]&&(je[re]=je[Z],we.lastIndexOf(re)<Se&&we.push(re));for(Z=1;Z<be;++Z)je[Z]===Z&&(re!==-1&&je[re]!==re?je[Z]=je[re]:ae!==-1&&je[ae]!==ae&&(je[Z]=je[ae]));for(Z=1;Z<be;++Z)if(G[Z].type!==0){if(Se=Z,Se!=je[Se])do Se=je[Se],te[Z]=te[Se]+"/"+te[Z];while(Se!==0&&je[Se]!==-1&&Se!=je[Se]);je[Z]=-1}for(te[0]+="/",Z=1;Z<be;++Z)G[Z].type!==2&&(te[Z]+="/")}function y(G,te,Q){for(var Z=G.start,ae=G.size,re=[],Ne=Z;Q&&ae>0&&Ne>=0;)re.push(te.slice(Ne*B,Ne*B+B)),ae-=B,Ne=Ml(Q,Ne*4);return re.length===0?Ce(0):ta(re).slice(0,G.size)}function N(G,te,Q,Z,ae){var re=W;if(G===W){if(te!==0)throw new Error("DIFAT chain shorter than expected")}else if(G!==-1){var Ne=Q[G],Se=(Z>>>2)-1;if(!Ne)return;for(var be=0;be<Se&&(re=Ml(Ne,be*4))!==W;++be)ae.push(re);N(Ml(Ne,Z-4),te-1,Q,Z,ae)}}function k(G,te,Q,Z,ae){var re=[],Ne=[];ae||(ae=[]);var Se=Z-1,be=0,je=0;for(be=te;be>=0;){ae[be]=!0,re[re.length]=be,Ne.push(G[be]);var we=Q[Math.floor(be*4/Z)];if(je=be*4&Se,Z<4+je)throw new Error("FAT boundary crossed: "+be+" 4 "+Z);if(!G[we])break;be=Ml(G[we],je)}return{nodes:re,data:kN([Ne])}}function T(G,te,Q,Z){var ae=G.length,re=[],Ne=[],Se=[],be=[],je=Z-1,we=0,Le=0,ze=0,qe=0;for(we=0;we<ae;++we)if(Se=[],ze=we+te,ze>=ae&&(ze-=ae),!Ne[ze]){be=[];var He=[];for(Le=ze;Le>=0;){He[Le]=!0,Ne[Le]=!0,Se[Se.length]=Le,be.push(G[Le]);var Me=Q[Math.floor(Le*4/Z)];if(qe=Le*4&je,Z<4+qe)throw new Error("FAT boundary crossed: "+Le+" 4 "+Z);if(!G[Me]||(Le=Ml(G[Me],qe),He[Le]))break}re[ze]={nodes:Se,data:kN([be])}}return re}function S(G,te,Q,Z,ae,re,Ne,Se){for(var be=0,je=Z.length?2:0,we=te[G].data,Le=0,ze=0,qe;Le<we.length;Le+=128){var He=we.slice(Le,Le+128);oa(He,64),ze=He.read_shift(2),qe=Sg(He,0,ze-je),Z.push(qe);var Me={name:qe,type:He.read_shift(1),color:He.read_shift(1),L:He.read_shift(4,"i"),R:He.read_shift(4,"i"),C:He.read_shift(4,"i"),clsid:He.read_shift(16),state:He.read_shift(4,"i"),start:0,size:0},xt=He.read_shift(2)+He.read_shift(2)+He.read_shift(2)+He.read_shift(2);xt!==0&&(Me.ct=w(He,He.l-8));var Yt=He.read_shift(2)+He.read_shift(2)+He.read_shift(2)+He.read_shift(2);Yt!==0&&(Me.mt=w(He,He.l-8)),Me.start=He.read_shift(4,"i"),Me.size=He.read_shift(4,"i"),Me.size<0&&Me.start<0&&(Me.size=Me.type=0,Me.start=W,Me.name=""),Me.type===5?(be=Me.start,ae>0&&be!==W&&(te[be].name="!StreamData")):Me.size>=4096?(Me.storage="fat",te[Me.start]===void 0&&(te[Me.start]=k(Q,Me.start,te.fat_addrs,te.ssz)),te[Me.start].name=Me.name,Me.content=te[Me.start].data.slice(0,Me.size)):(Me.storage="minifat",Me.size<0?Me.size=0:be!==W&&Me.start!==W&&te[be]&&(Me.content=y(Me,te[be].data,(te[Se]||{}).data))),Me.content&&oa(Me.content,0),re[qe]=Me,Ne.push(Me)}}function w(G,te){return new Date((cr(G,te+4)/1e7*Math.pow(2,32)+cr(G,te)/1e7-11644473600)*1e3)}function _(G,te){return x(),m(u.readFileSync(G),te)}function L(G,te){var Q=te&&te.type;switch(Q||bt&&Buffer.isBuffer(G)&&(Q="buffer"),Q||"base64"){case"file":return _(G,te);case"base64":return m(dr(xr(G)),te);case"binary":return m(dr(G),te)}return m(G,te)}function C(G,te){var Q=te||{},Z=Q.root||"Root Entry";if(G.FullPaths||(G.FullPaths=[]),G.FileIndex||(G.FileIndex=[]),G.FullPaths.length!==G.FileIndex.length)throw new Error("inconsistent CFB structure");G.FullPaths.length===0&&(G.FullPaths[0]=Z+"/",G.FileIndex[0]={name:Z,type:5}),Q.CLSID&&(G.FileIndex[0].clsid=Q.CLSID),P(G)}function P(G){var te="Sh33tJ5";if(!at.find(G,"/"+te)){var Q=Ce(4);Q[0]=55,Q[1]=Q[3]=50,Q[2]=54,G.FileIndex.push({name:te,type:2,content:Q,size:4,L:69,R:69,C:69}),G.FullPaths.push(G.FullPaths[0]+te),F(G)}}function F(G,te){C(G);for(var Q=!1,Z=!1,ae=G.FullPaths.length-1;ae>=0;--ae){var re=G.FileIndex[ae];switch(re.type){case 0:Z?Q=!0:(G.FileIndex.pop(),G.FullPaths.pop());break;case 1:case 2:case 5:Z=!0,isNaN(re.R*re.L*re.C)&&(Q=!0),re.R>-1&&re.L>-1&&re.R==re.L&&(Q=!0);break;default:Q=!0;break}}if(!(!Q&&!te)){var Ne=new Date(1987,1,19),Se=0,be=Object.create?Object.create(null):{},je=[];for(ae=0;ae<G.FullPaths.length;++ae)be[G.FullPaths[ae]]=!0,G.FileIndex[ae].type!==0&&je.push([G.FullPaths[ae],G.FileIndex[ae]]);for(ae=0;ae<je.length;++ae){var we=r(je[ae][0]);Z=be[we],Z||(je.push([we,{name:s(we).replace("/",""),type:1,clsid:fe,ct:Ne,mt:Ne,content:null}]),be[we]=!0)}for(je.sort(function(qe,He){return a(qe[0],He[0])}),G.FullPaths=[],G.FileIndex=[],ae=0;ae<je.length;++ae)G.FullPaths[ae]=je[ae][0],G.FileIndex[ae]=je[ae][1];for(ae=0;ae<je.length;++ae){var Le=G.FileIndex[ae],ze=G.FullPaths[ae];if(Le.name=s(ze).replace("/",""),Le.L=Le.R=Le.C=-(Le.color=1),Le.size=Le.content?Le.content.length:0,Le.start=0,Le.clsid=Le.clsid||fe,ae===0)Le.C=je.length>1?1:-1,Le.size=0,Le.type=5;else if(ze.slice(-1)=="/"){for(Se=ae+1;Se<je.length&&r(G.FullPaths[Se])!=ze;++Se);for(Le.C=Se>=je.length?-1:Se,Se=ae+1;Se<je.length&&r(G.FullPaths[Se])!=r(ze);++Se);Le.R=Se>=je.length?-1:Se,Le.type=1}else r(G.FullPaths[ae+1]||"")==r(ze)&&(Le.R=ae+1),Le.type=2}}}function H(G,te){var Q=te||{};if(Q.fileType=="mad")return fl(G,Q);switch(F(G),Q.fileType){case"zip":return fi(G,Q)}var Z=(function(qe){for(var He=0,Me=0,xt=0;xt<qe.FileIndex.length;++xt){var Yt=qe.FileIndex[xt];if(Yt.content){var tn=Yt.content.length;tn>0&&(tn<4096?He+=tn+63>>6:Me+=tn+511>>9)}}for(var Tn=qe.FullPaths.length+3>>2,gl=He+7>>3,pi=He+127>>7,ss=gl+Me+Tn+pi,Wn=ss+127>>7,Vc=Wn<=109?0:Math.ceil((Wn-109)/127);ss+Wn+Vc+127>>7>Wn;)Vc=++Wn<=109?0:Math.ceil((Wn-109)/127);var Cn=[1,Vc,Wn,pi,Tn,Me,He,0];return qe.FileIndex[0].size=He<<6,Cn[7]=(qe.FileIndex[0].start=Cn[0]+Cn[1]+Cn[2]+Cn[3]+Cn[4]+Cn[5])+(Cn[6]+7>>3),Cn})(G),ae=Ce(Z[7]<<9),re=0,Ne=0;{for(re=0;re<8;++re)ae.write_shift(1,q[re]);for(re=0;re<8;++re)ae.write_shift(2,0);for(ae.write_shift(2,62),ae.write_shift(2,3),ae.write_shift(2,65534),ae.write_shift(2,9),ae.write_shift(2,6),re=0;re<3;++re)ae.write_shift(2,0);for(ae.write_shift(4,0),ae.write_shift(4,Z[2]),ae.write_shift(4,Z[0]+Z[1]+Z[2]+Z[3]-1),ae.write_shift(4,0),ae.write_shift(4,4096),ae.write_shift(4,Z[3]?Z[0]+Z[1]+Z[2]-1:W),ae.write_shift(4,Z[3]),ae.write_shift(-4,Z[1]?Z[0]-1:W),ae.write_shift(4,Z[1]),re=0;re<109;++re)ae.write_shift(-4,re<Z[2]?Z[1]+re:-1)}if(Z[1])for(Ne=0;Ne<Z[1];++Ne){for(;re<236+Ne*127;++re)ae.write_shift(-4,re<Z[2]?Z[1]+re:-1);ae.write_shift(-4,Ne===Z[1]-1?W:Ne+1)}var Se=function(qe){for(Ne+=qe;re<Ne-1;++re)ae.write_shift(-4,re+1);qe&&(++re,ae.write_shift(-4,W))};for(Ne=re=0,Ne+=Z[1];re<Ne;++re)ae.write_shift(-4,ne.DIFSECT);for(Ne+=Z[2];re<Ne;++re)ae.write_shift(-4,ne.FATSECT);Se(Z[3]),Se(Z[4]);for(var be=0,je=0,we=G.FileIndex[0];be<G.FileIndex.length;++be)we=G.FileIndex[be],we.content&&(je=we.content.length,!(je<4096)&&(we.start=Ne,Se(je+511>>9)));for(Se(Z[6]+7>>3);ae.l&511;)ae.write_shift(-4,ne.ENDOFCHAIN);for(Ne=re=0,be=0;be<G.FileIndex.length;++be)we=G.FileIndex[be],we.content&&(je=we.content.length,!(!je||je>=4096)&&(we.start=Ne,Se(je+63>>6)));for(;ae.l&511;)ae.write_shift(-4,ne.ENDOFCHAIN);for(re=0;re<Z[4]<<2;++re){var Le=G.FullPaths[re];if(!Le||Le.length===0){for(be=0;be<17;++be)ae.write_shift(4,0);for(be=0;be<3;++be)ae.write_shift(4,-1);for(be=0;be<12;++be)ae.write_shift(4,0);continue}we=G.FileIndex[re],re===0&&(we.start=we.size?we.start-1:W);var ze=re===0&&Q.root||we.name;if(je=2*(ze.length+1),ae.write_shift(64,ze,"utf16le"),ae.write_shift(2,je),ae.write_shift(1,we.type),ae.write_shift(1,we.color),ae.write_shift(-4,we.L),ae.write_shift(-4,we.R),ae.write_shift(-4,we.C),we.clsid)ae.write_shift(16,we.clsid,"hex");else for(be=0;be<4;++be)ae.write_shift(4,0);ae.write_shift(4,we.state||0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,we.start),ae.write_shift(4,we.size),ae.write_shift(4,0)}for(re=1;re<G.FileIndex.length;++re)if(we=G.FileIndex[re],we.size>=4096)if(ae.l=we.start+1<<9,bt&&Buffer.isBuffer(we.content))we.content.copy(ae,ae.l,0,we.size),ae.l+=we.size+511&-512;else{for(be=0;be<we.size;++be)ae.write_shift(1,we.content[be]);for(;be&511;++be)ae.write_shift(1,0)}for(re=1;re<G.FileIndex.length;++re)if(we=G.FileIndex[re],we.size>0&&we.size<4096)if(bt&&Buffer.isBuffer(we.content))we.content.copy(ae,ae.l,0,we.size),ae.l+=we.size+63&-64;else{for(be=0;be<we.size;++be)ae.write_shift(1,we.content[be]);for(;be&63;++be)ae.write_shift(1,0)}if(bt)ae.l=ae.length;else for(;ae.l<ae.length;)ae.write_shift(1,0);return ae}function O(G,te){var Q=G.FullPaths.map(function(be){return be.toUpperCase()}),Z=Q.map(function(be){var je=be.split("/");return je[je.length-(be.slice(-1)=="/"?2:1)]}),ae=!1;te.charCodeAt(0)===47?(ae=!0,te=Q[0].slice(0,-1)+te):ae=te.indexOf("/")!==-1;var re=te.toUpperCase(),Ne=ae===!0?Q.indexOf(re):Z.indexOf(re);if(Ne!==-1)return G.FileIndex[Ne];var Se=!re.match(Fd);for(re=re.replace(Ra,""),Se&&(re=re.replace(Fd,"!")),Ne=0;Ne<Q.length;++Ne)if((Se?Q[Ne].replace(Fd,"!"):Q[Ne]).replace(Ra,"")==re||(Se?Z[Ne].replace(Fd,"!"):Z[Ne]).replace(Ra,"")==re)return G.FileIndex[Ne];return null}var B=64,W=-2,ee="d0cf11e0a1b11ae1",q=[208,207,17,224,161,177,26,225],fe="00000000000000000000000000000000",ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:W,FREESECT:-1,HEADER_SIGNATURE:ee,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Y(G,te,Q){x();var Z=H(G,Q);u.writeFileSync(te,Z)}function X(G){for(var te=new Array(G.length),Q=0;Q<G.length;++Q)te[Q]=String.fromCharCode(G[Q]);return te.join("")}function xe(G,te){var Q=H(G,te);switch(te&&te.type||"buffer"){case"file":return x(),u.writeFileSync(te.filename,Q),Q;case"binary":return typeof Q=="string"?Q:X(Q);case"base64":return Yd(typeof Q=="string"?Q:X(Q));case"buffer":if(bt)return Buffer.isBuffer(Q)?Q:ci(Q);case"array":return typeof Q=="string"?dr(Q):Q}return Q}var K;function A(G){try{var te=G.InflateRaw,Q=new te;if(Q._processChunk(new Uint8Array([3,0]),Q._finishFlushFlag),Q.bytesRead)K=G;else throw new Error("zlib does not expose bytesRead")}catch(Z){console.error("cannot use native zlib: "+(Z.message||Z))}}function M(G,te){if(!K)return rs(G,te);var Q=K.InflateRaw,Z=new Q,ae=Z._processChunk(G.slice(G.l),Z._finishFlushFlag);return G.l+=Z.bytesRead,ae}function I(G){return K?K.deflateRawSync(G):ot(G)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ge=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function z(G){var te=(G<<1|G<<11)&139536|(G<<5|G<<15)&558144;return(te>>16|te>>8|te)&255}for(var le=typeof Uint8Array<"u",ue=le?new Uint8Array(256):[],ce=0;ce<256;++ce)ue[ce]=z(ce);function R(G,te){var Q=ue[G&255];return te<=8?Q>>>8-te:(Q=Q<<8|ue[G>>8&255],te<=16?Q>>>16-te:(Q=Q<<8|ue[G>>16&255],Q>>>24-te))}function pe(G,te){var Q=te&7,Z=te>>>3;return(G[Z]|(Q<=6?0:G[Z+1]<<8))>>>Q&3}function Oe(G,te){var Q=te&7,Z=te>>>3;return(G[Z]|(Q<=5?0:G[Z+1]<<8))>>>Q&7}function tt(G,te){var Q=te&7,Z=te>>>3;return(G[Z]|(Q<=4?0:G[Z+1]<<8))>>>Q&15}function Ye(G,te){var Q=te&7,Z=te>>>3;return(G[Z]|(Q<=3?0:G[Z+1]<<8))>>>Q&31}function Re(G,te){var Q=te&7,Z=te>>>3;return(G[Z]|(Q<=1?0:G[Z+1]<<8))>>>Q&127}function Ot(G,te,Q){var Z=te&7,ae=te>>>3,re=(1<<Q)-1,Ne=G[ae]>>>Z;return Q<8-Z||(Ne|=G[ae+1]<<8-Z,Q<16-Z)||(Ne|=G[ae+2]<<16-Z,Q<24-Z)||(Ne|=G[ae+3]<<24-Z),Ne&re}function Ht(G,te,Q){var Z=te&7,ae=te>>>3;return Z<=5?G[ae]|=(Q&7)<<Z:(G[ae]|=Q<<Z&255,G[ae+1]=(Q&7)>>8-Z),te+3}function rn(G,te,Q){var Z=te&7,ae=te>>>3;return Q=(Q&1)<<Z,G[ae]|=Q,te+1}function Fn(G,te,Q){var Z=te&7,ae=te>>>3;return Q<<=Z,G[ae]|=Q&255,Q>>>=8,G[ae+1]=Q,te+8}function Ha(G,te,Q){var Z=te&7,ae=te>>>3;return Q<<=Z,G[ae]|=Q&255,Q>>>=8,G[ae+1]=Q&255,G[ae+2]=Q>>>8,te+16}function Sa(G,te){var Q=G.length,Z=2*Q>te?2*Q:te+5,ae=0;if(Q>=te)return G;if(bt){var re=sN(Z);if(G.copy)G.copy(re);else for(;ae<G.length;++ae)re[ae]=G[ae];return re}else if(le){var Ne=new Uint8Array(Z);if(Ne.set)Ne.set(G);else for(;ae<Q;++ae)Ne[ae]=G[ae];return Ne}return G.length=Z,G}function Be(G){for(var te=new Array(G),Q=0;Q<G;++Q)te[Q]=0;return te}function Xe(G,te,Q){var Z=1,ae=0,re=0,Ne=0,Se=0,be=G.length,je=le?new Uint16Array(32):Be(32);for(re=0;re<32;++re)je[re]=0;for(re=be;re<Q;++re)G[re]=0;be=G.length;var we=le?new Uint16Array(be):Be(be);for(re=0;re<be;++re)je[ae=G[re]]++,Z<ae&&(Z=ae),we[re]=0;for(je[0]=0,re=1;re<=Z;++re)je[re+16]=Se=Se+je[re-1]<<1;for(re=0;re<be;++re)Se=G[re],Se!=0&&(we[re]=je[Se+16]++);var Le=0;for(re=0;re<be;++re)if(Le=G[re],Le!=0)for(Se=R(we[re],Z)>>Z-Le,Ne=(1<<Z+4-Le)-1;Ne>=0;--Ne)te[Se|Ne<<Le]=Le&15|re<<4;return Z}var Lt=le?new Uint16Array(512):Be(512),Wt=le?new Uint16Array(32):Be(32);if(!le){for(var Ct=0;Ct<512;++Ct)Lt[Ct]=0;for(Ct=0;Ct<32;++Ct)Wt[Ct]=0}(function(){for(var G=[],te=0;te<32;te++)G.push(5);Xe(G,Wt,32);var Q=[];for(te=0;te<=143;te++)Q.push(8);for(;te<=255;te++)Q.push(9);for(;te<=279;te++)Q.push(7);for(;te<=287;te++)Q.push(8);Xe(Q,Lt,288)})();var Rn=(function(){for(var te=le?new Uint8Array(32768):[],Q=0,Z=0;Q<ge.length-1;++Q)for(;Z<ge[Q+1];++Z)te[Z]=Q;for(;Z<32768;++Z)te[Z]=29;var ae=le?new Uint8Array(259):[];for(Q=0,Z=0;Q<J.length-1;++Q)for(;Z<J[Q+1];++Z)ae[Z]=Q;function re(Se,be){for(var je=0;je<Se.length;){var we=Math.min(65535,Se.length-je),Le=je+we==Se.length;for(be.write_shift(1,+Le),be.write_shift(2,we),be.write_shift(2,~we&65535);we-- >0;)be[be.l++]=Se[je++]}return be.l}function Ne(Se,be){for(var je=0,we=0,Le=le?new Uint16Array(32768):[];we<Se.length;){var ze=Math.min(65535,Se.length-we);if(ze<10){for(je=Ht(be,je,+(we+ze==Se.length)),je&7&&(je+=8-(je&7)),be.l=je/8|0,be.write_shift(2,ze),be.write_shift(2,~ze&65535);ze-- >0;)be[be.l++]=Se[we++];je=be.l*8;continue}je=Ht(be,je,+(we+ze==Se.length)+2);for(var qe=0;ze-- >0;){var He=Se[we];qe=(qe<<5^He)&32767;var Me=-1,xt=0;if((Me=Le[qe])&&(Me|=we&-32768,Me>we&&(Me-=32768),Me<we))for(;Se[Me+xt]==Se[we+xt]&&xt<250;)++xt;if(xt>2){He=ae[xt],He<=22?je=Fn(be,je,ue[He+1]>>1)-1:(Fn(be,je,3),je+=5,Fn(be,je,ue[He-23]>>5),je+=3);var Yt=He<8?0:He-4>>2;Yt>0&&(Ha(be,je,xt-J[He]),je+=Yt),He=te[we-Me],je=Fn(be,je,ue[He]>>3),je-=3;var tn=He<4?0:He-2>>1;tn>0&&(Ha(be,je,we-Me-ge[He]),je+=tn);for(var Tn=0;Tn<xt;++Tn)Le[qe]=we&32767,qe=(qe<<5^Se[we])&32767,++we;ze-=xt-1}else He<=143?He=He+48:je=rn(be,je,1),je=Fn(be,je,ue[He]),Le[qe]=we&32767,++we}je=Fn(be,je,0)-1}return be.l=(je+7)/8|0,be.l}return function(be,je){return be.length<8?re(be,je):Ne(be,je)}})();function ot(G){var te=Ce(50+Math.floor(G.length*1.1)),Q=Rn(G,te);return te.slice(0,Q)}var Mt=le?new Uint16Array(32768):Be(32768),qn=le?new Uint16Array(32768):Be(32768),en=le?new Uint16Array(128):Be(128),_a=1,hi=1;function As(G,te){var Q=Ye(G,te)+257;te+=5;var Z=Ye(G,te)+1;te+=5;var ae=tt(G,te)+4;te+=4;for(var re=0,Ne=le?new Uint8Array(19):Be(19),Se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],be=1,je=le?new Uint8Array(8):Be(8),we=le?new Uint8Array(8):Be(8),Le=Ne.length,ze=0;ze<ae;++ze)Ne[V[ze]]=re=Oe(G,te),be<re&&(be=re),je[re]++,te+=3;var qe=0;for(je[0]=0,ze=1;ze<=be;++ze)we[ze]=qe=qe+je[ze-1]<<1;for(ze=0;ze<Le;++ze)(qe=Ne[ze])!=0&&(Se[ze]=we[qe]++);var He=0;for(ze=0;ze<Le;++ze)if(He=Ne[ze],He!=0){qe=ue[Se[ze]]>>8-He;for(var Me=(1<<7-He)-1;Me>=0;--Me)en[qe|Me<<He]=He&7|ze<<3}var xt=[];for(be=1;xt.length<Q+Z;)switch(qe=en[Re(G,te)],te+=qe&7,qe>>>=3){case 16:for(re=3+pe(G,te),te+=2,qe=xt[xt.length-1];re-- >0;)xt.push(qe);break;case 17:for(re=3+Oe(G,te),te+=3;re-- >0;)xt.push(0);break;case 18:for(re=11+Re(G,te),te+=7;re-- >0;)xt.push(0);break;default:xt.push(qe),be<qe&&(be=qe);break}var Yt=xt.slice(0,Q),tn=xt.slice(Q);for(ze=Q;ze<286;++ze)Yt[ze]=0;for(ze=Z;ze<30;++ze)tn[ze]=0;return _a=Xe(Yt,Mt,286),hi=Xe(tn,qn,30),te}function Fs(G,te){if(G[0]==3&&!(G[1]&3))return[rl(te),2];for(var Q=0,Z=0,ae=sN(te||1<<18),re=0,Ne=ae.length>>>0,Se=0,be=0;(Z&1)==0;){if(Z=Oe(G,Q),Q+=3,Z>>>1)Z>>1==1?(Se=9,be=5):(Q=As(G,Q),Se=_a,be=hi);else{Q&7&&(Q+=8-(Q&7));var je=G[Q>>>3]|G[(Q>>>3)+1]<<8;if(Q+=32,je>0)for(!te&&Ne<re+je&&(ae=Sa(ae,re+je),Ne=ae.length);je-- >0;)ae[re++]=G[Q>>>3],Q+=8;continue}for(;;){!te&&Ne<re+32767&&(ae=Sa(ae,re+32767),Ne=ae.length);var we=Ot(G,Q,Se),Le=Z>>>1==1?Lt[we]:Mt[we];if(Q+=Le&15,Le>>>=4,(Le>>>8&255)===0)ae[re++]=Le;else{if(Le==256)break;Le-=257;var ze=Le<8?0:Le-4>>2;ze>5&&(ze=0);var qe=re+J[Le];ze>0&&(qe+=Ot(G,Q,ze),Q+=ze),we=Ot(G,Q,be),Le=Z>>>1==1?Wt[we]:qn[we],Q+=Le&15,Le>>>=4;var He=Le<4?0:Le-2>>1,Me=ge[Le];for(He>0&&(Me+=Ot(G,Q,He),Q+=He),!te&&Ne<qe&&(ae=Sa(ae,qe+100),Ne=ae.length);re<qe;)ae[re]=ae[re-Me],++re}}}return te?[ae,Q+7>>>3]:[ae.slice(0,re),Q+7>>>3]}function rs(G,te){var Q=G.slice(G.l||0),Z=Fs(Q,te);return G.l+=Z[1],Z[0]}function xi(G,te){if(G)typeof console<"u"&&console.error(te);else throw new Error(te)}function wo(G,te){var Q=G;oa(Q,0);var Z=[],ae=[],re={FileIndex:Z,FullPaths:ae};C(re,{root:te.root});for(var Ne=Q.length-4;(Q[Ne]!=80||Q[Ne+1]!=75||Q[Ne+2]!=5||Q[Ne+3]!=6)&&Ne>=0;)--Ne;Q.l=Ne+4,Q.l+=4;var Se=Q.read_shift(2);Q.l+=6;var be=Q.read_shift(4);for(Q.l=be,Ne=0;Ne<Se;++Ne){Q.l+=20;var je=Q.read_shift(4),we=Q.read_shift(4),Le=Q.read_shift(2),ze=Q.read_shift(2),qe=Q.read_shift(2);Q.l+=8;var He=Q.read_shift(4),Me=d(Q.slice(Q.l+Le,Q.l+Le+ze));Q.l+=Le+ze+qe;var xt=Q.l;Q.l=He+4,mi(Q,je,we,re,Me),Q.l=xt}return re}function mi(G,te,Q,Z,ae){G.l+=2;var re=G.read_shift(2),Ne=G.read_shift(2),Se=o(G);if(re&8257)throw new Error("Unsupported ZIP encryption");for(var be=G.read_shift(4),je=G.read_shift(4),we=G.read_shift(4),Le=G.read_shift(2),ze=G.read_shift(2),qe="",He=0;He<Le;++He)qe+=String.fromCharCode(G[G.l++]);if(ze){var Me=d(G.slice(G.l,G.l+ze));(Me[21589]||{}).mt&&(Se=Me[21589].mt),((ae||{})[21589]||{}).mt&&(Se=ae[21589].mt)}G.l+=ze;var xt=G.slice(G.l,G.l+je);switch(Ne){case 8:xt=M(G,we);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ne)}var Yt=!1;re&8&&(be=G.read_shift(4),be==134695760&&(be=G.read_shift(4),Yt=!0),je=G.read_shift(4),we=G.read_shift(4)),je!=te&&xi(Yt,"Bad compressed size: "+te+" != "+je),we!=Q&&xi(Yt,"Bad uncompressed size: "+Q+" != "+we),Ls(Z,qe,xt,{unsafe:!0,mt:Se})}function fi(G,te){var Q=te||{},Z=[],ae=[],re=Ce(1),Ne=Q.compression?8:0,Se=0,be=0,je=0,we=0,Le=0,ze=G.FullPaths[0],qe=ze,He=G.FileIndex[0],Me=[],xt=0;for(be=1;be<G.FullPaths.length;++be)if(qe=G.FullPaths[be].slice(ze.length),He=G.FileIndex[be],!(!He.size||!He.content||qe=="Sh33tJ5")){var Yt=we,tn=Ce(qe.length);for(je=0;je<qe.length;++je)tn.write_shift(1,qe.charCodeAt(je)&127);tn=tn.slice(0,tn.l),Me[Le]=EF.buf(He.content,0);var Tn=He.content;Ne==8&&(Tn=I(Tn)),re=Ce(30),re.write_shift(4,67324752),re.write_shift(2,20),re.write_shift(2,Se),re.write_shift(2,Ne),He.mt?l(re,He.mt):re.write_shift(4,0),re.write_shift(-4,Me[Le]),re.write_shift(4,Tn.length),re.write_shift(4,He.content.length),re.write_shift(2,tn.length),re.write_shift(2,0),we+=re.length,Z.push(re),we+=tn.length,Z.push(tn),we+=Tn.length,Z.push(Tn),re=Ce(46),re.write_shift(4,33639248),re.write_shift(2,0),re.write_shift(2,20),re.write_shift(2,Se),re.write_shift(2,Ne),re.write_shift(4,0),re.write_shift(-4,Me[Le]),re.write_shift(4,Tn.length),re.write_shift(4,He.content.length),re.write_shift(2,tn.length),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(4,0),re.write_shift(4,Yt),xt+=re.l,ae.push(re),xt+=tn.length,ae.push(tn),++Le}return re=Ce(22),re.write_shift(4,101010256),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(2,Le),re.write_shift(2,Le),re.write_shift(4,xt),re.write_shift(4,we),re.write_shift(2,0),ta([ta(Z),ta(ae),re])}var ml={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Du(G,te){if(G.ctype)return G.ctype;var Q=G.name||"",Z=Q.match(/\.([^\.]+)$/);return Z&&ml[Z[1]]||te&&(Z=(Q=te).match(/[\.\\]([^\.\\])+$/),Z&&ml[Z[1]])?ml[Z[1]]:"application/octet-stream"}function Au(G){for(var te=Yd(G),Q=[],Z=0;Z<te.length;Z+=76)Q.push(te.slice(Z,Z+76));return Q.join(`\r
`)+`\r
`}function Fu(G){var te=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(je){var we=je.charCodeAt(0).toString(16).toUpperCase();return"="+(we.length==1?"0"+we:we)});te=te.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),te.charAt(0)==`
`&&(te="=0D"+te.slice(1)),te=te.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Q=[],Z=te.split(`\r
`),ae=0;ae<Z.length;++ae){var re=Z[ae];if(re.length==0){Q.push("");continue}for(var Ne=0;Ne<re.length;){var Se=76,be=re.slice(Ne,Ne+Se);be.charAt(Se-1)=="="?Se--:be.charAt(Se-2)=="="?Se-=2:be.charAt(Se-3)=="="&&(Se-=3),be=re.slice(Ne,Ne+Se),Ne+=Se,Ne<re.length&&(be+="="),Q.push(be)}}return Q.join(`\r
`)}function Lu(G){for(var te=[],Q=0;Q<G.length;++Q){for(var Z=G[Q];Q<=G.length&&Z.charAt(Z.length-1)=="=";)Z=Z.slice(0,Z.length-1)+G[++Q];te.push(Z)}for(var ae=0;ae<te.length;++ae)te[ae]=te[ae].replace(/[=][0-9A-Fa-f]{2}/g,function(re){return String.fromCharCode(parseInt(re.slice(1),16))});return dr(te.join(`\r
`))}function Bc(G,te,Q){for(var Z="",ae="",re="",Ne,Se=0;Se<10;++Se){var be=te[Se];if(!be||be.match(/^\s*$/))break;var je=be.match(/^(.*?):\s*([^\s].*)$/);if(je)switch(je[1].toLowerCase()){case"content-location":Z=je[2].trim();break;case"content-type":re=je[2].trim();break;case"content-transfer-encoding":ae=je[2].trim();break}}switch(++Se,ae.toLowerCase()){case"base64":Ne=dr(xr(te.slice(Se).join("")));break;case"quoted-printable":Ne=Lu(te.slice(Se));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ae)}var we=Ls(G,Z.slice(Q.length),Ne,{unsafe:!0});re&&(we.ctype=re)}function Pu(G,te){if(X(G.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Q=te&&te.root||"",Z=(bt&&Buffer.isBuffer(G)?G.toString("binary"):X(G)).split(`\r
`),ae=0,re="";for(ae=0;ae<Z.length;++ae)if(re=Z[ae],!!/^Content-Location:/i.test(re)&&(re=re.slice(re.indexOf("file")),Q||(Q=re.slice(0,re.lastIndexOf("/")+1)),re.slice(0,Q.length)!=Q))for(;Q.length>0&&(Q=Q.slice(0,Q.length-1),Q=Q.slice(0,Q.lastIndexOf("/")+1),re.slice(0,Q.length)!=Q););var Ne=(Z[1]||"").match(/boundary="(.*?)"/);if(!Ne)throw new Error("MAD cannot find boundary");var Se="--"+(Ne[1]||""),be=[],je=[],we={FileIndex:be,FullPaths:je};C(we);var Le,ze=0;for(ae=0;ae<Z.length;++ae){var qe=Z[ae];qe!==Se&&qe!==Se+"--"||(ze++&&Bc(we,Z.slice(Le,ae),Q),Le=ae)}return we}function fl(G,te){var Q=te||{},Z=Q.boundary||"SheetJS";Z="------="+Z;for(var ae=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Z.slice(2)+'"',"","",""],re=G.FullPaths[0],Ne=re,Se=G.FileIndex[0],be=1;be<G.FullPaths.length;++be)if(Ne=G.FullPaths[be].slice(re.length),Se=G.FileIndex[be],!(!Se.size||!Se.content||Ne=="Sh33tJ5")){Ne=Ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(xt){return"_x"+xt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(xt){return"_u"+xt.charCodeAt(0).toString(16)+"_"});for(var je=Se.content,we=bt&&Buffer.isBuffer(je)?je.toString("binary"):X(je),Le=0,ze=Math.min(1024,we.length),qe=0,He=0;He<=ze;++He)(qe=we.charCodeAt(He))>=32&&qe<128&&++Le;var Me=Le>=ze*4/5;ae.push(Z),ae.push("Content-Location: "+(Q.root||"file:///C:/SheetJS/")+Ne),ae.push("Content-Transfer-Encoding: "+(Me?"quoted-printable":"base64")),ae.push("Content-Type: "+Du(Se,Ne)),ae.push(""),ae.push(Me?Fu(we):Au(we))}return ae.push(Z+`--\r
`),ae.join(`\r
`)}function Hc(G){var te={};return C(te,G),te}function Ls(G,te,Q,Z){var ae=Z&&Z.unsafe;ae||C(G);var re=!ae&&at.find(G,te);if(!re){var Ne=G.FullPaths[0];te.slice(0,Ne.length)==Ne?Ne=te:(Ne.slice(-1)!="/"&&(Ne+="/"),Ne=(Ne+te).replace("//","/")),re={name:s(te),type:2},G.FileIndex.push(re),G.FullPaths.push(Ne),ae||at.utils.cfb_gc(G)}return re.content=Q,re.size=Q?Q.length:0,Z&&(Z.CLSID&&(re.clsid=Z.CLSID),Z.mt&&(re.mt=Z.mt),Z.ct&&(re.ct=Z.ct)),re}function ux(G,te){C(G);var Q=at.find(G,te);if(Q){for(var Z=0;Z<G.FileIndex.length;++Z)if(G.FileIndex[Z]==Q)return G.FileIndex.splice(Z,1),G.FullPaths.splice(Z,1),!0}return!1}function pl(G,te,Q){C(G);var Z=at.find(G,te);if(Z){for(var ae=0;ae<G.FileIndex.length;++ae)if(G.FileIndex[ae]==Z)return G.FileIndex[ae].name=s(Q),G.FullPaths[ae]=Q,!0}return!1}function ko(G){F(G,!0)}return n.find=O,n.read=L,n.parse=m,n.write=xe,n.writeFile=Y,n.utils={cfb_new:Hc,cfb_add:Ls,cfb_del:ux,cfb_mov:pl,cfb_gc:ko,ReadShift:Md,CheckField:Zw,prep_blob:oa,bconcat:ta,use_zlib:A,_deflateRaw:ot,_inflateRaw:rs,consts:ne},n})();function DF(e){return typeof e=="string"?nx(e):Array.isArray(e)?nF(e):e}function ju(e,n,a){if(typeof Deno<"u"){if(a&&typeof n=="string")switch(a){case"utf8":n=new TextEncoder(a).encode(n);break;case"binary":n=nx(n);break;default:throw new Error("Unsupported encoding "+a)}return Deno.writeFileSync(e,n)}var r=a=="utf8"?ws(n):n;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,e);if(typeof Blob<"u"){var s=new Blob([DF(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=l,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var d=File(e);return d.open("w"),d.encoding="binary",Array.isArray(n)&&(n=ul(n)),d.write(n),d.close(),n}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+e)}function AF(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(e);n.open("r"),n.encoding="binary";var a=n.read();return n.close(),a}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function kn(e){for(var n=Object.keys(e),a=[],r=0;r<n.length;++r)Object.prototype.hasOwnProperty.call(e,n[r])&&a.push(n[r]);return a}function xN(e,n){for(var a=[],r=kn(e),s=0;s!==r.length;++s)a[e[r[s]][n]]==null&&(a[e[r[s]][n]]=r[s]);return a}function rx(e){for(var n=[],a=kn(e),r=0;r!==a.length;++r)n[e[a[r]]]=a[r];return n}function sx(e){for(var n=[],a=kn(e),r=0;r!==a.length;++r)n[e[a[r]]]=parseInt(a[r],10);return n}function FF(e){for(var n=[],a=kn(e),r=0;r!==a.length;++r)n[e[a[r]]]==null&&(n[e[a[r]]]=[]),n[e[a[r]]].push(a[r]);return n}var E0=new Date(1899,11,30,0,0,0);function Gn(e,n){var a=e.getTime(),r=E0.getTime()+(e.getTimezoneOffset()-E0.getTimezoneOffset())*6e4;return(a-r)/(1440*60*1e3)}var Fw=new Date,LF=E0.getTime()+(Fw.getTimezoneOffset()-E0.getTimezoneOffset())*6e4,mN=Fw.getTimezoneOffset();function ix(e){var n=new Date;return n.setTime(e*24*60*60*1e3+LF),n.getTimezoneOffset()!==mN&&n.setTime(n.getTime()+(n.getTimezoneOffset()-mN)*6e4),n}function PF(e){var n=0,a=0,r=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=s.length;++l)if(s[l]){switch(a=1,l>3&&(r=!0),s[l].slice(s[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[l].slice(s[l].length-1));case"D":a*=24;case"H":a*=60;case"M":if(r)a*=60;else throw new Error("Unsupported ISO Duration Field: M")}n+=a*parseInt(s[l],10)}return n}var fN=new Date("2017-02-19T19:06:09.000Z"),Lw=isNaN(fN.getFullYear())?new Date("2/19/17"):fN,IF=Lw.getFullYear()==2017;function un(e,n){var a=new Date(e);if(IF)return n>0?a.setTime(a.getTime()+a.getTimezoneOffset()*60*1e3):n<0&&a.setTime(a.getTime()-a.getTimezoneOffset()*60*1e3),a;if(e instanceof Date)return e;if(Lw.getFullYear()==1917&&!isNaN(a.getFullYear())){var r=a.getFullYear();return e.indexOf(""+r)>-1||a.setFullYear(a.getFullYear()+100),a}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function lo(e,n){if(bt&&Buffer.isBuffer(e)){if(n){if(e[0]==255&&e[1]==254)return ws(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ws(bw(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(e[0]==255&&e[1]==254)return ws(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ws(new TextDecoder("utf-16be").decode(e.slice(2)))}var a={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return a[l]||l})}catch{}for(var r=[],s=0;s!=e.length;++s)r.push(String.fromCharCode(e[s]));return r.join("")}function hn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=hn(e[a]));return n}function jn(e,n){for(var a="";a.length<n;)a+=e;return a}function es(e){var n=Number(e);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(e))return n;var a=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return a*=100,""});return!isNaN(n=Number(r))||(r=r.replace(/[(](.*)[)]/,function(s,l){return a=-a,l}),!isNaN(n=Number(r)))?n/a:n}var OF=["january","february","march","april","may","june","july","august","september","october","november","december"];function Cc(e){var n=new Date(e),a=new Date(NaN),r=n.getYear(),s=n.getMonth(),l=n.getDate();if(isNaN(l))return a;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&OF.indexOf(o)==-1)return a}else if(o.match(/[a-z]/))return a;return r<0||r>8099?a:(s>0||l>1)&&r!=101?n:e.match(/[^-0-9:,\/\\]/)?a:n}var MF=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(a,r,s){if(e||typeof r=="string")return a.split(r);for(var l=a.split(r),o=[l[0]],d=1;d<l.length;++d)o.push(s),o.push(l[d]);return o}})();function Pw(e){return e?e.content&&e.type?lo(e.content,!0):e.data?Ad(e.data):e.asNodeBuffer&&bt?Ad(e.asNodeBuffer().toString("binary")):e.asBinary?Ad(e.asBinary()):e._data&&e._data.getContent?Ad(lo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Iw(e){if(!e)return null;if(e.data)return aN(e.data);if(e.asNodeBuffer&&bt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var n=e._data.getContent();return typeof n=="string"?aN(n):Array.prototype.slice.call(n)}return e.content&&e.type?e.content:null}function RF(e){return e&&e.name.slice(-4)===".bin"?Iw(e):Pw(e)}function Cr(e,n){for(var a=e.FullPaths||kn(e.files),r=n.toLowerCase().replace(/[\/]/g,"\\"),s=r.replace(/\\/g,"/"),l=0;l<a.length;++l){var o=a[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==o||s==o)return e.files?e.files[a[l]]:e.FileIndex[l]}return null}function Ng(e,n){var a=Cr(e,n);if(a==null)throw new Error("Cannot find file "+n+" in zip");return a}function In(e,n,a){if(!a)return RF(Ng(e,n));if(!n)return null;try{return In(e,n)}catch{return null}}function ur(e,n,a){if(!a)return Pw(Ng(e,n));if(!n)return null;try{return ur(e,n)}catch{return null}}function BF(e,n,a){return Iw(Ng(e,n))}function pN(e){for(var n=e.FullPaths||kn(e.files),a=[],r=0;r<n.length;++r)n[r].slice(-1)!="/"&&a.push(n[r].replace(/^Root Entry[\/]/,""));return a.sort()}function gt(e,n,a){if(e.FullPaths){if(typeof a=="string"){var r;return bt?r=ci(a):r=aF(a),at.utils.cfb_add(e,n,r)}at.utils.cfb_add(e,n,a)}else e.file(n,a)}function jg(){return at.utils.cfb_new()}function Ow(e,n){switch(n.type){case"base64":return at.read(e,{type:"base64"});case"binary":return at.read(e,{type:"binary"});case"buffer":case"array":return at.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function Ld(e,n){if(e.charAt(0)=="/")return e.slice(1);var a=n.split("/");n.slice(-1)!="/"&&a.pop();for(var r=e.split("/");r.length!==0;){var s=r.shift();s===".."?a.pop():s!=="."&&a.push(s)}return a.join("/")}var An=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,HF=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,gN=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,VF=/<[^>]*>/g,Ca=An.match(gN)?gN:VF,UF=/<\w*:/,KF=/<(\/?)\w+:/;function ut(e,n,a){for(var r={},s=0,l=0;s!==e.length&&!((l=e.charCodeAt(s))===32||l===10||l===13);++s);if(n||(r[0]=e.slice(0,s)),s===e.length)return r;var o=e.match(HF),d=0,u="",x=0,m="",f="",p=1;if(o)for(x=0;x!=o.length;++x){for(f=o[x],l=0;l!=f.length&&f.charCodeAt(l)!==61;++l);for(m=f.slice(0,l).trim();f.charCodeAt(l+1)==32;)++l;for(p=(s=f.charCodeAt(l+1))==34||s==39?1:0,u=f.slice(l+1+p,f.length-p),d=0;d!=m.length&&m.charCodeAt(d)!==58;++d);if(d===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),r[m]=u,r[m.toLowerCase()]=u;else{var b=(d===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(d+1);if(r[b]&&m.slice(d-3,d)=="ext")continue;r[b]=u,r[b.toLowerCase()]=u}}return r}function Es(e){return e.replace(KF,"<$1")}var Mw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},wg=rx(Mw),Dt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function a(r){var s=r+"",l=s.indexOf("<![CDATA[");if(l==-1)return s.replace(e,function(d,u){return Mw[d]||String.fromCharCode(parseInt(u,d.indexOf("x")>-1?16:10))||d}).replace(n,function(d,u){return String.fromCharCode(parseInt(u,16))});var o=s.indexOf("]]>");return a(s.slice(0,l))+s.slice(l+9,o)+a(s.slice(o+3))}})(),kg=/[&<>'"]/g,zF=/[\u0000-\u0008\u000b-\u001f]/g;function qt(e){var n=e+"";return n.replace(kg,function(a){return wg[a]}).replace(zF,function(a){return"_x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+"_"})}function yN(e){return qt(e).replace(/ /g,"_x0020_")}var Rw=/[\u0000-\u001f]/g;function Tg(e){var n=e+"";return n.replace(kg,function(a){return wg[a]}).replace(/\n/g,"<br/>").replace(Rw,function(a){return"&#x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+";"})}function $F(e){var n=e+"";return n.replace(kg,function(a){return wg[a]}).replace(Rw,function(a){return"&#x"+a.charCodeAt(0).toString(16).toUpperCase()+";"})}var vN=(function(){var e=/&#(\d+);/g;function n(a,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,n)}})();function GF(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function on(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function jf(e){for(var n="",a=0,r=0,s=0,l=0,o=0,d=0;a<e.length;){if(r=e.charCodeAt(a++),r<128){n+=String.fromCharCode(r);continue}if(s=e.charCodeAt(a++),r>191&&r<224){o=(r&31)<<6,o|=s&63,n+=String.fromCharCode(o);continue}if(l=e.charCodeAt(a++),r<240){n+=String.fromCharCode((r&15)<<12|(s&63)<<6|l&63);continue}o=e.charCodeAt(a++),d=((r&7)<<18|(s&63)<<12|(l&63)<<6|o&63)-65536,n+=String.fromCharCode(55296+(d>>>10&1023)),n+=String.fromCharCode(56320+(d&1023))}return n}function bN(e){var n=rl(2*e.length),a,r,s=1,l=0,o=0,d;for(r=0;r<e.length;r+=s)s=1,(d=e.charCodeAt(r))<128?a=d:d<224?(a=(d&31)*64+(e.charCodeAt(r+1)&63),s=2):d<240?(a=(d&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),s=3):(s=4,a=(d&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),a-=65536,o=55296+(a>>>10&1023),a=56320+(a&1023)),o!==0&&(n[l++]=o&255,n[l++]=o>>>8,o=0),n[l++]=a%256,n[l++]=a>>>8;return n.slice(0,l).toString("ucs2")}function NN(e){return ci(e,"binary").toString("utf8")}var Wh="foo bar baz",Qt=bt&&(NN(Wh)==jf(Wh)&&NN||bN(Wh)==jf(Wh)&&bN)||jf,ws=bt?function(e){return ci(e,"utf8").toString("binary")}:function(e){for(var n=[],a=0,r=0,s=0;a<e.length;)switch(r=e.charCodeAt(a++),!0){case r<128:n.push(String.fromCharCode(r));break;case r<2048:n.push(String.fromCharCode(192+(r>>6))),n.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,s=e.charCodeAt(a++)-56320+(r<<10),n.push(String.fromCharCode(240+(s>>18&7))),n.push(String.fromCharCode(144+(s>>12&63))),n.push(String.fromCharCode(128+(s>>6&63))),n.push(String.fromCharCode(128+(s&63)));break;default:n.push(String.fromCharCode(224+(r>>12))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(r&63)))}return n.join("")},Zd=(function(){var e={};return function(a,r){var s=a+"|"+(r||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+a+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+a+">",r||"")}})(),Bw=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(a){for(var r=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)r=r.replace(e[s][0],e[s][1]);return r}})(),qF=(function(){var e={};return function(a){return e[a]!==void 0?e[a]:e[a]=new RegExp("<(?:vt:)?"+a+">([\\s\\S]*?)</(?:vt:)?"+a+">","g")}})(),WF=/<\/?(?:vt:)?variant>/g,XF=/<(?:vt:)([^>]*)>([\s\S]*)</;function jN(e,n){var a=ut(e),r=e.match(qF(a.baseType))||[],s=[];if(r.length!=a.size){if(n.WTF)throw new Error("unexpected vector length "+r.length+" != "+a.size);return s}return r.forEach(function(l){var o=l.replace(WF,"").match(XF);o&&s.push({v:Qt(o[2]),t:o[1]})}),s}var Hw=/(^\s|\s$|\n)/;function da(e,n){return"<"+e+(n.match(Hw)?' xml:space="preserve"':"")+">"+n+"</"+e+">"}function eu(e){return kn(e).map(function(n){return" "+n+'="'+e[n]+'"'}).join("")}function Ue(e,n,a){return"<"+e+(a!=null?eu(a):"")+(n!=null?(n.match(Hw)?' xml:space="preserve"':"")+">"+n+"</"+e:"/")+">"}function jp(e,n){try{return e.toISOString().replace(/\.\d*/,"")}catch(a){if(n)throw a}return""}function QF(e,n){switch(typeof e){case"string":var a=Ue("vt:lpwstr",qt(e));return a=a.replace(/&quot;/g,"_x0022_"),a;case"number":return Ue((e|0)==e?"vt:i4":"vt:r8",qt(String(e)));case"boolean":return Ue("vt:bool",e?"true":"false")}if(e instanceof Date)return Ue("vt:filetime",jp(e));throw new Error("Unable to serialize "+e)}function Cg(e){if(bt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Qt(ul(yg(e)));throw new Error("Bad input format: expected Buffer or string")}var tu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,zn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},fo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],or={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function YF(e,n){for(var a=1-2*(e[n+7]>>>7),r=((e[n+7]&127)<<4)+(e[n+6]>>>4&15),s=e[n+6]&15,l=5;l>=0;--l)s=s*256+e[n+l];return r==2047?s==0?a*(1/0):NaN:(r==0?r=-1022:(r-=1023,s+=Math.pow(2,52)),a*Math.pow(2,r-52)*s)}function JF(e,n,a){var r=(n<0||1/n==-1/0?1:0)<<7,s=0,l=0,o=r?-n:n;isFinite(o)?o==0?s=l=0:(s=Math.floor(Math.log(o)/Math.LN2),l=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?s=-1022:(l-=Math.pow(2,52),s+=1023)):(s=2047,l=isNaN(n)?26985:0);for(var d=0;d<=5;++d,l/=256)e[a+d]=l&255;e[a+6]=(s&15)<<4|l&15,e[a+7]=s>>4|r}var wN=function(e){for(var n=[],a=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var s=0,l=e[0][r].length;s<l;s+=a)n.push.apply(n,e[0][r].slice(s,s+a));return n},kN=bt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(n){return Buffer.isBuffer(n)?n:ci(n)})):wN(e)}:wN,TN=function(e,n,a){for(var r=[],s=n;s<a;s+=2)r.push(String.fromCharCode(Qs(e,s)));return r.join("").replace(Ra,"")},Sg=bt?function(e,n,a){return Buffer.isBuffer(e)?e.toString("utf16le",n,a).replace(Ra,""):TN(e,n,a)}:TN,CN=function(e,n,a){for(var r=[],s=n;s<n+a;++s)r.push(("0"+e[s].toString(16)).slice(-2));return r.join("")},Vw=bt?function(e,n,a){return Buffer.isBuffer(e)?e.toString("hex",n,n+a):CN(e,n,a)}:CN,SN=function(e,n,a){for(var r=[],s=n;s<a;s++)r.push(String.fromCharCode(tc(e,s)));return r.join("")},wu=bt?function(n,a,r){return Buffer.isBuffer(n)?n.toString("utf8",a,r):SN(n,a,r)}:SN,Uw=function(e,n){var a=cr(e,n);return a>0?wu(e,n+4,n+4+a-1):""},Kw=Uw,zw=function(e,n){var a=cr(e,n);return a>0?wu(e,n+4,n+4+a-1):""},$w=zw,Gw=function(e,n){var a=2*cr(e,n);return a>0?wu(e,n+4,n+4+a-1):""},qw=Gw,Ww=function(n,a){var r=cr(n,a);return r>0?Sg(n,a+4,a+4+r):""},Xw=Ww,Qw=function(e,n){var a=cr(e,n);return a>0?wu(e,n+4,n+4+a):""},Yw=Qw,Jw=function(e,n){return YF(e,n)},D0=Jw,_g=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};bt&&(Kw=function(n,a){if(!Buffer.isBuffer(n))return Uw(n,a);var r=n.readUInt32LE(a);return r>0?n.toString("utf8",a+4,a+4+r-1):""},$w=function(n,a){if(!Buffer.isBuffer(n))return zw(n,a);var r=n.readUInt32LE(a);return r>0?n.toString("utf8",a+4,a+4+r-1):""},qw=function(n,a){if(!Buffer.isBuffer(n))return Gw(n,a);var r=2*n.readUInt32LE(a);return n.toString("utf16le",a+4,a+4+r-1)},Xw=function(n,a){if(!Buffer.isBuffer(n))return Ww(n,a);var r=n.readUInt32LE(a);return n.toString("utf16le",a+4,a+4+r)},Yw=function(n,a){if(!Buffer.isBuffer(n))return Qw(n,a);var r=n.readUInt32LE(a);return n.toString("utf8",a+4,a+4+r)},D0=function(n,a){return Buffer.isBuffer(n)?n.readDoubleLE(a):Jw(n,a)},_g=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var tc=function(e,n){return e[n]},Qs=function(e,n){return e[n+1]*256+e[n]},ZF=function(e,n){var a=e[n+1]*256+e[n];return a<32768?a:(65535-a+1)*-1},cr=function(e,n){return e[n+3]*(1<<24)+(e[n+2]<<16)+(e[n+1]<<8)+e[n]},Ml=function(e,n){return e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]},e8=function(e,n){return e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]};function Md(e,n){var a="",r,s,l=[],o,d,u,x;switch(n){case"dbcs":if(x=this.l,bt&&Buffer.isBuffer(this))a=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)a+=String.fromCharCode(Qs(this,x)),x+=2;e*=2;break;case"utf8":a=wu(this,this.l,this.l+e);break;case"utf16le":e*=2,a=Sg(this,this.l,this.l+e);break;case"wstr":return Md.call(this,e,"dbcs");case"lpstr-ansi":a=Kw(this,this.l),e=4+cr(this,this.l);break;case"lpstr-cp":a=$w(this,this.l),e=4+cr(this,this.l);break;case"lpwstr":a=qw(this,this.l),e=4+2*cr(this,this.l);break;case"lpp4":e=4+cr(this,this.l),a=Xw(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+cr(this,this.l),a=Yw(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,a="";(o=tc(this,this.l+e++))!==0;)l.push(qh(o));a=l.join("");break;case"_wstr":for(e=0,a="";(o=Qs(this,this.l+e))!==0;)l.push(qh(o)),e+=2;e+=2,a=l.join("");break;case"dbcs-cont":for(a="",x=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(x)!==-1)return o=tc(this,x),this.l=x+1,d=Md.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),l.join("")+d;l.push(qh(Qs(this,x))),x+=2}a=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(a="",x=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(x)!==-1)return o=tc(this,x),this.l=x+1,d=Md.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),l.join("")+d;l.push(qh(tc(this,x))),x+=1}a=l.join("");break;default:switch(e){case 1:return r=tc(this,this.l),this.l++,r;case 2:return r=(n==="i"?ZF:Qs)(this,this.l),this.l+=2,r;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(r=(e>0?Ml:e8)(this,this.l),this.l+=4,r):(s=cr(this,this.l),this.l+=4,s);case 8:case-8:if(n==="f")return e==8?s=D0(this,this.l):s=D0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:a=Vw(this,this.l,e);break}}return this.l+=e,a}var t8=function(e,n,a){e[a]=n&255,e[a+1]=n>>>8&255,e[a+2]=n>>>16&255,e[a+3]=n>>>24&255},n8=function(e,n,a){e[a]=n&255,e[a+1]=n>>8&255,e[a+2]=n>>16&255,e[a+3]=n>>24&255},a8=function(e,n,a){e[a]=n&255,e[a+1]=n>>>8&255};function r8(e,n,a){var r=0,s=0;if(a==="dbcs"){for(s=0;s!=n.length;++s)a8(this,n.charCodeAt(s),this.l+2*s);r=2*n.length}else if(a==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=n.length;++s)this[this.l+s]=n.charCodeAt(s)&255;r=n.length}else if(a==="hex"){for(;s<e;++s)this[this.l++]=parseInt(n.slice(2*s,2*s+2),16)||0;return this}else if(a==="utf16le"){var l=Math.min(this.l+e,this.length);for(s=0;s<Math.min(n.length,e);++s){var o=n.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=n&255;break;case 2:r=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:r=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:r=4,t8(this,n,this.l);break;case 8:if(r=8,a==="f"){JF(this,n,this.l);break}case 16:break;case-4:r=4,n8(this,n,this.l);break}return this.l+=r,this}function Zw(e,n){var a=Vw(this,this.l,e.length>>1);if(a!==e)throw new Error(n+"Expected "+e+" saw "+a);this.l+=e.length>>1}function oa(e,n){e.l=n,e.read_shift=Md,e.chk=Zw,e.write_shift=r8}function Ta(e,n){e.l+=n}function Ce(e){var n=rl(e);return oa(n,0),n}function di(e,n,a){if(e){var r,s,l;oa(e,e.l||0);for(var o=e.length,d=0,u=0;e.l<o;){d=e.read_shift(1),d&128&&(d=(d&127)+((e.read_shift(1)&127)<<7));var x=lu[d]||lu[65535];for(r=e.read_shift(1),l=r&127,s=1;s<4&&r&128;++s)l+=((r=e.read_shift(1))&127)<<7*s;u=e.l+l;var m=x.f&&x.f(e,l,a);if(e.l=u,n(m,x,d))return}}}function tr(){var e=[],n=bt?256:2048,a=function(x){var m=Ce(x);return oa(m,0),m},r=a(n),s=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},l=function(x){return r&&x<r.length-r.l?r:(s(),r=a(Math.max(x+1,n)))},o=function(){return s(),ta(e)},d=function(x){s(),r=x,r.l==null&&(r.l=r.length),l(n)};return{next:l,push:d,end:o,_bufs:e}}function Ee(e,n,a,r){var s=+n,l;if(!isNaN(s)){r||(r=lu[s].p||(a||[]).length||0),l=1+(s>=128?1:0)+1,r>=128&&++l,r>=16384&&++l,r>=2097152&&++l;var o=e.next(l);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var d=0;d!=4;++d)if(r>=128)o.write_shift(1,(r&127)+128),r>>=7;else{o.write_shift(1,r);break}r>0&&_g(a)&&e.push(a)}}function Rd(e,n,a){var r=hn(e);if(n.s?(r.cRel&&(r.c+=n.s.c),r.rRel&&(r.r+=n.s.r)):(r.cRel&&(r.c+=n.c),r.rRel&&(r.r+=n.r)),!a||a.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function _N(e,n,a){var r=hn(e);return r.s=Rd(r.s,n.s,a),r.e=Rd(r.e,n.s,a),r}function Bd(e,n){if(e.cRel&&e.c<0)for(e=hn(e);e.c<0;)e.c+=n>8?16384:256;if(e.rRel&&e.r<0)for(e=hn(e);e.r<0;)e.r+=n>8?1048576:n>5?65536:16384;var a=dt(e);return!e.cRel&&e.cRel!=null&&(a=l8(a)),!e.rRel&&e.rRel!=null&&(a=s8(a)),a}function wf(e,n){return e.s.r==0&&!e.s.rRel&&e.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+yn(e.s.c)+":"+(e.e.cRel?"":"$")+yn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(n.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Dn(e.s.r)+":"+(e.e.rRel?"":"$")+Dn(e.e.r):Bd(e.s,n.biff)+":"+Bd(e.e,n.biff)}function Eg(e){return parseInt(i8(e),10)-1}function Dn(e){return""+(e+1)}function s8(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function i8(e){return e.replace(/\$(\d+)$/,"$1")}function Dg(e){for(var n=o8(e),a=0,r=0;r!==n.length;++r)a=26*a+n.charCodeAt(r)-64;return a-1}function yn(e){if(e<0)throw new Error("invalid column "+e);var n="";for(++e;e;e=Math.floor((e-1)/26))n=String.fromCharCode((e-1)%26+65)+n;return n}function l8(e){return e.replace(/^([A-Z])/,"$$$1")}function o8(e){return e.replace(/^\$([A-Z])/,"$1")}function c8(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function vn(e){for(var n=0,a=0,r=0;r<e.length;++r){var s=e.charCodeAt(r);s>=48&&s<=57?n=10*n+(s-48):s>=65&&s<=90&&(a=26*a+(s-64))}return{c:a-1,r:n-1}}function dt(e){for(var n=e.c+1,a="";n;n=(n-1)/26|0)a=String.fromCharCode((n-1)%26+65)+a;return a+(e.r+1)}function nr(e){var n=e.indexOf(":");return n==-1?{s:vn(e),e:vn(e)}:{s:vn(e.slice(0,n)),e:vn(e.slice(n+1))}}function pt(e,n){return typeof n>"u"||typeof n=="number"?pt(e.s,e.e):(typeof e!="string"&&(e=dt(e)),typeof n!="string"&&(n=dt(n)),e==n?e:e+":"+n)}function Ft(e){var n={s:{c:0,r:0},e:{c:0,r:0}},a=0,r=0,s=0,l=e.length;for(a=0;r<l&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)a=26*a+s;for(n.s.c=--a,a=0;r<l&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)a=10*a+s;if(n.s.r=--a,r===l||s!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++r,a=0;r!=l&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)a=26*a+s;for(n.e.c=--a,a=0;r!=l&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)a=10*a+s;return n.e.r=--a,n}function EN(e,n){var a=e.t=="d"&&n instanceof Date;if(e.z!=null)try{return e.w=Br(e.z,a?Gn(n):n)}catch{}try{return e.w=Br((e.XF||{}).numFmtId||(a?14:0),a?Gn(n):n)}catch{return""+n}}function oi(e,n,a){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&a&&a.dateNF&&(e.z=a.dateNF),e.t=="e"?ui[e.v]||e.v:n==null?EN(e,e.v):EN(e,n))}function hl(e,n){var a=n&&n.sheet?n.sheet:"Sheet1",r={};return r[a]=e,{SheetNames:[a],Sheets:r}}function ek(e,n,a){var r=a||{},s=e?Array.isArray(e):r.dense,l=e||(s?[]:{}),o=0,d=0;if(l&&r.origin!=null){if(typeof r.origin=="number")o=r.origin;else{var u=typeof r.origin=="string"?vn(r.origin):r.origin;o=u.r,d=u.c}l["!ref"]||(l["!ref"]="A1:A1")}var x={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var m=Ft(l["!ref"]);x.s.c=m.s.c,x.s.r=m.s.r,x.e.c=Math.max(x.e.c,m.e.c),x.e.r=Math.max(x.e.r,m.e.r),o==-1&&(x.e.r=o=m.e.r+1)}for(var f=0;f!=n.length;++f)if(n[f]){if(!Array.isArray(n[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=n[f].length;++p)if(!(typeof n[f][p]>"u")){var b={v:n[f][p]},g=o+f,y=d+p;if(x.s.r>g&&(x.s.r=g),x.s.c>y&&(x.s.c=y),x.e.r<g&&(x.e.r=g),x.e.c<y&&(x.e.c=y),n[f][p]&&typeof n[f][p]=="object"&&!Array.isArray(n[f][p])&&!(n[f][p]instanceof Date))b=n[f][p];else if(Array.isArray(b.v)&&(b.f=n[f][p][1],b.v=b.v[0]),b.v===null)if(b.f)b.t="n";else if(r.nullError)b.t="e",b.v=0;else if(r.sheetStubs)b.t="z";else continue;else typeof b.v=="number"?b.t="n":typeof b.v=="boolean"?b.t="b":b.v instanceof Date?(b.z=r.dateNF||ct[14],r.cellDates?(b.t="d",b.w=Br(b.z,Gn(b.v))):(b.t="n",b.v=Gn(b.v),b.w=Br(b.z,b.v))):b.t="s";if(s)l[g]||(l[g]=[]),l[g][y]&&l[g][y].z&&(b.z=l[g][y].z),l[g][y]=b;else{var N=dt({c:y,r:g});l[N]&&l[N].z&&(b.z=l[N].z),l[N]=b}}}return x.s.c<1e7&&(l["!ref"]=pt(x)),l}function Oc(e,n){return ek(null,e,n)}function d8(e){return e.read_shift(4,"i")}function ts(e,n){return n||(n=Ce(4)),n.write_shift(4,e),n}function ka(e){var n=e.read_shift(4);return n===0?"":e.read_shift(n,"dbcs")}function na(e,n){var a=!1;return n==null&&(a=!0,n=Ce(4+2*e.length)),n.write_shift(4,e.length),e.length>0&&n.write_shift(0,e,"dbcs"),a?n.slice(0,n.l):n}function u8(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function h8(e,n){return n||(n=Ce(4)),n.write_shift(2,0),n.write_shift(2,0),n}function Ag(e,n){var a=e.l,r=e.read_shift(1),s=ka(e),l=[],o={t:s,h:s};if((r&1)!==0){for(var d=e.read_shift(4),u=0;u!=d;++u)l.push(u8(e));o.r=l}else o.r=[{ich:0,ifnt:0}];return e.l=a+n,o}function x8(e,n){var a=!1;return n==null&&(a=!0,n=Ce(15+4*e.t.length)),n.write_shift(1,0),na(e.t,n),a?n.slice(0,n.l):n}var m8=Ag;function f8(e,n){var a=!1;return n==null&&(a=!0,n=Ce(23+4*e.t.length)),n.write_shift(1,1),na(e.t,n),n.write_shift(4,1),h8({},n),a?n.slice(0,n.l):n}function Vr(e){var n=e.read_shift(4),a=e.read_shift(2);return a+=e.read_shift(1)<<16,e.l++,{c:n,iStyleRef:a}}function po(e,n){return n==null&&(n=Ce(8)),n.write_shift(-4,e.c),n.write_shift(3,e.iStyleRef||e.s),n.write_shift(1,0),n}function go(e){var n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:n}}function yo(e,n){return n==null&&(n=Ce(4)),n.write_shift(3,e.iStyleRef||e.s),n.write_shift(1,0),n}var p8=ka,tk=na;function Fg(e){var n=e.read_shift(4);return n===0||n===4294967295?"":e.read_shift(n,"dbcs")}function A0(e,n){var a=!1;return n==null&&(a=!0,n=Ce(127)),n.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&n.write_shift(0,e,"dbcs"),a?n.slice(0,n.l):n}var g8=ka,wp=Fg,Lg=A0;function Pg(e){var n=e.slice(e.l,e.l+4),a=n[0]&1,r=n[0]&2;e.l+=4;var s=r===0?D0([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):Ml(n,0)>>2;return a?s/100:s}function nk(e,n){n==null&&(n=Ce(4));var a=0,r=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?r=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(r=1,a=1),r)n.write_shift(-4,((a?s:e)<<2)+(a+2));else throw new Error("unsupported RkNumber "+e)}function ak(e){var n={s:{},e:{}};return n.s.r=e.read_shift(4),n.e.r=e.read_shift(4),n.s.c=e.read_shift(4),n.e.c=e.read_shift(4),n}function y8(e,n){return n||(n=Ce(16)),n.write_shift(4,e.s.r),n.write_shift(4,e.e.r),n.write_shift(4,e.s.c),n.write_shift(4,e.e.c),n}var vo=ak,Mc=y8;function wa(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function oo(e,n){return(n||Ce(8)).write_shift(8,e,"f")}function v8(e){var n={},a=e.read_shift(1),r=a>>>1,s=e.read_shift(1),l=e.read_shift(2,"i"),o=e.read_shift(1),d=e.read_shift(1),u=e.read_shift(1);switch(e.l++,r){case 0:n.auto=1;break;case 1:n.index=s;var x=Jl[s];x&&(n.rgb=au(x));break;case 2:n.rgb=au([o,d,u]);break;case 3:n.theme=s;break}return l!=0&&(n.tint=l>0?l/32767:l/32768),n}function F0(e,n){if(n||(n=Ce(8)),!e||e.auto)return n.write_shift(4,0),n.write_shift(4,0),n;e.index!=null?(n.write_shift(1,2),n.write_shift(1,e.index)):e.theme!=null?(n.write_shift(1,6),n.write_shift(1,e.theme)):(n.write_shift(1,5),n.write_shift(1,0));var a=e.tint||0;if(a>0?a*=32767:a<0&&(a*=32768),n.write_shift(2,a),!e.rgb||e.theme!=null)n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);else{var r=e.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),n.write_shift(1,parseInt(r.slice(0,2),16)),n.write_shift(1,parseInt(r.slice(2,4),16)),n.write_shift(1,parseInt(r.slice(4,6),16)),n.write_shift(1,255)}return n}function b8(e){var n=e.read_shift(1);e.l++;var a={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return a}function N8(e,n){n||(n=Ce(2));var a=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return n.write_shift(1,a),n.write_shift(1,0),n}function rk(e,n){var a={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return a[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,n==1?"lpstr":"lpwstr")}function j8(e){return rk(e,1)}function w8(e){return rk(e,2)}var Ig=2,Qa=3,Xh=11,DN=12,L0=19,Qh=64,k8=65,T8=71,C8=4108,S8=4126,Zn=80,sk=81,_8=[Zn,sk],kp={1:{n:"CodePage",t:Ig},2:{n:"Category",t:Zn},3:{n:"PresentationFormat",t:Zn},4:{n:"ByteCount",t:Qa},5:{n:"LineCount",t:Qa},6:{n:"ParagraphCount",t:Qa},7:{n:"SlideCount",t:Qa},8:{n:"NoteCount",t:Qa},9:{n:"HiddenCount",t:Qa},10:{n:"MultimediaClipCount",t:Qa},11:{n:"ScaleCrop",t:Xh},12:{n:"HeadingPairs",t:C8},13:{n:"TitlesOfParts",t:S8},14:{n:"Manager",t:Zn},15:{n:"Company",t:Zn},16:{n:"LinksUpToDate",t:Xh},17:{n:"CharacterCount",t:Qa},19:{n:"SharedDoc",t:Xh},22:{n:"HyperlinksChanged",t:Xh},23:{n:"AppVersion",t:Qa,p:"version"},24:{n:"DigSig",t:k8},26:{n:"ContentType",t:Zn},27:{n:"ContentStatus",t:Zn},28:{n:"Language",t:Zn},29:{n:"Version",t:Zn},255:{},2147483648:{n:"Locale",t:L0},2147483651:{n:"Behavior",t:L0},1919054434:{}},Tp={1:{n:"CodePage",t:Ig},2:{n:"Title",t:Zn},3:{n:"Subject",t:Zn},4:{n:"Author",t:Zn},5:{n:"Keywords",t:Zn},6:{n:"Comments",t:Zn},7:{n:"Template",t:Zn},8:{n:"LastAuthor",t:Zn},9:{n:"RevNumber",t:Zn},10:{n:"EditTime",t:Qh},11:{n:"LastPrinted",t:Qh},12:{n:"CreatedDate",t:Qh},13:{n:"ModifiedDate",t:Qh},14:{n:"PageCount",t:Qa},15:{n:"WordCount",t:Qa},16:{n:"CharCount",t:Qa},17:{n:"Thumbnail",t:T8},18:{n:"Application",t:Zn},19:{n:"DocSecurity",t:Qa},255:{},2147483648:{n:"Locale",t:L0},2147483651:{n:"Behavior",t:L0},1919054434:{}},AN={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},E8=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function D8(e){return e.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var A8=D8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Jl=hn(A8),ui={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ik={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Cp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Yh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Og(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function F8(e){var n=Og();if(!e||!e.match)return n;var a={};if((e.match(Ca)||[]).forEach(function(r){var s=ut(r);switch(s[0].replace(UF,"<")){case"<?xml":break;case"<Types":n.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":a[s.Extension]=s.ContentType;break;case"<Override":n[Cp[s.ContentType]]!==void 0&&n[Cp[s.ContentType]].push(s.PartName);break}}),n.xmlns!==zn.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=a,delete n.calcchains,n}function lk(e,n){var a=FF(Cp),r=[],s;r[r.length]=An,r[r.length]=Ue("Types",null,{xmlns:zn.CT,"xmlns:xsd":zn.xsd,"xmlns:xsi":zn.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return Ue("Default",null,{Extension:u[0],ContentType:u[1]})}));var l=function(u){e[u]&&e[u].length>0&&(s=e[u][0],r[r.length]=Ue("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Yh[u][n.bookType]||Yh[u].xlsx}))},o=function(u){(e[u]||[]).forEach(function(x){r[r.length]=Ue("Override",null,{PartName:(x[0]=="/"?"":"/")+x,ContentType:Yh[u][n.bookType]||Yh[u].xlsx})})},d=function(u){(e[u]||[]).forEach(function(x){r[r.length]=Ue("Override",null,{PartName:(x[0]=="/"?"":"/")+x,ContentType:a[u][0]})})};return l("workbooks"),o("sheets"),o("charts"),d("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(d),d("vba"),d("comments"),d("threadedcomments"),d("drawings"),o("metadata"),d("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var jt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function nu(e){var n=e.lastIndexOf("/");return e.slice(0,n+1)+"_rels/"+e.slice(n+1)+".rels"}function Hd(e,n){var a={"!id":{}};if(!e)return a;n.charAt(0)!=="/"&&(n="/"+n);var r={};return(e.match(Ca)||[]).forEach(function(s){var l=ut(s);if(l[0]==="<Relationship"){var o={};o.Type=l.Type,o.Target=l.Target,o.Id=l.Id,l.TargetMode&&(o.TargetMode=l.TargetMode);var d=l.TargetMode==="External"?l.Target:Ld(l.Target,n);a[d]=o,r[l.Id]=o}}),a["!id"]=r,a}function ic(e){var n=[An,Ue("Relationships",null,{xmlns:zn.RELS})];return kn(e["!id"]).forEach(function(a){n[n.length]=Ue("Relationship",null,e["!id"][a])}),n.length>2&&(n[n.length]="</Relationships>",n[1]=n[1].replace("/>",">")),n.join("")}function Gt(e,n,a,r,s,l){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),n<0)for(n=e["!idx"];e["!id"]["rId"+n];++n);if(e["!idx"]=n+1,s.Id="rId"+n,s.Type=r,s.Target=a,[jt.HLINK,jt.XPATH,jt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+n);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,n}var L8="application/vnd.oasis.opendocument.spreadsheet";function P8(e,n){for(var a=Cg(e),r,s;r=tu.exec(a);)switch(r[3]){case"manifest":break;case"file-entry":if(s=ut(r[0],!1),s.path=="/"&&s.type!==L8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw r}}function I8(e){var n=[An];n.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),n.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var a=0;a<e.length;++a)n.push('  <manifest:file-entry manifest:full-path="'+e[a][0]+'" manifest:media-type="'+e[a][1]+`"/>
`);return n.push("</manifest:manifest>"),n.join("")}function FN(e,n,a){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(a||"odf")+"#"+n+`"/>
`,`  </rdf:Description>
`].join("")}function O8(e,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+n+`"/>
`,`  </rdf:Description>
`].join("")}function M8(e){var n=[An];n.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var a=0;a!=e.length;++a)n.push(FN(e[a][0],e[a][1])),n.push(O8("",e[a][0]));return n.push(FN("","Document","pkg")),n.push("</rdf:RDF>"),n.join("")}function ok(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+T0.version+"</meta:generator></office:meta></office:document-meta>"}var Ir=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],R8=(function(){for(var e=new Array(Ir.length),n=0;n<Ir.length;++n){var a=Ir[n],r="(?:"+a[0].slice(0,a[0].indexOf(":"))+":)"+a[0].slice(a[0].indexOf(":")+1);e[n]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e})();function ck(e){var n={};e=Qt(e);for(var a=0;a<Ir.length;++a){var r=Ir[a],s=e.match(R8[a]);s!=null&&s.length>0&&(n[r[1]]=Dt(s[1])),r[2]==="date"&&n[r[1]]&&(n[r[1]]=un(n[r[1]]))}return n}function kf(e,n,a,r,s){s[e]!=null||n==null||n===""||(s[e]=n,n=qt(n),r[r.length]=a?Ue(e,n,a):da(e,n))}function dk(e,n){var a=n||{},r=[An,Ue("cp:coreProperties",null,{"xmlns:cp":zn.CORE_PROPS,"xmlns:dc":zn.dc,"xmlns:dcterms":zn.dcterms,"xmlns:dcmitype":zn.dcmitype,"xmlns:xsi":zn.xsi})],s={};if(!e&&!a.Props)return r.join("");e&&(e.CreatedDate!=null&&kf("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:jp(e.CreatedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},r,s),e.ModifiedDate!=null&&kf("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:jp(e.ModifiedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},r,s));for(var l=0;l!=Ir.length;++l){var o=Ir[l],d=a.Props&&a.Props[o[1]]!=null?a.Props[o[1]]:e?e[o[1]]:null;d===!0?d="1":d===!1?d="0":typeof d=="number"&&(d=String(d)),d!=null&&kf(o[0],d,null,r,s)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Zl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],uk=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function hk(e,n,a,r){var s=[];if(typeof e=="string")s=jN(e,r);else for(var l=0;l<e.length;++l)s=s.concat(e[l].map(function(m){return{v:m}}));var o=typeof n=="string"?jN(n,r).map(function(m){return m.v}):n,d=0,u=0;if(o.length>0)for(var x=0;x!==s.length;x+=2){switch(u=+s[x+1].v,s[x].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":a.Worksheets=u,a.SheetNames=o.slice(d,d+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":a.NamedRanges=u,a.DefinedNames=o.slice(d,d+u);break;case"Charts":case"Diagramme":a.Chartsheets=u,a.ChartNames=o.slice(d,d+u);break}d+=u}}function B8(e,n,a){var r={};return n||(n={}),e=Qt(e),Zl.forEach(function(s){var l=(e.match(Zd(s[0]))||[])[1];switch(s[2]){case"string":l&&(n[s[1]]=Dt(l));break;case"bool":n[s[1]]=l==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(r[s[1]]=o[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&hk(r.HeadingPairs,r.TitlesOfParts,n,a),n}function xk(e){var n=[],a=Ue;return e||(e={}),e.Application="SheetJS",n[n.length]=An,n[n.length]=Ue("Properties",null,{xmlns:zn.EXT_PROPS,"xmlns:vt":zn.vt}),Zl.forEach(function(r){if(e[r[1]]!==void 0){var s;switch(r[2]){case"string":s=qt(String(e[r[1]]));break;case"bool":s=e[r[1]]?"true":"false";break}s!==void 0&&(n[n.length]=a(r[0],s))}}),n[n.length]=a("HeadingPairs",a("vt:vector",a("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+a("vt:variant",a("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),n[n.length]=a("TitlesOfParts",a("vt:vector",e.SheetNames.map(function(r){return"<vt:lpstr>"+qt(r)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var H8=/<[^>]+>[^<]*/g;function V8(e,n){var a={},r="",s=e.match(H8);if(s)for(var l=0;l!=s.length;++l){var o=s[l],d=ut(o);switch(d[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Dt(d.name);break;case"</property>":r=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),x=u[0].slice(4),m=u[1];switch(x){case"lpstr":case"bstr":case"lpwstr":a[r]=Dt(m);break;case"bool":a[r]=on(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":a[r]=parseInt(m,10);break;case"r4":case"r8":case"decimal":a[r]=parseFloat(m);break;case"filetime":case"date":a[r]=un(m);break;case"cy":case"error":a[r]=Dt(m);break;default:if(x.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",o,x,u)}}else if(o.slice(0,2)!=="</"){if(n.WTF)throw new Error(o)}}}return a}function mk(e){var n=[An,Ue("Properties",null,{xmlns:zn.CUST_PROPS,"xmlns:vt":zn.vt})];if(!e)return n.join("");var a=1;return kn(e).forEach(function(s){++a,n[n.length]=Ue("property",QF(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:a,name:qt(s)})}),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var Sp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Tf;function U8(e,n,a){Tf||(Tf=rx(Sp)),n=Tf[n]||n,e[n]=a}function K8(e,n){var a=[];return kn(Sp).map(function(r){for(var s=0;s<Ir.length;++s)if(Ir[s][1]==r)return Ir[s];for(s=0;s<Zl.length;++s)if(Zl[s][1]==r)return Zl[s];throw r}).forEach(function(r){if(e[r[1]]!=null){var s=n&&n.Props&&n.Props[r[1]]!=null?n.Props[r[1]]:e[r[1]];switch(r[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),a.push(da(Sp[r[1]]||r[1],s))}}),Ue("DocumentProperties",a.join(""),{xmlns:or.o})}function z8(e,n){var a=["Worksheets","SheetNames"],r="CustomDocumentProperties",s=[];return e&&kn(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)){for(var o=0;o<Ir.length;++o)if(l==Ir[o][1])return;for(o=0;o<Zl.length;++o)if(l==Zl[o][1])return;for(o=0;o<a.length;++o)if(l==a[o])return;var d=e[l],u="string";typeof d=="number"?(u="float",d=String(d)):d===!0||d===!1?(u="boolean",d=d?"1":"0"):d=String(d),s.push(Ue(yN(l),d,{"dt:dt":u}))}}),n&&kn(n).forEach(function(l){if(Object.prototype.hasOwnProperty.call(n,l)&&!(e&&Object.prototype.hasOwnProperty.call(e,l))){var o=n[l],d="string";typeof o=="number"?(d="float",o=String(o)):o===!0||o===!1?(d="boolean",o=o?"1":"0"):o instanceof Date?(d="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Ue(yN(l),o,{"dt:dt":d}))}}),"<"+r+' xmlns="'+or.o+'">'+s.join("")+"</"+r+">"}function Mg(e){var n=e.read_shift(4),a=e.read_shift(4);return new Date((a/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function $8(e){var n=typeof e=="string"?new Date(Date.parse(e)):e,a=n.getTime()/1e3+11644473600,r=a%Math.pow(2,32),s=(a-r)/Math.pow(2,32);r*=1e7,s*=1e7;var l=r/Math.pow(2,32)|0;l>0&&(r=r%Math.pow(2,32),s+=l);var o=Ce(8);return o.write_shift(4,r),o.write_shift(4,s),o}function fk(e,n,a){var r=e.l,s=e.read_shift(0,"lpstr-cp");if(a)for(;e.l-r&3;)++e.l;return s}function pk(e,n,a){var r=e.read_shift(0,"lpwstr");return r}function gk(e,n,a){return n===31?pk(e):fk(e,n,a)}function _p(e,n,a){return gk(e,n,a===!1?0:4)}function G8(e,n){if(!n)throw new Error("VtUnalignedString must have positive length");return gk(e,n,0)}function q8(e){for(var n=e.read_shift(4),a=[],r=0;r!=n;++r){var s=e.l;a[r]=e.read_shift(0,"lpwstr").replace(Ra,""),e.l-s&2&&(e.l+=2)}return a}function W8(e){for(var n=e.read_shift(4),a=[],r=0;r!=n;++r)a[r]=e.read_shift(0,"lpstr-cp").replace(Ra,"");return a}function X8(e){var n=e.l,a=P0(e,sk);e[e.l]==0&&e[e.l+1]==0&&e.l-n&2&&(e.l+=2);var r=P0(e,Qa);return[a,r]}function Q8(e){for(var n=e.read_shift(4),a=[],r=0;r<n/2;++r)a.push(X8(e));return a}function LN(e,n){for(var a=e.read_shift(4),r={},s=0;s!=a;++s){var l=e.read_shift(4),o=e.read_shift(4);r[l]=e.read_shift(o,n===1200?"utf16le":"utf8").replace(Ra,"").replace(Fd,"!"),n===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function yk(e){var n=e.read_shift(4),a=e.slice(e.l,e.l+n);return e.l+=n,(n&3)>0&&(e.l+=4-(n&3)&3),a}function Y8(e){var n={};return n.Size=e.read_shift(4),e.l+=n.Size+3-(n.Size-1)%4,n}function P0(e,n,a){var r=e.read_shift(2),s,l=a||{};if(e.l+=2,n!==DN&&r!==n&&_8.indexOf(n)===-1&&!((n&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+n+" saw "+r);switch(n===DN?r:n){case 2:return s=e.read_shift(2,"i"),l.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return fk(e,r,4).replace(Ra,"");case 31:return pk(e);case 64:return Mg(e);case 65:return yk(e);case 71:return Y8(e);case 80:return _p(e,r,!l.raw).replace(Ra,"");case 81:return G8(e,r).replace(Ra,"");case 4108:return Q8(e);case 4126:case 4127:return r==4127?q8(e):W8(e);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+r)}}function PN(e,n){var a=Ce(4),r=Ce(4);switch(a.write_shift(4,e==80?31:e),e){case 3:r.write_shift(-4,n);break;case 5:r=Ce(8),r.write_shift(8,n,"f");break;case 11:r.write_shift(4,n?1:0);break;case 64:r=$8(n);break;case 31:case 80:for(r=Ce(4+2*(n.length+1)+(n.length%2?0:2)),r.write_shift(4,n.length+1),r.write_shift(0,n,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}return ta([a,r])}function IN(e,n){var a=e.l,r=e.read_shift(4),s=e.read_shift(4),l=[],o=0,d=0,u=-1,x={};for(o=0;o!=s;++o){var m=e.read_shift(4),f=e.read_shift(4);l[o]=[m,f+a]}l.sort(function(T,S){return T[1]-S[1]});var p={};for(o=0;o!=s;++o){if(e.l!==l[o][1]){var b=!0;if(o>0&&n)switch(n[l[o-1][0]].t){case 2:e.l+2===l[o][1]&&(e.l+=2,b=!1);break;case 80:e.l<=l[o][1]&&(e.l=l[o][1],b=!1);break;case 4108:e.l<=l[o][1]&&(e.l=l[o][1],b=!1);break}if((!n||o==0)&&e.l<=l[o][1]&&(b=!1,e.l=l[o][1]),b)throw new Error("Read Error: Expected address "+l[o][1]+" at "+e.l+" :"+o)}if(n){var g=n[l[o][0]];if(p[g.n]=P0(e,g.t,{raw:!0}),g.p==="version"&&(p[g.n]=String(p[g.n]>>16)+"."+("0000"+String(p[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(p[g.n]){case 0:p[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Jr(d=p[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[g.n])}}else if(l[o][0]===1){if(d=p.CodePage=P0(e,Ig),Jr(d),u!==-1){var y=e.l;e.l=l[u][1],x=LN(e,d),e.l=y}}else if(l[o][0]===0){if(d===0){u=o,e.l=l[o+1][1];continue}x=LN(e,d)}else{var N=x[l[o][0]],k;switch(e[e.l]){case 65:e.l+=4,k=yk(e);break;case 30:e.l+=4,k=_p(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=_p(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=_n(e,4);break;case 64:e.l+=4,k=un(Mg(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[N]=k}}return e.l=a+r,p}var vk=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function J8(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function ON(e,n,a){var r=Ce(8),s=[],l=[],o=8,d=0,u=Ce(8),x=Ce(8);if(u.write_shift(4,2),u.write_shift(4,1200),x.write_shift(4,1),l.push(u),s.push(x),o+=8+u.length,!n){x=Ce(8),x.write_shift(4,0),s.unshift(x);var m=[Ce(4)];for(m[0].write_shift(4,e.length),d=0;d<e.length;++d){var f=e[d][0];for(u=Ce(8+2*(f.length+1)+(f.length%2?0:2)),u.write_shift(4,d+2),u.write_shift(4,f.length+1),u.write_shift(0,f,"dbcs");u.l!=u.length;)u.write_shift(1,0);m.push(u)}u=ta(m),l.unshift(u),o+=8+u.length}for(d=0;d<e.length;++d)if(!(n&&!n[e[d][0]])&&!(vk.indexOf(e[d][0])>-1||uk.indexOf(e[d][0])>-1)&&e[d][1]!=null){var p=e[d][1],b=0;if(n){b=+n[e[d][0]];var g=a[b];if(g.p=="version"&&typeof p=="string"){var y=p.split(".");p=(+y[0]<<16)+(+y[1]||0)}u=PN(g.t,p)}else{var N=J8(p);N==-1&&(N=31,p=String(p)),u=PN(N,p)}l.push(u),x=Ce(8),x.write_shift(4,n?b:2+d),s.push(x),o+=8+u.length}var k=8*(l.length+1);for(d=0;d<l.length;++d)s[d].write_shift(4,k),k+=l[d].length;return r.write_shift(4,o),r.write_shift(4,l.length),ta([r].concat(s).concat(l))}function MN(e,n,a){var r=e.content;if(!r)return{};oa(r,0);var s,l,o,d,u=0;r.chk("feff","Byte Order: "),r.read_shift(2);var x=r.read_shift(4),m=r.read_shift(16);if(m!==at.utils.consts.HEADER_CLSID&&m!==a)throw new Error("Bad PropertySet CLSID "+m);if(s=r.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(l=r.read_shift(16),d=r.read_shift(4),s===1&&d!==r.l)throw new Error("Length mismatch: "+d+" !== "+r.l);s===2&&(o=r.read_shift(16),u=r.read_shift(4));var f=IN(r,n),p={SystemIdentifier:x};for(var b in f)p[b]=f[b];if(p.FMTID=l,s===1)return p;if(u-r.l==2&&(r.l+=2),r.l!==u)throw new Error("Length mismatch 2: "+r.l+" !== "+u);var g;try{g=IN(r,null)}catch{}for(b in g)p[b]=g[b];return p.FMTID=[l,o],p}function RN(e,n,a,r,s,l){var o=Ce(s?68:48),d=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,at.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,n,"hex"),o.write_shift(4,s?68:48);var u=ON(e,a,r);if(d.push(u),s){var x=ON(s,null,null);o.write_shift(16,l,"hex"),o.write_shift(4,68+u.length),d.push(x)}return ta(d)}function Oi(e,n){return e.read_shift(n),null}function Z8(e,n){n||(n=Ce(e));for(var a=0;a<e;++a)n.write_shift(1,0);return n}function eL(e,n,a){for(var r=[],s=e.l+n;e.l<s;)r.push(a(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return r}function _n(e,n){return e.read_shift(n)===1}function Ia(e,n){return n||(n=Ce(2)),n.write_shift(2,+!!e),n}function On(e){return e.read_shift(2,"u")}function _r(e,n){return n||(n=Ce(2)),n.write_shift(2,e),n}function bk(e,n){return eL(e,n,On)}function tL(e){var n=e.read_shift(1),a=e.read_shift(1);return a===1?n:n===1}function Nk(e,n,a){return a||(a=Ce(2)),a.write_shift(1,n=="e"?+e:+!!e),a.write_shift(1,n=="e"?1:0),a}function ku(e,n,a){var r=e.read_shift(a&&a.biff>=12?2:1),s="sbcs-cont";if(a&&a.biff>=8,!a||a.biff==8){var l=e.read_shift(1);l&&(s="dbcs-cont")}else a.biff==12&&(s="wstr");a.biff>=2&&a.biff<=5&&(s="cpstr");var o=r?e.read_shift(r,s):"";return o}function nL(e){var n=e.read_shift(2),a=e.read_shift(1),r=a&4,s=a&8,l=1+(a&1),o=0,d,u={};s&&(o=e.read_shift(2)),r&&(d=e.read_shift(4));var x=l==2?"dbcs-cont":"sbcs-cont",m=n===0?"":e.read_shift(n,x);return s&&(e.l+=4*o),r&&(e.l+=d),u.t=m,s||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function aL(e){var n=e.t||"",a=Ce(3);a.write_shift(2,n.length),a.write_shift(1,1);var r=Ce(2*n.length);r.write_shift(2*n.length,n,"utf16le");var s=[a,r];return ta(s)}function co(e,n,a){var r;if(a){if(a.biff>=2&&a.biff<=5)return e.read_shift(n,"cpstr");if(a.biff>=12)return e.read_shift(n,"dbcs-cont")}var s=e.read_shift(1);return s===0?r=e.read_shift(n,"sbcs-cont"):r=e.read_shift(n,"dbcs-cont"),r}function Tu(e,n,a){var r=e.read_shift(a&&a.biff==2?1:2);return r===0?(e.l++,""):co(e,r,a)}function bo(e,n,a){if(a.biff>5)return Tu(e,n,a);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,a.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function jk(e,n,a){return a||(a=Ce(3+2*e.length)),a.write_shift(2,e.length),a.write_shift(1,1),a.write_shift(31,e,"utf16le"),a}function rL(e){var n=e.read_shift(1);e.l++;var a=e.read_shift(2);return e.l+=2,[n,a]}function sL(e){var n=e.read_shift(4),a=e.l,r=!1;n>24&&(e.l+=n-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=a);var s=e.read_shift((r?n-24:n)>>1,"utf16le").replace(Ra,"");return r&&(e.l+=24),s}function iL(e){for(var n=e.read_shift(2),a="";n-- >0;)a+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return a+r.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(l>>1,"utf16le").replace(Ra,"");return a+o}function lL(e,n){var a=e.read_shift(16);switch(a){case"e0c9ea79f9bace118c8200aa004ba90b":return sL(e);case"0303000000000000c000000000000046":return iL(e);default:throw new Error("Unsupported Moniker "+a)}}function Jh(e){var n=e.read_shift(4),a=n>0?e.read_shift(n,"utf16le").replace(Ra,""):"";return a}function BN(e,n){n||(n=Ce(6+e.length*2)),n.write_shift(4,1+e.length);for(var a=0;a<e.length;++a)n.write_shift(2,e.charCodeAt(a));return n.write_shift(2,0),n}function oL(e,n){var a=e.l+n,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var s=e.read_shift(2);e.l+=2;var l,o,d,u,x="",m,f;s&16&&(l=Jh(e,a-e.l)),s&128&&(o=Jh(e,a-e.l)),(s&257)===257&&(d=Jh(e,a-e.l)),(s&257)===1&&(u=lL(e,a-e.l)),s&8&&(x=Jh(e,a-e.l)),s&32&&(m=e.read_shift(16)),s&64&&(f=Mg(e)),e.l=a;var p=o||d||u||"";p&&x&&(p+="#"+x),p||(p="#"+x),s&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var b={Target:p};return m&&(b.guid=m),f&&(b.time=f),l&&(b.Tooltip=l),b}function cL(e){var n=Ce(512),a=0,r=e.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var s=r.indexOf("#"),l=s>-1?31:23;switch(r.charAt(0)){case"#":l=28;break;case".":l&=-3;break}n.write_shift(4,2),n.write_shift(4,l);var o=[8,6815827,6619237,4849780,83];for(a=0;a<o.length;++a)n.write_shift(4,o[a]);if(l==28)r=r.slice(1),BN(r,n);else if(l&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<o.length;++a)n.write_shift(1,parseInt(o[a],16));var d=s>-1?r.slice(0,s):r;for(n.write_shift(4,2*(d.length+1)),a=0;a<d.length;++a)n.write_shift(2,d.charCodeAt(a));n.write_shift(2,0),l&8&&BN(s>-1?r.slice(s+1):"",n)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),a=0;a<o.length;++a)n.write_shift(1,parseInt(o[a],16));for(var u=0;r.slice(u*3,u*3+3)=="../"||r.slice(u*3,u*3+3)=="..\\";)++u;for(n.write_shift(2,u),n.write_shift(4,r.length-3*u+1),a=0;a<r.length-3*u;++a)n.write_shift(1,r.charCodeAt(a+3*u)&255);for(n.write_shift(1,0),n.write_shift(2,65535),n.write_shift(2,57005),a=0;a<6;++a)n.write_shift(4,0)}return n.slice(0,n.l)}function wk(e){var n=e.read_shift(1),a=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1);return[n,a,r,s]}function kk(e,n){var a=wk(e);return a[3]=0,a}function Ds(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2);return{r:n,c:a,ixfe:r}}function uo(e,n,a,r){return r||(r=Ce(6)),r.write_shift(2,e),r.write_shift(2,n),r.write_shift(2,a||0),r}function dL(e){var n=e.read_shift(2),a=e.read_shift(2);return e.l+=8,{type:n,flags:a}}function uL(e,n,a){return n===0?"":bo(e,n,a)}function hL(e,n,a){var r=a.biff>8?4:2,s=e.read_shift(r),l=e.read_shift(r,"i"),o=e.read_shift(r,"i");return[s,l,o]}function Tk(e){var n=e.read_shift(2),a=Pg(e);return[n,a]}function xL(e,n,a){e.l+=4,n-=4;var r=e.l+n,s=ku(e,n,a),l=e.read_shift(2);if(r-=e.l,l!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+l);return e.l+=l,s}function lx(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{s:{c:r,r:n},e:{c:s,r:a}}}function Ck(e,n){return n||(n=Ce(8)),n.write_shift(2,e.s.r),n.write_shift(2,e.e.r),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c),n}function Sk(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(1),s=e.read_shift(1);return{s:{c:r,r:n},e:{c:s,r:a}}}var mL=Sk;function _k(e){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[a,n,r]}function fL(e){var n={};return e.l+=4,e.l+=16,n.fSharedNote=e.read_shift(2),e.l+=4,n}function pL(e){var n={};return e.l+=4,e.cf=e.read_shift(2),n}function ga(e){e.l+=2,e.l+=e.read_shift(2)}var gL={0:ga,4:ga,5:ga,6:ga,7:pL,8:ga,9:ga,10:ga,11:ga,12:ga,13:fL,14:ga,15:ga,16:ga,17:ga,18:ga,19:ga,20:ga,21:_k};function yL(e,n){for(var a=e.l+n,r=[];e.l<a;){var s=e.read_shift(2);e.l-=2;try{r.push(gL[s](e,a-e.l))}catch{return e.l=a,r}}return e.l!=a&&(e.l=a),r}function Zh(e,n){var a={BIFFVer:0,dt:0};switch(a.BIFFVer=e.read_shift(2),n-=2,n>=2&&(a.dt=e.read_shift(2),e.l-=2),a.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+a.BIFFVer)}return e.read_shift(n),a}function Rg(e,n,a){var r=1536,s=16;switch(a.bookType){case"biff8":break;case"biff5":r=1280,s=8;break;case"biff4":r=4,s=6;break;case"biff3":r=3,s=6;break;case"biff2":r=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=Ce(s);return l.write_shift(2,r),l.write_shift(2,n),s>4&&l.write_shift(2,29282),s>6&&l.write_shift(2,1997),s>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function vL(e,n){return n===0||e.read_shift(2),1200}function bL(e,n,a){if(a.enc)return e.l+=n,"";var r=e.l,s=bo(e,0,a);return e.read_shift(n+r-e.l),s}function NL(e,n){var a=!n||n.biff==8,r=Ce(a?112:54);for(r.write_shift(n.biff==8?2:1,7),a&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(a?0:536870912));r.l<r.length;)r.write_shift(1,a?0:32);return r}function jL(e,n,a){var r=a&&a.biff==8||n==2?e.read_shift(2):(e.l+=n,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function wL(e,n,a){var r=e.read_shift(4),s=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var o=ku(e,0,a);return o.length===0&&(o="Sheet1"),{pos:r,hs:s,dt:l,name:o}}function kL(e,n){var a=!n||n.biff>=8?2:1,r=Ce(8+a*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),n.biff>=8&&r.write_shift(1,1),r.write_shift(a*e.name.length,e.name,n.biff<8?"sbcs":"utf16le");var s=r.slice(0,r.l);return s.l=r.l,s}function TL(e,n){for(var a=e.l+n,r=e.read_shift(4),s=e.read_shift(4),l=[],o=0;o!=s&&e.l<a;++o)l.push(nL(e));return l.Count=r,l.Unique=s,l}function CL(e,n){var a=Ce(8);a.write_shift(4,e.Count),a.write_shift(4,e.Unique);for(var r=[],s=0;s<e.length;++s)r[s]=aL(e[s]);var l=ta([a].concat(r));return l.parts=[a.length].concat(r.map(function(o){return o.length})),l}function SL(e,n){var a={};return a.dsst=e.read_shift(2),e.l+=n-2,a}function _L(e){var n={};n.r=e.read_shift(2),n.c=e.read_shift(2),n.cnt=e.read_shift(2)-n.c;var a=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(n.level=r&7),r&32&&(n.hidden=!0),r&64&&(n.hpt=a/20),n}function EL(e){var n=dL(e);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var a=e.read_shift(4);return a!==0}function DL(e){return e.read_shift(2),e.read_shift(4)}function HN(e,n,a){var r=0;a&&a.biff==2||(r=e.read_shift(2));var s=e.read_shift(2);a&&a.biff==2&&(r=1-(s>>15),s&=32767);var l={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[l,s]}function AL(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),d=e.read_shift(2),u=e.read_shift(2),x=e.read_shift(2);return{Pos:[n,a],Dim:[r,s],Flags:l,CurTab:o,FirstTab:d,Selected:u,TabRatio:x}}function FL(){var e=Ce(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function LL(e,n,a){if(a&&a.biff>=2&&a.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function PL(e){var n=Ce(18),a=1718;return e&&e.RTL&&(a|=64),n.write_shift(2,a),n.write_shift(4,0),n.write_shift(4,64),n.write_shift(4,0),n.write_shift(4,0),n}function IL(){}function OL(e,n,a){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(a&&a.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=ku(e,0,a),r}function ML(e,n){var a=e.name||"Arial",r=n&&n.biff==5,s=r?15+a.length:16+2*a.length,l=Ce(s);return l.write_shift(2,e.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,a.length),r||l.write_shift(1,1),l.write_shift((r?1:2)*a.length,a,r?"sbcs":"utf16le"),l}function RL(e){var n=Ds(e);return n.isst=e.read_shift(4),n}function BL(e,n,a,r){var s=Ce(10);return uo(e,n,r,s),s.write_shift(4,a),s}function HL(e,n,a){a.biffguess&&a.biff==2&&(a.biff=5);var r=e.l+n,s=Ds(e);a.biff==2&&e.l++;var l=Tu(e,r-e.l,a);return s.val=l,s}function VL(e,n,a,r,s){var l=!s||s.biff==8,o=Ce(8+ +l+(1+l)*a.length);return uo(e,n,r,o),o.write_shift(2,a.length),l&&o.write_shift(1,1),o.write_shift((1+l)*a.length,a,l?"utf16le":"sbcs"),o}function UL(e,n,a){var r=e.read_shift(2),s=bo(e,0,a);return[r,s]}function KL(e,n,a,r){var s=a&&a.biff==5;r||(r=Ce(s?3+n.length:5+2*n.length)),r.write_shift(2,e),r.write_shift(s?1:2,n.length),s||r.write_shift(1,1),r.write_shift((s?1:2)*n.length,n,s?"sbcs":"utf16le");var l=r.length>r.l?r.slice(0,r.l):r;return l.l==null&&(l.l=l.length),l}var zL=bo;function VN(e,n,a){var r=e.l+n,s=a.biff==8||!a.biff?4:2,l=e.read_shift(s),o=e.read_shift(s),d=e.read_shift(2),u=e.read_shift(2);return e.l=r,{s:{r:l,c:d},e:{r:o,c:u}}}function $L(e,n){var a=n.biff==8||!n.biff?4:2,r=Ce(2*a+6);return r.write_shift(a,e.s.r),r.write_shift(a,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}function GL(e){var n=e.read_shift(2),a=e.read_shift(2),r=Tk(e);return{r:n,c:a,ixfe:r[0],rknum:r[1]}}function qL(e,n){for(var a=e.l+n-2,r=e.read_shift(2),s=e.read_shift(2),l=[];e.l<a;)l.push(Tk(e));if(e.l!==a)throw new Error("MulRK read error");var o=e.read_shift(2);if(l.length!=o-s+1)throw new Error("MulRK length mismatch");return{r,c:s,C:o,rkrec:l}}function WL(e,n){for(var a=e.l+n-2,r=e.read_shift(2),s=e.read_shift(2),l=[];e.l<a;)l.push(e.read_shift(2));if(e.l!==a)throw new Error("MulBlank read error");var o=e.read_shift(2);if(l.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r,c:s,C:o,ixfe:l}}function XL(e,n,a,r){var s={},l=e.read_shift(4),o=e.read_shift(4),d=e.read_shift(4),u=e.read_shift(2);return s.patternType=E8[d>>26],r.cellStyles&&(s.alc=l&7,s.fWrap=l>>3&1,s.alcV=l>>4&7,s.fJustLast=l>>7&1,s.trot=l>>8&255,s.cIndent=l>>16&15,s.fShrinkToFit=l>>20&1,s.iReadOrder=l>>22&2,s.fAtrNum=l>>26&1,s.fAtrFnt=l>>27&1,s.fAtrAlc=l>>28&1,s.fAtrBdr=l>>29&1,s.fAtrPat=l>>30&1,s.fAtrProt=l>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=d&127,s.icvBottom=d>>7&127,s.icvDiag=d>>14&127,s.dgDiag=d>>21&15,s.icvFore=u&127,s.icvBack=u>>7&127,s.fsxButton=u>>14&1),s}function QL(e,n,a){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,n-=6,r.data=XL(e,n,r.fStyle,a),r}function UN(e,n,a,r){var s=a&&a.biff==5;r||(r=Ce(s?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,n<<4));var l=0;return e.numFmtId>0&&s&&(l|=1024),r.write_shift(4,l),r.write_shift(4,0),s||r.write_shift(4,0),r.write_shift(2,0),r}function YL(e){e.l+=4;var n=[e.read_shift(2),e.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function JL(e){var n=Ce(8);return n.write_shift(4,0),n.write_shift(2,0),n.write_shift(2,0),n}function KN(e,n,a){var r=Ds(e);(a.biff==2||n==9)&&++e.l;var s=tL(e);return r.val=s,r.t=s===!0||s===!1?"b":"e",r}function ZL(e,n,a,r,s,l){var o=Ce(8);return uo(e,n,r,o),Nk(a,l,o),o}function eP(e,n,a){a.biffguess&&a.biff==2&&(a.biff=5);var r=Ds(e),s=wa(e);return r.val=s,r}function tP(e,n,a,r){var s=Ce(14);return uo(e,n,r,s),oo(a,s),s}var zN=uL;function nP(e,n,a){var r=e.l+n,s=e.read_shift(2),l=e.read_shift(2);if(a.sbcch=l,l==1025||l==14849)return[l,s];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var o=co(e,l),d=[];r>e.l;)d.push(Tu(e));return[l,s,o,d]}function $N(e,n,a){var r=e.read_shift(2),s,l={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return a.sbcch===14849&&(s=xL(e,n-2,a)),l.body=s||e.read_shift(n-2),typeof s=="string"&&(l.Name=s),l}var aP=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function GN(e,n,a){var r=e.l+n,s=e.read_shift(2),l=e.read_shift(1),o=e.read_shift(1),d=e.read_shift(a&&a.biff==2?1:2),u=0;(!a||a.biff>=5)&&(a.biff!=5&&(e.l+=2),u=e.read_shift(2),a.biff==5&&(e.l+=2),e.l+=4);var x=co(e,o,a);s&32&&(x=aP[x.charCodeAt(0)]);var m=r-e.l;a&&a.biff==2&&--m;var f=r==e.l||d===0||!(m>0)?[]:y7(e,m,a,d);return{chKey:l,Name:x,itab:u,rgce:f}}function Ek(e,n,a){if(a.biff<8)return rP(e,n,a);for(var r=[],s=e.l+n,l=e.read_shift(a.biff>8?4:2);l--!==0;)r.push(hL(e,a.biff>8?12:6,a));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return r}function rP(e,n,a){e[e.l+1]==3&&e[e.l]++;var r=ku(e,n,a);return r.charCodeAt(0)==3?r.slice(1):r}function sP(e,n,a){if(a.biff<8){e.l+=n;return}var r=e.read_shift(2),s=e.read_shift(2),l=co(e,r,a),o=co(e,s,a);return[l,o]}function iP(e,n,a){var r=Sk(e);e.l++;var s=e.read_shift(1);return n-=8,[v7(e,n,a),s,r]}function qN(e,n,a){var r=mL(e);switch(a.biff){case 2:e.l++,n-=7;break;case 3:case 4:e.l+=2,n-=8;break;default:e.l+=6,n-=12}return[r,p7(e,n,a)]}function lP(e){var n=e.read_shift(4)!==0,a=e.read_shift(4)!==0,r=e.read_shift(4);return[n,a,r]}function oP(e,n,a){if(!(a.biff<8)){var r=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),d=bo(e,0,a);return a.biff<8&&e.read_shift(1),[{r,c:s},d,o,l]}}function cP(e,n,a){return oP(e,n,a)}function dP(e,n){for(var a=[],r=e.read_shift(2);r--;)a.push(lx(e));return a}function uP(e){var n=Ce(2+e.length*8);n.write_shift(2,e.length);for(var a=0;a<e.length;++a)Ck(e[a],n);return n}function hP(e,n,a){if(a&&a.biff<8)return mP(e,n,a);var r=_k(e),s=yL(e,n-22,r[1]);return{cmo:r,ft:s}}var xP={8:function(e,n){var a=e.l+n;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=a,{fmt:r}}};function mP(e,n,a){e.l+=4;var r=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,n-=36;var o=[];return o.push((xP[r]||Ta)(e,n,a)),{cmo:[s,r,l],ft:o}}function fP(e,n,a){var r=e.l,s="";try{e.l+=4;var l=(a.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:o=rL(e,6,a);var d=e.read_shift(2);e.read_shift(2),On(e,2);var u=e.read_shift(2);e.l+=u;for(var x=1;x<e.lens.length-1;++x){if(e.l-r!=e.lens[x])throw new Error("TxO: bad continue record");var m=e[e.l],f=co(e,e.lens[x+1]-e.lens[x]-1);if(s+=f,s.length>=(m?d:2*d))break}if(s.length!==d&&s.length!==d*2)throw new Error("cchText: "+d+" != "+s.length);return e.l=r+n,{t:s}}catch{return e.l=r+n,{t:s}}}function pP(e,n){var a=lx(e);e.l+=16;var r=oL(e,n-24);return[a,r]}function gP(e){var n=Ce(24),a=vn(e[0]);n.write_shift(2,a.r),n.write_shift(2,a.r),n.write_shift(2,a.c),n.write_shift(2,a.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)n.write_shift(1,parseInt(r[s],16));return ta([n,cL(e[1])])}function yP(e,n){e.read_shift(2);var a=lx(e),r=e.read_shift((n-10)/2,"dbcs-cont");return r=r.replace(Ra,""),[a,r]}function vP(e){var n=e[1].Tooltip,a=Ce(10+2*(n.length+1));a.write_shift(2,2048);var r=vn(e[0]);a.write_shift(2,r.r),a.write_shift(2,r.r),a.write_shift(2,r.c),a.write_shift(2,r.c);for(var s=0;s<n.length;++s)a.write_shift(2,n.charCodeAt(s));return a.write_shift(2,0),a}function bP(e){var n=[0,0],a;return a=e.read_shift(2),n[0]=AN[a]||a,a=e.read_shift(2),n[1]=AN[a]||a,n}function NP(e){return e||(e=Ce(4)),e.write_shift(2,1),e.write_shift(2,1),e}function jP(e){for(var n=e.read_shift(2),a=[];n-- >0;)a.push(kk(e));return a}function wP(e){for(var n=e.read_shift(2),a=[];n-- >0;)a.push(kk(e));return a}function kP(e){e.l+=2;var n={cxfs:0,crc:0};return n.cxfs=e.read_shift(2),n.crc=e.read_shift(4),n}function Dk(e,n,a){if(!a.cellStyles)return Ta(e,n);var r=a&&a.biff>=12?4:2,s=e.read_shift(r),l=e.read_shift(r),o=e.read_shift(r),d=e.read_shift(r),u=e.read_shift(2);r==2&&(e.l+=2);var x={s,e:l,w:o,ixfe:d,flags:u};return(a.biff>=5||!a.biff)&&(x.level=u>>8&7),x}function TP(e,n){var a=Ce(12);a.write_shift(2,n),a.write_shift(2,n),a.write_shift(2,e.width*256),a.write_shift(2,0);var r=0;return e.hidden&&(r|=1),a.write_shift(1,r),r=e.level||0,a.write_shift(1,r),a.write_shift(2,0),a}function CP(e,n){var a={};return n<32||(e.l+=16,a.header=wa(e),a.footer=wa(e),e.l+=2),a}function SP(e,n,a){var r={area:!1};if(a.biff!=5)return e.l+=n,r;var s=e.read_shift(1);return e.l+=3,s&16&&(r.area=!0),r}function _P(e){for(var n=Ce(2*e),a=0;a<e;++a)n.write_shift(2,a+1);return n}var EP=Ds,DP=bk,AP=Tu;function FP(e){var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(4),s={fmt:n,env:a,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,s}function LP(e,n,a){a.biffguess&&a.biff==5&&(a.biff=2);var r=Ds(e);++e.l;var s=bo(e,n-7,a);return r.t="str",r.val=s,r}function PP(e){var n=Ds(e);++e.l;var a=wa(e);return n.t="n",n.val=a,n}function IP(e,n,a){var r=Ce(15);return Eu(r,e,n),r.write_shift(8,a,"f"),r}function OP(e){var n=Ds(e);++e.l;var a=e.read_shift(2);return n.t="n",n.val=a,n}function MP(e,n,a){var r=Ce(9);return Eu(r,e,n),r.write_shift(2,a),r}function RP(e){var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,"sbcs-cont")}function BP(e,n){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=n-13}function HP(e,n,a){var r=e.l+n,s=Ds(e),l=e.read_shift(2),o=co(e,l,a);return e.l=r,s.t="str",s.val=o,s}var VP=[2,3,48,49,131,139,140,245],Ep=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=rx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function a(d,u){var x=[],m=rl(1);switch(u.type){case"base64":m=dr(xr(d));break;case"binary":m=dr(d);break;case"buffer":case"array":m=d;break}oa(m,0);var f=m.read_shift(1),p=!!(f&136),b=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:b=!0,p=!0;break;case 49:b=!0,p=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var y=0,N=521;f==2&&(y=m.read_shift(2)),m.l+=3,f!=2&&(y=m.read_shift(4)),y>1048576&&(y=1e6),f!=2&&(N=m.read_shift(2));var k=m.read_shift(2),T=u.codepage||1252;f!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(T=e[m[m.l]]),m.l+=1,m.l+=2),g&&(m.l+=36);for(var S=[],w={},_=Math.min(m.length,f==2?521:N-10-(b?264:0)),L=g?32:11;m.l<_&&m[m.l]!=13;)switch(w={},w.name=Qd.utils.decode(T,m.slice(m.l,m.l+L)).replace(/[\u0000\r\n].*$/g,""),m.l+=L,w.type=String.fromCharCode(m.read_shift(1)),f!=2&&!g&&(w.offset=m.read_shift(4)),w.len=m.read_shift(1),f==2&&(w.offset=m.read_shift(2)),w.dec=m.read_shift(1),w.name.length&&S.push(w),f!=2&&(m.l+=g?13:14),w.type){case"B":(!b||w.len!=8)&&u.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(m[m.l]!==13&&(m.l=N-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=N;var C=0,P=0;for(x[0]=[],P=0;P!=S.length;++P)x[0][P]=S[P].name;for(;y-- >0;){if(m[m.l]===42){m.l+=k;continue}for(++m.l,x[++C]=[],P=0,P=0;P!=S.length;++P){var F=m.slice(m.l,m.l+S[P].len);m.l+=S[P].len,oa(F,0);var H=Qd.utils.decode(T,F);switch(S[P].type){case"C":H.trim().length&&(x[C][P]=H.replace(/\s+$/,""));break;case"D":H.length===8?x[C][P]=new Date(+H.slice(0,4),+H.slice(4,6)-1,+H.slice(6,8)):x[C][P]=H;break;case"F":x[C][P]=parseFloat(H.trim());break;case"+":case"I":x[C][P]=g?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(H.trim().toUpperCase()){case"Y":case"T":x[C][P]=!0;break;case"N":case"F":x[C][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+H+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));x[C][P]="##MEMO##"+(g?parseInt(H.trim(),10):F.read_shift(4));break;case"N":H=H.replace(/\u0000/g,"").trim(),H&&H!="."&&(x[C][P]=+H||0);break;case"@":x[C][P]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":x[C][P]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":x[C][P]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":x[C][P]=-F.read_shift(-8,"f");break;case"B":if(b&&S[P].len==8){x[C][P]=F.read_shift(8,"f");break}case"G":case"P":F.l+=S[P].len;break;case"0":if(S[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[P].type)}}}if(f!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return u&&u.sheetRows&&(x=x.slice(0,u.sheetRows)),u.DBF=S,x}function r(d,u){var x=u||{};x.dateNF||(x.dateNF="yyyymmdd");var m=Oc(a(d,x),x);return m["!cols"]=x.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete x.DBF,m}function s(d,u){try{return hl(r(d,u),u)}catch(x){if(u&&u.WTF)throw x}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function o(d,u){var x=u||{};if(+x.codepage>=0&&Jr(+x.codepage),x.type=="string")throw new Error("Cannot write DBF to JS string");var m=tr(),f=R0(d,{header:1,raw:!0,cellDates:!0}),p=f[0],b=f.slice(1),g=d["!cols"]||[],y=0,N=0,k=0,T=1;for(y=0;y<p.length;++y){if(((g[y]||{}).DBF||{}).name){p[y]=g[y].DBF.name,++k;continue}if(p[y]!=null){if(++k,typeof p[y]=="number"&&(p[y]=p[y].toString(10)),typeof p[y]!="string")throw new Error("DBF Invalid column name "+p[y]+" |"+typeof p[y]+"|");if(p.indexOf(p[y])!==y){for(N=0;N<1024;++N)if(p.indexOf(p[y]+"_"+N)==-1){p[y]+="_"+N;break}}}}var S=Ft(d["!ref"]),w=[],_=[],L=[];for(y=0;y<=S.e.c-S.s.c;++y){var C="",P="",F=0,H=[];for(N=0;N<b.length;++N)b[N][y]!=null&&H.push(b[N][y]);if(H.length==0||p[y]==null){w[y]="?";continue}for(N=0;N<H.length;++N){switch(typeof H[N]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=H[N]instanceof Date?"D":"C";break;default:P="C"}F=Math.max(F,String(H[N]).length),C=C&&C!=P?"C":P}F>250&&(F=250),P=((g[y]||{}).DBF||{}).type,P=="C"&&g[y].DBF.len>F&&(F=g[y].DBF.len),C=="B"&&P=="N"&&(C="N",L[y]=g[y].DBF.dec,F=g[y].DBF.len),_[y]=C=="C"||P=="N"?F:l[C]||0,T+=_[y],w[y]=C}var O=m.next(32);for(O.write_shift(4,318902576),O.write_shift(4,b.length),O.write_shift(2,296+32*k),O.write_shift(2,T),y=0;y<4;++y)O.write_shift(4,0);for(O.write_shift(4,0|(+n[vw]||3)<<8),y=0,N=0;y<p.length;++y)if(p[y]!=null){var B=m.next(32),W=(p[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);B.write_shift(1,W,"sbcs"),B.write_shift(1,w[y]=="?"?"C":w[y],"sbcs"),B.write_shift(4,N),B.write_shift(1,_[y]||l[w[y]]||0),B.write_shift(1,L[y]||0),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(1,0),B.write_shift(4,0),B.write_shift(4,0),N+=_[y]||l[w[y]]||0}var ee=m.next(264);for(ee.write_shift(4,13),y=0;y<65;++y)ee.write_shift(4,0);for(y=0;y<b.length;++y){var q=m.next(T);for(q.write_shift(1,0),N=0;N<p.length;++N)if(p[N]!=null)switch(w[N]){case"L":q.write_shift(1,b[y][N]==null?63:b[y][N]?84:70);break;case"B":q.write_shift(8,b[y][N]||0,"f");break;case"N":var fe="0";for(typeof b[y][N]=="number"&&(fe=b[y][N].toFixed(L[N]||0)),k=0;k<_[N]-fe.length;++k)q.write_shift(1,32);q.write_shift(1,fe,"sbcs");break;case"D":b[y][N]?(q.write_shift(4,("0000"+b[y][N].getFullYear()).slice(-4),"sbcs"),q.write_shift(2,("00"+(b[y][N].getMonth()+1)).slice(-2),"sbcs"),q.write_shift(2,("00"+b[y][N].getDate()).slice(-2),"sbcs")):q.write_shift(8,"00000000","sbcs");break;case"C":var ne=String(b[y][N]!=null?b[y][N]:"").slice(0,_[N]);for(q.write_shift(1,ne,"sbcs"),k=0;k<_[N]-ne.length;++k)q.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:s,to_sheet:r,from_sheet:o}})(),Ak=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+kn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(p,b){var g=e[b];return typeof g=="number"?rN(g):g},r=function(p,b,g){var y=b.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return y==59?p:rN(y)};e["|"]=254;function s(p,b){switch(b.type){case"base64":return l(xr(p),b);case"binary":return l(p,b);case"buffer":return l(bt&&Buffer.isBuffer(p)?p.toString("binary"):ul(p),b);case"array":return l(lo(p),b)}throw new Error("Unrecognized type "+b.type)}function l(p,b){var g=p.split(/[\n\r]+/),y=-1,N=-1,k=0,T=0,S=[],w=[],_=null,L={},C=[],P=[],F=[],H=0,O;for(+b.codepage>=0&&Jr(+b.codepage);k!==g.length;++k){H=0;var B=g[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(n,a),W=B.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),ee=W[0],q;if(B.length>0)switch(ee){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":W[1].charAt(0)=="P"&&w.push(B.slice(3).replace(/;;/g,";"));break;case"C":var fe=!1,ne=!1,Y=!1,X=!1,xe=-1,K=-1;for(T=1;T<W.length;++T)switch(W[T].charAt(0)){case"A":break;case"X":N=parseInt(W[T].slice(1))-1,ne=!0;break;case"Y":for(y=parseInt(W[T].slice(1))-1,ne||(N=0),O=S.length;O<=y;++O)S[O]=[];break;case"K":q=W[T].slice(1),q.charAt(0)==='"'?q=q.slice(1,q.length-1):q==="TRUE"?q=!0:q==="FALSE"?q=!1:isNaN(es(q))?isNaN(Cc(q).getDate())||(q=un(q)):(q=es(q),_!==null&&Pc(_)&&(q=ix(q))),fe=!0;break;case"E":X=!0;var A=lc(W[T].slice(1),{r:y,c:N});S[y][N]=[S[y][N],A];break;case"S":Y=!0,S[y][N]=[S[y][N],"S5S"];break;case"G":break;case"R":xe=parseInt(W[T].slice(1))-1;break;case"C":K=parseInt(W[T].slice(1))-1;break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+B)}if(fe&&(S[y][N]&&S[y][N].length==2?S[y][N][0]=q:S[y][N]=q,_=null),Y){if(X)throw new Error("SYLK shared formula cannot have own formula");var M=xe>-1&&S[xe][K];if(!M||!M[1])throw new Error("SYLK shared formula cannot find base");S[y][N][1]=Xk(M[1],{r:y-xe,c:N-K})}break;case"F":var I=0;for(T=1;T<W.length;++T)switch(W[T].charAt(0)){case"X":N=parseInt(W[T].slice(1))-1,++I;break;case"Y":for(y=parseInt(W[T].slice(1))-1,O=S.length;O<=y;++O)S[O]=[];break;case"M":H=parseInt(W[T].slice(1))/20;break;case"F":break;case"G":break;case"P":_=w[parseInt(W[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=W[T].slice(1).split(" "),O=parseInt(F[0],10);O<=parseInt(F[1],10);++O)H=parseInt(F[2],10),P[O-1]=H===0?{hidden:!0}:{wch:H},sl(P[O-1]);break;case"C":N=parseInt(W[T].slice(1))-1,P[N]||(P[N]={});break;case"R":y=parseInt(W[T].slice(1))-1,C[y]||(C[y]={}),H>0?(C[y].hpt=H,C[y].hpx=_c(H)):H===0&&(C[y].hidden=!0);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+B)}I<1&&(_=null);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+B)}}return C.length>0&&(L["!rows"]=C),P.length>0&&(L["!cols"]=P),b&&b.sheetRows&&(S=S.slice(0,b.sheetRows)),[S,L]}function o(p,b){var g=s(p,b),y=g[0],N=g[1],k=Oc(y,b);return kn(N).forEach(function(T){k[T]=N[T]}),k}function d(p,b){return hl(o(p,b),b)}function u(p,b,g,y){var N="C;Y"+(g+1)+";X"+(y+1)+";K";switch(p.t){case"n":N+=p.v||0,p.f&&!p.F&&(N+=";E"+zg(p.f,{r:g,c:y}));break;case"b":N+=p.v?"TRUE":"FALSE";break;case"e":N+=p.w||p.v;break;case"d":N+='"'+(p.w||p.v)+'"';break;case"s":N+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return N}function x(p,b){b.forEach(function(g,y){var N="F;W"+(y+1)+" "+(y+1)+" ";g.hidden?N+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=ru(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=su(g.wpx)),typeof g.wch=="number"&&(N+=Math.round(g.wch))),N.charAt(N.length-1)!=" "&&p.push(N)})}function m(p,b){b.forEach(function(g,y){var N="F;";g.hidden?N+="M0;":g.hpt?N+="M"+20*g.hpt+";":g.hpx&&(N+="M"+20*iu(g.hpx)+";"),N.length>2&&p.push(N+"R"+(y+1))})}function f(p,b){var g=["ID;PWXL;N;E"],y=[],N=Ft(p["!ref"]),k,T=Array.isArray(p),S=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),p["!cols"]&&x(g,p["!cols"]),p["!rows"]&&m(g,p["!rows"]),g.push("B;Y"+(N.e.r-N.s.r+1)+";X"+(N.e.c-N.s.c+1)+";D"+[N.s.c,N.s.r,N.e.c,N.e.r].join(" "));for(var w=N.s.r;w<=N.e.r;++w)for(var _=N.s.c;_<=N.e.c;++_){var L=dt({r:w,c:_});k=T?(p[w]||[])[_]:p[L],!(!k||k.v==null&&(!k.f||k.F))&&y.push(u(k,p,w,_))}return g.join(S)+S+y.join(S)+S+"E"+S}return{to_workbook:d,to_sheet:o,from_sheet:f}})(),Fk=(function(){function e(l,o){switch(o.type){case"base64":return n(xr(l),o);case"binary":return n(l,o);case"buffer":return n(bt&&Buffer.isBuffer(l)?l.toString("binary"):ul(l),o);case"array":return n(lo(l),o)}throw new Error("Unrecognized type "+o.type)}function n(l,o){for(var d=l.split(`
`),u=-1,x=-1,m=0,f=[];m!==d.length;++m){if(d[m].trim()==="BOT"){f[++u]=[],x=0;continue}if(!(u<0)){var p=d[m].trim().split(","),b=p[0],g=p[1];++m;for(var y=d[m]||"";(y.match(/["]/g)||[]).length&1&&m<d.length-1;)y+=`
`+d[++m];switch(y=y.trim(),+b){case-1:if(y==="BOT"){f[++u]=[],x=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?f[u][x]=!0:y==="FALSE"?f[u][x]=!1:isNaN(es(g))?isNaN(Cc(g).getDate())?f[u][x]=g:f[u][x]=un(g):f[u][x]=es(g),++x;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),f[u][x++]=y!==""?y:null;break}if(y==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function a(l,o){return Oc(e(l,o),o)}function r(l,o){return hl(a(l,o),o)}var s=(function(){var l=function(u,x,m,f,p){u.push(x),u.push(m+","+f),u.push('"'+p.replace(/"/g,'""')+'"')},o=function(u,x,m,f){u.push(x+","+m),u.push(x==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(u){var x=[],m=Ft(u["!ref"]),f,p=Array.isArray(u);l(x,"TABLE",0,1,"sheetjs"),l(x,"VECTORS",0,m.e.r-m.s.r+1,""),l(x,"TUPLES",0,m.e.c-m.s.c+1,""),l(x,"DATA",0,0,"");for(var b=m.s.r;b<=m.e.r;++b){o(x,-1,0,"BOT");for(var g=m.s.c;g<=m.e.c;++g){var y=dt({r:b,c:g});if(f=p?(u[b]||[])[g]:u[y],!f){o(x,1,0,"");continue}switch(f.t){case"n":var N=f.w;!N&&f.v!=null&&(N=f.v),N==null?f.f&&!f.F?o(x,1,0,"="+f.f):o(x,1,0,""):o(x,0,N,"V");break;case"b":o(x,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(x,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Br(f.z||ct[14],Gn(un(f.v)))),o(x,0,f.w,"V");break;default:o(x,1,0,"")}}}o(x,-1,0,"EOD");var k=`\r
`,T=x.join(k);return T}})();return{to_workbook:r,to_sheet:a,from_sheet:s}})(),Lk=(function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function a(f,p){for(var b=f.split(`
`),g=-1,y=-1,N=0,k=[];N!==b.length;++N){var T=b[N].trim().split(":");if(T[0]==="cell"){var S=vn(T[1]);if(k.length<=S.r)for(g=k.length;g<=S.r;++g)k[g]||(k[g]=[]);switch(g=S.r,y=S.c,T[2]){case"t":k[g][y]=e(T[3]);break;case"v":k[g][y]=+T[3];break;case"vtf":var w=T[T.length-1];case"vtc":switch(T[3]){case"nl":k[g][y]=!!+T[4];break;default:k[g][y]=+T[4];break}T[2]=="vtf"&&(k[g][y]=[k[g][y],w])}}}return p&&p.sheetRows&&(k=k.slice(0,p.sheetRows)),k}function r(f,p){return Oc(a(f,p),p)}function s(f,p){return hl(r(f,p),p)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,d=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function x(f){if(!f||!f["!ref"])return"";for(var p=[],b=[],g,y="",N=nr(f["!ref"]),k=Array.isArray(f),T=N.s.r;T<=N.e.r;++T)for(var S=N.s.c;S<=N.e.c;++S)if(y=dt({r:T,c:S}),g=k?(f[T]||[])[S]:f[y],!(!g||g.v==null||g.t==="z")){switch(b=["cell",y,"t"],g.t){case"s":case"str":b.push(n(g.v));break;case"n":g.f?(b[2]="vtf",b[3]="n",b[4]=g.v,b[5]=n(g.f)):(b[2]="v",b[3]=g.v);break;case"b":b[2]="vt"+(g.f?"f":"c"),b[3]="nl",b[4]=g.v?"1":"0",b[5]=n(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var w=Gn(un(g.v));b[2]="vtc",b[3]="nd",b[4]=""+w,b[5]=g.w||Br(g.z||ct[14],w);break;case"e":continue}p.push(b.join(":"))}return p.push("sheet:c:"+(N.e.c-N.s.c+1)+":r:"+(N.e.r-N.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function m(f){return[l,o,d,o,x(f),u].join(`
`)}return{to_workbook:s,to_sheet:r,from_sheet:m}})(),Sc=(function(){function e(m,f,p,b,g){g.raw?f[p][b]=m:m===""||(m==="TRUE"?f[p][b]=!0:m==="FALSE"?f[p][b]=!1:isNaN(es(m))?isNaN(Cc(m).getDate())?f[p][b]=m:f[p][b]=un(m):f[p][b]=es(m))}function n(m,f){var p=f||{},b=[];if(!m||m.length===0)return b;for(var g=m.split(/[\r\n]/),y=g.length-1;y>=0&&g[y].length===0;)--y;for(var N=10,k=0,T=0;T<=y;++T)k=g[T].indexOf(" "),k==-1?k=g[T].length:k++,N=Math.max(N,k);for(T=0;T<=y;++T){b[T]=[];var S=0;for(e(g[T].slice(0,N).trim(),b,T,S,p),S=1;S<=(g[T].length-N)/10+1;++S)e(g[T].slice(N+(S-1)*10,N+S*10).trim(),b,T,S,p)}return p.sheetRows&&(b=b.slice(0,p.sheetRows)),b}var a={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function s(m){for(var f={},p=!1,b=0,g=0;b<m.length;++b)(g=m.charCodeAt(b))==34?p=!p:!p&&g in a&&(f[g]=(f[g]||0)+1);g=[];for(b in f)Object.prototype.hasOwnProperty.call(f,b)&&g.push([f[b],b]);if(!g.length){f=r;for(b in f)Object.prototype.hasOwnProperty.call(f,b)&&g.push([f[b],b])}return g.sort(function(y,N){return y[0]-N[0]||r[y[1]]-r[N[1]]}),a[g.pop()[1]]||44}function l(m,f){var p=f||{},b="",g=p.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(b=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(b=m.charAt(4),m=m.slice(6)):b=s(m.slice(0,1024)):p&&p.FS?b=p.FS:b=s(m.slice(0,1024));var N=0,k=0,T=0,S=0,w=0,_=b.charCodeAt(0),L=!1,C=0,P=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var F=p.dateNF!=null?SF(p.dateNF):null;function H(){var O=m.slice(S,w),B={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)B.t="z";else if(p.raw)B.t="s",B.v=O;else if(O.trim().length===0)B.t="s",B.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(B.t="s",B.v=O.slice(2,-1).replace(/""/g,'"')):nM(O)?(B.t="n",B.f=O.slice(1)):(B.t="s",B.v=O);else if(O=="TRUE")B.t="b",B.v=!0;else if(O=="FALSE")B.t="b",B.v=!1;else if(!isNaN(T=es(O)))B.t="n",p.cellText!==!1&&(B.w=O),B.v=T;else if(!isNaN(Cc(O).getDate())||F&&O.match(F)){B.z=p.dateNF||ct[14];var W=0;F&&O.match(F)&&(O=_F(O,p.dateNF,O.match(F)||[]),W=1),p.cellDates?(B.t="d",B.v=un(O,W)):(B.t="n",B.v=Gn(un(O,W))),p.cellText!==!1&&(B.w=Br(B.z,B.v instanceof Date?Gn(B.v):B.v)),p.cellNF||delete B.z}else B.t="s",B.v=O;if(B.t=="z"||(p.dense?(g[N]||(g[N]=[]),g[N][k]=B):g[dt({c:k,r:N})]=B),S=w+1,P=m.charCodeAt(S),y.e.c<k&&(y.e.c=k),y.e.r<N&&(y.e.r=N),C==_)++k;else if(k=0,++N,p.sheetRows&&p.sheetRows<=N)return!0}e:for(;w<m.length;++w)switch(C=m.charCodeAt(w)){case 34:P===34&&(L=!L);break;case _:case 10:case 13:if(!L&&H())break e;break}return w-S>0&&H(),g["!ref"]=pt(y),g}function o(m,f){return!(f&&f.PRN)||f.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?l(m,f):Oc(n(m,f),f)}function d(m,f){var p="",b=f.type=="string"?[0,0,0,0]:Zg(m,f);switch(f.type){case"base64":p=xr(m);break;case"binary":p=m;break;case"buffer":f.codepage==65001?p=m.toString("utf8"):f.codepage&&typeof Qd<"u"||(p=bt&&Buffer.isBuffer(m)?m.toString("binary"):ul(m));break;case"array":p=lo(m);break;case"string":p=m;break;default:throw new Error("Unrecognized type "+f.type)}return b[0]==239&&b[1]==187&&b[2]==191?p=Qt(p.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?p=Qt(p):f.type=="binary"&&typeof Qd<"u",p.slice(0,19)=="socialcalc:version:"?Lk.to_sheet(f.type=="string"?p:Qt(p),f):o(p,f)}function u(m,f){return hl(d(m,f),f)}function x(m){for(var f=[],p=Ft(m["!ref"]),b,g=Array.isArray(m),y=p.s.r;y<=p.e.r;++y){for(var N=[],k=p.s.c;k<=p.e.c;++k){var T=dt({r:y,c:k});if(b=g?(m[y]||[])[k]:m[T],!b||b.v==null){N.push("          ");continue}for(var S=(b.w||(oi(b),b.w)||"").slice(0,10);S.length<10;)S+=" ";N.push(S+(k===0?" ":""))}f.push(N.join(""))}return f.join(`
`)}return{to_workbook:u,to_sheet:d,from_sheet:x}})();function UP(e,n){var a=n||{},r=!!a.WTF;a.WTF=!0;try{var s=Ak.to_workbook(e,a);return a.WTF=r,s}catch(l){if(a.WTF=r,!l.message.match(/SYLK bad record ID/)&&r)throw l;return Sc.to_workbook(e,n)}}var eo=(function(){function e(A,M,I){if(A){oa(A,A.l||0);for(var V=I.Enum||xe;A.l<A.length;){var J=A.read_shift(2),ge=V[J]||V[65535],z=A.read_shift(2),le=A.l+z,ue=ge.f&&ge.f(A,z,I);if(A.l=le,M(ue,ge,J))return}}}function n(A,M){switch(M.type){case"base64":return a(dr(xr(A)),M);case"binary":return a(dr(A),M);case"buffer":case"array":return a(A,M)}throw"Unsupported type "+M.type}function a(A,M){if(!A)return A;var I=M||{},V=I.dense?[]:{},J="Sheet1",ge="",z=0,le={},ue=[],ce=[],R={s:{r:0,c:0},e:{r:0,c:0}},pe=I.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)I.Enum=xe,e(A,function(Re,Ot,Ht){switch(Ht){case 0:I.vers=Re,Re>=4096&&(I.qpro=!0);break;case 6:R=Re;break;case 204:Re&&(ge=Re);break;case 222:ge=Re;break;case 15:case 51:I.qpro||(Re[1].v=Re[1].v.slice(1));case 13:case 14:case 16:Ht==14&&(Re[2]&112)==112&&(Re[2]&15)>1&&(Re[2]&15)<15&&(Re[1].z=I.dateNF||ct[14],I.cellDates&&(Re[1].t="d",Re[1].v=ix(Re[1].v))),I.qpro&&Re[3]>z&&(V["!ref"]=pt(R),le[J]=V,ue.push(J),V=I.dense?[]:{},R={s:{r:0,c:0},e:{r:0,c:0}},z=Re[3],J=ge||"Sheet"+(z+1),ge="");var rn=I.dense?(V[Re[0].r]||[])[Re[0].c]:V[dt(Re[0])];if(rn){rn.t=Re[1].t,rn.v=Re[1].v,Re[1].z!=null&&(rn.z=Re[1].z),Re[1].f!=null&&(rn.f=Re[1].f);break}I.dense?(V[Re[0].r]||(V[Re[0].r]=[]),V[Re[0].r][Re[0].c]=Re[1]):V[dt(Re[0])]=Re[1];break}},I);else if(A[2]==26||A[2]==14)I.Enum=K,A[2]==14&&(I.qpro=!0,A.l=0),e(A,function(Re,Ot,Ht){switch(Ht){case 204:J=Re;break;case 22:Re[1].v=Re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Re[3]>z&&(V["!ref"]=pt(R),le[J]=V,ue.push(J),V=I.dense?[]:{},R={s:{r:0,c:0},e:{r:0,c:0}},z=Re[3],J="Sheet"+(z+1)),pe>0&&Re[0].r>=pe)break;I.dense?(V[Re[0].r]||(V[Re[0].r]=[]),V[Re[0].r][Re[0].c]=Re[1]):V[dt(Re[0])]=Re[1],R.e.c<Re[0].c&&(R.e.c=Re[0].c),R.e.r<Re[0].r&&(R.e.r=Re[0].r);break;case 27:Re[14e3]&&(ce[Re[14e3][0]]=Re[14e3][1]);break;case 1537:ce[Re[0]]=Re[1],Re[0]==z&&(J=Re[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(V["!ref"]=pt(R),le[ge||J]=V,ue.push(ge||J),!ce.length)return{SheetNames:ue,Sheets:le};for(var Oe={},tt=[],Ye=0;Ye<ce.length;++Ye)le[ue[Ye]]?(tt.push(ce[Ye]||ue[Ye]),Oe[ce[Ye]]=le[ce[Ye]]||le[ue[Ye]]):(tt.push(ce[Ye]),Oe[ce[Ye]]={"!ref":"A1"});return{SheetNames:tt,Sheets:Oe}}function r(A,M){var I=M||{};if(+I.codepage>=0&&Jr(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var V=tr(),J=Ft(A["!ref"]),ge=Array.isArray(A),z=[];Ke(V,0,l(1030)),Ke(V,6,u(J));for(var le=Math.min(J.e.r,8191),ue=J.s.r;ue<=le;++ue)for(var ce=Dn(ue),R=J.s.c;R<=J.e.c;++R){ue===J.s.r&&(z[R]=yn(R));var pe=z[R]+ce,Oe=ge?(A[ue]||[])[R]:A[pe];if(!(!Oe||Oe.t=="z"))if(Oe.t=="n")(Oe.v|0)==Oe.v&&Oe.v>=-32768&&Oe.v<=32767?Ke(V,13,b(ue,R,Oe.v)):Ke(V,14,y(ue,R,Oe.v));else{var tt=oi(Oe);Ke(V,15,f(ue,R,tt.slice(0,239)))}}return Ke(V,1),V.end()}function s(A,M){var I=M||{};if(+I.codepage>=0&&Jr(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var V=tr();Ke(V,0,o(A));for(var J=0,ge=0;J<A.SheetNames.length;++J)(A.Sheets[A.SheetNames[J]]||{})["!ref"]&&Ke(V,27,X(A.SheetNames[J],ge++));var z=0;for(J=0;J<A.SheetNames.length;++J){var le=A.Sheets[A.SheetNames[J]];if(!(!le||!le["!ref"])){for(var ue=Ft(le["!ref"]),ce=Array.isArray(le),R=[],pe=Math.min(ue.e.r,8191),Oe=ue.s.r;Oe<=pe;++Oe)for(var tt=Dn(Oe),Ye=ue.s.c;Ye<=ue.e.c;++Ye){Oe===ue.s.r&&(R[Ye]=yn(Ye));var Re=R[Ye]+tt,Ot=ce?(le[Oe]||[])[Ye]:le[Re];if(!(!Ot||Ot.t=="z"))if(Ot.t=="n")Ke(V,23,H(Oe,Ye,z,Ot.v));else{var Ht=oi(Ot);Ke(V,22,C(Oe,Ye,z,Ht.slice(0,239)))}}++z}}return Ke(V,1),V.end()}function l(A){var M=Ce(2);return M.write_shift(2,A),M}function o(A){var M=Ce(26);M.write_shift(2,4096),M.write_shift(2,4),M.write_shift(4,0);for(var I=0,V=0,J=0,ge=0;ge<A.SheetNames.length;++ge){var z=A.SheetNames[ge],le=A.Sheets[z];if(!(!le||!le["!ref"])){++J;var ue=nr(le["!ref"]);I<ue.e.r&&(I=ue.e.r),V<ue.e.c&&(V=ue.e.c)}}return I>8191&&(I=8191),M.write_shift(2,I),M.write_shift(1,J),M.write_shift(1,V),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(1,1),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(4,0),M}function d(A,M,I){var V={s:{c:0,r:0},e:{c:0,r:0}};return M==8&&I.qpro?(V.s.c=A.read_shift(1),A.l++,V.s.r=A.read_shift(2),V.e.c=A.read_shift(1),A.l++,V.e.r=A.read_shift(2),V):(V.s.c=A.read_shift(2),V.s.r=A.read_shift(2),M==12&&I.qpro&&(A.l+=2),V.e.c=A.read_shift(2),V.e.r=A.read_shift(2),M==12&&I.qpro&&(A.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function u(A){var M=Ce(8);return M.write_shift(2,A.s.c),M.write_shift(2,A.s.r),M.write_shift(2,A.e.c),M.write_shift(2,A.e.r),M}function x(A,M,I){var V=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(V[0].c=A.read_shift(1),V[3]=A.read_shift(1),V[0].r=A.read_shift(2),A.l+=2):(V[2]=A.read_shift(1),V[0].c=A.read_shift(2),V[0].r=A.read_shift(2)),V}function m(A,M,I){var V=A.l+M,J=x(A,M,I);if(J[1].t="s",I.vers==20768){A.l++;var ge=A.read_shift(1);return J[1].v=A.read_shift(ge,"utf8"),J}return I.qpro&&A.l++,J[1].v=A.read_shift(V-A.l,"cstr"),J}function f(A,M,I){var V=Ce(7+I.length);V.write_shift(1,255),V.write_shift(2,M),V.write_shift(2,A),V.write_shift(1,39);for(var J=0;J<V.length;++J){var ge=I.charCodeAt(J);V.write_shift(1,ge>=128?95:ge)}return V.write_shift(1,0),V}function p(A,M,I){var V=x(A,M,I);return V[1].v=A.read_shift(2,"i"),V}function b(A,M,I){var V=Ce(7);return V.write_shift(1,255),V.write_shift(2,M),V.write_shift(2,A),V.write_shift(2,I,"i"),V}function g(A,M,I){var V=x(A,M,I);return V[1].v=A.read_shift(8,"f"),V}function y(A,M,I){var V=Ce(13);return V.write_shift(1,255),V.write_shift(2,M),V.write_shift(2,A),V.write_shift(8,I,"f"),V}function N(A,M,I){var V=A.l+M,J=x(A,M,I);if(J[1].v=A.read_shift(8,"f"),I.qpro)A.l=V;else{var ge=A.read_shift(2);w(A.slice(A.l,A.l+ge),J),A.l+=ge}return J}function k(A,M,I){var V=M&32768;return M&=-32769,M=(V?A:0)+(M>=8192?M-16384:M),(V?"":"$")+(I?yn(M):Dn(M))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(A,M){oa(A,0);for(var I=[],V=0,J="",ge="",z="",le="";A.l<A.length;){var ue=A[A.l++];switch(ue){case 0:I.push(A.read_shift(8,"f"));break;case 1:ge=k(M[0].c,A.read_shift(2),!0),J=k(M[0].r,A.read_shift(2),!1),I.push(ge+J);break;case 2:{var ce=k(M[0].c,A.read_shift(2),!0),R=k(M[0].r,A.read_shift(2),!1);ge=k(M[0].c,A.read_shift(2),!0),J=k(M[0].r,A.read_shift(2),!1),I.push(ce+R+":"+ge+J)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(A.read_shift(2));break;case 6:{for(var pe="";ue=A[A.l++];)pe+=String.fromCharCode(ue);I.push('"'+pe.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:le=I.pop(),z=I.pop(),I.push(["AND","OR"][ue-20]+"("+z+","+le+")");break;default:if(ue<32&&S[ue])le=I.pop(),z=I.pop(),I.push(z+S[ue]+le);else if(T[ue]){if(V=T[ue][1],V==69&&(V=A[A.l++]),V>I.length){console.error("WK1 bad formula parse 0x"+ue.toString(16)+":|"+I.join("|")+"|");return}var Oe=I.slice(-V);I.length-=V,I.push(T[ue][0]+"("+Oe.join(",")+")")}else return ue<=7?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=24?console.error("WK1 unsupported op "+ue.toString(16)):ue<=30?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=115?console.error("WK1 unsupported function opcode "+ue.toString(16)):console.error("WK1 unrecognized opcode "+ue.toString(16))}}I.length==1?M[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function _(A){var M=[{c:0,r:0},{t:"n",v:0},0];return M[0].r=A.read_shift(2),M[3]=A[A.l++],M[0].c=A[A.l++],M}function L(A,M){var I=_(A);return I[1].t="s",I[1].v=A.read_shift(M-4,"cstr"),I}function C(A,M,I,V){var J=Ce(6+V.length);J.write_shift(2,A),J.write_shift(1,I),J.write_shift(1,M),J.write_shift(1,39);for(var ge=0;ge<V.length;++ge){var z=V.charCodeAt(ge);J.write_shift(1,z>=128?95:z)}return J.write_shift(1,0),J}function P(A,M){var I=_(A);I[1].v=A.read_shift(2);var V=I[1].v>>1;if(I[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return I[1].v=V,I}function F(A,M){var I=_(A),V=A.read_shift(4),J=A.read_shift(4),ge=A.read_shift(2);if(ge==65535)return V===0&&J===3221225472?(I[1].t="e",I[1].v=15):V===0&&J===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var z=ge&32768;return ge=(ge&32767)-16446,I[1].v=(1-z*2)*(J*Math.pow(2,ge+32)+V*Math.pow(2,ge)),I}function H(A,M,I,V){var J=Ce(14);if(J.write_shift(2,A),J.write_shift(1,I),J.write_shift(1,M),V==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var ge=0,z=0,le=0,ue=0;return V<0&&(ge=1,V=-V),z=Math.log2(V)|0,V/=Math.pow(2,z-31),ue=V>>>0,(ue&2147483648)==0&&(V/=2,++z,ue=V>>>0),V-=ue,ue|=2147483648,ue>>>=0,V*=Math.pow(2,32),le=V>>>0,J.write_shift(4,le),J.write_shift(4,ue),z+=16383+(ge?32768:0),J.write_shift(2,z),J}function O(A,M){var I=F(A);return A.l+=M-14,I}function B(A,M){var I=_(A),V=A.read_shift(4);return I[1].v=V>>6,I}function W(A,M){var I=_(A),V=A.read_shift(8,"f");return I[1].v=V,I}function ee(A,M){var I=W(A);return A.l+=M-10,I}function q(A,M){return A[A.l+M-1]==0?A.read_shift(M,"cstr"):""}function fe(A,M){var I=A[A.l++];I>M-1&&(I=M-1);for(var V="";V.length<I;)V+=String.fromCharCode(A[A.l++]);return V}function ne(A,M,I){if(!(!I.qpro||M<21)){var V=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var J=A.read_shift(M-21,"cstr");return[V,J]}}function Y(A,M){for(var I={},V=A.l+M;A.l<V;){var J=A.read_shift(2);if(J==14e3){for(I[J]=[0,""],I[J][0]=A.read_shift(2);A[A.l];)I[J][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return I}function X(A,M){var I=Ce(5+A.length);I.write_shift(2,14e3),I.write_shift(2,M);for(var V=0;V<A.length;++V){var J=A.charCodeAt(V);I[I.l++]=J>127?95:J}return I[I.l++]=0,I}var xe={0:{n:"BOF",f:On},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:N},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:q},222:{n:"SHEETNAMELP",f:fe},65535:{n:""}},K={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Y},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:B},38:{n:"??"},39:{n:"NUMBER27",f:W},40:{n:"FORMULA28",f:ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:s,to_workbook:n}})();function KP(e){var n={},a=e.match(Ca),r=0,s=!1;if(a)for(;r!=a.length;++r){var l=ut(a[r]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;n.cp=fg[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=l.val;break;case"<sz":n.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":l.rgb&&(n.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(l[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+l[0])}}return n}var zP=(function(){var e=Zd("t"),n=Zd("rPr");function a(l){var o=l.match(e);if(!o)return{t:"s",v:""};var d={t:"s",v:Dt(o[1])},u=l.match(n);return u&&(d.s=KP(u[1])),d}var r=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(r,"").split(s).map(a).filter(function(d){return d.v})}})(),$P=(function(){var n=/(\r\n|\n)/g;function a(s,l,o){var d=[];s.u&&d.push("text-decoration: underline;"),s.uval&&d.push("text-underline-style:"+s.uval+";"),s.sz&&d.push("font-size:"+s.sz+"pt;"),s.outline&&d.push("text-effect: outline;"),s.shadow&&d.push("text-shadow: auto;"),l.push('<span style="'+d.join("")+'">'),s.b&&(l.push("<b>"),o.push("</b>")),s.i&&(l.push("<i>"),o.push("</i>")),s.strike&&(l.push("<s>"),o.push("</s>"));var u=s.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(l.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),s}function r(s){var l=[[],s.v,[]];return s.v?(s.s&&a(s.s,l[0],l[2]),l[0].join("")+l[1].replace(n,"<br/>")+l[2].join("")):""}return function(l){return l.map(r).join("")}})(),GP=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,qP=/<(?:\w+:)?r>/,WP=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Bg(e,n){var a=n?n.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Dt(Qt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Qt(e),a&&(r.h=Tg(r.t))):e.match(qP)&&(r.r=Qt(e),r.t=Dt(Qt((e.replace(WP,"").match(GP)||[]).join("").replace(Ca,""))),a&&(r.h=$P(zP(r.r)))),r):{t:""}}var XP=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,QP=/<(?:\w+:)?(?:si|sstItem)>/g,YP=/<\/(?:\w+:)?(?:si|sstItem)>/;function JP(e,n){var a=[],r="";if(!e)return a;var s=e.match(XP);if(s){r=s[2].replace(QP,"").split(YP);for(var l=0;l!=r.length;++l){var o=Bg(r[l].trim(),n);o!=null&&(a[a.length]=o)}s=ut(s[1]),a.Count=s.count,a.Unique=s.uniqueCount}return a}var ZP=/^\s|\s$|[\t\n\r]/;function Pk(e,n){if(!n.bookSST)return"";var a=[An];a[a.length]=Ue("sst",null,{xmlns:fo[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(e[r]!=null){var s=e[r],l="<si>";s.r?l+=s.r:(l+="<t",s.t||(s.t=""),s.t.match(ZP)&&(l+=' xml:space="preserve"'),l+=">"+qt(s.t)+"</t>"),l+="</si>",a[a.length]=l}return a.length>2&&(a[a.length]="</sst>",a[1]=a[1].replace("/>",">")),a.join("")}function eI(e){return[e.read_shift(4),e.read_shift(4)]}function tI(e,n){var a=[],r=!1;return di(e,function(l,o,d){switch(d){case 159:a.Count=l[0],a.Unique=l[1];break;case 19:a.push(l);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(o.T,!r||n.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}function nI(e,n){return n||(n=Ce(8)),n.write_shift(4,e.Count),n.write_shift(4,e.Unique),n}var aI=x8;function rI(e){var n=tr();Ee(n,159,nI(e));for(var a=0;a<e.length;++a)Ee(n,19,aI(e[a]));return Ee(n,160),n.end()}function Ik(e){for(var n=[],a=e.split(""),r=0;r<a.length;++r)n[r]=a[r].charCodeAt(0);return n}function ai(e,n){var a={};return a.Major=e.read_shift(2),a.Minor=e.read_shift(2),n>=4&&(e.l+=n-4),a}function sI(e){var n={};return n.id=e.read_shift(0,"lpp4"),n.R=ai(e,4),n.U=ai(e,4),n.W=ai(e,4),n}function iI(e){for(var n=e.read_shift(4),a=e.l+n-4,r={},s=e.read_shift(4),l=[];s-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=l,e.l!=a)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+a);return r}function lI(e){var n=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)n.push(iI(e));return n}function oI(e){var n=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)n.push(e.read_shift(0,"lpp4"));return n}function cI(e){var n={};return e.read_shift(4),e.l+=4,n.id=e.read_shift(0,"lpp4"),n.name=e.read_shift(0,"lpp4"),n.R=ai(e,4),n.U=ai(e,4),n.W=ai(e,4),n}function dI(e){var n=cI(e);if(n.ename=e.read_shift(0,"8lpp4"),n.blksz=e.read_shift(4),n.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function Ok(e,n){var a=e.l+n,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var s=!1;switch(r.AlgID){case 26126:case 26127:case 26128:s=r.Flags==36;break;case 26625:s=r.Flags==4;break;case 0:s=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(a-e.l>>1,"utf16le"),e.l=a,r}function Mk(e,n){var a={},r=e.l+n;return e.l+=4,a.Salt=e.slice(e.l,e.l+16),e.l+=16,a.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),a.VerifierHash=e.slice(e.l,r),e.l=r,a}function uI(e){var n=ai(e);switch(n.Minor){case 2:return[n.Minor,hI(e)];case 3:return[n.Minor,xI()];case 4:return[n.Minor,mI(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function hI(e){var n=e.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var a=e.read_shift(4),r=Ok(e,a),s=Mk(e,e.length-e.l);return{t:"Std",h:r,v:s}}function xI(){throw new Error("File is password-protected: ECMA-376 Extensible")}function mI(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var a=e.read_shift(e.length-e.l,"utf8"),r={};return a.replace(Ca,function(l){var o=ut(l);switch(Es(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(d){r[d]=o[d]});break;case"<dataIntegrity":r.encryptedHmacKey=o.encryptedHmacKey,r.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(o);break;default:throw o[0]}}),r}function fI(e,n){var a={},r=a.EncryptionVersionInfo=ai(e,4);if(n-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);a.Flags=e.read_shift(4),n-=4;var s=e.read_shift(4);return n-=4,a.EncryptionHeader=Ok(e,s),n-=s,a.EncryptionVerifier=Mk(e,n),a}function pI(e){var n={},a=n.EncryptionVersionInfo=ai(e,4);if(a.Major!=1||a.Minor!=1)throw"unrecognized version code "+a.Major+" : "+a.Minor;return n.Salt=e.read_shift(16),n.EncryptedVerifier=e.read_shift(16),n.EncryptedVerifierHash=e.read_shift(16),n}function Hg(e){var n=0,a,r=Ik(e),s=r.length+1,l,o,d,u,x;for(a=rl(s),a[0]=r.length,l=1;l!=s;++l)a[l]=r[l-1];for(l=s-1;l>=0;--l)o=a[l],d=(n&16384)===0?0:1,u=n<<1&32767,x=d|u,n=x^o;return n^52811}var Rk=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],a=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(o){return(o/2|o*128)&255},s=function(o,d){return r(o^d)},l=function(o){for(var d=n[o.length-1],u=104,x=o.length-1;x>=0;--x)for(var m=o[x],f=0;f!=7;++f)m&64&&(d^=a[u]),m*=2,--u;return d};return function(o){for(var d=Ik(o),u=l(d),x=d.length,m=rl(16),f=0;f!=16;++f)m[f]=0;var p,b,g;for((x&1)===1&&(p=u>>8,m[x]=s(e[0],p),--x,p=u&255,b=d[d.length-1],m[x]=s(b,p));x>0;)--x,p=u>>8,m[x]=s(d[x],p),--x,p=u&255,m[x]=s(d[x],p);for(x=15,g=15-d.length;g>0;)p=u>>8,m[x]=s(e[g],p),--x,--g,p=u&255,m[x]=s(d[x],p),--x,--g;return m}})(),gI=function(e,n,a,r,s){s||(s=n),r||(r=Rk(e));var l,o;for(l=0;l!=n.length;++l)o=n[l],o^=r[a],o=(o>>5|o<<3)&255,s[l]=o,++a;return[s,a,r]},yI=function(e){var n=0,a=Rk(e);return function(r){var s=gI("",r,n,a);return n=s[1],s[0]}};function vI(e,n,a,r){var s={key:On(e),verificationBytes:On(e)};return a.password&&(s.verifier=Hg(a.password)),r.valid=s.verificationBytes===s.verifier,r.valid&&(r.insitu=yI(a.password)),s}function bI(e,n,a){var r=a||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=pI(e):r.Data=fI(e,n),r}function NI(e,n,a){var r={Type:a.biff>=8?e.read_shift(2):0};return r.Type?bI(e,n-2,r):vI(e,a.biff>=8?n:n-2,a,r),r}var Bk=(function(){function e(s,l){switch(l.type){case"base64":return n(xr(s),l);case"binary":return n(s,l);case"buffer":return n(bt&&Buffer.isBuffer(s)?s.toString("binary"):ul(s),l);case"array":return n(lo(s),l)}throw new Error("Unrecognized type "+l.type)}function n(s,l){var o=l||{},d=o.dense?[]:{},u=s.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var x={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(m,f){Array.isArray(d)&&(d[f]=[]);for(var p=/\\\w+\b/g,b=0,g,y=-1;g=p.exec(m);){switch(g[0]){case"\\cell":var N=m.slice(b,p.lastIndex-g[0].length);if(N[0]==" "&&(N=N.slice(1)),++y,N.length){var k={v:N,t:"s"};Array.isArray(d)?d[f][y]=k:d[dt({r:f,c:y})]=k}break}b=p.lastIndex}y>x.e.c&&(x.e.c=y)}),d["!ref"]=pt(x),d}function a(s,l){return hl(e(s,l),l)}function r(s){for(var l=["{\\rtf1\\ansi"],o=Ft(s["!ref"]),d,u=Array.isArray(s),x=o.s.r;x<=o.e.r;++x){l.push("\\trowd\\trautofit1");for(var m=o.s.c;m<=o.e.c;++m)l.push("\\cellx"+(m+1));for(l.push("\\pard\\intbl"),m=o.s.c;m<=o.e.c;++m){var f=dt({r:x,c:m});d=u?(s[x]||[])[m]:s[f],!(!d||d.v==null&&(!d.f||d.F))&&(l.push(" "+(d.w||(oi(d),d.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:a,to_sheet:e,from_sheet:r}})();function jI(e){var n=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function au(e){for(var n=0,a=1;n!=3;++n)a=a*256+(e[n]>255?255:e[n]<0?0:e[n]);return a.toString(16).toUpperCase().slice(1)}function wI(e){var n=e[0]/255,a=e[1]/255,r=e[2]/255,s=Math.max(n,a,r),l=Math.min(n,a,r),o=s-l;if(o===0)return[0,0,n];var d=0,u=0,x=s+l;switch(u=o/(x>1?2-x:x),s){case n:d=((a-r)/o+6)%6;break;case a:d=(r-n)/o+2;break;case r:d=(n-a)/o+4;break}return[d/6,u,x/2]}function kI(e){var n=e[0],a=e[1],r=e[2],s=a*2*(r<.5?r:1-r),l=r-s/2,o=[l,l,l],d=6*n,u;if(a!==0)switch(d|0){case 0:case 6:u=s*d,o[0]+=s,o[1]+=u;break;case 1:u=s*(2-d),o[0]+=u,o[1]+=s;break;case 2:u=s*(d-2),o[1]+=s,o[2]+=u;break;case 3:u=s*(4-d),o[1]+=u,o[2]+=s;break;case 4:u=s*(d-4),o[2]+=s,o[0]+=u;break;case 5:u=s*(6-d),o[2]+=u,o[0]+=s;break}for(var x=0;x!=3;++x)o[x]=Math.round(o[x]*255);return o}function I0(e,n){if(n===0)return e;var a=wI(jI(e));return n<0?a[2]=a[2]*(1+n):a[2]=1-(1-a[2])*(1-n),au(kI(a))}var Hk=6,TI=15,CI=1,Na=Hk;function ru(e){return Math.floor((e+Math.round(128/Na)/256)*Na)}function su(e){return Math.floor((e-5)/Na*100+.5)/100}function O0(e){return Math.round((e*Na+5)/Na*256)/256}function Cf(e){return O0(su(ru(e)))}function Vg(e){var n=Math.abs(e-Cf(e)),a=Na;if(n>.005)for(Na=CI;Na<TI;++Na)Math.abs(e-Cf(e))<=n&&(n=Math.abs(e-Cf(e)),a=Na);Na=a}function sl(e){e.width?(e.wpx=ru(e.width),e.wch=su(e.wpx),e.MDW=Na):e.wpx?(e.wch=su(e.wpx),e.width=O0(e.wch),e.MDW=Na):typeof e.wch=="number"&&(e.width=O0(e.wch),e.wpx=ru(e.width),e.MDW=Na),e.customWidth&&delete e.customWidth}var SI=96,Vk=SI;function iu(e){return e*96/Vk}function _c(e){return e*Vk/96}var _I={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function EI(e,n,a,r){n.Borders=[];var s={},l=!1;(e[0].match(Ca)||[]).forEach(function(o){var d=ut(o);switch(Es(d[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},d.diagonalUp&&(s.diagonalUp=on(d.diagonalUp)),d.diagonalDown&&(s.diagonalDown=on(d.diagonalDown)),n.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+d[0]+" in borders")}})}function DI(e,n,a,r){n.Fills=[];var s={},l=!1;(e[0].match(Ca)||[]).forEach(function(o){var d=ut(o);switch(Es(d[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},n.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":d.patternType&&(s.patternType=d.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),d.indexed&&(s.bgColor.indexed=parseInt(d.indexed,10)),d.theme&&(s.bgColor.theme=parseInt(d.theme,10)),d.tint&&(s.bgColor.tint=parseFloat(d.tint)),d.rgb&&(s.bgColor.rgb=d.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),d.theme&&(s.fgColor.theme=parseInt(d.theme,10)),d.tint&&(s.fgColor.tint=parseFloat(d.tint)),d.rgb!=null&&(s.fgColor.rgb=d.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+d[0]+" in fills")}})}function AI(e,n,a,r){n.Fonts=[];var s={},l=!1;(e[0].match(Ca)||[]).forEach(function(o){var d=ut(o);switch(Es(d[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(s),s={};break;case"<name":d.val&&(s.name=Qt(d.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=d.val?on(d.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=d.val?on(d.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(d.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=d.val?on(d.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=d.val?on(d.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=d.val?on(d.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=d.val?on(d.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=d.val?on(d.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":d.val&&(s.sz=+d.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":d.val&&(s.vertAlign=d.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":d.val&&(s.family=parseInt(d.val,10));break;case"<family/>":case"</family>":break;case"<scheme":d.val&&(s.scheme=d.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(d.val=="1")break;d.codepage=fg[parseInt(d.val,10)];break;case"<color":if(s.color||(s.color={}),d.auto&&(s.color.auto=on(d.auto)),d.rgb)s.color.rgb=d.rgb.slice(-6);else if(d.indexed){s.color.index=parseInt(d.indexed,10);var u=Jl[s.color.index];s.color.index==81&&(u=Jl[1]),u||(u=Jl[1]),s.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else d.theme&&(s.color.theme=parseInt(d.theme,10),d.tint&&(s.color.tint=parseFloat(d.tint)),d.theme&&a.themeElements&&a.themeElements.clrScheme&&(s.color.rgb=I0(a.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw new Error("unrecognized "+d[0]+" in fonts")}})}function FI(e,n,a){n.NumberFmt=[];for(var r=kn(ct),s=0;s<r.length;++s)n.NumberFmt[r[s]]=ct[r[s]];var l=e[0].match(Ca);if(l)for(s=0;s<l.length;++s){var o=ut(l[s]);switch(Es(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var d=Dt(Qt(o.formatCode)),u=parseInt(o.numFmtId,10);if(n.NumberFmt[u]=d,u>0){if(u>392){for(u=392;u>60&&n.NumberFmt[u]!=null;--u);n.NumberFmt[u]=d}ni(d,u)}}break;case"</numFmt>":break;default:if(a.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function LI(e){var n=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var r=a[0];r<=a[1];++r)e[r]!=null&&(n[n.length]=Ue("numFmt",null,{numFmtId:r,formatCode:qt(e[r])}))}),n.length===1?"":(n[n.length]="</numFmts>",n[0]=Ue("numFmts",null,{count:n.length-2}).replace("/>",">"),n.join(""))}var e0=["numFmtId","fillId","fontId","borderId","xfId"],t0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function PI(e,n,a){n.CellXf=[];var r,s=!1;(e[0].match(Ca)||[]).forEach(function(l){var o=ut(l),d=0;switch(Es(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=o,delete r[0],d=0;d<e0.length;++d)r[e0[d]]&&(r[e0[d]]=parseInt(r[e0[d]],10));for(d=0;d<t0.length;++d)r[t0[d]]&&(r[t0[d]]=on(r[t0[d]]));if(n.NumberFmt&&r.numFmtId>392){for(d=392;d>60;--d)if(n.NumberFmt[r.numFmtId]==n.NumberFmt[d]){r.numFmtId=d;break}}n.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=on(o.wrapText)),r.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function II(e){var n=[];return n[n.length]=Ue("cellXfs",null),e.forEach(function(a){n[n.length]=Ue("xf",null,a)}),n[n.length]="</cellXfs>",n.length===2?"":(n[0]=Ue("cellXfs",null,{count:n.length-2}).replace("/>",">"),n.join(""))}var OI=(function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,a=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(d,u,x){var m={};if(!d)return m;d=d.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=d.match(n))&&FI(f,m,x),(f=d.match(s))&&AI(f,m,u,x),(f=d.match(r))&&DI(f,m,u,x),(f=d.match(l))&&EI(f,m,u,x),(f=d.match(a))&&PI(f,m,x),m}})();function Uk(e,n){var a=[An,Ue("styleSheet",null,{xmlns:fo[0],"xmlns:vt":zn.vt})],r;return e.SSF&&(r=LI(e.SSF))!=null&&(a[a.length]=r),a[a.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',a[a.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',a[a.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',a[a.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=II(n.cellXfs))&&(a[a.length]=r),a[a.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',a[a.length]='<dxfs count="0"/>',a[a.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',a.length>2&&(a[a.length]="</styleSheet>",a[1]=a[1].replace("/>",">")),a.join("")}function MI(e,n){var a=e.read_shift(2),r=ka(e);return[a,r]}function RI(e,n,a){a||(a=Ce(6+4*n.length)),a.write_shift(2,e),na(n,a);var r=a.length>a.l?a.slice(0,a.l):a;return a.l==null&&(a.l=a.length),r}function BI(e,n,a){var r={};r.sz=e.read_shift(2)/20;var s=b8(e);s.fItalic&&(r.italic=1),s.fCondense&&(r.condense=1),s.fExtend&&(r.extend=1),s.fShadow&&(r.shadow=1),s.fOutline&&(r.outline=1),s.fStrikeout&&(r.strike=1);var l=e.read_shift(2);switch(l===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(r.underline=o);var d=e.read_shift(1);d>0&&(r.family=d);var u=e.read_shift(1);switch(u>0&&(r.charset=u),e.l++,r.color=v8(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=ka(e),r}function HI(e,n){n||(n=Ce(153)),n.write_shift(2,e.sz*20),N8(e,n),n.write_shift(2,e.bold?700:400);var a=0;e.vertAlign=="superscript"?a=1:e.vertAlign=="subscript"&&(a=2),n.write_shift(2,a),n.write_shift(1,e.underline||0),n.write_shift(1,e.family||0),n.write_shift(1,e.charset||0),n.write_shift(1,0),F0(e.color,n);var r=0;return r=2,n.write_shift(1,r),na(e.name,n),n.length>n.l?n.slice(0,n.l):n}var VI=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Sf,UI=Ta;function WN(e,n){n||(n=Ce(84)),Sf||(Sf=rx(VI));var a=Sf[e.patternType];a==null&&(a=40),n.write_shift(4,a);var r=0;if(a!=40)for(F0({auto:1},n),F0({auto:1},n);r<12;++r)n.write_shift(4,0);else{for(;r<4;++r)n.write_shift(4,0);for(;r<12;++r)n.write_shift(4,0)}return n.length>n.l?n.slice(0,n.l):n}function KI(e,n){var a=e.l+n,r=e.read_shift(2),s=e.read_shift(2);return e.l=a,{ixfe:r,numFmtId:s}}function Kk(e,n,a){a||(a=Ce(16)),a.write_shift(2,n||0),a.write_shift(2,e.numFmtId||0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(1,0),a.write_shift(1,0);var r=0;return a.write_shift(1,r),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(1,0),a}function Cd(e,n){return n||(n=Ce(10)),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(4,0),n}var zI=Ta;function $I(e,n){return n||(n=Ce(51)),n.write_shift(1,0),Cd(null,n),Cd(null,n),Cd(null,n),Cd(null,n),Cd(null,n),n.length>n.l?n.slice(0,n.l):n}function GI(e,n){return n||(n=Ce(52)),n.write_shift(4,e.xfId),n.write_shift(2,1),n.write_shift(1,0),n.write_shift(1,0),A0(e.name||"",n),n.length>n.l?n.slice(0,n.l):n}function qI(e,n,a){var r=Ce(2052);return r.write_shift(4,e),A0(n,r),A0(a,r),r.length>r.l?r.slice(0,r.l):r}function WI(e,n,a){var r={};r.NumberFmt=[];for(var s in ct)r.NumberFmt[s]=ct[s];r.CellXf=[],r.Fonts=[];var l=[],o=!1;return di(e,function(u,x,m){switch(m){case 44:r.NumberFmt[u[0]]=u[1],ni(u[1],u[0]);break;case 43:r.Fonts.push(u),u.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(u.color.rgb=I0(n.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&r.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:l.push(m),o=!0;break;case 38:l.pop(),o=!1;break;default:if(x.T>0)l.push(m);else if(x.T<0)l.pop();else if(!o||a.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),r}function XI(e,n){if(n){var a=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)n[s]!=null&&++a}),a!=0&&(Ee(e,615,ts(a)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)n[s]!=null&&Ee(e,44,RI(s,n[s]))}),Ee(e,616))}}function QI(e){var n=1;Ee(e,611,ts(n)),Ee(e,43,HI({sz:12,color:{theme:1},name:"Calibri",family:2})),Ee(e,612)}function YI(e){var n=2;Ee(e,603,ts(n)),Ee(e,45,WN({patternType:"none"})),Ee(e,45,WN({patternType:"gray125"})),Ee(e,604)}function JI(e){var n=1;Ee(e,613,ts(n)),Ee(e,46,$I()),Ee(e,614)}function ZI(e){var n=1;Ee(e,626,ts(n)),Ee(e,47,Kk({numFmtId:0},65535)),Ee(e,627)}function eO(e,n){Ee(e,617,ts(n.length)),n.forEach(function(a){Ee(e,47,Kk(a,0))}),Ee(e,618)}function tO(e){var n=1;Ee(e,619,ts(n)),Ee(e,48,GI({xfId:0,name:"Normal"})),Ee(e,620)}function nO(e){var n=0;Ee(e,505,ts(n)),Ee(e,506)}function aO(e){var n=0;Ee(e,508,qI(n,"TableStyleMedium9","PivotStyleMedium4")),Ee(e,509)}function rO(e,n){var a=tr();return Ee(a,278),XI(a,e.SSF),QI(a),YI(a),JI(a),ZI(a),eO(a,n.cellXfs),tO(a),nO(a),aO(a),Ee(a,279),a.end()}var sO=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function iO(e,n,a){n.themeElements.clrScheme=[];var r={};(e[0].match(Ca)||[]).forEach(function(s){var l=ut(s);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=l.val;break;case"<a:sysClr":r.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(n.themeElements.clrScheme[sO.indexOf(l[0])]=r,r={}):r.name=l[0].slice(3,l[0].length-1);break;default:if(a&&a.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function lO(){}function oO(){}var cO=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,dO=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,uO=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function hO(e,n,a){n.themeElements={};var r;[["clrScheme",cO,iO],["fontScheme",dO,lO],["fmtScheme",uO,oO]].forEach(function(s){if(!(r=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](r,n,a)})}var xO=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function zk(e,n){(!e||e.length===0)&&(e=Ug());var a,r={};if(!(a=e.match(xO)))throw new Error("themeElements not found in theme");return hO(a[0],r,n),r.raw=e,r}function Ug(e,n){if(n&&n.themeXLSX)return n.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var a=[An];return a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join("")}function mO(e,n,a){var r=e.l+n,s=e.read_shift(4);if(s!==124226){if(!a.cellStyles){e.l=r;return}var l=e.slice(e.l);e.l=r;var o;try{o=Ow(l,{type:"array"})}catch{return}var d=ur(o,"theme/theme/theme1.xml",!0);if(d)return zk(d,a)}}function fO(e){return e.read_shift(4)}function pO(e){var n={};switch(n.xclrType=e.read_shift(2),n.nTintShade=e.read_shift(2),n.xclrType){case 0:e.l+=4;break;case 1:n.xclrValue=gO(e,4);break;case 2:n.xclrValue=wk(e);break;case 3:n.xclrValue=fO(e);break;case 4:e.l+=4;break}return e.l+=8,n}function gO(e,n){return Ta(e,n)}function yO(e,n){return Ta(e,n)}function vO(e){var n=e.read_shift(2),a=e.read_shift(2)-4,r=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=pO(e);break;case 6:r[1]=yO(e,a);break;case 14:case 15:r[1]=e.read_shift(a===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+a)}return r}function bO(e,n){var a=e.l+n;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),l=[];s-- >0;)l.push(vO(e,a-e.l));return{ixfe:r,ext:l}}function NO(e,n){n.forEach(function(a){a[0]})}function jO(e,n){return{flags:e.read_shift(4),version:e.read_shift(4),name:ka(e)}}function wO(e){var n=Ce(12+2*e.name.length);return n.write_shift(4,e.flags),n.write_shift(4,e.version),na(e.name,n),n.slice(0,n.l)}function kO(e){for(var n=[],a=e.read_shift(4);a-- >0;)n.push([e.read_shift(4),e.read_shift(4)]);return n}function TO(e){var n=Ce(4+8*e.length);n.write_shift(4,e.length);for(var a=0;a<e.length;++a)n.write_shift(4,e[a][0]),n.write_shift(4,e[a][1]);return n}function CO(e,n){var a=Ce(8+2*n.length);return a.write_shift(4,e),na(n,a),a.slice(0,a.l)}function SO(e){return e.l+=4,e.read_shift(4)!=0}function _O(e,n){var a=Ce(8);return a.write_shift(4,e),a.write_shift(4,1),a}function EO(e,n,a){var r={Types:[],Cell:[],Value:[]},s=a||{},l=[],o=!1,d=2;return di(e,function(u,x,m){switch(m){case 335:r.Types.push({name:u.name});break;case 51:u.forEach(function(f){d==1?r.Cell.push({type:r.Types[f[0]-1].name,index:f[1]}):d==0&&r.Value.push({type:r.Types[f[0]-1].name,index:f[1]})});break;case 337:d=u?1:0;break;case 338:d=2;break;case 35:l.push(m),o=!0;break;case 36:l.pop(),o=!1;break;default:if(!x.T){if(!o||s.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),r}function DO(){var e=tr();return Ee(e,332),Ee(e,334,ts(1)),Ee(e,335,wO({name:"XLDAPR",version:12e4,flags:3496657072})),Ee(e,336),Ee(e,339,CO(1,"XLDAPR")),Ee(e,52),Ee(e,35,ts(514)),Ee(e,4096,ts(0)),Ee(e,4097,_r(1)),Ee(e,36),Ee(e,53),Ee(e,340),Ee(e,337,_O(1)),Ee(e,51,TO([[1,0]])),Ee(e,338),Ee(e,333),e.end()}function AO(e,n,a){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var s=!1,l=2,o;return e.replace(Ca,function(d){var u=ut(d);switch(Es(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var x=0;x<r.Types.length;++x)r.Types[x].name==u.name&&(o=r.Types[x]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?r.Cell.push({type:r.Types[u.t-1].name,index:+u.v}):l==0&&r.Value.push({type:r.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!s&&a.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return d}),r}function $k(){var e=[An];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function FO(e){var n=[];if(!e)return n;var a=1;return(e.match(Ca)||[]).forEach(function(r){var s=ut(r);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?a=s.i:s.i=a,n.push(s);break}}),n}function LO(e){var n={};n.i=e.read_shift(4);var a={};a.r=e.read_shift(4),a.c=e.read_shift(4),n.r=dt(a);var r=e.read_shift(1);return r&2&&(n.l="1"),r&8&&(n.a="1"),n}function PO(e,n,a){var r=[];return di(e,function(l,o,d){switch(d){case 63:r.push(l);break;default:if(!o.T)throw new Error("Unexpected record 0x"+d.toString(16))}}),r}function IO(e,n,a,r){if(!e)return e;var s=r||{},l=!1;di(e,function(d,u,x){switch(x){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!u.T){if(!l||s.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}},s)}function OO(e,n){if(!e)return"??";var a=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][a].Target}var rc=1024;function Gk(e,n){for(var a=[21600,21600],r=["m0,0l0",a[1],a[0],a[1],a[0],"0xe"].join(","),s=[Ue("xml",null,{"xmlns:v":or.v,"xmlns:o":or.o,"xmlns:x":or.x,"xmlns:mv":or.mv}).replace(/\/>/,">"),Ue("o:shapelayout",Ue("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ue("v:shapetype",[Ue("v:stroke",null,{joinstyle:"miter"}),Ue("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:a.join(","),path:r})];rc<e*1e3;)rc+=1e3;return n.forEach(function(l){var o=vn(l[0]),d={color2:"#BEFF82",type:"gradient"};d.type=="gradient"&&(d.angle="-180");var u=d.type=="gradient"?Ue("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,x=Ue("v:fill",u,d),m={on:"t",obscured:"t"};++rc,s=s.concat(["<v:shape"+eu({id:"_x0000_s"+rc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",x,Ue("v:shadow",null,m),Ue("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",da("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),da("x:AutoFill","False"),da("x:Row",String(o.r)),da("x:Column",String(o.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function XN(e,n,a,r){var s=Array.isArray(e),l;n.forEach(function(o){var d=vn(o.ref);if(s?(e[d.r]||(e[d.r]=[]),l=e[d.r][d.c]):l=e[o.ref],!l){l={t:"z"},s?e[d.r][d.c]=l:e[o.ref]=l;var u=Ft(e["!ref"]||"BDWGO1000001:A1");u.s.r>d.r&&(u.s.r=d.r),u.e.r<d.r&&(u.e.r=d.r),u.s.c>d.c&&(u.s.c=d.c),u.e.c<d.c&&(u.e.c=d.c);var x=pt(u);x!==e["!ref"]&&(e["!ref"]=x)}l.c||(l.c=[]);var m={a:o.author,t:o.t,r:o.r,T:a};o.h&&(m.h=o.h);for(var f=l.c.length-1;f>=0;--f){if(!a&&l.c[f].T)return;a&&!l.c[f].T&&l.c.splice(f,1)}if(a&&r){for(f=0;f<r.length;++f)if(m.a==r[f].id){m.a=r[f].name||m.a;break}}l.c.push(m)})}function MO(e,n){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var a=[],r=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var d=o.match(/<(?:\w+:)?author[^>]*>(.*)/);d&&a.push(d[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var d=o.match(/<(?:\w+:)?comment[^>]*>/);if(d){var u=ut(d[0]),x={author:u.authorId&&a[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},m=vn(u.ref);if(!(n.sheetRows&&n.sheetRows<=m.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!f&&!!f[1]&&Bg(f[1])||{r:"",t:"",h:""};x.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),x.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(x.h=p.h),r.push(x)}}}}),r}function qk(e){var n=[An,Ue("comments",null,{xmlns:fo[0]})],a=[];return n.push("<authors>"),e.forEach(function(r){r[1].forEach(function(s){var l=qt(s.a);a.indexOf(l)==-1&&(a.push(l),n.push("<author>"+l+"</author>")),s.T&&s.ID&&a.indexOf("tc="+s.ID)==-1&&(a.push("tc="+s.ID),n.push("<author>tc="+s.ID+"</author>"))})}),a.length==0&&(a.push("SheetJ5"),n.push("<author>SheetJ5</author>")),n.push("</authors>"),n.push("<commentList>"),e.forEach(function(r){var s=0,l=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?s=a.indexOf("tc="+r[1][0].ID):r[1].forEach(function(u){u.a&&(s=a.indexOf(qt(u.a))),l.push(u.t||"")}),n.push('<comment ref="'+r[0]+'" authorId="'+s+'"><text>'),l.length<=1)n.push(da("t",qt(l[0]||"")));else{for(var o=`Comment:
    `+l[0]+`
`,d=1;d<l.length;++d)o+=`Reply:
    `+l[d]+`
`;n.push(da("t",qt(o)))}n.push("</text></comment>")}),n.push("</commentList>"),n.length>2&&(n[n.length]="</comments>",n[1]=n[1].replace("/>",">")),n.join("")}function RO(e,n){var a=[],r=!1,s={},l=0;return e.replace(Ca,function(d,u){var x=ut(d);switch(Es(x[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:x.personId,guid:x.id,ref:x.ref,T:1};break;case"</threadedComment>":s.t!=null&&a.push(s);break;case"<text>":case"<text":l=u+d.length;break;case"</text>":s.t=e.slice(l,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+x[0]+" in threaded comments")}return d}),a}function BO(e,n,a){var r=[An,Ue("ThreadedComments",null,{xmlns:zn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var l="";(s[1]||[]).forEach(function(o,d){if(!o.T){delete o.ID;return}o.a&&n.indexOf(o.a)==-1&&n.push(o.a);var u={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+a.tcid++).slice(-12)+"}"};d==0?l=u.id:u.parentId=l,o.ID=u.id,o.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+n.indexOf(o.a)).slice(-12)+"}"),r.push(Ue("threadedComment",da("text",o.t||""),u))})}),r.push("</ThreadedComments>"),r.join("")}function HO(e,n){var a=[],r=!1;return e.replace(Ca,function(l){var o=ut(l);switch(Es(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":a.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return l}),a}function VO(e){var n=[An,Ue("personList",null,{xmlns:zn.TCMNT,"xmlns:x":fo[0]}).replace(/[\/]>/,">")];return e.forEach(function(a,r){n.push(Ue("person",null,{displayName:a,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:a,providerId:"None"}))}),n.push("</personList>"),n.join("")}function UO(e){var n={};n.iauthor=e.read_shift(4);var a=vo(e);return n.rfx=a.s,n.ref=dt(a.s),e.l+=16,n}function KO(e,n){return n==null&&(n=Ce(36)),n.write_shift(4,e[1].iauthor),Mc(e[0],n),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n}var zO=ka;function $O(e){return na(e.slice(0,54))}function GO(e,n){var a=[],r=[],s={},l=!1;return di(e,function(d,u,x){switch(x){case 632:r.push(d);break;case 635:s=d;break;case 637:s.t=d.t,s.h=d.h,s.r=d.r;break;case 636:if(s.author=r[s.iauthor],delete s.iauthor,n.sheetRows&&s.rfx&&n.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,a.push(s);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!l||n.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}),a}function qO(e){var n=tr(),a=[];return Ee(n,628),Ee(n,630),e.forEach(function(r){r[1].forEach(function(s){a.indexOf(s.a)>-1||(a.push(s.a.slice(0,54)),Ee(n,632,$O(s.a)))})}),Ee(n,631),Ee(n,633),e.forEach(function(r){r[1].forEach(function(s){s.iauthor=a.indexOf(s.a);var l={s:vn(r[0]),e:vn(r[0])};Ee(n,635,KO([l,s])),s.t&&s.t.length>0&&Ee(n,637,f8(s)),Ee(n,636),delete s.iauthor})}),Ee(n,634),Ee(n,629),n.end()}var WO="application/vnd.ms-office.vbaProject";function XO(e){var n=at.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(a,r){if(!(a.slice(-1)==="/"||!a.match(/_VBA_PROJECT_CUR/))){var s=a.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");at.utils.cfb_add(n,s,e.FileIndex[r].content)}}),at.write(n)}function QO(e,n){n.FullPaths.forEach(function(a,r){if(r!=0){var s=a.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&at.utils.cfb_add(e,s,n.FileIndex[r].content)}})}var Wk=["xlsb","xlsm","xlam","biff8","xla"];function YO(){return{"!type":"dialog"}}function JO(){return{"!type":"dialog"}}function ZO(){return{"!type":"macro"}}function eM(){return{"!type":"macro"}}var lc=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function a(r,s,l,o){var d=!1,u=!1;l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1)),o.length==0?d=!0:o.charAt(0)=="["&&(d=!0,o=o.slice(1,-1));var x=l.length>0?parseInt(l,10)|0:0,m=o.length>0?parseInt(o,10)|0:0;return d?m+=n.c:--m,u?x+=n.r:--x,s+(d?"":"$")+yn(m)+(u?"":"$")+Dn(x)}return function(s,l){return n=l,s.replace(e,a)}})(),Kg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,zg=(function(){return function(n,a){return n.replace(Kg,function(r,s,l,o,d,u){var x=Dg(o)-(l?0:a.c),m=Eg(u)-(d?0:a.r),f=m==0?"":d?m+1:"["+m+"]",p=x==0?"":l?x+1:"["+x+"]";return s+"R"+f+"C"+p})}})();function Xk(e,n){return e.replace(Kg,function(a,r,s,l,o,d){return r+(s=="$"?s+l:yn(Dg(l)+n.c))+(o=="$"?o+d:Dn(Eg(d)+n.r))})}function tM(e,n,a){var r=nr(n),s=r.s,l=vn(a),o={r:l.r-s.r,c:l.c-s.c};return Xk(e,o)}function nM(e){return e.length!=1}function QN(e){return e.replace(/_xlfn\./g,"")}function Pn(e){e.l+=1}function il(e,n){var a=e.read_shift(2);return[a&16383,a>>14&1,a>>15&1]}function Qk(e,n,a){var r=2;if(a){if(a.biff>=2&&a.biff<=5)return Yk(e);a.biff==12&&(r=4)}var s=e.read_shift(r),l=e.read_shift(r),o=il(e),d=il(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:l,c:d[0],cRel:d[1],rRel:d[2]}}}function Yk(e){var n=il(e),a=il(e),r=e.read_shift(1),s=e.read_shift(1);return{s:{r:n[0],c:r,cRel:n[1],rRel:n[2]},e:{r:a[0],c:s,cRel:a[1],rRel:a[2]}}}function aM(e,n,a){if(a.biff<8)return Yk(e);var r=e.read_shift(a.biff==12?4:2),s=e.read_shift(a.biff==12?4:2),l=il(e),o=il(e);return{s:{r,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Jk(e,n,a){if(a&&a.biff>=2&&a.biff<=5)return rM(e);var r=e.read_shift(a&&a.biff==12?4:2),s=il(e);return{r,c:s[0],cRel:s[1],rRel:s[2]}}function rM(e){var n=il(e),a=e.read_shift(1);return{r:n[0],c:a,cRel:n[1],rRel:n[2]}}function sM(e){var n=e.read_shift(2),a=e.read_shift(2);return{r:n,c:a&255,fQuoted:!!(a&16384),cRel:a>>15,rRel:a>>15}}function iM(e,n,a){var r=a&&a.biff?a.biff:8;if(r>=2&&r<=5)return lM(e);var s=e.read_shift(r>=12?4:2),l=e.read_shift(2),o=(l&16384)>>14,d=(l&32768)>>15;if(l&=16383,d==1)for(;s>524287;)s-=1048576;if(o==1)for(;l>8191;)l=l-16384;return{r:s,c:l,cRel:o,rRel:d}}function lM(e){var n=e.read_shift(2),a=e.read_shift(1),r=(n&32768)>>15,s=(n&16384)>>14;return n&=16383,r==1&&n>=8192&&(n=n-16384),s==1&&a>=128&&(a=a-256),{r:n,c:a,cRel:s,rRel:r}}function oM(e,n,a){var r=(e[e.l++]&96)>>5,s=Qk(e,a.biff>=2&&a.biff<=5?6:8,a);return[r,s]}function cM(e,n,a){var r=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),l=8;if(a)switch(a.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var o=Qk(e,l,a);return[r,s,o]}function dM(e,n,a){var r=(e[e.l++]&96)>>5;return e.l+=a&&a.biff>8?12:a.biff<8?6:8,[r]}function uM(e,n,a){var r=(e[e.l++]&96)>>5,s=e.read_shift(2),l=8;if(a)switch(a.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[r,s]}function hM(e,n,a){var r=(e[e.l++]&96)>>5,s=aM(e,n-1,a);return[r,s]}function xM(e,n,a){var r=(e[e.l++]&96)>>5;return e.l+=a.biff==2?6:a.biff==12?14:7,[r]}function YN(e){var n=e[e.l+1]&1,a=1;return e.l+=4,[n,a]}function mM(e,n,a){e.l+=2;for(var r=e.read_shift(a&&a.biff==2?1:2),s=[],l=0;l<=r;++l)s.push(e.read_shift(a&&a.biff==2?1:2));return s}function fM(e,n,a){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(a&&a.biff==2?1:2)]}function pM(e,n,a){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(a&&a.biff==2?1:2)]}function gM(e){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(2)]}function yM(e,n,a){var r=e[e.l+1]&255?1:0;return e.l+=a&&a.biff==2?3:4,[r]}function Zk(e){var n=e.read_shift(1),a=e.read_shift(1);return[n,a]}function vM(e){return e.read_shift(2),Zk(e)}function bM(e){return e.read_shift(2),Zk(e)}function NM(e,n,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=Jk(e,0,a);return[r,s]}function jM(e,n,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=iM(e,0,a);return[r,s]}function wM(e,n,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);a&&a.biff==5&&(e.l+=12);var l=Jk(e,0,a);return[r,s,l]}function kM(e,n,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(a&&a.biff<=3?1:2);return[S7[s],nT[s],r]}function TM(e,n,a){var r=e[e.l++],s=e.read_shift(1),l=a&&a.biff<=3?[r==88?-1:0,e.read_shift(1)]:CM(e);return[s,(l[0]===0?nT:C7)[l[1]]]}function CM(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function SM(e,n,a){e.l+=a&&a.biff==2?3:4}function _M(e,n,a){if(e.l++,a&&a.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),s=e.read_shift(a&&a.biff==2?1:2);return[r,s]}function EM(e){return e.l++,ui[e.read_shift(1)]}function DM(e){return e.l++,e.read_shift(2)}function AM(e){return e.l++,e.read_shift(1)!==0}function FM(e){return e.l++,wa(e)}function LM(e,n,a){return e.l++,ku(e,n-1,a)}function PM(e,n){var a=[e.read_shift(1)];if(n==12)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2;break}switch(a[0]){case 4:a[1]=_n(e,1)?"TRUE":"FALSE",n!=12&&(e.l+=7);break;case 37:case 16:a[1]=ui[e[e.l]],e.l+=n==12?4:8;break;case 0:e.l+=8;break;case 1:a[1]=wa(e);break;case 2:a[1]=bo(e,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function IM(e,n,a){for(var r=e.read_shift(a.biff==12?4:2),s=[],l=0;l!=r;++l)s.push((a.biff==12?vo:lx)(e));return s}function OM(e,n,a){var r=0,s=0;a.biff==12?(r=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),r=1+e.read_shift(2)),a.biff>=2&&a.biff<8&&(--r,--s==0&&(s=256));for(var l=0,o=[];l!=r&&(o[l]=[]);++l)for(var d=0;d!=s;++d)o[l][d]=PM(e,a.biff);return o}function MM(e,n,a){var r=e.read_shift(1)>>>5&3,s=!a||a.biff>=8?4:2,l=e.read_shift(s);switch(a.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,l]}function RM(e,n,a){if(a.biff==5)return BM(e);var r=e.read_shift(1)>>>5&3,s=e.read_shift(2),l=e.read_shift(4);return[r,s,l]}function BM(e){var n=e.read_shift(1)>>>5&3,a=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[n,a,r]}function HM(e,n,a){var r=e.read_shift(1)>>>5&3;e.l+=a&&a.biff==2?3:4;var s=e.read_shift(a&&a.biff==2?1:2);return[r,s]}function VM(e,n,a){var r=e.read_shift(1)>>>5&3,s=e.read_shift(a&&a.biff==2?1:2);return[r,s]}function UM(e,n,a){var r=e.read_shift(1)>>>5&3;return e.l+=4,a.biff<8&&e.l--,a.biff==12&&(e.l+=2),[r]}function KM(e,n,a){var r=(e[e.l++]&96)>>5,s=e.read_shift(2),l=4;if(a)switch(a.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[r,s]}var zM=Ta,$M=Ta,GM=Ta;function Cu(e,n,a){return e.l+=2,[sM(e)]}function $g(e){return e.l+=6,[]}var qM=Cu,WM=$g,XM=$g,QM=Cu;function eT(e){return e.l+=2,[On(e),e.read_shift(2)&1]}var YM=Cu,JM=eT,ZM=$g,e7=Cu,t7=Cu,n7=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function a7(e){e.l+=2;var n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(4),s=e.read_shift(2),l=e.read_shift(2),o=n7[a>>2&31];return{ixti:n,coltype:a&3,rt:o,idx:r,c:s,C:l}}function r7(e){return e.l+=2,[e.read_shift(4)]}function s7(e,n,a){return e.l+=5,e.l+=2,e.l+=a.biff==2?1:4,["PTGSHEET"]}function i7(e,n,a){return e.l+=a.biff==2?4:5,["PTGENDSHEET"]}function l7(e){var n=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[n,a]}function o7(e){var n=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[n,a]}function c7(e){return e.l+=4,[0,0]}var JN={1:{n:"PtgExp",f:_M},2:{n:"PtgTbl",f:GM},3:{n:"PtgAdd",f:Pn},4:{n:"PtgSub",f:Pn},5:{n:"PtgMul",f:Pn},6:{n:"PtgDiv",f:Pn},7:{n:"PtgPower",f:Pn},8:{n:"PtgConcat",f:Pn},9:{n:"PtgLt",f:Pn},10:{n:"PtgLe",f:Pn},11:{n:"PtgEq",f:Pn},12:{n:"PtgGe",f:Pn},13:{n:"PtgGt",f:Pn},14:{n:"PtgNe",f:Pn},15:{n:"PtgIsect",f:Pn},16:{n:"PtgUnion",f:Pn},17:{n:"PtgRange",f:Pn},18:{n:"PtgUplus",f:Pn},19:{n:"PtgUminus",f:Pn},20:{n:"PtgPercent",f:Pn},21:{n:"PtgParen",f:Pn},22:{n:"PtgMissArg",f:Pn},23:{n:"PtgStr",f:LM},26:{n:"PtgSheet",f:s7},27:{n:"PtgEndSheet",f:i7},28:{n:"PtgErr",f:EM},29:{n:"PtgBool",f:AM},30:{n:"PtgInt",f:DM},31:{n:"PtgNum",f:FM},32:{n:"PtgArray",f:xM},33:{n:"PtgFunc",f:kM},34:{n:"PtgFuncVar",f:TM},35:{n:"PtgName",f:MM},36:{n:"PtgRef",f:NM},37:{n:"PtgArea",f:oM},38:{n:"PtgMemArea",f:HM},39:{n:"PtgMemErr",f:zM},40:{n:"PtgMemNoMem",f:$M},41:{n:"PtgMemFunc",f:VM},42:{n:"PtgRefErr",f:UM},43:{n:"PtgAreaErr",f:dM},44:{n:"PtgRefN",f:jM},45:{n:"PtgAreaN",f:hM},46:{n:"PtgMemAreaN",f:l7},47:{n:"PtgMemNoMemN",f:o7},57:{n:"PtgNameX",f:RM},58:{n:"PtgRef3d",f:wM},59:{n:"PtgArea3d",f:cM},60:{n:"PtgRefErr3d",f:KM},61:{n:"PtgAreaErr3d",f:uM},255:{}},d7={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},u7={1:{n:"PtgElfLel",f:eT},2:{n:"PtgElfRw",f:e7},3:{n:"PtgElfCol",f:qM},6:{n:"PtgElfRwV",f:t7},7:{n:"PtgElfColV",f:QM},10:{n:"PtgElfRadical",f:YM},11:{n:"PtgElfRadicalS",f:ZM},13:{n:"PtgElfColS",f:WM},15:{n:"PtgElfColSV",f:XM},16:{n:"PtgElfRadicalLel",f:JM},25:{n:"PtgList",f:a7},29:{n:"PtgSxName",f:r7},255:{}},h7={0:{n:"PtgAttrNoop",f:c7},1:{n:"PtgAttrSemi",f:yM},2:{n:"PtgAttrIf",f:pM},4:{n:"PtgAttrChoose",f:mM},8:{n:"PtgAttrGoto",f:fM},16:{n:"PtgAttrSum",f:SM},32:{n:"PtgAttrBaxcel",f:YN},33:{n:"PtgAttrBaxcel",f:YN},64:{n:"PtgAttrSpace",f:vM},65:{n:"PtgAttrSpaceSemi",f:bM},128:{n:"PtgAttrIfError",f:gM},255:{}};function Su(e,n,a,r){if(r.biff<8)return Ta(e,n);for(var s=e.l+n,l=[],o=0;o!==a.length;++o)switch(a[o][0]){case"PtgArray":a[o][1]=OM(e,0,r),l.push(a[o][1]);break;case"PtgMemArea":a[o][2]=IM(e,a[o][1],r),l.push(a[o][2]);break;case"PtgExp":r&&r.biff==12&&(a[o][1][1]=e.read_shift(4),l.push(a[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[o][0]}return n=s-e.l,n!==0&&l.push(Ta(e,n)),l}function _u(e,n,a){for(var r=e.l+n,s,l,o=[];r!=e.l;)n=r-e.l,l=e[e.l],s=JN[l]||JN[d7[l]],(l===24||l===25)&&(s=(l===24?u7:h7)[e[e.l+1]]),!s||!s.f?Ta(e,n):o.push([s.n,s.f(e,n,a)]);return o}function x7(e){for(var n=[],a=0;a<e.length;++a){for(var r=e[a],s=[],l=0;l<r.length;++l){var o=r[l];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}n.push(s.join(","))}return n.join(";")}var m7={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function f7(e,n){if(!e&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function tT(e,n,a){if(!e)return"SH33TJSERR0";if(a.biff>8&&(!e.XTI||!e.XTI[n]))return e.SheetNames[n];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[n];if(a.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":e.XTI[n-1];if(!r)return"SH33TJSERR1";var s="";if(a.biff>8)switch(e[r[0]][0]){case 357:return s=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 358:return a.SID!=null?e.SheetNames[a.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return s=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[r[0]][0][3]?(s=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?s:s+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function ZN(e,n,a){var r=tT(e,n,a);return r=="#REF"?r:f7(r,a)}function ba(e,n,a,r,s){var l=s&&s.biff||8,o={s:{c:0,r:0}},d=[],u,x,m,f=0,p=0,b,g="";if(!e[0]||!e[0][0])return"";for(var y=-1,N="",k=0,T=e[0].length;k<T;++k){var S=e[0][k];switch(S[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=d.pop(),x=d.pop(),y>=0){switch(e[0][y][1][0]){case 0:N=jn(" ",e[0][y][1][1]);break;case 1:N=jn("\r",e[0][y][1][1]);break;default:if(N="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}x=x+N,y=-1}d.push(x+m7[S[0]]+u);break;case"PtgIsect":u=d.pop(),x=d.pop(),d.push(x+" "+u);break;case"PtgUnion":u=d.pop(),x=d.pop(),d.push(x+","+u);break;case"PtgRange":u=d.pop(),x=d.pop(),d.push(x+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=Rd(S[1][1],o,s),d.push(Bd(m,l));break;case"PtgRefN":m=a?Rd(S[1][1],a,s):S[1][1],d.push(Bd(m,l));break;case"PtgRef3d":f=S[1][1],m=Rd(S[1][2],o,s),g=ZN(r,f,s),d.push(g+"!"+Bd(m,l));break;case"PtgFunc":case"PtgFuncVar":var w=S[1][0],_=S[1][1];w||(w=0),w&=127;var L=w==0?[]:d.slice(-w);d.length-=w,_==="User"&&(_=L.shift()),d.push(_+"("+L.join(",")+")");break;case"PtgBool":d.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":d.push(S[1]);break;case"PtgNum":d.push(String(S[1]));break;case"PtgStr":d.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":d.push(S[1]);break;case"PtgAreaN":b=_N(S[1][1],a?{s:a}:o,s),d.push(wf(b,s));break;case"PtgArea":b=_N(S[1][1],o,s),d.push(wf(b,s));break;case"PtgArea3d":f=S[1][1],b=S[1][2],g=ZN(r,f,s),d.push(g+"!"+wf(b,s));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=S[1][2];var C=(r.names||[])[p-1]||(r[0]||[])[p],P=C?C.Name:"SH33TJSNAME"+String(p);P&&P.slice(0,6)=="_xlfn."&&!s.xlfn&&(P=P.slice(6)),d.push(P);break;case"PtgNameX":var F=S[1][1];p=S[1][2];var H;if(s.biff<=5)F<0&&(F=-F),r[F]&&(H=r[F][p]);else{var O="";if(((r[F]||[])[0]||[])[0]==14849||(((r[F]||[])[0]||[])[0]==1025?r[F][p]&&r[F][p].itab>0&&(O=r.SheetNames[r[F][p].itab-1]+"!"):O=r.SheetNames[p-1]+"!"),r[F]&&r[F][p])O+=r[F][p].Name;else if(r[0]&&r[0][p])O+=r[0][p].Name;else{var B=(tT(r,F,s)||"").split(";;");B[p-1]?O=B[p-1]:O+="SH33TJSERRX"}d.push(O);break}H||(H={Name:"SH33TJSERRY"}),d.push(H.Name);break;case"PtgParen":var W="(",ee=")";if(y>=0){switch(N="",e[0][y][1][0]){case 2:W=jn(" ",e[0][y][1][1])+W;break;case 3:W=jn("\r",e[0][y][1][1])+W;break;case 4:ee=jn(" ",e[0][y][1][1])+ee;break;case 5:ee=jn("\r",e[0][y][1][1])+ee;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}d.push(W+d.pop()+ee);break;case"PtgRefErr":d.push("#REF!");break;case"PtgRefErr3d":d.push("#REF!");break;case"PtgExp":m={c:S[1][1],r:S[1][0]};var q={c:a.c,r:a.r};if(r.sharedf[dt(m)]){var fe=r.sharedf[dt(m)];d.push(ba(fe,o,q,r,s))}else{var ne=!1;for(u=0;u!=r.arrayf.length;++u)if(x=r.arrayf[u],!(m.c<x[0].s.c||m.c>x[0].e.c)&&!(m.r<x[0].s.r||m.r>x[0].e.r)){d.push(ba(x[1],o,q,r,s)),ne=!0;break}ne||d.push(S[1])}break;case"PtgArray":d.push("{"+x7(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":d.push("");break;case"PtgAreaErr":d.push("#REF!");break;case"PtgAreaErr3d":d.push("#REF!");break;case"PtgList":d.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var Y=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&y>=0&&Y.indexOf(e[0][k][0])==-1){S=e[0][y];var X=!0;switch(S[1][0]){case 4:X=!1;case 0:N=jn(" ",S[1][1]);break;case 5:X=!1;case 1:N=jn("\r",S[1][1]);break;default:if(N="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}d.push((X?N:"")+d.pop()+(X?"":N)),y=-1}}if(d.length>1&&s.WTF)throw new Error("bad formula stack");return d[0]}function p7(e,n,a){var r=e.l+n,s=a.biff==2?1:2,l,o=e.read_shift(s);if(o==65535)return[[],Ta(e,n-2)];var d=_u(e,o,a);return n!==o+s&&(l=Su(e,n-o-s,d,a)),e.l=r,[d,l]}function g7(e,n,a){var r=e.l+n,s=a.biff==2?1:2,l,o=e.read_shift(s);if(o==65535)return[[],Ta(e,n-2)];var d=_u(e,o,a);return n!==o+s&&(l=Su(e,n-o-s,d,a)),e.l=r,[d,l]}function y7(e,n,a,r){var s=e.l+n,l=_u(e,r,a),o;return s!==e.l&&(o=Su(e,s-e.l,l,a)),[l,o]}function v7(e,n,a){var r=e.l+n,s,l=e.read_shift(2),o=_u(e,l,a);return l==65535?[[],Ta(e,n-2)]:(n!==l+2&&(s=Su(e,r-l-2,o,a)),[o,s])}function b7(e){var n;if(Qs(e,e.l+6)!==65535)return[wa(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return n=e[e.l+2]===1,e.l+=8,[n,"b"];case 2:return n=e[e.l+2],e.l+=8,[n,"e"];case 3:return e.l+=8,["","s"]}return[]}function N7(e){if(e==null){var n=Ce(8);return n.write_shift(1,3),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,65535),n}else if(typeof e=="number")return oo(e);return oo(0)}function _f(e,n,a){var r=e.l+n,s=Ds(e);a.biff==2&&++e.l;var l=b7(e),o=e.read_shift(1);a.biff!=2&&(e.read_shift(1),a.biff>=5&&e.read_shift(4));var d=g7(e,r-e.l,a);return{cell:s,val:l[0],formula:d,shared:o>>3&1,tt:l[1]}}function j7(e,n,a,r,s){var l=uo(n,a,s),o=N7(e.v),d=Ce(6),u=33;d.write_shift(2,u),d.write_shift(4,0);for(var x=Ce(e.bf.length),m=0;m<e.bf.length;++m)x[m]=e.bf[m];var f=ta([l,o,d,x]);return f}function ox(e,n,a){var r=e.read_shift(4),s=_u(e,r,a),l=e.read_shift(4),o=l>0?Su(e,l,s,a):null;return[s,o]}var w7=ox,cx=ox,k7=ox,T7=ox,C7={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},nT={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},S7={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function e2(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,a){return a.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function _7(e){var n="of:="+e.replace(Kg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return n.replace(/;/g,"|").replace(/,/g,";")}function Ef(e){var n=e.split(":"),a=n[0].split(".")[0];return[a,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}function E7(e){return e.replace(/\./,"!")}var Vd={},oc={},Ud=typeof Map<"u";function Gg(e,n,a){var r=0,s=e.length;if(a){if(Ud?a.has(n):Object.prototype.hasOwnProperty.call(a,n)){for(var l=Ud?a.get(n):a[n];r<l.length;++r)if(e[l[r]].t===n)return e.Count++,l[r]}}else for(;r<s;++r)if(e[r].t===n)return e.Count++,r;return e[s]={t:n},e.Count++,e.Unique++,a&&(Ud?(a.has(n)||a.set(n,[]),a.get(n).push(s)):(Object.prototype.hasOwnProperty.call(a,n)||(a[n]=[]),a[n].push(s))),s}function dx(e,n){var a={min:e+1,max:e+1},r=-1;return n.MDW&&(Na=n.MDW),n.width!=null?a.customWidth=1:n.wpx!=null?r=su(n.wpx):n.wch!=null&&(r=n.wch),r>-1?(a.width=O0(r),a.customWidth=1):n.width!=null&&(a.width=n.width),n.hidden&&(a.hidden=!0),n.level!=null&&(a.outlineLevel=a.level=n.level),a}function to(e,n){if(e){var a=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(a=[1,1,1,1,.5,.5]),e.left==null&&(e.left=a[0]),e.right==null&&(e.right=a[1]),e.top==null&&(e.top=a[2]),e.bottom==null&&(e.bottom=a[3]),e.header==null&&(e.header=a[4]),e.footer==null&&(e.footer=a[5])}}function xl(e,n,a){var r=a.revssf[n.z!=null?n.z:"General"],s=60,l=e.length;if(r==null&&a.ssf){for(;s<392;++s)if(a.ssf[s]==null){ni(n.z,s),a.ssf[s]=n.z,a.revssf[n.z]=r=s;break}}for(s=0;s!=l;++s)if(e[s].numFmtId===r)return s;return e[l]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function aT(e,n,a,r,s,l){try{r.cellNF&&(e.z=ct[n])}catch(d){if(r.WTF)throw d}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=un(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(ct[n]==null&&ni(CF[n]||"General",n),e.t==="e")e.w=e.w||ui[e.v];else if(n===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Jd(e.v);else if(e.t==="d"){var o=Gn(e.v);(o|0)===o?e.w=o.toString(10):e.w=Jd(o)}else{if(e.v===void 0)return"";e.w=io(e.v,oc)}else e.t==="d"?e.w=Br(n,Gn(e.v),oc):e.w=Br(n,e.v,oc)}catch(d){if(r.WTF)throw d}if(r.cellStyles&&a!=null)try{e.s=l.Fills[a],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=I0(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=I0(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(d){if(r.WTF&&l.Fills)throw d}}}function D7(e,n,a){if(e&&e["!ref"]){var r=Ft(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+a+"): "+e["!ref"])}}function A7(e,n){var a=Ft(n);a.s.r<=a.e.r&&a.s.c<=a.e.c&&a.s.r>=0&&a.s.c>=0&&(e["!ref"]=pt(a))}var F7=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,L7=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,P7=/<(?:\w:)?hyperlink [^>]*>/mg,I7=/"(\w*:\w*)"/,O7=/<(?:\w:)?col\b[^>]*[\/]?>/g,M7=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,R7=/<(?:\w:)?pageMargins[^>]*\/>/g,rT=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,B7=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,H7=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function V7(e,n,a,r,s,l,o){if(!e)return e;r||(r={"!id":{}});var d=n.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},x="",m="",f=e.match(L7);f?(x=e.slice(0,f.index),m=e.slice(f.index+f[0].length)):x=m=e;var p=x.match(rT);p?qg(p[0],d,s,a):(p=x.match(B7))&&K7(p[0],p[1]||"",d,s,a);var b=(x.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(b>0){var g=x.slice(b,b+50).match(I7);g&&A7(d,g[1])}var y=x.match(H7);y&&y[1]&&nR(y[1],s);var N=[];if(n.cellStyles){var k=x.match(O7);k&&Y7(N,k)}f&&sR(f[1],d,n,u,l,o);var T=m.match(M7);T&&(d["!autofilter"]=Z7(T[0]));var S=[],w=m.match(F7);if(w)for(b=0;b!=w.length;++b)S[b]=Ft(w[b].slice(w[b].indexOf('"')+1));var _=m.match(P7);_&&W7(d,_,r);var L=m.match(R7);if(L&&(d["!margins"]=X7(ut(L[0]))),!d["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(d["!ref"]=pt(u)),n.sheetRows>0&&d["!ref"]){var C=Ft(d["!ref"]);n.sheetRows<=+C.e.r&&(C.e.r=n.sheetRows-1,C.e.r>u.e.r&&(C.e.r=u.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>u.e.c&&(C.e.c=u.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),d["!fullref"]=d["!ref"],d["!ref"]=pt(C))}return N.length>0&&(d["!cols"]=N),S.length>0&&(d["!merges"]=S),d}function U7(e){if(e.length===0)return"";for(var n='<mergeCells count="'+e.length+'">',a=0;a!=e.length;++a)n+='<mergeCell ref="'+pt(e[a])+'"/>';return n+"</mergeCells>"}function qg(e,n,a,r){var s=ut(e);a.Sheets[r]||(a.Sheets[r]={}),s.codeName&&(a.Sheets[r].CodeName=Dt(Qt(s.codeName)))}function K7(e,n,a,r,s){qg(e.slice(0,e.indexOf(">")),a,r,s)}function z7(e,n,a,r,s){var l=!1,o={},d=null;if(r.bookType!=="xlsx"&&n.vbaraw){var u=n.SheetNames[a];try{n.Workbook&&(u=n.Workbook.Sheets[a].CodeName||u)}catch{}l=!0,o.codeName=ws(qt(u))}if(e&&e["!outline"]){var x={summaryBelow:1,summaryRight:1};e["!outline"].above&&(x.summaryBelow=0),e["!outline"].left&&(x.summaryRight=0),d=(d||"")+Ue("outlinePr",null,x)}!l&&!d||(s[s.length]=Ue("sheetPr",d,o))}var $7=["objects","scenarios","selectLockedCells","selectUnlockedCells"],G7=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function q7(e){var n={sheet:1};return $7.forEach(function(a){e[a]!=null&&e[a]&&(n[a]="1")}),G7.forEach(function(a){e[a]!=null&&!e[a]&&(n[a]="0")}),e.password&&(n.password=Hg(e.password).toString(16).toUpperCase()),Ue("sheetProtection",null,n)}function W7(e,n,a){for(var r=Array.isArray(e),s=0;s!=n.length;++s){var l=ut(Qt(n[s]),!0);if(!l.ref)return;var o=((a||{})["!id"]||[])[l.id];o?(l.Target=o.Target,l.location&&(l.Target+="#"+Dt(l.location))):(l.Target="#"+Dt(l.location),o={Target:l.Target,TargetMode:"Internal"}),l.Rel=o,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var d=Ft(l.ref),u=d.s.r;u<=d.e.r;++u)for(var x=d.s.c;x<=d.e.c;++x){var m=dt({c:x,r:u});r?(e[u]||(e[u]=[]),e[u][x]||(e[u][x]={t:"z",v:void 0}),e[u][x].l=l):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=l)}}}function X7(e){var n={};return["left","right","top","bottom","header","footer"].forEach(function(a){e[a]&&(n[a]=parseFloat(e[a]))}),n}function Q7(e){return to(e),Ue("pageMargins",null,e)}function Y7(e,n){for(var a=!1,r=0;r!=n.length;++r){var s=ut(n[r],!0);s.hidden&&(s.hidden=on(s.hidden));var l=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!a&&s.width&&(a=!0,Vg(s.width)),sl(s);l<=o;)e[l++]=hn(s)}}function J7(e,n){for(var a=["<cols>"],r,s=0;s!=n.length;++s)(r=n[s])&&(a[a.length]=Ue("col",null,dx(s,r)));return a[a.length]="</cols>",a.join("")}function Z7(e){var n={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return n}function eR(e,n,a,r){var s=typeof e.ref=="string"?e.ref:pt(e.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var l=a.Workbook.Names,o=nr(s);o.s.r==o.e.r&&(o.e.r=nr(n["!ref"]).e.r,s=pt(o));for(var d=0;d<l.length;++d){var u=l[d];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r){u.Ref="'"+a.SheetNames[r]+"'!"+s;break}}return d==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+a.SheetNames[r]+"'!"+s}),Ue("autoFilter",null,{ref:s})}var tR=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function nR(e,n){n.Views||(n.Views=[{}]),(e.match(tR)||[]).forEach(function(a,r){var s=ut(a);n.Views[r]||(n.Views[r]={}),+s.zoomScale&&(n.Views[r].zoom=+s.zoomScale),on(s.rightToLeft)&&(n.Views[r].RTL=!0)})}function aR(e,n,a,r){var s={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Ue("sheetViews",Ue("sheetView",null,s),{})}function rR(e,n,a,r){if(e.c&&a["!comments"].push([n,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",l=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=ui[e.v];break;case"d":r&&r.cellDates?s=un(e.v,-1).toISOString():(e=hn(e),e.t="n",s=""+(e.v=Gn(un(e.v)))),typeof e.z>"u"&&(e.z=ct[14]);break;default:s=e.v;break}var d=da("v",qt(s)),u={r:n},x=xl(r.cellXfs,e,r);switch(x!==0&&(u.s=x),e.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){d=da("v",""+Gg(r.Strings,e.v,r.revStrings)),u.t="s";break}u.t="str";break}if(e.t!=l&&(e.t=l,e.v=o),typeof e.f=="string"&&e.f){var m=e.F&&e.F.slice(0,n.length)==n?{t:"array",ref:e.F}:null;d=Ue("f",qt(e.f),m)+(e.v!=null?d:"")}return e.l&&a["!links"].push([n,e.l]),e.D&&(u.cm=1),Ue("c",d,u)}var sR=(function(){var e=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,a=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,l=Zd("v"),o=Zd("f");return function(u,x,m,f,p,b){for(var g=0,y="",N=[],k=[],T=0,S=0,w=0,_="",L,C,P=0,F=0,H,O,B=0,W=0,ee=Array.isArray(b.CellXf),q,fe=[],ne=[],Y=Array.isArray(x),X=[],xe={},K=!1,A=!!m.sheetStubs,M=u.split(n),I=0,V=M.length;I!=V;++I){y=M[I].trim();var J=y.length;if(J!==0){var ge=0;e:for(g=0;g<J;++g)switch(y[g]){case">":if(y[g-1]!="/"){++g;break e}if(m&&m.cellStyles){if(C=ut(y.slice(ge,g),!0),P=C.r!=null?parseInt(C.r,10):P+1,F=-1,m.sheetRows&&m.sheetRows<P)continue;xe={},K=!1,C.ht&&(K=!0,xe.hpt=parseFloat(C.ht),xe.hpx=_c(xe.hpt)),C.hidden=="1"&&(K=!0,xe.hidden=!0),C.outlineLevel!=null&&(K=!0,xe.level=+C.outlineLevel),K&&(X[P-1]=xe)}break;case"<":ge=g;break}if(ge>=g)break;if(C=ut(y.slice(ge,g),!0),P=C.r!=null?parseInt(C.r,10):P+1,F=-1,!(m.sheetRows&&m.sheetRows<P)){f.s.r>P-1&&(f.s.r=P-1),f.e.r<P-1&&(f.e.r=P-1),m&&m.cellStyles&&(xe={},K=!1,C.ht&&(K=!0,xe.hpt=parseFloat(C.ht),xe.hpx=_c(xe.hpt)),C.hidden=="1"&&(K=!0,xe.hidden=!0),C.outlineLevel!=null&&(K=!0,xe.level=+C.outlineLevel),K&&(X[P-1]=xe)),N=y.slice(g).split(e);for(var z=0;z!=N.length&&N[z].trim().charAt(0)=="<";++z);for(N=N.slice(z),g=0;g!=N.length;++g)if(y=N[g].trim(),y.length!==0){if(k=y.match(a),T=g,S=0,w=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,k!=null&&k.length===2){for(T=0,_=k[1],S=0;S!=_.length&&!((w=_.charCodeAt(S)-64)<1||w>26);++S)T=26*T+w;--T,F=T}else++F;for(S=0;S!=y.length&&y.charCodeAt(S)!==62;++S);if(++S,C=ut(y.slice(0,S),!0),C.r||(C.r=dt({r:P-1,c:F})),_=y.slice(S),L={t:""},(k=_.match(l))!=null&&k[1]!==""&&(L.v=Dt(k[1])),m.cellFormula){if((k=_.match(o))!=null&&k[1]!==""){if(L.f=Dt(Qt(k[1])).replace(/\r\n/g,`
`),m.xlfn||(L.f=QN(L.f)),k[0].indexOf('t="array"')>-1)L.F=(_.match(s)||[])[1],L.F.indexOf(":")>-1&&fe.push([Ft(L.F),L.F]);else if(k[0].indexOf('t="shared"')>-1){O=ut(k[0]);var le=Dt(Qt(k[1]));m.xlfn||(le=QN(le)),ne[parseInt(O.si,10)]=[O,le,C.r]}}else(k=_.match(/<f[^>]*\/>/))&&(O=ut(k[0]),ne[O.si]&&(L.f=tM(ne[O.si][1],ne[O.si][2],C.r)));var ue=vn(C.r);for(S=0;S<fe.length;++S)ue.r>=fe[S][0].s.r&&ue.r<=fe[S][0].e.r&&ue.c>=fe[S][0].s.c&&ue.c<=fe[S][0].e.c&&(L.F=fe[S][1])}if(C.t==null&&L.v===void 0)if(L.f||L.F)L.v=0,L.t="n";else if(A)L.t="z";else continue;else L.t=C.t||"n";switch(f.s.c>F&&(f.s.c=F),f.e.c<F&&(f.e.c=F),L.t){case"n":if(L.v==""||L.v==null){if(!A)continue;L.t="z"}else L.v=parseFloat(L.v);break;case"s":if(typeof L.v>"u"){if(!A)continue;L.t="z"}else H=Vd[parseInt(L.v,10)],L.v=H.t,L.r=H.r,m.cellHTML&&(L.h=H.h);break;case"str":L.t="s",L.v=L.v!=null?Qt(L.v):"",m.cellHTML&&(L.h=Tg(L.v));break;case"inlineStr":k=_.match(r),L.t="s",k!=null&&(H=Bg(k[1]))?(L.v=H.t,m.cellHTML&&(L.h=H.h)):L.v="";break;case"b":L.v=on(L.v);break;case"d":m.cellDates?L.v=un(L.v,1):(L.v=Gn(un(L.v,1)),L.t="n");break;case"e":(!m||m.cellText!==!1)&&(L.w=L.v),L.v=ik[L.v];break}if(B=W=0,q=null,ee&&C.s!==void 0&&(q=b.CellXf[C.s],q!=null&&(q.numFmtId!=null&&(B=q.numFmtId),m.cellStyles&&q.fillId!=null&&(W=q.fillId))),aT(L,B,W,m,p,b),m.cellDates&&ee&&L.t=="n"&&Pc(ct[B])&&(L.t="d",L.v=ix(L.v)),C.cm&&m.xlmeta){var ce=(m.xlmeta.Cell||[])[+C.cm-1];ce&&ce.type=="XLDAPR"&&(L.D=!0)}if(Y){var R=vn(C.r);x[R.r]||(x[R.r]=[]),x[R.r][R.c]=L}else x[C.r]=L}}}}X.length>0&&(x["!rows"]=X)}})();function iR(e,n,a,r){var s=[],l=[],o=Ft(e["!ref"]),d="",u,x="",m=[],f=0,p=0,b=e["!rows"],g=Array.isArray(e),y={r:x},N,k=-1;for(p=o.s.c;p<=o.e.c;++p)m[p]=yn(p);for(f=o.s.r;f<=o.e.r;++f){for(l=[],x=Dn(f),p=o.s.c;p<=o.e.c;++p){u=m[p]+x;var T=g?(e[f]||[])[p]:e[u];T!==void 0&&(d=rR(T,u,e,n))!=null&&l.push(d)}(l.length>0||b&&b[f])&&(y={r:x},b&&b[f]&&(N=b[f],N.hidden&&(y.hidden=1),k=-1,N.hpx?k=iu(N.hpx):N.hpt&&(k=N.hpt),k>-1&&(y.ht=k,y.customHeight=1),N.level&&(y.outlineLevel=N.level)),s[s.length]=Ue("row",l.join(""),y))}if(b)for(;f<b.length;++f)b&&b[f]&&(y={r:f+1},N=b[f],N.hidden&&(y.hidden=1),k=-1,N.hpx?k=iu(N.hpx):N.hpt&&(k=N.hpt),k>-1&&(y.ht=k,y.customHeight=1),N.level&&(y.outlineLevel=N.level),s[s.length]=Ue("row","",y));return s.join("")}function sT(e,n,a,r){var s=[An,Ue("worksheet",null,{xmlns:fo[0],"xmlns:r":zn.r})],l=a.SheetNames[e],o=0,d="",u=a.Sheets[l];u==null&&(u={});var x=u["!ref"]||"A1",m=Ft(x);if(m.e.c>16383||m.e.r>1048575){if(n.WTF)throw new Error("Range "+x+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),x=pt(m)}r||(r={}),u["!comments"]=[];var f=[];z7(u,a,e,n,s),s[s.length]=Ue("dimension",null,{ref:x}),s[s.length]=aR(u,n,e,a),n.sheetFormat&&(s[s.length]=Ue("sheetFormatPr",null,{defaultRowHeight:n.sheetFormat.defaultRowHeight||"16",baseColWidth:n.sheetFormat.baseColWidth||"10",outlineLevelRow:n.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(s[s.length]=J7(u,u["!cols"])),s[o=s.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(d=iR(u,n),d.length>0&&(s[s.length]=d)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),u["!protect"]&&(s[s.length]=q7(u["!protect"])),u["!autofilter"]!=null&&(s[s.length]=eR(u["!autofilter"],u,a,e)),u["!merges"]!=null&&u["!merges"].length>0&&(s[s.length]=U7(u["!merges"]));var p=-1,b,g=-1;return u["!links"].length>0&&(s[s.length]="<hyperlinks>",u["!links"].forEach(function(y){y[1].Target&&(b={ref:y[0]},y[1].Target.charAt(0)!="#"&&(g=Gt(r,-1,qt(y[1].Target).replace(/#.*$/,""),jt.HLINK),b["r:id"]="rId"+g),(p=y[1].Target.indexOf("#"))>-1&&(b.location=qt(y[1].Target.slice(p+1))),y[1].Tooltip&&(b.tooltip=qt(y[1].Tooltip)),s[s.length]=Ue("hyperlink",null,b))}),s[s.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(s[s.length]=Q7(u["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&(s[s.length]=da("ignoredErrors",Ue("ignoredError",null,{numberStoredAsText:1,sqref:x}))),f.length>0&&(g=Gt(r,-1,"../drawings/drawing"+(e+1)+".xml",jt.DRAW),s[s.length]=Ue("drawing",null,{"r:id":"rId"+g}),u["!drawing"]=f),u["!comments"].length>0&&(g=Gt(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",jt.VML),s[s.length]=Ue("legacyDrawing",null,{"r:id":"rId"+g}),u["!legacy"]=g),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function lR(e,n){var a={},r=e.l+n;a.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=r,l&7&&(a.level=l&7),l&16&&(a.hidden=!0),l&32&&(a.hpt=s/20),a}function oR(e,n,a){var r=Ce(145),s=(a["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var l=320;s.hpx?l=iu(s.hpx)*20:s.hpt&&(l=s.hpt*20),r.write_shift(2,l),r.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var d=0,u=r.l;r.l+=4;for(var x={r:e,c:0},m=0;m<16;++m)if(!(n.s.c>m+1<<10||n.e.c<m<<10)){for(var f=-1,p=-1,b=m<<10;b<m+1<<10;++b){x.c=b;var g=Array.isArray(a)?(a[x.r]||[])[x.c]:a[dt(x)];g&&(f<0&&(f=b),p=b)}f<0||(++d,r.write_shift(4,f),r.write_shift(4,p))}var y=r.l;return r.l=u,r.write_shift(4,d),r.l=y,r.length>r.l?r.slice(0,r.l):r}function cR(e,n,a,r){var s=oR(r,a,n);(s.length>17||(n["!rows"]||[])[r])&&Ee(e,0,s)}var dR=vo,uR=Mc;function hR(){}function xR(e,n){var a={},r=e[e.l];return++e.l,a.above=!(r&64),a.left=!(r&128),e.l+=18,a.name=p8(e),a}function mR(e,n,a){a==null&&(a=Ce(84+4*e.length));var r=192;n&&(n.above&&(r&=-65),n.left&&(r&=-129)),a.write_shift(1,r);for(var s=1;s<3;++s)a.write_shift(1,0);return F0({auto:1},a),a.write_shift(-4,-1),a.write_shift(-4,-1),tk(e,a),a.slice(0,a.l)}function fR(e){var n=Vr(e);return[n]}function pR(e,n,a){return a==null&&(a=Ce(8)),po(n,a)}function gR(e){var n=go(e);return[n]}function yR(e,n,a){return a==null&&(a=Ce(4)),yo(n,a)}function vR(e){var n=Vr(e),a=e.read_shift(1);return[n,a,"b"]}function bR(e,n,a){return a==null&&(a=Ce(9)),po(n,a),a.write_shift(1,e.v?1:0),a}function NR(e){var n=go(e),a=e.read_shift(1);return[n,a,"b"]}function jR(e,n,a){return a==null&&(a=Ce(5)),yo(n,a),a.write_shift(1,e.v?1:0),a}function wR(e){var n=Vr(e),a=e.read_shift(1);return[n,a,"e"]}function kR(e,n,a){return a==null&&(a=Ce(9)),po(n,a),a.write_shift(1,e.v),a}function TR(e){var n=go(e),a=e.read_shift(1);return[n,a,"e"]}function CR(e,n,a){return a==null&&(a=Ce(8)),yo(n,a),a.write_shift(1,e.v),a.write_shift(2,0),a.write_shift(1,0),a}function SR(e){var n=Vr(e),a=e.read_shift(4);return[n,a,"s"]}function _R(e,n,a){return a==null&&(a=Ce(12)),po(n,a),a.write_shift(4,n.v),a}function ER(e){var n=go(e),a=e.read_shift(4);return[n,a,"s"]}function DR(e,n,a){return a==null&&(a=Ce(8)),yo(n,a),a.write_shift(4,n.v),a}function AR(e){var n=Vr(e),a=wa(e);return[n,a,"n"]}function FR(e,n,a){return a==null&&(a=Ce(16)),po(n,a),oo(e.v,a),a}function iT(e){var n=go(e),a=wa(e);return[n,a,"n"]}function LR(e,n,a){return a==null&&(a=Ce(12)),yo(n,a),oo(e.v,a),a}function PR(e){var n=Vr(e),a=Pg(e);return[n,a,"n"]}function IR(e,n,a){return a==null&&(a=Ce(12)),po(n,a),nk(e.v,a),a}function OR(e){var n=go(e),a=Pg(e);return[n,a,"n"]}function MR(e,n,a){return a==null&&(a=Ce(8)),yo(n,a),nk(e.v,a),a}function RR(e){var n=Vr(e),a=Ag(e);return[n,a,"is"]}function BR(e){var n=Vr(e),a=ka(e);return[n,a,"str"]}function HR(e,n,a){return a==null&&(a=Ce(12+4*e.v.length)),po(n,a),na(e.v,a),a.length>a.l?a.slice(0,a.l):a}function VR(e){var n=go(e),a=ka(e);return[n,a,"str"]}function UR(e,n,a){return a==null&&(a=Ce(8+4*e.v.length)),yo(n,a),na(e.v,a),a.length>a.l?a.slice(0,a.l):a}function KR(e,n,a){var r=e.l+n,s=Vr(e);s.r=a["!row"];var l=e.read_shift(1),o=[s,l,"b"];if(a.cellFormula){e.l+=2;var d=cx(e,r-e.l,a);o[3]=ba(d,null,s,a.supbooks,a)}else e.l=r;return o}function zR(e,n,a){var r=e.l+n,s=Vr(e);s.r=a["!row"];var l=e.read_shift(1),o=[s,l,"e"];if(a.cellFormula){e.l+=2;var d=cx(e,r-e.l,a);o[3]=ba(d,null,s,a.supbooks,a)}else e.l=r;return o}function $R(e,n,a){var r=e.l+n,s=Vr(e);s.r=a["!row"];var l=wa(e),o=[s,l,"n"];if(a.cellFormula){e.l+=2;var d=cx(e,r-e.l,a);o[3]=ba(d,null,s,a.supbooks,a)}else e.l=r;return o}function GR(e,n,a){var r=e.l+n,s=Vr(e);s.r=a["!row"];var l=ka(e),o=[s,l,"str"];if(a.cellFormula){e.l+=2;var d=cx(e,r-e.l,a);o[3]=ba(d,null,s,a.supbooks,a)}else e.l=r;return o}var qR=vo,WR=Mc;function XR(e,n){return n==null&&(n=Ce(4)),n.write_shift(4,e),n}function QR(e,n){var a=e.l+n,r=vo(e),s=Fg(e),l=ka(e),o=ka(e),d=ka(e);e.l=a;var u={rfx:r,relId:s,loc:l,display:d};return o&&(u.Tooltip=o),u}function YR(e,n){var a=Ce(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Mc({s:vn(e[0]),e:vn(e[0])},a),Lg("rId"+n,a);var r=e[1].Target.indexOf("#"),s=r==-1?"":e[1].Target.slice(r+1);return na(s||"",a),na(e[1].Tooltip||"",a),na("",a),a.slice(0,a.l)}function JR(){}function ZR(e,n,a){var r=e.l+n,s=ak(e),l=e.read_shift(1),o=[s];if(o[2]=l,a.cellFormula){var d=w7(e,r-e.l,a);o[1]=d}else e.l=r;return o}function eB(e,n,a){var r=e.l+n,s=vo(e),l=[s];if(a.cellFormula){var o=T7(e,r-e.l,a);l[1]=o,e.l=r}else e.l=r;return l}function tB(e,n,a){a==null&&(a=Ce(18));var r=dx(e,n);a.write_shift(-4,e),a.write_shift(-4,e),a.write_shift(4,(r.width||10)*256),a.write_shift(4,0);var s=0;return n.hidden&&(s|=1),typeof r.width=="number"&&(s|=2),n.level&&(s|=n.level<<8),a.write_shift(2,s),a}var lT=["left","right","top","bottom","header","footer"];function nB(e){var n={};return lT.forEach(function(a){n[a]=wa(e)}),n}function aB(e,n){return n==null&&(n=Ce(48)),to(e),lT.forEach(function(a){oo(e[a],n)}),n}function rB(e){var n=e.read_shift(2);return e.l+=28,{RTL:n&32}}function sB(e,n,a){a==null&&(a=Ce(30));var r=924;return(((n||{}).Views||[])[0]||{}).RTL&&(r|=32),a.write_shift(2,r),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(2,0),a.write_shift(2,100),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(4,0),a}function iB(e){var n=Ce(24);return n.write_shift(4,4),n.write_shift(4,1),Mc(e,n),n}function lB(e,n){return n==null&&(n=Ce(66)),n.write_shift(2,e.password?Hg(e.password):0),n.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(a){a[1]?n.write_shift(4,e[a[0]]!=null&&!e[a[0]]?1:0):n.write_shift(4,e[a[0]]!=null&&e[a[0]]?0:1)}),n}function oB(){}function cB(){}function dB(e,n,a,r,s,l,o){if(!e)return e;var d=n||{};r||(r={"!id":{}});var u=d.dense?[]:{},x,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,p=!1,b,g,y,N,k,T,S,w,_,L=[];d.biff=12,d["!row"]=0;var C=0,P=!1,F=[],H={},O=d.supbooks||s.supbooks||[[]];if(O.sharedf=H,O.arrayf=F,O.SheetNames=s.SheetNames||s.Sheets.map(function(Y){return Y.name}),!d.supbooks&&(d.supbooks=O,s.Names))for(var B=0;B<s.Names.length;++B)O[0][B+1]=s.Names[B];var W=[],ee=[],q=!1;lu[16]={n:"BrtShortReal",f:iT};var fe;if(di(e,function(X,xe,K){if(!p)switch(K){case 148:x=X;break;case 0:b=X,d.sheetRows&&d.sheetRows<=b.r&&(p=!0),w=Dn(N=b.r),d["!row"]=b.r,(X.hidden||X.hpt||X.level!=null)&&(X.hpt&&(X.hpx=_c(X.hpt)),ee[X.r]=X);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:X[2]},X[2]){case"n":g.v=X[1];break;case"s":S=Vd[X[1]],g.v=S.t,g.r=S.r;break;case"b":g.v=!!X[1];break;case"e":g.v=X[1],d.cellText!==!1&&(g.w=ui[g.v]);break;case"str":g.t="s",g.v=X[1];break;case"is":g.t="s",g.v=X[1].t;break}if((y=o.CellXf[X[0].iStyleRef])&&aT(g,y.numFmtId,null,d,l,o),k=X[0].c==-1?k+1:X[0].c,d.dense?(u[N]||(u[N]=[]),u[N][k]=g):u[yn(k)+w]=g,d.cellFormula){for(P=!1,C=0;C<F.length;++C){var A=F[C];b.r>=A[0].s.r&&b.r<=A[0].e.r&&k>=A[0].s.c&&k<=A[0].e.c&&(g.F=pt(A[0]),P=!0)}!P&&X.length>3&&(g.f=X[3])}if(m.s.r>b.r&&(m.s.r=b.r),m.s.c>k&&(m.s.c=k),m.e.r<b.r&&(m.e.r=b.r),m.e.c<k&&(m.e.c=k),d.cellDates&&y&&g.t=="n"&&Pc(ct[y.numFmtId])){var M=Hl(g.v);M&&(g.t="d",g.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}fe&&(fe.type=="XLDAPR"&&(g.D=!0),fe=void 0);break;case 1:case 12:if(!d.sheetStubs||f)break;g={t:"z",v:void 0},k=X[0].c==-1?k+1:X[0].c,d.dense?(u[N]||(u[N]=[]),u[N][k]=g):u[yn(k)+w]=g,m.s.r>b.r&&(m.s.r=b.r),m.s.c>k&&(m.s.c=k),m.e.r<b.r&&(m.e.r=b.r),m.e.c<k&&(m.e.c=k),fe&&(fe.type=="XLDAPR"&&(g.D=!0),fe=void 0);break;case 176:L.push(X);break;case 49:fe=((d.xlmeta||{}).Cell||[])[X-1];break;case 494:var I=r["!id"][X.relId];for(I?(X.Target=I.Target,X.loc&&(X.Target+="#"+X.loc),X.Rel=I):X.relId==""&&(X.Target="#"+X.loc),N=X.rfx.s.r;N<=X.rfx.e.r;++N)for(k=X.rfx.s.c;k<=X.rfx.e.c;++k)d.dense?(u[N]||(u[N]=[]),u[N][k]||(u[N][k]={t:"z",v:void 0}),u[N][k].l=X):(T=dt({c:k,r:N}),u[T]||(u[T]={t:"z",v:void 0}),u[T].l=X);break;case 426:if(!d.cellFormula)break;F.push(X),_=d.dense?u[N][k]:u[yn(k)+w],_.f=ba(X[1],m,{r:b.r,c:k},O,d),_.F=pt(X[0]);break;case 427:if(!d.cellFormula)break;H[dt(X[0].s)]=X[1],_=d.dense?u[N][k]:u[yn(k)+w],_.f=ba(X[1],m,{r:b.r,c:k},O,d);break;case 60:if(!d.cellStyles)break;for(;X.e>=X.s;)W[X.e--]={width:X.w/256,hidden:!!(X.flags&1),level:X.level},q||(q=!0,Vg(X.w/256)),sl(W[X.e+1]);break;case 161:u["!autofilter"]={ref:pt(X)};break;case 476:u["!margins"]=X;break;case 147:s.Sheets[a]||(s.Sheets[a]={}),X.name&&(s.Sheets[a].CodeName=X.name),(X.above||X.left)&&(u["!outline"]={above:X.above,left:X.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),X.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!xe.T){if(!f||d.WTF)throw new Error("Unexpected record 0x"+K.toString(16))}}},d),delete d.supbooks,delete d["!row"],!u["!ref"]&&(m.s.r<2e6||x&&(x.e.r>0||x.e.c>0||x.s.r>0||x.s.c>0))&&(u["!ref"]=pt(x||m)),d.sheetRows&&u["!ref"]){var ne=Ft(u["!ref"]);d.sheetRows<=+ne.e.r&&(ne.e.r=d.sheetRows-1,ne.e.r>m.e.r&&(ne.e.r=m.e.r),ne.e.r<ne.s.r&&(ne.s.r=ne.e.r),ne.e.c>m.e.c&&(ne.e.c=m.e.c),ne.e.c<ne.s.c&&(ne.s.c=ne.e.c),u["!fullref"]=u["!ref"],u["!ref"]=pt(ne))}return L.length>0&&(u["!merges"]=L),W.length>0&&(u["!cols"]=W),ee.length>0&&(u["!rows"]=ee),u}function uB(e,n,a,r,s,l,o){if(n.v===void 0)return!1;var d="";switch(n.t){case"b":d=n.v?"1":"0";break;case"d":n=hn(n),n.z=n.z||ct[14],n.v=Gn(un(n.v)),n.t="n";break;case"n":case"e":d=""+n.v;break;default:d=n.v;break}var u={r:a,c:r};switch(u.s=xl(s.cellXfs,n,s),n.l&&l["!links"].push([dt(u),n.l]),n.c&&l["!comments"].push([dt(u),n.c]),n.t){case"s":case"str":return s.bookSST?(d=Gg(s.Strings,n.v,s.revStrings),u.t="s",u.v=d,o?Ee(e,18,DR(n,u)):Ee(e,7,_R(n,u))):(u.t="str",o?Ee(e,17,UR(n,u)):Ee(e,6,HR(n,u))),!0;case"n":return n.v==(n.v|0)&&n.v>-1e3&&n.v<1e3?o?Ee(e,13,MR(n,u)):Ee(e,2,IR(n,u)):o?Ee(e,16,LR(n,u)):Ee(e,5,FR(n,u)),!0;case"b":return u.t="b",o?Ee(e,15,jR(n,u)):Ee(e,4,bR(n,u)),!0;case"e":return u.t="e",o?Ee(e,14,CR(n,u)):Ee(e,3,kR(n,u)),!0}return o?Ee(e,12,yR(n,u)):Ee(e,1,pR(n,u)),!0}function hB(e,n,a,r){var s=Ft(n["!ref"]||"A1"),l,o="",d=[];Ee(e,145);var u=Array.isArray(n),x=s.e.r;n["!rows"]&&(x=Math.max(s.e.r,n["!rows"].length-1));for(var m=s.s.r;m<=x;++m){o=Dn(m),cR(e,n,s,m);var f=!1;if(m<=s.e.r)for(var p=s.s.c;p<=s.e.c;++p){m===s.s.r&&(d[p]=yn(p)),l=d[p]+o;var b=u?(n[m]||[])[p]:n[l];if(!b){f=!1;continue}f=uB(e,b,m,p,r,n,f)}}Ee(e,146)}function xB(e,n){!n||!n["!merges"]||(Ee(e,177,XR(n["!merges"].length)),n["!merges"].forEach(function(a){Ee(e,176,WR(a))}),Ee(e,178))}function mB(e,n){!n||!n["!cols"]||(Ee(e,390),n["!cols"].forEach(function(a,r){a&&Ee(e,60,tB(r,a))}),Ee(e,391))}function fB(e,n){!n||!n["!ref"]||(Ee(e,648),Ee(e,649,iB(Ft(n["!ref"]))),Ee(e,650))}function pB(e,n,a){n["!links"].forEach(function(r){if(r[1].Target){var s=Gt(a,-1,r[1].Target.replace(/#.*$/,""),jt.HLINK);Ee(e,494,YR(r,s))}}),delete n["!links"]}function gB(e,n,a,r){if(n["!comments"].length>0){var s=Gt(r,-1,"../drawings/vmlDrawing"+(a+1)+".vml",jt.VML);Ee(e,551,Lg("rId"+s)),n["!legacy"]=s}}function yB(e,n,a,r){if(n["!autofilter"]){var s=n["!autofilter"],l=typeof s.ref=="string"?s.ref:pt(s.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var o=a.Workbook.Names,d=nr(l);d.s.r==d.e.r&&(d.e.r=nr(n["!ref"]).e.r,l=pt(d));for(var u=0;u<o.length;++u){var x=o[u];if(x.Name=="_xlnm._FilterDatabase"&&x.Sheet==r){x.Ref="'"+a.SheetNames[r]+"'!"+l;break}}u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+a.SheetNames[r]+"'!"+l}),Ee(e,161,Mc(Ft(l))),Ee(e,162)}}function vB(e,n,a){Ee(e,133),Ee(e,137,sB(n,a)),Ee(e,138),Ee(e,134)}function bB(e,n){n["!protect"]&&Ee(e,535,lB(n["!protect"]))}function NB(e,n,a,r){var s=tr(),l=a.SheetNames[e],o=a.Sheets[l]||{},d=l;try{a&&a.Workbook&&(d=a.Workbook.Sheets[e].CodeName||d)}catch{}var u=Ft(o["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(n.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Ee(s,129),(a.vbaraw||o["!outline"])&&Ee(s,147,mR(d,o["!outline"])),Ee(s,148,uR(u)),vB(s,o,a.Workbook),mB(s,o),hB(s,o,e,n),bB(s,o),yB(s,o,a,e),xB(s,o),pB(s,o,r),o["!margins"]&&Ee(s,476,aB(o["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&fB(s,o),gB(s,o,e,r),Ee(s,130),s.end()}function jB(e){var n=[],a=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var o=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(n[+o[1]]=a?+o[2]:o[2])});var s=Dt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){r=l.replace(/<.*?>/g,"")}),[n,s,r]}function wB(e,n,a,r,s,l){var o=l||{"!type":"chart"};if(!e)return l;var d=0,u=0,x="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var p=jB(f);m.s.r=m.s.c=0,m.e.c=d,x=yn(d),p[0].forEach(function(b,g){o[x+Dn(g)]={t:"n",v:b,z:p[1]},u=g}),m.e.r<u&&(m.e.r=u),++d}),d>0&&(o["!ref"]=pt(m)),o}function kB(e,n,a,r,s){if(!e)return e;r||(r={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o,d=e.match(rT);return d&&qg(d[0],l,s,a),(o=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=o[1]),r["!id"][l["!rel"]]&&(l["!drawel"]=r["!id"][l["!rel"]]),l}function TB(e,n){e.l+=10;var a=ka(e);return{name:a}}function CB(e,n,a,r,s){if(!e)return e;r||(r={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o=!1;return di(e,function(u,x,m){switch(m){case 550:l["!rel"]=u;break;case 651:s.Sheets[a]||(s.Sheets[a]={}),u.name&&(s.Sheets[a].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(x.T>0)){if(!(x.T<0)){if(!o||n.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},n),r["!id"][l["!rel"]]&&(l["!drawel"]=r["!id"][l["!rel"]]),l}var Wg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],SB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],_B=[],EB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function t2(e,n){for(var a=0;a!=e.length;++a)for(var r=e[a],s=0;s!=n.length;++s){var l=n[s];if(r[l[0]]==null)r[l[0]]=l[1];else switch(l[2]){case"bool":typeof r[l[0]]=="string"&&(r[l[0]]=on(r[l[0]]));break;case"int":typeof r[l[0]]=="string"&&(r[l[0]]=parseInt(r[l[0]],10));break}}}function n2(e,n){for(var a=0;a!=n.length;++a){var r=n[a];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=on(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function oT(e){n2(e.WBProps,Wg),n2(e.CalcPr,EB),t2(e.WBView,SB),t2(e.Sheets,_B),oc.date1904=on(e.WBProps.date1904)}function DB(e){return!e.Workbook||!e.Workbook.WBProps?"false":on(e.Workbook.WBProps.date1904)?"true":"false"}var AB="][*?/\\".split("");function cT(e,n){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var a=!0;return AB.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),a}function FB(e,n,a){e.forEach(function(r,s){cT(r);for(var l=0;l<s;++l)if(r==e[l])throw new Error("Duplicate Sheet Name: "+r);if(a){var o=n&&n[s]&&n[s].CodeName||r;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function LB(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var n=e.Workbook&&e.Workbook.Sheets||[];FB(e.SheetNames,n,!!e.vbaraw);for(var a=0;a<e.SheetNames.length;++a)D7(e.Sheets[e.SheetNames[a]],e.SheetNames[a],a)}var PB=/<\w+:workbook/;function IB(e,n){if(!e)throw new Error("Could not find file");var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,s="xmlns",l={},o=0;if(e.replace(Ca,function(u,x){var m=ut(u);switch(Es(m[0])){case"<?xml":break;case"<workbook":u.match(PB)&&(s="xmlns"+u.match(/<(\w+):/)[1]),a.xmlns=m[s];break;case"</workbook>":break;case"<fileVersion":delete m[0],a.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Wg.forEach(function(f){if(m[f[0]]!=null)switch(f[2]){case"bool":a.WBProps[f[0]]=on(m[f[0]]);break;case"int":a.WBProps[f[0]]=parseInt(m[f[0]],10);break;default:a.WBProps[f[0]]=m[f[0]]}}),m.codeName&&(a.WBProps.CodeName=Qt(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],a.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=Dt(Qt(m.name)),delete m[0],a.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":l={},l.Name=Qt(m.name),m.comment&&(l.Comment=m.comment),m.localSheetId&&(l.Sheet=+m.localSheetId),on(m.hidden||"0")&&(l.Hidden=!0),o=x+u.length;break;case"</definedName>":l.Ref=Dt(Qt(e.slice(o,x))),a.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete m[0],a.CalcPr=m;break;case"<calcPr/>":delete m[0],a.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&n.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return u}),fo.indexOf(a.xmlns)===-1)throw new Error("Unknown Namespace: "+a.xmlns);return oT(a),a}function dT(e){var n=[An];n[n.length]=Ue("workbook",null,{xmlns:fo[0],"xmlns:r":zn.r});var a=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Wg.forEach(function(d){e.Workbook.WBProps[d[0]]!=null&&e.Workbook.WBProps[d[0]]!=d[1]&&(r[d[0]]=e.Workbook.WBProps[d[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),n[n.length]=Ue("workbookPr",null,r);var s=e.Workbook&&e.Workbook.Sheets||[],l=0;if(s&&s[0]&&s[0].Hidden){for(n[n.length]="<bookViews>",l=0;l!=e.SheetNames.length&&!(!s[l]||!s[l].Hidden);++l);l==e.SheetNames.length&&(l=0),n[n.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',n[n.length]="</bookViews>"}for(n[n.length]="<sheets>",l=0;l!=e.SheetNames.length;++l){var o={name:qt(e.SheetNames[l].slice(0,31))};if(o.sheetId=""+(l+1),o["r:id"]="rId"+(l+1),s[l])switch(s[l].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}n[n.length]=Ue("sheet",null,o)}return n[n.length]="</sheets>",a&&(n[n.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(d){var u={name:d.Name};d.Comment&&(u.comment=d.Comment),d.Sheet!=null&&(u.localSheetId=""+d.Sheet),d.Hidden&&(u.hidden="1"),d.Ref&&(n[n.length]=Ue("definedName",qt(d.Ref),u))}),n[n.length]="</definedNames>"),n.length>2&&(n[n.length]="</workbook>",n[1]=n[1].replace("/>",">")),n.join("")}function OB(e,n){var a={};return a.Hidden=e.read_shift(4),a.iTabID=e.read_shift(4),a.strRelID=wp(e),a.name=ka(e),a}function MB(e,n){return n||(n=Ce(127)),n.write_shift(4,e.Hidden),n.write_shift(4,e.iTabID),Lg(e.strRelID,n),na(e.name.slice(0,31),n),n.length>n.l?n.slice(0,n.l):n}function RB(e,n){var a={},r=e.read_shift(4);a.defaultThemeVersion=e.read_shift(4);var s=n>8?ka(e):"";return s.length>0&&(a.CodeName=s),a.autoCompressPictures=!!(r&65536),a.backupFile=!!(r&64),a.checkCompatibility=!!(r&4096),a.date1904=!!(r&1),a.filterPrivacy=!!(r&8),a.hidePivotFieldList=!!(r&1024),a.promptedSolutions=!!(r&16),a.publishItems=!!(r&2048),a.refreshAllConnections=!!(r&262144),a.saveExternalLinkValues=!!(r&128),a.showBorderUnselectedTables=!!(r&4),a.showInkAnnotation=!!(r&32),a.showObjects=["all","placeholders","none"][r>>13&3],a.showPivotChartFilter=!!(r&32768),a.updateLinks=["userSet","never","always"][r>>8&3],a}function BB(e,n){n||(n=Ce(72));var a=0;return e&&e.filterPrivacy&&(a|=8),n.write_shift(4,a),n.write_shift(4,0),tk(e&&e.CodeName||"ThisWorkbook",n),n.slice(0,n.l)}function HB(e,n){var a={};return e.read_shift(4),a.ArchID=e.read_shift(4),e.l+=n-8,a}function VB(e,n,a){var r=e.l+n;e.l+=4,e.l+=1;var s=e.read_shift(4),l=g8(e),o=k7(e,0,a),d=Fg(e);e.l=r;var u={Name:l,Ptg:o};return s<268435455&&(u.Sheet=s),d&&(u.Comment=d),u}function UB(e,n){var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],s=!1;n||(n={}),n.biff=12;var l=[],o=[[]];return o.SheetNames=[],o.XTI=[],lu[16]={n:"BrtFRTArchID$",f:HB},di(e,function(u,x,m){switch(m){case 156:o.SheetNames.push(u.name),a.Sheets.push(u);break;case 153:a.WBProps=u;break;case 39:u.Sheet!=null&&(n.SID=u.Sheet),u.Ref=ba(u.Ptg,null,null,o,n),delete n.SID,delete u.Ptg,l.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([m,u]):o[0]=[m,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(m),s=!0;break;case 36:r.pop(),s=!1;break;case 37:r.push(m),s=!0;break;case 38:r.pop(),s=!1;break;case 16:break;default:if(!x.T){if(!s||n.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},n),oT(a),a.Names=l,a.supbooks=o,a}function KB(e,n){Ee(e,143);for(var a=0;a!=n.SheetNames.length;++a){var r=n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[a]&&n.Workbook.Sheets[a].Hidden||0,s={Hidden:r,iTabID:a+1,strRelID:"rId"+(a+1),name:n.SheetNames[a]};Ee(e,156,MB(s))}Ee(e,144)}function zB(e,n){n||(n=Ce(127));for(var a=0;a!=4;++a)n.write_shift(4,0);return na("SheetJS",n),na(T0.version,n),na(T0.version,n),na("7262",n),n.length>n.l?n.slice(0,n.l):n}function $B(e,n){n||(n=Ce(29)),n.write_shift(-4,0),n.write_shift(-4,460),n.write_shift(4,28800),n.write_shift(4,17600),n.write_shift(4,500),n.write_shift(4,e),n.write_shift(4,e);var a=120;return n.write_shift(1,a),n.length>n.l?n.slice(0,n.l):n}function GB(e,n){if(!(!n.Workbook||!n.Workbook.Sheets)){for(var a=n.Workbook.Sheets,r=0,s=-1,l=-1;r<a.length;++r)!a[r]||!a[r].Hidden&&s==-1?s=r:a[r].Hidden==1&&l==-1&&(l=r);l>s||(Ee(e,135),Ee(e,158,$B(s)),Ee(e,136))}}function qB(e,n){var a=tr();return Ee(a,131),Ee(a,128,zB()),Ee(a,153,BB(e.Workbook&&e.Workbook.WBProps||null)),GB(a,e),KB(a,e),Ee(a,132),a.end()}function WB(e,n,a){return n.slice(-4)===".bin"?UB(e,a):IB(e,a)}function XB(e,n,a,r,s,l,o,d){return n.slice(-4)===".bin"?dB(e,r,a,s,l,o,d):V7(e,r,a,s,l,o,d)}function QB(e,n,a,r,s,l,o,d){return n.slice(-4)===".bin"?CB(e,r,a,s,l):kB(e,r,a,s,l)}function YB(e,n,a,r,s,l,o,d){return n.slice(-4)===".bin"?ZO():eM()}function JB(e,n,a,r,s,l,o,d){return n.slice(-4)===".bin"?YO():JO()}function ZB(e,n,a,r){return n.slice(-4)===".bin"?WI(e,a,r):OI(e,a,r)}function e9(e,n,a){return zk(e,a)}function t9(e,n,a){return n.slice(-4)===".bin"?tI(e,a):JP(e,a)}function n9(e,n,a){return n.slice(-4)===".bin"?GO(e,a):MO(e,a)}function a9(e,n,a){return n.slice(-4)===".bin"?PO(e):FO(e)}function r9(e,n,a,r){return a.slice(-4)===".bin"?IO(e,n,a,r):void 0}function s9(e,n,a){return n.slice(-4)===".bin"?EO(e,n,a):AO(e,n,a)}function i9(e,n,a){return(n.slice(-4)===".bin"?qB:dT)(e)}function l9(e,n,a,r,s){return(n.slice(-4)===".bin"?NB:sT)(e,a,r,s)}function o9(e,n,a){return(n.slice(-4)===".bin"?rO:Uk)(e,a)}function c9(e,n,a){return(n.slice(-4)===".bin"?rI:Pk)(e,a)}function d9(e,n,a){return(n.slice(-4)===".bin"?qO:qk)(e)}function u9(e){return(e.slice(-4)===".bin"?DO:$k)()}var uT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,hT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Wr(e,n){var a=e.split(/\s+/),r=[];if(r[0]=a[0],a.length===1)return r;var s=e.match(uT),l,o,d,u;if(s)for(u=0;u!=s.length;++u)l=s[u].match(hT),(o=l[1].indexOf(":"))===-1?r[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?d="xmlns"+l[1].slice(6):d=l[1].slice(o+1),r[d]=l[2].slice(1,l[2].length-1));return r}function h9(e){var n=e.split(/\s+/),a={};if(n.length===1)return a;var r=e.match(uT),s,l,o,d;if(r)for(d=0;d!=r.length;++d)s=r[d].match(hT),(l=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(l+1),a[o]=s[2].slice(1,s[2].length-1));return a}var Kd;function x9(e,n){var a=Kd[e]||Dt(e);return a==="General"?io(n):Br(a,n)}function m9(e,n,a,r){var s=r;switch((a[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=on(r);break;case"i2":case"int":s=parseInt(r,10);break;case"r4":case"float":s=parseFloat(r);break;case"date":case"dateTime.tz":s=un(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+a[0])}e[Dt(n)]=s}function f9(e,n,a){if(e.t!=="z"){if(!a||a.cellText!==!1)try{e.t==="e"?e.w=e.w||ui[e.v]:n==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Jd(e.v):e.w=io(e.v):e.w=x9(n||"General",e.v)}catch(l){if(a.WTF)throw l}try{var r=Kd[n]||n||"General";if(a.cellNF&&(e.z=r),a.cellDates&&e.t=="n"&&Pc(r)){var s=Hl(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(l){if(a.WTF)throw l}}}function p9(e,n,a){if(a.cellStyles&&n.Interior){var r=n.Interior;r.Pattern&&(r.patternType=_I[r.Pattern]||r.Pattern)}e[n.ID]=n}function g9(e,n,a,r,s,l,o,d,u,x){var m="General",f=r.StyleID,p={};x=x||{};var b=[],g=0;for(f===void 0&&d&&(f=d.StyleID),f===void 0&&o&&(f=o.StyleID);l[f]!==void 0&&(l[f].nf&&(m=l[f].nf),l[f].Interior&&b.push(l[f].Interior),!!l[f].Parent);)f=l[f].Parent;switch(a.Type){case"Boolean":r.t="b",r.v=on(e);break;case"String":r.t="s",r.r=vN(Dt(e)),r.v=e.indexOf("<")>-1?Dt(n||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(un(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),r.v!==r.v?r.v=Dt(e):r.v<60&&(r.v=r.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=ik[e],x.cellText!==!1&&(r.w=e);break;default:e==""&&n==""?r.t="z":(r.t="s",r.v=vN(n||e));break}if(f9(r,m,x),x.cellFormula!==!1)if(r.Formula){var y=Dt(r.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),r.f=lc(y,s),delete r.Formula,r.ArrayRange=="RC"?r.F=lc("RC:RC",s):r.ArrayRange&&(r.F=lc(r.ArrayRange,s),u.push([Ft(r.F),r.F]))}else for(g=0;g<u.length;++g)s.r>=u[g][0].s.r&&s.r<=u[g][0].e.r&&s.c>=u[g][0].s.c&&s.c<=u[g][0].e.c&&(r.F=u[g][1]);x.cellStyles&&(b.forEach(function(N){!p.patternType&&N.patternType&&(p.patternType=N.patternType)}),r.s=p),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function y9(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Df(e,n){var a=n||{};Ic();var r=Ad(Cg(e));(a.type=="binary"||a.type=="array"||a.type=="base64")&&(r=Qt(r));var s=r.slice(0,1024).toLowerCase(),l=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=hn(a);return o.type="string",Sc.to_workbook(r,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ot){s.indexOf("<"+Ot)>=0&&(l=!0)}),l)return aH(r,a);Kd={"General Number":"General","General Date":ct[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ct[15],"Short Date":ct[14],"Long Time":ct[19],"Medium Time":ct[18],"Short Time":ct[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ct[2],Standard:ct[4],Percent:ct[10],Scientific:ct[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var d,u=[],x,m={},f=[],p=a.dense?[]:{},b="",g={},y={},N=Wr('<Data ss:Type="String">'),k=0,T=0,S=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},_={},L={},C="",P=0,F=[],H={},O={},B=0,W=[],ee=[],q={},fe=[],ne,Y=!1,X=[],xe=[],K={},A=0,M=0,I={Sheets:[],WBProps:{date1904:!1}},V={};tu.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";d=tu.exec(r);)switch(d[3]=(J=d[3]).toLowerCase()){case"data":if(J=="data"){if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&u.push([d[3],!0]);break}if(u[u.length-1][1])break;d[1]==="/"?g9(r.slice(k,d.index),C,N,u[u.length-1][0]=="comment"?q:g,{c:T,r:S},_,fe[T],y,X,a):(C="",N=Wr(d[0]),k=d.index+d[0].length);break;case"cell":if(d[1]==="/")if(ee.length>0&&(g.c=ee),(!a.sheetRows||a.sheetRows>S)&&g.v!==void 0&&(a.dense?(p[S]||(p[S]=[]),p[S][T]=g):p[yn(T)+Dn(S)]=g),g.HRef&&(g.l={Target:Dt(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(A=T+(parseInt(g.MergeAcross,10)|0),M=S+(parseInt(g.MergeDown,10)|0),F.push({s:{c:T,r:S},e:{c:A,r:M}})),!a.sheetStubs)g.MergeAcross?T=A+1:++T;else if(g.MergeAcross||g.MergeDown){for(var ge=T;ge<=A;++ge)for(var z=S;z<=M;++z)(ge>T||z>S)&&(a.dense?(p[z]||(p[z]=[]),p[z][ge]={t:"z"}):p[yn(ge)+Dn(z)]={t:"z"});T=A+1}else++T;else g=h9(d[0]),g.Index&&(T=+g.Index-1),T<w.s.c&&(w.s.c=T),T>w.e.c&&(w.e.c=T),d[0].slice(-2)==="/>"&&++T,ee=[];break;case"row":d[1]==="/"||d[0].slice(-2)==="/>"?(S<w.s.r&&(w.s.r=S),S>w.e.r&&(w.e.r=S),d[0].slice(-2)==="/>"&&(y=Wr(d[0]),y.Index&&(S=+y.Index-1)),T=0,++S):(y=Wr(d[0]),y.Index&&(S=+y.Index-1),K={},(y.AutoFitHeight=="0"||y.Height)&&(K.hpx=parseInt(y.Height,10),K.hpt=iu(K.hpx),xe[S]=K),y.Hidden=="1"&&(K.hidden=!0,xe[S]=K));break;case"worksheet":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"));f.push(b),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(p["!ref"]=pt(w),a.sheetRows&&a.sheetRows<=w.e.r&&(p["!fullref"]=p["!ref"],w.e.r=a.sheetRows-1,p["!ref"]=pt(w))),F.length&&(p["!merges"]=F),fe.length>0&&(p["!cols"]=fe),xe.length>0&&(p["!rows"]=xe),m[b]=p}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=T=0,u.push([d[3],!1]),x=Wr(d[0]),b=Dt(x.Name),p=a.dense?[]:{},F=[],X=[],xe=[],V={name:b,Hidden:0},I.Sheets.push(V);break;case"table":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else{if(d[0].slice(-2)=="/>")break;u.push([d[3],!1]),fe=[],Y=!1}break;case"style":d[1]==="/"?p9(_,L,a):L=Wr(d[0]);break;case"numberformat":L.nf=Dt(Wr(d[0]).Format||"General"),Kd[L.nf]&&(L.nf=Kd[L.nf]);for(var le=0;le!=392&&ct[le]!=L.nf;++le);if(le==392){for(le=57;le!=392;++le)if(ct[le]==null){ni(L.nf,le);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(ne=Wr(d[0]),ne.Hidden&&(ne.hidden=!0,delete ne.Hidden),ne.Width&&(ne.wpx=parseInt(ne.Width,10)),!Y&&ne.wpx>10){Y=!0,Na=Hk;for(var ue=0;ue<fe.length;++ue)fe[ue]&&sl(fe[ue])}Y&&sl(ne),fe[ne.Index-1||fe.length]=ne;for(var ce=0;ce<+ne.Span;++ce)fe[fe.length]=hn(ne);break;case"namedrange":if(d[1]==="/")break;I.Names||(I.Names=[]);var R=ut(d[0]),pe={Name:R.Name,Ref:lc(R.RefersTo.slice(1),{r:0,c:0})};I.Sheets.length>0&&(pe.Sheet=I.Sheets.length-1),I.Names.push(pe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(d[0].slice(-2)==="/>")break;d[1]==="/"?C+=r.slice(P,d.index):P=d.index+d[0].length;break;case"interior":if(!a.cellStyles)break;L.Interior=Wr(d[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(d[0].slice(-2)==="/>")break;d[1]==="/"?U8(H,J,r.slice(B,d.index)):B=d.index+d[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else u.push([d[3],!1]);break;case"comment":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"));y9(q),ee.push(q)}else u.push([d[3],!1]),x=Wr(d[0]),q={a:x.Author};break;case"autofilter":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else if(d[0].charAt(d[0].length-2)!=="/"){var Oe=Wr(d[0]);p["!autofilter"]={ref:lc(Oe.Range).replace(/\$/g,"")},u.push([d[3],!0])}break;case"name":break;case"datavalidation":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&u.push([d[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(d[1]==="/"){if((x=u.pop())[0]!==d[3])throw new Error("Bad state: "+x.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&u.push([d[3],!0]);break;case"null":break;default:if(u.length==0&&d[3]=="document"||u.length==0&&d[3]=="uof")return l2(r,a);var tt=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(d[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:tt=!1}break;case"componentoptions":switch(d[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:tt=!1}break;case"excelworkbook":switch(d[3]){case"date1904":I.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:tt=!1}break;case"workbookoptions":switch(d[3]){case"owcversion":break;case"height":break;case"width":break;default:tt=!1}break;case"worksheetoptions":switch(d[3]){case"visible":if(d[0].slice(-2)!=="/>")if(d[1]==="/")switch(r.slice(B,d.index)){case"SheetHidden":V.Hidden=1;break;case"SheetVeryHidden":V.Hidden=2;break}else B=d.index+d[0].length;break;case"header":p["!margins"]||to(p["!margins"]={},"xlml"),isNaN(+ut(d[0]).Margin)||(p["!margins"].header=+ut(d[0]).Margin);break;case"footer":p["!margins"]||to(p["!margins"]={},"xlml"),isNaN(+ut(d[0]).Margin)||(p["!margins"].footer=+ut(d[0]).Margin);break;case"pagemargins":var Ye=ut(d[0]);p["!margins"]||to(p["!margins"]={},"xlml"),isNaN(+Ye.Top)||(p["!margins"].top=+Ye.Top),isNaN(+Ye.Left)||(p["!margins"].left=+Ye.Left),isNaN(+Ye.Right)||(p["!margins"].right=+Ye.Right),isNaN(+Ye.Bottom)||(p["!margins"].bottom=+Ye.Bottom);break;case"displayrighttoleft":I.Views||(I.Views=[]),I.Views[0]||(I.Views[0]={}),I.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:tt=!1}break;case"pivottable":case"pivotcache":switch(d[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:tt=!1}break;case"pagebreaks":switch(d[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:tt=!1}break;case"autofilter":switch(d[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:tt=!1}break;case"querytable":switch(d[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:tt=!1}break;case"datavalidation":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:tt=!1}break;case"sorting":case"conditionalformatting":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:tt=!1}break;case"mapinfo":case"schema":case"data":switch(d[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:tt=!1}break;case"smarttags":break;default:tt=!1;break}if(tt||d[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+d[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(d[0].slice(-2)==="/>")break;d[1]==="/"?m9(O,J,W,r.slice(B,d.index)):(W=d,B=d.index+d[0].length);break}if(a.WTF)throw"Unrecognized tag: "+d[3]+"|"+u.join("|")}var Re={};return!a.bookSheets&&!a.bookProps&&(Re.Sheets=m),Re.SheetNames=f,Re.Workbook=I,Re.SSF=hn(ct),Re.Props=H,Re.Custprops=O,Re}function Dp(e,n){switch(Yg(n=n||{}),n.type||"base64"){case"base64":return Df(xr(e),n);case"binary":case"buffer":case"file":return Df(e,n);case"array":return Df(ul(e),n)}}function v9(e,n){var a=[];return e.Props&&a.push(K8(e.Props,n)),e.Custprops&&a.push(z8(e.Props,e.Custprops)),a.join("")}function b9(){return""}function N9(e,n){var a=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return n.cellXfs.forEach(function(r,s){var l=[];l.push(Ue("NumberFormat",null,{"ss:Format":qt(ct[r.numFmtId])}));var o={"ss:ID":"s"+(21+s)};a.push(Ue("Style",l.join(""),o))}),Ue("Styles",a.join(""))}function xT(e){return Ue("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+zg(e.Ref,{r:0,c:0})})}function j9(e){if(!((e||{}).Workbook||{}).Names)return"";for(var n=e.Workbook.Names,a=[],r=0;r<n.length;++r){var s=n[r];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||a.push(xT(s)))}return Ue("Names",a.join(""))}function w9(e,n,a,r){if(!e||!((r||{}).Workbook||{}).Names)return"";for(var s=r.Workbook.Names,l=[],o=0;o<s.length;++o){var d=s[o];d.Sheet==a&&(d.Name.match(/^_xlfn\./)||l.push(xT(d)))}return l.join("")}function k9(e,n,a,r){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Ue("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Ue("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Ue("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[a])if(r.Workbook.Sheets[a].Hidden)s.push(Ue("Visible",r.Workbook.Sheets[a].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<a&&!(r.Workbook.Sheets[l]&&!r.Workbook.Sheets[l].Hidden);++l);l==a&&s.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(da("ProtectContents","True")),e["!protect"].objects&&s.push(da("ProtectObjects","True")),e["!protect"].scenarios&&s.push(da("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(da("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(da("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Ue("WorksheetOptions",s.join(""),{xmlns:or.x})}function T9(e){return e.map(function(n){var a=GF(n.t||""),r=Ue("ss:Data",a,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ue("Comment",r,{"ss:Author":n.a})}).join("")}function C9(e,n,a,r,s,l,o){if(!e||e.v==null&&e.f==null)return"";var d={};if(e.f&&(d["ss:Formula"]="="+qt(zg(e.f,o))),e.F&&e.F.slice(0,n.length)==n){var u=vn(e.F.slice(n.length+1));d["ss:ArrayRange"]="RC:R"+(u.r==o.r?"":"["+(u.r-o.r)+"]")+"C"+(u.c==o.c?"":"["+(u.c-o.c)+"]")}if(e.l&&e.l.Target&&(d["ss:HRef"]=qt(e.l.Target),e.l.Tooltip&&(d["x:HRefScreenTip"]=qt(e.l.Tooltip))),a["!merges"])for(var x=a["!merges"],m=0;m!=x.length;++m)x[m].s.c!=o.c||x[m].s.r!=o.r||(x[m].e.c>x[m].s.c&&(d["ss:MergeAcross"]=x[m].e.c-x[m].s.c),x[m].e.r>x[m].s.r&&(d["ss:MergeDown"]=x[m].e.r-x[m].s.r));var f="",p="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":f="Number",p=String(e.v);break;case"b":f="Boolean",p=e.v?"1":"0";break;case"e":f="Error",p=ui[e.v];break;case"d":f="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ct[14]);break;case"s":f="String",p=$F(e.v||"");break}var b=xl(r.cellXfs,e,r);d["ss:StyleID"]="s"+(21+b),d["ss:Index"]=o.c+1;var g=e.v!=null?p:"",y=e.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(e.c||[]).length>0&&(y+=T9(e.c)),Ue("Cell",y,d)}function S9(e,n){var a='<Row ss:Index="'+(e+1)+'"';return n&&(n.hpt&&!n.hpx&&(n.hpx=_c(n.hpt)),n.hpx&&(a+=' ss:AutoFitHeight="0" ss:Height="'+n.hpx+'"'),n.hidden&&(a+=' ss:Hidden="1"')),a+">"}function _9(e,n,a,r){if(!e["!ref"])return"";var s=Ft(e["!ref"]),l=e["!merges"]||[],o=0,d=[];e["!cols"]&&e["!cols"].forEach(function(N,k){sl(N);var T=!!N.width,S=dx(k,N),w={"ss:Index":k+1};T&&(w["ss:Width"]=ru(S.width)),N.hidden&&(w["ss:Hidden"]="1"),d.push(Ue("Column",null,w))});for(var u=Array.isArray(e),x=s.s.r;x<=s.e.r;++x){for(var m=[S9(x,(e["!rows"]||[])[x])],f=s.s.c;f<=s.e.c;++f){var p=!1;for(o=0;o!=l.length;++o)if(!(l[o].s.c>f)&&!(l[o].s.r>x)&&!(l[o].e.c<f)&&!(l[o].e.r<x)){(l[o].s.c!=f||l[o].s.r!=x)&&(p=!0);break}if(!p){var b={r:x,c:f},g=dt(b),y=u?(e[x]||[])[f]:e[g];m.push(C9(y,g,e,n,a,r,b))}}m.push("</Row>"),m.length>2&&d.push(m.join(""))}return d.join("")}function E9(e,n,a){var r=[],s=a.SheetNames[e],l=a.Sheets[s],o=l?w9(l,n,e,a):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=l?_9(l,n,e,a):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(k9(l,n,e,a)),r.join("")}function D9(e,n){n||(n={}),e.SSF||(e.SSF=hn(ct)),e.SSF&&(Ic(),ax(e.SSF),n.revssf=sx(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF,n.cellXfs=[],xl(n.cellXfs,{},{revssf:{General:0}}));var a=[];a.push(v9(e,n)),a.push(b9()),a.push(""),a.push("");for(var r=0;r<e.SheetNames.length;++r)a.push(Ue("Worksheet",E9(r,n,e),{"ss:Name":qt(e.SheetNames[r])}));return a[2]=N9(e,n),a[3]=j9(e),An+Ue("Workbook",a.join(""),{xmlns:or.ss,"xmlns:o":or.o,"xmlns:x":or.x,"xmlns:ss":or.ss,"xmlns:dt":or.dt,"xmlns:html":or.html})}function A9(e){var n={},a=e.content;if(a.l=28,n.AnsiUserType=a.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=j8(a),a.length-a.l<=4)return n;var r=a.read_shift(4);if(r==0||r>40||(a.l-=4,n.Reserved1=a.read_shift(0,"lpstr-ansi"),a.length-a.l<=4)||(r=a.read_shift(4),r!==1907505652)||(n.UnicodeClipboardFormat=w8(a),r=a.read_shift(4),r==0||r>40))return n;a.l-=4,n.Reserved2=a.read_shift(0,"lpwstr")}var F9=[60,1084,2066,2165,2175];function L9(e,n,a,r,s){var l=r,o=[],d=a.slice(a.l,a.l+l);if(s&&s.enc&&s.enc.insitu&&d.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(d)}o.push(d),a.l+=l;for(var u=Qs(a,a.l),x=Ap[u],m=0;x!=null&&F9.indexOf(u)>-1;)l=Qs(a,a.l+2),m=a.l+4,u==2066?m+=4:(u==2165||u==2175)&&(m+=12),d=a.slice(m,a.l+4+l),o.push(d),a.l+=4+l,x=Ap[u=Qs(a,a.l)];var f=ta(o);oa(f,0);var p=0;f.lens=[];for(var b=0;b<o.length;++b)f.lens.push(p),p+=o[b].length;if(f.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+r;return n.f(f,f.length,s)}function hs(e,n,a){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,n.cellNF&&(e.z=ct[r])}catch(l){if(n.WTF)throw l}if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||ui[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Jd(e.v):e.w=io(e.v):e.w=Br(r,e.v,{date1904:!!a,dateNF:n&&n.dateNF})}catch(l){if(n.WTF)throw l}if(n.cellDates&&r&&e.t=="n"&&Pc(ct[r]||String(r))){var s=Hl(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function n0(e,n,a){return{v:e,ixfe:n,t:a}}function P9(e,n){var a={opts:{}},r={},s=n.dense?[]:{},l={},o={},d=null,u=[],x="",m={},f,p="",b,g,y,N,k={},T=[],S,w,_=[],L=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},F=function(ot){return ot<8?Jl[ot]:ot<64&&L[ot-8]||Jl[ot]},H=function(ot,Mt,qn){var en=Mt.XF.data;if(!(!en||!en.patternType||!qn||!qn.cellStyles)){Mt.s={},Mt.s.patternType=en.patternType;var _a;(_a=au(F(en.icvFore)))&&(Mt.s.fgColor={rgb:_a}),(_a=au(F(en.icvBack)))&&(Mt.s.bgColor={rgb:_a})}},O=function(ot,Mt,qn){if(!(K>1)&&!(qn.sheetRows&&ot.r>=qn.sheetRows)){if(qn.cellStyles&&Mt.XF&&Mt.XF.data&&H(ot,Mt,qn),delete Mt.ixfe,delete Mt.XF,f=ot,p=dt(ot),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ot.r<o.s.r&&(o.s.r=ot.r),ot.c<o.s.c&&(o.s.c=ot.c),ot.r+1>o.e.r&&(o.e.r=ot.r+1),ot.c+1>o.e.c&&(o.e.c=ot.c+1),qn.cellFormula&&Mt.f){for(var en=0;en<T.length;++en)if(!(T[en][0].s.c>ot.c||T[en][0].s.r>ot.r)&&!(T[en][0].e.c<ot.c||T[en][0].e.r<ot.r)){Mt.F=pt(T[en][0]),(T[en][0].s.c!=ot.c||T[en][0].s.r!=ot.r)&&delete Mt.f,Mt.f&&(Mt.f=""+ba(T[en][1],o,ot,X,B));break}}qn.dense?(s[ot.r]||(s[ot.r]=[]),s[ot.r][ot.c]=Mt):s[p]=Mt}},B={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(B.password=n.password);var W,ee=[],q=[],fe=[],ne=[],Y=!1,X=[];X.SheetNames=B.snames,X.sharedf=B.sharedf,X.arrayf=B.arrayf,X.names=[],X.XTI=[];var xe=0,K=0,A=0,M=[],I=[],V;B.codepage=1200,Jr(1200);for(var J=!1;e.l<e.length-1;){var ge=e.l,z=e.read_shift(2);if(z===0&&xe===10)break;var le=e.l===e.length?0:e.read_shift(2),ue=Ap[z];if(ue&&ue.f){if(n.bookSheets&&xe===133&&z!==133)break;if(xe=z,ue.r===2||ue.r==12){var ce=e.read_shift(2);if(le-=2,!B.enc&&ce!==z&&((ce&255)<<8|ce>>8)!==z)throw new Error("rt mismatch: "+ce+"!="+z);ue.r==12&&(e.l+=10,le-=10)}var R={};if(z===10?R=ue.f(e,le,B):R=L9(z,ue,e,le,B),K==0&&[9,521,1033,2057].indexOf(xe)===-1)continue;switch(z){case 34:a.opts.Date1904=C.WBProps.date1904=R;break;case 134:a.opts.WriteProtect=!0;break;case 47:if(B.enc||(e.l=0),B.enc=R,!n.password)throw new Error("File is password-protected");if(R.valid==null)throw new Error("Encryption scheme unsupported");if(!R.valid)throw new Error("Password is incorrect");break;case 92:B.lastuser=R;break;case 66:var pe=Number(R);switch(pe){case 21010:pe=1200;break;case 32768:pe=1e4;break;case 32769:pe=1252;break}Jr(B.codepage=pe),J=!0;break;case 317:B.rrtabid=R;break;case 25:B.winlocked=R;break;case 439:a.opts.RefreshAll=R;break;case 12:a.opts.CalcCount=R;break;case 16:a.opts.CalcDelta=R;break;case 17:a.opts.CalcIter=R;break;case 13:a.opts.CalcMode=R;break;case 14:a.opts.CalcPrecision=R;break;case 95:a.opts.CalcSaveRecalc=R;break;case 15:B.CalcRefMode=R;break;case 2211:a.opts.FullCalc=R;break;case 129:R.fDialog&&(s["!type"]="dialog"),R.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),R.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:_.push(R);break;case 430:X.push([R]),X[X.length-1].XTI=[];break;case 35:case 547:X[X.length-1].push(R);break;case 24:case 536:V={Name:R.Name,Ref:ba(R.rgce,o,null,X,B)},R.itab>0&&(V.Sheet=R.itab-1),X.names.push(V),X[0]||(X[0]=[],X[0].XTI=[]),X[X.length-1].push(R),R.Name=="_xlnm._FilterDatabase"&&R.itab>0&&R.rgce&&R.rgce[0]&&R.rgce[0][0]&&R.rgce[0][0][0]=="PtgArea3d"&&(I[R.itab-1]={ref:pt(R.rgce[0][0][1][2])});break;case 22:B.ExternCount=R;break;case 23:X.length==0&&(X[0]=[],X[0].XTI=[]),X[X.length-1].XTI=X[X.length-1].XTI.concat(R),X.XTI=X.XTI.concat(R);break;case 2196:if(B.biff<8)break;V!=null&&(V.Comment=R[1]);break;case 18:s["!protect"]=R;break;case 19:R!==0&&B.WTF&&console.error("Password verifier: "+R);break;case 133:l[R.pos]=R,B.snames.push(R.name);break;case 10:{if(--K)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=pt(o),n.sheetRows&&n.sheetRows<=o.e.r){var Oe=o.e.r;o.e.r=n.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=pt(o),o.e.r=Oe}o.e.r++,o.e.c++}ee.length>0&&(s["!merges"]=ee),q.length>0&&(s["!objects"]=q),fe.length>0&&(s["!cols"]=fe),ne.length>0&&(s["!rows"]=ne),C.Sheets.push(P)}x===""?m=s:r[x]=s,s=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(B.biff===8&&(B.biff={9:2,521:3,1033:4}[z]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[R.BIFFVer]||8),B.biffguess=R.BIFFVer==0,R.BIFFVer==0&&R.dt==4096&&(B.biff=5,J=!0,Jr(B.codepage=28591)),B.biff==8&&R.BIFFVer==0&&R.dt==16&&(B.biff=2),K++)break;if(s=n.dense?[]:{},B.biff<8&&!J&&(J=!0,Jr(B.codepage=n.codepage||1252)),B.biff<5||R.BIFFVer==0&&R.dt==4096){x===""&&(x="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var tt={pos:e.l-le,name:x};l[tt.pos]=tt,B.snames.push(x)}else x=(l[ge]||{name:""}).name;R.dt==32&&(s["!type"]="chart"),R.dt==64&&(s["!type"]="macro"),ee=[],q=[],B.arrayf=T=[],fe=[],ne=[],Y=!1,P={Hidden:(l[ge]||{hs:0}).hs,name:x}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(n.dense?(s[R.r]||[])[R.c]:s[dt({c:R.c,r:R.r})])&&++R.c,S={ixfe:R.ixfe,XF:_[R.ixfe]||{},v:R.val,t:"n"},A>0&&(S.z=M[S.ixfe>>8&63]),hs(S,n,a.opts.Date1904),O({c:R.c,r:R.r},S,n);break;case 5:case 517:S={ixfe:R.ixfe,XF:_[R.ixfe],v:R.val,t:R.t},A>0&&(S.z=M[S.ixfe>>8&63]),hs(S,n,a.opts.Date1904),O({c:R.c,r:R.r},S,n);break;case 638:S={ixfe:R.ixfe,XF:_[R.ixfe],v:R.rknum,t:"n"},A>0&&(S.z=M[S.ixfe>>8&63]),hs(S,n,a.opts.Date1904),O({c:R.c,r:R.r},S,n);break;case 189:for(var Ye=R.c;Ye<=R.C;++Ye){var Re=R.rkrec[Ye-R.c][0];S={ixfe:Re,XF:_[Re],v:R.rkrec[Ye-R.c][1],t:"n"},A>0&&(S.z=M[S.ixfe>>8&63]),hs(S,n,a.opts.Date1904),O({c:Ye,r:R.r},S,n)}break;case 6:case 518:case 1030:{if(R.val=="String"){d=R;break}if(S=n0(R.val,R.cell.ixfe,R.tt),S.XF=_[S.ixfe],n.cellFormula){var Ot=R.formula;if(Ot&&Ot[0]&&Ot[0][0]&&Ot[0][0][0]=="PtgExp"){var Ht=Ot[0][0][1][0],rn=Ot[0][0][1][1],Fn=dt({r:Ht,c:rn});k[Fn]?S.f=""+ba(R.formula,o,R.cell,X,B):S.F=((n.dense?(s[Ht]||[])[rn]:s[Fn])||{}).F}else S.f=""+ba(R.formula,o,R.cell,X,B)}A>0&&(S.z=M[S.ixfe>>8&63]),hs(S,n,a.opts.Date1904),O(R.cell,S,n),d=R}break;case 7:case 519:if(d)d.val=R,S=n0(R,d.cell.ixfe,"s"),S.XF=_[S.ixfe],n.cellFormula&&(S.f=""+ba(d.formula,o,d.cell,X,B)),A>0&&(S.z=M[S.ixfe>>8&63]),hs(S,n,a.opts.Date1904),O(d.cell,S,n),d=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(R);var Ha=dt(R[0].s);if(b=n.dense?(s[R[0].s.r]||[])[R[0].s.c]:s[Ha],n.cellFormula&&b){if(!d||!Ha||!b)break;b.f=""+ba(R[1],o,R[0],X,B),b.F=pt(R[0])}}break;case 1212:{if(!n.cellFormula)break;if(p){if(!d)break;k[dt(d.cell)]=R[0],b=n.dense?(s[d.cell.r]||[])[d.cell.c]:s[dt(d.cell)],(b||{}).f=""+ba(R[0],o,f,X,B)}}break;case 253:S=n0(u[R.isst].t,R.ixfe,"s"),u[R.isst].h&&(S.h=u[R.isst].h),S.XF=_[S.ixfe],A>0&&(S.z=M[S.ixfe>>8&63]),hs(S,n,a.opts.Date1904),O({c:R.c,r:R.r},S,n);break;case 513:n.sheetStubs&&(S={ixfe:R.ixfe,XF:_[R.ixfe],t:"z"},A>0&&(S.z=M[S.ixfe>>8&63]),hs(S,n,a.opts.Date1904),O({c:R.c,r:R.r},S,n));break;case 190:if(n.sheetStubs)for(var Sa=R.c;Sa<=R.C;++Sa){var Be=R.ixfe[Sa-R.c];S={ixfe:Be,XF:_[Be],t:"z"},A>0&&(S.z=M[S.ixfe>>8&63]),hs(S,n,a.opts.Date1904),O({c:Sa,r:R.r},S,n)}break;case 214:case 516:case 4:S=n0(R.val,R.ixfe,"s"),S.XF=_[S.ixfe],A>0&&(S.z=M[S.ixfe>>8&63]),hs(S,n,a.opts.Date1904),O({c:R.c,r:R.r},S,n);break;case 0:case 512:K===1&&(o=R);break;case 252:u=R;break;case 1054:if(B.biff==4){M[A++]=R[1];for(var Xe=0;Xe<A+163&&ct[Xe]!=R[1];++Xe);Xe>=163&&ni(R[1],A+163)}else ni(R[1],R[0]);break;case 30:{M[A++]=R;for(var Lt=0;Lt<A+163&&ct[Lt]!=R;++Lt);Lt>=163&&ni(R,A+163)}break;case 229:ee=ee.concat(R);break;case 93:q[R.cmo[0]]=B.lastobj=R;break;case 438:B.lastobj.TxO=R;break;case 127:B.lastobj.ImData=R;break;case 440:for(N=R[0].s.r;N<=R[0].e.r;++N)for(y=R[0].s.c;y<=R[0].e.c;++y)b=n.dense?(s[N]||[])[y]:s[dt({c:y,r:N})],b&&(b.l=R[1]);break;case 2048:for(N=R[0].s.r;N<=R[0].e.r;++N)for(y=R[0].s.c;y<=R[0].e.c;++y)b=n.dense?(s[N]||[])[y]:s[dt({c:y,r:N})],b&&b.l&&(b.l.Tooltip=R[1]);break;case 28:{if(B.biff<=5&&B.biff>=2)break;b=n.dense?(s[R[0].r]||[])[R[0].c]:s[dt(R[0])];var Wt=q[R[2]];b||(n.dense?(s[R[0].r]||(s[R[0].r]=[]),b=s[R[0].r][R[0].c]={t:"z"}):b=s[dt(R[0])]={t:"z"},o.e.r=Math.max(o.e.r,R[0].r),o.s.r=Math.min(o.s.r,R[0].r),o.e.c=Math.max(o.e.c,R[0].c),o.s.c=Math.min(o.s.c,R[0].c)),b.c||(b.c=[]),g={a:R[1],t:Wt.TxO.t},b.c.push(g)}break;case 2173:NO(_[R.ixfe],R.ext);break;case 125:{if(!B.cellStyles)break;for(;R.e>=R.s;)fe[R.e--]={width:R.w/256,level:R.level||0,hidden:!!(R.flags&1)},Y||(Y=!0,Vg(R.w/256)),sl(fe[R.e+1])}break;case 520:{var Ct={};R.level!=null&&(ne[R.r]=Ct,Ct.level=R.level),R.hidden&&(ne[R.r]=Ct,Ct.hidden=!0),R.hpt&&(ne[R.r]=Ct,Ct.hpt=R.hpt,Ct.hpx=_c(R.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||to(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[z]]=R;break;case 161:s["!margins"]||to(s["!margins"]={}),s["!margins"].header=R.header,s["!margins"].footer=R.footer;break;case 574:R.RTL&&(C.Views[0].RTL=!0);break;case 146:L=R;break;case 2198:W=R;break;case 140:w=R;break;case 442:x?P.CodeName=R||P.name:C.WBProps.CodeName=R||"ThisWorkbook";break}}else ue||console.error("Missing Info for XLS Record 0x"+z.toString(16)),e.l+=le}return a.SheetNames=kn(l).sort(function(Rn,ot){return Number(Rn)-Number(ot)}).map(function(Rn){return l[Rn].name}),n.bookSheets||(a.Sheets=r),!a.SheetNames.length&&m["!ref"]?(a.SheetNames.push("Sheet1"),a.Sheets&&(a.Sheets.Sheet1=m)):a.Preamble=m,a.Sheets&&I.forEach(function(Rn,ot){a.Sheets[a.SheetNames[ot]]["!autofilter"]=Rn}),a.Strings=u,a.SSF=hn(ct),B.enc&&(a.Encryption=B.enc),W&&(a.Themes=W),a.Metadata={},w!==void 0&&(a.Metadata.Country=w),X.names.length>0&&(C.Names=X.names),a.Workbook=C,a}var zd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function I9(e,n,a){var r=at.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var s=MN(r,kp,zd.DSI);for(var l in s)n[l]=s[l]}catch(x){if(a.WTF)throw x}var o=at.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var d=MN(o,Tp,zd.SI);for(var u in d)n[u]==null&&(n[u]=d[u])}catch(x){if(a.WTF)throw x}n.HeadingPairs&&n.TitlesOfParts&&(hk(n.HeadingPairs,n.TitlesOfParts,n,a),delete n.HeadingPairs,delete n.TitlesOfParts)}function O9(e,n){var a=[],r=[],s=[],l=0,o,d=xN(kp,"n"),u=xN(Tp,"n");if(e.Props)for(o=kn(e.Props),l=0;l<o.length;++l)(Object.prototype.hasOwnProperty.call(d,o[l])?a:Object.prototype.hasOwnProperty.call(u,o[l])?r:s).push([o[l],e.Props[o[l]]]);if(e.Custprops)for(o=kn(e.Custprops),l=0;l<o.length;++l)Object.prototype.hasOwnProperty.call(e.Props||{},o[l])||(Object.prototype.hasOwnProperty.call(d,o[l])?a:Object.prototype.hasOwnProperty.call(u,o[l])?r:s).push([o[l],e.Custprops[o[l]]]);var x=[];for(l=0;l<s.length;++l)vk.indexOf(s[l][0])>-1||uk.indexOf(s[l][0])>-1||s[l][1]!=null&&x.push(s[l]);r.length&&at.utils.cfb_add(n,"/SummaryInformation",RN(r,zd.SI,u,Tp)),(a.length||x.length)&&at.utils.cfb_add(n,"/DocumentSummaryInformation",RN(a,zd.DSI,d,kp,x.length?x:null,zd.UDI))}function Xg(e,n){n||(n={}),Yg(n),gg(),n.codepage&&pg(n.codepage);var a,r;if(e.FullPaths){if(at.find(e,"/encryption"))throw new Error("File is password-protected");a=at.find(e,"!CompObj"),r=at.find(e,"/Workbook")||at.find(e,"/Book")}else{switch(n.type){case"base64":e=dr(xr(e));break;case"binary":e=dr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}oa(e,0),r={content:e}}var s,l;if(a&&A9(a),n.bookProps&&!n.bookSheets)s={};else{var o=bt?"buffer":"array";if(r&&r.content)s=P9(r.content,n);else if((l=at.find(e,"PerfectOffice_MAIN"))&&l.content)s=eo.to_workbook(l.content,(n.type=o,n));else if((l=at.find(e,"NativeContent_MAIN"))&&l.content)s=eo.to_workbook(l.content,(n.type=o,n));else throw(l=at.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&e.FullPaths&&at.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=XO(e))}var d={};return e.FullPaths&&I9(e,d,n),s.Props=s.Custprops=d,n.bookFiles&&(s.cfb=e),s}function M9(e,n){var a=n||{},r=at.utils.cfb_new({root:"R"}),s="/Workbook";switch(a.bookType||"xls"){case"xls":a.bookType="biff8";case"xla":a.bookType||(a.bookType="xla");case"biff8":s="/Workbook",a.biff=8;break;case"biff5":s="/Book",a.biff=5;break;default:throw new Error("invalid type "+a.bookType+" for XLS CFB")}return at.utils.cfb_add(r,s,mT(e,a)),a.biff==8&&(e.Props||e.Custprops)&&O9(e,r),a.biff==8&&e.vbaraw&&QO(r,at.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),r}var lu={0:{f:lR},1:{f:fR},2:{f:PR},3:{f:wR},4:{f:vR},5:{f:AR},6:{f:BR},7:{f:SR},8:{f:GR},9:{f:$R},10:{f:KR},11:{f:zR},12:{f:gR},13:{f:OR},14:{f:TR},15:{f:NR},16:{f:iT},17:{f:VR},18:{f:ER},19:{f:Ag},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:VB},40:{},42:{},43:{f:BI},44:{f:MI},45:{f:UI},46:{f:zI},47:{f:KI},48:{},49:{f:d8},50:{},51:{f:kO},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Dk},62:{f:RR},63:{f:LO},64:{f:oB},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ta,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:rB},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:xR},148:{f:dR,p:16},151:{f:JR},152:{},153:{f:RB},154:{},155:{},156:{f:OB},157:{},158:{},159:{T:1,f:eI},160:{T:-1},161:{T:1,f:vo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:qR},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:jO},336:{T:-1},337:{f:SO,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:wp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ek},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ZR},427:{f:eB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:nB},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:hR},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:QR},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:wp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:zO},633:{T:1},634:{T:-1},635:{T:1,f:UO},636:{T:-1},637:{f:m8},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:TB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:cB},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ap={6:{f:_f},10:{f:Oi},12:{f:On},13:{f:On},14:{f:_n},15:{f:_n},16:{f:wa},17:{f:_n},18:{f:_n},19:{f:On},20:{f:zN},21:{f:zN},23:{f:Ek},24:{f:GN},25:{f:_n},26:{},27:{},28:{f:cP},29:{},34:{f:_n},35:{f:$N},38:{f:wa},39:{f:wa},40:{f:wa},41:{f:wa},42:{f:_n},43:{f:_n},47:{f:NI},49:{f:OL},51:{f:On},60:{},61:{f:AL},64:{f:_n},65:{f:IL},66:{f:On},77:{},80:{},81:{},82:{},85:{f:On},89:{},90:{},91:{},92:{f:bL},93:{f:hP},94:{},95:{f:_n},96:{},97:{},99:{f:_n},125:{f:Dk},128:{f:YL},129:{f:jL},130:{f:On},131:{f:_n},132:{f:_n},133:{f:wL},134:{},140:{f:bP},141:{f:On},144:{},146:{f:wP},151:{},152:{},153:{},154:{},155:{},156:{f:On},157:{},158:{},160:{f:DP},161:{f:CP},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:qL},190:{f:WL},193:{f:Oi},197:{},198:{},199:{},200:{},201:{},202:{f:_n},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:On},220:{},221:{f:_n},222:{},224:{f:QL},225:{f:vL},226:{f:Oi},227:{},229:{f:dP},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:TL},253:{f:RL},255:{f:SL},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:bk},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:_n},353:{f:Oi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:nP},431:{f:_n},432:{},433:{},434:{},437:{},438:{f:fP},439:{f:_n},440:{f:pP},441:{},442:{f:Tu},443:{},444:{f:On},445:{},446:{},448:{f:Oi},449:{f:DL,r:2},450:{f:Oi},512:{f:VN},513:{f:EP},515:{f:eP},516:{f:HL},517:{f:KN},519:{f:AP},520:{f:_L},523:{},545:{f:qN},549:{f:HN},566:{},574:{f:LL},638:{f:GL},659:{},1048:{},1054:{f:UL},1084:{},1212:{f:iP},2048:{f:yP},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Zh},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Oi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:kP,r:12},2173:{f:bO,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:_n,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:sP,r:12},2197:{},2198:{f:mO,r:12},2199:{},2200:{},2201:{},2202:{f:lP,r:12},2203:{f:Oi},2204:{},2205:{},2206:{},2207:{},2211:{f:EL},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:On},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:SP},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:jP},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:VN},1:{},2:{f:OP},3:{f:PP},4:{f:LP},5:{f:KN},7:{f:RP},8:{},9:{f:Zh},11:{},22:{f:On},30:{f:zL},31:{},32:{},33:{f:qN},36:{},37:{f:HN},50:{f:BP},62:{},52:{},67:{},68:{f:On},69:{},86:{},126:{},127:{f:FP},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:HP},223:{},234:{},354:{},421:{},518:{f:_f},521:{f:Zh},536:{f:GN},547:{f:$N},561:{},579:{},1030:{f:_f},1033:{f:Zh},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ke(e,n,a,r){var s=n;if(!isNaN(s)){var l=r||(a||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,l),l>0&&_g(a)&&e.push(a)}}function R9(e,n,a,r){var s=(a||[]).length||0;if(s<=8224)return Ke(e,n,a,s);var l=n;if(!isNaN(l)){for(var o=a.parts||[],d=0,u=0,x=0;x+(o[d]||8224)<=8224;)x+=o[d]||8224,d++;var m=e.next(4);for(m.write_shift(2,l),m.write_shift(2,x),e.push(a.slice(u,u+x)),u+=x;u<s;){for(m=e.next(4),m.write_shift(2,60),x=0;x+(o[d]||8224)<=8224;)x+=o[d]||8224,d++;m.write_shift(2,x),e.push(a.slice(u,u+x)),u+=x}}}function Eu(e,n,a){return e||(e=Ce(7)),e.write_shift(2,n),e.write_shift(2,a),e.write_shift(2,0),e.write_shift(1,0),e}function B9(e,n,a,r){var s=Ce(9);return Eu(s,e,n),Nk(a,r||"b",s),s}function H9(e,n,a){var r=Ce(8+2*a.length);return Eu(r,e,n),r.write_shift(1,a.length),r.write_shift(a.length,a,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function V9(e,n,a,r){if(n.v!=null)switch(n.t){case"d":case"n":var s=n.t=="d"?Gn(un(n.v)):n.v;s==(s|0)&&s>=0&&s<65536?Ke(e,2,MP(a,r,s)):Ke(e,3,IP(a,r,s));return;case"b":case"e":Ke(e,5,B9(a,r,n.v,n.t));return;case"s":case"str":Ke(e,4,H9(a,r,(n.v||"").slice(0,255)));return}Ke(e,1,Eu(null,a,r))}function U9(e,n,a,r){var s=Array.isArray(n),l=Ft(n["!ref"]||"A1"),o,d="",u=[];if(l.e.c>255||l.e.r>16383){if(r.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),o=pt(l)}for(var x=l.s.r;x<=l.e.r;++x){d=Dn(x);for(var m=l.s.c;m<=l.e.c;++m){x===l.s.r&&(u[m]=yn(m)),o=u[m]+d;var f=s?(n[x]||[])[m]:n[o];f&&V9(e,f,x,m)}}}function K9(e,n){for(var a=n||{},r=tr(),s=0,l=0;l<e.SheetNames.length;++l)e.SheetNames[l]==a.sheet&&(s=l);if(s==0&&a.sheet&&e.SheetNames[0]!=a.sheet)throw new Error("Sheet not found: "+a.sheet);return Ke(r,a.biff==4?1033:a.biff==3?521:9,Rg(e,16,a)),U9(r,e.Sheets[e.SheetNames[s]],s,a),Ke(r,10),r.end()}function z9(e,n,a){Ke(e,49,ML({sz:12,name:"Arial"},a))}function $9(e,n,a){n&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)n[s]!=null&&Ke(e,1054,KL(s,n[s],a))})}function G9(e,n){var a=Ce(19);a.write_shift(4,2151),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,1),a.write_shift(4,0),Ke(e,2151,a),a=Ce(39),a.write_shift(4,2152),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,0),a.write_shift(4,0),a.write_shift(2,1),a.write_shift(4,4),a.write_shift(2,0),Ck(Ft(n["!ref"]||"A1"),a),a.write_shift(4,4),Ke(e,2152,a)}function q9(e,n){for(var a=0;a<16;++a)Ke(e,224,UN({numFmtId:0,style:!0},0,n));n.cellXfs.forEach(function(r){Ke(e,224,UN(r,0,n))})}function W9(e,n){for(var a=0;a<n["!links"].length;++a){var r=n["!links"][a];Ke(e,440,gP(r)),r[1].Tooltip&&Ke(e,2048,vP(r))}delete n["!links"]}function X9(e,n){if(n){var a=0;n.forEach(function(r,s){++a<=256&&r&&Ke(e,125,TP(dx(s,r),s))})}}function Q9(e,n,a,r,s){var l=16+xl(s.cellXfs,n,s);if(n.v==null&&!n.bf){Ke(e,513,uo(a,r,l));return}if(n.bf)Ke(e,6,j7(n,a,r,s,l));else switch(n.t){case"d":case"n":var o=n.t=="d"?Gn(un(n.v)):n.v;Ke(e,515,tP(a,r,o,l));break;case"b":case"e":Ke(e,517,ZL(a,r,n.v,l,s,n.t));break;case"s":case"str":if(s.bookSST){var d=Gg(s.Strings,n.v,s.revStrings);Ke(e,253,BL(a,r,d,l))}else Ke(e,516,VL(a,r,(n.v||"").slice(0,255),l,s));break;default:Ke(e,513,uo(a,r,l))}}function Y9(e,n,a){var r=tr(),s=a.SheetNames[e],l=a.Sheets[s]||{},o=(a||{}).Workbook||{},d=(o.Sheets||[])[e]||{},u=Array.isArray(l),x=n.biff==8,m,f="",p=[],b=Ft(l["!ref"]||"A1"),g=x?65536:16384;if(b.e.c>255||b.e.r>=g){if(n.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");b.e.c=Math.min(b.e.c,255),b.e.r=Math.min(b.e.c,g-1)}Ke(r,2057,Rg(a,16,n)),Ke(r,13,_r(1)),Ke(r,12,_r(100)),Ke(r,15,Ia(!0)),Ke(r,17,Ia(!1)),Ke(r,16,oo(.001)),Ke(r,95,Ia(!0)),Ke(r,42,Ia(!1)),Ke(r,43,Ia(!1)),Ke(r,130,_r(1)),Ke(r,128,JL()),Ke(r,131,Ia(!1)),Ke(r,132,Ia(!1)),x&&X9(r,l["!cols"]),Ke(r,512,$L(b,n)),x&&(l["!links"]=[]);for(var y=b.s.r;y<=b.e.r;++y){f=Dn(y);for(var N=b.s.c;N<=b.e.c;++N){y===b.s.r&&(p[N]=yn(N)),m=p[N]+f;var k=u?(l[y]||[])[N]:l[m];k&&(Q9(r,k,y,N,n),x&&k.l&&l["!links"].push([m,k.l]))}}var T=d.CodeName||d.name||s;return x&&Ke(r,574,PL((o.Views||[])[0])),x&&(l["!merges"]||[]).length&&Ke(r,229,uP(l["!merges"])),x&&W9(r,l),Ke(r,442,jk(T)),x&&G9(r,l),Ke(r,10),r.end()}function J9(e,n,a){var r=tr(),s=(e||{}).Workbook||{},l=s.Sheets||[],o=s.WBProps||{},d=a.biff==8,u=a.biff==5;if(Ke(r,2057,Rg(e,5,a)),a.bookType=="xla"&&Ke(r,135),Ke(r,225,d?_r(1200):null),Ke(r,193,Z8(2)),u&&Ke(r,191),u&&Ke(r,192),Ke(r,226),Ke(r,92,NL("SheetJS",a)),Ke(r,66,_r(d?1200:1252)),d&&Ke(r,353,_r(0)),d&&Ke(r,448),Ke(r,317,_P(e.SheetNames.length)),d&&e.vbaraw&&Ke(r,211),d&&e.vbaraw){var x=o.CodeName||"ThisWorkbook";Ke(r,442,jk(x))}Ke(r,156,_r(17)),Ke(r,25,Ia(!1)),Ke(r,18,Ia(!1)),Ke(r,19,_r(0)),d&&Ke(r,431,Ia(!1)),d&&Ke(r,444,_r(0)),Ke(r,61,FL()),Ke(r,64,Ia(!1)),Ke(r,141,_r(0)),Ke(r,34,Ia(DB(e)=="true")),Ke(r,14,Ia(!0)),d&&Ke(r,439,Ia(!1)),Ke(r,218,_r(0)),z9(r,e,a),$9(r,e.SSF,a),q9(r,a),d&&Ke(r,352,Ia(!1));var m=r.end(),f=tr();d&&Ke(f,140,NP()),d&&a.Strings&&R9(f,252,CL(a.Strings)),Ke(f,10);var p=f.end(),b=tr(),g=0,y=0;for(y=0;y<e.SheetNames.length;++y)g+=(d?12:11)+(d?2:1)*e.SheetNames[y].length;var N=m.length+g+p.length;for(y=0;y<e.SheetNames.length;++y){var k=l[y]||{};Ke(b,133,kL({pos:N,hs:k.Hidden||0,dt:0,name:e.SheetNames[y]},a)),N+=n[y].length}var T=b.end();if(g!=T.length)throw new Error("BS8 "+g+" != "+T.length);var S=[];return m.length&&S.push(m),T.length&&S.push(T),p.length&&S.push(p),ta(S)}function Z9(e,n){var a=n||{},r=[];e&&!e.SSF&&(e.SSF=hn(ct)),e&&e.SSF&&(Ic(),ax(e.SSF),a.revssf=sx(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF),a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,Jg(a),a.cellXfs=[],xl(a.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)r[r.length]=Y9(s,a,e);return r.unshift(J9(e,r,a)),ta(r)}function mT(e,n){for(var a=0;a<=e.SheetNames.length;++a){var r=e.Sheets[e.SheetNames[a]];if(!(!r||!r["!ref"])){var s=nr(r["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[a]+"' extends beyond column IV (255).  Data may be lost.")}}var l=n||{};switch(l.biff||2){case 8:case 5:return Z9(e,n);case 4:case 3:case 2:return K9(e,n)}throw new Error("invalid type "+l.bookType+" for BIFF")}function a2(e,n){var a=n||{},r=a.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),o=s.index,d=l&&l.index||e.length,u=MF(e.slice(o,d),/(:?<tr[^>]*>)/i,"<tr>"),x=-1,m=0,f=0,p=0,b={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(o=0;o<u.length;++o){var y=u[o].trim(),N=y.slice(0,3).toLowerCase();if(N=="<tr"){if(++x,a.sheetRows&&a.sheetRows<=x){--x;break}m=0;continue}if(!(N!="<td"&&N!="<th")){var k=y.split(/<\/t[dh]>/i);for(d=0;d<k.length;++d){var T=k[d].trim();if(T.match(/<t[dh]/i)){for(var S=T,w=0;S.charAt(0)=="<"&&(w=S.indexOf(">"))>-1;)S=S.slice(w+1);for(var _=0;_<g.length;++_){var L=g[_];L.s.c==m&&L.s.r<x&&x<=L.e.r&&(m=L.e.c+1,_=-1)}var C=ut(T.slice(0,T.indexOf(">")));p=C.colspan?+C.colspan:1,((f=+C.rowspan)>1||p>1)&&g.push({s:{r:x,c:m},e:{r:x+(f||1)-1,c:m+p-1}});var P=C.t||C["data-t"]||"";if(!S.length){m+=p;continue}if(S=Bw(S),b.s.r>x&&(b.s.r=x),b.e.r<x&&(b.e.r=x),b.s.c>m&&(b.s.c=m),b.e.c<m&&(b.e.c=m),!S.length){m+=p;continue}var F={t:"s",v:S};a.raw||!S.trim().length||P=="s"||(S==="TRUE"?F={t:"b",v:!0}:S==="FALSE"?F={t:"b",v:!1}:isNaN(es(S))?isNaN(Cc(S).getDate())||(F={t:"d",v:un(S)},a.cellDates||(F={t:"n",v:Gn(F.v)}),F.z=a.dateNF||ct[14]):F={t:"n",v:es(S)}),a.dense?(r[x]||(r[x]=[]),r[x][m]=F):r[dt({r:x,c:m})]=F,m+=p}}}}return r["!ref"]=pt(b),g.length&&(r["!merges"]=g),r}function eH(e,n,a,r){for(var s=e["!merges"]||[],l=[],o=n.s.c;o<=n.e.c;++o){for(var d=0,u=0,x=0;x<s.length;++x)if(!(s[x].s.r>a||s[x].s.c>o)&&!(s[x].e.r<a||s[x].e.c<o)){if(s[x].s.r<a||s[x].s.c<o){d=-1;break}d=s[x].e.r-s[x].s.r+1,u=s[x].e.c-s[x].s.c+1;break}if(!(d<0)){var m=dt({r:a,c:o}),f=r.dense?(e[a]||[])[o]:e[m],p=f&&f.v!=null&&(f.h||Tg(f.w||(oi(f),f.w)||""))||"",b={};d>1&&(b.rowspan=d),u>1&&(b.colspan=u),r.editable?p='<span contenteditable="true">'+p+"</span>":f&&(b["data-t"]=f&&f.t||"z",f.v!=null&&(b["data-v"]=f.v),f.z!=null&&(b["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+f.l.Target+'">'+p+"</a>")),b.id=(r.id||"sjs")+"-"+m,l.push(Ue("td",p,b))}}var g="<tr>";return g+l.join("")+"</tr>"}var tH='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',nH="</body></html>";function aH(e,n){var a=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!a||a.length==0)throw new Error("Invalid HTML: could not find <table>");if(a.length==1)return hl(a2(a[0],n),n);var r=ny();return a.forEach(function(s,l){ay(r,a2(s,n),"Sheet"+(l+1))}),r}function rH(e,n,a){var r=[];return r.join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}function fT(e,n){var a=n||{},r=a.header!=null?a.header:tH,s=a.footer!=null?a.footer:nH,l=[r],o=nr(e["!ref"]);a.dense=Array.isArray(e),l.push(rH(e,o,a));for(var d=o.s.r;d<=o.e.r;++d)l.push(eH(e,o,d,a));return l.push("</table>"+s),l.join("")}function pT(e,n,a){var r=a||{},s=0,l=0;if(r.origin!=null)if(typeof r.origin=="number")s=r.origin;else{var o=typeof r.origin=="string"?vn(r.origin):r.origin;s=o.r,l=o.c}var d=n.getElementsByTagName("tr"),u=Math.min(r.sheetRows||1e7,d.length),x={s:{r:0,c:0},e:{r:s,c:l}};if(e["!ref"]){var m=nr(e["!ref"]);x.s.r=Math.min(x.s.r,m.s.r),x.s.c=Math.min(x.s.c,m.s.c),x.e.r=Math.max(x.e.r,m.e.r),x.e.c=Math.max(x.e.c,m.e.c),s==-1&&(x.e.r=s=m.e.r+1)}var f=[],p=0,b=e["!rows"]||(e["!rows"]=[]),g=0,y=0,N=0,k=0,T=0,S=0;for(e["!cols"]||(e["!cols"]=[]);g<d.length&&y<u;++g){var w=d[g];if(r2(w)){if(r.display)continue;b[y]={hidden:!0}}var _=w.children;for(N=k=0;N<_.length;++N){var L=_[N];if(!(r.display&&r2(L))){var C=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):Bw(L.innerHTML),P=L.getAttribute("data-z")||L.getAttribute("z");for(p=0;p<f.length;++p){var F=f[p];F.s.c==k+l&&F.s.r<y+s&&y+s<=F.e.r&&(k=F.e.c+1-l,p=-1)}S=+L.getAttribute("colspan")||1,((T=+L.getAttribute("rowspan")||1)>1||S>1)&&f.push({s:{r:y+s,c:k+l},e:{r:y+s+(T||1)-1,c:k+l+(S||1)-1}});var H={t:"s",v:C},O=L.getAttribute("data-t")||L.getAttribute("t")||"";C!=null&&(C.length==0?H.t=O||"z":r.raw||C.trim().length==0||O=="s"||(C==="TRUE"?H={t:"b",v:!0}:C==="FALSE"?H={t:"b",v:!1}:isNaN(es(C))?isNaN(Cc(C).getDate())||(H={t:"d",v:un(C)},r.cellDates||(H={t:"n",v:Gn(H.v)}),H.z=r.dateNF||ct[14]):H={t:"n",v:es(C)})),H.z===void 0&&P!=null&&(H.z=P);var B="",W=L.getElementsByTagName("A");if(W&&W.length)for(var ee=0;ee<W.length&&!(W[ee].hasAttribute("href")&&(B=W[ee].getAttribute("href"),B.charAt(0)!="#"));++ee);B&&B.charAt(0)!="#"&&(H.l={Target:B}),r.dense?(e[y+s]||(e[y+s]=[]),e[y+s][k+l]=H):e[dt({c:k+l,r:y+s})]=H,x.e.c<k+l&&(x.e.c=k+l),k+=S}}++y}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),x.e.r=Math.max(x.e.r,y-1+s),e["!ref"]=pt(x),y>=u&&(e["!fullref"]=pt((x.e.r=d.length-g+y-1+s,x))),e}function gT(e,n){var a=n||{},r=a.dense?[]:{};return pT(r,e,n)}function sH(e,n){return hl(gT(e,n),n)}function r2(e){var n="",a=iH(e);return a&&(n=a(e).getPropertyValue("display")),n||(n=e.style&&e.style.display),n==="none"}function iH(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function lH(e){var n=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),a=Dt(n.replace(/<[^>]*>/g,""));return[a]}var s2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function yT(e,n){var a=n||{},r=Cg(e),s=[],l,o,d={name:""},u="",x=0,m,f,p={},b=[],g=a.dense?[]:{},y,N,k={value:""},T="",S=0,w=[],_=-1,L=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,F={},H=[],O={},B=0,W=0,ee=[],q=1,fe=1,ne=[],Y={Names:[]},X={},xe=["",""],K=[],A={},M="",I=0,V=!1,J=!1,ge=0;for(tu.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=tu.exec(r);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?g["!ref"]=pt(C):g["!ref"]="A1:A1",a.sheetRows>0&&a.sheetRows<=C.e.r&&(g["!fullref"]=g["!ref"],C.e.r=a.sheetRows-1,g["!ref"]=pt(C)),H.length&&(g["!merges"]=H),ee.length&&(g["!rows"]=ee),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),b.push(m.name),p[m.name]=g,J=!1):y[0].charAt(y[0].length-2)!=="/"&&(m=ut(y[0],!1),_=L=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,g=a.dense?[]:{},H=[],ee=[],J=!0);break;case"table-row-group":y[1]==="/"?--P:++P;break;case"table-row":case"":if(y[1]==="/"){_+=q,q=1;break}if(f=ut(y[0],!1),f.?_=f.-1:_==-1&&(_=0),q=+f["number-rows-repeated"]||1,q<10)for(ge=0;ge<q;++ge)P>0&&(ee[_+ge]={level:P});L=-1;break;case"covered-table-cell":y[1]!=="/"&&++L,a.sheetStubs&&(a.dense?(g[_]||(g[_]=[]),g[_][L]={t:"z"}):g[dt({r:_,c:L})]={t:"z"}),T="",w=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++L,k=ut(y[0],!1),fe=parseInt(k["number-columns-repeated"]||"1",10),N={t:"z",v:null},k.formula&&a.cellFormula!=!1&&(N.f=e2(Dt(k.formula))),(k.||k["value-type"])=="string"&&(N.t="s",N.v=Dt(k["string-value"]||""),a.dense?(g[_]||(g[_]=[]),g[_][L]=N):g[dt({r:_,c:L})]=N),L+=fe-1;else if(y[1]!=="/"){++L,T="",S=0,w=[],fe=1;var z=q?_+q-1:_;if(L>C.e.c&&(C.e.c=L),L<C.s.c&&(C.s.c=L),_<C.s.r&&(C.s.r=_),z>C.e.r&&(C.e.r=z),k=ut(y[0],!1),K=[],A={},N={t:k.||k["value-type"],v:null},a.cellFormula)if(k.formula&&(k.formula=Dt(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(B=parseInt(k["number-matrix-rows-spanned"],10)||0,W=parseInt(k["number-matrix-columns-spanned"],10)||0,O={s:{r:_,c:L},e:{r:_+B-1,c:L+W-1}},N.F=pt(O),ne.push([O,N.F])),k.formula)N.f=e2(k.formula);else for(ge=0;ge<ne.length;++ge)_>=ne[ge][0].s.r&&_<=ne[ge][0].e.r&&L>=ne[ge][0].s.c&&L<=ne[ge][0].e.c&&(N.F=ne[ge][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(B=parseInt(k["number-rows-spanned"],10)||0,W=parseInt(k["number-columns-spanned"],10)||0,O={s:{r:_,c:L},e:{r:_+B-1,c:L+W-1}},H.push(O)),k["number-columns-repeated"]&&(fe=parseInt(k["number-columns-repeated"],10)),N.t){case"boolean":N.t="b",N.v=on(k["boolean-value"]);break;case"float":N.t="n",N.v=parseFloat(k.value);break;case"percentage":N.t="n",N.v=parseFloat(k.value);break;case"currency":N.t="n",N.v=parseFloat(k.value);break;case"date":N.t="d",N.v=un(k["date-value"]),a.cellDates||(N.t="n",N.v=Gn(N.v)),N.z="m/d/yy";break;case"time":N.t="n",N.v=PF(k["time-value"])/86400,a.cellDates&&(N.t="d",N.v=ix(N.v)),N.z="HH:MM:SS";break;case"number":N.t="n",N.v=parseFloat(k.);break;default:if(N.t==="string"||N.t==="text"||!N.t)N.t="s",k["string-value"]!=null&&(T=Dt(k["string-value"]),w=[]);else throw new Error("Unsupported value type "+N.t)}}else{if(V=!1,N.t==="s"&&(N.v=T||"",w.length&&(N.R=w),V=S==0),X.Target&&(N.l=X),K.length>0&&(N.c=K,K=[]),T&&a.cellText!==!1&&(N.w=T),V&&(N.t="z",delete N.v),(!V||a.sheetStubs)&&!(a.sheetRows&&a.sheetRows<=_))for(var le=0;le<q;++le){if(fe=parseInt(k["number-columns-repeated"]||"1",10),a.dense)for(g[_+le]||(g[_+le]=[]),g[_+le][L]=le==0?N:hn(N);--fe>0;)g[_+le][L+fe]=hn(N);else for(g[dt({r:_+le,c:L})]=N;--fe>0;)g[dt({r:_+le,c:L+fe})]=hn(N);C.e.c<=L&&(C.e.c=L)}fe=parseInt(k["number-columns-repeated"]||"1",10),L+=fe-1,fe=0,N={},T="",w=[]}X={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((l=s.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((l=s.pop())[0]!==y[3])throw"Bad state: "+l;A.t=T,w.length&&(A.R=w),A.a=M,K.push(A)}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);M="",I=0,T="",S=0,w=[];break;case"creator":y[1]==="/"?M=r.slice(I,y.index):I=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((l=s.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);T="",S=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(F[d.name]=u,(l=s.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&(u="",d=ut(y[0],!1),s.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=ut(y[0],!1),u+=s2[y[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=ut(y[0],!1),u+=s2[y[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":u+=r.slice(x,y.index);break}else x=y.index+y[0].length;break;case"named-range":o=ut(y[0],!1),xe=Ef(o["cell-range-address"]);var ue={Name:o.name,Ref:xe[0]+"!"+xe[1]};J&&(ue.Sheet=b.length),Y.Names.push(ue);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(y[1]==="/"&&(!k||!k["string-value"])){var ce=lH(r.slice(S,y.index));T=(T.length>0?T+`
`:"")+ce[0]}else ut(y[0],!1),S=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{xe=Ef(ut(y[0])["target-range-address"]),p[xe[0]]["!autofilter"]={ref:xe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(X=ut(y[0],!1),!X.href)break;X.Target=Dt(X.href),delete X.href,X.Target.charAt(0)=="#"&&X.Target.indexOf(".")>-1?(xe=Ef(X.Target.slice(1)),X.Target="#"+xe[0]+"!"+xe[1]):X.Target.match(/^\.\.[\\\/]/)&&(X.Target=X.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(a.WTF)throw new Error(y)}}var R={Sheets:p,SheetNames:b,Workbook:Y};return a.bookSheets&&delete R.Sheets,R}function i2(e,n){n=n||{},Cr(e,"META-INF/manifest.xml")&&P8(In(e,"META-INF/manifest.xml"),n);var a=ur(e,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var r=yT(Qt(a),n);return Cr(e,"meta.xml")&&(r.Props=ck(In(e,"meta.xml"))),r}function l2(e,n){return yT(e,n)}var oH=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),n="<office:document-styles "+eu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return An+n}})(),o2=(function(){var e=function(l){return qt(l).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},n=`          <table:table-cell />
`,a=`          <table:covered-table-cell/>
`,r=function(l,o,d){var u=[];u.push('      <table:table table:name="'+qt(o.SheetNames[d])+`" table:style-name="ta1">
`);var x=0,m=0,f=nr(l["!ref"]||"A1"),p=l["!merges"]||[],b=0,g=Array.isArray(l);if(l["!cols"])for(m=0;m<=f.e.c;++m)u.push("        <table:table-column"+(l["!cols"][m]?' table:style-name="co'+l["!cols"][m].ods+'"':"")+`></table:table-column>
`);var y="",N=l["!rows"]||[];for(x=0;x<f.s.r;++x)y=N[x]?' table:style-name="ro'+N[x].ods+'"':"",u.push("        <table:table-row"+y+`></table:table-row>
`);for(;x<=f.e.r;++x){for(y=N[x]?' table:style-name="ro'+N[x].ods+'"':"",u.push("        <table:table-row"+y+`>
`),m=0;m<f.s.c;++m)u.push(n);for(;m<=f.e.c;++m){var k=!1,T={},S="";for(b=0;b!=p.length;++b)if(!(p[b].s.c>m)&&!(p[b].s.r>x)&&!(p[b].e.c<m)&&!(p[b].e.r<x)){(p[b].s.c!=m||p[b].s.r!=x)&&(k=!0),T["table:number-columns-spanned"]=p[b].e.c-p[b].s.c+1,T["table:number-rows-spanned"]=p[b].e.r-p[b].s.r+1;break}if(k){u.push(a);continue}var w=dt({r:x,c:m}),_=g?(l[x]||[])[m]:l[w];if(_&&_.f&&(T["table:formula"]=qt(_7(_.f)),_.F&&_.F.slice(0,w.length)==w)){var L=nr(_.F);T["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,T["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!_){u.push(n);continue}switch(_.t){case"b":S=_.v?"TRUE":"FALSE",T["office:value-type"]="boolean",T["office:boolean-value"]=_.v?"true":"false";break;case"n":S=_.w||String(_.v||0),T["office:value-type"]="float",T["office:value"]=_.v||0;break;case"s":case"str":S=_.v==null?"":_.v,T["office:value-type"]="string";break;case"d":S=_.w||un(_.v).toISOString(),T["office:value-type"]="date",T["office:date-value"]=un(_.v).toISOString(),T["table:style-name"]="ce1";break;default:u.push(n);continue}var C=e(S);if(_.l&&_.l.Target){var P=_.l.Target;P=P.charAt(0)=="#"?"#"+E7(P.slice(1)):P,P.charAt(0)!="#"&&!P.match(/^\w+:/)&&(P="../"+P),C=Ue("text:a",C,{"xlink:href":P.replace(/&/g,"&amp;")})}u.push("          "+Ue("table:table-cell",Ue("text:p",C,{}),T)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},s=function(l,o){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var d=0;o.SheetNames.map(function(x){return o.Sheets[x]}).forEach(function(x){if(x&&x["!cols"]){for(var m=0;m<x["!cols"].length;++m)if(x["!cols"][m]){var f=x["!cols"][m];if(f.width==null&&f.wpx==null&&f.wch==null)continue;sl(f),f.ods=d;var p=x["!cols"][m].wpx+"px";l.push('  <style:style style:name="co'+d+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),l.push(`  </style:style>
`),++d}}});var u=0;o.SheetNames.map(function(x){return o.Sheets[x]}).forEach(function(x){if(x&&x["!rows"]){for(var m=0;m<x["!rows"].length;++m)if(x["!rows"][m]){x["!rows"][m].ods=u;var f=x["!rows"][m].hpx+"px";l.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),l.push(`  </style:style>
`),++u}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(o,d){var u=[An],x=eu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=eu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});d.bookType=="fods"?(u.push("<office:document"+x+m+`>
`),u.push(ok().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+x+`>
`),s(u,o),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)u.push(r(o.Sheets[o.SheetNames[f]],o,f));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),d.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}})();function vT(e,n){if(n.bookType=="fods")return o2(e,n);var a=jg(),r="",s=[],l=[];return r="mimetype",gt(a,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",gt(a,r,o2(e,n)),s.push([r,"text/xml"]),l.push([r,"ContentFile"]),r="styles.xml",gt(a,r,oH(e,n)),s.push([r,"text/xml"]),l.push([r,"StylesFile"]),r="meta.xml",gt(a,r,An+ok()),s.push([r,"text/xml"]),l.push([r,"MetadataFile"]),r="manifest.rdf",gt(a,r,M8(l)),s.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",gt(a,r,I8(s)),a}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ho(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Fp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Qt(ul(e))}function cH(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):dr(ws(e))}function dH(e,n){e:for(var a=0;a<=e.length-n.length;++a){for(var r=0;r<n.length;++r)if(e[a+r]!=n[r])continue e;return!0}return!1}function ll(e){var n=e.reduce(function(s,l){return s+l.length},0),a=new Uint8Array(n),r=0;return e.forEach(function(s){a.set(s,r),r+=s.length}),a}function c2(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function uH(e,n){for(var a=(e[n+15]&127)<<7|e[n+14]>>1,r=e[n+14]&1,s=n+13;s>=n;--s)r=r*256+e[s];return(e[n+15]&128?-r:r)*Math.pow(10,a-6176)}function hH(e,n,a){var r=Math.floor(a==0?0:Math.LOG10E*Math.log(Math.abs(a)))+6176-20,s=a/Math.pow(10,r-6176);e[n+15]|=r>>7,e[n+14]|=(r&127)<<1;for(var l=0;s>=1;++l,s/=256)e[n+l]=s&255;e[n+15]|=a>=0?0:128}function ou(e,n){var a=n?n[0]:0,r=e[a]&127;e:if(e[a++]>=128&&(r|=(e[a]&127)<<7,e[a++]<128||(r|=(e[a]&127)<<14,e[a++]<128)||(r|=(e[a]&127)<<21,e[a++]<128)||(r+=(e[a]&127)*Math.pow(2,28),++a,e[a++]<128)||(r+=(e[a]&127)*Math.pow(2,35),++a,e[a++]<128)||(r+=(e[a]&127)*Math.pow(2,42),++a,e[a++]<128)))break e;return n&&(n[0]=a),r}function $t(e){var n=new Uint8Array(7);n[0]=e&127;var a=1;e:if(e>127){if(n[a-1]|=128,n[a]=e>>7&127,++a,e<=16383||(n[a-1]|=128,n[a]=e>>14&127,++a,e<=2097151)||(n[a-1]|=128,n[a]=e>>21&127,++a,e<=268435455)||(n[a-1]|=128,n[a]=e/256>>>21&127,++a,e<=34359738367)||(n[a-1]|=128,n[a]=e/65536>>>21&127,++a,e<=4398046511103))break e;n[a-1]|=128,n[a]=e/16777216>>>21&127,++a}return n.slice(0,a)}function wn(e){var n=0,a=e[n]&127;e:if(e[n++]>=128){if(a|=(e[n]&127)<<7,e[n++]<128||(a|=(e[n]&127)<<14,e[n++]<128)||(a|=(e[n]&127)<<21,e[n++]<128))break e;a|=(e[n]&127)<<28}return a}function It(e){for(var n=[],a=[0];a[0]<e.length;){var r=a[0],s=ou(e,a),l=s&7;s=Math.floor(s/8);var o=0,d;if(s==0)break;switch(l){case 0:{for(var u=a[0];e[a[0]++]>=128;);d=e.slice(u,a[0])}break;case 5:o=4,d=e.slice(a[0],a[0]+o),a[0]+=o;break;case 1:o=8,d=e.slice(a[0],a[0]+o),a[0]+=o;break;case 2:o=ou(e,a),d=e.slice(a[0],a[0]+o),a[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(s," at offset ").concat(r))}var x={data:d,type:l};n[s]==null?n[s]=[x]:n[s].push(x)}return n}function la(e){var n=[];return e.forEach(function(a,r){a.forEach(function(s){s.data&&(n.push($t(r*8+s.type)),s.type==2&&n.push($t(s.data.length)),n.push(s.data))})}),ll(n)}function Qg(e,n){return(e==null?void 0:e.map(function(a){return n(a.data)}))||[]}function kr(e){for(var n,a=[],r=[0];r[0]<e.length;){var s=ou(e,r),l=It(e.slice(r[0],r[0]+s));r[0]+=s;var o={id:wn(l[1][0].data),messages:[]};l[2].forEach(function(d){var u=It(d.data),x=wn(u[3][0].data);o.messages.push({meta:u,data:e.slice(r[0],r[0]+x)}),r[0]+=x}),(n=l[3])!=null&&n[0]&&(o.merge=wn(l[3][0].data)>>>0>0),a.push(o)}return a}function Zo(e){var n=[];return e.forEach(function(a){var r=[];r[1]=[{data:$t(a.id),type:0}],r[2]=[],a.merge!=null&&(r[3]=[{data:$t(+!!a.merge),type:0}]);var s=[];a.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:$t(o.data.length)}],r[2].push({data:la(o.meta),type:2})});var l=la(r);n.push($t(l.length)),n.push(l),s.forEach(function(o){return n.push(o)})}),ll(n)}function xH(e,n){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var a=[0],r=ou(n,a),s=[];a[0]<n.length;){var l=n[a[0]]&3;if(l==0){var o=n[a[0]++]>>2;if(o<60)++o;else{var d=o-59;o=n[a[0]],d>1&&(o|=n[a[0]+1]<<8),d>2&&(o|=n[a[0]+2]<<16),d>3&&(o|=n[a[0]+3]<<24),o>>>=0,o++,a[0]+=d}s.push(n.slice(a[0],a[0]+o)),a[0]+=o;continue}else{var u=0,x=0;if(l==1?(x=(n[a[0]]>>2&7)+4,u=(n[a[0]++]&224)<<3,u|=n[a[0]++]):(x=(n[a[0]++]>>2)+1,l==2?(u=n[a[0]]|n[a[0]+1]<<8,a[0]+=2):(u=(n[a[0]]|n[a[0]+1]<<8|n[a[0]+2]<<16|n[a[0]+3]<<24)>>>0,a[0]+=4)),s=[ll(s)],u==0)throw new Error("Invalid offset 0");if(u>s[0].length)throw new Error("Invalid offset beyond length");if(x>=u)for(s.push(s[0].slice(-u)),x-=u;x>=s[s.length-1].length;)s.push(s[s.length-1]),x-=s[s.length-1].length;s.push(s[0].slice(-u,-u+x))}}var m=ll(s);if(m.length!=r)throw new Error("Unexpected length: ".concat(m.length," != ").concat(r));return m}function Tr(e){for(var n=[],a=0;a<e.length;){var r=e[a++],s=e[a]|e[a+1]<<8|e[a+2]<<16;a+=3,n.push(xH(r,e.slice(a,a+s))),a+=s}if(a!==e.length)throw new Error("data is not a valid framed stream!");return ll(n)}function ec(e){for(var n=[],a=0;a<e.length;){var r=Math.min(e.length-a,268435455),s=new Uint8Array(4);n.push(s);var l=$t(r),o=l.length;n.push(l),r<=60?(o++,n.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,n.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,n.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,n.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,n.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),n.push(e.slice(a,a+r)),o+=r,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,a+=r}return ll(n)}function mH(e,n,a,r){var s=ho(e),l=s.getUint32(4,!0),o=(r>1?12:8)+c2(l&(r>1?3470:398))*4,d=-1,u=-1,x=NaN,m=new Date(2001,0,1);l&512&&(d=s.getUint32(o,!0),o+=4),o+=c2(l&(r>1?12288:4096))*4,l&16&&(u=s.getUint32(o,!0),o+=4),l&32&&(x=s.getFloat64(o,!0),o+=8),l&64&&(m.setTime(m.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:x};break;case 3:f={t:"s",v:n[u]};break;case 5:f={t:"d",v:m};break;case 6:f={t:"b",v:x>0};break;case 7:f={t:"n",v:x/86400};break;case 8:f={t:"e",v:0};break;case 9:if(d>-1)f={t:"s",v:a[d]};else if(u>-1)f={t:"s",v:n[u]};else if(!isNaN(x))f={t:"n",v:x};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function fH(e,n,a){var r=ho(e),s=r.getUint32(8,!0),l=12,o=-1,d=-1,u=NaN,x=NaN,m=new Date(2001,0,1);s&1&&(u=uH(e,l),l+=16),s&2&&(x=r.getFloat64(l,!0),l+=8),s&4&&(m.setTime(m.getTime()+r.getFloat64(l,!0)*1e3),l+=8),s&8&&(d=r.getUint32(l,!0),l+=4),s&16&&(o=r.getUint32(l,!0),l+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:n[d]};break;case 5:f={t:"d",v:m};break;case 6:f={t:"b",v:x>0};break;case 7:f={t:"n",v:x/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:a[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function Af(e,n){var a=new Uint8Array(32),r=ho(a),s=12,l=0;switch(a[0]=5,e.t){case"n":a[1]=2,hH(a,s,e.v),l|=1,s+=16;break;case"b":a[1]=6,r.setFloat64(s,e.v?1:0,!0),l|=2,s+=8;break;case"s":if(n.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));a[1]=3,r.setUint32(s,n.indexOf(e.v),!0),l|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,l,!0),a.slice(0,s)}function Ff(e,n){var a=new Uint8Array(32),r=ho(a),s=12,l=0;switch(a[0]=3,e.t){case"n":a[2]=2,r.setFloat64(s,e.v,!0),l|=32,s+=8;break;case"b":a[2]=6,r.setFloat64(s,e.v?1:0,!0),l|=32,s+=8;break;case"s":if(n.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));a[2]=3,r.setUint32(s,n.indexOf(e.v),!0),l|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,l,!0),a.slice(0,s)}function pH(e,n,a){switch(e[0]){case 0:case 1:case 2:case 3:return mH(e,n,a,e[0]);case 5:return fH(e,n,a);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function va(e){var n=It(e);return ou(n[1][0].data)}function d2(e,n){var a=It(n.data),r=wn(a[1][0].data),s=a[3],l=[];return(s||[]).forEach(function(o){var d=It(o.data),u=wn(d[1][0].data)>>>0;switch(r){case 1:l[u]=Fp(d[3][0].data);break;case 8:{var x=e[va(d[9][0].data)][0],m=It(x.data),f=e[va(m[1][0].data)][0],p=wn(f.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var b=It(f.data);l[u]=b[3].map(function(g){return Fp(g.data)}).join("")}break}}),l}function gH(e,n){var a,r,s,l,o,d,u,x,m,f,p,b,g,y,N=It(e),k=wn(N[1][0].data)>>>0,T=wn(N[2][0].data)>>>0,S=((r=(a=N[8])==null?void 0:a[0])==null?void 0:r.data)&&wn(N[8][0].data)>0||!1,w,_;if((l=(s=N[7])==null?void 0:s[0])!=null&&l.data&&n!=0)w=(d=(o=N[7])==null?void 0:o[0])==null?void 0:d.data,_=(x=(u=N[6])==null?void 0:u[0])==null?void 0:x.data;else if((f=(m=N[4])==null?void 0:m[0])!=null&&f.data&&n!=1)w=(b=(p=N[4])==null?void 0:p[0])==null?void 0:b.data,_=(y=(g=N[3])==null?void 0:g[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var L=S?4:1,C=ho(w),P=[],F=0;F<w.length/2;++F){var H=C.getUint16(F*2,!0);H<65535&&P.push([F,H])}if(P.length!=T)throw"Expected ".concat(T," cells, found ").concat(P.length);var O=[];for(F=0;F<P.length-1;++F)O[P[F][0]]=_.subarray(P[F][1]*L,P[F+1][1]*L);return P.length>=1&&(O[P[P.length-1][0]]=_.subarray(P[P.length-1][1]*L)),{R:k,cells:O}}function yH(e,n){var a,r=It(n.data),s=(a=r==null?void 0:r[7])!=null&&a[0]?wn(r[7][0].data)>>>0>0?1:0:-1,l=Qg(r[5],function(o){return gH(o,s)});return{nrows:wn(r[4][0].data)>>>0,data:l.reduce(function(o,d){return o[d.R]||(o[d.R]=[]),d.cells.forEach(function(u,x){if(o[d.R][x])throw new Error("Duplicate cell r=".concat(d.R," c=").concat(x));o[d.R][x]=u}),o},[])}}function vH(e,n,a){var r,s=It(n.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(wn(s[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(l.e.c=(wn(s[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));a["!ref"]=pt(l);var o=It(s[4][0].data),d=d2(e,e[va(o[4][0].data)][0]),u=(r=o[17])!=null&&r[0]?d2(e,e[va(o[17][0].data)][0]):[],x=It(o[3][0].data),m=0;x[1].forEach(function(f){var p=It(f.data),b=e[va(p[2][0].data)][0],g=wn(b.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var y=yH(e,b);y.data.forEach(function(N,k){N.forEach(function(T,S){var w=dt({r:m+k,c:S}),_=pH(T,d,u);_&&(a[w]=_)})}),m+=y.nrows})}function bH(e,n){var a=It(n.data),r={"!ref":"A1"},s=e[va(a[2][0].data)],l=wn(s[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return vH(e,s[0],r),r}function NH(e,n){var a,r=It(n.data),s={name:(a=r[1])!=null&&a[0]?Fp(r[1][0].data):"",sheets:[]},l=Qg(r[2],va);return l.forEach(function(o){e[o].forEach(function(d){var u=wn(d.meta[1][0].data);u==6e3&&s.sheets.push(bH(e,d))})}),s}function jH(e,n){var a=ny(),r=It(n.data),s=Qg(r[1],va);if(s.forEach(function(l){e[l].forEach(function(o){var d=wn(o.meta[1][0].data);if(d==2){var u=NH(e,o);u.sheets.forEach(function(x,m){ay(a,x,m==0?u.name:u.name+"_"+m,!0)})}})}),a.SheetNames.length==0)throw new Error("Empty NUMBERS file");return a}function Lf(e){var n,a,r,s,l={},o=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var x;try{x=Tr(u.content)}catch(f){return console.log("?? "+u.content.length+" "+(f.message||f))}var m;try{m=kr(x)}catch(f){return console.log("## "+(f.message||f))}m.forEach(function(f){l[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var d=((s=(r=(a=(n=l==null?void 0:l[1])==null?void 0:n[0])==null?void 0:a.meta)==null?void 0:r[1])==null?void 0:s[0].data)&&wn(l[1][0].meta[1][0].data)==1&&l[1][0];if(d||o.forEach(function(u){l[u].forEach(function(x){var m=wn(x.meta[1][0].data)>>>0;if(m==1)if(!d)d=x;else throw new Error("Document has multiple roots")})}),!d)throw new Error("Cannot find Document root");return jH(l,d)}function wH(e,n,a){var r,s,l,o;if(!((r=e[6])!=null&&r[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var d=((o=(l=e[8])==null?void 0:l[0])==null?void 0:o.data)&&wn(e[8][0].data)>0||!1;if(d)throw"Math only works with normal offsets";for(var u=0,x=ho(e[7][0].data),m=0,f=[],p=ho(e[4][0].data),b=0,g=[],y=0;y<n.length;++y){if(n[y]==null){x.setUint16(y*2,65535,!0),p.setUint16(y*2,65535);continue}x.setUint16(y*2,m,!0),p.setUint16(y*2,b,!0);var N,k;switch(typeof n[y]){case"string":N=Af({t:"s",v:n[y]},a),k=Ff({t:"s",v:n[y]},a);break;case"number":N=Af({t:"n",v:n[y]},a),k=Ff({t:"n",v:n[y]},a);break;case"boolean":N=Af({t:"b",v:n[y]},a),k=Ff({t:"b",v:n[y]},a);break;default:throw new Error("Unsupported value "+n[y])}f.push(N),m+=N.length,g.push(k),b+=k.length,++u}for(e[2][0].data=$t(u);y<e[7][0].data.length/2;++y)x.setUint16(y*2,65535,!0),p.setUint16(y*2,65535,!0);return e[6][0].data=ll(f),e[3][0].data=ll(g),u}function kH(e,n){if(!n||!n.numbers)throw new Error("Must pass a `numbers` option -- check the README");var a=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=nr(a["!ref"]);r.s.r=r.s.c=0;var s=!1;r.e.c>9&&(s=!0,r.e.c=9),r.e.r>49&&(s=!0,r.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(pt(r)));var l=R0(a,{range:r,header:1}),o=["~Sh33tJ5~"];l.forEach(function(M){return M.forEach(function(I){typeof I=="string"&&o.push(I)})});var d={},u=[],x=at.read(n.numbers,{type:"base64"});x.FileIndex.map(function(M,I){return[M,x.FullPaths[I]]}).forEach(function(M){var I=M[0],V=M[1];if(I.type==2&&I.name.match(/\.iwa/)){var J=I.content,ge=Tr(J),z=kr(ge);z.forEach(function(le){u.push(le.id),d[le.id]={deps:[],location:V,type:wn(le.messages[0].meta[1][0].data)}})}}),u.sort(function(M,I){return M-I});var m=u.filter(function(M){return M>1}).map(function(M){return[M,$t(M)]});x.FileIndex.map(function(M,I){return[M,x.FullPaths[I]]}).forEach(function(M){var I=M[0];if(M[1],!!I.name.match(/\.iwa/)){var V=kr(Tr(I.content));V.forEach(function(J){J.messages.forEach(function(ge){m.forEach(function(z){J.messages.some(function(le){return wn(le.meta[1][0].data)!=11006&&dH(le.data,z[1])})&&d[z[0]].deps.push(J.id)})})})}});for(var f=at.find(x,d[1].location),p=kr(Tr(f.content)),b,g=0;g<p.length;++g){var y=p[g];y.id==1&&(b=y)}var N=va(It(b.messages[0].data)[1][0].data);for(f=at.find(x,d[N].location),p=kr(Tr(f.content)),g=0;g<p.length;++g)y=p[g],y.id==N&&(b=y);for(N=va(It(b.messages[0].data)[2][0].data),f=at.find(x,d[N].location),p=kr(Tr(f.content)),g=0;g<p.length;++g)y=p[g],y.id==N&&(b=y);for(N=va(It(b.messages[0].data)[2][0].data),f=at.find(x,d[N].location),p=kr(Tr(f.content)),g=0;g<p.length;++g)y=p[g],y.id==N&&(b=y);var k=It(b.messages[0].data);{k[6][0].data=$t(r.e.r+1),k[7][0].data=$t(r.e.c+1);var T=va(k[46][0].data),S=at.find(x,d[T].location),w=kr(Tr(S.content));{for(var _=0;_<w.length&&w[_].id!=T;++_);if(w[_].id!=T)throw"Bad ColumnRowUIDMapArchive";var L=It(w[_].messages[0].data);L[1]=[],L[2]=[],L[3]=[];for(var C=0;C<=r.e.c;++C){var P=[];P[1]=P[2]=[{type:0,data:$t(C+420690)}],L[1].push({type:2,data:la(P)}),L[2].push({type:0,data:$t(C)}),L[3].push({type:0,data:$t(C)})}L[4]=[],L[5]=[],L[6]=[];for(var F=0;F<=r.e.r;++F)P=[],P[1]=P[2]=[{type:0,data:$t(F+726270)}],L[4].push({type:2,data:la(P)}),L[5].push({type:0,data:$t(F)}),L[6].push({type:0,data:$t(F)});w[_].messages[0].data=la(L)}S.content=ec(Zo(w)),S.size=S.content.length,delete k[46];var H=It(k[4][0].data);{H[7][0].data=$t(r.e.r+1);var O=It(H[1][0].data),B=va(O[2][0].data);S=at.find(x,d[B].location),w=kr(Tr(S.content));{if(w[0].id!=B)throw"Bad HeaderStorageBucket";var W=It(w[0].messages[0].data);for(F=0;F<l.length;++F){var ee=It(W[2][0].data);ee[1][0].data=$t(F),ee[4][0].data=$t(l[F].length),W[2][F]={type:W[2][0].type,data:la(ee)}}w[0].messages[0].data=la(W)}S.content=ec(Zo(w)),S.size=S.content.length;var q=va(H[2][0].data);S=at.find(x,d[q].location),w=kr(Tr(S.content));{if(w[0].id!=q)throw"Bad HeaderStorageBucket";for(W=It(w[0].messages[0].data),C=0;C<=r.e.c;++C)ee=It(W[2][0].data),ee[1][0].data=$t(C),ee[4][0].data=$t(r.e.r+1),W[2][C]={type:W[2][0].type,data:la(ee)};w[0].messages[0].data=la(W)}S.content=ec(Zo(w)),S.size=S.content.length;var fe=va(H[4][0].data);(function(){for(var M=at.find(x,d[fe].location),I=kr(Tr(M.content)),V,J=0;J<I.length;++J){var ge=I[J];ge.id==fe&&(V=ge)}var z=It(V.messages[0].data);{z[3]=[];var le=[];o.forEach(function(R,pe){le[1]=[{type:0,data:$t(pe)}],le[2]=[{type:0,data:$t(1)}],le[3]=[{type:2,data:cH(R)}],z[3].push({type:2,data:la(le)})})}V.messages[0].data=la(z);var ue=Zo(I),ce=ec(ue);M.content=ce,M.size=M.content.length})();var ne=It(H[3][0].data);{var Y=ne[1][0];delete ne[2];var X=It(Y.data);{var xe=va(X[2][0].data);(function(){for(var M=at.find(x,d[xe].location),I=kr(Tr(M.content)),V,J=0;J<I.length;++J){var ge=I[J];ge.id==xe&&(V=ge)}var z=It(V.messages[0].data);{delete z[6],delete ne[7];var le=new Uint8Array(z[5][0].data);z[5]=[];for(var ue=0,ce=0;ce<=r.e.r;++ce){var R=It(le);ue+=wH(R,l[ce],o),R[1][0].data=$t(ce),z[5].push({data:la(R),type:2})}z[1]=[{type:0,data:$t(r.e.c+1)}],z[2]=[{type:0,data:$t(r.e.r+1)}],z[3]=[{type:0,data:$t(ue)}],z[4]=[{type:0,data:$t(r.e.r+1)}]}V.messages[0].data=la(z);var pe=Zo(I),Oe=ec(pe);M.content=Oe,M.size=M.content.length})()}Y.data=la(X)}H[3][0].data=la(ne)}k[4][0].data=la(H)}b.messages[0].data=la(k);var K=Zo(p),A=ec(K);return f.content=A,f.size=f.content.length,x}function bT(e){return function(a){for(var r=0;r!=e.length;++r){var s=e[r];a[s[0]]===void 0&&(a[s[0]]=s[1]),s[2]==="n"&&(a[s[0]]=Number(a[s[0]]))}}}function Yg(e){bT([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Jg(e){bT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function TH(e){return jt.WS.indexOf(e)>-1?"sheet":e==jt.CS?"chart":e==jt.DS?"dialog":e==jt.MS?"macro":e&&e.length?e:"sheet"}function CH(e,n){if(!e)return 0;try{e=n.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,TH(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function SH(e,n,a,r,s,l,o,d,u,x,m,f){try{l[r]=Hd(ur(e,a,!0),n);var p=In(e,n),b;switch(d){case"sheet":b=XB(p,n,s,u,l[r],x,m,f);break;case"chart":if(b=QB(p,n,s,u,l[r],x,m,f),!b||!b["!drawel"])break;var g=Ld(b["!drawel"].Target,n),y=nu(g),N=OO(ur(e,g,!0),Hd(ur(e,y,!0),g)),k=Ld(N,g),T=nu(k);b=wB(ur(e,k,!0),k,u,Hd(ur(e,T,!0),k),x,b);break;case"macro":b=YB(p,n,s,u,l[r],x,m,f);break;case"dialog":b=JB(p,n,s,u,l[r],x,m,f);break;default:throw new Error("Unrecognized sheet type "+d)}o[r]=b;var S=[];l&&l[r]&&kn(l[r]).forEach(function(w){var _="";if(l[r][w].Type==jt.CMNT){_=Ld(l[r][w].Target,n);var L=n9(In(e,_,!0),_,u);if(!L||!L.length)return;XN(b,L,!1)}l[r][w].Type==jt.TCMNT&&(_=Ld(l[r][w].Target,n),S=S.concat(RO(In(e,_,!0),u)))}),S&&S.length&&XN(b,S,!0,u.people||[])}catch(w){if(u.WTF)throw w}}function jr(e){return e.charAt(0)=="/"?e.slice(1):e}function NT(e,n){if(Ic(),n=n||{},Yg(n),Cr(e,"META-INF/manifest.xml")||Cr(e,"objectdata.xml"))return i2(e,n);if(Cr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Lf<"u"){if(e.FileIndex)return Lf(e);var a=at.utils.cfb_new();return pN(e).forEach(function(ee){gt(a,ee,BF(e,ee))}),Lf(a)}throw new Error("Unsupported NUMBERS file")}if(!Cr(e,"[Content_Types].xml"))throw Cr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Cr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=pN(e),s=F8(ur(e,"[Content_Types].xml")),l=!1,o,d;if(s.workbooks.length===0&&(d="xl/workbook.xml",In(e,d,!0)&&s.workbooks.push(d)),s.workbooks.length===0){if(d="xl/workbook.bin",!In(e,d,!0))throw new Error("Could not find workbook");s.workbooks.push(d),l=!0}s.workbooks[0].slice(-3)=="bin"&&(l=!0);var u={},x={};if(!n.bookSheets&&!n.bookProps){if(Vd=[],s.sst)try{Vd=t9(In(e,jr(s.sst)),s.sst,n)}catch(ee){if(n.WTF)throw ee}n.cellStyles&&s.themes.length&&(u=e9(ur(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],n)),s.style&&(x=ZB(In(e,jr(s.style)),s.style,u,n))}s.links.map(function(ee){try{var q=Hd(ur(e,nu(jr(ee))),ee);return r9(In(e,jr(ee)),q,ee,n)}catch{}});var m=WB(In(e,jr(s.workbooks[0])),s.workbooks[0],n),f={},p="";s.coreprops.length&&(p=In(e,jr(s.coreprops[0]),!0),p&&(f=ck(p)),s.extprops.length!==0&&(p=In(e,jr(s.extprops[0]),!0),p&&B8(p,f,n)));var b={};(!n.bookSheets||n.bookProps)&&s.custprops.length!==0&&(p=ur(e,jr(s.custprops[0]),!0),p&&(b=V8(p,n)));var g={};if((n.bookSheets||n.bookProps)&&(m.Sheets?o=m.Sheets.map(function(q){return q.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),n.bookProps&&(g.Props=f,g.Custprops=b),n.bookSheets&&typeof o<"u"&&(g.SheetNames=o),n.bookSheets?g.SheetNames:n.bookProps))return g;o={};var y={};n.bookDeps&&s.calcchain&&(y=a9(In(e,jr(s.calcchain)),s.calcchain));var N=0,k={},T,S;{var w=m.Sheets;f.Worksheets=w.length,f.SheetNames=[];for(var _=0;_!=w.length;++_)f.SheetNames[_]=w[_].name}var L=l?"bin":"xml",C=s.workbooks[0].lastIndexOf("/"),P=(s.workbooks[0].slice(0,C+1)+"_rels/"+s.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");Cr(e,P)||(P="xl/_rels/workbook."+L+".rels");var F=Hd(ur(e,P,!0),P.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(n.xlmeta=s9(In(e,jr(s.metadata[0])),s.metadata[0],n)),(s.people||[]).length>=1&&(n.people=HO(In(e,jr(s.people[0])),n)),F&&(F=CH(F,m.Sheets));var H=In(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(N=0;N!=f.Worksheets;++N){var O="sheet";if(F&&F[N]?(T="xl/"+F[N][1].replace(/[\/]?xl\//,""),Cr(e,T)||(T=F[N][1]),Cr(e,T)||(T=P.replace(/_rels\/.*$/,"")+F[N][1]),O=F[N][2]):(T="xl/worksheets/sheet"+(N+1-H)+"."+L,T=T.replace(/sheet0\./,"sheet.")),S=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(N!=n.sheets)continue e;break;case"string":if(f.SheetNames[N].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var B=!1,W=0;W!=n.sheets.length;++W)typeof n.sheets[W]=="number"&&n.sheets[W]==N&&(B=1),typeof n.sheets[W]=="string"&&n.sheets[W].toLowerCase()==f.SheetNames[N].toLowerCase()&&(B=1);if(!B)continue e}}SH(e,T,S,f.SheetNames[N],N,k,o,O,n,m,u,x)}return g={Directory:s,Workbook:m,Props:f,Custprops:b,Deps:y,Sheets:o,SheetNames:f.SheetNames,Strings:Vd,Styles:x,Themes:u,SSF:hn(ct)},n&&n.bookFiles&&(e.files?(g.keys=r,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(ee,q){ee=ee.replace(/^Root Entry[\/]/,""),g.keys.push(ee),g.files[ee]=e.FileIndex[q]}))),n&&n.bookVBA&&(s.vba.length>0?g.vbaraw=In(e,jr(s.vba[0]),!0):s.defaults&&s.defaults.bin===WO&&(g.vbaraw=In(e,"xl/vbaProject.bin",!0))),g}function _H(e,n){var a=n||{},r="Workbook",s=at.find(e,r);try{if(r="/!DataSpaces/Version",s=at.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(sI(s.content),r="/!DataSpaces/DataSpaceMap",s=at.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=lI(s.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=at.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=oI(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=at.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);dI(s.content)}catch{}if(r="/EncryptionInfo",s=at.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var d=uI(s.content);if(r="/EncryptedPackage",s=at.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(d[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(d[1],s.content,a.password||"",a);if(d[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(d[1],s.content,a.password||"",a);throw new Error("File is password-protected")}function EH(e,n){return n.bookType=="ods"?vT(e,n):n.bookType=="numbers"?kH(e,n):n.bookType=="xlsb"?DH(e,n):AH(e,n)}function DH(e,n){rc=1024,e&&!e.SSF&&(e.SSF=hn(ct)),e&&e.SSF&&(Ic(),ax(e.SSF),n.revssf=sx(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Ud?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var a=n.bookType=="xlsb"?"bin":"xml",r=Wk.indexOf(n.bookType)>-1,s=Og();Jg(n=n||{});var l=jg(),o="",d=0;if(n.cellXfs=[],xl(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",gt(l,o,dk(e.Props,n)),s.coreprops.push(o),Gt(n.rels,2,o,jt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],x=0;x<e.SheetNames.length;++x)(e.Workbook.Sheets[x]||{}).Hidden!=2&&u.push(e.SheetNames[x]);e.Props.SheetNames=u}for(e.Props.Worksheets=e.Props.SheetNames.length,gt(l,o,xk(e.Props)),s.extprops.push(o),Gt(n.rels,3,o,jt.EXT_PROPS),e.Custprops!==e.Props&&kn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",gt(l,o,mk(e.Custprops)),s.custprops.push(o),Gt(n.rels,4,o,jt.CUST_PROPS)),d=1;d<=e.SheetNames.length;++d){var m={"!id":{}},f=e.Sheets[e.SheetNames[d-1]],p=(f||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+d+"."+a,gt(l,o,l9(d-1,o,n,e,m)),s.sheets.push(o),Gt(n.wbrels,-1,"worksheets/sheet"+d+"."+a,jt.WS[0])}if(f){var b=f["!comments"],g=!1,y="";b&&b.length>0&&(y="xl/comments"+d+"."+a,gt(l,y,d9(b,y)),s.comments.push(y),Gt(m,-1,"../comments"+d+"."+a,jt.CMNT),g=!0),f["!legacy"]&&g&&gt(l,"xl/drawings/vmlDrawing"+d+".vml",Gk(d,f["!comments"])),delete f["!comments"],delete f["!legacy"]}m["!id"].rId1&&gt(l,nu(o),ic(m))}return n.Strings!=null&&n.Strings.length>0&&(o="xl/sharedStrings."+a,gt(l,o,c9(n.Strings,o,n)),s.strs.push(o),Gt(n.wbrels,-1,"sharedStrings."+a,jt.SST)),o="xl/workbook."+a,gt(l,o,i9(e,o)),s.workbooks.push(o),Gt(n.rels,1,o,jt.WB),o="xl/theme/theme1.xml",gt(l,o,Ug(e.Themes,n)),s.themes.push(o),Gt(n.wbrels,-1,"theme/theme1.xml",jt.THEME),o="xl/styles."+a,gt(l,o,o9(e,o,n)),s.styles.push(o),Gt(n.wbrels,-1,"styles."+a,jt.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",gt(l,o,e.vbaraw),s.vba.push(o),Gt(n.wbrels,-1,"vbaProject.bin",jt.VBA)),o="xl/metadata."+a,gt(l,o,u9(o)),s.metadata.push(o),Gt(n.wbrels,-1,"metadata."+a,jt.XLMETA),gt(l,"[Content_Types].xml",lk(s,n)),gt(l,"_rels/.rels",ic(n.rels)),gt(l,"xl/_rels/workbook."+a+".rels",ic(n.wbrels)),delete n.revssf,delete n.ssf,l}function AH(e,n){rc=1024,e&&!e.SSF&&(e.SSF=hn(ct)),e&&e.SSF&&(Ic(),ax(e.SSF),n.revssf=sx(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Ud?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var a="xml",r=Wk.indexOf(n.bookType)>-1,s=Og();Jg(n=n||{});var l=jg(),o="",d=0;if(n.cellXfs=[],xl(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",gt(l,o,dk(e.Props,n)),s.coreprops.push(o),Gt(n.rels,2,o,jt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],x=0;x<e.SheetNames.length;++x)(e.Workbook.Sheets[x]||{}).Hidden!=2&&u.push(e.SheetNames[x]);e.Props.SheetNames=u}e.Props.Worksheets=e.Props.SheetNames.length,gt(l,o,xk(e.Props)),s.extprops.push(o),Gt(n.rels,3,o,jt.EXT_PROPS),e.Custprops!==e.Props&&kn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",gt(l,o,mk(e.Custprops)),s.custprops.push(o),Gt(n.rels,4,o,jt.CUST_PROPS));var m=["SheetJ5"];for(n.tcid=0,d=1;d<=e.SheetNames.length;++d){var f={"!id":{}},p=e.Sheets[e.SheetNames[d-1]],b=(p||{})["!type"]||"sheet";switch(b){case"chart":default:o="xl/worksheets/sheet"+d+"."+a,gt(l,o,sT(d-1,n,e,f)),s.sheets.push(o),Gt(n.wbrels,-1,"worksheets/sheet"+d+"."+a,jt.WS[0])}if(p){var g=p["!comments"],y=!1,N="";if(g&&g.length>0){var k=!1;g.forEach(function(T){T[1].forEach(function(S){S.T==!0&&(k=!0)})}),k&&(N="xl/threadedComments/threadedComment"+d+"."+a,gt(l,N,BO(g,m,n)),s.threadedcomments.push(N),Gt(f,-1,"../threadedComments/threadedComment"+d+"."+a,jt.TCMNT)),N="xl/comments"+d+"."+a,gt(l,N,qk(g)),s.comments.push(N),Gt(f,-1,"../comments"+d+"."+a,jt.CMNT),y=!0}p["!legacy"]&&y&&gt(l,"xl/drawings/vmlDrawing"+d+".vml",Gk(d,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&gt(l,nu(o),ic(f))}return n.Strings!=null&&n.Strings.length>0&&(o="xl/sharedStrings."+a,gt(l,o,Pk(n.Strings,n)),s.strs.push(o),Gt(n.wbrels,-1,"sharedStrings."+a,jt.SST)),o="xl/workbook."+a,gt(l,o,dT(e)),s.workbooks.push(o),Gt(n.rels,1,o,jt.WB),o="xl/theme/theme1.xml",gt(l,o,Ug(e.Themes,n)),s.themes.push(o),Gt(n.wbrels,-1,"theme/theme1.xml",jt.THEME),o="xl/styles."+a,gt(l,o,Uk(e,n)),s.styles.push(o),Gt(n.wbrels,-1,"styles."+a,jt.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",gt(l,o,e.vbaraw),s.vba.push(o),Gt(n.wbrels,-1,"vbaProject.bin",jt.VBA)),o="xl/metadata."+a,gt(l,o,$k()),s.metadata.push(o),Gt(n.wbrels,-1,"metadata."+a,jt.XLMETA),m.length>1&&(o="xl/persons/person.xml",gt(l,o,VO(m)),s.people.push(o),Gt(n.wbrels,-1,"persons/person.xml",jt.PEOPLE)),gt(l,"[Content_Types].xml",lk(s,n)),gt(l,"_rels/.rels",ic(n.rels)),gt(l,"xl/_rels/workbook."+a+".rels",ic(n.wbrels)),delete n.revssf,delete n.ssf,l}function Zg(e,n){var a="";switch((n||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":a=xr(e.slice(0,12));break;case"binary":a=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3),a.charCodeAt(4),a.charCodeAt(5),a.charCodeAt(6),a.charCodeAt(7)]}function FH(e,n){return at.find(e,"EncryptedPackage")?_H(e,n):Xg(e,n)}function LH(e,n){var a,r=e,s=n||{};return s.type||(s.type=bt&&Buffer.isBuffer(e)?"buffer":"base64"),a=Ow(r,s),NT(a,s)}function jT(e,n){var a=0;e:for(;a<e.length;)switch(e.charCodeAt(a)){case 10:case 13:case 32:++a;break;case 60:return Dp(e.slice(a),n);default:break e}return Sc.to_workbook(e,n)}function PH(e,n){var a="",r=Zg(e,n);switch(n.type){case"base64":a=xr(e);break;case"binary":a=e;break;case"buffer":a=e.toString("binary");break;case"array":a=lo(e);break;default:throw new Error("Unrecognized type "+n.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(a=Qt(a)),n.type="binary",jT(a,n)}function IH(e,n){var a=e;return n.type=="base64"&&(a=xr(a)),a=Qd.utils.decode(1200,a.slice(2),"str"),n.type="binary",jT(a,n)}function OH(e){return e.match(/[^\x00-\x7F]/)?ws(e):e}function Pf(e,n,a,r){return r?(a.type="string",Sc.to_workbook(e,a)):Sc.to_workbook(n,a)}function Lp(e,n){gg();var a=n||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Lp(new Uint8Array(e),(a=hn(a),a.type="array",a));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!a.type&&(a.type=typeof Deno<"u"?"buffer":"array");var r=e,s=[0,0,0,0],l=!1;if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),oc={},a.dateNF&&(oc.dateNF=a.dateNF),a.type||(a.type=bt&&Buffer.isBuffer(e)?"buffer":"base64"),a.type=="file"&&(a.type=bt?"buffer":"binary",r=AF(e),typeof Uint8Array<"u"&&!bt&&(a.type="array")),a.type=="string"&&(l=!0,a.type="binary",a.codepage=65001,r=OH(e)),a.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),d=new Uint8Array(o);if(d.foo="bar",!d.foo)return a=hn(a),a.type="array",Lp(yg(r),a)}switch((s=Zg(r,a))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return FH(at.read(r,a),a);break;case 9:if(s[1]<=8)return Xg(r,a);break;case 60:return Dp(r,a);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return UP(r,a);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return Fk.to_workbook(r,a);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?LH(r,a):Pf(e,r,a,l);case 239:return s[3]===60?Dp(r,a):Pf(e,r,a,l);case 255:if(s[1]===254)return IH(r,a);if(s[1]===0&&s[2]===2&&s[3]===0)return eo.to_workbook(r,a);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return eo.to_workbook(r,a);break;case 3:case 131:case 139:case 140:return Ep.to_workbook(r,a);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return Bk.to_workbook(r,a);break;case 10:case 13:case 32:return PH(r,a);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return VP.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Ep.to_workbook(r,a):Pf(e,r,a,l)}function wT(e,n){switch(n.type){case"base64":case"binary":break;case"buffer":case"array":n.type="";break;case"file":return ju(n.file,at.write(e,{type:bt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");default:throw new Error("Unrecognized type "+n.type)}return at.write(e,n)}function MH(e,n){var a=hn(n||{}),r=EH(e,a);return RH(r,a)}function RH(e,n){var a={},r=bt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(n.compression&&(a.compression="DEFLATE"),n.password)a.type=r;else switch(n.type){case"base64":a.type="base64";break;case"binary":a.type="string";break;case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");case"buffer":case"file":a.type=r;break;default:throw new Error("Unrecognized type "+n.type)}var s=e.FullPaths?at.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[a.type]||a.type,compression:!!n.compression}):e.generate(a);if(typeof Deno<"u"&&typeof s=="string"){if(n.type=="binary"||n.type=="base64")return s;s=new Uint8Array(nx(s))}return n.password&&typeof encrypt_agile<"u"?wT(encrypt_agile(s,n.password),n):n.type==="file"?ju(n.file,s):n.type=="string"?Qt(s):s}function BH(e,n){var a=n||{},r=M9(e,a);return wT(r,a)}function ms(e,n,a){a||(a="");var r=a+e;switch(n.type){case"base64":return Yd(ws(r));case"binary":return ws(r);case"string":return e;case"file":return ju(n.file,r,"utf8");case"buffer":return bt?ci(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):ms(r,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function HH(e,n){switch(n.type){case"base64":return Yd(e);case"binary":return e;case"string":return e;case"file":return ju(n.file,e,"binary");case"buffer":return bt?ci(e,"binary"):e.split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function a0(e,n){switch(n.type){case"string":case"base64":case"binary":for(var a="",r=0;r<e.length;++r)a+=String.fromCharCode(e[r]);return n.type=="base64"?Yd(a):n.type=="string"?Qt(a):a;case"file":return ju(n.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+n.type)}}function ey(e,n){gg(),LB(e);var a=hn(n||{});if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),a.type=="array"){a.type="binary";var r=ey(e,a);return a.type="array",nx(r)}var s=0;if(a.sheet&&(typeof a.sheet=="number"?s=a.sheet:s=e.SheetNames.indexOf(a.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+a.sheet+" : "+typeof a.sheet);switch(a.bookType||"xlsb"){case"xml":case"xlml":return ms(D9(e,a),a);case"slk":case"sylk":return ms(Ak.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"htm":case"html":return ms(fT(e.Sheets[e.SheetNames[s]],a),a);case"txt":return HH(kT(e.Sheets[e.SheetNames[s]],a),a);case"csv":return ms(ty(e.Sheets[e.SheetNames[s]],a),a,"\uFEFF");case"dif":return ms(Fk.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"dbf":return a0(Ep.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"prn":return ms(Sc.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"rtf":return ms(Bk.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"eth":return ms(Lk.from_sheet(e.Sheets[e.SheetNames[s]],a),a);case"fods":return ms(vT(e,a),a);case"wk1":return a0(eo.sheet_to_wk1(e.Sheets[e.SheetNames[s]],a),a);case"wk3":return a0(eo.book_to_wk3(e,a),a);case"biff2":a.biff||(a.biff=2);case"biff3":a.biff||(a.biff=3);case"biff4":return a.biff||(a.biff=4),a0(mT(e,a),a);case"biff5":a.biff||(a.biff=5);case"biff8":case"xla":case"xls":return a.biff||(a.biff=8),BH(e,a);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return MH(e,a);default:throw new Error("Unrecognized bookType |"+a.bookType+"|")}}function VH(e){if(!e.bookType){var n={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},a=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();a.match(/^\.[a-z]+$/)&&(e.bookType=a.slice(1)),e.bookType=n[e.bookType]||e.bookType}}function M0(e,n,a){var r={};return r.type="file",r.file=n,VH(r),ey(e,r)}function UH(e,n,a,r,s,l,o,d){var u=Dn(a),x=d.defval,m=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),f=!0,p=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:a,enumerable:!1})}catch{p.__rowNum__=a}else p.__rowNum__=a;if(!o||e[a])for(var b=n.s.c;b<=n.e.c;++b){var g=o?e[a][b]:e[r[b]+u];if(g===void 0||g.t===void 0){if(x===void 0)continue;l[b]!=null&&(p[l[b]]=x);continue}var y=g.v;switch(g.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(l[b]!=null){if(y==null)if(g.t=="e"&&y===null)p[l[b]]=null;else if(x!==void 0)p[l[b]]=x;else if(m&&y===null)p[l[b]]=null;else continue;else p[l[b]]=m&&(g.t!=="n"||g.t==="n"&&d.rawNumbers!==!1)?y:oi(g,y,d);y!=null&&(f=!1)}}return{row:p,isempty:f}}function R0(e,n){if(e==null||e["!ref"]==null)return[];var a={t:"n",v:0},r=0,s=1,l=[],o=0,d="",u={s:{r:0,c:0},e:{r:0,c:0}},x=n||{},m=x.range!=null?x.range:e["!ref"];switch(x.header===1?r=1:x.header==="A"?r=2:Array.isArray(x.header)?r=3:x.header==null&&(r=0),typeof m){case"string":u=Ft(m);break;case"number":u=Ft(e["!ref"]),u.s.r=m;break;default:u=m}r>0&&(s=0);var f=Dn(u.s.r),p=[],b=[],g=0,y=0,N=Array.isArray(e),k=u.s.r,T=0,S={};N&&!e[k]&&(e[k]=[]);var w=x.skipHidden&&e["!cols"]||[],_=x.skipHidden&&e["!rows"]||[];for(T=u.s.c;T<=u.e.c;++T)if(!(w[T]||{}).hidden)switch(p[T]=yn(T),a=N?e[k][T]:e[p[T]+f],r){case 1:l[T]=T-u.s.c;break;case 2:l[T]=p[T];break;case 3:l[T]=x.header[T-u.s.c];break;default:if(a==null&&(a={w:"__EMPTY",t:"s"}),d=o=oi(a,null,x),y=S[o]||0,!y)S[o]=1;else{do d=o+"_"+y++;while(S[d]);S[o]=y,S[d]=1}l[T]=d}for(k=u.s.r+s;k<=u.e.r;++k)if(!(_[k]||{}).hidden){var L=UH(e,u,k,p,r,l,N,x);(L.isempty===!1||(r===1?x.blankrows!==!1:x.blankrows))&&(b[g++]=L.row)}return b.length=g,b}var u2=/"/g;function KH(e,n,a,r,s,l,o,d){for(var u=!0,x=[],m="",f=Dn(a),p=n.s.c;p<=n.e.c;++p)if(r[p]){var b=d.dense?(e[a]||[])[p]:e[r[p]+f];if(b==null)m="";else if(b.v!=null){u=!1,m=""+(d.rawNumbers&&b.t=="n"?b.v:oi(b,null,d));for(var g=0,y=0;g!==m.length;++g)if((y=m.charCodeAt(g))===s||y===l||y===34||d.forceQuotes){m='"'+m.replace(u2,'""')+'"';break}m=="ID"&&(m='"ID"')}else b.f!=null&&!b.F?(u=!1,m="="+b.f,m.indexOf(",")>=0&&(m='"'+m.replace(u2,'""')+'"')):m="";x.push(m)}return d.blankrows===!1&&u?null:x.join(o)}function ty(e,n){var a=[],r=n??{};if(e==null||e["!ref"]==null)return"";var s=Ft(e["!ref"]),l=r.FS!==void 0?r.FS:",",o=l.charCodeAt(0),d=r.RS!==void 0?r.RS:`
`,u=d.charCodeAt(0),x=new RegExp((l=="|"?"\\|":l)+"+$"),m="",f=[];r.dense=Array.isArray(e);for(var p=r.skipHidden&&e["!cols"]||[],b=r.skipHidden&&e["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(p[g]||{}).hidden||(f[g]=yn(g));for(var y=0,N=s.s.r;N<=s.e.r;++N)(b[N]||{}).hidden||(m=KH(e,s,N,f,o,u,l,r),m!=null&&(r.strip&&(m=m.replace(x,"")),(m||r.blankrows!==!1)&&a.push((y++?d:"")+m)));return delete r.dense,a.join("")}function kT(e,n){n||(n={}),n.FS="	",n.RS=`
`;var a=ty(e,n);return a}function zH(e){var n="",a,r="";if(e==null||e["!ref"]==null)return[];var s=Ft(e["!ref"]),l="",o=[],d,u=[],x=Array.isArray(e);for(d=s.s.c;d<=s.e.c;++d)o[d]=yn(d);for(var m=s.s.r;m<=s.e.r;++m)for(l=Dn(m),d=s.s.c;d<=s.e.c;++d)if(n=o[d]+l,a=x?(e[m]||[])[d]:e[n],r="",a!==void 0){if(a.F!=null){if(n=a.F,!a.f)continue;r=a.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(a.f!=null)r=a.f;else{if(a.t=="z")continue;if(a.t=="n"&&a.v!=null)r=""+a.v;else if(a.t=="b")r=a.v?"TRUE":"FALSE";else if(a.w!==void 0)r="'"+a.w;else{if(a.v===void 0)continue;a.t=="s"?r="'"+a.v:r=""+a.v}}u[u.length]=n+"="+r}return u}function TT(e,n,a){var r=a||{},s=+!r.skipHeader,l=e||{},o=0,d=0;if(l&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var u=typeof r.origin=="string"?vn(r.origin):r.origin;o=u.r,d=u.c}var x,m={s:{c:0,r:0},e:{c:d,r:o+n.length-1+s}};if(l["!ref"]){var f=Ft(l["!ref"]);m.e.c=Math.max(m.e.c,f.e.c),m.e.r=Math.max(m.e.r,f.e.r),o==-1&&(o=f.e.r+1,m.e.r=o+n.length-1+s)}else o==-1&&(o=0,m.e.r=n.length-1+s);var p=r.header||[],b=0;n.forEach(function(y,N){kn(y).forEach(function(k){(b=p.indexOf(k))==-1&&(p[b=p.length]=k);var T=y[k],S="z",w="",_=dt({c:d+b,r:o+N+s});x=cu(l,_),T&&typeof T=="object"&&!(T instanceof Date)?l[_]=T:(typeof T=="number"?S="n":typeof T=="boolean"?S="b":typeof T=="string"?S="s":T instanceof Date?(S="d",r.cellDates||(S="n",T=Gn(T)),w=r.dateNF||ct[14]):T===null&&r.nullError&&(S="e",T=0),x?(x.t=S,x.v=T,delete x.w,delete x.R,w&&(x.z=w)):l[_]=x={t:S,v:T},w&&(x.z=w))})}),m.e.c=Math.max(m.e.c,d+p.length-1);var g=Dn(o);if(s)for(b=0;b<p.length;++b)l[yn(b+d)+g]={t:"s",v:p[b]};return l["!ref"]=pt(m),l}function $H(e,n){return TT(null,e,n)}function cu(e,n,a){if(typeof n=="string"){if(Array.isArray(e)){var r=vn(n);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[n]||(e[n]={t:"z"})}return typeof n!="number"?cu(e,dt(n)):cu(e,dt({r:n,c:a||0}))}function GH(e,n){if(typeof n=="number"){if(n>=0&&e.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var a=e.SheetNames.indexOf(n);if(a>-1)return a;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function ny(){return{SheetNames:[],Sheets:{}}}function ay(e,n,a,r){var s=1;if(!a)for(;s<=65535&&e.SheetNames.indexOf(a="Sheet"+s)!=-1;++s,a=void 0);if(!a||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(a)>=0){var l=a.match(/(^.*?)(\d+)$/);s=l&&+l[2]||0;var o=l&&l[1]||a;for(++s;s<=65535&&e.SheetNames.indexOf(a=o+s)!=-1;++s);}if(cT(a),e.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");return e.SheetNames.push(a),e.Sheets[a]=n,a}function qH(e,n,a){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=GH(e,n);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}e.Workbook.Sheets[r].Hidden=a}function WH(e,n){return e.z=n,e}function CT(e,n,a){return n?(e.l={Target:n},a&&(e.l.Tooltip=a)):delete e.l,e}function XH(e,n,a){return CT(e,"#"+n,a)}function QH(e,n,a){e.c||(e.c=[]),e.c.push({t:n,a:a||"SheetJS"})}function YH(e,n,a,r){for(var s=typeof n!="string"?n:Ft(n),l=typeof n=="string"?n:pt(n),o=s.s.r;o<=s.e.r;++o)for(var d=s.s.c;d<=s.e.c;++d){var u=cu(e,o,d);u.t="n",u.F=l,delete u.v,o==s.s.r&&d==s.s.c&&(u.f=a,r&&(u.D=!0))}return e}var Yr={encode_col:yn,encode_row:Dn,encode_cell:dt,encode_range:pt,decode_col:Dg,decode_row:Eg,split_cell:c8,decode_cell:vn,decode_range:nr,format_cell:oi,sheet_add_aoa:ek,sheet_add_json:TT,sheet_add_dom:pT,aoa_to_sheet:Oc,json_to_sheet:$H,table_to_sheet:gT,table_to_book:sH,sheet_to_csv:ty,sheet_to_txt:kT,sheet_to_json:R0,sheet_to_html:fT,sheet_to_formulae:zH,sheet_to_row_object_array:R0,sheet_get_cell:cu,book_new:ny,book_append_sheet:ay,book_set_sheet_visibility:qH,cell_set_number_format:WH,cell_set_hyperlink:CT,cell_set_internal_link:XH,cell_add_comment:QH,sheet_set_array_formula:YH,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const ST=Object.freeze(Object.defineProperty({__proto__:null,CFB:at,parse_xlscfb:Xg,parse_zip:NT,read:Lp,utils:Yr,write:ey,writeFile:M0,writeFileSync:M0},Symbol.toStringTag,{value:"Module"})),JH="modulepreload",ZH=function(e){return"/"+e},h2={},_T=function(n,a,r){let s=Promise.resolve();if(a&&a.length>0){let o=function(x){return Promise.all(x.map(m=>Promise.resolve(m).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),u=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));s=o(a.map(x=>{if(x=ZH(x),x in h2)return;h2[x]=!0;const m=x.endsWith(".css"),f=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${f}`))return;const p=document.createElement("link");if(p.rel=m?"stylesheet":JH,m||(p.as="script"),p.crossOrigin="",p.href=x,u&&p.setAttribute("nonce",u),document.head.appendChild(p),m)return new Promise((b,g)=>{p.addEventListener("load",b),p.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${x}`)))})}))}function l(o){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=o,window.dispatchEvent(d),!d.defaultPrevented)throw o}return s.then(o=>{for(const d of o||[])d.status==="rejected"&&l(d.reason);return n().catch(l)})},eV=async(e,n,a)=>(await he.post("/san-luong/chia-hang/preview",{rows:e,thang:n,nam:a})).data,tV=async(e,n,a)=>(await he.post("/san-luong/chia-hang/confirm",{rows:e,tenFile:n,fileHash:a})).data,nV=async(e,n,a)=>(await he.post("/san-luong/giao-hang/preview",{rows:e,thang:n,nam:a})).data,aV=async(e,n,a)=>(await he.post("/san-luong/giao-hang/confirm",{rows:e,tenFile:n,fileHash:a})).data,rV=async e=>{const n=await he.get("/san-luong/lich-su-import",{params:{loaiImport:e.loaiImport,tuNgay:e.tuNgay,denNgay:e.denNgay}}),a=Array.isArray(n.data)?n.data:[];let r=a;e.trangThai&&(r=a.filter(u=>u.trangThai===e.trangThai));const s=e.page||1,l=e.limit||20,o=(s-1)*l,d=o+l;return{items:r.slice(o,d),total:r.length}},sV=async e=>{const{read:n,utils:a}=await _T(async()=>{const{read:d,utils:u}=await Promise.resolve().then(()=>ST);return{read:d,utils:u}},void 0),r=await e.arrayBuffer(),s=n(r,{type:"array"}),l=s.Sheets[s.SheetNames[0]];return a.sheet_to_json(l).map(d=>({maNhanVien:String(d["M NV"]||d.MaNhanVien||d.maNhanVien||""),ngay:ET(d.Ngy||d.ngay),sanPhamDat:Number(d["SP t"]||d.sanPhamDat||0),sanPhamLoi:Number(d["SP Li"]||d.sanPhamLoi||0),tongSanPham:Number(d["Tng SP"]||d.tongSanPham||0)}))},iV=async e=>{const{read:n,utils:a}=await _T(async()=>{const{read:d,utils:u}=await Promise.resolve().then(()=>ST);return{read:d,utils:u}},void 0),r=await e.arrayBuffer(),s=n(r,{type:"array"}),l=s.Sheets[s.SheetNames[0]];return a.sheet_to_json(l).map(d=>({maNhanVien:String(d["M NV"]||d.MaNhanVien||d.maNhanVien||""),ngay:ET(d.Ngy||d.ngay),khoiLuong:Number(d["Khi lng"]||d.khoiLuong||0),donGia:Number(d["n gi"]||d.donGia||0),phatTre:Number(d["Pht tr"]||d.phatTre||0),phatKhongLayPhieu:Number(d["Pht KL phiu"]||d.phatKhongLayPhieu||0)}))};function ET(e){if(!e)return"";if(typeof e=="number")return new Date((e-25569)*86400*1e3).toISOString().split("T")[0];if(typeof e=="string"){const n=e.split("/");if(n.length===3){const[a,r,s]=n;return`${s}-${r.padStart(2,"0")}-${a.padStart(2,"0")}`}if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e}return String(e)}const DT=async e=>{const n=await e.arrayBuffer(),a=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(a)).map(s=>s.toString(16).padStart(2,"0")).join("")},lV=()=>{const[e,n]=E.useState(null),[a,r]=E.useState([]),[s,l]=E.useState(null),[o,d]=E.useState(!1),[u,x]=E.useState(!1),[m,f]=E.useState(new Date().getMonth()+1),[p,b]=E.useState(new Date().getFullYear()),g=()=>{const L=[{"M NV":"NV001",Ngy:"01/01/2026","SP t":100,"SP Li":2,"Tng SP":102},{"M NV":"NV001",Ngy:"02/01/2026","SP t":95,"SP Li":1,"Tng SP":96},{"M NV":"NV002",Ngy:"01/01/2026","SP t":120,"SP Li":3,"Tng SP":123},{"M NV":"NV002",Ngy:"02/01/2026","SP t":110,"SP Li":0,"Tng SP":110}],C=Yr.json_to_sheet(L);C["!cols"]=[{wch:10},{wch:12},{wch:10},{wch:10},{wch:10}];const P=Yr.book_new();Yr.book_append_sheet(P,C,"Chia Hng");const F=[{Ct:"M NV","M t":"M nhn vin (bt buc)","V d":"NV001"},{Ct:"Ngy","M t":"Ngy lm vic (dd/MM/yyyy)","V d":"01/01/2026"},{Ct:"SP t","M t":"S sn phm t chun","V d":"100"},{Ct:"SP Li","M t":"S sn phm li","V d":"2"},{Ct:"Tng SP","M t":"Tng sn phm","V d":"102"},{Ct:"","M t":"","V d":""},{Ct:"Cng thc","M t":"Quy i SP = SP t - (SP Li  5)","V d":""},{Ct:"","M t":"Tin sn lng = Quy i SP  320","V d":""}],H=Yr.json_to_sheet(F);H["!cols"]=[{wch:12},{wch:40},{wch:15}],Yr.book_append_sheet(P,H,"Hng dn"),M0(P,`Template_ChiaHang_${m}_${p}.xlsx`),vt.success(" ti template mu")},y=E.useCallback(async L=>{const C=L[0];if(C){n(C),d(!0),l(null);try{const P=await sV(C);r(P),vt.success(` c ${P.length} dng t file`)}catch(P){vt.error("Li c file Excel"),console.error(P)}finally{d(!1)}}},[]),{getRootProps:N,getInputProps:k,isDragActive:T}=mg({onDrop:y,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"]},multiple:!1}),S=async()=>{var L,C;if(a.length===0){vt.error("Cha c d liu  preview");return}d(!0);try{const P=await eV(a,m,p);l(P),P.tongKhongHopLe>0?vt.error(`C ${P.tongKhongHopLe} dng khng hp l`):vt.success(`${P.tongHopLe} dng hp l, sn sng import`)}catch(P){const F=P;vt.error(((C=(L=F.response)==null?void 0:L.data)==null?void 0:C.message)||"Li preview")}finally{d(!1)}},w=async()=>{var L,C;if(!(!s||!e)){if(s.hopLe.length===0){vt.error("Khng c d liu hp l  import");return}x(!0);try{const P=await DT(e),F=await tV(s.hopLe,e.name,P);vt.success(`Import thnh cng! Thm mi: ${F.inserted}, Cp nht: ${F.updated}`),n(null),r([]),l(null)}catch(P){const F=P;vt.error(((C=(L=F.response)==null?void 0:L.data)==null?void 0:C.message)||"Li import")}finally{x(!1)}}},_=()=>{n(null),r([]),l(null)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Import Sn Lng Chia Hng"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:g,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Ti Template Mu"]}),(e||a.length>0)&&t.jsx("button",{onClick:_,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Reset"})]})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow flex gap-4 items-center",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thng"}),t.jsx("select",{value:m,onChange:L=>f(Number(L.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:12},(L,C)=>t.jsxs("option",{value:C+1,children:["Thng ",C+1]},C+1))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nm"}),t.jsx("select",{value:p,onChange:L=>b(Number(L.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:5},(L,C)=>new Date().getFullYear()-2+C).map(L=>t.jsx("option",{value:L,children:L},L))})]})]}),t.jsxs("div",{...N(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${T?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,children:[t.jsx("input",{...k()}),t.jsxs("div",{className:"text-gray-600",children:[t.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),T?t.jsx("p",{className:"text-blue-600",children:"Th file vo y..."}):t.jsxs(t.Fragment,{children:[t.jsx("p",{children:"Ko th file Excel vo y, hoc click  chn file"}),t.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"H tr: .xlsx, .xls"})]})]})]}),e&&t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsxs("p",{className:"text-blue-800",children:[t.jsx("strong",{children:"File:"})," ",e.name," (",(e.size/1024).toFixed(1)," KB)"]}),t.jsxs("p",{className:"text-blue-600 text-sm mt-1",children:[" c ",a.length," dng d liu"]})]}),a.length>0&&!s&&t.jsx("button",{onClick:S,disabled:o,className:"w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2",children:o?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang x l..."]}):"Preview d liu"}),s&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[t.jsx("p",{className:"text-green-800 font-semibold text-lg",children:s.tongHopLe}),t.jsx("p",{className:"text-green-600 text-sm",children:"Dng hp l"})]}),t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[t.jsx("p",{className:"text-red-800 font-semibold text-lg",children:s.tongKhongHopLe}),t.jsx("p",{className:"text-red-600 text-sm",children:"Dng khng hp l"})]})]}),s.hopLe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-green-50 border-b border-green-200",children:t.jsxs("h3",{className:"font-semibold text-green-800",children:["D liu hp l (",s.hopLe.length,")"]})}),t.jsxs("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:[t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"SP t"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"SP Li"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Tng SP"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:s.hopLe.slice(0,100).map((L,C)=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-2 text-sm",children:L.maNhanVien}),t.jsx("td",{className:"px-4 py-2 text-sm",children:L.ngay}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:L.sanPhamDat}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:L.sanPhamLoi}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:L.tongSanPham})]},C))})]}),s.hopLe.length>100&&t.jsxs("p",{className:"text-center text-gray-500 py-2",children:["... v ",s.hopLe.length-100," dng na"]})]})]}),s.khongHopLe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-red-50 border-b border-red-200",children:t.jsxs("h3",{className:"font-semibold text-red-800",children:["D liu khng hp l (",s.khongHopLe.length,")"]})}),t.jsx("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"L do"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:s.khongHopLe.map((L,C)=>t.jsxs("tr",{className:"bg-red-50",children:[t.jsx("td",{className:"px-4 py-2 text-sm",children:L.row.maNhanVien}),t.jsx("td",{className:"px-4 py-2 text-sm",children:L.row.ngay}),t.jsx("td",{className:"px-4 py-2 text-sm text-red-600",children:L.lyDo})]},C))})]})})]}),s.hopLe.length>0&&t.jsxs("div",{className:"flex gap-4",children:[t.jsx("button",{onClick:S,disabled:o,className:"flex-1 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 disabled:opacity-50",children:"Preview li"}),t.jsx("button",{onClick:w,disabled:u,className:"flex-1 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center justify-center gap-2",children:u?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang import..."]}):`Import ${s.hopLe.length} dng`})]})]}),t.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[t.jsx("h3",{className:"font-semibold text-yellow-800 mb-2",children:"Hng dn"}),t.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1 list-disc list-inside",children:[t.jsx("li",{children:"File Excel cn c cc ct: M NV, Ngy, SP t, SP Li, Tng SP"}),t.jsx("li",{children:"Ngy c th  nh dng dd/MM/yyyy hoc yyyy-MM-dd"}),t.jsx("li",{children:"Nu d liu  tn ti (cng m NV + ngy) s c cp nht"}),t.jsxs("li",{children:["Cng thc: ",t.jsx("strong",{children:"Quy i SP = SP t - (SP Li  5)"}),", ",t.jsx("strong",{children:"Tin = Quy i  320"})]})]})]})]})},oV=()=>{const[e,n]=E.useState(null),[a,r]=E.useState([]),[s,l]=E.useState(null),[o,d]=E.useState(!1),[u,x]=E.useState(!1),[m,f]=E.useState(new Date().getMonth()+1),[p,b]=E.useState(new Date().getFullYear()),g=()=>{const C=[{"M NV":"NV001",Ngy:"01/01/2026","Khi lng":50,"n gi":5e3,"Pht tr":0,"Pht KL phiu":0},{"M NV":"NV001",Ngy:"02/01/2026","Khi lng":45,"n gi":5e3,"Pht tr":1e4,"Pht KL phiu":0},{"M NV":"NV002",Ngy:"01/01/2026","Khi lng":60,"n gi":5500,"Pht tr":0,"Pht KL phiu":5e3},{"M NV":"NV002",Ngy:"02/01/2026","Khi lng":55,"n gi":5500,"Pht tr":0,"Pht KL phiu":0}],P=Yr.json_to_sheet(C);P["!cols"]=[{wch:10},{wch:12},{wch:12},{wch:12},{wch:12},{wch:15}];const F=Yr.book_new();Yr.book_append_sheet(F,P,"Giao Hng");const H=[{Ct:"M NV","M t":"M nhn vin (bt buc)","V d":"NV001"},{Ct:"Ngy","M t":"Ngy lm vic (dd/MM/yyyy)","V d":"01/01/2026"},{Ct:"Khi lng","M t":"Khi lng giao hng (kg)","V d":"50"},{Ct:"n gi","M t":"n gi theo kg (VN)","V d":"5000"},{Ct:"Pht tr","M t":"Tin pht giao tr (VN)","V d":"10000"},{Ct:"Pht KL phiu","M t":"Pht khng ly phiu (VN)","V d":"5000"},{Ct:"","M t":"","V d":""},{Ct:"Cng thc","M t":"Tin = Khi lng  n gi - Pht tr - Pht KL phiu","V d":""}],O=Yr.json_to_sheet(H);O["!cols"]=[{wch:15},{wch:50},{wch:15}],Yr.book_append_sheet(F,O,"Hng dn"),M0(F,`Template_GiaoHang_${m}_${p}.xlsx`),vt.success(" ti template mu")},y=E.useCallback(async C=>{const P=C[0];if(P){n(P),d(!0),l(null);try{const F=await iV(P);r(F),vt.success(` c ${F.length} dng t file`)}catch(F){vt.error("Li c file Excel"),console.error(F)}finally{d(!1)}}},[]),{getRootProps:N,getInputProps:k,isDragActive:T}=mg({onDrop:y,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"]},multiple:!1}),S=async()=>{var C,P;if(a.length===0){vt.error("Cha c d liu  preview");return}d(!0);try{const F=await nV(a,m,p);l(F),F.tongKhongHopLe>0?vt.error(`C ${F.tongKhongHopLe} dng khng hp l`):vt.success(`${F.tongHopLe} dng hp l, sn sng import`)}catch(F){const H=F;vt.error(((P=(C=H.response)==null?void 0:C.data)==null?void 0:P.message)||"Li preview")}finally{d(!1)}},w=async()=>{var C,P;if(!(!s||!e)){if(s.hopLe.length===0){vt.error("Khng c d liu hp l  import");return}x(!0);try{const F=await DT(e),H=await aV(s.hopLe,e.name,F);vt.success(`Import thnh cng! Thm mi: ${H.inserted}, Cp nht: ${H.updated}`),n(null),r([]),l(null)}catch(F){const H=F;vt.error(((P=(C=H.response)==null?void 0:C.data)==null?void 0:P.message)||"Li import")}finally{x(!1)}}},_=()=>{n(null),r([]),l(null)},L=C=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(C);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Import Sn Lng Giao Hng"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:g,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Ti Template Mu"]}),(e||a.length>0)&&t.jsx("button",{onClick:_,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Reset"})]})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow flex gap-4 items-center",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thng"}),t.jsx("select",{value:m,onChange:C=>f(Number(C.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:12},(C,P)=>t.jsxs("option",{value:P+1,children:["Thng ",P+1]},P+1))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nm"}),t.jsx("select",{value:p,onChange:C=>b(Number(C.target.value)),className:"border rounded-lg px-3 py-2",children:Array.from({length:5},(C,P)=>new Date().getFullYear()-2+P).map(C=>t.jsx("option",{value:C,children:C},C))})]})]}),t.jsxs("div",{...N(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${T?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,children:[t.jsx("input",{...k()}),t.jsxs("div",{className:"text-gray-600",children:[t.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),T?t.jsx("p",{className:"text-blue-600",children:"Th file vo y..."}):t.jsxs(t.Fragment,{children:[t.jsx("p",{children:"Ko th file Excel vo y, hoc click  chn file"}),t.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"H tr: .xlsx, .xls"})]})]})]}),e&&t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsxs("p",{className:"text-blue-800",children:[t.jsx("strong",{children:"File:"})," ",e.name," (",(e.size/1024).toFixed(1)," KB)"]}),t.jsxs("p",{className:"text-blue-600 text-sm mt-1",children:[" c ",a.length," dng d liu"]})]}),a.length>0&&!s&&t.jsx("button",{onClick:S,disabled:o,className:"w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2",children:o?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang x l..."]}):"Preview d liu"}),s&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[t.jsx("p",{className:"text-green-800 font-semibold text-lg",children:s.tongHopLe}),t.jsx("p",{className:"text-green-600 text-sm",children:"Dng hp l"})]}),t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[t.jsx("p",{className:"text-red-800 font-semibold text-lg",children:s.tongKhongHopLe}),t.jsx("p",{className:"text-red-600 text-sm",children:"Dng khng hp l"})]})]}),s.hopLe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-green-50 border-b border-green-200",children:t.jsxs("h3",{className:"font-semibold text-green-800",children:["D liu hp l (",s.hopLe.length,")"]})}),t.jsxs("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:[t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Khi lng"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"n gi"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Pht tr"}),t.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Pht KLP"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:s.hopLe.slice(0,100).map((C,P)=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-2 text-sm",children:C.maNhanVien}),t.jsx("td",{className:"px-4 py-2 text-sm",children:C.ngay}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:C.khoiLuong}),t.jsx("td",{className:"px-4 py-2 text-sm text-right",children:L(C.donGia)}),t.jsx("td",{className:"px-4 py-2 text-sm text-right text-red-600",children:L(C.phatTre)}),t.jsx("td",{className:"px-4 py-2 text-sm text-right text-red-600",children:L(C.phatKhongLayPhieu)})]},P))})]}),s.hopLe.length>100&&t.jsxs("p",{className:"text-center text-gray-500 py-2",children:["... v ",s.hopLe.length-100," dng na"]})]})]}),s.khongHopLe.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 bg-red-50 border-b border-red-200",children:t.jsxs("h3",{className:"font-semibold text-red-800",children:["D liu khng hp l (",s.khongHopLe.length,")"]})}),t.jsx("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"M NV"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"L do"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:s.khongHopLe.map((C,P)=>t.jsxs("tr",{className:"bg-red-50",children:[t.jsx("td",{className:"px-4 py-2 text-sm",children:C.row.maNhanVien}),t.jsx("td",{className:"px-4 py-2 text-sm",children:C.row.ngay}),t.jsx("td",{className:"px-4 py-2 text-sm text-red-600",children:C.lyDo})]},P))})]})})]}),s.hopLe.length>0&&t.jsxs("div",{className:"flex gap-4",children:[t.jsx("button",{onClick:S,disabled:o,className:"flex-1 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 disabled:opacity-50",children:"Preview li"}),t.jsx("button",{onClick:w,disabled:u,className:"flex-1 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center justify-center gap-2",children:u?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang import..."]}):`Import ${s.hopLe.length} dng`})]})]}),t.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[t.jsx("h3",{className:"font-semibold text-yellow-800 mb-2",children:"Hng dn"}),t.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1 list-disc list-inside",children:[t.jsx("li",{children:"File Excel cn c cc ct: M NV, Ngy, Khi lng, n gi, Pht tr, Pht KL phiu"}),t.jsx("li",{children:"Ngy c th  nh dng dd/MM/yyyy hoc yyyy-MM-dd"}),t.jsx("li",{children:"Nu d liu  tn ti (cng m NV + ngy) s c cp nht"}),t.jsxs("li",{children:["Cng thc: ",t.jsx("strong",{children:"Tin = Khi lng  n gi - Pht tr - Pht khng ly phiu"})]})]})]})]})},cV=()=>{const[e,n]=E.useState([]),[a,r]=E.useState(0),[s,l]=E.useState(!0),[o,d]=E.useState({loaiImport:void 0,trangThai:void 0,page:1,limit:20});E.useEffect(()=>{u()},[o]);const u=async()=>{var g,y;l(!0);try{const N=await rV(o);n(N.items),r(N.total)}catch(N){const k=N;vt.error(((y=(g=k.response)==null?void 0:g.data)==null?void 0:y.message)||"Li ti d liu")}finally{l(!1)}},x=g=>new Date(g).toLocaleString("vi-VN"),m=g=>{d(y=>({...y,loaiImport:g===""?void 0:g,page:1}))},f=g=>{d(y=>({...y,trangThai:g===""?void 0:g,page:1}))},p=g=>{d(y=>({...y,page:g}))},b=Math.ceil(a/(o.limit||20));return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Lch S Import Sn Lng"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(ca,{to:"/import-chia-hang",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Import Chia Hng"}),t.jsx(ca,{to:"/import-giao-hang",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Import Giao Hng"})]})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg shadow flex gap-4 items-center flex-wrap",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi"}),t.jsxs("select",{value:o.loaiImport||"",onChange:g=>m(g.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"CHIA_HANG",children:"Chia hng"}),t.jsx("option",{value:"GIAO_HANG",children:"Giao hng"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng thi"}),t.jsxs("select",{value:o.trangThai||"",onChange:g=>f(g.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"THANH_CONG",children:"Thnh cng"}),t.jsx("option",{value:"THAT_BAI",children:"Tht bi"})]})]}),t.jsx("div",{className:"ml-auto",children:t.jsx("button",{onClick:u,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Lm mi"})})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[s?t.jsxs("div",{className:"p-8 text-center",children:[t.jsxs("svg",{className:"animate-spin h-8 w-8 mx-auto text-blue-600",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),t.jsx("p",{className:"text-gray-500 mt-2",children:"ang ti..."})]}):e.length===0?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Khng c d liu"}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Loi"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tn file"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thi gian"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ngi import"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"S dng"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thnh cng"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tht bi"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trng thi"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(g=>{var y;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:g.id}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:t.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g.loaiImport==="CHIA_HANG"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:g.loaiImport==="CHIA_HANG"?"Chia hng":"Giao hng"})}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",title:g.tenFile,children:g.tenFile}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:x(g.importLuc)}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:((y=g.nguoiImport)==null?void 0:y.hoTen)||"N/A"}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-center",children:g.soDong}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-green-600 text-center font-medium",children:g.soDongHopLe}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-red-600 text-center font-medium",children:g.soDongLoi}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:t.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g.trangThai==="THANH_CONG"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.trangThai==="THANH_CONG"?"Thnh cng":"Tht bi"})})]},g.id)})})]})}),b>1&&t.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 flex items-center justify-between",children:[t.jsxs("div",{className:"text-sm text-gray-700",children:["Hin th ",t.jsx("span",{className:"font-medium",children:(o.page-1)*o.limit+1})," n"," ",t.jsx("span",{className:"font-medium",children:Math.min(o.page*o.limit,a)})," trong"," ",t.jsx("span",{className:"font-medium",children:a})," kt qu"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>p(o.page-1),disabled:o.page===1,className:"px-3 py-1 border rounded-md text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Trc"}),Array.from({length:Math.min(5,b)},(g,y)=>{let N;return b<=5||o.page<=3?N=y+1:o.page>=b-2?N=b-4+y:N=o.page-2+y,t.jsx("button",{onClick:()=>p(N),className:`px-3 py-1 border rounded-md text-sm ${N===o.page?"bg-blue-600 text-white border-blue-600":"hover:bg-gray-50"}`,children:N},N)}),t.jsx("button",{onClick:()=>p(o.page+1),disabled:o.page===b,className:"px-3 py-1 border rounded-md text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Sau"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Tng s ln import"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:a})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Import chia hng"}),t.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:e.filter(g=>g.loaiImport==="CHIA_HANG").length})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Import giao hng"}),t.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:e.filter(g=>g.loaiImport==="GIAO_HANG").length})]})]})]})};function dV(){var C,P;const[e,n]=E.useState("chia-hang"),[a,r]=E.useState(new Date().getMonth()+1),[s,l]=E.useState(new Date().getFullYear()),[o,d]=E.useState(1),[u,x]=E.useState(""),m=20,{data:f,isLoading:p}=Ie({queryKey:["san-luong","chia-hang",a,s,o,u],queryFn:async()=>(await he.get("/san-luong/chia-hang",{params:{thang:a,nam:s,page:o,limit:m,tuKhoa:u}})).data,enabled:e==="chia-hang"}),{data:b,isLoading:g}=Ie({queryKey:["san-luong","giao-hang",a,s,o,u],queryFn:async()=>(await he.get("/san-luong/giao-hang",{params:{thang:a,nam:s,page:o,limit:m,tuKhoa:u}})).data,enabled:e==="giao-hang"}),{data:y}=Ie({queryKey:["san-luong","thong-ke",e,a,s],queryFn:async()=>(await he.get(`/san-luong/${e}/thong-ke`,{params:{thang:a,nam:s}})).data}),N=e==="chia-hang"?f:b,k=e==="chia-hang"?p:g,T=Array.isArray(N)?N:(N==null?void 0:N.data)||[],S=((C=N==null?void 0:N.pagination)==null?void 0:C.total)||T.length,w=Math.ceil(S/m),_=async()=>{try{const F=await he.get(`/san-luong/${e}/export`,{params:{thang:a,nam:s},responseType:"blob"}),H=window.URL.createObjectURL(new Blob([F.data])),O=document.createElement("a");O.href=H,O.setAttribute("download",`san-luong-${e}-${a}-${s}.xlsx`),document.body.appendChild(O),O.click(),O.remove()}catch(F){console.error("Export error:",F)}},L=F=>(F==null?void 0:F.toLocaleString("vi-VN"))||"0";return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Tra cu Sn lng"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Xem chi tit sn lng Chia hng v Giao hng theo thng"})]}),t.jsxs("button",{onClick:_,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[t.jsx(bs,{size:18}),"Xut Excel"]})]}),t.jsxs("div",{className:"flex gap-2 border-b",children:[t.jsxs("button",{onClick:()=>{n("chia-hang"),d(1)},className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${e==="chia-hang"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(Jp,{size:20}),"Chia hng"]}),t.jsxs("button",{onClick:()=>{n("giao-hang"),d(1)},className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${e==="giao-hang"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx(eg,{size:20}),"Giao hng"]})]}),t.jsxs("div",{className:"flex flex-wrap gap-4 items-center bg-gray-50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(At,{size:18,className:"text-gray-400"}),t.jsx("select",{value:a,onChange:F=>{r(Number(F.target.value)),d(1)},className:"border rounded-lg px-3 py-2",children:Array.from({length:12},(F,H)=>t.jsxs("option",{value:H+1,children:["Thng ",H+1]},H+1))}),t.jsx("select",{value:s,onChange:F=>{l(Number(F.target.value)),d(1)},className:"border rounded-lg px-3 py-2",children:[2024,2025,2026].map(F=>t.jsx("option",{value:F,children:F},F))})]}),t.jsx("div",{className:"flex-1 min-w-[200px]",children:t.jsxs("div",{className:"relative",children:[t.jsx(Hr,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Tm theo m NV, tn...",value:u,onChange:F=>{x(F.target.value),d(1)},className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]})}),t.jsxs("div",{className:"text-sm text-gray-600",children:["Tng: ",t.jsx("span",{className:"font-semibold",children:L(S)})," bn ghi"]})]}),y&&t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:e==="chia-hang"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-blue-600",children:"Tng SP t"}),t.jsx("div",{className:"text-2xl font-bold text-blue-700",children:L(y.tongSpDat)})]}),t.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-red-600",children:"Tng SP li"}),t.jsx("div",{className:"text-2xl font-bold text-red-700",children:L(y.tongSpLoi)})]}),t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-green-600",children:"T l t"}),t.jsxs("div",{className:"text-2xl font-bold text-green-700",children:[((P=y.tyLeDat)==null?void 0:P.toFixed(1))||"0","%"]})]}),t.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-purple-600",children:"S NV"}),t.jsx("div",{className:"text-2xl font-bold text-purple-700",children:L(y.soNhanVien)})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-blue-600",children:"Tng KL (kg)"}),t.jsx("div",{className:"text-2xl font-bold text-blue-700",children:L(y.tongKhoiLuong)})]}),t.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-orange-600",children:"Tng tr gi"}),t.jsx("div",{className:"text-2xl font-bold text-orange-700",children:L(y.tongTreGio)})]}),t.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-red-600",children:"Khng ly phiu"}),t.jsx("div",{className:"text-2xl font-bold text-red-700",children:L(y.tongKhongLayPhieu)})]}),t.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-purple-600",children:"S NV"}),t.jsx("div",{className:"text-2xl font-bold text-purple-700",children:L(y.soNhanVien)})]})]})}),t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50 text-gray-600",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left",children:"Ngy"}),t.jsx("th",{className:"px-4 py-3 text-left",children:"M NV"}),t.jsx("th",{className:"px-4 py-3 text-left",children:"H tn"}),e==="chia-hang"?t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"px-4 py-3 text-right",children:"SP t"}),t.jsx("th",{className:"px-4 py-3 text-right",children:"SP li"}),t.jsx("th",{className:"px-4 py-3 text-right",children:"T l li"})]}):t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"px-4 py-3 text-right",children:"KL (kg)"}),t.jsx("th",{className:"px-4 py-3 text-right",children:"Tr gi"}),t.jsx("th",{className:"px-4 py-3 text-right",children:"Khng phiu"})]}),t.jsx("th",{className:"px-4 py-3 text-center",children:"Ngun"}),t.jsx("th",{className:"px-4 py-3 text-left",children:"Ghi ch"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-100",children:k?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"ang ti..."})}):T.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"Khng c d liu"})}):e==="chia-hang"?T.map(F=>{var H,O;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3",children:new Date(F.ngay).toLocaleDateString("vi-VN")}),t.jsx("td",{className:"px-4 py-3 font-medium",children:((H=F.nhanVien)==null?void 0:H.maNhanVien)||`NV${F.nhanVienId}`}),t.jsx("td",{className:"px-4 py-3",children:((O=F.nhanVien)==null?void 0:O.hoTen)||"-"}),t.jsx("td",{className:"px-4 py-3 text-right font-medium text-blue-600",children:L(F.soLuongSpDat)}),t.jsx("td",{className:"px-4 py-3 text-right text-red-600",children:L(F.soLuongSpLoi)}),t.jsx("td",{className:"px-4 py-3 text-right",children:F.soLuongSpDat>0?(F.soLuongSpLoi/F.soLuongSpDat*100).toFixed(1)+"%":"-"}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded text-xs ${F.nguonDuLieu==="IMPORT_EXCEL"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:F.nguonDuLieu==="IMPORT_EXCEL"?t.jsxs(t.Fragment,{children:[t.jsx(ua,{size:12})," Import"]}):"Nhp tay"})}),t.jsx("td",{className:"px-4 py-3 text-gray-500 max-w-[200px] truncate",children:F.ghiChu||"-"})]},F.id)}):T.map(F=>{var H,O;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3",children:new Date(F.ngay).toLocaleDateString("vi-VN")}),t.jsx("td",{className:"px-4 py-3 font-medium",children:((H=F.nhanVien)==null?void 0:H.maNhanVien)||`NV${F.nhanVienId}`}),t.jsx("td",{className:"px-4 py-3",children:((O=F.nhanVien)==null?void 0:O.hoTen)||"-"}),t.jsx("td",{className:"px-4 py-3 text-right font-medium text-blue-600",children:L(Number(F.khoiLuongThanhCong))}),t.jsx("td",{className:"px-4 py-3 text-right",children:F.soLanTreGio>0?t.jsxs("span",{className:"text-orange-600 flex items-center justify-end gap-1",children:[t.jsx(dl,{size:14})," ",F.soLanTreGio]}):t.jsx("span",{className:"text-green-600",children:"0"})}),t.jsx("td",{className:"px-4 py-3 text-right",children:F.soLanKhongLayPhieu>0?t.jsx("span",{className:"text-red-600",children:F.soLanKhongLayPhieu}):t.jsx("span",{className:"text-green-600",children:"0"})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded text-xs ${F.nguonDuLieu==="IMPORT_EXCEL"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:F.nguonDuLieu==="IMPORT_EXCEL"?t.jsxs(t.Fragment,{children:[t.jsx(ua,{size:12})," Import"]}):"Nhp tay"})}),t.jsx("td",{className:"px-4 py-3 text-gray-500 max-w-[200px] truncate",children:F.ghiChu||"-"})]},F.id)})})]})}),w>1&&t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t bg-gray-50",children:[t.jsxs("div",{className:"text-sm text-gray-600",children:["Trang ",o," / ",w]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>d(F=>Math.max(1,F-1)),disabled:o===1,className:"p-2 rounded border hover:bg-gray-100 disabled:opacity-50",children:t.jsx(fr,{size:18})}),t.jsx("button",{onClick:()=>d(F=>Math.min(w,F+1)),disabled:o>=w,className:"p-2 rounded border hover:bg-gray-100 disabled:opacity-50",children:t.jsx($n,{size:18})})]})]})]})]})}const uV=e=>{switch(e){case"NHAP":return"bg-yellow-100 text-yellow-800";case"DA_CHOT":return"bg-blue-100 text-blue-800";case"DA_KHOA":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},hV=e=>{switch(e){case"NHAP":return"Nhp";case"DA_CHOT":return" cht";case"DA_KHOA":return" kha";default:return e}};function xV(){const e=Bt(),{coVaiTro:n}=as(),a=n("ADMIN"),[r,s]=E.useState(!1),[l,o]=E.useState(()=>{const P=new Date;return`${P.getFullYear()}-${String(P.getMonth()+1).padStart(2,"0")}`}),[d,u]=E.useState(),[x,m]=E.useState({thangNam:l,tuNgay:"",denNgay:"",ngayChiTra:"",phongBanId:void 0,ghiChu:""}),f=P=>{const F=`${P}-01`,H=`${P}-15`;m({...x,thangNam:P,tuNgay:F,denNgay:H})},{data:p,isLoading:b}=Ie({queryKey:["bang-ung-luong",l,d],queryFn:()=>Xa.layDanhSach({thangNam:l,phongBanId:d})}),g=(p==null?void 0:p.data)||[],{data:y}=Ie({queryKey:["phong-ban"],queryFn:cn.layTatCa}),N=De({mutationFn:Xa.taoMoi,onSuccess:()=>{e.invalidateQueries({queryKey:["bang-ung-luong"]}),ie.success("To bng ng lng thnh cng!"),s(!1),m({thangNam:l,tuNgay:"",denNgay:"",ngayChiTra:"",phongBanId:void 0,ghiChu:""})},onError:P=>{var F,H;ie.error(((H=(F=P.response)==null?void 0:F.data)==null?void 0:H.message)||"C li xy ra")}}),k=De({mutationFn:({id:P,force:F})=>Xa.xoa(P,F),onSuccess:()=>{e.invalidateQueries({queryKey:["bang-ung-luong"]}),ie.success("Xa bng ng lng thnh cng!")},onError:P=>{var F,H;ie.error(((H=(F=P.response)==null?void 0:F.data)==null?void 0:H.message)||"C li xy ra")}}),T=De({mutationFn:Xa.chot,onSuccess:()=>{e.invalidateQueries({queryKey:["bang-ung-luong"]}),ie.success("Cht bng ng lng thnh cng!")},onError:P=>{var F,H;ie.error(((H=(F=P.response)==null?void 0:F.data)==null?void 0:H.message)||"C li xy ra")}}),S=De({mutationFn:Xa.khoa,onSuccess:()=>{e.invalidateQueries({queryKey:["bang-ung-luong"]}),ie.success("Kha bng ng lng thnh cng!")},onError:P=>{var F,H;ie.error(((H=(F=P.response)==null?void 0:F.data)==null?void 0:H.message)||"C li xy ra")}}),w=()=>{if(!x.tuNgay||!x.denNgay){ie.error("Vui lng nhp y  thng tin");return}N.mutate(x)},_=(P,F,H=!1)=>{if(F!=="NHAP"&&!H){ie.error("Ch c th xa bng ng lng ang  trng thi Nhp");return}confirm(H?" CNH BO: Bn ang xa cng ch bng ng lng  kha. Thao tc ny s c ghi li. Tip tc?":"Bn c chc mun xa bng ng lng ny?")&&k.mutate({id:P,force:H})},L=(P,F)=>{if(F!=="NHAP"){ie.error("Ch c th cht bng ng lng ang  trng thi Nhp");return}confirm("Bn c chc mun cht bng ng lng ny?")&&T.mutate(P)},C=(P,F)=>{if(F!=="DA_CHOT"){ie.error("Ch c th kha bng ng lng  cht");return}confirm("Bn c chc mun kha bng ng lng ny?")&&S.mutate(P)};return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[t.jsx(ng,{size:28}),"Qun l Bng ng lng"]}),t.jsxs("button",{onClick:()=>{f(l),s(!0)},className:"btn btn-primary",children:[t.jsx(St,{size:20}),"To bng ng lng"]})]}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Thng/Nm"}),t.jsx(kc,{value:l,onChange:o,className:"border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Phng ban"}),t.jsxs("select",{value:d||"",onChange:P=>u(P.target.value?Number(P.target.value):void 0),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),y==null?void 0:y.map(P=>t.jsx("option",{value:P.id,children:P.tenPhongBan},P.id))]})]})]})}),t.jsx("div",{className:"card",children:b?t.jsx("p",{className:"text-center py-8 text-gray-500",children:"ang ti..."}):g&&g.length>0?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b",children:[t.jsx("th",{className:"text-left py-3 px-4",children:"Phng ban"}),t.jsx("th",{className:"text-left py-3 px-4",children:"Thng/Nm"}),t.jsx("th",{className:"text-left py-3 px-4",children:"Ngy chi tr"}),t.jsx("th",{className:"text-right py-3 px-4",children:"S NV"}),t.jsx("th",{className:"text-right py-3 px-4",children:"Tng tin ng"}),t.jsx("th",{className:"text-center py-3 px-4",children:"Trng thi"}),t.jsx("th",{className:"text-center py-3 px-4",children:"Thao tc"})]})}),t.jsx("tbody",{children:g.map(P=>{var F,H;return t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4 font-medium",children:t.jsx(ca,{to:`/ung-luong/${P.id}`,className:"text-primary-600 hover:underline",children:((F=P.phongBan)==null?void 0:F.tenPhongBan)||"Tt c phng ban"})}),t.jsx("td",{className:"py-3 px-4",children:P.thangNam}),t.jsx("td",{className:"py-3 px-4",children:P.ngayChiTra?vs(P.ngayChiTra):"-"}),t.jsxs("td",{className:"py-3 px-4 text-right",children:[P.soNhanVienUng,"/",((H=P._count)==null?void 0:H.chiTiets)||0]}),t.jsx("td",{className:"py-3 px-4 text-right font-medium text-blue-600",children:et(P.tongSoTienUng)}),t.jsx("td",{className:"py-3 px-4 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded text-sm ${uV(P.trangThai)}`,children:hV(P.trangThai)})}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex justify-center gap-2",children:[P.trangThai==="NHAP"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>L(P.id,P.trangThai),className:"p-2 text-green-600 hover:bg-green-50 rounded",title:"Cht",children:t.jsx(Or,{size:18})}),t.jsx("button",{onClick:()=>_(P.id,P.trangThai),className:"p-2 text-red-600 hover:bg-red-50 rounded",title:"Xa",children:t.jsx(Rr,{size:18})})]}),P.trangThai==="DA_CHOT"&&t.jsx("button",{onClick:()=>C(P.id,P.trangThai),className:"p-2 text-orange-600 hover:bg-orange-50 rounded",title:"Kha",children:t.jsx(Js,{size:18})}),P.trangThai==="DA_KHOA"&&a&&t.jsx("button",{onClick:()=>_(P.id,P.trangThai,!0),className:"p-2 text-red-600 hover:bg-red-50 rounded",title:"[Admin] Xa cng ch",children:t.jsx(aa,{size:18})})]})})]},P.id)})})]})}):t.jsx("p",{className:"text-center py-8 text-gray-500",children:'Cha c bng ng lng no. Nhn "To bng ng lng"  bt u.'})}),r&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"To bng ng lng mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Thng/Nm ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(kc,{value:x.thangNam,onChange:f,className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["T ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ut,{value:x.tuNgay,onChange:P=>m({...x,tuNgay:P}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["n ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ut,{value:x.denNgay,onChange:P=>m({...x,denNgay:P}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy chi tr"}),t.jsx(Ut,{value:x.ngayChiTra,onChange:P=>m({...x,ngayChiTra:P}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:x.phongBanId||"",onChange:P=>m({...x,phongBanId:P.target.value?Number(P.target.value):void 0}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),y==null?void 0:y.map(P=>t.jsx("option",{value:P.id,children:P.tenPhongBan},P.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),t.jsx("textarea",{value:x.ghiChu,onChange:P=>m({...x,ghiChu:P.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:w,disabled:N.isPending,className:"btn btn-primary",children:N.isPending?"ang to...":"To bng ng lng"})]})]})})]})}const mV=e=>{switch(e){case"NGHI_QUA_NHIEU":return"Ngh qu nhiu ngy";case"NGHI_KHONG_PHEP":return"Ngh khng php";case"KHONG_HOAT_DONG":return"Khng hot ng";default:return e||""}};function fV(){const{id:e}=z0(),n=mr(),a=Bt(),r=Number(e),[s,l]=E.useState(new Map),[o,d]=E.useState(!1),[u,x]=E.useState(!1),[m,f]=E.useState(!1),[p,b]=E.useState(70),[g,y]=E.useState(0),[N,k]=E.useState(null),{data:T,isLoading:S,refetch:w}=Ie({queryKey:["bang-ung-luong",r],queryFn:()=>Xa.layTheoId(r),enabled:!!r}),{data:_}=Ie({queryKey:["bang-luong-list"],queryFn:()=>Dr.layDanhSach({})}),L=(T==null?void 0:T.trangThai)==="NHAP",C=De({mutationFn:K=>Xa.sinhDanhSach(r,K),onSuccess:K=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),ie.success(` sinh ${K.soNhanVien} nhn vin (${K.soDuocUng}  iu kin)`)},onError:K=>{var A,M;ie.error(((M=(A=K.response)==null?void 0:A.data)==null?void 0:M.message)||"C li xy ra")}}),P=De({mutationFn:K=>Xa.capNhatBulk(r,K),onSuccess:K=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),l(new Map),K.errors&&K.errors.length>0?ie.error(`Cp nht ${K.soCapNhat} dng. Li: ${K.errors.length}`):ie.success(`Cp nht ${K.soCapNhat} dng thnh cng`)},onError:K=>{var A,M;ie.error(((M=(A=K.response)==null?void 0:A.data)==null?void 0:M.message)||"C li xy ra")}}),F=De({mutationFn:K=>Xa.setTheoTiLe(r,K),onSuccess:K=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),d(!1),ie.success(K.message)},onError:K=>{var A,M;ie.error(((M=(A=K.response)==null?void 0:A.data)==null?void 0:M.message)||"C li xy ra")}}),H=De({mutationFn:K=>Xa.setSoTienCoDinh(r,K),onSuccess:K=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),x(!1),ie.success(K.message)},onError:K=>{var A,M;ie.error(((M=(A=K.response)==null?void 0:A.data)==null?void 0:M.message)||"C li xy ra")}}),O=De({mutationFn:()=>Xa.chot(r),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),ie.success("Cht bng ng lng thnh cng!")},onError:K=>{var A,M;ie.error(((M=(A=K.response)==null?void 0:A.data)==null?void 0:M.message)||"C li xy ra")}}),B=De({mutationFn:()=>Xa.khoa(r),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),ie.success("Kha bng ng lng thnh cng!")},onError:K=>{var A,M;ie.error(((M=(A=K.response)==null?void 0:A.data)==null?void 0:M.message)||"C li xy ra")}}),W=De({mutationFn:K=>Xa.moKhoa(r,{lyDo:K}),onSuccess:()=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),ie.success("M kha bng ng lng thnh cng!")},onError:K=>{var A,M;ie.error(((M=(A=K.response)==null?void 0:A.data)==null?void 0:M.message)||"C li xy ra")}}),ee=De({mutationFn:K=>Xa.ghiNhanKhauTru(r,K),onSuccess:K=>{a.invalidateQueries({queryKey:["bang-ung-luong",r]}),f(!1),ie.success(K.message)},onError:K=>{var A,M;ie.error(((M=(A=K.response)==null?void 0:A.data)==null?void 0:M.message)||"C li xy ra")}}),q=E.useCallback((K,A,M)=>{l(I=>{const V=new Map(I),J=V.get(K)||{};return V.set(K,{...J,[A]:M}),V})},[]),fe=E.useCallback((K,A)=>{const M=s.get(K.id);return M&&A in M?M[A]:K[A]},[s]),ne=E.useCallback((K,A)=>!(!K.duocPhepUng&&A>0||A>Number(K.mucToiDaDuocUng)),[]),Y=()=>{if(s.size===0){ie("Khng c thay i  lu",{icon:""});return}const K=Array.from(s.entries()).map(([A,M])=>({id:A,soTienUngDeXuat:M.soTienUngDeXuat,soTienUngDuyet:M.soTienUngDuyet,ghiChu:M.ghiChu??void 0}));P.mutate({chiTiets:K})},X=E.useMemo(()=>{if(!(T!=null&&T.chiTiets))return{tongNV:0,tongDuocUng:0,tongTien:0};const K=T.chiTiets;return{tongNV:K.length,tongDuocUng:K.filter(A=>A.duocPhepUng).length,tongTien:K.reduce((A,M)=>{const I=s.get(M.id),V=(I==null?void 0:I.soTienUngDuyet)??M.soTienUngDuyet;return A+Number(V)},0)}},[T==null?void 0:T.chiTiets,s]);if(S)return t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});if(!T)return t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-500",children:"Khng tm thy bng ng lng"})});const xe=T.chiTiets||[];return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>n("/ung-luong"),className:"p-2 hover:bg-gray-100 rounded-full",children:t.jsx(q0,{size:24})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:T.maBangUngLuong}),t.jsxs("p",{className:"text-gray-500",children:["K ",T.thangNam," | ",new Date(T.tuNgay).toLocaleDateString("vi-VN")," -"," ",new Date(T.denNgay).toLocaleDateString("vi-VN")]})]})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("span",{className:`px-3 py-1 rounded-full text-sm ${T.trangThai==="NHAP"?"bg-yellow-100 text-yellow-800":T.trangThai==="DA_CHOT"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:T.trangThai==="NHAP"?"Nhp":T.trangThai==="DA_CHOT"?" cht":" kha"})})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[t.jsxs("div",{className:"card",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng nhn vin"}),t.jsx("p",{className:"text-2xl font-bold text-gray-800",children:X.tongNV})]}),t.jsxs("div",{className:"card",children:[t.jsx("p",{className:"text-sm text-gray-500",children:" iu kin ng"}),t.jsx("p",{className:"text-2xl font-bold text-green-600",children:X.tongDuocUng})]}),t.jsxs("div",{className:"card",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Khng  iu kin"}),t.jsx("p",{className:"text-2xl font-bold text-red-600",children:X.tongNV-X.tongDuocUng})]}),t.jsxs("div",{className:"card",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng tin ng"}),t.jsx("p",{className:"text-2xl font-bold text-blue-600",children:et(X.tongTien)})]})]}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"flex flex-wrap gap-2",children:[L&&t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>C.mutate({}),disabled:C.isPending,className:"btn btn-secondary",children:[t.jsx(dn,{size:18}),"Sinh danh sch NV"]}),t.jsxs("button",{onClick:()=>d(!0),className:"btn btn-secondary",children:[t.jsx(O_,{size:18}),"Set theo % mc ti a"]}),t.jsxs("button",{onClick:()=>x(!0),className:"btn btn-secondary",children:[t.jsx(Pr,{size:18}),"Set s tin c nh"]}),t.jsxs("button",{onClick:Y,disabled:s.size===0||P.isPending,className:"btn btn-primary",children:[t.jsx(al,{size:18}),"Lu thay i (",s.size,")"]}),t.jsxs("button",{onClick:()=>{confirm("Bn c chc mun cht bng ng lng ny?")&&O.mutate()},disabled:xe.length===0,className:"btn bg-green-600 text-white hover:bg-green-700",children:[t.jsx(Or,{size:18}),"Cht"]})]}),T.trangThai==="DA_CHOT"&&t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>{confirm("Bn c chc mun kha bng ng lng ny?")&&B.mutate()},className:"btn bg-orange-600 text-white hover:bg-orange-700",children:[t.jsx(Js,{size:18}),"Kha"]}),t.jsxs("button",{onClick:()=>f(!0),disabled:T.daGhiNhanKhauTru,className:"btn btn-primary",children:[t.jsx(Wp,{size:18}),T.daGhiNhanKhauTru?" ghi nhn khu tr":"Ghi nhn khu tr"]})]}),T.trangThai==="DA_KHOA"&&t.jsxs("button",{onClick:()=>{const K=prompt("Nhp l do m kha:");K&&W.mutate(K)},className:"btn bg-gray-600 text-white hover:bg-gray-700",children:[t.jsx(tg,{size:18}),"M kha"]}),t.jsx("button",{onClick:()=>w(),className:"btn btn-secondary ml-auto",children:t.jsx(H_,{size:18})})]})}),t.jsx("div",{className:"card overflow-x-auto",children:xe.length>0?t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-3 px-4 font-medium sticky left-0 bg-gray-50",children:"M NV"}),t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"H tn"}),t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Phng ban"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Ngy cng"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Ngh"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Ngh KP"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Tin cng ly k"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Mc ti a"}),t.jsx("th",{className:"text-center py-3 px-4 font-medium",children:"Eligible"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium bg-blue-50",children:"S tin  xut"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium bg-green-50",children:"S tin duyt"}),t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Ghi ch"})]})}),t.jsx("tbody",{children:xe.map(K=>{var V,J,ge;const A=fe(K,"soTienUngDuyet"),M=ne(K,Number(A)),I=s.has(K.id);return t.jsxs("tr",{className:`border-b hover:bg-gray-50 ${K.duocPhepUng?"":"bg-red-50"} ${I?"bg-yellow-50":""}`,children:[t.jsx("td",{className:"py-2 px-4 font-medium sticky left-0 bg-white",children:(V=K.nhanVien)==null?void 0:V.maNhanVien}),t.jsx("td",{className:"py-2 px-4",children:(J=K.nhanVien)==null?void 0:J.hoTen}),t.jsx("td",{className:"py-2 px-4",children:(ge=K.phongBan)==null?void 0:ge.tenPhongBan}),t.jsxs("td",{className:"py-2 px-4 text-right",children:[Number(K.soNgayCong).toFixed(1),K.laTamTinh&&t.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs bg-yellow-100 text-yellow-700 rounded",title:"Tm tnh theo lch (cha c chm cng thc t)",children:"~"})]}),t.jsx("td",{className:"py-2 px-4 text-right",children:Number(K.soNgayNghi).toFixed(1)}),t.jsxs("td",{className:"py-2 px-4 text-right",children:[Number(K.soNgayNghiKhongPhep)>0&&t.jsx("span",{className:"text-red-600 font-medium",children:Number(K.soNgayNghiKhongPhep).toFixed(1)}),Number(K.soNgayNghiKhongPhep)===0&&"0"]}),t.jsx("td",{className:"py-2 px-4 text-right",children:et(K.tienCongLuyKe)}),t.jsx("td",{className:"py-2 px-4 text-right font-medium text-blue-600",children:et(K.mucToiDaDuocUng)}),t.jsx("td",{className:"py-2 px-4 text-center",children:K.duocPhepUng?t.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-green-100 text-green-600 rounded-full",children:t.jsx(Or,{size:14})}):t.jsx("span",{className:"inline-flex items-center gap-1 text-red-600",title:mV(K.lyDoKhongDat),children:t.jsx(dl,{size:14})})}),t.jsx("td",{className:"py-2 px-4 bg-blue-50",children:t.jsx("input",{type:"number",min:"0",max:K.mucToiDaDuocUng,value:fe(K,"soTienUngDeXuat"),onChange:z=>q(K.id,"soTienUngDeXuat",Number(z.target.value)),disabled:!L||!K.duocPhepUng,className:`w-full px-2 py-1 border rounded text-right ${!L||!K.duocPhepUng?"bg-gray-100 cursor-not-allowed":"bg-white"}`})}),t.jsxs("td",{className:"py-2 px-4 bg-green-50",children:[t.jsx("input",{type:"number",min:"0",max:K.mucToiDaDuocUng,value:A,onChange:z=>q(K.id,"soTienUngDuyet",Number(z.target.value)),disabled:!L||!K.duocPhepUng,className:`w-full px-2 py-1 border rounded text-right ${!L||!K.duocPhepUng?"bg-gray-100 cursor-not-allowed":M?"bg-white":"border-red-500 bg-red-50"}`}),!M&&t.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Vt mc ti a"})]}),t.jsx("td",{className:"py-2 px-4",children:t.jsx("input",{type:"text",value:fe(K,"ghiChu")||"",onChange:z=>q(K.id,"ghiChu",z.target.value),disabled:!L,className:`w-full px-2 py-1 border rounded ${L?"bg-white":"bg-gray-100 cursor-not-allowed"}`,placeholder:"Ghi ch..."})})]},K.id)})})]}):t.jsxs("div",{className:"text-center py-12",children:[t.jsx(dn,{size:48,className:"mx-auto text-gray-400 mb-4"}),t.jsx("p",{className:"text-gray-500 mb-4",children:"Cha c nhn vin no trong bng ng lng"}),L&&t.jsxs("button",{onClick:()=>C.mutate({}),disabled:C.isPending,className:"btn btn-primary",children:[t.jsx(dn,{size:18}),"Sinh danh sch nhn vin"]})]})}),o&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Set theo % mc ti a"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T l (%)"}),t.jsx("input",{type:"number",min:"0",max:"100",value:p,onChange:K=>b(Number(K.target.value)),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"p dng cho tt c nhn vin  iu kin ng lng"}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:()=>F.mutate({tiLe:p,lamTron:1e4}),disabled:F.isPending,className:"btn btn-primary",children:F.isPending?"ang x l...":"p dng"})]})]})}),u&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Set s tin c nh"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S tin (VN)"}),t.jsx("input",{type:"number",min:"0",step:"100000",value:g,onChange:K=>y(Number(K.target.value)),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Ch p dng cho nhn vin c mc ti a >= s tin ny"}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:()=>H.mutate({soTien:g}),disabled:H.isPending,className:"btn btn-primary",children:H.isPending?"ang x l...":"p dng"})]})]})}),m&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Ghi nhn khu tr vo bng lng"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Chn bng lng p dng"}),t.jsxs("select",{value:N||"",onChange:K=>k(K.target.value?Number(K.target.value):null),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn bng lng --"}),(Array.isArray(_)?_:(_==null?void 0:_.data)||[]).map(K=>{var A;return t.jsxs("option",{value:K.id,children:["Thng ",K.thang,"/",K.nam," - ",((A=K.phongBan)==null?void 0:A.tenPhongBan)||"Tt c"]},K.id)})]})]}),t.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"H thng s to phiu iu chnh t ng  khu tr s tin ng t bng lng c chn."}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:()=>{if(!N){ie.error("Vui lng chn bng lng");return}ee.mutate({bangLuongApDungId:N})},disabled:ee.isPending||!N,className:"btn btn-primary",children:ee.isPending?"ang x l...":"Ghi nhn"})]})]})})]})}function pV(){var y,N,k,T,S,w,_,L,C,P,F,H,O;const[e,n]=E.useState(""),[a,r]=E.useState(null),[s,l]=E.useState(()=>{const B=new Date;return B.setMonth(B.getMonth()-11),`${B.getFullYear()}-${String(B.getMonth()+1).padStart(2,"0")}`}),[o,d]=E.useState(()=>{const B=new Date;return`${B.getFullYear()}-${String(B.getMonth()+1).padStart(2,"0")}`}),[u,x]=E.useState("bangLuongs"),{data:m}=Ie({queryKey:["nhan-vien-search",e],queryFn:()=>Ma.layTatCa({tuKhoa:e,soLuong:20}),enabled:e.length>=2}),f=m?{data:Array.isArray(m)?m:m.data}:void 0,{data:p,isLoading:b}=Ie({queryKey:["so-luong-nv",a,s,o],queryFn:()=>Kj.layNhanVien(a,{tuThang:Number(s.split("-")[1]),tuNam:Number(s.split("-")[0]),denThang:Number(o.split("-")[1]),denNam:Number(o.split("-")[0])}),enabled:!!a}),g=B=>{x(u===B?null:B)};return t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"S lng nhn vin"}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tm nhn vin"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",value:e,onChange:B=>n(B.target.value),placeholder:"Nhp m hoc tn nhn vin...",className:"w-full border rounded-lg px-3 py-2 pl-10"}),t.jsx(Hr,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(f==null?void 0:f.data)&&f.data.length>0&&e.length>=2&&t.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-60 overflow-y-auto",children:f.data.map(B=>{var W;return t.jsxs("button",{onClick:()=>{r(B.id),n(`${B.maNhanVien} - ${B.hoTen}`)},className:"w-full text-left px-4 py-2 hover:bg-gray-50",children:[t.jsx("span",{className:"font-medium",children:B.maNhanVien})," - ",B.hoTen,t.jsx("span",{className:"text-gray-500 text-sm block",children:(W=B.phongBan)==null?void 0:W.tenPhongBan})]},B.id)})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T thng"}),t.jsx(kc,{value:s,onChange:l,className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n thng"}),t.jsx(kc,{value:o,onChange:d,className:"w-full border rounded-lg px-3 py-2"})]})]})}),p&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"card mb-6",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[t.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center",children:t.jsx(ro,{size:32,className:"text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold",children:p.nhanVien.hoTen}),t.jsxs("p",{className:"text-gray-500",children:[p.nhanVien.maNhanVien," | ",(y=p.nhanVien.phongBan)==null?void 0:y.tenPhongBan]})]}),t.jsxs("button",{className:"btn btn-secondary ml-auto",children:[t.jsx(bs,{size:18}),"Xut Excel"]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng lng"}),t.jsx("p",{className:"text-lg font-bold text-gray-800",children:et(((N=p.tongKet)==null?void 0:N.tongLuong)??0)})]}),t.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng thng"}),t.jsx("p",{className:"text-lg font-bold text-green-600",children:et(((k=p.tongKet)==null?void 0:k.tongThuong)??0)})]}),t.jsxs("div",{className:"bg-red-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng pht"}),t.jsx("p",{className:"text-lg font-bold text-red-600",children:et(((T=p.tongKet)==null?void 0:T.tongPhat)??0)})]}),t.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng khu tr"}),t.jsx("p",{className:"text-lg font-bold text-orange-600",children:et(((S=p.tongKet)==null?void 0:S.tongKhauTru)??0)})]}),t.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Tng ng"}),t.jsx("p",{className:"text-lg font-bold text-purple-600",children:et(((w=p.tongKet)==null?void 0:w.tongUng)??0)})]}),t.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Thc nhn"}),t.jsx("p",{className:"text-lg font-bold text-blue-600",children:et(((_=p.tongKet)==null?void 0:_.tongThucNhan)??0)})]})]})]}),t.jsxs("div",{className:"card mb-4",children:[t.jsxs("button",{onClick:()=>g("bangLuongs"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(Ys,{size:20}),"Lch s bng lng (",((L=p.bangLuongs)==null?void 0:L.length)??0,")"]}),u==="bangLuongs"?t.jsx(Il,{}):t.jsx(Ar,{})]}),u==="bangLuongs"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Thng"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Ngy cng"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Lng c bn"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Ph cp"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Thng"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Khu tr"}),t.jsx("th",{className:"text-right py-2 px-3",children:"BHXH"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Thu TNCN"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Thc lnh"})]})}),t.jsx("tbody",{children:(C=p.bangLuongs)==null?void 0:C.map(B=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3 font-medium",children:B.thangNam}),t.jsx("td",{className:"py-2 px-3 text-right",children:B.ngayCong}),t.jsx("td",{className:"py-2 px-3 text-right",children:et(B.luongCoBan)}),t.jsx("td",{className:"py-2 px-3 text-right",children:et(B.phuCapTong)}),t.jsx("td",{className:"py-2 px-3 text-right text-green-600",children:et(B.thuongKPI+B.thuongThuNhap)}),t.jsx("td",{className:"py-2 px-3 text-right text-red-600",children:et(B.khauTruTong+B.ungLuong)}),t.jsx("td",{className:"py-2 px-3 text-right",children:et(B.bhxh+B.bhyt+B.bhtn)}),t.jsx("td",{className:"py-2 px-3 text-right",children:et(B.thueTNCN)}),t.jsx("td",{className:"py-2 px-3 text-right font-bold text-blue-600",children:et(B.thucLanh)})]},B.bangLuongId))})]})})]}),t.jsxs("div",{className:"card mb-4",children:[t.jsxs("button",{onClick:()=>g("dieuChinhs"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(At,{size:20}),"Phiu iu chnh (",((P=p.dieuChinhs)==null?void 0:P.length)??0,")"]}),u==="dieuChinhs"?t.jsx(Il,{}):t.jsx(Ar,{})]}),u==="dieuChinhs"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Ngy"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Loi phiu"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Khon"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Loi khon"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Ghi ch"})]})}),t.jsx("tbody",{children:(F=p.dieuChinhs)==null?void 0:F.map((B,W)=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3",children:new Date(B.ngayTao).toLocaleDateString("vi-VN")}),t.jsx("td",{className:"py-2 px-3",children:B.loaiPhieu}),t.jsx("td",{className:"py-2 px-3",children:B.tenKhoanLuong}),t.jsx("td",{className:"py-2 px-3",children:t.jsx("span",{className:B.loaiKhoan==="CONG_THEM"?"text-green-600":"text-red-600",children:B.loaiKhoan==="CONG_THEM"?"Cng thm":"Tr bt"})}),t.jsxs("td",{className:`py-2 px-3 text-right ${B.loaiKhoan==="CONG_THEM"?"text-green-600":"text-red-600"}`,children:[B.loaiKhoan==="CONG_THEM"?"+":"-",et(B.soTien)]}),t.jsx("td",{className:"py-2 px-3 text-gray-500",children:B.ghiChu})]},W))})]})})]}),t.jsxs("div",{className:"card mb-4",children:[t.jsxs("button",{onClick:()=>g("ungLuongs"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(li,{size:20}),"ng lng (",((H=p.ungLuongs)==null?void 0:H.length)??0,")"]}),u==="ungLuongs"?t.jsx(Il,{}):t.jsx(Ar,{})]}),u==="ungLuongs"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"M bng"}),t.jsx("th",{className:"text-left py-2 px-3",children:"K"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin duyt"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Trng thi"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Ngy cht"})]})}),t.jsx("tbody",{children:(O=p.ungLuongs)==null?void 0:O.map(B=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3 font-medium",children:B.maBang}),t.jsx("td",{className:"py-2 px-3",children:B.thangNam}),t.jsx("td",{className:"py-2 px-3 text-right font-bold text-purple-600",children:et(B.soTienDuyet)}),t.jsx("td",{className:"py-2 px-3 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${B.trangThai==="DA_KHOA"?"bg-green-100 text-green-800":B.trangThai==="DA_CHOT"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:B.trangThai==="DA_KHOA"?" kha":B.trangThai==="DA_CHOT"?" cht":"Nhp"})}),t.jsx("td",{className:"py-2 px-3",children:B.ngayChot?new Date(B.ngayChot).toLocaleDateString("vi-VN"):"-"})]},B.bangUngLuongId))})]})})]}),p.kpis&&p.kpis.length>0&&t.jsxs("div",{className:"card mb-4",children:[t.jsxs("button",{onClick:()=>g("kpis"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(li,{size:20}),"nh gi KPI (",p.kpis.length,")"]}),u==="kpis"?t.jsx(Il,{}):t.jsx(Ar,{})]}),u==="kpis"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Thng"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Tng im"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Xp loi"}),t.jsx("th",{className:"text-right py-2 px-3",children:"Tin thng"})]})}),t.jsx("tbody",{children:p.kpis.map(B=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsxs("td",{className:"py-2 px-3",children:[B.thang,"/",B.nam]}),t.jsx("td",{className:"py-2 px-3 text-right",children:B.tongDiem}),t.jsx("td",{className:"py-2 px-3 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${B.xepLoai==="A"?"bg-green-100 text-green-800":B.xepLoai==="B"?"bg-blue-100 text-blue-800":B.xepLoai==="C"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:B.xepLoai})}),t.jsx("td",{className:"py-2 px-3 text-right text-green-600",children:et(B.tienThuong)})]},B.kyDanhGiaId))})]})})]}),p.thuongPhats&&p.thuongPhats.length>0&&t.jsxs("div",{className:"card",children:[t.jsxs("button",{onClick:()=>g("thuongPhats"),className:"flex items-center justify-between w-full text-left",children:[t.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(At,{size:20}),"Thng/Pht (",p.thuongPhats.length,")"]}),u==="thuongPhats"?t.jsx(Il,{}):t.jsx(Ar,{})]}),u==="thuongPhats"&&t.jsx("div",{className:"mt-4 overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Ngy"}),t.jsx("th",{className:"text-center py-2 px-3",children:"Loi"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Tn"}),t.jsx("th",{className:"text-right py-2 px-3",children:"S tin"}),t.jsx("th",{className:"text-left py-2 px-3",children:"L do"})]})}),t.jsx("tbody",{children:p.thuongPhats.map(B=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 px-3",children:new Date(B.ngay).toLocaleDateString("vi-VN")}),t.jsx("td",{className:"py-2 px-3 text-center",children:t.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${B.loai==="THUONG"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:B.loai==="THUONG"?"Thng":"Pht"})}),t.jsx("td",{className:"py-2 px-3",children:B.ten}),t.jsxs("td",{className:`py-2 px-3 text-right ${B.loai==="THUONG"?"text-green-600":"text-red-600"}`,children:[B.loai==="THUONG"?"+":"-",et(B.soTien)]}),t.jsx("td",{className:"py-2 px-3 text-gray-500",children:B.lyDo})]},B.suKienId))})]})})]})]}),!a&&t.jsxs("div",{className:"card text-center py-12",children:[t.jsx(ro,{size:48,className:"mx-auto text-gray-400 mb-4"}),t.jsx("p",{className:"text-gray-500",children:"Vui lng chn nhn vin  xem s lng"})]}),b&&t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})]})}function gV(){var m,f,p,b,g,y,N,k,T,S,w,_,L;const[e,n]=E.useState(null),[a,r]=E.useState(()=>{const C=new Date;return C.setMonth(C.getMonth()-11),`${C.getFullYear()}-${String(C.getMonth()+1).padStart(2,"0")}`}),[s,l]=E.useState(()=>{const C=new Date;return`${C.getFullYear()}-${String(C.getMonth()+1).padStart(2,"0")}`}),{data:o}=Ie({queryKey:["phong-ban-list"],queryFn:cn.layTatCa}),d=Array.isArray(o)?o:[],{data:u,isLoading:x}=Ie({queryKey:["so-luong-pb",e,a,s],queryFn:()=>Kj.layPhongBan(e,{tuThang:Number(a.split("-")[1]),tuNam:Number(a.split("-")[0]),denThang:Number(s.split("-")[1]),denNam:Number(s.split("-")[0])}),enabled:!!e});return t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"S lng phng ban"}),t.jsx("div",{className:"card mb-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:e||"",onChange:C=>n(C.target.value?Number(C.target.value):null),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"-- Chn phng ban --"}),d.map(C=>t.jsx("option",{value:C.id,children:C.tenPhongBan},C.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T thng"}),t.jsx(kc,{value:a,onChange:r,className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n thng"}),t.jsx(kc,{value:s,onChange:l,className:"w-full border rounded-lg px-3 py-2"})]})]})}),x&&t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),u&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"card mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-14 h-14 bg-blue-100 rounded-full flex items-center justify-center",children:t.jsx(Lr,{size:28,className:"text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold",children:(m=u.phongBan)==null?void 0:m.tenPhongBan}),t.jsxs("p",{className:"text-gray-500",children:["M: ",(f=u.phongBan)==null?void 0:f.maPhongBan]})]})]}),t.jsx("div",{className:"flex items-center gap-4",children:t.jsxs("button",{className:"btn btn-secondary",children:[t.jsx(bs,{size:18}),"Xut Excel"]})})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[t.jsx(dn,{size:18}),t.jsx("span",{className:"text-sm",children:"S nhn vin"})]}),t.jsx("p",{className:"text-2xl font-bold text-gray-800",children:((p=u.theoNhanVien)==null?void 0:p.length)??0})]}),t.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[t.jsx(Pr,{size:18}),t.jsx("span",{className:"text-sm",children:"Tng thu nhp"})]}),t.jsx("p",{className:"text-xl font-bold text-blue-600",children:et(((b=u.tongHop)==null?void 0:b.tongThuNhap)??0)})]}),t.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[t.jsx(li,{size:18}),t.jsx("span",{className:"text-sm",children:"Tng thng"})]}),t.jsx("p",{className:"text-xl font-bold text-green-600",children:et(((g=u.tongHop)==null?void 0:g.tongThuong)??0)})]}),t.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-1",children:[t.jsx(rj,{size:18}),t.jsx("span",{className:"text-sm",children:"Thc lnh"})]}),t.jsx("p",{className:"text-xl font-bold text-purple-600",children:et(((y=u.tongHop)==null?void 0:y.thucLinh)??0)})]})]})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["Chi tit theo nhn vin (",((N=u.theoNhanVien)==null?void 0:N.length)??0,")"]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"M NV"}),t.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"H tn"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Thu nhp"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Khu tr"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Thng"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Pht"}),t.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Thc lnh"})]})}),t.jsx("tbody",{children:(k=u.theoNhanVien)==null?void 0:k.map(C=>{var P,F,H,O,B,W,ee,q;return t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4 font-medium",children:(P=C.nhanVien)==null?void 0:P.maNhanVien}),t.jsx("td",{className:"py-3 px-4",children:(F=C.nhanVien)==null?void 0:F.hoTen}),t.jsx("td",{className:"py-3 px-4 text-right",children:et(((H=C.tongHop)==null?void 0:H.tongThuNhap)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-red-600",children:et(((O=C.tongHop)==null?void 0:O.tongKhauTru)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-green-600",children:et(((B=C.tongHop)==null?void 0:B.tongThuong)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-orange-600",children:et(((W=C.tongHop)==null?void 0:W.tongPhat)??0)}),t.jsx("td",{className:"py-3 px-4 text-right font-bold text-blue-600",children:et(((ee=C.tongHop)==null?void 0:ee.thucLinh)??0)})]},(q=C.nhanVien)==null?void 0:q.id)})}),t.jsx("tfoot",{className:"bg-gray-100 font-semibold",children:t.jsxs("tr",{children:[t.jsx("td",{colSpan:2,className:"py-3 px-4",children:"Tng cng"}),t.jsx("td",{className:"py-3 px-4 text-right",children:et(((T=u.tongHop)==null?void 0:T.tongThuNhap)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-red-600",children:et(((S=u.tongHop)==null?void 0:S.tongKhauTru)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-green-600",children:et(((w=u.tongHop)==null?void 0:w.tongThuong)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-orange-600",children:et(((_=u.tongHop)==null?void 0:_.tongPhat)??0)}),t.jsx("td",{className:"py-3 px-4 text-right text-blue-600",children:et(((L=u.tongHop)==null?void 0:L.thucLinh)??0)})]})})]})})]})]}),!e&&t.jsxs("div",{className:"card text-center py-12",children:[t.jsx(Lr,{size:48,className:"mx-auto text-gray-400 mb-4"}),t.jsx("p",{className:"text-gray-500",children:"Vui lng chn phng ban  xem s lng"})]})]})}const yV="tinh_luong_auth",ia=Zt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});ia.interceptors.request.use(e=>{const n=localStorage.getItem(yV);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const Oa={layDanhSachLoaiNghi:(e=!1)=>ia.get("/nghi-phep/loai-nghi",{params:{all:e}}).then(n=>n.data),layLoaiNghi:e=>ia.get(`/nghi-phep/loai-nghi/${e}`).then(n=>n.data),taoLoaiNghi:e=>ia.post("/nghi-phep/loai-nghi",e).then(n=>n.data),capNhatLoaiNghi:(e,n)=>ia.put(`/nghi-phep/loai-nghi/${e}`,n).then(a=>a.data),toggleLoaiNghi:e=>ia.post(`/nghi-phep/loai-nghi/${e}/toggle`).then(n=>n.data),layDanhSachDon:e=>ia.get("/nghi-phep/don",{params:e}).then(n=>n.data),layChiTietDon:e=>ia.get(`/nghi-phep/don/${e}`).then(n=>n.data),taoDon:e=>ia.post("/nghi-phep/don",e).then(n=>n.data),capNhatDon:(e,n)=>ia.put(`/nghi-phep/don/${e}`,n).then(a=>a.data),guiDuyet:e=>ia.post(`/nghi-phep/don/${e}/gui-duyet`).then(n=>n.data),duyetDon:(e,n)=>ia.post(`/nghi-phep/don/${e}/duyet`,{ghiChu:n}).then(a=>a.data),tuChoiDon:(e,n)=>ia.post(`/nghi-phep/don/${e}/tu-choi`,{lyDoTuChoi:n}).then(a=>a.data),huyDon:(e,n)=>ia.post(`/nghi-phep/don/${e}/huy`,{lyDo:n}).then(a=>a.data),rebuildMapping:e=>ia.post(`/nghi-phep/don/${e}/mapping/rebuild`).then(n=>n.data),layLichNghi:e=>ia.get("/nghi-phep/lich",{params:e}).then(n=>n.data),layLichNghiNhanVien:(e,n,a)=>ia.get(`/nghi-phep/nhan-vien/${e}/lich`,{params:{tuNgay:n,denNgay:a}}).then(r=>r.data)},B0=e=>({NHAP:"Nhp",GUI_DUYET:"Ch duyt",DA_DUYET:" duyt",TU_CHOI:"T chi",HUY:" hy"})[e]||e,Yi=e=>({NHAP:"gray",GUI_DUYET:"blue",DA_DUYET:"green",TU_CHOI:"red",HUY:"gray"})[e]||"gray",vV=e=>({CO_PHEP:"C php",KHONG_PHEP:"Khng php"})[e]||e;function bV(){const e=Bt(),[n,a]=E.useState(!1),[r,s]=E.useState(null),[l,o]=E.useState(!1),[d,u]=E.useState({maLoaiNghi:"",tenLoaiNghi:"",nhomLoai:"CO_PHEP",coTinhLuong:!0,coTinhChuyenCan:!1,thuTuHienThi:0}),{data:x,isLoading:m}=Ie({queryKey:["loai-nghi",l],queryFn:()=>Oa.layDanhSachLoaiNghi(l)}),f=De({mutationFn:Oa.taoLoaiNghi,onSuccess:()=>{e.invalidateQueries({queryKey:["loai-nghi"]}),ie.success("To loi ngh thnh cng!"),g()},onError:k=>{var T,S;ie.error(((S=(T=k.response)==null?void 0:T.data)==null?void 0:S.message)||"C li xy ra")}}),p=De({mutationFn:({id:k,data:T})=>Oa.capNhatLoaiNghi(k,T),onSuccess:()=>{e.invalidateQueries({queryKey:["loai-nghi"]}),ie.success("Cp nht thnh cng!"),g()},onError:k=>{var T,S;ie.error(((S=(T=k.response)==null?void 0:T.data)==null?void 0:S.message)||"C li xy ra")}}),b=De({mutationFn:Oa.toggleLoaiNghi,onSuccess:k=>{e.invalidateQueries({queryKey:["loai-nghi"]}),ie.success(k.isActive?" kch hot":" v hiu ha")},onError:k=>{var T,S;ie.error(((S=(T=k.response)==null?void 0:T.data)==null?void 0:S.message)||"C li xy ra")}}),g=()=>{a(!1),s(null),u({maLoaiNghi:"",tenLoaiNghi:"",nhomLoai:"CO_PHEP",coTinhLuong:!0,coTinhChuyenCan:!1,thuTuHienThi:0})},y=k=>{s(k),u({maLoaiNghi:k.maLoaiNghi,tenLoaiNghi:k.tenLoaiNghi,nhomLoai:k.nhomLoai,coTinhLuong:k.coTinhLuong,coTinhChuyenCan:k.coTinhChuyenCan,thuTuHienThi:k.thuTuHienThi}),a(!0)},N=()=>{if(!d.maLoaiNghi||!d.tenLoaiNghi){ie.error("Vui lng in y  thng tin bt buc");return}if(r){const{maLoaiNghi:k,...T}=d;p.mutate({id:r.id,data:T})}else f.mutate(d)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(At,{className:"w-8 h-8 text-indigo-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Danh mc loi ngh"}),t.jsx("p",{className:"text-gray-500",children:"Qun l cc loi ngh php trong h thng"})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[t.jsx("input",{type:"checkbox",checked:l,onChange:k=>o(k.target.checked),className:"rounded border-gray-300"}),"Hin th tt c"]}),t.jsxs("button",{onClick:()=>{g(),a(!0)},className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:[t.jsx(St,{className:"w-4 h-4"}),"Thm loi ngh"]})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tn loi ngh"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nhm"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Tnh lng"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Tnh chuyn cn"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"ang ti..."})}):(x==null?void 0:x.length)===0?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"Cha c loi ngh no"})}):x==null?void 0:x.map(k=>t.jsxs("tr",{className:k.isActive?"":"bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-mono text-sm text-gray-900",children:k.maLoaiNghi}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:k.tenLoaiNghi}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${k.nhomLoai==="CO_PHEP"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:vV(k.nhomLoai)})}),t.jsx("td",{className:"px-6 py-4 text-center",children:k.coTinhLuong?t.jsx("span",{className:"text-green-600",children:""}):t.jsx("span",{className:"text-gray-400",children:""})}),t.jsx("td",{className:"px-6 py-4 text-center",children:k.coTinhChuyenCan?t.jsx("span",{className:"text-green-600",children:""}):t.jsx("span",{className:"text-gray-400",children:""})}),t.jsx("td",{className:"px-6 py-4 text-center",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${k.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:k.isActive?"Hot ng":"V hiu"})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[t.jsx("button",{onClick:()=>y(k),className:"text-indigo-600 hover:text-indigo-900 mr-3",title:"Sa",children:t.jsx(Mr,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>b.mutate(k.id),className:`${k.isActive?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900"}`,title:k.isActive?"V hiu ha":"Kch hot",children:t.jsx(R_,{className:"w-4 h-4"})})]})]},k.id))})]})}),n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:r?"Sa loi ngh":"Thm loi ngh mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["M loi ngh ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:d.maLoaiNghi,onChange:k=>u({...d,maLoaiNghi:k.target.value.toUpperCase()}),disabled:!!r,className:"w-full border rounded-lg px-3 py-2 disabled:bg-gray-100",placeholder:"VD: PHEP_NAM"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn loi ngh ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:d.tenLoaiNghi,onChange:k=>u({...d,tenLoaiNghi:k.target.value}),className:"w-full border rounded-lg px-3 py-2",placeholder:"VD: Php nm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nhm loi ngh"}),t.jsxs("select",{value:d.nhomLoai,onChange:k=>u({...d,nhomLoai:k.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"CO_PHEP",children:"C php"}),t.jsx("option",{value:"KHONG_PHEP",children:"Khng php"})]})]}),t.jsxs("div",{className:"flex gap-6",children:[t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:d.coTinhLuong,onChange:k=>u({...d,coTinhLuong:k.target.checked}),className:"rounded border-gray-300"}),t.jsx("span",{className:"text-sm text-gray-700",children:"C tnh lng"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:d.coTinhChuyenCan,onChange:k=>u({...d,coTinhChuyenCan:k.target.checked}),className:"rounded border-gray-300"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Tnh chuyn cn"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Th t hin th"}),t.jsx("input",{type:"number",min:"0",value:d.thuTuHienThi,onChange:k=>u({...d,thuTuHienThi:parseInt(k.target.value)||0}),className:"w-full border rounded-lg px-3 py-2"})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:g,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Hy"}),t.jsx("button",{onClick:N,disabled:f.isPending||p.isPending,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:f.isPending||p.isPending?"ang x l...":r?"Cp nht":"Thm mi"})]})]})})]})}function NV(){var O,B;const e=Bt(),{user:n}=as(),[a,r]=E.useState(!1),[s,l]=E.useState(null),[o,d]=E.useState(null),[u,x]=E.useState(""),[m,f]=E.useState(null),[p,b]=E.useState({nhanVienId:0,loaiNghiId:0,tuNgay:"",denNgay:"",lyDo:""}),{data:g}=Ie({queryKey:["loai-nghi"],queryFn:()=>Oa.layDanhSachLoaiNghi()}),{data:y}=Ie({queryKey:["nhan-vien-don-gian"],queryFn:()=>Ma.layTatCa()});E.useEffect(()=>{if(y&&n){const ee=(Array.isArray(y)?y:y.data||[]).find(q=>q.email===n.email||q.id===n.nhanVienId);ee&&(f(ee),b(q=>({...q,nhanVienId:ee.id})))}},[y,n]);const{data:N,isLoading:k}=Ie({queryKey:["don-nghi-phep",u,m==null?void 0:m.id],queryFn:()=>Oa.layDanhSachDon({nhanVienId:m==null?void 0:m.id,trangThai:u||void 0,limit:50}),enabled:!!m}),T=De({mutationFn:Oa.taoDon,onSuccess:()=>{e.invalidateQueries({queryKey:["don-nghi-phep"]}),ie.success("To n ngh php thnh cng!"),L()},onError:W=>{var ee,q;ie.error(((q=(ee=W.response)==null?void 0:ee.data)==null?void 0:q.message)||"C li xy ra")}}),S=De({mutationFn:({id:W,data:ee})=>Oa.capNhatDon(W,ee),onSuccess:()=>{e.invalidateQueries({queryKey:["don-nghi-phep"]}),ie.success("Cp nht n thnh cng!"),L()},onError:W=>{var ee,q;ie.error(((q=(ee=W.response)==null?void 0:ee.data)==null?void 0:q.message)||"C li xy ra")}}),w=De({mutationFn:Oa.guiDuyet,onSuccess:()=>{e.invalidateQueries({queryKey:["don-nghi-phep"]}),ie.success(" gi n  duyt!")},onError:W=>{var ee,q;ie.error(((q=(ee=W.response)==null?void 0:ee.data)==null?void 0:q.message)||"C li xy ra")}}),_=De({mutationFn:W=>Oa.huyDon(W),onSuccess:()=>{e.invalidateQueries({queryKey:["don-nghi-phep"]}),ie.success(" hy n!")},onError:W=>{var ee,q;ie.error(((q=(ee=W.response)==null?void 0:ee.data)==null?void 0:q.message)||"C li xy ra")}}),L=()=>{r(!1),l(null),b({nhanVienId:(m==null?void 0:m.id)||0,loaiNghiId:0,tuNgay:"",denNgay:"",lyDo:""})},C=W=>{l(W),b({nhanVienId:W.nhanVien.id,loaiNghiId:W.loaiNghi.id,tuNgay:W.tuNgay.split("T")[0],denNgay:W.denNgay.split("T")[0],lyDo:W.lyDo||""}),r(!0)},P=()=>{if(!p.loaiNghiId||!p.tuNgay||!p.denNgay){ie.error("Vui lng in y  thng tin bt buc");return}if(new Date(p.tuNgay)>new Date(p.denNgay)){ie.error("Ngy bt u phi nh hn hoc bng ngy kt thc");return}s?S.mutate({id:s.id,data:{loaiNghiId:p.loaiNghiId,tuNgay:p.tuNgay,denNgay:p.denNgay,lyDo:p.lyDo}}):T.mutate(p)},F=()=>{if(!p.tuNgay||!p.denNgay)return 0;const W=new Date(p.tuNgay),ee=new Date(p.denNgay);let q=0;for(let fe=new Date(W);fe<=ee;fe.setDate(fe.getDate()+1)){const ne=fe.getDay();ne!==0&&ne!==6&&q++}return q},H=W=>new Date(W).toLocaleDateString("vi-VN");return m?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(ha,{className:"w-8 h-8 text-indigo-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"n ngh ca ti"}),t.jsxs("p",{className:"text-gray-500",children:[m.hoTen," - ",m.maNhanVien]})]})]}),t.jsxs("button",{onClick:()=>{L(),r(!0)},className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:[t.jsx(St,{className:"w-4 h-4"}),"To n ngh"]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Lc theo trng thi:"}),t.jsxs("select",{value:u,onChange:W=>x(W.target.value),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"NHAP",children:"Nhp"}),t.jsx("option",{value:"GUI_DUYET",children:"Ch duyt"}),t.jsx("option",{value:"DA_DUYET",children:" duyt"}),t.jsx("option",{value:"TU_CHOI",children:"T chi"}),t.jsx("option",{value:"HUY",children:" hy"})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M n"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Loi ngh"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"T ngy"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"n ngy"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"S ngy"}),t.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:k?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"ang ti..."})}):((O=N==null?void 0:N.items)==null?void 0:O.length)===0?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"Cha c n ngh no"})}):(B=N==null?void 0:N.items)==null?void 0:B.map(W=>t.jsxs("tr",{children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-mono text-sm text-gray-900",children:W.maDon}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.loaiNghi.tenLoaiNghi}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:H(W.tuNgay)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:H(W.denNgay)}),t.jsx("td",{className:"px-6 py-4 text-center text-sm text-gray-900",children:W.soNgayNghi}),t.jsx("td",{className:"px-6 py-4 text-center",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full bg-${Yi(W.trangThai)}-100 text-${Yi(W.trangThai)}-800`,children:B0(W.trangThai)})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[t.jsx("button",{onClick:()=>d(W),className:"text-gray-600 hover:text-gray-900 mr-2",title:"Xem chi tit",children:t.jsx(ii,{className:"w-4 h-4"})}),(W.trangThai==="NHAP"||W.trangThai==="TU_CHOI")&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>C(W),className:"text-indigo-600 hover:text-indigo-900 mr-2",title:"Sa",children:t.jsx(Mr,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>w.mutate(W.id),className:"text-blue-600 hover:text-blue-900 mr-2",title:"Gi duyt",children:t.jsx(gu,{className:"w-4 h-4"})})]}),W.trangThai!=="HUY"&&W.trangThai!=="DA_DUYET"&&t.jsx("button",{onClick:()=>{confirm("Bn c chc mun hy n ny?")&&_.mutate(W.id)},className:"text-red-600 hover:text-red-900",title:"Hy n",children:t.jsx(mn,{className:"w-4 h-4"})})]})]},W.id))})]})}),a&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:s?"Sa n ngh php":"To n ngh php mi"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Loi ngh ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("select",{value:p.loaiNghiId,onChange:W=>b({...p,loaiNghiId:parseInt(W.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[t.jsx("option",{value:0,children:"-- Chn loi ngh --"}),g==null?void 0:g.map(W=>t.jsxs("option",{value:W.id,children:[W.tenLoaiNghi," (",W.coTinhLuong?"C lng":"Khng lng",")"]},W.id))]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["T ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ut,{value:p.tuNgay,onChange:W=>b({...p,tuNgay:W}),className:"w-full border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["n ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ut,{value:p.denNgay,onChange:W=>b({...p,denNgay:W}),className:"w-full border rounded-lg px-3 py-2"})]})]}),p.tuNgay&&p.denNgay&&t.jsx("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:t.jsxs("span",{className:"text-blue-700 font-medium",children:["S ngy ngh (khng tnh T7, CN): ",F()," ngy"]})}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"L do ngh"}),t.jsx("textarea",{value:p.lyDo,onChange:W=>b({...p,lyDo:W.target.value}),rows:3,className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp l do ngh (ty chn)"})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:L,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Hy"}),t.jsx("button",{onClick:P,disabled:T.isPending||S.isPending,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:T.isPending||S.isPending?"ang x l...":s?"Cp nht":"To n"})]})]})}),o&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h2",{className:"text-xl font-bold",children:"Chi tit n ngh"}),t.jsx("button",{onClick:()=>d(null),className:"text-gray-500 hover:text-gray-700",children:t.jsx(mn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"M n"}),t.jsx("p",{className:"font-mono font-medium",children:o.maDon})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Trng thi"}),t.jsx("p",{children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full bg-${Yi(o.trangThai)}-100 text-${Yi(o.trangThai)}-800`,children:B0(o.trangThai)})})]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Loi ngh"}),t.jsx("p",{className:"font-medium",children:o.loaiNghi.tenLoaiNghi})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"T ngy"}),t.jsx("p",{className:"font-medium",children:H(o.tuNgay)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"n ngy"}),t.jsx("p",{className:"font-medium",children:H(o.denNgay)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"S ngy"}),t.jsx("p",{className:"font-medium",children:o.soNgayNghi})]})]}),o.lyDo&&t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"L do"}),t.jsx("p",{className:"text-gray-700",children:o.lyDo})]}),o.nguoiDuyet&&t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Ngi duyt"}),t.jsx("p",{className:"font-medium",children:o.nguoiDuyet.hoTen}),o.ngayDuyet&&t.jsxs("p",{className:"text-sm text-gray-500",children:["Ngy duyt: ",H(o.ngayDuyet)]})]}),o.lyDoTuChoi&&t.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[t.jsx("span",{className:"text-sm text-red-600 font-medium",children:"L do t chi:"}),t.jsx("p",{className:"text-red-700",children:o.lyDoTuChoi})]})]}),t.jsx("div",{className:"flex justify-end mt-6",children:t.jsx("button",{onClick:()=>d(null),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"ng"})})]})})]}):t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsxs("div",{className:"text-center",children:[t.jsx(At,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),t.jsx("p",{className:"text-gray-500",children:"ang ti thng tin nhn vin..."})]})})}function jV(){var T,S;const e=Bt(),[n,a]=E.useState(null),[r,s]=E.useState(null),[l,o]=E.useState(""),[d,u]=E.useState({phongBanId:void 0,trangThai:"GUI_DUYET",tuNgay:"",denNgay:"",page:1}),{data:x}=Ie({queryKey:["phong-ban"],queryFn:cn.layTatCa}),{data:m,isLoading:f,refetch:p}=Ie({queryKey:["don-nghi-phep-duyet",d],queryFn:()=>Oa.layDanhSachDon({phongBanId:d.phongBanId,trangThai:d.trangThai||void 0,tuNgay:d.tuNgay||void 0,denNgay:d.denNgay||void 0,page:d.page,limit:20})}),b=De({mutationFn:w=>Oa.duyetDon(w),onSuccess:w=>{e.invalidateQueries({queryKey:["don-nghi-phep-duyet"]}),ie.success(` duyt n ${w.maDon}!`)},onError:w=>{var _,L;ie.error(((L=(_=w.response)==null?void 0:_.data)==null?void 0:L.message)||"C li xy ra khi duyt")}}),g=De({mutationFn:({id:w,lyDo:_})=>Oa.tuChoiDon(w,_),onSuccess:w=>{e.invalidateQueries({queryKey:["don-nghi-phep-duyet"]}),ie.success(` t chi n ${w.maDon}`),s(null),o("")},onError:w=>{var _,L;ie.error(((L=(_=w.response)==null?void 0:_.data)==null?void 0:L.message)||"C li xy ra")}}),y=De({mutationFn:Oa.rebuildMapping,onSuccess:w=>{ie.success(` rebuild mapping: ${w.soNgayTao} ngy`)},onError:w=>{var _,L;ie.error(((L=(_=w.response)==null?void 0:_.data)==null?void 0:L.message)||"C li xy ra")}}),N=w=>new Date(w).toLocaleDateString("vi-VN"),k=()=>{if(r){if(!l.trim()){ie.error("Vui lng nhp l do t chi");return}g.mutate({id:r.id,lyDo:l})}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(ua,{className:"w-8 h-8 text-green-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Duyt ngh php"}),t.jsx("p",{className:"text-gray-500",children:"Xem xt v ph duyt n ngh php ca nhn vin"})]})]}),t.jsxs("button",{onClick:()=>p(),className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-800",children:[t.jsx(Ba,{className:"w-4 h-4"}),"Lm mi"]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t.jsx(Xp,{className:"w-4 h-4 inline mr-1"}),"Phng ban"]}),t.jsxs("select",{value:d.phongBanId||"",onChange:w=>u({...d,phongBanId:w.target.value?parseInt(w.target.value):void 0,page:1}),className:"border rounded-lg px-3 py-2 min-w-[180px]",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),x==null?void 0:x.map(w=>t.jsx("option",{value:w.id,children:w.tenPhongBan},w.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng thi"}),t.jsxs("select",{value:d.trangThai,onChange:w=>u({...d,trangThai:w.target.value,page:1}),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"GUI_DUYET",children:"Ch duyt"}),t.jsx("option",{value:"DA_DUYET",children:" duyt"}),t.jsx("option",{value:"TU_CHOI",children:"T chi"}),t.jsx("option",{value:"NHAP",children:"Nhp"}),t.jsx("option",{value:"HUY",children:" hy"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"T ngy"}),t.jsx(Ut,{value:d.tuNgay,onChange:w=>u({...d,tuNgay:w,page:1}),className:"border rounded-lg px-3 py-2"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n ngy"}),t.jsx(Ut,{value:d.denNgay,onChange:w=>u({...d,denNgay:w,page:1}),className:"border rounded-lg px-3 py-2"})]}),t.jsx("button",{onClick:()=>u({phongBanId:void 0,trangThai:"GUI_DUYET",tuNgay:"",denNgay:"",page:1}),className:"px-3 py-2 text-sm text-gray-600 hover:text-gray-800",children:"t li"})]})}),t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"M n"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Loi ngh"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"S ngy"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-4 text-center text-gray-500",children:"ang ti..."})}):((T=m==null?void 0:m.items)==null?void 0:T.length)===0?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-4 text-center text-gray-500",children:"Khng c n ngh php no"})}):(S=m==null?void 0:m.items)==null?void 0:S.map(w=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 whitespace-nowrap font-mono text-sm text-gray-900",children:w.maDon}),t.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:w.nhanVien.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:w.nhanVien.maNhanVien})]}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:w.phongBan.tenPhongBan}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:w.loaiNghi.tenLoaiNghi}),t.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:[N(w.tuNgay)," - ",N(w.denNgay)]}),t.jsx("td",{className:"px-4 py-3 text-center text-sm font-medium text-gray-900",children:w.soNgayNghi}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full bg-${Yi(w.trangThai)}-100 text-${Yi(w.trangThai)}-800`,children:B0(w.trangThai)})}),t.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm font-medium",children:[t.jsx("button",{onClick:()=>a(w),className:"text-gray-600 hover:text-gray-900 mr-2",title:"Xem chi tit",children:t.jsx(ii,{className:"w-4 h-4"})}),w.trangThai==="GUI_DUYET"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>b.mutate(w.id),disabled:b.isPending,className:"text-green-600 hover:text-green-900 mr-2",title:"Duyt",children:t.jsx(Or,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>s(w),className:"text-red-600 hover:text-red-900",title:"T chi",children:t.jsx(xo,{className:"w-4 h-4"})})]}),w.trangThai==="DA_DUYET"&&t.jsx("button",{onClick:()=>y.mutate(w.id),disabled:y.isPending,className:"text-blue-600 hover:text-blue-900",title:"Rebuild mapping",children:t.jsx(Ba,{className:"w-4 h-4"})})]})]},w.id))})]}),(m==null?void 0:m.pagination)&&m.pagination.totalPages>1&&t.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 flex items-center justify-between",children:[t.jsxs("div",{className:"text-sm text-gray-500",children:["Trang ",m.pagination.page," / ",m.pagination.totalPages," (",m.pagination.total," n)"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>u({...d,page:d.page-1}),disabled:d.page<=1,className:"p-2 text-gray-600 hover:text-gray-900 disabled:opacity-50",children:t.jsx(fr,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>u({...d,page:d.page+1}),disabled:d.page>=m.pagination.totalPages,className:"p-2 text-gray-600 hover:text-gray-900 disabled:opacity-50",children:t.jsx($n,{className:"w-4 h-4"})})]})]})]}),n&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h2",{className:"text-xl font-bold",children:"Chi tit n ngh"}),t.jsx("button",{onClick:()=>a(null),className:"text-gray-500 hover:text-gray-700",children:t.jsx(mn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"M n"}),t.jsx("p",{className:"font-mono font-medium",children:n.maDon})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Trng thi"}),t.jsx("p",{children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full bg-${Yi(n.trangThai)}-100 text-${Yi(n.trangThai)}-800`,children:B0(n.trangThai)})})]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Nhn vin"}),t.jsxs("p",{className:"font-medium",children:[n.nhanVien.hoTen," (",n.nhanVien.maNhanVien,")"]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Phng ban"}),t.jsx("p",{className:"font-medium",children:n.phongBan.tenPhongBan})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Loi ngh"}),t.jsx("p",{className:"font-medium",children:n.loaiNghi.tenLoaiNghi})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"T ngy"}),t.jsx("p",{className:"font-medium",children:N(n.tuNgay)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"n ngy"}),t.jsx("p",{className:"font-medium",children:N(n.denNgay)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"S ngy"}),t.jsx("p",{className:"font-medium",children:n.soNgayNghi})]})]}),n.lyDo&&t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"L do"}),t.jsx("p",{className:"text-gray-700",children:n.lyDo})]}),n.nguoiDuyet&&t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Ngi duyt"}),t.jsx("p",{className:"font-medium",children:n.nguoiDuyet.hoTen}),n.ngayDuyet&&t.jsxs("p",{className:"text-sm text-gray-500",children:["Ngy duyt: ",N(n.ngayDuyet)]})]}),n.lyDoTuChoi&&t.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[t.jsx("span",{className:"text-sm text-red-600 font-medium",children:"L do t chi:"}),t.jsx("p",{className:"text-red-700",children:n.lyDoTuChoi})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[n.trangThai==="GUI_DUYET"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>{a(null),s(n)},className:"px-4 py-2 text-red-600 hover:text-red-800",children:"T chi"}),t.jsx("button",{onClick:()=>{b.mutate(n.id),a(null)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Duyt n"})]}),t.jsx("button",{onClick:()=>a(null),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"ng"})]})]})}),r&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4 text-red-600",children:"T chi n ngh"}),t.jsxs("p",{className:"text-gray-600 mb-4",children:["T chi n ",t.jsx("strong",{children:r.maDon})," ca"," ",t.jsx("strong",{children:r.nhanVien.hoTen}),"?"]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["L do t chi ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("textarea",{value:l,onChange:w=>o(w.target.value),rows:3,className:"w-full border rounded-lg px-3 py-2",placeholder:"Nhp l do t chi..."})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:()=>{s(null),o("")},className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Hy"}),t.jsx("button",{onClick:k,disabled:g.isPending,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:g.isPending?"ang x l...":"T chi"})]})]})})]})}function wV(){const[e,n]=E.useState(()=>{const g=new Date;return`${g.getFullYear()}-${String(g.getMonth()+1).padStart(2,"0")}`}),[a,r]=E.useState(),{tuNgay:s,denNgay:l}=E.useMemo(()=>{const[g,y]=e.split("-").map(Number),N=new Date(g,y-1,1),k=new Date(g,y,0);return{tuNgay:N.toISOString().split("T")[0],denNgay:k.toISOString().split("T")[0]}},[e]),{data:o}=Ie({queryKey:["phong-ban"],queryFn:cn.layTatCa}),{data:d,isLoading:u}=Ie({queryKey:["lich-nghi",s,l,a],queryFn:()=>Oa.layLichNghi({phongBanId:a,tuNgay:s,denNgay:l})}),x=E.useMemo(()=>{const[g,y]=e.split("-").map(Number),N=new Date(g,y-1,1),k=new Date(g,y,0),T=[];for(let S=new Date(N);S<=k;S.setDate(S.getDate()+1))T.push(new Date(S));return T},[e]),m=E.useMemo(()=>{const g=new Map;return d==null||d.forEach(y=>{y.chiTietNgays.forEach(N=>{const k=`${y.nhanVien.id}-${N.ngay.split("T")[0]}`;g.set(k,{loaiNghi:N.loaiNghi.tenLoaiNghi,nhomLoai:N.loaiNghi.nhomLoai})})}),g},[d]),f=g=>{const[y,N]=e.split("-").map(Number),k=new Date(y,N-1+g,1);n(`${k.getFullYear()}-${String(k.getMonth()+1).padStart(2,"0")}`)},p=()=>{const[g,y]=e.split("-").map(Number);return`Thng ${y}/${g}`},b=g=>{const y=g.getDay();return y===0||y===6};return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(At,{className:"w-8 h-8 text-indigo-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Lch ngh php"}),t.jsx("p",{className:"text-gray-500",children:"Xem tng quan lch ngh php ca nhn vin"})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>f(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:t.jsx(fr,{className:"w-5 h-5"})}),t.jsx("h2",{className:"text-lg font-semibold min-w-[140px] text-center",children:p()}),t.jsx("button",{onClick:()=>f(1),className:"p-2 hover:bg-gray-100 rounded-lg",children:t.jsx($n,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Xp,{className:"w-4 h-4 text-gray-500"}),t.jsxs("select",{value:a||"",onChange:g=>r(g.target.value?parseInt(g.target.value):void 0),className:"border rounded-lg px-3 py-2",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),o==null?void 0:o.map(g=>t.jsx("option",{value:g.id,children:g.tenPhongBan},g.id))]})]})]})}),t.jsxs("div",{className:"flex gap-4 text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"w-4 h-4 bg-green-200 rounded"}),t.jsx("span",{children:"Ngh c php"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"w-4 h-4 bg-red-200 rounded"}),t.jsx("span",{children:"Ngh khng php"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"w-4 h-4 bg-gray-200 rounded"}),t.jsx("span",{children:"Cui tun"})]})]}),t.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:u?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"ang ti..."}):d!=null&&d.length?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"sticky left-0 bg-gray-50 px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase min-w-[200px] border-r",children:"Nhn vin"}),x.map(g=>t.jsxs("th",{className:`px-2 py-3 text-center text-xs font-medium uppercase min-w-[36px] ${b(g)?"bg-gray-100 text-gray-400":"text-gray-500"}`,children:[t.jsx("div",{children:g.getDate()}),t.jsx("div",{className:"text-[10px] font-normal",children:["CN","T2","T3","T4","T5","T6","T7"][g.getDay()]})]},g.toISOString()))]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:d.map(g=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsxs("td",{className:"sticky left-0 bg-white px-4 py-2 border-r",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:g.nhanVien.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:g.nhanVien.maNhanVien})]}),x.map(y=>{const N=y.toISOString().split("T")[0],k=`${g.nhanVien.id}-${N}`,T=m.get(k);return t.jsx("td",{className:`px-1 py-2 text-center ${b(y)?"bg-gray-50":""}`,children:T&&t.jsx("div",{className:`w-6 h-6 mx-auto rounded-full flex items-center justify-center text-xs font-medium cursor-pointer ${T.nhomLoai==="CO_PHEP"?"bg-green-200 text-green-800":"bg-red-200 text-red-800"}`,title:T.loaiNghi,children:T.nhomLoai==="CO_PHEP"?"P":"K"})},y.toISOString())})]},g.nhanVien.id))})]})}):t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Khng c lch ngh php trong thng ny"})}),d&&d.length>0&&t.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[t.jsxs("h3",{className:"font-medium text-gray-700 mb-3",children:["Thng k thng ",p()]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:d.length}),t.jsx("div",{className:"text-sm text-gray-500",children:"Nhn vin c ngh"})]}),t.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:d.reduce((g,y)=>g+y.chiTietNgays.filter(N=>N.loaiNghi.nhomLoai==="CO_PHEP").length,0)}),t.jsx("div",{className:"text-sm text-gray-500",children:"Ngy ngh c php"})]}),t.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-red-600",children:d.reduce((g,y)=>g+y.chiTietNgays.filter(N=>N.loaiNghi.nhomLoai==="KHONG_PHEP").length,0)}),t.jsx("div",{className:"text-sm text-gray-500",children:"Ngy ngh khng php"})]}),t.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:d.reduce((g,y)=>g+y.chiTietNgays.length,0)}),t.jsx("div",{className:"text-sm text-gray-500",children:"Tng ngy ngh"})]})]})]})]})}const nc={layDanhSach:async e=>(await he.get("/ca-lam-viec",{params:e})).data,layDanhSachActive:async e=>(await he.get("/ca-lam-viec/active",{params:{phongBanId:e}})).data,layChiTiet:async e=>(await he.get(`/ca-lam-viec/${e}`)).data,tao:async e=>(await he.post("/ca-lam-viec",e)).data,capNhat:async(e,n)=>(await he.put(`/ca-lam-viec/${e}`,n)).data,xoa:async e=>(await he.delete(`/ca-lam-viec/${e}`)).data,toggleTrangThai:async e=>(await he.patch(`/ca-lam-viec/${e}/toggle`)).data},Sd=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#06B6D4","#84CC16"];function kV(){const e=Bt(),[n,a]=E.useState(!1),[r,s]=E.useState(null),[l,o]=E.useState(""),[d,u]=E.useState(),[x,m]=E.useState(),[f,p]=E.useState({maCa:"",tenCa:"",gioVao:"08:00",gioRa:"17:00",nghiGiuaCaPhut:60,graceInPhut:5,graceLatePhut:5,isCaDem:!1,phongBanId:void 0,moTa:"",mauHienThi:Sd[0]}),{data:b,isLoading:g}=Ie({queryKey:["ca-lam-viec",d,x,l],queryFn:()=>nc.layDanhSach({phongBanId:d,trangThai:x,tuKhoa:l||void 0})}),{data:y}=Ie({queryKey:["phong-ban"],queryFn:cn.layTatCa}),N=De({mutationFn:nc.tao,onSuccess:()=>{e.invalidateQueries({queryKey:["ca-lam-viec"]}),ie.success("To ca lm vic thnh cng"),L()},onError:O=>{var B,W;ie.error(((W=(B=O.response)==null?void 0:B.data)==null?void 0:W.message)||"C li xy ra")}}),k=De({mutationFn:({id:O,data:B})=>nc.capNhat(O,B),onSuccess:()=>{e.invalidateQueries({queryKey:["ca-lam-viec"]}),ie.success("Cp nht thnh cng"),L()},onError:O=>{var B,W;ie.error(((W=(B=O.response)==null?void 0:B.data)==null?void 0:W.message)||"C li xy ra")}}),T=De({mutationFn:nc.xoa,onSuccess:()=>{e.invalidateQueries({queryKey:["ca-lam-viec"]}),ie.success(" xa ca lm vic")},onError:O=>{var B,W;ie.error(((W=(B=O.response)==null?void 0:B.data)==null?void 0:W.message)||"C li xy ra")}}),S=De({mutationFn:nc.toggleTrangThai,onSuccess:O=>{e.invalidateQueries({queryKey:["ca-lam-viec"]}),ie.success(O.trangThai?" kch hot ca":" v hiu ha ca")}}),w=()=>{s(null),p({maCa:"",tenCa:"",gioVao:"08:00",gioRa:"17:00",nghiGiuaCaPhut:60,graceInPhut:5,graceLatePhut:5,isCaDem:!1,phongBanId:void 0,moTa:"",mauHienThi:Sd[Math.floor(Math.random()*Sd.length)]}),a(!0)},_=O=>{s(O),p({maCa:O.maCa,tenCa:O.tenCa,gioVao:O.gioVao,gioRa:O.gioRa,nghiGiuaCaPhut:O.nghiGiuaCaPhut,graceInPhut:O.graceInPhut,graceLatePhut:O.graceLatePhut,isCaDem:O.isCaDem,phongBanId:O.phongBanId||void 0,moTa:O.moTa||"",mauHienThi:O.mauHienThi||Sd[0]}),a(!0)},L=()=>{a(!1),s(null)},C=O=>{if(O.preventDefault(),!f.maCa||!f.tenCa||!f.gioVao||!f.gioRa){ie.error("Vui lng in y  thng tin bt buc");return}r?k.mutate({id:r.id,data:{tenCa:f.tenCa,gioVao:f.gioVao,gioRa:f.gioRa,nghiGiuaCaPhut:f.nghiGiuaCaPhut,graceInPhut:f.graceInPhut,graceLatePhut:f.graceLatePhut,isCaDem:f.isCaDem,phongBanId:f.phongBanId,moTa:f.moTa,mauHienThi:f.mauHienThi}}):N.mutate(f)},P=O=>{confirm(`Bn c chc mun xa ca "${O.tenCa}"?`)&&T.mutate(O.id)},F=(O,B,W,ee)=>{const[q,fe]=O.split(":").map(Number),[ne,Y]=B.split(":").map(Number);let X=q*60+fe,xe=ne*60+Y;ee&&xe<X&&(xe+=1440);const K=xe-X-W,A=Math.floor(K/60),M=K%60;return`${A}h${M>0?M+"p":""}`},H=(b==null?void 0:b.data)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Danh mc Ca lm vic"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Qun l cc ca lm vic trong cng ty"})]}),t.jsxs(mt,{onClick:w,className:"flex items-center gap-2",children:[t.jsx(St,{className:"w-4 h-4"}),"Thm ca mi"]})]}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex flex-wrap gap-4",children:[t.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[t.jsx(Hr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Tm theo m hoc tn ca...",value:l,onChange:O=>o(O.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 focus:ring-2 focus:ring-primary-500"})]}),t.jsxs("select",{value:d||"",onChange:O=>u(O.target.value?Number(O.target.value):void 0),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),y==null?void 0:y.map(O=>t.jsx("option",{value:O.id,children:O.tenPhongBan},O.id))]}),t.jsxs("select",{value:x===void 0?"":x?"active":"inactive",onChange:O=>{O.target.value===""?m(void 0):m(O.target.value==="active")},className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:[t.jsx("option",{value:"",children:"Tt c trng thi"}),t.jsx("option",{value:"active",children:"ang hot ng"}),t.jsx("option",{value:"inactive",children:"Ngng hot ng"})]})]})}),t.jsx(st,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Mu"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"M ca"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Tn ca"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Gi lm"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Thi lng"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:g?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"ang ti..."})}):H.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"Cha c ca lm vic no"})}):H.map(O=>{var B;return t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white shadow",style:{backgroundColor:O.mauHienThi||"#3B82F6"}})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"font-mono text-sm font-medium text-gray-900 dark:text-white",children:O.maCa})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-2",children:[O.isCaDem?t.jsx(ob,{className:"w-4 h-4 text-indigo-500"}):t.jsx(uj,{className:"w-4 h-4 text-amber-500"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:O.tenCa})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[t.jsx(an,{className:"w-4 h-4 text-gray-400"}),t.jsxs("span",{className:"text-gray-900 dark:text-white",children:[O.gioVao," - ",O.gioRa]})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:F(O.gioVao,O.gioRa,O.nghiGiuaCaPhut,O.isCaDem)})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:O.phongBanId?(B=y==null?void 0:y.find(W=>W.id===O.phongBanId))==null?void 0:B.tenPhongBan:"Ton cng ty"})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("button",{onClick:()=>S.mutate(O.id),className:"inline-flex items-center gap-1",title:O.trangThai?"Click  v hiu ha":"Click  kch hot",children:O.trangThai?t.jsxs(t.Fragment,{children:[t.jsx(xj,{className:"w-6 h-6 text-green-500"}),t.jsx(Tt,{variant:"success",children:"Hot ng"})]}):t.jsxs(t.Fragment,{children:[t.jsx(hj,{className:"w-6 h-6 text-gray-400"}),t.jsx(Tt,{variant:"neutral",children:"Ngng"})]})})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>_(O),className:"p-2 text-gray-500 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",title:"Chnh sa",children:t.jsx(Mr,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>P(O),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Xa",children:t.jsx(Rr,{className:"w-4 h-4"})})]})})]},O.id)})})]})})}),t.jsx(ks,{isOpen:n,onClose:L,size:"lg",children:t.jsxs("form",{onSubmit:C,children:[t.jsx(Ts,{title:r?"Chnh sa ca lm vic":"Thm ca lm vic mi"}),t.jsx(Cs,{children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["M ca ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:f.maCa,onChange:O=>p({...f,maCa:O.target.value.toUpperCase()}),disabled:!!r,placeholder:"VD: CA_HANH_CHINH",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 disabled:bg-gray-100"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Tn ca ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:f.tenCa,onChange:O=>p({...f,tenCa:O.target.value}),placeholder:"VD: Ca hnh chnh",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Gi vo ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"time",value:f.gioVao,onChange:O=>p({...f,gioVao:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Gi ra ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"time",value:f.gioRa,onChange:O=>p({...f,gioRa:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ngh gia ca (pht)"}),t.jsx("input",{type:"number",min:0,max:120,value:f.nghiGiuaCaPhut,onChange:O=>p({...f,nghiGiuaCaPhut:Number(O.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Pht c php tr"}),t.jsx("input",{type:"number",min:0,max:60,value:f.graceLatePhut,onChange:O=>p({...f,graceLatePhut:Number(O.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"p dng cho phng ban"}),t.jsxs("select",{value:f.phongBanId||"",onChange:O=>p({...f,phongBanId:O.target.value?Number(O.target.value):void 0}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:[t.jsx("option",{value:"",children:"Ton cng ty"}),y==null?void 0:y.map(O=>t.jsx("option",{value:O.id,children:O.tenPhongBan},O.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Mu hin th"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"color",value:f.mauHienThi,onChange:O=>p({...f,mauHienThi:O.target.value}),className:"w-10 h-10 border-0 rounded cursor-pointer"}),t.jsx("div",{className:"flex gap-1",children:Sd.map(O=>t.jsx("button",{type:"button",onClick:()=>p({...f,mauHienThi:O}),className:`w-6 h-6 rounded-full border-2 ${f.mauHienThi===O?"border-gray-800 dark:border-white":"border-transparent"}`,style:{backgroundColor:O}},O))})]})]}),t.jsx("div",{className:"md:col-span-2",children:t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:f.isCaDem,onChange:O=>p({...f,isCaDem:O.target.checked}),className:"w-4 h-4 text-primary-600 rounded"}),t.jsx(ob,{className:"w-4 h-4 text-indigo-500"}),t.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Ca m (qua ngy, VD: 22:00 - 06:00)"})]})}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"M t"}),t.jsx("textarea",{value:f.moTa,onChange:O=>p({...f,moTa:O.target.value}),rows:2,placeholder:"Ghi ch v ca lm vic...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800"})]})]})}),t.jsxs(ei,{children:[t.jsx(mt,{variant:"secondary",onClick:L,type:"button",children:"Hy"}),t.jsx(mt,{type:"submit",disabled:N.isPending||k.isPending,children:N.isPending||k.isPending?"ang x l...":r?"Cp nht":"To mi"})]})]})})]})}const Al={layDanhSach:async e=>(await he.get("/phan-ca",{params:e})).data,layChiTiet:async e=>(await he.get(`/phan-ca/${e}`)).data,layCalendarView:async e=>(await he.get("/phan-ca/calendar",{params:e})).data,tao:async e=>(await he.post("/phan-ca",e)).data,capNhat:async(e,n)=>(await he.put(`/phan-ca/${e}`,n)).data,assignNgay:async(e,n)=>(await he.post(`/phan-ca/${e}/assign`,n)).data,assignBatch:async(e,n)=>(await he.post(`/phan-ca/${e}/assign-batch`,n)).data,copyTuan:async(e,n)=>(await he.post(`/phan-ca/${e}/copy-week`,n)).data,publish:async e=>(await he.post(`/phan-ca/${e}/publish`)).data,unpublish:async e=>(await he.post(`/phan-ca/${e}/unpublish`)).data,xoa:async e=>(await he.delete(`/phan-ca/${e}`)).data,xoaChiTiet:async(e,n)=>(await he.post(`/phan-ca/${e}/xoa-chi-tiet`,{chiTietIds:n})).data,layLichCuaToi:async(e,n)=>(await he.get("/phan-ca/lich-cua-toi",{params:{tuNgay:e,denNgay:n}})).data},x2=["CN","T2","T3","T4","T5","T6","T7"];function TV(){var ge;const e=Bt(),[n,a]=E.useState(()=>{const z=new Date;return`${z.getFullYear()}-${String(z.getMonth()+1).padStart(2,"0")}`}),[r,s]=E.useState(),[l,o]=E.useState(null),[d,u]=E.useState(!1),[x,m]=E.useState(!1),[f,p]=E.useState(!1),[b,g]=E.useState({nhanVienIds:[],caLamViecId:0,tuNgay:"",denNgay:"",ngoaiTruThu:[]}),[y,N]=E.useState({tuanNguon:"",tuanDich:""}),{data:k}=Ie({queryKey:["phong-ban"],queryFn:cn.layTatCa}),{data:T}=Ie({queryKey:["ca-lam-viec-active",r],queryFn:()=>nc.layDanhSachActive(r)}),{data:S}=Ie({queryKey:["phan-ca",n,r],queryFn:()=>Al.layDanhSach({thangNam:n,phongBanId:r})}),{data:w,isLoading:_}=Ie({queryKey:["phan-ca-calendar",n,r],queryFn:()=>Al.layCalendarView({thangNam:n,phongBanId:r}),enabled:!!n}),{data:L}=Ie({queryKey:["nhan-vien",r],queryFn:()=>Ma.layTatCa({phongBanId:r,trangThai:"DANG_LAM",soLuong:500})}),C=De({mutationFn:Al.tao,onSuccess:z=>{e.invalidateQueries({queryKey:["phan-ca"]}),ie.success("To lch phn ca thnh cng"),o(z.id),u(!1)},onError:z=>{var le,ue;ie.error(((ue=(le=z.response)==null?void 0:le.data)==null?void 0:ue.message)||"C li xy ra")}}),P=De({mutationFn:({lichId:z,payload:le})=>Al.assignBatch(z,le),onSuccess:z=>{e.invalidateQueries({queryKey:["phan-ca-calendar"]}),ie.success(`${z.message} (${z.created} mi, ${z.updated} cp nht)`),m(!1)},onError:z=>{var le,ue;ie.error(((ue=(le=z.response)==null?void 0:le.data)==null?void 0:ue.message)||"C li xy ra")}}),F=De({mutationFn:({lichId:z,payload:le})=>Al.copyTuan(z,le),onSuccess:z=>{e.invalidateQueries({queryKey:["phan-ca-calendar"]}),ie.success(`${z.message}`),p(!1)},onError:z=>{var le,ue;ie.error(((ue=(le=z.response)==null?void 0:le.data)==null?void 0:ue.message)||"C li xy ra")}}),H=De({mutationFn:Al.publish,onSuccess:z=>{e.invalidateQueries({queryKey:["phan-ca"]}),e.invalidateQueries({queryKey:["phan-ca-calendar"]}),ie.success(`${z.message} (${z.mapped}  mapping)`)},onError:z=>{var le,ue;ie.error(((ue=(le=z.response)==null?void 0:le.data)==null?void 0:ue.message)||"C li xy ra")}}),O=De({mutationFn:({lichId:z,payload:le})=>Al.assignNgay(z,le),onSuccess:()=>{e.invalidateQueries({queryKey:["phan-ca-calendar"]})},onError:z=>{var le,ue;ie.error(((ue=(le=z.response)==null?void 0:le.data)==null?void 0:ue.message)||"C li xy ra")}}),B=E.useMemo(()=>S!=null&&S.data?l?S.data.find(z=>z.id===l):S.data.find(z=>z.trangThai!=="HUY"):null,[S,l]),W=E.useMemo(()=>{const[z,le]=n.split("-").map(Number),ue=new Date(z,le-1,1),ce=new Date(z,le,0),R=[],pe=ue.getDay();for(let tt=pe-1;tt>=0;tt--){const Ye=new Date(z,le-1,-tt);R.push({date:Ye,dateStr:Ye.toISOString().split("T")[0],isCurrentMonth:!1})}for(let tt=1;tt<=ce.getDate();tt++){const Ye=new Date(z,le-1,tt);R.push({date:Ye,dateStr:Ye.toISOString().split("T")[0],isCurrentMonth:!0})}const Oe=42-R.length;for(let tt=1;tt<=Oe;tt++){const Ye=new Date(z,le,tt);R.push({date:Ye,dateStr:Ye.toISOString().split("T")[0],isCurrentMonth:!1})}return R},[n]),ee=()=>{const[z,le]=n.split("-").map(Number),ue=new Date(z,le-2,1);a(`${ue.getFullYear()}-${String(ue.getMonth()+1).padStart(2,"0")}`)},q=()=>{const[z,le]=n.split("-").map(Number),ue=new Date(z,le,1);a(`${ue.getFullYear()}-${String(ue.getMonth()+1).padStart(2,"0")}`)},fe=()=>{C.mutate({thangNam:n,phongBanId:r,tenLich:`Lch phn ca ${n}${r?` - PB${r}`:""}`})},ne=(z,le,ue)=>{if(!B||B.trangThai==="DA_CONG_BO")return;const ce=ue==null?void 0:ue.caLamViecId,R=Y(ce);R&&O.mutate({lichId:B.id,payload:{nhanVienId:z,ngay:le,caLamViecId:R.id}})},Y=z=>{if(!T||T.length===0)return null;if(!z)return T[0];const ue=(T.findIndex(ce=>ce.id===z)+1)%(T.length+1);return ue===T.length?null:T[ue]},X=()=>{if(B){if(!b.nhanVienIds.length||!b.caLamViecId||!b.tuNgay||!b.denNgay){ie.error("Vui lng in y  thng tin");return}P.mutate({lichId:B.id,payload:b})}},xe=()=>{if(B){if(!y.tuanNguon||!y.tuanDich){ie.error("Vui lng chn tun ngun v tun ch");return}F.mutate({lichId:B.id,payload:y})}},K=()=>{B&&confirm("Bn c chc mun cng b lch? Sau khi cng b s khng th chnh sa.")&&H.mutate(B.id)},[A,M]=n.split("-").map(Number),I=`Thng ${M}/${A}`,V=(w==null?void 0:w.nhanViens)||[],J=Array.isArray(L)?L:(L==null?void 0:L.data)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[t.jsx(At,{className:"w-6 h-6 text-primary-500"}),"Lch Phn Ca"]}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Phn ca lm vic cho nhn vin theo thng"})]}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[!B&&t.jsxs(mt,{onClick:()=>u(!0),className:"flex items-center gap-2",children:[t.jsx(St,{className:"w-4 h-4"}),"To lch mi"]}),B&&B.trangThai==="NHAP"&&t.jsxs(t.Fragment,{children:[t.jsxs(mt,{variant:"secondary",onClick:()=>{var z;g({nhanVienIds:[],caLamViecId:((z=T==null?void 0:T[0])==null?void 0:z.id)||0,tuNgay:`${n}-01`,denNgay:`${n}-${(w==null?void 0:w.soNgayTrongThang)||28}`,ngoaiTruThu:[0,6]}),m(!0)},className:"flex items-center gap-2",children:[t.jsx(dn,{className:"w-4 h-4"}),"Phn ca hng lot"]}),t.jsxs(mt,{variant:"secondary",onClick:()=>p(!0),className:"flex items-center gap-2",children:[t.jsx(lj,{className:"w-4 h-4"}),"Copy tun"]}),t.jsxs(mt,{onClick:K,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700",children:[t.jsx(js,{className:"w-4 h-4"}),"Cng b lch"]})]})]})]}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:ee,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(fr,{className:"w-5 h-5"})}),t.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white min-w-[150px] text-center",children:I}),t.jsx("button",{onClick:q,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx($n,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("select",{value:r||"",onChange:z=>s(z.target.value?Number(z.target.value):void 0),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),k==null?void 0:k.map(z=>t.jsx("option",{value:z.id,children:z.tenPhongBan},z.id))]}),(S==null?void 0:S.data)&&S.data.length>0&&t.jsx("select",{value:l||(B==null?void 0:B.id)||"",onChange:z=>o(Number(z.target.value)),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800",children:S.data.map(z=>t.jsxs("option",{value:z.id,children:[z.tenLich," (",z.trangThai,")"]},z.id))})]}),B&&t.jsxs("div",{className:"flex items-center gap-2",children:[B.trangThai==="DA_CONG_BO"?t.jsxs(Tt,{variant:"success",className:"flex items-center gap-1",children:[t.jsx(ua,{className:"w-4 h-4"})," cng b"]}):B.trangThai==="NHAP"?t.jsx(Tt,{variant:"warning",className:"flex items-center gap-1",children:"ang son tho"}):t.jsx(Tt,{variant:"neutral",children:" hy"}),t.jsxs("span",{className:"text-sm text-gray-500",children:[((ge=B._count)==null?void 0:ge.chiTiets)||0," phn ca"]})]})]})}),T&&T.length>0&&t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[t.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Ch thch:"}),T.map(z=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:z.mauHienThi||"#3B82F6"}}),t.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:[z.tenCa," (",z.gioVao,"-",z.gioRa,")"]})]},z.id)),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded bg-gray-200 dark:bg-gray-700"}),t.jsx("span",{className:"text-sm text-gray-500",children:"Cha phn ca"})]})]})}),t.jsx(st,{className:"overflow-hidden",children:_?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"ang ti lch..."}):V.length===0?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Cha c nhn vin no. Hy chn phng ban hoc to lch phn ca mi."}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full border-collapse",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-800",children:[t.jsx("th",{className:"sticky left-0 z-10 bg-gray-50 dark:bg-gray-800 px-4 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 border-b border-r min-w-[180px]",children:"Nhn vin"}),W.filter(z=>z.isCurrentMonth).map(z=>{const le=z.date.getDay(),ue=le===0||le===6;return t.jsxs("th",{className:`px-1 py-2 text-center text-xs font-semibold border-b min-w-[60px] ${ue?"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-300"}`,children:[t.jsx("div",{children:x2[le]}),t.jsx("div",{className:"text-lg font-bold",children:z.date.getDate()})]},z.dateStr)})]})}),t.jsx("tbody",{children:V.map(z=>t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50",children:[t.jsxs("td",{className:"sticky left-0 z-10 bg-white dark:bg-gray-900 px-4 py-2 border-b border-r",children:[t.jsx("div",{className:"font-medium text-gray-900 dark:text-white text-sm",children:z.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:z.maNhanVien})]}),W.filter(le=>le.isCurrentMonth).map(le=>{const ue=z.ngays[le.dateStr],ce=le.date.getDay(),R=ce===0||ce===6,pe=B&&B.trangThai==="NHAP";return t.jsx("td",{onClick:()=>pe&&ne(z.nhanVienId,le.dateStr,ue),className:`px-1 py-1 border-b text-center cursor-pointer transition-colors ${R?"bg-red-50/50 dark:bg-red-900/10":""} ${pe?"hover:bg-primary-50 dark:hover:bg-primary-900/20":""}`,children:ue?t.jsx("div",{className:"px-1 py-1 rounded text-xs font-medium text-white truncate",style:{backgroundColor:ue.mauHienThi||"#3B82F6"},title:`${ue.tenCa} (${ue.gioVao}-${ue.gioRa})`,children:ue.maCa}):t.jsx("div",{className:"px-1 py-1 rounded text-xs text-gray-400",children:"-"})},le.dateStr)})]},z.nhanVienId))})]})})}),t.jsxs(ks,{isOpen:d,onClose:()=>u(!1),children:[t.jsx(Ts,{title:"To lch phn ca mi"}),t.jsx(Cs,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Thng"}),t.jsx("input",{type:"month",value:n,onChange:z=>a(z.target.value),className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phng ban"}),t.jsxs("select",{value:r||"",onChange:z=>s(z.target.value?Number(z.target.value):void 0),className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Ton cng ty"}),k==null?void 0:k.map(z=>t.jsx("option",{value:z.id,children:z.tenPhongBan},z.id))]})]})]})}),t.jsxs(ei,{children:[t.jsx(mt,{variant:"secondary",onClick:()=>u(!1),children:"Hy"}),t.jsx(mt,{onClick:fe,disabled:C.isPending,children:C.isPending?"ang to...":"To lch"})]})]}),t.jsxs(ks,{isOpen:x,onClose:()=>m(!1),size:"lg",children:[t.jsx(Ts,{title:"Phn ca hng lot"}),t.jsx(Cs,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Chn nhn vin ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("div",{className:"border rounded-lg p-2 max-h-48 overflow-y-auto",children:[t.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:b.nhanVienIds.length===J.length,onChange:z=>{g({...b,nhanVienIds:z.target.checked?J.map(le=>le.id):[]})},className:"w-4 h-4"}),t.jsx("span",{className:"font-medium",children:"Chn tt c"})]}),t.jsx("hr",{className:"my-2"}),J.map(z=>t.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:b.nhanVienIds.includes(z.id),onChange:le=>{const ue=le.target.checked?[...b.nhanVienIds,z.id]:b.nhanVienIds.filter(ce=>ce!==z.id);g({...b,nhanVienIds:ue})},className:"w-4 h-4"}),t.jsxs("span",{children:[z.hoTen," (",z.maNhanVien,")"]})]},z.id))]}),t.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[" chn: ",b.nhanVienIds.length," nhn vin"]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Ca lm vic ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("select",{value:b.caLamViecId,onChange:z=>g({...b,caLamViecId:Number(z.target.value)}),className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"-- Chn ca --"}),T==null?void 0:T.map(z=>t.jsxs("option",{value:z.id,children:[z.tenCa," (",z.gioVao," - ",z.gioRa,")"]},z.id))]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"T ngy"}),t.jsx("input",{type:"date",value:b.tuNgay,onChange:z=>g({...b,tuNgay:z.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"n ngy"}),t.jsx("input",{type:"date",value:b.denNgay,onChange:z=>g({...b,denNgay:z.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi tr cc ngy"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:x2.map((z,le)=>t.jsxs("label",{className:`px-3 py-1 rounded-full cursor-pointer border ${b.ngoaiTruThu.includes(le)?"bg-red-100 border-red-300 text-red-700":"bg-gray-100 border-gray-300"}`,children:[t.jsx("input",{type:"checkbox",className:"hidden",checked:b.ngoaiTruThu.includes(le),onChange:ue=>{const ce=ue.target.checked?[...b.ngoaiTruThu,le]:b.ngoaiTruThu.filter(R=>R!==le);g({...b,ngoaiTruThu:ce})}}),z]},le))})]})]})}),t.jsxs(ei,{children:[t.jsx(mt,{variant:"secondary",onClick:()=>m(!1),children:"Hy"}),t.jsx(mt,{onClick:X,disabled:P.isPending,children:P.isPending?"ang x l...":"Phn ca"})]})]}),t.jsxs(ks,{isOpen:f,onClose:()=>p(!1),children:[t.jsx(Ts,{title:"Copy tun"}),t.jsx(Cs,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tun ngun (chn ngy bt k trong tun)"}),t.jsx("input",{type:"date",value:y.tuanNguon,onChange:z=>N({...y,tuanNguon:z.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tun ch (chn ngy bt k trong tun)"}),t.jsx("input",{type:"date",value:y.tuanDich,onChange:z=>N({...y,tuanDich:z.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]})]})}),t.jsxs(ei,{children:[t.jsx(mt,{variant:"secondary",onClick:()=>p(!1),children:"Hy"}),t.jsx(mt,{onClick:xe,disabled:F.isPending,children:F.isPending?"ang copy...":"Copy tun"})]})]})]})}const H0=e=>({NHAP:"Nhp",CHO_DUYET_1:"Ch duyt (Cp 1)",CHO_DUYET_2:"Ch duyt (Cp 2)",DA_DUYET:" duyt",TU_CHOI:"T chi",HUY:" hy"})[e]||e,V0=e=>({NHAP:"bg-gray-100 text-gray-700",CHO_DUYET_1:"bg-yellow-100 text-yellow-700",CHO_DUYET_2:"bg-orange-100 text-orange-700",DA_DUYET:"bg-green-100 text-green-700",TU_CHOI:"bg-red-100 text-red-700",HUY:"bg-gray-100 text-gray-500"})[e]||"bg-gray-100 text-gray-700",Vl=e=>({OT:"",TRE_GIO:"",VE_SOM:"",CONG_TAC:"",LAM_TU_XA:""})[e]||"",ya={layDanhSachLoai:async e=>(await he.get("/yeu-cau/loai",{params:{all:e?"true":void 0}})).data,layLoai:async e=>(await he.get(`/yeu-cau/loai/${e}`)).data,taoLoai:async e=>(await he.post("/yeu-cau/loai",e)).data,capNhatLoai:async(e,n)=>(await he.put(`/yeu-cau/loai/${e}`,n)).data,toggleLoai:async e=>(await he.post(`/yeu-cau/loai/${e}/toggle`)).data,layDanhSachDon:async e=>(await he.get("/yeu-cau/don",{params:e})).data,layDonCuaToi:async e=>(await he.get("/yeu-cau/don/cua-toi",{params:e})).data,layChiTietDon:async e=>(await he.get(`/yeu-cau/don/${e}`)).data,taoDon:async e=>(await he.post("/yeu-cau/don",e)).data,capNhatDon:async(e,n)=>(await he.put(`/yeu-cau/don/${e}`,n)).data,guiDuyet:async e=>(await he.post(`/yeu-cau/don/${e}/gui-duyet`)).data,duyetCap1:async(e,n)=>(await he.post(`/yeu-cau/don/${e}/duyet-cap-1`,{ghiChu:n})).data,duyetCap2:async(e,n)=>(await he.post(`/yeu-cau/don/${e}/duyet-cap-2`,{ghiChu:n})).data,tuChoiCap1:async(e,n)=>(await he.post(`/yeu-cau/don/${e}/tu-choi-cap-1`,{lyDoTuChoi:n})).data,tuChoiCap2:async(e,n)=>(await he.post(`/yeu-cau/don/${e}/tu-choi-cap-2`,{lyDoTuChoi:n})).data,override:async(e,n,a)=>(await he.post(`/yeu-cau/don/${e}/override`,{lyDoOverride:n,duyet:a})).data,huyDon:async e=>(await he.post(`/yeu-cau/don/${e}/huy`)).data,layInboxCap1:async e=>(await he.get("/yeu-cau/inbox/cap-1",{params:e})).data,layInboxCap2:async e=>(await he.get("/yeu-cau/inbox/cap-2",{params:e})).data,duyetBatch:async(e,n,a)=>(await he.post("/yeu-cau/inbox/duyet-batch",{ids:e,cap:n,ghiChu:a})).data,layDanhSachWorkflowConfig:async(e,n)=>(await he.get("/yeu-cau/workflow-config",{params:{loaiYeuCauId:e,phongBanId:n}})).data,taoWorkflowConfig:async e=>(await he.post("/yeu-cau/workflow-config",e)).data,capNhatWorkflowConfig:async(e,n)=>(await he.put(`/yeu-cau/workflow-config/${e}`,n)).data};function CV(){var fe,ne;const e=Bt(),{user:n}=as(),[a,r]=E.useState(!1),[s,l]=E.useState(null),[o,d]=E.useState(null),[u,x]=E.useState(""),[m,f]=E.useState(""),[p,b]=E.useState(null),[g,y]=E.useState({nhanVienId:0,loaiYeuCauId:0,ngayYeuCau:new Date().toISOString().split("T")[0],gioBatDau:"",gioKetThuc:"",diaDiem:"",lyDo:""}),{data:N}=Ie({queryKey:["loai-yeu-cau"],queryFn:()=>ya.layDanhSachLoai()}),{data:k}=Ie({queryKey:["nhan-vien-don-gian"],queryFn:()=>Ma.layTatCa()});E.useEffect(()=>{if(k&&n){const X=(Array.isArray(k)?k:k.data||[]).find(xe=>xe.email===n.email||xe.id===n.nhanVienId);X&&(b(X),y(xe=>({...xe,nhanVienId:X.id})))}},[k,n]);const{data:T,isLoading:S}=Ie({queryKey:["don-yeu-cau-cua-toi",u,m],queryFn:()=>ya.layDonCuaToi({trangThai:u||void 0,loaiYeuCauId:m||void 0,limit:50}),enabled:!0}),w=N==null?void 0:N.find(Y=>Y.id===g.loaiYeuCauId),_=De({mutationFn:ya.taoDon,onSuccess:()=>{e.invalidateQueries({queryKey:["don-yeu-cau-cua-toi"]}),ie.success("To n yu cu thnh cng!"),F()},onError:Y=>{var X,xe;ie.error(((xe=(X=Y.response)==null?void 0:X.data)==null?void 0:xe.message)||"C li xy ra")}}),L=De({mutationFn:({id:Y,data:X})=>ya.capNhatDon(Y,X),onSuccess:()=>{e.invalidateQueries({queryKey:["don-yeu-cau-cua-toi"]}),ie.success("Cp nht n thnh cng!"),F()},onError:Y=>{var X,xe;ie.error(((xe=(X=Y.response)==null?void 0:X.data)==null?void 0:xe.message)||"C li xy ra")}}),C=De({mutationFn:ya.guiDuyet,onSuccess:Y=>{e.invalidateQueries({queryKey:["don-yeu-cau-cua-toi"]}),ie.success(` gi n ${Y.maDon}  duyt!`)},onError:Y=>{var X,xe;ie.error(((xe=(X=Y.response)==null?void 0:X.data)==null?void 0:xe.message)||"C li xy ra")}}),P=De({mutationFn:ya.huyDon,onSuccess:()=>{e.invalidateQueries({queryKey:["don-yeu-cau-cua-toi"]}),ie.success(" hy n!")},onError:Y=>{var X,xe;ie.error(((xe=(X=Y.response)==null?void 0:X.data)==null?void 0:xe.message)||"C li xy ra")}}),F=()=>{y({nhanVienId:(p==null?void 0:p.id)||0,loaiYeuCauId:0,ngayYeuCau:new Date().toISOString().split("T")[0],gioBatDau:"",gioKetThuc:"",diaDiem:"",lyDo:""}),l(null),r(!1)},H=Y=>{l(Y),y({nhanVienId:Y.nhanVienId,loaiYeuCauId:Y.loaiYeuCauId,ngayYeuCau:Y.ngayYeuCau.split("T")[0],gioBatDau:Y.gioBatDau||"",gioKetThuc:Y.gioKetThuc||"",diaDiem:Y.diaDiem||"",lyDo:Y.lyDo}),r(!0)},O=()=>{var Y;if(!g.loaiYeuCauId){ie.error("Vui lng chn loi yu cu");return}if(!g.lyDo.trim()){ie.error("Vui lng nhp l do");return}if(w!=null&&w.yeuCauGioBatDau&&!g.gioBatDau){ie.error("Vui lng nhp gi bt u");return}if(w!=null&&w.yeuCauGioKetThuc&&!g.gioKetThuc){ie.error("Vui lng nhp gi kt thc");return}if(w!=null&&w.yeuCauDiaDiem&&!((Y=g.diaDiem)!=null&&Y.trim())){ie.error("Vui lng nhp a im");return}s?L.mutate({id:s.id,data:g}):_.mutate(g)},B=Y=>{confirm(`Gi n ${Y.maDon}  duyt?`)&&C.mutate(Y.id)},W=Y=>{confirm(`Hy n ${Y.maDon}?`)&&P.mutate(Y.id)},ee=Y=>new Date(Y).toLocaleDateString("vi-VN"),q=(T==null?void 0:T.data)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"n yu cu ca ti"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"To v qun l n OT, Tr gi, V sm, Cng tc, Lm t xa"})]}),t.jsxs("button",{onClick:()=>{F(),r(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[t.jsx(St,{className:"w-5 h-5"}),"To n mi"]})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("select",{value:m,onChange:Y=>f(Y.target.value?Number(Y.target.value):""),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[t.jsx("option",{value:"",children:"Tt c loi"}),N==null?void 0:N.map(Y=>t.jsxs("option",{value:Y.id,children:[Vl(Y.maLoai)," ",Y.tenLoai]},Y.id))]}),t.jsxs("select",{value:u,onChange:Y=>x(Y.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[t.jsx("option",{value:"",children:"Tt c trng thi"}),t.jsx("option",{value:"NHAP",children:"Nhp"}),t.jsx("option",{value:"CHO_DUYET_1",children:"Ch duyt (Cp 1)"}),t.jsx("option",{value:"CHO_DUYET_2",children:"Ch duyt (Cp 2)"}),t.jsx("option",{value:"DA_DUYET",children:" duyt"}),t.jsx("option",{value:"TU_CHOI",children:"T chi"}),t.jsx("option",{value:"HUY",children:" hy"})]})]}),t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:S?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"ang ti..."}):q.length===0?t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx(ha,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Cha c n yu cu no"})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"M n"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Loi"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:q.map(Y=>{var X,xe;return t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:Y.maDon})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{children:Vl(((X=Y.loaiYeuCau)==null?void 0:X.maLoai)||"")}),t.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:(xe=Y.loaiYeuCau)==null?void 0:xe.tenLoai})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300",children:ee(Y.ngayYeuCau)}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300",children:[Y.gioBatDau&&Y.gioKetThuc?`${Y.gioBatDau} - ${Y.gioKetThuc}`:Y.gioBatDau||"-",Y.soGio&&t.jsxs("span",{className:"ml-2 text-blue-600 dark:text-blue-400",children:["(",Y.soGio,"h)"]})]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${V0(Y.trangThai)}`,children:H0(Y.trangThai)})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx("button",{onClick:()=>d(Y),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Xem chi tit",children:t.jsx(ii,{className:"w-4 h-4"})}),["NHAP","TU_CHOI"].includes(Y.trangThai)&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>H(Y),className:"p-2 text-gray-500 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg transition-colors",title:"Sa",children:t.jsx(Mr,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>B(Y),className:"p-2 text-gray-500 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Gi duyt",children:t.jsx(gu,{className:"w-4 h-4"})})]}),["NHAP","CHO_DUYET_1","CHO_DUYET_2","TU_CHOI"].includes(Y.trangThai)&&t.jsx("button",{onClick:()=>W(Y),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Hy n",children:t.jsx(mn,{className:"w-4 h-4"})})]})})]},Y.id)})})]})})}),a&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[t.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:t.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:s?"Sa n yu cu":"To n yu cu mi"})}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Loi yu cu ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs("select",{value:g.loaiYeuCauId,onChange:Y=>y({...g,loaiYeuCauId:Number(Y.target.value)}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",disabled:!!s,children:[t.jsx("option",{value:0,children:"-- Chn loi yu cu --"}),N==null?void 0:N.map(Y=>t.jsxs("option",{value:Y.id,children:[Vl(Y.maLoai)," ",Y.tenLoai]},Y.id))]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Ngy ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ut,{value:g.ngayYeuCau,onChange:Y=>y({...g,ngayYeuCau:Y})})]}),((w==null?void 0:w.yeuCauGioBatDau)||g.gioBatDau)&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Gi bt u ",(w==null?void 0:w.yeuCauGioBatDau)&&t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"time",value:g.gioBatDau,onChange:Y=>y({...g,gioBatDau:Y.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),((w==null?void 0:w.yeuCauGioKetThuc)||g.gioKetThuc)&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Gi kt thc ",(w==null?void 0:w.yeuCauGioKetThuc)&&t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"time",value:g.gioKetThuc,onChange:Y=>y({...g,gioKetThuc:Y.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),((w==null?void 0:w.yeuCauDiaDiem)||g.diaDiem)&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["a im ",(w==null?void 0:w.yeuCauDiaDiem)&&t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:g.diaDiem,onChange:Y=>y({...g,diaDiem:Y.target.value}),placeholder:"Nhp a im...",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["L do ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("textarea",{value:g.lyDo,onChange:Y=>y({...g,lyDo:Y.target.value}),placeholder:"Nhp l do yu cu...",rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none"})]})]}),t.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[t.jsx("button",{onClick:F,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700",children:"Hy"}),t.jsx("button",{onClick:O,disabled:_.isPending||L.isPending,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:_.isPending||L.isPending?"ang lu...":s?"Cp nht":"To n"})]})]})}),o&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Chi tit n ",o.maDon]}),t.jsx("button",{onClick:()=>d(null),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(mn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Loi yu cu"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[Vl(((fe=o.loaiYeuCau)==null?void 0:fe.maLoai)||"")," ",(ne=o.loaiYeuCau)==null?void 0:ne.tenLoai]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Trng thi"}),t.jsx("span",{className:`inline-block px-2 py-1 text-xs font-medium rounded-full ${V0(o.trangThai)}`,children:H0(o.trangThai)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Ngy yu cu"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:ee(o.ngayYeuCau)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Thi gian"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[o.gioBatDau&&o.gioKetThuc?`${o.gioBatDau} - ${o.gioKetThuc}`:o.gioBatDau||"-",o.soGio&&` (${o.soGio}h)`]})]})]}),o.diaDiem&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"a im"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:o.diaDiem})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"L do"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:o.lyDo})]}),o.nguoiDuyet1&&t.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Duyt cp 1"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[o.nguoiDuyet1.hoTen," -"," ",o.ngayDuyet1&&ee(o.ngayDuyet1)]}),o.ghiChuDuyet1&&t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:o.ghiChuDuyet1})]}),o.nguoiDuyet2&&t.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Duyt cp 2"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[o.nguoiDuyet2.hoTen," -"," ",o.ngayDuyet2&&ee(o.ngayDuyet2)]}),o.ghiChuDuyet2&&t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:o.ghiChuDuyet2})]}),o.lyDoTuChoi&&t.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[t.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 font-medium",children:"L do t chi"}),t.jsx("p",{className:"text-red-700 dark:text-red-300",children:o.lyDoTuChoi})]}),o.isOverride&&t.jsxs("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[t.jsxs("p",{className:"text-sm text-yellow-600 dark:text-yellow-400 font-medium flex items-center gap-1",children:[t.jsx(dl,{className:"w-4 h-4"})," Override"]}),t.jsx("p",{className:"text-yellow-700 dark:text-yellow-300",children:o.lyDoOverride})]})]})]})})]})}function SV(){var A,M,I,V,J,ge;const e=Bt(),[n,a]=E.useState("cap1"),[r,s]=E.useState(null),[l,o]=E.useState(null),[d,u]=E.useState(null),[x,m]=E.useState(""),[f,p]=E.useState(""),[b,g]=E.useState(!0),[y,N]=E.useState(new Set),[k,T]=E.useState({phongBanId:void 0,loaiYeuCauId:void 0,tuNgay:"",denNgay:"",page:1}),{data:S}=Ie({queryKey:["phong-ban"],queryFn:cn.layTatCa}),{data:w}=Ie({queryKey:["loai-yeu-cau"],queryFn:()=>ya.layDanhSachLoai()}),{data:_,isLoading:L,refetch:C}=Ie({queryKey:["don-yeu-cau-duyet",n,k],queryFn:()=>n==="cap1"?ya.layInboxCap1({phongBanId:k.phongBanId,loaiYeuCauId:k.loaiYeuCauId,tuNgay:k.tuNgay||void 0,denNgay:k.denNgay||void 0,page:k.page,limit:20}):n==="cap2"?ya.layInboxCap2({phongBanId:k.phongBanId,loaiYeuCauId:k.loaiYeuCauId,tuNgay:k.tuNgay||void 0,denNgay:k.denNgay||void 0,page:k.page,limit:20}):ya.layDanhSachDon({phongBanId:k.phongBanId,loaiYeuCauId:k.loaiYeuCauId,tuNgay:k.tuNgay||void 0,denNgay:k.denNgay||void 0,page:k.page,limit:20})}),P=De({mutationFn:z=>ya.duyetCap1(z),onSuccess:z=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),ie.success(` duyt n ${z.maDon}!`)},onError:z=>{var le,ue;ie.error(((ue=(le=z.response)==null?void 0:le.data)==null?void 0:ue.message)||"C li xy ra")}}),F=De({mutationFn:z=>ya.duyetCap2(z),onSuccess:z=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),ie.success(` duyt n ${z.maDon}!`)},onError:z=>{var le,ue;ie.error(((ue=(le=z.response)==null?void 0:le.data)==null?void 0:ue.message)||"C li xy ra")}}),H=De({mutationFn:({id:z,lyDo:le})=>ya.tuChoiCap1(z,le),onSuccess:z=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),ie.success(` t chi n ${z.maDon}`),o(null),m("")},onError:z=>{var le,ue;ie.error(((ue=(le=z.response)==null?void 0:le.data)==null?void 0:ue.message)||"C li xy ra")}}),O=De({mutationFn:({id:z,lyDo:le})=>ya.tuChoiCap2(z,le),onSuccess:z=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),ie.success(` t chi n ${z.maDon}`),o(null),m("")},onError:z=>{var le,ue;ie.error(((ue=(le=z.response)==null?void 0:le.data)==null?void 0:ue.message)||"C li xy ra")}}),B=De({mutationFn:({id:z,lyDo:le,duyet:ue})=>ya.override(z,le,ue),onSuccess:z=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),ie.success(` override n ${z.maDon}`),u(null),p("")},onError:z=>{var le,ue;ie.error(((ue=(le=z.response)==null?void 0:le.data)==null?void 0:ue.message)||"C li xy ra")}}),W=De({mutationFn:({ids:z,cap:le})=>ya.duyetBatch(z,le),onSuccess:z=>{e.invalidateQueries({queryKey:["don-yeu-cau-duyet"]}),ie.success(` duyt ${z.success} n thnh cng!`),z.failed>0&&ie.error(`${z.failed} n tht bi`),N(new Set)},onError:z=>{var le,ue;ie.error(((ue=(le=z.response)==null?void 0:le.data)==null?void 0:ue.message)||"C li xy ra")}}),ee=z=>new Date(z).toLocaleDateString("vi-VN"),q=z=>{z.trangThai==="CHO_DUYET_1"?P.mutate(z.id):z.trangThai==="CHO_DUYET_2"&&F.mutate(z.id)},fe=()=>{if(!l||!x.trim()){ie.error("Vui lng nhp l do t chi");return}l.trangThai==="CHO_DUYET_1"?H.mutate({id:l.id,lyDo:x}):O.mutate({id:l.id,lyDo:x})},ne=()=>{if(!d||!f.trim()){ie.error("Vui lng nhp l do override");return}B.mutate({id:d.id,lyDo:f,duyet:b})},Y=()=>{if(y.size===0){ie.error("Cha chn n no");return}const z=n==="cap1"?1:2;W.mutate({ids:Array.from(y),cap:z})},X=z=>{const le=new Set(y);le.has(z)?le.delete(z):le.add(z),N(le)},xe=()=>{const z=(_==null?void 0:_.data)||[];y.size===z.length?N(new Set):N(new Set(z.map(le=>le.id)))},K=(_==null?void 0:_.data)||[];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Duyt yu cu"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Duyt n OT, Tr gi, V sm, Cng tc ca nhn vin"})]}),t.jsxs("button",{onClick:()=>C(),className:"flex items-center gap-2 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700",children:[t.jsx(Ba,{className:"w-4 h-4"}),"Lm mi"]})]}),t.jsxs("div",{className:"flex gap-2 border-b border-gray-200 dark:border-gray-700",children:[t.jsx("button",{onClick:()=>{a("cap1"),N(new Set)},className:`px-4 py-2 font-medium transition-colors ${n==="cap1"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Cp 1 (Manager)"}),t.jsx("button",{onClick:()=>{a("cap2"),N(new Set)},className:`px-4 py-2 font-medium transition-colors ${n==="cap2"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Cp 2 (HR)"}),t.jsx("button",{onClick:()=>{a("tat-ca"),N(new Set)},className:`px-4 py-2 font-medium transition-colors ${n==="tat-ca"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Tt c"})]}),t.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[t.jsxs("select",{value:k.phongBanId||"",onChange:z=>T({...k,phongBanId:z.target.value?Number(z.target.value):void 0,page:1}),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),S==null?void 0:S.map(z=>t.jsx("option",{value:z.id,children:z.tenPhongBan},z.id))]}),t.jsxs("select",{value:k.loaiYeuCauId||"",onChange:z=>T({...k,loaiYeuCauId:z.target.value?Number(z.target.value):void 0,page:1}),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[t.jsx("option",{value:"",children:"Tt c loi"}),w==null?void 0:w.map(z=>t.jsxs("option",{value:z.id,children:[Vl(z.maLoai)," ",z.tenLoai]},z.id))]}),y.size>0&&(n==="cap1"||n==="cap2")&&t.jsxs("button",{onClick:Y,disabled:W.isPending,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:[t.jsx(ua,{className:"w-4 h-4"}),"Duyt ",y.size," n"]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[L?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"ang ti..."}):K.length===0?t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx(dn,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Khng c n yu cu no"})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:t.jsxs("tr",{children:[(n==="cap1"||n==="cap2")&&t.jsx("th",{className:"px-4 py-3 text-left",children:t.jsx("input",{type:"checkbox",checked:y.size===K.length&&K.length>0,onChange:xe,className:"w-4 h-4 rounded"})}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"M n"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Loi"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Ngy"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Thi gian"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:K.map(z=>{var le,ue,ce,R;return t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[(n==="cap1"||n==="cap2")&&t.jsx("td",{className:"px-4 py-4",children:t.jsx("input",{type:"checkbox",checked:y.has(z.id),onChange:()=>X(z.id),className:"w-4 h-4 rounded"})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:z.maDon})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:(le=z.nhanVien)==null?void 0:le.hoTen}),t.jsx("p",{className:"text-sm text-gray-500",children:(ue=z.nhanVien)==null?void 0:ue.maNhanVien})]})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{children:Vl(((ce=z.loaiYeuCau)==null?void 0:ce.maLoai)||"")}),t.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:(R=z.loaiYeuCau)==null?void 0:R.tenLoai})]})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300",children:ee(z.ngayYeuCau)}),t.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300",children:[z.gioBatDau&&z.gioKetThuc?`${z.gioBatDau} - ${z.gioKetThuc}`:z.gioBatDau||"-",z.soGio&&t.jsxs("span",{className:"ml-2 text-blue-600 dark:text-blue-400",children:["(",z.soGio,"h)"]})]}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${V0(z.trangThai)}`,children:H0(z.trangThai)})}),t.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx("button",{onClick:()=>s(z),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Xem chi tit",children:t.jsx(ii,{className:"w-4 h-4"})}),["CHO_DUYET_1","CHO_DUYET_2"].includes(z.trangThai)&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>q(z),className:"p-2 text-gray-500 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Duyt",children:t.jsx(ua,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>o(z),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"T chi",children:t.jsx(xo,{className:"w-4 h-4"})})]}),n==="tat-ca"&&!["HUY"].includes(z.trangThai)&&t.jsx("button",{onClick:()=>{u(z),g(z.trangThai==="TU_CHOI")},className:"p-2 text-gray-500 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg transition-colors",title:"Override",children:t.jsx(aa,{className:"w-4 h-4"})})]})})]},z.id)})})]})}),(_==null?void 0:_.pagination)&&_.pagination.totalPages>1&&t.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[t.jsxs("span",{className:"text-sm text-gray-500",children:["Trang ",_.pagination.page," / ",_.pagination.totalPages," (",_.pagination.total," n)"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>T({...k,page:k.page-1}),disabled:k.page<=1,className:"p-2 border rounded-lg disabled:opacity-50",children:t.jsx(fr,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>T({...k,page:k.page+1}),disabled:k.page>=_.pagination.totalPages,className:"p-2 border rounded-lg disabled:opacity-50",children:t.jsx($n,{className:"w-4 h-4"})})]})]})]}),r&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Chi tit n ",r.maDon]}),t.jsx("button",{onClick:()=>s(null),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(mn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Nhn vin"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[(A=r.nhanVien)==null?void 0:A.hoTen," (",(M=r.nhanVien)==null?void 0:M.maNhanVien,")"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Phng ban"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:(I=r.phongBan)==null?void 0:I.tenPhongBan})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Loi yu cu"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[Vl(((V=r.loaiYeuCau)==null?void 0:V.maLoai)||"")," ",(J=r.loaiYeuCau)==null?void 0:J.tenLoai]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Trng thi"}),t.jsx("span",{className:`inline-block px-2 py-1 text-xs font-medium rounded-full ${V0(r.trangThai)}`,children:H0(r.trangThai)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Ngy yu cu"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:ee(r.ngayYeuCau)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Thi gian"}),t.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[r.gioBatDau&&r.gioKetThuc?`${r.gioBatDau} - ${r.gioKetThuc}`:r.gioBatDau||"-",r.soGio&&` (${r.soGio}h)`]})]})]}),r.diaDiem&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"a im"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:r.diaDiem})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"L do"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:r.lyDo})]}),r.lyDoTuChoi&&t.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[t.jsx("p",{className:"text-sm text-red-600 font-medium",children:"L do t chi"}),t.jsx("p",{className:"text-red-700",children:r.lyDoTuChoi})]})]}),["CHO_DUYET_1","CHO_DUYET_2"].includes(r.trangThai)&&t.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{o(r),s(null)},className:"px-4 py-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50",children:"T chi"}),t.jsx("button",{onClick:()=>{q(r),s(null)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Duyt"})]})]})}),l&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md",children:[t.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["T chi n ",l.maDon]})}),t.jsxs("div",{className:"p-6",children:[t.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:["T chi yu cu ca ",t.jsx("strong",{children:(ge=l.nhanVien)==null?void 0:ge.hoTen}),"?"]}),t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["L do t chi ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("textarea",{value:x,onChange:z=>m(z.target.value),placeholder:"Nhp l do t chi...",rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none"})]}),t.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{o(null),m("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:fe,disabled:H.isPending||O.isPending,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:"T chi"})]})]})}),d&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md",children:[t.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Override n ",d.maDon]})}),t.jsxs("div",{className:"p-6 space-y-4",children:[t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"radio",checked:b,onChange:()=>g(!0),className:"w-4 h-4"}),t.jsx("span",{className:"text-green-600 font-medium",children:"Override Duyt"})]}),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"radio",checked:!b,onChange:()=>g(!1),className:"w-4 h-4"}),t.jsx("span",{className:"text-red-600 font-medium",children:"Override T chi"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["L do override ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("textarea",{value:f,onChange:z=>p(z.target.value),placeholder:"Nhp l do override...",rows:3,className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none"})]})]}),t.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{u(null),p("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Hy"}),t.jsx("button",{onClick:ne,disabled:B.isPending,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:opacity-50",children:"Override"})]})]})})]})}const Ji={layDanhSach:async e=>(await he.get("/thong-bao",{params:e})).data,demChuaDoc:async()=>(await he.get("/thong-bao/chua-doc")).data,danhDauDaDoc:async e=>(await he.put(`/thong-bao/${e}/da-doc`)).data,danhDauTatCaDaDoc:async()=>(await he.post("/thong-bao/da-doc-tat-ca")).data},AT=e=>{const n=new Date(e),r=new Date().getTime()-n.getTime(),s=Math.floor(r/6e4),l=Math.floor(r/36e5),o=Math.floor(r/864e5);return s<1?"Va xong":s<60?`${s} pht trc`:l<24?`${l} gi trc`:o<7?`${o} ngy trc`:n.toLocaleDateString("vi-VN")},FT=e=>{switch(e){case"YEU_CAU_MOI":return{icon:"",color:"text-blue-600"};case"YEU_CAU_DA_DUYET":return{icon:"",color:"text-green-600"};case"YEU_CAU_TU_CHOI":return{icon:"",color:"text-red-600"};case"NGHI_PHEP_MOI":return{icon:"",color:"text-blue-600"};case"NGHI_PHEP_DA_DUYET":return{icon:"",color:"text-green-600"};case"NGHI_PHEP_TU_CHOI":return{icon:"",color:"text-red-600"};case"LICH_PHAN_CA":return{icon:"",color:"text-purple-600"};case"PHIEU_LUONG":return{icon:"",color:"text-green-600"};case"HE_THONG":default:return{icon:"",color:"text-gray-600"}}};function _V({className:e=""}){var b;const n=mr(),a=Bt(),[r,s]=E.useState(!1),l=E.useRef(null),{data:o}=Ie({queryKey:["thong-bao","chua-doc"],queryFn:()=>Ji.demChuaDoc(),refetchInterval:3e4}),{data:d,isLoading:u}=Ie({queryKey:["thong-bao","list",{limit:10}],queryFn:()=>Ji.layDanhSach({limit:10}),enabled:r}),x=De({mutationFn:g=>Ji.danhDauDaDoc(g),onSuccess:()=>{a.invalidateQueries({queryKey:["thong-bao"]})}}),m=De({mutationFn:()=>Ji.danhDauTatCaDaDoc(),onSuccess:()=>{a.invalidateQueries({queryKey:["thong-bao"]})}});E.useEffect(()=>{const g=y=>{l.current&&!l.current.contains(y.target)&&s(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]);const f=g=>{g.daDoc||x.mutate(g.id),g.link&&(n(g.link),s(!1))},p=(o==null?void 0:o.chuaDoc)||0;return t.jsxs("div",{className:`relative ${e}`,ref:l,children:[t.jsxs("button",{onClick:()=>s(!r),className:"relative p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"Thng bo",children:[t.jsx(Nc,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"}),p>0&&t.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] flex items-center justify-center bg-red-500 text-white text-xs font-bold rounded-full px-1",children:p>99?"99+":p})]}),r&&t.jsxs("div",{className:"absolute right-0 top-full mt-2 w-80 max-h-[70vh] bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 overflow-hidden z-50 animate-scale-in",children:[t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Thng bo"}),t.jsxs("div",{className:"flex items-center gap-2",children:[p>0&&t.jsxs("button",{onClick:()=>m.mutate(),className:"text-xs text-blue-600 hover:text-blue-700 flex items-center gap-1",disabled:m.isPending,children:[t.jsx(sj,{className:"w-3 h-3"}),"c tt c"]}),t.jsx("button",{onClick:()=>s(!1),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:t.jsx(mn,{className:"w-4 h-4 text-gray-500"})})]})]}),t.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:u?t.jsx("div",{className:"p-4 text-center text-gray-500",children:"ang ti..."}):(b=d==null?void 0:d.data)!=null&&b.length?d.data.map(g=>{const{icon:y,color:N}=FT(g.loaiThongBao);return t.jsx("button",{onClick:()=>f(g),className:`w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors border-b border-gray-100 dark:border-gray-700 last:border-0 ${g.daDoc?"":"bg-blue-50/50 dark:bg-blue-900/20"}`,children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx("span",{className:`text-xl ${N}`,children:y}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsx("p",{className:`text-sm font-medium truncate ${g.daDoc?"text-gray-600 dark:text-gray-400":"text-gray-900 dark:text-white"}`,children:g.tieuDe}),!g.daDoc&&t.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-1.5"})]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5 line-clamp-2",children:g.noiDung}),t.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:AT(g.ngayTao)})]})]})},g.id)}):t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx(Nc,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),t.jsx("p",{children:"Khng c thng bo"})]})}),d&&d.total>10&&t.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 p-2",children:t.jsxs("button",{onClick:()=>{n("/thong-bao"),s(!1)},className:"w-full text-center text-sm text-blue-600 hover:text-blue-700 py-2",children:["Xem tt c (",d.total,")"]})})]})]})}const If=[{id:"home",label:"Trang ch",icon:W0,path:"/portal"},{id:"schedule",label:"Lch lm",icon:At,path:"/portal/lich-lam"},{id:"attendance",label:"Chm cng",icon:an,path:"/portal/cham-cong"},{id:"requests",label:"Yu cu",icon:ha,path:"/portal/yeu-cau"},{id:"profile",label:"C nhn",icon:ro,path:"/portal/ca-nhan"}];function EV(){var x,m;const e=_s(),n=mr(),{user:a,dangXuat:r}=as(),[s,l]=E.useState(!1),o=((x=If.find(f=>e.pathname===f.path))==null?void 0:x.id)||"home",d=()=>{const f=If.find(p=>e.pathname.startsWith(p.path));return(f==null?void 0:f.label)||"Portal"},u=async()=>{await r(),n("/dang-nhap")};return t.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex flex-col",children:[t.jsx("header",{className:"sticky top-0 z-40 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-between max-w-lg mx-auto",children:[e.pathname!=="/portal"?t.jsx("button",{onClick:()=>n(-1),className:"p-2 -ml-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(fr,{className:"w-5 h-5"})}):t.jsx("div",{className:"w-9"}),t.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:d()}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(_V,{}),t.jsx("button",{onClick:()=>l(!s),className:"p-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(L_,{className:"w-5 h-5"})})]})]})}),s&&t.jsx("div",{className:"fixed inset-0 z-50 bg-black/50",onClick:()=>l(!1),children:t.jsxs("div",{className:"absolute right-0 top-0 h-full w-64 bg-white dark:bg-gray-800 shadow-xl",onClick:f=>f.stopPropagation(),children:[t.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[t.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:"Menu"}),t.jsx("button",{onClick:()=>l(!1),className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(mn,{className:"w-5 h-5"})})]}),t.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-semibold",children:((m=a==null?void 0:a.hoTen)==null?void 0:m[0])||"U"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a==null?void 0:a.hoTen}),t.jsx("p",{className:"text-sm text-gray-500",children:a==null?void 0:a.email})]})]})}),t.jsxs("nav",{className:"p-2",children:[t.jsxs("button",{onClick:()=>n("/"),className:"w-full flex items-center gap-3 px-4 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:[t.jsx(W0,{className:"w-5 h-5"}),t.jsx("span",{children:"V trang Admin"})]}),t.jsxs("button",{onClick:u,className:"w-full flex items-center gap-3 px-4 py-3 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg",children:[t.jsx(Qp,{className:"w-5 h-5"}),t.jsx("span",{children:"ng xut"})]})]})]})}),t.jsx("main",{className:"flex-1 overflow-y-auto pb-20",children:t.jsx("div",{className:"max-w-lg mx-auto px-4 py-4",children:t.jsx(X2,{})})}),t.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-40 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 safe-area-pb",children:t.jsx("div",{className:"max-w-lg mx-auto flex items-center justify-around h-16",children:If.map(f=>{const p=f.icon,b=o===f.id;return t.jsxs("button",{onClick:()=>n(f.path),className:`flex flex-col items-center justify-center flex-1 h-full transition-colors ${b?"text-blue-600 dark:text-blue-400":"text-gray-500 dark:text-gray-400"}`,children:[t.jsx(p,{className:`w-5 h-5 mb-1 ${b?"stroke-[2.5]":""}`}),t.jsx("span",{className:`text-xs ${b?"font-medium":""}`,children:f.label})]},f.id)})})})]})}const Rc={getDashboard:async()=>(await he.get("/employee-portal/dashboard")).data,getLichLamViec:async e=>(await he.get("/employee-portal/lich-lam-viec",{params:e})).data,getChamCong:async e=>(await he.get("/employee-portal/cham-cong",{params:e})).data,getPhieuLuong:async e=>(await he.get("/employee-portal/phieu-luong",{params:e})).data,getChiTietPhieuLuong:async e=>(await he.get(`/employee-portal/phieu-luong/${e}`)).data,getSoDuPhep:async()=>(await he.get("/employee-portal/so-du-phep")).data,getHoSo:async()=>(await he.get("/employee-portal/ho-so")).data,checkIn:async()=>(await he.post("/employee-portal/check-in")).data,checkOut:async()=>(await he.post("/employee-portal/check-out")).data},DV=e=>["CN","T2","T3","T4","T5","T6","T7"][e]||"",AV=e=>["Ch nht","Th hai","Th ba","Th t","Th nm","Th su","Th by"][e]||"",U0=e=>{if(!e)return"--:--";const n=new Date(e);return`${String(n.getHours()).padStart(2,"0")}:${String(n.getMinutes()).padStart(2,"0")}`},Of=e=>new Intl.NumberFormat("vi-VN").format(e)+"",FV="tinh_luong_auth",Vn=Zt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});Vn.interceptors.request.use(e=>{const n=localStorage.getItem(FV);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e},e=>Promise.reject(e));const hr={layDanhSachGeofence:e=>Vn.get("/anti-fraud/geofence",{params:e}).then(n=>n.data),layGeofence:e=>Vn.get(`/anti-fraud/geofence/${e}`).then(n=>n.data),taoGeofence:e=>Vn.post("/anti-fraud/geofence",e).then(n=>n.data),capNhatGeofence:(e,n)=>Vn.put(`/anti-fraud/geofence/${e}`,n).then(a=>a.data),xoaGeofence:e=>Vn.delete(`/anti-fraud/geofence/${e}`).then(n=>n.data),layGeofenceCuaToi:()=>Vn.get("/anti-fraud/my-geofence").then(e=>e.data),gpsCheckin:e=>Vn.post("/anti-fraud/gps-checkin",e).then(n=>n.data),layLichSuGPS:e=>Vn.get("/anti-fraud/gps-logs",{params:e}).then(n=>n.data),layLichSuGPSCuaToi:e=>Vn.get("/anti-fraud/my-gps-logs",{params:e}).then(n=>n.data),thongKeGPS:(e,n,a)=>Vn.get("/anti-fraud/thong-ke",{params:{tuNgay:e,denNgay:n,phongBanId:a}}).then(r=>r.data),layDanhSachThietBi:e=>Vn.get("/anti-fraud/devices",{params:e}).then(n=>n.data),layThietBiNhanVien:e=>Vn.get(`/anti-fraud/devices/${e}`).then(n=>n.data),layThietBiCuaToi:()=>Vn.get("/anti-fraud/my-device").then(e=>e.data),kiemTraDevice:e=>Vn.post("/anti-fraud/check-device",{deviceId:e}).then(n=>n.data),bindDevice:e=>Vn.post("/anti-fraud/bind-device",e).then(n=>n.data),resetDevice:e=>Vn.post("/anti-fraud/reset-device",e).then(n=>n.data),blockDevice:(e,n)=>Vn.post(`/anti-fraud/block-device/${e}`,{lyDo:n}).then(a=>a.data),layLichSuThietBi:e=>Vn.get("/anti-fraud/device-history",{params:e}).then(n=>n.data)},LT=()=>new Promise((e,n)=>{if(!navigator.geolocation){n(new Error("Trnh duyt khng h tr GPS"));return}navigator.geolocation.getCurrentPosition(a=>{e({viDo:a.coords.latitude,kinhDo:a.coords.longitude,doChinhXacMet:Math.round(a.coords.accuracy)})},a=>{switch(a.code){case a.PERMISSION_DENIED:n(new Error("Bn  t chi quyn truy cp GPS"));break;case a.POSITION_UNAVAILABLE:n(new Error("Khng th xc nh v tr"));break;case a.TIMEOUT:n(new Error("Qu thi gian ch GPS"));break;default:n(new Error("Li GPS khng xc nh"))}},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),LV=()=>{const e="tinh_luong_device_id";let n=localStorage.getItem(e);return n||(n=`WEB-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,localStorage.setItem(e,n)),n};function PV(){var N,k,T,S,w,_;const e=mr(),n=Bt(),[a,r]=E.useState(null),[s,l]=E.useState("idle"),[o,d]=E.useState(null),{data:u,isLoading:x}=Ie({queryKey:["employee-portal","dashboard"],queryFn:()=>Rc.getDashboard(),refetchInterval:6e4}),{data:m}=Ie({queryKey:["my-geofences"],queryFn:()=>hr.layGeofenceCuaToi()}),f=De({mutationFn:async L=>{l("getting");let C={};const P=m==null?void 0:m.some(F=>F.batBuocGPS);if(P||m!=null&&m.length)try{C=await LT(),l("success")}catch(F){if(P)throw l("error"),new Error(F.message||"Khng th ly v tr GPS");l("idle")}return hr.gpsCheckin({loaiChamCong:L,viDo:C.viDo,kinhDo:C.kinhDo,doChinhXacMet:C.doChinhXacMet,deviceId:LV()})},onSuccess:L=>{var C;r(null),l("idle"),d({trongVung:L.trongVung,khoangCachMet:L.khoangCachMet,geofenceName:(C=L.geofence)==null?void 0:C.tenDiaDiem}),n.invalidateQueries({queryKey:["employee-portal","dashboard"]})},onError:L=>{var C,P;l("error"),r(((P=(C=L.response)==null?void 0:C.data)==null?void 0:P.message)||L.message||"Li khi chm cng")}}),p=f.isPending,b=()=>{var L;r(null),d(null),((L=u==null?void 0:u.chamCongHomNay)==null?void 0:L.trangThai)==="DA_VAO"?f.mutate("CHECK_OUT"):f.mutate("CHECK_IN")};if(x)return t.jsx("div",{className:"space-y-4",children:[1,2,3].map(L=>t.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"},L))});const y=(()=>{var C;const L=(C=u==null?void 0:u.chamCongHomNay)==null?void 0:C.trangThai;return L==="DA_RA"?{label:" ra",color:"text-green-600",bg:"bg-green-100 dark:bg-green-900/30"}:L==="DA_VAO"?{label:" vo",color:"text-blue-600",bg:"bg-blue-100 dark:bg-blue-900/30"}:{label:"Cha vo",color:"text-gray-500",bg:"bg-gray-100 dark:bg-gray-700"}})();return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 rounded-2xl p-5 text-white shadow-lg",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-blue-100 text-sm",children:"Xin cho,"}),t.jsx("h2",{className:"text-xl font-bold mt-1",children:u==null?void 0:u.nhanVien.hoTen}),t.jsxs("p",{className:"text-blue-200 text-sm mt-1",children:[u==null?void 0:u.nhanVien.chucVu,"  ",u==null?void 0:u.nhanVien.phongBan]})]}),t.jsx("div",{className:"w-12 h-12 rounded-full bg-white/20 flex items-center justify-center text-xl font-bold",children:((N=u==null?void 0:u.nhanVien.hoTen)==null?void 0:N[0])||"N"})]}),u!=null&&u.caHomNay?t.jsxs("div",{className:"mt-4 bg-white/10 rounded-xl p-3 flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:u.caHomNay.mauHienThi||"#3B82F6"},children:t.jsx(an,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm text-blue-100",children:"Ca hm nay"}),t.jsxs("p",{className:"font-semibold",children:[u.caHomNay.tenCa," (",u.caHomNay.gioVao," - ",u.caHomNay.gioRa,")"]})]})]}):t.jsxs("div",{className:"mt-4 bg-white/10 rounded-xl p-3 flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/20 flex items-center justify-center",children:t.jsx(At,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-blue-100",children:"Hm nay"}),t.jsx("p",{className:"font-semibold",children:"Khng c ca lm vic"})]})]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-5 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:`w-14 h-14 rounded-xl ${y.bg} flex items-center justify-center`,children:((k=u==null?void 0:u.chamCongHomNay)==null?void 0:k.trangThai)==="DA_RA"?t.jsx(ua,{className:`w-7 h-7 ${y.color}`}):((T=u==null?void 0:u.chamCongHomNay)==null?void 0:T.trangThai)==="DA_VAO"?t.jsx(Qp,{className:`w-7 h-7 ${y.color}`}):t.jsx(F_,{className:`w-7 h-7 ${y.color}`})}),t.jsxs("div",{children:[t.jsx("p",{className:`text-sm ${y.color} font-medium`,children:y.label}),((S=u==null?void 0:u.chamCongHomNay)==null?void 0:S.gioVao)&&t.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:["Vo: ",U0(u.chamCongHomNay.gioVao),u.chamCongHomNay.gioRa&&`  Ra: ${U0(u.chamCongHomNay.gioRa)}`]})]})]}),((w=u==null?void 0:u.chamCongHomNay)==null?void 0:w.trangThai)!=="DA_RA"&&t.jsx("button",{onClick:b,disabled:p,className:`px-4 py-2 rounded-xl font-medium transition-colors flex items-center gap-2 ${p?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} text-white`,children:p?t.jsxs(t.Fragment,{children:[t.jsx(Mn,{className:"w-4 h-4 animate-spin"}),"ang x l..."]}):((_=u==null?void 0:u.chamCongHomNay)==null?void 0:_.trangThai)==="DA_VAO"?"Check-out":"Check-in"})]}),a&&t.jsxs("p",{className:"text-sm text-red-500 mt-3 flex items-center gap-1",children:[t.jsx(aa,{className:"w-4 h-4"}),a]}),o&&t.jsxs("div",{className:`text-sm mt-3 flex items-center gap-2 ${o.trongVung?"text-green-600":"text-yellow-600"}`,children:[t.jsx(Wd,{className:"w-4 h-4"}),o.trongVung?t.jsxs("span",{children:[' Trong vng "',o.geofenceName,'"',o.khoangCachMet&&` (cch ${o.khoangCachMet}m)`]}):o.khoangCachMet?t.jsxs("span",{children:[" Ngoi vng cho php (cch ",o.khoangCachMet,"m)"]}):null]}),s==="getting"&&t.jsxs("p",{className:"text-sm text-blue-500 mt-3 flex items-center gap-2",children:[t.jsx(jc,{className:"w-4 h-4 animate-pulse"}),"ang ly v tr GPS..."]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[t.jsxs("button",{onClick:()=>e("/portal/yeu-cau"),className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700 text-center",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center mx-auto",children:t.jsx(ha,{className:"w-5 h-5 text-orange-600"})}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-2",children:(u==null?void 0:u.thongKe.soDonChoDuyet)||0}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"n ch duyt"})]}),t.jsxs("button",{onClick:()=>e("/portal/ca-nhan"),className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700 text-center",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 dark:bg-green-900/30 flex items-center justify-center mx-auto",children:t.jsx(At,{className:"w-5 h-5 text-green-600"})}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-2",children:(u==null?void 0:u.thongKe.soNgayPhepConLai)||0}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Php cn li"})]}),t.jsxs("button",{onClick:()=>e("/portal/cham-cong"),className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700 text-center",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center mx-auto",children:t.jsx(f0,{className:"w-5 h-5 text-blue-600"})}),t.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-2",children:(u==null?void 0:u.thongKe.soNgayCongThang)||0}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Ngy cng"})]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-5 py-3 border-b border-gray-200 dark:border-gray-700",children:t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Thao tc nhanh"})}),t.jsx("div",{children:[{label:"Xem lch lm vic",icon:At,path:"/portal/lich-lam",color:"text-blue-600"},{label:"To n yu cu",icon:ha,path:"/portal/yeu-cau",color:"text-orange-600"},{label:"Xem phiu lng",icon:f0,path:"/portal/ca-nhan",color:"text-green-600"}].map(L=>t.jsxs("button",{onClick:()=>e(L.path),className:"w-full flex items-center justify-between px-5 py-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(L.icon,{className:`w-5 h-5 ${L.color}`}),t.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:L.label})]}),t.jsx($n,{className:"w-5 h-5 text-gray-400"})]},L.path))})]})]})}function IV(){const[e,n]=E.useState(0),a=m=>{const f=new Date,p=f.getDay(),b=new Date(f);b.setDate(f.getDate()-(p===0?6:p-1)+m*7),b.setHours(0,0,0,0);const g=new Date(b);return g.setDate(b.getDate()+6),{monday:b,sunday:g}},{monday:r,sunday:s}=a(e),{data:l,isLoading:o}=Ie({queryKey:["employee-portal","lich-lam-viec",r.toISOString()],queryFn:()=>Rc.getLichLamViec({tuNgay:r.toISOString().split("T")[0],denNgay:s.toISOString().split("T")[0]})}),d=()=>{const m=f=>`${f.getDate()}/${f.getMonth()+1}`;return`${m(r)} - ${m(s)}`},u=m=>{const f=new Date().toISOString().split("T")[0];return m===f},x=m=>{const f=new Date;return f.setHours(0,0,0,0),new Date(m)<f};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("button",{onClick:()=>n(e-1),className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(fr,{className:"w-5 h-5"})}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:d()}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e===0?"Tun ny":e>0?`+${e} tun`:`${e} tun`})]}),t.jsx("button",{onClick:()=>n(e+1),className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx($n,{className:"w-5 h-5"})})]}),e!==0&&t.jsx("button",{onClick:()=>n(0),className:"w-full mt-3 py-2 text-sm text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg font-medium",children:"V tun hin ti"})]}),o?t.jsx("div",{className:"space-y-3",children:[1,2,3,4,5,6,7].map(m=>t.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"},m))}):t.jsx("div",{className:"space-y-3",children:l==null?void 0:l.map(m=>t.jsx("div",{className:`bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border transition-all ${u(m.ngay)?"border-blue-500 ring-2 ring-blue-100 dark:ring-blue-900/50":"border-gray-200 dark:border-gray-700"} ${x(m.ngay)&&!u(m.ngay)?"opacity-60":""}`,children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsxs("div",{className:`w-14 h-14 rounded-xl flex flex-col items-center justify-center ${u(m.ngay)?"bg-blue-600 text-white":m.thuTrongTuan===0||m.thuTrongTuan===6?"bg-gray-100 dark:bg-gray-700 text-gray-500":"bg-gray-50 dark:bg-gray-700/50 text-gray-700 dark:text-gray-300"}`,children:[t.jsx("span",{className:"text-xs font-medium",children:DV(m.thuTrongTuan)}),t.jsx("span",{className:"text-lg font-bold",children:new Date(m.ngay).getDate()})]}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[AV(m.thuTrongTuan),", ",new Date(m.ngay).toLocaleDateString("vi-VN")]}),m.nghiPhep?t.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 rounded-lg bg-green-100 dark:bg-green-900/30 flex items-center justify-center",children:t.jsx(j_,{className:"w-4 h-4 text-green-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-green-600",children:m.nghiPhep.loaiNghi}),t.jsx("p",{className:"text-xs text-gray-500",children:m.nghiPhep.trangThai})]})]}):m.ca?t.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:m.ca.mauHienThi||"#3B82F6"},children:t.jsx(f0,{className:"w-4 h-4 text-white"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:m.ca.tenCa}),t.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[m.ca.gioVao," - ",m.ca.gioRa]})]})]}):t.jsxs("div",{className:"mt-2 flex items-center gap-2 text-gray-400",children:[t.jsx(At,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"Khng c ca lm vic"})]})]})]})},m.ngay))})]})}function OV(){var y,N,k,T,S,w;const e=new Date,[n,a]=E.useState(e.getMonth()+1),[r,s]=E.useState(e.getFullYear()),{data:l,isLoading:o}=Ie({queryKey:["employee-portal","cham-cong",n,r],queryFn:()=>Rc.getChamCong({thang:n,nam:r})}),d=n===e.getMonth()+1&&r===e.getFullYear(),{data:u,isLoading:x}=Ie({queryKey:["employee-portal","san-luong",n,r],queryFn:async()=>{var _;try{const L=await he.get("/san-luong/my-stats",{params:{thang:n,nam:r}});return((_=L.data)==null?void 0:_.data)||L.data}catch{return null}},enabled:d}),m=()=>{n===1?(a(12),s(r-1)):a(n-1)},f=()=>{n===12?(a(1),s(r+1)):a(n+1)},p=_=>{switch(_){case"DU_CONG":return{text:" cng",color:"text-green-600 bg-green-50 dark:bg-green-900/30"};case"DI_TRE":return{text:"i tr",color:"text-yellow-600 bg-yellow-50 dark:bg-yellow-900/30"};case"VE_SOM":return{text:"V sm",color:"text-yellow-600 bg-yellow-50 dark:bg-yellow-900/30"};case"NGHI_KHONG_PHEP":return{text:"Ngh K.Php",color:"text-red-600 bg-red-50 dark:bg-red-900/30"};case"NGHI_CO_PHEP":return{text:"Ngh php",color:"text-blue-600 bg-blue-50 dark:bg-blue-900/30"};default:return{text:_,color:"text-gray-600 bg-gray-50 dark:bg-gray-700"}}},b={duCong:(l==null?void 0:l.filter(_=>_.trangThai==="DU_CONG").length)||0,diTre:(l==null?void 0:l.filter(_=>_.trangThai==="DI_TRE").length)||0,veSom:(l==null?void 0:l.filter(_=>_.trangThai==="VE_SOM").length)||0,nghiKhongPhep:(l==null?void 0:l.filter(_=>_.trangThai==="NGHI_KHONG_PHEP").length)||0},g=_=>{const L=new Date().toISOString().split("T")[0];return _===L};return t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("button",{onClick:m,className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(fr,{className:"w-5 h-5"})}),t.jsx("div",{className:"text-center",children:t.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:["Thng ",n,"/",r]})}),t.jsx("button",{onClick:f,className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx($n,{className:"w-5 h-5"})})]})}),t.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[t.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 rounded-xl p-3 text-center",children:[t.jsx("p",{className:"text-xl font-bold text-green-600",children:b.duCong}),t.jsx("p",{className:"text-xs text-green-600",children:" cng"})]}),t.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/30 rounded-xl p-3 text-center",children:[t.jsx("p",{className:"text-xl font-bold text-yellow-600",children:b.diTre}),t.jsx("p",{className:"text-xs text-yellow-600",children:"i tr"})]}),t.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/30 rounded-xl p-3 text-center",children:[t.jsx("p",{className:"text-xl font-bold text-orange-600",children:b.veSom}),t.jsx("p",{className:"text-xs text-orange-600",children:"V sm"})]}),t.jsxs("div",{className:"bg-red-50 dark:bg-red-900/30 rounded-xl p-3 text-center",children:[t.jsx("p",{className:"text-xl font-bold text-red-600",children:b.nghiKhongPhep}),t.jsx("p",{className:"text-xs text-red-600",children:"K.Php"})]})]}),d&&t.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-500 rounded-2xl p-4 shadow-md text-white",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(li,{className:"w-5 h-5"}),t.jsx("h3",{className:"font-semibold",children:"Sn lng thng ny"})]}),x?t.jsx("div",{className:"h-16 bg-white/20 rounded-xl animate-pulse"}):u?t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[(((y=u.chiaHang)==null?void 0:y.tongSanPham)>0||u.chiaHang)&&t.jsxs("div",{className:"bg-white/20 rounded-xl p-3",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx(Jp,{className:"w-4 h-4"}),t.jsx("span",{className:"text-xs opacity-80",children:"Chia hng"})]}),t.jsxs("p",{className:"text-lg font-bold",children:[(((N=u.chiaHang)==null?void 0:N.tongSanPham)||0).toLocaleString("vi-VN"),t.jsx("span",{className:"text-xs font-normal ml-1",children:"SP"})]}),((k=u.chiaHang)==null?void 0:k.sanPhamLoi)>0&&t.jsxs("p",{className:"text-xs opacity-80",children:["Li: ",u.chiaHang.sanPhamLoi.toLocaleString("vi-VN")]})]}),(((T=u.giaoHang)==null?void 0:T.tongKhoiLuong)>0||u.giaoHang)&&t.jsxs("div",{className:"bg-white/20 rounded-xl p-3",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx(eg,{className:"w-4 h-4"}),t.jsx("span",{className:"text-xs opacity-80",children:"Giao hng"})]}),t.jsxs("p",{className:"text-lg font-bold",children:[(((S=u.giaoHang)==null?void 0:S.tongKhoiLuong)||0).toLocaleString("vi-VN"),t.jsx("span",{className:"text-xs font-normal ml-1",children:"kg"})]}),((w=u.giaoHang)==null?void 0:w.soLuotGiao)>0&&t.jsxs("p",{className:"text-xs opacity-80",children:[u.giaoHang.soLuotGiao," lt giao"]})]}),u.diemKPI>0&&t.jsx("div",{className:"bg-white/20 rounded-xl p-3 col-span-2",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm",children:"im KPI"}),t.jsx("span",{className:"text-xl font-bold",children:u.diemKPI.toFixed(1)})]})}),!u.chiaHang&&!u.giaoHang&&!u.diemKPI&&t.jsx("div",{className:"col-span-2 text-center py-2 text-sm opacity-80",children:"Cha c d liu sn lng"})]}):t.jsx("div",{className:"text-center py-2 text-sm opacity-80",children:"Cha c d liu sn lng"})]}),o?t.jsx("div",{className:"space-y-3",children:[1,2,3,4,5].map(_=>t.jsx("div",{className:"h-16 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"},_))}):l&&l.length>0?t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:l.map((_,L)=>{const C=p(_.trangThai);return t.jsxs("div",{className:`flex items-center gap-4 px-4 py-3 ${L<l.length-1?"border-b border-gray-100 dark:border-gray-700":""} ${g(_.ngay)?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[t.jsxs("div",{className:"w-12 text-center",children:[t.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:new Date(_.ngay).getDate()}),t.jsx("p",{className:"text-xs text-gray-500",children:["CN","T2","T3","T4","T5","T6","T7"][new Date(_.ngay).getDay()]})]}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Vo:"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:U0(_.gioVaoThucTe)}),t.jsx("span",{className:"text-gray-400",children:""}),t.jsx("span",{className:"text-gray-500",children:"Ra:"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:U0(_.gioRaThucTe)})]}),_.ca&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Ca: ",_.ca.tenCa]})]}),t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-lg ${C.color}`,children:C.text})]},_.ngay)})}):t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx(an,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Cha c d liu chm cng"})]})]})}const Fl=[{value:"NGHI_PHEP",label:"Ngh php nm",icon:"",nhom:"NGHI_PHEP"},{value:"NGHI_KHONG_LUONG",label:"Ngh khng lng",icon:"",nhom:"NGHI_PHEP"},{value:"NGHI_OM",label:"Ngh m",icon:"",nhom:"NGHI_PHEP"},{value:"NGHI_VIEC_RIENG",label:"Ngh vic ring",icon:"",nhom:"NGHI_PHEP"},{value:"OT",label:"Lm thm gi",icon:"",nhom:"THOI_GIAN"},{value:"TRE_GIO",label:"i tr",icon:"",nhom:"THOI_GIAN"},{value:"VE_SOM",label:"V sm",icon:"",nhom:"THOI_GIAN"},{value:"CONG_TAC",label:"Cng tc",icon:"",nhom:"DI_CHUYEN"},{value:"WFH",label:"Lm vic t xa",icon:"",nhom:"DI_CHUYEN"}];function MV(){var g,y;const[e,n]=E.useState(!1),[a,r]=E.useState("ALL"),s=Bt(),[l,o]=E.useState({loai:"NGHI_PHEP",ngay:new Date().toISOString().split("T")[0],soNgay:1,soGio:1,lyDo:""}),{data:d,isLoading:u}=Ie({queryKey:["employee-portal","yeu-cau",a],queryFn:async()=>{const N={};return a!=="ALL"&&(N.trangThai=a),(await he.get("/yeu-cau/my-requests",{params:N})).data.data||[]}}),x=De({mutationFn:async N=>(await he.post("/yeu-cau",N)).data,onSuccess:()=>{s.invalidateQueries({queryKey:["employee-portal","yeu-cau"]}),n(!1),o({loai:"NGHI_PHEP",ngay:new Date().toISOString().split("T")[0],soNgay:1,soGio:1,lyDo:""})}}),m=N=>{switch(N){case"DA_DUYET":return{text:" duyt",color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",icon:Or};case"TU_CHOI":return{text:"T chi",color:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",icon:mn};case"CHO_DUYET":default:return{text:"Ch duyt",color:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",icon:an}}},f=N=>{var k;return((k=Fl.find(T=>T.value===N))==null?void 0:k.label)||N},p=N=>{var k;return((k=Fl.find(T=>T.value===N))==null?void 0:k.icon)||""},b=N=>{if(N.preventDefault(),!l.lyDo.trim()){alert("Vui lng nhp l do");return}x.mutate(l)};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("button",{onClick:()=>n(!0),className:"w-full flex items-center justify-center gap-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 rounded-2xl font-medium shadow-md",children:[t.jsx(St,{className:"w-5 h-5"}),"To yu cu mi"]}),t.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:[{value:"ALL",label:"Tt c"},{value:"CHO_DUYET",label:"Ch duyt"},{value:"DA_DUYET",label:" duyt"},{value:"TU_CHOI",label:"T chi"}].map(N=>t.jsx("button",{onClick:()=>r(N.value),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors ${a===N.value?"bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300"}`,children:N.label},N.value))}),u?t.jsx("div",{className:"space-y-3",children:[1,2,3].map(N=>t.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"},N))}):d&&d.length>0?t.jsx("div",{className:"space-y-3",children:d.map(N=>{const k=m(N.trangThai),T=k.icon;return t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"text-2xl",children:p(N.loai)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:f(N.loai)}),t.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${k.color}`,children:[t.jsx(T,{className:"w-3 h-3"}),k.text]})]}),t.jsxs("p",{className:"text-sm text-gray-500 mb-1",children:[new Date(N.ngay).toLocaleDateString("vi-VN"),"  ",N.soGio," gi"]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:N.lyDo})]}),t.jsx($n,{className:"w-5 h-5 text-gray-400"})]})},N.id)})}):t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx(dl,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Cha c yu cu no"})]}),e&&t.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-end justify-center",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 w-full max-w-lg rounded-t-3xl p-6 pb-10 animate-slide-up",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"To yu cu mi"}),t.jsx("button",{onClick:()=>n(!1),className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(mn,{className:"w-5 h-5"})})]}),t.jsxs("form",{onSubmit:b,className:"space-y-4",children:[t.jsxs("div",{className:"max-h-[40vh] overflow-y-auto pr-1",children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:" Ngh php"}),t.jsx("div",{className:"grid grid-cols-2 gap-2 mb-4",children:Fl.filter(N=>N.nhom==="NGHI_PHEP").map(N=>t.jsxs("button",{type:"button",onClick:()=>o({...l,loai:N.value}),className:`flex items-center gap-2 px-3 py-2.5 rounded-xl border-2 transition-colors text-sm ${l.loai===N.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600"}`,children:[t.jsx("span",{className:"text-lg",children:N.icon}),t.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:N.label})]},N.value))}),t.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:" Thi gian"}),t.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:Fl.filter(N=>N.nhom==="THOI_GIAN").map(N=>t.jsxs("button",{type:"button",onClick:()=>o({...l,loai:N.value}),className:`flex items-center gap-1 px-3 py-2.5 rounded-xl border-2 transition-colors text-sm ${l.loai===N.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600"}`,children:[t.jsx("span",{className:"text-lg",children:N.icon}),t.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:N.label})]},N.value))}),t.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:" Di chuyn / Lm vic t xa"}),t.jsx("div",{className:"grid grid-cols-2 gap-2",children:Fl.filter(N=>N.nhom==="DI_CHUYEN").map(N=>t.jsxs("button",{type:"button",onClick:()=>o({...l,loai:N.value}),className:`flex items-center gap-2 px-3 py-2.5 rounded-xl border-2 transition-colors text-sm ${l.loai===N.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600"}`,children:[t.jsx("span",{className:"text-lg",children:N.icon}),t.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:N.label})]},N.value))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Ngy bt u"}),t.jsx("input",{type:"date",value:l.ngay,onChange:N=>o({...l,ngay:N.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),((g=Fl.find(N=>N.value===l.loai))==null?void 0:g.nhom)==="NGHI_PHEP"&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"S ngy ngh"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("input",{type:"number",min:"0.5",max:"30",step:"0.5",value:l.soNgay,onChange:N=>o({...l,soNgay:parseFloat(N.target.value)}),className:"flex-1 px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),t.jsx("span",{className:"text-sm text-gray-500",children:"ngy"})]})]}),((y=Fl.find(N=>N.value===l.loai))==null?void 0:y.nhom)==="THOI_GIAN"&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"S gi"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("input",{type:"number",min:"0.5",max:"12",step:"0.5",value:l.soGio,onChange:N=>o({...l,soGio:parseFloat(N.target.value)}),className:"flex-1 px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),t.jsx("span",{className:"text-sm text-gray-500",children:"gi"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"L do"}),t.jsx("textarea",{value:l.lyDo,onChange:N=>o({...l,lyDo:N.target.value}),rows:3,placeholder:"Nhp l do yu cu...",className:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none"})]}),t.jsx("button",{type:"submit",disabled:x.isPending,className:"w-full py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl font-medium disabled:opacity-50",children:x.isPending?"ang gi...":"Gi yu cu"})]})]})})]})}function RV(){const[e,n]=E.useState("ho-so");return t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-1 shadow-sm border border-gray-200 dark:border-gray-700",children:t.jsx("div",{className:"flex",children:[{id:"ho-so",label:"H s",icon:ro},{id:"phieu-luong",label:"Phiu lng",icon:ha},{id:"so-du-phep",label:"S d php",icon:At}].map(a=>t.jsxs("button",{onClick:()=>n(a.id),className:`flex-1 flex items-center justify-center gap-1.5 py-2.5 rounded-xl text-sm font-medium transition-colors ${e===a.id?"bg-blue-500 text-white":"text-gray-600 dark:text-gray-300"}`,children:[t.jsx(a.icon,{className:"w-4 h-4"}),a.label]},a.id))})}),e==="ho-so"&&t.jsx(BV,{}),e==="phieu-luong"&&t.jsx(HV,{}),e==="so-du-phep"&&t.jsx(VV,{})]})}function BV(){var a;const{data:e,isLoading:n}=Ie({queryKey:["employee-portal","ho-so"],queryFn:()=>Rc.getHoSo()});return n?t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"}),t.jsx("div",{className:"h-48 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"})]}):e?t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl p-6 text-white",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-16 h-16 bg-white/20 backdrop-blur rounded-full flex items-center justify-center text-2xl font-bold",children:e.hoTen.charAt(0)}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold",children:e.hoTen}),t.jsx("p",{className:"text-blue-100",children:e.maNhanVien}),e.chucVu&&t.jsx("p",{className:"text-sm text-blue-200 mt-1",children:e.chucVu})]})]})}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx(_d,{icon:p_,label:"Phng ban",value:typeof e.phongBan=="object"?(a=e.phongBan)==null?void 0:a.tenPhongBan:e.phongBan||"Cha c"}),t.jsx(_d,{icon:Yp,label:"Email",value:e.email||"Cha cp nht"}),t.jsx(_d,{icon:M_,label:"in thoi",value:e.soDienThoai||"Cha cp nht"}),t.jsx(_d,{icon:At,label:"Ngy vo lm",value:e.ngayVaoLam?new Date(e.ngayVaoLam).toLocaleDateString("vi-VN"):"Cha c"}),t.jsx(_d,{icon:k_,label:"STK ngn hng",value:e.soTaiKhoan||"Cha cp nht",last:!0})]}),e.nganHang&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx(K_,{className:"w-5 h-5 text-blue-500"}),t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Thng tin ngn hng"})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("p",{className:"text-gray-500",children:"Ngn hng"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:e.nganHang.tenNganHang})]})]})]}):t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center",children:[t.jsx(ro,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Khng tm thy thng tin"})]})}function _d({icon:e,label:n,value:a,last:r=!1}){return t.jsxs("div",{className:`flex items-center gap-3 px-4 py-3 ${r?"":"border-b border-gray-100 dark:border-gray-700"}`,children:[t.jsx(e,{className:"w-5 h-5 text-gray-400"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-xs text-gray-500",children:n}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a})]})]})}function HV(){const{data:e,isLoading:n}=Ie({queryKey:["employee-portal","phieu-luong"],queryFn:()=>Rc.getPhieuLuong()});if(n)return t.jsx("div",{className:"space-y-3",children:[1,2,3].map(r=>t.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"},r))});const a=(e==null?void 0:e.data)||[];return a.length===0?t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center",children:[t.jsx(ha,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Cha c phiu lng"})]}):t.jsx("div",{className:"space-y-3",children:a.map(r=>t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h4",{className:"font-semibold text-gray-900 dark:text-white",children:["Thng ",r.thang,"/",r.nam]}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:r.kyLuong})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-lg font-bold text-green-600",children:Of(r.thucLinh)}),t.jsx("p",{className:"text-xs text-gray-500",children:"Thc nhn"})]})]}),t.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100 dark:border-gray-700",children:t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-500",children:"Thu nhp"}),t.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:Of(r.tongThuNhap)})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-500",children:"Khu tr"}),t.jsx("p",{className:"font-medium text-red-600",children:Of(r.tongKhauTru)})]})]})})]},r.id))})}function VV(){var d;const{data:e,isLoading:n}=Ie({queryKey:["employee-portal","so-du-phep"],queryFn:()=>Rc.getSoDuPhep()});if(n)return t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"}),t.jsx("div",{className:"h-24 bg-gray-200 dark:bg-gray-700 rounded-2xl animate-pulse"})]});if(!e)return t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 text-center",children:[t.jsx(At,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"Khng c d liu"})]});const a=e.phepNam,r=(a==null?void 0:a.conLai)||0,s=(a==null?void 0:a.tongSo)||12,l=(a==null?void 0:a.daSuDung)||0,o=s>0?l/s*100:0;return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl p-6 text-white",children:[t.jsx("p",{className:"text-emerald-100 mb-2",children:"S ngy php cn li"}),t.jsxs("div",{className:"flex items-end gap-2",children:[t.jsx("span",{className:"text-5xl font-bold",children:r}),t.jsxs("span",{className:"text-emerald-200 mb-1",children:["/ ",s," ngy"]})]}),t.jsx("div",{className:"mt-4",children:t.jsx("div",{className:"h-2 bg-white/20 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-white rounded-full transition-all",style:{width:`${100-o}%`}})})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx("p",{className:"text-sm text-gray-500 mb-1",children:" s dng"}),t.jsx("p",{className:"text-2xl font-bold text-blue-600",children:l}),t.jsx("p",{className:"text-xs text-gray-400",children:"ngy"})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Loi ngh khc"}),t.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:((d=e.danhSachLoaiNghi)==null?void 0:d.length)||0}),t.jsx("p",{className:"text-xs text-gray-400",children:"loi"})]})]}),e.danhSachLoaiNghi&&e.danhSachLoaiNghi.length>0&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Chi tit cc loi ngh"}),t.jsx("div",{className:"space-y-2",children:e.danhSachLoaiNghi.map(u=>t.jsxs("div",{className:"flex justify-between items-center text-sm",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:u.tenLoai}),t.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[u.soNgayDaSuDung," ngy"]})]},u.maLoai))})]}),t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-2xl p-4",children:[t.jsx("h4",{className:"font-medium text-blue-800 dark:text-blue-300 mb-2",children:"Lu "}),t.jsxs("ul",{className:"text-sm text-blue-700 dark:text-blue-400 space-y-1",children:[t.jsxs("li",{children:[" S ngy php c tnh theo nm ",new Date().getFullYear()]}),t.jsx("li",{children:" Php khng s dng ht s chuyn sang nm sau (ti a 5 ngy)"}),t.jsx("li",{children:" Lin h HR  c h tr"})]})]})]})}function m2(){var k;const e=mr(),n=Bt(),[a,r]=E.useState("tat-ca"),[s,l]=E.useState(1),o=20,{data:d,isLoading:u,refetch:x,isFetching:m}=Ie({queryKey:["thong-bao","list",{page:s,limit:o,filter:a}],queryFn:()=>Ji.layDanhSach({page:s,limit:o,daDoc:a==="chua-doc"?!1:a==="da-doc"?!0:void 0})}),{data:f}=Ie({queryKey:["thong-bao","chua-doc"],queryFn:()=>Ji.demChuaDoc()}),p=De({mutationFn:T=>Ji.danhDauDaDoc(T),onSuccess:()=>{n.invalidateQueries({queryKey:["thong-bao"]})}}),b=De({mutationFn:()=>Ji.danhDauTatCaDaDoc(),onSuccess:()=>{n.invalidateQueries({queryKey:["thong-bao"]})}}),g=T=>{T.daDoc||p.mutate(T.id),T.link&&e(T.link)},y=d?Math.ceil(d.total/o):1,N=(f==null?void 0:f.chuaDoc)||0;return t.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[t.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-10",children:t.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h1",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[t.jsx(Nc,{className:"w-5 h-5"}),"Thng bo",N>0&&t.jsxs("span",{className:"bg-red-500 text-white text-xs px-2 py-0.5 rounded-full",children:[N," cha c"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>x(),disabled:m,className:"p-2 text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg disabled:opacity-50",title:"Lm mi",children:t.jsx(Ba,{className:`w-4 h-4 ${m?"animate-spin":""}`})}),N>0&&t.jsxs("button",{onClick:()=>b.mutate(),disabled:b.isPending,className:"flex items-center gap-1 px-3 py-1.5 text-sm text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg disabled:opacity-50",children:[t.jsx(sj,{className:"w-4 h-4"}),"c tt c"]})]})]}),t.jsx("div",{className:"flex gap-1 bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[{id:"tat-ca",label:"Tt c"},{id:"chua-doc",label:"Cha c"},{id:"da-doc",label:" c"}].map(T=>t.jsxs("button",{onClick:()=>{r(T.id),l(1)},className:`flex-1 px-4 py-2 text-sm font-medium rounded-md transition-colors ${a===T.id?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:[T.label,T.id==="chua-doc"&&N>0&&t.jsxs("span",{className:"ml-1 text-xs text-red-500",children:["(",N,")"]})]},T.id))})]})}),t.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-4",children:[u?t.jsx("div",{className:"space-y-4",children:[...Array(5)].map((T,S)=>t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 animate-pulse",children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gray-200 dark:bg-gray-700 rounded-full"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-2"}),t.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-full"})]})]})},S))}):(k=d==null?void 0:d.data)!=null&&k.length?t.jsx("div",{className:"space-y-2",children:d.data.map(T=>{const{icon:S,color:w}=FT(T.loaiThongBao);return t.jsx("button",{onClick:()=>g(T),className:`w-full text-left bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm hover:shadow-md transition-all border border-gray-100 dark:border-gray-700 ${T.daDoc?"":"ring-2 ring-blue-500/20"}`,children:t.jsxs("div",{className:"flex gap-4",children:[t.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-xl ${T.daDoc?"bg-gray-100 dark:bg-gray-700":"bg-blue-100 dark:bg-blue-900/30"} ${w}`,children:S}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsx("h3",{className:`font-medium ${T.daDoc?"text-gray-600 dark:text-gray-400":"text-gray-900 dark:text-white"}`,children:T.tieuDe}),t.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[!T.daDoc&&t.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),t.jsx("span",{className:"text-xs text-gray-400",children:AT(T.ngayTao)})]})]}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1 line-clamp-2",children:T.noiDung}),T.link&&t.jsx("p",{className:"text-xs text-blue-500 mt-2",children:"Nhn  xem chi tit "})]})]})},T.id)})}):t.jsxs("div",{className:"text-center py-16",children:[t.jsx(Nc,{className:"w-12 h-12 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:a==="chua-doc"?"Khng c thng bo cha c":a==="da-doc"?"Khng c thng bo  c":"Cha c thng bo no"})]}),d&&y>1&&t.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[t.jsx("button",{onClick:()=>l(T=>Math.max(1,T-1)),disabled:s===1,className:"px-4 py-2 text-sm bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg disabled:opacity-50 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Trc"}),t.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Trang ",s," / ",y]}),t.jsx("button",{onClick:()=>l(T=>Math.min(y,T+1)),disabled:s===y,className:"px-4 py-2 text-sm bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg disabled:opacity-50 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Sau"})]})]})]})}function UV(){const e=Bt(),[n,a]=E.useState(!1),[r,s]=E.useState(null),[l,o]=E.useState(),[d,u]=E.useState(""),[x,m]=E.useState({tenDiaDiem:"",diaChi:"",viDo:0,kinhDo:0,banKinhMet:100,phongBanId:void 0,apDungTatCa:!1,batBuocGPS:!0,chanNgoaiVung:!1}),{data:f,isLoading:p}=Ie({queryKey:["geofences",l],queryFn:()=>hr.layDanhSachGeofence({phongBanId:l})}),{data:b}=Ie({queryKey:["phong-ban"],queryFn:cn.layTatCa}),g=De({mutationFn:hr.taoGeofence,onSuccess:()=>{e.invalidateQueries({queryKey:["geofences"]}),ie.success("To geofence thnh cng"),w()},onError:F=>{var H,O;ie.error(((O=(H=F.response)==null?void 0:H.data)==null?void 0:O.message)||"C li xy ra")}}),y=De({mutationFn:({id:F,data:H})=>hr.capNhatGeofence(F,H),onSuccess:()=>{e.invalidateQueries({queryKey:["geofences"]}),ie.success("Cp nht thnh cng"),w()},onError:F=>{var H,O;ie.error(((O=(H=F.response)==null?void 0:H.data)==null?void 0:O.message)||"C li xy ra")}}),N=De({mutationFn:hr.xoaGeofence,onSuccess:()=>{e.invalidateQueries({queryKey:["geofences"]}),ie.success("Xa thnh cng")},onError:F=>{var H,O;ie.error(((O=(H=F.response)==null?void 0:H.data)==null?void 0:O.message)||"C li xy ra")}}),k=De({mutationFn:({id:F,trangThai:H})=>hr.capNhatGeofence(F,{trangThai:H}),onSuccess:()=>{e.invalidateQueries({queryKey:["geofences"]}),ie.success("Cp nht trng thi thnh cng")}}),T=()=>{s(null),m({tenDiaDiem:"",diaChi:"",viDo:0,kinhDo:0,banKinhMet:100,phongBanId:void 0,apDungTatCa:!1,batBuocGPS:!0,chanNgoaiVung:!1}),a(!0)},S=F=>{s(F),m({tenDiaDiem:F.tenDiaDiem,diaChi:F.diaChi||"",viDo:F.viDo,kinhDo:F.kinhDo,banKinhMet:F.banKinhMet,phongBanId:F.phongBanId,apDungTatCa:F.apDungTatCa,batBuocGPS:F.batBuocGPS,chanNgoaiVung:F.chanNgoaiVung}),a(!0)},w=()=>{a(!1),s(null)},_=F=>{if(F.preventDefault(),!x.tenDiaDiem.trim()){ie.error("Vui lng nhp tn a im");return}if(x.viDo===0&&x.kinhDo===0){ie.error("Vui lng nhp ta  GPS");return}r?y.mutate({id:r.id,data:x}):g.mutate(x)},L=F=>{confirm(`Bn c chc mun xa geofence "${F.tenDiaDiem}"?`)&&N.mutate(F.id)},C=async()=>{try{const F=await LT();m({...x,viDo:F.viDo,kinhDo:F.kinhDo}),ie.success(" ly v tr hin ti")}catch(F){ie.error(F.message)}},P=f==null?void 0:f.filter(F=>{var H;return F.tenDiaDiem.toLowerCase().includes(d.toLowerCase())||((H=F.diaChi)==null?void 0:H.toLowerCase().includes(d.toLowerCase()))});return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-[var(--text-primary)]",children:"Cu hnh Geofence"}),t.jsx("p",{className:"text-[var(--text-muted)]",children:"Qun l vng a l cho php chm cng GPS"})]}),t.jsxs(mt,{onClick:T,children:[t.jsx(St,{className:"w-4 h-4 mr-2"}),"Thm a im"]})]}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[t.jsx("div",{className:"flex-1",children:t.jsxs("div",{className:"relative",children:[t.jsx(Hr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Tm kim a im...",value:d,onChange:F=>u(F.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]})}),t.jsx("div",{className:"sm:w-64",children:t.jsxs("select",{value:l||"",onChange:F=>o(F.target.value?Number(F.target.value):void 0),className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Tt c phng ban"}),b==null?void 0:b.map(F=>t.jsx("option",{value:F.id,children:F.tenPhongBan},F.id))]})})]})}),t.jsx(st,{children:p?t.jsx("div",{className:"p-8 text-center text-[var(--text-muted)]",children:"ang ti..."}):P!=null&&P.length?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-[var(--bg-secondary)] border-b",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"a im"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Ta "}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Bn knh"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"p dng"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Cu hnh"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y",children:P.map(F=>t.jsxs("tr",{className:"hover:bg-[var(--bg-secondary)]/50",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg bg-primary-100 flex items-center justify-center",children:t.jsx(Wd,{className:"w-5 h-5 text-primary-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:F.tenDiaDiem}),F.diaChi&&t.jsx("p",{className:"text-sm text-[var(--text-muted)]",children:F.diaChi})]})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:[F.viDo.toFixed(6),", ",F.kinhDo.toFixed(6)]})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsxs("span",{className:"font-medium",children:[F.banKinhMet,"m"]})}),t.jsx("td",{className:"px-4 py-3",children:F.apDungTatCa?t.jsx(Tt,{variant:"info",children:"Ton cng ty"}):t.jsxs("span",{className:"text-sm text-[var(--text-muted)]",children:["Phng ban #",F.phongBanId]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[F.batBuocGPS&&t.jsxs(Tt,{variant:"warning",className:"text-xs",children:[t.jsx(jc,{className:"w-3 h-3 mr-1"}),"GPS bt buc"]}),F.chanNgoaiVung&&t.jsxs(Tt,{variant:"danger",className:"text-xs",children:[t.jsx(aa,{className:"w-3 h-3 mr-1"}),"Chn ngoi vng"]})]})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("button",{onClick:()=>k.mutate({id:F.id,trangThai:!F.trangThai}),className:"inline-flex items-center gap-1",children:F.trangThai?t.jsxs(t.Fragment,{children:[t.jsx(xj,{className:"w-6 h-6 text-green-500"}),t.jsx(Tt,{variant:"success",children:"Hot ng"})]}):t.jsxs(t.Fragment,{children:[t.jsx(hj,{className:"w-6 h-6 text-gray-400"}),t.jsx(Tt,{variant:"neutral",children:"Tt"})]})})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("button",{onClick:()=>S(F),className:"p-2 text-gray-500 hover:text-primary-600 hover:bg-primary-50 rounded-lg",title:"Chnh sa",children:t.jsx(Mr,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>L(F),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Xa",children:t.jsx(Rr,{className:"w-4 h-4"})})]})})]},F.id))})]})}):t.jsxs("div",{className:"p-8 text-center text-[var(--text-muted)]",children:[t.jsx(Wd,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Cha c geofence no c cu hnh"})]})}),t.jsx(ks,{isOpen:n,onClose:w,size:"lg",children:t.jsxs("form",{onSubmit:_,children:[t.jsx(Ts,{title:r?"Chnh sa Geofence":"Thm a im mi"}),t.jsx(Cs,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Tn a im ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",value:x.tenDiaDiem,onChange:F=>m({...x,tenDiaDiem:F.target.value}),placeholder:"VD: Vn phng chnh, Nh my ABC...",className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"a ch"}),t.jsx("input",{type:"text",value:x.diaChi,onChange:F=>m({...x,diaChi:F.target.value}),placeholder:"a ch y ...",className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["V  (Latitude) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"number",step:"any",value:x.viDo,onChange:F=>m({...x,viDo:parseFloat(F.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Kinh  (Longitude) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"number",step:"any",value:x.kinhDo,onChange:F=>m({...x,kinhDo:parseFloat(F.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg",required:!0})]})]}),t.jsx("div",{children:t.jsxs(mt,{type:"button",variant:"outline",onClick:C,className:"w-full",children:[t.jsx(jc,{className:"w-4 h-4 mr-2"}),"Ly v tr hin ti"]})}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Bn knh cho php (mt) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"number",min:"10",max:"5000",value:x.banKinhMet,onChange:F=>m({...x,banKinhMet:parseInt(F.target.value)||100}),className:"w-full px-3 py-2 border rounded-lg",required:!0}),t.jsx("p",{className:"text-sm text-[var(--text-muted)] mt-1",children:"Khong cch ti a t im check-in n tm geofence"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Phm vi p dng"}),t.jsx("div",{className:"space-y-2",children:t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:x.apDungTatCa,onChange:F=>m({...x,apDungTatCa:F.target.checked,phongBanId:F.target.checked?void 0:x.phongBanId}),className:"rounded"}),t.jsx("span",{children:"p dng cho ton cng ty"})]})}),!x.apDungTatCa&&t.jsxs("select",{value:x.phongBanId||"",onChange:F=>m({...x,phongBanId:F.target.value?Number(F.target.value):void 0}),className:"w-full px-3 py-2 border rounded-lg mt-2",children:[t.jsx("option",{value:"",children:"Chn phng ban..."}),b==null?void 0:b.map(F=>t.jsx("option",{value:F.id,children:F.tenPhongBan},F.id))]})]}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Cu hnh bo mt"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("label",{className:"flex items-center gap-3 p-3 bg-[var(--bg-secondary)] rounded-lg cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:x.batBuocGPS,onChange:F=>m({...x,batBuocGPS:F.target.checked}),className:"rounded"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:"Bt buc bt GPS"}),t.jsx("p",{className:"text-sm text-[var(--text-muted)]",children:"Nhn vin phi bt GPS khi chm cng"})]})]}),t.jsxs("label",{className:"flex items-center gap-3 p-3 bg-[var(--bg-secondary)] rounded-lg cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:x.chanNgoaiVung,onChange:F=>m({...x,chanNgoaiVung:F.target.checked}),className:"rounded"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-red-600",children:"Chn check-in ngoi vng"}),t.jsx("p",{className:"text-sm text-[var(--text-muted)]",children:"Khng cho php chm cng nu ngoi bn knh cho php"})]})]})]})]})]})}),t.jsxs(ei,{children:[t.jsx(mt,{type:"button",variant:"secondary",onClick:w,children:"Hy"}),t.jsx(mt,{type:"submit",disabled:g.isPending||y.isPending,children:g.isPending||y.isPending?"ang lu...":r?t.jsxs(t.Fragment,{children:[t.jsx(ua,{className:"w-4 h-4 mr-2"}),"Cp nht"]}):t.jsxs(t.Fragment,{children:[t.jsx(St,{className:"w-4 h-4 mr-2"}),"To mi"]})})]})]})})]})}function KV(){var L;const[e,n]=E.useState(),[a,r]=E.useState(),[s,l]=E.useState(),[o,d]=E.useState(()=>new Date().toISOString().split("T")[0]),[u,x]=E.useState(()=>new Date().toISOString().split("T")[0]),[m,f]=E.useState(1),p=20,{data:b,isLoading:g}=Ie({queryKey:["gps-logs",e,s,o,u,m],queryFn:()=>hr.layLichSuGPS({nhanVienId:e,tuNgay:o,denNgay:u,trangThai:s,page:m,limit:p})}),{data:y}=Ie({queryKey:["gps-thong-ke",o,u,a],queryFn:()=>hr.thongKeGPS(o,u,a),enabled:!!o&&!!u}),{data:N}=Ie({queryKey:["phong-ban"],queryFn:cn.layTatCa}),{data:k}=Ie({queryKey:["nhan-vien",a],queryFn:()=>Ma.layTatCa({phongBanId:a,trangThai:"DANG_LAM",soLuong:500})}),T=C=>{switch(C){case"HOP_LE":return t.jsx(ua,{className:"w-4 h-4 text-green-500"});case"NGOAI_VUNG":return t.jsx(xo,{className:"w-4 h-4 text-red-500"});case"CANH_BAO":return t.jsx(aa,{className:"w-4 h-4 text-yellow-500"});case"KHONG_CO_GPS":return t.jsx(jc,{className:"w-4 h-4 text-gray-400"});default:return null}},S=C=>{switch(C){case"HOP_LE":return t.jsx(Tt,{variant:"success",children:"Hp l"});case"NGOAI_VUNG":return t.jsx(Tt,{variant:"danger",children:"Ngoi vng"});case"CANH_BAO":return t.jsx(Tt,{variant:"warning",children:"Cnh bo"});case"KHONG_CO_GPS":return t.jsx(Tt,{variant:"neutral",children:"Khng GPS"});default:return t.jsx(Tt,{variant:"neutral",children:C})}},w=C=>new Date(C).toLocaleString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),_=Array.isArray(k)?k:(k==null?void 0:k.data)||[];return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-[var(--text-primary)]",children:"Lch s GPS Chm cng"}),t.jsx("p",{className:"text-[var(--text-muted)]",children:"Theo di v kim tra v tr chm cng ca nhn vin"})]}),t.jsxs(mt,{variant:"outline",children:[t.jsx(bs,{className:"w-4 h-4 mr-2"}),"Xut Excel"]})]}),y&&t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[t.jsxs(st,{className:"p-4 text-center",children:[t.jsx("p",{className:"text-2xl font-bold",children:y.thongKe.tongBanGhi}),t.jsx("p",{className:"text-sm text-[var(--text-muted)]",children:"Tng bn ghi"})]}),t.jsxs(st,{className:"p-4 text-center bg-green-50",children:[t.jsx("p",{className:"text-2xl font-bold text-green-600",children:y.thongKe.hopLe}),t.jsxs("p",{className:"text-sm text-green-600",children:["Hp l (",y.thongKe.tyLeHopLe,"%)"]})]}),t.jsxs(st,{className:"p-4 text-center bg-red-50",children:[t.jsx("p",{className:"text-2xl font-bold text-red-600",children:y.thongKe.ngoaiVung}),t.jsx("p",{className:"text-sm text-red-600",children:"Ngoi vng"})]}),t.jsxs(st,{className:"p-4 text-center bg-yellow-50",children:[t.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:y.thongKe.canhBao}),t.jsx("p",{className:"text-sm text-yellow-600",children:"Cnh bo"})]}),t.jsxs(st,{className:"p-4 text-center bg-gray-50",children:[t.jsx("p",{className:"text-2xl font-bold text-gray-600",children:y.thongKe.khongGPS}),t.jsx("p",{className:"text-sm text-gray-600",children:"Khng GPS"})]})]}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"T ngy"}),t.jsx("input",{type:"date",value:o,onChange:C=>{d(C.target.value),f(1)},className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"n ngy"}),t.jsx("input",{type:"date",value:u,onChange:C=>{x(C.target.value),f(1)},className:"w-full px-3 py-2 border rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phng ban"}),t.jsxs("select",{value:a||"",onChange:C=>{r(C.target.value?Number(C.target.value):void 0),n(void 0),f(1)},className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Tt c"}),N==null?void 0:N.map(C=>t.jsx("option",{value:C.id,children:C.tenPhongBan},C.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Nhn vin"}),t.jsxs("select",{value:e||"",onChange:C=>{n(C.target.value?Number(C.target.value):void 0),f(1)},className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Tt c"}),_.map(C=>t.jsxs("option",{value:C.id,children:[C.hoTen," (",C.maNhanVien,")"]},C.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Trng thi"}),t.jsxs("select",{value:s||"",onChange:C=>{l(C.target.value||void 0),f(1)},className:"w-full px-3 py-2 border rounded-lg",children:[t.jsx("option",{value:"",children:"Tt c"}),t.jsx("option",{value:"HOP_LE",children:"Hp l"}),t.jsx("option",{value:"NGOAI_VUNG",children:"Ngoi vng"}),t.jsx("option",{value:"CANH_BAO",children:"Cnh bo"}),t.jsx("option",{value:"KHONG_CO_GPS",children:"Khng GPS"})]})]})]})}),t.jsx(st,{children:g?t.jsx("div",{className:"p-8 text-center text-[var(--text-muted)]",children:"ang ti..."}):(L=b==null?void 0:b.data)!=null&&L.length?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-[var(--bg-secondary)] border-b",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Thi gian"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Loi"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Ta "}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Geofence"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Khong cch"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Trng thi"})]})}),t.jsx("tbody",{className:"divide-y",children:b.data.map(C=>t.jsxs("tr",{className:"hover:bg-[var(--bg-secondary)]/50",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(an,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{className:"text-sm",children:w(C.thoiGian)})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("span",{className:"font-medium",children:["NV #",C.nhanVienId]})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx(Tt,{variant:C.loaiChamCong==="CHECK_IN"?"success":"info",children:C.loaiChamCong==="CHECK_IN"?"Vo":"Ra"})}),t.jsxs("td",{className:"px-4 py-3",children:[C.viDo&&C.kinhDo?t.jsxs("a",{href:`https://maps.google.com/?q=${C.viDo},${C.kinhDo}`,target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:underline text-sm",children:[t.jsx(Wd,{className:"w-3 h-3 inline mr-1"}),C.viDo.toFixed(5),", ",C.kinhDo.toFixed(5)]}):t.jsx("span",{className:"text-gray-400 text-sm",children:"Khng c"}),C.doChinhXacMet&&t.jsxs("span",{className:"text-xs text-gray-400 ml-2",children:["(",C.doChinhXacMet,"m)"]})]}),t.jsx("td",{className:"px-4 py-3",children:C.geofence?t.jsx("span",{className:"text-sm",children:C.geofence.tenDiaDiem}):t.jsx("span",{className:"text-gray-400 text-sm",children:""})}),t.jsx("td",{className:"px-4 py-3 text-center",children:C.khoangCachMet!==void 0&&C.khoangCachMet!==null?t.jsxs("span",{className:`font-medium ${C.trongVung?"text-green-600":"text-red-600"}`,children:[C.khoangCachMet,"m"]}):t.jsx("span",{className:"text-gray-400",children:""})}),t.jsxs("td",{className:"px-4 py-3 text-center",children:[t.jsxs("div",{className:"flex items-center justify-center gap-1",children:[T(C.trangThai),S(C.trangThai)]}),C.ghiChu&&t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:C.ghiChu})]})]},C.id))})]})}),t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t",children:[t.jsxs("p",{className:"text-sm text-[var(--text-muted)]",children:["Hin th ",(m-1)*p+1,"-",Math.min(m*p,b.total)," /"," ",b.total," bn ghi"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(mt,{variant:"outline",size:"sm",onClick:()=>f(C=>Math.max(1,C-1)),disabled:m===1,children:t.jsx(fr,{className:"w-4 h-4"})}),t.jsxs("span",{className:"px-3 py-1 bg-[var(--bg-secondary)] rounded",children:[m," / ",b.totalPages||1]}),t.jsx(mt,{variant:"outline",size:"sm",onClick:()=>f(C=>C+1),disabled:m>=(b.totalPages||1),children:t.jsx($n,{className:"w-4 h-4"})})]})]})]}):t.jsxs("div",{className:"p-8 text-center text-[var(--text-muted)]",children:[t.jsx(jc,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Khng c d liu GPS trong khong thi gian ny"})]})})]})}const Mf=e=>e?new Date(e).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-";function zV(){var _,L,C,P,F,H,O,B,W,ee;const e=Bt(),[n,a]=E.useState(""),[r,s]=E.useState(""),[l,o]=E.useState(1),[d,u]=E.useState({open:!1}),[x,m]=E.useState(""),[f,p]=E.useState({open:!1}),{data:b,isLoading:g}=Ie({queryKey:["devices",{search:n,trangThai:r,page:l}],queryFn:()=>hr.layDanhSachThietBi({search:n,trangThai:r,page:l,limit:20})}),{data:y}=Ie({queryKey:["device-history",f.nhanVienId],queryFn:()=>f.nhanVienId?hr.layLichSuThietBi({nhanVienId:f.nhanVienId,limit:50}):null,enabled:f.open&&!!f.nhanVienId}),N=De({mutationFn:q=>hr.resetDevice(q),onSuccess:()=>{alert(" reset thit b thnh cng"),e.invalidateQueries({queryKey:["devices"]}),u({open:!1}),m("")},onError:q=>{alert(q.message||"C li xy ra")}}),k=De({mutationFn:({nhanVienId:q,lyDo:fe})=>hr.blockDevice(q,fe),onSuccess:()=>{alert(" kha thit b"),e.invalidateQueries({queryKey:["devices"]})},onError:q=>{alert(q.message||"C li xy ra")}}),T=()=>{if(!d.device||!x.trim()){alert("Vui lng nhp l do reset");return}N.mutate({nhanVienId:d.device.nhanVienId,lyDo:x})},S=q=>{switch(q){case"ACTIVE":return{label:"Hot ng",variant:"success",icon:ij};case"BLOCKED":return{label:" kha",variant:"danger",icon:Js};case"PENDING_RESET":return{label:"Ch reset",variant:"warning",icon:an};default:return{label:q,variant:"neutral",icon:aa}}},w=q=>{if(!q)return t.jsx(lb,{className:"h-4 w-4"});const fe=q.toLowerCase();return fe.includes("ios")||fe.includes("iphone")?t.jsx(i0,{className:"h-4 w-4"}):fe.includes("android")?t.jsx(i0,{className:"h-4 w-4"}):t.jsx(lb,{className:"h-4 w-4"})};return t.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold",children:"Qun l thit b"}),t.jsx("p",{className:"text-gray-500",children:"Sprint 8: Device Binding - Mi nhn vin ch c ng nhp t 1 thit b"})]})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs(st,{children:[t.jsx(Kn,{children:t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Tng thit b"})}),t.jsx(Vt,{children:t.jsx("div",{className:"text-2xl font-bold",children:(b==null?void 0:b.total)||0})})]}),t.jsxs(st,{children:[t.jsx(Kn,{children:t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Hot ng"})}),t.jsx(Vt,{children:t.jsx("div",{className:"text-2xl font-bold text-green-600",children:((_=b==null?void 0:b.data)==null?void 0:_.filter(q=>q.trangThai==="ACTIVE").length)||0})})]}),t.jsxs(st,{children:[t.jsx(Kn,{children:t.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Ch reset"})}),t.jsx(Vt,{children:t.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:((L=b==null?void 0:b.data)==null?void 0:L.filter(q=>q.trangThai==="PENDING_RESET").length)||0})})]}),t.jsxs(st,{children:[t.jsx(Kn,{children:t.jsx("span",{className:"text-sm font-medium text-gray-500",children:" kha"})}),t.jsx(Vt,{children:t.jsx("div",{className:"text-2xl font-bold text-red-600",children:((C=b==null?void 0:b.data)==null?void 0:C.filter(q=>q.trangThai==="BLOCKED").length)||0})})]})]}),t.jsxs(st,{children:[t.jsx(Kn,{children:t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Danh sch thit b"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Qun l thit b  ng k ca nhn vin"})]})})}),t.jsxs(Vt,{children:[t.jsxs("div",{className:"flex gap-4 mb-4",children:[t.jsx("div",{className:"flex-1",children:t.jsx(cg,{placeholder:"Tm theo tn, m nhn vin...",value:n,onChange:q=>a(q.target.value)})}),t.jsxs("select",{className:"px-3 py-2 border rounded-lg bg-white",value:r,onChange:q=>s(q.target.value),children:[t.jsx("option",{value:"",children:"Tt c trng thi"}),t.jsx("option",{value:"ACTIVE",children:"Hot ng"}),t.jsx("option",{value:"PENDING_RESET",children:"Ch reset"}),t.jsx("option",{value:"BLOCKED",children:" kha"})]})]}),t.jsxs(Gj,{children:[t.jsx(qj,{children:t.jsxs(Dd,{children:[t.jsx(Pl,{children:"Nhn vin"}),t.jsx(Pl,{children:"Thit b"}),t.jsx(Pl,{children:"Trng thi"}),t.jsx(Pl,{children:"Ngy ng k"}),t.jsx(Pl,{children:"ng nhp cui"}),t.jsx(Pl,{align:"right",children:"Thao tc"})]})}),t.jsx(Wj,{children:g?t.jsx(Dd,{children:t.jsx(zs,{colSpan:6,className:"text-center py-8",children:"ang ti..."})}):((P=b==null?void 0:b.data)==null?void 0:P.length)===0?t.jsx(Dd,{children:t.jsx(zs,{colSpan:6,className:"text-center py-8 text-gray-500",children:"Cha c thit b no c ng k"})}):(F=b==null?void 0:b.data)==null?void 0:F.map(q=>{var Y,X,xe;const fe=S(q.trangThai),ne=fe.icon;return t.jsxs(Dd,{children:[t.jsx(zs,{children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:((Y=q.nhanVien)==null?void 0:Y.hoTen)||"N/A"}),t.jsx("div",{className:"text-sm text-gray-500",children:(X=q.nhanVien)==null?void 0:X.maNhanVien})]})}),t.jsx(zs,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[w(q.platform),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:q.tenThietBi||"Khng xc nh"}),t.jsxs("div",{className:"text-xs text-gray-500 truncate max-w-[200px]",children:[(xe=q.deviceId)==null?void 0:xe.substring(0,20),"..."]})]})]})}),t.jsx(zs,{children:t.jsxs(Tt,{variant:fe.variant,children:[t.jsx(ne,{className:"h-3 w-3 mr-1"}),fe.label]})}),t.jsx(zs,{children:Mf(q.ngayDangKy)}),t.jsx(zs,{children:Mf(q.lanDangNhapCuoi)}),t.jsx(zs,{align:"right",children:t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(mt,{variant:"ghost",size:"sm",title:"Xem lch s",onClick:()=>p({open:!0,nhanVienId:q.nhanVienId}),children:t.jsx(pu,{className:"h-4 w-4"})}),q.trangThai!=="PENDING_RESET"&&t.jsx(mt,{variant:"ghost",size:"sm",title:"Reset thit b",onClick:()=>u({open:!0,device:q}),children:t.jsx(Ba,{className:"h-4 w-4"})}),q.trangThai==="ACTIVE"&&t.jsx(mt,{variant:"ghost",size:"sm",title:"Kha thit b",onClick:()=>{confirm("Bn c chc mun kha thit b ny?")&&k.mutate({nhanVienId:q.nhanVienId,lyDo:"Kha th cng bi HR"})},children:t.jsx(Js,{className:"h-4 w-4"})})]})})]},q.id)})})]}),b&&b.totalPages>1&&t.jsxs("div",{className:"flex justify-center gap-2 mt-4",children:[t.jsx(mt,{variant:"outline",size:"sm",disabled:l===1,onClick:()=>o(q=>q-1),children:"Trc"}),t.jsxs("span",{className:"flex items-center px-4 text-sm",children:["Trang ",l," / ",b.totalPages]}),t.jsx(mt,{variant:"outline",size:"sm",disabled:l===b.totalPages,onClick:()=>o(q=>q+1),children:"Sau"})]})]})]}),t.jsxs(ks,{isOpen:d.open,onClose:()=>u({open:!1}),children:[t.jsx(Ts,{title:"Reset thit b"}),t.jsx(Cs,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg",children:[t.jsx("div",{className:"font-medium",children:(O=(H=d.device)==null?void 0:H.nhanVien)==null?void 0:O.hoTen}),t.jsxs("div",{className:"text-sm text-gray-500",children:["Thit b hin ti: ",((B=d.device)==null?void 0:B.tenThietBi)||"Khng xc nh"]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium",children:"L do reset *"}),t.jsx(ex,{placeholder:"Nhp l do reset thit b...",value:x,onChange:q=>m(q.target.value),rows:3})]}),t.jsx("p",{className:"text-sm text-gray-500",children:"Reset s cho php nhn vin ng nhp t thit b mi"})]})}),t.jsxs(ei,{children:[t.jsx(mt,{variant:"outline",onClick:()=>u({open:!1}),children:"Hy"}),t.jsx(mt,{onClick:T,disabled:N.isPending,children:N.isPending?"ang x l...":"Xc nhn reset"})]})]}),t.jsxs(ks,{isOpen:f.open,onClose:()=>p({open:!1}),size:"lg",children:[t.jsx(Ts,{title:"Lch s thit b"}),t.jsx(Cs,{className:"max-h-[60vh] overflow-y-auto",children:t.jsx("div",{className:"space-y-4",children:((W=y==null?void 0:y.data)==null?void 0:W.length)===0?t.jsx("p",{className:"text-center text-gray-500 py-8",children:"Cha c lch s"}):(ee=y==null?void 0:y.data)==null?void 0:ee.map(q=>t.jsxs("div",{className:"flex items-start gap-4 p-4 border rounded-lg",children:[t.jsxs("div",{className:`p-2 rounded-full ${q.hanhDong==="BIND"?"bg-green-100 text-green-600":q.hanhDong==="RESET"?"bg-yellow-100 text-yellow-600":q.hanhDong==="BLOCK"?"bg-red-100 text-red-600":"bg-gray-100"}`,children:[q.hanhDong==="BIND"&&t.jsx(i0,{className:"h-4 w-4"}),q.hanhDong==="RESET"&&t.jsx(Ba,{className:"h-4 w-4"}),q.hanhDong==="BLOCK"&&t.jsx(Js,{className:"h-4 w-4"}),q.hanhDong==="LOGIN_BLOCKED"&&t.jsx(aa,{className:"h-4 w-4"})]}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"font-medium",children:[q.hanhDong==="BIND"&&"ng k thit b mi",q.hanhDong==="RESET"&&"Reset thit b",q.hanhDong==="BLOCK"&&"Kha thit b",q.hanhDong==="LOGIN_BLOCKED"&&"Chn ng nhp t thit b l"]}),q.lyDo&&t.jsxs("div",{className:"text-sm text-gray-500",children:["L do: ",q.lyDo]}),q.nguoiThucHien&&t.jsxs("div",{className:"text-sm text-gray-500",children:["Thc hin bi: ",q.nguoiThucHien.hoTen]}),t.jsx("div",{className:"text-xs text-gray-400 mt-1",children:Mf(q.ngayTao)})]})]},q.id))})})]})]})}const $V=async e=>(await he.get("/timesheet",{params:e})).data,GV=async e=>(await he.get("/timesheet/yeu-cau-sua-cong",{params:e})).data,qV=async e=>(await he.post("/timesheet/yeu-cau-sua-cong",e)).data,WV=async(e,n)=>(await he.post(`/timesheet/yeu-cau-sua-cong/${e}/duyet`,n)).data,XV=async e=>(await he.put("/timesheet/sua-cong-truc-tiep",e)).data,Zi=e=>e?new Date(e).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}):"-",Rf=e=>({DI_LAM:{label:"i lm",color:"success"},NGHI_PHEP:{label:"Ngh php",color:"info"},NGHI_KHONG_LUONG:{label:"Ngh KL",color:"warning"},NGHI_BENH:{label:"Ngh bnh",color:"warning"},NGHI_LE:{label:"Ngh l",color:"info"},CHUA_XAC_DINH:{label:"-",color:"neutral"},VANG_MAT:{label:"Vng",color:"danger"}})[e]||{label:e,color:"neutral"},f2=(e,n)=>e==="NGAY_LE"?"bg-red-100":n===0?"bg-red-50":n===6?"bg-yellow-50":"",QV=(e,n)=>new Date(n,e,0).getDate(),YV=e=>["CN","T2","T3","T4","T5","T6","T7"][e];function JV(){var fe,ne;const e=Bt(),n=new Date,[a,r]=E.useState(n.getMonth()+1),[s,l]=E.useState(n.getFullYear()),[o,d]=E.useState(""),[u]=E.useState(),[x,m]=E.useState(null),[f,p]=E.useState(null),[b,g]=E.useState("view"),[y,N]=E.useState({gioVaoMoi:"",gioRaMoi:"",trangThaiMoi:"",lyDo:""}),[k,T]=E.useState(!1),{data:S,isLoading:w}=Ie({queryKey:["bang-cong",{thang:a,nam:s,search:o,phongBanId:u}],queryFn:()=>$V({thang:a,nam:s,search:o,phongBanId:u})}),{data:_}=Ie({queryKey:["yeu-cau-sua-cong",{thang:a,nam:s,trangThaiDuyet:"CHO_DUYET"}],queryFn:()=>{const Y=new Date(s,a-1,1).toISOString().slice(0,10),X=new Date(s,a,0).toISOString().slice(0,10);return GV({trangThaiDuyet:"CHO_DUYET",tuNgay:Y,denNgay:X})}}),L=De({mutationFn:qV,onSuccess:()=>{alert(" to yu cu sa cng"),e.invalidateQueries({queryKey:["bang-cong"]}),e.invalidateQueries({queryKey:["yeu-cau-sua-cong"]}),W()},onError:Y=>{alert(Y.message||"C li xy ra")}}),C=De({mutationFn:XV,onSuccess:()=>{alert(" cp nht chm cng"),e.invalidateQueries({queryKey:["bang-cong"]}),W()},onError:Y=>{alert(Y.message||"C li xy ra")}}),P=De({mutationFn:({id:Y,payload:X})=>WV(Y,X),onSuccess:()=>{alert(" x l yu cu"),e.invalidateQueries({queryKey:["bang-cong"]}),e.invalidateQueries({queryKey:["yeu-cau-sua-cong"]})},onError:Y=>{alert(Y.message||"C li xy ra")}}),F=E.useMemo(()=>QV(a,s),[a,s]),H=()=>{a===1?(r(12),l(s-1)):r(a-1)},O=()=>{a===12?(r(1),l(s+1)):r(a+1)},B=(Y,X,xe)=>{m(Y),p(X),g(xe),N({gioVaoMoi:X.gioVao?new Date(X.gioVao).toTimeString().slice(0,5):"",gioRaMoi:X.gioRa?new Date(X.gioRa).toTimeString().slice(0,5):"",trangThaiMoi:X.trangThai,lyDo:""})},W=()=>{m(null),p(null),g("view"),N({gioVaoMoi:"",gioRaMoi:"",trangThaiMoi:"",lyDo:""})},ee=()=>{if(!(!x||!f))if(b==="request"){if(!y.lyDo.trim()){alert("Vui lng nhp l do");return}L.mutate({nhanVienId:x.nhanVienId,ngayChamCong:f.ngay,gioVaoMoi:y.gioVaoMoi?`${f.ngay}T${y.gioVaoMoi}:00`:void 0,gioRaMoi:y.gioRaMoi?`${f.ngay}T${y.gioRaMoi}:00`:void 0,trangThaiMoi:y.trangThaiMoi!==f.trangThai?y.trangThaiMoi:void 0,lyDo:y.lyDo})}else C.mutate({nhanVienId:x.nhanVienId,ngayChamCong:f.ngay,gioVao:y.gioVaoMoi?`${f.ngay}T${y.gioVaoMoi}:00`:void 0,gioRa:y.gioRaMoi?`${f.ngay}T${y.gioRaMoi}:00`:void 0,trangThai:y.trangThaiMoi,ghiChu:y.lyDo})},q=S==null?void 0:S.thongKe;return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[t.jsx(At,{className:"h-6 w-6"}),"Bng Cng Thng ",a,"/",s]}),t.jsx("p",{className:"text-gray-500",children:"Theo di chm cng v sa cng nhn vin"})]}),t.jsx("div",{className:"flex gap-2",children:t.jsxs(mt,{variant:"outline",onClick:()=>T(!0),children:[t.jsx(ha,{className:"h-4 w-4 mr-2"}),"Duyt sa cng (",((fe=_==null?void 0:_.data)==null?void 0:fe.length)||0,")"]})})]}),q&&t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[t.jsx(st,{children:t.jsx(Vt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(dn,{className:"h-5 w-5 text-blue-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Nhn vin"}),t.jsx("p",{className:"text-xl font-bold",children:q.tongNhanVien})]})]})})}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Or,{className:"h-5 w-5 text-green-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Ngy cng"}),t.jsx("p",{className:"text-xl font-bold",children:q.tongNgayCong})]})]})})}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(G_,{className:"h-5 w-5 text-purple-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Gi OT"}),t.jsx("p",{className:"text-xl font-bold",children:q.tongGioOT.toFixed(1)})]})]})})}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(aa,{className:"h-5 w-5 text-orange-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"i tr"}),t.jsx("p",{className:"text-xl font-bold",children:q.tongLanDiTre})]})]})})}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(mn,{className:"h-5 w-5 text-red-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Ngh"}),t.jsx("p",{className:"text-xl font-bold",children:q.tongNgayNghi})]})]})})}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(an,{className:"h-5 w-5 text-cyan-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Ch duyt"}),t.jsx("p",{className:"text-xl font-bold",children:q.yeuCauSuaCong.choDuyet})]})]})})})]}),t.jsxs(st,{children:[t.jsx(Kn,{children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(mt,{variant:"outline",size:"sm",onClick:H,children:t.jsx(fr,{className:"h-4 w-4"})}),t.jsxs("span",{className:"font-medium text-lg min-w-[120px] text-center",children:["Thng ",a,"/",s]}),t.jsx(mt,{variant:"outline",size:"sm",onClick:O,children:t.jsx($n,{className:"h-4 w-4"})})]}),t.jsx(cg,{placeholder:"Tm nhn vin...",value:o,onChange:Y=>d(Y.target.value),className:"w-64"})]})}),t.jsxs(Vt,{children:[w?t.jsx("div",{className:"text-center py-8",children:"ang ti..."}):(ne=S==null?void 0:S.data)!=null&&ne.length?t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full border-collapse text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-50",children:[t.jsx("th",{className:"border px-3 py-2 text-left sticky left-0 bg-gray-50 z-10 min-w-[150px]",children:"Nhn vin"}),Array.from({length:F},(Y,X)=>{const K=new Date(s,a-1,X+1).getDay();return t.jsxs("th",{className:`border px-1 py-1 text-center min-w-[50px] ${f2("",K)}`,children:[t.jsx("div",{className:"text-xs",children:YV(K)}),t.jsx("div",{children:X+1})]},X)}),t.jsx("th",{className:"border px-2 py-2 text-center min-w-[60px] bg-gray-100",children:"Cng"}),t.jsx("th",{className:"border px-2 py-2 text-center min-w-[60px] bg-gray-100",children:"OT"})]})}),t.jsx("tbody",{children:S.data.map(Y=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsxs("td",{className:"border px-3 py-2 sticky left-0 bg-white z-10",children:[t.jsx("div",{className:"font-medium",children:Y.hoTen}),t.jsx("div",{className:"text-xs text-gray-500",children:Y.maNhanVien})]}),Y.chiTiet.map(X=>{const{label:xe,color:K}=Rf(X.trangThai);return t.jsxs("td",{className:`border px-1 py-1 text-center cursor-pointer hover:bg-blue-50 ${f2(X.loaiNgay,X.thuTrongTuan)}`,onClick:()=>B(Y,X,"view"),children:[t.jsx("div",{className:"text-xs",children:X.trangThai==="DI_LAM"?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-green-600",children:Zi(X.gioVao)}),t.jsx("div",{className:"text-blue-600",children:Zi(X.gioRa)})]}):t.jsx(Tt,{variant:K,className:"text-[10px] px-1",children:xe})}),X.coYeuCauSuaCong&&t.jsx(Zm,{className:"h-3 w-3 text-orange-500 mx-auto"})]},X.ngay)}),t.jsx("td",{className:"border px-2 py-2 text-center font-medium bg-gray-50",children:Y.tongKet.soNgayDiLam}),t.jsx("td",{className:"border px-2 py-2 text-center font-medium bg-gray-50",children:Y.tongKet.soGioOT.toFixed(1)})]},Y.nhanVienId))})]})}):t.jsx("div",{className:"text-center py-8 text-gray-500",children:"Khng c d liu"}),t.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-sm",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"w-3 h-3 bg-red-50 border"})," Ch nht"]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"w-3 h-3 bg-yellow-50 border"})," Th 7"]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"w-3 h-3 bg-red-100 border"})," Ngy l"]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(Zm,{className:"h-3 w-3 text-orange-500"})," C yu cu sa"]})]})]})]}),t.jsxs(ks,{isOpen:!!f,onClose:W,children:[t.jsx(Ts,{title:b==="view"?"Chi tit chm cng":b==="edit"?"Sa cng trc tip":"Yu cu sa cng"}),t.jsx(Cs,{children:f&&x&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Nhn vin:"}),t.jsx("span",{className:"ml-2 font-medium",children:x.hoTen})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Ngy:"}),t.jsx("span",{className:"ml-2 font-medium",children:f.ngay})]})]}),b==="view"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm border rounded p-3",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Gi vo:"}),t.jsx("span",{className:"ml-2",children:Zi(f.gioVao)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Gi ra:"}),t.jsx("span",{className:"ml-2",children:Zi(f.gioRa)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Trng thi:"}),t.jsx(Tt,{variant:Rf(f.trangThai).color,className:"ml-2",children:Rf(f.trangThai).label})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Gi lm:"}),t.jsxs("span",{className:"ml-2",children:[f.soGioLam.toFixed(1),"h"]})]}),f.phutDiTre&&f.phutDiTre>0&&t.jsxs("div",{className:"text-orange-600",children:["i tr: ",f.phutDiTre," pht"]}),f.phutVeSom&&f.phutVeSom>0&&t.jsxs("div",{className:"text-orange-600",children:["V sm: ",f.phutVeSom," pht"]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(mt,{variant:"outline",onClick:()=>g("edit"),children:[t.jsx(Zm,{className:"h-4 w-4 mr-2"}),"Sa trc tip"]}),t.jsxs(mt,{variant:"outline",onClick:()=>g("request"),children:[t.jsx(ha,{className:"h-4 w-4 mr-2"}),"To yu cu sa"]})]})]}):t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gi vo mi"}),t.jsx("input",{type:"time",className:"w-full border rounded px-3 py-2",value:y.gioVaoMoi,onChange:Y=>N({...y,gioVaoMoi:Y.target.value})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gi ra mi"}),t.jsx("input",{type:"time",className:"w-full border rounded px-3 py-2",value:y.gioRaMoi,onChange:Y=>N({...y,gioRaMoi:Y.target.value})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Trng thi"}),t.jsxs("select",{className:"w-full border rounded px-3 py-2",value:y.trangThaiMoi,onChange:Y=>N({...y,trangThaiMoi:Y.target.value}),children:[t.jsx("option",{value:"DI_LAM",children:"i lm"}),t.jsx("option",{value:"NGHI_PHEP",children:"Ngh php"}),t.jsx("option",{value:"NGHI_KHONG_LUONG",children:"Ngh khng lng"}),t.jsx("option",{value:"NGHI_BENH",children:"Ngh bnh"}),t.jsx("option",{value:"VANG_MAT",children:"Vng mt"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:b==="request"?"L do sa (bt buc)":"Ghi ch"}),t.jsx(ex,{placeholder:b==="request"?"Nhp l do yu cu sa cng...":"Ghi ch...",value:y.lyDo,onChange:Y=>N({...y,lyDo:Y.target.value}),rows:3})]})]})]})}),t.jsxs(ei,{children:[t.jsx(mt,{variant:"outline",onClick:W,children:"ng"}),b!=="view"&&t.jsx(mt,{onClick:ee,disabled:L.isPending||C.isPending,children:L.isPending||C.isPending?"ang x l...":"Lu"})]})]}),t.jsx(ZV,{open:k,onClose:()=>T(!1),yeuCauList:(_==null?void 0:_.data)||[],onDuyet:(Y,X,xe)=>{P.mutate({id:Y,payload:{trangThaiDuyet:X?"DA_DUYET":"TU_CHOI",lyDoTuChoi:xe}})},isLoading:P.isPending})]})}function ZV({open:e,onClose:n,yeuCauList:a,onDuyet:r,isLoading:s}){const[l,o]=E.useState({});return t.jsxs(ks,{isOpen:e,onClose:n,size:"xl",children:[t.jsx(Ts,{title:"Duyt yu cu sa cng"}),t.jsx(Cs,{children:a.length===0?t.jsx("div",{className:"text-center py-8 text-gray-500",children:"Khng c yu cu no ang ch duyt"}):t.jsx("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto",children:a.map(d=>{var u,x,m;return t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"font-medium",children:[(u=d.nhanVien)==null?void 0:u.hoTen," - ",(x=d.nhanVien)==null?void 0:x.maNhanVien]}),t.jsxs("div",{className:"text-sm text-gray-500",children:["Ngy: ",new Date(d.ngayChamCong).toLocaleDateString("vi-VN")]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Thay i:"}),d.gioVaoMoi&&t.jsxs("span",{className:"ml-2",children:["Gi vo: ",Zi(d.gioVaoCu),"  ",Zi(d.gioVaoMoi)]}),d.gioRaMoi&&t.jsxs("span",{className:"ml-2",children:["Gi ra: ",Zi(d.gioRaCu),"  ",Zi(d.gioRaMoi)]}),d.trangThaiMoi&&t.jsxs("span",{className:"ml-2",children:["Trng thi: ",d.trangThaiCu,"  ",d.trangThaiMoi]})]}),t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"L do:"}),t.jsx("span",{className:"ml-2",children:d.lyDo})]}),t.jsxs("div",{className:"text-xs text-gray-400",children:["Ngi to: ",(m=d.nguoiTao)==null?void 0:m.hoTen," - ",new Date(d.ngayTao).toLocaleString("vi-VN")]}),t.jsx(ex,{placeholder:"L do t chi (nu t chi)",value:l[d.id]||"",onChange:f=>o({...l,[d.id]:f.target.value}),rows:2,className:"mt-2"})]}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsxs(mt,{variant:"primary",size:"sm",onClick:()=>r(d.id,!0),disabled:s,children:[t.jsx(Or,{className:"h-4 w-4 mr-1"}),"Duyt"]}),t.jsxs(mt,{variant:"danger",size:"sm",onClick:()=>r(d.id,!1,l[d.id]),disabled:s,children:[t.jsx(mn,{className:"h-4 w-4 mr-1"}),"T chi"]})]})]})},d.id)})})}),t.jsx(ei,{children:t.jsx(mt,{variant:"outline",onClick:n,children:"ng"})})]})}const eU="tinh_luong_auth",ac=Zt.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});ac.interceptors.request.use(e=>{const n=localStorage.getItem(eU);if(n)try{const a=JSON.parse(n);a.token&&(e.headers.Authorization=`Bearer ${a.token}`)}catch{}return e});const Bf={sync:e=>ac.post("/payroll-sync/sync",e).then(n=>n.data),getProgress:e=>ac.get(`/payroll-sync/progress/${e}`).then(n=>n.data),getStatus:(e,n)=>ac.get("/payroll-sync/status",{params:{thang:e,nam:n}}).then(a=>a.data),getRuleTrace:e=>ac.get("/payroll-sync/rule-trace",{params:e}).then(n=>n.data),getRuleTraceByEmployee:(e,n,a)=>ac.get(`/payroll-sync/rule-trace/nhan-vien/${e}`,{params:{thang:n,nam:a}}).then(r=>r.data)},tU={CHAM_CONG:{label:"Chm cng",color:"bg-blue-100 text-blue-700",icon:an},YEU_CAU:{label:"n yu cu",color:"bg-purple-100 text-purple-700",icon:ha},NGHI_PHEP:{label:"Ngh php",color:"bg-green-100 text-green-700",icon:At},PHAN_CA:{label:"Phn ca",color:"bg-yellow-100 text-yellow-700",icon:dn},GPS:{label:"GPS",color:"bg-orange-100 text-orange-700",icon:Pd},KPI:{label:"KPI",color:"bg-pink-100 text-pink-700",icon:aj},MANUAL:{label:"Th cng",color:"bg-gray-100 text-gray-700",icon:ha},RULE_ENGINE:{label:"Rule Engine",color:"bg-indigo-100 text-indigo-700",icon:Pd}};function nU(){var S,w;const e=Bt(),[n,a]=E.useState(new Date().getMonth()+1),[r,s]=E.useState(new Date().getFullYear()),[l,o]=E.useState(),[d,u]=E.useState(new Set),[x,m]=E.useState(null),{data:f}=Ie({queryKey:["phong-ban"],queryFn:cn.layTatCa}),{data:p,isLoading:b}=Ie({queryKey:["pipeline-status",n,r],queryFn:()=>Bf.getStatus(n,r)}),{data:g,isLoading:y}=Ie({queryKey:["rule-trace",n,r,l],queryFn:()=>Bf.getRuleTrace({thang:n,nam:r,phongBanId:l})}),N=De({mutationFn:_=>Bf.sync({bangLuongId:_}),onMutate:_=>{m(_)},onSuccess:_=>{var L;e.invalidateQueries({queryKey:["pipeline-status"]}),e.invalidateQueries({queryKey:["rule-trace"]}),e.invalidateQueries({queryKey:["bang-luong"]}),_.currentStep==="HOAN_THANH"?ie.success(`ng b hon thnh: ${((L=_.summary)==null?void 0:L.tongThayDoi)||0} thay i`):_.currentStep==="LOI"&&ie.error(`ng b tht bi: ${_.errors[0]||"C li xy ra"}`)},onError:_=>{ie.error(`Li ng b: ${_.message}`)},onSettled:()=>{m(null)}}),k=_=>{const L=new Set(d);L.has(_)?L.delete(_):L.add(_),u(L)},T=_=>{const C={CHUA_TAO:{color:"gray",label:"Cha to"},NHAP:{color:"yellow",label:"Nhp"},DA_TINH:{color:"blue",label:" tnh"},DA_KHOA:{color:"purple",label:" kha"},DA_DUYET:{color:"green",label:" duyt"}}[_]||{color:"gray",label:_};return t.jsx(Tt,{variant:C.color,children:C.label})};return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Pipeline ng B Lng"}),t.jsx("p",{className:"text-gray-500",children:"ng b d liu chm cng, ngh php, yu cu vo bng lng"})]})}),t.jsx(st,{className:"p-4",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thng"}),t.jsx("select",{value:n,onChange:_=>a(Number(_.target.value)),className:"input",children:[...Array(12)].map((_,L)=>t.jsxs("option",{value:L+1,children:["Thng ",L+1]},L+1))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nm"}),t.jsx("select",{value:r,onChange:_=>s(Number(_.target.value)),className:"input",children:[2024,2025,2026].map(_=>t.jsx("option",{value:_,children:_},_))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),t.jsxs("select",{value:l||"",onChange:_=>o(_.target.value?Number(_.target.value):void 0),className:"input",children:[t.jsx("option",{value:"",children:"Tt c"}),f==null?void 0:f.map(_=>t.jsx("option",{value:_.id,children:_.tenPhongBan},_.id))]})]})]})}),t.jsxs(st,{children:[t.jsx("div",{className:"p-4 border-b border-gray-200",children:t.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(Pd,{className:"w-5 h-5"}),"Trng thi Pipeline"]})}),b?t.jsx("div",{className:"p-8 text-center",children:t.jsx(Mn,{className:"w-8 h-8 animate-spin mx-auto text-blue-500"})}):t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[t.jsx("div",{className:"text-sm text-blue-600",children:"Tng nhn vin"}),t.jsx("div",{className:"text-2xl font-bold text-blue-700",children:(p==null?void 0:p.tongNhanVien)||0})]}),t.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[t.jsx("div",{className:"text-sm text-green-600",children:" sync hon thnh"}),t.jsx("div",{className:"text-2xl font-bold text-green-700",children:(p==null?void 0:p.tongDaSyncHoanThanh)||0})]}),t.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[t.jsx("div",{className:"text-sm text-yellow-600",children:"Cnh bo"}),t.jsx("div",{className:"text-2xl font-bold text-yellow-700",children:((S=p==null?void 0:p.warnings)==null?void 0:S.length)||0})]})]}),(p==null?void 0:p.warnings)&&p.warnings.length>0&&t.jsxs("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[t.jsxs("h3",{className:"font-medium text-yellow-800 flex items-center gap-2 mb-2",children:[t.jsx(dl,{className:"w-4 h-4"}),"Cnh bo"]}),t.jsxs("ul",{className:"space-y-1",children:[p.warnings.slice(0,5).map((_,L)=>t.jsxs("li",{className:"text-sm text-yellow-700",children:[" ",_.moTa]},L)),p.warnings.length>5&&t.jsxs("li",{className:"text-sm text-yellow-600 italic",children:["... v ",p.warnings.length-5," cnh bo khc"]})]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phng ban"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Nhn vin"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Tng lng"}),t.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:(w=p==null?void 0:p.phongBans)==null?void 0:w.map(_=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-4 py-3 font-medium",children:_.tenPhongBan}),t.jsx("td",{className:"px-4 py-3 text-center",children:T(_.trangThai)}),t.jsx("td",{className:"px-4 py-3 text-right",children:_.tongNhanVien}),t.jsx("td",{className:"px-4 py-3 text-right",children:et(_.tongLuong)}),t.jsx("td",{className:"px-4 py-3 text-center",children:_.bangLuongId&&_.trangThai!=="DA_KHOA"&&_.trangThai!=="DA_DUYET"?t.jsxs(mt,{size:"sm",variant:"primary",onClick:()=>N.mutate(_.bangLuongId),disabled:x===_.bangLuongId,children:[x===_.bangLuongId?t.jsx(Mn,{className:"w-4 h-4 animate-spin"}):t.jsx(Ba,{className:"w-4 h-4"}),t.jsx("span",{className:"ml-1",children:"Sync"})]}):_.trangThai==="CHUA_TAO"?t.jsx("span",{className:"text-sm text-gray-400",children:"Cha to BL"}):t.jsx("span",{className:"text-sm text-gray-400",children:" kha"})})]},_.phongBanId))})]})})]})]}),t.jsxs(st,{children:[t.jsxs("div",{className:"p-4 border-b border-gray-200",children:[t.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(ii,{className:"w-5 h-5"}),"Rule Trace - Ngun D Liu"]}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Xem chi tit d liu c s dng  tnh lng t cc ngun khc nhau"})]}),y?t.jsx("div",{className:"p-8 text-center",children:t.jsx(Mn,{className:"w-8 h-8 animate-spin mx-auto text-blue-500"})}):g&&g.length>0?t.jsx("div",{className:"divide-y divide-gray-200",children:g.map(_=>{var L;return t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>k(_.ruleId*1e3+_.nhanVienId),children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center",children:t.jsx(Pd,{className:"w-5 h-5 text-indigo-600"})}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:_.ruleName}),t.jsx("div",{className:"text-sm text-gray-500",children:_.hoTen})]})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-lg font-semibold text-green-600",children:et(_.ketQua)}),t.jsx("div",{className:"text-xs text-gray-400",children:new Date(_.ngayChay).toLocaleDateString("vi-VN")})]}),d.has(_.ruleId*1e3+_.nhanVienId)?t.jsx(Il,{className:"w-5 h-5 text-gray-400"}):t.jsx(Ar,{className:"w-5 h-5 text-gray-400"})]})]}),d.has(_.ruleId*1e3+_.nhanVienId)&&t.jsxs("div",{className:"mt-4 pl-14 space-y-3",children:[t.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[t.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Chi tit tnh ton:"}),t.jsx("div",{className:"text-sm font-mono bg-white p-2 rounded border",children:_.chiTiet})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Ngun d liu:"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:(L=_.nguonDuLieu)==null?void 0:L.map((C,P)=>{const F=tU[C.type],H=F.icon;return t.jsxs("div",{className:`flex items-center gap-2 p-2 rounded-lg ${F.color}`,children:[t.jsx(H,{className:"w-4 h-4"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-sm font-medium",children:F.label}),t.jsxs("div",{className:"text-xs opacity-75",children:[C.sourceId," = ",String(C.value)]})]})]},P)})})]})]})]},`${_.ruleId}-${_.nhanVienId}`)})}):t.jsxs("div",{className:"p-8 text-center text-gray-500",children:[t.jsx(Pd,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),t.jsxs("p",{children:["Cha c d liu rule trace cho thng ",n,"/",r]})]})]})]})}const Ll={getDiTreVeSom:e=>he.get("/reports/di-tre-ve-som",{params:e}),getOT:e=>he.get("/reports/ot",{params:e}),getNghiPhep:e=>he.get("/reports/nghi-phep",{params:e}),getQuyLuong:e=>he.get("/reports/quy-luong",{params:e}),getHeadcount:e=>he.get("/reports/headcount",{params:e}),getChamCong:e=>he.get("/reports/cham-cong",{params:e}),getDashboard:(e,n)=>he.get("/reports/dashboard",{params:{thang:e,nam:n}})},PT=new Date,aU=PT.getMonth()+1,rU=PT.getFullYear(),fs=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),sU=e=>new Date(e).toLocaleDateString("vi-VN");function iU(){var g,y,N,k,T,S,w;const[e,n]=E.useState("dashboard"),[a,r]=E.useState({thang:aU,nam:rU}),s=Ie({queryKey:["reports","dashboard",a.thang,a.nam],queryFn:()=>Ll.getDashboard(a.thang,a.nam),enabled:e==="dashboard"}),l=Ie({queryKey:["reports","di-tre",a],queryFn:()=>Ll.getDiTreVeSom(a),enabled:e==="di-tre"}),o=Ie({queryKey:["reports","ot",a],queryFn:()=>Ll.getOT(a),enabled:e==="ot"}),d=Ie({queryKey:["reports","nghi-phep",a],queryFn:()=>Ll.getNghiPhep(a),enabled:e==="nghi-phep"}),u=Ie({queryKey:["reports","quy-luong",a],queryFn:()=>Ll.getQuyLuong(a),enabled:e==="quy-luong"}),x=Ie({queryKey:["reports","headcount",a],queryFn:()=>Ll.getHeadcount(a),enabled:e==="headcount"}),m=Ie({queryKey:["reports","cham-cong",a],queryFn:()=>Ll.getChamCong(a),enabled:e==="cham-cong"}),f=s.isLoading||l.isLoading||o.isLoading||d.isLoading||u.isLoading||x.isLoading||m.isLoading,p=()=>{switch(e){case"dashboard":s.refetch();break;case"di-tre":l.refetch();break;case"ot":o.refetch();break;case"nghi-phep":d.refetch();break;case"quy-luong":u.refetch();break;case"headcount":x.refetch();break;case"cham-cong":m.refetch();break}},b=[{key:"dashboard",label:"Dashboard"},{key:"di-tre",label:"i tr/V sm"},{key:"ot",label:"Tng ca (OT)"},{key:"nghi-phep",label:"Ngh php"},{key:"quy-luong",label:"Qu lng"},{key:"headcount",label:"Nhn s"},{key:"cham-cong",label:"Chm cng"}];return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Bo co & Thng k"}),t.jsx("p",{className:"text-slate-500",children:"Xem tng hp v chi tit cc bo co nhn s"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(mt,{variant:"outline",onClick:p,disabled:f,children:[t.jsx(Ba,{className:`h-4 w-4 mr-2 ${f?"animate-spin":""}`}),"Lm mi"]}),t.jsxs(mt,{variant:"primary",children:[t.jsx(Wp,{className:"h-4 w-4 mr-2"}),"Xut Excel"]})]})]}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-6",children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Thng"}),t.jsxs("div",{className:"relative",children:[t.jsx("select",{value:a.thang,onChange:_=>r({...a,thang:Number(_.target.value)}),className:"w-32 px-3 py-2 border border-slate-200 rounded-lg appearance-none focus:ring-2 focus:ring-blue-500 bg-white",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(_=>t.jsxs("option",{value:_,children:["Thng ",_]},_))}),t.jsx(Ar,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400 pointer-events-none"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Nm"}),t.jsxs("div",{className:"relative",children:[t.jsx("select",{value:a.nam,onChange:_=>r({...a,nam:Number(_.target.value)}),className:"w-28 px-3 py-2 border border-slate-200 rounded-lg appearance-none focus:ring-2 focus:ring-blue-500 bg-white",children:[2023,2024,2025,2026].map(_=>t.jsx("option",{value:_,children:_},_))}),t.jsx(Ar,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400 pointer-events-none"})]})]})]})})}),t.jsx("div",{className:"border-b border-slate-200",children:t.jsx("div",{className:"flex flex-wrap gap-1",children:b.map(_=>t.jsx("button",{onClick:()=>n(_.key),className:`px-4 py-3 text-sm font-medium transition-colors ${e===_.key?"text-blue-600 border-b-2 border-blue-600 -mb-[1px]":"text-slate-500 hover:text-slate-900"}`,children:_.label},_.key))})}),t.jsxs("div",{className:"mt-6",children:[e==="dashboard"&&t.jsx(lU,{data:(g=s.data)==null?void 0:g.data,isLoading:s.isLoading}),e==="di-tre"&&t.jsx(oU,{data:(y=l.data)==null?void 0:y.data,isLoading:l.isLoading}),e==="ot"&&t.jsx(cU,{data:(N=o.data)==null?void 0:N.data,isLoading:o.isLoading}),e==="nghi-phep"&&t.jsx(dU,{data:(k=d.data)==null?void 0:k.data,isLoading:d.isLoading}),e==="quy-luong"&&t.jsx(uU,{data:(T=u.data)==null?void 0:T.data,isLoading:u.isLoading}),e==="headcount"&&t.jsx(hU,{data:(S=x.data)==null?void 0:S.data,isLoading:x.isLoading}),e==="cham-cong"&&t.jsx(xU,{data:(w=m.data)==null?void 0:w.data,isLoading:m.isLoading})]})]})}function lU({data:e,isLoading:n}){return n?t.jsx(No,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:e.kpis.map((a,r)=>t.jsx(st,{children:t.jsxs(Vt,{className:"pt-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-slate-500",children:a.ten}),t.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[a.donVi==="VND"?fs(a.giaTri):a.giaTri.toLocaleString(),a.donVi!=="VND"&&t.jsx("span",{className:"text-sm ml-1",children:a.donVi})]})]}),t.jsxs("div",{className:`p-3 rounded-full bg-${a.mau}-100`,children:[a.icon==="users"&&t.jsx(dn,{className:"h-6 w-6 text-blue-600"}),a.icon==="dollar"&&t.jsx(Pr,{className:"h-6 w-6 text-green-600"}),a.icon==="clock"&&t.jsx(an,{className:"h-6 w-6 text-amber-600"}),a.icon==="calendar"&&t.jsx(At,{className:"h-6 w-6 text-purple-600"})]})]}),t.jsxs("div",{className:"mt-2 flex items-center text-sm",children:[a.soSanhThangTruoc>=0?t.jsx(li,{className:"h-4 w-4 text-green-500 mr-1"}):t.jsx(lp,{className:"h-4 w-4 text-red-500 mr-1"}),t.jsxs("span",{className:a.soSanhThangTruoc>=0?"text-green-500":"text-red-500",children:[Math.abs(a.soSanhThangTruoc).toFixed(1),"%"]}),t.jsx("span",{className:"text-slate-500 ml-1",children:"so vi thng trc"})]})]})},r))}),e.alerts.length>0&&t.jsxs(st,{children:[t.jsx(Kn,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(aa,{className:"h-5 w-5 text-amber-500"}),t.jsx("h3",{className:"font-semibold text-lg",children:"Cnh bo & Thng bo"})]})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-3",children:e.alerts.map((a,r)=>t.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg ${a.loai==="ERROR"?"bg-red-50 border border-red-200":a.loai==="WARNING"?"bg-amber-50 border border-amber-200":"bg-blue-50 border border-blue-200"}`,children:[a.loai==="ERROR"&&t.jsx(xo,{className:"h-5 w-5 text-red-500 mt-0.5"}),a.loai==="WARNING"&&t.jsx(aa,{className:"h-5 w-5 text-amber-500 mt-0.5"}),a.loai==="INFO"&&t.jsx(cj,{className:"h-5 w-5 text-blue-500 mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium",children:a.tieuDe}),t.jsx("p",{className:"text-sm text-slate-600",children:a.moTa})]}),t.jsx(Tt,{variant:"neutral",children:a.soLuong})]},r))})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(st,{children:[t.jsx(Kn,{children:t.jsx("h3",{className:"font-semibold",children:"Bin ng nhn s 6 thng"})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-4",children:e.bienDongNhanSu.map((a,r)=>{const s=Math.max(...e.bienDongNhanSu.map(l=>l.moiTuyen+l.nghiViec),1);return t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsxs("span",{children:["Thng ",a.thang]}),t.jsxs("span",{className:"text-green-600",children:["+",a.moiTuyen]}),t.jsxs("span",{className:"text-red-600",children:["-",a.nghiViec]})]}),t.jsxs("div",{className:"flex gap-1 h-2",children:[t.jsx("div",{className:"bg-green-500 rounded",style:{width:`${a.moiTuyen/s*100}%`}}),t.jsx("div",{className:"bg-red-500 rounded",style:{width:`${a.nghiViec/s*100}%`}})]})]},r)})})})]}),t.jsxs(st,{children:[t.jsx(Kn,{children:t.jsx("h3",{className:"font-semibold",children:"Phn b qu lng theo phng ban"})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-3",children:e.phanBoLuongTheoPB.map((a,r)=>t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[t.jsx("span",{children:a.tenPhongBan}),t.jsxs("span",{className:"text-slate-600",children:[a.tyLe.toFixed(1),"%"]})]}),t.jsx("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full rounded-full",style:{width:`${a.tyLe}%`,backgroundColor:`hsl(${210+r*30}, 70%, 50%)`}})})]},r))})})]})]})]}):t.jsx(jo,{message:"Khng c d liu dashboard"})}function oU({data:e,isLoading:n}){return n?t.jsx(No,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsx(Xt,{title:"Nhn vin vi phm",value:e.summary.tongNhanVien,icon:t.jsx(dn,{className:"h-5 w-5"})}),t.jsx(Xt,{title:"Lt i tr",value:e.summary.tongLuotDiTre,icon:t.jsx(an,{className:"h-5 w-5"}),color:"red"}),t.jsx(Xt,{title:"Lt v sm",value:e.summary.tongLuotVeSom,icon:t.jsx(an,{className:"h-5 w-5"}),color:"amber"}),t.jsx(Xt,{title:"Tng pht tr",value:e.summary.tongPhutTre,unit:"pht",icon:t.jsx(an,{className:"h-5 w-5"})}),t.jsx(Xt,{title:"Tng pht v sm",value:e.summary.tongPhutVeSom,unit:"pht",icon:t.jsx(an,{className:"h-5 w-5"})})]}),t.jsxs(st,{children:[t.jsx(Kn,{children:t.jsx("h3",{className:"font-semibold",children:"Top nhn vin i tr nhiu nht"})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-3",children:e.summary.topDiTre.map((a,r)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-red-100 flex items-center justify-center text-red-600 font-bold",children:r+1}),t.jsx("span",{className:"font-medium",children:a.hoTen})]}),t.jsxs(Tt,{variant:"danger",children:[a.soLan," ln"]})]},a.nhanVienId))})})]}),t.jsxs(st,{children:[t.jsx(Kn,{children:t.jsxs("h3",{className:"font-semibold",children:["Chi tit (",e.chiTiet.length," bn ghi)"]})}),t.jsx(Vt,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-slate-200",children:[t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"M NV"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"H tn"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"Phng ban"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"Ngy"}),t.jsx("th",{className:"text-center p-3 font-medium text-slate-600",children:"Gi vo"}),t.jsx("th",{className:"text-center p-3 font-medium text-slate-600",children:"Gi ra"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Pht tr"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Pht v sm"})]})}),t.jsx("tbody",{children:e.chiTiet.slice(0,50).map((a,r)=>t.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[t.jsx("td",{className:"p-3",children:a.maNhanVien}),t.jsx("td",{className:"p-3",children:a.hoTen}),t.jsx("td",{className:"p-3",children:a.phongBan}),t.jsx("td",{className:"p-3",children:sU(a.ngay)}),t.jsx("td",{className:"text-center p-3",children:a.gioVao||"-"}),t.jsx("td",{className:"text-center p-3",children:a.gioRa||"-"}),t.jsx("td",{className:"text-right p-3",children:a.soPhutTre>0&&t.jsx("span",{className:"text-red-600 font-medium",children:a.soPhutTre})}),t.jsx("td",{className:"text-right p-3",children:a.soPhutVeSom>0&&t.jsx("span",{className:"text-amber-600 font-medium",children:a.soPhutVeSom})})]},r))})]})})})]})]}):t.jsx(jo,{message:"Khng c d liu i tr/v sm"})}function cU({data:e,isLoading:n}){return n?t.jsx(No,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsx(Xt,{title:"Nhn vin OT",value:e.summary.tongNhanVien,icon:t.jsx(dn,{className:"h-5 w-5"})}),t.jsx(Xt,{title:"Tng gi OT",value:e.summary.tongGioOT.toFixed(1),unit:"gi",icon:t.jsx(an,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Xt,{title:"Tng tin OT",value:fs(e.summary.tongTienOT),icon:t.jsx(Pr,{className:"h-5 w-5"}),color:"green"}),t.jsx(Xt,{title:"TB gi OT/ngy",value:e.summary.trungBinhGioOTNgay.toFixed(2),unit:"gi",icon:t.jsx(an,{className:"h-5 w-5"})})]}),t.jsxs(st,{children:[t.jsx(Kn,{children:t.jsx("h3",{className:"font-semibold",children:"Top phng ban OT nhiu nht"})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-3",children:e.summary.phongBanNhieuOTNhat.map((a,r)=>{const s=Math.max(...e.summary.phongBanNhieuOTNhat.map(l=>l.tongGio),1);return t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[t.jsx("span",{children:a.phongBan}),t.jsxs("span",{className:"font-medium",children:[a.tongGio.toFixed(1)," gi"]})]}),t.jsx("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${a.tongGio/s*100}%`}})})]},r)})})})]})]}):t.jsx(jo,{message:"Khng c d liu tng ca"})}function dU({data:e,isLoading:n}){return n?t.jsx(No,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsx(Xt,{title:"Tng n",value:e.summary.tongDon,icon:t.jsx(At,{className:"h-5 w-5"})}),t.jsx(Xt,{title:"Tng ngy ngh",value:e.summary.tongNgayNghi,unit:"ngy",icon:t.jsx(At,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Xt,{title:" duyt",value:e.summary.daDuyet,icon:t.jsx(At,{className:"h-5 w-5"}),color:"green"}),t.jsx(Xt,{title:"Ch duyt",value:e.summary.choDuyet,icon:t.jsx(an,{className:"h-5 w-5"}),color:"amber"}),t.jsx(Xt,{title:"T chi",value:e.summary.tuChoi,icon:t.jsx(xo,{className:"h-5 w-5"}),color:"red"})]}),t.jsxs(st,{children:[t.jsx(Kn,{children:t.jsx("h3",{className:"font-semibold",children:"Thng k theo loi ngh"})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-3",children:e.summary.theoLoai.map((a,r)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[t.jsx("span",{children:a.loai||"Cha phn loi"}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs(Tt,{variant:"info",children:[a.soDon," n"]}),t.jsxs(Tt,{variant:"warning",children:[a.soNgay," ngy"]})]})]},r))})})]})]}):t.jsx(jo,{message:"Khng c d liu ngh php"})}function uU({data:e,isLoading:n}){return n?t.jsx(No,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsx(Xt,{title:"Tng qu lng",value:fs(e.summary.tongQuyLuong),icon:t.jsx(Pr,{className:"h-5 w-5"}),color:"green"}),t.jsx(Xt,{title:"Tng nhn vin",value:e.summary.tongNhanVien,icon:t.jsx(dn,{className:"h-5 w-5"})}),t.jsx(Xt,{title:"Lng trung bnh",value:fs(e.summary.luongTrungBinh),icon:t.jsx(Pr,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Xt,{title:"Tng thu TNCN",value:fs(e.summary.tongThueTNCN),icon:t.jsx(Pr,{className:"h-5 w-5"}),color:"red"})]}),t.jsxs(st,{children:[t.jsx(Kn,{children:t.jsx("h3",{className:"font-semibold",children:"Qu lng theo phng ban"})}),t.jsx(Vt,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-slate-200",children:[t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"Phng ban"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Nhn vin"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Lng c bn"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Ph cp"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Thng"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Khu tr"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Thc lnh"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"T l"})]})}),t.jsx("tbody",{children:e.theoPhongBan.map((a,r)=>t.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[t.jsx("td",{className:"p-3 font-medium",children:a.tenPhongBan}),t.jsx("td",{className:"text-right p-3",children:a.tongNhanVien}),t.jsx("td",{className:"text-right p-3",children:fs(a.tongLuongCoBan)}),t.jsx("td",{className:"text-right p-3",children:fs(a.tongPhuCap)}),t.jsx("td",{className:"text-right p-3",children:fs(a.tongThuong)}),t.jsx("td",{className:"text-right p-3 text-red-600",children:fs(a.tongKhauTru)}),t.jsx("td",{className:"text-right p-3 font-medium text-green-600",children:fs(a.tongThucLinh)}),t.jsxs("td",{className:"text-right p-3",children:[a.tyLeQuyLuong.toFixed(1),"%"]})]},r))})]})})})]})]}):t.jsx(jo,{message:"Khng c d liu qu lng"})}function hU({data:e,isLoading:n}){return n?t.jsx(No,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsx(Xt,{title:"Tng nhn s",value:e.summary.tongNhanVien,icon:t.jsx(dn,{className:"h-5 w-5"})}),t.jsx(Xt,{title:"ang lm",value:e.summary.dangLam,icon:t.jsx(dn,{className:"h-5 w-5"}),color:"green"}),t.jsx(Xt,{title:"Mi tuyn",value:e.summary.moiTuyenThang,icon:t.jsx(li,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Xt,{title:"Ngh vic",value:e.summary.nghiViecThang,icon:t.jsx(lp,{className:"h-5 w-5"}),color:"red"}),t.jsx(Xt,{title:"T l ngh vic",value:`${e.summary.tyLeNghiViec.toFixed(1)}%`,icon:t.jsx(lp,{className:"h-5 w-5"}),color:"amber"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(st,{children:[t.jsx(Kn,{children:t.jsx("h3",{className:"font-semibold",children:"Phn b theo gii tnh"})}),t.jsx(Vt,{children:t.jsxs("div",{className:"flex items-center justify-center gap-8",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-20 h-20 rounded-full bg-blue-100 flex items-center justify-center mx-auto mb-2",children:t.jsx("span",{className:"text-2xl font-bold text-blue-600",children:e.summary.theoGioiTinh.nam})}),t.jsx("span",{className:"text-slate-600",children:"Nam"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-20 h-20 rounded-full bg-pink-100 flex items-center justify-center mx-auto mb-2",children:t.jsx("span",{className:"text-2xl font-bold text-pink-600",children:e.summary.theoGioiTinh.nu})}),t.jsx("span",{className:"text-slate-600",children:"N"})]})]})})]}),t.jsxs(st,{children:[t.jsx(Kn,{children:t.jsx("h3",{className:"font-semibold",children:"Phn b theo  tui"})}),t.jsx(Vt,{children:t.jsx("div",{className:"space-y-3",children:[{label:"Di 25",value:e.summary.theoDoTuoi.duoi25},{label:"25-35",value:e.summary.theoDoTuoi.tu25den35},{label:"35-45",value:e.summary.theoDoTuoi.tu35den45},{label:"Trn 45",value:e.summary.theoDoTuoi.tren45}].map((a,r)=>t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[t.jsx("span",{children:a.label}),t.jsxs("span",{className:"font-medium",children:[a.value," ngi"]})]}),t.jsx("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-purple-500 rounded-full",style:{width:`${e.summary.tongNhanVien>0?a.value/e.summary.tongNhanVien*100:0}%`}})})]},r))})})]})]})]}):t.jsx(jo,{message:"Khng c d liu nhn s"})}function xU({data:e,isLoading:n}){return n?t.jsx(No,{}):e?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsx(Xt,{title:"Ngy cng chun",value:e.summary.ngayCongChuan,unit:"ngy",icon:t.jsx(At,{className:"h-5 w-5"})}),t.jsx(Xt,{title:"Tng nhn vin",value:e.summary.tongNhanVien,icon:t.jsx(dn,{className:"h-5 w-5"})}),t.jsx(Xt,{title:"TB ngy cng",value:e.summary.trungBinhNgayCong.toFixed(1),unit:"ngy",icon:t.jsx(At,{className:"h-5 w-5"}),color:"blue"}),t.jsx(Xt,{title:"T l i lm",value:`${e.summary.tyLeDiLamTrungBinh.toFixed(1)}%`,icon:t.jsx(li,{className:"h-5 w-5"}),color:"green"}),t.jsx(Xt,{title:"Tng gi OT",value:e.summary.tongGioOT.toFixed(1),unit:"gi",icon:t.jsx(an,{className:"h-5 w-5"}),color:"amber"})]}),t.jsxs(st,{children:[t.jsx(Kn,{children:t.jsxs("h3",{className:"font-semibold",children:["Chi tit chm cng (",e.chiTiet.length," nhn vin)"]})}),t.jsx(Vt,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-slate-200",children:[t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"M NV"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"H tn"}),t.jsx("th",{className:"text-left p-3 font-medium text-slate-600",children:"Phng ban"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Cng chun"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Cng thc"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Ngy ngh"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"i tr"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"V sm"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"Gi OT"}),t.jsx("th",{className:"text-right p-3 font-medium text-slate-600",children:"T l"})]})}),t.jsx("tbody",{children:e.chiTiet.slice(0,50).map((a,r)=>t.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[t.jsx("td",{className:"p-3",children:a.maNhanVien}),t.jsx("td",{className:"p-3",children:a.hoTen}),t.jsx("td",{className:"p-3",children:a.phongBan}),t.jsx("td",{className:"text-right p-3",children:a.ngayCongChuan}),t.jsx("td",{className:"text-right p-3 font-medium",children:a.ngayCongThuc}),t.jsx("td",{className:"text-right p-3",children:a.ngayNghi+a.ngayPhep}),t.jsx("td",{className:"text-right p-3",children:a.soLanDiTre>0&&t.jsx("span",{className:"text-red-600",children:a.soLanDiTre})}),t.jsx("td",{className:"text-right p-3",children:a.soLanVeSom>0&&t.jsx("span",{className:"text-amber-600",children:a.soLanVeSom})}),t.jsx("td",{className:"text-right p-3",children:a.tongGioOT>0&&t.jsx("span",{className:"text-blue-600",children:a.tongGioOT.toFixed(1)})}),t.jsx("td",{className:"text-right p-3",children:t.jsxs(Tt,{variant:a.tyLeDiLam>=90?"success":a.tyLeDiLam>=80?"warning":"danger",children:[a.tyLeDiLam.toFixed(1),"%"]})})]},r))})]})})})]})]}):t.jsx(jo,{message:"Khng c d liu chm cng"})}function Xt({title:e,value:n,unit:a,icon:r,color:s="gray"}){const l={gray:"bg-slate-100",red:"bg-red-100",amber:"bg-amber-100",green:"bg-green-100",blue:"bg-blue-100"};return t.jsx(st,{children:t.jsx(Vt,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-slate-500",children:e}),t.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[n,a&&t.jsx("span",{className:"text-sm font-normal ml-1",children:a})]})]}),t.jsx("div",{className:`p-3 rounded-full ${l[s]||l.gray}`,children:r})]})})})}function No(){return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[1,2,3,4].map(e=>t.jsx(st,{children:t.jsx(Vt,{className:"pt-6",children:t.jsx("div",{className:"h-16 bg-slate-200 animate-pulse rounded"})})},e))}),t.jsx(st,{children:t.jsx(Vt,{className:"pt-6",children:t.jsx("div",{className:"h-64 bg-slate-200 animate-pulse rounded"})})})]})}function jo({message:e}){return t.jsx(st,{children:t.jsx(Vt,{className:"pt-6",children:t.jsxs("div",{className:"text-center py-12 text-slate-500",children:[t.jsx(At,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:e})]})})})}function mU(){return t.jsxs(o3,{children:[t.jsx(rt,{path:"/dang-nhap",element:t.jsx(_D,{})}),t.jsxs(rt,{path:"/",element:t.jsx(U5,{}),children:[t.jsx(rt,{index:!0,element:t.jsx(Z5,{})}),t.jsx(rt,{path:"bang-luong",element:t.jsx(e6,{})}),t.jsx(rt,{path:"bang-luong/:id",element:t.jsx(Q6,{})}),t.jsx(rt,{path:"nhan-vien",element:t.jsx(Z6,{})}),t.jsx(rt,{path:"nhan-vien/:id",element:t.jsx(bD,{})}),t.jsx(rt,{path:"nhom-nhan-vien",element:t.jsx(SD,{})}),t.jsx(rt,{path:"phong-ban",element:t.jsx(TD,{})}),t.jsx(rt,{path:"khoan-luong",element:t.jsx(ND,{})}),t.jsx(rt,{path:"cham-cong",element:t.jsx(kD,{})}),t.jsx(rt,{path:"import-excel",element:t.jsx(jD,{})}),t.jsx(rt,{path:"cai-dat",element:t.jsx(CD,{})}),t.jsx(rt,{path:"quy-che",element:t.jsx(Et,{children:t.jsx(BD,{})})}),t.jsx(rt,{path:"quy-che/:id",element:t.jsx(Et,{children:t.jsx(XD,{})})}),t.jsx(rt,{path:"su-kien",element:t.jsx(Et,{children:t.jsx(YD,{})})}),t.jsx(rt,{path:"rule-trace",element:t.jsx(Et,{children:t.jsx(ZD,{})})}),t.jsx(rt,{path:"kpi/template",element:t.jsx(Et,{children:t.jsx(DD,{})})}),t.jsx(rt,{path:"kpi/ky-danh-gia",element:t.jsx(Et,{children:t.jsx(FD,{})})}),t.jsx(rt,{path:"kpi/cau-hinh-thuong",element:t.jsx(Et,{children:t.jsx(LD,{})})}),t.jsx(rt,{path:"san-luong",element:t.jsx(Et,{children:t.jsx(dV,{})})}),t.jsx(rt,{path:"import-chia-hang",element:t.jsx(Et,{children:t.jsx(lV,{})})}),t.jsx(rt,{path:"import-giao-hang",element:t.jsx(Et,{children:t.jsx(oV,{})})}),t.jsx(rt,{path:"lich-su-import",element:t.jsx(Et,{children:t.jsx(cV,{})})}),t.jsx(rt,{path:"ung-luong",element:t.jsx(Et,{children:t.jsx(xV,{})})}),t.jsx(rt,{path:"ung-luong/:id",element:t.jsx(Et,{children:t.jsx(fV,{})})}),t.jsx(rt,{path:"so-luong/nhan-vien",element:t.jsx(Et,{children:t.jsx(pV,{})})}),t.jsx(rt,{path:"so-luong/phong-ban",element:t.jsx(Et,{children:t.jsx(gV,{})})}),t.jsx(rt,{path:"nghi-phep/loai-nghi",element:t.jsx(Et,{children:t.jsx(bV,{})})}),t.jsx(rt,{path:"nghi-phep/don-cua-toi",element:t.jsx(Et,{children:t.jsx(NV,{})})}),t.jsx(rt,{path:"nghi-phep/duyet",element:t.jsx(Et,{children:t.jsx(jV,{})})}),t.jsx(rt,{path:"nghi-phep/lich",element:t.jsx(Et,{children:t.jsx(wV,{})})}),t.jsx(rt,{path:"xep-ca/danh-muc-ca",element:t.jsx(Et,{children:t.jsx(kV,{})})}),t.jsx(rt,{path:"xep-ca/lich-phan-ca",element:t.jsx(Et,{children:t.jsx(TV,{})})}),t.jsx(rt,{path:"yeu-cau/don-cua-toi",element:t.jsx(Et,{children:t.jsx(CV,{})})}),t.jsx(rt,{path:"yeu-cau/duyet",element:t.jsx(Et,{children:t.jsx(SV,{})})}),t.jsx(rt,{path:"quan-tri/nguoi-dung",element:t.jsx(Et,{children:t.jsx(PD,{})})}),t.jsx(rt,{path:"quan-tri/audit-log",element:t.jsx(Et,{children:t.jsx(ID,{})})}),t.jsx(rt,{path:"anti-fraud/geofence",element:t.jsx(Et,{children:t.jsx(UV,{})})}),t.jsx(rt,{path:"anti-fraud/gps-logs",element:t.jsx(Et,{children:t.jsx(KV,{})})}),t.jsx(rt,{path:"anti-fraud/devices",element:t.jsx(Et,{children:t.jsx(zV,{})})}),t.jsx(rt,{path:"timesheet",element:t.jsx(Et,{children:t.jsx(JV,{})})}),t.jsx(rt,{path:"payroll-sync",element:t.jsx(Et,{children:t.jsx(nU,{})})}),t.jsx(rt,{path:"reports",element:t.jsx(Et,{children:t.jsx(iU,{})})}),t.jsx(rt,{path:"*",element:t.jsx(i3,{to:"/",replace:!0})})]}),t.jsxs(rt,{path:"/portal",element:t.jsx(Et,{children:t.jsx(EV,{})}),children:[t.jsx(rt,{index:!0,element:t.jsx(PV,{})}),t.jsx(rt,{path:"lich-lam",element:t.jsx(IV,{})}),t.jsx(rt,{path:"cham-cong",element:t.jsx(OV,{})}),t.jsx(rt,{path:"yeu-cau",element:t.jsx(MV,{})}),t.jsx(rt,{path:"ca-nhan",element:t.jsx(RV,{})}),t.jsx(rt,{path:"thong-bao",element:t.jsx(m2,{})})]}),t.jsx(rt,{path:"/thong-bao",element:t.jsx(Et,{children:t.jsx(m2,{})})})]})}const fU=new eS({defaultOptions:{queries:{staleTime:300*1e3,retry:1}}});DC.createRoot(document.getElementById("root")).render(t.jsx(E.StrictMode,{children:t.jsx(tS,{client:fU,children:t.jsx(p3,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:t.jsxs(S5,{children:[t.jsx(mU,{}),t.jsx(o_,{position:"top-right",toastOptions:{duration:3e3,style:{background:"#333",color:"#fff"}}})]})})})}));
